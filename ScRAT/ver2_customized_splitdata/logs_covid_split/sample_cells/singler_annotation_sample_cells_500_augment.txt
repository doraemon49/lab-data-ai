Namespace(seed=240, batch_size=16, learning_rate=0.0001, weight_decay=0.0001, epochs=100, task='custom_covid', emb_dim=8, h_dim=128, dropout=0.0, layers=1, heads=4, train_sample_cells=500, test_sample_cells=500, train_num_sample=20, test_num_sample=100, model='Transformer', dataset=None, inter_only=False, same_pheno=0, augment_num=100, alpha=1.0, repeat=5, all=1, min_size=6000, n_splits=5, pca=False, mix_type=1, norm_first=False, warmup=False, top_k=1)
🔁 Repeat 0, Fold 0
🔍 Split #1
  → train_p_index 환자 수: 16
  → test_p_index 환자 수: 3
  → train 환자 ID: ['COVID19_Participant13', 'COVID19_Participant15', 'COVID19_Participant17', 'COVID19_Participant19', 'COVID19_Participant20', 'COVID19_Participant22', 'COVID19_Participant26', 'COVID19_Participant29', 'COVID19_Participant32', 'COVID19_Participant37', 'COVID19_Participant4', 'Control_Participant10', 'Control_Participant11', 'Control_Participant15', 'Control_Participant3', 'Control_Participant5']
  → test  환자 ID: ['COVID19_Participant7', 'COVID19_Participant13', 'COVID19_Participant26']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: Control_Participant10, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant5, Label: 0
  → test 환자 ID 및 라벨:
    ID: COVID19_Participant7, Label: 1
    ID: COVID19_Participant13, Label: 0
    ID: COVID19_Participant26, Label: 0
train_p_index_ 10
valid_p_index 6
test_p_index 3
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Epithelial_cells', 'Platelets', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Keratinocytes', 'Macrophage', 'Epithelial_cells', 'B_cell', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
data augment 실행 함
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:13,  7.42it/s]  2%|▏         | 2/100 [00:00<00:11,  8.61it/s]  3%|▎         | 3/100 [00:00<00:10,  8.85it/s]  4%|▍         | 4/100 [00:00<00:10,  8.89it/s]  5%|▌         | 5/100 [00:00<00:10,  8.92it/s]  6%|▌         | 6/100 [00:00<00:10,  8.98it/s]  7%|▋         | 7/100 [00:00<00:10,  9.03it/s]  8%|▊         | 8/100 [00:00<00:09,  9.31it/s]  9%|▉         | 9/100 [00:00<00:09,  9.44it/s] 10%|█         | 10/100 [00:01<00:09,  9.30it/s] 11%|█         | 11/100 [00:01<00:09,  8.95it/s] 12%|█▏        | 12/100 [00:01<00:09,  9.24it/s] 13%|█▎        | 13/100 [00:01<00:09,  9.10it/s] 14%|█▍        | 14/100 [00:01<00:09,  8.95it/s] 15%|█▌        | 15/100 [00:01<00:09,  9.13it/s] 16%|█▌        | 16/100 [00:01<00:09,  9.21it/s] 17%|█▋        | 17/100 [00:01<00:09,  9.09it/s] 18%|█▊        | 18/100 [00:01<00:08,  9.15it/s] 19%|█▉        | 19/100 [00:02<00:08,  9.12it/s] 20%|██        | 20/100 [00:02<00:08,  8.95it/s] 21%|██        | 21/100 [00:02<00:09,  8.50it/s] 22%|██▏       | 22/100 [00:02<00:09,  8.45it/s] 23%|██▎       | 23/100 [00:02<00:08,  8.62it/s] 24%|██▍       | 24/100 [00:02<00:08,  8.55it/s] 25%|██▌       | 25/100 [00:02<00:08,  8.65it/s] 26%|██▌       | 26/100 [00:02<00:09,  8.19it/s] 27%|██▋       | 27/100 [00:03<00:08,  8.24it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.39it/s] 29%|██▉       | 29/100 [00:03<00:08,  8.44it/s] 30%|███       | 30/100 [00:03<00:08,  8.58it/s] 31%|███       | 31/100 [00:03<00:08,  8.59it/s] 32%|███▏      | 32/100 [00:03<00:08,  8.47it/s] 33%|███▎      | 33/100 [00:03<00:08,  8.25it/s] 34%|███▍      | 34/100 [00:03<00:07,  8.45it/s] 35%|███▌      | 35/100 [00:04<00:07,  8.49it/s] 36%|███▌      | 36/100 [00:04<00:07,  8.72it/s] 37%|███▋      | 37/100 [00:04<00:07,  8.60it/s] 38%|███▊      | 38/100 [00:04<00:07,  8.21it/s] 39%|███▉      | 39/100 [00:04<00:07,  8.17it/s] 40%|████      | 40/100 [00:04<00:07,  8.20it/s] 41%|████      | 41/100 [00:04<00:07,  8.17it/s] 42%|████▏     | 42/100 [00:04<00:07,  8.18it/s] 43%|████▎     | 43/100 [00:04<00:06,  8.18it/s] 44%|████▍     | 44/100 [00:05<00:06,  8.14it/s] 45%|████▌     | 45/100 [00:05<00:06,  8.23it/s] 46%|████▌     | 46/100 [00:05<00:06,  8.10it/s] 47%|████▋     | 47/100 [00:05<00:06,  8.15it/s] 48%|████▊     | 48/100 [00:05<00:06,  8.18it/s] 49%|████▉     | 49/100 [00:05<00:06,  8.24it/s] 50%|█████     | 50/100 [00:05<00:06,  8.10it/s] 51%|█████     | 51/100 [00:05<00:06,  8.08it/s] 52%|█████▏    | 52/100 [00:06<00:06,  7.89it/s] 53%|█████▎    | 53/100 [00:06<00:05,  8.09it/s] 54%|█████▍    | 54/100 [00:06<00:05,  8.12it/s] 55%|█████▌    | 55/100 [00:06<00:05,  8.12it/s] 56%|█████▌    | 56/100 [00:06<00:05,  8.09it/s] 57%|█████▋    | 57/100 [00:06<00:05,  7.74it/s] 58%|█████▊    | 58/100 [00:06<00:05,  7.91it/s] 59%|█████▉    | 59/100 [00:06<00:05,  8.00it/s] 60%|██████    | 60/100 [00:07<00:04,  8.05it/s] 61%|██████    | 61/100 [00:07<00:04,  8.17it/s] 62%|██████▏   | 62/100 [00:07<00:04,  8.07it/s] 63%|██████▎   | 63/100 [00:07<00:04,  7.82it/s] 64%|██████▍   | 64/100 [00:07<00:04,  7.76it/s] 65%|██████▌   | 65/100 [00:07<00:04,  7.85it/s] 66%|██████▌   | 66/100 [00:07<00:04,  7.88it/s] 67%|██████▋   | 67/100 [00:07<00:04,  7.87it/s] 68%|██████▊   | 68/100 [00:08<00:04,  7.85it/s] 69%|██████▉   | 69/100 [00:08<00:03,  7.81it/s] 70%|███████   | 70/100 [00:08<00:03,  8.03it/s] 71%|███████   | 71/100 [00:08<00:03,  8.29it/s] 72%|███████▏  | 72/100 [00:08<00:03,  8.36it/s] 73%|███████▎  | 73/100 [00:08<00:03,  8.24it/s] 74%|███████▍  | 74/100 [00:08<00:03,  8.44it/s] 75%|███████▌  | 75/100 [00:08<00:03,  8.12it/s] 76%|███████▌  | 76/100 [00:09<00:02,  8.16it/s] 77%|███████▋  | 77/100 [00:09<00:02,  8.22it/s] 78%|███████▊  | 78/100 [00:09<00:02,  8.27it/s] 79%|███████▉  | 79/100 [00:09<00:02,  8.33it/s] 80%|████████  | 80/100 [00:09<00:02,  8.30it/s] 81%|████████  | 81/100 [00:09<00:02,  8.05it/s] 82%|████████▏ | 82/100 [00:09<00:02,  8.04it/s] 83%|████████▎ | 83/100 [00:09<00:02,  7.71it/s] 84%|████████▍ | 84/100 [00:10<00:02,  7.55it/s] 85%|████████▌ | 85/100 [00:10<00:01,  7.65it/s] 86%|████████▌ | 86/100 [00:10<00:01,  7.42it/s] 87%|████████▋ | 87/100 [00:10<00:01,  7.56it/s] 88%|████████▊ | 88/100 [00:10<00:01,  7.60it/s] 89%|████████▉ | 89/100 [00:10<00:01,  7.75it/s] 90%|█████████ | 90/100 [00:10<00:01,  7.81it/s] 91%|█████████ | 91/100 [00:10<00:01,  7.76it/s] 92%|█████████▏| 92/100 [00:11<00:01,  8.00it/s] 93%|█████████▎| 93/100 [00:11<00:00,  7.86it/s] 94%|█████████▍| 94/100 [00:11<00:00,  7.79it/s] 95%|█████████▌| 95/100 [00:11<00:00,  7.66it/s] 96%|█████████▌| 96/100 [00:11<00:00,  7.57it/s] 97%|█████████▋| 97/100 [00:11<00:00,  7.56it/s] 98%|█████████▊| 98/100 [00:11<00:00,  7.54it/s] 99%|█████████▉| 99/100 [00:12<00:00,  7.43it/s]100%|██████████| 100/100 [00:12<00:00,  7.51it/s]100%|██████████| 100/100 [00:12<00:00,  8.21it/s]
eval_p_index len:  9
individual_train 110
individual_eval 9
train data의 x, y, id 길이: 110 110 110
valid data의 x, y, id 길이: 6 6 6
test data의 x, y, id 길이: 3 3 3
output_class :  1
Memory Allocated: 0.44 MB
Memory Reserved: 2.00 MB
cuda
Epoch 1, Train Loss 0.562202, Valid_loss 0.637558
Epoch 2, Train Loss 0.559618, Valid_loss 0.634546
Epoch 3, Train Loss 0.554042, Valid_loss 0.629955
Epoch 4, Train Loss 0.552835, Valid_loss 0.624374
Epoch 5, Train Loss 0.550554, Valid_loss 0.615229
Epoch 6, Train Loss 0.545337, Valid_loss 0.599694
Epoch 7, Train Loss 0.536063, Valid_loss 0.580410
Epoch 8, Train Loss 0.523903, Valid_loss 0.561853
Epoch 9, Train Loss 0.514532, Valid_loss 0.543220
Epoch 10, Train Loss 0.506741, Valid_loss 0.529278
Epoch 11, Train Loss 0.495990, Valid_loss 0.521395
Epoch 12, Train Loss 0.487686, Valid_loss 0.517231
Epoch 13, Train Loss 0.483084, Valid_loss 0.512616
Epoch 14, Train Loss 0.478426, Valid_loss 0.510432
Epoch 15, Train Loss 0.472842, Valid_loss 0.509139
Epoch 16, Train Loss 0.469181, Valid_loss 0.509414
Epoch 17, Train Loss 0.467240, Valid_loss 0.508234
Epoch 18, Train Loss 0.464989, Valid_loss 0.506916
Epoch 19, Train Loss 0.463349, Valid_loss 0.506777
Epoch 20, Train Loss 0.461025, Valid_loss 0.504960
Epoch 21, Train Loss 0.459720, Valid_loss 0.502592
Epoch 22, Train Loss 0.458064, Valid_loss 0.502894
Epoch 23, Train Loss 0.455635, Valid_loss 0.501783
Epoch 24, Train Loss 0.455379, Valid_loss 0.500435
Epoch 25, Train Loss 0.453535, Valid_loss 0.499960
Epoch 26, Train Loss 0.452362, Valid_loss 0.499451
Epoch 27, Train Loss 0.452042, Valid_loss 0.498113
Epoch 28, Train Loss 0.449052, Valid_loss 0.497808
Epoch 29, Train Loss 0.447806, Valid_loss 0.497112
Epoch 30, Train Loss 0.447079, Valid_loss 0.496362
Epoch 31, Train Loss 0.446407, Valid_loss 0.495832
Epoch 32, Train Loss 0.444586, Valid_loss 0.495210
Epoch 33, Train Loss 0.444185, Valid_loss 0.494606
Epoch 34, Train Loss 0.441799, Valid_loss 0.494119
Epoch 35, Train Loss 0.442232, Valid_loss 0.493582
Epoch 36, Train Loss 0.440557, Valid_loss 0.492930
Epoch 37, Train Loss 0.439800, Valid_loss 0.492377
Epoch 38, Train Loss 0.437199, Valid_loss 0.491785
Epoch 39, Train Loss 0.437139, Valid_loss 0.491085
Epoch 40, Train Loss 0.434638, Valid_loss 0.490011
Epoch 41, Train Loss 0.434914, Valid_loss 0.489524
Epoch 42, Train Loss 0.434250, Valid_loss 0.488399
Epoch 43, Train Loss 0.433809, Valid_loss 0.488134
Epoch 44, Train Loss 0.432150, Valid_loss 0.487070
Epoch 45, Train Loss 0.431236, Valid_loss 0.486340
Epoch 46, Train Loss 0.429992, Valid_loss 0.485402
Epoch 47, Train Loss 0.429422, Valid_loss 0.484866
Epoch 48, Train Loss 0.429042, Valid_loss 0.484041
Epoch 49, Train Loss 0.427024, Valid_loss 0.483233
Epoch 50, Train Loss 0.426382, Valid_loss 0.482486
Epoch 51, Train Loss 0.425827, Valid_loss 0.482069
Epoch 52, Train Loss 0.424638, Valid_loss 0.481765
Epoch 53, Train Loss 0.424932, Valid_loss 0.481462
Epoch 54, Train Loss 0.425683, Valid_loss 0.480997
Epoch 55, Train Loss 0.425236, Valid_loss 0.480821
Epoch 56, Train Loss 0.423403, Valid_loss 0.480228
Epoch 57, Train Loss 0.422687, Valid_loss 0.480067
Epoch 58, Train Loss 0.422908, Valid_loss 0.479598
Epoch 59, Train Loss 0.422641, Valid_loss 0.479252
Epoch 60, Train Loss 0.422059, Valid_loss 0.478827
Epoch 61, Train Loss 0.422056, Valid_loss 0.478710
Epoch 62, Train Loss 0.422920, Valid_loss 0.478058
Epoch 63, Train Loss 0.420442, Valid_loss 0.477844
Epoch 64, Train Loss 0.420874, Valid_loss 0.477388
Epoch 65, Train Loss 0.421744, Valid_loss 0.477105
Epoch 66, Train Loss 0.420777, Valid_loss 0.476802
Epoch 67, Train Loss 0.418912, Valid_loss 0.476445
Epoch 68, Train Loss 0.417775, Valid_loss 0.476113
Epoch 69, Train Loss 0.418757, Valid_loss 0.475667
Epoch 70, Train Loss 0.418288, Valid_loss 0.475397
Epoch 71, Train Loss 0.417290, Valid_loss 0.475078
Epoch 72, Train Loss 0.417158, Valid_loss 0.474700
Epoch 73, Train Loss 0.417305, Valid_loss 0.474334
Epoch 74, Train Loss 0.416424, Valid_loss 0.474032
Epoch 75, Train Loss 0.415382, Valid_loss 0.473618
Epoch 76, Train Loss 0.414075, Valid_loss 0.473392
Epoch 77, Train Loss 0.414424, Valid_loss 0.472964
Epoch 78, Train Loss 0.415102, Valid_loss 0.472717
Epoch 79, Train Loss 0.413624, Valid_loss 0.472291
Epoch 80, Train Loss 0.413900, Valid_loss 0.471990
Epoch 81, Train Loss 0.413053, Valid_loss 0.471569
Epoch 82, Train Loss 0.412459, Valid_loss 0.471268
Epoch 83, Train Loss 0.413527, Valid_loss 0.470916
Epoch 84, Train Loss 0.412108, Valid_loss 0.470672
Epoch 85, Train Loss 0.411269, Valid_loss 0.470269
Epoch 86, Train Loss 0.410976, Valid_loss 0.469812
Epoch 87, Train Loss 0.410465, Valid_loss 0.469587
Epoch 88, Train Loss 0.411268, Valid_loss 0.469252
Epoch 89, Train Loss 0.409427, Valid_loss 0.468957
Epoch 90, Train Loss 0.410655, Valid_loss 0.468607
Epoch 91, Train Loss 0.409419, Valid_loss 0.468305
Epoch 92, Train Loss 0.407900, Valid_loss 0.467844
Epoch 93, Train Loss 0.408111, Valid_loss 0.467562
Epoch 94, Train Loss 0.408276, Valid_loss 0.467302
Epoch 95, Train Loss 0.406935, Valid_loss 0.466945
Epoch 96, Train Loss 0.407540, Valid_loss 0.466497
Epoch 97, Train Loss 0.405659, Valid_loss 0.466296
Epoch 98, Train Loss 0.407074, Valid_loss 0.465931
Epoch 99, Train Loss 0.406721, Valid_loss 0.465581
Epoch 100, Train Loss 0.406664, Valid_loss 0.465372
COVID19_Participant7 -- true: COVID-19 -- pred: normal
COVID19_Participant13 -- true: COVID-19 -- pred: COVID-19
COVID19_Participant26 -- true: COVID-19 -- pred: COVID-19
true :  [1, 1, 1]
pred :  [0, 1, 1]
Confusion Matrix: [0 0 1 2]
Best performance: Epoch 100, Loss 0.406664, Test ACC 0.666667, Test AUC 0.000000, Test Recall 0.666667, Test Precision 1.000000
✅ Total valid splits used: 1
🔁 Repeat 0, Fold 1
🔍 Split #2
  → train_p_index 환자 수: 15
  → test_p_index 환자 수: 4
  → train 환자 ID: ['COVID19_Participant13', 'COVID19_Participant17', 'COVID19_Participant19', 'COVID19_Participant20', 'COVID19_Participant22', 'COVID19_Participant26', 'COVID19_Participant28', 'COVID19_Participant29', 'COVID19_Participant37', 'COVID19_Participant4', 'Control_Participant10', 'Control_Participant11', 'Control_Participant5', 'Control_Participant7', 'Control_Participant9']
  → test  환자 ID: ['Control_Participant5', 'Control_Participant4', 'COVID19_Participant19', 'Control_Participant7']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: Control_Participant10, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: Control_Participant5, Label: 1
    ID: Control_Participant4, Label: 1
    ID: COVID19_Participant19, Label: 0
    ID: Control_Participant7, Label: 0
train_p_index_ 10
valid_p_index 5
test_p_index 4
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Keratinocytes', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Neurons', 'iPS_cells', 'Embryonic_stem_cells', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
data augment 실행 함
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:11,  8.55it/s]  2%|▏         | 2/100 [00:00<00:11,  8.79it/s]  3%|▎         | 3/100 [00:00<00:11,  8.74it/s]  4%|▍         | 4/100 [00:00<00:11,  8.69it/s]  5%|▌         | 5/100 [00:00<00:10,  8.70it/s]  6%|▌         | 6/100 [00:00<00:10,  8.74it/s]  7%|▋         | 7/100 [00:00<00:10,  8.80it/s]  8%|▊         | 8/100 [00:00<00:10,  9.04it/s]  9%|▉         | 9/100 [00:01<00:10,  9.01it/s] 10%|█         | 10/100 [00:01<00:09,  9.06it/s] 11%|█         | 11/100 [00:01<00:09,  9.11it/s] 12%|█▏        | 12/100 [00:01<00:09,  9.08it/s] 13%|█▎        | 13/100 [00:01<00:09,  8.84it/s] 14%|█▍        | 14/100 [00:01<00:09,  8.79it/s] 15%|█▌        | 15/100 [00:01<00:09,  8.68it/s] 16%|█▌        | 16/100 [00:01<00:09,  8.69it/s] 17%|█▋        | 17/100 [00:01<00:09,  8.64it/s] 18%|█▊        | 18/100 [00:02<00:09,  8.72it/s] 19%|█▉        | 19/100 [00:02<00:09,  8.88it/s] 20%|██        | 20/100 [00:02<00:09,  8.81it/s] 21%|██        | 21/100 [00:02<00:09,  8.61it/s] 22%|██▏       | 22/100 [00:02<00:09,  8.63it/s] 23%|██▎       | 23/100 [00:02<00:09,  8.21it/s] 24%|██▍       | 24/100 [00:02<00:09,  8.40it/s] 25%|██▌       | 25/100 [00:02<00:08,  8.41it/s] 26%|██▌       | 26/100 [00:02<00:08,  8.61it/s] 27%|██▋       | 27/100 [00:03<00:08,  8.77it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.79it/s] 29%|██▉       | 29/100 [00:03<00:08,  8.38it/s] 30%|███       | 30/100 [00:03<00:08,  8.31it/s] 31%|███       | 31/100 [00:03<00:08,  8.54it/s] 32%|███▏      | 32/100 [00:03<00:07,  8.57it/s] 33%|███▎      | 33/100 [00:03<00:07,  8.61it/s] 34%|███▍      | 34/100 [00:03<00:07,  8.67it/s] 35%|███▌      | 35/100 [00:04<00:07,  8.56it/s] 36%|███▌      | 36/100 [00:04<00:07,  8.16it/s] 37%|███▋      | 37/100 [00:04<00:07,  8.14it/s] 38%|███▊      | 38/100 [00:04<00:07,  8.32it/s] 39%|███▉      | 39/100 [00:04<00:07,  8.28it/s] 40%|████      | 40/100 [00:04<00:07,  8.24it/s] 41%|████      | 41/100 [00:04<00:07,  8.33it/s] 42%|████▏     | 42/100 [00:04<00:06,  8.32it/s] 43%|████▎     | 43/100 [00:05<00:06,  8.46it/s] 44%|████▍     | 44/100 [00:05<00:06,  8.35it/s] 45%|████▌     | 45/100 [00:05<00:06,  8.40it/s] 46%|████▌     | 46/100 [00:05<00:06,  8.41it/s] 47%|████▋     | 47/100 [00:05<00:06,  8.38it/s] 48%|████▊     | 48/100 [00:05<00:06,  8.30it/s] 49%|████▉     | 49/100 [00:05<00:06,  8.22it/s] 50%|█████     | 50/100 [00:05<00:06,  8.18it/s] 51%|█████     | 51/100 [00:05<00:05,  8.30it/s] 52%|█████▏    | 52/100 [00:06<00:05,  8.51it/s] 53%|█████▎    | 53/100 [00:06<00:05,  8.45it/s] 54%|█████▍    | 54/100 [00:06<00:05,  8.26it/s] 55%|█████▌    | 55/100 [00:06<00:05,  8.45it/s] 56%|█████▌    | 56/100 [00:06<00:05,  8.58it/s] 57%|█████▋    | 57/100 [00:06<00:05,  8.46it/s] 58%|█████▊    | 58/100 [00:06<00:04,  8.49it/s] 59%|█████▉    | 59/100 [00:06<00:04,  8.64it/s] 60%|██████    | 60/100 [00:07<00:04,  8.35it/s] 61%|██████    | 61/100 [00:07<00:04,  8.23it/s] 62%|██████▏   | 62/100 [00:07<00:04,  8.20it/s] 63%|██████▎   | 63/100 [00:07<00:04,  8.44it/s] 64%|██████▍   | 64/100 [00:07<00:04,  7.98it/s] 65%|██████▌   | 65/100 [00:07<00:04,  7.97it/s] 66%|██████▌   | 66/100 [00:07<00:04,  7.93it/s] 67%|██████▋   | 67/100 [00:07<00:04,  7.96it/s] 68%|██████▊   | 68/100 [00:08<00:03,  8.19it/s] 69%|██████▉   | 69/100 [00:08<00:03,  8.17it/s] 70%|███████   | 70/100 [00:08<00:03,  8.12it/s] 71%|███████   | 71/100 [00:08<00:03,  8.06it/s] 72%|███████▏  | 72/100 [00:08<00:03,  7.73it/s] 73%|███████▎  | 73/100 [00:08<00:03,  7.74it/s] 74%|███████▍  | 74/100 [00:08<00:03,  7.78it/s] 75%|███████▌  | 75/100 [00:08<00:03,  7.86it/s] 76%|███████▌  | 76/100 [00:09<00:03,  7.85it/s] 77%|███████▋  | 77/100 [00:09<00:02,  7.83it/s] 78%|███████▊  | 78/100 [00:09<00:02,  7.77it/s] 79%|███████▉  | 79/100 [00:09<00:02,  7.77it/s] 80%|████████  | 80/100 [00:09<00:02,  7.87it/s] 81%|████████  | 81/100 [00:09<00:02,  7.50it/s] 82%|████████▏ | 82/100 [00:09<00:02,  7.60it/s] 83%|████████▎ | 83/100 [00:09<00:02,  7.71it/s] 84%|████████▍ | 84/100 [00:10<00:02,  7.79it/s] 85%|████████▌ | 85/100 [00:10<00:01,  7.86it/s] 86%|████████▌ | 86/100 [00:10<00:01,  7.83it/s] 87%|████████▋ | 87/100 [00:10<00:01,  7.84it/s] 88%|████████▊ | 88/100 [00:10<00:01,  7.84it/s] 89%|████████▉ | 89/100 [00:10<00:01,  7.77it/s] 90%|█████████ | 90/100 [00:10<00:01,  7.62it/s] 91%|█████████ | 91/100 [00:10<00:01,  7.54it/s] 92%|█████████▏| 92/100 [00:11<00:01,  7.56it/s] 93%|█████████▎| 93/100 [00:11<00:00,  7.62it/s] 94%|█████████▍| 94/100 [00:11<00:00,  7.65it/s] 95%|█████████▌| 95/100 [00:11<00:00,  7.26it/s] 96%|█████████▌| 96/100 [00:11<00:00,  7.37it/s] 97%|█████████▋| 97/100 [00:11<00:00,  7.35it/s] 98%|█████████▊| 98/100 [00:11<00:00,  7.43it/s] 99%|█████████▉| 99/100 [00:12<00:00,  7.48it/s]100%|██████████| 100/100 [00:12<00:00,  7.45it/s]100%|██████████| 100/100 [00:12<00:00,  8.19it/s]
eval_p_index len:  9
individual_train 110
individual_eval 9
train data의 x, y, id 길이: 110 110 110
valid data의 x, y, id 길이: 5 5 5
test data의 x, y, id 길이: 4 4 4
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 38.00 MB
cuda
Epoch 1, Train Loss 0.705777, Valid_loss 0.541413
Epoch 2, Train Loss 0.694048, Valid_loss 0.541149
Epoch 3, Train Loss 0.683615, Valid_loss 0.536440
Epoch 4, Train Loss 0.673195, Valid_loss 0.530059
Epoch 5, Train Loss 0.657388, Valid_loss 0.535785
Epoch 6, Train Loss 0.637754, Valid_loss 0.566649
Epoch 7, Train Loss 0.615538, Valid_loss 0.572475
Epoch 8, Train Loss 0.593631, Valid_loss 0.572075
Epoch 9, Train Loss 0.575629, Valid_loss 0.567826
Epoch 10, Train Loss 0.557623, Valid_loss 0.564071
Epoch 11, Train Loss 0.544358, Valid_loss 0.560101
Epoch 12, Train Loss 0.534126, Valid_loss 0.553486
Epoch 13, Train Loss 0.527525, Valid_loss 0.539167
Epoch 14, Train Loss 0.521647, Valid_loss 0.527726
Epoch 15, Train Loss 0.519693, Valid_loss 0.527710
Epoch 16, Train Loss 0.516736, Valid_loss 0.522391
Epoch 17, Train Loss 0.514416, Valid_loss 0.521055
Epoch 18, Train Loss 0.511786, Valid_loss 0.518469
Epoch 19, Train Loss 0.510145, Valid_loss 0.511862
Epoch 20, Train Loss 0.508934, Valid_loss 0.510028
Epoch 21, Train Loss 0.507362, Valid_loss 0.512449
Epoch 22, Train Loss 0.505204, Valid_loss 0.510324
Epoch 23, Train Loss 0.503325, Valid_loss 0.508895
Epoch 24, Train Loss 0.503845, Valid_loss 0.506348
Epoch 25, Train Loss 0.501157, Valid_loss 0.505244
Epoch 26, Train Loss 0.500256, Valid_loss 0.502065
Epoch 27, Train Loss 0.499084, Valid_loss 0.502244
Epoch 28, Train Loss 0.496910, Valid_loss 0.502516
Epoch 29, Train Loss 0.496650, Valid_loss 0.498766
Epoch 30, Train Loss 0.496084, Valid_loss 0.500434
Epoch 31, Train Loss 0.493731, Valid_loss 0.498936
Epoch 32, Train Loss 0.492935, Valid_loss 0.496054
Epoch 33, Train Loss 0.492880, Valid_loss 0.494485
Epoch 34, Train Loss 0.491676, Valid_loss 0.495478
Epoch 35, Train Loss 0.490340, Valid_loss 0.493566
Epoch 36, Train Loss 0.488812, Valid_loss 0.494002
Epoch 37, Train Loss 0.488642, Valid_loss 0.488924
Epoch 38, Train Loss 0.486324, Valid_loss 0.493498
Epoch 39, Train Loss 0.485420, Valid_loss 0.490010
Epoch 40, Train Loss 0.484420, Valid_loss 0.488768
Epoch 41, Train Loss 0.483155, Valid_loss 0.488685
Epoch 42, Train Loss 0.482627, Valid_loss 0.488595
Epoch 43, Train Loss 0.481648, Valid_loss 0.484853
Epoch 44, Train Loss 0.480093, Valid_loss 0.486061
Epoch 45, Train Loss 0.480221, Valid_loss 0.484115
Epoch 46, Train Loss 0.479834, Valid_loss 0.484450
Epoch 47, Train Loss 0.478460, Valid_loss 0.484343
Epoch 48, Train Loss 0.477485, Valid_loss 0.480944
Epoch 49, Train Loss 0.476318, Valid_loss 0.480916
Epoch 50, Train Loss 0.475198, Valid_loss 0.483250
Epoch 51, Train Loss 0.475426, Valid_loss 0.480446
Epoch 52, Train Loss 0.473450, Valid_loss 0.480240
Epoch 53, Train Loss 0.473316, Valid_loss 0.480817
Epoch 54, Train Loss 0.474577, Valid_loss 0.480146
Epoch 55, Train Loss 0.472655, Valid_loss 0.478990
Epoch 56, Train Loss 0.474270, Valid_loss 0.479306
Epoch 57, Train Loss 0.471631, Valid_loss 0.479484
Control_Participant5 -- true: normal -- pred: COVID-19
Control_Participant4 -- true: normal -- pred: normal
COVID19_Participant19 -- true: COVID-19 -- pred: COVID-19
Control_Participant7 -- true: normal -- pred: COVID-19
true :  [0, 0, 1, 0]
pred :  [1, 0, 1, 1]
Confusion Matrix: [1 2 0 1]
Best performance: Epoch 55, Loss 0.472655, Test ACC 0.500000, Test AUC 0.666667, Test Recall 1.000000, Test Precision 0.333333
✅ Total valid splits used: 2
🔁 Repeat 0, Fold 2
🔍 Split #3
  → train_p_index 환자 수: 17
  → test_p_index 환자 수: 2
  → train 환자 ID: ['COVID19_Participant13', 'COVID19_Participant15', 'COVID19_Participant17', 'COVID19_Participant19', 'COVID19_Participant20', 'COVID19_Participant22', 'COVID19_Participant26', 'COVID19_Participant28', 'COVID19_Participant29', 'COVID19_Participant32', 'COVID19_Participant37', 'Control_Participant10', 'Control_Participant15', 'Control_Participant3', 'Control_Participant5', 'Control_Participant7', 'Control_Participant9']
  → test  환자 ID: ['COVID19_Participant26', 'COVID19_Participant13']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: Control_Participant10, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant13, Label: 0
train_p_index_ 11
valid_p_index 6
test_p_index 2
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Keratinocytes', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Neurons', 'iPS_cells', 'Embryonic_stem_cells', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
data augment 실행 함
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:11,  8.72it/s]  2%|▏         | 2/100 [00:00<00:10,  8.95it/s]  3%|▎         | 3/100 [00:00<00:10,  9.20it/s]  4%|▍         | 4/100 [00:00<00:10,  9.00it/s]  5%|▌         | 5/100 [00:00<00:11,  8.57it/s]  6%|▌         | 6/100 [00:00<00:10,  8.62it/s]  7%|▋         | 7/100 [00:00<00:10,  8.79it/s]  8%|▊         | 8/100 [00:00<00:11,  8.13it/s]  9%|▉         | 9/100 [00:01<00:11,  8.26it/s] 10%|█         | 10/100 [00:01<00:11,  7.94it/s] 11%|█         | 11/100 [00:01<00:10,  8.16it/s] 12%|█▏        | 12/100 [00:01<00:10,  8.32it/s] 13%|█▎        | 13/100 [00:01<00:10,  8.36it/s] 14%|█▍        | 14/100 [00:01<00:10,  8.35it/s] 15%|█▌        | 15/100 [00:01<00:10,  8.42it/s] 16%|█▌        | 16/100 [00:01<00:09,  8.64it/s] 17%|█▋        | 17/100 [00:02<00:09,  8.46it/s] 18%|█▊        | 18/100 [00:02<00:10,  8.05it/s] 19%|█▉        | 19/100 [00:02<00:10,  8.01it/s] 20%|██        | 20/100 [00:02<00:09,  8.17it/s] 21%|██        | 21/100 [00:02<00:09,  8.37it/s] 22%|██▏       | 22/100 [00:02<00:09,  8.35it/s] 23%|██▎       | 23/100 [00:02<00:09,  8.36it/s] 24%|██▍       | 24/100 [00:02<00:09,  8.28it/s] 25%|██▌       | 25/100 [00:02<00:09,  8.28it/s] 26%|██▌       | 26/100 [00:03<00:08,  8.26it/s] 27%|██▋       | 27/100 [00:03<00:08,  8.31it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.31it/s] 29%|██▉       | 29/100 [00:03<00:08,  8.19it/s] 30%|███       | 30/100 [00:03<00:08,  8.25it/s] 31%|███       | 31/100 [00:03<00:08,  8.30it/s] 32%|███▏      | 32/100 [00:03<00:08,  8.23it/s] 33%|███▎      | 33/100 [00:03<00:08,  8.08it/s] 34%|███▍      | 34/100 [00:04<00:08,  8.12it/s] 35%|███▌      | 35/100 [00:04<00:07,  8.29it/s] 36%|███▌      | 36/100 [00:04<00:07,  8.20it/s] 37%|███▋      | 37/100 [00:04<00:07,  8.24it/s] 38%|███▊      | 38/100 [00:04<00:07,  8.24it/s] 39%|███▉      | 39/100 [00:04<00:07,  8.23it/s] 40%|████      | 40/100 [00:04<00:07,  8.14it/s] 41%|████      | 41/100 [00:04<00:07,  7.89it/s] 42%|████▏     | 42/100 [00:05<00:07,  7.93it/s] 43%|████▎     | 43/100 [00:05<00:07,  8.09it/s] 44%|████▍     | 44/100 [00:05<00:07,  7.76it/s] 45%|████▌     | 45/100 [00:05<00:06,  7.94it/s] 46%|████▌     | 46/100 [00:05<00:06,  7.94it/s] 47%|████▋     | 47/100 [00:05<00:07,  7.56it/s] 48%|████▊     | 48/100 [00:05<00:06,  7.81it/s] 49%|████▉     | 49/100 [00:05<00:06,  8.07it/s] 50%|█████     | 50/100 [00:06<00:06,  7.56it/s] 51%|█████     | 51/100 [00:06<00:06,  7.29it/s] 52%|█████▏    | 52/100 [00:06<00:06,  7.27it/s] 53%|█████▎    | 53/100 [00:06<00:06,  7.51it/s] 54%|█████▍    | 54/100 [00:06<00:05,  7.69it/s] 55%|█████▌    | 55/100 [00:06<00:05,  7.74it/s] 56%|█████▌    | 56/100 [00:06<00:05,  7.82it/s] 57%|█████▋    | 57/100 [00:07<00:05,  7.21it/s] 58%|█████▊    | 58/100 [00:07<00:05,  7.44it/s] 59%|█████▉    | 59/100 [00:07<00:05,  7.57it/s] 60%|██████    | 60/100 [00:07<00:05,  7.71it/s] 61%|██████    | 61/100 [00:07<00:04,  7.82it/s] 62%|██████▏   | 62/100 [00:07<00:04,  7.83it/s] 63%|██████▎   | 63/100 [00:07<00:04,  7.85it/s] 64%|██████▍   | 64/100 [00:07<00:04,  7.87it/s] 65%|██████▌   | 65/100 [00:08<00:04,  7.87it/s] 66%|██████▌   | 66/100 [00:08<00:04,  7.70it/s] 67%|██████▋   | 67/100 [00:08<00:04,  7.45it/s] 68%|██████▊   | 68/100 [00:08<00:04,  7.57it/s] 69%|██████▉   | 69/100 [00:08<00:04,  7.67it/s] 70%|███████   | 70/100 [00:08<00:03,  7.95it/s] 71%|███████   | 71/100 [00:08<00:03,  7.85it/s] 72%|███████▏  | 72/100 [00:08<00:03,  7.88it/s] 73%|███████▎  | 73/100 [00:09<00:03,  8.05it/s] 74%|███████▍  | 74/100 [00:09<00:03,  8.06it/s] 75%|███████▌  | 75/100 [00:09<00:03,  7.94it/s] 76%|███████▌  | 76/100 [00:09<00:03,  7.93it/s] 77%|███████▋  | 77/100 [00:09<00:02,  7.93it/s] 78%|███████▊  | 78/100 [00:09<00:02,  7.42it/s] 79%|███████▉  | 79/100 [00:09<00:02,  7.43it/s] 80%|████████  | 80/100 [00:10<00:02,  7.68it/s] 81%|████████  | 81/100 [00:10<00:02,  7.77it/s] 82%|████████▏ | 82/100 [00:10<00:02,  7.85it/s] 83%|████████▎ | 83/100 [00:10<00:02,  7.73it/s] 84%|████████▍ | 84/100 [00:10<00:02,  7.72it/s] 85%|████████▌ | 85/100 [00:10<00:01,  7.63it/s] 86%|████████▌ | 86/100 [00:10<00:01,  7.51it/s] 87%|████████▋ | 87/100 [00:10<00:01,  7.10it/s] 88%|████████▊ | 88/100 [00:11<00:01,  7.31it/s] 89%|████████▉ | 89/100 [00:11<00:01,  7.12it/s] 90%|█████████ | 90/100 [00:11<00:01,  7.21it/s] 91%|█████████ | 91/100 [00:11<00:01,  7.25it/s] 92%|█████████▏| 92/100 [00:11<00:01,  7.32it/s] 93%|█████████▎| 93/100 [00:11<00:00,  7.57it/s] 94%|█████████▍| 94/100 [00:11<00:00,  7.58it/s] 95%|█████████▌| 95/100 [00:12<00:00,  7.58it/s] 96%|█████████▌| 96/100 [00:12<00:00,  7.59it/s] 97%|█████████▋| 97/100 [00:12<00:00,  7.57it/s] 98%|█████████▊| 98/100 [00:12<00:00,  7.61it/s] 99%|█████████▉| 99/100 [00:12<00:00,  7.64it/s]100%|██████████| 100/100 [00:12<00:00,  7.62it/s]100%|██████████| 100/100 [00:12<00:00,  7.89it/s]
eval_p_index len:  8
individual_train 111
individual_eval 8
train data의 x, y, id 길이: 111 111 111
valid data의 x, y, id 길이: 6 6 6
test data의 x, y, id 길이: 2 2 2
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 38.00 MB
cuda
Epoch 1, Train Loss 0.760954, Valid_loss 0.731754
Epoch 2, Train Loss 0.726189, Valid_loss 0.704831
Epoch 3, Train Loss 0.708490, Valid_loss 0.687988
Epoch 4, Train Loss 0.696924, Valid_loss 0.676182
Epoch 5, Train Loss 0.686185, Valid_loss 0.661535
Epoch 6, Train Loss 0.675523, Valid_loss 0.640819
Epoch 7, Train Loss 0.660296, Valid_loss 0.614185
Epoch 8, Train Loss 0.639880, Valid_loss 0.591477
Epoch 9, Train Loss 0.619500, Valid_loss 0.570574
Epoch 10, Train Loss 0.600967, Valid_loss 0.552745
Epoch 11, Train Loss 0.587160, Valid_loss 0.546653
Epoch 12, Train Loss 0.574938, Valid_loss 0.536197
Epoch 13, Train Loss 0.564590, Valid_loss 0.526368
Epoch 14, Train Loss 0.555408, Valid_loss 0.515743
Epoch 15, Train Loss 0.547064, Valid_loss 0.513020
Epoch 16, Train Loss 0.538987, Valid_loss 0.496633
Epoch 17, Train Loss 0.533108, Valid_loss 0.498270
Epoch 18, Train Loss 0.525793, Valid_loss 0.486505
Epoch 19, Train Loss 0.520510, Valid_loss 0.486479
Epoch 20, Train Loss 0.516633, Valid_loss 0.478095
Epoch 21, Train Loss 0.513871, Valid_loss 0.471007
Epoch 22, Train Loss 0.510581, Valid_loss 0.457137
Epoch 23, Train Loss 0.507562, Valid_loss 0.459091
Epoch 24, Train Loss 0.505229, Valid_loss 0.442796
Epoch 25, Train Loss 0.503410, Valid_loss 0.452200
Epoch 26, Train Loss 0.500742, Valid_loss 0.435598
Epoch 27, Train Loss 0.498893, Valid_loss 0.435856
Epoch 28, Train Loss 0.497658, Valid_loss 0.432798
Epoch 29, Train Loss 0.495719, Valid_loss 0.427157
Epoch 30, Train Loss 0.493796, Valid_loss 0.430864
Epoch 31, Train Loss 0.492833, Valid_loss 0.424096
Epoch 32, Train Loss 0.491166, Valid_loss 0.427578
Epoch 33, Train Loss 0.489429, Valid_loss 0.423198
Epoch 34, Train Loss 0.487684, Valid_loss 0.421751
Epoch 35, Train Loss 0.486427, Valid_loss 0.422195
Epoch 36, Train Loss 0.485006, Valid_loss 0.417793
Epoch 37, Train Loss 0.483672, Valid_loss 0.418902
Epoch 38, Train Loss 0.482208, Valid_loss 0.416834
Epoch 39, Train Loss 0.480811, Valid_loss 0.413962
Epoch 40, Train Loss 0.479930, Valid_loss 0.414335
Epoch 41, Train Loss 0.478278, Valid_loss 0.409849
Epoch 42, Train Loss 0.476426, Valid_loss 0.414548
Epoch 43, Train Loss 0.475748, Valid_loss 0.412514
Epoch 44, Train Loss 0.474375, Valid_loss 0.407948
Epoch 45, Train Loss 0.473481, Valid_loss 0.409175
Epoch 46, Train Loss 0.471965, Valid_loss 0.406304
Epoch 47, Train Loss 0.470521, Valid_loss 0.407215
Epoch 48, Train Loss 0.469893, Valid_loss 0.405179
Epoch 49, Train Loss 0.467974, Valid_loss 0.402560
Epoch 50, Train Loss 0.467243, Valid_loss 0.404168
Epoch 51, Train Loss 0.465781, Valid_loss 0.400652
Epoch 52, Train Loss 0.465919, Valid_loss 0.399711
Epoch 53, Train Loss 0.464372, Valid_loss 0.401488
Epoch 54, Train Loss 0.464575, Valid_loss 0.399538
Epoch 55, Train Loss 0.463565, Valid_loss 0.397055
Epoch 56, Train Loss 0.463383, Valid_loss 0.399189
Epoch 57, Train Loss 0.462661, Valid_loss 0.396019
Epoch 58, Train Loss 0.461581, Valid_loss 0.396595
Epoch 59, Train Loss 0.461521, Valid_loss 0.396098
Epoch 60, Train Loss 0.460842, Valid_loss 0.395931
Epoch 61, Train Loss 0.460627, Valid_loss 0.394466
Epoch 62, Train Loss 0.459271, Valid_loss 0.393656
Epoch 63, Train Loss 0.458795, Valid_loss 0.395344
Epoch 64, Train Loss 0.458803, Valid_loss 0.392436
Epoch 65, Train Loss 0.458361, Valid_loss 0.392396
Epoch 66, Train Loss 0.457737, Valid_loss 0.391497
Epoch 67, Train Loss 0.456733, Valid_loss 0.390479
Epoch 68, Train Loss 0.455817, Valid_loss 0.391821
Epoch 69, Train Loss 0.455866, Valid_loss 0.389009
Epoch 70, Train Loss 0.455143, Valid_loss 0.388337
Epoch 71, Train Loss 0.455679, Valid_loss 0.389453
Epoch 72, Train Loss 0.454352, Valid_loss 0.385778
Epoch 73, Train Loss 0.453538, Valid_loss 0.387828
Epoch 74, Train Loss 0.454016, Valid_loss 0.383577
Epoch 75, Train Loss 0.453152, Valid_loss 0.385429
Epoch 76, Train Loss 0.452524, Valid_loss 0.384263
Epoch 77, Train Loss 0.451554, Valid_loss 0.383832
Epoch 78, Train Loss 0.451552, Valid_loss 0.384256
Epoch 79, Train Loss 0.450821, Valid_loss 0.382035
Epoch 80, Train Loss 0.450041, Valid_loss 0.382867
Epoch 81, Train Loss 0.449138, Valid_loss 0.381888
Epoch 82, Train Loss 0.448888, Valid_loss 0.380876
Epoch 83, Train Loss 0.449103, Valid_loss 0.380313
Epoch 84, Train Loss 0.448098, Valid_loss 0.378176
Epoch 85, Train Loss 0.447622, Valid_loss 0.379035
Epoch 86, Train Loss 0.447387, Valid_loss 0.376419
Epoch 87, Train Loss 0.446774, Valid_loss 0.378599
Epoch 88, Train Loss 0.445781, Valid_loss 0.377146
Epoch 89, Train Loss 0.445749, Valid_loss 0.376373
Epoch 90, Train Loss 0.445536, Valid_loss 0.373442
Epoch 91, Train Loss 0.444799, Valid_loss 0.376080
Epoch 92, Train Loss 0.444283, Valid_loss 0.375198
Epoch 93, Train Loss 0.443783, Valid_loss 0.374409
Epoch 94, Train Loss 0.443290, Valid_loss 0.372156
Epoch 95, Train Loss 0.443081, Valid_loss 0.373503
Epoch 96, Train Loss 0.442721, Valid_loss 0.373189
Epoch 97, Train Loss 0.442587, Valid_loss 0.368365
Epoch 98, Train Loss 0.440926, Valid_loss 0.370685
Epoch 99, Train Loss 0.441407, Valid_loss 0.371916
COVID19_Participant26 -- true: COVID-19 -- pred: COVID-19
COVID19_Participant13 -- true: COVID-19 -- pred: COVID-19
true :  [1, 1]
pred :  [1, 1]
⚠️ Skipping evaluation due to insufficient class diversity
Confusion Matrix: [2]
Best performance: Epoch 97, Loss 0.442587, Test ACC 1.000000, Test AUC 0.000000, Test Recall 0.000000, Test Precision 0.000000
✅ Total valid splits used: 3
🔁 Repeat 0, Fold 3
🔍 Split #4
  → train_p_index 환자 수: 14
  → test_p_index 환자 수: 5
  → train 환자 ID: ['COVID19_Participant13', 'COVID19_Participant15', 'COVID19_Participant17', 'COVID19_Participant22', 'COVID19_Participant28', 'COVID19_Participant32', 'COVID19_Participant37', 'COVID19_Participant4', 'Control_Participant10', 'Control_Participant11', 'Control_Participant15', 'Control_Participant3', 'Control_Participant7', 'Control_Participant9']
  → test  환자 ID: ['Control_Participant12', 'Control_Participant3', 'Control_Participant7', 'COVID19_Participant11', 'COVID19_Participant13']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: Control_Participant10, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: Control_Participant12, Label: 1
    ID: Control_Participant3, Label: 1
    ID: Control_Participant7, Label: 1
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant13, Label: 0
train_p_index_ 9
valid_p_index 5
test_p_index 5
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Keratinocytes', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Neurons', 'iPS_cells', 'Embryonic_stem_cells', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
data augment 실행 함
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:12,  8.16it/s]  2%|▏         | 2/100 [00:00<00:12,  8.15it/s]  4%|▍         | 4/100 [00:00<00:10,  9.15it/s]  5%|▌         | 5/100 [00:00<00:10,  9.06it/s]  6%|▌         | 6/100 [00:00<00:10,  8.82it/s]  7%|▋         | 7/100 [00:00<00:10,  8.83it/s]  8%|▊         | 8/100 [00:00<00:10,  9.10it/s]  9%|▉         | 9/100 [00:01<00:10,  8.96it/s] 10%|█         | 10/100 [00:01<00:09,  9.05it/s] 11%|█         | 11/100 [00:01<00:09,  9.05it/s] 12%|█▏        | 12/100 [00:01<00:09,  9.04it/s] 13%|█▎        | 13/100 [00:01<00:09,  8.90it/s] 14%|█▍        | 14/100 [00:01<00:09,  8.88it/s] 15%|█▌        | 15/100 [00:01<00:09,  8.75it/s] 16%|█▌        | 16/100 [00:01<00:09,  8.71it/s] 17%|█▋        | 17/100 [00:01<00:09,  8.65it/s] 18%|█▊        | 18/100 [00:02<00:09,  8.66it/s] 19%|█▉        | 19/100 [00:02<00:09,  8.80it/s] 20%|██        | 20/100 [00:02<00:09,  8.82it/s] 21%|██        | 21/100 [00:02<00:09,  8.70it/s] 22%|██▏       | 22/100 [00:02<00:09,  8.50it/s] 23%|██▎       | 23/100 [00:02<00:09,  8.47it/s] 24%|██▍       | 24/100 [00:02<00:09,  8.24it/s] 25%|██▌       | 25/100 [00:02<00:08,  8.59it/s] 26%|██▌       | 26/100 [00:02<00:08,  8.51it/s] 27%|██▋       | 27/100 [00:03<00:09,  7.68it/s] 28%|██▊       | 28/100 [00:03<00:09,  7.81it/s] 29%|██▉       | 29/100 [00:03<00:08,  8.04it/s] 30%|███       | 30/100 [00:03<00:08,  8.20it/s] 31%|███       | 31/100 [00:03<00:08,  8.11it/s] 32%|███▏      | 32/100 [00:03<00:08,  8.05it/s] 33%|███▎      | 33/100 [00:03<00:08,  8.21it/s] 34%|███▍      | 34/100 [00:03<00:07,  8.27it/s] 35%|███▌      | 35/100 [00:04<00:07,  8.40it/s] 36%|███▌      | 36/100 [00:04<00:07,  8.25it/s] 37%|███▋      | 37/100 [00:04<00:07,  8.37it/s] 38%|███▊      | 38/100 [00:04<00:07,  8.48it/s] 39%|███▉      | 39/100 [00:04<00:07,  8.49it/s] 40%|████      | 40/100 [00:04<00:06,  8.58it/s] 41%|████      | 41/100 [00:04<00:06,  8.52it/s] 42%|████▏     | 42/100 [00:04<00:06,  8.59it/s] 43%|████▎     | 43/100 [00:05<00:06,  8.85it/s] 44%|████▍     | 44/100 [00:05<00:06,  8.66it/s] 45%|████▌     | 45/100 [00:05<00:06,  8.62it/s] 46%|████▌     | 46/100 [00:05<00:06,  8.16it/s] 47%|████▋     | 47/100 [00:05<00:06,  8.37it/s] 48%|████▊     | 48/100 [00:05<00:06,  8.31it/s] 49%|████▉     | 49/100 [00:05<00:06,  8.49it/s] 50%|█████     | 50/100 [00:05<00:05,  8.42it/s] 51%|█████     | 51/100 [00:05<00:05,  8.29it/s] 52%|█████▏    | 52/100 [00:06<00:05,  8.23it/s] 53%|█████▎    | 53/100 [00:06<00:05,  8.21it/s] 54%|█████▍    | 54/100 [00:06<00:05,  8.61it/s] 55%|█████▌    | 55/100 [00:06<00:05,  8.39it/s] 56%|█████▌    | 56/100 [00:06<00:05,  8.35it/s] 57%|█████▋    | 57/100 [00:06<00:05,  8.35it/s] 58%|█████▊    | 58/100 [00:06<00:05,  8.19it/s] 59%|█████▉    | 59/100 [00:06<00:05,  7.84it/s] 60%|██████    | 60/100 [00:07<00:04,  8.04it/s] 61%|██████    | 61/100 [00:07<00:05,  7.61it/s] 62%|██████▏   | 62/100 [00:07<00:05,  7.41it/s] 63%|██████▎   | 63/100 [00:07<00:04,  7.47it/s] 64%|██████▍   | 64/100 [00:07<00:04,  7.56it/s] 65%|██████▌   | 65/100 [00:07<00:04,  7.71it/s] 66%|██████▌   | 66/100 [00:07<00:04,  7.69it/s] 67%|██████▋   | 67/100 [00:08<00:04,  7.76it/s] 68%|██████▊   | 68/100 [00:08<00:04,  7.60it/s] 69%|██████▉   | 69/100 [00:08<00:04,  7.68it/s] 70%|███████   | 70/100 [00:08<00:03,  7.85it/s] 71%|███████   | 71/100 [00:08<00:03,  7.78it/s] 72%|███████▏  | 72/100 [00:08<00:03,  7.74it/s] 73%|███████▎  | 73/100 [00:08<00:03,  7.73it/s] 74%|███████▍  | 74/100 [00:08<00:03,  7.69it/s] 75%|███████▌  | 75/100 [00:09<00:03,  7.55it/s] 76%|███████▌  | 76/100 [00:09<00:03,  7.71it/s] 77%|███████▋  | 77/100 [00:09<00:02,  7.68it/s] 78%|███████▊  | 78/100 [00:09<00:02,  8.09it/s] 79%|███████▉  | 79/100 [00:09<00:02,  7.90it/s] 80%|████████  | 80/100 [00:09<00:02,  7.98it/s] 81%|████████  | 81/100 [00:09<00:02,  8.15it/s] 82%|████████▏ | 82/100 [00:09<00:02,  8.11it/s] 83%|████████▎ | 83/100 [00:10<00:02,  8.19it/s] 84%|████████▍ | 84/100 [00:10<00:02,  7.76it/s] 85%|████████▌ | 85/100 [00:10<00:01,  7.79it/s] 86%|████████▌ | 86/100 [00:10<00:01,  8.12it/s] 87%|████████▋ | 87/100 [00:10<00:01,  7.96it/s] 88%|████████▊ | 88/100 [00:10<00:01,  7.75it/s] 89%|████████▉ | 89/100 [00:10<00:01,  7.89it/s] 90%|█████████ | 90/100 [00:10<00:01,  7.81it/s] 91%|█████████ | 91/100 [00:11<00:01,  7.59it/s] 92%|█████████▏| 92/100 [00:11<00:01,  7.76it/s] 93%|█████████▎| 93/100 [00:11<00:00,  7.89it/s] 94%|█████████▍| 94/100 [00:11<00:00,  7.91it/s] 95%|█████████▌| 95/100 [00:11<00:00,  7.84it/s] 96%|█████████▌| 96/100 [00:11<00:00,  7.70it/s] 97%|█████████▋| 97/100 [00:11<00:00,  7.88it/s] 98%|█████████▊| 98/100 [00:11<00:00,  7.80it/s] 99%|█████████▉| 99/100 [00:12<00:00,  7.94it/s]100%|██████████| 100/100 [00:12<00:00,  7.73it/s]100%|██████████| 100/100 [00:12<00:00,  8.17it/s]
eval_p_index len:  10
individual_train 109
individual_eval 10
train data의 x, y, id 길이: 109 109 109
valid data의 x, y, id 길이: 5 5 5
test data의 x, y, id 길이: 5 5 5
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 38.00 MB
cuda
Epoch 1, Train Loss 0.685498, Valid_loss 0.666906
Epoch 2, Train Loss 0.664432, Valid_loss 0.643867
Epoch 3, Train Loss 0.643489, Valid_loss 0.621338
Epoch 4, Train Loss 0.633010, Valid_loss 0.600305
Epoch 5, Train Loss 0.616108, Valid_loss 0.581875
Epoch 6, Train Loss 0.594698, Valid_loss 0.547854
Epoch 7, Train Loss 0.574000, Valid_loss 0.517461
Epoch 8, Train Loss 0.557830, Valid_loss 0.502575
Epoch 9, Train Loss 0.550852, Valid_loss 0.489248
Epoch 10, Train Loss 0.542082, Valid_loss 0.487735
Epoch 11, Train Loss 0.534268, Valid_loss 0.480323
Epoch 12, Train Loss 0.527624, Valid_loss 0.471744
Epoch 13, Train Loss 0.524209, Valid_loss 0.469240
Epoch 14, Train Loss 0.519215, Valid_loss 0.470334
Epoch 15, Train Loss 0.512190, Valid_loss 0.461433
Epoch 16, Train Loss 0.507560, Valid_loss 0.451103
Epoch 17, Train Loss 0.506162, Valid_loss 0.454302
Epoch 18, Train Loss 0.501311, Valid_loss 0.445203
Epoch 19, Train Loss 0.497682, Valid_loss 0.435089
Epoch 20, Train Loss 0.493369, Valid_loss 0.437037
Epoch 21, Train Loss 0.489968, Valid_loss 0.435799
Epoch 22, Train Loss 0.487514, Valid_loss 0.428586
Epoch 23, Train Loss 0.481772, Valid_loss 0.423469
Epoch 24, Train Loss 0.478187, Valid_loss 0.422126
Epoch 25, Train Loss 0.478078, Valid_loss 0.428830
Epoch 26, Train Loss 0.474580, Valid_loss 0.418654
Epoch 27, Train Loss 0.472970, Valid_loss 0.418368
Epoch 28, Train Loss 0.469264, Valid_loss 0.419082
Epoch 29, Train Loss 0.469431, Valid_loss 0.416211
Epoch 30, Train Loss 0.466101, Valid_loss 0.416580
Epoch 31, Train Loss 0.463853, Valid_loss 0.413054
Epoch 32, Train Loss 0.464100, Valid_loss 0.415649
Epoch 33, Train Loss 0.462433, Valid_loss 0.413020
Epoch 34, Train Loss 0.460039, Valid_loss 0.407463
Epoch 35, Train Loss 0.459117, Valid_loss 0.410724
Epoch 36, Train Loss 0.459706, Valid_loss 0.407465
Epoch 37, Train Loss 0.457982, Valid_loss 0.407582
Epoch 38, Train Loss 0.457676, Valid_loss 0.406176
Epoch 39, Train Loss 0.454892, Valid_loss 0.402798
Epoch 40, Train Loss 0.454102, Valid_loss 0.404918
Epoch 41, Train Loss 0.453489, Valid_loss 0.402007
Epoch 42, Train Loss 0.451609, Valid_loss 0.401442
Epoch 43, Train Loss 0.450856, Valid_loss 0.400221
Epoch 44, Train Loss 0.450506, Valid_loss 0.396639
Epoch 45, Train Loss 0.447379, Valid_loss 0.396683
Epoch 46, Train Loss 0.446879, Valid_loss 0.398340
Epoch 47, Train Loss 0.448192, Valid_loss 0.392362
Epoch 48, Train Loss 0.443713, Valid_loss 0.394686
Epoch 49, Train Loss 0.449142, Valid_loss 0.396795
Epoch 50, Train Loss 0.447424, Valid_loss 0.386681
Epoch 51, Train Loss 0.442995, Valid_loss 0.393184
Epoch 52, Train Loss 0.443428, Valid_loss 0.393752
Control_Participant12 -- true: normal -- pred: normal
Control_Participant3 -- true: normal -- pred: normal
Control_Participant7 -- true: normal -- pred: normal
COVID19_Participant11 -- true: COVID-19 -- pred: COVID-19
COVID19_Participant13 -- true: COVID-19 -- pred: COVID-19
true :  [0, 0, 0, 1, 1]
pred :  [0, 0, 0, 1, 1]
Confusion Matrix: [3 0 0 2]
Best performance: Epoch 50, Loss 0.447424, Test ACC 1.000000, Test AUC 1.000000, Test Recall 1.000000, Test Precision 1.000000
✅ Total valid splits used: 4
🔁 Repeat 0, Fold 4
🔍 Split #5
  → train_p_index 환자 수: 14
  → test_p_index 환자 수: 5
  → train 환자 ID: ['COVID19_Participant15', 'COVID19_Participant19', 'COVID19_Participant20', 'COVID19_Participant26', 'COVID19_Participant28', 'COVID19_Participant29', 'COVID19_Participant32', 'COVID19_Participant4', 'Control_Participant11', 'Control_Participant15', 'Control_Participant3', 'Control_Participant5', 'Control_Participant7', 'Control_Participant9']
  → test  환자 ID: ['Control_Participant7', 'Control_Participant5', 'Control_Participant3', 'COVID19_Participant25', 'Control_Participant12']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: Control_Participant11, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: Control_Participant7, Label: 1
    ID: Control_Participant5, Label: 1
    ID: Control_Participant3, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: Control_Participant12, Label: 0
train_p_index_ 9
valid_p_index 5
test_p_index 5
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Keratinocytes', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Neurons', 'iPS_cells', 'Embryonic_stem_cells', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
data augment 실행 함
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:11,  8.70it/s]  2%|▏         | 2/100 [00:00<00:10,  9.01it/s]  3%|▎         | 3/100 [00:00<00:10,  9.14it/s]  4%|▍         | 4/100 [00:00<00:10,  9.01it/s]  5%|▌         | 5/100 [00:00<00:10,  8.87it/s]  6%|▌         | 6/100 [00:00<00:10,  8.71it/s]  7%|▋         | 7/100 [00:00<00:10,  8.71it/s]  8%|▊         | 8/100 [00:00<00:10,  8.81it/s]  9%|▉         | 9/100 [00:01<00:09,  9.13it/s] 10%|█         | 10/100 [00:01<00:10,  8.99it/s] 11%|█         | 11/100 [00:01<00:10,  8.61it/s] 12%|█▏        | 12/100 [00:01<00:10,  8.76it/s] 13%|█▎        | 13/100 [00:01<00:09,  8.73it/s] 14%|█▍        | 14/100 [00:01<00:09,  8.76it/s] 15%|█▌        | 15/100 [00:01<00:09,  8.91it/s] 16%|█▌        | 16/100 [00:01<00:09,  8.87it/s] 17%|█▋        | 17/100 [00:01<00:09,  9.06it/s] 18%|█▊        | 18/100 [00:02<00:09,  8.64it/s] 19%|█▉        | 19/100 [00:02<00:09,  8.68it/s] 20%|██        | 20/100 [00:02<00:09,  8.73it/s] 22%|██▏       | 22/100 [00:02<00:08,  9.01it/s] 23%|██▎       | 23/100 [00:02<00:08,  8.80it/s] 24%|██▍       | 24/100 [00:02<00:08,  8.52it/s] 25%|██▌       | 25/100 [00:02<00:08,  8.48it/s] 26%|██▌       | 26/100 [00:02<00:08,  8.43it/s] 27%|██▋       | 27/100 [00:03<00:08,  8.33it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.17it/s] 29%|██▉       | 29/100 [00:03<00:09,  7.79it/s] 30%|███       | 30/100 [00:03<00:08,  7.83it/s] 31%|███       | 31/100 [00:03<00:08,  7.93it/s] 32%|███▏      | 32/100 [00:03<00:08,  8.13it/s] 33%|███▎      | 33/100 [00:03<00:07,  8.51it/s] 34%|███▍      | 34/100 [00:03<00:07,  8.44it/s] 35%|███▌      | 35/100 [00:04<00:07,  8.36it/s] 36%|███▌      | 36/100 [00:04<00:07,  8.27it/s] 37%|███▋      | 37/100 [00:04<00:07,  8.21it/s] 38%|███▊      | 38/100 [00:04<00:07,  8.15it/s] 39%|███▉      | 39/100 [00:04<00:07,  8.15it/s] 40%|████      | 40/100 [00:04<00:07,  7.94it/s] 41%|████      | 41/100 [00:04<00:07,  7.72it/s] 42%|████▏     | 42/100 [00:04<00:07,  7.79it/s] 43%|████▎     | 43/100 [00:05<00:07,  7.93it/s] 44%|████▍     | 44/100 [00:05<00:06,  8.19it/s] 45%|████▌     | 45/100 [00:05<00:06,  7.94it/s] 46%|████▌     | 46/100 [00:05<00:06,  8.26it/s] 47%|████▋     | 47/100 [00:05<00:06,  8.17it/s] 48%|████▊     | 48/100 [00:05<00:06,  8.32it/s] 49%|████▉     | 49/100 [00:05<00:06,  8.48it/s] 50%|█████     | 50/100 [00:05<00:06,  7.79it/s] 51%|█████     | 51/100 [00:06<00:06,  7.87it/s] 52%|█████▏    | 52/100 [00:06<00:06,  7.83it/s] 53%|█████▎    | 53/100 [00:06<00:05,  7.95it/s] 54%|█████▍    | 54/100 [00:06<00:05,  8.04it/s] 55%|█████▌    | 55/100 [00:06<00:05,  8.22it/s] 56%|█████▌    | 56/100 [00:06<00:05,  7.99it/s] 57%|█████▋    | 57/100 [00:06<00:05,  7.55it/s] 58%|█████▊    | 58/100 [00:06<00:05,  7.89it/s] 59%|█████▉    | 59/100 [00:07<00:05,  7.94it/s] 60%|██████    | 60/100 [00:07<00:05,  7.77it/s] 61%|██████    | 61/100 [00:07<00:05,  7.77it/s] 62%|██████▏   | 62/100 [00:07<00:04,  7.89it/s] 63%|██████▎   | 63/100 [00:07<00:04,  7.84it/s] 64%|██████▍   | 64/100 [00:07<00:04,  7.82it/s] 65%|██████▌   | 65/100 [00:07<00:04,  7.97it/s] 66%|██████▌   | 66/100 [00:07<00:04,  7.95it/s] 67%|██████▋   | 67/100 [00:08<00:04,  7.71it/s] 68%|██████▊   | 68/100 [00:08<00:04,  7.82it/s] 69%|██████▉   | 69/100 [00:08<00:03,  8.09it/s] 70%|███████   | 70/100 [00:08<00:03,  7.98it/s] 71%|███████   | 71/100 [00:08<00:03,  8.17it/s] 72%|███████▏  | 72/100 [00:08<00:03,  8.35it/s] 73%|███████▎  | 73/100 [00:08<00:03,  7.91it/s] 74%|███████▍  | 74/100 [00:09<00:03,  7.31it/s] 75%|███████▌  | 75/100 [00:09<00:03,  7.38it/s] 76%|███████▌  | 76/100 [00:09<00:03,  7.57it/s] 77%|███████▋  | 77/100 [00:09<00:03,  7.33it/s] 78%|███████▊  | 78/100 [00:09<00:02,  7.47it/s] 79%|███████▉  | 79/100 [00:09<00:02,  7.64it/s] 80%|████████  | 80/100 [00:09<00:02,  7.85it/s] 81%|████████  | 81/100 [00:09<00:02,  7.59it/s] 82%|████████▏ | 82/100 [00:10<00:02,  7.79it/s] 83%|████████▎ | 83/100 [00:10<00:02,  8.04it/s] 84%|████████▍ | 84/100 [00:10<00:02,  7.96it/s] 85%|████████▌ | 85/100 [00:10<00:01,  7.73it/s] 86%|████████▌ | 86/100 [00:10<00:01,  7.67it/s] 87%|████████▋ | 87/100 [00:10<00:01,  7.89it/s] 88%|████████▊ | 88/100 [00:10<00:01,  7.87it/s] 89%|████████▉ | 89/100 [00:10<00:01,  7.74it/s] 90%|█████████ | 90/100 [00:11<00:01,  7.63it/s] 91%|█████████ | 91/100 [00:11<00:01,  7.67it/s] 92%|█████████▏| 92/100 [00:11<00:01,  7.59it/s] 93%|█████████▎| 93/100 [00:11<00:00,  7.66it/s] 94%|█████████▍| 94/100 [00:11<00:00,  7.72it/s] 95%|█████████▌| 95/100 [00:11<00:00,  7.54it/s] 96%|█████████▌| 96/100 [00:11<00:00,  7.52it/s] 97%|█████████▋| 97/100 [00:12<00:00,  7.42it/s] 98%|█████████▊| 98/100 [00:12<00:00,  7.43it/s] 99%|█████████▉| 99/100 [00:12<00:00,  7.43it/s]100%|██████████| 100/100 [00:12<00:00,  7.23it/s]100%|██████████| 100/100 [00:12<00:00,  8.05it/s]
eval_p_index len:  10
individual_train 109
individual_eval 10
train data의 x, y, id 길이: 109 109 109
valid data의 x, y, id 길이: 5 5 5
test data의 x, y, id 길이: 5 5 5
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 38.00 MB
cuda
Epoch 1, Train Loss 0.677989, Valid_loss 0.665154
Epoch 2, Train Loss 0.662611, Valid_loss 0.651615
Epoch 3, Train Loss 0.645604, Valid_loss 0.641522
Epoch 4, Train Loss 0.631925, Valid_loss 0.631043
Epoch 5, Train Loss 0.617476, Valid_loss 0.617568
Epoch 6, Train Loss 0.601273, Valid_loss 0.606453
Epoch 7, Train Loss 0.583991, Valid_loss 0.593596
Epoch 8, Train Loss 0.568999, Valid_loss 0.585602
Epoch 9, Train Loss 0.554574, Valid_loss 0.582323
Epoch 10, Train Loss 0.541242, Valid_loss 0.578931
Epoch 11, Train Loss 0.531562, Valid_loss 0.578555
Epoch 12, Train Loss 0.523231, Valid_loss 0.577839
Epoch 13, Train Loss 0.516669, Valid_loss 0.572769
Epoch 14, Train Loss 0.509410, Valid_loss 0.572545
Epoch 15, Train Loss 0.502417, Valid_loss 0.573111
Epoch 16, Train Loss 0.500439, Valid_loss 0.577408
Epoch 17, Train Loss 0.494926, Valid_loss 0.568103
Epoch 18, Train Loss 0.489785, Valid_loss 0.572729
Epoch 19, Train Loss 0.489179, Valid_loss 0.578951
Epoch 20, Train Loss 0.484236, Valid_loss 0.575348
Epoch 21, Train Loss 0.480340, Valid_loss 0.573266
Epoch 22, Train Loss 0.479822, Valid_loss 0.578754
Epoch 23, Train Loss 0.479099, Valid_loss 0.579189
Epoch 24, Train Loss 0.478936, Valid_loss 0.581054
Epoch 25, Train Loss 0.472929, Valid_loss 0.576982
Epoch 26, Train Loss 0.472572, Valid_loss 0.582311
Epoch 27, Train Loss 0.470217, Valid_loss 0.588304
Epoch 28, Train Loss 0.468310, Valid_loss 0.585801
Epoch 29, Train Loss 0.469850, Valid_loss 0.593060
Epoch 30, Train Loss 0.465048, Valid_loss 0.587160
Epoch 31, Train Loss 0.464973, Valid_loss 0.594611
Epoch 32, Train Loss 0.463705, Valid_loss 0.594149
Epoch 33, Train Loss 0.460392, Valid_loss 0.591813
Epoch 34, Train Loss 0.459852, Valid_loss 0.600234
Epoch 35, Train Loss 0.459581, Valid_loss 0.598907
Epoch 36, Train Loss 0.457735, Valid_loss 0.599995
Epoch 37, Train Loss 0.457511, Valid_loss 0.600094
Epoch 38, Train Loss 0.455558, Valid_loss 0.600559
Epoch 39, Train Loss 0.453213, Valid_loss 0.599845
Epoch 40, Train Loss 0.451628, Valid_loss 0.601976
Epoch 41, Train Loss 0.450567, Valid_loss 0.604336
Epoch 42, Train Loss 0.451853, Valid_loss 0.602136
Epoch 43, Train Loss 0.450357, Valid_loss 0.604008
Epoch 44, Train Loss 0.450459, Valid_loss 0.605110
Epoch 45, Train Loss 0.448743, Valid_loss 0.601782
Epoch 46, Train Loss 0.447920, Valid_loss 0.601422
Epoch 47, Train Loss 0.446702, Valid_loss 0.603823
Epoch 48, Train Loss 0.444288, Valid_loss 0.604363
Epoch 49, Train Loss 0.443990, Valid_loss 0.603355
Epoch 50, Train Loss 0.442847, Valid_loss 0.604665
Epoch 51, Train Loss 0.441969, Valid_loss 0.603256
Epoch 52, Train Loss 0.440102, Valid_loss 0.603287
Epoch 53, Train Loss 0.441834, Valid_loss 0.603647
Control_Participant7 -- true: normal -- pred: normal
Control_Participant5 -- true: normal -- pred: normal
Control_Participant3 -- true: normal -- pred: normal
COVID19_Participant25 -- true: COVID-19 -- pred: COVID-19
Control_Participant12 -- true: normal -- pred: COVID-19
true :  [0, 0, 0, 1, 0]
pred :  [0, 0, 0, 1, 1]
Confusion Matrix: [3 1 0 1]
Best performance: Epoch 17, Loss 0.494926, Test ACC 0.800000, Test AUC 0.750000, Test Recall 1.000000, Test Precision 0.500000
✅ Total valid splits used: 5

📌 Repeat 0: 평균 AUC = 0.4833, 표준편차 = 0.4096
🔁 Repeat 1, Fold 0
🔍 Split #1
  → train_p_index 환자 수: 16
  → test_p_index 환자 수: 3
  → train 환자 ID: ['COVID19_Participant13', 'COVID19_Participant15', 'COVID19_Participant17', 'COVID19_Participant19', 'COVID19_Participant20', 'COVID19_Participant22', 'COVID19_Participant26', 'COVID19_Participant28', 'COVID19_Participant29', 'COVID19_Participant32', 'COVID19_Participant4', 'Control_Participant10', 'Control_Participant11', 'Control_Participant15', 'Control_Participant3', 'Control_Participant7']
  → test  환자 ID: ['COVID19_Participant26', 'COVID19_Participant13', 'COVID19_Participant5']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: Control_Participant10, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant7, Label: 0
  → test 환자 ID 및 라벨:
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant13, Label: 0
    ID: COVID19_Participant5, Label: 0
train_p_index_ 10
valid_p_index 6
test_p_index 3
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Keratinocytes', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Neurons', 'iPS_cells', 'Embryonic_stem_cells', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
data augment 실행 함
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:11,  8.77it/s]  2%|▏         | 2/100 [00:00<00:11,  8.45it/s]  3%|▎         | 3/100 [00:00<00:10,  8.85it/s]  4%|▍         | 4/100 [00:00<00:10,  9.12it/s]  5%|▌         | 5/100 [00:00<00:10,  9.13it/s]  6%|▌         | 6/100 [00:00<00:10,  8.83it/s]  8%|▊         | 8/100 [00:00<00:10,  9.12it/s]  9%|▉         | 9/100 [00:00<00:09,  9.17it/s] 10%|█         | 10/100 [00:01<00:10,  8.74it/s] 11%|█         | 11/100 [00:01<00:10,  8.72it/s] 12%|█▏        | 12/100 [00:01<00:10,  8.77it/s] 13%|█▎        | 13/100 [00:01<00:09,  9.06it/s] 14%|█▍        | 14/100 [00:01<00:09,  9.06it/s] 15%|█▌        | 15/100 [00:01<00:09,  9.22it/s] 16%|█▌        | 16/100 [00:01<00:08,  9.37it/s] 17%|█▋        | 17/100 [00:01<00:08,  9.23it/s] 18%|█▊        | 18/100 [00:02<00:09,  8.38it/s] 19%|█▉        | 19/100 [00:02<00:09,  8.53it/s] 20%|██        | 20/100 [00:02<00:09,  8.49it/s] 21%|██        | 21/100 [00:02<00:10,  7.80it/s] 22%|██▏       | 22/100 [00:02<00:09,  8.03it/s] 23%|██▎       | 23/100 [00:02<00:09,  8.14it/s] 24%|██▍       | 24/100 [00:02<00:08,  8.49it/s] 25%|██▌       | 25/100 [00:02<00:08,  8.61it/s] 26%|██▌       | 26/100 [00:02<00:08,  8.72it/s] 27%|██▋       | 27/100 [00:03<00:08,  8.64it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.68it/s] 29%|██▉       | 29/100 [00:03<00:08,  8.55it/s] 30%|███       | 30/100 [00:03<00:08,  8.62it/s] 31%|███       | 31/100 [00:03<00:08,  8.58it/s] 32%|███▏      | 32/100 [00:03<00:08,  8.43it/s] 33%|███▎      | 33/100 [00:03<00:08,  8.25it/s] 34%|███▍      | 34/100 [00:03<00:07,  8.39it/s] 35%|███▌      | 35/100 [00:04<00:07,  8.14it/s] 36%|███▌      | 36/100 [00:04<00:07,  8.29it/s] 37%|███▋      | 37/100 [00:04<00:07,  8.29it/s] 38%|███▊      | 38/100 [00:04<00:07,  8.38it/s] 39%|███▉      | 39/100 [00:04<00:07,  8.31it/s] 40%|████      | 40/100 [00:04<00:07,  8.17it/s] 41%|████      | 41/100 [00:04<00:07,  8.09it/s] 42%|████▏     | 42/100 [00:04<00:07,  7.55it/s] 43%|████▎     | 43/100 [00:05<00:07,  7.84it/s] 44%|████▍     | 44/100 [00:05<00:06,  8.05it/s] 45%|████▌     | 45/100 [00:05<00:06,  8.11it/s] 46%|████▌     | 46/100 [00:05<00:06,  8.07it/s] 47%|████▋     | 47/100 [00:05<00:06,  8.22it/s] 48%|████▊     | 48/100 [00:05<00:06,  7.93it/s] 49%|████▉     | 49/100 [00:05<00:06,  7.86it/s] 50%|█████     | 50/100 [00:05<00:06,  7.66it/s] 51%|█████     | 51/100 [00:06<00:06,  7.75it/s] 52%|█████▏    | 52/100 [00:06<00:06,  7.78it/s] 53%|█████▎    | 53/100 [00:06<00:06,  7.73it/s] 54%|█████▍    | 54/100 [00:06<00:05,  7.86it/s] 55%|█████▌    | 55/100 [00:06<00:05,  7.91it/s] 56%|█████▌    | 56/100 [00:06<00:05,  7.85it/s] 57%|█████▋    | 57/100 [00:06<00:05,  7.87it/s] 58%|█████▊    | 58/100 [00:06<00:05,  8.14it/s] 59%|█████▉    | 59/100 [00:07<00:05,  8.16it/s] 60%|██████    | 60/100 [00:07<00:04,  8.26it/s] 61%|██████    | 61/100 [00:07<00:04,  8.24it/s] 62%|██████▏   | 62/100 [00:07<00:04,  8.38it/s] 63%|██████▎   | 63/100 [00:07<00:04,  8.03it/s] 64%|██████▍   | 64/100 [00:07<00:04,  7.78it/s] 65%|██████▌   | 65/100 [00:07<00:04,  7.84it/s] 66%|██████▌   | 66/100 [00:07<00:04,  7.26it/s] 67%|██████▋   | 67/100 [00:08<00:04,  7.28it/s] 68%|██████▊   | 68/100 [00:08<00:04,  7.42it/s] 69%|██████▉   | 69/100 [00:08<00:04,  7.51it/s] 70%|███████   | 70/100 [00:08<00:03,  7.70it/s] 71%|███████   | 71/100 [00:08<00:03,  8.01it/s] 72%|███████▏  | 72/100 [00:08<00:03,  8.22it/s] 73%|███████▎  | 73/100 [00:08<00:03,  8.01it/s] 74%|███████▍  | 74/100 [00:08<00:03,  7.97it/s] 75%|███████▌  | 75/100 [00:09<00:03,  7.83it/s] 76%|███████▌  | 76/100 [00:09<00:03,  7.98it/s] 77%|███████▋  | 77/100 [00:09<00:02,  8.01it/s] 78%|███████▊  | 78/100 [00:09<00:02,  7.99it/s] 79%|███████▉  | 79/100 [00:09<00:02,  7.97it/s] 80%|████████  | 80/100 [00:09<00:02,  8.20it/s] 81%|████████  | 81/100 [00:09<00:02,  7.64it/s] 82%|████████▏ | 82/100 [00:10<00:02,  7.49it/s] 83%|████████▎ | 83/100 [00:10<00:02,  7.89it/s] 84%|████████▍ | 84/100 [00:10<00:01,  8.20it/s] 85%|████████▌ | 85/100 [00:10<00:01,  8.15it/s] 86%|████████▌ | 86/100 [00:10<00:01,  8.05it/s] 87%|████████▋ | 87/100 [00:10<00:01,  8.00it/s] 88%|████████▊ | 88/100 [00:10<00:01,  7.84it/s] 89%|████████▉ | 89/100 [00:10<00:01,  7.92it/s] 90%|█████████ | 90/100 [00:11<00:01,  7.80it/s] 91%|█████████ | 91/100 [00:11<00:01,  7.54it/s] 92%|█████████▏| 92/100 [00:11<00:01,  7.57it/s] 93%|█████████▎| 93/100 [00:11<00:00,  7.63it/s] 94%|█████████▍| 94/100 [00:11<00:00,  7.60it/s] 95%|█████████▌| 95/100 [00:11<00:00,  7.69it/s] 96%|█████████▌| 96/100 [00:11<00:00,  7.47it/s] 97%|█████████▋| 97/100 [00:11<00:00,  7.42it/s] 98%|█████████▊| 98/100 [00:12<00:00,  7.43it/s] 99%|█████████▉| 99/100 [00:12<00:00,  7.56it/s]100%|██████████| 100/100 [00:12<00:00,  7.45it/s]100%|██████████| 100/100 [00:12<00:00,  8.10it/s]
eval_p_index len:  9
individual_train 110
individual_eval 9
train data의 x, y, id 길이: 110 110 110
valid data의 x, y, id 길이: 6 6 6
test data의 x, y, id 길이: 3 3 3
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 38.00 MB
cuda
Epoch 1, Train Loss 0.709973, Valid_loss 0.700466
Epoch 2, Train Loss 0.694924, Valid_loss 0.685804
Epoch 3, Train Loss 0.681773, Valid_loss 0.677735
Epoch 4, Train Loss 0.668406, Valid_loss 0.664788
Epoch 5, Train Loss 0.655175, Valid_loss 0.650038
Epoch 6, Train Loss 0.643170, Valid_loss 0.644922
Epoch 7, Train Loss 0.632736, Valid_loss 0.639875
Epoch 8, Train Loss 0.626634, Valid_loss 0.630107
Epoch 9, Train Loss 0.617721, Valid_loss 0.628004
Epoch 10, Train Loss 0.604089, Valid_loss 0.613710
Epoch 11, Train Loss 0.583851, Valid_loss 0.593336
Epoch 12, Train Loss 0.566145, Valid_loss 0.580280
Epoch 13, Train Loss 0.547002, Valid_loss 0.572073
Epoch 14, Train Loss 0.526282, Valid_loss 0.555642
Epoch 15, Train Loss 0.506305, Valid_loss 0.545100
Epoch 16, Train Loss 0.490762, Valid_loss 0.542525
Epoch 17, Train Loss 0.474556, Valid_loss 0.541936
Epoch 18, Train Loss 0.466269, Valid_loss 0.562343
Epoch 19, Train Loss 0.458695, Valid_loss 0.573840
Epoch 20, Train Loss 0.453401, Valid_loss 0.578238
Epoch 21, Train Loss 0.450145, Valid_loss 0.576564
Epoch 22, Train Loss 0.447942, Valid_loss 0.576533
Epoch 23, Train Loss 0.444738, Valid_loss 0.578751
Epoch 24, Train Loss 0.441408, Valid_loss 0.578935
Epoch 25, Train Loss 0.440772, Valid_loss 0.580467
Epoch 26, Train Loss 0.439365, Valid_loss 0.578991
Epoch 27, Train Loss 0.437033, Valid_loss 0.576895
Epoch 28, Train Loss 0.436257, Valid_loss 0.577172
Epoch 29, Train Loss 0.435131, Valid_loss 0.577700
Epoch 30, Train Loss 0.433329, Valid_loss 0.575100
Epoch 31, Train Loss 0.432408, Valid_loss 0.578032
Epoch 32, Train Loss 0.431026, Valid_loss 0.576720
Epoch 33, Train Loss 0.430150, Valid_loss 0.572881
Epoch 34, Train Loss 0.427213, Valid_loss 0.574575
Epoch 35, Train Loss 0.426171, Valid_loss 0.572244
Epoch 36, Train Loss 0.426511, Valid_loss 0.568680
Epoch 37, Train Loss 0.425037, Valid_loss 0.570129
Epoch 38, Train Loss 0.424553, Valid_loss 0.565721
Epoch 39, Train Loss 0.422056, Valid_loss 0.573012
Epoch 40, Train Loss 0.421405, Valid_loss 0.568173
Epoch 41, Train Loss 0.421580, Valid_loss 0.564380
Epoch 42, Train Loss 0.420432, Valid_loss 0.567074
Epoch 43, Train Loss 0.419945, Valid_loss 0.567029
Epoch 44, Train Loss 0.420382, Valid_loss 0.565999
Epoch 45, Train Loss 0.420009, Valid_loss 0.564124
Epoch 46, Train Loss 0.418495, Valid_loss 0.566373
Epoch 47, Train Loss 0.417225, Valid_loss 0.566474
Epoch 48, Train Loss 0.417818, Valid_loss 0.562308
Epoch 49, Train Loss 0.416190, Valid_loss 0.565028
Epoch 50, Train Loss 0.415899, Valid_loss 0.564020
Epoch 51, Train Loss 0.414612, Valid_loss 0.564672
Epoch 52, Train Loss 0.414664, Valid_loss 0.563688
Epoch 53, Train Loss 0.415205, Valid_loss 0.564280
Epoch 54, Train Loss 0.413439, Valid_loss 0.561877
Epoch 55, Train Loss 0.413739, Valid_loss 0.565328
Epoch 56, Train Loss 0.412602, Valid_loss 0.564423
Epoch 57, Train Loss 0.412494, Valid_loss 0.564119
Epoch 58, Train Loss 0.411877, Valid_loss 0.562073
Epoch 59, Train Loss 0.412029, Valid_loss 0.563699
Epoch 60, Train Loss 0.412229, Valid_loss 0.563358
Epoch 61, Train Loss 0.411480, Valid_loss 0.562044
Epoch 62, Train Loss 0.412130, Valid_loss 0.563335
Epoch 63, Train Loss 0.410064, Valid_loss 0.563736
COVID19_Participant26 -- true: COVID-19 -- pred: COVID-19
COVID19_Participant13 -- true: COVID-19 -- pred: COVID-19
COVID19_Participant5 -- true: COVID-19 -- pred: COVID-19
true :  [1, 1, 1]
pred :  [1, 1, 1]
⚠️ Skipping evaluation due to insufficient class diversity
Confusion Matrix: [3]
Best performance: Epoch 17, Loss 0.474556, Test ACC 1.000000, Test AUC 0.000000, Test Recall 0.000000, Test Precision 0.000000
✅ Total valid splits used: 1
🔁 Repeat 1, Fold 1
🔍 Split #2
  → train_p_index 환자 수: 12
  → test_p_index 환자 수: 7
  → train 환자 ID: ['COVID19_Participant13', 'COVID19_Participant15', 'COVID19_Participant20', 'COVID19_Participant28', 'COVID19_Participant32', 'COVID19_Participant37', 'COVID19_Participant4', 'Control_Participant10', 'Control_Participant11', 'Control_Participant15', 'Control_Participant5', 'Control_Participant9']
  → test  환자 ID: ['Control_Participant1', 'Control_Participant5', 'COVID19_Participant8', 'COVID19_Participant31', 'Control_Participant10', 'Control_Participant4', 'COVID19_Participant13']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: Control_Participant10, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: Control_Participant1, Label: 1
    ID: Control_Participant5, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: Control_Participant10, Label: 1
    ID: Control_Participant4, Label: 0
    ID: COVID19_Participant13, Label: 0
train_p_index_ 8
valid_p_index 4
test_p_index 7
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Epithelial_cells', 'Platelets', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Keratinocytes', 'Macrophage', 'Epithelial_cells', 'B_cell', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
data augment 실행 함
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  2%|▏         | 2/100 [00:00<00:09, 10.01it/s]  4%|▍         | 4/100 [00:00<00:10,  9.20it/s]  5%|▌         | 5/100 [00:00<00:10,  9.20it/s]  7%|▋         | 7/100 [00:00<00:10,  9.26it/s]  8%|▊         | 8/100 [00:00<00:10,  9.00it/s] 10%|█         | 10/100 [00:01<00:09,  9.30it/s] 12%|█▏        | 12/100 [00:01<00:09,  9.43it/s] 13%|█▎        | 13/100 [00:01<00:09,  9.30it/s] 15%|█▌        | 15/100 [00:01<00:08,  9.71it/s] 16%|█▌        | 16/100 [00:01<00:08,  9.56it/s] 17%|█▋        | 17/100 [00:01<00:08,  9.56it/s] 18%|█▊        | 18/100 [00:01<00:08,  9.40it/s] 19%|█▉        | 19/100 [00:02<00:08,  9.11it/s] 20%|██        | 20/100 [00:02<00:08,  9.18it/s] 21%|██        | 21/100 [00:02<00:08,  9.19it/s] 22%|██▏       | 22/100 [00:02<00:08,  9.07it/s] 23%|██▎       | 23/100 [00:02<00:08,  9.19it/s] 24%|██▍       | 24/100 [00:02<00:08,  9.21it/s] 25%|██▌       | 25/100 [00:02<00:08,  9.01it/s] 26%|██▌       | 26/100 [00:02<00:08,  8.79it/s] 27%|██▋       | 27/100 [00:02<00:08,  8.84it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.70it/s] 29%|██▉       | 29/100 [00:03<00:08,  8.72it/s] 30%|███       | 30/100 [00:03<00:07,  9.01it/s] 31%|███       | 31/100 [00:03<00:07,  8.95it/s] 32%|███▏      | 32/100 [00:03<00:07,  8.83it/s] 33%|███▎      | 33/100 [00:03<00:07,  8.61it/s] 34%|███▍      | 34/100 [00:03<00:07,  8.70it/s] 35%|███▌      | 35/100 [00:03<00:07,  8.64it/s] 36%|███▌      | 36/100 [00:03<00:07,  8.66it/s] 37%|███▋      | 37/100 [00:04<00:07,  8.91it/s] 38%|███▊      | 38/100 [00:04<00:06,  8.98it/s] 39%|███▉      | 39/100 [00:04<00:06,  8.96it/s] 40%|████      | 40/100 [00:04<00:06,  9.02it/s] 41%|████      | 41/100 [00:04<00:06,  8.51it/s] 42%|████▏     | 42/100 [00:04<00:06,  8.38it/s] 43%|████▎     | 43/100 [00:04<00:06,  8.31it/s] 44%|████▍     | 44/100 [00:04<00:06,  8.57it/s] 45%|████▌     | 45/100 [00:04<00:06,  8.68it/s] 46%|████▌     | 46/100 [00:05<00:06,  8.50it/s] 47%|████▋     | 47/100 [00:05<00:06,  8.32it/s] 48%|████▊     | 48/100 [00:05<00:06,  8.33it/s] 49%|████▉     | 49/100 [00:05<00:06,  8.31it/s] 50%|█████     | 50/100 [00:05<00:05,  8.54it/s] 51%|█████     | 51/100 [00:05<00:05,  8.66it/s] 52%|█████▏    | 52/100 [00:05<00:05,  8.39it/s] 53%|█████▎    | 53/100 [00:05<00:05,  8.64it/s] 54%|█████▍    | 54/100 [00:06<00:05,  8.57it/s] 55%|█████▌    | 55/100 [00:06<00:05,  8.58it/s] 56%|█████▌    | 56/100 [00:06<00:05,  8.58it/s] 57%|█████▋    | 57/100 [00:06<00:05,  8.55it/s] 58%|█████▊    | 58/100 [00:06<00:04,  8.61it/s] 59%|█████▉    | 59/100 [00:06<00:04,  8.65it/s] 60%|██████    | 60/100 [00:06<00:04,  8.48it/s] 61%|██████    | 61/100 [00:06<00:04,  8.40it/s] 62%|██████▏   | 62/100 [00:06<00:04,  8.78it/s] 63%|██████▎   | 63/100 [00:07<00:04,  8.76it/s] 64%|██████▍   | 64/100 [00:07<00:04,  8.58it/s] 65%|██████▌   | 65/100 [00:07<00:04,  8.07it/s] 66%|██████▌   | 66/100 [00:07<00:04,  8.02it/s] 67%|██████▋   | 67/100 [00:07<00:04,  7.86it/s] 68%|██████▊   | 68/100 [00:07<00:03,  8.14it/s] 69%|██████▉   | 69/100 [00:07<00:03,  8.37it/s] 70%|███████   | 70/100 [00:07<00:03,  8.43it/s] 71%|███████   | 71/100 [00:08<00:03,  8.42it/s] 72%|███████▏  | 72/100 [00:08<00:03,  8.20it/s] 73%|███████▎  | 73/100 [00:08<00:03,  8.05it/s] 74%|███████▍  | 74/100 [00:08<00:03,  8.09it/s] 75%|███████▌  | 75/100 [00:08<00:03,  8.10it/s] 76%|███████▌  | 76/100 [00:08<00:02,  8.15it/s] 77%|███████▋  | 77/100 [00:08<00:02,  8.20it/s] 78%|███████▊  | 78/100 [00:08<00:02,  8.00it/s] 79%|███████▉  | 79/100 [00:09<00:02,  8.06it/s] 80%|████████  | 80/100 [00:09<00:02,  8.45it/s] 81%|████████  | 81/100 [00:09<00:02,  8.38it/s] 82%|████████▏ | 82/100 [00:09<00:02,  8.25it/s] 83%|████████▎ | 83/100 [00:09<00:02,  8.37it/s] 84%|████████▍ | 84/100 [00:09<00:01,  8.27it/s] 85%|████████▌ | 85/100 [00:09<00:01,  8.19it/s] 86%|████████▌ | 86/100 [00:09<00:01,  8.32it/s] 87%|████████▋ | 87/100 [00:10<00:01,  8.01it/s] 88%|████████▊ | 88/100 [00:10<00:01,  8.02it/s] 89%|████████▉ | 89/100 [00:10<00:01,  8.01it/s] 90%|█████████ | 90/100 [00:10<00:01,  8.10it/s] 91%|█████████ | 91/100 [00:10<00:01,  8.20it/s] 92%|█████████▏| 92/100 [00:10<00:00,  8.32it/s] 93%|█████████▎| 93/100 [00:10<00:00,  8.28it/s] 94%|█████████▍| 94/100 [00:10<00:00,  8.36it/s] 95%|█████████▌| 95/100 [00:11<00:00,  8.33it/s] 96%|█████████▌| 96/100 [00:11<00:00,  8.18it/s] 97%|█████████▋| 97/100 [00:11<00:00,  8.02it/s] 98%|█████████▊| 98/100 [00:11<00:00,  8.14it/s] 99%|█████████▉| 99/100 [00:11<00:00,  7.90it/s]100%|██████████| 100/100 [00:11<00:00,  7.81it/s]100%|██████████| 100/100 [00:11<00:00,  8.58it/s]
eval_p_index len:  11
individual_train 108
individual_eval 11
train data의 x, y, id 길이: 108 108 108
valid data의 x, y, id 길이: 4 4 4
test data의 x, y, id 길이: 7 7 7
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 38.00 MB
cuda
Epoch 1, Train Loss 0.692898, Valid_loss 0.666415
Epoch 2, Train Loss 0.645273, Valid_loss 0.675194
Epoch 3, Train Loss 0.621807, Valid_loss 0.672248
Epoch 4, Train Loss 0.602549, Valid_loss 0.658543
Epoch 5, Train Loss 0.593340, Valid_loss 0.646418
Epoch 6, Train Loss 0.579363, Valid_loss 0.631171
Epoch 7, Train Loss 0.562305, Valid_loss 0.611048
Epoch 8, Train Loss 0.543809, Valid_loss 0.599486
Epoch 9, Train Loss 0.533205, Valid_loss 0.597931
Epoch 10, Train Loss 0.517929, Valid_loss 0.594060
Epoch 11, Train Loss 0.501451, Valid_loss 0.586933
Epoch 12, Train Loss 0.492381, Valid_loss 0.591465
Epoch 13, Train Loss 0.485745, Valid_loss 0.600440
Epoch 14, Train Loss 0.481157, Valid_loss 0.593807
Epoch 15, Train Loss 0.475809, Valid_loss 0.593363
Epoch 16, Train Loss 0.475762, Valid_loss 0.603383
Epoch 17, Train Loss 0.471183, Valid_loss 0.626353
Epoch 18, Train Loss 0.467252, Valid_loss 0.630427
Epoch 19, Train Loss 0.467454, Valid_loss 0.631084
Epoch 20, Train Loss 0.462537, Valid_loss 0.632234
Epoch 21, Train Loss 0.465479, Valid_loss 0.634251
Epoch 22, Train Loss 0.465016, Valid_loss 0.629696
Epoch 23, Train Loss 0.460809, Valid_loss 0.626388
Epoch 24, Train Loss 0.463392, Valid_loss 0.623667
Epoch 25, Train Loss 0.456041, Valid_loss 0.625096
Epoch 26, Train Loss 0.457865, Valid_loss 0.628870
Epoch 27, Train Loss 0.458232, Valid_loss 0.625498
Epoch 28, Train Loss 0.457967, Valid_loss 0.628509
Epoch 29, Train Loss 0.456674, Valid_loss 0.629792
Epoch 30, Train Loss 0.456408, Valid_loss 0.626905
Epoch 31, Train Loss 0.456846, Valid_loss 0.629844
Epoch 32, Train Loss 0.452935, Valid_loss 0.628481
Epoch 33, Train Loss 0.452343, Valid_loss 0.628145
Epoch 34, Train Loss 0.451082, Valid_loss 0.629657
Epoch 35, Train Loss 0.451978, Valid_loss 0.630491
Epoch 36, Train Loss 0.452713, Valid_loss 0.628033
Epoch 37, Train Loss 0.448856, Valid_loss 0.631947
Epoch 38, Train Loss 0.449302, Valid_loss 0.629616
Epoch 39, Train Loss 0.452431, Valid_loss 0.630732
Epoch 40, Train Loss 0.449325, Valid_loss 0.633220
Epoch 41, Train Loss 0.451808, Valid_loss 0.631317
Epoch 42, Train Loss 0.449509, Valid_loss 0.631970
Epoch 43, Train Loss 0.446981, Valid_loss 0.631772
Epoch 44, Train Loss 0.450733, Valid_loss 0.632179
Epoch 45, Train Loss 0.446666, Valid_loss 0.633851
Epoch 46, Train Loss 0.448616, Valid_loss 0.632980
Epoch 47, Train Loss 0.449254, Valid_loss 0.633879
Epoch 48, Train Loss 0.444042, Valid_loss 0.632894
Epoch 49, Train Loss 0.445099, Valid_loss 0.636481
Epoch 50, Train Loss 0.444682, Valid_loss 0.635611
Epoch 51, Train Loss 0.444757, Valid_loss 0.635463
Epoch 52, Train Loss 0.443880, Valid_loss 0.635371
Epoch 53, Train Loss 0.446411, Valid_loss 0.635589
Epoch 54, Train Loss 0.440767, Valid_loss 0.635675
Control_Participant1 -- true: normal -- pred: normal
Control_Participant5 -- true: normal -- pred: COVID-19
COVID19_Participant8 -- true: COVID-19 -- pred: COVID-19
COVID19_Participant31 -- true: COVID-19 -- pred: COVID-19
Control_Participant10 -- true: normal -- pred: normal
Control_Participant4 -- true: normal -- pred: COVID-19
COVID19_Participant13 -- true: COVID-19 -- pred: COVID-19
true :  [0, 0, 1, 1, 0, 0, 1]
pred :  [0, 1, 1, 1, 0, 1, 1]
Confusion Matrix: [2 2 0 3]
Best performance: Epoch 11, Loss 0.501451, Test ACC 0.714286, Test AUC 0.666667, Test Recall 1.000000, Test Precision 0.600000
✅ Total valid splits used: 2
🔁 Repeat 1, Fold 2
🔍 Split #3
  → train_p_index 환자 수: 18
  → test_p_index 환자 수: 1
  → train 환자 ID: ['COVID19_Participant13', 'COVID19_Participant15', 'COVID19_Participant17', 'COVID19_Participant19', 'COVID19_Participant22', 'COVID19_Participant26', 'COVID19_Participant28', 'COVID19_Participant29', 'COVID19_Participant32', 'COVID19_Participant37', 'COVID19_Participant4', 'Control_Participant10', 'Control_Participant11', 'Control_Participant15', 'Control_Participant3', 'Control_Participant5', 'Control_Participant7', 'Control_Participant9']
  → test  환자 ID: ['COVID19_Participant31']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: Control_Participant10, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: COVID19_Participant31, Label: 1
train_p_index_ 12
valid_p_index 6
test_p_index 1
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Keratinocytes', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Neurons', 'iPS_cells', 'Embryonic_stem_cells', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
data augment 실행 함
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:11,  8.29it/s]  2%|▏         | 2/100 [00:00<00:11,  8.66it/s]  3%|▎         | 3/100 [00:00<00:11,  8.55it/s]  4%|▍         | 4/100 [00:00<00:12,  7.92it/s]  5%|▌         | 5/100 [00:00<00:11,  8.27it/s]  6%|▌         | 6/100 [00:00<00:11,  8.47it/s]  7%|▋         | 7/100 [00:00<00:10,  8.57it/s]  8%|▊         | 8/100 [00:00<00:10,  8.65it/s]  9%|▉         | 9/100 [00:01<00:10,  8.73it/s] 10%|█         | 10/100 [00:01<00:10,  8.77it/s] 11%|█         | 11/100 [00:01<00:10,  8.51it/s] 12%|█▏        | 12/100 [00:01<00:10,  8.56it/s] 13%|█▎        | 13/100 [00:01<00:10,  8.42it/s] 14%|█▍        | 14/100 [00:01<00:10,  8.46it/s] 15%|█▌        | 15/100 [00:01<00:09,  8.57it/s] 16%|█▌        | 16/100 [00:01<00:09,  8.59it/s] 17%|█▋        | 17/100 [00:02<00:09,  8.42it/s] 18%|█▊        | 18/100 [00:02<00:09,  8.27it/s] 19%|█▉        | 19/100 [00:02<00:09,  8.47it/s] 20%|██        | 20/100 [00:02<00:09,  8.55it/s] 21%|██        | 21/100 [00:02<00:09,  8.54it/s] 22%|██▏       | 22/100 [00:02<00:09,  8.58it/s] 23%|██▎       | 23/100 [00:02<00:09,  8.40it/s] 24%|██▍       | 24/100 [00:02<00:09,  8.04it/s] 25%|██▌       | 25/100 [00:02<00:09,  8.15it/s] 26%|██▌       | 26/100 [00:03<00:08,  8.25it/s] 27%|██▋       | 27/100 [00:03<00:08,  8.25it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.25it/s] 29%|██▉       | 29/100 [00:03<00:08,  7.99it/s] 30%|███       | 30/100 [00:03<00:08,  8.05it/s] 31%|███       | 31/100 [00:03<00:08,  8.23it/s] 32%|███▏      | 32/100 [00:03<00:08,  8.08it/s] 33%|███▎      | 33/100 [00:03<00:08,  7.86it/s] 34%|███▍      | 34/100 [00:04<00:08,  8.07it/s] 35%|███▌      | 35/100 [00:04<00:08,  7.88it/s] 36%|███▌      | 36/100 [00:04<00:08,  7.50it/s] 37%|███▋      | 37/100 [00:04<00:08,  7.64it/s] 38%|███▊      | 38/100 [00:04<00:08,  7.62it/s] 39%|███▉      | 39/100 [00:04<00:07,  7.82it/s] 40%|████      | 40/100 [00:04<00:07,  7.98it/s] 41%|████      | 41/100 [00:04<00:07,  7.94it/s] 42%|████▏     | 42/100 [00:05<00:07,  8.10it/s] 43%|████▎     | 43/100 [00:05<00:07,  7.97it/s] 44%|████▍     | 44/100 [00:05<00:06,  8.12it/s] 45%|████▌     | 45/100 [00:05<00:07,  7.75it/s] 46%|████▌     | 46/100 [00:05<00:07,  7.65it/s] 47%|████▋     | 47/100 [00:05<00:07,  7.49it/s] 48%|████▊     | 48/100 [00:05<00:06,  7.52it/s] 49%|████▉     | 49/100 [00:06<00:06,  7.60it/s] 50%|█████     | 50/100 [00:06<00:06,  7.89it/s] 51%|█████     | 51/100 [00:06<00:06,  7.83it/s] 52%|█████▏    | 52/100 [00:06<00:06,  7.67it/s] 53%|█████▎    | 53/100 [00:06<00:06,  7.81it/s] 54%|█████▍    | 54/100 [00:06<00:06,  7.59it/s] 55%|█████▌    | 55/100 [00:06<00:05,  7.82it/s] 56%|█████▌    | 56/100 [00:06<00:05,  7.84it/s] 57%|█████▋    | 57/100 [00:07<00:05,  7.83it/s] 58%|█████▊    | 58/100 [00:07<00:05,  7.93it/s] 59%|█████▉    | 59/100 [00:07<00:05,  7.25it/s] 60%|██████    | 60/100 [00:07<00:05,  7.57it/s] 61%|██████    | 61/100 [00:07<00:04,  7.96it/s] 62%|██████▏   | 62/100 [00:07<00:04,  7.89it/s] 63%|██████▎   | 63/100 [00:07<00:04,  7.76it/s] 64%|██████▍   | 64/100 [00:07<00:04,  7.53it/s] 65%|██████▌   | 65/100 [00:08<00:04,  7.53it/s] 66%|██████▌   | 66/100 [00:08<00:04,  7.52it/s] 67%|██████▋   | 67/100 [00:08<00:04,  7.58it/s] 68%|██████▊   | 68/100 [00:08<00:04,  7.70it/s] 69%|██████▉   | 69/100 [00:08<00:03,  7.86it/s] 70%|███████   | 70/100 [00:08<00:03,  7.69it/s] 71%|███████   | 71/100 [00:08<00:03,  7.91it/s] 72%|███████▏  | 72/100 [00:09<00:03,  7.65it/s] 73%|███████▎  | 73/100 [00:09<00:03,  7.70it/s] 74%|███████▍  | 74/100 [00:09<00:03,  7.62it/s] 75%|███████▌  | 75/100 [00:09<00:03,  7.56it/s] 76%|███████▌  | 76/100 [00:09<00:03,  7.03it/s] 77%|███████▋  | 77/100 [00:09<00:03,  6.70it/s] 78%|███████▊  | 78/100 [00:09<00:03,  7.01it/s] 79%|███████▉  | 79/100 [00:09<00:02,  7.17it/s] 80%|████████  | 80/100 [00:10<00:02,  7.28it/s] 81%|████████  | 81/100 [00:10<00:02,  7.46it/s] 82%|████████▏ | 82/100 [00:10<00:02,  7.46it/s] 83%|████████▎ | 83/100 [00:10<00:02,  7.54it/s] 84%|████████▍ | 84/100 [00:10<00:02,  7.32it/s] 85%|████████▌ | 85/100 [00:10<00:02,  7.40it/s] 86%|████████▌ | 86/100 [00:10<00:01,  7.26it/s] 87%|████████▋ | 87/100 [00:11<00:01,  7.46it/s] 88%|████████▊ | 88/100 [00:11<00:01,  7.01it/s] 89%|████████▉ | 89/100 [00:11<00:01,  7.07it/s] 90%|█████████ | 90/100 [00:11<00:01,  7.48it/s] 91%|█████████ | 91/100 [00:11<00:01,  7.44it/s] 92%|█████████▏| 92/100 [00:11<00:01,  7.52it/s] 93%|█████████▎| 93/100 [00:11<00:00,  7.50it/s] 94%|█████████▍| 94/100 [00:12<00:00,  7.17it/s] 95%|█████████▌| 95/100 [00:12<00:00,  7.22it/s] 96%|█████████▌| 96/100 [00:12<00:00,  7.33it/s] 97%|█████████▋| 97/100 [00:12<00:00,  7.37it/s] 98%|█████████▊| 98/100 [00:12<00:00,  7.43it/s] 99%|█████████▉| 99/100 [00:12<00:00,  7.51it/s]100%|██████████| 100/100 [00:12<00:00,  7.63it/s]100%|██████████| 100/100 [00:12<00:00,  7.80it/s]
eval_p_index len:  7
individual_train 112
individual_eval 7
train data의 x, y, id 길이: 112 112 112
valid data의 x, y, id 길이: 6 6 6
test data의 x, y, id 길이: 1 1 1
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 38.00 MB
cuda
Epoch 1, Train Loss 0.614339, Valid_loss 0.699028
Epoch 2, Train Loss 0.590289, Valid_loss 0.715770
Epoch 3, Train Loss 0.579563, Valid_loss 0.691327
Epoch 4, Train Loss 0.573028, Valid_loss 0.685697
Epoch 5, Train Loss 0.569202, Valid_loss 0.676243
Epoch 6, Train Loss 0.565405, Valid_loss 0.671247
Epoch 7, Train Loss 0.562590, Valid_loss 0.664552
Epoch 8, Train Loss 0.559832, Valid_loss 0.657597
Epoch 9, Train Loss 0.557089, Valid_loss 0.655125
Epoch 10, Train Loss 0.554274, Valid_loss 0.649756
Epoch 11, Train Loss 0.551738, Valid_loss 0.642321
Epoch 12, Train Loss 0.548401, Valid_loss 0.637630
Epoch 13, Train Loss 0.545490, Valid_loss 0.628017
Epoch 14, Train Loss 0.542111, Valid_loss 0.621781
Epoch 15, Train Loss 0.537861, Valid_loss 0.611005
Epoch 16, Train Loss 0.531557, Valid_loss 0.595156
Epoch 17, Train Loss 0.523867, Valid_loss 0.576367
Epoch 18, Train Loss 0.516107, Valid_loss 0.558216
Epoch 19, Train Loss 0.508688, Valid_loss 0.535981
Epoch 20, Train Loss 0.500306, Valid_loss 0.515225
Epoch 21, Train Loss 0.491878, Valid_loss 0.488526
Epoch 22, Train Loss 0.485755, Valid_loss 0.476619
Epoch 23, Train Loss 0.481046, Valid_loss 0.467118
Epoch 24, Train Loss 0.477650, Valid_loss 0.457994
Epoch 25, Train Loss 0.475353, Valid_loss 0.451134
Epoch 26, Train Loss 0.473089, Valid_loss 0.441434
Epoch 27, Train Loss 0.471535, Valid_loss 0.438688
Epoch 28, Train Loss 0.469709, Valid_loss 0.439969
Epoch 29, Train Loss 0.468230, Valid_loss 0.434094
Epoch 30, Train Loss 0.466782, Valid_loss 0.429820
Epoch 31, Train Loss 0.465364, Valid_loss 0.431505
Epoch 32, Train Loss 0.464060, Valid_loss 0.431076
Epoch 33, Train Loss 0.462723, Valid_loss 0.426339
Epoch 34, Train Loss 0.461331, Valid_loss 0.426560
Epoch 35, Train Loss 0.459907, Valid_loss 0.426882
Epoch 36, Train Loss 0.458810, Valid_loss 0.432249
Epoch 37, Train Loss 0.457099, Valid_loss 0.422948
Epoch 38, Train Loss 0.455857, Valid_loss 0.422372
Epoch 39, Train Loss 0.454289, Valid_loss 0.423653
Epoch 40, Train Loss 0.453048, Valid_loss 0.426714
Epoch 41, Train Loss 0.451711, Valid_loss 0.419300
Epoch 42, Train Loss 0.450384, Valid_loss 0.424785
Epoch 43, Train Loss 0.448850, Valid_loss 0.421416
Epoch 44, Train Loss 0.447619, Valid_loss 0.419808
Epoch 45, Train Loss 0.446445, Valid_loss 0.419078
Epoch 46, Train Loss 0.445404, Valid_loss 0.418578
Epoch 47, Train Loss 0.444349, Valid_loss 0.419204
Epoch 48, Train Loss 0.443377, Valid_loss 0.417184
Epoch 49, Train Loss 0.442420, Valid_loss 0.417079
Epoch 50, Train Loss 0.441527, Valid_loss 0.417507
Epoch 51, Train Loss 0.440683, Valid_loss 0.416986
Epoch 52, Train Loss 0.440204, Valid_loss 0.418113
Epoch 53, Train Loss 0.439806, Valid_loss 0.416635
Epoch 54, Train Loss 0.439330, Valid_loss 0.417548
Epoch 55, Train Loss 0.438944, Valid_loss 0.414424
Epoch 56, Train Loss 0.438434, Valid_loss 0.417504
Epoch 57, Train Loss 0.438044, Valid_loss 0.414747
Epoch 58, Train Loss 0.437524, Valid_loss 0.416407
Epoch 59, Train Loss 0.437114, Valid_loss 0.417171
COVID19_Participant31 -- true: COVID-19 -- pred: COVID-19
true :  [1]
pred :  [1]
⚠️ Skipping evaluation due to insufficient class diversity
Confusion Matrix: [1]
Best performance: Epoch 55, Loss 0.438944, Test ACC 1.000000, Test AUC 0.000000, Test Recall 0.000000, Test Precision 0.000000
✅ Total valid splits used: 3
🔁 Repeat 1, Fold 3
🔍 Split #4
  → train_p_index 환자 수: 15
  → test_p_index 환자 수: 4
  → train 환자 ID: ['COVID19_Participant15', 'COVID19_Participant17', 'COVID19_Participant19', 'COVID19_Participant20', 'COVID19_Participant22', 'COVID19_Participant26', 'COVID19_Participant29', 'COVID19_Participant32', 'COVID19_Participant37', 'Control_Participant10', 'Control_Participant11', 'Control_Participant3', 'Control_Participant5', 'Control_Participant7', 'Control_Participant9']
  → test  환자 ID: ['Control_Participant7', 'COVID19_Participant26', 'Control_Participant5', 'Control_Participant3']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: Control_Participant10, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: Control_Participant7, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: Control_Participant5, Label: 1
    ID: Control_Participant3, Label: 0
train_p_index_ 10
valid_p_index 5
test_p_index 4
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Keratinocytes', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Neurons', 'iPS_cells', 'Embryonic_stem_cells', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
data augment 실행 함
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:10,  9.04it/s]  2%|▏         | 2/100 [00:00<00:10,  9.23it/s]  3%|▎         | 3/100 [00:00<00:10,  9.22it/s]  4%|▍         | 4/100 [00:00<00:10,  9.14it/s]  5%|▌         | 5/100 [00:00<00:10,  9.01it/s]  6%|▌         | 6/100 [00:00<00:10,  9.02it/s]  7%|▋         | 7/100 [00:00<00:10,  9.00it/s]  8%|▊         | 8/100 [00:00<00:10,  9.01it/s]  9%|▉         | 9/100 [00:00<00:09,  9.11it/s] 10%|█         | 10/100 [00:01<00:09,  9.04it/s] 11%|█         | 11/100 [00:01<00:09,  8.91it/s] 12%|█▏        | 12/100 [00:01<00:10,  8.68it/s] 13%|█▎        | 13/100 [00:01<00:09,  8.73it/s] 14%|█▍        | 14/100 [00:01<00:09,  8.72it/s] 15%|█▌        | 15/100 [00:01<00:09,  8.86it/s] 16%|█▌        | 16/100 [00:01<00:09,  8.73it/s] 17%|█▋        | 17/100 [00:01<00:09,  8.63it/s] 18%|█▊        | 18/100 [00:02<00:09,  8.77it/s] 19%|█▉        | 19/100 [00:02<00:09,  8.88it/s] 20%|██        | 20/100 [00:02<00:09,  8.83it/s] 21%|██        | 21/100 [00:02<00:08,  9.02it/s] 22%|██▏       | 22/100 [00:02<00:08,  8.81it/s] 23%|██▎       | 23/100 [00:02<00:08,  8.81it/s] 24%|██▍       | 24/100 [00:02<00:08,  8.75it/s] 25%|██▌       | 25/100 [00:02<00:08,  8.75it/s] 26%|██▌       | 26/100 [00:02<00:08,  8.67it/s] 27%|██▋       | 27/100 [00:03<00:08,  8.69it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.54it/s] 29%|██▉       | 29/100 [00:03<00:08,  8.49it/s] 30%|███       | 30/100 [00:03<00:08,  8.40it/s] 31%|███       | 31/100 [00:03<00:08,  8.48it/s] 32%|███▏      | 32/100 [00:03<00:08,  8.47it/s] 33%|███▎      | 33/100 [00:03<00:07,  8.63it/s] 34%|███▍      | 34/100 [00:03<00:07,  8.61it/s] 35%|███▌      | 35/100 [00:03<00:07,  8.49it/s] 36%|███▌      | 36/100 [00:04<00:07,  8.58it/s] 37%|███▋      | 37/100 [00:04<00:07,  8.60it/s] 38%|███▊      | 38/100 [00:04<00:07,  8.65it/s] 39%|███▉      | 39/100 [00:04<00:07,  8.63it/s] 40%|████      | 40/100 [00:04<00:07,  8.48it/s] 41%|████      | 41/100 [00:04<00:06,  8.48it/s] 42%|████▏     | 42/100 [00:04<00:06,  8.45it/s] 43%|████▎     | 43/100 [00:04<00:06,  8.51it/s] 44%|████▍     | 44/100 [00:05<00:06,  8.27it/s] 45%|████▌     | 45/100 [00:05<00:06,  8.21it/s] 46%|████▌     | 46/100 [00:05<00:06,  8.26it/s] 47%|████▋     | 47/100 [00:05<00:06,  8.27it/s] 48%|████▊     | 48/100 [00:05<00:06,  8.22it/s] 49%|████▉     | 49/100 [00:05<00:06,  8.21it/s] 50%|█████     | 50/100 [00:05<00:06,  8.21it/s] 51%|█████     | 51/100 [00:05<00:05,  8.19it/s] 52%|█████▏    | 52/100 [00:06<00:05,  8.04it/s] 53%|█████▎    | 53/100 [00:06<00:05,  8.34it/s] 54%|█████▍    | 54/100 [00:06<00:05,  8.29it/s] 55%|█████▌    | 55/100 [00:06<00:05,  8.29it/s] 56%|█████▌    | 56/100 [00:06<00:05,  8.30it/s] 57%|█████▋    | 57/100 [00:06<00:05,  8.43it/s] 58%|█████▊    | 58/100 [00:06<00:04,  8.54it/s] 59%|█████▉    | 59/100 [00:06<00:04,  8.31it/s] 60%|██████    | 60/100 [00:06<00:04,  8.20it/s] 61%|██████    | 61/100 [00:07<00:04,  8.21it/s] 62%|██████▏   | 62/100 [00:07<00:04,  8.14it/s] 63%|██████▎   | 63/100 [00:07<00:04,  8.07it/s] 64%|██████▍   | 64/100 [00:07<00:04,  8.03it/s] 65%|██████▌   | 65/100 [00:07<00:04,  8.09it/s] 66%|██████▌   | 66/100 [00:07<00:04,  8.12it/s] 67%|██████▋   | 67/100 [00:07<00:04,  8.10it/s] 68%|██████▊   | 68/100 [00:07<00:04,  7.93it/s] 69%|██████▉   | 69/100 [00:08<00:03,  8.03it/s] 70%|███████   | 70/100 [00:08<00:03,  8.05it/s] 71%|███████   | 71/100 [00:08<00:03,  8.15it/s] 72%|███████▏  | 72/100 [00:08<00:03,  8.06it/s] 73%|███████▎  | 73/100 [00:08<00:03,  7.99it/s] 74%|███████▍  | 74/100 [00:08<00:03,  7.83it/s] 75%|███████▌  | 75/100 [00:08<00:03,  7.91it/s] 76%|███████▌  | 76/100 [00:08<00:03,  7.96it/s] 77%|███████▋  | 77/100 [00:09<00:02,  7.89it/s] 78%|███████▊  | 78/100 [00:09<00:02,  7.90it/s] 79%|███████▉  | 79/100 [00:09<00:02,  7.79it/s] 80%|████████  | 80/100 [00:09<00:02,  7.73it/s] 81%|████████  | 81/100 [00:09<00:02,  7.81it/s] 82%|████████▏ | 82/100 [00:09<00:02,  7.90it/s] 83%|████████▎ | 83/100 [00:09<00:02,  8.04it/s] 84%|████████▍ | 84/100 [00:10<00:02,  7.98it/s] 85%|████████▌ | 85/100 [00:10<00:01,  7.97it/s] 86%|████████▌ | 86/100 [00:10<00:01,  7.98it/s] 87%|████████▋ | 87/100 [00:10<00:01,  7.96it/s] 88%|████████▊ | 88/100 [00:10<00:01,  7.98it/s] 89%|████████▉ | 89/100 [00:10<00:01,  7.98it/s] 90%|█████████ | 90/100 [00:10<00:01,  7.83it/s] 91%|█████████ | 91/100 [00:10<00:01,  7.86it/s] 92%|█████████▏| 92/100 [00:11<00:01,  7.67it/s] 93%|█████████▎| 93/100 [00:11<00:00,  7.75it/s] 94%|█████████▍| 94/100 [00:11<00:00,  7.73it/s] 95%|█████████▌| 95/100 [00:11<00:00,  7.66it/s] 96%|█████████▌| 96/100 [00:11<00:00,  7.58it/s] 97%|█████████▋| 97/100 [00:11<00:00,  7.64it/s] 98%|█████████▊| 98/100 [00:11<00:00,  7.72it/s] 99%|█████████▉| 99/100 [00:11<00:00,  7.74it/s]100%|██████████| 100/100 [00:12<00:00,  7.70it/s]100%|██████████| 100/100 [00:12<00:00,  8.28it/s]
eval_p_index len:  9
individual_train 110
individual_eval 9
train data의 x, y, id 길이: 110 110 110
valid data의 x, y, id 길이: 5 5 5
test data의 x, y, id 길이: 4 4 4
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 38.00 MB
cuda
Epoch 1, Train Loss 0.700952, Valid_loss 0.640611
Epoch 2, Train Loss 0.693227, Valid_loss 0.638573
Epoch 3, Train Loss 0.686528, Valid_loss 0.641476
Epoch 4, Train Loss 0.679375, Valid_loss 0.640229
Epoch 5, Train Loss 0.669978, Valid_loss 0.638099
Epoch 6, Train Loss 0.650487, Valid_loss 0.653450
Epoch 7, Train Loss 0.628350, Valid_loss 0.669889
Epoch 8, Train Loss 0.603527, Valid_loss 0.629310
Epoch 9, Train Loss 0.572032, Valid_loss 0.549532
Epoch 10, Train Loss 0.535641, Valid_loss 0.511005
Epoch 11, Train Loss 0.510720, Valid_loss 0.532062
Epoch 12, Train Loss 0.492728, Valid_loss 0.544184
Epoch 13, Train Loss 0.483221, Valid_loss 0.530139
Epoch 14, Train Loss 0.474609, Valid_loss 0.526164
Epoch 15, Train Loss 0.467714, Valid_loss 0.530225
Epoch 16, Train Loss 0.462846, Valid_loss 0.518711
Epoch 17, Train Loss 0.457553, Valid_loss 0.522958
Epoch 18, Train Loss 0.453633, Valid_loss 0.524421
Epoch 19, Train Loss 0.450454, Valid_loss 0.513394
Epoch 20, Train Loss 0.447757, Valid_loss 0.519350
Epoch 21, Train Loss 0.445221, Valid_loss 0.512313
Epoch 22, Train Loss 0.443098, Valid_loss 0.514155
Epoch 23, Train Loss 0.441675, Valid_loss 0.513411
Epoch 24, Train Loss 0.438522, Valid_loss 0.514497
Epoch 25, Train Loss 0.436859, Valid_loss 0.508321
Epoch 26, Train Loss 0.438924, Valid_loss 0.511197
Epoch 27, Train Loss 0.435808, Valid_loss 0.507961
Epoch 28, Train Loss 0.435646, Valid_loss 0.504407
Epoch 29, Train Loss 0.432643, Valid_loss 0.508649
Epoch 30, Train Loss 0.432883, Valid_loss 0.511070
Epoch 31, Train Loss 0.431606, Valid_loss 0.500869
Epoch 32, Train Loss 0.433302, Valid_loss 0.504792
Epoch 33, Train Loss 0.431157, Valid_loss 0.507247
Epoch 34, Train Loss 0.429629, Valid_loss 0.498963
Epoch 35, Train Loss 0.428944, Valid_loss 0.504551
Epoch 36, Train Loss 0.427545, Valid_loss 0.502674
Epoch 37, Train Loss 0.426577, Valid_loss 0.500773
Epoch 38, Train Loss 0.427829, Valid_loss 0.503266
Epoch 39, Train Loss 0.425236, Valid_loss 0.499348
Epoch 40, Train Loss 0.423514, Valid_loss 0.497062
Epoch 41, Train Loss 0.423283, Valid_loss 0.501358
Epoch 42, Train Loss 0.422427, Valid_loss 0.496832
Epoch 43, Train Loss 0.420613, Valid_loss 0.497142
Epoch 44, Train Loss 0.420508, Valid_loss 0.495172
Epoch 45, Train Loss 0.419524, Valid_loss 0.494638
Epoch 46, Train Loss 0.419908, Valid_loss 0.494755
Epoch 47, Train Loss 0.418663, Valid_loss 0.489350
Epoch 48, Train Loss 0.418391, Valid_loss 0.492083
Epoch 49, Train Loss 0.417318, Valid_loss 0.490803
Epoch 50, Train Loss 0.416305, Valid_loss 0.487917
Epoch 51, Train Loss 0.414979, Valid_loss 0.482793
Epoch 52, Train Loss 0.415985, Valid_loss 0.485770
Epoch 53, Train Loss 0.413759, Valid_loss 0.486420
Control_Participant7 -- true: normal -- pred: normal
COVID19_Participant26 -- true: COVID-19 -- pred: COVID-19
Control_Participant5 -- true: normal -- pred: normal
Control_Participant3 -- true: normal -- pred: normal
true :  [0, 1, 0, 0]
pred :  [0, 1, 0, 0]
Confusion Matrix: [3 0 0 1]
Best performance: Epoch 51, Loss 0.414979, Test ACC 1.000000, Test AUC 1.000000, Test Recall 1.000000, Test Precision 1.000000
✅ Total valid splits used: 4
🔁 Repeat 1, Fold 4
🔍 Split #5
  → train_p_index 환자 수: 15
  → test_p_index 환자 수: 4
  → train 환자 ID: ['COVID19_Participant13', 'COVID19_Participant17', 'COVID19_Participant19', 'COVID19_Participant20', 'COVID19_Participant22', 'COVID19_Participant26', 'COVID19_Participant28', 'COVID19_Participant29', 'COVID19_Participant37', 'COVID19_Participant4', 'Control_Participant15', 'Control_Participant3', 'Control_Participant5', 'Control_Participant7', 'Control_Participant9']
  → test  환자 ID: ['COVID19_Participant11', 'COVID19_Participant25', 'Control_Participant7', 'COVID19_Participant26']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: Control_Participant15, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: Control_Participant7, Label: 0
    ID: COVID19_Participant26, Label: 0
train_p_index_ 10
valid_p_index 5
test_p_index 4
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Keratinocytes', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Neurons', 'iPS_cells', 'Embryonic_stem_cells', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
data augment 실행 함
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:11,  8.42it/s]  2%|▏         | 2/100 [00:00<00:10,  8.92it/s]  3%|▎         | 3/100 [00:00<00:10,  9.04it/s]  4%|▍         | 4/100 [00:00<00:10,  8.97it/s]  5%|▌         | 5/100 [00:00<00:10,  9.00it/s]  6%|▌         | 6/100 [00:00<00:10,  9.11it/s]  7%|▋         | 7/100 [00:00<00:10,  8.92it/s]  8%|▊         | 8/100 [00:00<00:10,  8.85it/s]  9%|▉         | 9/100 [00:01<00:10,  8.53it/s] 10%|█         | 10/100 [00:01<00:11,  7.99it/s] 11%|█         | 11/100 [00:01<00:11,  7.80it/s] 12%|█▏        | 12/100 [00:01<00:11,  7.92it/s] 13%|█▎        | 13/100 [00:01<00:10,  8.03it/s] 14%|█▍        | 14/100 [00:01<00:11,  7.78it/s] 15%|█▌        | 15/100 [00:01<00:10,  7.97it/s] 16%|█▌        | 16/100 [00:01<00:10,  8.32it/s] 17%|█▋        | 17/100 [00:02<00:10,  8.24it/s] 18%|█▊        | 18/100 [00:02<00:09,  8.21it/s] 19%|█▉        | 19/100 [00:02<00:09,  8.35it/s] 20%|██        | 20/100 [00:02<00:09,  8.16it/s] 21%|██        | 21/100 [00:02<00:10,  7.61it/s] 22%|██▏       | 22/100 [00:02<00:10,  7.67it/s] 23%|██▎       | 23/100 [00:02<00:09,  7.95it/s] 24%|██▍       | 24/100 [00:02<00:09,  7.98it/s] 25%|██▌       | 25/100 [00:03<00:09,  7.87it/s] 26%|██▌       | 26/100 [00:03<00:09,  7.99it/s] 27%|██▋       | 27/100 [00:03<00:09,  7.99it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.01it/s] 29%|██▉       | 29/100 [00:03<00:08,  8.02it/s] 30%|███       | 30/100 [00:03<00:08,  8.17it/s] 31%|███       | 31/100 [00:03<00:08,  8.12it/s] 32%|███▏      | 32/100 [00:03<00:08,  7.99it/s] 33%|███▎      | 33/100 [00:04<00:08,  7.96it/s] 34%|███▍      | 34/100 [00:04<00:08,  7.99it/s] 35%|███▌      | 35/100 [00:04<00:08,  8.11it/s] 36%|███▌      | 36/100 [00:04<00:07,  8.34it/s] 37%|███▋      | 37/100 [00:04<00:07,  8.70it/s] 38%|███▊      | 38/100 [00:04<00:07,  8.60it/s] 39%|███▉      | 39/100 [00:04<00:07,  8.04it/s] 40%|████      | 40/100 [00:04<00:07,  7.84it/s] 41%|████      | 41/100 [00:05<00:07,  7.91it/s] 42%|████▏     | 42/100 [00:05<00:07,  7.97it/s] 43%|████▎     | 43/100 [00:05<00:07,  8.14it/s] 44%|████▍     | 44/100 [00:05<00:06,  8.04it/s] 45%|████▌     | 45/100 [00:05<00:07,  7.85it/s] 46%|████▌     | 46/100 [00:05<00:06,  7.87it/s] 47%|████▋     | 47/100 [00:05<00:06,  7.98it/s] 48%|████▊     | 48/100 [00:05<00:06,  8.01it/s] 49%|████▉     | 49/100 [00:06<00:06,  8.12it/s] 50%|█████     | 50/100 [00:06<00:06,  8.20it/s] 51%|█████     | 51/100 [00:06<00:05,  8.17it/s] 52%|█████▏    | 52/100 [00:06<00:06,  7.87it/s] 53%|█████▎    | 53/100 [00:06<00:05,  7.99it/s] 54%|█████▍    | 54/100 [00:06<00:05,  7.82it/s] 55%|█████▌    | 55/100 [00:06<00:05,  7.81it/s] 56%|█████▌    | 56/100 [00:06<00:05,  7.82it/s] 57%|█████▋    | 57/100 [00:07<00:05,  8.03it/s] 58%|█████▊    | 58/100 [00:07<00:05,  8.15it/s] 59%|█████▉    | 59/100 [00:07<00:05,  8.00it/s] 60%|██████    | 60/100 [00:07<00:05,  7.88it/s] 61%|██████    | 61/100 [00:07<00:04,  7.92it/s] 62%|██████▏   | 62/100 [00:07<00:05,  7.48it/s] 63%|██████▎   | 63/100 [00:07<00:04,  7.60it/s] 64%|██████▍   | 64/100 [00:07<00:04,  7.29it/s] 65%|██████▌   | 65/100 [00:08<00:04,  7.44it/s] 66%|██████▌   | 66/100 [00:08<00:04,  7.48it/s] 67%|██████▋   | 67/100 [00:08<00:04,  7.51it/s] 68%|██████▊   | 68/100 [00:08<00:04,  7.54it/s] 69%|██████▉   | 69/100 [00:08<00:04,  7.53it/s] 70%|███████   | 70/100 [00:08<00:03,  7.55it/s] 71%|███████   | 71/100 [00:08<00:03,  7.70it/s] 72%|███████▏  | 72/100 [00:09<00:03,  7.57it/s] 73%|███████▎  | 73/100 [00:09<00:03,  7.68it/s] 74%|███████▍  | 74/100 [00:09<00:03,  7.89it/s] 75%|███████▌  | 75/100 [00:09<00:03,  7.72it/s] 76%|███████▌  | 76/100 [00:09<00:03,  7.62it/s] 77%|███████▋  | 77/100 [00:09<00:03,  7.35it/s] 78%|███████▊  | 78/100 [00:09<00:02,  7.43it/s] 79%|███████▉  | 79/100 [00:09<00:02,  7.50it/s] 80%|████████  | 80/100 [00:10<00:02,  7.54it/s] 81%|████████  | 81/100 [00:10<00:02,  7.59it/s] 82%|████████▏ | 82/100 [00:10<00:02,  7.64it/s] 83%|████████▎ | 83/100 [00:10<00:02,  7.69it/s] 84%|████████▍ | 84/100 [00:10<00:02,  7.54it/s] 85%|████████▌ | 85/100 [00:10<00:01,  7.55it/s] 86%|████████▌ | 86/100 [00:10<00:01,  7.57it/s] 87%|████████▋ | 87/100 [00:10<00:01,  7.44it/s] 88%|████████▊ | 88/100 [00:11<00:01,  7.46it/s] 89%|████████▉ | 89/100 [00:11<00:01,  7.76it/s] 90%|█████████ | 90/100 [00:11<00:01,  7.63it/s] 91%|█████████ | 91/100 [00:11<00:01,  7.63it/s] 92%|█████████▏| 92/100 [00:11<00:01,  7.63it/s] 93%|█████████▎| 93/100 [00:11<00:00,  7.27it/s] 94%|█████████▍| 94/100 [00:11<00:00,  7.25it/s] 95%|█████████▌| 95/100 [00:12<00:00,  7.31it/s] 96%|█████████▌| 96/100 [00:12<00:00,  7.23it/s] 97%|█████████▋| 97/100 [00:12<00:00,  7.33it/s] 98%|█████████▊| 98/100 [00:12<00:00,  7.43it/s] 99%|█████████▉| 99/100 [00:12<00:00,  7.47it/s]100%|██████████| 100/100 [00:12<00:00,  7.33it/s]100%|██████████| 100/100 [00:12<00:00,  7.85it/s]
eval_p_index len:  9
individual_train 110
individual_eval 9
train data의 x, y, id 길이: 110 110 110
valid data의 x, y, id 길이: 5 5 5
test data의 x, y, id 길이: 4 4 4
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 38.00 MB
cuda
Epoch 1, Train Loss 0.651116, Valid_loss 0.545684
Epoch 2, Train Loss 0.637022, Valid_loss 0.547901
Epoch 3, Train Loss 0.627091, Valid_loss 0.542720
Epoch 4, Train Loss 0.619557, Valid_loss 0.535634
Epoch 5, Train Loss 0.611169, Valid_loss 0.532433
Epoch 6, Train Loss 0.602658, Valid_loss 0.532409
Epoch 7, Train Loss 0.593431, Valid_loss 0.534486
Epoch 8, Train Loss 0.581538, Valid_loss 0.536613
Epoch 9, Train Loss 0.566049, Valid_loss 0.542608
Epoch 10, Train Loss 0.553889, Valid_loss 0.546566
Epoch 11, Train Loss 0.545962, Valid_loss 0.537371
Epoch 12, Train Loss 0.540664, Valid_loss 0.527978
Epoch 13, Train Loss 0.535314, Valid_loss 0.522982
Epoch 14, Train Loss 0.532816, Valid_loss 0.519051
Epoch 15, Train Loss 0.528286, Valid_loss 0.516549
Epoch 16, Train Loss 0.525632, Valid_loss 0.513078
Epoch 17, Train Loss 0.522179, Valid_loss 0.510214
Epoch 18, Train Loss 0.519478, Valid_loss 0.507743
Epoch 19, Train Loss 0.517014, Valid_loss 0.503914
Epoch 20, Train Loss 0.515280, Valid_loss 0.500255
Epoch 21, Train Loss 0.512806, Valid_loss 0.497713
Epoch 22, Train Loss 0.511540, Valid_loss 0.495039
Epoch 23, Train Loss 0.509022, Valid_loss 0.491410
Epoch 24, Train Loss 0.506309, Valid_loss 0.490032
Epoch 25, Train Loss 0.505451, Valid_loss 0.487386
Epoch 26, Train Loss 0.503513, Valid_loss 0.485707
Epoch 27, Train Loss 0.501460, Valid_loss 0.483101
Epoch 28, Train Loss 0.500691, Valid_loss 0.481810
Epoch 29, Train Loss 0.498811, Valid_loss 0.479730
Epoch 30, Train Loss 0.496494, Valid_loss 0.477695
Epoch 31, Train Loss 0.495946, Valid_loss 0.476751
Epoch 32, Train Loss 0.493705, Valid_loss 0.474413
Epoch 33, Train Loss 0.493650, Valid_loss 0.472439
Epoch 34, Train Loss 0.490895, Valid_loss 0.471070
Epoch 35, Train Loss 0.490335, Valid_loss 0.469544
Epoch 36, Train Loss 0.489106, Valid_loss 0.468288
Epoch 37, Train Loss 0.487401, Valid_loss 0.466807
Epoch 38, Train Loss 0.486711, Valid_loss 0.465408
Epoch 39, Train Loss 0.486642, Valid_loss 0.463858
Epoch 40, Train Loss 0.483969, Valid_loss 0.462880
Epoch 41, Train Loss 0.484005, Valid_loss 0.461195
Epoch 42, Train Loss 0.481898, Valid_loss 0.459582
Epoch 43, Train Loss 0.481507, Valid_loss 0.458356
Epoch 44, Train Loss 0.480703, Valid_loss 0.456549
Epoch 45, Train Loss 0.478521, Valid_loss 0.455360
Epoch 46, Train Loss 0.478213, Valid_loss 0.453989
Epoch 47, Train Loss 0.476697, Valid_loss 0.452540
Epoch 48, Train Loss 0.475364, Valid_loss 0.451197
Epoch 49, Train Loss 0.474345, Valid_loss 0.449659
Epoch 50, Train Loss 0.473206, Valid_loss 0.448395
Epoch 51, Train Loss 0.472919, Valid_loss 0.447685
Epoch 52, Train Loss 0.472670, Valid_loss 0.447129
Epoch 53, Train Loss 0.471644, Valid_loss 0.446668
Epoch 54, Train Loss 0.472635, Valid_loss 0.446090
Epoch 55, Train Loss 0.470507, Valid_loss 0.445611
Epoch 56, Train Loss 0.470474, Valid_loss 0.445054
Epoch 57, Train Loss 0.470620, Valid_loss 0.444497
Epoch 58, Train Loss 0.469620, Valid_loss 0.443907
Epoch 59, Train Loss 0.468665, Valid_loss 0.443316
Epoch 60, Train Loss 0.469108, Valid_loss 0.442653
Epoch 61, Train Loss 0.468646, Valid_loss 0.442079
Epoch 62, Train Loss 0.465904, Valid_loss 0.441762
Epoch 63, Train Loss 0.466834, Valid_loss 0.440918
Epoch 64, Train Loss 0.465429, Valid_loss 0.440447
Epoch 65, Train Loss 0.465930, Valid_loss 0.440150
Epoch 66, Train Loss 0.465284, Valid_loss 0.439628
Epoch 67, Train Loss 0.465967, Valid_loss 0.439165
Epoch 68, Train Loss 0.464289, Valid_loss 0.438892
Epoch 69, Train Loss 0.463232, Valid_loss 0.438249
Epoch 70, Train Loss 0.462605, Valid_loss 0.437584
Epoch 71, Train Loss 0.461732, Valid_loss 0.437348
Epoch 72, Train Loss 0.462267, Valid_loss 0.436908
Epoch 73, Train Loss 0.461642, Valid_loss 0.436421
Epoch 74, Train Loss 0.461926, Valid_loss 0.435908
Epoch 75, Train Loss 0.461306, Valid_loss 0.435325
Epoch 76, Train Loss 0.459720, Valid_loss 0.434744
Epoch 77, Train Loss 0.459980, Valid_loss 0.434182
Epoch 78, Train Loss 0.460104, Valid_loss 0.433765
Epoch 79, Train Loss 0.458833, Valid_loss 0.433255
Epoch 80, Train Loss 0.457938, Valid_loss 0.432818
Epoch 81, Train Loss 0.458296, Valid_loss 0.432276
Epoch 82, Train Loss 0.457739, Valid_loss 0.431844
Epoch 83, Train Loss 0.457491, Valid_loss 0.431516
Epoch 84, Train Loss 0.457415, Valid_loss 0.431121
Epoch 85, Train Loss 0.456846, Valid_loss 0.430592
Epoch 86, Train Loss 0.456354, Valid_loss 0.430204
Epoch 87, Train Loss 0.456609, Valid_loss 0.429805
Epoch 88, Train Loss 0.454363, Valid_loss 0.429289
Epoch 89, Train Loss 0.455386, Valid_loss 0.428837
Epoch 90, Train Loss 0.453900, Valid_loss 0.428387
Epoch 91, Train Loss 0.451903, Valid_loss 0.427854
Epoch 92, Train Loss 0.453223, Valid_loss 0.427416
Epoch 93, Train Loss 0.451832, Valid_loss 0.426977
Epoch 94, Train Loss 0.451559, Valid_loss 0.426647
Epoch 95, Train Loss 0.451675, Valid_loss 0.426058
Epoch 96, Train Loss 0.451580, Valid_loss 0.425574
Epoch 97, Train Loss 0.450737, Valid_loss 0.425124
Epoch 98, Train Loss 0.450258, Valid_loss 0.424759
Epoch 99, Train Loss 0.450283, Valid_loss 0.424339
Epoch 100, Train Loss 0.450362, Valid_loss 0.423943
COVID19_Participant11 -- true: COVID-19 -- pred: normal
COVID19_Participant25 -- true: COVID-19 -- pred: normal
Control_Participant7 -- true: normal -- pred: COVID-19
COVID19_Participant26 -- true: COVID-19 -- pred: COVID-19
true :  [1, 1, 0, 1]
pred :  [0, 0, 1, 1]
Confusion Matrix: [0 1 2 1]
Best performance: Epoch 100, Loss 0.450362, Test ACC 0.250000, Test AUC 0.333333, Test Recall 0.333333, Test Precision 0.500000
✅ Total valid splits used: 5

📌 Repeat 1: 평균 AUC = 0.4000, 표준편차 = 0.3887
🔁 Repeat 2, Fold 0
🔍 Split #1
  → train_p_index 환자 수: 15
  → test_p_index 환자 수: 4
  → train 환자 ID: ['COVID19_Participant13', 'COVID19_Participant15', 'COVID19_Participant17', 'COVID19_Participant19', 'COVID19_Participant22', 'COVID19_Participant26', 'COVID19_Participant28', 'COVID19_Participant29', 'COVID19_Participant32', 'COVID19_Participant37', 'Control_Participant10', 'Control_Participant11', 'Control_Participant15', 'Control_Participant3', 'Control_Participant7']
  → test  환자 ID: ['COVID19_Participant11', 'COVID19_Participant26', 'Control_Participant7', 'COVID19_Participant13']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: Control_Participant10, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant7, Label: 0
  → test 환자 ID 및 라벨:
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: Control_Participant7, Label: 0
    ID: COVID19_Participant13, Label: 0
train_p_index_ 10
valid_p_index 5
test_p_index 4
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Keratinocytes', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Neurons', 'iPS_cells', 'Embryonic_stem_cells', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
data augment 실행 함
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:10,  9.09it/s]  2%|▏         | 2/100 [00:00<00:10,  8.95it/s]  3%|▎         | 3/100 [00:00<00:11,  8.71it/s]  4%|▍         | 4/100 [00:00<00:10,  8.93it/s]  5%|▌         | 5/100 [00:00<00:10,  8.98it/s]  6%|▌         | 6/100 [00:00<00:11,  7.91it/s]  7%|▋         | 7/100 [00:00<00:11,  8.20it/s]  8%|▊         | 8/100 [00:00<00:10,  8.61it/s]  9%|▉         | 9/100 [00:01<00:10,  8.63it/s] 10%|█         | 10/100 [00:01<00:10,  8.27it/s] 11%|█         | 11/100 [00:01<00:10,  8.63it/s] 12%|█▏        | 12/100 [00:01<00:10,  8.60it/s] 13%|█▎        | 13/100 [00:01<00:09,  8.73it/s] 14%|█▍        | 14/100 [00:01<00:10,  8.60it/s] 15%|█▌        | 15/100 [00:01<00:09,  8.83it/s] 16%|█▌        | 16/100 [00:01<00:09,  9.08it/s] 17%|█▋        | 17/100 [00:01<00:09,  8.97it/s] 18%|█▊        | 18/100 [00:02<00:09,  8.78it/s] 19%|█▉        | 19/100 [00:02<00:09,  8.73it/s] 20%|██        | 20/100 [00:02<00:09,  8.84it/s] 21%|██        | 21/100 [00:02<00:09,  8.74it/s] 22%|██▏       | 22/100 [00:02<00:08,  8.95it/s] 23%|██▎       | 23/100 [00:02<00:08,  9.11it/s] 24%|██▍       | 24/100 [00:02<00:08,  9.21it/s] 25%|██▌       | 25/100 [00:02<00:08,  9.20it/s] 26%|██▌       | 26/100 [00:02<00:08,  9.09it/s] 27%|██▋       | 27/100 [00:03<00:08,  9.12it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.97it/s] 29%|██▉       | 29/100 [00:03<00:07,  8.90it/s] 30%|███       | 30/100 [00:03<00:07,  8.81it/s] 31%|███       | 31/100 [00:03<00:08,  8.45it/s] 32%|███▏      | 32/100 [00:03<00:08,  8.25it/s] 33%|███▎      | 33/100 [00:03<00:07,  8.48it/s] 34%|███▍      | 34/100 [00:03<00:07,  8.52it/s] 35%|███▌      | 35/100 [00:04<00:07,  8.50it/s] 36%|███▌      | 36/100 [00:04<00:07,  8.43it/s] 37%|███▋      | 37/100 [00:04<00:07,  8.18it/s] 38%|███▊      | 38/100 [00:04<00:08,  7.63it/s] 39%|███▉      | 39/100 [00:04<00:07,  8.04it/s] 40%|████      | 40/100 [00:04<00:07,  7.87it/s] 41%|████      | 41/100 [00:04<00:07,  8.09it/s] 42%|████▏     | 42/100 [00:04<00:07,  7.65it/s] 43%|████▎     | 43/100 [00:05<00:07,  7.37it/s] 44%|████▍     | 44/100 [00:05<00:07,  7.66it/s] 45%|████▌     | 45/100 [00:05<00:06,  7.86it/s] 46%|████▌     | 46/100 [00:05<00:06,  7.97it/s] 47%|████▋     | 47/100 [00:05<00:06,  7.89it/s] 48%|████▊     | 48/100 [00:05<00:06,  7.77it/s] 49%|████▉     | 49/100 [00:05<00:06,  8.10it/s] 50%|█████     | 50/100 [00:05<00:06,  8.08it/s] 52%|█████▏    | 52/100 [00:06<00:05,  8.37it/s] 53%|█████▎    | 53/100 [00:06<00:05,  8.50it/s] 54%|█████▍    | 54/100 [00:06<00:05,  8.44it/s] 55%|█████▌    | 55/100 [00:06<00:05,  8.15it/s] 56%|█████▌    | 56/100 [00:06<00:05,  8.03it/s] 57%|█████▋    | 57/100 [00:06<00:05,  8.18it/s] 58%|█████▊    | 58/100 [00:06<00:05,  8.32it/s] 59%|█████▉    | 59/100 [00:07<00:04,  8.36it/s] 60%|██████    | 60/100 [00:07<00:05,  7.76it/s] 61%|██████    | 61/100 [00:07<00:04,  8.05it/s] 62%|██████▏   | 62/100 [00:07<00:04,  8.26it/s] 63%|██████▎   | 63/100 [00:07<00:04,  8.12it/s] 64%|██████▍   | 64/100 [00:07<00:04,  8.26it/s] 65%|██████▌   | 65/100 [00:07<00:04,  8.12it/s] 66%|██████▌   | 66/100 [00:07<00:04,  7.79it/s] 67%|██████▋   | 67/100 [00:08<00:04,  7.85it/s] 68%|██████▊   | 68/100 [00:08<00:04,  7.36it/s] 69%|██████▉   | 69/100 [00:08<00:04,  7.08it/s] 70%|███████   | 70/100 [00:08<00:04,  7.05it/s] 71%|███████   | 71/100 [00:08<00:04,  7.20it/s] 72%|███████▏  | 72/100 [00:08<00:03,  7.57it/s] 73%|███████▎  | 73/100 [00:08<00:03,  7.29it/s] 74%|███████▍  | 74/100 [00:08<00:03,  7.53it/s] 75%|███████▌  | 75/100 [00:09<00:03,  7.78it/s] 76%|███████▌  | 76/100 [00:09<00:02,  8.28it/s] 77%|███████▋  | 77/100 [00:09<00:02,  8.36it/s] 78%|███████▊  | 78/100 [00:09<00:02,  8.31it/s] 79%|███████▉  | 79/100 [00:09<00:02,  7.99it/s] 80%|████████  | 80/100 [00:09<00:02,  8.17it/s] 81%|████████  | 81/100 [00:09<00:02,  8.05it/s] 82%|████████▏ | 82/100 [00:09<00:02,  8.21it/s] 83%|████████▎ | 83/100 [00:10<00:02,  7.95it/s] 84%|████████▍ | 84/100 [00:10<00:02,  7.85it/s] 85%|████████▌ | 85/100 [00:10<00:01,  7.86it/s] 86%|████████▌ | 86/100 [00:10<00:01,  8.01it/s] 87%|████████▋ | 87/100 [00:10<00:01,  8.15it/s] 88%|████████▊ | 88/100 [00:10<00:01,  8.04it/s] 89%|████████▉ | 89/100 [00:10<00:01,  8.03it/s] 90%|█████████ | 90/100 [00:10<00:01,  7.86it/s] 91%|█████████ | 91/100 [00:11<00:01,  7.50it/s] 92%|█████████▏| 92/100 [00:11<00:01,  7.62it/s] 93%|█████████▎| 93/100 [00:11<00:00,  7.80it/s] 94%|█████████▍| 94/100 [00:11<00:00,  7.98it/s] 95%|█████████▌| 95/100 [00:11<00:00,  8.13it/s] 96%|█████████▌| 96/100 [00:11<00:00,  7.92it/s] 97%|█████████▋| 97/100 [00:11<00:00,  8.01it/s] 98%|█████████▊| 98/100 [00:11<00:00,  8.12it/s] 99%|█████████▉| 99/100 [00:12<00:00,  8.08it/s]100%|██████████| 100/100 [00:12<00:00,  8.21it/s]100%|██████████| 100/100 [00:12<00:00,  8.19it/s]
eval_p_index len:  9
individual_train 110
individual_eval 9
train data의 x, y, id 길이: 110 110 110
valid data의 x, y, id 길이: 5 5 5
test data의 x, y, id 길이: 4 4 4
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 38.00 MB
cuda
Epoch 1, Train Loss 0.726713, Valid_loss 0.744858
Epoch 2, Train Loss 0.709076, Valid_loss 0.713264
Epoch 3, Train Loss 0.692336, Valid_loss 0.695080
Epoch 4, Train Loss 0.684148, Valid_loss 0.680913
Epoch 5, Train Loss 0.679757, Valid_loss 0.675127
Epoch 6, Train Loss 0.674346, Valid_loss 0.676914
Epoch 7, Train Loss 0.667878, Valid_loss 0.681445
Epoch 8, Train Loss 0.659713, Valid_loss 0.684013
Epoch 9, Train Loss 0.646975, Valid_loss 0.687988
Epoch 10, Train Loss 0.635059, Valid_loss 0.681821
Epoch 11, Train Loss 0.607551, Valid_loss 0.649392
Epoch 12, Train Loss 0.580658, Valid_loss 0.629380
Epoch 13, Train Loss 0.569096, Valid_loss 0.628846
Epoch 14, Train Loss 0.563980, Valid_loss 0.631881
Epoch 15, Train Loss 0.557867, Valid_loss 0.631903
Epoch 16, Train Loss 0.552491, Valid_loss 0.631434
Epoch 17, Train Loss 0.547431, Valid_loss 0.630825
Epoch 18, Train Loss 0.544702, Valid_loss 0.629652
Epoch 19, Train Loss 0.539676, Valid_loss 0.624417
Epoch 20, Train Loss 0.538300, Valid_loss 0.620308
Epoch 21, Train Loss 0.536489, Valid_loss 0.616772
Epoch 22, Train Loss 0.532891, Valid_loss 0.616246
Epoch 23, Train Loss 0.533023, Valid_loss 0.614958
Epoch 24, Train Loss 0.529870, Valid_loss 0.611062
Epoch 25, Train Loss 0.528097, Valid_loss 0.609856
Epoch 26, Train Loss 0.526022, Valid_loss 0.610453
Epoch 27, Train Loss 0.525662, Valid_loss 0.608732
Epoch 28, Train Loss 0.522766, Valid_loss 0.603628
Epoch 29, Train Loss 0.523178, Valid_loss 0.602236
Epoch 30, Train Loss 0.521562, Valid_loss 0.605228
Epoch 31, Train Loss 0.520617, Valid_loss 0.597806
Epoch 32, Train Loss 0.518225, Valid_loss 0.598127
Epoch 33, Train Loss 0.518326, Valid_loss 0.597049
Epoch 34, Train Loss 0.517503, Valid_loss 0.594496
Epoch 35, Train Loss 0.516047, Valid_loss 0.589029
Epoch 36, Train Loss 0.514934, Valid_loss 0.591699
Epoch 37, Train Loss 0.513490, Valid_loss 0.588359
Epoch 38, Train Loss 0.513336, Valid_loss 0.589368
Epoch 39, Train Loss 0.511831, Valid_loss 0.584179
Epoch 40, Train Loss 0.510894, Valid_loss 0.584831
Epoch 41, Train Loss 0.510014, Valid_loss 0.582845
Epoch 42, Train Loss 0.508735, Valid_loss 0.584027
Epoch 43, Train Loss 0.507829, Valid_loss 0.581596
Epoch 44, Train Loss 0.506428, Valid_loss 0.577583
Epoch 45, Train Loss 0.505857, Valid_loss 0.579472
Epoch 46, Train Loss 0.505462, Valid_loss 0.580291
Epoch 47, Train Loss 0.503760, Valid_loss 0.581056
Epoch 48, Train Loss 0.502544, Valid_loss 0.578862
Epoch 49, Train Loss 0.501725, Valid_loss 0.579755
Epoch 50, Train Loss 0.500276, Valid_loss 0.578417
Epoch 51, Train Loss 0.500058, Valid_loss 0.576148
Epoch 52, Train Loss 0.498672, Valid_loss 0.575684
Epoch 53, Train Loss 0.499652, Valid_loss 0.575899
Epoch 54, Train Loss 0.498031, Valid_loss 0.573355
Epoch 55, Train Loss 0.497547, Valid_loss 0.574512
Epoch 56, Train Loss 0.497308, Valid_loss 0.573964
Epoch 57, Train Loss 0.496688, Valid_loss 0.571937
Epoch 58, Train Loss 0.495922, Valid_loss 0.573385
Epoch 59, Train Loss 0.495832, Valid_loss 0.570762
Epoch 60, Train Loss 0.495049, Valid_loss 0.573334
Epoch 61, Train Loss 0.494539, Valid_loss 0.569481
Epoch 62, Train Loss 0.493929, Valid_loss 0.570854
Epoch 63, Train Loss 0.492625, Valid_loss 0.572021
COVID19_Participant11 -- true: COVID-19 -- pred: normal
COVID19_Participant26 -- true: COVID-19 -- pred: COVID-19
Control_Participant7 -- true: normal -- pred: normal
COVID19_Participant13 -- true: COVID-19 -- pred: COVID-19
true :  [1, 1, 0, 1]
pred :  [0, 1, 0, 1]
Confusion Matrix: [1 0 1 2]
Best performance: Epoch 61, Loss 0.494539, Test ACC 0.750000, Test AUC 0.666667, Test Recall 0.666667, Test Precision 1.000000
✅ Total valid splits used: 1
🔁 Repeat 2, Fold 1
🔍 Split #2
  → train_p_index 환자 수: 16
  → test_p_index 환자 수: 3
  → train 환자 ID: ['COVID19_Participant13', 'COVID19_Participant15', 'COVID19_Participant17', 'COVID19_Participant19', 'COVID19_Participant20', 'COVID19_Participant22', 'COVID19_Participant28', 'COVID19_Participant29', 'COVID19_Participant32', 'COVID19_Participant4', 'Control_Participant10', 'Control_Participant11', 'Control_Participant15', 'Control_Participant5', 'Control_Participant7', 'Control_Participant9']
  → test  환자 ID: ['Control_Participant7', 'COVID19_Participant11', 'COVID19_Participant13']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: Control_Participant10, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: Control_Participant7, Label: 1
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant13, Label: 0
train_p_index_ 10
valid_p_index 6
test_p_index 3
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Keratinocytes', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Neurons', 'iPS_cells', 'Embryonic_stem_cells', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
data augment 실행 함
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:10,  9.26it/s]  2%|▏         | 2/100 [00:00<00:10,  9.10it/s]  3%|▎         | 3/100 [00:00<00:10,  8.88it/s]  4%|▍         | 4/100 [00:00<00:10,  8.87it/s]  5%|▌         | 5/100 [00:00<00:10,  9.14it/s]  6%|▌         | 6/100 [00:00<00:10,  9.01it/s]  7%|▋         | 7/100 [00:00<00:10,  9.03it/s]  8%|▊         | 8/100 [00:00<00:10,  9.03it/s]  9%|▉         | 9/100 [00:01<00:10,  8.94it/s] 10%|█         | 10/100 [00:01<00:10,  8.70it/s] 11%|█         | 11/100 [00:01<00:10,  8.78it/s] 12%|█▏        | 12/100 [00:01<00:09,  8.94it/s] 13%|█▎        | 13/100 [00:01<00:09,  9.09it/s] 14%|█▍        | 14/100 [00:01<00:09,  9.04it/s] 15%|█▌        | 15/100 [00:01<00:09,  9.26it/s] 16%|█▌        | 16/100 [00:01<00:09,  9.25it/s] 17%|█▋        | 17/100 [00:01<00:08,  9.41it/s] 18%|█▊        | 18/100 [00:01<00:08,  9.25it/s] 19%|█▉        | 19/100 [00:02<00:08,  9.38it/s] 20%|██        | 20/100 [00:02<00:08,  9.08it/s] 21%|██        | 21/100 [00:02<00:08,  9.26it/s] 22%|██▏       | 22/100 [00:02<00:09,  8.48it/s] 23%|██▎       | 23/100 [00:02<00:09,  8.42it/s] 24%|██▍       | 24/100 [00:02<00:09,  8.35it/s] 25%|██▌       | 25/100 [00:02<00:08,  8.54it/s] 26%|██▌       | 26/100 [00:02<00:08,  8.67it/s] 27%|██▋       | 27/100 [00:03<00:08,  8.56it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.90it/s] 29%|██▉       | 29/100 [00:03<00:08,  8.77it/s] 30%|███       | 30/100 [00:03<00:08,  8.56it/s] 31%|███       | 31/100 [00:03<00:07,  8.68it/s] 32%|███▏      | 32/100 [00:03<00:07,  8.66it/s] 33%|███▎      | 33/100 [00:03<00:07,  9.01it/s] 34%|███▍      | 34/100 [00:03<00:07,  8.94it/s] 35%|███▌      | 35/100 [00:03<00:07,  9.04it/s] 36%|███▌      | 36/100 [00:04<00:07,  8.62it/s] 37%|███▋      | 37/100 [00:04<00:07,  8.59it/s] 38%|███▊      | 38/100 [00:04<00:07,  8.33it/s] 39%|███▉      | 39/100 [00:04<00:07,  8.05it/s] 40%|████      | 40/100 [00:04<00:07,  8.31it/s] 41%|████      | 41/100 [00:04<00:06,  8.47it/s] 42%|████▏     | 42/100 [00:04<00:06,  8.42it/s] 43%|████▎     | 43/100 [00:04<00:06,  8.43it/s] 44%|████▍     | 44/100 [00:05<00:06,  8.64it/s] 45%|████▌     | 45/100 [00:05<00:06,  8.33it/s] 46%|████▌     | 46/100 [00:05<00:06,  8.54it/s] 47%|████▋     | 47/100 [00:05<00:06,  8.30it/s] 48%|████▊     | 48/100 [00:05<00:06,  8.32it/s] 49%|████▉     | 49/100 [00:05<00:06,  8.13it/s] 50%|█████     | 50/100 [00:05<00:06,  8.11it/s] 51%|█████     | 51/100 [00:05<00:06,  7.95it/s] 52%|█████▏    | 52/100 [00:06<00:06,  7.83it/s] 53%|█████▎    | 53/100 [00:06<00:05,  7.87it/s] 54%|█████▍    | 54/100 [00:06<00:05,  7.82it/s] 55%|█████▌    | 55/100 [00:06<00:05,  8.02it/s] 56%|█████▌    | 56/100 [00:06<00:05,  7.81it/s] 57%|█████▋    | 57/100 [00:06<00:05,  8.00it/s] 58%|█████▊    | 58/100 [00:06<00:05,  7.14it/s] 59%|█████▉    | 59/100 [00:06<00:05,  7.35it/s] 60%|██████    | 60/100 [00:07<00:05,  7.73it/s] 61%|██████    | 61/100 [00:07<00:05,  7.73it/s] 62%|██████▏   | 62/100 [00:07<00:04,  7.75it/s] 63%|██████▎   | 63/100 [00:07<00:04,  8.08it/s] 64%|██████▍   | 64/100 [00:07<00:04,  8.00it/s] 65%|██████▌   | 65/100 [00:07<00:04,  8.16it/s] 66%|██████▌   | 66/100 [00:07<00:04,  7.97it/s] 67%|██████▋   | 67/100 [00:07<00:04,  7.74it/s] 68%|██████▊   | 68/100 [00:08<00:04,  7.74it/s] 69%|██████▉   | 69/100 [00:08<00:03,  7.78it/s] 70%|███████   | 70/100 [00:08<00:03,  7.87it/s] 71%|███████   | 71/100 [00:08<00:03,  7.84it/s] 72%|███████▏  | 72/100 [00:08<00:03,  7.66it/s] 73%|███████▎  | 73/100 [00:08<00:03,  7.69it/s] 74%|███████▍  | 74/100 [00:08<00:03,  7.99it/s] 75%|███████▌  | 75/100 [00:08<00:03,  8.01it/s] 76%|███████▌  | 76/100 [00:09<00:02,  8.04it/s] 77%|███████▋  | 77/100 [00:09<00:02,  7.77it/s] 78%|███████▊  | 78/100 [00:09<00:02,  7.86it/s] 79%|███████▉  | 79/100 [00:09<00:02,  7.83it/s] 80%|████████  | 80/100 [00:09<00:02,  7.37it/s] 81%|████████  | 81/100 [00:09<00:02,  7.71it/s] 82%|████████▏ | 82/100 [00:09<00:02,  7.53it/s] 83%|████████▎ | 83/100 [00:10<00:02,  7.63it/s] 84%|████████▍ | 84/100 [00:10<00:01,  8.09it/s] 85%|████████▌ | 85/100 [00:10<00:01,  7.89it/s] 86%|████████▌ | 86/100 [00:10<00:01,  7.80it/s] 87%|████████▋ | 87/100 [00:10<00:01,  7.78it/s] 88%|████████▊ | 88/100 [00:10<00:01,  7.88it/s] 89%|████████▉ | 89/100 [00:10<00:01,  7.78it/s] 90%|█████████ | 90/100 [00:10<00:01,  7.08it/s] 91%|█████████ | 91/100 [00:11<00:01,  7.26it/s] 92%|█████████▏| 92/100 [00:11<00:01,  7.44it/s] 93%|█████████▎| 93/100 [00:11<00:00,  7.71it/s] 94%|█████████▍| 94/100 [00:11<00:00,  7.82it/s] 95%|█████████▌| 95/100 [00:11<00:00,  7.70it/s] 96%|█████████▌| 96/100 [00:11<00:00,  7.62it/s] 97%|█████████▋| 97/100 [00:11<00:00,  7.50it/s] 98%|█████████▊| 98/100 [00:11<00:00,  7.44it/s] 99%|█████████▉| 99/100 [00:12<00:00,  7.54it/s]100%|██████████| 100/100 [00:12<00:00,  7.50it/s]100%|██████████| 100/100 [00:12<00:00,  8.17it/s]
eval_p_index len:  9
individual_train 110
individual_eval 9
train data의 x, y, id 길이: 110 110 110
valid data의 x, y, id 길이: 6 6 6
test data의 x, y, id 길이: 3 3 3
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 38.00 MB
cuda
Epoch 1, Train Loss 0.730562, Valid_loss 0.648578
Epoch 2, Train Loss 0.658610, Valid_loss 0.619614
Epoch 3, Train Loss 0.637691, Valid_loss 0.609800
Epoch 4, Train Loss 0.628296, Valid_loss 0.598280
Epoch 5, Train Loss 0.612672, Valid_loss 0.589511
Epoch 6, Train Loss 0.601097, Valid_loss 0.583988
Epoch 7, Train Loss 0.587960, Valid_loss 0.578138
Epoch 8, Train Loss 0.576438, Valid_loss 0.572534
Epoch 9, Train Loss 0.565008, Valid_loss 0.567685
Epoch 10, Train Loss 0.553031, Valid_loss 0.564415
Epoch 11, Train Loss 0.542218, Valid_loss 0.562678
Epoch 12, Train Loss 0.534649, Valid_loss 0.561524
Epoch 13, Train Loss 0.526029, Valid_loss 0.560659
Epoch 14, Train Loss 0.520335, Valid_loss 0.559484
Epoch 15, Train Loss 0.514302, Valid_loss 0.561457
Epoch 16, Train Loss 0.508911, Valid_loss 0.560170
Epoch 17, Train Loss 0.503705, Valid_loss 0.560512
Epoch 18, Train Loss 0.500971, Valid_loss 0.560643
Epoch 19, Train Loss 0.496510, Valid_loss 0.562089
Epoch 20, Train Loss 0.493553, Valid_loss 0.562217
Epoch 21, Train Loss 0.491443, Valid_loss 0.561634
Epoch 22, Train Loss 0.488640, Valid_loss 0.562278
Epoch 23, Train Loss 0.487395, Valid_loss 0.561252
Epoch 24, Train Loss 0.485720, Valid_loss 0.563472
Epoch 25, Train Loss 0.484570, Valid_loss 0.561542
Epoch 26, Train Loss 0.482970, Valid_loss 0.562396
Epoch 27, Train Loss 0.481609, Valid_loss 0.561649
Epoch 28, Train Loss 0.479916, Valid_loss 0.559950
Epoch 29, Train Loss 0.479150, Valid_loss 0.557596
Epoch 30, Train Loss 0.478105, Valid_loss 0.559859
Epoch 31, Train Loss 0.478204, Valid_loss 0.557017
Epoch 32, Train Loss 0.476035, Valid_loss 0.557173
Epoch 33, Train Loss 0.475406, Valid_loss 0.554092
Epoch 34, Train Loss 0.473894, Valid_loss 0.556832
Epoch 35, Train Loss 0.472912, Valid_loss 0.553511
Epoch 36, Train Loss 0.472239, Valid_loss 0.551803
Epoch 37, Train Loss 0.470407, Valid_loss 0.552120
Epoch 38, Train Loss 0.469247, Valid_loss 0.551179
Epoch 39, Train Loss 0.468019, Valid_loss 0.549744
Epoch 40, Train Loss 0.466852, Valid_loss 0.548490
Epoch 41, Train Loss 0.465893, Valid_loss 0.548243
Epoch 42, Train Loss 0.465345, Valid_loss 0.545821
Epoch 43, Train Loss 0.464614, Valid_loss 0.546119
Epoch 44, Train Loss 0.464431, Valid_loss 0.544725
Epoch 45, Train Loss 0.462905, Valid_loss 0.543109
Epoch 46, Train Loss 0.461857, Valid_loss 0.542573
Epoch 47, Train Loss 0.460984, Valid_loss 0.542698
Epoch 48, Train Loss 0.459620, Valid_loss 0.540481
Epoch 49, Train Loss 0.459859, Valid_loss 0.539479
Epoch 50, Train Loss 0.458662, Valid_loss 0.539397
Epoch 51, Train Loss 0.458532, Valid_loss 0.538829
Epoch 52, Train Loss 0.457658, Valid_loss 0.538344
Epoch 53, Train Loss 0.456405, Valid_loss 0.537894
Epoch 54, Train Loss 0.456773, Valid_loss 0.537775
Epoch 55, Train Loss 0.455697, Valid_loss 0.536618
Epoch 56, Train Loss 0.454960, Valid_loss 0.536325
Epoch 57, Train Loss 0.455446, Valid_loss 0.535590
Epoch 58, Train Loss 0.455223, Valid_loss 0.535152
Epoch 59, Train Loss 0.453772, Valid_loss 0.534732
Epoch 60, Train Loss 0.452717, Valid_loss 0.534359
Epoch 61, Train Loss 0.453093, Valid_loss 0.534101
Epoch 62, Train Loss 0.451885, Valid_loss 0.533571
Epoch 63, Train Loss 0.452481, Valid_loss 0.533186
Epoch 64, Train Loss 0.451732, Valid_loss 0.532435
Epoch 65, Train Loss 0.451003, Valid_loss 0.532352
Epoch 66, Train Loss 0.450227, Valid_loss 0.531807
Epoch 67, Train Loss 0.451136, Valid_loss 0.531276
Epoch 68, Train Loss 0.450061, Valid_loss 0.531012
Epoch 69, Train Loss 0.449944, Valid_loss 0.530542
Epoch 70, Train Loss 0.449487, Valid_loss 0.529840
Epoch 71, Train Loss 0.448520, Valid_loss 0.529743
Epoch 72, Train Loss 0.448952, Valid_loss 0.529326
Epoch 73, Train Loss 0.448817, Valid_loss 0.528105
Epoch 74, Train Loss 0.447740, Valid_loss 0.528193
Epoch 75, Train Loss 0.446557, Valid_loss 0.527974
Epoch 76, Train Loss 0.447516, Valid_loss 0.526975
Epoch 77, Train Loss 0.444908, Valid_loss 0.526967
Epoch 78, Train Loss 0.445682, Valid_loss 0.526667
Epoch 79, Train Loss 0.444467, Valid_loss 0.525859
Epoch 80, Train Loss 0.444455, Valid_loss 0.525298
Epoch 81, Train Loss 0.444962, Valid_loss 0.524893
Epoch 82, Train Loss 0.443650, Valid_loss 0.524687
Epoch 83, Train Loss 0.443890, Valid_loss 0.524038
Epoch 84, Train Loss 0.443089, Valid_loss 0.523728
Epoch 85, Train Loss 0.442865, Valid_loss 0.523237
Epoch 86, Train Loss 0.442474, Valid_loss 0.522620
Epoch 87, Train Loss 0.441744, Valid_loss 0.522185
Epoch 88, Train Loss 0.441663, Valid_loss 0.522108
Epoch 89, Train Loss 0.440788, Valid_loss 0.521231
Epoch 90, Train Loss 0.439913, Valid_loss 0.520892
Epoch 91, Train Loss 0.440932, Valid_loss 0.520593
Epoch 92, Train Loss 0.439974, Valid_loss 0.519944
Epoch 93, Train Loss 0.438953, Valid_loss 0.519504
Epoch 94, Train Loss 0.438577, Valid_loss 0.518841
Epoch 95, Train Loss 0.437970, Valid_loss 0.518477
Epoch 96, Train Loss 0.437811, Valid_loss 0.518435
Epoch 97, Train Loss 0.438050, Valid_loss 0.517836
Epoch 98, Train Loss 0.438059, Valid_loss 0.517466
Epoch 99, Train Loss 0.437268, Valid_loss 0.516843
Epoch 100, Train Loss 0.436353, Valid_loss 0.516640
Control_Participant7 -- true: normal -- pred: normal
COVID19_Participant11 -- true: COVID-19 -- pred: COVID-19
COVID19_Participant13 -- true: COVID-19 -- pred: normal
true :  [0, 1, 1]
pred :  [0, 1, 0]
Confusion Matrix: [1 0 1 1]
Best performance: Epoch 100, Loss 0.436353, Test ACC 0.666667, Test AUC 1.000000, Test Recall 0.500000, Test Precision 1.000000
✅ Total valid splits used: 2
🔁 Repeat 2, Fold 2
🔍 Split #3
  → train_p_index 환자 수: 14
  → test_p_index 환자 수: 5
  → train 환자 ID: ['COVID19_Participant13', 'COVID19_Participant19', 'COVID19_Participant20', 'COVID19_Participant26', 'COVID19_Participant29', 'COVID19_Participant37', 'COVID19_Participant4', 'Control_Participant10', 'Control_Participant11', 'Control_Participant15', 'Control_Participant3', 'Control_Participant5', 'Control_Participant7', 'Control_Participant9']
  → test  환자 ID: ['Control_Participant5', 'COVID19_Participant13', 'COVID19_Participant5', 'Control_Participant7', 'Control_Participant4']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: Control_Participant10, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: Control_Participant5, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant5, Label: 1
    ID: Control_Participant7, Label: 1
    ID: Control_Participant4, Label: 1
train_p_index_ 9
valid_p_index 5
test_p_index 5
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Keratinocytes', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Neurons', 'iPS_cells', 'Embryonic_stem_cells', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
data augment 실행 함
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:10,  9.02it/s]  2%|▏         | 2/100 [00:00<00:10,  9.25it/s]  3%|▎         | 3/100 [00:00<00:10,  9.08it/s]  4%|▍         | 4/100 [00:00<00:11,  8.41it/s]  6%|▌         | 6/100 [00:00<00:10,  8.88it/s]  7%|▋         | 7/100 [00:00<00:10,  8.78it/s]  8%|▊         | 8/100 [00:00<00:10,  8.96it/s]  9%|▉         | 9/100 [00:01<00:10,  8.91it/s] 10%|█         | 10/100 [00:01<00:10,  8.98it/s] 11%|█         | 11/100 [00:01<00:09,  9.11it/s] 12%|█▏        | 12/100 [00:01<00:09,  9.32it/s] 13%|█▎        | 13/100 [00:01<00:09,  9.23it/s] 14%|█▍        | 14/100 [00:01<00:09,  9.20it/s] 15%|█▌        | 15/100 [00:01<00:09,  9.03it/s] 16%|█▌        | 16/100 [00:01<00:09,  9.14it/s] 17%|█▋        | 17/100 [00:01<00:08,  9.24it/s] 18%|█▊        | 18/100 [00:01<00:08,  9.24it/s] 20%|██        | 20/100 [00:02<00:08,  9.29it/s] 21%|██        | 21/100 [00:02<00:08,  9.32it/s] 22%|██▏       | 22/100 [00:02<00:08,  9.10it/s] 23%|██▎       | 23/100 [00:02<00:08,  8.89it/s] 24%|██▍       | 24/100 [00:02<00:08,  8.94it/s] 25%|██▌       | 25/100 [00:02<00:08,  8.95it/s] 26%|██▌       | 26/100 [00:02<00:08,  8.86it/s] 27%|██▋       | 27/100 [00:03<00:08,  8.66it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.92it/s] 29%|██▉       | 29/100 [00:03<00:08,  8.83it/s] 30%|███       | 30/100 [00:03<00:07,  8.85it/s] 32%|███▏      | 32/100 [00:03<00:07,  9.35it/s] 33%|███▎      | 33/100 [00:03<00:07,  9.40it/s] 34%|███▍      | 34/100 [00:03<00:07,  9.28it/s] 35%|███▌      | 35/100 [00:03<00:07,  9.03it/s] 36%|███▌      | 36/100 [00:03<00:07,  9.10it/s] 37%|███▋      | 37/100 [00:04<00:07,  8.95it/s] 38%|███▊      | 38/100 [00:04<00:07,  8.65it/s] 39%|███▉      | 39/100 [00:04<00:07,  8.34it/s] 40%|████      | 40/100 [00:04<00:06,  8.57it/s] 41%|████      | 41/100 [00:04<00:06,  8.69it/s] 42%|████▏     | 42/100 [00:04<00:07,  8.28it/s] 43%|████▎     | 43/100 [00:04<00:06,  8.24it/s] 44%|████▍     | 44/100 [00:04<00:06,  8.58it/s] 45%|████▌     | 45/100 [00:05<00:06,  8.73it/s] 46%|████▌     | 46/100 [00:05<00:06,  8.56it/s] 47%|████▋     | 47/100 [00:05<00:06,  7.92it/s] 48%|████▊     | 48/100 [00:05<00:06,  8.20it/s] 49%|████▉     | 49/100 [00:05<00:06,  8.48it/s] 50%|█████     | 50/100 [00:05<00:06,  8.32it/s] 51%|█████     | 51/100 [00:05<00:05,  8.38it/s] 52%|█████▏    | 52/100 [00:05<00:05,  8.35it/s] 53%|█████▎    | 53/100 [00:06<00:05,  8.46it/s] 54%|█████▍    | 54/100 [00:06<00:05,  8.29it/s] 55%|█████▌    | 55/100 [00:06<00:05,  8.44it/s] 56%|█████▌    | 56/100 [00:06<00:05,  8.49it/s] 57%|█████▋    | 57/100 [00:06<00:05,  8.40it/s] 58%|█████▊    | 58/100 [00:06<00:05,  8.36it/s] 59%|█████▉    | 59/100 [00:06<00:04,  8.54it/s] 60%|██████    | 60/100 [00:06<00:04,  8.41it/s] 61%|██████    | 61/100 [00:06<00:04,  8.50it/s] 62%|██████▏   | 62/100 [00:07<00:04,  8.19it/s] 63%|██████▎   | 63/100 [00:07<00:04,  8.31it/s] 64%|██████▍   | 64/100 [00:07<00:04,  8.44it/s] 65%|██████▌   | 65/100 [00:07<00:04,  8.25it/s] 66%|██████▌   | 66/100 [00:07<00:04,  7.93it/s] 67%|██████▋   | 67/100 [00:07<00:04,  8.04it/s] 68%|██████▊   | 68/100 [00:07<00:04,  7.92it/s] 69%|██████▉   | 69/100 [00:07<00:03,  8.04it/s] 70%|███████   | 70/100 [00:08<00:03,  8.16it/s] 71%|███████   | 71/100 [00:08<00:03,  8.11it/s] 72%|███████▏  | 72/100 [00:08<00:03,  8.27it/s] 73%|███████▎  | 73/100 [00:08<00:03,  8.36it/s] 74%|███████▍  | 74/100 [00:08<00:03,  8.44it/s] 75%|███████▌  | 75/100 [00:08<00:02,  8.52it/s] 76%|███████▌  | 76/100 [00:08<00:02,  8.30it/s] 77%|███████▋  | 77/100 [00:08<00:02,  8.24it/s] 78%|███████▊  | 78/100 [00:09<00:02,  8.22it/s] 79%|███████▉  | 79/100 [00:09<00:02,  8.18it/s] 80%|████████  | 80/100 [00:09<00:02,  8.02it/s] 81%|████████  | 81/100 [00:09<00:02,  8.09it/s] 82%|████████▏ | 82/100 [00:09<00:02,  8.16it/s] 83%|████████▎ | 83/100 [00:09<00:02,  8.08it/s] 84%|████████▍ | 84/100 [00:09<00:01,  8.17it/s] 85%|████████▌ | 85/100 [00:09<00:01,  8.17it/s] 86%|████████▌ | 86/100 [00:10<00:01,  7.50it/s] 87%|████████▋ | 87/100 [00:10<00:01,  7.69it/s] 88%|████████▊ | 88/100 [00:10<00:01,  7.69it/s] 89%|████████▉ | 89/100 [00:10<00:01,  7.92it/s] 90%|█████████ | 90/100 [00:10<00:01,  8.25it/s] 91%|█████████ | 91/100 [00:10<00:01,  7.97it/s] 92%|█████████▏| 92/100 [00:10<00:00,  8.00it/s] 93%|█████████▎| 93/100 [00:10<00:00,  8.11it/s] 94%|█████████▍| 94/100 [00:11<00:00,  8.21it/s] 95%|█████████▌| 95/100 [00:11<00:00,  8.27it/s] 96%|█████████▌| 96/100 [00:11<00:00,  8.13it/s] 97%|█████████▋| 97/100 [00:11<00:00,  8.05it/s] 98%|█████████▊| 98/100 [00:11<00:00,  7.94it/s] 99%|█████████▉| 99/100 [00:11<00:00,  7.75it/s]100%|██████████| 100/100 [00:11<00:00,  7.89it/s]100%|██████████| 100/100 [00:11<00:00,  8.48it/s]
eval_p_index len:  10
individual_train 109
individual_eval 10
train data의 x, y, id 길이: 109 109 109
valid data의 x, y, id 길이: 5 5 5
test data의 x, y, id 길이: 5 5 5
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 38.00 MB
cuda
Epoch 1, Train Loss 0.770945, Valid_loss 0.674341
Epoch 2, Train Loss 0.763601, Valid_loss 0.671503
Epoch 3, Train Loss 0.755210, Valid_loss 0.667712
Epoch 4, Train Loss 0.746317, Valid_loss 0.660516
Epoch 5, Train Loss 0.732870, Valid_loss 0.654421
Epoch 6, Train Loss 0.720599, Valid_loss 0.642310
Epoch 7, Train Loss 0.708463, Valid_loss 0.637606
Epoch 8, Train Loss 0.695148, Valid_loss 0.731924
Epoch 9, Train Loss 0.679091, Valid_loss 0.718226
Epoch 10, Train Loss 0.662206, Valid_loss 0.683902
Epoch 11, Train Loss 0.642222, Valid_loss 0.675658
Epoch 12, Train Loss 0.628364, Valid_loss 0.675090
Epoch 13, Train Loss 0.615313, Valid_loss 0.646273
Epoch 14, Train Loss 0.602920, Valid_loss 0.645034
Epoch 15, Train Loss 0.594661, Valid_loss 0.612611
Epoch 16, Train Loss 0.582458, Valid_loss 0.615254
Epoch 17, Train Loss 0.568613, Valid_loss 0.605709
Epoch 18, Train Loss 0.554996, Valid_loss 0.593203
Epoch 19, Train Loss 0.539558, Valid_loss 0.565140
Epoch 20, Train Loss 0.520662, Valid_loss 0.533762
Epoch 21, Train Loss 0.502912, Valid_loss 0.540237
Epoch 22, Train Loss 0.486255, Valid_loss 0.503092
Epoch 23, Train Loss 0.472594, Valid_loss 0.502785
Epoch 24, Train Loss 0.458254, Valid_loss 0.497909
Epoch 25, Train Loss 0.444430, Valid_loss 0.477007
Epoch 26, Train Loss 0.438157, Valid_loss 0.461491
Epoch 27, Train Loss 0.433175, Valid_loss 0.462926
Epoch 28, Train Loss 0.427856, Valid_loss 0.457089
Epoch 29, Train Loss 0.426711, Valid_loss 0.459493
Epoch 30, Train Loss 0.424499, Valid_loss 0.461078
Epoch 31, Train Loss 0.422304, Valid_loss 0.458175
Epoch 32, Train Loss 0.419647, Valid_loss 0.449684
Epoch 33, Train Loss 0.420211, Valid_loss 0.455124
Epoch 34, Train Loss 0.417487, Valid_loss 0.458349
Epoch 35, Train Loss 0.414059, Valid_loss 0.457001
Epoch 36, Train Loss 0.414422, Valid_loss 0.458982
Epoch 37, Train Loss 0.410811, Valid_loss 0.455786
Epoch 38, Train Loss 0.411560, Valid_loss 0.454579
Epoch 39, Train Loss 0.411472, Valid_loss 0.456538
Epoch 40, Train Loss 0.408604, Valid_loss 0.455771
Epoch 41, Train Loss 0.410294, Valid_loss 0.459258
Epoch 42, Train Loss 0.407724, Valid_loss 0.453946
Epoch 43, Train Loss 0.407381, Valid_loss 0.454192
Epoch 44, Train Loss 0.407444, Valid_loss 0.452928
Epoch 45, Train Loss 0.404932, Valid_loss 0.454826
Epoch 46, Train Loss 0.406164, Valid_loss 0.453336
Epoch 47, Train Loss 0.404834, Valid_loss 0.458105
Epoch 48, Train Loss 0.402722, Valid_loss 0.453683
Epoch 49, Train Loss 0.402738, Valid_loss 0.453255
Epoch 50, Train Loss 0.400695, Valid_loss 0.455298
Epoch 51, Train Loss 0.400655, Valid_loss 0.454236
Epoch 52, Train Loss 0.399900, Valid_loss 0.453443
Epoch 53, Train Loss 0.400914, Valid_loss 0.451914
Epoch 54, Train Loss 0.398559, Valid_loss 0.455574
Epoch 55, Train Loss 0.400649, Valid_loss 0.455426
Epoch 56, Train Loss 0.399480, Valid_loss 0.453872
Epoch 57, Train Loss 0.397528, Valid_loss 0.452694
Epoch 58, Train Loss 0.398338, Valid_loss 0.453384
Epoch 59, Train Loss 0.398004, Valid_loss 0.453377
Epoch 60, Train Loss 0.398617, Valid_loss 0.454003
Epoch 61, Train Loss 0.397316, Valid_loss 0.453202
Epoch 62, Train Loss 0.397177, Valid_loss 0.453266
Epoch 63, Train Loss 0.396331, Valid_loss 0.452827
Epoch 64, Train Loss 0.399325, Valid_loss 0.452930
Epoch 65, Train Loss 0.395635, Valid_loss 0.454917
Control_Participant5 -- true: normal -- pred: COVID-19
COVID19_Participant13 -- true: COVID-19 -- pred: normal
COVID19_Participant5 -- true: COVID-19 -- pred: COVID-19
Control_Participant7 -- true: normal -- pred: COVID-19
Control_Participant4 -- true: normal -- pred: normal
true :  [0, 1, 1, 0, 0]
pred :  [1, 0, 1, 1, 0]
Confusion Matrix: [1 2 1 1]
Best performance: Epoch 32, Loss 0.419647, Test ACC 0.400000, Test AUC 0.500000, Test Recall 0.500000, Test Precision 0.333333
✅ Total valid splits used: 3
🔁 Repeat 2, Fold 3
🔍 Split #4
  → train_p_index 환자 수: 16
  → test_p_index 환자 수: 3
  → train 환자 ID: ['COVID19_Participant13', 'COVID19_Participant15', 'COVID19_Participant17', 'COVID19_Participant20', 'COVID19_Participant22', 'COVID19_Participant26', 'COVID19_Participant28', 'COVID19_Participant29', 'COVID19_Participant32', 'COVID19_Participant37', 'COVID19_Participant4', 'Control_Participant11', 'Control_Participant15', 'Control_Participant3', 'Control_Participant5', 'Control_Participant9']
  → test  환자 ID: ['COVID19_Participant7', 'Control_Participant5', 'COVID19_Participant13']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: Control_Participant11, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: COVID19_Participant7, Label: 1
    ID: Control_Participant5, Label: 0
    ID: COVID19_Participant13, Label: 0
train_p_index_ 10
valid_p_index 6
test_p_index 3
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Epithelial_cells', 'Platelets', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Keratinocytes', 'Macrophage', 'Epithelial_cells', 'B_cell', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
data augment 실행 함
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:10,  9.13it/s]  2%|▏         | 2/100 [00:00<00:10,  8.98it/s]  3%|▎         | 3/100 [00:00<00:11,  8.61it/s]  4%|▍         | 4/100 [00:00<00:11,  8.64it/s]  5%|▌         | 5/100 [00:00<00:10,  8.82it/s]  6%|▌         | 6/100 [00:00<00:10,  8.80it/s]  7%|▋         | 7/100 [00:00<00:10,  8.83it/s]  8%|▊         | 8/100 [00:00<00:10,  8.87it/s]  9%|▉         | 9/100 [00:01<00:10,  8.88it/s] 10%|█         | 10/100 [00:01<00:09,  9.04it/s] 11%|█         | 11/100 [00:01<00:10,  8.89it/s] 12%|█▏        | 12/100 [00:01<00:10,  8.74it/s] 13%|█▎        | 13/100 [00:01<00:09,  8.81it/s] 14%|█▍        | 14/100 [00:01<00:09,  8.87it/s] 15%|█▌        | 15/100 [00:01<00:09,  8.87it/s] 16%|█▌        | 16/100 [00:01<00:09,  8.76it/s] 17%|█▋        | 17/100 [00:01<00:09,  8.55it/s] 18%|█▊        | 18/100 [00:02<00:10,  7.98it/s] 19%|█▉        | 19/100 [00:02<00:10,  7.79it/s] 20%|██        | 20/100 [00:02<00:09,  8.02it/s] 21%|██        | 21/100 [00:02<00:09,  8.18it/s] 22%|██▏       | 22/100 [00:02<00:09,  8.31it/s] 23%|██▎       | 23/100 [00:02<00:09,  8.45it/s] 24%|██▍       | 24/100 [00:02<00:08,  8.48it/s] 25%|██▌       | 25/100 [00:02<00:09,  8.15it/s] 26%|██▌       | 26/100 [00:03<00:08,  8.23it/s] 27%|██▋       | 27/100 [00:03<00:08,  8.31it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.47it/s] 29%|██▉       | 29/100 [00:03<00:08,  8.47it/s] 30%|███       | 30/100 [00:03<00:08,  8.34it/s] 31%|███       | 31/100 [00:03<00:08,  7.98it/s] 32%|███▏      | 32/100 [00:03<00:08,  8.14it/s] 33%|███▎      | 33/100 [00:03<00:08,  8.17it/s] 34%|███▍      | 34/100 [00:04<00:07,  8.44it/s] 35%|███▌      | 35/100 [00:04<00:08,  8.11it/s] 36%|███▌      | 36/100 [00:04<00:07,  8.43it/s] 37%|███▋      | 37/100 [00:04<00:07,  8.36it/s] 38%|███▊      | 38/100 [00:04<00:07,  8.13it/s] 39%|███▉      | 39/100 [00:04<00:07,  8.15it/s] 40%|████      | 40/100 [00:04<00:07,  7.77it/s] 41%|████      | 41/100 [00:04<00:07,  7.98it/s] 42%|████▏     | 42/100 [00:05<00:07,  8.06it/s] 43%|████▎     | 43/100 [00:05<00:07,  8.14it/s] 44%|████▍     | 44/100 [00:05<00:06,  8.16it/s] 45%|████▌     | 45/100 [00:05<00:06,  8.16it/s] 46%|████▌     | 46/100 [00:05<00:06,  8.32it/s] 47%|████▋     | 47/100 [00:05<00:06,  8.09it/s] 48%|████▊     | 48/100 [00:05<00:06,  8.14it/s] 49%|████▉     | 49/100 [00:05<00:06,  8.13it/s] 50%|█████     | 50/100 [00:05<00:06,  8.11it/s] 51%|█████     | 51/100 [00:06<00:06,  8.05it/s] 52%|█████▏    | 52/100 [00:06<00:06,  7.89it/s] 53%|█████▎    | 53/100 [00:06<00:05,  7.85it/s] 54%|█████▍    | 54/100 [00:06<00:05,  7.94it/s] 55%|█████▌    | 55/100 [00:06<00:05,  8.02it/s] 56%|█████▌    | 56/100 [00:06<00:05,  8.03it/s] 57%|█████▋    | 57/100 [00:06<00:05,  7.98it/s] 58%|█████▊    | 58/100 [00:06<00:05,  8.09it/s] 59%|█████▉    | 59/100 [00:07<00:05,  8.06it/s] 60%|██████    | 60/100 [00:07<00:04,  8.19it/s] 61%|██████    | 61/100 [00:07<00:04,  8.10it/s] 62%|██████▏   | 62/100 [00:07<00:04,  7.88it/s] 63%|██████▎   | 63/100 [00:07<00:04,  8.03it/s] 64%|██████▍   | 64/100 [00:07<00:04,  8.01it/s] 65%|██████▌   | 65/100 [00:07<00:04,  8.08it/s] 66%|██████▌   | 66/100 [00:07<00:04,  8.05it/s] 67%|██████▋   | 67/100 [00:08<00:04,  7.99it/s] 68%|██████▊   | 68/100 [00:08<00:04,  7.53it/s] 69%|██████▉   | 69/100 [00:08<00:04,  7.70it/s] 70%|███████   | 70/100 [00:08<00:03,  7.75it/s] 71%|███████   | 71/100 [00:08<00:03,  7.37it/s] 72%|███████▏  | 72/100 [00:08<00:03,  7.69it/s] 73%|███████▎  | 73/100 [00:08<00:03,  7.82it/s] 74%|███████▍  | 74/100 [00:09<00:03,  7.87it/s] 75%|███████▌  | 75/100 [00:09<00:03,  7.78it/s] 76%|███████▌  | 76/100 [00:09<00:03,  7.66it/s] 77%|███████▋  | 77/100 [00:09<00:02,  7.67it/s] 78%|███████▊  | 78/100 [00:09<00:02,  7.69it/s] 79%|███████▉  | 79/100 [00:09<00:02,  7.88it/s] 80%|████████  | 80/100 [00:09<00:02,  7.95it/s] 81%|████████  | 81/100 [00:09<00:02,  7.90it/s] 82%|████████▏ | 82/100 [00:10<00:02,  8.04it/s] 83%|████████▎ | 83/100 [00:10<00:02,  8.08it/s] 84%|████████▍ | 84/100 [00:10<00:01,  8.04it/s] 85%|████████▌ | 85/100 [00:10<00:01,  7.98it/s] 86%|████████▌ | 86/100 [00:10<00:01,  8.01it/s] 87%|████████▋ | 87/100 [00:10<00:01,  7.86it/s] 88%|████████▊ | 88/100 [00:10<00:01,  7.87it/s] 89%|████████▉ | 89/100 [00:10<00:01,  7.90it/s] 90%|█████████ | 90/100 [00:11<00:01,  8.15it/s] 91%|█████████ | 91/100 [00:11<00:01,  8.14it/s] 92%|█████████▏| 92/100 [00:11<00:01,  7.94it/s] 93%|█████████▎| 93/100 [00:11<00:00,  7.89it/s] 94%|█████████▍| 94/100 [00:11<00:00,  7.87it/s] 95%|█████████▌| 95/100 [00:11<00:00,  7.67it/s] 96%|█████████▌| 96/100 [00:11<00:00,  7.76it/s] 97%|█████████▋| 97/100 [00:11<00:00,  7.72it/s] 98%|█████████▊| 98/100 [00:12<00:00,  7.93it/s] 99%|█████████▉| 99/100 [00:12<00:00,  8.09it/s]100%|██████████| 100/100 [00:12<00:00,  8.02it/s]100%|██████████| 100/100 [00:12<00:00,  8.12it/s]
eval_p_index len:  9
individual_train 110
individual_eval 9
train data의 x, y, id 길이: 110 110 110
valid data의 x, y, id 길이: 6 6 6
test data의 x, y, id 길이: 3 3 3
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 38.00 MB
cuda
Epoch 1, Train Loss 0.623372, Valid_loss 0.630046
Epoch 2, Train Loss 0.606442, Valid_loss 0.618056
Epoch 3, Train Loss 0.597489, Valid_loss 0.611330
Epoch 4, Train Loss 0.591771, Valid_loss 0.601617
Epoch 5, Train Loss 0.585757, Valid_loss 0.593955
Epoch 6, Train Loss 0.577796, Valid_loss 0.588728
Epoch 7, Train Loss 0.573118, Valid_loss 0.583739
Epoch 8, Train Loss 0.566758, Valid_loss 0.576450
Epoch 9, Train Loss 0.562181, Valid_loss 0.571899
Epoch 10, Train Loss 0.556839, Valid_loss 0.566316
Epoch 11, Train Loss 0.551051, Valid_loss 0.562686
Epoch 12, Train Loss 0.545792, Valid_loss 0.556810
Epoch 13, Train Loss 0.539980, Valid_loss 0.552525
Epoch 14, Train Loss 0.532314, Valid_loss 0.543868
Epoch 15, Train Loss 0.525519, Valid_loss 0.544455
Epoch 16, Train Loss 0.520244, Valid_loss 0.532493
Epoch 17, Train Loss 0.512732, Valid_loss 0.529626
Epoch 18, Train Loss 0.505384, Valid_loss 0.515376
Epoch 19, Train Loss 0.500671, Valid_loss 0.516217
Epoch 20, Train Loss 0.495591, Valid_loss 0.502811
Epoch 21, Train Loss 0.492407, Valid_loss 0.495382
Epoch 22, Train Loss 0.486575, Valid_loss 0.488190
Epoch 23, Train Loss 0.483715, Valid_loss 0.478967
Epoch 24, Train Loss 0.481135, Valid_loss 0.471108
Epoch 25, Train Loss 0.477539, Valid_loss 0.465519
Epoch 26, Train Loss 0.475364, Valid_loss 0.460947
Epoch 27, Train Loss 0.473246, Valid_loss 0.456573
Epoch 28, Train Loss 0.472010, Valid_loss 0.452731
Epoch 29, Train Loss 0.470076, Valid_loss 0.451064
Epoch 30, Train Loss 0.469584, Valid_loss 0.447500
Epoch 31, Train Loss 0.468004, Valid_loss 0.444040
Epoch 32, Train Loss 0.465984, Valid_loss 0.442655
Epoch 33, Train Loss 0.467378, Valid_loss 0.440662
Epoch 34, Train Loss 0.465859, Valid_loss 0.440981
Epoch 35, Train Loss 0.464075, Valid_loss 0.438456
Epoch 36, Train Loss 0.463112, Valid_loss 0.435835
Epoch 37, Train Loss 0.463225, Valid_loss 0.437020
Epoch 38, Train Loss 0.461588, Valid_loss 0.434475
Epoch 39, Train Loss 0.459837, Valid_loss 0.433080
Epoch 40, Train Loss 0.460384, Valid_loss 0.431920
Epoch 41, Train Loss 0.459257, Valid_loss 0.431202
Epoch 42, Train Loss 0.458732, Valid_loss 0.430398
Epoch 43, Train Loss 0.457016, Valid_loss 0.429098
Epoch 44, Train Loss 0.456497, Valid_loss 0.427244
Epoch 45, Train Loss 0.454620, Valid_loss 0.425868
Epoch 46, Train Loss 0.454308, Valid_loss 0.425893
Epoch 47, Train Loss 0.454084, Valid_loss 0.424307
Epoch 48, Train Loss 0.453737, Valid_loss 0.422874
Epoch 49, Train Loss 0.452394, Valid_loss 0.421636
Epoch 50, Train Loss 0.452813, Valid_loss 0.420183
Epoch 51, Train Loss 0.449467, Valid_loss 0.420182
Epoch 52, Train Loss 0.449924, Valid_loss 0.419793
Epoch 53, Train Loss 0.450606, Valid_loss 0.418905
Epoch 54, Train Loss 0.450563, Valid_loss 0.418396
Epoch 55, Train Loss 0.449103, Valid_loss 0.417862
Epoch 56, Train Loss 0.448812, Valid_loss 0.417519
Epoch 57, Train Loss 0.447063, Valid_loss 0.416864
Epoch 58, Train Loss 0.448124, Valid_loss 0.416406
Epoch 59, Train Loss 0.447122, Valid_loss 0.416113
Epoch 60, Train Loss 0.448285, Valid_loss 0.415573
Epoch 61, Train Loss 0.446401, Valid_loss 0.415150
Epoch 62, Train Loss 0.445287, Valid_loss 0.414757
Epoch 63, Train Loss 0.445290, Valid_loss 0.414073
Epoch 64, Train Loss 0.445899, Valid_loss 0.413705
Epoch 65, Train Loss 0.445900, Valid_loss 0.413374
Epoch 66, Train Loss 0.444893, Valid_loss 0.412899
Epoch 67, Train Loss 0.445328, Valid_loss 0.412336
Epoch 68, Train Loss 0.444384, Valid_loss 0.411851
Epoch 69, Train Loss 0.443314, Valid_loss 0.411481
Epoch 70, Train Loss 0.443840, Valid_loss 0.411152
Epoch 71, Train Loss 0.443778, Valid_loss 0.410654
Epoch 72, Train Loss 0.442335, Valid_loss 0.410149
Epoch 73, Train Loss 0.442345, Valid_loss 0.409884
Epoch 74, Train Loss 0.441818, Valid_loss 0.409151
Epoch 75, Train Loss 0.442303, Valid_loss 0.408771
Epoch 76, Train Loss 0.440480, Valid_loss 0.408352
Epoch 77, Train Loss 0.440978, Valid_loss 0.407932
Epoch 78, Train Loss 0.439771, Valid_loss 0.407765
Epoch 79, Train Loss 0.439711, Valid_loss 0.407130
Epoch 80, Train Loss 0.439366, Valid_loss 0.406575
Epoch 81, Train Loss 0.440132, Valid_loss 0.406271
Epoch 82, Train Loss 0.438577, Valid_loss 0.405628
Epoch 83, Train Loss 0.439087, Valid_loss 0.405095
Epoch 84, Train Loss 0.437873, Valid_loss 0.405029
Epoch 85, Train Loss 0.438469, Valid_loss 0.404470
Epoch 86, Train Loss 0.438530, Valid_loss 0.404233
Epoch 87, Train Loss 0.435961, Valid_loss 0.403658
Epoch 88, Train Loss 0.435385, Valid_loss 0.402972
Epoch 89, Train Loss 0.436310, Valid_loss 0.402598
Epoch 90, Train Loss 0.436818, Valid_loss 0.402209
Epoch 91, Train Loss 0.434527, Valid_loss 0.401717
Epoch 92, Train Loss 0.436043, Valid_loss 0.401444
Epoch 93, Train Loss 0.436305, Valid_loss 0.400864
Epoch 94, Train Loss 0.434931, Valid_loss 0.400358
Epoch 95, Train Loss 0.434126, Valid_loss 0.399962
Epoch 96, Train Loss 0.434540, Valid_loss 0.399659
Epoch 97, Train Loss 0.433687, Valid_loss 0.399218
Epoch 98, Train Loss 0.434702, Valid_loss 0.398826
Epoch 99, Train Loss 0.433640, Valid_loss 0.398259
Epoch 100, Train Loss 0.432251, Valid_loss 0.397797
COVID19_Participant7 -- true: COVID-19 -- pred: normal
Control_Participant5 -- true: normal -- pred: normal
COVID19_Participant13 -- true: COVID-19 -- pred: COVID-19
true :  [1, 0, 1]
pred :  [0, 0, 1]
Confusion Matrix: [1 0 1 1]
Best performance: Epoch 100, Loss 0.432251, Test ACC 0.666667, Test AUC 0.500000, Test Recall 0.500000, Test Precision 1.000000
✅ Total valid splits used: 4
🔁 Repeat 2, Fold 4
🔍 Split #5
  → train_p_index 환자 수: 15
  → test_p_index 환자 수: 4
  → train 환자 ID: ['COVID19_Participant15', 'COVID19_Participant17', 'COVID19_Participant19', 'COVID19_Participant20', 'COVID19_Participant22', 'COVID19_Participant26', 'COVID19_Participant28', 'COVID19_Participant32', 'COVID19_Participant37', 'COVID19_Participant4', 'Control_Participant10', 'Control_Participant3', 'Control_Participant5', 'Control_Participant7', 'Control_Participant9']
  → test  환자 ID: ['Control_Participant7', 'Control_Participant5', 'COVID19_Participant31', 'COVID19_Participant7']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: Control_Participant10, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: Control_Participant7, Label: 1
    ID: Control_Participant5, Label: 1
    ID: COVID19_Participant31, Label: 0
    ID: COVID19_Participant7, Label: 0
train_p_index_ 10
valid_p_index 5
test_p_index 4
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Keratinocytes', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Neurons', 'iPS_cells', 'Embryonic_stem_cells', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
data augment 실행 함
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:09,  9.98it/s]  2%|▏         | 2/100 [00:00<00:09,  9.92it/s]  3%|▎         | 3/100 [00:00<00:09,  9.84it/s]  4%|▍         | 4/100 [00:00<00:09,  9.72it/s]  5%|▌         | 5/100 [00:00<00:09,  9.54it/s]  6%|▌         | 6/100 [00:00<00:10,  9.27it/s]  7%|▋         | 7/100 [00:00<00:09,  9.49it/s]  8%|▊         | 8/100 [00:00<00:09,  9.55it/s]  9%|▉         | 9/100 [00:00<00:09,  9.67it/s] 10%|█         | 10/100 [00:01<00:09,  9.19it/s] 11%|█         | 11/100 [00:01<00:09,  8.99it/s] 13%|█▎        | 13/100 [00:01<00:09,  9.30it/s] 15%|█▌        | 15/100 [00:01<00:08,  9.45it/s] 16%|█▌        | 16/100 [00:01<00:08,  9.38it/s] 17%|█▋        | 17/100 [00:01<00:08,  9.35it/s] 18%|█▊        | 18/100 [00:01<00:08,  9.37it/s] 19%|█▉        | 19/100 [00:02<00:08,  9.39it/s] 20%|██        | 20/100 [00:02<00:08,  9.34it/s] 21%|██        | 21/100 [00:02<00:08,  9.21it/s] 22%|██▏       | 22/100 [00:02<00:08,  9.16it/s] 23%|██▎       | 23/100 [00:02<00:08,  9.20it/s] 24%|██▍       | 24/100 [00:02<00:08,  9.15it/s] 25%|██▌       | 25/100 [00:02<00:08,  8.94it/s] 26%|██▌       | 26/100 [00:02<00:08,  9.00it/s] 27%|██▋       | 27/100 [00:02<00:08,  8.94it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.66it/s] 29%|██▉       | 29/100 [00:03<00:08,  8.76it/s] 30%|███       | 30/100 [00:03<00:08,  8.60it/s] 31%|███       | 31/100 [00:03<00:08,  8.47it/s] 32%|███▏      | 32/100 [00:03<00:07,  8.57it/s] 33%|███▎      | 33/100 [00:03<00:07,  8.60it/s] 34%|███▍      | 34/100 [00:03<00:07,  8.79it/s] 35%|███▌      | 35/100 [00:03<00:07,  8.26it/s] 36%|███▌      | 36/100 [00:03<00:07,  8.39it/s] 37%|███▋      | 37/100 [00:04<00:07,  8.42it/s] 38%|███▊      | 38/100 [00:04<00:07,  8.51it/s] 39%|███▉      | 39/100 [00:04<00:07,  8.70it/s] 40%|████      | 40/100 [00:04<00:06,  8.59it/s] 41%|████      | 41/100 [00:04<00:06,  8.72it/s] 42%|████▏     | 42/100 [00:04<00:06,  8.62it/s] 43%|████▎     | 43/100 [00:04<00:06,  8.70it/s] 44%|████▍     | 44/100 [00:04<00:06,  8.73it/s] 45%|████▌     | 45/100 [00:05<00:06,  8.82it/s] 46%|████▌     | 46/100 [00:05<00:06,  8.77it/s] 47%|████▋     | 47/100 [00:05<00:06,  8.66it/s] 48%|████▊     | 48/100 [00:05<00:06,  8.63it/s] 49%|████▉     | 49/100 [00:05<00:05,  8.70it/s] 50%|█████     | 50/100 [00:05<00:05,  8.71it/s] 51%|█████     | 51/100 [00:05<00:05,  8.82it/s] 52%|█████▏    | 52/100 [00:05<00:05,  8.70it/s] 53%|█████▎    | 53/100 [00:05<00:05,  8.71it/s] 54%|█████▍    | 54/100 [00:06<00:05,  8.62it/s] 55%|█████▌    | 55/100 [00:06<00:05,  8.62it/s] 56%|█████▌    | 56/100 [00:06<00:05,  8.44it/s] 57%|█████▋    | 57/100 [00:06<00:05,  8.39it/s] 58%|█████▊    | 58/100 [00:06<00:04,  8.49it/s] 59%|█████▉    | 59/100 [00:06<00:04,  8.40it/s] 60%|██████    | 60/100 [00:06<00:04,  8.21it/s] 61%|██████    | 61/100 [00:06<00:04,  8.36it/s] 62%|██████▏   | 62/100 [00:06<00:04,  8.41it/s] 63%|██████▎   | 63/100 [00:07<00:04,  8.29it/s] 64%|██████▍   | 64/100 [00:07<00:04,  8.29it/s] 65%|██████▌   | 65/100 [00:07<00:04,  8.14it/s] 66%|██████▌   | 66/100 [00:07<00:04,  8.24it/s] 67%|██████▋   | 67/100 [00:07<00:03,  8.27it/s] 68%|██████▊   | 68/100 [00:07<00:03,  8.34it/s] 69%|██████▉   | 69/100 [00:07<00:03,  8.09it/s] 70%|███████   | 70/100 [00:07<00:03,  8.18it/s] 71%|███████   | 71/100 [00:08<00:03,  8.23it/s] 72%|███████▏  | 72/100 [00:08<00:03,  8.35it/s] 73%|███████▎  | 73/100 [00:08<00:03,  8.39it/s] 74%|███████▍  | 74/100 [00:08<00:03,  8.22it/s] 75%|███████▌  | 75/100 [00:08<00:03,  8.19it/s] 76%|███████▌  | 76/100 [00:08<00:02,  8.08it/s] 77%|███████▋  | 77/100 [00:08<00:02,  8.25it/s] 78%|███████▊  | 78/100 [00:08<00:02,  8.15it/s] 79%|███████▉  | 79/100 [00:09<00:02,  8.15it/s] 80%|████████  | 80/100 [00:09<00:02,  7.90it/s] 81%|████████  | 81/100 [00:09<00:02,  7.83it/s] 82%|████████▏ | 82/100 [00:09<00:02,  7.84it/s] 83%|████████▎ | 83/100 [00:09<00:02,  7.25it/s] 84%|████████▍ | 84/100 [00:09<00:02,  7.52it/s] 85%|████████▌ | 85/100 [00:09<00:01,  7.64it/s] 86%|████████▌ | 86/100 [00:10<00:01,  7.63it/s] 87%|████████▋ | 87/100 [00:10<00:01,  7.66it/s] 88%|████████▊ | 88/100 [00:10<00:01,  7.72it/s] 89%|████████▉ | 89/100 [00:10<00:01,  7.81it/s] 90%|█████████ | 90/100 [00:10<00:01,  7.71it/s] 91%|█████████ | 91/100 [00:10<00:01,  7.69it/s] 92%|█████████▏| 92/100 [00:10<00:01,  7.65it/s] 93%|█████████▎| 93/100 [00:10<00:00,  7.57it/s] 94%|█████████▍| 94/100 [00:11<00:00,  7.60it/s] 95%|█████████▌| 95/100 [00:11<00:00,  7.70it/s] 96%|█████████▌| 96/100 [00:11<00:00,  7.72it/s] 97%|█████████▋| 97/100 [00:11<00:00,  7.76it/s] 98%|█████████▊| 98/100 [00:11<00:00,  7.62it/s] 99%|█████████▉| 99/100 [00:11<00:00,  7.65it/s]100%|██████████| 100/100 [00:11<00:00,  7.69it/s]100%|██████████| 100/100 [00:11<00:00,  8.45it/s]
eval_p_index len:  9
individual_train 110
individual_eval 9
train data의 x, y, id 길이: 110 110 110
valid data의 x, y, id 길이: 5 5 5
test data의 x, y, id 길이: 4 4 4
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 38.00 MB
cuda
Epoch 1, Train Loss 0.663449, Valid_loss 0.528963
Epoch 2, Train Loss 0.652598, Valid_loss 0.536670
Epoch 3, Train Loss 0.650746, Valid_loss 0.539672
Epoch 4, Train Loss 0.643841, Valid_loss 0.544020
Epoch 5, Train Loss 0.636282, Valid_loss 0.546154
Epoch 6, Train Loss 0.627787, Valid_loss 0.558213
Epoch 7, Train Loss 0.615056, Valid_loss 0.578140
Epoch 8, Train Loss 0.595274, Valid_loss 0.621718
Epoch 9, Train Loss 0.578774, Valid_loss 0.645758
Epoch 10, Train Loss 0.554624, Valid_loss 0.661657
Epoch 11, Train Loss 0.528359, Valid_loss 0.676946
Epoch 12, Train Loss 0.502391, Valid_loss 0.682371
Epoch 13, Train Loss 0.484475, Valid_loss 0.685433
Epoch 14, Train Loss 0.471306, Valid_loss 0.691320
Epoch 15, Train Loss 0.461621, Valid_loss 0.701816
Epoch 16, Train Loss 0.451958, Valid_loss 0.708334
Epoch 17, Train Loss 0.444960, Valid_loss 0.714550
Epoch 18, Train Loss 0.440798, Valid_loss 0.722552
Epoch 19, Train Loss 0.434229, Valid_loss 0.731320
Epoch 20, Train Loss 0.427451, Valid_loss 0.743298
Epoch 21, Train Loss 0.422483, Valid_loss 0.752649
Epoch 22, Train Loss 0.417738, Valid_loss 0.764484
Epoch 23, Train Loss 0.412181, Valid_loss 0.775247
Epoch 24, Train Loss 0.408988, Valid_loss 0.782728
Epoch 25, Train Loss 0.404408, Valid_loss 0.787983
Epoch 26, Train Loss 0.402960, Valid_loss 0.789774
Epoch 27, Train Loss 0.401376, Valid_loss 0.789935
Epoch 28, Train Loss 0.400711, Valid_loss 0.792050
Epoch 29, Train Loss 0.398151, Valid_loss 0.793704
Epoch 30, Train Loss 0.397672, Valid_loss 0.794944
Epoch 31, Train Loss 0.396182, Valid_loss 0.797064
Epoch 32, Train Loss 0.394532, Valid_loss 0.800235
Epoch 33, Train Loss 0.394285, Valid_loss 0.801343
Epoch 34, Train Loss 0.392837, Valid_loss 0.803431
Epoch 35, Train Loss 0.391621, Valid_loss 0.804954
Epoch 36, Train Loss 0.390997, Valid_loss 0.810292
Epoch 37, Train Loss 0.390491, Valid_loss 0.811820
Epoch 38, Train Loss 0.389694, Valid_loss 0.811369
Epoch 39, Train Loss 0.388307, Valid_loss 0.818103
Epoch 40, Train Loss 0.389131, Valid_loss 0.815424
Epoch 41, Train Loss 0.387447, Valid_loss 0.822355
Epoch 42, Train Loss 0.386514, Valid_loss 0.822898
Epoch 43, Train Loss 0.385511, Valid_loss 0.828333
Epoch 44, Train Loss 0.384695, Valid_loss 0.829703
Epoch 45, Train Loss 0.384036, Valid_loss 0.831130
Epoch 46, Train Loss 0.381536, Valid_loss 0.835771
Epoch 47, Train Loss 0.381972, Valid_loss 0.836338
Epoch 48, Train Loss 0.382099, Valid_loss 0.839775
Epoch 49, Train Loss 0.382353, Valid_loss 0.844884
Epoch 50, Train Loss 0.378564, Valid_loss 0.843923
Epoch 51, Train Loss 0.379096, Valid_loss 0.848920
Epoch 52, Train Loss 0.376900, Valid_loss 0.849733
Control_Participant7 -- true: normal -- pred: COVID-19
Control_Participant5 -- true: normal -- pred: COVID-19
COVID19_Participant31 -- true: COVID-19 -- pred: COVID-19
COVID19_Participant7 -- true: COVID-19 -- pred: COVID-19
true :  [0, 0, 1, 1]
pred :  [1, 1, 1, 1]
Confusion Matrix: [0 2 0 2]
Best performance: Epoch 1, Loss 0.663449, Test ACC 0.500000, Test AUC 0.500000, Test Recall 1.000000, Test Precision 0.500000
✅ Total valid splits used: 5

📌 Repeat 2: 평균 AUC = 0.6333, 표준편차 = 0.1944
🔁 Repeat 3, Fold 0
🔍 Split #1
  → train_p_index 환자 수: 17
  → test_p_index 환자 수: 2
  → train 환자 ID: ['COVID19_Participant13', 'COVID19_Participant15', 'COVID19_Participant20', 'COVID19_Participant22', 'COVID19_Participant26', 'COVID19_Participant28', 'COVID19_Participant29', 'COVID19_Participant32', 'COVID19_Participant37', 'COVID19_Participant4', 'Control_Participant10', 'Control_Participant11', 'Control_Participant15', 'Control_Participant3', 'Control_Participant5', 'Control_Participant7', 'Control_Participant9']
  → test  환자 ID: ['Control_Participant5', 'COVID19_Participant26']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: Control_Participant10, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: Control_Participant5, Label: 1
    ID: COVID19_Participant26, Label: 1
train_p_index_ 11
valid_p_index 6
test_p_index 2
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Keratinocytes', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Neurons', 'iPS_cells', 'Embryonic_stem_cells', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
data augment 실행 함
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:11,  8.98it/s]  2%|▏         | 2/100 [00:00<00:10,  9.07it/s]  3%|▎         | 3/100 [00:00<00:10,  8.91it/s]  4%|▍         | 4/100 [00:00<00:11,  8.68it/s]  5%|▌         | 5/100 [00:00<00:10,  8.69it/s]  6%|▌         | 6/100 [00:00<00:10,  8.62it/s]  7%|▋         | 7/100 [00:00<00:11,  8.42it/s]  8%|▊         | 8/100 [00:00<00:10,  8.57it/s]  9%|▉         | 9/100 [00:01<00:10,  8.81it/s] 10%|█         | 10/100 [00:01<00:10,  8.65it/s] 11%|█         | 11/100 [00:01<00:10,  8.55it/s] 12%|█▏        | 12/100 [00:01<00:10,  8.65it/s] 13%|█▎        | 13/100 [00:01<00:10,  8.64it/s] 14%|█▍        | 14/100 [00:01<00:10,  8.58it/s] 15%|█▌        | 15/100 [00:01<00:09,  8.70it/s] 16%|█▌        | 16/100 [00:01<00:09,  8.52it/s] 17%|█▋        | 17/100 [00:01<00:09,  8.62it/s] 19%|█▉        | 19/100 [00:02<00:08,  9.05it/s] 20%|██        | 20/100 [00:02<00:08,  8.97it/s] 21%|██        | 21/100 [00:02<00:08,  8.82it/s] 22%|██▏       | 22/100 [00:02<00:08,  8.72it/s] 23%|██▎       | 23/100 [00:02<00:08,  8.68it/s] 24%|██▍       | 24/100 [00:02<00:08,  8.52it/s] 25%|██▌       | 25/100 [00:02<00:08,  8.45it/s] 26%|██▌       | 26/100 [00:02<00:08,  8.64it/s] 27%|██▋       | 27/100 [00:03<00:08,  8.43it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.45it/s] 29%|██▉       | 29/100 [00:03<00:08,  8.10it/s] 30%|███       | 30/100 [00:03<00:08,  8.15it/s] 31%|███       | 31/100 [00:03<00:08,  8.26it/s] 32%|███▏      | 32/100 [00:03<00:08,  8.32it/s] 34%|███▍      | 34/100 [00:03<00:07,  8.72it/s] 35%|███▌      | 35/100 [00:04<00:07,  8.29it/s] 36%|███▌      | 36/100 [00:04<00:07,  8.36it/s] 37%|███▋      | 37/100 [00:04<00:07,  8.34it/s] 38%|███▊      | 38/100 [00:04<00:07,  8.53it/s] 39%|███▉      | 39/100 [00:04<00:07,  8.52it/s] 40%|████      | 40/100 [00:04<00:07,  8.27it/s] 41%|████      | 41/100 [00:04<00:07,  8.24it/s] 42%|████▏     | 42/100 [00:04<00:07,  8.17it/s] 43%|████▎     | 43/100 [00:05<00:06,  8.21it/s] 44%|████▍     | 44/100 [00:05<00:06,  8.09it/s] 45%|████▌     | 45/100 [00:05<00:06,  8.10it/s] 46%|████▌     | 46/100 [00:05<00:06,  8.13it/s] 47%|████▋     | 47/100 [00:05<00:06,  7.66it/s] 48%|████▊     | 48/100 [00:05<00:06,  7.84it/s] 49%|████▉     | 49/100 [00:05<00:06,  7.94it/s] 50%|█████     | 50/100 [00:05<00:06,  7.97it/s] 51%|█████     | 51/100 [00:06<00:05,  8.22it/s] 52%|█████▏    | 52/100 [00:06<00:05,  8.17it/s] 53%|█████▎    | 53/100 [00:06<00:05,  7.91it/s] 54%|█████▍    | 54/100 [00:06<00:05,  7.88it/s] 55%|█████▌    | 55/100 [00:06<00:05,  7.77it/s] 56%|█████▌    | 56/100 [00:06<00:05,  7.91it/s] 57%|█████▋    | 57/100 [00:06<00:05,  8.11it/s] 58%|█████▊    | 58/100 [00:06<00:05,  7.83it/s] 59%|█████▉    | 59/100 [00:07<00:05,  7.93it/s] 60%|██████    | 60/100 [00:07<00:05,  7.24it/s] 61%|██████    | 61/100 [00:07<00:05,  7.59it/s] 62%|██████▏   | 62/100 [00:07<00:04,  7.92it/s] 63%|██████▎   | 63/100 [00:07<00:04,  7.89it/s] 64%|██████▍   | 64/100 [00:07<00:04,  7.94it/s] 65%|██████▌   | 65/100 [00:07<00:04,  7.90it/s] 66%|██████▌   | 66/100 [00:07<00:04,  7.95it/s] 67%|██████▋   | 67/100 [00:08<00:04,  8.16it/s] 68%|██████▊   | 68/100 [00:08<00:03,  8.03it/s] 69%|██████▉   | 69/100 [00:08<00:03,  7.98it/s] 70%|███████   | 70/100 [00:08<00:03,  8.06it/s] 71%|███████   | 71/100 [00:08<00:03,  7.95it/s] 72%|███████▏  | 72/100 [00:08<00:03,  8.05it/s] 73%|███████▎  | 73/100 [00:08<00:03,  7.73it/s] 74%|███████▍  | 74/100 [00:08<00:03,  7.81it/s] 75%|███████▌  | 75/100 [00:09<00:03,  7.82it/s] 76%|███████▌  | 76/100 [00:09<00:03,  7.82it/s] 77%|███████▋  | 77/100 [00:09<00:02,  7.82it/s] 78%|███████▊  | 78/100 [00:09<00:02,  7.86it/s] 79%|███████▉  | 79/100 [00:09<00:02,  7.90it/s] 80%|████████  | 80/100 [00:09<00:02,  7.79it/s] 81%|████████  | 81/100 [00:09<00:02,  7.70it/s] 82%|████████▏ | 82/100 [00:10<00:02,  7.41it/s] 83%|████████▎ | 83/100 [00:10<00:02,  7.57it/s] 84%|████████▍ | 84/100 [00:10<00:02,  7.64it/s] 85%|████████▌ | 85/100 [00:10<00:01,  7.58it/s] 86%|████████▌ | 86/100 [00:10<00:01,  7.61it/s] 87%|████████▋ | 87/100 [00:10<00:01,  7.60it/s] 88%|████████▊ | 88/100 [00:10<00:01,  7.47it/s] 89%|████████▉ | 89/100 [00:10<00:01,  7.21it/s] 90%|█████████ | 90/100 [00:11<00:01,  7.38it/s] 91%|█████████ | 91/100 [00:11<00:01,  7.35it/s] 92%|█████████▏| 92/100 [00:11<00:01,  7.65it/s] 93%|█████████▎| 93/100 [00:11<00:00,  7.74it/s] 94%|█████████▍| 94/100 [00:11<00:00,  7.66it/s] 95%|█████████▌| 95/100 [00:11<00:00,  7.51it/s] 96%|█████████▌| 96/100 [00:11<00:00,  7.50it/s] 97%|█████████▋| 97/100 [00:11<00:00,  7.92it/s] 98%|█████████▊| 98/100 [00:12<00:00,  7.81it/s] 99%|█████████▉| 99/100 [00:12<00:00,  7.88it/s]100%|██████████| 100/100 [00:12<00:00,  7.81it/s]100%|██████████| 100/100 [00:12<00:00,  8.08it/s]
eval_p_index len:  8
individual_train 111
individual_eval 8
train data의 x, y, id 길이: 111 111 111
valid data의 x, y, id 길이: 6 6 6
test data의 x, y, id 길이: 2 2 2
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 38.00 MB
cuda
Epoch 1, Train Loss 0.699944, Valid_loss 0.644477
Epoch 2, Train Loss 0.677960, Valid_loss 0.642546
Epoch 3, Train Loss 0.655868, Valid_loss 0.640445
Epoch 4, Train Loss 0.632030, Valid_loss 0.639020
Epoch 5, Train Loss 0.613916, Valid_loss 0.631305
Epoch 6, Train Loss 0.599892, Valid_loss 0.618490
Epoch 7, Train Loss 0.590981, Valid_loss 0.586413
Epoch 8, Train Loss 0.584019, Valid_loss 0.620797
Epoch 9, Train Loss 0.575768, Valid_loss 0.610729
Epoch 10, Train Loss 0.568475, Valid_loss 0.610434
Epoch 11, Train Loss 0.560730, Valid_loss 0.631083
Epoch 12, Train Loss 0.550902, Valid_loss 0.627167
Epoch 13, Train Loss 0.540481, Valid_loss 0.633757
Epoch 14, Train Loss 0.532306, Valid_loss 0.680284
Epoch 15, Train Loss 0.526245, Valid_loss 0.679547
Epoch 16, Train Loss 0.522603, Valid_loss 0.690513
Epoch 17, Train Loss 0.519674, Valid_loss 0.693997
Epoch 18, Train Loss 0.516499, Valid_loss 0.697135
Epoch 19, Train Loss 0.514789, Valid_loss 0.701082
Epoch 20, Train Loss 0.512691, Valid_loss 0.679332
Epoch 21, Train Loss 0.512292, Valid_loss 0.713451
Epoch 22, Train Loss 0.508923, Valid_loss 0.698961
Epoch 23, Train Loss 0.507466, Valid_loss 0.717754
Epoch 24, Train Loss 0.506420, Valid_loss 0.701861
Epoch 25, Train Loss 0.504615, Valid_loss 0.706008
Epoch 26, Train Loss 0.503067, Valid_loss 0.699941
Epoch 27, Train Loss 0.501994, Valid_loss 0.685619
Epoch 28, Train Loss 0.499581, Valid_loss 0.710297
Epoch 29, Train Loss 0.499069, Valid_loss 0.693564
Epoch 30, Train Loss 0.496998, Valid_loss 0.707235
Epoch 31, Train Loss 0.495818, Valid_loss 0.693058
Epoch 32, Train Loss 0.494267, Valid_loss 0.702241
Epoch 33, Train Loss 0.492644, Valid_loss 0.699417
Epoch 34, Train Loss 0.491712, Valid_loss 0.696037
Epoch 35, Train Loss 0.490639, Valid_loss 0.706612
Epoch 36, Train Loss 0.488976, Valid_loss 0.692869
Epoch 37, Train Loss 0.488587, Valid_loss 0.699002
Epoch 38, Train Loss 0.487487, Valid_loss 0.701990
Epoch 39, Train Loss 0.486473, Valid_loss 0.689032
Epoch 40, Train Loss 0.485488, Valid_loss 0.705054
Epoch 41, Train Loss 0.484439, Valid_loss 0.693225
Epoch 42, Train Loss 0.483392, Valid_loss 0.705815
Epoch 43, Train Loss 0.483220, Valid_loss 0.692869
Epoch 44, Train Loss 0.482346, Valid_loss 0.704073
Epoch 45, Train Loss 0.481436, Valid_loss 0.689335
Epoch 46, Train Loss 0.480398, Valid_loss 0.694574
Epoch 47, Train Loss 0.479980, Valid_loss 0.689887
Epoch 48, Train Loss 0.478051, Valid_loss 0.684136
Epoch 49, Train Loss 0.478044, Valid_loss 0.689376
Epoch 50, Train Loss 0.477194, Valid_loss 0.681109
Epoch 51, Train Loss 0.476389, Valid_loss 0.686315
Epoch 52, Train Loss 0.476219, Valid_loss 0.680461
Epoch 53, Train Loss 0.475945, Valid_loss 0.685441
Epoch 54, Train Loss 0.476173, Valid_loss 0.679009
Epoch 55, Train Loss 0.475318, Valid_loss 0.675776
Epoch 56, Train Loss 0.475324, Valid_loss 0.682132
Epoch 57, Train Loss 0.474299, Valid_loss 0.670814
Epoch 58, Train Loss 0.473943, Valid_loss 0.678863
Epoch 59, Train Loss 0.473844, Valid_loss 0.671442
Epoch 60, Train Loss 0.474478, Valid_loss 0.674260
Epoch 61, Train Loss 0.473813, Valid_loss 0.673241
Epoch 62, Train Loss 0.473133, Valid_loss 0.668967
Epoch 63, Train Loss 0.472979, Valid_loss 0.669072
Epoch 64, Train Loss 0.471853, Valid_loss 0.671198
Control_Participant5 -- true: normal -- pred: normal
COVID19_Participant26 -- true: COVID-19 -- pred: COVID-19
true :  [0, 1]
pred :  [0, 1]
Confusion Matrix: [1 0 0 1]
Best performance: Epoch 7, Loss 0.590981, Test ACC 1.000000, Test AUC 1.000000, Test Recall 1.000000, Test Precision 1.000000
✅ Total valid splits used: 1
🔁 Repeat 3, Fold 1
🔍 Split #2
  → train_p_index 환자 수: 17
  → test_p_index 환자 수: 2
  → train 환자 ID: ['COVID19_Participant13', 'COVID19_Participant17', 'COVID19_Participant19', 'COVID19_Participant20', 'COVID19_Participant22', 'COVID19_Participant26', 'COVID19_Participant28', 'COVID19_Participant29', 'COVID19_Participant32', 'COVID19_Participant37', 'COVID19_Participant4', 'Control_Participant11', 'Control_Participant15', 'Control_Participant3', 'Control_Participant5', 'Control_Participant7', 'Control_Participant9']
  → test  환자 ID: ['COVID19_Participant26', 'Control_Participant7']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: Control_Participant11, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: COVID19_Participant26, Label: 1
    ID: Control_Participant7, Label: 0
train_p_index_ 11
valid_p_index 6
test_p_index 2
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Keratinocytes', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Neurons', 'iPS_cells', 'Embryonic_stem_cells', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
data augment 실행 함
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:10,  9.53it/s]  2%|▏         | 2/100 [00:00<00:10,  9.18it/s]  3%|▎         | 3/100 [00:00<00:10,  9.06it/s]  4%|▍         | 4/100 [00:00<00:10,  9.04it/s]  5%|▌         | 5/100 [00:00<00:10,  9.09it/s]  7%|▋         | 7/100 [00:00<00:09,  9.55it/s]  8%|▊         | 8/100 [00:00<00:09,  9.65it/s]  9%|▉         | 9/100 [00:00<00:09,  9.66it/s] 10%|█         | 10/100 [00:01<00:09,  9.57it/s] 11%|█         | 11/100 [00:01<00:09,  9.47it/s] 12%|█▏        | 12/100 [00:01<00:09,  9.36it/s] 13%|█▎        | 13/100 [00:01<00:09,  9.36it/s] 14%|█▍        | 14/100 [00:01<00:09,  9.35it/s] 15%|█▌        | 15/100 [00:01<00:09,  8.98it/s] 16%|█▌        | 16/100 [00:01<00:09,  8.82it/s] 17%|█▋        | 17/100 [00:01<00:09,  8.94it/s] 18%|█▊        | 18/100 [00:01<00:09,  9.06it/s] 19%|█▉        | 19/100 [00:02<00:09,  8.96it/s] 20%|██        | 20/100 [00:02<00:08,  8.95it/s] 21%|██        | 21/100 [00:02<00:09,  8.73it/s] 22%|██▏       | 22/100 [00:02<00:08,  8.72it/s] 23%|██▎       | 23/100 [00:02<00:09,  8.47it/s] 24%|██▍       | 24/100 [00:02<00:08,  8.50it/s] 25%|██▌       | 25/100 [00:02<00:09,  7.99it/s] 26%|██▌       | 26/100 [00:02<00:08,  8.25it/s] 27%|██▋       | 27/100 [00:03<00:08,  8.27it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.44it/s] 29%|██▉       | 29/100 [00:03<00:08,  8.65it/s] 30%|███       | 30/100 [00:03<00:08,  8.62it/s] 31%|███       | 31/100 [00:03<00:08,  8.54it/s] 32%|███▏      | 32/100 [00:03<00:07,  8.53it/s] 33%|███▎      | 33/100 [00:03<00:07,  8.57it/s] 34%|███▍      | 34/100 [00:03<00:07,  8.45it/s] 35%|███▌      | 35/100 [00:03<00:07,  8.38it/s] 36%|███▌      | 36/100 [00:04<00:07,  8.41it/s] 37%|███▋      | 37/100 [00:04<00:07,  8.43it/s] 38%|███▊      | 38/100 [00:04<00:07,  8.58it/s] 39%|███▉      | 39/100 [00:04<00:06,  8.79it/s] 40%|████      | 40/100 [00:04<00:07,  8.44it/s] 41%|████      | 41/100 [00:04<00:06,  8.43it/s] 42%|████▏     | 42/100 [00:04<00:06,  8.39it/s] 43%|████▎     | 43/100 [00:04<00:06,  8.31it/s] 44%|████▍     | 44/100 [00:05<00:06,  8.15it/s] 45%|████▌     | 45/100 [00:05<00:06,  7.94it/s] 46%|████▌     | 46/100 [00:05<00:06,  8.11it/s] 47%|████▋     | 47/100 [00:05<00:06,  8.09it/s] 48%|████▊     | 48/100 [00:05<00:06,  8.10it/s] 49%|████▉     | 49/100 [00:05<00:06,  8.01it/s] 50%|█████     | 50/100 [00:05<00:06,  7.57it/s] 51%|█████     | 51/100 [00:05<00:06,  7.54it/s] 52%|█████▏    | 52/100 [00:06<00:06,  7.75it/s] 53%|█████▎    | 53/100 [00:06<00:06,  7.83it/s] 54%|█████▍    | 54/100 [00:06<00:05,  7.87it/s] 55%|█████▌    | 55/100 [00:06<00:05,  7.98it/s] 56%|█████▌    | 56/100 [00:06<00:05,  8.15it/s] 57%|█████▋    | 57/100 [00:06<00:05,  7.93it/s] 58%|█████▊    | 58/100 [00:06<00:05,  8.17it/s] 59%|█████▉    | 59/100 [00:06<00:05,  8.09it/s] 60%|██████    | 60/100 [00:07<00:04,  8.13it/s] 61%|██████    | 61/100 [00:07<00:04,  7.94it/s] 62%|██████▏   | 62/100 [00:07<00:04,  8.02it/s] 63%|██████▎   | 63/100 [00:07<00:04,  7.96it/s] 64%|██████▍   | 64/100 [00:07<00:04,  7.99it/s] 65%|██████▌   | 65/100 [00:07<00:04,  7.87it/s] 66%|██████▌   | 66/100 [00:07<00:04,  7.88it/s] 67%|██████▋   | 67/100 [00:07<00:04,  7.79it/s] 68%|██████▊   | 68/100 [00:08<00:04,  7.75it/s] 69%|██████▉   | 69/100 [00:08<00:03,  7.84it/s] 70%|███████   | 70/100 [00:08<00:03,  7.81it/s] 71%|███████   | 71/100 [00:08<00:03,  7.46it/s] 72%|███████▏  | 72/100 [00:08<00:03,  7.57it/s] 73%|███████▎  | 73/100 [00:08<00:03,  7.68it/s] 74%|███████▍  | 74/100 [00:08<00:03,  7.59it/s] 75%|███████▌  | 75/100 [00:09<00:03,  7.44it/s] 76%|███████▌  | 76/100 [00:09<00:03,  7.54it/s] 77%|███████▋  | 77/100 [00:09<00:03,  7.62it/s] 78%|███████▊  | 78/100 [00:09<00:02,  7.50it/s] 79%|███████▉  | 79/100 [00:09<00:02,  7.59it/s] 80%|████████  | 80/100 [00:09<00:02,  7.55it/s] 81%|████████  | 81/100 [00:09<00:02,  7.25it/s] 82%|████████▏ | 82/100 [00:09<00:02,  7.45it/s] 83%|████████▎ | 83/100 [00:10<00:02,  7.71it/s] 84%|████████▍ | 84/100 [00:10<00:02,  7.78it/s] 85%|████████▌ | 85/100 [00:10<00:01,  7.78it/s] 86%|████████▌ | 86/100 [00:10<00:01,  7.37it/s] 87%|████████▋ | 87/100 [00:10<00:01,  7.51it/s] 88%|████████▊ | 88/100 [00:10<00:01,  7.48it/s] 89%|████████▉ | 89/100 [00:10<00:01,  7.58it/s] 90%|█████████ | 90/100 [00:10<00:01,  7.45it/s] 91%|█████████ | 91/100 [00:11<00:01,  7.53it/s] 92%|█████████▏| 92/100 [00:11<00:01,  7.63it/s] 93%|█████████▎| 93/100 [00:11<00:00,  7.39it/s] 94%|█████████▍| 94/100 [00:11<00:00,  7.37it/s] 95%|█████████▌| 95/100 [00:11<00:00,  7.60it/s] 96%|█████████▌| 96/100 [00:11<00:00,  7.73it/s] 97%|█████████▋| 97/100 [00:11<00:00,  7.65it/s] 98%|█████████▊| 98/100 [00:12<00:00,  7.64it/s] 99%|█████████▉| 99/100 [00:12<00:00,  7.63it/s]100%|██████████| 100/100 [00:12<00:00,  7.69it/s]100%|██████████| 100/100 [00:12<00:00,  8.13it/s]
eval_p_index len:  8
individual_train 111
individual_eval 8
train data의 x, y, id 길이: 111 111 111
valid data의 x, y, id 길이: 6 6 6
test data의 x, y, id 길이: 2 2 2
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 38.00 MB
cuda
Epoch 1, Train Loss 0.670283, Valid_loss 0.637184
Epoch 2, Train Loss 0.661822, Valid_loss 0.628544
Epoch 3, Train Loss 0.653490, Valid_loss 0.622417
Epoch 4, Train Loss 0.644870, Valid_loss 0.616108
Epoch 5, Train Loss 0.637016, Valid_loss 0.602741
Epoch 6, Train Loss 0.629467, Valid_loss 0.595538
Epoch 7, Train Loss 0.623444, Valid_loss 0.590440
Epoch 8, Train Loss 0.617975, Valid_loss 0.586456
Epoch 9, Train Loss 0.612523, Valid_loss 0.580017
Epoch 10, Train Loss 0.605349, Valid_loss 0.575487
Epoch 11, Train Loss 0.598996, Valid_loss 0.572426
Epoch 12, Train Loss 0.593449, Valid_loss 0.570481
Epoch 13, Train Loss 0.589014, Valid_loss 0.567867
Epoch 14, Train Loss 0.585594, Valid_loss 0.563145
Epoch 15, Train Loss 0.581587, Valid_loss 0.559634
Epoch 16, Train Loss 0.578917, Valid_loss 0.557497
Epoch 17, Train Loss 0.575694, Valid_loss 0.553930
Epoch 18, Train Loss 0.572784, Valid_loss 0.552020
Epoch 19, Train Loss 0.570472, Valid_loss 0.550180
Epoch 20, Train Loss 0.567467, Valid_loss 0.548007
Epoch 21, Train Loss 0.565391, Valid_loss 0.545686
Epoch 22, Train Loss 0.562468, Valid_loss 0.544223
Epoch 23, Train Loss 0.560328, Valid_loss 0.542059
Epoch 24, Train Loss 0.556579, Valid_loss 0.538696
Epoch 25, Train Loss 0.552455, Valid_loss 0.534662
Epoch 26, Train Loss 0.547975, Valid_loss 0.527266
Epoch 27, Train Loss 0.542918, Valid_loss 0.520068
Epoch 28, Train Loss 0.538230, Valid_loss 0.506870
Epoch 29, Train Loss 0.532581, Valid_loss 0.501745
Epoch 30, Train Loss 0.526643, Valid_loss 0.486585
Epoch 31, Train Loss 0.520950, Valid_loss 0.477503
Epoch 32, Train Loss 0.515149, Valid_loss 0.467078
Epoch 33, Train Loss 0.509724, Valid_loss 0.454975
Epoch 34, Train Loss 0.504601, Valid_loss 0.451530
Epoch 35, Train Loss 0.500585, Valid_loss 0.443742
Epoch 36, Train Loss 0.496511, Valid_loss 0.440259
Epoch 37, Train Loss 0.491981, Valid_loss 0.435806
Epoch 38, Train Loss 0.488568, Valid_loss 0.434309
Epoch 39, Train Loss 0.486486, Valid_loss 0.433560
Epoch 40, Train Loss 0.483535, Valid_loss 0.429200
Epoch 41, Train Loss 0.481886, Valid_loss 0.427466
Epoch 42, Train Loss 0.479207, Valid_loss 0.425491
Epoch 43, Train Loss 0.476684, Valid_loss 0.424002
Epoch 44, Train Loss 0.475548, Valid_loss 0.419666
Epoch 45, Train Loss 0.474012, Valid_loss 0.417031
Epoch 46, Train Loss 0.472266, Valid_loss 0.417773
Epoch 47, Train Loss 0.470340, Valid_loss 0.412595
Epoch 48, Train Loss 0.469259, Valid_loss 0.409776
Epoch 49, Train Loss 0.468078, Valid_loss 0.408895
Epoch 50, Train Loss 0.466495, Valid_loss 0.406199
Epoch 51, Train Loss 0.464746, Valid_loss 0.404983
Epoch 52, Train Loss 0.464569, Valid_loss 0.405581
Epoch 53, Train Loss 0.464191, Valid_loss 0.404510
Epoch 54, Train Loss 0.463734, Valid_loss 0.403149
Epoch 55, Train Loss 0.463244, Valid_loss 0.404110
Epoch 56, Train Loss 0.462550, Valid_loss 0.403403
Epoch 57, Train Loss 0.461869, Valid_loss 0.401771
Epoch 58, Train Loss 0.460710, Valid_loss 0.402077
Epoch 59, Train Loss 0.460659, Valid_loss 0.402390
COVID19_Participant26 -- true: COVID-19 -- pred: normal
Control_Participant7 -- true: normal -- pred: COVID-19
true :  [1, 0]
pred :  [0, 1]
Confusion Matrix: [0 1 1 0]
Best performance: Epoch 57, Loss 0.461869, Test ACC 0.000000, Test AUC 0.000000, Test Recall 0.000000, Test Precision 0.000000
✅ Total valid splits used: 2
🔁 Repeat 3, Fold 2
🔍 Split #3
  → train_p_index 환자 수: 15
  → test_p_index 환자 수: 4
  → train 환자 ID: ['COVID19_Participant13', 'COVID19_Participant15', 'COVID19_Participant17', 'COVID19_Participant19', 'COVID19_Participant20', 'COVID19_Participant22', 'COVID19_Participant26', 'COVID19_Participant28', 'COVID19_Participant29', 'COVID19_Participant32', 'COVID19_Participant4', 'Control_Participant10', 'Control_Participant11', 'Control_Participant3', 'Control_Participant7']
  → test  환자 ID: ['COVID19_Participant31', 'Control_Participant4', 'Control_Participant7', 'Control_Participant7']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: Control_Participant10, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant7, Label: 0
  → test 환자 ID 및 라벨:
    ID: COVID19_Participant31, Label: 1
    ID: Control_Participant4, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant7, Label: 0
train_p_index_ 10
valid_p_index 5
test_p_index 4
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Keratinocytes', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Neurons', 'iPS_cells', 'Embryonic_stem_cells', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
data augment 실행 함
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:12,  7.78it/s]  2%|▏         | 2/100 [00:00<00:12,  8.12it/s]  3%|▎         | 3/100 [00:00<00:11,  8.47it/s]  4%|▍         | 4/100 [00:00<00:11,  8.05it/s]  5%|▌         | 5/100 [00:00<00:11,  8.46it/s]  6%|▌         | 6/100 [00:00<00:11,  8.36it/s]  7%|▋         | 7/100 [00:00<00:11,  8.17it/s]  8%|▊         | 8/100 [00:00<00:11,  8.24it/s]  9%|▉         | 9/100 [00:01<00:10,  8.68it/s] 10%|█         | 10/100 [00:01<00:10,  8.69it/s] 11%|█         | 11/100 [00:01<00:10,  8.35it/s] 12%|█▏        | 12/100 [00:01<00:10,  8.44it/s] 13%|█▎        | 13/100 [00:01<00:10,  8.36it/s] 14%|█▍        | 14/100 [00:01<00:10,  8.23it/s] 15%|█▌        | 15/100 [00:01<00:10,  8.44it/s] 16%|█▌        | 16/100 [00:01<00:09,  8.70it/s] 17%|█▋        | 17/100 [00:02<00:09,  8.53it/s] 18%|█▊        | 18/100 [00:02<00:09,  8.40it/s] 19%|█▉        | 19/100 [00:02<00:09,  8.48it/s] 20%|██        | 20/100 [00:02<00:09,  8.36it/s] 21%|██        | 21/100 [00:02<00:09,  8.41it/s] 22%|██▏       | 22/100 [00:02<00:09,  8.51it/s] 23%|██▎       | 23/100 [00:02<00:09,  8.52it/s] 24%|██▍       | 24/100 [00:02<00:08,  8.47it/s] 25%|██▌       | 25/100 [00:02<00:08,  8.55it/s] 26%|██▌       | 26/100 [00:03<00:09,  8.13it/s] 27%|██▋       | 27/100 [00:03<00:09,  8.02it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.29it/s] 29%|██▉       | 29/100 [00:03<00:08,  8.28it/s] 30%|███       | 30/100 [00:03<00:08,  7.92it/s] 31%|███       | 31/100 [00:03<00:08,  8.34it/s] 32%|███▏      | 32/100 [00:03<00:08,  8.29it/s] 33%|███▎      | 33/100 [00:03<00:08,  8.36it/s] 34%|███▍      | 34/100 [00:04<00:07,  8.46it/s] 35%|███▌      | 35/100 [00:04<00:07,  8.36it/s] 36%|███▌      | 36/100 [00:04<00:07,  8.19it/s] 37%|███▋      | 37/100 [00:04<00:07,  8.29it/s] 38%|███▊      | 38/100 [00:04<00:07,  8.15it/s] 39%|███▉      | 39/100 [00:04<00:07,  8.07it/s] 40%|████      | 40/100 [00:04<00:07,  7.56it/s] 41%|████      | 41/100 [00:04<00:07,  7.59it/s] 42%|████▏     | 42/100 [00:05<00:07,  7.43it/s] 43%|████▎     | 43/100 [00:05<00:07,  7.69it/s] 44%|████▍     | 44/100 [00:05<00:07,  7.77it/s] 45%|████▌     | 45/100 [00:05<00:07,  7.74it/s] 46%|████▌     | 46/100 [00:05<00:06,  7.83it/s] 47%|████▋     | 47/100 [00:05<00:06,  7.79it/s] 48%|████▊     | 48/100 [00:05<00:06,  7.95it/s] 49%|████▉     | 49/100 [00:05<00:06,  8.36it/s] 50%|█████     | 50/100 [00:06<00:06,  8.10it/s] 51%|█████     | 51/100 [00:06<00:05,  8.19it/s] 52%|█████▏    | 52/100 [00:06<00:05,  8.19it/s] 53%|█████▎    | 53/100 [00:06<00:05,  7.98it/s] 54%|█████▍    | 54/100 [00:06<00:05,  7.85it/s] 55%|█████▌    | 55/100 [00:06<00:05,  7.92it/s] 56%|█████▌    | 56/100 [00:06<00:05,  7.75it/s] 57%|█████▋    | 57/100 [00:06<00:05,  7.63it/s] 58%|█████▊    | 58/100 [00:07<00:05,  7.76it/s] 59%|█████▉    | 59/100 [00:07<00:05,  7.72it/s] 60%|██████    | 60/100 [00:07<00:05,  7.73it/s] 61%|██████    | 61/100 [00:07<00:05,  7.80it/s] 62%|██████▏   | 62/100 [00:07<00:05,  7.60it/s] 63%|██████▎   | 63/100 [00:07<00:04,  7.76it/s] 64%|██████▍   | 64/100 [00:07<00:04,  7.79it/s] 65%|██████▌   | 65/100 [00:08<00:04,  7.82it/s] 66%|██████▌   | 66/100 [00:08<00:04,  7.77it/s] 67%|██████▋   | 67/100 [00:08<00:04,  7.75it/s] 68%|██████▊   | 68/100 [00:08<00:04,  7.71it/s] 69%|██████▉   | 69/100 [00:08<00:03,  7.77it/s] 70%|███████   | 70/100 [00:08<00:03,  7.72it/s] 71%|███████   | 71/100 [00:08<00:03,  7.59it/s] 72%|███████▏  | 72/100 [00:08<00:03,  7.61it/s] 73%|███████▎  | 73/100 [00:09<00:03,  7.74it/s] 74%|███████▍  | 74/100 [00:09<00:03,  7.37it/s] 75%|███████▌  | 75/100 [00:09<00:03,  7.58it/s] 76%|███████▌  | 76/100 [00:09<00:03,  7.62it/s] 77%|███████▋  | 77/100 [00:09<00:02,  7.72it/s] 78%|███████▊  | 78/100 [00:09<00:02,  7.74it/s] 79%|███████▉  | 79/100 [00:09<00:02,  7.73it/s] 80%|████████  | 80/100 [00:09<00:02,  7.54it/s] 81%|████████  | 81/100 [00:10<00:02,  7.52it/s] 82%|████████▏ | 82/100 [00:10<00:02,  7.56it/s] 83%|████████▎ | 83/100 [00:10<00:02,  7.52it/s] 84%|████████▍ | 84/100 [00:10<00:02,  7.60it/s] 85%|████████▌ | 85/100 [00:10<00:01,  7.60it/s] 86%|████████▌ | 86/100 [00:10<00:01,  7.66it/s] 87%|████████▋ | 87/100 [00:10<00:01,  7.51it/s] 88%|████████▊ | 88/100 [00:11<00:01,  7.62it/s] 89%|████████▉ | 89/100 [00:11<00:01,  7.89it/s] 90%|█████████ | 90/100 [00:11<00:01,  7.79it/s] 91%|█████████ | 91/100 [00:11<00:01,  7.75it/s] 92%|█████████▏| 92/100 [00:11<00:01,  7.80it/s] 93%|█████████▎| 93/100 [00:11<00:00,  7.74it/s] 94%|█████████▍| 94/100 [00:11<00:00,  7.73it/s] 95%|█████████▌| 95/100 [00:11<00:00,  7.71it/s] 96%|█████████▌| 96/100 [00:12<00:00,  7.81it/s] 97%|█████████▋| 97/100 [00:12<00:00,  7.71it/s] 98%|█████████▊| 98/100 [00:12<00:00,  7.51it/s] 99%|█████████▉| 99/100 [00:12<00:00,  7.54it/s]100%|██████████| 100/100 [00:12<00:00,  7.27it/s]100%|██████████| 100/100 [00:12<00:00,  7.92it/s]
eval_p_index len:  9
individual_train 110
individual_eval 9
train data의 x, y, id 길이: 110 110 110
valid data의 x, y, id 길이: 5 5 5
test data의 x, y, id 길이: 4 4 4
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 38.00 MB
cuda
Epoch 1, Train Loss 0.898431, Valid_loss 0.982557
Epoch 2, Train Loss 0.861359, Valid_loss 0.866967
Epoch 3, Train Loss 0.794376, Valid_loss 0.742214
Epoch 4, Train Loss 0.730216, Valid_loss 0.704891
Epoch 5, Train Loss 0.711414, Valid_loss 0.714153
Epoch 6, Train Loss 0.710083, Valid_loss 0.715510
Epoch 7, Train Loss 0.707361, Valid_loss 0.704706
Epoch 8, Train Loss 0.704424, Valid_loss 0.697678
Epoch 9, Train Loss 0.699424, Valid_loss 0.690434
Epoch 10, Train Loss 0.695594, Valid_loss 0.680459
Epoch 11, Train Loss 0.689645, Valid_loss 0.670815
Epoch 12, Train Loss 0.682524, Valid_loss 0.662117
Epoch 13, Train Loss 0.673943, Valid_loss 0.650554
Epoch 14, Train Loss 0.667370, Valid_loss 0.649543
Epoch 15, Train Loss 0.662163, Valid_loss 0.646213
Epoch 16, Train Loss 0.656994, Valid_loss 0.641029
Epoch 17, Train Loss 0.652210, Valid_loss 0.642573
Epoch 18, Train Loss 0.648424, Valid_loss 0.639712
Epoch 19, Train Loss 0.644379, Valid_loss 0.634559
Epoch 20, Train Loss 0.640298, Valid_loss 0.632370
Epoch 21, Train Loss 0.636008, Valid_loss 0.628893
Epoch 22, Train Loss 0.631669, Valid_loss 0.624251
Epoch 23, Train Loss 0.628398, Valid_loss 0.623475
Epoch 24, Train Loss 0.624380, Valid_loss 0.619632
Epoch 25, Train Loss 0.621078, Valid_loss 0.619494
Epoch 26, Train Loss 0.617180, Valid_loss 0.616145
Epoch 27, Train Loss 0.612997, Valid_loss 0.617005
Epoch 28, Train Loss 0.610336, Valid_loss 0.618126
Epoch 29, Train Loss 0.608127, Valid_loss 0.610088
Epoch 30, Train Loss 0.605466, Valid_loss 0.612957
Epoch 31, Train Loss 0.602769, Valid_loss 0.610845
Epoch 32, Train Loss 0.601582, Valid_loss 0.607159
Epoch 33, Train Loss 0.599342, Valid_loss 0.601296
Epoch 34, Train Loss 0.597329, Valid_loss 0.595494
Epoch 35, Train Loss 0.595420, Valid_loss 0.594414
Epoch 36, Train Loss 0.594417, Valid_loss 0.592160
Epoch 37, Train Loss 0.591668, Valid_loss 0.583951
Epoch 38, Train Loss 0.588538, Valid_loss 0.591082
Epoch 39, Train Loss 0.589254, Valid_loss 0.581144
Epoch 40, Train Loss 0.586599, Valid_loss 0.582716
Epoch 41, Train Loss 0.586815, Valid_loss 0.580741
Epoch 42, Train Loss 0.586555, Valid_loss 0.569321
Epoch 43, Train Loss 0.584544, Valid_loss 0.585707
Epoch 44, Train Loss 0.582011, Valid_loss 0.564762
Epoch 45, Train Loss 0.579711, Valid_loss 0.570949
Epoch 46, Train Loss 0.579149, Valid_loss 0.565784
Epoch 47, Train Loss 0.577724, Valid_loss 0.563865
Epoch 48, Train Loss 0.576861, Valid_loss 0.561261
Epoch 49, Train Loss 0.575357, Valid_loss 0.559762
Epoch 50, Train Loss 0.574542, Valid_loss 0.557354
Epoch 51, Train Loss 0.573218, Valid_loss 0.557059
Epoch 52, Train Loss 0.571946, Valid_loss 0.555917
Epoch 53, Train Loss 0.572515, Valid_loss 0.556237
Epoch 54, Train Loss 0.571253, Valid_loss 0.553271
Epoch 55, Train Loss 0.571812, Valid_loss 0.553517
Epoch 56, Train Loss 0.569982, Valid_loss 0.552528
Epoch 57, Train Loss 0.570516, Valid_loss 0.552414
Epoch 58, Train Loss 0.569850, Valid_loss 0.551107
Epoch 59, Train Loss 0.568161, Valid_loss 0.548343
Epoch 60, Train Loss 0.568561, Valid_loss 0.551078
Epoch 61, Train Loss 0.568320, Valid_loss 0.546888
Epoch 62, Train Loss 0.567355, Valid_loss 0.546454
Epoch 63, Train Loss 0.566964, Valid_loss 0.547754
Epoch 64, Train Loss 0.566785, Valid_loss 0.545462
Epoch 65, Train Loss 0.566839, Valid_loss 0.544248
Epoch 66, Train Loss 0.565833, Valid_loss 0.542939
Epoch 67, Train Loss 0.563339, Valid_loss 0.543910
Epoch 68, Train Loss 0.565392, Valid_loss 0.541151
Epoch 69, Train Loss 0.562489, Valid_loss 0.538281
Epoch 70, Train Loss 0.562671, Valid_loss 0.540502
Epoch 71, Train Loss 0.563110, Valid_loss 0.540231
Epoch 72, Train Loss 0.562611, Valid_loss 0.537089
Epoch 73, Train Loss 0.562129, Valid_loss 0.537249
Epoch 74, Train Loss 0.561319, Valid_loss 0.536555
Epoch 75, Train Loss 0.559100, Valid_loss 0.532057
Epoch 76, Train Loss 0.560226, Valid_loss 0.534271
Epoch 77, Train Loss 0.559975, Valid_loss 0.532964
Epoch 78, Train Loss 0.559631, Valid_loss 0.529233
Epoch 79, Train Loss 0.557874, Valid_loss 0.529786
Epoch 80, Train Loss 0.557835, Valid_loss 0.529132
Epoch 81, Train Loss 0.557816, Valid_loss 0.530988
Epoch 82, Train Loss 0.556278, Valid_loss 0.527423
Epoch 83, Train Loss 0.555883, Valid_loss 0.526660
Epoch 84, Train Loss 0.556225, Valid_loss 0.526716
Epoch 85, Train Loss 0.554975, Valid_loss 0.523956
Epoch 86, Train Loss 0.553896, Valid_loss 0.524691
Epoch 87, Train Loss 0.554620, Valid_loss 0.522681
Epoch 88, Train Loss 0.553696, Valid_loss 0.521959
Epoch 89, Train Loss 0.553040, Valid_loss 0.520020
Epoch 90, Train Loss 0.551979, Valid_loss 0.520036
Epoch 91, Train Loss 0.552370, Valid_loss 0.518170
Epoch 92, Train Loss 0.552062, Valid_loss 0.518799
Epoch 93, Train Loss 0.551602, Valid_loss 0.516812
Epoch 94, Train Loss 0.551756, Valid_loss 0.516094
Epoch 95, Train Loss 0.551721, Valid_loss 0.517692
Epoch 96, Train Loss 0.549910, Valid_loss 0.512369
Epoch 97, Train Loss 0.549394, Valid_loss 0.513022
Epoch 98, Train Loss 0.548537, Valid_loss 0.512109
Epoch 99, Train Loss 0.548554, Valid_loss 0.510719
Epoch 100, Train Loss 0.548328, Valid_loss 0.510049
COVID19_Participant31 -- true: COVID-19 -- pred: COVID-19
Control_Participant4 -- true: normal -- pred: COVID-19
Control_Participant7 -- true: normal -- pred: normal
Control_Participant7 -- true: normal -- pred: COVID-19
true :  [1, 0, 0, 0]
pred :  [1, 1, 0, 1]
Confusion Matrix: [1 2 0 1]
Best performance: Epoch 100, Loss 0.548328, Test ACC 0.500000, Test AUC 0.666667, Test Recall 1.000000, Test Precision 0.333333
✅ Total valid splits used: 3
🔁 Repeat 3, Fold 3
🔍 Split #4
  → train_p_index 환자 수: 12
  → test_p_index 환자 수: 7
  → train 환자 ID: ['COVID19_Participant13', 'COVID19_Participant15', 'COVID19_Participant17', 'COVID19_Participant19', 'COVID19_Participant29', 'COVID19_Participant37', 'Control_Participant10', 'Control_Participant11', 'Control_Participant15', 'Control_Participant5', 'Control_Participant7', 'Control_Participant9']
  → test  환자 ID: ['Control_Participant10', 'Control_Participant5', 'Control_Participant7', 'COVID19_Participant25', 'Control_Participant9', 'Control_Participant1', 'COVID19_Participant13']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: Control_Participant10, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: Control_Participant10, Label: 1
    ID: Control_Participant5, Label: 1
    ID: Control_Participant7, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: Control_Participant9, Label: 1
    ID: Control_Participant1, Label: 1
    ID: COVID19_Participant13, Label: 0
train_p_index_ 8
valid_p_index 4
test_p_index 7
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Keratinocytes', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Neurons', 'iPS_cells', 'Embryonic_stem_cells', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
data augment 실행 함
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:10,  9.12it/s]  2%|▏         | 2/100 [00:00<00:11,  8.75it/s]  3%|▎         | 3/100 [00:00<00:11,  8.66it/s]  4%|▍         | 4/100 [00:00<00:10,  9.11it/s]  5%|▌         | 5/100 [00:00<00:10,  9.25it/s]  6%|▌         | 6/100 [00:00<00:10,  8.89it/s]  7%|▋         | 7/100 [00:00<00:10,  8.97it/s]  8%|▊         | 8/100 [00:00<00:10,  9.13it/s]  9%|▉         | 9/100 [00:00<00:10,  9.02it/s] 10%|█         | 10/100 [00:01<00:10,  8.98it/s] 11%|█         | 11/100 [00:01<00:09,  8.99it/s] 12%|█▏        | 12/100 [00:01<00:10,  8.78it/s] 13%|█▎        | 13/100 [00:01<00:09,  8.78it/s] 14%|█▍        | 14/100 [00:01<00:09,  9.03it/s] 15%|█▌        | 15/100 [00:01<00:09,  8.94it/s] 16%|█▌        | 16/100 [00:01<00:09,  9.07it/s] 17%|█▋        | 17/100 [00:01<00:09,  8.96it/s] 18%|█▊        | 18/100 [00:02<00:09,  8.75it/s] 19%|█▉        | 19/100 [00:02<00:09,  8.85it/s] 20%|██        | 20/100 [00:02<00:09,  8.83it/s] 21%|██        | 21/100 [00:02<00:08,  8.79it/s] 22%|██▏       | 22/100 [00:02<00:08,  8.74it/s] 23%|██▎       | 23/100 [00:02<00:08,  8.68it/s] 24%|██▍       | 24/100 [00:02<00:08,  8.64it/s] 25%|██▌       | 25/100 [00:02<00:08,  8.63it/s] 26%|██▌       | 26/100 [00:02<00:08,  8.65it/s] 27%|██▋       | 27/100 [00:03<00:08,  8.62it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.62it/s] 29%|██▉       | 29/100 [00:03<00:08,  8.63it/s] 30%|███       | 30/100 [00:03<00:08,  8.33it/s] 31%|███       | 31/100 [00:03<00:08,  8.44it/s] 32%|███▏      | 32/100 [00:03<00:07,  8.67it/s] 33%|███▎      | 33/100 [00:03<00:07,  8.68it/s] 34%|███▍      | 34/100 [00:03<00:07,  8.55it/s] 35%|███▌      | 35/100 [00:03<00:07,  8.46it/s] 36%|███▌      | 36/100 [00:04<00:07,  8.35it/s] 37%|███▋      | 37/100 [00:04<00:07,  8.41it/s] 38%|███▊      | 38/100 [00:04<00:07,  8.44it/s] 39%|███▉      | 39/100 [00:04<00:07,  8.36it/s] 40%|████      | 40/100 [00:04<00:07,  8.30it/s] 41%|████      | 41/100 [00:04<00:07,  8.43it/s] 42%|████▏     | 42/100 [00:04<00:06,  8.73it/s] 43%|████▎     | 43/100 [00:04<00:06,  8.59it/s] 44%|████▍     | 44/100 [00:05<00:06,  8.52it/s] 45%|████▌     | 45/100 [00:05<00:06,  8.62it/s] 46%|████▌     | 46/100 [00:05<00:06,  8.76it/s] 47%|████▋     | 47/100 [00:05<00:06,  8.57it/s] 48%|████▊     | 48/100 [00:05<00:06,  8.44it/s] 49%|████▉     | 49/100 [00:05<00:05,  8.54it/s] 50%|█████     | 50/100 [00:05<00:05,  8.54it/s] 51%|█████     | 51/100 [00:05<00:05,  8.47it/s] 52%|█████▏    | 52/100 [00:05<00:05,  8.75it/s] 53%|█████▎    | 53/100 [00:06<00:05,  8.73it/s] 54%|█████▍    | 54/100 [00:06<00:05,  8.53it/s] 55%|█████▌    | 55/100 [00:06<00:05,  8.65it/s] 56%|█████▌    | 56/100 [00:06<00:05,  8.67it/s] 57%|█████▋    | 57/100 [00:06<00:05,  8.49it/s] 58%|█████▊    | 58/100 [00:06<00:04,  8.57it/s] 59%|█████▉    | 59/100 [00:06<00:04,  8.40it/s] 60%|██████    | 60/100 [00:06<00:04,  8.59it/s] 61%|██████    | 61/100 [00:07<00:04,  8.70it/s] 62%|██████▏   | 62/100 [00:07<00:04,  8.43it/s] 63%|██████▎   | 63/100 [00:07<00:04,  8.40it/s] 64%|██████▍   | 64/100 [00:07<00:04,  8.53it/s] 65%|██████▌   | 65/100 [00:07<00:04,  8.35it/s] 66%|██████▌   | 66/100 [00:07<00:04,  8.23it/s] 67%|██████▋   | 67/100 [00:07<00:04,  8.07it/s] 68%|██████▊   | 68/100 [00:07<00:03,  8.50it/s] 69%|██████▉   | 69/100 [00:07<00:03,  8.47it/s] 70%|███████   | 70/100 [00:08<00:03,  8.73it/s] 71%|███████   | 71/100 [00:08<00:03,  8.36it/s] 72%|███████▏  | 72/100 [00:08<00:03,  8.25it/s] 73%|███████▎  | 73/100 [00:08<00:03,  8.14it/s] 74%|███████▍  | 74/100 [00:08<00:03,  8.06it/s] 75%|███████▌  | 75/100 [00:08<00:03,  8.01it/s] 76%|███████▌  | 76/100 [00:08<00:03,  7.93it/s] 77%|███████▋  | 77/100 [00:08<00:02,  7.90it/s] 78%|███████▊  | 78/100 [00:09<00:02,  7.95it/s] 79%|███████▉  | 79/100 [00:09<00:02,  7.95it/s] 80%|████████  | 80/100 [00:09<00:02,  7.92it/s] 81%|████████  | 81/100 [00:09<00:02,  8.30it/s] 82%|████████▏ | 82/100 [00:09<00:02,  8.20it/s] 83%|████████▎ | 83/100 [00:09<00:02,  8.06it/s] 84%|████████▍ | 84/100 [00:09<00:01,  8.02it/s] 85%|████████▌ | 85/100 [00:09<00:01,  8.14it/s] 86%|████████▌ | 86/100 [00:10<00:01,  8.02it/s] 87%|████████▋ | 87/100 [00:10<00:01,  7.95it/s] 88%|████████▊ | 88/100 [00:10<00:01,  7.90it/s] 89%|████████▉ | 89/100 [00:10<00:01,  7.91it/s] 90%|█████████ | 90/100 [00:10<00:01,  7.84it/s] 91%|█████████ | 91/100 [00:10<00:01,  7.92it/s] 92%|█████████▏| 92/100 [00:10<00:01,  7.82it/s] 93%|█████████▎| 93/100 [00:11<00:00,  7.72it/s] 94%|█████████▍| 94/100 [00:11<00:00,  7.69it/s] 95%|█████████▌| 95/100 [00:11<00:00,  7.93it/s] 96%|█████████▌| 96/100 [00:11<00:00,  7.87it/s] 97%|█████████▋| 97/100 [00:11<00:00,  7.73it/s] 98%|█████████▊| 98/100 [00:11<00:00,  7.78it/s] 99%|█████████▉| 99/100 [00:11<00:00,  7.92it/s]100%|██████████| 100/100 [00:11<00:00,  7.96it/s]100%|██████████| 100/100 [00:11<00:00,  8.41it/s]
eval_p_index len:  11
individual_train 108
individual_eval 11
train data의 x, y, id 길이: 108 108 108
valid data의 x, y, id 길이: 4 4 4
test data의 x, y, id 길이: 7 7 7
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 38.00 MB
cuda
Epoch 1, Train Loss 0.704521, Valid_loss 0.694771
Epoch 2, Train Loss 0.695692, Valid_loss 0.681184
Epoch 3, Train Loss 0.687289, Valid_loss 0.672325
Epoch 4, Train Loss 0.675802, Valid_loss 0.660175
Epoch 5, Train Loss 0.664768, Valid_loss 0.645371
Epoch 6, Train Loss 0.647618, Valid_loss 0.625579
Epoch 7, Train Loss 0.630157, Valid_loss 0.617757
Epoch 8, Train Loss 0.622305, Valid_loss 0.612528
Epoch 9, Train Loss 0.612462, Valid_loss 0.604025
Epoch 10, Train Loss 0.606438, Valid_loss 0.593273
Epoch 11, Train Loss 0.600519, Valid_loss 0.586455
Epoch 12, Train Loss 0.594329, Valid_loss 0.580416
Epoch 13, Train Loss 0.586879, Valid_loss 0.575872
Epoch 14, Train Loss 0.577281, Valid_loss 0.564852
Epoch 15, Train Loss 0.576521, Valid_loss 0.560836
Epoch 16, Train Loss 0.573862, Valid_loss 0.557630
Epoch 17, Train Loss 0.569172, Valid_loss 0.552684
Epoch 18, Train Loss 0.569505, Valid_loss 0.554777
Epoch 19, Train Loss 0.566784, Valid_loss 0.550687
Epoch 20, Train Loss 0.566414, Valid_loss 0.550073
Epoch 21, Train Loss 0.566066, Valid_loss 0.550356
Epoch 22, Train Loss 0.564426, Valid_loss 0.548932
Epoch 23, Train Loss 0.561858, Valid_loss 0.548081
Epoch 24, Train Loss 0.559601, Valid_loss 0.546034
Epoch 25, Train Loss 0.558769, Valid_loss 0.545615
Epoch 26, Train Loss 0.560888, Valid_loss 0.542953
Epoch 27, Train Loss 0.558166, Valid_loss 0.543338
Epoch 28, Train Loss 0.558473, Valid_loss 0.541710
Epoch 29, Train Loss 0.558219, Valid_loss 0.540090
Epoch 30, Train Loss 0.556079, Valid_loss 0.538539
Epoch 31, Train Loss 0.553543, Valid_loss 0.537625
Epoch 32, Train Loss 0.554494, Valid_loss 0.536802
Epoch 33, Train Loss 0.554915, Valid_loss 0.534234
Epoch 34, Train Loss 0.551589, Valid_loss 0.533580
Epoch 35, Train Loss 0.552750, Valid_loss 0.533171
Epoch 36, Train Loss 0.551655, Valid_loss 0.532566
Epoch 37, Train Loss 0.549797, Valid_loss 0.529993
Epoch 38, Train Loss 0.547611, Valid_loss 0.530814
Epoch 39, Train Loss 0.547875, Valid_loss 0.527151
Epoch 40, Train Loss 0.546004, Valid_loss 0.528999
Epoch 41, Train Loss 0.546251, Valid_loss 0.525031
Epoch 42, Train Loss 0.548610, Valid_loss 0.526553
Epoch 43, Train Loss 0.545201, Valid_loss 0.522518
Epoch 44, Train Loss 0.545086, Valid_loss 0.522947
Epoch 45, Train Loss 0.544579, Valid_loss 0.522256
Epoch 46, Train Loss 0.544125, Valid_loss 0.519265
Epoch 47, Train Loss 0.544496, Valid_loss 0.520483
Epoch 48, Train Loss 0.543740, Valid_loss 0.517197
Epoch 49, Train Loss 0.541924, Valid_loss 0.516914
Epoch 50, Train Loss 0.543555, Valid_loss 0.517033
Epoch 51, Train Loss 0.539743, Valid_loss 0.514846
Epoch 52, Train Loss 0.538274, Valid_loss 0.514089
Epoch 53, Train Loss 0.542242, Valid_loss 0.514551
Epoch 54, Train Loss 0.537692, Valid_loss 0.512880
Epoch 55, Train Loss 0.537215, Valid_loss 0.512720
Epoch 56, Train Loss 0.538964, Valid_loss 0.512811
Epoch 57, Train Loss 0.537892, Valid_loss 0.511666
Epoch 58, Train Loss 0.536272, Valid_loss 0.511775
Epoch 59, Train Loss 0.538490, Valid_loss 0.511488
Epoch 60, Train Loss 0.538171, Valid_loss 0.509806
Epoch 61, Train Loss 0.535317, Valid_loss 0.510970
Epoch 62, Train Loss 0.536472, Valid_loss 0.509043
Epoch 63, Train Loss 0.532591, Valid_loss 0.509890
Epoch 64, Train Loss 0.535430, Valid_loss 0.508308
Epoch 65, Train Loss 0.533261, Valid_loss 0.508257
Epoch 66, Train Loss 0.533812, Valid_loss 0.508395
Epoch 67, Train Loss 0.534297, Valid_loss 0.507066
Epoch 68, Train Loss 0.532600, Valid_loss 0.506616
Epoch 69, Train Loss 0.534925, Valid_loss 0.505962
Epoch 70, Train Loss 0.535761, Valid_loss 0.505704
Epoch 71, Train Loss 0.532335, Valid_loss 0.504706
Epoch 72, Train Loss 0.530094, Valid_loss 0.505790
Epoch 73, Train Loss 0.532291, Valid_loss 0.503870
Epoch 74, Train Loss 0.531870, Valid_loss 0.503417
Epoch 75, Train Loss 0.528981, Valid_loss 0.503145
Epoch 76, Train Loss 0.531211, Valid_loss 0.502757
Epoch 77, Train Loss 0.526668, Valid_loss 0.502407
Epoch 78, Train Loss 0.530115, Valid_loss 0.501709
Epoch 79, Train Loss 0.531030, Valid_loss 0.501628
Epoch 80, Train Loss 0.529150, Valid_loss 0.500711
Epoch 81, Train Loss 0.529184, Valid_loss 0.499799
Epoch 82, Train Loss 0.526554, Valid_loss 0.499886
Epoch 83, Train Loss 0.528593, Valid_loss 0.499049
Epoch 84, Train Loss 0.525983, Valid_loss 0.499345
Epoch 85, Train Loss 0.525431, Valid_loss 0.498189
Epoch 86, Train Loss 0.527543, Valid_loss 0.498247
Epoch 87, Train Loss 0.528564, Valid_loss 0.497199
Epoch 88, Train Loss 0.525409, Valid_loss 0.496847
Epoch 89, Train Loss 0.526661, Valid_loss 0.496713
Epoch 90, Train Loss 0.523893, Valid_loss 0.496254
Epoch 91, Train Loss 0.525400, Valid_loss 0.495061
Epoch 92, Train Loss 0.528540, Valid_loss 0.494578
Epoch 93, Train Loss 0.523691, Valid_loss 0.493803
Epoch 94, Train Loss 0.523852, Valid_loss 0.494149
Epoch 95, Train Loss 0.524258, Valid_loss 0.494179
Control_Participant10 -- true: normal -- pred: COVID-19
Control_Participant5 -- true: normal -- pred: normal
Control_Participant7 -- true: normal -- pred: COVID-19
COVID19_Participant25 -- true: COVID-19 -- pred: normal
Control_Participant9 -- true: normal -- pred: normal
Control_Participant1 -- true: normal -- pred: COVID-19
COVID19_Participant13 -- true: COVID-19 -- pred: COVID-19
true :  [0, 0, 0, 1, 0, 0, 1]
pred :  [1, 0, 1, 0, 0, 1, 1]
Confusion Matrix: [2 3 1 1]
Best performance: Epoch 93, Loss 0.523691, Test ACC 0.428571, Test AUC 0.500000, Test Recall 0.500000, Test Precision 0.250000
✅ Total valid splits used: 4
🔁 Repeat 3, Fold 4
🔍 Split #5
  → train_p_index 환자 수: 15
  → test_p_index 환자 수: 4
  → train 환자 ID: ['COVID19_Participant15', 'COVID19_Participant17', 'COVID19_Participant19', 'COVID19_Participant20', 'COVID19_Participant22', 'COVID19_Participant26', 'COVID19_Participant28', 'COVID19_Participant32', 'COVID19_Participant37', 'COVID19_Participant4', 'Control_Participant10', 'Control_Participant15', 'Control_Participant3', 'Control_Participant5', 'Control_Participant9']
  → test  환자 ID: ['COVID19_Participant26', 'COVID19_Participant11', 'COVID19_Participant25', 'COVID19_Participant31']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: Control_Participant10, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant25, Label: 0
    ID: COVID19_Participant31, Label: 0
train_p_index_ 10
valid_p_index 5
test_p_index 4
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Epithelial_cells', 'Epithelial_cells', 'NK_cell', 'Epithelial_cells', 'Epithelial_cells', 'Keratinocytes', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
data augment 실행 함
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:10,  9.45it/s]  2%|▏         | 2/100 [00:00<00:10,  9.37it/s]  3%|▎         | 3/100 [00:00<00:10,  9.31it/s]  4%|▍         | 4/100 [00:00<00:10,  9.42it/s]  5%|▌         | 5/100 [00:00<00:10,  9.22it/s]  6%|▌         | 6/100 [00:00<00:10,  9.21it/s]  7%|▋         | 7/100 [00:00<00:10,  9.08it/s]  8%|▊         | 8/100 [00:00<00:10,  9.12it/s] 10%|█         | 10/100 [00:01<00:09,  9.13it/s] 11%|█         | 11/100 [00:01<00:09,  8.97it/s] 12%|█▏        | 12/100 [00:01<00:09,  9.16it/s] 13%|█▎        | 13/100 [00:01<00:09,  9.32it/s] 14%|█▍        | 14/100 [00:01<00:09,  9.37it/s] 15%|█▌        | 15/100 [00:01<00:09,  9.32it/s] 16%|█▌        | 16/100 [00:01<00:09,  9.13it/s] 17%|█▋        | 17/100 [00:01<00:09,  8.90it/s] 18%|█▊        | 18/100 [00:01<00:09,  9.04it/s] 19%|█▉        | 19/100 [00:02<00:08,  9.15it/s] 20%|██        | 20/100 [00:02<00:08,  9.12it/s] 21%|██        | 21/100 [00:02<00:09,  8.47it/s] 22%|██▏       | 22/100 [00:02<00:09,  8.66it/s] 23%|██▎       | 23/100 [00:02<00:08,  8.67it/s] 24%|██▍       | 24/100 [00:02<00:08,  8.83it/s] 25%|██▌       | 25/100 [00:02<00:08,  8.93it/s] 26%|██▌       | 26/100 [00:02<00:08,  8.90it/s] 27%|██▋       | 27/100 [00:02<00:08,  8.96it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.97it/s] 29%|██▉       | 29/100 [00:03<00:07,  9.11it/s] 30%|███       | 30/100 [00:03<00:07,  9.06it/s] 31%|███       | 31/100 [00:03<00:07,  9.06it/s] 32%|███▏      | 32/100 [00:03<00:07,  8.80it/s] 33%|███▎      | 33/100 [00:03<00:07,  8.93it/s] 34%|███▍      | 34/100 [00:03<00:07,  8.96it/s] 35%|███▌      | 35/100 [00:03<00:07,  8.88it/s] 36%|███▌      | 36/100 [00:03<00:07,  8.91it/s] 37%|███▋      | 37/100 [00:04<00:07,  8.47it/s] 38%|███▊      | 38/100 [00:04<00:07,  8.34it/s] 39%|███▉      | 39/100 [00:04<00:07,  8.42it/s] 40%|████      | 40/100 [00:04<00:07,  8.11it/s] 41%|████      | 41/100 [00:04<00:07,  8.42it/s] 42%|████▏     | 42/100 [00:04<00:07,  8.23it/s] 43%|████▎     | 43/100 [00:04<00:06,  8.29it/s] 44%|████▍     | 44/100 [00:04<00:06,  8.17it/s] 45%|████▌     | 45/100 [00:05<00:06,  8.43it/s] 46%|████▌     | 46/100 [00:05<00:06,  8.47it/s] 47%|████▋     | 47/100 [00:05<00:06,  8.24it/s] 48%|████▊     | 48/100 [00:05<00:06,  8.38it/s] 49%|████▉     | 49/100 [00:05<00:06,  8.15it/s] 50%|█████     | 50/100 [00:05<00:05,  8.41it/s] 51%|█████     | 51/100 [00:05<00:06,  8.08it/s] 52%|█████▏    | 52/100 [00:05<00:06,  7.74it/s] 53%|█████▎    | 53/100 [00:06<00:06,  7.75it/s] 54%|█████▍    | 54/100 [00:06<00:05,  7.87it/s] 55%|█████▌    | 55/100 [00:06<00:05,  7.97it/s] 56%|█████▌    | 56/100 [00:06<00:05,  7.79it/s] 57%|█████▋    | 57/100 [00:06<00:05,  7.88it/s] 58%|█████▊    | 58/100 [00:06<00:05,  7.75it/s] 59%|█████▉    | 59/100 [00:06<00:05,  8.04it/s] 60%|██████    | 60/100 [00:06<00:04,  8.19it/s] 61%|██████    | 61/100 [00:07<00:04,  8.35it/s] 62%|██████▏   | 62/100 [00:07<00:04,  8.53it/s] 63%|██████▎   | 63/100 [00:07<00:04,  8.48it/s] 64%|██████▍   | 64/100 [00:07<00:04,  8.34it/s] 65%|██████▌   | 65/100 [00:07<00:04,  8.35it/s] 66%|██████▌   | 66/100 [00:07<00:04,  8.28it/s] 67%|██████▋   | 67/100 [00:07<00:04,  7.99it/s] 68%|██████▊   | 68/100 [00:07<00:04,  7.85it/s] 69%|██████▉   | 69/100 [00:08<00:03,  7.92it/s] 70%|███████   | 70/100 [00:08<00:03,  8.10it/s] 71%|███████   | 71/100 [00:08<00:03,  8.18it/s] 72%|███████▏  | 72/100 [00:08<00:03,  7.65it/s] 73%|███████▎  | 73/100 [00:08<00:03,  7.76it/s] 74%|███████▍  | 74/100 [00:08<00:03,  7.82it/s] 75%|███████▌  | 75/100 [00:08<00:03,  7.87it/s] 76%|███████▌  | 76/100 [00:08<00:02,  8.03it/s] 77%|███████▋  | 77/100 [00:09<00:02,  7.86it/s] 78%|███████▊  | 78/100 [00:09<00:02,  8.04it/s] 79%|███████▉  | 79/100 [00:09<00:02,  7.66it/s] 80%|████████  | 80/100 [00:09<00:02,  7.71it/s] 81%|████████  | 81/100 [00:09<00:02,  7.78it/s] 82%|████████▏ | 82/100 [00:09<00:02,  7.79it/s] 83%|████████▎ | 83/100 [00:09<00:02,  7.93it/s] 84%|████████▍ | 84/100 [00:09<00:02,  7.92it/s] 85%|████████▌ | 85/100 [00:10<00:01,  7.80it/s] 86%|████████▌ | 86/100 [00:10<00:01,  7.82it/s] 87%|████████▋ | 87/100 [00:10<00:01,  7.94it/s] 88%|████████▊ | 88/100 [00:10<00:01,  7.10it/s] 89%|████████▉ | 89/100 [00:10<00:01,  7.20it/s] 90%|█████████ | 90/100 [00:10<00:01,  7.27it/s] 91%|█████████ | 91/100 [00:10<00:01,  7.36it/s] 92%|█████████▏| 92/100 [00:11<00:01,  7.56it/s] 93%|█████████▎| 93/100 [00:11<00:00,  7.19it/s] 94%|█████████▍| 94/100 [00:11<00:00,  7.29it/s] 95%|█████████▌| 95/100 [00:11<00:00,  7.39it/s] 96%|█████████▌| 96/100 [00:11<00:00,  7.50it/s] 97%|█████████▋| 97/100 [00:11<00:00,  7.25it/s] 98%|█████████▊| 98/100 [00:11<00:00,  7.46it/s] 99%|█████████▉| 99/100 [00:11<00:00,  7.64it/s]100%|██████████| 100/100 [00:12<00:00,  7.68it/s]100%|██████████| 100/100 [00:12<00:00,  8.25it/s]
eval_p_index len:  9
individual_train 110
individual_eval 9
train data의 x, y, id 길이: 110 110 110
valid data의 x, y, id 길이: 5 5 5
test data의 x, y, id 길이: 4 4 4
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 38.00 MB
cuda
Epoch 1, Train Loss 0.724637, Valid_loss 0.717718
Epoch 2, Train Loss 0.692505, Valid_loss 0.679639
Epoch 3, Train Loss 0.673501, Valid_loss 0.653800
Epoch 4, Train Loss 0.661303, Valid_loss 0.641301
Epoch 5, Train Loss 0.648774, Valid_loss 0.629403
Epoch 6, Train Loss 0.629685, Valid_loss 0.607518
Epoch 7, Train Loss 0.597004, Valid_loss 0.545342
Epoch 8, Train Loss 0.549528, Valid_loss 0.460675
Epoch 9, Train Loss 0.519165, Valid_loss 0.453770
Epoch 10, Train Loss 0.509664, Valid_loss 0.446242
Epoch 11, Train Loss 0.502425, Valid_loss 0.436834
Epoch 12, Train Loss 0.495805, Valid_loss 0.436298
Epoch 13, Train Loss 0.492180, Valid_loss 0.436359
Epoch 14, Train Loss 0.487771, Valid_loss 0.436056
Epoch 15, Train Loss 0.486389, Valid_loss 0.437878
Epoch 16, Train Loss 0.484669, Valid_loss 0.435658
Epoch 17, Train Loss 0.483193, Valid_loss 0.445552
Epoch 18, Train Loss 0.480645, Valid_loss 0.434729
Epoch 19, Train Loss 0.480015, Valid_loss 0.440114
Epoch 20, Train Loss 0.479049, Valid_loss 0.445518
Epoch 21, Train Loss 0.476794, Valid_loss 0.437458
Epoch 22, Train Loss 0.476985, Valid_loss 0.434276
Epoch 23, Train Loss 0.474621, Valid_loss 0.447464
Epoch 24, Train Loss 0.473510, Valid_loss 0.439348
Epoch 25, Train Loss 0.472293, Valid_loss 0.438798
Epoch 26, Train Loss 0.472629, Valid_loss 0.441533
Epoch 27, Train Loss 0.471219, Valid_loss 0.437213
Epoch 28, Train Loss 0.469481, Valid_loss 0.441758
Epoch 29, Train Loss 0.468531, Valid_loss 0.440562
Epoch 30, Train Loss 0.466315, Valid_loss 0.435391
Epoch 31, Train Loss 0.467046, Valid_loss 0.437120
Epoch 32, Train Loss 0.466066, Valid_loss 0.441565
Epoch 33, Train Loss 0.464671, Valid_loss 0.437620
Epoch 34, Train Loss 0.465223, Valid_loss 0.429215
Epoch 35, Train Loss 0.462999, Valid_loss 0.437035
Epoch 36, Train Loss 0.461990, Valid_loss 0.432650
Epoch 37, Train Loss 0.461242, Valid_loss 0.433326
Epoch 38, Train Loss 0.460171, Valid_loss 0.431143
Epoch 39, Train Loss 0.459715, Valid_loss 0.426150
Epoch 40, Train Loss 0.457802, Valid_loss 0.428241
Epoch 41, Train Loss 0.458132, Valid_loss 0.428548
Epoch 42, Train Loss 0.457062, Valid_loss 0.416643
Epoch 43, Train Loss 0.456109, Valid_loss 0.426580
Epoch 44, Train Loss 0.455492, Valid_loss 0.419990
Epoch 45, Train Loss 0.454652, Valid_loss 0.417895
Epoch 46, Train Loss 0.452951, Valid_loss 0.419931
Epoch 47, Train Loss 0.452493, Valid_loss 0.416262
Epoch 48, Train Loss 0.452900, Valid_loss 0.414662
Epoch 49, Train Loss 0.451777, Valid_loss 0.414198
Epoch 50, Train Loss 0.451633, Valid_loss 0.411807
Epoch 51, Train Loss 0.449842, Valid_loss 0.410358
Epoch 52, Train Loss 0.450583, Valid_loss 0.414525
Epoch 53, Train Loss 0.450352, Valid_loss 0.408375
Epoch 54, Train Loss 0.449713, Valid_loss 0.410805
Epoch 55, Train Loss 0.448639, Valid_loss 0.411045
COVID19_Participant26 -- true: COVID-19 -- pred: COVID-19
COVID19_Participant11 -- true: COVID-19 -- pred: normal
COVID19_Participant25 -- true: COVID-19 -- pred: normal
COVID19_Participant31 -- true: COVID-19 -- pred: normal
true :  [1, 1, 1, 1]
pred :  [1, 0, 0, 0]
Confusion Matrix: [0 0 3 1]
Best performance: Epoch 53, Loss 0.450352, Test ACC 0.250000, Test AUC 0.000000, Test Recall 0.250000, Test Precision 1.000000
✅ Total valid splits used: 5

📌 Repeat 3: 평균 AUC = 0.4333, 표준편차 = 0.3887
🔁 Repeat 4, Fold 0
🔍 Split #1
  → train_p_index 환자 수: 15
  → test_p_index 환자 수: 4
  → train 환자 ID: ['COVID19_Participant13', 'COVID19_Participant15', 'COVID19_Participant17', 'COVID19_Participant19', 'COVID19_Participant22', 'COVID19_Participant26', 'COVID19_Participant28', 'COVID19_Participant37', 'COVID19_Participant4', 'Control_Participant11', 'Control_Participant15', 'Control_Participant3', 'Control_Participant5', 'Control_Participant7', 'Control_Participant9']
  → test  환자 ID: ['COVID19_Participant11', 'Control_Participant5', 'COVID19_Participant26', 'Control_Participant7']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: Control_Participant11, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: COVID19_Participant11, Label: 1
    ID: Control_Participant5, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: Control_Participant7, Label: 0
train_p_index_ 10
valid_p_index 5
test_p_index 4
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Keratinocytes', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Neurons', 'iPS_cells', 'Embryonic_stem_cells', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
data augment 실행 함
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:10,  9.19it/s]  2%|▏         | 2/100 [00:00<00:10,  9.20it/s]  3%|▎         | 3/100 [00:00<00:10,  9.34it/s]  4%|▍         | 4/100 [00:00<00:10,  8.88it/s]  5%|▌         | 5/100 [00:00<00:10,  8.89it/s]  6%|▌         | 6/100 [00:00<00:10,  8.88it/s]  7%|▋         | 7/100 [00:00<00:10,  8.93it/s]  8%|▊         | 8/100 [00:00<00:10,  8.87it/s]  9%|▉         | 9/100 [00:01<00:10,  8.85it/s] 10%|█         | 10/100 [00:01<00:10,  8.83it/s] 11%|█         | 11/100 [00:01<00:09,  8.91it/s] 12%|█▏        | 12/100 [00:01<00:10,  8.77it/s] 13%|█▎        | 13/100 [00:01<00:09,  8.74it/s] 14%|█▍        | 14/100 [00:01<00:09,  8.83it/s] 15%|█▌        | 15/100 [00:01<00:09,  9.01it/s] 16%|█▌        | 16/100 [00:01<00:09,  8.90it/s] 17%|█▋        | 17/100 [00:01<00:09,  8.85it/s] 18%|█▊        | 18/100 [00:02<00:09,  8.78it/s] 19%|█▉        | 19/100 [00:02<00:09,  8.85it/s] 20%|██        | 20/100 [00:02<00:09,  8.55it/s] 21%|██        | 21/100 [00:02<00:09,  8.47it/s] 22%|██▏       | 22/100 [00:02<00:09,  8.62it/s] 23%|██▎       | 23/100 [00:02<00:08,  8.58it/s] 24%|██▍       | 24/100 [00:02<00:08,  8.49it/s] 25%|██▌       | 25/100 [00:02<00:08,  8.60it/s] 26%|██▌       | 26/100 [00:02<00:08,  8.83it/s] 27%|██▋       | 27/100 [00:03<00:08,  8.70it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.21it/s] 29%|██▉       | 29/100 [00:03<00:08,  8.67it/s] 30%|███       | 30/100 [00:03<00:08,  8.48it/s] 31%|███       | 31/100 [00:03<00:08,  8.52it/s] 33%|███▎      | 33/100 [00:03<00:07,  8.90it/s] 34%|███▍      | 34/100 [00:03<00:07,  8.98it/s] 35%|███▌      | 35/100 [00:03<00:07,  8.89it/s] 36%|███▌      | 36/100 [00:04<00:07,  8.28it/s] 37%|███▋      | 37/100 [00:04<00:07,  8.07it/s] 38%|███▊      | 38/100 [00:04<00:07,  8.12it/s] 39%|███▉      | 39/100 [00:04<00:07,  8.23it/s] 40%|████      | 40/100 [00:04<00:06,  8.59it/s] 41%|████      | 41/100 [00:04<00:07,  8.12it/s] 42%|████▏     | 42/100 [00:04<00:06,  8.29it/s] 43%|████▎     | 43/100 [00:04<00:06,  8.26it/s] 44%|████▍     | 44/100 [00:05<00:06,  8.34it/s] 45%|████▌     | 45/100 [00:05<00:06,  7.95it/s] 46%|████▌     | 46/100 [00:05<00:06,  8.24it/s] 47%|████▋     | 47/100 [00:05<00:06,  8.20it/s] 48%|████▊     | 48/100 [00:05<00:06,  7.80it/s] 49%|████▉     | 49/100 [00:05<00:06,  7.53it/s] 50%|█████     | 50/100 [00:05<00:06,  7.79it/s] 51%|█████     | 51/100 [00:05<00:06,  8.04it/s] 52%|█████▏    | 52/100 [00:06<00:06,  7.93it/s] 53%|█████▎    | 53/100 [00:06<00:05,  7.96it/s] 54%|█████▍    | 54/100 [00:06<00:05,  7.92it/s] 55%|█████▌    | 55/100 [00:06<00:05,  8.01it/s] 56%|█████▌    | 56/100 [00:06<00:05,  7.97it/s] 57%|█████▋    | 57/100 [00:06<00:05,  8.08it/s] 58%|█████▊    | 58/100 [00:06<00:05,  8.08it/s] 59%|█████▉    | 59/100 [00:06<00:05,  8.13it/s] 60%|██████    | 60/100 [00:07<00:04,  8.37it/s] 61%|██████    | 61/100 [00:07<00:04,  8.30it/s] 62%|██████▏   | 62/100 [00:07<00:04,  8.36it/s] 63%|██████▎   | 63/100 [00:07<00:04,  8.42it/s] 64%|██████▍   | 64/100 [00:07<00:04,  8.33it/s] 65%|██████▌   | 65/100 [00:07<00:04,  7.82it/s] 66%|██████▌   | 66/100 [00:07<00:04,  7.94it/s] 67%|██████▋   | 67/100 [00:07<00:04,  8.02it/s] 68%|██████▊   | 68/100 [00:08<00:03,  8.14it/s] 69%|██████▉   | 69/100 [00:08<00:03,  8.12it/s] 70%|███████   | 70/100 [00:08<00:03,  7.66it/s] 71%|███████   | 71/100 [00:08<00:03,  7.78it/s] 72%|███████▏  | 72/100 [00:08<00:03,  7.89it/s] 73%|███████▎  | 73/100 [00:08<00:03,  7.98it/s] 74%|███████▍  | 74/100 [00:08<00:03,  7.91it/s] 75%|███████▌  | 75/100 [00:08<00:03,  7.99it/s] 76%|███████▌  | 76/100 [00:09<00:02,  8.00it/s] 77%|███████▋  | 77/100 [00:09<00:02,  7.86it/s] 78%|███████▊  | 78/100 [00:09<00:02,  8.09it/s] 79%|███████▉  | 79/100 [00:09<00:02,  8.16it/s] 80%|████████  | 80/100 [00:09<00:02,  7.97it/s] 81%|████████  | 81/100 [00:09<00:02,  8.02it/s] 82%|████████▏ | 82/100 [00:09<00:02,  8.42it/s] 83%|████████▎ | 83/100 [00:09<00:02,  8.33it/s] 84%|████████▍ | 84/100 [00:10<00:01,  8.17it/s] 85%|████████▌ | 85/100 [00:10<00:01,  7.64it/s] 86%|████████▌ | 86/100 [00:10<00:01,  7.72it/s] 87%|████████▋ | 87/100 [00:10<00:01,  7.83it/s] 88%|████████▊ | 88/100 [00:10<00:01,  7.77it/s] 89%|████████▉ | 89/100 [00:10<00:01,  7.82it/s] 90%|█████████ | 90/100 [00:10<00:01,  7.90it/s] 91%|█████████ | 91/100 [00:10<00:01,  7.99it/s] 92%|█████████▏| 92/100 [00:11<00:00,  8.00it/s] 93%|█████████▎| 93/100 [00:11<00:00,  8.04it/s] 94%|█████████▍| 94/100 [00:11<00:00,  8.04it/s] 95%|█████████▌| 95/100 [00:11<00:00,  8.02it/s] 96%|█████████▌| 96/100 [00:11<00:00,  7.80it/s] 97%|█████████▋| 97/100 [00:11<00:00,  7.60it/s] 98%|█████████▊| 98/100 [00:11<00:00,  7.77it/s] 99%|█████████▉| 99/100 [00:12<00:00,  7.79it/s]100%|██████████| 100/100 [00:12<00:00,  7.78it/s]100%|██████████| 100/100 [00:12<00:00,  8.24it/s]
eval_p_index len:  9
individual_train 110
individual_eval 9
train data의 x, y, id 길이: 110 110 110
valid data의 x, y, id 길이: 5 5 5
test data의 x, y, id 길이: 4 4 4
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 38.00 MB
cuda
Epoch 1, Train Loss 0.706033, Valid_loss 0.774856
Epoch 2, Train Loss 0.698005, Valid_loss 0.754703
Epoch 3, Train Loss 0.686675, Valid_loss 0.747722
Epoch 4, Train Loss 0.679941, Valid_loss 0.741349
Epoch 5, Train Loss 0.674632, Valid_loss 0.726225
Epoch 6, Train Loss 0.671938, Valid_loss 0.722645
Epoch 7, Train Loss 0.668818, Valid_loss 0.726907
Epoch 8, Train Loss 0.665517, Valid_loss 0.733285
Epoch 9, Train Loss 0.662378, Valid_loss 0.733829
Epoch 10, Train Loss 0.659205, Valid_loss 0.735672
Epoch 11, Train Loss 0.657653, Valid_loss 0.735336
Epoch 12, Train Loss 0.654098, Valid_loss 0.734873
Epoch 13, Train Loss 0.651924, Valid_loss 0.733517
Epoch 14, Train Loss 0.649815, Valid_loss 0.726744
Epoch 15, Train Loss 0.646128, Valid_loss 0.725760
Epoch 16, Train Loss 0.645073, Valid_loss 0.711848
Epoch 17, Train Loss 0.641422, Valid_loss 0.714353
Epoch 18, Train Loss 0.639371, Valid_loss 0.693340
Epoch 19, Train Loss 0.637014, Valid_loss 0.687752
Epoch 20, Train Loss 0.633782, Valid_loss 0.680165
Epoch 21, Train Loss 0.628245, Valid_loss 0.657082
Epoch 22, Train Loss 0.618852, Valid_loss 0.632522
Epoch 23, Train Loss 0.608046, Valid_loss 0.600709
Epoch 24, Train Loss 0.594961, Valid_loss 0.570330
Epoch 25, Train Loss 0.577519, Valid_loss 0.533234
Epoch 26, Train Loss 0.551124, Valid_loss 0.445575
Epoch 27, Train Loss 0.519587, Valid_loss 0.395649
Epoch 28, Train Loss 0.500730, Valid_loss 0.372684
Epoch 29, Train Loss 0.489291, Valid_loss 0.367717
Epoch 30, Train Loss 0.484039, Valid_loss 0.358297
Epoch 31, Train Loss 0.479227, Valid_loss 0.354819
Epoch 32, Train Loss 0.476600, Valid_loss 0.355499
Epoch 33, Train Loss 0.473794, Valid_loss 0.350791
Epoch 34, Train Loss 0.472447, Valid_loss 0.352740
Epoch 35, Train Loss 0.470998, Valid_loss 0.352479
Epoch 36, Train Loss 0.467046, Valid_loss 0.349594
Epoch 37, Train Loss 0.467292, Valid_loss 0.349985
Epoch 38, Train Loss 0.465896, Valid_loss 0.350879
Epoch 39, Train Loss 0.464634, Valid_loss 0.352423
Epoch 40, Train Loss 0.463136, Valid_loss 0.353113
Epoch 41, Train Loss 0.462348, Valid_loss 0.348662
Epoch 42, Train Loss 0.460106, Valid_loss 0.347808
Epoch 43, Train Loss 0.461063, Valid_loss 0.348576
Epoch 44, Train Loss 0.459063, Valid_loss 0.348023
Epoch 45, Train Loss 0.458484, Valid_loss 0.346654
Epoch 46, Train Loss 0.457407, Valid_loss 0.346037
Epoch 47, Train Loss 0.456193, Valid_loss 0.344711
Epoch 48, Train Loss 0.455263, Valid_loss 0.345122
Epoch 49, Train Loss 0.453444, Valid_loss 0.342254
Epoch 50, Train Loss 0.451868, Valid_loss 0.340093
Epoch 51, Train Loss 0.452833, Valid_loss 0.340757
Epoch 52, Train Loss 0.451219, Valid_loss 0.341185
COVID19_Participant11 -- true: COVID-19 -- pred: normal
Control_Participant5 -- true: normal -- pred: normal
COVID19_Participant26 -- true: COVID-19 -- pred: normal
Control_Participant7 -- true: normal -- pred: COVID-19
true :  [1, 0, 1, 0]
pred :  [0, 0, 0, 1]
Confusion Matrix: [1 1 2 0]
Best performance: Epoch 50, Loss 0.451868, Test ACC 0.250000, Test AUC 0.000000, Test Recall 0.000000, Test Precision 0.000000
✅ Total valid splits used: 1
🔁 Repeat 4, Fold 1
🔍 Split #2
  → train_p_index 환자 수: 17
  → test_p_index 환자 수: 2
  → train 환자 ID: ['COVID19_Participant13', 'COVID19_Participant15', 'COVID19_Participant17', 'COVID19_Participant19', 'COVID19_Participant20', 'COVID19_Participant22', 'COVID19_Participant26', 'COVID19_Participant29', 'COVID19_Participant32', 'COVID19_Participant37', 'COVID19_Participant4', 'Control_Participant10', 'Control_Participant11', 'Control_Participant15', 'Control_Participant3', 'Control_Participant7', 'Control_Participant9']
  → test  환자 ID: ['COVID19_Participant31', 'Control_Participant7']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: Control_Participant10, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: COVID19_Participant31, Label: 1
    ID: Control_Participant7, Label: 0
train_p_index_ 11
valid_p_index 6
test_p_index 2
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Keratinocytes', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Neurons', 'iPS_cells', 'Embryonic_stem_cells', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
data augment 실행 함
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:10,  9.05it/s]  2%|▏         | 2/100 [00:00<00:10,  9.07it/s]  3%|▎         | 3/100 [00:00<00:10,  9.17it/s]  4%|▍         | 4/100 [00:00<00:10,  9.37it/s]  5%|▌         | 5/100 [00:00<00:10,  8.94it/s]  6%|▌         | 6/100 [00:00<00:10,  8.84it/s]  7%|▋         | 7/100 [00:00<00:10,  8.61it/s]  8%|▊         | 8/100 [00:00<00:10,  8.78it/s]  9%|▉         | 9/100 [00:01<00:10,  8.89it/s] 10%|█         | 10/100 [00:01<00:09,  9.02it/s] 11%|█         | 11/100 [00:01<00:09,  9.13it/s] 12%|█▏        | 12/100 [00:01<00:09,  9.29it/s] 13%|█▎        | 13/100 [00:01<00:09,  9.17it/s] 14%|█▍        | 14/100 [00:01<00:09,  8.93it/s] 15%|█▌        | 15/100 [00:01<00:09,  9.00it/s] 16%|█▌        | 16/100 [00:01<00:09,  8.72it/s] 17%|█▋        | 17/100 [00:01<00:09,  8.76it/s] 18%|█▊        | 18/100 [00:02<00:09,  8.81it/s] 19%|█▉        | 19/100 [00:02<00:09,  8.74it/s] 20%|██        | 20/100 [00:02<00:09,  8.60it/s] 21%|██        | 21/100 [00:02<00:09,  8.39it/s] 22%|██▏       | 22/100 [00:02<00:09,  8.37it/s] 23%|██▎       | 23/100 [00:02<00:09,  8.47it/s] 24%|██▍       | 24/100 [00:02<00:08,  8.53it/s] 25%|██▌       | 25/100 [00:02<00:08,  8.71it/s] 26%|██▌       | 26/100 [00:02<00:08,  8.69it/s] 27%|██▋       | 27/100 [00:03<00:08,  8.81it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.73it/s] 29%|██▉       | 29/100 [00:03<00:08,  8.12it/s] 30%|███       | 30/100 [00:03<00:08,  8.21it/s] 31%|███       | 31/100 [00:03<00:08,  8.32it/s] 32%|███▏      | 32/100 [00:03<00:08,  8.48it/s] 33%|███▎      | 33/100 [00:03<00:07,  8.39it/s] 34%|███▍      | 34/100 [00:03<00:08,  8.19it/s] 35%|███▌      | 35/100 [00:04<00:07,  8.24it/s] 36%|███▌      | 36/100 [00:04<00:07,  8.41it/s] 37%|███▋      | 37/100 [00:04<00:07,  8.41it/s] 38%|███▊      | 38/100 [00:04<00:07,  8.46it/s] 39%|███▉      | 39/100 [00:04<00:07,  8.50it/s] 40%|████      | 40/100 [00:04<00:07,  8.49it/s] 41%|████      | 41/100 [00:04<00:06,  8.49it/s] 42%|████▏     | 42/100 [00:04<00:06,  8.46it/s] 43%|████▎     | 43/100 [00:04<00:06,  8.54it/s] 44%|████▍     | 44/100 [00:05<00:06,  8.62it/s] 45%|████▌     | 45/100 [00:05<00:06,  8.66it/s] 46%|████▌     | 46/100 [00:05<00:06,  8.39it/s] 47%|████▋     | 47/100 [00:05<00:06,  8.52it/s] 48%|████▊     | 48/100 [00:05<00:06,  8.39it/s] 49%|████▉     | 49/100 [00:05<00:06,  8.33it/s] 50%|█████     | 50/100 [00:05<00:05,  8.43it/s] 51%|█████     | 51/100 [00:05<00:05,  8.45it/s] 52%|█████▏    | 52/100 [00:06<00:05,  8.34it/s] 53%|█████▎    | 53/100 [00:06<00:05,  8.25it/s] 54%|█████▍    | 54/100 [00:06<00:05,  7.95it/s] 56%|█████▌    | 56/100 [00:06<00:05,  8.46it/s] 57%|█████▋    | 57/100 [00:06<00:05,  8.38it/s] 58%|█████▊    | 58/100 [00:06<00:05,  8.31it/s] 59%|█████▉    | 59/100 [00:06<00:04,  8.26it/s] 60%|██████    | 60/100 [00:07<00:04,  8.22it/s] 61%|██████    | 61/100 [00:07<00:04,  8.18it/s] 62%|██████▏   | 62/100 [00:07<00:04,  8.22it/s] 63%|██████▎   | 63/100 [00:07<00:04,  8.28it/s] 64%|██████▍   | 64/100 [00:07<00:04,  8.17it/s] 65%|██████▌   | 65/100 [00:07<00:04,  7.99it/s] 66%|██████▌   | 66/100 [00:07<00:04,  7.98it/s] 67%|██████▋   | 67/100 [00:07<00:04,  8.04it/s] 68%|██████▊   | 68/100 [00:08<00:04,  8.00it/s] 69%|██████▉   | 69/100 [00:08<00:03,  7.99it/s] 70%|███████   | 70/100 [00:08<00:03,  8.32it/s] 71%|███████   | 71/100 [00:08<00:03,  8.11it/s] 72%|███████▏  | 72/100 [00:08<00:03,  8.08it/s] 73%|███████▎  | 73/100 [00:08<00:03,  8.10it/s] 74%|███████▍  | 74/100 [00:08<00:03,  8.12it/s] 75%|███████▌  | 75/100 [00:08<00:03,  8.16it/s] 76%|███████▌  | 76/100 [00:09<00:03,  7.89it/s] 77%|███████▋  | 77/100 [00:09<00:02,  7.87it/s] 78%|███████▊  | 78/100 [00:09<00:02,  7.95it/s] 79%|███████▉  | 79/100 [00:09<00:02,  7.86it/s] 80%|████████  | 80/100 [00:09<00:02,  7.70it/s] 81%|████████  | 81/100 [00:09<00:02,  7.70it/s] 82%|████████▏ | 82/100 [00:09<00:02,  7.69it/s] 83%|████████▎ | 83/100 [00:09<00:02,  7.64it/s] 84%|████████▍ | 84/100 [00:10<00:02,  7.73it/s] 85%|████████▌ | 85/100 [00:10<00:01,  7.82it/s] 86%|████████▌ | 86/100 [00:10<00:01,  7.56it/s] 87%|████████▋ | 87/100 [00:10<00:01,  7.73it/s] 88%|████████▊ | 88/100 [00:10<00:01,  7.93it/s] 89%|████████▉ | 89/100 [00:10<00:01,  7.95it/s] 90%|█████████ | 90/100 [00:10<00:01,  7.98it/s] 91%|█████████ | 91/100 [00:10<00:01,  7.76it/s] 92%|█████████▏| 92/100 [00:11<00:01,  7.67it/s] 93%|█████████▎| 93/100 [00:11<00:00,  7.49it/s] 94%|█████████▍| 94/100 [00:11<00:00,  7.45it/s] 95%|█████████▌| 95/100 [00:11<00:00,  7.32it/s] 96%|█████████▌| 96/100 [00:11<00:00,  7.79it/s] 97%|█████████▋| 97/100 [00:11<00:00,  8.08it/s] 98%|█████████▊| 98/100 [00:11<00:00,  7.98it/s] 99%|█████████▉| 99/100 [00:11<00:00,  7.87it/s]100%|██████████| 100/100 [00:12<00:00,  7.71it/s]100%|██████████| 100/100 [00:12<00:00,  8.26it/s]
eval_p_index len:  8
individual_train 111
individual_eval 8
train data의 x, y, id 길이: 111 111 111
valid data의 x, y, id 길이: 6 6 6
test data의 x, y, id 길이: 2 2 2
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 38.00 MB
cuda
Epoch 1, Train Loss 0.823177, Valid_loss 0.833428
Epoch 2, Train Loss 0.805133, Valid_loss 0.815329
Epoch 3, Train Loss 0.793251, Valid_loss 0.805618
Epoch 4, Train Loss 0.781946, Valid_loss 0.785702
Epoch 5, Train Loss 0.766297, Valid_loss 0.763511
Epoch 6, Train Loss 0.747771, Valid_loss 0.738234
Epoch 7, Train Loss 0.727430, Valid_loss 0.711646
Epoch 8, Train Loss 0.709675, Valid_loss 0.697529
Epoch 9, Train Loss 0.693479, Valid_loss 0.685110
Epoch 10, Train Loss 0.675856, Valid_loss 0.671146
Epoch 11, Train Loss 0.659092, Valid_loss 0.664492
Epoch 12, Train Loss 0.646262, Valid_loss 0.661570
Epoch 13, Train Loss 0.636834, Valid_loss 0.656680
Epoch 14, Train Loss 0.628202, Valid_loss 0.654374
Epoch 15, Train Loss 0.619668, Valid_loss 0.655149
Epoch 16, Train Loss 0.612879, Valid_loss 0.660228
Epoch 17, Train Loss 0.607767, Valid_loss 0.644823
Epoch 18, Train Loss 0.603437, Valid_loss 0.647137
Epoch 19, Train Loss 0.599305, Valid_loss 0.640905
Epoch 20, Train Loss 0.595619, Valid_loss 0.634788
Epoch 21, Train Loss 0.592470, Valid_loss 0.631292
Epoch 22, Train Loss 0.589139, Valid_loss 0.623905
Epoch 23, Train Loss 0.585997, Valid_loss 0.622519
Epoch 24, Train Loss 0.583012, Valid_loss 0.617341
Epoch 25, Train Loss 0.580403, Valid_loss 0.615381
Epoch 26, Train Loss 0.578481, Valid_loss 0.610140
Epoch 27, Train Loss 0.576674, Valid_loss 0.610417
Epoch 28, Train Loss 0.575150, Valid_loss 0.606623
Epoch 29, Train Loss 0.573506, Valid_loss 0.606733
Epoch 30, Train Loss 0.572461, Valid_loss 0.603866
Epoch 31, Train Loss 0.570852, Valid_loss 0.602224
Epoch 32, Train Loss 0.569117, Valid_loss 0.600967
Epoch 33, Train Loss 0.567874, Valid_loss 0.599651
Epoch 34, Train Loss 0.566597, Valid_loss 0.598925
Epoch 35, Train Loss 0.565496, Valid_loss 0.597373
Epoch 36, Train Loss 0.564279, Valid_loss 0.596227
Epoch 37, Train Loss 0.562243, Valid_loss 0.596143
Epoch 38, Train Loss 0.560150, Valid_loss 0.593900
Epoch 39, Train Loss 0.558916, Valid_loss 0.592843
Epoch 40, Train Loss 0.557907, Valid_loss 0.591614
Epoch 41, Train Loss 0.556974, Valid_loss 0.588848
Epoch 42, Train Loss 0.555587, Valid_loss 0.587672
Epoch 43, Train Loss 0.554318, Valid_loss 0.584437
Epoch 44, Train Loss 0.553317, Valid_loss 0.583246
Epoch 45, Train Loss 0.552266, Valid_loss 0.579136
Epoch 46, Train Loss 0.551629, Valid_loss 0.580616
Epoch 47, Train Loss 0.550172, Valid_loss 0.577027
Epoch 48, Train Loss 0.549450, Valid_loss 0.575715
Epoch 49, Train Loss 0.548637, Valid_loss 0.574958
Epoch 50, Train Loss 0.547485, Valid_loss 0.572695
Epoch 51, Train Loss 0.546904, Valid_loss 0.572728
Epoch 52, Train Loss 0.545524, Valid_loss 0.572265
Epoch 53, Train Loss 0.545683, Valid_loss 0.571596
Epoch 54, Train Loss 0.545216, Valid_loss 0.570467
Epoch 55, Train Loss 0.544811, Valid_loss 0.570384
Epoch 56, Train Loss 0.544360, Valid_loss 0.569785
Epoch 57, Train Loss 0.544061, Valid_loss 0.568904
Epoch 58, Train Loss 0.543500, Valid_loss 0.568198
Epoch 59, Train Loss 0.543328, Valid_loss 0.567689
Epoch 60, Train Loss 0.542283, Valid_loss 0.567127
Epoch 61, Train Loss 0.542366, Valid_loss 0.566138
Epoch 62, Train Loss 0.542105, Valid_loss 0.565800
Epoch 63, Train Loss 0.541217, Valid_loss 0.564557
Epoch 64, Train Loss 0.540500, Valid_loss 0.564632
Epoch 65, Train Loss 0.540553, Valid_loss 0.564245
Epoch 66, Train Loss 0.540414, Valid_loss 0.563102
Epoch 67, Train Loss 0.539944, Valid_loss 0.562780
Epoch 68, Train Loss 0.539508, Valid_loss 0.563143
Epoch 69, Train Loss 0.538640, Valid_loss 0.561520
Epoch 70, Train Loss 0.538824, Valid_loss 0.561516
Epoch 71, Train Loss 0.538420, Valid_loss 0.561014
Epoch 72, Train Loss 0.537783, Valid_loss 0.559460
Epoch 73, Train Loss 0.537315, Valid_loss 0.558682
Epoch 74, Train Loss 0.536941, Valid_loss 0.559562
Epoch 75, Train Loss 0.536207, Valid_loss 0.558097
Epoch 76, Train Loss 0.536205, Valid_loss 0.557936
Epoch 77, Train Loss 0.536038, Valid_loss 0.556868
Epoch 78, Train Loss 0.535370, Valid_loss 0.556866
Epoch 79, Train Loss 0.535667, Valid_loss 0.556141
Epoch 80, Train Loss 0.535080, Valid_loss 0.555445
Epoch 81, Train Loss 0.534604, Valid_loss 0.554193
Epoch 82, Train Loss 0.534049, Valid_loss 0.554874
Epoch 83, Train Loss 0.533591, Valid_loss 0.553875
Epoch 84, Train Loss 0.532880, Valid_loss 0.553675
Epoch 85, Train Loss 0.533240, Valid_loss 0.552674
Epoch 86, Train Loss 0.532749, Valid_loss 0.551866
Epoch 87, Train Loss 0.532355, Valid_loss 0.551961
Epoch 88, Train Loss 0.531799, Valid_loss 0.550912
Epoch 89, Train Loss 0.531553, Valid_loss 0.549584
Epoch 90, Train Loss 0.531005, Valid_loss 0.550461
Epoch 91, Train Loss 0.530642, Valid_loss 0.549374
Epoch 92, Train Loss 0.530483, Valid_loss 0.548557
Epoch 93, Train Loss 0.529712, Valid_loss 0.549907
Epoch 94, Train Loss 0.529734, Valid_loss 0.546345
Epoch 95, Train Loss 0.529407, Valid_loss 0.546760
Epoch 96, Train Loss 0.529247, Valid_loss 0.547424
COVID19_Participant31 -- true: COVID-19 -- pred: COVID-19
Control_Participant7 -- true: normal -- pred: normal
true :  [1, 0]
pred :  [1, 0]
Confusion Matrix: [1 0 0 1]
Best performance: Epoch 94, Loss 0.529734, Test ACC 1.000000, Test AUC 1.000000, Test Recall 1.000000, Test Precision 1.000000
✅ Total valid splits used: 2
🔁 Repeat 4, Fold 2
🔍 Split #3
  → train_p_index 환자 수: 15
  → test_p_index 환자 수: 4
  → train 환자 ID: ['COVID19_Participant13', 'COVID19_Participant15', 'COVID19_Participant17', 'COVID19_Participant20', 'COVID19_Participant28', 'COVID19_Participant29', 'COVID19_Participant32', 'COVID19_Participant37', 'COVID19_Participant4', 'Control_Participant10', 'Control_Participant11', 'Control_Participant3', 'Control_Participant5', 'Control_Participant7', 'Control_Participant9']
  → test  환자 ID: ['COVID19_Participant5', 'Control_Participant1', 'Control_Participant7', 'Control_Participant3']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: Control_Participant10, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: COVID19_Participant5, Label: 1
    ID: Control_Participant1, Label: 1
    ID: Control_Participant7, Label: 1
    ID: Control_Participant3, Label: 0
train_p_index_ 10
valid_p_index 5
test_p_index 4
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Keratinocytes', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Neurons', 'iPS_cells', 'Embryonic_stem_cells', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
data augment 실행 함
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:11,  8.71it/s]  2%|▏         | 2/100 [00:00<00:11,  8.49it/s]  3%|▎         | 3/100 [00:00<00:10,  9.11it/s]  4%|▍         | 4/100 [00:00<00:10,  9.14it/s]  5%|▌         | 5/100 [00:00<00:10,  9.15it/s]  6%|▌         | 6/100 [00:00<00:10,  9.28it/s]  7%|▋         | 7/100 [00:00<00:10,  9.20it/s]  8%|▊         | 8/100 [00:00<00:10,  8.52it/s]  9%|▉         | 9/100 [00:01<00:10,  8.68it/s] 10%|█         | 10/100 [00:01<00:10,  8.72it/s] 11%|█         | 11/100 [00:01<00:10,  8.57it/s] 12%|█▏        | 12/100 [00:01<00:10,  8.74it/s] 13%|█▎        | 13/100 [00:01<00:09,  8.85it/s] 14%|█▍        | 14/100 [00:01<00:09,  8.82it/s] 15%|█▌        | 15/100 [00:01<00:09,  8.81it/s] 16%|█▌        | 16/100 [00:01<00:09,  8.72it/s] 17%|█▋        | 17/100 [00:01<00:09,  8.61it/s] 18%|█▊        | 18/100 [00:02<00:09,  8.75it/s] 19%|█▉        | 19/100 [00:02<00:09,  8.66it/s] 20%|██        | 20/100 [00:02<00:09,  8.72it/s] 21%|██        | 21/100 [00:02<00:08,  8.98it/s] 22%|██▏       | 22/100 [00:02<00:09,  8.57it/s] 23%|██▎       | 23/100 [00:02<00:08,  8.60it/s] 24%|██▍       | 24/100 [00:02<00:08,  8.69it/s] 25%|██▌       | 25/100 [00:02<00:08,  8.90it/s] 26%|██▌       | 26/100 [00:02<00:08,  8.68it/s] 27%|██▋       | 27/100 [00:03<00:08,  8.79it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.75it/s] 29%|██▉       | 29/100 [00:03<00:08,  8.31it/s] 30%|███       | 30/100 [00:03<00:08,  8.45it/s] 31%|███       | 31/100 [00:03<00:08,  8.46it/s] 32%|███▏      | 32/100 [00:03<00:08,  8.16it/s] 33%|███▎      | 33/100 [00:03<00:08,  8.20it/s] 34%|███▍      | 34/100 [00:03<00:07,  8.44it/s] 35%|███▌      | 35/100 [00:04<00:07,  8.35it/s] 36%|███▌      | 36/100 [00:04<00:07,  8.27it/s] 37%|███▋      | 37/100 [00:04<00:07,  8.56it/s] 38%|███▊      | 38/100 [00:04<00:07,  8.47it/s] 39%|███▉      | 39/100 [00:04<00:07,  8.38it/s] 40%|████      | 40/100 [00:04<00:07,  8.32it/s] 41%|████      | 41/100 [00:04<00:07,  8.29it/s] 42%|████▏     | 42/100 [00:04<00:07,  8.18it/s] 43%|████▎     | 43/100 [00:05<00:06,  8.18it/s] 44%|████▍     | 44/100 [00:05<00:06,  8.23it/s] 45%|████▌     | 45/100 [00:05<00:06,  8.15it/s] 46%|████▌     | 46/100 [00:05<00:06,  7.78it/s] 47%|████▋     | 47/100 [00:05<00:06,  8.09it/s] 48%|████▊     | 48/100 [00:05<00:06,  8.03it/s] 49%|████▉     | 49/100 [00:05<00:06,  8.12it/s] 50%|█████     | 50/100 [00:05<00:06,  8.05it/s] 51%|█████     | 51/100 [00:06<00:06,  8.11it/s] 52%|█████▏    | 52/100 [00:06<00:05,  8.19it/s] 53%|█████▎    | 53/100 [00:06<00:05,  8.28it/s] 54%|█████▍    | 54/100 [00:06<00:05,  8.29it/s] 55%|█████▌    | 55/100 [00:06<00:05,  8.26it/s] 56%|█████▌    | 56/100 [00:06<00:05,  8.26it/s] 57%|█████▋    | 57/100 [00:06<00:05,  8.21it/s] 58%|█████▊    | 58/100 [00:06<00:05,  8.16it/s] 59%|█████▉    | 59/100 [00:06<00:05,  8.02it/s] 60%|██████    | 60/100 [00:07<00:04,  8.11it/s] 61%|██████    | 61/100 [00:07<00:04,  8.29it/s] 62%|██████▏   | 62/100 [00:07<00:04,  8.19it/s] 63%|██████▎   | 63/100 [00:07<00:04,  8.03it/s] 64%|██████▍   | 64/100 [00:07<00:04,  8.22it/s] 65%|██████▌   | 65/100 [00:07<00:04,  8.35it/s] 66%|██████▌   | 66/100 [00:07<00:04,  8.27it/s] 67%|██████▋   | 67/100 [00:07<00:04,  7.87it/s] 68%|██████▊   | 68/100 [00:08<00:04,  7.90it/s] 69%|██████▉   | 69/100 [00:08<00:03,  7.83it/s] 70%|███████   | 70/100 [00:08<00:03,  7.75it/s] 71%|███████   | 71/100 [00:08<00:03,  7.97it/s] 72%|███████▏  | 72/100 [00:08<00:03,  8.01it/s] 73%|███████▎  | 73/100 [00:08<00:03,  7.94it/s] 74%|███████▍  | 74/100 [00:08<00:03,  7.98it/s] 75%|███████▌  | 75/100 [00:08<00:03,  8.05it/s] 76%|███████▌  | 76/100 [00:09<00:02,  8.10it/s] 77%|███████▋  | 77/100 [00:09<00:02,  8.02it/s] 78%|███████▊  | 78/100 [00:09<00:02,  8.06it/s] 79%|███████▉  | 79/100 [00:09<00:02,  8.22it/s] 80%|████████  | 80/100 [00:09<00:02,  7.99it/s] 81%|████████  | 81/100 [00:09<00:02,  7.73it/s] 82%|████████▏ | 82/100 [00:09<00:02,  7.78it/s] 83%|████████▎ | 83/100 [00:09<00:02,  7.87it/s] 84%|████████▍ | 84/100 [00:10<00:02,  7.78it/s] 85%|████████▌ | 85/100 [00:10<00:01,  7.76it/s] 86%|████████▌ | 86/100 [00:10<00:01,  7.51it/s] 87%|████████▋ | 87/100 [00:10<00:01,  7.60it/s] 88%|████████▊ | 88/100 [00:10<00:01,  7.69it/s] 89%|████████▉ | 89/100 [00:10<00:01,  7.78it/s] 90%|█████████ | 90/100 [00:10<00:01,  7.91it/s] 91%|█████████ | 91/100 [00:11<00:01,  7.87it/s] 92%|█████████▏| 92/100 [00:11<00:01,  7.56it/s] 93%|█████████▎| 93/100 [00:11<00:00,  7.55it/s] 94%|█████████▍| 94/100 [00:11<00:00,  7.55it/s] 95%|█████████▌| 95/100 [00:11<00:00,  7.66it/s] 96%|█████████▌| 96/100 [00:11<00:00,  7.61it/s] 97%|█████████▋| 97/100 [00:11<00:00,  7.60it/s] 98%|█████████▊| 98/100 [00:11<00:00,  7.68it/s] 99%|█████████▉| 99/100 [00:12<00:00,  7.72it/s]100%|██████████| 100/100 [00:12<00:00,  7.75it/s]100%|██████████| 100/100 [00:12<00:00,  8.20it/s]
eval_p_index len:  9
individual_train 110
individual_eval 9
train data의 x, y, id 길이: 110 110 110
valid data의 x, y, id 길이: 5 5 5
test data의 x, y, id 길이: 4 4 4
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 38.00 MB
cuda
Epoch 1, Train Loss 0.706188, Valid_loss 0.988786
Epoch 2, Train Loss 0.697766, Valid_loss 0.966628
Epoch 3, Train Loss 0.694666, Valid_loss 0.954782
Epoch 4, Train Loss 0.689795, Valid_loss 0.941607
Epoch 5, Train Loss 0.686409, Valid_loss 0.929990
Epoch 6, Train Loss 0.679002, Valid_loss 0.919030
Epoch 7, Train Loss 0.671728, Valid_loss 0.911057
Epoch 8, Train Loss 0.668726, Valid_loss 0.912796
Epoch 9, Train Loss 0.661236, Valid_loss 0.918884
Epoch 10, Train Loss 0.657933, Valid_loss 0.916393
Epoch 11, Train Loss 0.646906, Valid_loss 0.904214
Epoch 12, Train Loss 0.638313, Valid_loss 0.894381
Epoch 13, Train Loss 0.622255, Valid_loss 0.846051
Epoch 14, Train Loss 0.599254, Valid_loss 0.783158
Epoch 15, Train Loss 0.582870, Valid_loss 0.719709
Epoch 16, Train Loss 0.571940, Valid_loss 0.707475
Epoch 17, Train Loss 0.564989, Valid_loss 0.688860
Epoch 18, Train Loss 0.557270, Valid_loss 0.685074
Epoch 19, Train Loss 0.550252, Valid_loss 0.674947
Epoch 20, Train Loss 0.546924, Valid_loss 0.668449
Epoch 21, Train Loss 0.541431, Valid_loss 0.657280
Epoch 22, Train Loss 0.536973, Valid_loss 0.648595
Epoch 23, Train Loss 0.532571, Valid_loss 0.640210
Epoch 24, Train Loss 0.527545, Valid_loss 0.631181
Epoch 25, Train Loss 0.524599, Valid_loss 0.620443
Epoch 26, Train Loss 0.520809, Valid_loss 0.618230
Epoch 27, Train Loss 0.516910, Valid_loss 0.608235
Epoch 28, Train Loss 0.512951, Valid_loss 0.600038
Epoch 29, Train Loss 0.511544, Valid_loss 0.597828
Epoch 30, Train Loss 0.509684, Valid_loss 0.589768
Epoch 31, Train Loss 0.505057, Valid_loss 0.585077
Epoch 32, Train Loss 0.504784, Valid_loss 0.579554
Epoch 33, Train Loss 0.501918, Valid_loss 0.574818
Epoch 34, Train Loss 0.498578, Valid_loss 0.571774
Epoch 35, Train Loss 0.497616, Valid_loss 0.566642
Epoch 36, Train Loss 0.492862, Valid_loss 0.563534
Epoch 37, Train Loss 0.491106, Valid_loss 0.552472
Epoch 38, Train Loss 0.490075, Valid_loss 0.549386
Epoch 39, Train Loss 0.488458, Valid_loss 0.554212
Epoch 40, Train Loss 0.484788, Valid_loss 0.540095
Epoch 41, Train Loss 0.482126, Valid_loss 0.551923
Epoch 42, Train Loss 0.479611, Valid_loss 0.548254
Epoch 43, Train Loss 0.469302, Valid_loss 0.522566
Epoch 44, Train Loss 0.465290, Valid_loss 0.505699
Epoch 45, Train Loss 0.463849, Valid_loss 0.513919
Epoch 46, Train Loss 0.459593, Valid_loss 0.519635
Epoch 47, Train Loss 0.458830, Valid_loss 0.510532
Epoch 48, Train Loss 0.456026, Valid_loss 0.499787
Epoch 49, Train Loss 0.454375, Valid_loss 0.500564
Epoch 50, Train Loss 0.452940, Valid_loss 0.494780
Epoch 51, Train Loss 0.451082, Valid_loss 0.500628
Epoch 52, Train Loss 0.452001, Valid_loss 0.494582
Epoch 53, Train Loss 0.452076, Valid_loss 0.498181
Epoch 54, Train Loss 0.451502, Valid_loss 0.489513
Epoch 55, Train Loss 0.449667, Valid_loss 0.490642
Epoch 56, Train Loss 0.448029, Valid_loss 0.491365
COVID19_Participant5 -- true: COVID-19 -- pred: normal
Control_Participant1 -- true: normal -- pred: normal
Control_Participant7 -- true: normal -- pred: normal
Control_Participant3 -- true: normal -- pred: normal
true :  [1, 0, 0, 0]
pred :  [0, 0, 0, 0]
Confusion Matrix: [3 0 1 0]
Best performance: Epoch 54, Loss 0.451502, Test ACC 0.750000, Test AUC 1.000000, Test Recall 0.000000, Test Precision 0.000000
✅ Total valid splits used: 3
🔁 Repeat 4, Fold 3
🔍 Split #4
  → train_p_index 환자 수: 15
  → test_p_index 환자 수: 4
  → train 환자 ID: ['COVID19_Participant13', 'COVID19_Participant15', 'COVID19_Participant19', 'COVID19_Participant20', 'COVID19_Participant22', 'COVID19_Participant26', 'COVID19_Participant28', 'COVID19_Participant29', 'COVID19_Participant32', 'COVID19_Participant4', 'Control_Participant10', 'Control_Participant11', 'Control_Participant15', 'Control_Participant5', 'Control_Participant7']
  → test  환자 ID: ['Control_Participant4', 'COVID19_Participant26', 'Control_Participant7', 'COVID19_Participant31']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: Control_Participant10, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant7, Label: 0
  → test 환자 ID 및 라벨:
    ID: Control_Participant4, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: Control_Participant7, Label: 0
    ID: COVID19_Participant31, Label: 0
train_p_index_ 10
valid_p_index 5
test_p_index 4
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Keratinocytes', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Neurons', 'iPS_cells', 'Embryonic_stem_cells', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
data augment 실행 함
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:16,  6.04it/s]  2%|▏         | 2/100 [00:00<00:13,  7.33it/s]  3%|▎         | 3/100 [00:00<00:12,  8.07it/s]  4%|▍         | 4/100 [00:00<00:12,  7.72it/s]  5%|▌         | 5/100 [00:00<00:11,  8.18it/s]  6%|▌         | 6/100 [00:00<00:11,  8.47it/s]  7%|▋         | 7/100 [00:00<00:11,  8.37it/s]  8%|▊         | 8/100 [00:00<00:11,  8.33it/s]  9%|▉         | 9/100 [00:01<00:10,  8.36it/s] 10%|█         | 10/100 [00:01<00:10,  8.42it/s] 11%|█         | 11/100 [00:01<00:10,  8.63it/s] 12%|█▏        | 12/100 [00:01<00:09,  8.98it/s] 13%|█▎        | 13/100 [00:01<00:09,  8.94it/s] 14%|█▍        | 14/100 [00:01<00:09,  8.72it/s] 15%|█▌        | 15/100 [00:01<00:09,  8.51it/s] 16%|█▌        | 16/100 [00:01<00:09,  8.73it/s] 17%|█▋        | 17/100 [00:02<00:09,  8.66it/s] 18%|█▊        | 18/100 [00:02<00:09,  8.46it/s] 19%|█▉        | 19/100 [00:02<00:09,  8.34it/s] 20%|██        | 20/100 [00:02<00:09,  8.63it/s] 21%|██        | 21/100 [00:02<00:09,  8.59it/s] 22%|██▏       | 22/100 [00:02<00:09,  8.56it/s] 23%|██▎       | 23/100 [00:02<00:09,  8.53it/s] 24%|██▍       | 24/100 [00:02<00:08,  8.47it/s] 25%|██▌       | 25/100 [00:02<00:08,  8.53it/s] 26%|██▌       | 26/100 [00:03<00:08,  8.28it/s] 27%|██▋       | 27/100 [00:03<00:08,  8.43it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.56it/s] 29%|██▉       | 29/100 [00:03<00:09,  7.86it/s] 30%|███       | 30/100 [00:03<00:08,  7.89it/s] 31%|███       | 31/100 [00:03<00:08,  8.05it/s] 32%|███▏      | 32/100 [00:03<00:08,  8.03it/s] 33%|███▎      | 33/100 [00:03<00:08,  7.66it/s] 34%|███▍      | 34/100 [00:04<00:08,  7.72it/s] 35%|███▌      | 35/100 [00:04<00:08,  7.75it/s] 36%|███▌      | 36/100 [00:04<00:08,  7.82it/s] 37%|███▋      | 37/100 [00:04<00:08,  7.66it/s] 38%|███▊      | 38/100 [00:04<00:07,  7.94it/s] 39%|███▉      | 39/100 [00:04<00:07,  7.78it/s] 40%|████      | 40/100 [00:04<00:07,  8.07it/s] 41%|████      | 41/100 [00:04<00:07,  7.91it/s] 42%|████▏     | 42/100 [00:05<00:07,  8.19it/s] 43%|████▎     | 43/100 [00:05<00:07,  8.14it/s] 44%|████▍     | 44/100 [00:05<00:07,  7.91it/s] 45%|████▌     | 45/100 [00:05<00:06,  8.06it/s] 46%|████▌     | 46/100 [00:05<00:06,  7.74it/s] 47%|████▋     | 47/100 [00:05<00:06,  7.87it/s] 48%|████▊     | 48/100 [00:05<00:06,  7.76it/s] 49%|████▉     | 49/100 [00:05<00:06,  8.26it/s] 50%|█████     | 50/100 [00:06<00:06,  8.11it/s] 51%|█████     | 51/100 [00:06<00:06,  8.05it/s] 52%|█████▏    | 52/100 [00:06<00:06,  7.92it/s] 53%|█████▎    | 53/100 [00:06<00:06,  7.82it/s] 54%|█████▍    | 54/100 [00:06<00:05,  7.74it/s] 55%|█████▌    | 55/100 [00:06<00:05,  7.87it/s] 56%|█████▌    | 56/100 [00:06<00:05,  7.84it/s] 57%|█████▋    | 57/100 [00:07<00:05,  7.56it/s] 58%|█████▊    | 58/100 [00:07<00:05,  7.62it/s] 59%|█████▉    | 59/100 [00:07<00:05,  7.69it/s] 60%|██████    | 60/100 [00:07<00:05,  7.70it/s] 61%|██████    | 61/100 [00:07<00:05,  7.74it/s] 62%|██████▏   | 62/100 [00:07<00:04,  7.62it/s] 63%|██████▎   | 63/100 [00:07<00:04,  7.40it/s] 64%|██████▍   | 64/100 [00:07<00:04,  7.78it/s] 65%|██████▌   | 65/100 [00:08<00:04,  7.63it/s] 66%|██████▌   | 66/100 [00:08<00:04,  7.61it/s] 67%|██████▋   | 67/100 [00:08<00:04,  7.36it/s] 68%|██████▊   | 68/100 [00:08<00:04,  7.31it/s] 69%|██████▉   | 69/100 [00:08<00:04,  7.54it/s] 70%|███████   | 70/100 [00:08<00:04,  7.37it/s] 71%|███████   | 71/100 [00:08<00:03,  7.60it/s] 72%|███████▏  | 72/100 [00:08<00:03,  7.86it/s] 73%|███████▎  | 73/100 [00:09<00:03,  7.78it/s] 74%|███████▍  | 74/100 [00:09<00:03,  7.85it/s] 75%|███████▌  | 75/100 [00:09<00:03,  8.00it/s] 76%|███████▌  | 76/100 [00:09<00:02,  8.04it/s] 77%|███████▋  | 77/100 [00:09<00:02,  7.86it/s] 78%|███████▊  | 78/100 [00:09<00:02,  7.76it/s] 79%|███████▉  | 79/100 [00:09<00:02,  7.88it/s] 80%|████████  | 80/100 [00:10<00:02,  7.55it/s] 81%|████████  | 81/100 [00:10<00:02,  7.65it/s] 82%|████████▏ | 82/100 [00:10<00:02,  7.33it/s] 83%|████████▎ | 83/100 [00:10<00:02,  7.39it/s] 84%|████████▍ | 84/100 [00:10<00:02,  7.49it/s] 85%|████████▌ | 85/100 [00:10<00:01,  7.50it/s] 86%|████████▌ | 86/100 [00:10<00:01,  7.51it/s] 87%|████████▋ | 87/100 [00:10<00:01,  7.59it/s] 88%|████████▊ | 88/100 [00:11<00:01,  7.84it/s] 89%|████████▉ | 89/100 [00:11<00:01,  8.03it/s] 90%|█████████ | 90/100 [00:11<00:01,  8.07it/s] 91%|█████████ | 91/100 [00:11<00:01,  7.92it/s] 92%|█████████▏| 92/100 [00:11<00:01,  7.79it/s] 93%|█████████▎| 93/100 [00:11<00:00,  7.76it/s] 94%|█████████▍| 94/100 [00:11<00:00,  7.74it/s] 95%|█████████▌| 95/100 [00:11<00:00,  7.67it/s] 96%|█████████▌| 96/100 [00:12<00:00,  7.59it/s] 97%|█████████▋| 97/100 [00:12<00:00,  7.40it/s] 98%|█████████▊| 98/100 [00:12<00:00,  7.19it/s] 99%|█████████▉| 99/100 [00:12<00:00,  7.47it/s]100%|██████████| 100/100 [00:12<00:00,  7.39it/s]100%|██████████| 100/100 [00:12<00:00,  7.90it/s]
eval_p_index len:  9
individual_train 110
individual_eval 9
train data의 x, y, id 길이: 110 110 110
valid data의 x, y, id 길이: 5 5 5
test data의 x, y, id 길이: 4 4 4
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 38.00 MB
cuda
Epoch 1, Train Loss 0.689032, Valid_loss 0.713587
Epoch 2, Train Loss 0.668551, Valid_loss 0.705989
Epoch 3, Train Loss 0.650169, Valid_loss 0.696104
Epoch 4, Train Loss 0.632504, Valid_loss 0.685651
Epoch 5, Train Loss 0.618602, Valid_loss 0.680352
Epoch 6, Train Loss 0.606090, Valid_loss 0.671482
Epoch 7, Train Loss 0.598020, Valid_loss 0.665787
Epoch 8, Train Loss 0.591206, Valid_loss 0.662855
Epoch 9, Train Loss 0.587049, Valid_loss 0.657883
Epoch 10, Train Loss 0.581061, Valid_loss 0.650237
Epoch 11, Train Loss 0.576175, Valid_loss 0.658471
Epoch 12, Train Loss 0.571582, Valid_loss 0.648575
Epoch 13, Train Loss 0.567717, Valid_loss 0.643281
Epoch 14, Train Loss 0.562629, Valid_loss 0.641417
Epoch 15, Train Loss 0.559705, Valid_loss 0.641991
Epoch 16, Train Loss 0.556487, Valid_loss 0.625519
Epoch 17, Train Loss 0.552193, Valid_loss 0.639574
Epoch 18, Train Loss 0.548506, Valid_loss 0.629107
Epoch 19, Train Loss 0.544967, Valid_loss 0.618413
Epoch 20, Train Loss 0.543280, Valid_loss 0.631767
Epoch 21, Train Loss 0.539817, Valid_loss 0.615265
Epoch 22, Train Loss 0.537859, Valid_loss 0.619399
Epoch 23, Train Loss 0.534991, Valid_loss 0.616588
Epoch 24, Train Loss 0.531356, Valid_loss 0.609669
Epoch 25, Train Loss 0.528592, Valid_loss 0.611102
Epoch 26, Train Loss 0.526466, Valid_loss 0.603227
Epoch 27, Train Loss 0.524389, Valid_loss 0.605209
Epoch 28, Train Loss 0.521389, Valid_loss 0.601213
Epoch 29, Train Loss 0.518976, Valid_loss 0.594122
Epoch 30, Train Loss 0.516760, Valid_loss 0.590686
Epoch 31, Train Loss 0.514482, Valid_loss 0.585590
Epoch 32, Train Loss 0.513517, Valid_loss 0.584755
Epoch 33, Train Loss 0.510915, Valid_loss 0.572993
Epoch 34, Train Loss 0.508716, Valid_loss 0.573612
Epoch 35, Train Loss 0.506727, Valid_loss 0.561644
Epoch 36, Train Loss 0.504185, Valid_loss 0.561635
Epoch 37, Train Loss 0.502450, Valid_loss 0.552655
Epoch 38, Train Loss 0.499459, Valid_loss 0.547245
Epoch 39, Train Loss 0.497356, Valid_loss 0.545293
Epoch 40, Train Loss 0.496148, Valid_loss 0.545609
Epoch 41, Train Loss 0.494850, Valid_loss 0.543270
Epoch 42, Train Loss 0.492678, Valid_loss 0.543375
Epoch 43, Train Loss 0.491048, Valid_loss 0.539526
Epoch 44, Train Loss 0.490610, Valid_loss 0.539335
Epoch 45, Train Loss 0.487722, Valid_loss 0.536532
Epoch 46, Train Loss 0.487581, Valid_loss 0.537873
Epoch 47, Train Loss 0.485526, Valid_loss 0.537422
Epoch 48, Train Loss 0.484280, Valid_loss 0.536068
Epoch 49, Train Loss 0.482395, Valid_loss 0.534085
Epoch 50, Train Loss 0.481443, Valid_loss 0.532525
Epoch 51, Train Loss 0.481015, Valid_loss 0.532824
Epoch 52, Train Loss 0.478457, Valid_loss 0.535449
Control_Participant4 -- true: normal -- pred: COVID-19
COVID19_Participant26 -- true: COVID-19 -- pred: COVID-19
Control_Participant7 -- true: normal -- pred: normal
COVID19_Participant31 -- true: COVID-19 -- pred: normal
true :  [0, 1, 0, 1]
pred :  [1, 1, 0, 0]
Confusion Matrix: [1 1 1 1]
Best performance: Epoch 50, Loss 0.481443, Test ACC 0.500000, Test AUC 0.500000, Test Recall 0.500000, Test Precision 0.500000
✅ Total valid splits used: 4
🔁 Repeat 4, Fold 4
🔍 Split #5
  → train_p_index 환자 수: 14
  → test_p_index 환자 수: 5
  → train 환자 ID: ['COVID19_Participant17', 'COVID19_Participant19', 'COVID19_Participant20', 'COVID19_Participant22', 'COVID19_Participant26', 'COVID19_Participant28', 'COVID19_Participant29', 'COVID19_Participant32', 'COVID19_Participant37', 'Control_Participant10', 'Control_Participant15', 'Control_Participant3', 'Control_Participant5', 'Control_Participant9']
  → test  환자 ID: ['COVID19_Participant26', 'Control_Participant3', 'Control_Participant1', 'COVID19_Participant7', 'COVID19_Participant31']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: Control_Participant10, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: COVID19_Participant26, Label: 1
    ID: Control_Participant3, Label: 1
    ID: Control_Participant1, Label: 1
    ID: COVID19_Participant7, Label: 0
    ID: COVID19_Participant31, Label: 0
train_p_index_ 9
valid_p_index 5
test_p_index 5
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Epithelial_cells', 'Epithelial_cells', 'NK_cell', 'Epithelial_cells', 'Epithelial_cells', 'Keratinocytes', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
data augment 실행 함
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:11,  8.68it/s]  2%|▏         | 2/100 [00:00<00:10,  9.03it/s]  3%|▎         | 3/100 [00:00<00:11,  8.66it/s]  4%|▍         | 4/100 [00:00<00:11,  8.65it/s]  5%|▌         | 5/100 [00:00<00:10,  8.70it/s]  6%|▌         | 6/100 [00:00<00:10,  8.91it/s]  7%|▋         | 7/100 [00:00<00:10,  9.17it/s]  8%|▊         | 8/100 [00:00<00:11,  8.21it/s]  9%|▉         | 9/100 [00:01<00:10,  8.55it/s] 10%|█         | 10/100 [00:01<00:10,  8.60it/s] 11%|█         | 11/100 [00:01<00:10,  8.68it/s] 12%|█▏        | 12/100 [00:01<00:09,  8.85it/s] 13%|█▎        | 13/100 [00:01<00:10,  8.20it/s] 14%|█▍        | 14/100 [00:01<00:10,  8.59it/s] 15%|█▌        | 15/100 [00:01<00:09,  8.72it/s] 16%|█▌        | 16/100 [00:01<00:09,  8.77it/s] 17%|█▋        | 17/100 [00:01<00:09,  8.50it/s] 18%|█▊        | 18/100 [00:02<00:09,  8.63it/s] 19%|█▉        | 19/100 [00:02<00:09,  8.42it/s] 20%|██        | 20/100 [00:02<00:09,  8.68it/s] 21%|██        | 21/100 [00:02<00:09,  8.21it/s] 22%|██▏       | 22/100 [00:02<00:09,  8.29it/s] 23%|██▎       | 23/100 [00:02<00:09,  8.30it/s] 24%|██▍       | 24/100 [00:02<00:08,  8.51it/s] 25%|██▌       | 25/100 [00:02<00:08,  8.52it/s] 26%|██▌       | 26/100 [00:03<00:08,  8.44it/s] 27%|██▋       | 27/100 [00:03<00:08,  8.37it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.20it/s] 29%|██▉       | 29/100 [00:03<00:08,  8.33it/s] 30%|███       | 30/100 [00:03<00:08,  8.45it/s] 31%|███       | 31/100 [00:03<00:08,  8.39it/s] 32%|███▏      | 32/100 [00:03<00:07,  8.54it/s] 33%|███▎      | 33/100 [00:03<00:07,  8.57it/s] 34%|███▍      | 34/100 [00:03<00:07,  8.53it/s] 35%|███▌      | 35/100 [00:04<00:08,  7.99it/s] 36%|███▌      | 36/100 [00:04<00:07,  8.19it/s] 37%|███▋      | 37/100 [00:04<00:07,  8.18it/s] 38%|███▊      | 38/100 [00:04<00:07,  7.91it/s] 39%|███▉      | 39/100 [00:04<00:07,  8.09it/s] 40%|████      | 40/100 [00:04<00:07,  8.07it/s] 41%|████      | 41/100 [00:04<00:07,  8.08it/s] 42%|████▏     | 42/100 [00:04<00:07,  8.18it/s] 43%|████▎     | 43/100 [00:05<00:06,  8.24it/s] 44%|████▍     | 44/100 [00:05<00:06,  8.04it/s] 45%|████▌     | 45/100 [00:05<00:06,  8.19it/s] 46%|████▌     | 46/100 [00:05<00:06,  8.56it/s] 47%|████▋     | 47/100 [00:05<00:06,  8.59it/s] 48%|████▊     | 48/100 [00:05<00:06,  8.32it/s] 49%|████▉     | 49/100 [00:05<00:06,  8.29it/s] 50%|█████     | 50/100 [00:05<00:05,  8.35it/s] 51%|█████     | 51/100 [00:06<00:05,  8.19it/s] 52%|█████▏    | 52/100 [00:06<00:05,  8.13it/s] 53%|█████▎    | 53/100 [00:06<00:05,  8.20it/s] 54%|█████▍    | 54/100 [00:06<00:05,  8.17it/s] 55%|█████▌    | 55/100 [00:06<00:05,  8.31it/s] 56%|█████▌    | 56/100 [00:06<00:05,  8.18it/s] 57%|█████▋    | 57/100 [00:06<00:05,  8.35it/s] 58%|█████▊    | 58/100 [00:06<00:05,  7.84it/s] 59%|█████▉    | 59/100 [00:07<00:05,  8.06it/s] 60%|██████    | 60/100 [00:07<00:05,  7.84it/s] 61%|██████    | 61/100 [00:07<00:04,  7.95it/s] 62%|██████▏   | 62/100 [00:07<00:04,  7.90it/s] 63%|██████▎   | 63/100 [00:07<00:04,  7.87it/s] 64%|██████▍   | 64/100 [00:07<00:04,  7.87it/s] 65%|██████▌   | 65/100 [00:07<00:04,  7.94it/s] 66%|██████▌   | 66/100 [00:07<00:04,  8.12it/s] 67%|██████▋   | 67/100 [00:08<00:03,  8.35it/s] 68%|██████▊   | 68/100 [00:08<00:03,  8.14it/s] 69%|██████▉   | 69/100 [00:08<00:03,  8.08it/s] 70%|███████   | 70/100 [00:08<00:03,  8.02it/s] 71%|███████   | 71/100 [00:08<00:03,  7.88it/s] 72%|███████▏  | 72/100 [00:08<00:03,  7.98it/s] 73%|███████▎  | 73/100 [00:08<00:03,  8.15it/s] 74%|███████▍  | 74/100 [00:08<00:03,  8.29it/s] 75%|███████▌  | 75/100 [00:09<00:03,  8.28it/s] 76%|███████▌  | 76/100 [00:09<00:02,  8.20it/s] 77%|███████▋  | 77/100 [00:09<00:02,  8.01it/s] 78%|███████▊  | 78/100 [00:09<00:02,  7.85it/s] 79%|███████▉  | 79/100 [00:09<00:02,  7.95it/s] 80%|████████  | 80/100 [00:09<00:02,  8.10it/s] 81%|████████  | 81/100 [00:09<00:02,  7.94it/s] 82%|████████▏ | 82/100 [00:09<00:02,  7.86it/s] 83%|████████▎ | 83/100 [00:10<00:02,  8.03it/s] 84%|████████▍ | 84/100 [00:10<00:01,  8.07it/s] 85%|████████▌ | 85/100 [00:10<00:01,  7.91it/s] 86%|████████▌ | 86/100 [00:10<00:01,  7.77it/s] 87%|████████▋ | 87/100 [00:10<00:01,  7.57it/s] 88%|████████▊ | 88/100 [00:10<00:01,  7.68it/s] 89%|████████▉ | 89/100 [00:10<00:01,  7.68it/s] 90%|█████████ | 90/100 [00:10<00:01,  7.71it/s] 91%|█████████ | 91/100 [00:11<00:01,  7.69it/s] 92%|█████████▏| 92/100 [00:11<00:01,  7.76it/s] 93%|█████████▎| 93/100 [00:11<00:00,  7.81it/s] 94%|█████████▍| 94/100 [00:11<00:00,  7.78it/s] 95%|█████████▌| 95/100 [00:11<00:00,  7.65it/s] 96%|█████████▌| 96/100 [00:11<00:00,  7.28it/s] 97%|█████████▋| 97/100 [00:11<00:00,  7.17it/s] 98%|█████████▊| 98/100 [00:12<00:00,  7.36it/s] 99%|█████████▉| 99/100 [00:12<00:00,  7.58it/s]100%|██████████| 100/100 [00:12<00:00,  7.66it/s]100%|██████████| 100/100 [00:12<00:00,  8.14it/s]
eval_p_index len:  10
individual_train 109
individual_eval 10
train data의 x, y, id 길이: 109 109 109
valid data의 x, y, id 길이: 5 5 5
test data의 x, y, id 길이: 5 5 5
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 38.00 MB
cuda
Epoch 1, Train Loss 0.693002, Valid_loss 0.545475
Epoch 2, Train Loss 0.685617, Valid_loss 0.540882
Epoch 3, Train Loss 0.680258, Valid_loss 0.533969
Epoch 4, Train Loss 0.665537, Valid_loss 0.523846
Epoch 5, Train Loss 0.658694, Valid_loss 0.508794
Epoch 6, Train Loss 0.642809, Valid_loss 0.488403
Epoch 7, Train Loss 0.613278, Valid_loss 0.487030
Epoch 8, Train Loss 0.579812, Valid_loss 0.599819
Epoch 9, Train Loss 0.527565, Valid_loss 0.598046
Epoch 10, Train Loss 0.496087, Valid_loss 0.556138
Epoch 11, Train Loss 0.482118, Valid_loss 0.556981
Epoch 12, Train Loss 0.467847, Valid_loss 0.539060
Epoch 13, Train Loss 0.458101, Valid_loss 0.537476
Epoch 14, Train Loss 0.445892, Valid_loss 0.547870
Epoch 15, Train Loss 0.443488, Valid_loss 0.551245
Epoch 16, Train Loss 0.433492, Valid_loss 0.551482
Epoch 17, Train Loss 0.428224, Valid_loss 0.547017
Epoch 18, Train Loss 0.425917, Valid_loss 0.553598
Epoch 19, Train Loss 0.421326, Valid_loss 0.556585
Epoch 20, Train Loss 0.420468, Valid_loss 0.556954
Epoch 21, Train Loss 0.417877, Valid_loss 0.560231
Epoch 22, Train Loss 0.417569, Valid_loss 0.560546
Epoch 23, Train Loss 0.415475, Valid_loss 0.561262
Epoch 24, Train Loss 0.412582, Valid_loss 0.561151
Epoch 25, Train Loss 0.410948, Valid_loss 0.563328
Epoch 26, Train Loss 0.411332, Valid_loss 0.559217
Epoch 27, Train Loss 0.409887, Valid_loss 0.559258
Epoch 28, Train Loss 0.408291, Valid_loss 0.562226
Epoch 29, Train Loss 0.407216, Valid_loss 0.562418
Epoch 30, Train Loss 0.408219, Valid_loss 0.560912
Epoch 31, Train Loss 0.406493, Valid_loss 0.559364
Epoch 32, Train Loss 0.405474, Valid_loss 0.562146
Epoch 33, Train Loss 0.404280, Valid_loss 0.560777
Epoch 34, Train Loss 0.403991, Valid_loss 0.560913
Epoch 35, Train Loss 0.401762, Valid_loss 0.561286
Epoch 36, Train Loss 0.399863, Valid_loss 0.560032
Epoch 37, Train Loss 0.402772, Valid_loss 0.562847
Epoch 38, Train Loss 0.400630, Valid_loss 0.561292
Epoch 39, Train Loss 0.398592, Valid_loss 0.561191
Epoch 40, Train Loss 0.399572, Valid_loss 0.558271
Epoch 41, Train Loss 0.398708, Valid_loss 0.562107
Epoch 42, Train Loss 0.397695, Valid_loss 0.550355
Epoch 43, Train Loss 0.396747, Valid_loss 0.562994
Epoch 44, Train Loss 0.397665, Valid_loss 0.554557
Epoch 45, Train Loss 0.395038, Valid_loss 0.565282
Epoch 46, Train Loss 0.395417, Valid_loss 0.555147
Epoch 47, Train Loss 0.394362, Valid_loss 0.549997
Epoch 48, Train Loss 0.393391, Valid_loss 0.554993
Epoch 49, Train Loss 0.395322, Valid_loss 0.550951
Epoch 50, Train Loss 0.392153, Valid_loss 0.547189
Epoch 51, Train Loss 0.391883, Valid_loss 0.546263
Epoch 52, Train Loss 0.390347, Valid_loss 0.539153
Epoch 53, Train Loss 0.388102, Valid_loss 0.543763
Epoch 54, Train Loss 0.391028, Valid_loss 0.545019
COVID19_Participant26 -- true: COVID-19 -- pred: COVID-19
Control_Participant3 -- true: normal -- pred: COVID-19
Control_Participant1 -- true: normal -- pred: COVID-19
COVID19_Participant7 -- true: COVID-19 -- pred: COVID-19
COVID19_Participant31 -- true: COVID-19 -- pred: COVID-19
true :  [1, 0, 0, 1, 1]
pred :  [1, 1, 1, 1, 1]
Confusion Matrix: [0 2 0 3]
Best performance: Epoch 7, Loss 0.613278, Test ACC 0.600000, Test AUC 0.500000, Test Recall 1.000000, Test Precision 0.600000
✅ Total valid splits used: 5

📌 Repeat 4: 평균 AUC = 0.6000, 표준편차 = 0.3742
