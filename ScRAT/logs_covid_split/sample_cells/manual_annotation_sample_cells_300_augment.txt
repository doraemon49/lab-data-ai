Namespace(seed=240, batch_size=16, learning_rate=0.0001, weight_decay=0.0001, epochs=100, task='custom_covid', emb_dim=8, h_dim=128, dropout=0.0, layers=1, heads=4, train_sample_cells=300, test_sample_cells=300, train_num_sample=20, test_num_sample=100, model='Transformer', dataset=None, inter_only=False, same_pheno=0, augment_num=100, alpha=1.0, repeat=5, all=1, min_size=6000, n_splits=5, pca=False, mix_type=1, norm_first=False, warmup=False, top_k=1)
🔁 Repeat 0, Fold 0
🔍 Split #1
  → train_p_index 환자 수: 25
  → test_p_index 환자 수: 7
  → train 환자 ID: ['COVID19_Participant13', 'COVID19_Participant14', 'COVID19_Participant15', 'COVID19_Participant17', 'COVID19_Participant19', 'COVID19_Participant2', 'COVID19_Participant20', 'COVID19_Participant22', 'COVID19_Participant23', 'COVID19_Participant26', 'COVID19_Participant29', 'COVID19_Participant31', 'COVID19_Participant32', 'COVID19_Participant37', 'COVID19_Participant4', 'COVID19_Participant40', 'COVID19_Participant7', 'Control_Participant1', 'Control_Participant10', 'Control_Participant11', 'Control_Participant15', 'Control_Participant3', 'Control_Participant4', 'Control_Participant5', 'Control_Participant8']
  → test  환자 ID: ['COVID19_Participant5', 'COVID19_Participant31', 'COVID19_Participant7', 'Control_Participant1', 'Control_Participant4', 'COVID19_Participant13', 'COVID19_Participant26']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant10, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant4, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant8, Label: 0
  → test 환자 ID 및 라벨:
    ID: COVID19_Participant5, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: Control_Participant1, Label: 1
    ID: Control_Participant4, Label: 1
    ID: COVID19_Participant13, Label: 0
    ID: COVID19_Participant26, Label: 0
train_p_index_ 16
valid_p_index 9
test_p_index 7
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Squamous Cells', 'Secretory Cells', 'Macrophages', 'Developing Ciliated Cells', 'B Cells', 'Ciliated Cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
data augment 실행 함
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:11,  8.78it/s]  2%|▏         | 2/100 [00:00<00:10,  8.98it/s]  3%|▎         | 3/100 [00:00<00:10,  8.93it/s]  4%|▍         | 4/100 [00:00<00:10,  8.91it/s]  5%|▌         | 5/100 [00:00<00:10,  8.75it/s]  6%|▌         | 6/100 [00:00<00:10,  8.68it/s]  7%|▋         | 7/100 [00:00<00:15,  6.13it/s]  8%|▊         | 8/100 [00:01<00:13,  6.92it/s]  9%|▉         | 9/100 [00:01<00:12,  7.44it/s] 10%|█         | 10/100 [00:01<00:11,  8.05it/s] 11%|█         | 11/100 [00:01<00:10,  8.30it/s] 12%|█▏        | 12/100 [00:01<00:10,  8.70it/s] 13%|█▎        | 13/100 [00:01<00:09,  9.02it/s] 14%|█▍        | 14/100 [00:01<00:09,  9.17it/s] 15%|█▌        | 15/100 [00:01<00:09,  9.22it/s] 16%|█▌        | 16/100 [00:01<00:08,  9.35it/s] 17%|█▋        | 17/100 [00:02<00:10,  7.65it/s] 18%|█▊        | 18/100 [00:02<00:10,  7.83it/s] 19%|█▉        | 19/100 [00:02<00:10,  8.01it/s] 20%|██        | 20/100 [00:02<00:09,  8.49it/s] 21%|██        | 21/100 [00:02<00:09,  8.61it/s] 22%|██▏       | 22/100 [00:02<00:08,  8.94it/s] 23%|██▎       | 23/100 [00:02<00:10,  7.62it/s] 24%|██▍       | 24/100 [00:02<00:09,  8.03it/s] 25%|██▌       | 25/100 [00:03<00:09,  8.33it/s] 26%|██▌       | 26/100 [00:03<00:09,  7.85it/s] 27%|██▋       | 27/100 [00:03<00:08,  8.22it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.42it/s] 29%|██▉       | 29/100 [00:03<00:08,  8.49it/s] 30%|███       | 30/100 [00:03<00:08,  8.49it/s] 31%|███       | 31/100 [00:03<00:08,  8.54it/s] 32%|███▏      | 32/100 [00:03<00:07,  8.72it/s] 34%|███▍      | 34/100 [00:04<00:07,  9.03it/s] 35%|███▌      | 35/100 [00:04<00:07,  8.99it/s] 36%|███▌      | 36/100 [00:04<00:07,  9.09it/s] 37%|███▋      | 37/100 [00:04<00:06,  9.08it/s] 38%|███▊      | 38/100 [00:04<00:08,  7.27it/s] 39%|███▉      | 39/100 [00:04<00:07,  7.68it/s] 40%|████      | 40/100 [00:04<00:07,  8.08it/s] 41%|████      | 41/100 [00:04<00:06,  8.43it/s] 42%|████▏     | 42/100 [00:05<00:06,  8.42it/s] 43%|████▎     | 43/100 [00:05<00:06,  8.59it/s] 44%|████▍     | 44/100 [00:05<00:09,  6.17it/s] 45%|████▌     | 45/100 [00:05<00:08,  6.83it/s] 46%|████▌     | 46/100 [00:05<00:07,  6.77it/s] 47%|████▋     | 47/100 [00:05<00:07,  6.65it/s] 48%|████▊     | 48/100 [00:06<00:11,  4.42it/s] 49%|████▉     | 49/100 [00:06<00:09,  5.17it/s] 50%|█████     | 50/100 [00:06<00:08,  5.75it/s] 51%|█████     | 51/100 [00:06<00:07,  6.43it/s] 52%|█████▏    | 52/100 [00:06<00:06,  6.92it/s] 53%|█████▎    | 53/100 [00:06<00:07,  6.38it/s] 54%|█████▍    | 54/100 [00:07<00:08,  5.32it/s] 55%|█████▌    | 55/100 [00:07<00:07,  6.10it/s] 56%|█████▌    | 56/100 [00:07<00:06,  6.72it/s] 57%|█████▋    | 57/100 [00:07<00:05,  7.19it/s] 58%|█████▊    | 58/100 [00:07<00:05,  7.24it/s] 59%|█████▉    | 59/100 [00:07<00:07,  5.84it/s] 60%|██████    | 60/100 [00:08<00:06,  6.56it/s] 61%|██████    | 61/100 [00:08<00:05,  7.24it/s] 62%|██████▏   | 62/100 [00:08<00:05,  7.51it/s] 63%|██████▎   | 63/100 [00:08<00:05,  6.60it/s] 64%|██████▍   | 64/100 [00:08<00:05,  7.13it/s] 65%|██████▌   | 65/100 [00:08<00:04,  7.22it/s] 66%|██████▌   | 66/100 [00:08<00:04,  7.55it/s] 67%|██████▋   | 67/100 [00:08<00:04,  8.06it/s] 68%|██████▊   | 68/100 [00:09<00:03,  8.32it/s] 69%|██████▉   | 69/100 [00:09<00:03,  7.96it/s] 70%|███████   | 70/100 [00:09<00:06,  4.71it/s] 71%|███████   | 71/100 [00:09<00:05,  5.50it/s] 72%|███████▏  | 72/100 [00:09<00:04,  6.24it/s] 73%|███████▎  | 73/100 [00:09<00:03,  6.91it/s] 74%|███████▍  | 74/100 [00:09<00:03,  7.54it/s] 75%|███████▌  | 75/100 [00:10<00:03,  7.69it/s] 76%|███████▌  | 76/100 [00:10<00:03,  7.86it/s] 77%|███████▋  | 77/100 [00:10<00:02,  7.96it/s] 78%|███████▊  | 78/100 [00:10<00:02,  8.39it/s] 79%|███████▉  | 79/100 [00:10<00:02,  8.46it/s] 80%|████████  | 80/100 [00:10<00:02,  8.47it/s] 81%|████████  | 81/100 [00:10<00:02,  8.37it/s] 82%|████████▏ | 82/100 [00:10<00:02,  8.48it/s] 83%|████████▎ | 83/100 [00:11<00:02,  8.42it/s] 84%|████████▍ | 84/100 [00:11<00:01,  8.47it/s] 85%|████████▌ | 85/100 [00:11<00:01,  8.70it/s] 86%|████████▌ | 86/100 [00:11<00:01,  8.78it/s] 87%|████████▋ | 87/100 [00:11<00:01,  8.78it/s] 88%|████████▊ | 88/100 [00:11<00:01,  9.04it/s] 89%|████████▉ | 89/100 [00:11<00:01,  7.62it/s] 90%|█████████ | 90/100 [00:11<00:01,  7.97it/s] 91%|█████████ | 91/100 [00:12<00:01,  8.19it/s] 92%|█████████▏| 92/100 [00:12<00:00,  8.48it/s] 93%|█████████▎| 93/100 [00:12<00:00,  8.21it/s] 94%|█████████▍| 94/100 [00:12<00:00,  8.36it/s] 95%|█████████▌| 95/100 [00:12<00:01,  4.89it/s] 96%|█████████▌| 96/100 [00:12<00:00,  5.58it/s] 97%|█████████▋| 97/100 [00:13<00:00,  5.58it/s] 98%|█████████▊| 98/100 [00:13<00:00,  6.28it/s] 99%|█████████▉| 99/100 [00:13<00:00,  6.85it/s]100%|██████████| 100/100 [00:13<00:00,  7.40it/s]100%|██████████| 100/100 [00:13<00:00,  7.46it/s]
eval_p_index len:  16
individual_train 116
individual_eval 16
train data의 x, y, id 길이: 116 116 116
valid data의 x, y, id 길이: 9 9 9
test data의 x, y, id 길이: 7 7 7
output_class :  1
Memory Allocated: 0.44 MB
Memory Reserved: 2.00 MB
cuda
Epoch 1, Train Loss 0.544335, Valid_loss 0.731170
Epoch 2, Train Loss 0.557370, Valid_loss 0.729959
Epoch 3, Train Loss 0.567033, Valid_loss 0.723440
Epoch 4, Train Loss 0.548400, Valid_loss 0.709757
Epoch 5, Train Loss 0.561571, Valid_loss 0.699548
Epoch 6, Train Loss 0.524598, Valid_loss 0.687302
Epoch 7, Train Loss 0.530070, Valid_loss 0.689667
Epoch 8, Train Loss 0.506034, Valid_loss 0.678380
Epoch 9, Train Loss 0.526371, Valid_loss 0.661162
Epoch 10, Train Loss 0.495561, Valid_loss 0.652531
Epoch 11, Train Loss 0.504789, Valid_loss 0.662466
Epoch 12, Train Loss 0.491652, Valid_loss 0.647288
Epoch 13, Train Loss 0.488305, Valid_loss 0.633987
Epoch 14, Train Loss 0.469481, Valid_loss 0.639814
Epoch 15, Train Loss 0.462839, Valid_loss 0.631595
Epoch 16, Train Loss 0.473667, Valid_loss 0.629820
Epoch 17, Train Loss 0.474718, Valid_loss 0.641322
Epoch 18, Train Loss 0.467158, Valid_loss 0.640581
Epoch 19, Train Loss 0.457178, Valid_loss 0.652947
Epoch 20, Train Loss 0.460035, Valid_loss 0.632813
Epoch 21, Train Loss 0.448333, Valid_loss 0.645906
Epoch 22, Train Loss 0.450544, Valid_loss 0.648867
Epoch 23, Train Loss 0.447945, Valid_loss 0.646545
Epoch 24, Train Loss 0.443103, Valid_loss 0.645692
Epoch 25, Train Loss 0.446956, Valid_loss 0.646523
Epoch 26, Train Loss 0.437526, Valid_loss 0.652332
Epoch 27, Train Loss 0.443187, Valid_loss 0.643906
Epoch 28, Train Loss 0.450912, Valid_loss 0.650120
Epoch 29, Train Loss 0.449346, Valid_loss 0.644206
Epoch 30, Train Loss 0.445418, Valid_loss 0.656207
Epoch 31, Train Loss 0.439379, Valid_loss 0.647057
Epoch 32, Train Loss 0.447526, Valid_loss 0.653284
Epoch 33, Train Loss 0.439790, Valid_loss 0.643020
Epoch 34, Train Loss 0.455981, Valid_loss 0.662177
Epoch 35, Train Loss 0.428830, Valid_loss 0.658394
Epoch 36, Train Loss 0.435268, Valid_loss 0.661772
Epoch 37, Train Loss 0.452052, Valid_loss 0.654766
Epoch 38, Train Loss 0.438671, Valid_loss 0.657879
Epoch 39, Train Loss 0.420754, Valid_loss 0.659110
Epoch 40, Train Loss 0.428165, Valid_loss 0.664418
Epoch 41, Train Loss 0.423398, Valid_loss 0.660872
Epoch 42, Train Loss 0.440719, Valid_loss 0.662062
Epoch 43, Train Loss 0.427728, Valid_loss 0.654967
Epoch 44, Train Loss 0.429460, Valid_loss 0.660696
Epoch 45, Train Loss 0.434981, Valid_loss 0.661847
Epoch 46, Train Loss 0.434920, Valid_loss 0.654706
Epoch 47, Train Loss 0.421389, Valid_loss 0.658367
Epoch 48, Train Loss 0.428036, Valid_loss 0.664369
Epoch 49, Train Loss 0.410614, Valid_loss 0.654734
Epoch 50, Train Loss 0.441041, Valid_loss 0.652526
Epoch 51, Train Loss 0.436275, Valid_loss 0.651660
Epoch 52, Train Loss 0.422266, Valid_loss 0.654696
Epoch 53, Train Loss 0.418990, Valid_loss 0.656166
COVID19_Participant5 -- true: COVID-19 -- pred: COVID-19
COVID19_Participant31 -- true: COVID-19 -- pred: COVID-19
COVID19_Participant7 -- true: COVID-19 -- pred: COVID-19
Control_Participant1 -- true: normal -- pred: COVID-19
Control_Participant4 -- true: normal -- pred: COVID-19
COVID19_Participant13 -- true: COVID-19 -- pred: COVID-19
COVID19_Participant26 -- true: COVID-19 -- pred: COVID-19
true :  [1, 1, 1, 0, 0, 1, 1]
pred :  [1, 1, 1, 1, 1, 1, 1]
Confusion Matrix: [0 2 0 5]
Best performance: Epoch 16, Loss 0.473667, Test ACC 0.714286, Test AUC 0.600000, Test Recall 1.000000, Test Precision 0.714286
✅ Total valid splits used: 1
🔁 Repeat 0, Fold 1
🔍 Split #2
  → train_p_index 환자 수: 27
  → test_p_index 환자 수: 5
  → train 환자 ID: ['COVID19_Participant11', 'COVID19_Participant13', 'COVID19_Participant14', 'COVID19_Participant17', 'COVID19_Participant19', 'COVID19_Participant2', 'COVID19_Participant20', 'COVID19_Participant22', 'COVID19_Participant23', 'COVID19_Participant25', 'COVID19_Participant26', 'COVID19_Participant28', 'COVID19_Participant29', 'COVID19_Participant37', 'COVID19_Participant39', 'COVID19_Participant4', 'COVID19_Participant40', 'COVID19_Participant7', 'COVID19_Participant8', 'Control_Participant1', 'Control_Participant10', 'Control_Participant11', 'Control_Participant4', 'Control_Participant5', 'Control_Participant7', 'Control_Participant8', 'Control_Participant9']
  → test  환자 ID: ['Control_Participant5', 'Control_Participant7', 'Control_Participant4', 'COVID19_Participant19', 'Control_Participant7']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant10, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant4, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant8, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: Control_Participant5, Label: 1
    ID: Control_Participant7, Label: 1
    ID: Control_Participant4, Label: 1
    ID: COVID19_Participant19, Label: 0
    ID: Control_Participant7, Label: 0
train_p_index_ 18
valid_p_index 9
test_p_index 5
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Ciliated Cells', 'Developing Ciliated Cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
data augment 실행 함
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  2%|▏         | 2/100 [00:00<00:09,  9.84it/s]  4%|▍         | 4/100 [00:00<00:09, 10.09it/s]  6%|▌         | 6/100 [00:00<00:10,  9.30it/s]  7%|▋         | 7/100 [00:00<00:10,  9.22it/s]  8%|▊         | 8/100 [00:00<00:10,  9.15it/s]  9%|▉         | 9/100 [00:00<00:09,  9.17it/s] 11%|█         | 11/100 [00:01<00:09,  9.34it/s] 12%|█▏        | 12/100 [00:01<00:09,  9.42it/s] 13%|█▎        | 13/100 [00:01<00:09,  9.43it/s] 14%|█▍        | 14/100 [00:01<00:09,  9.28it/s] 15%|█▌        | 15/100 [00:01<00:10,  8.16it/s] 16%|█▌        | 16/100 [00:01<00:10,  8.29it/s] 17%|█▋        | 17/100 [00:01<00:10,  8.11it/s] 18%|█▊        | 18/100 [00:02<00:13,  6.01it/s] 19%|█▉        | 19/100 [00:02<00:12,  6.73it/s] 21%|██        | 21/100 [00:02<00:12,  6.29it/s] 22%|██▏       | 22/100 [00:02<00:13,  5.58it/s] 24%|██▍       | 24/100 [00:03<00:11,  6.80it/s] 25%|██▌       | 25/100 [00:03<00:12,  6.00it/s] 26%|██▌       | 26/100 [00:03<00:11,  6.63it/s] 27%|██▋       | 27/100 [00:03<00:10,  7.14it/s] 28%|██▊       | 28/100 [00:03<00:09,  7.58it/s] 29%|██▉       | 29/100 [00:03<00:09,  7.85it/s] 31%|███       | 31/100 [00:03<00:07,  8.63it/s] 32%|███▏      | 32/100 [00:04<00:07,  8.76it/s] 33%|███▎      | 33/100 [00:04<00:07,  8.83it/s] 34%|███▍      | 34/100 [00:04<00:07,  9.07it/s] 35%|███▌      | 35/100 [00:04<00:07,  8.86it/s] 36%|███▌      | 36/100 [00:04<00:07,  8.91it/s] 37%|███▋      | 37/100 [00:04<00:07,  8.91it/s] 39%|███▉      | 39/100 [00:04<00:06,  9.15it/s] 40%|████      | 40/100 [00:04<00:06,  9.16it/s] 41%|████      | 41/100 [00:05<00:06,  9.16it/s] 42%|████▏     | 42/100 [00:05<00:06,  8.42it/s] 43%|████▎     | 43/100 [00:05<00:06,  8.49it/s] 44%|████▍     | 44/100 [00:05<00:06,  8.62it/s] 45%|████▌     | 45/100 [00:05<00:06,  8.76it/s] 46%|████▌     | 46/100 [00:05<00:06,  8.92it/s] 47%|████▋     | 47/100 [00:05<00:05,  9.03it/s] 48%|████▊     | 48/100 [00:05<00:05,  8.87it/s] 49%|████▉     | 49/100 [00:05<00:05,  8.85it/s] 50%|█████     | 50/100 [00:06<00:05,  8.82it/s] 51%|█████     | 51/100 [00:06<00:05,  8.82it/s] 52%|█████▏    | 52/100 [00:06<00:05,  8.67it/s] 53%|█████▎    | 53/100 [00:06<00:05,  8.70it/s] 54%|█████▍    | 54/100 [00:06<00:05,  8.77it/s] 55%|█████▌    | 55/100 [00:06<00:05,  8.89it/s] 56%|█████▌    | 56/100 [00:06<00:04,  9.17it/s] 57%|█████▋    | 57/100 [00:06<00:04,  9.21it/s] 58%|█████▊    | 58/100 [00:07<00:06,  6.51it/s] 59%|█████▉    | 59/100 [00:07<00:05,  7.09it/s] 60%|██████    | 60/100 [00:07<00:05,  7.45it/s] 61%|██████    | 61/100 [00:07<00:05,  7.63it/s] 62%|██████▏   | 62/100 [00:07<00:04,  8.06it/s] 63%|██████▎   | 63/100 [00:07<00:04,  7.80it/s] 64%|██████▍   | 64/100 [00:07<00:05,  7.00it/s] 65%|██████▌   | 65/100 [00:07<00:04,  7.63it/s] 66%|██████▌   | 66/100 [00:08<00:04,  7.83it/s] 67%|██████▋   | 67/100 [00:08<00:03,  8.34it/s] 68%|██████▊   | 68/100 [00:08<00:03,  8.66it/s] 69%|██████▉   | 69/100 [00:08<00:03,  8.82it/s] 70%|███████   | 70/100 [00:08<00:03,  8.56it/s] 71%|███████   | 71/100 [00:08<00:03,  8.63it/s] 72%|███████▏  | 72/100 [00:08<00:03,  8.87it/s] 73%|███████▎  | 73/100 [00:08<00:03,  8.32it/s] 74%|███████▍  | 74/100 [00:09<00:03,  8.63it/s] 75%|███████▌  | 75/100 [00:09<00:03,  7.37it/s] 76%|███████▌  | 76/100 [00:09<00:03,  7.71it/s] 77%|███████▋  | 77/100 [00:09<00:03,  7.59it/s] 78%|███████▊  | 78/100 [00:09<00:02,  7.71it/s] 79%|███████▉  | 79/100 [00:09<00:02,  7.97it/s] 80%|████████  | 80/100 [00:09<00:02,  8.03it/s] 81%|████████  | 81/100 [00:09<00:02,  8.19it/s] 82%|████████▏ | 82/100 [00:10<00:02,  8.32it/s] 83%|████████▎ | 83/100 [00:10<00:02,  8.10it/s] 84%|████████▍ | 84/100 [00:10<00:01,  8.28it/s] 85%|████████▌ | 85/100 [00:10<00:01,  8.21it/s] 86%|████████▌ | 86/100 [00:10<00:01,  8.42it/s] 87%|████████▋ | 87/100 [00:10<00:01,  8.53it/s] 88%|████████▊ | 88/100 [00:10<00:01,  8.80it/s] 89%|████████▉ | 89/100 [00:10<00:01,  9.11it/s] 90%|█████████ | 90/100 [00:10<00:01,  9.08it/s] 91%|█████████ | 91/100 [00:11<00:01,  8.76it/s] 92%|█████████▏| 92/100 [00:11<00:00,  8.80it/s] 93%|█████████▎| 93/100 [00:11<00:00,  8.78it/s] 94%|█████████▍| 94/100 [00:11<00:00,  8.72it/s] 95%|█████████▌| 95/100 [00:11<00:00,  8.95it/s] 96%|█████████▌| 96/100 [00:11<00:00,  8.78it/s] 97%|█████████▋| 97/100 [00:11<00:00,  8.75it/s] 98%|█████████▊| 98/100 [00:12<00:00,  6.03it/s] 99%|█████████▉| 99/100 [00:12<00:00,  6.72it/s]100%|██████████| 100/100 [00:12<00:00,  7.26it/s]100%|██████████| 100/100 [00:12<00:00,  8.15it/s]
eval_p_index len:  14
individual_train 118
individual_eval 14
train data의 x, y, id 길이: 118 118 118
valid data의 x, y, id 길이: 9 9 9
test data의 x, y, id 길이: 5 5 5
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.602124, Valid_loss 0.689237
Epoch 2, Train Loss 0.590163, Valid_loss 0.690488
Epoch 3, Train Loss 0.591170, Valid_loss 0.692212
Epoch 4, Train Loss 0.583743, Valid_loss 0.692402
Epoch 5, Train Loss 0.586578, Valid_loss 0.691693
Epoch 6, Train Loss 0.582388, Valid_loss 0.691531
Epoch 7, Train Loss 0.582231, Valid_loss 0.692219
Epoch 8, Train Loss 0.571591, Valid_loss 0.692741
Epoch 9, Train Loss 0.592545, Valid_loss 0.692628
Epoch 10, Train Loss 0.580062, Valid_loss 0.692706
Epoch 11, Train Loss 0.579669, Valid_loss 0.695336
Epoch 12, Train Loss 0.567363, Valid_loss 0.676923
Epoch 13, Train Loss 0.518739, Valid_loss 0.716351
Epoch 14, Train Loss 0.508361, Valid_loss 0.699747
Epoch 15, Train Loss 0.480977, Valid_loss 0.653573
Epoch 16, Train Loss 0.480556, Valid_loss 0.648398
Epoch 17, Train Loss 0.465639, Valid_loss 0.685281
Epoch 18, Train Loss 0.477165, Valid_loss 0.664462
Epoch 19, Train Loss 0.481598, Valid_loss 0.661603
Epoch 20, Train Loss 0.452688, Valid_loss 0.672187
Epoch 21, Train Loss 0.447762, Valid_loss 0.667825
Epoch 22, Train Loss 0.453652, Valid_loss 0.664920
Epoch 23, Train Loss 0.462095, Valid_loss 0.668387
Epoch 24, Train Loss 0.437232, Valid_loss 0.667013
Epoch 25, Train Loss 0.470696, Valid_loss 0.661786
Epoch 26, Train Loss 0.461187, Valid_loss 0.664549
Epoch 27, Train Loss 0.441194, Valid_loss 0.657836
Epoch 28, Train Loss 0.446331, Valid_loss 0.659896
Epoch 29, Train Loss 0.431773, Valid_loss 0.656803
Epoch 30, Train Loss 0.425775, Valid_loss 0.655773
Epoch 31, Train Loss 0.426172, Valid_loss 0.647317
Epoch 32, Train Loss 0.433980, Valid_loss 0.641518
Epoch 33, Train Loss 0.423864, Valid_loss 0.641334
Epoch 34, Train Loss 0.423066, Valid_loss 0.639422
Epoch 35, Train Loss 0.424692, Valid_loss 0.630220
Epoch 36, Train Loss 0.415958, Valid_loss 0.630310
Epoch 37, Train Loss 0.411681, Valid_loss 0.629935
Epoch 38, Train Loss 0.426936, Valid_loss 0.627118
Epoch 39, Train Loss 0.400228, Valid_loss 0.617835
Epoch 40, Train Loss 0.405866, Valid_loss 0.619832
Epoch 41, Train Loss 0.401405, Valid_loss 0.616213
Epoch 42, Train Loss 0.415220, Valid_loss 0.611579
Epoch 43, Train Loss 0.403341, Valid_loss 0.609329
Epoch 44, Train Loss 0.386592, Valid_loss 0.615531
Epoch 45, Train Loss 0.400300, Valid_loss 0.610415
Epoch 46, Train Loss 0.388617, Valid_loss 0.607119
Epoch 47, Train Loss 0.391297, Valid_loss 0.611996
Epoch 48, Train Loss 0.390334, Valid_loss 0.609597
Epoch 49, Train Loss 0.398519, Valid_loss 0.606995
Epoch 50, Train Loss 0.392663, Valid_loss 0.607796
Epoch 51, Train Loss 0.388396, Valid_loss 0.606292
Epoch 52, Train Loss 0.387142, Valid_loss 0.610238
Epoch 53, Train Loss 0.397204, Valid_loss 0.608499
Epoch 54, Train Loss 0.399364, Valid_loss 0.609889
Epoch 55, Train Loss 0.388362, Valid_loss 0.604703
Epoch 56, Train Loss 0.388386, Valid_loss 0.607582
Epoch 57, Train Loss 0.381433, Valid_loss 0.609368
Control_Participant5 -- true: normal -- pred: normal
Control_Participant7 -- true: normal -- pred: normal
Control_Participant4 -- true: normal -- pred: COVID-19
COVID19_Participant19 -- true: COVID-19 -- pred: COVID-19
Control_Participant7 -- true: normal -- pred: COVID-19
true :  [0, 0, 0, 1, 0]
pred :  [0, 0, 1, 1, 1]
Confusion Matrix: [2 2 0 1]
Best performance: Epoch 55, Loss 0.388362, Test ACC 0.600000, Test AUC 1.000000, Test Recall 1.000000, Test Precision 0.333333
✅ Total valid splits used: 2
🔁 Repeat 0, Fold 2
🔍 Split #3
  → train_p_index 환자 수: 26
  → test_p_index 환자 수: 6
  → train 환자 ID: ['COVID19_Participant11', 'COVID19_Participant13', 'COVID19_Participant15', 'COVID19_Participant17', 'COVID19_Participant19', 'COVID19_Participant20', 'COVID19_Participant22', 'COVID19_Participant25', 'COVID19_Participant26', 'COVID19_Participant28', 'COVID19_Participant29', 'COVID19_Participant31', 'COVID19_Participant32', 'COVID19_Participant37', 'COVID19_Participant39', 'COVID19_Participant40', 'COVID19_Participant7', 'COVID19_Participant8', 'Control_Participant1', 'Control_Participant10', 'Control_Participant15', 'Control_Participant3', 'Control_Participant5', 'Control_Participant7', 'Control_Participant8', 'Control_Participant9']
  → test  환자 ID: ['Control_Participant7', 'Control_Participant5', 'COVID19_Participant26', 'COVID19_Participant26', 'COVID19_Participant13', 'Control_Participant7']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant10, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant8, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: Control_Participant7, Label: 1
    ID: Control_Participant5, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant13, Label: 0
    ID: Control_Participant7, Label: 0
train_p_index_ 17
valid_p_index 9
test_p_index 6
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Ciliated Cells', 'Developing Ciliated Cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
data augment 실행 함
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:11,  8.51it/s]  2%|▏         | 2/100 [00:00<00:10,  8.98it/s]  3%|▎         | 3/100 [00:00<00:15,  6.39it/s]  4%|▍         | 4/100 [00:00<00:15,  6.25it/s]  5%|▌         | 5/100 [00:00<00:13,  7.14it/s]  6%|▌         | 6/100 [00:00<00:12,  7.68it/s]  8%|▊         | 8/100 [00:01<00:12,  7.31it/s] 10%|█         | 10/100 [00:01<00:12,  7.37it/s] 12%|█▏        | 12/100 [00:01<00:11,  7.90it/s] 13%|█▎        | 13/100 [00:01<00:10,  8.19it/s] 14%|█▍        | 14/100 [00:01<00:10,  8.40it/s] 15%|█▌        | 15/100 [00:01<00:09,  8.73it/s] 16%|█▌        | 16/100 [00:02<00:09,  8.86it/s] 17%|█▋        | 17/100 [00:02<00:09,  8.30it/s] 18%|█▊        | 18/100 [00:02<00:09,  8.48it/s] 19%|█▉        | 19/100 [00:02<00:09,  8.66it/s] 20%|██        | 20/100 [00:02<00:08,  8.93it/s] 22%|██▏       | 22/100 [00:02<00:08,  9.27it/s] 23%|██▎       | 23/100 [00:02<00:08,  9.38it/s] 24%|██▍       | 24/100 [00:02<00:08,  8.83it/s] 25%|██▌       | 25/100 [00:03<00:08,  8.81it/s] 27%|██▋       | 27/100 [00:03<00:08,  8.80it/s] 28%|██▊       | 28/100 [00:03<00:09,  7.54it/s] 30%|███       | 30/100 [00:03<00:08,  8.21it/s] 31%|███       | 31/100 [00:03<00:08,  8.38it/s] 32%|███▏      | 32/100 [00:03<00:08,  8.17it/s] 33%|███▎      | 33/100 [00:04<00:07,  8.54it/s] 34%|███▍      | 34/100 [00:04<00:07,  8.48it/s] 35%|███▌      | 35/100 [00:04<00:07,  8.61it/s] 36%|███▌      | 36/100 [00:04<00:07,  8.72it/s] 37%|███▋      | 37/100 [00:04<00:07,  8.96it/s] 38%|███▊      | 38/100 [00:04<00:06,  8.90it/s] 39%|███▉      | 39/100 [00:04<00:06,  8.87it/s] 40%|████      | 40/100 [00:04<00:07,  8.51it/s] 41%|████      | 41/100 [00:04<00:06,  8.78it/s] 42%|████▏     | 42/100 [00:05<00:06,  8.59it/s] 43%|████▎     | 43/100 [00:05<00:06,  8.73it/s] 44%|████▍     | 44/100 [00:05<00:06,  9.05it/s] 45%|████▌     | 45/100 [00:05<00:06,  9.03it/s] 46%|████▌     | 46/100 [00:05<00:06,  8.82it/s] 47%|████▋     | 47/100 [00:05<00:05,  9.03it/s] 48%|████▊     | 48/100 [00:05<00:05,  9.19it/s] 49%|████▉     | 49/100 [00:05<00:05,  9.18it/s] 50%|█████     | 50/100 [00:05<00:05,  8.67it/s] 51%|█████     | 51/100 [00:06<00:05,  8.60it/s] 52%|█████▏    | 52/100 [00:06<00:05,  8.74it/s] 53%|█████▎    | 53/100 [00:06<00:05,  8.69it/s] 54%|█████▍    | 54/100 [00:06<00:05,  8.83it/s] 56%|█████▌    | 56/100 [00:06<00:06,  6.71it/s] 57%|█████▋    | 57/100 [00:07<00:07,  5.61it/s] 58%|█████▊    | 58/100 [00:07<00:06,  6.18it/s] 59%|█████▉    | 59/100 [00:07<00:06,  6.82it/s] 60%|██████    | 60/100 [00:07<00:05,  7.41it/s] 61%|██████    | 61/100 [00:07<00:04,  7.95it/s] 62%|██████▏   | 62/100 [00:07<00:04,  8.28it/s] 63%|██████▎   | 63/100 [00:07<00:04,  8.65it/s] 64%|██████▍   | 64/100 [00:07<00:04,  8.92it/s] 65%|██████▌   | 65/100 [00:07<00:04,  8.00it/s] 67%|██████▋   | 67/100 [00:08<00:03,  8.68it/s] 68%|██████▊   | 68/100 [00:08<00:03,  8.71it/s] 69%|██████▉   | 69/100 [00:08<00:03,  8.89it/s] 70%|███████   | 70/100 [00:08<00:03,  7.71it/s] 71%|███████   | 71/100 [00:08<00:03,  8.17it/s] 72%|███████▏  | 72/100 [00:08<00:03,  7.10it/s] 73%|███████▎  | 73/100 [00:08<00:03,  7.65it/s] 74%|███████▍  | 74/100 [00:09<00:03,  7.88it/s] 75%|███████▌  | 75/100 [00:09<00:03,  8.06it/s] 76%|███████▌  | 76/100 [00:09<00:02,  8.18it/s] 77%|███████▋  | 77/100 [00:09<00:02,  8.56it/s] 78%|███████▊  | 78/100 [00:09<00:02,  8.45it/s] 79%|███████▉  | 79/100 [00:09<00:02,  8.46it/s] 80%|████████  | 80/100 [00:09<00:02,  8.65it/s] 81%|████████  | 81/100 [00:09<00:02,  8.42it/s] 82%|████████▏ | 82/100 [00:09<00:02,  8.57it/s] 83%|████████▎ | 83/100 [00:10<00:01,  8.73it/s] 84%|████████▍ | 84/100 [00:10<00:01,  8.13it/s] 85%|████████▌ | 85/100 [00:10<00:01,  8.47it/s] 87%|████████▋ | 87/100 [00:10<00:01,  8.50it/s] 88%|████████▊ | 88/100 [00:10<00:01,  8.66it/s] 89%|████████▉ | 89/100 [00:10<00:01,  8.94it/s] 90%|█████████ | 90/100 [00:10<00:01,  8.75it/s] 91%|█████████ | 91/100 [00:11<00:01,  8.84it/s] 92%|█████████▏| 92/100 [00:11<00:00,  8.91it/s] 93%|█████████▎| 93/100 [00:11<00:00,  9.10it/s] 94%|█████████▍| 94/100 [00:11<00:00,  9.08it/s] 95%|█████████▌| 95/100 [00:11<00:00,  5.58it/s] 96%|█████████▌| 96/100 [00:11<00:00,  6.31it/s] 97%|█████████▋| 97/100 [00:11<00:00,  6.87it/s] 98%|█████████▊| 98/100 [00:12<00:00,  7.34it/s] 99%|█████████▉| 99/100 [00:12<00:00,  7.88it/s]100%|██████████| 100/100 [00:12<00:00,  7.62it/s]100%|██████████| 100/100 [00:12<00:00,  8.15it/s]
eval_p_index len:  15
individual_train 117
individual_eval 15
train data의 x, y, id 길이: 117 117 117
valid data의 x, y, id 길이: 9 9 9
test data의 x, y, id 길이: 6 6 6
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.828344, Valid_loss 0.690807
Epoch 2, Train Loss 0.784925, Valid_loss 0.686359
Epoch 3, Train Loss 0.751095, Valid_loss 0.682417
Epoch 4, Train Loss 0.717061, Valid_loss 0.668453
Epoch 5, Train Loss 0.662385, Valid_loss 0.668212
Epoch 6, Train Loss 0.611817, Valid_loss 0.677471
Epoch 7, Train Loss 0.587693, Valid_loss 0.689679
Epoch 8, Train Loss 0.574759, Valid_loss 0.700334
Epoch 9, Train Loss 0.554987, Valid_loss 0.711573
Epoch 10, Train Loss 0.539470, Valid_loss 0.723632
Epoch 11, Train Loss 0.529403, Valid_loss 0.734931
Epoch 12, Train Loss 0.525668, Valid_loss 0.744060
Epoch 13, Train Loss 0.523949, Valid_loss 0.750422
Epoch 14, Train Loss 0.516158, Valid_loss 0.754450
Epoch 15, Train Loss 0.513058, Valid_loss 0.755220
Epoch 16, Train Loss 0.521642, Valid_loss 0.750863
Epoch 17, Train Loss 0.505230, Valid_loss 0.739798
Epoch 18, Train Loss 0.507047, Valid_loss 0.727265
Epoch 19, Train Loss 0.486504, Valid_loss 0.708956
Epoch 20, Train Loss 0.501749, Valid_loss 0.697527
Epoch 21, Train Loss 0.482370, Valid_loss 0.677058
Epoch 22, Train Loss 0.478754, Valid_loss 0.659279
Epoch 23, Train Loss 0.461219, Valid_loss 0.640310
Epoch 24, Train Loss 0.452815, Valid_loss 0.642229
Epoch 25, Train Loss 0.448696, Valid_loss 0.633531
Epoch 26, Train Loss 0.446342, Valid_loss 0.624788
Epoch 27, Train Loss 0.427909, Valid_loss 0.611564
Epoch 28, Train Loss 0.429677, Valid_loss 0.603230
Epoch 29, Train Loss 0.418060, Valid_loss 0.602946
Epoch 30, Train Loss 0.419627, Valid_loss 0.612520
Epoch 31, Train Loss 0.412806, Valid_loss 0.601667
Epoch 32, Train Loss 0.409479, Valid_loss 0.585881
Epoch 33, Train Loss 0.402975, Valid_loss 0.585904
Epoch 34, Train Loss 0.414398, Valid_loss 0.587440
Epoch 35, Train Loss 0.400075, Valid_loss 0.586708
Epoch 36, Train Loss 0.400524, Valid_loss 0.580477
Epoch 37, Train Loss 0.406322, Valid_loss 0.572919
Epoch 38, Train Loss 0.393942, Valid_loss 0.565764
Epoch 39, Train Loss 0.392244, Valid_loss 0.566596
Epoch 40, Train Loss 0.388657, Valid_loss 0.570597
Epoch 41, Train Loss 0.390997, Valid_loss 0.566878
Epoch 42, Train Loss 0.383526, Valid_loss 0.568384
Epoch 43, Train Loss 0.394135, Valid_loss 0.575742
Epoch 44, Train Loss 0.396197, Valid_loss 0.560060
Epoch 45, Train Loss 0.385748, Valid_loss 0.559870
Epoch 46, Train Loss 0.387212, Valid_loss 0.570104
Epoch 47, Train Loss 0.393558, Valid_loss 0.572191
Epoch 48, Train Loss 0.388566, Valid_loss 0.569340
Epoch 49, Train Loss 0.374988, Valid_loss 0.578043
Epoch 50, Train Loss 0.386861, Valid_loss 0.566692
Epoch 51, Train Loss 0.384195, Valid_loss 0.573224
Epoch 52, Train Loss 0.371034, Valid_loss 0.566912
Epoch 53, Train Loss 0.376335, Valid_loss 0.563251
Epoch 54, Train Loss 0.377743, Valid_loss 0.563826
Epoch 55, Train Loss 0.382918, Valid_loss 0.565001
Control_Participant7 -- true: normal -- pred: COVID-19
Control_Participant5 -- true: normal -- pred: normal
COVID19_Participant26 -- true: COVID-19 -- pred: COVID-19
COVID19_Participant26 -- true: COVID-19 -- pred: COVID-19
COVID19_Participant13 -- true: COVID-19 -- pred: COVID-19
Control_Participant7 -- true: normal -- pred: normal
true :  [0, 0, 1, 1, 1, 0]
pred :  [1, 0, 1, 1, 1, 0]
Confusion Matrix: [2 1 0 3]
Best performance: Epoch 45, Loss 0.385748, Test ACC 0.833333, Test AUC 1.000000, Test Recall 1.000000, Test Precision 0.750000
✅ Total valid splits used: 3
🔁 Repeat 0, Fold 3
🔍 Split #4
  → train_p_index 환자 수: 25
  → test_p_index 환자 수: 7
  → train 환자 ID: ['COVID19_Participant11', 'COVID19_Participant13', 'COVID19_Participant14', 'COVID19_Participant15', 'COVID19_Participant17', 'COVID19_Participant2', 'COVID19_Participant22', 'COVID19_Participant23', 'COVID19_Participant25', 'COVID19_Participant28', 'COVID19_Participant31', 'COVID19_Participant32', 'COVID19_Participant37', 'COVID19_Participant39', 'COVID19_Participant4', 'COVID19_Participant40', 'COVID19_Participant8', 'Control_Participant1', 'Control_Participant10', 'Control_Participant11', 'Control_Participant15', 'Control_Participant3', 'Control_Participant4', 'Control_Participant7', 'Control_Participant9']
  → test  환자 ID: ['Control_Participant12', 'Control_Participant3', 'Control_Participant7', 'COVID19_Participant11', 'COVID19_Participant13', 'COVID19_Participant13', 'COVID19_Participant25']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant10, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant4, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: Control_Participant12, Label: 1
    ID: Control_Participant3, Label: 1
    ID: Control_Participant7, Label: 1
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant13, Label: 0
    ID: COVID19_Participant25, Label: 0
train_p_index_ 16
valid_p_index 9
test_p_index 7
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Ciliated Cells', 'Developing Ciliated Cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
data augment 실행 함
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  2%|▏         | 2/100 [00:00<00:09, 10.09it/s]  4%|▍         | 4/100 [00:00<00:08, 10.72it/s]  6%|▌         | 6/100 [00:00<00:09, 10.18it/s]  8%|▊         | 8/100 [00:00<00:08, 10.61it/s] 10%|█         | 10/100 [00:00<00:08, 10.49it/s] 12%|█▏        | 12/100 [00:01<00:08, 10.04it/s] 14%|█▍        | 14/100 [00:01<00:08,  9.78it/s] 16%|█▌        | 16/100 [00:01<00:08, 10.10it/s] 18%|█▊        | 18/100 [00:01<00:08,  9.92it/s] 19%|█▉        | 19/100 [00:01<00:08,  9.79it/s] 20%|██        | 20/100 [00:02<00:08,  9.23it/s] 22%|██▏       | 22/100 [00:02<00:08,  9.52it/s] 23%|██▎       | 23/100 [00:02<00:09,  8.51it/s] 24%|██▍       | 24/100 [00:02<00:08,  8.70it/s] 25%|██▌       | 25/100 [00:02<00:08,  8.82it/s] 26%|██▌       | 26/100 [00:02<00:08,  8.86it/s] 27%|██▋       | 27/100 [00:02<00:08,  8.90it/s] 29%|██▉       | 29/100 [00:03<00:07,  9.27it/s] 30%|███       | 30/100 [00:03<00:07,  9.33it/s] 31%|███       | 31/100 [00:03<00:07,  9.38it/s] 32%|███▏      | 32/100 [00:03<00:07,  9.20it/s] 33%|███▎      | 33/100 [00:03<00:07,  8.79it/s] 34%|███▍      | 34/100 [00:03<00:07,  8.96it/s] 36%|███▌      | 36/100 [00:03<00:06,  9.47it/s] 37%|███▋      | 37/100 [00:03<00:06,  9.37it/s] 38%|███▊      | 38/100 [00:03<00:06,  9.46it/s] 39%|███▉      | 39/100 [00:04<00:06,  9.38it/s] 40%|████      | 40/100 [00:04<00:07,  8.47it/s] 41%|████      | 41/100 [00:04<00:06,  8.62it/s] 42%|████▏     | 42/100 [00:04<00:07,  7.68it/s] 43%|████▎     | 43/100 [00:04<00:06,  8.18it/s] 44%|████▍     | 44/100 [00:04<00:06,  8.34it/s] 46%|████▌     | 46/100 [00:04<00:06,  9.00it/s] 47%|████▋     | 47/100 [00:05<00:06,  8.34it/s] 48%|████▊     | 48/100 [00:05<00:06,  8.45it/s] 49%|████▉     | 49/100 [00:05<00:05,  8.53it/s] 50%|█████     | 50/100 [00:05<00:06,  7.98it/s] 51%|█████     | 51/100 [00:05<00:06,  8.05it/s] 53%|█████▎    | 53/100 [00:05<00:05,  8.84it/s] 55%|█████▌    | 55/100 [00:06<00:05,  7.77it/s] 56%|█████▌    | 56/100 [00:06<00:05,  7.83it/s] 57%|█████▋    | 57/100 [00:06<00:05,  8.07it/s] 58%|█████▊    | 58/100 [00:06<00:04,  8.45it/s] 59%|█████▉    | 59/100 [00:06<00:05,  7.37it/s] 60%|██████    | 60/100 [00:06<00:05,  7.68it/s] 61%|██████    | 61/100 [00:06<00:05,  7.68it/s] 63%|██████▎   | 63/100 [00:07<00:04,  8.50it/s] 64%|██████▍   | 64/100 [00:07<00:04,  8.74it/s] 65%|██████▌   | 65/100 [00:07<00:04,  8.67it/s] 66%|██████▌   | 66/100 [00:07<00:04,  7.75it/s] 67%|██████▋   | 67/100 [00:07<00:04,  8.15it/s] 68%|██████▊   | 68/100 [00:07<00:03,  8.49it/s] 70%|███████   | 70/100 [00:07<00:03,  7.78it/s] 71%|███████   | 71/100 [00:08<00:03,  8.11it/s] 72%|███████▏  | 72/100 [00:08<00:03,  7.73it/s] 74%|███████▍  | 74/100 [00:08<00:03,  8.51it/s] 75%|███████▌  | 75/100 [00:08<00:02,  8.77it/s] 76%|███████▌  | 76/100 [00:08<00:02,  8.68it/s] 77%|███████▋  | 77/100 [00:08<00:02,  8.60it/s] 79%|███████▉  | 79/100 [00:08<00:02,  9.06it/s] 81%|████████  | 81/100 [00:09<00:02,  9.29it/s] 82%|████████▏ | 82/100 [00:09<00:02,  7.10it/s] 83%|████████▎ | 83/100 [00:09<00:02,  7.54it/s] 84%|████████▍ | 84/100 [00:09<00:01,  8.02it/s] 85%|████████▌ | 85/100 [00:09<00:01,  8.32it/s] 86%|████████▌ | 86/100 [00:09<00:01,  8.43it/s] 87%|████████▋ | 87/100 [00:09<00:01,  8.41it/s] 88%|████████▊ | 88/100 [00:10<00:01,  8.71it/s] 89%|████████▉ | 89/100 [00:10<00:01,  8.84it/s] 90%|█████████ | 90/100 [00:10<00:01,  9.05it/s] 91%|█████████ | 91/100 [00:10<00:00,  9.21it/s] 92%|█████████▏| 92/100 [00:10<00:01,  6.94it/s] 93%|█████████▎| 93/100 [00:10<00:00,  7.52it/s] 94%|█████████▍| 94/100 [00:10<00:00,  7.25it/s] 95%|█████████▌| 95/100 [00:10<00:00,  7.66it/s] 96%|█████████▌| 96/100 [00:11<00:00,  7.94it/s] 97%|█████████▋| 97/100 [00:11<00:00,  7.92it/s] 98%|█████████▊| 98/100 [00:11<00:00,  8.26it/s] 99%|█████████▉| 99/100 [00:11<00:00,  8.63it/s]100%|██████████| 100/100 [00:11<00:00,  8.67it/s]
eval_p_index len:  16
individual_train 116
individual_eval 16
train data의 x, y, id 길이: 116 116 116
valid data의 x, y, id 길이: 9 9 9
test data의 x, y, id 길이: 7 7 7
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.729165, Valid_loss 0.693942
Epoch 2, Train Loss 0.706035, Valid_loss 0.687227
Epoch 3, Train Loss 0.692129, Valid_loss 0.682723
Epoch 4, Train Loss 0.683744, Valid_loss 0.678887
Epoch 5, Train Loss 0.675577, Valid_loss 0.675603
Epoch 6, Train Loss 0.661361, Valid_loss 0.672345
Epoch 7, Train Loss 0.655385, Valid_loss 0.668753
Epoch 8, Train Loss 0.646946, Valid_loss 0.664765
Epoch 9, Train Loss 0.638421, Valid_loss 0.659662
Epoch 10, Train Loss 0.638794, Valid_loss 0.653174
Epoch 11, Train Loss 0.629529, Valid_loss 0.642749
Epoch 12, Train Loss 0.617945, Valid_loss 0.629745
Epoch 13, Train Loss 0.596012, Valid_loss 0.619180
Epoch 14, Train Loss 0.603941, Valid_loss 0.615446
Epoch 15, Train Loss 0.578233, Valid_loss 0.608449
Epoch 16, Train Loss 0.574993, Valid_loss 0.609531
Epoch 17, Train Loss 0.564166, Valid_loss 0.610924
Epoch 18, Train Loss 0.562046, Valid_loss 0.609910
Epoch 19, Train Loss 0.553362, Valid_loss 0.606854
Epoch 20, Train Loss 0.550431, Valid_loss 0.606566
Epoch 21, Train Loss 0.540246, Valid_loss 0.605353
Epoch 22, Train Loss 0.535982, Valid_loss 0.610306
Epoch 23, Train Loss 0.527951, Valid_loss 0.609800
Epoch 24, Train Loss 0.524612, Valid_loss 0.611022
Epoch 25, Train Loss 0.509461, Valid_loss 0.599289
Epoch 26, Train Loss 0.513118, Valid_loss 0.601383
Epoch 27, Train Loss 0.504162, Valid_loss 0.595698
Epoch 28, Train Loss 0.499048, Valid_loss 0.599610
Epoch 29, Train Loss 0.494441, Valid_loss 0.595304
Epoch 30, Train Loss 0.487622, Valid_loss 0.594877
Epoch 31, Train Loss 0.479529, Valid_loss 0.604900
Epoch 32, Train Loss 0.478392, Valid_loss 0.608641
Epoch 33, Train Loss 0.473335, Valid_loss 0.577276
Epoch 34, Train Loss 0.478129, Valid_loss 0.586953
Epoch 35, Train Loss 0.456510, Valid_loss 0.593515
Epoch 36, Train Loss 0.458331, Valid_loss 0.601489
Epoch 37, Train Loss 0.469064, Valid_loss 0.576832
Epoch 38, Train Loss 0.461237, Valid_loss 0.647332
Epoch 39, Train Loss 0.458348, Valid_loss 0.626803
Epoch 40, Train Loss 0.453860, Valid_loss 0.607369
Epoch 41, Train Loss 0.443069, Valid_loss 0.597058
Epoch 42, Train Loss 0.443019, Valid_loss 0.602714
Epoch 43, Train Loss 0.439309, Valid_loss 0.601044
Epoch 44, Train Loss 0.450159, Valid_loss 0.606500
Epoch 45, Train Loss 0.450923, Valid_loss 0.603168
Epoch 46, Train Loss 0.438273, Valid_loss 0.588443
Epoch 47, Train Loss 0.442382, Valid_loss 0.610616
Epoch 48, Train Loss 0.438941, Valid_loss 0.599692
Epoch 49, Train Loss 0.420807, Valid_loss 0.616153
Epoch 50, Train Loss 0.437871, Valid_loss 0.599297
Epoch 51, Train Loss 0.431706, Valid_loss 0.601682
Epoch 52, Train Loss 0.424924, Valid_loss 0.596394
Epoch 53, Train Loss 0.433586, Valid_loss 0.602733
Epoch 54, Train Loss 0.430917, Valid_loss 0.594589
Epoch 55, Train Loss 0.418681, Valid_loss 0.599170
Epoch 56, Train Loss 0.433527, Valid_loss 0.597629
Epoch 57, Train Loss 0.420974, Valid_loss 0.592561
Epoch 58, Train Loss 0.434980, Valid_loss 0.595412
Epoch 59, Train Loss 0.429017, Valid_loss 0.596139
Control_Participant12 -- true: normal -- pred: COVID-19
Control_Participant3 -- true: normal -- pred: normal
Control_Participant7 -- true: normal -- pred: COVID-19
COVID19_Participant11 -- true: COVID-19 -- pred: COVID-19
COVID19_Participant13 -- true: COVID-19 -- pred: COVID-19
COVID19_Participant13 -- true: COVID-19 -- pred: COVID-19
COVID19_Participant25 -- true: COVID-19 -- pred: COVID-19
true :  [0, 0, 0, 1, 1, 1, 1]
pred :  [1, 0, 1, 1, 1, 1, 1]
Confusion Matrix: [1 2 0 4]
Best performance: Epoch 37, Loss 0.469064, Test ACC 0.714286, Test AUC 1.000000, Test Recall 1.000000, Test Precision 0.666667
✅ Total valid splits used: 4
🔁 Repeat 0, Fold 4
🔍 Split #5
  → train_p_index 환자 수: 25
  → test_p_index 환자 수: 7
  → train 환자 ID: ['COVID19_Participant11', 'COVID19_Participant14', 'COVID19_Participant15', 'COVID19_Participant19', 'COVID19_Participant2', 'COVID19_Participant20', 'COVID19_Participant23', 'COVID19_Participant25', 'COVID19_Participant26', 'COVID19_Participant28', 'COVID19_Participant29', 'COVID19_Participant31', 'COVID19_Participant32', 'COVID19_Participant39', 'COVID19_Participant4', 'COVID19_Participant7', 'COVID19_Participant8', 'Control_Participant11', 'Control_Participant15', 'Control_Participant3', 'Control_Participant4', 'Control_Participant5', 'Control_Participant7', 'Control_Participant8', 'Control_Participant9']
  → test  환자 ID: ['Control_Participant7', 'Control_Participant5', 'Control_Participant3', 'COVID19_Participant25', 'COVID19_Participant11', 'Control_Participant7', 'Control_Participant12']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: Control_Participant11, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant4, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant8, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: Control_Participant7, Label: 1
    ID: Control_Participant5, Label: 1
    ID: Control_Participant3, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant11, Label: 1
    ID: Control_Participant7, Label: 0
    ID: Control_Participant12, Label: 0
train_p_index_ 16
valid_p_index 9
test_p_index 7
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Ciliated Cells', 'Developing Ciliated Cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
data augment 실행 함
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:10,  9.80it/s]  2%|▏         | 2/100 [00:00<00:10,  9.55it/s]  3%|▎         | 3/100 [00:00<00:11,  8.58it/s]  4%|▍         | 4/100 [00:00<00:10,  8.92it/s]  5%|▌         | 5/100 [00:00<00:10,  9.02it/s]  6%|▌         | 6/100 [00:00<00:11,  8.39it/s]  7%|▋         | 7/100 [00:00<00:10,  8.47it/s]  8%|▊         | 8/100 [00:00<00:10,  8.44it/s] 10%|█         | 10/100 [00:01<00:09,  9.29it/s] 11%|█         | 11/100 [00:01<00:11,  8.00it/s] 12%|█▏        | 12/100 [00:01<00:10,  8.40it/s] 13%|█▎        | 13/100 [00:01<00:10,  8.53it/s] 14%|█▍        | 14/100 [00:01<00:10,  8.56it/s] 15%|█▌        | 15/100 [00:01<00:11,  7.58it/s] 16%|█▌        | 16/100 [00:01<00:10,  8.12it/s] 17%|█▋        | 17/100 [00:02<00:11,  7.36it/s] 18%|█▊        | 18/100 [00:02<00:10,  7.96it/s] 19%|█▉        | 19/100 [00:02<00:09,  8.29it/s] 20%|██        | 20/100 [00:02<00:09,  8.63it/s] 21%|██        | 21/100 [00:02<00:08,  8.92it/s] 22%|██▏       | 22/100 [00:02<00:08,  9.02it/s] 23%|██▎       | 23/100 [00:02<00:09,  8.55it/s] 25%|██▌       | 25/100 [00:02<00:08,  9.21it/s] 26%|██▌       | 26/100 [00:03<00:08,  9.23it/s] 27%|██▋       | 27/100 [00:03<00:07,  9.23it/s] 28%|██▊       | 28/100 [00:03<00:07,  9.20it/s] 29%|██▉       | 29/100 [00:03<00:11,  5.96it/s] 30%|███       | 30/100 [00:03<00:11,  6.04it/s] 31%|███       | 31/100 [00:03<00:10,  6.80it/s] 32%|███▏      | 32/100 [00:03<00:09,  7.35it/s] 33%|███▎      | 33/100 [00:04<00:08,  7.81it/s] 34%|███▍      | 34/100 [00:04<00:08,  7.92it/s] 35%|███▌      | 35/100 [00:04<00:07,  8.32it/s] 36%|███▌      | 36/100 [00:04<00:07,  8.40it/s] 38%|███▊      | 38/100 [00:04<00:07,  8.82it/s] 39%|███▉      | 39/100 [00:04<00:07,  8.57it/s] 40%|████      | 40/100 [00:04<00:06,  8.65it/s] 41%|████      | 41/100 [00:04<00:06,  8.82it/s] 42%|████▏     | 42/100 [00:05<00:06,  8.77it/s] 43%|████▎     | 43/100 [00:05<00:07,  7.32it/s] 44%|████▍     | 44/100 [00:05<00:07,  7.86it/s] 45%|████▌     | 45/100 [00:05<00:08,  6.27it/s] 46%|████▌     | 46/100 [00:05<00:08,  6.37it/s] 47%|████▋     | 47/100 [00:05<00:07,  6.88it/s] 48%|████▊     | 48/100 [00:05<00:06,  7.44it/s] 49%|████▉     | 49/100 [00:06<00:07,  7.09it/s] 50%|█████     | 50/100 [00:06<00:07,  6.42it/s] 51%|█████     | 51/100 [00:06<00:07,  6.84it/s] 52%|█████▏    | 52/100 [00:06<00:06,  7.46it/s] 53%|█████▎    | 53/100 [00:06<00:05,  8.06it/s] 54%|█████▍    | 54/100 [00:06<00:05,  8.47it/s] 55%|█████▌    | 55/100 [00:06<00:05,  8.83it/s] 56%|█████▌    | 56/100 [00:06<00:04,  8.82it/s] 57%|█████▋    | 57/100 [00:07<00:04,  9.03it/s] 58%|█████▊    | 58/100 [00:07<00:06,  6.64it/s] 59%|█████▉    | 59/100 [00:07<00:06,  6.49it/s] 60%|██████    | 60/100 [00:07<00:05,  6.94it/s] 61%|██████    | 61/100 [00:07<00:05,  6.92it/s] 62%|██████▏   | 62/100 [00:07<00:05,  7.21it/s] 63%|██████▎   | 63/100 [00:07<00:04,  7.79it/s] 64%|██████▍   | 64/100 [00:08<00:04,  7.78it/s] 65%|██████▌   | 65/100 [00:08<00:04,  7.71it/s] 66%|██████▌   | 66/100 [00:08<00:04,  8.14it/s] 67%|██████▋   | 67/100 [00:08<00:03,  8.37it/s] 68%|██████▊   | 68/100 [00:08<00:03,  8.34it/s] 69%|██████▉   | 69/100 [00:08<00:03,  8.53it/s] 70%|███████   | 70/100 [00:08<00:03,  8.75it/s] 71%|███████   | 71/100 [00:08<00:03,  8.83it/s] 72%|███████▏  | 72/100 [00:09<00:03,  9.06it/s] 73%|███████▎  | 73/100 [00:09<00:02,  9.24it/s] 74%|███████▍  | 74/100 [00:09<00:02,  9.29it/s] 75%|███████▌  | 75/100 [00:09<00:02,  9.28it/s] 76%|███████▌  | 76/100 [00:09<00:02,  9.16it/s] 77%|███████▋  | 77/100 [00:09<00:02,  8.83it/s] 78%|███████▊  | 78/100 [00:09<00:02,  8.73it/s] 79%|███████▉  | 79/100 [00:09<00:02,  8.78it/s] 80%|████████  | 80/100 [00:09<00:02,  8.78it/s] 81%|████████  | 81/100 [00:10<00:02,  8.59it/s] 82%|████████▏ | 82/100 [00:10<00:02,  8.64it/s] 83%|████████▎ | 83/100 [00:10<00:01,  8.54it/s] 84%|████████▍ | 84/100 [00:10<00:01,  8.73it/s] 85%|████████▌ | 85/100 [00:10<00:01,  8.78it/s] 86%|████████▌ | 86/100 [00:10<00:02,  6.21it/s] 87%|████████▋ | 87/100 [00:10<00:01,  6.82it/s] 88%|████████▊ | 88/100 [00:10<00:01,  7.35it/s] 89%|████████▉ | 89/100 [00:11<00:01,  7.65it/s] 90%|█████████ | 90/100 [00:11<00:01,  5.74it/s] 91%|█████████ | 91/100 [00:11<00:01,  6.45it/s] 92%|█████████▏| 92/100 [00:11<00:01,  6.89it/s] 93%|█████████▎| 93/100 [00:11<00:00,  7.29it/s] 94%|█████████▍| 94/100 [00:12<00:01,  5.54it/s] 95%|█████████▌| 95/100 [00:12<00:00,  6.25it/s] 96%|█████████▌| 96/100 [00:12<00:00,  5.56it/s] 97%|█████████▋| 97/100 [00:12<00:00,  4.84it/s] 98%|█████████▊| 98/100 [00:12<00:00,  5.62it/s] 99%|█████████▉| 99/100 [00:12<00:00,  6.29it/s]100%|██████████| 100/100 [00:12<00:00,  6.64it/s]100%|██████████| 100/100 [00:12<00:00,  7.71it/s]
eval_p_index len:  16
individual_train 116
individual_eval 16
train data의 x, y, id 길이: 116 116 116
valid data의 x, y, id 길이: 9 9 9
test data의 x, y, id 길이: 7 7 7
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.773973, Valid_loss 0.687192
Epoch 2, Train Loss 0.738098, Valid_loss 0.682731
Epoch 3, Train Loss 0.696244, Valid_loss 0.690534
Epoch 4, Train Loss 0.692795, Valid_loss 0.682823
Epoch 5, Train Loss 0.674696, Valid_loss 0.675233
Epoch 6, Train Loss 0.673470, Valid_loss 0.672931
Epoch 7, Train Loss 0.658036, Valid_loss 0.669716
Epoch 8, Train Loss 0.650327, Valid_loss 0.667905
Epoch 9, Train Loss 0.655418, Valid_loss 0.666187
Epoch 10, Train Loss 0.642428, Valid_loss 0.661894
Epoch 11, Train Loss 0.638002, Valid_loss 0.660174
Epoch 12, Train Loss 0.637748, Valid_loss 0.656192
Epoch 13, Train Loss 0.633585, Valid_loss 0.654206
Epoch 14, Train Loss 0.627918, Valid_loss 0.651085
Epoch 15, Train Loss 0.627397, Valid_loss 0.648074
Epoch 16, Train Loss 0.615081, Valid_loss 0.645092
Epoch 17, Train Loss 0.620041, Valid_loss 0.642042
Epoch 18, Train Loss 0.612389, Valid_loss 0.640192
Epoch 19, Train Loss 0.608680, Valid_loss 0.635268
Epoch 20, Train Loss 0.609742, Valid_loss 0.634366
Epoch 21, Train Loss 0.619360, Valid_loss 0.631069
Epoch 22, Train Loss 0.603827, Valid_loss 0.631529
Epoch 23, Train Loss 0.603330, Valid_loss 0.627090
Epoch 24, Train Loss 0.598657, Valid_loss 0.626040
Epoch 25, Train Loss 0.590705, Valid_loss 0.623932
Epoch 26, Train Loss 0.584516, Valid_loss 0.622161
Epoch 27, Train Loss 0.591871, Valid_loss 0.620619
Epoch 28, Train Loss 0.592457, Valid_loss 0.618599
Epoch 29, Train Loss 0.576419, Valid_loss 0.616807
Epoch 30, Train Loss 0.580596, Valid_loss 0.615405
Epoch 31, Train Loss 0.578652, Valid_loss 0.611787
Epoch 32, Train Loss 0.573080, Valid_loss 0.608823
Epoch 33, Train Loss 0.576494, Valid_loss 0.605591
Epoch 34, Train Loss 0.564481, Valid_loss 0.602901
Epoch 35, Train Loss 0.562932, Valid_loss 0.600798
Epoch 36, Train Loss 0.566195, Valid_loss 0.597539
Epoch 37, Train Loss 0.552428, Valid_loss 0.597041
Epoch 38, Train Loss 0.554176, Valid_loss 0.593399
Epoch 39, Train Loss 0.557108, Valid_loss 0.593875
Epoch 40, Train Loss 0.548066, Valid_loss 0.593988
Epoch 41, Train Loss 0.547689, Valid_loss 0.592216
Epoch 42, Train Loss 0.545788, Valid_loss 0.591971
Epoch 43, Train Loss 0.552862, Valid_loss 0.589167
Epoch 44, Train Loss 0.541437, Valid_loss 0.587241
Epoch 45, Train Loss 0.540697, Valid_loss 0.586880
Epoch 46, Train Loss 0.532227, Valid_loss 0.580750
Epoch 47, Train Loss 0.537387, Valid_loss 0.585865
Epoch 48, Train Loss 0.542553, Valid_loss 0.577814
Epoch 49, Train Loss 0.541278, Valid_loss 0.580933
Epoch 50, Train Loss 0.526385, Valid_loss 0.577507
Epoch 51, Train Loss 0.528750, Valid_loss 0.577997
Epoch 52, Train Loss 0.532735, Valid_loss 0.574567
Epoch 53, Train Loss 0.530952, Valid_loss 0.575655
Epoch 54, Train Loss 0.525884, Valid_loss 0.574875
Epoch 55, Train Loss 0.526953, Valid_loss 0.574268
Epoch 56, Train Loss 0.520838, Valid_loss 0.573025
Epoch 57, Train Loss 0.515985, Valid_loss 0.572123
Epoch 58, Train Loss 0.517119, Valid_loss 0.571492
Epoch 59, Train Loss 0.535629, Valid_loss 0.571856
Epoch 60, Train Loss 0.522393, Valid_loss 0.570417
Epoch 61, Train Loss 0.514683, Valid_loss 0.571275
Epoch 62, Train Loss 0.512237, Valid_loss 0.567227
Epoch 63, Train Loss 0.525373, Valid_loss 0.569049
Epoch 64, Train Loss 0.519094, Valid_loss 0.568974
Epoch 65, Train Loss 0.523907, Valid_loss 0.566226
Epoch 66, Train Loss 0.515180, Valid_loss 0.568104
Epoch 67, Train Loss 0.514460, Valid_loss 0.565457
Epoch 68, Train Loss 0.518626, Valid_loss 0.566192
Epoch 69, Train Loss 0.506905, Valid_loss 0.568923
Control_Participant7 -- true: normal -- pred: normal
Control_Participant5 -- true: normal -- pred: normal
Control_Participant3 -- true: normal -- pred: normal
COVID19_Participant25 -- true: COVID-19 -- pred: COVID-19
COVID19_Participant11 -- true: COVID-19 -- pred: normal
Control_Participant7 -- true: normal -- pred: COVID-19
Control_Participant12 -- true: normal -- pred: COVID-19
true :  [0, 0, 0, 1, 1, 0, 0]
pred :  [0, 0, 0, 1, 0, 1, 1]
Confusion Matrix: [3 2 1 1]
Best performance: Epoch 67, Loss 0.514460, Test ACC 0.571429, Test AUC 0.800000, Test Recall 0.500000, Test Precision 0.333333
✅ Total valid splits used: 5

📌 Repeat 0: 평균 AUC = 0.8800, 표준편차 = 0.1600
🔁 Repeat 1, Fold 0
🔍 Split #1
  → train_p_index 환자 수: 24
  → test_p_index 환자 수: 8
  → train 환자 ID: ['COVID19_Participant13', 'COVID19_Participant14', 'COVID19_Participant15', 'COVID19_Participant17', 'COVID19_Participant19', 'COVID19_Participant20', 'COVID19_Participant22', 'COVID19_Participant26', 'COVID19_Participant28', 'COVID19_Participant29', 'COVID19_Participant31', 'COVID19_Participant32', 'COVID19_Participant39', 'COVID19_Participant4', 'COVID19_Participant40', 'COVID19_Participant8', 'Control_Participant1', 'Control_Participant10', 'Control_Participant11', 'Control_Participant15', 'Control_Participant3', 'Control_Participant4', 'Control_Participant7', 'Control_Participant8']
  → test  환자 ID: ['COVID19_Participant31', 'Control_Participant3', 'Control_Participant1', 'Control_Participant7', 'COVID19_Participant26', 'Control_Participant7', 'COVID19_Participant13', 'COVID19_Participant5']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant10, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant4, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant8, Label: 0
  → test 환자 ID 및 라벨:
    ID: COVID19_Participant31, Label: 1
    ID: Control_Participant3, Label: 1
    ID: Control_Participant1, Label: 1
    ID: Control_Participant7, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: Control_Participant7, Label: 1
    ID: COVID19_Participant13, Label: 0
    ID: COVID19_Participant5, Label: 0
train_p_index_ 16
valid_p_index 8
test_p_index 8
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Ciliated Cells', 'Developing Ciliated Cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
data augment 실행 함
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  2%|▏         | 2/100 [00:00<00:10,  9.12it/s]  3%|▎         | 3/100 [00:00<00:12,  7.68it/s]  5%|▌         | 5/100 [00:00<00:11,  8.50it/s]  6%|▌         | 6/100 [00:00<00:10,  8.78it/s]  7%|▋         | 7/100 [00:00<00:12,  7.31it/s]  9%|▉         | 9/100 [00:01<00:11,  8.18it/s] 10%|█         | 10/100 [00:01<00:10,  8.51it/s] 11%|█         | 11/100 [00:01<00:10,  8.79it/s] 12%|█▏        | 12/100 [00:01<00:09,  8.92it/s] 13%|█▎        | 13/100 [00:01<00:11,  7.51it/s] 14%|█▍        | 14/100 [00:01<00:12,  6.76it/s] 15%|█▌        | 15/100 [00:01<00:11,  7.42it/s] 16%|█▌        | 16/100 [00:02<00:11,  7.48it/s] 17%|█▋        | 17/100 [00:02<00:10,  8.06it/s] 19%|█▉        | 19/100 [00:02<00:09,  8.67it/s] 20%|██        | 20/100 [00:02<00:09,  8.88it/s] 21%|██        | 21/100 [00:02<00:08,  9.06it/s] 22%|██▏       | 22/100 [00:02<00:09,  8.66it/s] 23%|██▎       | 23/100 [00:02<00:09,  7.98it/s] 24%|██▍       | 24/100 [00:02<00:09,  8.11it/s] 25%|██▌       | 25/100 [00:03<00:08,  8.35it/s] 26%|██▌       | 26/100 [00:03<00:08,  8.64it/s] 27%|██▋       | 27/100 [00:03<00:08,  8.89it/s] 28%|██▊       | 28/100 [00:03<00:10,  6.73it/s] 29%|██▉       | 29/100 [00:03<00:09,  7.41it/s] 30%|███       | 30/100 [00:03<00:08,  7.90it/s] 31%|███       | 31/100 [00:03<00:08,  8.20it/s] 32%|███▏      | 32/100 [00:03<00:08,  8.42it/s] 33%|███▎      | 33/100 [00:04<00:07,  8.69it/s] 34%|███▍      | 34/100 [00:04<00:07,  8.85it/s] 35%|███▌      | 35/100 [00:04<00:07,  9.10it/s] 36%|███▌      | 36/100 [00:04<00:07,  8.49it/s] 37%|███▋      | 37/100 [00:04<00:07,  8.82it/s] 39%|███▉      | 39/100 [00:04<00:06,  9.61it/s] 40%|████      | 40/100 [00:04<00:06,  9.32it/s] 41%|████      | 41/100 [00:04<00:06,  9.21it/s] 42%|████▏     | 42/100 [00:05<00:06,  9.09it/s] 43%|████▎     | 43/100 [00:05<00:06,  8.93it/s] 44%|████▍     | 44/100 [00:05<00:06,  8.66it/s] 45%|████▌     | 45/100 [00:05<00:06,  8.79it/s] 46%|████▌     | 46/100 [00:05<00:06,  8.93it/s] 47%|████▋     | 47/100 [00:05<00:06,  7.69it/s] 48%|████▊     | 48/100 [00:05<00:07,  7.43it/s] 49%|████▉     | 49/100 [00:05<00:06,  7.97it/s] 50%|█████     | 50/100 [00:06<00:06,  7.19it/s] 51%|█████     | 51/100 [00:06<00:06,  7.32it/s] 52%|█████▏    | 52/100 [00:06<00:06,  7.63it/s] 53%|█████▎    | 53/100 [00:06<00:05,  7.91it/s] 54%|█████▍    | 54/100 [00:06<00:05,  8.08it/s] 55%|█████▌    | 55/100 [00:06<00:06,  6.97it/s] 56%|█████▌    | 56/100 [00:06<00:06,  7.06it/s] 57%|█████▋    | 57/100 [00:06<00:05,  7.60it/s] 58%|█████▊    | 58/100 [00:07<00:06,  6.73it/s] 59%|█████▉    | 59/100 [00:07<00:05,  7.43it/s] 60%|██████    | 60/100 [00:07<00:05,  7.80it/s] 61%|██████    | 61/100 [00:07<00:04,  8.25it/s] 62%|██████▏   | 62/100 [00:07<00:04,  8.50it/s] 63%|██████▎   | 63/100 [00:07<00:04,  8.66it/s] 64%|██████▍   | 64/100 [00:07<00:04,  8.82it/s] 65%|██████▌   | 65/100 [00:07<00:04,  8.62it/s] 66%|██████▌   | 66/100 [00:08<00:05,  5.94it/s] 67%|██████▋   | 67/100 [00:08<00:05,  6.31it/s] 68%|██████▊   | 68/100 [00:08<00:04,  6.88it/s] 69%|██████▉   | 69/100 [00:08<00:04,  7.37it/s] 71%|███████   | 71/100 [00:08<00:03,  8.26it/s] 72%|███████▏  | 72/100 [00:08<00:03,  8.42it/s] 73%|███████▎  | 73/100 [00:09<00:03,  7.70it/s] 74%|███████▍  | 74/100 [00:09<00:04,  6.24it/s] 75%|███████▌  | 75/100 [00:09<00:03,  6.74it/s] 76%|███████▌  | 76/100 [00:09<00:03,  7.14it/s] 77%|███████▋  | 77/100 [00:09<00:03,  7.46it/s] 78%|███████▊  | 78/100 [00:09<00:02,  7.93it/s] 79%|███████▉  | 79/100 [00:09<00:02,  8.04it/s] 80%|████████  | 80/100 [00:10<00:02,  8.36it/s] 81%|████████  | 81/100 [00:10<00:03,  5.46it/s] 83%|████████▎ | 83/100 [00:10<00:02,  6.83it/s] 84%|████████▍ | 84/100 [00:10<00:02,  6.97it/s] 85%|████████▌ | 85/100 [00:10<00:01,  7.55it/s] 86%|████████▌ | 86/100 [00:11<00:02,  5.94it/s] 87%|████████▋ | 87/100 [00:11<00:02,  6.45it/s] 88%|████████▊ | 88/100 [00:11<00:01,  6.50it/s] 89%|████████▉ | 89/100 [00:11<00:01,  7.06it/s] 90%|█████████ | 90/100 [00:11<00:01,  7.31it/s] 91%|█████████ | 91/100 [00:11<00:01,  7.85it/s] 92%|█████████▏| 92/100 [00:11<00:00,  8.12it/s] 93%|█████████▎| 93/100 [00:12<00:01,  4.80it/s] 94%|█████████▍| 94/100 [00:12<00:01,  5.53it/s] 95%|█████████▌| 95/100 [00:12<00:00,  6.36it/s] 96%|█████████▌| 96/100 [00:12<00:00,  6.99it/s] 97%|█████████▋| 97/100 [00:12<00:00,  6.38it/s] 98%|█████████▊| 98/100 [00:12<00:00,  6.96it/s] 99%|█████████▉| 99/100 [00:12<00:00,  7.45it/s]100%|██████████| 100/100 [00:13<00:00,  7.93it/s]100%|██████████| 100/100 [00:13<00:00,  7.67it/s]
eval_p_index len:  16
individual_train 116
individual_eval 16
train data의 x, y, id 길이: 116 116 116
valid data의 x, y, id 길이: 8 8 8
test data의 x, y, id 길이: 8 8 8
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.805704, Valid_loss 0.717649
Epoch 2, Train Loss 0.781146, Valid_loss 0.709271
Epoch 3, Train Loss 0.746757, Valid_loss 0.703360
Epoch 4, Train Loss 0.734463, Valid_loss 0.699150
Epoch 5, Train Loss 0.722945, Valid_loss 0.696400
Epoch 6, Train Loss 0.713283, Valid_loss 0.694262
Epoch 7, Train Loss 0.707695, Valid_loss 0.693550
Epoch 8, Train Loss 0.697397, Valid_loss 0.692001
Epoch 9, Train Loss 0.684765, Valid_loss 0.691462
Epoch 10, Train Loss 0.673836, Valid_loss 0.692361
Epoch 11, Train Loss 0.668222, Valid_loss 0.695851
Epoch 12, Train Loss 0.660437, Valid_loss 0.697497
Epoch 13, Train Loss 0.660123, Valid_loss 0.698736
Epoch 14, Train Loss 0.652913, Valid_loss 0.698681
Epoch 15, Train Loss 0.651601, Valid_loss 0.698510
Epoch 16, Train Loss 0.651784, Valid_loss 0.699261
Epoch 17, Train Loss 0.642313, Valid_loss 0.698149
Epoch 18, Train Loss 0.639216, Valid_loss 0.696878
Epoch 19, Train Loss 0.638463, Valid_loss 0.693325
Epoch 20, Train Loss 0.633025, Valid_loss 0.689656
Epoch 21, Train Loss 0.625128, Valid_loss 0.686188
Epoch 22, Train Loss 0.623912, Valid_loss 0.685486
Epoch 23, Train Loss 0.616533, Valid_loss 0.678360
Epoch 24, Train Loss 0.613136, Valid_loss 0.672510
Epoch 25, Train Loss 0.603187, Valid_loss 0.664862
Epoch 26, Train Loss 0.606967, Valid_loss 0.657501
Epoch 27, Train Loss 0.594278, Valid_loss 0.658023
Epoch 28, Train Loss 0.593054, Valid_loss 0.653664
Epoch 29, Train Loss 0.598035, Valid_loss 0.649196
Epoch 30, Train Loss 0.591441, Valid_loss 0.653213
Epoch 31, Train Loss 0.586340, Valid_loss 0.648022
Epoch 32, Train Loss 0.582162, Valid_loss 0.642484
Epoch 33, Train Loss 0.581641, Valid_loss 0.638788
Epoch 34, Train Loss 0.579035, Valid_loss 0.641048
Epoch 35, Train Loss 0.576801, Valid_loss 0.638611
Epoch 36, Train Loss 0.575540, Valid_loss 0.632751
Epoch 37, Train Loss 0.568739, Valid_loss 0.630689
Epoch 38, Train Loss 0.575830, Valid_loss 0.629798
Epoch 39, Train Loss 0.570931, Valid_loss 0.629461
Epoch 40, Train Loss 0.571166, Valid_loss 0.634367
Epoch 41, Train Loss 0.559570, Valid_loss 0.631834
Epoch 42, Train Loss 0.561129, Valid_loss 0.622807
Epoch 43, Train Loss 0.569813, Valid_loss 0.623429
Epoch 44, Train Loss 0.561141, Valid_loss 0.623839
Epoch 45, Train Loss 0.555661, Valid_loss 0.625991
Epoch 46, Train Loss 0.556247, Valid_loss 0.619763
Epoch 47, Train Loss 0.554401, Valid_loss 0.620510
Epoch 48, Train Loss 0.551092, Valid_loss 0.620570
Epoch 49, Train Loss 0.545926, Valid_loss 0.611717
Epoch 50, Train Loss 0.550367, Valid_loss 0.615406
Epoch 51, Train Loss 0.546220, Valid_loss 0.615773
Epoch 52, Train Loss 0.539828, Valid_loss 0.612891
Epoch 53, Train Loss 0.543757, Valid_loss 0.610865
Epoch 54, Train Loss 0.542615, Valid_loss 0.613233
Epoch 55, Train Loss 0.533035, Valid_loss 0.611145
Epoch 56, Train Loss 0.543407, Valid_loss 0.614315
Epoch 57, Train Loss 0.539660, Valid_loss 0.617496
COVID19_Participant31 -- true: COVID-19 -- pred: COVID-19
Control_Participant3 -- true: normal -- pred: normal
Control_Participant1 -- true: normal -- pred: normal
Control_Participant7 -- true: normal -- pred: normal
COVID19_Participant26 -- true: COVID-19 -- pred: COVID-19
Control_Participant7 -- true: normal -- pred: normal
COVID19_Participant13 -- true: COVID-19 -- pred: COVID-19
COVID19_Participant5 -- true: COVID-19 -- pred: COVID-19
true :  [1, 0, 0, 0, 1, 0, 1, 1]
pred :  [1, 0, 0, 0, 1, 0, 1, 1]
Confusion Matrix: [4 0 0 4]
Best performance: Epoch 53, Loss 0.543757, Test ACC 1.000000, Test AUC 1.000000, Test Recall 1.000000, Test Precision 1.000000
✅ Total valid splits used: 1
🔁 Repeat 1, Fold 1
🔍 Split #2
  → train_p_index 환자 수: 25
  → test_p_index 환자 수: 7
  → train 환자 ID: ['COVID19_Participant11', 'COVID19_Participant13', 'COVID19_Participant14', 'COVID19_Participant15', 'COVID19_Participant2', 'COVID19_Participant20', 'COVID19_Participant23', 'COVID19_Participant25', 'COVID19_Participant28', 'COVID19_Participant31', 'COVID19_Participant32', 'COVID19_Participant37', 'COVID19_Participant39', 'COVID19_Participant4', 'COVID19_Participant40', 'COVID19_Participant7', 'COVID19_Participant8', 'Control_Participant1', 'Control_Participant10', 'Control_Participant11', 'Control_Participant15', 'Control_Participant4', 'Control_Participant5', 'Control_Participant8', 'Control_Participant9']
  → test  환자 ID: ['Control_Participant1', 'Control_Participant5', 'COVID19_Participant8', 'COVID19_Participant31', 'Control_Participant10', 'Control_Participant4', 'COVID19_Participant13']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant10, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant4, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant8, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: Control_Participant1, Label: 1
    ID: Control_Participant5, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: Control_Participant10, Label: 1
    ID: Control_Participant4, Label: 0
    ID: COVID19_Participant13, Label: 0
train_p_index_ 16
valid_p_index 9
test_p_index 7
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Squamous Cells', 'Secretory Cells', 'Macrophages', 'Developing Ciliated Cells', 'B Cells', 'Ciliated Cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
data augment 실행 함
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:11,  8.71it/s]  2%|▏         | 2/100 [00:00<00:10,  9.08it/s]  3%|▎         | 3/100 [00:00<00:10,  8.99it/s]  4%|▍         | 4/100 [00:00<00:13,  7.12it/s]  5%|▌         | 5/100 [00:00<00:12,  7.89it/s]  6%|▌         | 6/100 [00:00<00:11,  8.35it/s]  7%|▋         | 7/100 [00:00<00:10,  8.76it/s]  8%|▊         | 8/100 [00:00<00:10,  8.98it/s] 10%|█         | 10/100 [00:01<00:09,  9.23it/s] 11%|█         | 11/100 [00:01<00:09,  9.20it/s] 12%|█▏        | 12/100 [00:01<00:11,  7.77it/s] 13%|█▎        | 13/100 [00:01<00:10,  8.13it/s] 15%|█▌        | 15/100 [00:01<00:09,  8.95it/s] 16%|█▌        | 16/100 [00:01<00:09,  8.41it/s] 17%|█▋        | 17/100 [00:01<00:09,  8.48it/s] 18%|█▊        | 18/100 [00:02<00:09,  8.83it/s] 19%|█▉        | 19/100 [00:02<00:08,  9.11it/s] 20%|██        | 20/100 [00:02<00:09,  8.46it/s] 21%|██        | 21/100 [00:02<00:09,  8.68it/s] 22%|██▏       | 22/100 [00:02<00:10,  7.70it/s] 23%|██▎       | 23/100 [00:02<00:09,  8.18it/s] 24%|██▍       | 24/100 [00:02<00:08,  8.47it/s] 25%|██▌       | 25/100 [00:02<00:08,  8.76it/s] 26%|██▌       | 26/100 [00:03<00:08,  8.90it/s] 27%|██▋       | 27/100 [00:03<00:08,  9.05it/s] 28%|██▊       | 28/100 [00:03<00:07,  9.22it/s] 29%|██▉       | 29/100 [00:03<00:07,  9.09it/s] 30%|███       | 30/100 [00:03<00:07,  9.22it/s] 31%|███       | 31/100 [00:03<00:07,  9.37it/s] 32%|███▏      | 32/100 [00:03<00:07,  9.52it/s] 33%|███▎      | 33/100 [00:03<00:07,  9.03it/s] 34%|███▍      | 34/100 [00:03<00:07,  9.14it/s] 35%|███▌      | 35/100 [00:04<00:06,  9.36it/s] 36%|███▌      | 36/100 [00:04<00:06,  9.23it/s] 37%|███▋      | 37/100 [00:04<00:08,  7.10it/s] 38%|███▊      | 38/100 [00:04<00:09,  6.33it/s] 39%|███▉      | 39/100 [00:04<00:09,  6.71it/s] 40%|████      | 40/100 [00:04<00:08,  7.30it/s] 41%|████      | 41/100 [00:04<00:07,  7.77it/s] 42%|████▏     | 42/100 [00:04<00:07,  8.12it/s] 43%|████▎     | 43/100 [00:05<00:06,  8.47it/s] 44%|████▍     | 44/100 [00:05<00:06,  8.76it/s] 45%|████▌     | 45/100 [00:05<00:09,  5.68it/s] 47%|████▋     | 47/100 [00:05<00:07,  7.03it/s] 48%|████▊     | 48/100 [00:05<00:07,  7.01it/s] 49%|████▉     | 49/100 [00:06<00:07,  7.03it/s] 51%|█████     | 51/100 [00:06<00:06,  8.04it/s] 52%|█████▏    | 52/100 [00:06<00:05,  8.29it/s] 53%|█████▎    | 53/100 [00:06<00:05,  8.21it/s] 54%|█████▍    | 54/100 [00:06<00:05,  8.43it/s] 55%|█████▌    | 55/100 [00:06<00:05,  8.58it/s] 56%|█████▌    | 56/100 [00:06<00:05,  8.51it/s] 57%|█████▋    | 57/100 [00:06<00:05,  8.41it/s] 58%|█████▊    | 58/100 [00:07<00:05,  8.36it/s] 59%|█████▉    | 59/100 [00:07<00:04,  8.54it/s] 61%|██████    | 61/100 [00:07<00:04,  9.08it/s] 62%|██████▏   | 62/100 [00:07<00:04,  9.20it/s] 63%|██████▎   | 63/100 [00:07<00:04,  9.07it/s] 64%|██████▍   | 64/100 [00:07<00:04,  8.29it/s] 65%|██████▌   | 65/100 [00:07<00:04,  8.16it/s] 66%|██████▌   | 66/100 [00:07<00:03,  8.54it/s] 67%|██████▋   | 67/100 [00:08<00:04,  8.04it/s] 68%|██████▊   | 68/100 [00:08<00:04,  7.81it/s] 69%|██████▉   | 69/100 [00:08<00:03,  8.18it/s] 70%|███████   | 70/100 [00:08<00:03,  7.87it/s] 71%|███████   | 71/100 [00:08<00:03,  7.50it/s] 72%|███████▏  | 72/100 [00:08<00:03,  7.98it/s] 73%|███████▎  | 73/100 [00:08<00:03,  8.22it/s] 75%|███████▌  | 75/100 [00:09<00:03,  7.71it/s] 76%|███████▌  | 76/100 [00:09<00:02,  8.02it/s] 77%|███████▋  | 77/100 [00:09<00:02,  7.84it/s] 78%|███████▊  | 78/100 [00:09<00:02,  8.10it/s] 79%|███████▉  | 79/100 [00:09<00:02,  8.38it/s] 80%|████████  | 80/100 [00:09<00:02,  8.31it/s] 81%|████████  | 81/100 [00:09<00:02,  8.41it/s] 82%|████████▏ | 82/100 [00:09<00:02,  8.58it/s] 83%|████████▎ | 83/100 [00:10<00:01,  8.65it/s] 84%|████████▍ | 84/100 [00:10<00:01,  8.28it/s] 85%|████████▌ | 85/100 [00:10<00:01,  8.38it/s] 86%|████████▌ | 86/100 [00:10<00:01,  8.32it/s] 87%|████████▋ | 87/100 [00:10<00:01,  8.59it/s] 88%|████████▊ | 88/100 [00:10<00:01,  8.67it/s] 89%|████████▉ | 89/100 [00:10<00:01,  8.81it/s] 91%|█████████ | 91/100 [00:10<00:00,  9.12it/s] 92%|█████████▏| 92/100 [00:11<00:00,  9.06it/s] 93%|█████████▎| 93/100 [00:11<00:00,  9.28it/s] 94%|█████████▍| 94/100 [00:11<00:00,  9.44it/s] 95%|█████████▌| 95/100 [00:11<00:00,  8.60it/s] 96%|█████████▌| 96/100 [00:11<00:00,  8.89it/s] 97%|█████████▋| 97/100 [00:11<00:00,  8.62it/s] 98%|█████████▊| 98/100 [00:11<00:00,  8.89it/s] 99%|█████████▉| 99/100 [00:11<00:00,  9.07it/s]100%|██████████| 100/100 [00:11<00:00,  9.05it/s]100%|██████████| 100/100 [00:11<00:00,  8.36it/s]
eval_p_index len:  16
individual_train 116
individual_eval 16
train data의 x, y, id 길이: 116 116 116
valid data의 x, y, id 길이: 9 9 9
test data의 x, y, id 길이: 7 7 7
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.871353, Valid_loss 0.745351
Epoch 2, Train Loss 0.819159, Valid_loss 0.722145
Epoch 3, Train Loss 0.781320, Valid_loss 0.706851
Epoch 4, Train Loss 0.756416, Valid_loss 0.699328
Epoch 5, Train Loss 0.748484, Valid_loss 0.698651
Epoch 6, Train Loss 0.746225, Valid_loss 0.697795
Epoch 7, Train Loss 0.748517, Valid_loss 0.697141
Epoch 8, Train Loss 0.733327, Valid_loss 0.696486
Epoch 9, Train Loss 0.742970, Valid_loss 0.695426
Epoch 10, Train Loss 0.723132, Valid_loss 0.694717
Epoch 11, Train Loss 0.731702, Valid_loss 0.693379
Epoch 12, Train Loss 0.763534, Valid_loss 0.692225
Epoch 13, Train Loss 0.734828, Valid_loss 0.691063
Epoch 14, Train Loss 0.745792, Valid_loss 0.690261
Epoch 15, Train Loss 0.727836, Valid_loss 0.688483
Epoch 16, Train Loss 0.725596, Valid_loss 0.687447
Epoch 17, Train Loss 0.714783, Valid_loss 0.685975
Epoch 18, Train Loss 0.719393, Valid_loss 0.683740
Epoch 19, Train Loss 0.724682, Valid_loss 0.681533
Epoch 20, Train Loss 0.707939, Valid_loss 0.682766
Epoch 21, Train Loss 0.702971, Valid_loss 0.681217
Epoch 22, Train Loss 0.694089, Valid_loss 0.678985
Epoch 23, Train Loss 0.696257, Valid_loss 0.675885
Epoch 24, Train Loss 0.683660, Valid_loss 0.672763
Epoch 25, Train Loss 0.682270, Valid_loss 0.671194
Epoch 26, Train Loss 0.678766, Valid_loss 0.666204
Epoch 27, Train Loss 0.687310, Valid_loss 0.663531
Epoch 28, Train Loss 0.668387, Valid_loss 0.665546
Epoch 29, Train Loss 0.661072, Valid_loss 0.668979
Epoch 30, Train Loss 0.664054, Valid_loss 0.670311
Epoch 31, Train Loss 0.658215, Valid_loss 0.670355
Epoch 32, Train Loss 0.650590, Valid_loss 0.672421
Epoch 33, Train Loss 0.653060, Valid_loss 0.667707
Epoch 34, Train Loss 0.660529, Valid_loss 0.667530
Epoch 35, Train Loss 0.642104, Valid_loss 0.655478
Epoch 36, Train Loss 0.640673, Valid_loss 0.649517
Epoch 37, Train Loss 0.649921, Valid_loss 0.648290
Epoch 38, Train Loss 0.634805, Valid_loss 0.650313
Epoch 39, Train Loss 0.618120, Valid_loss 0.644406
Epoch 40, Train Loss 0.609070, Valid_loss 0.636947
Epoch 41, Train Loss 0.611921, Valid_loss 0.623399
Epoch 42, Train Loss 0.554850, Valid_loss 0.599151
Epoch 43, Train Loss 0.519584, Valid_loss 0.613765
Epoch 44, Train Loss 0.526304, Valid_loss 0.599171
Epoch 45, Train Loss 0.495081, Valid_loss 0.576929
Epoch 46, Train Loss 0.499345, Valid_loss 0.567815
Epoch 47, Train Loss 0.467647, Valid_loss 0.564415
Epoch 48, Train Loss 0.476905, Valid_loss 0.568309
Epoch 49, Train Loss 0.463040, Valid_loss 0.574097
Epoch 50, Train Loss 0.478706, Valid_loss 0.569103
Epoch 51, Train Loss 0.449613, Valid_loss 0.569451
Epoch 52, Train Loss 0.444992, Valid_loss 0.566057
Epoch 53, Train Loss 0.470800, Valid_loss 0.558595
Epoch 54, Train Loss 0.452419, Valid_loss 0.559560
Epoch 55, Train Loss 0.439742, Valid_loss 0.566301
Control_Participant1 -- true: normal -- pred: normal
Control_Participant5 -- true: normal -- pred: COVID-19
COVID19_Participant8 -- true: COVID-19 -- pred: normal
COVID19_Participant31 -- true: COVID-19 -- pred: normal
Control_Participant10 -- true: normal -- pred: normal
Control_Participant4 -- true: normal -- pred: COVID-19
COVID19_Participant13 -- true: COVID-19 -- pred: COVID-19
true :  [0, 0, 1, 1, 0, 0, 1]
pred :  [0, 1, 0, 0, 0, 1, 1]
Confusion Matrix: [2 2 2 1]
Best performance: Epoch 53, Loss 0.470800, Test ACC 0.428571, Test AUC 0.583333, Test Recall 0.333333, Test Precision 0.333333
✅ Total valid splits used: 2
🔁 Repeat 1, Fold 2
🔍 Split #3
  → train_p_index 환자 수: 28
  → test_p_index 환자 수: 4
  → train 환자 ID: ['COVID19_Participant11', 'COVID19_Participant13', 'COVID19_Participant15', 'COVID19_Participant17', 'COVID19_Participant19', 'COVID19_Participant2', 'COVID19_Participant22', 'COVID19_Participant23', 'COVID19_Participant25', 'COVID19_Participant26', 'COVID19_Participant28', 'COVID19_Participant29', 'COVID19_Participant31', 'COVID19_Participant32', 'COVID19_Participant37', 'COVID19_Participant39', 'COVID19_Participant4', 'COVID19_Participant7', 'COVID19_Participant8', 'Control_Participant1', 'Control_Participant10', 'Control_Participant11', 'Control_Participant15', 'Control_Participant3', 'Control_Participant5', 'Control_Participant7', 'Control_Participant8', 'Control_Participant9']
  → test  환자 ID: ['Control_Participant7', 'COVID19_Participant31', 'COVID19_Participant13', 'Control_Participant7']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant10, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant8, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: Control_Participant7, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: Control_Participant7, Label: 0
train_p_index_ 18
valid_p_index 10
test_p_index 4
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Ciliated Cells', 'Developing Ciliated Cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
data augment 실행 함
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:12,  7.88it/s]  2%|▏         | 2/100 [00:00<00:11,  8.86it/s]  3%|▎         | 3/100 [00:00<00:11,  8.80it/s]  4%|▍         | 4/100 [00:00<00:10,  8.85it/s]  5%|▌         | 5/100 [00:00<00:10,  9.20it/s]  7%|▋         | 7/100 [00:00<00:10,  8.85it/s]  8%|▊         | 8/100 [00:01<00:13,  6.83it/s]  9%|▉         | 9/100 [00:01<00:12,  7.37it/s] 10%|█         | 10/100 [00:01<00:13,  6.69it/s] 11%|█         | 11/100 [00:01<00:12,  7.09it/s] 12%|█▏        | 12/100 [00:01<00:12,  7.30it/s] 13%|█▎        | 13/100 [00:01<00:10,  7.91it/s] 14%|█▍        | 14/100 [00:01<00:13,  6.59it/s] 15%|█▌        | 15/100 [00:01<00:11,  7.19it/s] 16%|█▌        | 16/100 [00:02<00:11,  7.58it/s] 17%|█▋        | 17/100 [00:02<00:10,  7.63it/s] 18%|█▊        | 18/100 [00:02<00:10,  7.99it/s] 19%|█▉        | 19/100 [00:02<00:09,  8.28it/s] 20%|██        | 20/100 [00:02<00:09,  8.29it/s] 21%|██        | 21/100 [00:02<00:09,  8.66it/s] 22%|██▏       | 22/100 [00:02<00:10,  7.18it/s] 23%|██▎       | 23/100 [00:02<00:09,  7.74it/s] 25%|██▌       | 25/100 [00:03<00:08,  8.67it/s] 26%|██▌       | 26/100 [00:03<00:09,  7.99it/s] 27%|██▋       | 27/100 [00:03<00:09,  7.76it/s] 28%|██▊       | 28/100 [00:03<00:09,  7.95it/s] 29%|██▉       | 29/100 [00:03<00:08,  8.19it/s] 30%|███       | 30/100 [00:03<00:09,  7.43it/s] 31%|███       | 31/100 [00:03<00:08,  7.81it/s] 32%|███▏      | 32/100 [00:04<00:08,  8.17it/s] 33%|███▎      | 33/100 [00:04<00:09,  7.27it/s] 34%|███▍      | 34/100 [00:04<00:08,  7.84it/s] 35%|███▌      | 35/100 [00:04<00:08,  7.77it/s] 36%|███▌      | 36/100 [00:04<00:07,  8.09it/s] 37%|███▋      | 37/100 [00:04<00:07,  8.37it/s] 38%|███▊      | 38/100 [00:04<00:09,  6.35it/s] 39%|███▉      | 39/100 [00:05<00:09,  6.66it/s] 40%|████      | 40/100 [00:05<00:09,  6.57it/s] 41%|████      | 41/100 [00:05<00:08,  7.19it/s] 42%|████▏     | 42/100 [00:05<00:07,  7.75it/s] 44%|████▍     | 44/100 [00:05<00:06,  8.67it/s] 45%|████▌     | 45/100 [00:05<00:08,  6.45it/s] 46%|████▌     | 46/100 [00:06<00:07,  7.01it/s] 47%|████▋     | 47/100 [00:06<00:07,  7.37it/s] 48%|████▊     | 48/100 [00:06<00:06,  7.85it/s] 49%|████▉     | 49/100 [00:06<00:06,  8.08it/s] 50%|█████     | 50/100 [00:06<00:06,  8.19it/s] 51%|█████     | 51/100 [00:06<00:06,  7.98it/s] 52%|█████▏    | 52/100 [00:06<00:06,  6.91it/s] 53%|█████▎    | 53/100 [00:06<00:06,  7.46it/s] 54%|█████▍    | 54/100 [00:07<00:07,  6.13it/s] 55%|█████▌    | 55/100 [00:07<00:06,  6.81it/s] 56%|█████▌    | 56/100 [00:07<00:06,  6.88it/s] 57%|█████▋    | 57/100 [00:07<00:05,  7.21it/s] 58%|█████▊    | 58/100 [00:07<00:05,  7.75it/s] 59%|█████▉    | 59/100 [00:07<00:05,  8.09it/s] 60%|██████    | 60/100 [00:07<00:05,  7.02it/s] 61%|██████    | 61/100 [00:08<00:05,  7.38it/s] 62%|██████▏   | 62/100 [00:08<00:04,  7.79it/s] 63%|██████▎   | 63/100 [00:08<00:04,  8.21it/s] 64%|██████▍   | 64/100 [00:08<00:04,  8.46it/s] 65%|██████▌   | 65/100 [00:08<00:03,  8.79it/s] 66%|██████▌   | 66/100 [00:08<00:04,  7.02it/s] 67%|██████▋   | 67/100 [00:08<00:04,  7.52it/s] 68%|██████▊   | 68/100 [00:08<00:04,  7.89it/s] 69%|██████▉   | 69/100 [00:09<00:03,  8.18it/s] 70%|███████   | 70/100 [00:09<00:03,  8.07it/s] 71%|███████   | 71/100 [00:09<00:03,  8.45it/s] 72%|███████▏  | 72/100 [00:09<00:03,  8.62it/s] 73%|███████▎  | 73/100 [00:09<00:03,  7.39it/s] 74%|███████▍  | 74/100 [00:09<00:03,  7.79it/s] 75%|███████▌  | 75/100 [00:09<00:03,  7.81it/s] 76%|███████▌  | 76/100 [00:10<00:03,  6.81it/s] 77%|███████▋  | 77/100 [00:10<00:03,  7.40it/s] 78%|███████▊  | 78/100 [00:10<00:02,  7.62it/s] 79%|███████▉  | 79/100 [00:10<00:02,  8.17it/s] 80%|████████  | 80/100 [00:10<00:02,  8.26it/s] 81%|████████  | 81/100 [00:10<00:02,  8.21it/s] 82%|████████▏ | 82/100 [00:10<00:02,  8.23it/s] 83%|████████▎ | 83/100 [00:10<00:02,  6.68it/s] 84%|████████▍ | 84/100 [00:11<00:02,  7.24it/s] 85%|████████▌ | 85/100 [00:11<00:01,  7.64it/s] 86%|████████▌ | 86/100 [00:11<00:01,  8.06it/s] 87%|████████▋ | 87/100 [00:11<00:01,  8.19it/s] 88%|████████▊ | 88/100 [00:11<00:01,  8.38it/s] 89%|████████▉ | 89/100 [00:11<00:01,  8.54it/s] 90%|█████████ | 90/100 [00:11<00:01,  7.15it/s] 91%|█████████ | 91/100 [00:11<00:01,  7.48it/s] 92%|█████████▏| 92/100 [00:12<00:01,  7.83it/s] 93%|█████████▎| 93/100 [00:12<00:00,  8.31it/s] 94%|█████████▍| 94/100 [00:12<00:00,  8.57it/s] 95%|█████████▌| 95/100 [00:12<00:00,  8.84it/s] 96%|█████████▌| 96/100 [00:12<00:00,  8.54it/s] 97%|█████████▋| 97/100 [00:12<00:00,  6.57it/s] 98%|█████████▊| 98/100 [00:12<00:00,  6.24it/s] 99%|█████████▉| 99/100 [00:12<00:00,  6.81it/s]100%|██████████| 100/100 [00:13<00:00,  7.22it/s]100%|██████████| 100/100 [00:13<00:00,  7.63it/s]
eval_p_index len:  14
individual_train 118
individual_eval 14
train data의 x, y, id 길이: 118 118 118
valid data의 x, y, id 길이: 10 10 10
test data의 x, y, id 길이: 4 4 4
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.759000, Valid_loss 0.693472
Epoch 2, Train Loss 0.745738, Valid_loss 0.690531
Epoch 3, Train Loss 0.732619, Valid_loss 0.688914
Epoch 4, Train Loss 0.720285, Valid_loss 0.689077
Epoch 5, Train Loss 0.722459, Valid_loss 0.690760
Epoch 6, Train Loss 0.715549, Valid_loss 0.691077
Epoch 7, Train Loss 0.715912, Valid_loss 0.690859
Epoch 8, Train Loss 0.710152, Valid_loss 0.690163
Epoch 9, Train Loss 0.706000, Valid_loss 0.689582
Epoch 10, Train Loss 0.704943, Valid_loss 0.689170
Epoch 11, Train Loss 0.702255, Valid_loss 0.689079
Epoch 12, Train Loss 0.700607, Valid_loss 0.688589
Epoch 13, Train Loss 0.699324, Valid_loss 0.687808
Epoch 14, Train Loss 0.691006, Valid_loss 0.686643
Epoch 15, Train Loss 0.685269, Valid_loss 0.684341
Epoch 16, Train Loss 0.672206, Valid_loss 0.668370
Epoch 17, Train Loss 0.628355, Valid_loss 0.660138
Epoch 18, Train Loss 0.577235, Valid_loss 0.673428
Epoch 19, Train Loss 0.562860, Valid_loss 0.684790
Epoch 20, Train Loss 0.537102, Valid_loss 0.680100
Epoch 21, Train Loss 0.533234, Valid_loss 0.673677
Epoch 22, Train Loss 0.524034, Valid_loss 0.666877
Epoch 23, Train Loss 0.514781, Valid_loss 0.677188
Epoch 24, Train Loss 0.508677, Valid_loss 0.680461
Epoch 25, Train Loss 0.484335, Valid_loss 0.673244
Epoch 26, Train Loss 0.489961, Valid_loss 0.668693
Epoch 27, Train Loss 0.477659, Valid_loss 0.664854
Epoch 28, Train Loss 0.469531, Valid_loss 0.663758
Epoch 29, Train Loss 0.458027, Valid_loss 0.664877
Epoch 30, Train Loss 0.465672, Valid_loss 0.672001
Epoch 31, Train Loss 0.461446, Valid_loss 0.659681
Epoch 32, Train Loss 0.462905, Valid_loss 0.654094
Epoch 33, Train Loss 0.457961, Valid_loss 0.649909
Epoch 34, Train Loss 0.458436, Valid_loss 0.649773
Epoch 35, Train Loss 0.452266, Valid_loss 0.645365
Epoch 36, Train Loss 0.439323, Valid_loss 0.641949
Epoch 37, Train Loss 0.440405, Valid_loss 0.639434
Epoch 38, Train Loss 0.428962, Valid_loss 0.641466
Epoch 39, Train Loss 0.434476, Valid_loss 0.642678
Epoch 40, Train Loss 0.434056, Valid_loss 0.635355
Epoch 41, Train Loss 0.427565, Valid_loss 0.639094
Epoch 42, Train Loss 0.421858, Valid_loss 0.635780
Epoch 43, Train Loss 0.428350, Valid_loss 0.646292
Epoch 44, Train Loss 0.426238, Valid_loss 0.641432
Epoch 45, Train Loss 0.411345, Valid_loss 0.645103
Epoch 46, Train Loss 0.416756, Valid_loss 0.646624
Epoch 47, Train Loss 0.420439, Valid_loss 0.646516
Epoch 48, Train Loss 0.415670, Valid_loss 0.647907
Epoch 49, Train Loss 0.404738, Valid_loss 0.647037
Epoch 50, Train Loss 0.406556, Valid_loss 0.647799
Epoch 51, Train Loss 0.417042, Valid_loss 0.647648
Epoch 52, Train Loss 0.417545, Valid_loss 0.647043
Epoch 53, Train Loss 0.395405, Valid_loss 0.647275
Epoch 54, Train Loss 0.400912, Valid_loss 0.647550
Control_Participant7 -- true: normal -- pred: COVID-19
COVID19_Participant31 -- true: COVID-19 -- pred: COVID-19
COVID19_Participant13 -- true: COVID-19 -- pred: COVID-19
Control_Participant7 -- true: normal -- pred: normal
true :  [0, 1, 1, 0]
pred :  [1, 1, 1, 0]
Confusion Matrix: [1 1 0 2]
Best performance: Epoch 40, Loss 0.434056, Test ACC 0.750000, Test AUC 1.000000, Test Recall 1.000000, Test Precision 0.666667
✅ Total valid splits used: 3
🔁 Repeat 1, Fold 3
🔍 Split #4
  → train_p_index 환자 수: 24
  → test_p_index 환자 수: 8
  → train 환자 ID: ['COVID19_Participant11', 'COVID19_Participant14', 'COVID19_Participant15', 'COVID19_Participant17', 'COVID19_Participant19', 'COVID19_Participant2', 'COVID19_Participant20', 'COVID19_Participant22', 'COVID19_Participant23', 'COVID19_Participant25', 'COVID19_Participant26', 'COVID19_Participant29', 'COVID19_Participant32', 'COVID19_Participant37', 'COVID19_Participant40', 'COVID19_Participant7', 'COVID19_Participant8', 'Control_Participant10', 'Control_Participant11', 'Control_Participant3', 'Control_Participant4', 'Control_Participant5', 'Control_Participant7', 'Control_Participant9']
  → test  환자 ID: ['Control_Participant7', 'COVID19_Participant26', 'Control_Participant7', 'COVID19_Participant7', 'Control_Participant5', 'COVID19_Participant26', 'Control_Participant3', 'Control_Participant5']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: Control_Participant10, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant4, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: Control_Participant7, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: Control_Participant7, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: Control_Participant5, Label: 1
    ID: COVID19_Participant26, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant5, Label: 0
train_p_index_ 16
valid_p_index 8
test_p_index 8
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Ciliated Cells', 'Developing Ciliated Cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
data augment 실행 함
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:10,  9.75it/s]  2%|▏         | 2/100 [00:00<00:10,  9.36it/s]  3%|▎         | 3/100 [00:00<00:10,  9.13it/s]  5%|▌         | 5/100 [00:00<00:09,  9.99it/s]  7%|▋         | 7/100 [00:00<00:09, 10.19it/s]  9%|▉         | 9/100 [00:00<00:09,  9.96it/s] 11%|█         | 11/100 [00:01<00:08, 10.05it/s] 13%|█▎        | 13/100 [00:01<00:08, 10.22it/s] 15%|█▌        | 15/100 [00:01<00:08, 10.27it/s] 17%|█▋        | 17/100 [00:01<00:07, 10.42it/s] 19%|█▉        | 19/100 [00:01<00:07, 10.16it/s] 21%|██        | 21/100 [00:02<00:07,  9.94it/s] 23%|██▎       | 23/100 [00:02<00:07,  9.98it/s] 24%|██▍       | 24/100 [00:02<00:07,  9.97it/s] 26%|██▌       | 26/100 [00:02<00:07,  9.90it/s] 27%|██▋       | 27/100 [00:02<00:07,  9.64it/s] 28%|██▊       | 28/100 [00:02<00:07,  9.71it/s] 30%|███       | 30/100 [00:03<00:06, 10.01it/s] 31%|███       | 31/100 [00:03<00:07,  9.80it/s] 32%|███▏      | 32/100 [00:03<00:07,  9.70it/s] 33%|███▎      | 33/100 [00:03<00:07,  9.32it/s] 34%|███▍      | 34/100 [00:03<00:07,  9.18it/s] 35%|███▌      | 35/100 [00:03<00:08,  8.09it/s] 37%|███▋      | 37/100 [00:03<00:07,  8.72it/s] 38%|███▊      | 38/100 [00:03<00:07,  8.83it/s] 40%|████      | 40/100 [00:04<00:06,  8.64it/s] 42%|████▏     | 42/100 [00:04<00:06,  8.98it/s] 44%|████▍     | 44/100 [00:04<00:06,  9.04it/s] 45%|████▌     | 45/100 [00:04<00:05,  9.19it/s] 47%|████▋     | 47/100 [00:04<00:05,  9.42it/s] 48%|████▊     | 48/100 [00:05<00:05,  9.32it/s] 49%|████▉     | 49/100 [00:05<00:05,  9.44it/s] 51%|█████     | 51/100 [00:05<00:05,  9.67it/s] 53%|█████▎    | 53/100 [00:05<00:04,  9.77it/s] 54%|█████▍    | 54/100 [00:05<00:04,  9.74it/s] 56%|█████▌    | 56/100 [00:05<00:04,  9.21it/s] 58%|█████▊    | 58/100 [00:06<00:04,  9.29it/s] 59%|█████▉    | 59/100 [00:06<00:04,  9.24it/s] 61%|██████    | 61/100 [00:06<00:04,  8.57it/s] 62%|██████▏   | 62/100 [00:06<00:04,  8.63it/s] 63%|██████▎   | 63/100 [00:06<00:04,  8.84it/s] 65%|██████▌   | 65/100 [00:06<00:03,  9.21it/s] 66%|██████▌   | 66/100 [00:06<00:03,  9.13it/s] 67%|██████▋   | 67/100 [00:07<00:03,  8.88it/s] 68%|██████▊   | 68/100 [00:07<00:03,  8.16it/s] 70%|███████   | 70/100 [00:07<00:03,  8.89it/s] 71%|███████   | 71/100 [00:07<00:03,  8.92it/s] 72%|███████▏  | 72/100 [00:07<00:03,  9.14it/s] 73%|███████▎  | 73/100 [00:07<00:02,  9.02it/s] 75%|███████▌  | 75/100 [00:07<00:02,  9.51it/s] 77%|███████▋  | 77/100 [00:08<00:02,  8.22it/s] 78%|███████▊  | 78/100 [00:08<00:02,  8.42it/s] 79%|███████▉  | 79/100 [00:08<00:02,  8.72it/s] 80%|████████  | 80/100 [00:08<00:02,  8.86it/s] 81%|████████  | 81/100 [00:08<00:02,  8.95it/s] 82%|████████▏ | 82/100 [00:08<00:01,  9.10it/s] 83%|████████▎ | 83/100 [00:08<00:01,  9.13it/s] 84%|████████▍ | 84/100 [00:09<00:01,  9.30it/s] 86%|████████▌ | 86/100 [00:09<00:01,  9.28it/s] 87%|████████▋ | 87/100 [00:09<00:01,  9.28it/s] 89%|████████▉ | 89/100 [00:09<00:01,  8.21it/s] 90%|█████████ | 90/100 [00:09<00:01,  8.55it/s] 92%|█████████▏| 92/100 [00:09<00:00,  9.34it/s] 93%|█████████▎| 93/100 [00:10<00:00,  9.29it/s] 94%|█████████▍| 94/100 [00:10<00:00,  8.74it/s] 95%|█████████▌| 95/100 [00:10<00:00,  7.53it/s] 96%|█████████▌| 96/100 [00:10<00:00,  5.48it/s] 97%|█████████▋| 97/100 [00:10<00:00,  6.05it/s] 98%|█████████▊| 98/100 [00:10<00:00,  6.54it/s]100%|██████████| 100/100 [00:11<00:00,  7.53it/s]100%|██████████| 100/100 [00:11<00:00,  9.01it/s]
eval_p_index len:  16
individual_train 116
individual_eval 16
train data의 x, y, id 길이: 116 116 116
valid data의 x, y, id 길이: 8 8 8
test data의 x, y, id 길이: 8 8 8
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.675915, Valid_loss 0.668739
Epoch 2, Train Loss 0.624727, Valid_loss 0.659369
Epoch 3, Train Loss 0.603106, Valid_loss 0.654704
Epoch 4, Train Loss 0.600195, Valid_loss 0.652305
Epoch 5, Train Loss 0.587385, Valid_loss 0.644982
Epoch 6, Train Loss 0.551274, Valid_loss 0.605423
Epoch 7, Train Loss 0.540888, Valid_loss 0.586455
Epoch 8, Train Loss 0.522107, Valid_loss 0.573153
Epoch 9, Train Loss 0.513835, Valid_loss 0.558929
Epoch 10, Train Loss 0.503322, Valid_loss 0.552654
Epoch 11, Train Loss 0.499613, Valid_loss 0.548125
Epoch 12, Train Loss 0.488844, Valid_loss 0.545687
Epoch 13, Train Loss 0.487240, Valid_loss 0.543812
Epoch 14, Train Loss 0.490724, Valid_loss 0.543790
Epoch 15, Train Loss 0.484779, Valid_loss 0.541680
Epoch 16, Train Loss 0.484330, Valid_loss 0.538319
Epoch 17, Train Loss 0.479541, Valid_loss 0.535418
Epoch 18, Train Loss 0.485947, Valid_loss 0.533448
Epoch 19, Train Loss 0.473182, Valid_loss 0.530315
Epoch 20, Train Loss 0.472144, Valid_loss 0.527248
Epoch 21, Train Loss 0.473262, Valid_loss 0.525192
Epoch 22, Train Loss 0.465465, Valid_loss 0.524089
Epoch 23, Train Loss 0.475605, Valid_loss 0.522924
Epoch 24, Train Loss 0.467245, Valid_loss 0.521411
Epoch 25, Train Loss 0.464121, Valid_loss 0.519898
Epoch 26, Train Loss 0.461650, Valid_loss 0.518871
Epoch 27, Train Loss 0.459865, Valid_loss 0.517460
Epoch 28, Train Loss 0.466302, Valid_loss 0.517146
Epoch 29, Train Loss 0.452777, Valid_loss 0.515945
Epoch 30, Train Loss 0.457361, Valid_loss 0.515644
Epoch 31, Train Loss 0.447553, Valid_loss 0.514713
Epoch 32, Train Loss 0.455492, Valid_loss 0.513834
Epoch 33, Train Loss 0.448294, Valid_loss 0.512091
Epoch 34, Train Loss 0.457430, Valid_loss 0.512058
Epoch 35, Train Loss 0.439753, Valid_loss 0.509094
Epoch 36, Train Loss 0.434142, Valid_loss 0.509242
Epoch 37, Train Loss 0.442441, Valid_loss 0.508769
Epoch 38, Train Loss 0.444001, Valid_loss 0.509083
Epoch 39, Train Loss 0.453326, Valid_loss 0.506116
Epoch 40, Train Loss 0.442791, Valid_loss 0.507966
Epoch 41, Train Loss 0.438459, Valid_loss 0.507559
Epoch 42, Train Loss 0.443807, Valid_loss 0.507029
Epoch 43, Train Loss 0.440036, Valid_loss 0.504288
Epoch 44, Train Loss 0.444906, Valid_loss 0.503658
Epoch 45, Train Loss 0.423238, Valid_loss 0.505737
Epoch 46, Train Loss 0.441155, Valid_loss 0.501455
Epoch 47, Train Loss 0.425084, Valid_loss 0.503134
Epoch 48, Train Loss 0.423891, Valid_loss 0.501403
Epoch 49, Train Loss 0.443009, Valid_loss 0.501668
Epoch 50, Train Loss 0.426337, Valid_loss 0.501809
Epoch 51, Train Loss 0.430965, Valid_loss 0.500256
Epoch 52, Train Loss 0.418101, Valid_loss 0.498879
Epoch 53, Train Loss 0.417804, Valid_loss 0.499338
Epoch 54, Train Loss 0.427184, Valid_loss 0.498565
Epoch 55, Train Loss 0.432336, Valid_loss 0.499473
Epoch 56, Train Loss 0.422835, Valid_loss 0.498122
Epoch 57, Train Loss 0.424994, Valid_loss 0.497560
Epoch 58, Train Loss 0.416920, Valid_loss 0.497485
Epoch 59, Train Loss 0.429254, Valid_loss 0.497369
Epoch 60, Train Loss 0.424349, Valid_loss 0.496427
Epoch 61, Train Loss 0.428628, Valid_loss 0.494192
Epoch 62, Train Loss 0.423113, Valid_loss 0.494902
Epoch 63, Train Loss 0.428205, Valid_loss 0.494691
Epoch 64, Train Loss 0.421566, Valid_loss 0.494306
Epoch 65, Train Loss 0.417591, Valid_loss 0.493248
Epoch 66, Train Loss 0.424353, Valid_loss 0.492863
Epoch 67, Train Loss 0.427099, Valid_loss 0.492799
Epoch 68, Train Loss 0.421101, Valid_loss 0.494676
Epoch 69, Train Loss 0.407798, Valid_loss 0.492907
Epoch 70, Train Loss 0.405862, Valid_loss 0.492966
Epoch 71, Train Loss 0.431855, Valid_loss 0.492051
Epoch 72, Train Loss 0.419862, Valid_loss 0.490953
Epoch 73, Train Loss 0.418904, Valid_loss 0.492581
Epoch 74, Train Loss 0.413045, Valid_loss 0.490882
Epoch 75, Train Loss 0.422413, Valid_loss 0.491872
Epoch 76, Train Loss 0.419178, Valid_loss 0.490233
Epoch 77, Train Loss 0.401970, Valid_loss 0.492902
Epoch 78, Train Loss 0.413376, Valid_loss 0.488790
Epoch 79, Train Loss 0.407539, Valid_loss 0.488877
Epoch 80, Train Loss 0.419764, Valid_loss 0.489419
Control_Participant7 -- true: normal -- pred: normal
COVID19_Participant26 -- true: COVID-19 -- pred: COVID-19
Control_Participant7 -- true: normal -- pred: COVID-19
COVID19_Participant7 -- true: COVID-19 -- pred: COVID-19
Control_Participant5 -- true: normal -- pred: normal
COVID19_Participant26 -- true: COVID-19 -- pred: COVID-19
Control_Participant3 -- true: normal -- pred: normal
Control_Participant5 -- true: normal -- pred: normal
true :  [0, 1, 0, 1, 0, 1, 0, 0]
pred :  [0, 1, 1, 1, 0, 1, 0, 0]
Confusion Matrix: [4 1 0 3]
Best performance: Epoch 78, Loss 0.413376, Test ACC 0.875000, Test AUC 0.933333, Test Recall 1.000000, Test Precision 0.750000
✅ Total valid splits used: 4
🔁 Repeat 1, Fold 4
🔍 Split #5
  → train_p_index 환자 수: 27
  → test_p_index 환자 수: 5
  → train 환자 ID: ['COVID19_Participant11', 'COVID19_Participant13', 'COVID19_Participant14', 'COVID19_Participant17', 'COVID19_Participant19', 'COVID19_Participant2', 'COVID19_Participant20', 'COVID19_Participant22', 'COVID19_Participant23', 'COVID19_Participant25', 'COVID19_Participant26', 'COVID19_Participant28', 'COVID19_Participant29', 'COVID19_Participant31', 'COVID19_Participant37', 'COVID19_Participant39', 'COVID19_Participant4', 'COVID19_Participant40', 'COVID19_Participant7', 'Control_Participant1', 'Control_Participant15', 'Control_Participant3', 'Control_Participant4', 'Control_Participant5', 'Control_Participant7', 'Control_Participant8', 'Control_Participant9']
  → test  환자 ID: ['COVID19_Participant11', 'COVID19_Participant25', 'Control_Participant7', 'Control_Participant7', 'COVID19_Participant26']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant4, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant8, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: Control_Participant7, Label: 1
    ID: Control_Participant7, Label: 0
    ID: COVID19_Participant26, Label: 0
train_p_index_ 18
valid_p_index 9
test_p_index 5
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Ciliated Cells', 'Developing Ciliated Cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
data augment 실행 함
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:11,  8.97it/s]  2%|▏         | 2/100 [00:00<00:10,  9.03it/s]  3%|▎         | 3/100 [00:00<00:10,  9.01it/s]  4%|▍         | 4/100 [00:00<00:10,  9.07it/s]  5%|▌         | 5/100 [00:00<00:10,  9.31it/s]  6%|▌         | 6/100 [00:00<00:10,  9.30it/s]  7%|▋         | 7/100 [00:00<00:10,  9.07it/s]  8%|▊         | 8/100 [00:00<00:10,  9.17it/s]  9%|▉         | 9/100 [00:00<00:10,  8.96it/s] 10%|█         | 10/100 [00:01<00:09,  9.03it/s] 11%|█         | 11/100 [00:01<00:09,  9.08it/s] 12%|█▏        | 12/100 [00:01<00:09,  9.08it/s] 13%|█▎        | 13/100 [00:01<00:09,  9.07it/s] 14%|█▍        | 14/100 [00:01<00:09,  9.15it/s] 15%|█▌        | 15/100 [00:01<00:09,  9.27it/s] 16%|█▌        | 16/100 [00:01<00:09,  8.89it/s] 17%|█▋        | 17/100 [00:01<00:10,  8.16it/s] 19%|█▉        | 19/100 [00:02<00:09,  8.93it/s] 20%|██        | 20/100 [00:02<00:08,  9.10it/s] 21%|██        | 21/100 [00:02<00:08,  9.16it/s] 22%|██▏       | 22/100 [00:02<00:08,  9.27it/s] 23%|██▎       | 23/100 [00:02<00:08,  9.22it/s] 24%|██▍       | 24/100 [00:02<00:08,  9.23it/s] 25%|██▌       | 25/100 [00:02<00:08,  9.28it/s] 26%|██▌       | 26/100 [00:02<00:08,  9.24it/s] 27%|██▋       | 27/100 [00:02<00:08,  9.07it/s] 28%|██▊       | 28/100 [00:03<00:12,  5.93it/s] 29%|██▉       | 29/100 [00:03<00:11,  6.29it/s] 30%|███       | 30/100 [00:03<00:10,  6.85it/s] 31%|███       | 31/100 [00:03<00:09,  7.52it/s] 32%|███▏      | 32/100 [00:03<00:08,  7.86it/s] 33%|███▎      | 33/100 [00:03<00:08,  8.24it/s] 34%|███▍      | 34/100 [00:03<00:07,  8.42it/s] 35%|███▌      | 35/100 [00:04<00:07,  8.59it/s] 36%|███▌      | 36/100 [00:04<00:07,  8.62it/s] 37%|███▋      | 37/100 [00:04<00:07,  8.57it/s] 38%|███▊      | 38/100 [00:04<00:07,  8.16it/s] 39%|███▉      | 39/100 [00:04<00:07,  8.48it/s] 40%|████      | 40/100 [00:04<00:06,  8.67it/s] 41%|████      | 41/100 [00:04<00:06,  8.63it/s] 42%|████▏     | 42/100 [00:04<00:06,  8.37it/s] 43%|████▎     | 43/100 [00:05<00:06,  8.36it/s] 44%|████▍     | 44/100 [00:05<00:06,  8.41it/s] 45%|████▌     | 45/100 [00:05<00:06,  8.60it/s] 46%|████▌     | 46/100 [00:05<00:06,  8.63it/s] 47%|████▋     | 47/100 [00:05<00:06,  7.88it/s] 48%|████▊     | 48/100 [00:05<00:06,  8.32it/s] 49%|████▉     | 49/100 [00:05<00:06,  8.22it/s] 50%|█████     | 50/100 [00:05<00:05,  8.41it/s] 51%|█████     | 51/100 [00:05<00:05,  8.74it/s] 52%|█████▏    | 52/100 [00:06<00:05,  8.71it/s] 53%|█████▎    | 53/100 [00:06<00:05,  8.71it/s] 54%|█████▍    | 54/100 [00:06<00:05,  8.74it/s] 55%|█████▌    | 55/100 [00:06<00:04,  9.01it/s] 56%|█████▌    | 56/100 [00:06<00:04,  9.10it/s] 57%|█████▋    | 57/100 [00:06<00:04,  9.09it/s] 58%|█████▊    | 58/100 [00:06<00:04,  8.89it/s] 59%|█████▉    | 59/100 [00:06<00:04,  8.80it/s] 60%|██████    | 60/100 [00:06<00:04,  8.96it/s] 61%|██████    | 61/100 [00:07<00:04,  9.16it/s] 62%|██████▏   | 62/100 [00:07<00:04,  9.21it/s] 63%|██████▎   | 63/100 [00:07<00:04,  9.02it/s] 64%|██████▍   | 64/100 [00:07<00:03,  9.01it/s] 65%|██████▌   | 65/100 [00:07<00:03,  8.99it/s] 66%|██████▌   | 66/100 [00:07<00:05,  5.80it/s] 67%|██████▋   | 67/100 [00:07<00:04,  6.61it/s] 68%|██████▊   | 68/100 [00:08<00:04,  7.31it/s] 69%|██████▉   | 69/100 [00:08<00:04,  7.29it/s] 70%|███████   | 70/100 [00:08<00:03,  7.75it/s] 71%|███████   | 71/100 [00:08<00:03,  8.07it/s] 72%|███████▏  | 72/100 [00:08<00:03,  8.26it/s] 73%|███████▎  | 73/100 [00:08<00:03,  8.33it/s] 74%|███████▍  | 74/100 [00:08<00:03,  8.07it/s] 75%|███████▌  | 75/100 [00:08<00:02,  8.42it/s] 76%|███████▌  | 76/100 [00:09<00:02,  8.37it/s] 77%|███████▋  | 77/100 [00:09<00:03,  6.41it/s] 78%|███████▊  | 78/100 [00:09<00:03,  6.93it/s] 79%|███████▉  | 79/100 [00:09<00:03,  6.01it/s] 80%|████████  | 80/100 [00:09<00:04,  4.93it/s] 81%|████████  | 81/100 [00:10<00:03,  5.36it/s] 82%|████████▏ | 82/100 [00:10<00:03,  5.98it/s] 83%|████████▎ | 83/100 [00:10<00:02,  6.42it/s] 84%|████████▍ | 84/100 [00:10<00:02,  6.91it/s] 85%|████████▌ | 85/100 [00:10<00:02,  7.30it/s] 86%|████████▌ | 86/100 [00:10<00:02,  5.17it/s] 87%|████████▋ | 87/100 [00:10<00:02,  5.87it/s] 88%|████████▊ | 88/100 [00:11<00:01,  6.48it/s] 89%|████████▉ | 89/100 [00:11<00:01,  7.06it/s] 90%|█████████ | 90/100 [00:11<00:01,  7.55it/s] 91%|█████████ | 91/100 [00:11<00:01,  6.74it/s] 92%|█████████▏| 92/100 [00:11<00:01,  7.35it/s] 93%|█████████▎| 93/100 [00:11<00:00,  7.44it/s] 94%|█████████▍| 94/100 [00:11<00:00,  7.83it/s] 95%|█████████▌| 95/100 [00:11<00:00,  7.01it/s] 96%|█████████▌| 96/100 [00:12<00:00,  6.83it/s] 97%|█████████▋| 97/100 [00:12<00:00,  7.32it/s] 98%|█████████▊| 98/100 [00:12<00:00,  7.76it/s] 99%|█████████▉| 99/100 [00:12<00:00,  7.08it/s]100%|██████████| 100/100 [00:12<00:00,  7.59it/s]100%|██████████| 100/100 [00:12<00:00,  7.90it/s]
eval_p_index len:  14
individual_train 118
individual_eval 14
train data의 x, y, id 길이: 118 118 118
valid data의 x, y, id 길이: 9 9 9
test data의 x, y, id 길이: 5 5 5
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.769460, Valid_loss 0.710504
Epoch 2, Train Loss 0.759579, Valid_loss 0.707187
Epoch 3, Train Loss 0.752500, Valid_loss 0.705256
Epoch 4, Train Loss 0.749258, Valid_loss 0.704194
Epoch 5, Train Loss 0.742959, Valid_loss 0.702406
Epoch 6, Train Loss 0.743470, Valid_loss 0.701390
Epoch 7, Train Loss 0.744283, Valid_loss 0.700689
Epoch 8, Train Loss 0.739405, Valid_loss 0.700291
Epoch 9, Train Loss 0.736877, Valid_loss 0.700378
Epoch 10, Train Loss 0.736323, Valid_loss 0.699906
Epoch 11, Train Loss 0.732557, Valid_loss 0.699683
Epoch 12, Train Loss 0.732488, Valid_loss 0.699419
Epoch 13, Train Loss 0.731284, Valid_loss 0.699260
Epoch 14, Train Loss 0.726607, Valid_loss 0.698848
Epoch 15, Train Loss 0.725290, Valid_loss 0.698227
Epoch 16, Train Loss 0.723313, Valid_loss 0.693868
Epoch 17, Train Loss 0.714817, Valid_loss 0.687640
Epoch 18, Train Loss 0.702121, Valid_loss 0.684183
Epoch 19, Train Loss 0.692103, Valid_loss 0.682110
Epoch 20, Train Loss 0.684519, Valid_loss 0.680885
Epoch 21, Train Loss 0.676315, Valid_loss 0.676010
Epoch 22, Train Loss 0.662186, Valid_loss 0.672826
Epoch 23, Train Loss 0.652468, Valid_loss 0.672467
Epoch 24, Train Loss 0.645455, Valid_loss 0.673942
Epoch 25, Train Loss 0.633516, Valid_loss 0.675224
Epoch 26, Train Loss 0.628258, Valid_loss 0.676315
Epoch 27, Train Loss 0.626833, Valid_loss 0.677377
Epoch 28, Train Loss 0.617132, Valid_loss 0.678359
Epoch 29, Train Loss 0.616254, Valid_loss 0.679473
Epoch 30, Train Loss 0.615026, Valid_loss 0.680527
Epoch 31, Train Loss 0.619407, Valid_loss 0.681325
Epoch 32, Train Loss 0.607563, Valid_loss 0.682013
Epoch 33, Train Loss 0.609492, Valid_loss 0.682578
Epoch 34, Train Loss 0.608441, Valid_loss 0.682832
Epoch 35, Train Loss 0.598486, Valid_loss 0.682909
Epoch 36, Train Loss 0.590975, Valid_loss 0.683087
Epoch 37, Train Loss 0.595871, Valid_loss 0.683268
Epoch 38, Train Loss 0.585561, Valid_loss 0.682819
Epoch 39, Train Loss 0.584837, Valid_loss 0.682192
Epoch 40, Train Loss 0.588698, Valid_loss 0.680621
Epoch 41, Train Loss 0.576310, Valid_loss 0.677639
Epoch 42, Train Loss 0.574928, Valid_loss 0.672429
Epoch 43, Train Loss 0.581898, Valid_loss 0.662183
Epoch 44, Train Loss 0.567880, Valid_loss 0.632126
Epoch 45, Train Loss 0.544386, Valid_loss 0.584833
Epoch 46, Train Loss 0.538247, Valid_loss 0.568874
Epoch 47, Train Loss 0.516064, Valid_loss 0.566256
Epoch 48, Train Loss 0.510371, Valid_loss 0.561124
Epoch 49, Train Loss 0.516746, Valid_loss 0.553970
Epoch 50, Train Loss 0.504536, Valid_loss 0.549331
Epoch 51, Train Loss 0.499680, Valid_loss 0.547966
Epoch 52, Train Loss 0.494798, Valid_loss 0.545732
Epoch 53, Train Loss 0.492880, Valid_loss 0.543994
Epoch 54, Train Loss 0.496322, Valid_loss 0.543501
Epoch 55, Train Loss 0.483976, Valid_loss 0.542148
Epoch 56, Train Loss 0.481896, Valid_loss 0.540642
Epoch 57, Train Loss 0.482135, Valid_loss 0.539132
Epoch 58, Train Loss 0.484085, Valid_loss 0.538398
Epoch 59, Train Loss 0.484686, Valid_loss 0.536679
Epoch 60, Train Loss 0.479838, Valid_loss 0.535518
Epoch 61, Train Loss 0.485728, Valid_loss 0.534255
Epoch 62, Train Loss 0.478273, Valid_loss 0.533346
Epoch 63, Train Loss 0.471913, Valid_loss 0.532546
Epoch 64, Train Loss 0.476631, Valid_loss 0.531722
Epoch 65, Train Loss 0.475909, Valid_loss 0.529535
Epoch 66, Train Loss 0.470125, Valid_loss 0.528826
Epoch 67, Train Loss 0.471947, Valid_loss 0.528410
Epoch 68, Train Loss 0.474399, Valid_loss 0.526545
Epoch 69, Train Loss 0.466170, Valid_loss 0.526256
Epoch 70, Train Loss 0.465675, Valid_loss 0.524696
Epoch 71, Train Loss 0.466554, Valid_loss 0.523528
Epoch 72, Train Loss 0.461402, Valid_loss 0.522275
Epoch 73, Train Loss 0.461368, Valid_loss 0.519718
Epoch 74, Train Loss 0.469888, Valid_loss 0.520518
Epoch 75, Train Loss 0.465878, Valid_loss 0.517647
Epoch 76, Train Loss 0.468185, Valid_loss 0.516482
Epoch 77, Train Loss 0.455772, Valid_loss 0.516353
Epoch 78, Train Loss 0.460307, Valid_loss 0.513678
Epoch 79, Train Loss 0.462137, Valid_loss 0.512370
Epoch 80, Train Loss 0.454505, Valid_loss 0.512152
Epoch 81, Train Loss 0.455467, Valid_loss 0.510671
Epoch 82, Train Loss 0.457507, Valid_loss 0.510239
Epoch 83, Train Loss 0.453153, Valid_loss 0.510469
Epoch 84, Train Loss 0.461666, Valid_loss 0.509858
Epoch 85, Train Loss 0.448074, Valid_loss 0.508659
Epoch 86, Train Loss 0.451825, Valid_loss 0.508934
Epoch 87, Train Loss 0.450084, Valid_loss 0.508268
Epoch 88, Train Loss 0.452755, Valid_loss 0.507765
Epoch 89, Train Loss 0.447751, Valid_loss 0.507588
Epoch 90, Train Loss 0.454491, Valid_loss 0.506714
Epoch 91, Train Loss 0.445825, Valid_loss 0.506881
Epoch 92, Train Loss 0.452471, Valid_loss 0.506757
Epoch 93, Train Loss 0.450353, Valid_loss 0.505764
Epoch 94, Train Loss 0.442237, Valid_loss 0.504720
Epoch 95, Train Loss 0.448586, Valid_loss 0.505357
Epoch 96, Train Loss 0.448055, Valid_loss 0.504902
Epoch 97, Train Loss 0.453558, Valid_loss 0.503517
Epoch 98, Train Loss 0.445222, Valid_loss 0.502706
Epoch 99, Train Loss 0.448558, Valid_loss 0.504117
Epoch 100, Train Loss 0.446877, Valid_loss 0.501737
COVID19_Participant11 -- true: COVID-19 -- pred: normal
COVID19_Participant25 -- true: COVID-19 -- pred: COVID-19
Control_Participant7 -- true: normal -- pred: normal
Control_Participant7 -- true: normal -- pred: COVID-19
COVID19_Participant26 -- true: COVID-19 -- pred: COVID-19
true :  [1, 1, 0, 0, 1]
pred :  [0, 1, 0, 1, 1]
Confusion Matrix: [1 1 1 2]
Best performance: Epoch 100, Loss 0.446877, Test ACC 0.600000, Test AUC 0.333333, Test Recall 0.666667, Test Precision 0.666667
✅ Total valid splits used: 5

📌 Repeat 1: 평균 AUC = 0.7700, 표준편차 = 0.2676
🔁 Repeat 2, Fold 0
🔍 Split #1
  → train_p_index 환자 수: 26
  → test_p_index 환자 수: 6
  → train 환자 ID: ['COVID19_Participant11', 'COVID19_Participant13', 'COVID19_Participant14', 'COVID19_Participant15', 'COVID19_Participant17', 'COVID19_Participant19', 'COVID19_Participant2', 'COVID19_Participant22', 'COVID19_Participant23', 'COVID19_Participant25', 'COVID19_Participant26', 'COVID19_Participant28', 'COVID19_Participant29', 'COVID19_Participant31', 'COVID19_Participant32', 'COVID19_Participant37', 'COVID19_Participant39', 'COVID19_Participant40', 'COVID19_Participant8', 'Control_Participant1', 'Control_Participant10', 'Control_Participant11', 'Control_Participant15', 'Control_Participant3', 'Control_Participant4', 'Control_Participant7']
  → test  환자 ID: ['COVID19_Participant11', 'COVID19_Participant26', 'Control_Participant7', 'Control_Participant7', 'COVID19_Participant31', 'COVID19_Participant13']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant10, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant4, Label: 0
    ID: Control_Participant7, Label: 0
  → test 환자 ID 및 라벨:
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: Control_Participant7, Label: 1
    ID: Control_Participant7, Label: 0
    ID: COVID19_Participant31, Label: 0
    ID: COVID19_Participant13, Label: 0
train_p_index_ 17
valid_p_index 9
test_p_index 6
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Ciliated Cells', 'Developing Ciliated Cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
data augment 실행 함
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:10,  9.65it/s]  2%|▏         | 2/100 [00:00<00:10,  9.62it/s]  3%|▎         | 3/100 [00:00<00:13,  7.45it/s]  5%|▌         | 5/100 [00:00<00:10,  8.75it/s]  6%|▌         | 6/100 [00:00<00:10,  8.84it/s]  7%|▋         | 7/100 [00:00<00:10,  8.85it/s]  8%|▊         | 8/100 [00:00<00:10,  8.81it/s]  9%|▉         | 9/100 [00:01<00:14,  6.18it/s] 11%|█         | 11/100 [00:01<00:12,  7.00it/s] 12%|█▏        | 12/100 [00:01<00:11,  7.48it/s] 13%|█▎        | 13/100 [00:01<00:12,  7.03it/s] 15%|█▌        | 15/100 [00:01<00:10,  7.96it/s] 17%|█▋        | 17/100 [00:02<00:10,  8.14it/s] 18%|█▊        | 18/100 [00:02<00:09,  8.32it/s] 19%|█▉        | 19/100 [00:02<00:09,  8.53it/s] 20%|██        | 20/100 [00:02<00:10,  7.85it/s] 21%|██        | 21/100 [00:02<00:09,  8.18it/s] 22%|██▏       | 22/100 [00:02<00:09,  8.55it/s] 23%|██▎       | 23/100 [00:02<00:09,  8.41it/s] 24%|██▍       | 24/100 [00:03<00:12,  6.14it/s] 25%|██▌       | 25/100 [00:03<00:12,  6.16it/s] 26%|██▌       | 26/100 [00:03<00:11,  6.20it/s] 27%|██▋       | 27/100 [00:03<00:10,  6.98it/s] 28%|██▊       | 28/100 [00:03<00:09,  7.53it/s] 29%|██▉       | 29/100 [00:03<00:08,  8.01it/s] 30%|███       | 30/100 [00:03<00:09,  7.74it/s] 32%|███▏      | 32/100 [00:04<00:08,  8.17it/s] 33%|███▎      | 33/100 [00:04<00:08,  7.92it/s] 35%|███▌      | 35/100 [00:04<00:07,  8.81it/s] 36%|███▌      | 36/100 [00:04<00:07,  8.87it/s] 37%|███▋      | 37/100 [00:04<00:07,  8.80it/s] 38%|███▊      | 38/100 [00:04<00:06,  8.92it/s] 39%|███▉      | 39/100 [00:04<00:06,  9.10it/s] 40%|████      | 40/100 [00:05<00:09,  6.19it/s] 41%|████      | 41/100 [00:05<00:08,  6.81it/s] 42%|████▏     | 42/100 [00:05<00:07,  7.48it/s] 43%|████▎     | 43/100 [00:05<00:07,  8.00it/s] 44%|████▍     | 44/100 [00:05<00:06,  8.30it/s] 45%|████▌     | 45/100 [00:05<00:06,  8.74it/s] 46%|████▌     | 46/100 [00:05<00:06,  8.36it/s] 47%|████▋     | 47/100 [00:05<00:06,  8.37it/s] 48%|████▊     | 48/100 [00:06<00:07,  7.20it/s] 49%|████▉     | 49/100 [00:06<00:07,  7.23it/s] 51%|█████     | 51/100 [00:06<00:05,  8.40it/s] 52%|█████▏    | 52/100 [00:06<00:06,  7.38it/s] 53%|█████▎    | 53/100 [00:06<00:06,  7.74it/s] 54%|█████▍    | 54/100 [00:06<00:05,  8.09it/s] 56%|█████▌    | 56/100 [00:07<00:04,  8.96it/s] 57%|█████▋    | 57/100 [00:07<00:05,  8.15it/s] 58%|█████▊    | 58/100 [00:07<00:05,  7.51it/s] 59%|█████▉    | 59/100 [00:07<00:05,  7.86it/s] 60%|██████    | 60/100 [00:07<00:04,  8.18it/s] 61%|██████    | 61/100 [00:07<00:04,  8.27it/s] 62%|██████▏   | 62/100 [00:07<00:04,  8.63it/s] 63%|██████▎   | 63/100 [00:08<00:05,  6.58it/s] 64%|██████▍   | 64/100 [00:08<00:05,  7.19it/s] 66%|██████▌   | 66/100 [00:08<00:04,  8.31it/s] 68%|██████▊   | 68/100 [00:08<00:04,  7.13it/s] 69%|██████▉   | 69/100 [00:08<00:04,  7.55it/s] 70%|███████   | 70/100 [00:09<00:04,  7.04it/s] 71%|███████   | 71/100 [00:09<00:03,  7.54it/s] 72%|███████▏  | 72/100 [00:09<00:04,  6.61it/s] 73%|███████▎  | 73/100 [00:09<00:03,  7.07it/s] 74%|███████▍  | 74/100 [00:09<00:03,  7.37it/s] 76%|███████▌  | 76/100 [00:09<00:02,  8.23it/s] 77%|███████▋  | 77/100 [00:09<00:02,  8.60it/s] 78%|███████▊  | 78/100 [00:09<00:02,  8.31it/s] 79%|███████▉  | 79/100 [00:10<00:02,  7.87it/s] 80%|████████  | 80/100 [00:10<00:02,  8.20it/s] 81%|████████  | 81/100 [00:10<00:02,  8.32it/s] 82%|████████▏ | 82/100 [00:10<00:02,  8.39it/s] 83%|████████▎ | 83/100 [00:10<00:01,  8.58it/s] 84%|████████▍ | 84/100 [00:10<00:02,  7.18it/s] 85%|████████▌ | 85/100 [00:10<00:02,  7.41it/s] 86%|████████▌ | 86/100 [00:11<00:02,  5.08it/s] 88%|████████▊ | 88/100 [00:11<00:01,  6.50it/s] 89%|████████▉ | 89/100 [00:11<00:01,  6.88it/s] 90%|█████████ | 90/100 [00:11<00:01,  7.41it/s] 91%|█████████ | 91/100 [00:11<00:01,  7.94it/s] 92%|█████████▏| 92/100 [00:11<00:00,  8.29it/s] 93%|█████████▎| 93/100 [00:11<00:00,  8.62it/s] 94%|█████████▍| 94/100 [00:12<00:00,  8.69it/s] 95%|█████████▌| 95/100 [00:12<00:00,  8.26it/s] 97%|█████████▋| 97/100 [00:12<00:00,  8.63it/s] 98%|█████████▊| 98/100 [00:12<00:00,  8.93it/s] 99%|█████████▉| 99/100 [00:12<00:00,  9.16it/s]100%|██████████| 100/100 [00:12<00:00,  9.29it/s]100%|██████████| 100/100 [00:12<00:00,  7.83it/s]
eval_p_index len:  15
individual_train 117
individual_eval 15
train data의 x, y, id 길이: 117 117 117
valid data의 x, y, id 길이: 9 9 9
test data의 x, y, id 길이: 6 6 6
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.633375, Valid_loss 0.687457
Epoch 2, Train Loss 0.630519, Valid_loss 0.686389
Epoch 3, Train Loss 0.620247, Valid_loss 0.686550
Epoch 4, Train Loss 0.618848, Valid_loss 0.684905
Epoch 5, Train Loss 0.615945, Valid_loss 0.682500
Epoch 6, Train Loss 0.608927, Valid_loss 0.676767
Epoch 7, Train Loss 0.608915, Valid_loss 0.673116
Epoch 8, Train Loss 0.599695, Valid_loss 0.667271
Epoch 9, Train Loss 0.598057, Valid_loss 0.664105
Epoch 10, Train Loss 0.596312, Valid_loss 0.658779
Epoch 11, Train Loss 0.592198, Valid_loss 0.654250
Epoch 12, Train Loss 0.591517, Valid_loss 0.650353
Epoch 13, Train Loss 0.582418, Valid_loss 0.646008
Epoch 14, Train Loss 0.580945, Valid_loss 0.642285
Epoch 15, Train Loss 0.576231, Valid_loss 0.638717
Epoch 16, Train Loss 0.577991, Valid_loss 0.635038
Epoch 17, Train Loss 0.568826, Valid_loss 0.630948
Epoch 18, Train Loss 0.569272, Valid_loss 0.627912
Epoch 19, Train Loss 0.570514, Valid_loss 0.624677
Epoch 20, Train Loss 0.567326, Valid_loss 0.622123
Epoch 21, Train Loss 0.560726, Valid_loss 0.621796
Epoch 22, Train Loss 0.558466, Valid_loss 0.618236
Epoch 23, Train Loss 0.556349, Valid_loss 0.614132
Epoch 24, Train Loss 0.556118, Valid_loss 0.612483
Epoch 25, Train Loss 0.555462, Valid_loss 0.609276
Epoch 26, Train Loss 0.555066, Valid_loss 0.609291
Epoch 27, Train Loss 0.553256, Valid_loss 0.604134
Epoch 28, Train Loss 0.545011, Valid_loss 0.598785
Epoch 29, Train Loss 0.545668, Valid_loss 0.594451
Epoch 30, Train Loss 0.539773, Valid_loss 0.590222
Epoch 31, Train Loss 0.539104, Valid_loss 0.582717
Epoch 32, Train Loss 0.538795, Valid_loss 0.581045
Epoch 33, Train Loss 0.542831, Valid_loss 0.569850
Epoch 34, Train Loss 0.532409, Valid_loss 0.568782
Epoch 35, Train Loss 0.528074, Valid_loss 0.563608
Epoch 36, Train Loss 0.529251, Valid_loss 0.560782
Epoch 37, Train Loss 0.531548, Valid_loss 0.555385
Epoch 38, Train Loss 0.527740, Valid_loss 0.557688
Epoch 39, Train Loss 0.520184, Valid_loss 0.552771
Epoch 40, Train Loss 0.520295, Valid_loss 0.549283
Epoch 41, Train Loss 0.522840, Valid_loss 0.548081
Epoch 42, Train Loss 0.518615, Valid_loss 0.546429
Epoch 43, Train Loss 0.522388, Valid_loss 0.550719
Epoch 44, Train Loss 0.514864, Valid_loss 0.546718
Epoch 45, Train Loss 0.509009, Valid_loss 0.546502
Epoch 46, Train Loss 0.505623, Valid_loss 0.546199
Epoch 47, Train Loss 0.502790, Valid_loss 0.536625
Epoch 48, Train Loss 0.504121, Valid_loss 0.544089
Epoch 49, Train Loss 0.505828, Valid_loss 0.539684
Epoch 50, Train Loss 0.504870, Valid_loss 0.542500
Epoch 51, Train Loss 0.501726, Valid_loss 0.538310
Epoch 52, Train Loss 0.497251, Valid_loss 0.538881
Epoch 53, Train Loss 0.499992, Valid_loss 0.536877
Epoch 54, Train Loss 0.500520, Valid_loss 0.537650
Epoch 55, Train Loss 0.495329, Valid_loss 0.536775
Epoch 56, Train Loss 0.492691, Valid_loss 0.534800
Epoch 57, Train Loss 0.501355, Valid_loss 0.536181
Epoch 58, Train Loss 0.497041, Valid_loss 0.533769
Epoch 59, Train Loss 0.488821, Valid_loss 0.535320
Epoch 60, Train Loss 0.498331, Valid_loss 0.533935
Epoch 61, Train Loss 0.497512, Valid_loss 0.532294
Epoch 62, Train Loss 0.498177, Valid_loss 0.532409
Epoch 63, Train Loss 0.492390, Valid_loss 0.530381
Epoch 64, Train Loss 0.490017, Valid_loss 0.532527
Epoch 65, Train Loss 0.488933, Valid_loss 0.530162
Epoch 66, Train Loss 0.487176, Valid_loss 0.531155
Epoch 67, Train Loss 0.487704, Valid_loss 0.527363
Epoch 68, Train Loss 0.483616, Valid_loss 0.530688
Epoch 69, Train Loss 0.491405, Valid_loss 0.531049
COVID19_Participant11 -- true: COVID-19 -- pred: normal
COVID19_Participant26 -- true: COVID-19 -- pred: COVID-19
Control_Participant7 -- true: normal -- pred: normal
Control_Participant7 -- true: normal -- pred: normal
COVID19_Participant31 -- true: COVID-19 -- pred: COVID-19
COVID19_Participant13 -- true: COVID-19 -- pred: COVID-19
true :  [1, 1, 0, 0, 1, 1]
pred :  [0, 1, 0, 0, 1, 1]
Confusion Matrix: [2 0 1 3]
Best performance: Epoch 67, Loss 0.487704, Test ACC 0.833333, Test AUC 0.875000, Test Recall 0.750000, Test Precision 1.000000
✅ Total valid splits used: 1
🔁 Repeat 2, Fold 1
🔍 Split #2
  → train_p_index 환자 수: 26
  → test_p_index 환자 수: 6
  → train 환자 ID: ['COVID19_Participant11', 'COVID19_Participant13', 'COVID19_Participant14', 'COVID19_Participant15', 'COVID19_Participant17', 'COVID19_Participant19', 'COVID19_Participant2', 'COVID19_Participant20', 'COVID19_Participant22', 'COVID19_Participant25', 'COVID19_Participant28', 'COVID19_Participant29', 'COVID19_Participant31', 'COVID19_Participant32', 'COVID19_Participant39', 'COVID19_Participant4', 'COVID19_Participant40', 'COVID19_Participant7', 'Control_Participant1', 'Control_Participant10', 'Control_Participant11', 'Control_Participant15', 'Control_Participant5', 'Control_Participant7', 'Control_Participant8', 'Control_Participant9']
  → test  환자 ID: ['COVID19_Participant19', 'Control_Participant7', 'COVID19_Participant11', 'Control_Participant5', 'COVID19_Participant13', 'COVID19_Participant13']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant10, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant8, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: COVID19_Participant19, Label: 1
    ID: Control_Participant7, Label: 1
    ID: COVID19_Participant11, Label: 1
    ID: Control_Participant5, Label: 1
    ID: COVID19_Participant13, Label: 0
    ID: COVID19_Participant13, Label: 0
train_p_index_ 17
valid_p_index 9
test_p_index 6
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Ciliated Cells', 'Developing Ciliated Cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
data augment 실행 함
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  2%|▏         | 2/100 [00:00<00:10,  9.66it/s]  4%|▍         | 4/100 [00:00<00:09, 10.48it/s]  6%|▌         | 6/100 [00:00<00:10,  9.22it/s]  8%|▊         | 8/100 [00:00<00:09,  9.73it/s] 10%|█         | 10/100 [00:01<00:08, 10.17it/s] 12%|█▏        | 12/100 [00:01<00:08, 10.31it/s] 14%|█▍        | 14/100 [00:01<00:09,  9.08it/s] 16%|█▌        | 16/100 [00:01<00:08,  9.50it/s] 18%|█▊        | 18/100 [00:01<00:08,  9.86it/s] 20%|██        | 20/100 [00:02<00:07, 10.22it/s] 22%|██▏       | 22/100 [00:02<00:07, 10.39it/s] 24%|██▍       | 24/100 [00:02<00:07, 10.31it/s] 26%|██▌       | 26/100 [00:02<00:07, 10.47it/s] 28%|██▊       | 28/100 [00:02<00:08,  8.40it/s] 29%|██▉       | 29/100 [00:03<00:08,  8.34it/s] 31%|███       | 31/100 [00:03<00:07,  8.77it/s] 32%|███▏      | 32/100 [00:03<00:08,  8.41it/s] 33%|███▎      | 33/100 [00:03<00:07,  8.67it/s] 34%|███▍      | 34/100 [00:03<00:07,  8.47it/s] 36%|███▌      | 36/100 [00:03<00:07,  8.97it/s] 38%|███▊      | 38/100 [00:04<00:07,  8.82it/s] 39%|███▉      | 39/100 [00:04<00:06,  8.95it/s] 40%|████      | 40/100 [00:04<00:06,  9.12it/s] 41%|████      | 41/100 [00:04<00:06,  9.16it/s] 43%|████▎     | 43/100 [00:04<00:05,  9.89it/s] 44%|████▍     | 44/100 [00:04<00:05,  9.89it/s] 46%|████▌     | 46/100 [00:04<00:05, 10.15it/s] 48%|████▊     | 48/100 [00:05<00:05,  9.39it/s] 50%|█████     | 50/100 [00:05<00:05,  9.59it/s] 51%|█████     | 51/100 [00:05<00:05,  9.34it/s] 52%|█████▏    | 52/100 [00:05<00:05,  8.97it/s] 53%|█████▎    | 53/100 [00:05<00:05,  9.11it/s] 54%|█████▍    | 54/100 [00:05<00:05,  9.04it/s] 55%|█████▌    | 55/100 [00:05<00:05,  8.31it/s] 57%|█████▋    | 57/100 [00:06<00:07,  5.98it/s] 58%|█████▊    | 58/100 [00:06<00:06,  6.50it/s] 59%|█████▉    | 59/100 [00:06<00:05,  7.12it/s] 60%|██████    | 60/100 [00:06<00:05,  7.60it/s] 61%|██████    | 61/100 [00:06<00:05,  7.40it/s] 62%|██████▏   | 62/100 [00:06<00:04,  7.91it/s] 64%|██████▍   | 64/100 [00:07<00:04,  8.96it/s] 65%|██████▌   | 65/100 [00:07<00:03,  9.07it/s] 66%|██████▌   | 66/100 [00:07<00:03,  8.74it/s] 67%|██████▋   | 67/100 [00:07<00:03,  8.38it/s] 68%|██████▊   | 68/100 [00:07<00:05,  5.82it/s] 70%|███████   | 70/100 [00:08<00:04,  6.89it/s] 72%|███████▏  | 72/100 [00:08<00:03,  7.18it/s] 73%|███████▎  | 73/100 [00:08<00:03,  7.15it/s] 75%|███████▌  | 75/100 [00:08<00:03,  8.11it/s] 76%|███████▌  | 76/100 [00:08<00:03,  7.47it/s] 78%|███████▊  | 78/100 [00:08<00:02,  8.44it/s] 79%|███████▉  | 79/100 [00:09<00:02,  8.69it/s] 80%|████████  | 80/100 [00:09<00:02,  8.87it/s] 82%|████████▏ | 82/100 [00:09<00:01,  9.42it/s] 83%|████████▎ | 83/100 [00:09<00:01,  9.46it/s] 84%|████████▍ | 84/100 [00:09<00:01,  9.38it/s] 86%|████████▌ | 86/100 [00:09<00:01,  9.53it/s] 87%|████████▋ | 87/100 [00:09<00:01,  9.13it/s] 88%|████████▊ | 88/100 [00:10<00:01,  9.18it/s] 89%|████████▉ | 89/100 [00:10<00:01,  9.28it/s] 90%|█████████ | 90/100 [00:10<00:01,  9.34it/s] 92%|█████████▏| 92/100 [00:10<00:00,  9.76it/s] 94%|█████████▍| 94/100 [00:10<00:00, 10.05it/s] 95%|█████████▌| 95/100 [00:10<00:00,  9.25it/s] 97%|█████████▋| 97/100 [00:11<00:00,  7.19it/s] 98%|█████████▊| 98/100 [00:11<00:00,  7.53it/s] 99%|█████████▉| 99/100 [00:11<00:00,  7.69it/s]100%|██████████| 100/100 [00:11<00:00,  7.62it/s]100%|██████████| 100/100 [00:11<00:00,  8.70it/s]
eval_p_index len:  15
individual_train 117
individual_eval 15
train data의 x, y, id 길이: 117 117 117
valid data의 x, y, id 길이: 9 9 9
test data의 x, y, id 길이: 6 6 6
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.675362, Valid_loss 0.713321
Epoch 2, Train Loss 0.633719, Valid_loss 0.724233
Epoch 3, Train Loss 0.590813, Valid_loss 0.744756
Epoch 4, Train Loss 0.551657, Valid_loss 0.770933
Epoch 5, Train Loss 0.555237, Valid_loss 0.780255
Epoch 6, Train Loss 0.553918, Valid_loss 0.780014
Epoch 7, Train Loss 0.536774, Valid_loss 0.774393
Epoch 8, Train Loss 0.524629, Valid_loss 0.770434
Epoch 9, Train Loss 0.527533, Valid_loss 0.768579
Epoch 10, Train Loss 0.529481, Valid_loss 0.757504
Epoch 11, Train Loss 0.518835, Valid_loss 0.754161
Epoch 12, Train Loss 0.507769, Valid_loss 0.756109
Epoch 13, Train Loss 0.501800, Valid_loss 0.751639
Epoch 14, Train Loss 0.498935, Valid_loss 0.745763
Epoch 15, Train Loss 0.504531, Valid_loss 0.741574
Epoch 16, Train Loss 0.490699, Valid_loss 0.731836
Epoch 17, Train Loss 0.503834, Valid_loss 0.723526
Epoch 18, Train Loss 0.477027, Valid_loss 0.702474
Epoch 19, Train Loss 0.478677, Valid_loss 0.707596
Epoch 20, Train Loss 0.462038, Valid_loss 0.698788
Epoch 21, Train Loss 0.462517, Valid_loss 0.696641
Epoch 22, Train Loss 0.457450, Valid_loss 0.706231
Epoch 23, Train Loss 0.460016, Valid_loss 0.695353
Epoch 24, Train Loss 0.448211, Valid_loss 0.709210
Epoch 25, Train Loss 0.452561, Valid_loss 0.689314
Epoch 26, Train Loss 0.453438, Valid_loss 0.698955
Epoch 27, Train Loss 0.433609, Valid_loss 0.709374
Epoch 28, Train Loss 0.429925, Valid_loss 0.683602
Epoch 29, Train Loss 0.432559, Valid_loss 0.699014
Epoch 30, Train Loss 0.437455, Valid_loss 0.688089
Epoch 31, Train Loss 0.420497, Valid_loss 0.693557
Epoch 32, Train Loss 0.417713, Valid_loss 0.699324
Epoch 33, Train Loss 0.419875, Valid_loss 0.700592
Epoch 34, Train Loss 0.416168, Valid_loss 0.702130
Epoch 35, Train Loss 0.412758, Valid_loss 0.709283
Epoch 36, Train Loss 0.413544, Valid_loss 0.701658
Epoch 37, Train Loss 0.418491, Valid_loss 0.716353
Epoch 38, Train Loss 0.410843, Valid_loss 0.706897
Epoch 39, Train Loss 0.407737, Valid_loss 0.724009
Epoch 40, Train Loss 0.419675, Valid_loss 0.707072
Epoch 41, Train Loss 0.395287, Valid_loss 0.730722
Epoch 42, Train Loss 0.408282, Valid_loss 0.728983
Epoch 43, Train Loss 0.399303, Valid_loss 0.729373
Epoch 44, Train Loss 0.405273, Valid_loss 0.732027
Epoch 45, Train Loss 0.410105, Valid_loss 0.730850
Epoch 46, Train Loss 0.386601, Valid_loss 0.732757
Epoch 47, Train Loss 0.408917, Valid_loss 0.729548
Epoch 48, Train Loss 0.400251, Valid_loss 0.743061
Epoch 49, Train Loss 0.391603, Valid_loss 0.726416
Epoch 50, Train Loss 0.382079, Valid_loss 0.740245
Epoch 51, Train Loss 0.392723, Valid_loss 0.740772
Epoch 52, Train Loss 0.385010, Valid_loss 0.739476
Epoch 53, Train Loss 0.393470, Valid_loss 0.738543
Epoch 54, Train Loss 0.390904, Valid_loss 0.746539
Epoch 55, Train Loss 0.396145, Valid_loss 0.741409
Epoch 56, Train Loss 0.389547, Valid_loss 0.738349
Epoch 57, Train Loss 0.392127, Valid_loss 0.747062
Epoch 58, Train Loss 0.393340, Valid_loss 0.739517
Epoch 59, Train Loss 0.397685, Valid_loss 0.742141
Epoch 60, Train Loss 0.400784, Valid_loss 0.743022
COVID19_Participant19 -- true: COVID-19 -- pred: COVID-19
Control_Participant7 -- true: normal -- pred: COVID-19
COVID19_Participant11 -- true: COVID-19 -- pred: COVID-19
Control_Participant5 -- true: normal -- pred: normal
COVID19_Participant13 -- true: COVID-19 -- pred: COVID-19
COVID19_Participant13 -- true: COVID-19 -- pred: COVID-19
true :  [1, 0, 1, 0, 1, 1]
pred :  [1, 1, 1, 0, 1, 1]
Confusion Matrix: [1 1 0 4]
Best performance: Epoch 28, Loss 0.429925, Test ACC 0.833333, Test AUC 1.000000, Test Recall 1.000000, Test Precision 0.800000
✅ Total valid splits used: 2
🔁 Repeat 2, Fold 2
🔍 Split #3
  → train_p_index 환자 수: 27
  → test_p_index 환자 수: 5
  → train 환자 ID: ['COVID19_Participant11', 'COVID19_Participant13', 'COVID19_Participant14', 'COVID19_Participant19', 'COVID19_Participant2', 'COVID19_Participant20', 'COVID19_Participant23', 'COVID19_Participant25', 'COVID19_Participant26', 'COVID19_Participant29', 'COVID19_Participant31', 'COVID19_Participant37', 'COVID19_Participant39', 'COVID19_Participant4', 'COVID19_Participant40', 'COVID19_Participant7', 'COVID19_Participant8', 'Control_Participant1', 'Control_Participant10', 'Control_Participant11', 'Control_Participant15', 'Control_Participant3', 'Control_Participant4', 'Control_Participant5', 'Control_Participant7', 'Control_Participant8', 'Control_Participant9']
  → test  환자 ID: ['Control_Participant5', 'COVID19_Participant13', 'COVID19_Participant5', 'Control_Participant7', 'Control_Participant4']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant10, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant4, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant8, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: Control_Participant5, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant5, Label: 1
    ID: Control_Participant7, Label: 1
    ID: Control_Participant4, Label: 1
train_p_index_ 18
valid_p_index 9
test_p_index 5
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Ciliated Cells', 'Developing Ciliated Cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
data augment 실행 함
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:10,  9.17it/s]  2%|▏         | 2/100 [00:00<00:10,  9.47it/s]  4%|▍         | 4/100 [00:00<00:09,  9.94it/s]  5%|▌         | 5/100 [00:00<00:09,  9.79it/s]  6%|▌         | 6/100 [00:00<00:09,  9.62it/s]  7%|▋         | 7/100 [00:00<00:09,  9.51it/s]  8%|▊         | 8/100 [00:00<00:09,  9.58it/s] 10%|█         | 10/100 [00:01<00:09,  9.70it/s] 11%|█         | 11/100 [00:01<00:09,  9.59it/s] 12%|█▏        | 12/100 [00:01<00:09,  9.30it/s] 13%|█▎        | 13/100 [00:01<00:09,  9.35it/s] 14%|█▍        | 14/100 [00:01<00:10,  7.84it/s] 15%|█▌        | 15/100 [00:01<00:11,  7.52it/s] 16%|█▌        | 16/100 [00:01<00:10,  7.98it/s] 17%|█▋        | 17/100 [00:01<00:10,  7.65it/s] 19%|█▉        | 19/100 [00:02<00:09,  8.31it/s] 20%|██        | 20/100 [00:02<00:11,  6.90it/s] 21%|██        | 21/100 [00:02<00:10,  7.42it/s] 22%|██▏       | 22/100 [00:02<00:10,  7.37it/s] 23%|██▎       | 23/100 [00:02<00:10,  7.40it/s] 24%|██▍       | 24/100 [00:02<00:09,  7.87it/s] 25%|██▌       | 25/100 [00:02<00:09,  8.27it/s] 26%|██▌       | 26/100 [00:03<00:08,  8.42it/s] 27%|██▋       | 27/100 [00:03<00:08,  8.61it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.78it/s] 30%|███       | 30/100 [00:03<00:07,  9.20it/s] 31%|███       | 31/100 [00:03<00:09,  7.19it/s] 32%|███▏      | 32/100 [00:03<00:08,  7.61it/s] 33%|███▎      | 33/100 [00:03<00:08,  8.03it/s] 34%|███▍      | 34/100 [00:04<00:08,  8.15it/s] 35%|███▌      | 35/100 [00:04<00:07,  8.33it/s] 36%|███▌      | 36/100 [00:04<00:07,  8.49it/s] 37%|███▋      | 37/100 [00:04<00:07,  8.71it/s] 38%|███▊      | 38/100 [00:04<00:07,  8.63it/s] 39%|███▉      | 39/100 [00:04<00:06,  8.89it/s] 40%|████      | 40/100 [00:04<00:06,  9.00it/s] 41%|████      | 41/100 [00:04<00:06,  9.17it/s] 42%|████▏     | 42/100 [00:04<00:06,  9.09it/s] 43%|████▎     | 43/100 [00:05<00:06,  8.69it/s] 44%|████▍     | 44/100 [00:05<00:06,  8.87it/s] 45%|████▌     | 45/100 [00:05<00:06,  8.46it/s] 46%|████▌     | 46/100 [00:05<00:07,  7.20it/s] 47%|████▋     | 47/100 [00:05<00:07,  6.74it/s] 48%|████▊     | 48/100 [00:05<00:07,  7.18it/s] 49%|████▉     | 49/100 [00:05<00:06,  7.57it/s] 50%|█████     | 50/100 [00:06<00:06,  8.00it/s] 51%|█████     | 51/100 [00:06<00:05,  8.20it/s] 52%|█████▏    | 52/100 [00:06<00:05,  8.49it/s] 53%|█████▎    | 53/100 [00:06<00:05,  8.47it/s] 54%|█████▍    | 54/100 [00:06<00:05,  8.70it/s] 55%|█████▌    | 55/100 [00:06<00:05,  8.74it/s] 56%|█████▌    | 56/100 [00:06<00:04,  8.92it/s] 57%|█████▋    | 57/100 [00:06<00:04,  9.06it/s] 58%|█████▊    | 58/100 [00:06<00:04,  9.24it/s] 59%|█████▉    | 59/100 [00:07<00:04,  9.02it/s] 60%|██████    | 60/100 [00:07<00:04,  8.97it/s] 61%|██████    | 61/100 [00:07<00:04,  9.06it/s] 62%|██████▏   | 62/100 [00:07<00:04,  8.32it/s] 63%|██████▎   | 63/100 [00:07<00:04,  8.74it/s] 64%|██████▍   | 64/100 [00:07<00:04,  7.86it/s] 65%|██████▌   | 65/100 [00:07<00:04,  8.30it/s] 66%|██████▌   | 66/100 [00:07<00:04,  8.19it/s] 67%|██████▋   | 67/100 [00:07<00:03,  8.53it/s] 68%|██████▊   | 68/100 [00:08<00:03,  8.66it/s] 69%|██████▉   | 69/100 [00:08<00:03,  7.99it/s] 70%|███████   | 70/100 [00:08<00:03,  7.77it/s] 71%|███████   | 71/100 [00:08<00:04,  7.11it/s] 72%|███████▏  | 72/100 [00:08<00:03,  7.53it/s] 73%|███████▎  | 73/100 [00:08<00:03,  8.03it/s] 74%|███████▍  | 74/100 [00:08<00:03,  8.22it/s] 75%|███████▌  | 75/100 [00:08<00:02,  8.45it/s] 76%|███████▌  | 76/100 [00:09<00:03,  7.00it/s] 77%|███████▋  | 77/100 [00:09<00:03,  7.49it/s] 78%|███████▊  | 78/100 [00:09<00:03,  6.32it/s] 79%|███████▉  | 79/100 [00:09<00:03,  6.93it/s] 80%|████████  | 80/100 [00:09<00:02,  7.36it/s] 81%|████████  | 81/100 [00:09<00:03,  5.89it/s] 82%|████████▏ | 82/100 [00:10<00:02,  6.44it/s] 83%|████████▎ | 83/100 [00:10<00:02,  6.71it/s] 84%|████████▍ | 84/100 [00:10<00:02,  7.22it/s] 85%|████████▌ | 85/100 [00:10<00:02,  7.49it/s] 86%|████████▌ | 86/100 [00:10<00:01,  7.58it/s] 87%|████████▋ | 87/100 [00:10<00:01,  7.89it/s] 88%|████████▊ | 88/100 [00:10<00:01,  8.34it/s] 89%|████████▉ | 89/100 [00:10<00:01,  8.52it/s] 90%|█████████ | 90/100 [00:11<00:01,  8.55it/s] 91%|█████████ | 91/100 [00:11<00:01,  8.07it/s] 92%|█████████▏| 92/100 [00:11<00:00,  8.12it/s] 93%|█████████▎| 93/100 [00:11<00:00,  8.33it/s] 94%|█████████▍| 94/100 [00:11<00:00,  7.45it/s] 95%|█████████▌| 95/100 [00:11<00:00,  7.83it/s] 96%|█████████▌| 96/100 [00:11<00:00,  8.16it/s] 97%|█████████▋| 97/100 [00:11<00:00,  8.41it/s] 98%|█████████▊| 98/100 [00:12<00:00,  8.28it/s] 99%|█████████▉| 99/100 [00:12<00:00,  8.37it/s]100%|██████████| 100/100 [00:12<00:00,  8.45it/s]100%|██████████| 100/100 [00:12<00:00,  8.14it/s]
eval_p_index len:  14
individual_train 118
individual_eval 14
train data의 x, y, id 길이: 118 118 118
valid data의 x, y, id 길이: 9 9 9
test data의 x, y, id 길이: 5 5 5
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.682853, Valid_loss 0.704546
Epoch 2, Train Loss 0.656186, Valid_loss 0.695321
Epoch 3, Train Loss 0.667060, Valid_loss 0.686734
Epoch 4, Train Loss 0.669251, Valid_loss 0.678619
Epoch 5, Train Loss 0.638233, Valid_loss 0.672452
Epoch 6, Train Loss 0.637571, Valid_loss 0.648474
Epoch 7, Train Loss 0.614809, Valid_loss 0.634293
Epoch 8, Train Loss 0.592470, Valid_loss 0.613430
Epoch 9, Train Loss 0.548117, Valid_loss 0.554636
Epoch 10, Train Loss 0.527232, Valid_loss 0.546881
Epoch 11, Train Loss 0.504362, Valid_loss 0.523540
Epoch 12, Train Loss 0.495278, Valid_loss 0.515966
Epoch 13, Train Loss 0.487683, Valid_loss 0.509299
Epoch 14, Train Loss 0.477890, Valid_loss 0.502901
Epoch 15, Train Loss 0.471577, Valid_loss 0.487002
Epoch 16, Train Loss 0.468225, Valid_loss 0.475945
Epoch 17, Train Loss 0.463535, Valid_loss 0.470590
Epoch 18, Train Loss 0.461841, Valid_loss 0.468447
Epoch 19, Train Loss 0.450775, Valid_loss 0.456088
Epoch 20, Train Loss 0.446979, Valid_loss 0.449585
Epoch 21, Train Loss 0.451411, Valid_loss 0.449860
Epoch 22, Train Loss 0.444581, Valid_loss 0.448621
Epoch 23, Train Loss 0.451502, Valid_loss 0.443420
Epoch 24, Train Loss 0.434367, Valid_loss 0.442484
Epoch 25, Train Loss 0.429281, Valid_loss 0.440623
Epoch 26, Train Loss 0.441009, Valid_loss 0.438438
Epoch 27, Train Loss 0.439312, Valid_loss 0.439228
Epoch 28, Train Loss 0.449159, Valid_loss 0.439261
Epoch 29, Train Loss 0.431341, Valid_loss 0.430148
Epoch 30, Train Loss 0.432126, Valid_loss 0.441366
Epoch 31, Train Loss 0.429957, Valid_loss 0.429720
Epoch 32, Train Loss 0.422345, Valid_loss 0.431182
Epoch 33, Train Loss 0.424084, Valid_loss 0.433920
Epoch 34, Train Loss 0.427062, Valid_loss 0.425537
Epoch 35, Train Loss 0.429603, Valid_loss 0.428902
Epoch 36, Train Loss 0.421057, Valid_loss 0.428303
Epoch 37, Train Loss 0.424667, Valid_loss 0.431042
Epoch 38, Train Loss 0.430000, Valid_loss 0.428182
Epoch 39, Train Loss 0.403296, Valid_loss 0.428572
Epoch 40, Train Loss 0.424992, Valid_loss 0.428937
Epoch 41, Train Loss 0.428104, Valid_loss 0.425003
Epoch 42, Train Loss 0.418939, Valid_loss 0.428848
Epoch 43, Train Loss 0.421604, Valid_loss 0.422424
Epoch 44, Train Loss 0.407879, Valid_loss 0.426180
Epoch 45, Train Loss 0.423231, Valid_loss 0.424463
Epoch 46, Train Loss 0.409544, Valid_loss 0.421881
Epoch 47, Train Loss 0.410171, Valid_loss 0.426280
Epoch 48, Train Loss 0.406294, Valid_loss 0.424600
Epoch 49, Train Loss 0.405955, Valid_loss 0.422187
Epoch 50, Train Loss 0.415409, Valid_loss 0.422302
Epoch 51, Train Loss 0.410864, Valid_loss 0.421984
Epoch 52, Train Loss 0.415535, Valid_loss 0.420378
Epoch 53, Train Loss 0.403545, Valid_loss 0.423789
Epoch 54, Train Loss 0.416453, Valid_loss 0.424310
Control_Participant5 -- true: normal -- pred: normal
COVID19_Participant13 -- true: COVID-19 -- pred: COVID-19
COVID19_Participant5 -- true: COVID-19 -- pred: COVID-19
Control_Participant7 -- true: normal -- pred: COVID-19
Control_Participant4 -- true: normal -- pred: COVID-19
true :  [0, 1, 1, 0, 0]
pred :  [0, 1, 1, 1, 1]
Confusion Matrix: [1 2 0 2]
Best performance: Epoch 52, Loss 0.415535, Test ACC 0.600000, Test AUC 1.000000, Test Recall 1.000000, Test Precision 0.500000
✅ Total valid splits used: 3
🔁 Repeat 2, Fold 3
🔍 Split #4
  → train_p_index 환자 수: 23
  → test_p_index 환자 수: 9
  → train 환자 ID: ['COVID19_Participant13', 'COVID19_Participant15', 'COVID19_Participant17', 'COVID19_Participant20', 'COVID19_Participant22', 'COVID19_Participant23', 'COVID19_Participant26', 'COVID19_Participant28', 'COVID19_Participant29', 'COVID19_Participant32', 'COVID19_Participant37', 'COVID19_Participant39', 'COVID19_Participant4', 'COVID19_Participant40', 'COVID19_Participant7', 'COVID19_Participant8', 'Control_Participant11', 'Control_Participant15', 'Control_Participant3', 'Control_Participant4', 'Control_Participant5', 'Control_Participant8', 'Control_Participant9']
  → test  환자 ID: ['COVID19_Participant26', 'Control_Participant3', 'COVID19_Participant7', 'Control_Participant9', 'COVID19_Participant26', 'Control_Participant12', 'Control_Participant4', 'Control_Participant5', 'COVID19_Participant13']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: Control_Participant11, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant4, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant8, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: COVID19_Participant26, Label: 1
    ID: Control_Participant3, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: Control_Participant9, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: Control_Participant12, Label: 1
    ID: Control_Participant4, Label: 0
    ID: Control_Participant5, Label: 0
    ID: COVID19_Participant13, Label: 0
train_p_index_ 15
valid_p_index 8
test_p_index 9
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Squamous Cells', 'Secretory Cells', 'Macrophages', 'Developing Ciliated Cells', 'B Cells', 'Ciliated Cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
data augment 실행 함
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  2%|▏         | 2/100 [00:00<00:11,  8.54it/s]  4%|▍         | 4/100 [00:00<00:10,  9.20it/s]  5%|▌         | 5/100 [00:00<00:10,  9.06it/s]  7%|▋         | 7/100 [00:00<00:09,  9.94it/s]  8%|▊         | 8/100 [00:00<00:09,  9.73it/s] 10%|█         | 10/100 [00:01<00:08, 10.07it/s] 12%|█▏        | 12/100 [00:01<00:08,  9.92it/s] 14%|█▍        | 14/100 [00:01<00:08,  9.81it/s] 15%|█▌        | 15/100 [00:01<00:08,  9.68it/s] 16%|█▌        | 16/100 [00:01<00:10,  8.15it/s] 18%|█▊        | 18/100 [00:01<00:09,  8.85it/s] 19%|█▉        | 19/100 [00:02<00:08,  9.07it/s] 21%|██        | 21/100 [00:02<00:08,  9.56it/s] 22%|██▏       | 22/100 [00:02<00:08,  9.14it/s] 23%|██▎       | 23/100 [00:02<00:08,  8.82it/s] 24%|██▍       | 24/100 [00:02<00:08,  8.99it/s] 26%|██▌       | 26/100 [00:02<00:07,  9.51it/s] 27%|██▋       | 27/100 [00:02<00:08,  8.60it/s] 29%|██▉       | 29/100 [00:03<00:07,  9.01it/s] 30%|███       | 30/100 [00:03<00:07,  9.12it/s] 32%|███▏      | 32/100 [00:03<00:07,  9.40it/s] 33%|███▎      | 33/100 [00:03<00:08,  7.92it/s] 34%|███▍      | 34/100 [00:03<00:08,  8.16it/s] 35%|███▌      | 35/100 [00:03<00:07,  8.38it/s] 36%|███▌      | 36/100 [00:03<00:07,  8.38it/s] 38%|███▊      | 38/100 [00:04<00:06,  9.03it/s] 40%|████      | 40/100 [00:04<00:06,  9.46it/s] 42%|████▏     | 42/100 [00:04<00:05,  9.79it/s] 43%|████▎     | 43/100 [00:04<00:05,  9.80it/s] 44%|████▍     | 44/100 [00:04<00:05,  9.80it/s] 46%|████▌     | 46/100 [00:04<00:05, 10.13it/s] 48%|████▊     | 48/100 [00:05<00:05,  9.59it/s] 50%|█████     | 50/100 [00:05<00:05,  9.63it/s] 51%|█████     | 51/100 [00:05<00:05,  9.50it/s] 52%|█████▏    | 52/100 [00:05<00:05,  9.50it/s] 54%|█████▍    | 54/100 [00:05<00:04,  9.59it/s] 55%|█████▌    | 55/100 [00:05<00:04,  9.66it/s] 57%|█████▋    | 57/100 [00:06<00:04,  9.89it/s] 58%|█████▊    | 58/100 [00:06<00:04,  9.79it/s] 60%|██████    | 60/100 [00:06<00:04,  9.79it/s] 62%|██████▏   | 62/100 [00:06<00:04,  9.12it/s] 64%|██████▍   | 64/100 [00:06<00:03,  9.54it/s] 66%|██████▌   | 66/100 [00:07<00:03,  9.76it/s] 67%|██████▋   | 67/100 [00:07<00:03,  9.64it/s] 68%|██████▊   | 68/100 [00:07<00:03,  9.46it/s] 70%|███████   | 70/100 [00:07<00:03,  9.42it/s] 71%|███████   | 71/100 [00:07<00:03,  9.42it/s] 72%|███████▏  | 72/100 [00:07<00:03,  9.33it/s] 73%|███████▎  | 73/100 [00:07<00:02,  9.38it/s] 75%|███████▌  | 75/100 [00:08<00:02,  9.62it/s] 77%|███████▋  | 77/100 [00:08<00:02,  9.85it/s] 78%|███████▊  | 78/100 [00:08<00:02,  9.71it/s] 79%|███████▉  | 79/100 [00:08<00:02,  9.75it/s] 80%|████████  | 80/100 [00:08<00:02,  9.32it/s] 82%|████████▏ | 82/100 [00:08<00:01,  9.55it/s] 83%|████████▎ | 83/100 [00:08<00:01,  9.37it/s] 84%|████████▍ | 84/100 [00:08<00:01,  9.25it/s] 85%|████████▌ | 85/100 [00:09<00:01,  9.16it/s] 86%|████████▌ | 86/100 [00:09<00:01,  9.25it/s] 87%|████████▋ | 87/100 [00:09<00:01,  8.92it/s] 88%|████████▊ | 88/100 [00:09<00:01,  8.71it/s] 89%|████████▉ | 89/100 [00:09<00:01,  8.97it/s] 90%|█████████ | 90/100 [00:09<00:01,  7.32it/s] 92%|█████████▏| 92/100 [00:09<00:01,  7.39it/s] 93%|█████████▎| 93/100 [00:10<00:00,  7.76it/s] 95%|█████████▌| 95/100 [00:10<00:00,  8.65it/s] 96%|█████████▌| 96/100 [00:10<00:00,  8.78it/s] 97%|█████████▋| 97/100 [00:10<00:00,  8.90it/s] 98%|█████████▊| 98/100 [00:10<00:00,  8.92it/s] 99%|█████████▉| 99/100 [00:10<00:00,  8.79it/s]100%|██████████| 100/100 [00:10<00:00,  8.94it/s]100%|██████████| 100/100 [00:10<00:00,  9.21it/s]
eval_p_index len:  17
individual_train 115
individual_eval 17
train data의 x, y, id 길이: 115 115 115
valid data의 x, y, id 길이: 8 8 8
test data의 x, y, id 길이: 9 9 9
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.663417, Valid_loss 0.672816
Epoch 2, Train Loss 0.634028, Valid_loss 0.663223
Epoch 3, Train Loss 0.609345, Valid_loss 0.657073
Epoch 4, Train Loss 0.586164, Valid_loss 0.654851
Epoch 5, Train Loss 0.562202, Valid_loss 0.655272
Epoch 6, Train Loss 0.561197, Valid_loss 0.655099
Epoch 7, Train Loss 0.545563, Valid_loss 0.654574
Epoch 8, Train Loss 0.552999, Valid_loss 0.652660
Epoch 9, Train Loss 0.570810, Valid_loss 0.649924
Epoch 10, Train Loss 0.558139, Valid_loss 0.645594
Epoch 11, Train Loss 0.546906, Valid_loss 0.639809
Epoch 12, Train Loss 0.529396, Valid_loss 0.634207
Epoch 13, Train Loss 0.540589, Valid_loss 0.630734
Epoch 14, Train Loss 0.523832, Valid_loss 0.626034
Epoch 15, Train Loss 0.524811, Valid_loss 0.623877
Epoch 16, Train Loss 0.496479, Valid_loss 0.625225
Epoch 17, Train Loss 0.502675, Valid_loss 0.624094
Epoch 18, Train Loss 0.502904, Valid_loss 0.626613
Epoch 19, Train Loss 0.482952, Valid_loss 0.622166
Epoch 20, Train Loss 0.500796, Valid_loss 0.620520
Epoch 21, Train Loss 0.480409, Valid_loss 0.615759
Epoch 22, Train Loss 0.483590, Valid_loss 0.612307
Epoch 23, Train Loss 0.471854, Valid_loss 0.611829
Epoch 24, Train Loss 0.477217, Valid_loss 0.607683
Epoch 25, Train Loss 0.460158, Valid_loss 0.611546
Epoch 26, Train Loss 0.456650, Valid_loss 0.610031
Epoch 27, Train Loss 0.457530, Valid_loss 0.610162
Epoch 28, Train Loss 0.450518, Valid_loss 0.611637
Epoch 29, Train Loss 0.441427, Valid_loss 0.610469
Epoch 30, Train Loss 0.450960, Valid_loss 0.608949
Epoch 31, Train Loss 0.452415, Valid_loss 0.608947
Epoch 32, Train Loss 0.443863, Valid_loss 0.611721
Epoch 33, Train Loss 0.448947, Valid_loss 0.607503
Epoch 34, Train Loss 0.451012, Valid_loss 0.608578
Epoch 35, Train Loss 0.439293, Valid_loss 0.605490
Epoch 36, Train Loss 0.453458, Valid_loss 0.606283
Epoch 37, Train Loss 0.455371, Valid_loss 0.603102
Epoch 38, Train Loss 0.426758, Valid_loss 0.606436
Epoch 39, Train Loss 0.447397, Valid_loss 0.601570
Epoch 40, Train Loss 0.426522, Valid_loss 0.604040
Epoch 41, Train Loss 0.430386, Valid_loss 0.600304
Epoch 42, Train Loss 0.434874, Valid_loss 0.600667
Epoch 43, Train Loss 0.433309, Valid_loss 0.599255
Epoch 44, Train Loss 0.419078, Valid_loss 0.597386
Epoch 45, Train Loss 0.432171, Valid_loss 0.597543
Epoch 46, Train Loss 0.427718, Valid_loss 0.598338
Epoch 47, Train Loss 0.423864, Valid_loss 0.595104
Epoch 48, Train Loss 0.413840, Valid_loss 0.594975
Epoch 49, Train Loss 0.415758, Valid_loss 0.595205
Epoch 50, Train Loss 0.411097, Valid_loss 0.592450
Epoch 51, Train Loss 0.416787, Valid_loss 0.593960
Epoch 52, Train Loss 0.424388, Valid_loss 0.592596
Epoch 53, Train Loss 0.425200, Valid_loss 0.591962
Epoch 54, Train Loss 0.415197, Valid_loss 0.591951
Epoch 55, Train Loss 0.418704, Valid_loss 0.591041
Epoch 56, Train Loss 0.407087, Valid_loss 0.591542
Epoch 57, Train Loss 0.419526, Valid_loss 0.591125
Epoch 58, Train Loss 0.409061, Valid_loss 0.589453
Epoch 59, Train Loss 0.410381, Valid_loss 0.590092
Epoch 60, Train Loss 0.407322, Valid_loss 0.588832
Epoch 61, Train Loss 0.410394, Valid_loss 0.589887
Epoch 62, Train Loss 0.414148, Valid_loss 0.588972
Epoch 63, Train Loss 0.403355, Valid_loss 0.589308
Epoch 64, Train Loss 0.402619, Valid_loss 0.587868
Epoch 65, Train Loss 0.405640, Valid_loss 0.588602
Epoch 66, Train Loss 0.403008, Valid_loss 0.587275
Epoch 67, Train Loss 0.409208, Valid_loss 0.587545
Epoch 68, Train Loss 0.408954, Valid_loss 0.587811
COVID19_Participant26 -- true: COVID-19 -- pred: normal
Control_Participant3 -- true: normal -- pred: normal
COVID19_Participant7 -- true: COVID-19 -- pred: normal
Control_Participant9 -- true: normal -- pred: normal
COVID19_Participant26 -- true: COVID-19 -- pred: COVID-19
Control_Participant12 -- true: normal -- pred: COVID-19
Control_Participant4 -- true: normal -- pred: normal
Control_Participant5 -- true: normal -- pred: normal
COVID19_Participant13 -- true: COVID-19 -- pred: COVID-19
true :  [1, 0, 1, 0, 1, 0, 0, 0, 1]
pred :  [0, 0, 0, 0, 1, 1, 0, 0, 1]
Confusion Matrix: [4 1 2 2]
Best performance: Epoch 66, Loss 0.403008, Test ACC 0.666667, Test AUC 0.700000, Test Recall 0.500000, Test Precision 0.666667
✅ Total valid splits used: 4
🔁 Repeat 2, Fold 4
🔍 Split #5
  → train_p_index 환자 수: 26
  → test_p_index 환자 수: 6
  → train 환자 ID: ['COVID19_Participant11', 'COVID19_Participant14', 'COVID19_Participant15', 'COVID19_Participant17', 'COVID19_Participant19', 'COVID19_Participant2', 'COVID19_Participant20', 'COVID19_Participant22', 'COVID19_Participant23', 'COVID19_Participant25', 'COVID19_Participant26', 'COVID19_Participant28', 'COVID19_Participant31', 'COVID19_Participant32', 'COVID19_Participant37', 'COVID19_Participant4', 'COVID19_Participant7', 'COVID19_Participant8', 'Control_Participant1', 'Control_Participant10', 'Control_Participant3', 'Control_Participant4', 'Control_Participant5', 'Control_Participant7', 'Control_Participant8', 'Control_Participant9']
  → test  환자 ID: ['Control_Participant7', 'Control_Participant5', 'COVID19_Participant26', 'Control_Participant4', 'COVID19_Participant31', 'COVID19_Participant7']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant10, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant4, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant8, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: Control_Participant7, Label: 1
    ID: Control_Participant5, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: Control_Participant4, Label: 1
    ID: COVID19_Participant31, Label: 0
    ID: COVID19_Participant7, Label: 0
train_p_index_ 17
valid_p_index 9
test_p_index 6
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Ciliated Cells', 'Developing Ciliated Cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
data augment 실행 함
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  2%|▏         | 2/100 [00:00<00:08, 11.29it/s]  4%|▍         | 4/100 [00:00<00:08, 10.88it/s]  6%|▌         | 6/100 [00:00<00:08, 10.66it/s]  8%|▊         | 8/100 [00:00<00:08, 10.83it/s] 10%|█         | 10/100 [00:00<00:08, 10.60it/s] 12%|█▏        | 12/100 [00:01<00:09,  9.71it/s] 13%|█▎        | 13/100 [00:01<00:10,  8.31it/s] 15%|█▌        | 15/100 [00:01<00:09,  8.86it/s] 16%|█▌        | 16/100 [00:01<00:09,  8.98it/s] 17%|█▋        | 17/100 [00:01<00:10,  8.22it/s] 19%|█▉        | 19/100 [00:02<00:09,  8.22it/s] 21%|██        | 21/100 [00:02<00:08,  8.91it/s] 22%|██▏       | 22/100 [00:02<00:08,  8.90it/s] 24%|██▍       | 24/100 [00:02<00:08,  9.43it/s] 25%|██▌       | 25/100 [00:02<00:07,  9.53it/s] 27%|██▋       | 27/100 [00:02<00:07,  9.58it/s] 28%|██▊       | 28/100 [00:02<00:07,  9.64it/s] 29%|██▉       | 29/100 [00:03<00:07,  9.23it/s] 30%|███       | 30/100 [00:03<00:07,  9.34it/s] 31%|███       | 31/100 [00:03<00:07,  9.51it/s] 32%|███▏      | 32/100 [00:03<00:07,  9.25it/s] 33%|███▎      | 33/100 [00:03<00:07,  8.53it/s] 34%|███▍      | 34/100 [00:03<00:08,  7.64it/s] 36%|███▌      | 36/100 [00:03<00:07,  8.60it/s] 38%|███▊      | 38/100 [00:04<00:08,  6.93it/s] 39%|███▉      | 39/100 [00:04<00:10,  5.59it/s] 41%|████      | 41/100 [00:04<00:08,  6.62it/s] 42%|████▏     | 42/100 [00:04<00:08,  7.09it/s] 44%|████▍     | 44/100 [00:05<00:07,  7.91it/s] 45%|████▌     | 45/100 [00:05<00:07,  7.45it/s] 47%|████▋     | 47/100 [00:05<00:06,  8.14it/s] 49%|████▉     | 49/100 [00:05<00:05,  8.63it/s] 51%|█████     | 51/100 [00:05<00:05,  9.08it/s] 52%|█████▏    | 52/100 [00:06<00:05,  8.74it/s] 53%|█████▎    | 53/100 [00:06<00:05,  8.91it/s] 54%|█████▍    | 54/100 [00:06<00:05,  8.99it/s] 55%|█████▌    | 55/100 [00:06<00:04,  9.04it/s] 56%|█████▌    | 56/100 [00:06<00:04,  9.18it/s] 57%|█████▋    | 57/100 [00:06<00:04,  9.14it/s] 59%|█████▉    | 59/100 [00:06<00:04,  9.14it/s] 60%|██████    | 60/100 [00:06<00:04,  9.14it/s] 62%|██████▏   | 62/100 [00:07<00:04,  9.29it/s] 63%|██████▎   | 63/100 [00:07<00:03,  9.32it/s] 64%|██████▍   | 64/100 [00:07<00:03,  9.10it/s] 65%|██████▌   | 65/100 [00:07<00:03,  9.24it/s] 66%|██████▌   | 66/100 [00:07<00:03,  8.82it/s] 67%|██████▋   | 67/100 [00:07<00:03,  9.08it/s] 68%|██████▊   | 68/100 [00:07<00:03,  9.19it/s] 69%|██████▉   | 69/100 [00:07<00:04,  7.59it/s] 70%|███████   | 70/100 [00:08<00:03,  7.56it/s] 71%|███████   | 71/100 [00:08<00:03,  8.04it/s] 72%|███████▏  | 72/100 [00:08<00:03,  8.50it/s] 73%|███████▎  | 73/100 [00:08<00:03,  8.82it/s] 74%|███████▍  | 74/100 [00:08<00:03,  7.27it/s] 76%|███████▌  | 76/100 [00:08<00:03,  6.07it/s] 77%|███████▋  | 77/100 [00:09<00:03,  5.82it/s] 78%|███████▊  | 78/100 [00:09<00:03,  6.51it/s] 79%|███████▉  | 79/100 [00:09<00:02,  7.02it/s] 80%|████████  | 80/100 [00:09<00:02,  7.65it/s] 82%|████████▏ | 82/100 [00:09<00:02,  8.48it/s] 83%|████████▎ | 83/100 [00:09<00:01,  8.72it/s] 84%|████████▍ | 84/100 [00:09<00:01,  8.61it/s] 85%|████████▌ | 85/100 [00:10<00:01,  8.60it/s] 86%|████████▌ | 86/100 [00:10<00:01,  8.61it/s] 87%|████████▋ | 87/100 [00:10<00:01,  8.84it/s] 88%|████████▊ | 88/100 [00:10<00:01,  8.46it/s] 89%|████████▉ | 89/100 [00:10<00:01,  8.73it/s] 90%|█████████ | 90/100 [00:10<00:01,  8.68it/s] 91%|█████████ | 91/100 [00:10<00:00,  9.01it/s] 93%|█████████▎| 93/100 [00:10<00:00,  8.04it/s] 94%|█████████▍| 94/100 [00:11<00:00,  8.41it/s] 95%|█████████▌| 95/100 [00:11<00:00,  8.32it/s] 96%|█████████▌| 96/100 [00:11<00:00,  8.36it/s] 98%|█████████▊| 98/100 [00:11<00:00,  8.96it/s] 99%|█████████▉| 99/100 [00:11<00:00,  8.80it/s]100%|██████████| 100/100 [00:11<00:00,  9.01it/s]100%|██████████| 100/100 [00:11<00:00,  8.50it/s]
eval_p_index len:  15
individual_train 117
individual_eval 15
train data의 x, y, id 길이: 117 117 117
valid data의 x, y, id 길이: 9 9 9
test data의 x, y, id 길이: 6 6 6
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.640510, Valid_loss 0.703555
Epoch 2, Train Loss 0.606856, Valid_loss 0.712906
Epoch 3, Train Loss 0.555896, Valid_loss 0.737456
Epoch 4, Train Loss 0.533829, Valid_loss 0.743845
Epoch 5, Train Loss 0.542045, Valid_loss 0.739606
Epoch 6, Train Loss 0.531015, Valid_loss 0.729309
Epoch 7, Train Loss 0.522822, Valid_loss 0.720471
Epoch 8, Train Loss 0.523196, Valid_loss 0.714333
Epoch 9, Train Loss 0.527203, Valid_loss 0.699391
Epoch 10, Train Loss 0.514003, Valid_loss 0.694865
Epoch 11, Train Loss 0.505894, Valid_loss 0.694253
Epoch 12, Train Loss 0.503562, Valid_loss 0.687376
Epoch 13, Train Loss 0.491025, Valid_loss 0.680243
Epoch 14, Train Loss 0.495255, Valid_loss 0.658431
Epoch 15, Train Loss 0.483854, Valid_loss 0.649152
Epoch 16, Train Loss 0.482495, Valid_loss 0.649778
Epoch 17, Train Loss 0.473764, Valid_loss 0.645698
Epoch 18, Train Loss 0.477222, Valid_loss 0.645608
Epoch 19, Train Loss 0.469118, Valid_loss 0.655705
Epoch 20, Train Loss 0.469138, Valid_loss 0.654861
Epoch 21, Train Loss 0.462054, Valid_loss 0.648910
Epoch 22, Train Loss 0.455995, Valid_loss 0.653105
Epoch 23, Train Loss 0.455512, Valid_loss 0.651243
Epoch 24, Train Loss 0.452602, Valid_loss 0.654167
Epoch 25, Train Loss 0.452797, Valid_loss 0.656019
Epoch 26, Train Loss 0.450395, Valid_loss 0.654551
Epoch 27, Train Loss 0.452783, Valid_loss 0.658795
Epoch 28, Train Loss 0.451728, Valid_loss 0.655697
Epoch 29, Train Loss 0.450142, Valid_loss 0.656210
Epoch 30, Train Loss 0.439315, Valid_loss 0.655958
Epoch 31, Train Loss 0.439878, Valid_loss 0.654869
Epoch 32, Train Loss 0.438985, Valid_loss 0.658662
Epoch 33, Train Loss 0.438311, Valid_loss 0.660923
Epoch 34, Train Loss 0.433183, Valid_loss 0.659427
Epoch 35, Train Loss 0.436554, Valid_loss 0.660433
Epoch 36, Train Loss 0.435027, Valid_loss 0.660902
Epoch 37, Train Loss 0.435685, Valid_loss 0.662932
Epoch 38, Train Loss 0.428363, Valid_loss 0.671251
Epoch 39, Train Loss 0.428696, Valid_loss 0.661963
Epoch 40, Train Loss 0.429832, Valid_loss 0.669221
Epoch 41, Train Loss 0.431244, Valid_loss 0.666541
Epoch 42, Train Loss 0.421421, Valid_loss 0.663247
Epoch 43, Train Loss 0.422907, Valid_loss 0.666945
Epoch 44, Train Loss 0.424392, Valid_loss 0.663605
Epoch 45, Train Loss 0.418081, Valid_loss 0.667665
Epoch 46, Train Loss 0.420135, Valid_loss 0.668875
Epoch 47, Train Loss 0.418295, Valid_loss 0.664075
Epoch 48, Train Loss 0.413446, Valid_loss 0.671144
Epoch 49, Train Loss 0.415988, Valid_loss 0.664738
Epoch 50, Train Loss 0.417577, Valid_loss 0.673511
Epoch 51, Train Loss 0.412665, Valid_loss 0.666490
Epoch 52, Train Loss 0.421075, Valid_loss 0.666377
Epoch 53, Train Loss 0.414958, Valid_loss 0.669716
Epoch 54, Train Loss 0.411904, Valid_loss 0.672479
Control_Participant7 -- true: normal -- pred: COVID-19
Control_Participant5 -- true: normal -- pred: normal
COVID19_Participant26 -- true: COVID-19 -- pred: normal
Control_Participant4 -- true: normal -- pred: COVID-19
COVID19_Participant31 -- true: COVID-19 -- pred: COVID-19
COVID19_Participant7 -- true: COVID-19 -- pred: normal
true :  [0, 0, 1, 0, 1, 1]
pred :  [1, 0, 0, 1, 1, 0]
Confusion Matrix: [1 2 2 1]
Best performance: Epoch 18, Loss 0.477222, Test ACC 0.333333, Test AUC 0.555556, Test Recall 0.333333, Test Precision 0.333333
✅ Total valid splits used: 5

📌 Repeat 2: 평균 AUC = 0.8261, 표준편차 = 0.1743
🔁 Repeat 3, Fold 0
🔍 Split #1
  → train_p_index 환자 수: 24
  → test_p_index 환자 수: 8
  → train 환자 ID: ['COVID19_Participant13', 'COVID19_Participant14', 'COVID19_Participant15', 'COVID19_Participant2', 'COVID19_Participant20', 'COVID19_Participant22', 'COVID19_Participant23', 'COVID19_Participant26', 'COVID19_Participant28', 'COVID19_Participant29', 'COVID19_Participant32', 'COVID19_Participant37', 'COVID19_Participant39', 'COVID19_Participant4', 'COVID19_Participant7', 'COVID19_Participant8', 'Control_Participant10', 'Control_Participant11', 'Control_Participant15', 'Control_Participant3', 'Control_Participant5', 'Control_Participant7', 'Control_Participant8', 'Control_Participant9']
  → test  환자 ID: ['COVID19_Participant13', 'Control_Participant5', 'COVID19_Participant26', 'COVID19_Participant13', 'Control_Participant7', 'Control_Participant3', 'COVID19_Participant26', 'Control_Participant7']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: Control_Participant10, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant8, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: COVID19_Participant13, Label: 1
    ID: Control_Participant5, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: Control_Participant7, Label: 1
    ID: Control_Participant3, Label: 1
    ID: COVID19_Participant26, Label: 0
    ID: Control_Participant7, Label: 0
train_p_index_ 16
valid_p_index 8
test_p_index 8
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Ciliated Cells', 'Developing Ciliated Cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
data augment 실행 함
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:11,  8.72it/s]  3%|▎         | 3/100 [00:00<00:10,  9.43it/s]  4%|▍         | 4/100 [00:00<00:09,  9.62it/s]  6%|▌         | 6/100 [00:00<00:09,  9.79it/s]  8%|▊         | 8/100 [00:00<00:10,  8.81it/s]  9%|▉         | 9/100 [00:00<00:10,  9.04it/s] 11%|█         | 11/100 [00:01<00:09,  9.13it/s] 13%|█▎        | 13/100 [00:01<00:09,  9.23it/s] 14%|█▍        | 14/100 [00:01<00:09,  9.23it/s] 16%|█▌        | 16/100 [00:01<00:08,  9.62it/s] 17%|█▋        | 17/100 [00:01<00:08,  9.68it/s] 18%|█▊        | 18/100 [00:01<00:08,  9.63it/s] 19%|█▉        | 19/100 [00:02<00:08,  9.51it/s] 20%|██        | 20/100 [00:02<00:09,  8.13it/s] 22%|██▏       | 22/100 [00:02<00:08,  8.85it/s] 23%|██▎       | 23/100 [00:02<00:09,  8.51it/s] 24%|██▍       | 24/100 [00:02<00:08,  8.81it/s] 25%|██▌       | 25/100 [00:02<00:08,  8.71it/s] 27%|██▋       | 27/100 [00:02<00:08,  9.02it/s] 28%|██▊       | 28/100 [00:03<00:09,  7.29it/s] 29%|██▉       | 29/100 [00:03<00:09,  7.13it/s] 30%|███       | 30/100 [00:03<00:09,  7.47it/s] 31%|███       | 31/100 [00:03<00:08,  7.85it/s] 32%|███▏      | 32/100 [00:03<00:08,  8.24it/s] 33%|███▎      | 33/100 [00:03<00:07,  8.66it/s] 34%|███▍      | 34/100 [00:03<00:07,  8.76it/s] 35%|███▌      | 35/100 [00:03<00:07,  8.95it/s] 37%|███▋      | 37/100 [00:04<00:06,  9.45it/s] 38%|███▊      | 38/100 [00:04<00:07,  8.42it/s] 39%|███▉      | 39/100 [00:04<00:07,  8.69it/s] 41%|████      | 41/100 [00:04<00:06,  9.15it/s] 42%|████▏     | 42/100 [00:04<00:06,  9.28it/s] 43%|████▎     | 43/100 [00:04<00:06,  9.39it/s] 44%|████▍     | 44/100 [00:04<00:06,  8.62it/s] 45%|████▌     | 45/100 [00:05<00:06,  8.95it/s] 46%|████▌     | 46/100 [00:05<00:06,  8.48it/s] 48%|████▊     | 48/100 [00:05<00:05,  9.05it/s] 49%|████▉     | 49/100 [00:05<00:05,  9.05it/s] 50%|█████     | 50/100 [00:05<00:05,  8.99it/s] 51%|█████     | 51/100 [00:05<00:05,  9.13it/s] 52%|█████▏    | 52/100 [00:05<00:05,  9.18it/s] 53%|█████▎    | 53/100 [00:05<00:05,  9.20it/s] 54%|█████▍    | 54/100 [00:06<00:05,  8.12it/s] 55%|█████▌    | 55/100 [00:06<00:05,  8.43it/s] 56%|█████▌    | 56/100 [00:06<00:05,  8.46it/s] 57%|█████▋    | 57/100 [00:06<00:04,  8.65it/s] 58%|█████▊    | 58/100 [00:06<00:04,  8.88it/s] 59%|█████▉    | 59/100 [00:06<00:04,  9.08it/s] 60%|██████    | 60/100 [00:06<00:04,  9.27it/s] 61%|██████    | 61/100 [00:06<00:04,  9.16it/s] 62%|██████▏   | 62/100 [00:07<00:04,  8.87it/s] 63%|██████▎   | 63/100 [00:07<00:04,  9.02it/s] 64%|██████▍   | 64/100 [00:07<00:03,  9.20it/s] 65%|██████▌   | 65/100 [00:07<00:04,  8.10it/s] 66%|██████▌   | 66/100 [00:07<00:04,  7.80it/s] 67%|██████▋   | 67/100 [00:07<00:03,  8.32it/s] 68%|██████▊   | 68/100 [00:07<00:03,  8.74it/s] 69%|██████▉   | 69/100 [00:07<00:03,  8.80it/s] 70%|███████   | 70/100 [00:07<00:03,  9.01it/s] 71%|███████   | 71/100 [00:08<00:03,  9.22it/s] 72%|███████▏  | 72/100 [00:08<00:03,  7.61it/s] 73%|███████▎  | 73/100 [00:08<00:03,  8.09it/s] 74%|███████▍  | 74/100 [00:08<00:03,  7.73it/s] 75%|███████▌  | 75/100 [00:08<00:03,  8.00it/s] 76%|███████▌  | 76/100 [00:08<00:02,  8.16it/s] 77%|███████▋  | 77/100 [00:08<00:02,  8.22it/s] 78%|███████▊  | 78/100 [00:08<00:02,  8.26it/s] 79%|███████▉  | 79/100 [00:09<00:02,  8.47it/s] 80%|████████  | 80/100 [00:09<00:02,  8.73it/s] 81%|████████  | 81/100 [00:09<00:02,  8.84it/s] 82%|████████▏ | 82/100 [00:09<00:02,  8.60it/s] 83%|████████▎ | 83/100 [00:09<00:01,  8.82it/s] 84%|████████▍ | 84/100 [00:09<00:01,  8.76it/s] 85%|████████▌ | 85/100 [00:09<00:01,  8.81it/s] 86%|████████▌ | 86/100 [00:09<00:01,  7.99it/s] 87%|████████▋ | 87/100 [00:10<00:01,  7.66it/s] 88%|████████▊ | 88/100 [00:10<00:01,  8.01it/s] 89%|████████▉ | 89/100 [00:10<00:01,  8.31it/s] 90%|█████████ | 90/100 [00:10<00:01,  8.64it/s] 91%|█████████ | 91/100 [00:10<00:01,  8.47it/s] 92%|█████████▏| 92/100 [00:10<00:00,  8.72it/s] 93%|█████████▎| 93/100 [00:10<00:00,  8.99it/s] 94%|█████████▍| 94/100 [00:10<00:00,  8.95it/s] 95%|█████████▌| 95/100 [00:10<00:00,  8.77it/s] 96%|█████████▌| 96/100 [00:11<00:00,  9.08it/s] 97%|█████████▋| 97/100 [00:11<00:00,  9.11it/s] 98%|█████████▊| 98/100 [00:11<00:00,  9.22it/s] 99%|█████████▉| 99/100 [00:11<00:00,  8.97it/s]100%|██████████| 100/100 [00:11<00:00,  9.06it/s]100%|██████████| 100/100 [00:11<00:00,  8.72it/s]
eval_p_index len:  16
individual_train 116
individual_eval 16
train data의 x, y, id 길이: 116 116 116
valid data의 x, y, id 길이: 8 8 8
test data의 x, y, id 길이: 8 8 8
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.723668, Valid_loss 0.676167
Epoch 2, Train Loss 0.674890, Valid_loss 0.661987
Epoch 3, Train Loss 0.649066, Valid_loss 0.666310
Epoch 4, Train Loss 0.628153, Valid_loss 0.664287
Epoch 5, Train Loss 0.616498, Valid_loss 0.656777
Epoch 6, Train Loss 0.615763, Valid_loss 0.650635
Epoch 7, Train Loss 0.609485, Valid_loss 0.647474
Epoch 8, Train Loss 0.590448, Valid_loss 0.641396
Epoch 9, Train Loss 0.577192, Valid_loss 0.635940
Epoch 10, Train Loss 0.571605, Valid_loss 0.626754
Epoch 11, Train Loss 0.567574, Valid_loss 0.620647
Epoch 12, Train Loss 0.557457, Valid_loss 0.602206
Epoch 13, Train Loss 0.533300, Valid_loss 0.576512
Epoch 14, Train Loss 0.523283, Valid_loss 0.557348
Epoch 15, Train Loss 0.501550, Valid_loss 0.533826
Epoch 16, Train Loss 0.481782, Valid_loss 0.526736
Epoch 17, Train Loss 0.479248, Valid_loss 0.523733
Epoch 18, Train Loss 0.456591, Valid_loss 0.501028
Epoch 19, Train Loss 0.447439, Valid_loss 0.509355
Epoch 20, Train Loss 0.444083, Valid_loss 0.511685
Epoch 21, Train Loss 0.438448, Valid_loss 0.506529
Epoch 22, Train Loss 0.436067, Valid_loss 0.507253
Epoch 23, Train Loss 0.451811, Valid_loss 0.504546
Epoch 24, Train Loss 0.438331, Valid_loss 0.500628
Epoch 25, Train Loss 0.434224, Valid_loss 0.499856
Epoch 26, Train Loss 0.433961, Valid_loss 0.500558
Epoch 27, Train Loss 0.421557, Valid_loss 0.495699
Epoch 28, Train Loss 0.424905, Valid_loss 0.493087
Epoch 29, Train Loss 0.419577, Valid_loss 0.492137
Epoch 30, Train Loss 0.412277, Valid_loss 0.491408
Epoch 31, Train Loss 0.417305, Valid_loss 0.490485
Epoch 32, Train Loss 0.404803, Valid_loss 0.489460
Epoch 33, Train Loss 0.418787, Valid_loss 0.488228
Epoch 34, Train Loss 0.422682, Valid_loss 0.487523
Epoch 35, Train Loss 0.417604, Valid_loss 0.485288
Epoch 36, Train Loss 0.414111, Valid_loss 0.482809
Epoch 37, Train Loss 0.418477, Valid_loss 0.481668
Epoch 38, Train Loss 0.413566, Valid_loss 0.483508
Epoch 39, Train Loss 0.420180, Valid_loss 0.478876
Epoch 40, Train Loss 0.420386, Valid_loss 0.476182
Epoch 41, Train Loss 0.416855, Valid_loss 0.478519
Epoch 42, Train Loss 0.401507, Valid_loss 0.476759
Epoch 43, Train Loss 0.403340, Valid_loss 0.478426
Epoch 44, Train Loss 0.400507, Valid_loss 0.475522
Epoch 45, Train Loss 0.403037, Valid_loss 0.476159
Epoch 46, Train Loss 0.412867, Valid_loss 0.475344
Epoch 47, Train Loss 0.407326, Valid_loss 0.474243
Epoch 48, Train Loss 0.401413, Valid_loss 0.472012
Epoch 49, Train Loss 0.403382, Valid_loss 0.474122
Epoch 50, Train Loss 0.395601, Valid_loss 0.471653
Epoch 51, Train Loss 0.391192, Valid_loss 0.472069
Epoch 52, Train Loss 0.393116, Valid_loss 0.471575
Epoch 53, Train Loss 0.407976, Valid_loss 0.468996
Epoch 54, Train Loss 0.389510, Valid_loss 0.470787
Epoch 55, Train Loss 0.391984, Valid_loss 0.471195
COVID19_Participant13 -- true: COVID-19 -- pred: COVID-19
Control_Participant5 -- true: normal -- pred: normal
COVID19_Participant26 -- true: COVID-19 -- pred: COVID-19
COVID19_Participant13 -- true: COVID-19 -- pred: COVID-19
Control_Participant7 -- true: normal -- pred: normal
Control_Participant3 -- true: normal -- pred: normal
COVID19_Participant26 -- true: COVID-19 -- pred: COVID-19
Control_Participant7 -- true: normal -- pred: normal
true :  [1, 0, 1, 1, 0, 0, 1, 0]
pred :  [1, 0, 1, 1, 0, 0, 1, 0]
Confusion Matrix: [4 0 0 4]
Best performance: Epoch 53, Loss 0.407976, Test ACC 1.000000, Test AUC 1.000000, Test Recall 1.000000, Test Precision 1.000000
✅ Total valid splits used: 1
🔁 Repeat 3, Fold 1
🔍 Split #2
  → train_p_index 환자 수: 28
  → test_p_index 환자 수: 4
  → train 환자 ID: ['COVID19_Participant11', 'COVID19_Participant13', 'COVID19_Participant14', 'COVID19_Participant17', 'COVID19_Participant19', 'COVID19_Participant2', 'COVID19_Participant20', 'COVID19_Participant22', 'COVID19_Participant23', 'COVID19_Participant25', 'COVID19_Participant26', 'COVID19_Participant28', 'COVID19_Participant29', 'COVID19_Participant31', 'COVID19_Participant32', 'COVID19_Participant37', 'COVID19_Participant4', 'COVID19_Participant40', 'COVID19_Participant8', 'Control_Participant1', 'Control_Participant11', 'Control_Participant15', 'Control_Participant3', 'Control_Participant4', 'Control_Participant5', 'Control_Participant7', 'Control_Participant8', 'Control_Participant9']
  → test  환자 ID: ['COVID19_Participant26', 'COVID19_Participant26', 'Control_Participant7', 'Control_Participant7']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant4, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant8, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: Control_Participant7, Label: 1
    ID: Control_Participant7, Label: 0
train_p_index_ 18
valid_p_index 10
test_p_index 4
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Ciliated Cells', 'Developing Ciliated Cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
data augment 실행 함
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  2%|▏         | 2/100 [00:00<00:09, 10.40it/s]  4%|▍         | 4/100 [00:00<00:09,  9.65it/s]  6%|▌         | 6/100 [00:00<00:09, 10.37it/s]  8%|▊         | 8/100 [00:00<00:09,  9.93it/s] 10%|█         | 10/100 [00:00<00:08, 10.01it/s] 12%|█▏        | 12/100 [00:01<00:08,  9.95it/s] 14%|█▍        | 14/100 [00:01<00:08, 10.27it/s] 16%|█▌        | 16/100 [00:01<00:08, 10.38it/s] 18%|█▊        | 18/100 [00:01<00:07, 10.28it/s] 20%|██        | 20/100 [00:01<00:07, 10.14it/s] 22%|██▏       | 22/100 [00:02<00:07, 10.20it/s] 24%|██▍       | 24/100 [00:02<00:07,  9.99it/s] 26%|██▌       | 26/100 [00:02<00:07, 10.12it/s] 28%|██▊       | 28/100 [00:02<00:07, 10.15it/s] 30%|███       | 30/100 [00:02<00:06, 10.00it/s] 32%|███▏      | 32/100 [00:03<00:07,  9.57it/s] 34%|███▍      | 34/100 [00:03<00:06,  9.82it/s] 36%|███▌      | 36/100 [00:03<00:06,  9.83it/s] 37%|███▋      | 37/100 [00:03<00:06,  9.77it/s] 38%|███▊      | 38/100 [00:03<00:06,  9.78it/s] 40%|████      | 40/100 [00:04<00:07,  8.54it/s] 42%|████▏     | 42/100 [00:04<00:06,  9.00it/s] 43%|████▎     | 43/100 [00:04<00:06,  9.13it/s] 45%|████▌     | 45/100 [00:04<00:05,  9.44it/s] 47%|████▋     | 47/100 [00:04<00:05,  9.72it/s] 48%|████▊     | 48/100 [00:04<00:05,  9.63it/s] 49%|████▉     | 49/100 [00:05<00:05,  9.05it/s] 51%|█████     | 51/100 [00:05<00:05,  9.30it/s] 53%|█████▎    | 53/100 [00:05<00:05,  9.31it/s] 54%|█████▍    | 54/100 [00:05<00:04,  9.42it/s] 56%|█████▌    | 56/100 [00:05<00:04,  9.45it/s] 57%|█████▋    | 57/100 [00:05<00:04,  9.22it/s] 58%|█████▊    | 58/100 [00:05<00:04,  9.36it/s] 60%|██████    | 60/100 [00:06<00:04,  9.97it/s] 61%|██████    | 61/100 [00:06<00:04,  8.84it/s] 63%|██████▎   | 63/100 [00:06<00:03,  9.40it/s] 65%|██████▌   | 65/100 [00:06<00:04,  8.15it/s] 67%|██████▋   | 67/100 [00:06<00:03,  8.89it/s] 69%|██████▉   | 69/100 [00:07<00:03,  9.28it/s] 71%|███████   | 71/100 [00:07<00:03,  9.46it/s] 73%|███████▎  | 73/100 [00:07<00:02,  9.84it/s] 75%|███████▌  | 75/100 [00:07<00:02, 10.04it/s] 77%|███████▋  | 77/100 [00:07<00:02, 10.12it/s] 79%|███████▉  | 79/100 [00:08<00:02,  9.99it/s] 81%|████████  | 81/100 [00:08<00:01,  9.90it/s] 83%|████████▎ | 83/100 [00:08<00:01, 10.03it/s] 85%|████████▌ | 85/100 [00:08<00:01,  9.37it/s] 86%|████████▌ | 86/100 [00:08<00:01,  9.24it/s] 88%|████████▊ | 88/100 [00:09<00:01,  9.29it/s] 90%|█████████ | 90/100 [00:09<00:01,  9.51it/s] 91%|█████████ | 91/100 [00:09<00:00,  9.52it/s] 93%|█████████▎| 93/100 [00:09<00:00,  9.76it/s] 94%|█████████▍| 94/100 [00:09<00:00,  8.74it/s] 95%|█████████▌| 95/100 [00:09<00:00,  8.99it/s] 97%|█████████▋| 97/100 [00:10<00:00,  8.98it/s] 99%|█████████▉| 99/100 [00:10<00:00,  9.34it/s]100%|██████████| 100/100 [00:10<00:00,  9.59it/s]
eval_p_index len:  14
individual_train 118
individual_eval 14
train data의 x, y, id 길이: 118 118 118
valid data의 x, y, id 길이: 10 10 10
test data의 x, y, id 길이: 4 4 4
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.729826, Valid_loss 0.694917
Epoch 2, Train Loss 0.693862, Valid_loss 0.692854
Epoch 3, Train Loss 0.670223, Valid_loss 0.692848
Epoch 4, Train Loss 0.646334, Valid_loss 0.694154
Epoch 5, Train Loss 0.634861, Valid_loss 0.696710
Epoch 6, Train Loss 0.613632, Valid_loss 0.700244
Epoch 7, Train Loss 0.606402, Valid_loss 0.704539
Epoch 8, Train Loss 0.591804, Valid_loss 0.709064
Epoch 9, Train Loss 0.582750, Valid_loss 0.713905
Epoch 10, Train Loss 0.568538, Valid_loss 0.717036
Epoch 11, Train Loss 0.572828, Valid_loss 0.719500
Epoch 12, Train Loss 0.576754, Valid_loss 0.719070
Epoch 13, Train Loss 0.571611, Valid_loss 0.716360
Epoch 14, Train Loss 0.571884, Valid_loss 0.711246
Epoch 15, Train Loss 0.570519, Valid_loss 0.706864
Epoch 16, Train Loss 0.546721, Valid_loss 0.699076
Epoch 17, Train Loss 0.555142, Valid_loss 0.691527
Epoch 18, Train Loss 0.550433, Valid_loss 0.685996
Epoch 19, Train Loss 0.545831, Valid_loss 0.676843
Epoch 20, Train Loss 0.543219, Valid_loss 0.677641
Epoch 21, Train Loss 0.540544, Valid_loss 0.668261
Epoch 22, Train Loss 0.542870, Valid_loss 0.657627
Epoch 23, Train Loss 0.530732, Valid_loss 0.653644
Epoch 24, Train Loss 0.523383, Valid_loss 0.654576
Epoch 25, Train Loss 0.509850, Valid_loss 0.643599
Epoch 26, Train Loss 0.513585, Valid_loss 0.640393
Epoch 27, Train Loss 0.511665, Valid_loss 0.641401
Epoch 28, Train Loss 0.506330, Valid_loss 0.633826
Epoch 29, Train Loss 0.501022, Valid_loss 0.629189
Epoch 30, Train Loss 0.502039, Valid_loss 0.627040
Epoch 31, Train Loss 0.492370, Valid_loss 0.628743
Epoch 32, Train Loss 0.491742, Valid_loss 0.621747
Epoch 33, Train Loss 0.488968, Valid_loss 0.622198
Epoch 34, Train Loss 0.484927, Valid_loss 0.617018
Epoch 35, Train Loss 0.488248, Valid_loss 0.614616
Epoch 36, Train Loss 0.482124, Valid_loss 0.617496
Epoch 37, Train Loss 0.480074, Valid_loss 0.616330
Epoch 38, Train Loss 0.483679, Valid_loss 0.616254
Epoch 39, Train Loss 0.469492, Valid_loss 0.618258
Epoch 40, Train Loss 0.477119, Valid_loss 0.617331
Epoch 41, Train Loss 0.468791, Valid_loss 0.616825
Epoch 42, Train Loss 0.466071, Valid_loss 0.621634
Epoch 43, Train Loss 0.472205, Valid_loss 0.614106
Epoch 44, Train Loss 0.459892, Valid_loss 0.617757
Epoch 45, Train Loss 0.456014, Valid_loss 0.617997
Epoch 46, Train Loss 0.455564, Valid_loss 0.616828
Epoch 47, Train Loss 0.452048, Valid_loss 0.618230
Epoch 48, Train Loss 0.451563, Valid_loss 0.616987
Epoch 49, Train Loss 0.451297, Valid_loss 0.616351
Epoch 50, Train Loss 0.452391, Valid_loss 0.619381
Epoch 51, Train Loss 0.456344, Valid_loss 0.618116
Epoch 52, Train Loss 0.453149, Valid_loss 0.617657
Epoch 53, Train Loss 0.460861, Valid_loss 0.619103
Epoch 54, Train Loss 0.449333, Valid_loss 0.617125
Epoch 55, Train Loss 0.448485, Valid_loss 0.614516
Epoch 56, Train Loss 0.442199, Valid_loss 0.617907
Epoch 57, Train Loss 0.448696, Valid_loss 0.618584
COVID19_Participant26 -- true: COVID-19 -- pred: normal
COVID19_Participant26 -- true: COVID-19 -- pred: COVID-19
Control_Participant7 -- true: normal -- pred: COVID-19
Control_Participant7 -- true: normal -- pred: COVID-19
true :  [1, 1, 0, 0]
pred :  [0, 1, 1, 1]
Confusion Matrix: [0 2 1 1]
Best performance: Epoch 43, Loss 0.472205, Test ACC 0.250000, Test AUC 0.500000, Test Recall 0.500000, Test Precision 0.333333
✅ Total valid splits used: 2
🔁 Repeat 3, Fold 2
🔍 Split #3
  → train_p_index 환자 수: 25
  → test_p_index 환자 수: 7
  → train 환자 ID: ['COVID19_Participant11', 'COVID19_Participant13', 'COVID19_Participant14', 'COVID19_Participant15', 'COVID19_Participant17', 'COVID19_Participant19', 'COVID19_Participant20', 'COVID19_Participant22', 'COVID19_Participant25', 'COVID19_Participant26', 'COVID19_Participant28', 'COVID19_Participant29', 'COVID19_Participant31', 'COVID19_Participant32', 'COVID19_Participant39', 'COVID19_Participant4', 'COVID19_Participant40', 'COVID19_Participant7', 'Control_Participant1', 'Control_Participant10', 'Control_Participant11', 'Control_Participant3', 'Control_Participant4', 'Control_Participant7', 'Control_Participant8']
  → test  환자 ID: ['COVID19_Participant26', 'COVID19_Participant26', 'COVID19_Participant31', 'COVID19_Participant13', 'Control_Participant4', 'Control_Participant7', 'Control_Participant7']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant10, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant4, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant8, Label: 0
  → test 환자 ID 및 라벨:
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: Control_Participant4, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant7, Label: 0
train_p_index_ 16
valid_p_index 9
test_p_index 7
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Ciliated Cells', 'Developing Ciliated Cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
data augment 실행 함
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:11,  8.67it/s]  2%|▏         | 2/100 [00:00<00:10,  9.01it/s]  3%|▎         | 3/100 [00:00<00:10,  9.08it/s]  4%|▍         | 4/100 [00:00<00:10,  9.15it/s]  5%|▌         | 5/100 [00:00<00:10,  9.06it/s]  6%|▌         | 6/100 [00:00<00:10,  9.13it/s]  7%|▋         | 7/100 [00:00<00:10,  8.56it/s]  8%|▊         | 8/100 [00:00<00:10,  8.96it/s]  9%|▉         | 9/100 [00:01<00:11,  7.76it/s] 10%|█         | 10/100 [00:01<00:12,  7.35it/s] 12%|█▏        | 12/100 [00:01<00:10,  8.35it/s] 13%|█▎        | 13/100 [00:01<00:10,  8.66it/s] 15%|█▌        | 15/100 [00:01<00:10,  8.39it/s] 16%|█▌        | 16/100 [00:01<00:09,  8.66it/s] 17%|█▋        | 17/100 [00:01<00:09,  8.51it/s] 19%|█▉        | 19/100 [00:02<00:08,  9.03it/s] 20%|██        | 20/100 [00:02<00:08,  9.00it/s] 21%|██        | 21/100 [00:02<00:08,  9.01it/s] 22%|██▏       | 22/100 [00:02<00:09,  8.60it/s] 23%|██▎       | 23/100 [00:02<00:08,  8.72it/s] 24%|██▍       | 24/100 [00:02<00:08,  8.72it/s] 25%|██▌       | 25/100 [00:02<00:09,  8.30it/s] 26%|██▌       | 26/100 [00:03<00:08,  8.73it/s] 27%|██▋       | 27/100 [00:03<00:08,  8.96it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.26it/s] 29%|██▉       | 29/100 [00:03<00:08,  7.95it/s] 30%|███       | 30/100 [00:03<00:08,  8.29it/s] 31%|███       | 31/100 [00:03<00:07,  8.71it/s] 32%|███▏      | 32/100 [00:03<00:07,  9.01it/s] 33%|███▎      | 33/100 [00:03<00:07,  9.04it/s] 34%|███▍      | 34/100 [00:03<00:07,  8.51it/s] 35%|███▌      | 35/100 [00:04<00:08,  7.32it/s] 36%|███▌      | 36/100 [00:04<00:08,  7.54it/s] 37%|███▋      | 37/100 [00:04<00:08,  7.52it/s] 38%|███▊      | 38/100 [00:04<00:07,  7.89it/s] 39%|███▉      | 39/100 [00:04<00:13,  4.68it/s] 40%|████      | 40/100 [00:05<00:14,  4.19it/s] 41%|████      | 41/100 [00:05<00:11,  5.01it/s] 42%|████▏     | 42/100 [00:05<00:09,  5.83it/s] 43%|████▎     | 43/100 [00:05<00:08,  6.46it/s] 44%|████▍     | 44/100 [00:05<00:07,  7.01it/s] 45%|████▌     | 45/100 [00:05<00:07,  7.58it/s] 46%|████▌     | 46/100 [00:05<00:08,  6.70it/s] 47%|████▋     | 47/100 [00:06<00:10,  5.15it/s] 48%|████▊     | 48/100 [00:06<00:08,  5.95it/s] 49%|████▉     | 49/100 [00:06<00:07,  6.57it/s] 50%|█████     | 50/100 [00:06<00:06,  7.25it/s] 51%|█████     | 51/100 [00:06<00:06,  7.56it/s] 52%|█████▏    | 52/100 [00:06<00:06,  7.96it/s] 53%|█████▎    | 53/100 [00:06<00:05,  8.27it/s] 54%|█████▍    | 54/100 [00:07<00:05,  8.54it/s] 55%|█████▌    | 55/100 [00:07<00:05,  7.79it/s] 56%|█████▌    | 56/100 [00:07<00:05,  8.04it/s] 57%|█████▋    | 57/100 [00:07<00:07,  6.03it/s] 58%|█████▊    | 58/100 [00:07<00:06,  6.13it/s] 59%|█████▉    | 59/100 [00:07<00:06,  6.67it/s] 60%|██████    | 60/100 [00:07<00:05,  7.18it/s] 61%|██████    | 61/100 [00:08<00:05,  7.44it/s] 62%|██████▏   | 62/100 [00:08<00:04,  7.87it/s] 63%|██████▎   | 63/100 [00:08<00:04,  8.25it/s] 64%|██████▍   | 64/100 [00:08<00:04,  8.61it/s] 65%|██████▌   | 65/100 [00:08<00:04,  8.68it/s] 66%|██████▌   | 66/100 [00:08<00:05,  6.08it/s] 67%|██████▋   | 67/100 [00:09<00:05,  5.58it/s] 68%|██████▊   | 68/100 [00:09<00:05,  6.33it/s] 69%|██████▉   | 69/100 [00:09<00:04,  7.03it/s] 70%|███████   | 70/100 [00:09<00:03,  7.61it/s] 71%|███████   | 71/100 [00:09<00:03,  8.06it/s] 72%|███████▏  | 72/100 [00:09<00:03,  7.89it/s] 73%|███████▎  | 73/100 [00:09<00:03,  8.17it/s] 74%|███████▍  | 74/100 [00:09<00:03,  8.40it/s] 75%|███████▌  | 75/100 [00:09<00:03,  7.51it/s] 76%|███████▌  | 76/100 [00:10<00:03,  7.80it/s] 77%|███████▋  | 77/100 [00:10<00:02,  8.12it/s] 78%|███████▊  | 78/100 [00:10<00:02,  8.43it/s] 79%|███████▉  | 79/100 [00:10<00:03,  6.49it/s] 80%|████████  | 80/100 [00:10<00:02,  6.98it/s] 81%|████████  | 81/100 [00:10<00:02,  7.05it/s] 82%|████████▏ | 82/100 [00:10<00:02,  6.91it/s] 83%|████████▎ | 83/100 [00:11<00:02,  7.55it/s] 84%|████████▍ | 84/100 [00:11<00:02,  7.87it/s] 85%|████████▌ | 85/100 [00:11<00:02,  5.27it/s] 86%|████████▌ | 86/100 [00:11<00:02,  5.64it/s] 87%|████████▋ | 87/100 [00:11<00:02,  6.26it/s] 88%|████████▊ | 88/100 [00:11<00:01,  6.68it/s] 89%|████████▉ | 89/100 [00:11<00:01,  7.14it/s] 90%|█████████ | 90/100 [00:12<00:01,  7.58it/s] 91%|█████████ | 91/100 [00:12<00:01,  7.93it/s] 92%|█████████▏| 92/100 [00:12<00:01,  7.93it/s] 93%|█████████▎| 93/100 [00:12<00:00,  8.28it/s] 94%|█████████▍| 94/100 [00:12<00:00,  8.39it/s] 95%|█████████▌| 95/100 [00:12<00:00,  8.65it/s] 96%|█████████▌| 96/100 [00:12<00:00,  7.76it/s] 97%|█████████▋| 97/100 [00:12<00:00,  7.22it/s] 98%|█████████▊| 98/100 [00:13<00:00,  6.99it/s] 99%|█████████▉| 99/100 [00:13<00:00,  7.25it/s]100%|██████████| 100/100 [00:13<00:00,  6.06it/s]100%|██████████| 100/100 [00:13<00:00,  7.40it/s]
eval_p_index len:  16
individual_train 116
individual_eval 16
train data의 x, y, id 길이: 116 116 116
valid data의 x, y, id 길이: 9 9 9
test data의 x, y, id 길이: 7 7 7
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.915307, Valid_loss 0.844308
Epoch 2, Train Loss 0.870720, Valid_loss 0.792101
Epoch 3, Train Loss 0.795007, Valid_loss 0.741067
Epoch 4, Train Loss 0.756128, Valid_loss 0.713977
Epoch 5, Train Loss 0.740867, Valid_loss 0.702009
Epoch 6, Train Loss 0.733055, Valid_loss 0.695649
Epoch 7, Train Loss 0.726261, Valid_loss 0.690878
Epoch 8, Train Loss 0.720307, Valid_loss 0.687066
Epoch 9, Train Loss 0.724419, Valid_loss 0.684870
Epoch 10, Train Loss 0.727238, Valid_loss 0.682887
Epoch 11, Train Loss 0.706370, Valid_loss 0.680591
Epoch 12, Train Loss 0.700507, Valid_loss 0.677881
Epoch 13, Train Loss 0.693151, Valid_loss 0.675004
Epoch 14, Train Loss 0.694318, Valid_loss 0.673830
Epoch 15, Train Loss 0.692712, Valid_loss 0.672333
Epoch 16, Train Loss 0.695537, Valid_loss 0.670133
Epoch 17, Train Loss 0.693981, Valid_loss 0.667343
Epoch 18, Train Loss 0.678995, Valid_loss 0.665252
Epoch 19, Train Loss 0.685547, Valid_loss 0.661524
Epoch 20, Train Loss 0.678938, Valid_loss 0.657607
Epoch 21, Train Loss 0.657731, Valid_loss 0.654805
Epoch 22, Train Loss 0.657691, Valid_loss 0.648718
Epoch 23, Train Loss 0.650106, Valid_loss 0.640924
Epoch 24, Train Loss 0.648244, Valid_loss 0.633421
Epoch 25, Train Loss 0.637773, Valid_loss 0.628082
Epoch 26, Train Loss 0.638169, Valid_loss 0.623850
Epoch 27, Train Loss 0.625894, Valid_loss 0.616496
Epoch 28, Train Loss 0.617172, Valid_loss 0.610808
Epoch 29, Train Loss 0.612276, Valid_loss 0.605796
Epoch 30, Train Loss 0.608594, Valid_loss 0.600258
Epoch 31, Train Loss 0.596266, Valid_loss 0.596767
Epoch 32, Train Loss 0.608392, Valid_loss 0.589852
Epoch 33, Train Loss 0.600774, Valid_loss 0.585046
Epoch 34, Train Loss 0.587949, Valid_loss 0.584232
Epoch 35, Train Loss 0.581587, Valid_loss 0.579459
Epoch 36, Train Loss 0.591265, Valid_loss 0.573913
Epoch 37, Train Loss 0.574598, Valid_loss 0.571366
Epoch 38, Train Loss 0.578942, Valid_loss 0.567779
Epoch 39, Train Loss 0.579138, Valid_loss 0.564915
Epoch 40, Train Loss 0.563910, Valid_loss 0.566301
Epoch 41, Train Loss 0.556430, Valid_loss 0.563393
Epoch 42, Train Loss 0.560320, Valid_loss 0.559507
Epoch 43, Train Loss 0.552451, Valid_loss 0.554508
Epoch 44, Train Loss 0.562073, Valid_loss 0.549634
Epoch 45, Train Loss 0.562715, Valid_loss 0.550823
Epoch 46, Train Loss 0.542458, Valid_loss 0.548777
Epoch 47, Train Loss 0.537702, Valid_loss 0.542327
Epoch 48, Train Loss 0.551057, Valid_loss 0.544974
Epoch 49, Train Loss 0.542912, Valid_loss 0.540279
Epoch 50, Train Loss 0.539580, Valid_loss 0.537767
Epoch 51, Train Loss 0.529300, Valid_loss 0.533218
Epoch 52, Train Loss 0.535770, Valid_loss 0.531494
Epoch 53, Train Loss 0.532970, Valid_loss 0.531931
Epoch 54, Train Loss 0.530939, Valid_loss 0.533200
COVID19_Participant26 -- true: COVID-19 -- pred: COVID-19
COVID19_Participant26 -- true: COVID-19 -- pred: COVID-19
COVID19_Participant31 -- true: COVID-19 -- pred: COVID-19
COVID19_Participant13 -- true: COVID-19 -- pred: COVID-19
Control_Participant4 -- true: normal -- pred: COVID-19
Control_Participant7 -- true: normal -- pred: normal
Control_Participant7 -- true: normal -- pred: COVID-19
true :  [1, 1, 1, 1, 0, 0, 0]
pred :  [1, 1, 1, 1, 1, 0, 1]
Confusion Matrix: [1 2 0 4]
Best performance: Epoch 52, Loss 0.535770, Test ACC 0.714286, Test AUC 0.666667, Test Recall 1.000000, Test Precision 0.666667
✅ Total valid splits used: 3
🔁 Repeat 3, Fold 3
🔍 Split #4
  → train_p_index 환자 수: 25
  → test_p_index 환자 수: 7
  → train 환자 ID: ['COVID19_Participant11', 'COVID19_Participant13', 'COVID19_Participant14', 'COVID19_Participant15', 'COVID19_Participant17', 'COVID19_Participant19', 'COVID19_Participant2', 'COVID19_Participant23', 'COVID19_Participant25', 'COVID19_Participant29', 'COVID19_Participant31', 'COVID19_Participant37', 'COVID19_Participant39', 'COVID19_Participant40', 'COVID19_Participant7', 'COVID19_Participant8', 'Control_Participant1', 'Control_Participant10', 'Control_Participant11', 'Control_Participant15', 'Control_Participant4', 'Control_Participant5', 'Control_Participant7', 'Control_Participant8', 'Control_Participant9']
  → test  환자 ID: ['Control_Participant10', 'Control_Participant5', 'Control_Participant7', 'COVID19_Participant25', 'Control_Participant9', 'Control_Participant1', 'COVID19_Participant13']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant10, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant4, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant8, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: Control_Participant10, Label: 1
    ID: Control_Participant5, Label: 1
    ID: Control_Participant7, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: Control_Participant9, Label: 1
    ID: Control_Participant1, Label: 1
    ID: COVID19_Participant13, Label: 0
train_p_index_ 16
valid_p_index 9
test_p_index 7
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Ciliated Cells', 'Developing Ciliated Cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
data augment 실행 함
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:15,  6.60it/s]  2%|▏         | 2/100 [00:00<00:12,  8.12it/s]  3%|▎         | 3/100 [00:00<00:11,  8.79it/s]  5%|▌         | 5/100 [00:00<00:09,  9.80it/s]  6%|▌         | 6/100 [00:00<00:10,  9.25it/s]  8%|▊         | 8/100 [00:00<00:09,  9.93it/s]  9%|▉         | 9/100 [00:00<00:09,  9.78it/s] 10%|█         | 10/100 [00:01<00:09,  9.20it/s] 11%|█         | 11/100 [00:01<00:09,  9.18it/s] 12%|█▏        | 12/100 [00:01<00:10,  8.03it/s] 13%|█▎        | 13/100 [00:01<00:10,  8.30it/s] 14%|█▍        | 14/100 [00:01<00:09,  8.68it/s] 15%|█▌        | 15/100 [00:01<00:10,  8.38it/s] 17%|█▋        | 17/100 [00:01<00:09,  9.04it/s] 18%|█▊        | 18/100 [00:02<00:08,  9.19it/s] 19%|█▉        | 19/100 [00:02<00:08,  9.19it/s] 20%|██        | 20/100 [00:02<00:08,  9.37it/s] 21%|██        | 21/100 [00:02<00:08,  8.91it/s] 22%|██▏       | 22/100 [00:02<00:08,  9.04it/s] 23%|██▎       | 23/100 [00:02<00:08,  9.12it/s] 24%|██▍       | 24/100 [00:02<00:08,  9.32it/s] 26%|██▌       | 26/100 [00:02<00:07,  9.54it/s] 27%|██▋       | 27/100 [00:02<00:07,  9.41it/s] 28%|██▊       | 28/100 [00:03<00:07,  9.02it/s] 30%|███       | 30/100 [00:03<00:07,  9.73it/s] 31%|███       | 31/100 [00:03<00:07,  9.77it/s] 32%|███▏      | 32/100 [00:03<00:07,  9.33it/s] 33%|███▎      | 33/100 [00:03<00:07,  8.63it/s] 34%|███▍      | 34/100 [00:03<00:07,  8.75it/s] 35%|███▌      | 35/100 [00:03<00:07,  8.65it/s] 36%|███▌      | 36/100 [00:03<00:07,  8.95it/s] 38%|███▊      | 38/100 [00:04<00:06,  9.32it/s] 39%|███▉      | 39/100 [00:04<00:06,  9.28it/s] 41%|████      | 41/100 [00:04<00:06,  9.38it/s] 42%|████▏     | 42/100 [00:04<00:06,  9.42it/s] 44%|████▍     | 44/100 [00:04<00:06,  9.29it/s] 46%|████▌     | 46/100 [00:05<00:05,  9.65it/s] 47%|████▋     | 47/100 [00:05<00:05,  9.62it/s] 49%|████▉     | 49/100 [00:05<00:05,  9.83it/s] 50%|█████     | 50/100 [00:05<00:05,  9.68it/s] 51%|█████     | 51/100 [00:05<00:05,  9.52it/s] 52%|█████▏    | 52/100 [00:05<00:05,  9.24it/s] 53%|█████▎    | 53/100 [00:05<00:05,  9.26it/s] 54%|█████▍    | 54/100 [00:05<00:05,  9.12it/s] 55%|█████▌    | 55/100 [00:05<00:04,  9.12it/s] 56%|█████▌    | 56/100 [00:06<00:05,  8.76it/s] 58%|█████▊    | 58/100 [00:06<00:04,  9.21it/s] 59%|█████▉    | 59/100 [00:06<00:04,  9.18it/s] 60%|██████    | 60/100 [00:06<00:04,  9.27it/s] 61%|██████    | 61/100 [00:06<00:04,  9.20it/s] 62%|██████▏   | 62/100 [00:06<00:04,  9.27it/s] 64%|██████▍   | 64/100 [00:06<00:04,  8.98it/s] 65%|██████▌   | 65/100 [00:07<00:04,  8.33it/s] 66%|██████▌   | 66/100 [00:07<00:03,  8.66it/s] 67%|██████▋   | 67/100 [00:07<00:04,  7.70it/s] 68%|██████▊   | 68/100 [00:07<00:03,  8.02it/s] 69%|██████▉   | 69/100 [00:07<00:03,  8.22it/s] 70%|███████   | 70/100 [00:07<00:03,  8.47it/s] 72%|███████▏  | 72/100 [00:07<00:03,  8.84it/s] 74%|███████▍  | 74/100 [00:08<00:02,  9.34it/s] 75%|███████▌  | 75/100 [00:08<00:02,  8.97it/s] 76%|███████▌  | 76/100 [00:08<00:02,  9.18it/s] 77%|███████▋  | 77/100 [00:08<00:02,  9.07it/s] 78%|███████▊  | 78/100 [00:08<00:02,  8.68it/s] 79%|███████▉  | 79/100 [00:08<00:02,  8.22it/s] 80%|████████  | 80/100 [00:08<00:02,  8.58it/s] 81%|████████  | 81/100 [00:08<00:02,  8.62it/s] 82%|████████▏ | 82/100 [00:09<00:02,  8.42it/s] 83%|████████▎ | 83/100 [00:09<00:01,  8.58it/s] 84%|████████▍ | 84/100 [00:09<00:01,  8.08it/s] 85%|████████▌ | 85/100 [00:09<00:01,  8.27it/s] 87%|████████▋ | 87/100 [00:09<00:01,  8.97it/s] 88%|████████▊ | 88/100 [00:09<00:01,  9.11it/s] 89%|████████▉ | 89/100 [00:09<00:01,  8.95it/s] 90%|█████████ | 90/100 [00:09<00:01,  8.95it/s] 91%|█████████ | 91/100 [00:10<00:00,  9.07it/s] 92%|█████████▏| 92/100 [00:10<00:01,  6.45it/s] 93%|█████████▎| 93/100 [00:10<00:00,  7.03it/s] 94%|█████████▍| 94/100 [00:10<00:00,  7.52it/s] 95%|█████████▌| 95/100 [00:10<00:00,  8.08it/s] 96%|█████████▌| 96/100 [00:10<00:00,  8.20it/s] 97%|█████████▋| 97/100 [00:10<00:00,  8.47it/s] 98%|█████████▊| 98/100 [00:11<00:00,  8.52it/s] 99%|█████████▉| 99/100 [00:11<00:00,  8.36it/s]100%|██████████| 100/100 [00:11<00:00,  8.39it/s]100%|██████████| 100/100 [00:11<00:00,  8.87it/s]
eval_p_index len:  16
individual_train 116
individual_eval 16
train data의 x, y, id 길이: 116 116 116
valid data의 x, y, id 길이: 9 9 9
test data의 x, y, id 길이: 7 7 7
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.771180, Valid_loss 0.704177
Epoch 2, Train Loss 0.750242, Valid_loss 0.700012
Epoch 3, Train Loss 0.743641, Valid_loss 0.696332
Epoch 4, Train Loss 0.733815, Valid_loss 0.693195
Epoch 5, Train Loss 0.723982, Valid_loss 0.689078
Epoch 6, Train Loss 0.717650, Valid_loss 0.687706
Epoch 7, Train Loss 0.732585, Valid_loss 0.681822
Epoch 8, Train Loss 0.695919, Valid_loss 0.682482
Epoch 9, Train Loss 0.706496, Valid_loss 0.676648
Epoch 10, Train Loss 0.689401, Valid_loss 0.674751
Epoch 11, Train Loss 0.682304, Valid_loss 0.669528
Epoch 12, Train Loss 0.677372, Valid_loss 0.666472
Epoch 13, Train Loss 0.671426, Valid_loss 0.663990
Epoch 14, Train Loss 0.655679, Valid_loss 0.659571
Epoch 15, Train Loss 0.664122, Valid_loss 0.657489
Epoch 16, Train Loss 0.659762, Valid_loss 0.652086
Epoch 17, Train Loss 0.654859, Valid_loss 0.651091
Epoch 18, Train Loss 0.649399, Valid_loss 0.643358
Epoch 19, Train Loss 0.635282, Valid_loss 0.640119
Epoch 20, Train Loss 0.634136, Valid_loss 0.633372
Epoch 21, Train Loss 0.630827, Valid_loss 0.628541
Epoch 22, Train Loss 0.630703, Valid_loss 0.627063
Epoch 23, Train Loss 0.633694, Valid_loss 0.622572
Epoch 24, Train Loss 0.617680, Valid_loss 0.622487
Epoch 25, Train Loss 0.643328, Valid_loss 0.617613
Epoch 26, Train Loss 0.621730, Valid_loss 0.623698
Epoch 27, Train Loss 0.628102, Valid_loss 0.622519
Epoch 28, Train Loss 0.617454, Valid_loss 0.618641
Epoch 29, Train Loss 0.611563, Valid_loss 0.619106
Epoch 30, Train Loss 0.602302, Valid_loss 0.618635
Epoch 31, Train Loss 0.610661, Valid_loss 0.605633
Epoch 32, Train Loss 0.600755, Valid_loss 0.614089
Epoch 33, Train Loss 0.611639, Valid_loss 0.611982
Epoch 34, Train Loss 0.606914, Valid_loss 0.612480
Epoch 35, Train Loss 0.610219, Valid_loss 0.616051
Epoch 36, Train Loss 0.587617, Valid_loss 0.612052
Epoch 37, Train Loss 0.588037, Valid_loss 0.610546
Epoch 38, Train Loss 0.598419, Valid_loss 0.613977
Epoch 39, Train Loss 0.587650, Valid_loss 0.612514
Epoch 40, Train Loss 0.587627, Valid_loss 0.612092
Epoch 41, Train Loss 0.590865, Valid_loss 0.613907
Epoch 42, Train Loss 0.580183, Valid_loss 0.613519
Epoch 43, Train Loss 0.586372, Valid_loss 0.612863
Epoch 44, Train Loss 0.582139, Valid_loss 0.611625
Epoch 45, Train Loss 0.580419, Valid_loss 0.613381
Epoch 46, Train Loss 0.573182, Valid_loss 0.609333
Epoch 47, Train Loss 0.580483, Valid_loss 0.611008
Epoch 48, Train Loss 0.593762, Valid_loss 0.610617
Epoch 49, Train Loss 0.570393, Valid_loss 0.610056
Epoch 50, Train Loss 0.584667, Valid_loss 0.609521
Epoch 51, Train Loss 0.572386, Valid_loss 0.609955
Epoch 52, Train Loss 0.571128, Valid_loss 0.607955
Epoch 53, Train Loss 0.578365, Valid_loss 0.609520
Epoch 54, Train Loss 0.582057, Valid_loss 0.607179
Epoch 55, Train Loss 0.566197, Valid_loss 0.608883
Epoch 56, Train Loss 0.570974, Valid_loss 0.605909
Epoch 57, Train Loss 0.582799, Valid_loss 0.606406
Epoch 58, Train Loss 0.561579, Valid_loss 0.607134
Control_Participant10 -- true: normal -- pred: COVID-19
Control_Participant5 -- true: normal -- pred: normal
Control_Participant7 -- true: normal -- pred: normal
COVID19_Participant25 -- true: COVID-19 -- pred: COVID-19
Control_Participant9 -- true: normal -- pred: normal
Control_Participant1 -- true: normal -- pred: normal
COVID19_Participant13 -- true: COVID-19 -- pred: normal
true :  [0, 0, 0, 1, 0, 0, 1]
pred :  [1, 0, 0, 1, 0, 0, 0]
Confusion Matrix: [4 1 1 1]
Best performance: Epoch 31, Loss 0.610661, Test ACC 0.714286, Test AUC 0.700000, Test Recall 0.500000, Test Precision 0.500000
✅ Total valid splits used: 4
🔁 Repeat 3, Fold 4
🔍 Split #5
  → train_p_index 환자 수: 26
  → test_p_index 환자 수: 6
  → train 환자 ID: ['COVID19_Participant11', 'COVID19_Participant15', 'COVID19_Participant17', 'COVID19_Participant19', 'COVID19_Participant2', 'COVID19_Participant20', 'COVID19_Participant22', 'COVID19_Participant23', 'COVID19_Participant25', 'COVID19_Participant26', 'COVID19_Participant28', 'COVID19_Participant31', 'COVID19_Participant32', 'COVID19_Participant37', 'COVID19_Participant39', 'COVID19_Participant4', 'COVID19_Participant40', 'COVID19_Participant7', 'COVID19_Participant8', 'Control_Participant1', 'Control_Participant10', 'Control_Participant15', 'Control_Participant3', 'Control_Participant4', 'Control_Participant5', 'Control_Participant9']
  → test  환자 ID: ['COVID19_Participant26', 'Control_Participant4', 'COVID19_Participant11', 'COVID19_Participant25', 'COVID19_Participant31', 'Control_Participant5']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant10, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant4, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: COVID19_Participant26, Label: 1
    ID: Control_Participant4, Label: 1
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant25, Label: 0
    ID: COVID19_Participant31, Label: 0
    ID: Control_Participant5, Label: 0
train_p_index_ 17
valid_p_index 9
test_p_index 6
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Ciliated Cells', 'Ciliated Cells', 'Goblet Cells', 'Basal Cells', 'Ciliated Cells', 'Developing Secretory and Goblet Cells', 'Basal Cells', 'Ciliated Cells', 'Basal Cells', 'Developing Secretory and Goblet Cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
data augment 실행 함
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:16,  5.92it/s]  2%|▏         | 2/100 [00:00<00:13,  7.44it/s]  3%|▎         | 3/100 [00:00<00:11,  8.15it/s]  4%|▍         | 4/100 [00:00<00:11,  8.02it/s]  5%|▌         | 5/100 [00:00<00:12,  7.77it/s]  6%|▌         | 6/100 [00:00<00:11,  8.36it/s]  7%|▋         | 7/100 [00:00<00:10,  8.71it/s]  8%|▊         | 8/100 [00:00<00:10,  8.92it/s]  9%|▉         | 9/100 [00:01<00:11,  8.20it/s] 10%|█         | 10/100 [00:01<00:13,  6.68it/s] 12%|█▏        | 12/100 [00:01<00:11,  7.85it/s] 14%|█▍        | 14/100 [00:01<00:09,  8.67it/s] 16%|█▌        | 16/100 [00:01<00:09,  9.20it/s] 18%|█▊        | 18/100 [00:02<00:08,  9.47it/s] 19%|█▉        | 19/100 [00:02<00:10,  7.63it/s] 21%|██        | 21/100 [00:02<00:09,  8.38it/s] 23%|██▎       | 23/100 [00:02<00:09,  8.34it/s] 25%|██▌       | 25/100 [00:02<00:08,  8.88it/s] 27%|██▋       | 27/100 [00:03<00:07,  9.25it/s] 29%|██▉       | 29/100 [00:03<00:08,  8.16it/s] 30%|███       | 30/100 [00:03<00:08,  8.04it/s] 31%|███       | 31/100 [00:03<00:09,  6.98it/s] 32%|███▏      | 32/100 [00:03<00:09,  7.49it/s] 34%|███▍      | 34/100 [00:04<00:07,  8.42it/s] 36%|███▌      | 36/100 [00:04<00:07,  8.80it/s] 38%|███▊      | 38/100 [00:04<00:07,  8.24it/s] 39%|███▉      | 39/100 [00:04<00:07,  7.89it/s] 40%|████      | 40/100 [00:04<00:07,  7.69it/s] 41%|████      | 41/100 [00:05<00:07,  8.13it/s] 43%|████▎     | 43/100 [00:05<00:06,  8.92it/s] 44%|████▍     | 44/100 [00:05<00:06,  8.85it/s] 45%|████▌     | 45/100 [00:05<00:06,  8.45it/s] 46%|████▌     | 46/100 [00:05<00:06,  8.79it/s] 47%|████▋     | 47/100 [00:05<00:07,  7.30it/s] 49%|████▉     | 49/100 [00:05<00:06,  8.40it/s] 50%|█████     | 50/100 [00:06<00:05,  8.65it/s] 51%|█████     | 51/100 [00:06<00:05,  8.72it/s] 52%|█████▏    | 52/100 [00:06<00:05,  8.54it/s] 53%|█████▎    | 53/100 [00:06<00:05,  8.65it/s] 54%|█████▍    | 54/100 [00:06<00:05,  8.98it/s] 55%|█████▌    | 55/100 [00:06<00:04,  9.21it/s] 56%|█████▌    | 56/100 [00:06<00:04,  9.28it/s] 57%|█████▋    | 57/100 [00:06<00:04,  9.00it/s] 58%|█████▊    | 58/100 [00:06<00:05,  8.19it/s] 59%|█████▉    | 59/100 [00:07<00:04,  8.57it/s] 60%|██████    | 60/100 [00:07<00:06,  6.11it/s] 61%|██████    | 61/100 [00:07<00:05,  6.90it/s] 62%|██████▏   | 62/100 [00:07<00:05,  7.54it/s] 63%|██████▎   | 63/100 [00:07<00:04,  7.94it/s] 64%|██████▍   | 64/100 [00:07<00:04,  8.40it/s] 65%|██████▌   | 65/100 [00:07<00:03,  8.82it/s] 66%|██████▌   | 66/100 [00:07<00:03,  8.78it/s] 67%|██████▋   | 67/100 [00:08<00:03,  8.74it/s] 68%|██████▊   | 68/100 [00:08<00:03,  8.99it/s] 69%|██████▉   | 69/100 [00:08<00:03,  8.18it/s] 70%|███████   | 70/100 [00:08<00:03,  8.41it/s] 71%|███████   | 71/100 [00:08<00:03,  8.72it/s] 72%|███████▏  | 72/100 [00:08<00:03,  8.73it/s] 73%|███████▎  | 73/100 [00:08<00:03,  8.88it/s] 74%|███████▍  | 74/100 [00:08<00:02,  8.76it/s] 75%|███████▌  | 75/100 [00:09<00:02,  9.00it/s] 76%|███████▌  | 76/100 [00:09<00:02,  8.99it/s] 77%|███████▋  | 77/100 [00:09<00:02,  9.09it/s] 78%|███████▊  | 78/100 [00:09<00:02,  8.22it/s] 79%|███████▉  | 79/100 [00:09<00:02,  8.58it/s] 80%|████████  | 80/100 [00:09<00:02,  8.93it/s] 81%|████████  | 81/100 [00:09<00:02,  9.16it/s] 82%|████████▏ | 82/100 [00:09<00:01,  9.17it/s] 84%|████████▍ | 84/100 [00:09<00:01,  9.41it/s] 85%|████████▌ | 85/100 [00:10<00:02,  6.34it/s] 86%|████████▌ | 86/100 [00:10<00:02,  7.00it/s] 87%|████████▋ | 87/100 [00:10<00:01,  7.15it/s] 88%|████████▊ | 88/100 [00:10<00:01,  6.89it/s] 89%|████████▉ | 89/100 [00:10<00:01,  7.50it/s] 90%|█████████ | 90/100 [00:10<00:01,  7.63it/s] 91%|█████████ | 91/100 [00:11<00:01,  7.67it/s] 92%|█████████▏| 92/100 [00:11<00:00,  8.12it/s] 93%|█████████▎| 93/100 [00:11<00:00,  8.53it/s] 95%|█████████▌| 95/100 [00:11<00:00,  9.20it/s] 96%|█████████▌| 96/100 [00:11<00:00,  9.20it/s] 97%|█████████▋| 97/100 [00:11<00:00,  9.02it/s] 98%|█████████▊| 98/100 [00:11<00:00,  9.03it/s] 99%|█████████▉| 99/100 [00:11<00:00,  9.03it/s]100%|██████████| 100/100 [00:12<00:00,  7.46it/s]100%|██████████| 100/100 [00:12<00:00,  8.26it/s]
eval_p_index len:  15
individual_train 117
individual_eval 15
train data의 x, y, id 길이: 117 117 117
valid data의 x, y, id 길이: 9 9 9
test data의 x, y, id 길이: 6 6 6
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.828212, Valid_loss 0.721606
Epoch 2, Train Loss 0.808326, Valid_loss 0.714823
Epoch 3, Train Loss 0.781364, Valid_loss 0.710328
Epoch 4, Train Loss 0.770128, Valid_loss 0.708422
Epoch 5, Train Loss 0.766683, Valid_loss 0.707053
Epoch 6, Train Loss 0.757355, Valid_loss 0.704862
Epoch 7, Train Loss 0.742469, Valid_loss 0.700814
Epoch 8, Train Loss 0.734362, Valid_loss 0.694169
Epoch 9, Train Loss 0.732392, Valid_loss 0.683456
Epoch 10, Train Loss 0.717643, Valid_loss 0.675309
Epoch 11, Train Loss 0.707849, Valid_loss 0.673814
Epoch 12, Train Loss 0.703703, Valid_loss 0.664139
Epoch 13, Train Loss 0.704651, Valid_loss 0.663575
Epoch 14, Train Loss 0.699295, Valid_loss 0.659557
Epoch 15, Train Loss 0.691063, Valid_loss 0.649600
Epoch 16, Train Loss 0.695941, Valid_loss 0.652431
Epoch 17, Train Loss 0.694247, Valid_loss 0.646056
Epoch 18, Train Loss 0.695307, Valid_loss 0.645394
Epoch 19, Train Loss 0.689265, Valid_loss 0.643898
Epoch 20, Train Loss 0.688863, Valid_loss 0.644363
Epoch 21, Train Loss 0.692158, Valid_loss 0.635876
Epoch 22, Train Loss 0.686131, Valid_loss 0.640624
Epoch 23, Train Loss 0.685758, Valid_loss 0.632970
Epoch 24, Train Loss 0.683750, Valid_loss 0.639237
Epoch 25, Train Loss 0.682966, Valid_loss 0.629772
Epoch 26, Train Loss 0.683156, Valid_loss 0.631979
Epoch 27, Train Loss 0.678813, Valid_loss 0.627210
Epoch 28, Train Loss 0.679612, Valid_loss 0.627032
Epoch 29, Train Loss 0.677768, Valid_loss 0.629101
Epoch 30, Train Loss 0.676561, Valid_loss 0.622460
Epoch 31, Train Loss 0.677480, Valid_loss 0.627885
Epoch 32, Train Loss 0.679125, Valid_loss 0.623053
Epoch 33, Train Loss 0.671899, Valid_loss 0.620255
Epoch 34, Train Loss 0.671719, Valid_loss 0.619538
Epoch 35, Train Loss 0.672144, Valid_loss 0.617219
Epoch 36, Train Loss 0.678178, Valid_loss 0.617858
Epoch 37, Train Loss 0.665753, Valid_loss 0.620670
Epoch 38, Train Loss 0.666869, Valid_loss 0.617134
Epoch 39, Train Loss 0.668660, Valid_loss 0.614910
Epoch 40, Train Loss 0.666660, Valid_loss 0.612369
Epoch 41, Train Loss 0.660121, Valid_loss 0.614146
Epoch 42, Train Loss 0.663219, Valid_loss 0.611939
Epoch 43, Train Loss 0.661492, Valid_loss 0.609064
Epoch 44, Train Loss 0.659463, Valid_loss 0.610233
Epoch 45, Train Loss 0.657936, Valid_loss 0.606123
Epoch 46, Train Loss 0.659516, Valid_loss 0.605165
Epoch 47, Train Loss 0.658342, Valid_loss 0.604798
Epoch 48, Train Loss 0.655377, Valid_loss 0.602304
Epoch 49, Train Loss 0.652868, Valid_loss 0.599999
Epoch 50, Train Loss 0.646049, Valid_loss 0.603629
Epoch 51, Train Loss 0.653850, Valid_loss 0.599948
Epoch 52, Train Loss 0.650515, Valid_loss 0.599819
Epoch 53, Train Loss 0.644830, Valid_loss 0.599319
Epoch 54, Train Loss 0.644873, Valid_loss 0.600442
Epoch 55, Train Loss 0.637423, Valid_loss 0.595439
Epoch 56, Train Loss 0.638707, Valid_loss 0.595054
Epoch 57, Train Loss 0.637592, Valid_loss 0.595857
Epoch 58, Train Loss 0.639459, Valid_loss 0.593278
Epoch 59, Train Loss 0.632733, Valid_loss 0.591506
Epoch 60, Train Loss 0.634831, Valid_loss 0.586808
Epoch 61, Train Loss 0.627773, Valid_loss 0.587534
Epoch 62, Train Loss 0.628707, Valid_loss 0.585603
Epoch 63, Train Loss 0.623537, Valid_loss 0.582241
Epoch 64, Train Loss 0.623702, Valid_loss 0.579548
Epoch 65, Train Loss 0.618885, Valid_loss 0.577231
Epoch 66, Train Loss 0.616886, Valid_loss 0.575745
Epoch 67, Train Loss 0.616306, Valid_loss 0.574012
Epoch 68, Train Loss 0.615952, Valid_loss 0.571331
Epoch 69, Train Loss 0.617872, Valid_loss 0.568920
Epoch 70, Train Loss 0.613414, Valid_loss 0.564692
Epoch 71, Train Loss 0.612519, Valid_loss 0.566347
Epoch 72, Train Loss 0.615652, Valid_loss 0.559726
Epoch 73, Train Loss 0.603809, Valid_loss 0.561304
Epoch 74, Train Loss 0.605674, Valid_loss 0.558614
Epoch 75, Train Loss 0.607002, Valid_loss 0.555508
Epoch 76, Train Loss 0.604245, Valid_loss 0.554170
Epoch 77, Train Loss 0.600575, Valid_loss 0.552173
Epoch 78, Train Loss 0.598381, Valid_loss 0.548796
Epoch 79, Train Loss 0.597693, Valid_loss 0.546768
Epoch 80, Train Loss 0.592121, Valid_loss 0.544885
Epoch 81, Train Loss 0.587532, Valid_loss 0.542063
Epoch 82, Train Loss 0.584755, Valid_loss 0.538137
Epoch 83, Train Loss 0.590747, Valid_loss 0.536474
Epoch 84, Train Loss 0.593620, Valid_loss 0.532818
Epoch 85, Train Loss 0.582597, Valid_loss 0.531334
Epoch 86, Train Loss 0.588116, Valid_loss 0.528121
Epoch 87, Train Loss 0.583460, Valid_loss 0.528331
Epoch 88, Train Loss 0.584074, Valid_loss 0.525121
Epoch 89, Train Loss 0.589043, Valid_loss 0.523284
Epoch 90, Train Loss 0.581142, Valid_loss 0.524384
Epoch 91, Train Loss 0.578089, Valid_loss 0.519016
Epoch 92, Train Loss 0.575782, Valid_loss 0.519349
Epoch 93, Train Loss 0.567732, Valid_loss 0.519001
Epoch 94, Train Loss 0.580255, Valid_loss 0.517594
Epoch 95, Train Loss 0.575309, Valid_loss 0.516232
Epoch 96, Train Loss 0.570771, Valid_loss 0.516621
Epoch 97, Train Loss 0.564564, Valid_loss 0.514345
Epoch 98, Train Loss 0.570517, Valid_loss 0.513417
Epoch 99, Train Loss 0.564441, Valid_loss 0.515181
Epoch 100, Train Loss 0.565810, Valid_loss 0.514458
COVID19_Participant26 -- true: COVID-19 -- pred: COVID-19
Control_Participant4 -- true: normal -- pred: COVID-19
COVID19_Participant11 -- true: COVID-19 -- pred: normal
COVID19_Participant25 -- true: COVID-19 -- pred: COVID-19
COVID19_Participant31 -- true: COVID-19 -- pred: COVID-19
Control_Participant5 -- true: normal -- pred: COVID-19
true :  [1, 0, 1, 1, 1, 0]
pred :  [1, 1, 0, 1, 1, 1]
Confusion Matrix: [0 2 1 3]
Best performance: Epoch 98, Loss 0.570517, Test ACC 0.500000, Test AUC 0.500000, Test Recall 0.750000, Test Precision 0.600000
✅ Total valid splits used: 5

📌 Repeat 3: 평균 AUC = 0.6733, 표준편차 = 0.1831
🔁 Repeat 4, Fold 0
🔍 Split #1
  → train_p_index 환자 수: 27
  → test_p_index 환자 수: 5
  → train 환자 ID: ['COVID19_Participant11', 'COVID19_Participant13', 'COVID19_Participant14', 'COVID19_Participant15', 'COVID19_Participant17', 'COVID19_Participant19', 'COVID19_Participant2', 'COVID19_Participant22', 'COVID19_Participant23', 'COVID19_Participant25', 'COVID19_Participant26', 'COVID19_Participant28', 'COVID19_Participant37', 'COVID19_Participant39', 'COVID19_Participant4', 'COVID19_Participant40', 'COVID19_Participant7', 'COVID19_Participant8', 'Control_Participant1', 'Control_Participant11', 'Control_Participant15', 'Control_Participant3', 'Control_Participant4', 'Control_Participant5', 'Control_Participant7', 'Control_Participant8', 'Control_Participant9']
  → test  환자 ID: ['COVID19_Participant11', 'Control_Participant5', 'Control_Participant7', 'COVID19_Participant26', 'Control_Participant7']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant4, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant8, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: COVID19_Participant11, Label: 1
    ID: Control_Participant5, Label: 1
    ID: Control_Participant7, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: Control_Participant7, Label: 0
train_p_index_ 18
valid_p_index 9
test_p_index 5
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Ciliated Cells', 'Developing Ciliated Cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
data augment 실행 함
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:10,  9.39it/s]  2%|▏         | 2/100 [00:00<00:10,  9.29it/s]  4%|▍         | 4/100 [00:00<00:09,  9.72it/s]  6%|▌         | 6/100 [00:00<00:09, 10.35it/s]  8%|▊         | 8/100 [00:00<00:11,  8.33it/s]  9%|▉         | 9/100 [00:01<00:11,  8.23it/s] 11%|█         | 11/100 [00:01<00:09,  9.03it/s] 12%|█▏        | 12/100 [00:01<00:09,  9.08it/s] 13%|█▎        | 13/100 [00:01<00:09,  9.08it/s] 14%|█▍        | 14/100 [00:01<00:09,  9.21it/s] 15%|█▌        | 15/100 [00:01<00:09,  9.32it/s] 16%|█▌        | 16/100 [00:01<00:08,  9.39it/s] 17%|█▋        | 17/100 [00:01<00:08,  9.29it/s] 18%|█▊        | 18/100 [00:01<00:09,  8.97it/s] 19%|█▉        | 19/100 [00:02<00:09,  8.73it/s] 20%|██        | 20/100 [00:02<00:09,  8.53it/s] 21%|██        | 21/100 [00:02<00:09,  8.72it/s] 23%|██▎       | 23/100 [00:02<00:08,  9.27it/s] 24%|██▍       | 24/100 [00:02<00:08,  9.43it/s] 25%|██▌       | 25/100 [00:02<00:08,  8.59it/s] 27%|██▋       | 27/100 [00:02<00:08,  8.99it/s] 28%|██▊       | 28/100 [00:03<00:07,  9.04it/s] 29%|██▉       | 29/100 [00:03<00:07,  9.00it/s] 30%|███       | 30/100 [00:03<00:07,  9.22it/s] 31%|███       | 31/100 [00:03<00:07,  9.06it/s] 32%|███▏      | 32/100 [00:03<00:07,  8.99it/s] 33%|███▎      | 33/100 [00:03<00:07,  8.47it/s] 34%|███▍      | 34/100 [00:03<00:07,  8.59it/s] 35%|███▌      | 35/100 [00:03<00:08,  7.58it/s] 36%|███▌      | 36/100 [00:04<00:08,  7.84it/s] 37%|███▋      | 37/100 [00:04<00:07,  8.35it/s] 38%|███▊      | 38/100 [00:04<00:07,  8.51it/s] 39%|███▉      | 39/100 [00:04<00:07,  8.66it/s] 41%|████      | 41/100 [00:04<00:06,  8.89it/s] 42%|████▏     | 42/100 [00:04<00:06,  8.44it/s] 43%|████▎     | 43/100 [00:04<00:06,  8.71it/s] 44%|████▍     | 44/100 [00:04<00:06,  8.80it/s] 45%|████▌     | 45/100 [00:05<00:06,  9.03it/s] 46%|████▌     | 46/100 [00:05<00:05,  9.17it/s] 47%|████▋     | 47/100 [00:05<00:05,  9.22it/s] 48%|████▊     | 48/100 [00:05<00:05,  9.19it/s] 50%|█████     | 50/100 [00:05<00:05,  9.56it/s] 51%|█████     | 51/100 [00:05<00:05,  9.37it/s] 52%|█████▏    | 52/100 [00:05<00:05,  9.36it/s] 53%|█████▎    | 53/100 [00:05<00:05,  9.16it/s] 54%|█████▍    | 54/100 [00:06<00:05,  9.16it/s] 55%|█████▌    | 55/100 [00:06<00:06,  7.14it/s] 56%|█████▌    | 56/100 [00:06<00:08,  5.40it/s] 57%|█████▋    | 57/100 [00:06<00:06,  6.15it/s] 58%|█████▊    | 58/100 [00:06<00:06,  6.65it/s] 59%|█████▉    | 59/100 [00:06<00:05,  7.30it/s] 61%|██████    | 61/100 [00:07<00:04,  8.35it/s] 63%|██████▎   | 63/100 [00:07<00:04,  8.89it/s] 64%|██████▍   | 64/100 [00:07<00:04,  8.68it/s] 65%|██████▌   | 65/100 [00:07<00:04,  8.73it/s] 67%|██████▋   | 67/100 [00:07<00:03,  9.03it/s] 68%|██████▊   | 68/100 [00:07<00:03,  8.59it/s] 69%|██████▉   | 69/100 [00:07<00:03,  8.75it/s] 70%|███████   | 70/100 [00:08<00:03,  8.39it/s] 71%|███████   | 71/100 [00:08<00:03,  8.63it/s] 72%|███████▏  | 72/100 [00:08<00:03,  8.75it/s] 73%|███████▎  | 73/100 [00:08<00:03,  8.74it/s] 74%|███████▍  | 74/100 [00:08<00:02,  9.01it/s] 75%|███████▌  | 75/100 [00:08<00:02,  9.07it/s] 76%|███████▌  | 76/100 [00:08<00:02,  9.17it/s] 77%|███████▋  | 77/100 [00:08<00:02,  9.22it/s] 78%|███████▊  | 78/100 [00:08<00:02,  9.04it/s] 79%|███████▉  | 79/100 [00:09<00:02,  9.00it/s] 80%|████████  | 80/100 [00:09<00:02,  8.93it/s] 81%|████████  | 81/100 [00:09<00:02,  8.51it/s] 82%|████████▏ | 82/100 [00:09<00:02,  8.26it/s] 83%|████████▎ | 83/100 [00:09<00:02,  8.20it/s] 84%|████████▍ | 84/100 [00:09<00:01,  8.49it/s] 85%|████████▌ | 85/100 [00:09<00:01,  8.72it/s] 87%|████████▋ | 87/100 [00:10<00:01,  9.42it/s] 88%|████████▊ | 88/100 [00:10<00:01,  8.29it/s] 89%|████████▉ | 89/100 [00:10<00:01,  8.56it/s] 90%|█████████ | 90/100 [00:10<00:01,  8.83it/s] 91%|█████████ | 91/100 [00:10<00:01,  8.99it/s] 92%|█████████▏| 92/100 [00:10<00:00,  9.01it/s] 93%|█████████▎| 93/100 [00:10<00:00,  8.98it/s] 94%|█████████▍| 94/100 [00:10<00:00,  6.07it/s] 95%|█████████▌| 95/100 [00:11<00:00,  6.58it/s] 96%|█████████▌| 96/100 [00:11<00:00,  7.16it/s] 97%|█████████▋| 97/100 [00:11<00:00,  7.25it/s] 98%|█████████▊| 98/100 [00:11<00:00,  7.54it/s] 99%|█████████▉| 99/100 [00:11<00:00,  6.95it/s]100%|██████████| 100/100 [00:11<00:00,  7.37it/s]100%|██████████| 100/100 [00:11<00:00,  8.50it/s]
eval_p_index len:  14
individual_train 118
individual_eval 14
train data의 x, y, id 길이: 118 118 118
valid data의 x, y, id 길이: 9 9 9
test data의 x, y, id 길이: 5 5 5
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.598052, Valid_loss 0.729388
Epoch 2, Train Loss 0.578271, Valid_loss 0.729746
Epoch 3, Train Loss 0.612668, Valid_loss 0.730304
Epoch 4, Train Loss 0.591973, Valid_loss 0.730065
Epoch 5, Train Loss 0.587498, Valid_loss 0.729629
Epoch 6, Train Loss 0.582641, Valid_loss 0.728889
Epoch 7, Train Loss 0.581261, Valid_loss 0.727843
Epoch 8, Train Loss 0.576662, Valid_loss 0.725680
Epoch 9, Train Loss 0.584561, Valid_loss 0.721712
Epoch 10, Train Loss 0.589121, Valid_loss 0.713630
Epoch 11, Train Loss 0.567541, Valid_loss 0.705790
Epoch 12, Train Loss 0.561130, Valid_loss 0.696280
Epoch 13, Train Loss 0.547827, Valid_loss 0.673267
Epoch 14, Train Loss 0.532658, Valid_loss 0.660868
Epoch 15, Train Loss 0.496018, Valid_loss 0.614459
Epoch 16, Train Loss 0.501674, Valid_loss 0.597898
Epoch 17, Train Loss 0.493142, Valid_loss 0.591241
Epoch 18, Train Loss 0.482664, Valid_loss 0.579402
Epoch 19, Train Loss 0.478624, Valid_loss 0.555819
Epoch 20, Train Loss 0.465364, Valid_loss 0.566439
Epoch 21, Train Loss 0.464623, Valid_loss 0.576164
Epoch 22, Train Loss 0.473257, Valid_loss 0.571030
Epoch 23, Train Loss 0.468830, Valid_loss 0.550280
Epoch 24, Train Loss 0.460072, Valid_loss 0.589252
Epoch 25, Train Loss 0.469733, Valid_loss 0.559518
Epoch 26, Train Loss 0.455411, Valid_loss 0.557105
Epoch 27, Train Loss 0.455005, Valid_loss 0.570384
Epoch 28, Train Loss 0.465970, Valid_loss 0.571123
Epoch 29, Train Loss 0.453645, Valid_loss 0.554875
Epoch 30, Train Loss 0.447852, Valid_loss 0.571894
Epoch 31, Train Loss 0.446992, Valid_loss 0.566739
Epoch 32, Train Loss 0.439458, Valid_loss 0.571588
Epoch 33, Train Loss 0.441606, Valid_loss 0.571475
Epoch 34, Train Loss 0.444037, Valid_loss 0.571107
Epoch 35, Train Loss 0.448129, Valid_loss 0.570410
Epoch 36, Train Loss 0.443918, Valid_loss 0.559680
Epoch 37, Train Loss 0.449255, Valid_loss 0.575903
Epoch 38, Train Loss 0.438664, Valid_loss 0.560743
Epoch 39, Train Loss 0.441589, Valid_loss 0.575322
Epoch 40, Train Loss 0.434971, Valid_loss 0.569907
Epoch 41, Train Loss 0.434506, Valid_loss 0.569458
Epoch 42, Train Loss 0.433058, Valid_loss 0.565703
Epoch 43, Train Loss 0.418723, Valid_loss 0.556257
Epoch 44, Train Loss 0.423667, Valid_loss 0.561333
Epoch 45, Train Loss 0.418757, Valid_loss 0.545030
Epoch 46, Train Loss 0.423076, Valid_loss 0.569140
Epoch 47, Train Loss 0.439553, Valid_loss 0.546884
Epoch 48, Train Loss 0.414529, Valid_loss 0.552248
Epoch 49, Train Loss 0.424677, Valid_loss 0.557757
Epoch 50, Train Loss 0.427237, Valid_loss 0.548823
Epoch 51, Train Loss 0.422207, Valid_loss 0.552042
Epoch 52, Train Loss 0.414768, Valid_loss 0.558514
COVID19_Participant11 -- true: COVID-19 -- pred: normal
Control_Participant5 -- true: normal -- pred: COVID-19
Control_Participant7 -- true: normal -- pred: COVID-19
COVID19_Participant26 -- true: COVID-19 -- pred: COVID-19
Control_Participant7 -- true: normal -- pred: COVID-19
true :  [1, 0, 0, 1, 0]
pred :  [0, 1, 1, 1, 1]
Confusion Matrix: [0 3 1 1]
Best performance: Epoch 45, Loss 0.418757, Test ACC 0.200000, Test AUC 0.000000, Test Recall 0.500000, Test Precision 0.250000
✅ Total valid splits used: 1
🔁 Repeat 4, Fold 1
🔍 Split #2
  → train_p_index 환자 수: 27
  → test_p_index 환자 수: 5
  → train 환자 ID: ['COVID19_Participant11', 'COVID19_Participant13', 'COVID19_Participant14', 'COVID19_Participant15', 'COVID19_Participant17', 'COVID19_Participant19', 'COVID19_Participant2', 'COVID19_Participant20', 'COVID19_Participant22', 'COVID19_Participant23', 'COVID19_Participant25', 'COVID19_Participant26', 'COVID19_Participant29', 'COVID19_Participant31', 'COVID19_Participant32', 'COVID19_Participant37', 'COVID19_Participant4', 'COVID19_Participant40', 'COVID19_Participant7', 'Control_Participant10', 'Control_Participant11', 'Control_Participant15', 'Control_Participant3', 'Control_Participant4', 'Control_Participant7', 'Control_Participant8', 'Control_Participant9']
  → test  환자 ID: ['COVID19_Participant31', 'COVID19_Participant26', 'COVID19_Participant13', 'Control_Participant7', 'Control_Participant7']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: Control_Participant10, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant4, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant8, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: Control_Participant7, Label: 0
    ID: Control_Participant7, Label: 0
train_p_index_ 18
valid_p_index 9
test_p_index 5
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Ciliated Cells', 'Developing Ciliated Cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
data augment 실행 함
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  2%|▏         | 2/100 [00:00<00:09,  9.88it/s]  3%|▎         | 3/100 [00:00<00:11,  8.49it/s]  5%|▌         | 5/100 [00:00<00:09,  9.75it/s]  7%|▋         | 7/100 [00:00<00:09, 10.06it/s]  9%|▉         | 9/100 [00:00<00:08, 10.25it/s] 11%|█         | 11/100 [00:01<00:09,  9.15it/s] 13%|█▎        | 13/100 [00:01<00:09,  9.56it/s] 14%|█▍        | 14/100 [00:01<00:08,  9.58it/s] 15%|█▌        | 15/100 [00:01<00:08,  9.49it/s] 17%|█▋        | 17/100 [00:01<00:08, 10.08it/s] 19%|█▉        | 19/100 [00:01<00:07, 10.24it/s] 21%|██        | 21/100 [00:02<00:07, 10.12it/s] 23%|██▎       | 23/100 [00:02<00:07, 10.24it/s] 25%|██▌       | 25/100 [00:02<00:07, 10.29it/s] 27%|██▋       | 27/100 [00:02<00:06, 10.46it/s] 29%|██▉       | 29/100 [00:02<00:06, 10.34it/s] 31%|███       | 31/100 [00:03<00:08,  8.49it/s] 32%|███▏      | 32/100 [00:03<00:07,  8.72it/s] 33%|███▎      | 33/100 [00:03<00:07,  8.94it/s] 35%|███▌      | 35/100 [00:03<00:06,  9.43it/s] 37%|███▋      | 37/100 [00:03<00:06,  9.78it/s] 38%|███▊      | 38/100 [00:03<00:06,  9.60it/s] 40%|████      | 40/100 [00:04<00:06,  9.92it/s] 42%|████▏     | 42/100 [00:04<00:06,  8.34it/s] 44%|████▍     | 44/100 [00:04<00:06,  8.55it/s] 45%|████▌     | 45/100 [00:04<00:06,  8.64it/s] 46%|████▌     | 46/100 [00:04<00:06,  8.58it/s] 47%|████▋     | 47/100 [00:04<00:06,  8.77it/s] 48%|████▊     | 48/100 [00:05<00:05,  8.83it/s] 50%|█████     | 50/100 [00:05<00:05,  9.04it/s] 51%|█████     | 51/100 [00:05<00:07,  6.30it/s] 52%|█████▏    | 52/100 [00:05<00:06,  6.91it/s] 54%|█████▍    | 54/100 [00:05<00:05,  8.05it/s] 55%|█████▌    | 55/100 [00:06<00:05,  8.38it/s] 56%|█████▌    | 56/100 [00:06<00:05,  8.66it/s] 58%|█████▊    | 58/100 [00:06<00:04,  8.61it/s] 59%|█████▉    | 59/100 [00:06<00:05,  7.90it/s] 60%|██████    | 60/100 [00:06<00:04,  8.24it/s] 62%|██████▏   | 62/100 [00:06<00:04,  8.39it/s] 64%|██████▍   | 64/100 [00:07<00:04,  7.20it/s] 65%|██████▌   | 65/100 [00:07<00:04,  7.61it/s] 67%|██████▋   | 67/100 [00:07<00:03,  8.43it/s] 69%|██████▉   | 69/100 [00:07<00:03,  9.04it/s] 70%|███████   | 70/100 [00:08<00:04,  6.23it/s] 72%|███████▏  | 72/100 [00:08<00:04,  6.85it/s] 73%|███████▎  | 73/100 [00:08<00:03,  7.02it/s] 74%|███████▍  | 74/100 [00:08<00:03,  6.96it/s] 75%|███████▌  | 75/100 [00:08<00:03,  7.31it/s] 76%|███████▌  | 76/100 [00:08<00:04,  5.84it/s] 78%|███████▊  | 78/100 [00:09<00:03,  6.57it/s] 80%|████████  | 80/100 [00:09<00:02,  6.83it/s] 81%|████████  | 81/100 [00:09<00:02,  6.64it/s] 82%|████████▏ | 82/100 [00:09<00:02,  7.12it/s] 83%|████████▎ | 83/100 [00:09<00:02,  7.65it/s] 84%|████████▍ | 84/100 [00:09<00:01,  8.14it/s] 86%|████████▌ | 86/100 [00:10<00:01,  8.96it/s] 87%|████████▋ | 87/100 [00:10<00:01,  8.01it/s] 88%|████████▊ | 88/100 [00:10<00:01,  7.94it/s] 89%|████████▉ | 89/100 [00:10<00:01,  8.39it/s] 91%|█████████ | 91/100 [00:10<00:00,  9.06it/s] 92%|█████████▏| 92/100 [00:10<00:00,  8.06it/s] 93%|█████████▎| 93/100 [00:11<00:00,  8.42it/s] 95%|█████████▌| 95/100 [00:11<00:00,  8.99it/s] 97%|█████████▋| 97/100 [00:11<00:00,  9.50it/s] 99%|█████████▉| 99/100 [00:11<00:00,  9.79it/s]100%|██████████| 100/100 [00:11<00:00,  8.54it/s]
eval_p_index len:  14
individual_train 118
individual_eval 14
train data의 x, y, id 길이: 118 118 118
valid data의 x, y, id 길이: 9 9 9
test data의 x, y, id 길이: 5 5 5
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.579538, Valid_loss 0.728830
Epoch 2, Train Loss 0.589261, Valid_loss 0.725825
Epoch 3, Train Loss 0.562228, Valid_loss 0.720922
Epoch 4, Train Loss 0.579534, Valid_loss 0.712876
Epoch 5, Train Loss 0.573277, Valid_loss 0.695722
Epoch 6, Train Loss 0.549695, Valid_loss 0.678581
Epoch 7, Train Loss 0.547243, Valid_loss 0.665923
Epoch 8, Train Loss 0.518015, Valid_loss 0.671826
Epoch 9, Train Loss 0.525176, Valid_loss 0.668668
Epoch 10, Train Loss 0.512483, Valid_loss 0.667532
Epoch 11, Train Loss 0.518042, Valid_loss 0.667905
Epoch 12, Train Loss 0.500782, Valid_loss 0.667254
Epoch 13, Train Loss 0.498772, Valid_loss 0.657770
Epoch 14, Train Loss 0.506569, Valid_loss 0.651712
Epoch 15, Train Loss 0.496960, Valid_loss 0.643452
Epoch 16, Train Loss 0.476355, Valid_loss 0.641235
Epoch 17, Train Loss 0.475542, Valid_loss 0.633674
Epoch 18, Train Loss 0.467333, Valid_loss 0.628683
Epoch 19, Train Loss 0.474058, Valid_loss 0.627780
Epoch 20, Train Loss 0.459448, Valid_loss 0.624295
Epoch 21, Train Loss 0.453799, Valid_loss 0.624098
Epoch 22, Train Loss 0.457317, Valid_loss 0.626000
Epoch 23, Train Loss 0.440452, Valid_loss 0.626350
Epoch 24, Train Loss 0.455175, Valid_loss 0.630977
Epoch 25, Train Loss 0.433359, Valid_loss 0.624952
Epoch 26, Train Loss 0.432058, Valid_loss 0.632318
Epoch 27, Train Loss 0.433297, Valid_loss 0.631354
Epoch 28, Train Loss 0.430602, Valid_loss 0.633246
Epoch 29, Train Loss 0.424024, Valid_loss 0.632696
Epoch 30, Train Loss 0.425376, Valid_loss 0.637513
Epoch 31, Train Loss 0.425115, Valid_loss 0.637824
Epoch 32, Train Loss 0.415941, Valid_loss 0.639454
Epoch 33, Train Loss 0.424315, Valid_loss 0.643047
Epoch 34, Train Loss 0.423835, Valid_loss 0.642388
Epoch 35, Train Loss 0.423131, Valid_loss 0.642935
Epoch 36, Train Loss 0.411508, Valid_loss 0.643981
Epoch 37, Train Loss 0.410431, Valid_loss 0.643360
Epoch 38, Train Loss 0.418064, Valid_loss 0.646109
Epoch 39, Train Loss 0.416239, Valid_loss 0.645002
Epoch 40, Train Loss 0.410484, Valid_loss 0.643347
Epoch 41, Train Loss 0.407036, Valid_loss 0.646532
Epoch 42, Train Loss 0.410623, Valid_loss 0.643911
Epoch 43, Train Loss 0.402660, Valid_loss 0.648436
Epoch 44, Train Loss 0.412495, Valid_loss 0.643504
Epoch 45, Train Loss 0.406067, Valid_loss 0.648567
Epoch 46, Train Loss 0.398453, Valid_loss 0.644531
Epoch 47, Train Loss 0.406643, Valid_loss 0.647116
Epoch 48, Train Loss 0.418622, Valid_loss 0.643599
Epoch 49, Train Loss 0.398602, Valid_loss 0.647111
Epoch 50, Train Loss 0.404914, Valid_loss 0.644707
Epoch 51, Train Loss 0.397540, Valid_loss 0.645195
Epoch 52, Train Loss 0.396181, Valid_loss 0.648129
COVID19_Participant31 -- true: COVID-19 -- pred: COVID-19
COVID19_Participant26 -- true: COVID-19 -- pred: normal
COVID19_Participant13 -- true: COVID-19 -- pred: COVID-19
Control_Participant7 -- true: normal -- pred: COVID-19
Control_Participant7 -- true: normal -- pred: COVID-19
true :  [1, 1, 1, 0, 0]
pred :  [1, 0, 1, 1, 1]
Confusion Matrix: [0 2 1 2]
Best performance: Epoch 21, Loss 0.453799, Test ACC 0.400000, Test AUC 0.333333, Test Recall 0.666667, Test Precision 0.500000
✅ Total valid splits used: 2
🔁 Repeat 4, Fold 2
🔍 Split #3
  → train_p_index 환자 수: 23
  → test_p_index 환자 수: 9
  → train 환자 ID: ['COVID19_Participant13', 'COVID19_Participant14', 'COVID19_Participant15', 'COVID19_Participant17', 'COVID19_Participant20', 'COVID19_Participant23', 'COVID19_Participant25', 'COVID19_Participant28', 'COVID19_Participant29', 'COVID19_Participant31', 'COVID19_Participant32', 'COVID19_Participant37', 'COVID19_Participant39', 'COVID19_Participant4', 'COVID19_Participant40', 'COVID19_Participant8', 'Control_Participant1', 'Control_Participant10', 'Control_Participant11', 'Control_Participant3', 'Control_Participant5', 'Control_Participant7', 'Control_Participant9']
  → test  환자 ID: ['COVID19_Participant31', 'COVID19_Participant5', 'Control_Participant3', 'Control_Participant1', 'Control_Participant7', 'COVID19_Participant13', 'Control_Participant3', 'COVID19_Participant13', 'Control_Participant5']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant10, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant5, Label: 1
    ID: Control_Participant3, Label: 1
    ID: Control_Participant1, Label: 1
    ID: Control_Participant7, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: Control_Participant3, Label: 0
    ID: COVID19_Participant13, Label: 0
    ID: Control_Participant5, Label: 0
train_p_index_ 15
valid_p_index 8
test_p_index 9
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Ciliated Cells', 'Developing Ciliated Cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
data augment 실행 함
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:11,  8.33it/s]  2%|▏         | 2/100 [00:00<00:10,  9.04it/s]  3%|▎         | 3/100 [00:00<00:10,  9.27it/s]  4%|▍         | 4/100 [00:00<00:14,  6.40it/s]  6%|▌         | 6/100 [00:00<00:11,  8.03it/s]  7%|▋         | 7/100 [00:00<00:10,  8.48it/s]  9%|▉         | 9/100 [00:01<00:09,  9.11it/s] 10%|█         | 10/100 [00:01<00:09,  9.20it/s] 11%|█         | 11/100 [00:01<00:10,  8.71it/s] 13%|█▎        | 13/100 [00:01<00:09,  9.31it/s] 15%|█▌        | 15/100 [00:01<00:08,  9.56it/s] 16%|█▌        | 16/100 [00:01<00:08,  9.63it/s] 17%|█▋        | 17/100 [00:01<00:08,  9.44it/s] 18%|█▊        | 18/100 [00:02<00:08,  9.30it/s] 19%|█▉        | 19/100 [00:02<00:08,  9.17it/s] 20%|██        | 20/100 [00:02<00:08,  9.08it/s] 21%|██        | 21/100 [00:02<00:08,  9.08it/s] 22%|██▏       | 22/100 [00:02<00:08,  9.21it/s] 24%|██▍       | 24/100 [00:02<00:07,  9.52it/s] 25%|██▌       | 25/100 [00:02<00:07,  9.63it/s] 26%|██▌       | 26/100 [00:02<00:07,  9.43it/s] 28%|██▊       | 28/100 [00:03<00:07,  9.90it/s] 29%|██▉       | 29/100 [00:03<00:07,  9.60it/s] 30%|███       | 30/100 [00:03<00:07,  9.60it/s] 31%|███       | 31/100 [00:03<00:07,  9.56it/s] 32%|███▏      | 32/100 [00:03<00:08,  8.31it/s] 33%|███▎      | 33/100 [00:03<00:07,  8.53it/s] 34%|███▍      | 34/100 [00:03<00:07,  8.75it/s] 35%|███▌      | 35/100 [00:03<00:07,  8.82it/s] 36%|███▌      | 36/100 [00:04<00:09,  6.65it/s] 37%|███▋      | 37/100 [00:04<00:08,  7.27it/s] 38%|███▊      | 38/100 [00:04<00:08,  6.92it/s] 39%|███▉      | 39/100 [00:04<00:08,  7.52it/s] 40%|████      | 40/100 [00:04<00:07,  7.59it/s] 42%|████▏     | 42/100 [00:04<00:06,  8.47it/s] 44%|████▍     | 44/100 [00:05<00:06,  8.85it/s] 45%|████▌     | 45/100 [00:05<00:06,  7.98it/s] 46%|████▌     | 46/100 [00:05<00:06,  7.89it/s] 47%|████▋     | 47/100 [00:05<00:06,  8.23it/s] 48%|████▊     | 48/100 [00:05<00:06,  8.45it/s] 49%|████▉     | 49/100 [00:05<00:05,  8.58it/s] 50%|█████     | 50/100 [00:05<00:06,  7.32it/s] 51%|█████     | 51/100 [00:05<00:06,  7.83it/s] 52%|█████▏    | 52/100 [00:06<00:07,  6.19it/s] 53%|█████▎    | 53/100 [00:06<00:06,  6.81it/s] 54%|█████▍    | 54/100 [00:06<00:06,  7.47it/s] 55%|█████▌    | 55/100 [00:06<00:05,  7.88it/s] 56%|█████▌    | 56/100 [00:06<00:05,  7.99it/s] 57%|█████▋    | 57/100 [00:06<00:05,  8.33it/s] 58%|█████▊    | 58/100 [00:06<00:04,  8.52it/s] 59%|█████▉    | 59/100 [00:06<00:04,  8.67it/s] 60%|██████    | 60/100 [00:07<00:04,  8.74it/s] 61%|██████    | 61/100 [00:07<00:04,  9.06it/s] 62%|██████▏   | 62/100 [00:07<00:04,  9.21it/s] 63%|██████▎   | 63/100 [00:07<00:03,  9.30it/s] 64%|██████▍   | 64/100 [00:07<00:03,  9.18it/s] 65%|██████▌   | 65/100 [00:07<00:04,  7.08it/s] 67%|██████▋   | 67/100 [00:07<00:04,  8.13it/s] 68%|██████▊   | 68/100 [00:08<00:05,  6.33it/s] 69%|██████▉   | 69/100 [00:08<00:04,  6.67it/s] 70%|███████   | 70/100 [00:08<00:04,  7.28it/s] 71%|███████   | 71/100 [00:08<00:03,  7.77it/s] 72%|███████▏  | 72/100 [00:08<00:03,  8.26it/s] 73%|███████▎  | 73/100 [00:08<00:03,  8.57it/s] 74%|███████▍  | 74/100 [00:08<00:03,  8.64it/s] 75%|███████▌  | 75/100 [00:08<00:02,  8.72it/s] 76%|███████▌  | 76/100 [00:09<00:02,  8.68it/s] 77%|███████▋  | 77/100 [00:09<00:02,  8.93it/s] 79%|███████▉  | 79/100 [00:09<00:02,  9.15it/s] 80%|████████  | 80/100 [00:09<00:02,  9.18it/s] 81%|████████  | 81/100 [00:09<00:02,  9.26it/s] 82%|████████▏ | 82/100 [00:09<00:01,  9.29it/s] 83%|████████▎ | 83/100 [00:09<00:01,  9.32it/s] 84%|████████▍ | 84/100 [00:09<00:01,  9.32it/s] 85%|████████▌ | 85/100 [00:10<00:01,  9.26it/s] 86%|████████▌ | 86/100 [00:10<00:01,  8.99it/s] 87%|████████▋ | 87/100 [00:10<00:01,  9.12it/s] 88%|████████▊ | 88/100 [00:10<00:01,  9.00it/s] 89%|████████▉ | 89/100 [00:10<00:01,  9.21it/s] 90%|█████████ | 90/100 [00:10<00:01,  9.42it/s] 91%|█████████ | 91/100 [00:10<00:00,  9.25it/s] 92%|█████████▏| 92/100 [00:10<00:00,  9.19it/s] 93%|█████████▎| 93/100 [00:10<00:00,  9.05it/s] 94%|█████████▍| 94/100 [00:11<00:00,  9.05it/s] 95%|█████████▌| 95/100 [00:11<00:00,  8.73it/s] 96%|█████████▌| 96/100 [00:11<00:00,  8.79it/s] 97%|█████████▋| 97/100 [00:11<00:00,  8.98it/s] 98%|█████████▊| 98/100 [00:11<00:00,  8.75it/s] 99%|█████████▉| 99/100 [00:11<00:00,  8.15it/s]100%|██████████| 100/100 [00:11<00:00,  5.37it/s]100%|██████████| 100/100 [00:11<00:00,  8.36it/s]
eval_p_index len:  17
individual_train 115
individual_eval 17
train data의 x, y, id 길이: 115 115 115
valid data의 x, y, id 길이: 8 8 8
test data의 x, y, id 길이: 9 9 9
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.839085, Valid_loss 0.797664
Epoch 2, Train Loss 0.806968, Valid_loss 0.747609
Epoch 3, Train Loss 0.742544, Valid_loss 0.697551
Epoch 4, Train Loss 0.680925, Valid_loss 0.640330
Epoch 5, Train Loss 0.643197, Valid_loss 0.617513
Epoch 6, Train Loss 0.627717, Valid_loss 0.610485
Epoch 7, Train Loss 0.614641, Valid_loss 0.603624
Epoch 8, Train Loss 0.608298, Valid_loss 0.599104
Epoch 9, Train Loss 0.608532, Valid_loss 0.594240
Epoch 10, Train Loss 0.584894, Valid_loss 0.586845
Epoch 11, Train Loss 0.575198, Valid_loss 0.578014
Epoch 12, Train Loss 0.549887, Valid_loss 0.557818
Epoch 13, Train Loss 0.491758, Valid_loss 0.545018
Epoch 14, Train Loss 0.467019, Valid_loss 0.526345
Epoch 15, Train Loss 0.476827, Valid_loss 0.519374
Epoch 16, Train Loss 0.460586, Valid_loss 0.516474
Epoch 17, Train Loss 0.471821, Valid_loss 0.516036
Epoch 18, Train Loss 0.463895, Valid_loss 0.511405
Epoch 19, Train Loss 0.448656, Valid_loss 0.521210
Epoch 20, Train Loss 0.446272, Valid_loss 0.522167
Epoch 21, Train Loss 0.448844, Valid_loss 0.520757
Epoch 22, Train Loss 0.437280, Valid_loss 0.517549
Epoch 23, Train Loss 0.434178, Valid_loss 0.520737
Epoch 24, Train Loss 0.423590, Valid_loss 0.517685
Epoch 25, Train Loss 0.434706, Valid_loss 0.531424
Epoch 26, Train Loss 0.441950, Valid_loss 0.525759
Epoch 27, Train Loss 0.428426, Valid_loss 0.520051
Epoch 28, Train Loss 0.419844, Valid_loss 0.527395
Epoch 29, Train Loss 0.428150, Valid_loss 0.529152
Epoch 30, Train Loss 0.419624, Valid_loss 0.511043
Epoch 31, Train Loss 0.420368, Valid_loss 0.531644
Epoch 32, Train Loss 0.435861, Valid_loss 0.528136
Epoch 33, Train Loss 0.423313, Valid_loss 0.526437
Epoch 34, Train Loss 0.412594, Valid_loss 0.531703
Epoch 35, Train Loss 0.426457, Valid_loss 0.522864
Epoch 36, Train Loss 0.410401, Valid_loss 0.525611
Epoch 37, Train Loss 0.426943, Valid_loss 0.542309
Epoch 38, Train Loss 0.424600, Valid_loss 0.507140
Epoch 39, Train Loss 0.398611, Valid_loss 0.518695
Epoch 40, Train Loss 0.412340, Valid_loss 0.534561
Epoch 41, Train Loss 0.402987, Valid_loss 0.515307
Epoch 42, Train Loss 0.408732, Valid_loss 0.510952
Epoch 43, Train Loss 0.408534, Valid_loss 0.542189
Epoch 44, Train Loss 0.391614, Valid_loss 0.520098
Epoch 45, Train Loss 0.389796, Valid_loss 0.515104
Epoch 46, Train Loss 0.388700, Valid_loss 0.530851
Epoch 47, Train Loss 0.403118, Valid_loss 0.526801
Epoch 48, Train Loss 0.400543, Valid_loss 0.518435
Epoch 49, Train Loss 0.406110, Valid_loss 0.530341
Epoch 50, Train Loss 0.384224, Valid_loss 0.528639
Epoch 51, Train Loss 0.398083, Valid_loss 0.525140
Epoch 52, Train Loss 0.381775, Valid_loss 0.517319
Epoch 53, Train Loss 0.388871, Valid_loss 0.528523
Epoch 54, Train Loss 0.386097, Valid_loss 0.535490
COVID19_Participant31 -- true: COVID-19 -- pred: normal
COVID19_Participant5 -- true: COVID-19 -- pred: COVID-19
Control_Participant3 -- true: normal -- pred: normal
Control_Participant1 -- true: normal -- pred: normal
Control_Participant7 -- true: normal -- pred: normal
COVID19_Participant13 -- true: COVID-19 -- pred: COVID-19
Control_Participant3 -- true: normal -- pred: normal
COVID19_Participant13 -- true: COVID-19 -- pred: COVID-19
Control_Participant5 -- true: normal -- pred: normal
true :  [1, 1, 0, 0, 0, 1, 0, 1, 0]
pred :  [0, 1, 0, 0, 0, 1, 0, 1, 0]
Confusion Matrix: [5 0 1 3]
Best performance: Epoch 38, Loss 0.424600, Test ACC 0.888889, Test AUC 0.750000, Test Recall 0.750000, Test Precision 1.000000
✅ Total valid splits used: 3
🔁 Repeat 4, Fold 3
🔍 Split #4
  → train_p_index 환자 수: 26
  → test_p_index 환자 수: 6
  → train 환자 ID: ['COVID19_Participant11', 'COVID19_Participant13', 'COVID19_Participant15', 'COVID19_Participant19', 'COVID19_Participant2', 'COVID19_Participant20', 'COVID19_Participant22', 'COVID19_Participant23', 'COVID19_Participant25', 'COVID19_Participant26', 'COVID19_Participant28', 'COVID19_Participant29', 'COVID19_Participant31', 'COVID19_Participant32', 'COVID19_Participant39', 'COVID19_Participant4', 'COVID19_Participant7', 'COVID19_Participant8', 'Control_Participant1', 'Control_Participant10', 'Control_Participant11', 'Control_Participant15', 'Control_Participant4', 'Control_Participant5', 'Control_Participant7', 'Control_Participant8']
  → test  환자 ID: ['Control_Participant4', 'Control_Participant4', 'COVID19_Participant26', 'COVID19_Participant7', 'Control_Participant7', 'COVID19_Participant31']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant10, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant4, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant8, Label: 0
  → test 환자 ID 및 라벨:
    ID: Control_Participant4, Label: 1
    ID: Control_Participant4, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: Control_Participant7, Label: 0
    ID: COVID19_Participant31, Label: 0
train_p_index_ 17
valid_p_index 9
test_p_index 6
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Ciliated Cells', 'Developing Ciliated Cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
data augment 실행 함
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:10,  9.64it/s]  2%|▏         | 2/100 [00:00<00:12,  7.67it/s]  3%|▎         | 3/100 [00:00<00:11,  8.23it/s]  4%|▍         | 4/100 [00:00<00:12,  7.64it/s]  6%|▌         | 6/100 [00:00<00:10,  9.10it/s]  7%|▋         | 7/100 [00:00<00:10,  9.24it/s]  9%|▉         | 9/100 [00:00<00:09,  9.85it/s] 11%|█         | 11/100 [00:01<00:09,  9.17it/s] 12%|█▏        | 12/100 [00:01<00:10,  8.32it/s] 14%|█▍        | 14/100 [00:01<00:09,  9.20it/s] 16%|█▌        | 16/100 [00:01<00:09,  8.80it/s] 17%|█▋        | 17/100 [00:01<00:10,  7.91it/s] 19%|█▉        | 19/100 [00:02<00:09,  8.73it/s] 20%|██        | 20/100 [00:02<00:10,  7.88it/s] 22%|██▏       | 22/100 [00:02<00:08,  8.68it/s] 24%|██▍       | 24/100 [00:02<00:08,  9.33it/s] 26%|██▌       | 26/100 [00:02<00:07,  9.55it/s] 28%|██▊       | 28/100 [00:03<00:07, 10.01it/s] 30%|███       | 30/100 [00:03<00:09,  7.70it/s] 32%|███▏      | 32/100 [00:03<00:08,  8.48it/s] 33%|███▎      | 33/100 [00:03<00:07,  8.67it/s] 35%|███▌      | 35/100 [00:03<00:07,  9.23it/s] 37%|███▋      | 37/100 [00:04<00:07,  8.00it/s] 39%|███▉      | 39/100 [00:04<00:07,  7.79it/s] 41%|████      | 41/100 [00:04<00:07,  7.79it/s] 43%|████▎     | 43/100 [00:05<00:06,  8.47it/s] 44%|████▍     | 44/100 [00:05<00:08,  6.46it/s] 45%|████▌     | 45/100 [00:05<00:08,  6.85it/s] 47%|████▋     | 47/100 [00:05<00:06,  7.92it/s] 49%|████▉     | 49/100 [00:05<00:06,  7.74it/s] 50%|█████     | 50/100 [00:05<00:06,  8.09it/s] 52%|█████▏    | 52/100 [00:06<00:05,  8.91it/s] 54%|█████▍    | 54/100 [00:06<00:05,  9.15it/s] 55%|█████▌    | 55/100 [00:06<00:04,  9.28it/s] 56%|█████▌    | 56/100 [00:06<00:04,  9.31it/s] 57%|█████▋    | 57/100 [00:06<00:04,  9.31it/s] 58%|█████▊    | 58/100 [00:06<00:04,  9.29it/s] 59%|█████▉    | 59/100 [00:06<00:04,  9.46it/s] 61%|██████    | 61/100 [00:07<00:03,  9.93it/s] 62%|██████▏   | 62/100 [00:07<00:03,  9.86it/s] 63%|██████▎   | 63/100 [00:07<00:04,  8.96it/s] 64%|██████▍   | 64/100 [00:07<00:05,  6.76it/s] 66%|██████▌   | 66/100 [00:07<00:04,  7.59it/s] 67%|██████▋   | 67/100 [00:07<00:04,  7.00it/s] 69%|██████▉   | 69/100 [00:08<00:03,  8.01it/s] 71%|███████   | 71/100 [00:08<00:03,  8.63it/s] 72%|███████▏  | 72/100 [00:08<00:03,  8.66it/s] 74%|███████▍  | 74/100 [00:08<00:02,  9.20it/s] 76%|███████▌  | 76/100 [00:08<00:02,  9.48it/s] 77%|███████▋  | 77/100 [00:09<00:02,  9.45it/s] 78%|███████▊  | 78/100 [00:09<00:02,  8.82it/s] 79%|███████▉  | 79/100 [00:09<00:02,  9.06it/s] 80%|████████  | 80/100 [00:09<00:02,  9.25it/s] 81%|████████  | 81/100 [00:09<00:02,  9.27it/s] 82%|████████▏ | 82/100 [00:09<00:01,  9.39it/s] 83%|████████▎ | 83/100 [00:09<00:02,  7.53it/s] 84%|████████▍ | 84/100 [00:09<00:02,  7.96it/s] 85%|████████▌ | 85/100 [00:10<00:02,  7.22it/s] 86%|████████▌ | 86/100 [00:10<00:02,  5.31it/s] 87%|████████▋ | 87/100 [00:10<00:02,  6.03it/s] 89%|████████▉ | 89/100 [00:10<00:01,  7.41it/s] 91%|█████████ | 91/100 [00:10<00:01,  8.09it/s] 93%|█████████▎| 93/100 [00:11<00:00,  8.82it/s] 94%|█████████▍| 94/100 [00:11<00:00,  9.02it/s] 95%|█████████▌| 95/100 [00:11<00:00,  9.13it/s] 96%|█████████▌| 96/100 [00:11<00:00,  9.00it/s] 98%|█████████▊| 98/100 [00:11<00:00,  6.46it/s] 99%|█████████▉| 99/100 [00:11<00:00,  6.89it/s]100%|██████████| 100/100 [00:12<00:00,  8.32it/s]
eval_p_index len:  15
individual_train 117
individual_eval 15
train data의 x, y, id 길이: 117 117 117
valid data의 x, y, id 길이: 9 9 9
test data의 x, y, id 길이: 6 6 6
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.586569, Valid_loss 0.730006
Epoch 2, Train Loss 0.581454, Valid_loss 0.735435
Epoch 3, Train Loss 0.567156, Valid_loss 0.741833
Epoch 4, Train Loss 0.565322, Valid_loss 0.748649
Epoch 5, Train Loss 0.558724, Valid_loss 0.755369
Epoch 6, Train Loss 0.559310, Valid_loss 0.762665
Epoch 7, Train Loss 0.561894, Valid_loss 0.769657
Epoch 8, Train Loss 0.536504, Valid_loss 0.774362
Epoch 9, Train Loss 0.569073, Valid_loss 0.776883
Epoch 10, Train Loss 0.543631, Valid_loss 0.776646
Epoch 11, Train Loss 0.538215, Valid_loss 0.778855
Epoch 12, Train Loss 0.528822, Valid_loss 0.780322
Epoch 13, Train Loss 0.543345, Valid_loss 0.779722
Epoch 14, Train Loss 0.531697, Valid_loss 0.775730
Epoch 15, Train Loss 0.532971, Valid_loss 0.772092
Epoch 16, Train Loss 0.517088, Valid_loss 0.767093
Epoch 17, Train Loss 0.524754, Valid_loss 0.765459
Epoch 18, Train Loss 0.510826, Valid_loss 0.764862
Epoch 19, Train Loss 0.517168, Valid_loss 0.761804
Epoch 20, Train Loss 0.527007, Valid_loss 0.763952
Epoch 21, Train Loss 0.502109, Valid_loss 0.764078
Epoch 22, Train Loss 0.487505, Valid_loss 0.775192
Epoch 23, Train Loss 0.499682, Valid_loss 0.768254
Epoch 24, Train Loss 0.474341, Valid_loss 0.771703
Epoch 25, Train Loss 0.463794, Valid_loss 0.762668
Epoch 26, Train Loss 0.469547, Valid_loss 0.762225
Epoch 27, Train Loss 0.470192, Valid_loss 0.756038
Epoch 28, Train Loss 0.458525, Valid_loss 0.757349
Epoch 29, Train Loss 0.444413, Valid_loss 0.751515
Epoch 30, Train Loss 0.459173, Valid_loss 0.748108
Epoch 31, Train Loss 0.453405, Valid_loss 0.743411
Epoch 32, Train Loss 0.465478, Valid_loss 0.752404
Epoch 33, Train Loss 0.436495, Valid_loss 0.735320
Epoch 34, Train Loss 0.442761, Valid_loss 0.733987
Epoch 35, Train Loss 0.466848, Valid_loss 0.736993
Epoch 36, Train Loss 0.440197, Valid_loss 0.731312
Epoch 37, Train Loss 0.441389, Valid_loss 0.737268
Epoch 38, Train Loss 0.456460, Valid_loss 0.726915
Epoch 39, Train Loss 0.444300, Valid_loss 0.733201
Epoch 40, Train Loss 0.441393, Valid_loss 0.726316
Epoch 41, Train Loss 0.427707, Valid_loss 0.727420
Epoch 42, Train Loss 0.446449, Valid_loss 0.723446
Epoch 43, Train Loss 0.434691, Valid_loss 0.722449
Epoch 44, Train Loss 0.435158, Valid_loss 0.718206
Epoch 45, Train Loss 0.440459, Valid_loss 0.726980
Epoch 46, Train Loss 0.425749, Valid_loss 0.721698
Epoch 47, Train Loss 0.432052, Valid_loss 0.722249
Epoch 48, Train Loss 0.440535, Valid_loss 0.715540
Epoch 49, Train Loss 0.443471, Valid_loss 0.715647
Epoch 50, Train Loss 0.421131, Valid_loss 0.718859
Epoch 51, Train Loss 0.420736, Valid_loss 0.711881
Epoch 52, Train Loss 0.420969, Valid_loss 0.716624
Epoch 53, Train Loss 0.421225, Valid_loss 0.715408
Epoch 54, Train Loss 0.410949, Valid_loss 0.715515
Epoch 55, Train Loss 0.418874, Valid_loss 0.714612
Epoch 56, Train Loss 0.419705, Valid_loss 0.711932
Epoch 57, Train Loss 0.424679, Valid_loss 0.711002
Epoch 58, Train Loss 0.429371, Valid_loss 0.714291
Epoch 59, Train Loss 0.421613, Valid_loss 0.708067
Epoch 60, Train Loss 0.408083, Valid_loss 0.711140
Epoch 61, Train Loss 0.408110, Valid_loss 0.710202
Epoch 62, Train Loss 0.419378, Valid_loss 0.711023
Epoch 63, Train Loss 0.417920, Valid_loss 0.707466
Epoch 64, Train Loss 0.406694, Valid_loss 0.709024
Epoch 65, Train Loss 0.436351, Valid_loss 0.705179
Epoch 66, Train Loss 0.423508, Valid_loss 0.707197
Epoch 67, Train Loss 0.431742, Valid_loss 0.704233
Epoch 68, Train Loss 0.421294, Valid_loss 0.704678
Epoch 69, Train Loss 0.440276, Valid_loss 0.701536
Epoch 70, Train Loss 0.420216, Valid_loss 0.704703
Epoch 71, Train Loss 0.405611, Valid_loss 0.703014
Epoch 72, Train Loss 0.420263, Valid_loss 0.699392
Epoch 73, Train Loss 0.418316, Valid_loss 0.700822
Epoch 74, Train Loss 0.420652, Valid_loss 0.700131
Epoch 75, Train Loss 0.406687, Valid_loss 0.700551
Epoch 76, Train Loss 0.407398, Valid_loss 0.699668
Epoch 77, Train Loss 0.402988, Valid_loss 0.700669
Epoch 78, Train Loss 0.399112, Valid_loss 0.693746
Epoch 79, Train Loss 0.417307, Valid_loss 0.701699
Epoch 80, Train Loss 0.417844, Valid_loss 0.694575
Epoch 81, Train Loss 0.406134, Valid_loss 0.699303
Epoch 82, Train Loss 0.407893, Valid_loss 0.692939
Epoch 83, Train Loss 0.429232, Valid_loss 0.693179
Epoch 84, Train Loss 0.400459, Valid_loss 0.695443
Control_Participant4 -- true: normal -- pred: COVID-19
Control_Participant4 -- true: normal -- pred: COVID-19
COVID19_Participant26 -- true: COVID-19 -- pred: COVID-19
COVID19_Participant7 -- true: COVID-19 -- pred: COVID-19
Control_Participant7 -- true: normal -- pred: COVID-19
COVID19_Participant31 -- true: COVID-19 -- pred: COVID-19
true :  [0, 0, 1, 1, 0, 1]
pred :  [1, 1, 1, 1, 1, 1]
Confusion Matrix: [0 3 0 3]
Best performance: Epoch 82, Loss 0.407893, Test ACC 0.500000, Test AUC 0.555556, Test Recall 1.000000, Test Precision 0.500000
✅ Total valid splits used: 4
🔁 Repeat 4, Fold 4
🔍 Split #5
  → train_p_index 환자 수: 25
  → test_p_index 환자 수: 7
  → train 환자 ID: ['COVID19_Participant11', 'COVID19_Participant14', 'COVID19_Participant17', 'COVID19_Participant19', 'COVID19_Participant2', 'COVID19_Participant20', 'COVID19_Participant22', 'COVID19_Participant26', 'COVID19_Participant28', 'COVID19_Participant29', 'COVID19_Participant31', 'COVID19_Participant32', 'COVID19_Participant37', 'COVID19_Participant39', 'COVID19_Participant40', 'COVID19_Participant7', 'COVID19_Participant8', 'Control_Participant1', 'Control_Participant10', 'Control_Participant15', 'Control_Participant3', 'Control_Participant4', 'Control_Participant5', 'Control_Participant8', 'Control_Participant9']
  → test  환자 ID: ['COVID19_Participant26', 'Control_Participant3', 'Control_Participant1', 'Control_Participant4', 'Control_Participant1', 'COVID19_Participant7', 'COVID19_Participant31']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant10, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant4, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant8, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: COVID19_Participant26, Label: 1
    ID: Control_Participant3, Label: 1
    ID: Control_Participant1, Label: 1
    ID: Control_Participant4, Label: 1
    ID: Control_Participant1, Label: 1
    ID: COVID19_Participant7, Label: 0
    ID: COVID19_Participant31, Label: 0
train_p_index_ 16
valid_p_index 9
test_p_index 7
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Ciliated Cells', 'Ciliated Cells', 'Goblet Cells', 'Basal Cells', 'Ciliated Cells', 'Developing Secretory and Goblet Cells', 'Basal Cells', 'Ciliated Cells', 'Basal Cells', 'Developing Secretory and Goblet Cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
data augment 실행 함
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:16,  6.17it/s]  2%|▏         | 2/100 [00:00<00:16,  6.01it/s]  3%|▎         | 3/100 [00:00<00:13,  6.98it/s]  4%|▍         | 4/100 [00:00<00:12,  7.53it/s]  5%|▌         | 5/100 [00:00<00:12,  7.75it/s]  6%|▌         | 6/100 [00:00<00:12,  7.35it/s]  7%|▋         | 7/100 [00:00<00:11,  8.05it/s]  9%|▉         | 9/100 [00:01<00:11,  7.78it/s] 10%|█         | 10/100 [00:01<00:11,  8.11it/s] 11%|█         | 11/100 [00:01<00:10,  8.40it/s] 12%|█▏        | 12/100 [00:01<00:10,  8.12it/s] 14%|█▍        | 14/100 [00:01<00:09,  8.67it/s] 15%|█▌        | 15/100 [00:01<00:09,  8.56it/s] 16%|█▌        | 16/100 [00:01<00:09,  8.84it/s] 17%|█▋        | 17/100 [00:02<00:09,  9.07it/s] 18%|█▊        | 18/100 [00:02<00:09,  8.60it/s] 20%|██        | 20/100 [00:02<00:08,  9.12it/s] 21%|██        | 21/100 [00:02<00:08,  9.03it/s] 22%|██▏       | 22/100 [00:02<00:08,  9.22it/s] 23%|██▎       | 23/100 [00:02<00:08,  9.40it/s] 24%|██▍       | 24/100 [00:02<00:08,  9.15it/s] 25%|██▌       | 25/100 [00:02<00:08,  9.34it/s] 26%|██▌       | 26/100 [00:03<00:07,  9.30it/s] 27%|██▋       | 27/100 [00:03<00:08,  8.32it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.60it/s] 30%|███       | 30/100 [00:03<00:07,  8.96it/s] 31%|███       | 31/100 [00:03<00:08,  8.53it/s] 32%|███▏      | 32/100 [00:03<00:08,  8.23it/s] 33%|███▎      | 33/100 [00:03<00:09,  7.22it/s] 34%|███▍      | 34/100 [00:04<00:08,  7.78it/s] 36%|███▌      | 36/100 [00:04<00:08,  7.60it/s] 38%|███▊      | 38/100 [00:04<00:07,  8.28it/s] 39%|███▉      | 39/100 [00:04<00:07,  8.05it/s] 40%|████      | 40/100 [00:04<00:08,  7.09it/s] 41%|████      | 41/100 [00:05<00:07,  7.49it/s] 42%|████▏     | 42/100 [00:05<00:07,  7.81it/s] 43%|████▎     | 43/100 [00:05<00:07,  8.08it/s] 44%|████▍     | 44/100 [00:05<00:06,  8.41it/s] 45%|████▌     | 45/100 [00:05<00:06,  8.53it/s] 46%|████▌     | 46/100 [00:05<00:07,  7.51it/s] 47%|████▋     | 47/100 [00:05<00:07,  6.78it/s] 48%|████▊     | 48/100 [00:05<00:07,  7.33it/s] 49%|████▉     | 49/100 [00:06<00:06,  7.81it/s] 50%|█████     | 50/100 [00:06<00:07,  6.97it/s] 51%|█████     | 51/100 [00:06<00:06,  7.56it/s] 52%|█████▏    | 52/100 [00:06<00:08,  5.68it/s] 53%|█████▎    | 53/100 [00:06<00:07,  6.48it/s] 54%|█████▍    | 54/100 [00:06<00:06,  7.14it/s] 55%|█████▌    | 55/100 [00:06<00:05,  7.72it/s] 56%|█████▌    | 56/100 [00:07<00:06,  7.22it/s] 57%|█████▋    | 57/100 [00:07<00:05,  7.68it/s] 58%|█████▊    | 58/100 [00:07<00:05,  8.07it/s] 59%|█████▉    | 59/100 [00:07<00:06,  6.31it/s] 60%|██████    | 60/100 [00:07<00:05,  7.06it/s] 61%|██████    | 61/100 [00:07<00:05,  7.65it/s] 62%|██████▏   | 62/100 [00:07<00:04,  8.09it/s] 63%|██████▎   | 63/100 [00:08<00:05,  7.20it/s] 64%|██████▍   | 64/100 [00:08<00:04,  7.74it/s] 65%|██████▌   | 65/100 [00:08<00:04,  8.11it/s] 66%|██████▌   | 66/100 [00:08<00:04,  7.98it/s] 67%|██████▋   | 67/100 [00:08<00:03,  8.31it/s] 68%|██████▊   | 68/100 [00:08<00:03,  8.53it/s] 69%|██████▉   | 69/100 [00:08<00:03,  8.19it/s] 70%|███████   | 70/100 [00:08<00:03,  8.48it/s] 71%|███████   | 71/100 [00:09<00:04,  6.34it/s] 72%|███████▏  | 72/100 [00:09<00:04,  6.63it/s] 73%|███████▎  | 73/100 [00:09<00:03,  7.28it/s] 74%|███████▍  | 74/100 [00:09<00:03,  7.82it/s] 75%|███████▌  | 75/100 [00:09<00:03,  7.57it/s] 76%|███████▌  | 76/100 [00:09<00:03,  7.95it/s] 77%|███████▋  | 77/100 [00:09<00:02,  7.95it/s] 78%|███████▊  | 78/100 [00:09<00:02,  8.36it/s] 79%|███████▉  | 79/100 [00:10<00:02,  7.17it/s] 80%|████████  | 80/100 [00:10<00:02,  6.99it/s] 81%|████████  | 81/100 [00:10<00:02,  7.36it/s] 82%|████████▏ | 82/100 [00:10<00:02,  7.49it/s] 83%|████████▎ | 83/100 [00:10<00:02,  7.95it/s] 84%|████████▍ | 84/100 [00:10<00:01,  8.21it/s] 85%|████████▌ | 85/100 [00:10<00:01,  8.42it/s] 86%|████████▌ | 86/100 [00:10<00:01,  8.66it/s] 87%|████████▋ | 87/100 [00:11<00:01,  7.52it/s] 88%|████████▊ | 88/100 [00:11<00:01,  6.17it/s] 89%|████████▉ | 89/100 [00:11<00:01,  6.86it/s] 90%|█████████ | 90/100 [00:11<00:01,  7.32it/s] 91%|█████████ | 91/100 [00:11<00:01,  7.83it/s] 92%|█████████▏| 92/100 [00:11<00:01,  7.65it/s] 93%|█████████▎| 93/100 [00:11<00:00,  7.97it/s] 94%|█████████▍| 94/100 [00:12<00:00,  8.28it/s] 95%|█████████▌| 95/100 [00:12<00:00,  8.55it/s] 96%|█████████▌| 96/100 [00:12<00:00,  8.86it/s] 97%|█████████▋| 97/100 [00:12<00:00,  8.88it/s] 98%|█████████▊| 98/100 [00:12<00:00,  8.87it/s] 99%|█████████▉| 99/100 [00:12<00:00,  8.94it/s]100%|██████████| 100/100 [00:12<00:00,  9.14it/s]100%|██████████| 100/100 [00:12<00:00,  7.89it/s]
eval_p_index len:  16
individual_train 116
individual_eval 16
train data의 x, y, id 길이: 116 116 116
valid data의 x, y, id 길이: 9 9 9
test data의 x, y, id 길이: 7 7 7
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.911721, Valid_loss 0.772245
Epoch 2, Train Loss 0.857288, Valid_loss 0.737316
Epoch 3, Train Loss 0.809467, Valid_loss 0.707369
Epoch 4, Train Loss 0.749336, Valid_loss 0.693000
Epoch 5, Train Loss 0.705668, Valid_loss 0.693416
Epoch 6, Train Loss 0.688959, Valid_loss 0.698246
Epoch 7, Train Loss 0.687253, Valid_loss 0.696139
Epoch 8, Train Loss 0.683503, Valid_loss 0.691497
Epoch 9, Train Loss 0.679908, Valid_loss 0.688908
Epoch 10, Train Loss 0.674733, Valid_loss 0.688391
Epoch 11, Train Loss 0.675563, Valid_loss 0.689072
Epoch 12, Train Loss 0.671039, Valid_loss 0.689097
Epoch 13, Train Loss 0.665672, Valid_loss 0.687081
Epoch 14, Train Loss 0.666661, Valid_loss 0.685637
Epoch 15, Train Loss 0.664704, Valid_loss 0.683725
Epoch 16, Train Loss 0.658150, Valid_loss 0.681780
Epoch 17, Train Loss 0.667956, Valid_loss 0.680999
Epoch 18, Train Loss 0.660225, Valid_loss 0.680059
Epoch 19, Train Loss 0.651905, Valid_loss 0.677767
Epoch 20, Train Loss 0.655113, Valid_loss 0.675688
Epoch 21, Train Loss 0.650556, Valid_loss 0.675089
Epoch 22, Train Loss 0.648208, Valid_loss 0.673234
Epoch 23, Train Loss 0.647998, Valid_loss 0.671956
Epoch 24, Train Loss 0.642705, Valid_loss 0.670945
Epoch 25, Train Loss 0.644203, Valid_loss 0.667497
Epoch 26, Train Loss 0.640595, Valid_loss 0.666838
Epoch 27, Train Loss 0.638931, Valid_loss 0.666919
Epoch 28, Train Loss 0.643566, Valid_loss 0.663943
Epoch 29, Train Loss 0.633171, Valid_loss 0.661862
Epoch 30, Train Loss 0.631447, Valid_loss 0.660283
Epoch 31, Train Loss 0.637074, Valid_loss 0.659564
Epoch 32, Train Loss 0.630119, Valid_loss 0.658202
Epoch 33, Train Loss 0.632974, Valid_loss 0.656436
Epoch 34, Train Loss 0.625720, Valid_loss 0.654565
Epoch 35, Train Loss 0.626347, Valid_loss 0.651850
Epoch 36, Train Loss 0.624847, Valid_loss 0.650314
Epoch 37, Train Loss 0.618635, Valid_loss 0.646104
Epoch 38, Train Loss 0.621333, Valid_loss 0.642997
Epoch 39, Train Loss 0.616969, Valid_loss 0.638755
Epoch 40, Train Loss 0.609482, Valid_loss 0.638250
Epoch 41, Train Loss 0.615429, Valid_loss 0.638093
Epoch 42, Train Loss 0.611997, Valid_loss 0.632042
Epoch 43, Train Loss 0.609197, Valid_loss 0.633055
Epoch 44, Train Loss 0.609415, Valid_loss 0.629431
Epoch 45, Train Loss 0.601484, Valid_loss 0.628996
Epoch 46, Train Loss 0.602979, Valid_loss 0.626849
Epoch 47, Train Loss 0.602704, Valid_loss 0.625238
Epoch 48, Train Loss 0.598525, Valid_loss 0.625799
Epoch 49, Train Loss 0.598547, Valid_loss 0.623251
Epoch 50, Train Loss 0.597639, Valid_loss 0.622897
Epoch 51, Train Loss 0.593744, Valid_loss 0.620266
Epoch 52, Train Loss 0.596546, Valid_loss 0.620461
Epoch 53, Train Loss 0.599106, Valid_loss 0.620353
Epoch 54, Train Loss 0.587590, Valid_loss 0.620517
Epoch 55, Train Loss 0.594497, Valid_loss 0.617459
Epoch 56, Train Loss 0.596419, Valid_loss 0.618239
Epoch 57, Train Loss 0.594706, Valid_loss 0.616078
Epoch 58, Train Loss 0.589704, Valid_loss 0.616009
Epoch 59, Train Loss 0.591654, Valid_loss 0.614056
Epoch 60, Train Loss 0.587115, Valid_loss 0.614010
Epoch 61, Train Loss 0.585086, Valid_loss 0.612159
Epoch 62, Train Loss 0.591066, Valid_loss 0.614363
Epoch 63, Train Loss 0.591179, Valid_loss 0.612738
Epoch 64, Train Loss 0.585361, Valid_loss 0.610218
Epoch 65, Train Loss 0.586841, Valid_loss 0.610711
Epoch 66, Train Loss 0.585472, Valid_loss 0.608978
Epoch 67, Train Loss 0.588077, Valid_loss 0.609722
Epoch 68, Train Loss 0.582300, Valid_loss 0.609134
Epoch 69, Train Loss 0.585376, Valid_loss 0.607953
Epoch 70, Train Loss 0.581321, Valid_loss 0.607285
Epoch 71, Train Loss 0.579116, Valid_loss 0.605038
Epoch 72, Train Loss 0.589751, Valid_loss 0.604976
Epoch 73, Train Loss 0.580988, Valid_loss 0.606867
Epoch 74, Train Loss 0.574116, Valid_loss 0.603876
Epoch 75, Train Loss 0.579263, Valid_loss 0.601264
Epoch 76, Train Loss 0.581004, Valid_loss 0.602463
Epoch 77, Train Loss 0.577327, Valid_loss 0.601995
Epoch 78, Train Loss 0.578161, Valid_loss 0.600145
Epoch 79, Train Loss 0.576649, Valid_loss 0.600013
Epoch 80, Train Loss 0.570036, Valid_loss 0.598684
Epoch 81, Train Loss 0.571183, Valid_loss 0.598284
Epoch 82, Train Loss 0.568494, Valid_loss 0.596499
Epoch 83, Train Loss 0.569123, Valid_loss 0.596139
Epoch 84, Train Loss 0.572834, Valid_loss 0.596689
Epoch 85, Train Loss 0.565339, Valid_loss 0.594365
Epoch 86, Train Loss 0.570536, Valid_loss 0.593008
Epoch 87, Train Loss 0.566141, Valid_loss 0.594346
Epoch 88, Train Loss 0.567498, Valid_loss 0.591569
Epoch 89, Train Loss 0.567036, Valid_loss 0.591499
Epoch 90, Train Loss 0.564519, Valid_loss 0.591467
Epoch 91, Train Loss 0.569446, Valid_loss 0.590171
Epoch 92, Train Loss 0.568730, Valid_loss 0.590637
Epoch 93, Train Loss 0.562679, Valid_loss 0.589461
Epoch 94, Train Loss 0.562788, Valid_loss 0.586873
Epoch 95, Train Loss 0.563060, Valid_loss 0.586260
Epoch 96, Train Loss 0.560482, Valid_loss 0.585810
Epoch 97, Train Loss 0.558859, Valid_loss 0.584940
Epoch 98, Train Loss 0.564187, Valid_loss 0.583849
Epoch 99, Train Loss 0.551637, Valid_loss 0.582666
Epoch 100, Train Loss 0.559954, Valid_loss 0.580080
COVID19_Participant26 -- true: COVID-19 -- pred: COVID-19
Control_Participant3 -- true: normal -- pred: COVID-19
Control_Participant1 -- true: normal -- pred: COVID-19
Control_Participant4 -- true: normal -- pred: normal
Control_Participant1 -- true: normal -- pred: normal
COVID19_Participant7 -- true: COVID-19 -- pred: normal
COVID19_Participant31 -- true: COVID-19 -- pred: COVID-19
true :  [1, 0, 0, 0, 0, 1, 1]
pred :  [1, 1, 1, 0, 0, 0, 1]
Confusion Matrix: [2 2 1 2]
Best performance: Epoch 100, Loss 0.559954, Test ACC 0.571429, Test AUC 0.833333, Test Recall 0.666667, Test Precision 0.500000
✅ Total valid splits used: 5

📌 Repeat 4: 평균 AUC = 0.4944, 표준편차 = 0.3014
