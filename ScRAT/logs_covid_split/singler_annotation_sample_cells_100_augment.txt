Namespace(seed=240, batch_size=16, learning_rate=0.0001, weight_decay=0.0001, epochs=100, task='custom_covid', emb_dim=8, h_dim=128, dropout=0.0, layers=1, heads=4, train_sample_cells=100, test_sample_cells=100, train_num_sample=20, test_num_sample=100, model='Transformer', dataset=None, inter_only=False, same_pheno=0, augment_num=100, alpha=1.0, repeat=5, all=1, min_size=6000, n_splits=5, pca=False, mix_type=1, norm_first=False, warmup=False, top_k=1)
🔁 Repeat 0, Fold 0
🔍 Split #1
  → train_p_index 환자 수: 29
  → test_p_index 환자 수: 10
  → train 환자 ID: ['COVID19_Participant12', 'COVID19_Participant13', 'COVID19_Participant14', 'COVID19_Participant15', 'COVID19_Participant17', 'COVID19_Participant19', 'COVID19_Participant2', 'COVID19_Participant20', 'COVID19_Participant22', 'COVID19_Participant23', 'COVID19_Participant26', 'COVID19_Participant29', 'COVID19_Participant3', 'COVID19_Participant31', 'COVID19_Participant32', 'COVID19_Participant36', 'COVID19_Participant37', 'COVID19_Participant4', 'COVID19_Participant40', 'COVID19_Participant7', 'Control_Participant1', 'Control_Participant10', 'Control_Participant11', 'Control_Participant15', 'Control_Participant3', 'Control_Participant4', 'Control_Participant5', 'Control_Participant6', 'Control_Participant8']
  → test  환자 ID: ['COVID19_Participant5', 'Control_Participant3', 'COVID19_Participant31', 'COVID19_Participant7', 'Control_Participant3', 'Control_Participant1', 'Control_Participant4', 'Control_Participant3', 'COVID19_Participant13', 'COVID19_Participant26']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant12, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant3, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant36, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant10, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant4, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant6, Label: 0
    ID: Control_Participant8, Label: 0
  → test 환자 ID 및 라벨:
    ID: COVID19_Participant5, Label: 1
    ID: Control_Participant3, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: Control_Participant3, Label: 1
    ID: Control_Participant1, Label: 1
    ID: Control_Participant4, Label: 1
    ID: Control_Participant3, Label: 0
    ID: COVID19_Participant13, Label: 0
    ID: COVID19_Participant26, Label: 0
train_p_index_ 19
valid_p_index 10
test_p_index 10
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Epithelial_cells', 'Platelets', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Keratinocytes', 'Macrophage', 'Epithelial_cells', 'B_cell', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
data augment 실행 함
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:14,  6.88it/s]  2%|▏         | 2/100 [00:00<00:12,  7.72it/s]  3%|▎         | 3/100 [00:00<00:12,  7.94it/s]  4%|▍         | 4/100 [00:00<00:11,  8.08it/s]  5%|▌         | 5/100 [00:00<00:11,  8.22it/s]  6%|▌         | 6/100 [00:00<00:11,  8.33it/s]  7%|▋         | 7/100 [00:00<00:11,  8.28it/s]  8%|▊         | 8/100 [00:00<00:10,  8.39it/s]  9%|▉         | 9/100 [00:01<00:10,  8.39it/s] 10%|█         | 10/100 [00:01<00:10,  8.48it/s] 11%|█         | 11/100 [00:01<00:10,  8.58it/s] 12%|█▏        | 12/100 [00:01<00:10,  8.69it/s] 13%|█▎        | 13/100 [00:01<00:09,  8.81it/s] 14%|█▍        | 14/100 [00:01<00:09,  8.89it/s] 15%|█▌        | 15/100 [00:01<00:09,  8.52it/s] 16%|█▌        | 16/100 [00:01<00:09,  8.43it/s] 17%|█▋        | 17/100 [00:02<00:09,  8.48it/s] 18%|█▊        | 18/100 [00:02<00:13,  6.27it/s] 19%|█▉        | 19/100 [00:02<00:11,  6.98it/s] 20%|██        | 20/100 [00:02<00:10,  7.35it/s] 21%|██        | 21/100 [00:02<00:10,  7.61it/s] 22%|██▏       | 22/100 [00:02<00:10,  7.55it/s] 23%|██▎       | 23/100 [00:02<00:09,  8.00it/s] 24%|██▍       | 24/100 [00:02<00:09,  8.20it/s] 25%|██▌       | 25/100 [00:03<00:08,  8.38it/s] 26%|██▌       | 26/100 [00:03<00:08,  8.50it/s] 27%|██▋       | 27/100 [00:03<00:08,  8.18it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.57it/s] 29%|██▉       | 29/100 [00:03<00:08,  8.87it/s] 30%|███       | 30/100 [00:03<00:07,  8.80it/s] 31%|███       | 31/100 [00:03<00:07,  8.68it/s] 32%|███▏      | 32/100 [00:03<00:07,  8.64it/s] 33%|███▎      | 33/100 [00:04<00:08,  8.16it/s] 34%|███▍      | 34/100 [00:04<00:08,  8.23it/s] 35%|███▌      | 35/100 [00:04<00:07,  8.50it/s] 36%|███▌      | 36/100 [00:04<00:07,  8.54it/s] 37%|███▋      | 37/100 [00:04<00:07,  8.40it/s] 38%|███▊      | 38/100 [00:04<00:07,  8.49it/s] 39%|███▉      | 39/100 [00:04<00:07,  8.21it/s] 40%|████      | 40/100 [00:04<00:07,  7.91it/s] 41%|████      | 41/100 [00:05<00:07,  8.13it/s] 42%|████▏     | 42/100 [00:05<00:07,  8.23it/s] 43%|████▎     | 43/100 [00:05<00:06,  8.51it/s] 44%|████▍     | 44/100 [00:05<00:06,  8.27it/s] 45%|████▌     | 45/100 [00:05<00:06,  8.38it/s] 46%|████▌     | 46/100 [00:05<00:06,  8.43it/s] 47%|████▋     | 47/100 [00:05<00:06,  8.24it/s] 48%|████▊     | 48/100 [00:05<00:06,  7.99it/s] 49%|████▉     | 49/100 [00:05<00:06,  8.26it/s] 50%|█████     | 50/100 [00:06<00:06,  8.14it/s] 51%|█████     | 51/100 [00:06<00:05,  8.26it/s] 52%|█████▏    | 52/100 [00:06<00:05,  8.15it/s] 53%|█████▎    | 53/100 [00:06<00:05,  8.31it/s] 54%|█████▍    | 54/100 [00:06<00:05,  8.15it/s] 55%|█████▌    | 55/100 [00:06<00:05,  8.26it/s] 56%|█████▌    | 56/100 [00:06<00:05,  8.33it/s] 57%|█████▋    | 57/100 [00:06<00:05,  7.86it/s] 58%|█████▊    | 58/100 [00:07<00:05,  7.75it/s] 59%|█████▉    | 59/100 [00:07<00:05,  7.77it/s] 60%|██████    | 60/100 [00:07<00:05,  7.96it/s] 61%|██████    | 61/100 [00:07<00:04,  8.02it/s] 62%|██████▏   | 62/100 [00:07<00:04,  8.06it/s] 63%|██████▎   | 63/100 [00:07<00:04,  7.85it/s] 64%|██████▍   | 64/100 [00:07<00:04,  7.79it/s] 65%|██████▌   | 65/100 [00:07<00:04,  7.81it/s] 66%|██████▌   | 66/100 [00:08<00:04,  7.80it/s] 67%|██████▋   | 67/100 [00:08<00:04,  7.88it/s] 68%|██████▊   | 68/100 [00:08<00:04,  7.57it/s] 69%|██████▉   | 69/100 [00:08<00:04,  7.69it/s] 70%|███████   | 70/100 [00:08<00:03,  7.62it/s] 71%|███████   | 71/100 [00:08<00:03,  7.68it/s] 72%|███████▏  | 72/100 [00:08<00:03,  7.85it/s] 73%|███████▎  | 73/100 [00:09<00:03,  7.73it/s] 74%|███████▍  | 74/100 [00:09<00:03,  7.86it/s] 75%|███████▌  | 75/100 [00:09<00:03,  7.87it/s] 76%|███████▌  | 76/100 [00:09<00:03,  7.84it/s] 77%|███████▋  | 77/100 [00:09<00:02,  7.84it/s] 78%|███████▊  | 78/100 [00:09<00:02,  7.83it/s] 79%|███████▉  | 79/100 [00:09<00:02,  7.82it/s] 80%|████████  | 80/100 [00:09<00:02,  7.97it/s] 81%|████████  | 81/100 [00:10<00:02,  7.82it/s] 82%|████████▏ | 82/100 [00:10<00:02,  7.97it/s] 83%|████████▎ | 83/100 [00:10<00:02,  8.06it/s] 84%|████████▍ | 84/100 [00:10<00:02,  7.91it/s] 85%|████████▌ | 85/100 [00:10<00:01,  7.69it/s] 86%|████████▌ | 86/100 [00:10<00:01,  7.50it/s] 87%|████████▋ | 87/100 [00:10<00:01,  7.57it/s] 88%|████████▊ | 88/100 [00:10<00:01,  7.59it/s] 89%|████████▉ | 89/100 [00:11<00:01,  7.53it/s] 90%|█████████ | 90/100 [00:11<00:01,  7.56it/s] 91%|█████████ | 91/100 [00:11<00:01,  7.55it/s] 92%|█████████▏| 92/100 [00:11<00:01,  7.65it/s] 93%|█████████▎| 93/100 [00:11<00:00,  7.61it/s] 94%|█████████▍| 94/100 [00:11<00:00,  7.47it/s] 95%|█████████▌| 95/100 [00:11<00:00,  7.41it/s] 96%|█████████▌| 96/100 [00:12<00:00,  7.47it/s] 97%|█████████▋| 97/100 [00:12<00:00,  7.59it/s] 98%|█████████▊| 98/100 [00:12<00:00,  7.67it/s] 99%|█████████▉| 99/100 [00:12<00:00,  7.61it/s]100%|██████████| 100/100 [00:12<00:00,  7.70it/s]100%|██████████| 100/100 [00:12<00:00,  7.98it/s]
eval_p_index len:  20
individual_train 119
individual_eval 20
train data의 x, y, id 길이: 119 119 119
valid data의 x, y, id 길이: 10 10 10
test data의 x, y, id 길이: 10 10 10
output_class :  1
Memory Allocated: 0.44 MB
Memory Reserved: 2.00 MB
cuda
Epoch 1, Train Loss 0.592059, Valid_loss 0.696757
Epoch 2, Train Loss 0.600447, Valid_loss 0.695311
Epoch 3, Train Loss 0.599515, Valid_loss 0.692362
Epoch 4, Train Loss 0.595017, Valid_loss 0.685240
Epoch 5, Train Loss 0.603976, Valid_loss 0.674223
Epoch 6, Train Loss 0.578713, Valid_loss 0.662277
Epoch 7, Train Loss 0.572041, Valid_loss 0.652391
Epoch 8, Train Loss 0.573414, Valid_loss 0.641727
Epoch 9, Train Loss 0.551393, Valid_loss 0.623468
Epoch 10, Train Loss 0.548859, Valid_loss 0.610010
Epoch 11, Train Loss 0.540869, Valid_loss 0.596011
Epoch 12, Train Loss 0.534815, Valid_loss 0.590777
Epoch 13, Train Loss 0.533858, Valid_loss 0.582883
Epoch 14, Train Loss 0.523124, Valid_loss 0.573396
Epoch 15, Train Loss 0.523820, Valid_loss 0.564884
Epoch 16, Train Loss 0.532400, Valid_loss 0.572836
Epoch 17, Train Loss 0.514268, Valid_loss 0.561571
Epoch 18, Train Loss 0.510962, Valid_loss 0.552406
Epoch 19, Train Loss 0.502851, Valid_loss 0.550356
Epoch 20, Train Loss 0.510182, Valid_loss 0.538297
Epoch 21, Train Loss 0.500567, Valid_loss 0.550048
Epoch 22, Train Loss 0.498671, Valid_loss 0.540571
Epoch 23, Train Loss 0.500055, Valid_loss 0.568428
Epoch 24, Train Loss 0.499938, Valid_loss 0.545309
Epoch 25, Train Loss 0.492310, Valid_loss 0.555981
Epoch 26, Train Loss 0.483749, Valid_loss 0.558334
Epoch 27, Train Loss 0.484197, Valid_loss 0.559447
Epoch 28, Train Loss 0.479017, Valid_loss 0.556971
Epoch 29, Train Loss 0.481537, Valid_loss 0.551273
Epoch 30, Train Loss 0.498417, Valid_loss 0.548835
Epoch 31, Train Loss 0.490262, Valid_loss 0.535694
Epoch 32, Train Loss 0.492197, Valid_loss 0.566222
Epoch 33, Train Loss 0.487110, Valid_loss 0.535409
Epoch 34, Train Loss 0.483623, Valid_loss 0.568150
Epoch 35, Train Loss 0.490351, Valid_loss 0.528216
Epoch 36, Train Loss 0.488064, Valid_loss 0.551438
Epoch 37, Train Loss 0.474905, Valid_loss 0.547696
Epoch 38, Train Loss 0.476265, Valid_loss 0.541637
Epoch 39, Train Loss 0.473615, Valid_loss 0.547114
Epoch 40, Train Loss 0.473258, Valid_loss 0.538595
Epoch 41, Train Loss 0.473623, Valid_loss 0.545244
Epoch 42, Train Loss 0.476424, Valid_loss 0.533417
Epoch 43, Train Loss 0.478511, Valid_loss 0.541108
Epoch 44, Train Loss 0.475568, Valid_loss 0.532929
Epoch 45, Train Loss 0.477669, Valid_loss 0.539034
Epoch 46, Train Loss 0.473074, Valid_loss 0.540179
Epoch 47, Train Loss 0.478021, Valid_loss 0.540567
Epoch 48, Train Loss 0.473201, Valid_loss 0.529407
Epoch 49, Train Loss 0.476122, Valid_loss 0.533018
Epoch 50, Train Loss 0.469287, Valid_loss 0.530347
Epoch 51, Train Loss 0.469996, Valid_loss 0.531221
Epoch 52, Train Loss 0.468075, Valid_loss 0.524765
Epoch 53, Train Loss 0.469800, Valid_loss 0.535349
Epoch 54, Train Loss 0.474135, Valid_loss 0.528398
Epoch 55, Train Loss 0.471688, Valid_loss 0.529476
Epoch 56, Train Loss 0.463023, Valid_loss 0.528576
Epoch 57, Train Loss 0.477611, Valid_loss 0.528009
Epoch 58, Train Loss 0.469883, Valid_loss 0.529502
Epoch 59, Train Loss 0.462438, Valid_loss 0.528473
Epoch 60, Train Loss 0.464253, Valid_loss 0.526066
Epoch 61, Train Loss 0.464259, Valid_loss 0.524268
Epoch 62, Train Loss 0.463377, Valid_loss 0.522522
Epoch 63, Train Loss 0.460534, Valid_loss 0.529394
Epoch 64, Train Loss 0.461543, Valid_loss 0.520187
Epoch 65, Train Loss 0.458291, Valid_loss 0.525448
Epoch 66, Train Loss 0.461624, Valid_loss 0.521351
Epoch 67, Train Loss 0.466093, Valid_loss 0.519746
Epoch 68, Train Loss 0.459902, Valid_loss 0.515819
Epoch 69, Train Loss 0.464264, Valid_loss 0.518879
Epoch 70, Train Loss 0.457658, Valid_loss 0.516163
Epoch 71, Train Loss 0.464074, Valid_loss 0.514559
Epoch 72, Train Loss 0.459079, Valid_loss 0.513967
Epoch 73, Train Loss 0.457874, Valid_loss 0.513602
Epoch 74, Train Loss 0.459924, Valid_loss 0.511882
Epoch 75, Train Loss 0.455423, Valid_loss 0.513053
Epoch 76, Train Loss 0.464683, Valid_loss 0.512262
Epoch 77, Train Loss 0.457525, Valid_loss 0.507824
Epoch 78, Train Loss 0.464584, Valid_loss 0.509423
Epoch 79, Train Loss 0.452128, Valid_loss 0.506611
Epoch 80, Train Loss 0.452349, Valid_loss 0.507597
Epoch 81, Train Loss 0.460169, Valid_loss 0.508208
COVID19_Participant5 -- true: COVID-19 -- pred: COVID-19
Control_Participant3 -- true: normal -- pred: normal
COVID19_Participant31 -- true: COVID-19 -- pred: COVID-19
COVID19_Participant7 -- true: COVID-19 -- pred: COVID-19
Control_Participant3 -- true: normal -- pred: COVID-19
Control_Participant1 -- true: normal -- pred: normal
Control_Participant4 -- true: normal -- pred: normal
Control_Participant3 -- true: normal -- pred: COVID-19
COVID19_Participant13 -- true: COVID-19 -- pred: COVID-19
COVID19_Participant26 -- true: COVID-19 -- pred: COVID-19
true :  [1, 0, 1, 1, 0, 0, 0, 0, 1, 1]
pred :  [1, 0, 1, 1, 1, 0, 0, 1, 1, 1]
Confusion Matrix: [3 2 0 5]
Best performance: Epoch 79, Loss 0.452128, Test ACC 0.800000, Test AUC 1.000000, Test Recall 1.000000, Test Precision 0.714286
✅ Total valid splits used: 1
🔁 Repeat 0, Fold 1
🔍 Split #2
  → train_p_index 환자 수: 31
  → test_p_index 환자 수: 8
  → train 환자 ID: ['COVID19_Participant11', 'COVID19_Participant13', 'COVID19_Participant14', 'COVID19_Participant17', 'COVID19_Participant18', 'COVID19_Participant19', 'COVID19_Participant2', 'COVID19_Participant20', 'COVID19_Participant22', 'COVID19_Participant23', 'COVID19_Participant25', 'COVID19_Participant26', 'COVID19_Participant28', 'COVID19_Participant29', 'COVID19_Participant30', 'COVID19_Participant37', 'COVID19_Participant39', 'COVID19_Participant4', 'COVID19_Participant40', 'COVID19_Participant7', 'COVID19_Participant8', 'Control_Participant1', 'Control_Participant10', 'Control_Participant11', 'Control_Participant14', 'Control_Participant4', 'Control_Participant5', 'Control_Participant6', 'Control_Participant7', 'Control_Participant8', 'Control_Participant9']
  → test  환자 ID: ['Control_Participant5', 'Control_Participant5', 'COVID19_Participant26', 'Control_Participant7', 'Control_Participant4', 'COVID19_Participant26', 'COVID19_Participant19', 'Control_Participant7']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant18, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant30, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant10, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant14, Label: 0
    ID: Control_Participant4, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant6, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant8, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: Control_Participant5, Label: 1
    ID: Control_Participant5, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: Control_Participant7, Label: 1
    ID: Control_Participant4, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant19, Label: 0
    ID: Control_Participant7, Label: 0
train_p_index_ 20
valid_p_index 11
test_p_index 8
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Keratinocytes', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Neurons', 'iPS_cells', 'Embryonic_stem_cells', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
data augment 실행 함
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:11,  8.43it/s]  2%|▏         | 2/100 [00:00<00:12,  7.58it/s]  3%|▎         | 3/100 [00:00<00:11,  8.18it/s]  4%|▍         | 4/100 [00:00<00:11,  8.41it/s]  5%|▌         | 5/100 [00:00<00:10,  8.74it/s]  6%|▌         | 6/100 [00:00<00:10,  9.10it/s]  7%|▋         | 7/100 [00:00<00:10,  9.15it/s]  8%|▊         | 8/100 [00:00<00:09,  9.37it/s]  9%|▉         | 9/100 [00:01<00:09,  9.23it/s] 10%|█         | 10/100 [00:01<00:09,  9.21it/s] 11%|█         | 11/100 [00:01<00:09,  9.00it/s] 12%|█▏        | 12/100 [00:01<00:11,  7.57it/s] 13%|█▎        | 13/100 [00:01<00:10,  7.99it/s] 14%|█▍        | 14/100 [00:01<00:10,  8.46it/s] 15%|█▌        | 15/100 [00:01<00:10,  8.22it/s] 16%|█▌        | 16/100 [00:01<00:10,  7.98it/s] 17%|█▋        | 17/100 [00:02<00:10,  8.22it/s] 18%|█▊        | 18/100 [00:02<00:10,  7.93it/s] 19%|█▉        | 19/100 [00:02<00:10,  8.09it/s] 20%|██        | 20/100 [00:02<00:09,  8.07it/s] 21%|██        | 21/100 [00:02<00:09,  8.14it/s] 22%|██▏       | 22/100 [00:02<00:10,  7.74it/s] 23%|██▎       | 23/100 [00:02<00:10,  7.08it/s] 24%|██▍       | 24/100 [00:02<00:10,  7.43it/s] 25%|██▌       | 25/100 [00:03<00:09,  7.68it/s] 26%|██▌       | 26/100 [00:03<00:09,  8.01it/s] 27%|██▋       | 27/100 [00:03<00:09,  8.02it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.10it/s] 29%|██▉       | 29/100 [00:03<00:08,  8.22it/s] 30%|███       | 30/100 [00:03<00:08,  8.17it/s] 31%|███       | 31/100 [00:03<00:09,  7.66it/s] 32%|███▏      | 32/100 [00:03<00:09,  7.12it/s] 33%|███▎      | 33/100 [00:04<00:08,  7.45it/s] 34%|███▍      | 34/100 [00:04<00:08,  7.79it/s] 35%|███▌      | 35/100 [00:04<00:08,  7.94it/s] 36%|███▌      | 36/100 [00:04<00:08,  7.73it/s] 37%|███▋      | 37/100 [00:04<00:07,  7.96it/s] 38%|███▊      | 38/100 [00:04<00:07,  8.08it/s] 39%|███▉      | 39/100 [00:04<00:07,  7.96it/s] 40%|████      | 40/100 [00:04<00:07,  7.80it/s] 41%|████      | 41/100 [00:05<00:08,  6.61it/s] 42%|████▏     | 42/100 [00:05<00:08,  7.14it/s] 43%|████▎     | 43/100 [00:05<00:07,  7.59it/s] 44%|████▍     | 44/100 [00:05<00:08,  6.82it/s] 45%|████▌     | 45/100 [00:05<00:07,  7.17it/s] 46%|████▌     | 46/100 [00:05<00:07,  7.28it/s] 47%|████▋     | 47/100 [00:05<00:06,  7.58it/s] 48%|████▊     | 48/100 [00:06<00:06,  7.76it/s] 49%|████▉     | 49/100 [00:06<00:06,  7.98it/s] 50%|█████     | 50/100 [00:06<00:06,  8.06it/s] 51%|█████     | 51/100 [00:06<00:05,  8.25it/s] 52%|█████▏    | 52/100 [00:06<00:05,  8.02it/s] 53%|█████▎    | 53/100 [00:06<00:05,  8.38it/s] 54%|█████▍    | 54/100 [00:06<00:05,  8.39it/s] 55%|█████▌    | 55/100 [00:06<00:05,  8.00it/s] 56%|█████▌    | 56/100 [00:07<00:05,  7.92it/s] 57%|█████▋    | 57/100 [00:07<00:05,  8.42it/s] 58%|█████▊    | 58/100 [00:07<00:05,  8.35it/s] 59%|█████▉    | 59/100 [00:07<00:04,  8.41it/s] 60%|██████    | 60/100 [00:07<00:04,  8.16it/s] 61%|██████    | 61/100 [00:07<00:04,  8.25it/s] 62%|██████▏   | 62/100 [00:07<00:04,  8.27it/s] 63%|██████▎   | 63/100 [00:07<00:04,  7.96it/s] 64%|██████▍   | 64/100 [00:08<00:04,  7.90it/s] 65%|██████▌   | 65/100 [00:08<00:04,  7.52it/s] 66%|██████▌   | 66/100 [00:08<00:04,  7.52it/s] 67%|██████▋   | 67/100 [00:08<00:04,  7.35it/s] 68%|██████▊   | 68/100 [00:08<00:04,  7.38it/s] 69%|██████▉   | 69/100 [00:08<00:04,  7.56it/s] 70%|███████   | 70/100 [00:08<00:03,  7.77it/s] 71%|███████   | 71/100 [00:08<00:03,  7.75it/s] 72%|███████▏  | 72/100 [00:09<00:03,  7.97it/s] 73%|███████▎  | 73/100 [00:09<00:03,  7.74it/s] 74%|███████▍  | 74/100 [00:09<00:03,  7.70it/s] 75%|███████▌  | 75/100 [00:09<00:03,  7.69it/s] 76%|███████▌  | 76/100 [00:09<00:03,  7.79it/s] 77%|███████▋  | 77/100 [00:09<00:02,  7.80it/s] 78%|███████▊  | 78/100 [00:09<00:02,  7.72it/s] 79%|███████▉  | 79/100 [00:09<00:02,  7.71it/s] 80%|████████  | 80/100 [00:10<00:02,  7.71it/s] 81%|████████  | 81/100 [00:10<00:02,  7.69it/s] 82%|████████▏ | 82/100 [00:10<00:02,  7.19it/s] 83%|████████▎ | 83/100 [00:10<00:02,  7.20it/s] 84%|████████▍ | 84/100 [00:10<00:02,  7.30it/s] 85%|████████▌ | 85/100 [00:10<00:02,  6.47it/s] 86%|████████▌ | 86/100 [00:11<00:02,  6.82it/s] 87%|████████▋ | 87/100 [00:11<00:01,  7.12it/s] 88%|████████▊ | 88/100 [00:11<00:01,  7.28it/s] 89%|████████▉ | 89/100 [00:11<00:01,  7.34it/s] 90%|█████████ | 90/100 [00:11<00:01,  7.50it/s] 91%|█████████ | 91/100 [00:11<00:01,  7.66it/s] 92%|█████████▏| 92/100 [00:11<00:01,  7.37it/s] 93%|█████████▎| 93/100 [00:11<00:00,  7.78it/s] 94%|█████████▍| 94/100 [00:12<00:00,  7.99it/s] 95%|█████████▌| 95/100 [00:12<00:00,  8.09it/s] 96%|█████████▌| 96/100 [00:12<00:00,  7.67it/s] 97%|█████████▋| 97/100 [00:12<00:00,  7.76it/s] 98%|█████████▊| 98/100 [00:12<00:00,  7.81it/s] 99%|█████████▉| 99/100 [00:12<00:00,  7.68it/s]100%|██████████| 100/100 [00:12<00:00,  7.57it/s]100%|██████████| 100/100 [00:12<00:00,  7.80it/s]
eval_p_index len:  19
individual_train 120
individual_eval 19
train data의 x, y, id 길이: 120 120 120
valid data의 x, y, id 길이: 11 11 11
test data의 x, y, id 길이: 8 8 8
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.662791, Valid_loss 0.603461
Epoch 2, Train Loss 0.668453, Valid_loss 0.587784
Epoch 3, Train Loss 0.650784, Valid_loss 0.584205
Epoch 4, Train Loss 0.635199, Valid_loss 0.581614
Epoch 5, Train Loss 0.634137, Valid_loss 0.573708
Epoch 6, Train Loss 0.629709, Valid_loss 0.567412
Epoch 7, Train Loss 0.628195, Valid_loss 0.560213
Epoch 8, Train Loss 0.616087, Valid_loss 0.553822
Epoch 9, Train Loss 0.599727, Valid_loss 0.542821
Epoch 10, Train Loss 0.586494, Valid_loss 0.520743
Epoch 11, Train Loss 0.572930, Valid_loss 0.499860
Epoch 12, Train Loss 0.569474, Valid_loss 0.483277
Epoch 13, Train Loss 0.551533, Valid_loss 0.470333
Epoch 14, Train Loss 0.545546, Valid_loss 0.458713
Epoch 15, Train Loss 0.542622, Valid_loss 0.449783
Epoch 16, Train Loss 0.529753, Valid_loss 0.443833
Epoch 17, Train Loss 0.530314, Valid_loss 0.435629
Epoch 18, Train Loss 0.527828, Valid_loss 0.431602
Epoch 19, Train Loss 0.521152, Valid_loss 0.425507
Epoch 20, Train Loss 0.516215, Valid_loss 0.422471
Epoch 21, Train Loss 0.518868, Valid_loss 0.418205
Epoch 22, Train Loss 0.521522, Valid_loss 0.410406
Epoch 23, Train Loss 0.510035, Valid_loss 0.406624
Epoch 24, Train Loss 0.508223, Valid_loss 0.404952
Epoch 25, Train Loss 0.511418, Valid_loss 0.399338
Epoch 26, Train Loss 0.515519, Valid_loss 0.398110
Epoch 27, Train Loss 0.502192, Valid_loss 0.400932
Epoch 28, Train Loss 0.506594, Valid_loss 0.392211
Epoch 29, Train Loss 0.495051, Valid_loss 0.403849
Epoch 30, Train Loss 0.497741, Valid_loss 0.388459
Epoch 31, Train Loss 0.493864, Valid_loss 0.396418
Epoch 32, Train Loss 0.493773, Valid_loss 0.381058
Epoch 33, Train Loss 0.481757, Valid_loss 0.383659
Epoch 34, Train Loss 0.498041, Valid_loss 0.371880
Epoch 35, Train Loss 0.487584, Valid_loss 0.373992
Epoch 36, Train Loss 0.476137, Valid_loss 0.368801
Epoch 37, Train Loss 0.478601, Valid_loss 0.373652
Epoch 38, Train Loss 0.480192, Valid_loss 0.368779
Epoch 39, Train Loss 0.477360, Valid_loss 0.365650
Epoch 40, Train Loss 0.481310, Valid_loss 0.359502
Epoch 41, Train Loss 0.476986, Valid_loss 0.366828
Epoch 42, Train Loss 0.484255, Valid_loss 0.359127
Epoch 43, Train Loss 0.477123, Valid_loss 0.364734
Epoch 44, Train Loss 0.472615, Valid_loss 0.366705
Epoch 45, Train Loss 0.462705, Valid_loss 0.346216
Epoch 46, Train Loss 0.467504, Valid_loss 0.356212
Epoch 47, Train Loss 0.469294, Valid_loss 0.346969
Epoch 48, Train Loss 0.469079, Valid_loss 0.360854
Epoch 49, Train Loss 0.472563, Valid_loss 0.353219
Epoch 50, Train Loss 0.470550, Valid_loss 0.342155
Epoch 51, Train Loss 0.472349, Valid_loss 0.347854
Epoch 52, Train Loss 0.463614, Valid_loss 0.350518
Control_Participant5 -- true: normal -- pred: normal
Control_Participant5 -- true: normal -- pred: normal
COVID19_Participant26 -- true: COVID-19 -- pred: COVID-19
Control_Participant7 -- true: normal -- pred: normal
Control_Participant4 -- true: normal -- pred: normal
COVID19_Participant26 -- true: COVID-19 -- pred: COVID-19
COVID19_Participant19 -- true: COVID-19 -- pred: COVID-19
Control_Participant7 -- true: normal -- pred: COVID-19
true :  [0, 0, 1, 0, 0, 1, 1, 0]
pred :  [0, 0, 1, 0, 0, 1, 1, 1]
Confusion Matrix: [4 1 0 3]
Best performance: Epoch 50, Loss 0.470550, Test ACC 0.875000, Test AUC 0.933333, Test Recall 1.000000, Test Precision 0.750000
✅ Total valid splits used: 2
🔁 Repeat 0, Fold 2
🔍 Split #3
  → train_p_index 환자 수: 33
  → test_p_index 환자 수: 6
  → train 환자 ID: ['COVID19_Participant11', 'COVID19_Participant12', 'COVID19_Participant13', 'COVID19_Participant15', 'COVID19_Participant17', 'COVID19_Participant18', 'COVID19_Participant19', 'COVID19_Participant20', 'COVID19_Participant22', 'COVID19_Participant25', 'COVID19_Participant26', 'COVID19_Participant28', 'COVID19_Participant29', 'COVID19_Participant3', 'COVID19_Participant30', 'COVID19_Participant31', 'COVID19_Participant32', 'COVID19_Participant36', 'COVID19_Participant37', 'COVID19_Participant39', 'COVID19_Participant40', 'COVID19_Participant7', 'COVID19_Participant8', 'Control_Participant1', 'Control_Participant10', 'Control_Participant14', 'Control_Participant15', 'Control_Participant3', 'Control_Participant5', 'Control_Participant6', 'Control_Participant7', 'Control_Participant8', 'Control_Participant9']
  → test  환자 ID: ['Control_Participant7', 'Control_Participant5', 'COVID19_Participant26', 'COVID19_Participant26', 'COVID19_Participant13', 'Control_Participant7']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant12, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant18, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant3, Label: 1
    ID: COVID19_Participant30, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant36, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant10, Label: 0
    ID: Control_Participant14, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant6, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant8, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: Control_Participant7, Label: 1
    ID: Control_Participant5, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant13, Label: 0
    ID: Control_Participant7, Label: 0
train_p_index_ 22
valid_p_index 11
test_p_index 6
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Keratinocytes', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Neurons', 'iPS_cells', 'Embryonic_stem_cells', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
data augment 실행 함
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:15,  6.45it/s]  2%|▏         | 2/100 [00:00<00:13,  7.26it/s]  3%|▎         | 3/100 [00:00<00:11,  8.12it/s]  4%|▍         | 4/100 [00:00<00:11,  8.53it/s]  5%|▌         | 5/100 [00:00<00:11,  8.62it/s]  6%|▌         | 6/100 [00:00<00:10,  8.59it/s]  7%|▋         | 7/100 [00:00<00:10,  8.56it/s]  8%|▊         | 8/100 [00:00<00:10,  8.89it/s]  9%|▉         | 9/100 [00:01<00:10,  8.86it/s] 10%|█         | 10/100 [00:01<00:10,  8.92it/s] 11%|█         | 11/100 [00:01<00:09,  9.16it/s] 12%|█▏        | 12/100 [00:01<00:09,  9.12it/s] 13%|█▎        | 13/100 [00:01<00:09,  9.09it/s] 14%|█▍        | 14/100 [00:01<00:09,  9.03it/s] 15%|█▌        | 15/100 [00:01<00:09,  8.67it/s] 16%|█▌        | 16/100 [00:01<00:09,  8.79it/s] 17%|█▋        | 17/100 [00:01<00:09,  8.81it/s] 18%|█▊        | 18/100 [00:02<00:09,  8.62it/s] 19%|█▉        | 19/100 [00:02<00:09,  8.42it/s] 20%|██        | 20/100 [00:02<00:09,  8.58it/s] 21%|██        | 21/100 [00:02<00:09,  8.27it/s] 22%|██▏       | 22/100 [00:02<00:09,  7.97it/s] 23%|██▎       | 23/100 [00:02<00:10,  7.60it/s] 24%|██▍       | 24/100 [00:02<00:10,  7.46it/s] 25%|██▌       | 25/100 [00:02<00:09,  7.83it/s] 26%|██▌       | 26/100 [00:03<00:09,  8.15it/s] 27%|██▋       | 27/100 [00:03<00:09,  8.07it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.20it/s] 29%|██▉       | 29/100 [00:03<00:08,  8.03it/s] 30%|███       | 30/100 [00:03<00:09,  7.55it/s] 31%|███       | 31/100 [00:03<00:08,  7.79it/s] 32%|███▏      | 32/100 [00:03<00:08,  7.89it/s] 33%|███▎      | 33/100 [00:03<00:08,  7.99it/s] 34%|███▍      | 34/100 [00:04<00:08,  8.14it/s] 35%|███▌      | 35/100 [00:04<00:08,  7.92it/s] 36%|███▌      | 36/100 [00:04<00:07,  8.01it/s] 37%|███▋      | 37/100 [00:04<00:07,  7.88it/s] 38%|███▊      | 38/100 [00:04<00:07,  8.10it/s] 39%|███▉      | 39/100 [00:04<00:07,  8.19it/s] 40%|████      | 40/100 [00:04<00:07,  8.39it/s] 41%|████      | 41/100 [00:04<00:07,  8.31it/s] 42%|████▏     | 42/100 [00:05<00:06,  8.40it/s] 43%|████▎     | 43/100 [00:05<00:06,  8.35it/s] 44%|████▍     | 44/100 [00:05<00:06,  8.32it/s] 45%|████▌     | 45/100 [00:05<00:06,  8.42it/s] 46%|████▌     | 46/100 [00:05<00:06,  8.00it/s] 47%|████▋     | 47/100 [00:05<00:06,  8.05it/s] 48%|████▊     | 48/100 [00:05<00:06,  8.02it/s] 49%|████▉     | 49/100 [00:05<00:06,  8.03it/s] 50%|█████     | 50/100 [00:06<00:06,  7.99it/s] 51%|█████     | 51/100 [00:06<00:06,  8.02it/s] 52%|█████▏    | 52/100 [00:06<00:05,  8.11it/s] 53%|█████▎    | 53/100 [00:06<00:05,  8.25it/s] 54%|█████▍    | 54/100 [00:06<00:05,  8.04it/s] 55%|█████▌    | 55/100 [00:06<00:05,  8.20it/s] 56%|█████▌    | 56/100 [00:06<00:05,  8.27it/s] 57%|█████▋    | 57/100 [00:06<00:05,  8.10it/s] 58%|█████▊    | 58/100 [00:07<00:05,  8.26it/s] 59%|█████▉    | 59/100 [00:07<00:05,  7.82it/s] 60%|██████    | 60/100 [00:07<00:04,  8.02it/s] 61%|██████    | 61/100 [00:07<00:05,  6.97it/s] 62%|██████▏   | 62/100 [00:07<00:05,  7.12it/s] 63%|██████▎   | 63/100 [00:07<00:04,  7.42it/s] 64%|██████▍   | 64/100 [00:07<00:04,  7.49it/s] 65%|██████▌   | 65/100 [00:07<00:04,  7.68it/s] 66%|██████▌   | 66/100 [00:08<00:04,  7.79it/s] 67%|██████▋   | 67/100 [00:08<00:04,  7.84it/s] 68%|██████▊   | 68/100 [00:08<00:04,  7.98it/s] 69%|██████▉   | 69/100 [00:08<00:03,  8.08it/s] 70%|███████   | 70/100 [00:08<00:03,  7.84it/s] 71%|███████   | 71/100 [00:08<00:03,  8.03it/s] 72%|███████▏  | 72/100 [00:08<00:03,  7.58it/s] 73%|███████▎  | 73/100 [00:09<00:03,  7.37it/s] 74%|███████▍  | 74/100 [00:09<00:03,  7.54it/s] 75%|███████▌  | 75/100 [00:09<00:03,  7.67it/s] 76%|███████▌  | 76/100 [00:09<00:03,  7.29it/s] 77%|███████▋  | 77/100 [00:09<00:03,  7.35it/s] 78%|███████▊  | 78/100 [00:09<00:02,  7.43it/s] 79%|███████▉  | 79/100 [00:09<00:02,  7.92it/s] 80%|████████  | 80/100 [00:09<00:02,  7.99it/s] 81%|████████  | 81/100 [00:10<00:02,  7.93it/s] 82%|████████▏ | 82/100 [00:10<00:02,  7.75it/s] 83%|████████▎ | 83/100 [00:10<00:02,  7.82it/s] 84%|████████▍ | 84/100 [00:10<00:01,  8.10it/s] 85%|████████▌ | 85/100 [00:10<00:01,  8.01it/s] 86%|████████▌ | 86/100 [00:10<00:01,  8.15it/s] 87%|████████▋ | 87/100 [00:10<00:01,  7.93it/s] 88%|████████▊ | 88/100 [00:10<00:01,  7.82it/s] 89%|████████▉ | 89/100 [00:11<00:01,  7.74it/s] 90%|█████████ | 90/100 [00:11<00:01,  7.85it/s] 91%|█████████ | 91/100 [00:11<00:01,  7.47it/s] 92%|█████████▏| 92/100 [00:11<00:01,  7.62it/s] 93%|█████████▎| 93/100 [00:11<00:00,  7.80it/s] 94%|█████████▍| 94/100 [00:11<00:00,  7.11it/s] 95%|█████████▌| 95/100 [00:11<00:00,  7.33it/s] 96%|█████████▌| 96/100 [00:12<00:00,  7.51it/s] 97%|█████████▋| 97/100 [00:12<00:00,  7.82it/s] 98%|█████████▊| 98/100 [00:12<00:00,  7.74it/s] 99%|█████████▉| 99/100 [00:12<00:00,  7.69it/s]100%|██████████| 100/100 [00:12<00:00,  7.79it/s]100%|██████████| 100/100 [00:12<00:00,  7.99it/s]
eval_p_index len:  17
individual_train 122
individual_eval 17
train data의 x, y, id 길이: 122 122 122
valid data의 x, y, id 길이: 11 11 11
test data의 x, y, id 길이: 6 6 6
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.778945, Valid_loss 0.771501
Epoch 2, Train Loss 0.743854, Valid_loss 0.728133
Epoch 3, Train Loss 0.712300, Valid_loss 0.693554
Epoch 4, Train Loss 0.682949, Valid_loss 0.668892
Epoch 5, Train Loss 0.662030, Valid_loss 0.650628
Epoch 6, Train Loss 0.649077, Valid_loss 0.640676
Epoch 7, Train Loss 0.639484, Valid_loss 0.636222
Epoch 8, Train Loss 0.635055, Valid_loss 0.633143
Epoch 9, Train Loss 0.622909, Valid_loss 0.629488
Epoch 10, Train Loss 0.617802, Valid_loss 0.624550
Epoch 11, Train Loss 0.612533, Valid_loss 0.619501
Epoch 12, Train Loss 0.604440, Valid_loss 0.615092
Epoch 13, Train Loss 0.597998, Valid_loss 0.610122
Epoch 14, Train Loss 0.592254, Valid_loss 0.603949
Epoch 15, Train Loss 0.585325, Valid_loss 0.596735
Epoch 16, Train Loss 0.577362, Valid_loss 0.590517
Epoch 17, Train Loss 0.567093, Valid_loss 0.583760
Epoch 18, Train Loss 0.562244, Valid_loss 0.575343
Epoch 19, Train Loss 0.554356, Valid_loss 0.565177
Epoch 20, Train Loss 0.541864, Valid_loss 0.554637
Epoch 21, Train Loss 0.528227, Valid_loss 0.545070
Epoch 22, Train Loss 0.518216, Valid_loss 0.540311
Epoch 23, Train Loss 0.507390, Valid_loss 0.531833
Epoch 24, Train Loss 0.501829, Valid_loss 0.524294
Epoch 25, Train Loss 0.495675, Valid_loss 0.519908
Epoch 26, Train Loss 0.487054, Valid_loss 0.518112
Epoch 27, Train Loss 0.480994, Valid_loss 0.511455
Epoch 28, Train Loss 0.473653, Valid_loss 0.507145
Epoch 29, Train Loss 0.471194, Valid_loss 0.503529
Epoch 30, Train Loss 0.473707, Valid_loss 0.501591
Epoch 31, Train Loss 0.472050, Valid_loss 0.494810
Epoch 32, Train Loss 0.466265, Valid_loss 0.489309
Epoch 33, Train Loss 0.462439, Valid_loss 0.490021
Epoch 34, Train Loss 0.460397, Valid_loss 0.485500
Epoch 35, Train Loss 0.461085, Valid_loss 0.482041
Epoch 36, Train Loss 0.461006, Valid_loss 0.478613
Epoch 37, Train Loss 0.456525, Valid_loss 0.477109
Epoch 38, Train Loss 0.454084, Valid_loss 0.471173
Epoch 39, Train Loss 0.455935, Valid_loss 0.469394
Epoch 40, Train Loss 0.451390, Valid_loss 0.466556
Epoch 41, Train Loss 0.453840, Valid_loss 0.461557
Epoch 42, Train Loss 0.445958, Valid_loss 0.458372
Epoch 43, Train Loss 0.446092, Valid_loss 0.453953
Epoch 44, Train Loss 0.439759, Valid_loss 0.447712
Epoch 45, Train Loss 0.440046, Valid_loss 0.443708
Epoch 46, Train Loss 0.437881, Valid_loss 0.441073
Epoch 47, Train Loss 0.434402, Valid_loss 0.438269
Epoch 48, Train Loss 0.435727, Valid_loss 0.435634
Epoch 49, Train Loss 0.432333, Valid_loss 0.433480
Epoch 50, Train Loss 0.434290, Valid_loss 0.432436
Epoch 51, Train Loss 0.433704, Valid_loss 0.431446
Epoch 52, Train Loss 0.429920, Valid_loss 0.430857
Epoch 53, Train Loss 0.429310, Valid_loss 0.430619
Epoch 54, Train Loss 0.431773, Valid_loss 0.429781
Epoch 55, Train Loss 0.434025, Valid_loss 0.428769
Epoch 56, Train Loss 0.430134, Valid_loss 0.428409
Epoch 57, Train Loss 0.429089, Valid_loss 0.427506
Epoch 58, Train Loss 0.427479, Valid_loss 0.426684
Epoch 59, Train Loss 0.429344, Valid_loss 0.425154
Epoch 60, Train Loss 0.429383, Valid_loss 0.424036
Epoch 61, Train Loss 0.430423, Valid_loss 0.422988
Epoch 62, Train Loss 0.428021, Valid_loss 0.421689
Epoch 63, Train Loss 0.422114, Valid_loss 0.421276
Epoch 64, Train Loss 0.427724, Valid_loss 0.419950
Epoch 65, Train Loss 0.427375, Valid_loss 0.419053
Epoch 66, Train Loss 0.426530, Valid_loss 0.417978
Epoch 67, Train Loss 0.423759, Valid_loss 0.417459
Epoch 68, Train Loss 0.420607, Valid_loss 0.416977
Epoch 69, Train Loss 0.425794, Valid_loss 0.415284
Epoch 70, Train Loss 0.421944, Valid_loss 0.414032
Epoch 71, Train Loss 0.425773, Valid_loss 0.412716
Epoch 72, Train Loss 0.419634, Valid_loss 0.411661
Epoch 73, Train Loss 0.419411, Valid_loss 0.410820
Epoch 74, Train Loss 0.420110, Valid_loss 0.409986
Epoch 75, Train Loss 0.415055, Valid_loss 0.409558
Epoch 76, Train Loss 0.421118, Valid_loss 0.408235
Epoch 77, Train Loss 0.420576, Valid_loss 0.406901
Epoch 78, Train Loss 0.417121, Valid_loss 0.405617
Epoch 79, Train Loss 0.421902, Valid_loss 0.404413
Epoch 80, Train Loss 0.416638, Valid_loss 0.403640
Epoch 81, Train Loss 0.419608, Valid_loss 0.402682
Epoch 82, Train Loss 0.422135, Valid_loss 0.401776
Epoch 83, Train Loss 0.413436, Valid_loss 0.400870
Epoch 84, Train Loss 0.410919, Valid_loss 0.399792
Epoch 85, Train Loss 0.417478, Valid_loss 0.398516
Epoch 86, Train Loss 0.410170, Valid_loss 0.397752
Epoch 87, Train Loss 0.415588, Valid_loss 0.396348
Epoch 88, Train Loss 0.415927, Valid_loss 0.395640
Epoch 89, Train Loss 0.413726, Valid_loss 0.395001
Epoch 90, Train Loss 0.417564, Valid_loss 0.393609
Epoch 91, Train Loss 0.413474, Valid_loss 0.392873
Epoch 92, Train Loss 0.410056, Valid_loss 0.392099
Epoch 93, Train Loss 0.413788, Valid_loss 0.390996
Epoch 94, Train Loss 0.410667, Valid_loss 0.389851
Epoch 95, Train Loss 0.413564, Valid_loss 0.389376
Epoch 96, Train Loss 0.410895, Valid_loss 0.387760
Epoch 97, Train Loss 0.410363, Valid_loss 0.387245
Epoch 98, Train Loss 0.411244, Valid_loss 0.386009
Epoch 99, Train Loss 0.410826, Valid_loss 0.384468
Epoch 100, Train Loss 0.411265, Valid_loss 0.383832
Control_Participant7 -- true: normal -- pred: COVID-19
Control_Participant5 -- true: normal -- pred: normal
COVID19_Participant26 -- true: COVID-19 -- pred: COVID-19
COVID19_Participant26 -- true: COVID-19 -- pred: COVID-19
COVID19_Participant13 -- true: COVID-19 -- pred: COVID-19
Control_Participant7 -- true: normal -- pred: normal
true :  [0, 0, 1, 1, 1, 0]
pred :  [1, 0, 1, 1, 1, 0]
Confusion Matrix: [2 1 0 3]
Best performance: Epoch 100, Loss 0.411265, Test ACC 0.833333, Test AUC 1.000000, Test Recall 1.000000, Test Precision 0.750000
✅ Total valid splits used: 3
🔁 Repeat 0, Fold 3
🔍 Split #4
  → train_p_index 환자 수: 32
  → test_p_index 환자 수: 7
  → train 환자 ID: ['COVID19_Participant11', 'COVID19_Participant12', 'COVID19_Participant13', 'COVID19_Participant14', 'COVID19_Participant15', 'COVID19_Participant17', 'COVID19_Participant18', 'COVID19_Participant2', 'COVID19_Participant22', 'COVID19_Participant23', 'COVID19_Participant25', 'COVID19_Participant28', 'COVID19_Participant3', 'COVID19_Participant30', 'COVID19_Participant31', 'COVID19_Participant32', 'COVID19_Participant36', 'COVID19_Participant37', 'COVID19_Participant39', 'COVID19_Participant4', 'COVID19_Participant40', 'COVID19_Participant8', 'Control_Participant1', 'Control_Participant10', 'Control_Participant11', 'Control_Participant14', 'Control_Participant15', 'Control_Participant3', 'Control_Participant4', 'Control_Participant6', 'Control_Participant7', 'Control_Participant9']
  → test  환자 ID: ['Control_Participant12', 'Control_Participant3', 'Control_Participant7', 'COVID19_Participant11', 'COVID19_Participant13', 'COVID19_Participant13', 'COVID19_Participant25']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant12, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant18, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant3, Label: 1
    ID: COVID19_Participant30, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant36, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant10, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant14, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant4, Label: 0
    ID: Control_Participant6, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: Control_Participant12, Label: 1
    ID: Control_Participant3, Label: 1
    ID: Control_Participant7, Label: 1
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant13, Label: 0
    ID: COVID19_Participant25, Label: 0
train_p_index_ 21
valid_p_index 11
test_p_index 7
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Keratinocytes', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Neurons', 'iPS_cells', 'Embryonic_stem_cells', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
data augment 실행 함
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:11,  8.63it/s]  3%|▎         | 3/100 [00:00<00:11,  8.72it/s]  4%|▍         | 4/100 [00:00<00:11,  8.27it/s]  5%|▌         | 5/100 [00:00<00:11,  8.30it/s]  6%|▌         | 6/100 [00:00<00:11,  8.17it/s]  7%|▋         | 7/100 [00:00<00:11,  8.35it/s]  8%|▊         | 8/100 [00:00<00:10,  8.69it/s] 10%|█         | 10/100 [00:01<00:09,  9.09it/s] 11%|█         | 11/100 [00:01<00:10,  8.74it/s] 13%|█▎        | 13/100 [00:01<00:09,  9.16it/s] 14%|█▍        | 14/100 [00:01<00:10,  7.99it/s] 15%|█▌        | 15/100 [00:01<00:10,  8.21it/s] 16%|█▌        | 16/100 [00:01<00:09,  8.49it/s] 17%|█▋        | 17/100 [00:01<00:09,  8.69it/s] 18%|█▊        | 18/100 [00:02<00:09,  8.96it/s] 19%|█▉        | 19/100 [00:02<00:09,  9.00it/s] 20%|██        | 20/100 [00:02<00:09,  8.89it/s] 21%|██        | 21/100 [00:02<00:08,  8.83it/s] 22%|██▏       | 22/100 [00:02<00:08,  8.76it/s] 23%|██▎       | 23/100 [00:02<00:08,  8.94it/s] 24%|██▍       | 24/100 [00:02<00:08,  8.99it/s] 25%|██▌       | 25/100 [00:02<00:08,  9.18it/s] 26%|██▌       | 26/100 [00:02<00:08,  8.89it/s] 27%|██▋       | 27/100 [00:03<00:08,  9.11it/s] 28%|██▊       | 28/100 [00:03<00:09,  7.64it/s] 29%|██▉       | 29/100 [00:03<00:08,  8.03it/s] 30%|███       | 30/100 [00:03<00:08,  8.36it/s] 31%|███       | 31/100 [00:03<00:08,  8.51it/s] 32%|███▏      | 32/100 [00:03<00:07,  8.71it/s] 33%|███▎      | 33/100 [00:03<00:07,  8.72it/s] 34%|███▍      | 34/100 [00:03<00:07,  8.67it/s] 35%|███▌      | 35/100 [00:04<00:07,  8.74it/s] 36%|███▌      | 36/100 [00:04<00:07,  9.01it/s] 37%|███▋      | 37/100 [00:04<00:06,  9.01it/s] 38%|███▊      | 38/100 [00:04<00:07,  8.60it/s] 39%|███▉      | 39/100 [00:04<00:07,  8.68it/s] 40%|████      | 40/100 [00:04<00:07,  8.34it/s] 41%|████      | 41/100 [00:04<00:07,  8.31it/s] 42%|████▏     | 42/100 [00:04<00:06,  8.58it/s] 43%|████▎     | 43/100 [00:04<00:06,  8.72it/s] 44%|████▍     | 44/100 [00:05<00:06,  8.04it/s] 45%|████▌     | 45/100 [00:05<00:06,  8.31it/s] 46%|████▌     | 46/100 [00:05<00:06,  8.39it/s] 47%|████▋     | 47/100 [00:05<00:06,  8.34it/s] 48%|████▊     | 48/100 [00:05<00:06,  8.10it/s] 49%|████▉     | 49/100 [00:05<00:06,  8.23it/s] 50%|█████     | 50/100 [00:05<00:06,  7.85it/s] 51%|█████     | 51/100 [00:05<00:05,  8.18it/s] 52%|█████▏    | 52/100 [00:06<00:05,  8.17it/s] 53%|█████▎    | 53/100 [00:06<00:05,  7.84it/s] 54%|█████▍    | 54/100 [00:06<00:05,  8.13it/s] 55%|█████▌    | 55/100 [00:06<00:05,  8.34it/s] 56%|█████▌    | 56/100 [00:06<00:05,  8.54it/s] 57%|█████▋    | 57/100 [00:06<00:04,  8.61it/s] 58%|█████▊    | 58/100 [00:06<00:04,  8.81it/s] 59%|█████▉    | 59/100 [00:06<00:04,  8.67it/s] 60%|██████    | 60/100 [00:07<00:04,  8.85it/s] 61%|██████    | 61/100 [00:07<00:04,  8.49it/s] 62%|██████▏   | 62/100 [00:07<00:04,  8.51it/s] 63%|██████▎   | 63/100 [00:07<00:04,  8.71it/s] 64%|██████▍   | 64/100 [00:07<00:04,  8.52it/s] 65%|██████▌   | 65/100 [00:07<00:04,  8.28it/s] 66%|██████▌   | 66/100 [00:07<00:04,  8.34it/s] 67%|██████▋   | 67/100 [00:07<00:03,  8.37it/s] 68%|██████▊   | 68/100 [00:07<00:03,  8.51it/s] 69%|██████▉   | 69/100 [00:08<00:03,  8.05it/s] 70%|███████   | 70/100 [00:08<00:03,  8.08it/s] 71%|███████   | 71/100 [00:08<00:03,  7.80it/s] 72%|███████▏  | 72/100 [00:08<00:03,  7.90it/s] 73%|███████▎  | 73/100 [00:08<00:03,  7.80it/s] 74%|███████▍  | 74/100 [00:08<00:03,  7.85it/s] 75%|███████▌  | 75/100 [00:08<00:03,  8.13it/s] 76%|███████▌  | 76/100 [00:08<00:02,  8.32it/s] 77%|███████▋  | 77/100 [00:09<00:02,  8.42it/s] 78%|███████▊  | 78/100 [00:09<00:02,  8.63it/s] 79%|███████▉  | 79/100 [00:09<00:02,  8.11it/s] 80%|████████  | 80/100 [00:09<00:02,  8.34it/s] 81%|████████  | 81/100 [00:09<00:02,  8.27it/s] 82%|████████▏ | 82/100 [00:09<00:02,  8.12it/s] 83%|████████▎ | 83/100 [00:09<00:02,  8.20it/s] 84%|████████▍ | 84/100 [00:09<00:01,  8.26it/s] 85%|████████▌ | 85/100 [00:10<00:01,  8.46it/s] 86%|████████▌ | 86/100 [00:10<00:01,  8.37it/s] 87%|████████▋ | 87/100 [00:10<00:01,  8.46it/s] 88%|████████▊ | 88/100 [00:10<00:01,  8.22it/s] 90%|█████████ | 90/100 [00:10<00:01,  8.80it/s] 91%|█████████ | 91/100 [00:10<00:01,  8.83it/s] 92%|█████████▏| 92/100 [00:10<00:00,  8.90it/s] 93%|█████████▎| 93/100 [00:10<00:00,  8.87it/s] 94%|█████████▍| 94/100 [00:11<00:00,  8.76it/s] 95%|█████████▌| 95/100 [00:11<00:00,  8.74it/s] 96%|█████████▌| 96/100 [00:11<00:00,  8.61it/s] 97%|█████████▋| 97/100 [00:11<00:00,  8.62it/s] 98%|█████████▊| 98/100 [00:11<00:00,  8.20it/s] 99%|█████████▉| 99/100 [00:11<00:00,  8.30it/s]100%|██████████| 100/100 [00:11<00:00,  8.29it/s]100%|██████████| 100/100 [00:11<00:00,  8.46it/s]
eval_p_index len:  18
individual_train 121
individual_eval 18
train data의 x, y, id 길이: 121 121 121
valid data의 x, y, id 길이: 11 11 11
test data의 x, y, id 길이: 7 7 7
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.658655, Valid_loss 0.589385
Epoch 2, Train Loss 0.609308, Valid_loss 0.568087
Epoch 3, Train Loss 0.598804, Valid_loss 0.556348
Epoch 4, Train Loss 0.579858, Valid_loss 0.546750
Epoch 5, Train Loss 0.565492, Valid_loss 0.522998
Epoch 6, Train Loss 0.553460, Valid_loss 0.502410
Epoch 7, Train Loss 0.544710, Valid_loss 0.486805
Epoch 8, Train Loss 0.532740, Valid_loss 0.477114
Epoch 9, Train Loss 0.523524, Valid_loss 0.470754
Epoch 10, Train Loss 0.514929, Valid_loss 0.461824
Epoch 11, Train Loss 0.500775, Valid_loss 0.456632
Epoch 12, Train Loss 0.494599, Valid_loss 0.462898
Epoch 13, Train Loss 0.494345, Valid_loss 0.466094
Epoch 14, Train Loss 0.485680, Valid_loss 0.470644
Epoch 15, Train Loss 0.483286, Valid_loss 0.465728
Epoch 16, Train Loss 0.476416, Valid_loss 0.460420
Epoch 17, Train Loss 0.480257, Valid_loss 0.456058
Epoch 18, Train Loss 0.468195, Valid_loss 0.454428
Epoch 19, Train Loss 0.466122, Valid_loss 0.453707
Epoch 20, Train Loss 0.467535, Valid_loss 0.449422
Epoch 21, Train Loss 0.466738, Valid_loss 0.448112
Epoch 22, Train Loss 0.464987, Valid_loss 0.447253
Epoch 23, Train Loss 0.466259, Valid_loss 0.441655
Epoch 24, Train Loss 0.459859, Valid_loss 0.440508
Epoch 25, Train Loss 0.453223, Valid_loss 0.440306
Epoch 26, Train Loss 0.455798, Valid_loss 0.436210
Epoch 27, Train Loss 0.454263, Valid_loss 0.435739
Epoch 28, Train Loss 0.454812, Valid_loss 0.434375
Epoch 29, Train Loss 0.450222, Valid_loss 0.434150
Epoch 30, Train Loss 0.448843, Valid_loss 0.430973
Epoch 31, Train Loss 0.442327, Valid_loss 0.433575
Epoch 32, Train Loss 0.442110, Valid_loss 0.430572
Epoch 33, Train Loss 0.443976, Valid_loss 0.430996
Epoch 34, Train Loss 0.440589, Valid_loss 0.430547
Epoch 35, Train Loss 0.438000, Valid_loss 0.428876
Epoch 36, Train Loss 0.442422, Valid_loss 0.427773
Epoch 37, Train Loss 0.443812, Valid_loss 0.427215
Epoch 38, Train Loss 0.434302, Valid_loss 0.425331
Epoch 39, Train Loss 0.433494, Valid_loss 0.428544
Epoch 40, Train Loss 0.439408, Valid_loss 0.424380
Epoch 41, Train Loss 0.432244, Valid_loss 0.426279
Epoch 42, Train Loss 0.436223, Valid_loss 0.423680
Epoch 43, Train Loss 0.426774, Valid_loss 0.423374
Epoch 44, Train Loss 0.429143, Valid_loss 0.420457
Epoch 45, Train Loss 0.430706, Valid_loss 0.420457
Epoch 46, Train Loss 0.427358, Valid_loss 0.421072
Epoch 47, Train Loss 0.432757, Valid_loss 0.416607
Epoch 48, Train Loss 0.424718, Valid_loss 0.419381
Epoch 49, Train Loss 0.424445, Valid_loss 0.415608
Epoch 50, Train Loss 0.422119, Valid_loss 0.413871
Epoch 51, Train Loss 0.427522, Valid_loss 0.413787
Epoch 52, Train Loss 0.419932, Valid_loss 0.415098
Epoch 53, Train Loss 0.422329, Valid_loss 0.414700
Epoch 54, Train Loss 0.423442, Valid_loss 0.412445
Epoch 55, Train Loss 0.428938, Valid_loss 0.413426
Epoch 56, Train Loss 0.419884, Valid_loss 0.412939
Epoch 57, Train Loss 0.423834, Valid_loss 0.412216
Epoch 58, Train Loss 0.418457, Valid_loss 0.411092
Epoch 59, Train Loss 0.416822, Valid_loss 0.411565
Epoch 60, Train Loss 0.422083, Valid_loss 0.410926
Epoch 61, Train Loss 0.419595, Valid_loss 0.409399
Epoch 62, Train Loss 0.421953, Valid_loss 0.409769
Epoch 63, Train Loss 0.423478, Valid_loss 0.409341
Epoch 64, Train Loss 0.418262, Valid_loss 0.409544
Epoch 65, Train Loss 0.416899, Valid_loss 0.408146
Epoch 66, Train Loss 0.415655, Valid_loss 0.407556
Epoch 67, Train Loss 0.415878, Valid_loss 0.407370
Epoch 68, Train Loss 0.414328, Valid_loss 0.407501
Epoch 69, Train Loss 0.418209, Valid_loss 0.406535
Epoch 70, Train Loss 0.413487, Valid_loss 0.405341
Epoch 71, Train Loss 0.411491, Valid_loss 0.405079
Epoch 72, Train Loss 0.416306, Valid_loss 0.406542
Epoch 73, Train Loss 0.408115, Valid_loss 0.404703
Epoch 74, Train Loss 0.407884, Valid_loss 0.404695
Epoch 75, Train Loss 0.411849, Valid_loss 0.403517
Epoch 76, Train Loss 0.414576, Valid_loss 0.404231
Epoch 77, Train Loss 0.414617, Valid_loss 0.403736
Epoch 78, Train Loss 0.413846, Valid_loss 0.402962
Epoch 79, Train Loss 0.412205, Valid_loss 0.402050
Epoch 80, Train Loss 0.408070, Valid_loss 0.402459
Epoch 81, Train Loss 0.410895, Valid_loss 0.401445
Epoch 82, Train Loss 0.406656, Valid_loss 0.400996
Epoch 83, Train Loss 0.404246, Valid_loss 0.400153
Epoch 84, Train Loss 0.402398, Valid_loss 0.399245
Epoch 85, Train Loss 0.404326, Valid_loss 0.399977
Epoch 86, Train Loss 0.408391, Valid_loss 0.399146
Epoch 87, Train Loss 0.406417, Valid_loss 0.398918
Epoch 88, Train Loss 0.409504, Valid_loss 0.399175
Epoch 89, Train Loss 0.402416, Valid_loss 0.397511
Epoch 90, Train Loss 0.404855, Valid_loss 0.397138
Epoch 91, Train Loss 0.407175, Valid_loss 0.397174
Epoch 92, Train Loss 0.402317, Valid_loss 0.397139
Epoch 93, Train Loss 0.398669, Valid_loss 0.395961
Epoch 94, Train Loss 0.404490, Valid_loss 0.395810
Epoch 95, Train Loss 0.400471, Valid_loss 0.395148
Epoch 96, Train Loss 0.400908, Valid_loss 0.394265
Epoch 97, Train Loss 0.398436, Valid_loss 0.394950
Epoch 98, Train Loss 0.399568, Valid_loss 0.393180
Epoch 99, Train Loss 0.402331, Valid_loss 0.393675
Epoch 100, Train Loss 0.397024, Valid_loss 0.393291
Control_Participant12 -- true: normal -- pred: normal
Control_Participant3 -- true: normal -- pred: normal
Control_Participant7 -- true: normal -- pred: normal
COVID19_Participant11 -- true: COVID-19 -- pred: normal
COVID19_Participant13 -- true: COVID-19 -- pred: COVID-19
COVID19_Participant13 -- true: COVID-19 -- pred: COVID-19
COVID19_Participant25 -- true: COVID-19 -- pred: COVID-19
true :  [0, 0, 0, 1, 1, 1, 1]
pred :  [0, 0, 0, 0, 1, 1, 1]
Confusion Matrix: [3 0 1 3]
Best performance: Epoch 98, Loss 0.399568, Test ACC 0.857143, Test AUC 0.833333, Test Recall 0.750000, Test Precision 1.000000
✅ Total valid splits used: 4
🔁 Repeat 0, Fold 4
🔍 Split #5
  → train_p_index 환자 수: 31
  → test_p_index 환자 수: 8
  → train 환자 ID: ['COVID19_Participant11', 'COVID19_Participant12', 'COVID19_Participant14', 'COVID19_Participant15', 'COVID19_Participant18', 'COVID19_Participant19', 'COVID19_Participant2', 'COVID19_Participant20', 'COVID19_Participant23', 'COVID19_Participant25', 'COVID19_Participant26', 'COVID19_Participant28', 'COVID19_Participant29', 'COVID19_Participant3', 'COVID19_Participant30', 'COVID19_Participant31', 'COVID19_Participant32', 'COVID19_Participant36', 'COVID19_Participant39', 'COVID19_Participant4', 'COVID19_Participant7', 'COVID19_Participant8', 'Control_Participant11', 'Control_Participant14', 'Control_Participant15', 'Control_Participant3', 'Control_Participant4', 'Control_Participant5', 'Control_Participant7', 'Control_Participant8', 'Control_Participant9']
  → test  환자 ID: ['Control_Participant7', 'Control_Participant5', 'Control_Participant3', 'COVID19_Participant25', 'COVID19_Participant11', 'Control_Participant7', 'Control_Participant12', 'Control_Participant3']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant12, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant18, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant3, Label: 1
    ID: COVID19_Participant30, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant36, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: Control_Participant11, Label: 0
    ID: Control_Participant14, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant4, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant8, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: Control_Participant7, Label: 1
    ID: Control_Participant5, Label: 1
    ID: Control_Participant3, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant11, Label: 1
    ID: Control_Participant7, Label: 0
    ID: Control_Participant12, Label: 0
    ID: Control_Participant3, Label: 0
train_p_index_ 20
valid_p_index 11
test_p_index 8
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Keratinocytes', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Neurons', 'iPS_cells', 'Embryonic_stem_cells', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
data augment 실행 함
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:10,  9.25it/s]  2%|▏         | 2/100 [00:00<00:10,  9.05it/s]  3%|▎         | 3/100 [00:00<00:10,  9.36it/s]  4%|▍         | 4/100 [00:00<00:11,  8.65it/s]  5%|▌         | 5/100 [00:00<00:11,  8.05it/s]  6%|▌         | 6/100 [00:00<00:11,  8.28it/s]  7%|▋         | 7/100 [00:00<00:11,  8.36it/s]  8%|▊         | 8/100 [00:00<00:10,  8.38it/s]  9%|▉         | 9/100 [00:01<00:10,  8.69it/s] 10%|█         | 10/100 [00:01<00:10,  8.95it/s] 11%|█         | 11/100 [00:01<00:09,  9.08it/s] 12%|█▏        | 12/100 [00:01<00:09,  9.17it/s] 13%|█▎        | 13/100 [00:01<00:09,  9.17it/s] 15%|█▌        | 15/100 [00:01<00:09,  9.37it/s] 16%|█▌        | 16/100 [00:01<00:12,  6.86it/s] 17%|█▋        | 17/100 [00:02<00:12,  6.63it/s] 18%|█▊        | 18/100 [00:02<00:11,  7.00it/s] 19%|█▉        | 19/100 [00:02<00:10,  7.38it/s] 20%|██        | 20/100 [00:02<00:10,  7.84it/s] 21%|██        | 21/100 [00:02<00:09,  8.06it/s] 22%|██▏       | 22/100 [00:02<00:09,  8.39it/s] 23%|██▎       | 23/100 [00:02<00:09,  7.91it/s] 24%|██▍       | 24/100 [00:02<00:09,  7.73it/s] 25%|██▌       | 25/100 [00:03<00:09,  8.07it/s] 26%|██▌       | 26/100 [00:03<00:09,  8.08it/s] 27%|██▋       | 27/100 [00:03<00:08,  8.20it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.34it/s] 29%|██▉       | 29/100 [00:03<00:08,  8.65it/s] 30%|███       | 30/100 [00:03<00:08,  8.45it/s] 31%|███       | 31/100 [00:03<00:08,  8.52it/s] 32%|███▏      | 32/100 [00:03<00:07,  8.50it/s] 33%|███▎      | 33/100 [00:04<00:07,  8.60it/s] 34%|███▍      | 34/100 [00:04<00:09,  6.91it/s] 35%|███▌      | 35/100 [00:04<00:09,  6.86it/s] 36%|███▌      | 36/100 [00:04<00:08,  7.35it/s] 37%|███▋      | 37/100 [00:04<00:08,  7.59it/s] 38%|███▊      | 38/100 [00:04<00:08,  7.59it/s] 39%|███▉      | 39/100 [00:04<00:07,  7.77it/s] 40%|████      | 40/100 [00:04<00:07,  7.86it/s] 41%|████      | 41/100 [00:05<00:07,  7.96it/s] 42%|████▏     | 42/100 [00:05<00:07,  7.88it/s] 43%|████▎     | 43/100 [00:05<00:07,  7.96it/s] 44%|████▍     | 44/100 [00:05<00:06,  8.12it/s] 45%|████▌     | 45/100 [00:05<00:06,  8.22it/s] 46%|████▌     | 46/100 [00:05<00:06,  8.32it/s] 47%|████▋     | 47/100 [00:05<00:06,  8.32it/s] 48%|████▊     | 48/100 [00:05<00:06,  8.39it/s] 49%|████▉     | 49/100 [00:06<00:06,  8.26it/s] 50%|█████     | 50/100 [00:06<00:06,  7.83it/s] 51%|█████     | 51/100 [00:06<00:06,  7.50it/s] 52%|█████▏    | 52/100 [00:06<00:08,  5.81it/s] 53%|█████▎    | 53/100 [00:06<00:07,  6.17it/s] 54%|█████▍    | 54/100 [00:06<00:06,  6.58it/s] 55%|█████▌    | 55/100 [00:06<00:06,  7.12it/s] 56%|█████▌    | 56/100 [00:07<00:06,  7.32it/s] 57%|█████▋    | 57/100 [00:07<00:05,  7.69it/s] 58%|█████▊    | 58/100 [00:07<00:05,  7.82it/s] 59%|█████▉    | 59/100 [00:07<00:05,  7.69it/s] 60%|██████    | 60/100 [00:07<00:05,  7.90it/s] 61%|██████    | 61/100 [00:07<00:04,  8.18it/s] 62%|██████▏   | 62/100 [00:07<00:04,  8.30it/s] 63%|██████▎   | 63/100 [00:07<00:04,  8.53it/s] 64%|██████▍   | 64/100 [00:08<00:04,  7.47it/s] 65%|██████▌   | 65/100 [00:08<00:04,  7.34it/s] 66%|██████▌   | 66/100 [00:08<00:04,  7.52it/s] 67%|██████▋   | 67/100 [00:08<00:04,  7.39it/s] 68%|██████▊   | 68/100 [00:08<00:04,  7.57it/s] 69%|██████▉   | 69/100 [00:08<00:04,  7.73it/s] 70%|███████   | 70/100 [00:08<00:03,  7.82it/s] 71%|███████   | 71/100 [00:09<00:03,  7.98it/s] 72%|███████▏  | 72/100 [00:09<00:03,  7.63it/s] 73%|███████▎  | 73/100 [00:09<00:03,  7.75it/s] 74%|███████▍  | 74/100 [00:09<00:03,  7.82it/s] 75%|███████▌  | 75/100 [00:09<00:03,  7.83it/s] 76%|███████▌  | 76/100 [00:09<00:03,  7.83it/s] 77%|███████▋  | 77/100 [00:09<00:02,  7.67it/s] 78%|███████▊  | 78/100 [00:09<00:02,  7.69it/s] 79%|███████▉  | 79/100 [00:10<00:02,  7.72it/s] 80%|████████  | 80/100 [00:10<00:02,  7.84it/s] 81%|████████  | 81/100 [00:10<00:02,  7.91it/s] 82%|████████▏ | 82/100 [00:10<00:02,  7.44it/s] 83%|████████▎ | 83/100 [00:10<00:02,  7.62it/s] 84%|████████▍ | 84/100 [00:10<00:02,  7.53it/s] 85%|████████▌ | 85/100 [00:10<00:02,  7.41it/s] 86%|████████▌ | 86/100 [00:11<00:01,  7.45it/s] 87%|████████▋ | 87/100 [00:11<00:01,  7.13it/s] 88%|████████▊ | 88/100 [00:11<00:01,  7.31it/s] 89%|████████▉ | 89/100 [00:11<00:01,  7.40it/s] 90%|█████████ | 90/100 [00:11<00:01,  7.64it/s] 91%|█████████ | 91/100 [00:11<00:01,  7.65it/s] 92%|█████████▏| 92/100 [00:11<00:01,  7.67it/s] 93%|█████████▎| 93/100 [00:11<00:00,  7.46it/s] 94%|█████████▍| 94/100 [00:12<00:00,  6.98it/s] 95%|█████████▌| 95/100 [00:12<00:00,  7.18it/s] 96%|█████████▌| 96/100 [00:12<00:00,  7.53it/s] 97%|█████████▋| 97/100 [00:12<00:00,  7.57it/s] 98%|█████████▊| 98/100 [00:12<00:00,  7.41it/s] 99%|█████████▉| 99/100 [00:12<00:00,  7.45it/s]100%|██████████| 100/100 [00:12<00:00,  7.53it/s]100%|██████████| 100/100 [00:12<00:00,  7.76it/s]
eval_p_index len:  19
individual_train 120
individual_eval 19
train data의 x, y, id 길이: 120 120 120
valid data의 x, y, id 길이: 11 11 11
test data의 x, y, id 길이: 8 8 8
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.760031, Valid_loss 0.747246
Epoch 2, Train Loss 0.713649, Valid_loss 0.713170
Epoch 3, Train Loss 0.687857, Valid_loss 0.683244
Epoch 4, Train Loss 0.664072, Valid_loss 0.663473
Epoch 5, Train Loss 0.654878, Valid_loss 0.650311
Epoch 6, Train Loss 0.646193, Valid_loss 0.641451
Epoch 7, Train Loss 0.643649, Valid_loss 0.635529
Epoch 8, Train Loss 0.637197, Valid_loss 0.631815
Epoch 9, Train Loss 0.635865, Valid_loss 0.628978
Epoch 10, Train Loss 0.631047, Valid_loss 0.626458
Epoch 11, Train Loss 0.618947, Valid_loss 0.619993
Epoch 12, Train Loss 0.607732, Valid_loss 0.613351
Epoch 13, Train Loss 0.600765, Valid_loss 0.608463
Epoch 14, Train Loss 0.591761, Valid_loss 0.598340
Epoch 15, Train Loss 0.588574, Valid_loss 0.589568
Epoch 16, Train Loss 0.583325, Valid_loss 0.582433
Epoch 17, Train Loss 0.573700, Valid_loss 0.579801
Epoch 18, Train Loss 0.569094, Valid_loss 0.575513
Epoch 19, Train Loss 0.566533, Valid_loss 0.566089
Epoch 20, Train Loss 0.559418, Valid_loss 0.559850
Epoch 21, Train Loss 0.554942, Valid_loss 0.556469
Epoch 22, Train Loss 0.551157, Valid_loss 0.548852
Epoch 23, Train Loss 0.547085, Valid_loss 0.542194
Epoch 24, Train Loss 0.542627, Valid_loss 0.532782
Epoch 25, Train Loss 0.540074, Valid_loss 0.528301
Epoch 26, Train Loss 0.535079, Valid_loss 0.525240
Epoch 27, Train Loss 0.534310, Valid_loss 0.520469
Epoch 28, Train Loss 0.529695, Valid_loss 0.517413
Epoch 29, Train Loss 0.529583, Valid_loss 0.512137
Epoch 30, Train Loss 0.526427, Valid_loss 0.509515
Epoch 31, Train Loss 0.520376, Valid_loss 0.505847
Epoch 32, Train Loss 0.521402, Valid_loss 0.503996
Epoch 33, Train Loss 0.518681, Valid_loss 0.500019
Epoch 34, Train Loss 0.514583, Valid_loss 0.493379
Epoch 35, Train Loss 0.511187, Valid_loss 0.496354
Epoch 36, Train Loss 0.510192, Valid_loss 0.494568
Epoch 37, Train Loss 0.511627, Valid_loss 0.491895
Epoch 38, Train Loss 0.506176, Valid_loss 0.486163
Epoch 39, Train Loss 0.508843, Valid_loss 0.486084
Epoch 40, Train Loss 0.503423, Valid_loss 0.491451
Epoch 41, Train Loss 0.502924, Valid_loss 0.478768
Epoch 42, Train Loss 0.499765, Valid_loss 0.485605
Epoch 43, Train Loss 0.496047, Valid_loss 0.481345
Epoch 44, Train Loss 0.499582, Valid_loss 0.488328
Epoch 45, Train Loss 0.494009, Valid_loss 0.485809
Epoch 46, Train Loss 0.497123, Valid_loss 0.476221
Epoch 47, Train Loss 0.495660, Valid_loss 0.476028
Epoch 48, Train Loss 0.491613, Valid_loss 0.479918
Epoch 49, Train Loss 0.491171, Valid_loss 0.482033
Epoch 50, Train Loss 0.490326, Valid_loss 0.471168
Epoch 51, Train Loss 0.484216, Valid_loss 0.472397
Epoch 52, Train Loss 0.485369, Valid_loss 0.467559
Epoch 53, Train Loss 0.485449, Valid_loss 0.473580
Epoch 54, Train Loss 0.482081, Valid_loss 0.472239
Epoch 55, Train Loss 0.487657, Valid_loss 0.464891
Epoch 56, Train Loss 0.482970, Valid_loss 0.465535
Epoch 57, Train Loss 0.483719, Valid_loss 0.465712
Control_Participant7 -- true: normal -- pred: normal
Control_Participant5 -- true: normal -- pred: normal
Control_Participant3 -- true: normal -- pred: normal
COVID19_Participant25 -- true: COVID-19 -- pred: COVID-19
COVID19_Participant11 -- true: COVID-19 -- pred: normal
Control_Participant7 -- true: normal -- pred: COVID-19
Control_Participant12 -- true: normal -- pred: COVID-19
Control_Participant3 -- true: normal -- pred: normal
true :  [0, 0, 0, 1, 1, 0, 0, 0]
pred :  [0, 0, 0, 1, 0, 1, 1, 0]
Confusion Matrix: [4 2 1 1]
Best performance: Epoch 55, Loss 0.487657, Test ACC 0.625000, Test AUC 0.666667, Test Recall 0.500000, Test Precision 0.333333
✅ Total valid splits used: 5

📌 Repeat 0: 평균 AUC = 0.8867, 표준편차 = 0.1258
🔁 Repeat 1, Fold 0
🔍 Split #1
  → train_p_index 환자 수: 30
  → test_p_index 환자 수: 9
  → train 환자 ID: ['COVID19_Participant12', 'COVID19_Participant13', 'COVID19_Participant14', 'COVID19_Participant15', 'COVID19_Participant17', 'COVID19_Participant18', 'COVID19_Participant19', 'COVID19_Participant20', 'COVID19_Participant22', 'COVID19_Participant26', 'COVID19_Participant28', 'COVID19_Participant29', 'COVID19_Participant3', 'COVID19_Participant30', 'COVID19_Participant31', 'COVID19_Participant32', 'COVID19_Participant39', 'COVID19_Participant4', 'COVID19_Participant40', 'COVID19_Participant8', 'Control_Participant1', 'Control_Participant10', 'Control_Participant11', 'Control_Participant14', 'Control_Participant15', 'Control_Participant3', 'Control_Participant4', 'Control_Participant6', 'Control_Participant7', 'Control_Participant8']
  → test  환자 ID: ['COVID19_Participant31', 'Control_Participant3', 'Control_Participant1', 'Control_Participant7', 'COVID19_Participant26', 'COVID19_Participant26', 'Control_Participant7', 'COVID19_Participant13', 'COVID19_Participant5']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant12, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant18, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant3, Label: 1
    ID: COVID19_Participant30, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant10, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant14, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant4, Label: 0
    ID: Control_Participant6, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant8, Label: 0
  → test 환자 ID 및 라벨:
    ID: COVID19_Participant31, Label: 1
    ID: Control_Participant3, Label: 1
    ID: Control_Participant1, Label: 1
    ID: Control_Participant7, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: Control_Participant7, Label: 1
    ID: COVID19_Participant13, Label: 0
    ID: COVID19_Participant5, Label: 0
train_p_index_ 20
valid_p_index 10
test_p_index 9
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Keratinocytes', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Neurons', 'iPS_cells', 'Embryonic_stem_cells', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
data augment 실행 함
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:10,  9.04it/s]  2%|▏         | 2/100 [00:00<00:11,  8.32it/s]  3%|▎         | 3/100 [00:00<00:11,  8.55it/s]  4%|▍         | 4/100 [00:00<00:11,  8.61it/s]  5%|▌         | 5/100 [00:00<00:11,  8.55it/s]  6%|▌         | 6/100 [00:00<00:10,  8.73it/s]  7%|▋         | 7/100 [00:00<00:10,  8.89it/s]  8%|▊         | 8/100 [00:00<00:10,  9.02it/s]  9%|▉         | 9/100 [00:01<00:10,  8.97it/s] 10%|█         | 10/100 [00:01<00:09,  9.04it/s] 11%|█         | 11/100 [00:01<00:10,  8.62it/s] 12%|█▏        | 12/100 [00:01<00:10,  8.62it/s] 13%|█▎        | 13/100 [00:01<00:09,  8.82it/s] 14%|█▍        | 14/100 [00:01<00:10,  8.58it/s] 15%|█▌        | 15/100 [00:01<00:10,  7.93it/s] 16%|█▌        | 16/100 [00:01<00:11,  7.54it/s] 17%|█▋        | 17/100 [00:02<00:10,  7.86it/s] 18%|█▊        | 18/100 [00:02<00:10,  8.11it/s] 19%|█▉        | 19/100 [00:02<00:09,  8.51it/s] 20%|██        | 20/100 [00:02<00:09,  8.74it/s] 21%|██        | 21/100 [00:02<00:09,  8.57it/s] 22%|██▏       | 22/100 [00:02<00:09,  8.54it/s] 23%|██▎       | 23/100 [00:02<00:09,  8.28it/s] 24%|██▍       | 24/100 [00:02<00:09,  8.36it/s] 25%|██▌       | 25/100 [00:02<00:08,  8.44it/s] 26%|██▌       | 26/100 [00:03<00:08,  8.47it/s] 27%|██▋       | 27/100 [00:03<00:08,  8.69it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.41it/s] 29%|██▉       | 29/100 [00:03<00:08,  8.50it/s] 30%|███       | 30/100 [00:03<00:08,  8.43it/s] 31%|███       | 31/100 [00:03<00:08,  8.45it/s] 32%|███▏      | 32/100 [00:03<00:08,  8.38it/s] 33%|███▎      | 33/100 [00:03<00:07,  8.38it/s] 34%|███▍      | 34/100 [00:04<00:07,  8.34it/s] 35%|███▌      | 35/100 [00:04<00:07,  8.26it/s] 36%|███▌      | 36/100 [00:04<00:07,  8.43it/s] 37%|███▋      | 37/100 [00:04<00:07,  8.50it/s] 38%|███▊      | 38/100 [00:04<00:07,  8.57it/s] 39%|███▉      | 39/100 [00:04<00:07,  8.46it/s] 40%|████      | 40/100 [00:04<00:07,  8.32it/s] 41%|████      | 41/100 [00:04<00:07,  8.29it/s] 42%|████▏     | 42/100 [00:04<00:06,  8.40it/s] 43%|████▎     | 43/100 [00:05<00:06,  8.64it/s] 44%|████▍     | 44/100 [00:05<00:06,  8.80it/s] 45%|████▌     | 45/100 [00:05<00:06,  8.70it/s] 46%|████▌     | 46/100 [00:05<00:06,  8.41it/s] 47%|████▋     | 47/100 [00:05<00:06,  7.96it/s] 48%|████▊     | 48/100 [00:05<00:06,  7.83it/s] 49%|████▉     | 49/100 [00:05<00:06,  7.89it/s] 50%|█████     | 50/100 [00:05<00:06,  8.21it/s] 51%|█████     | 51/100 [00:06<00:05,  8.32it/s] 52%|█████▏    | 52/100 [00:06<00:05,  8.44it/s] 53%|█████▎    | 53/100 [00:06<00:05,  8.33it/s] 54%|█████▍    | 54/100 [00:06<00:05,  7.75it/s] 55%|█████▌    | 55/100 [00:06<00:05,  7.75it/s] 56%|█████▌    | 56/100 [00:06<00:05,  7.96it/s] 57%|█████▋    | 57/100 [00:06<00:05,  8.03it/s] 58%|█████▊    | 58/100 [00:06<00:05,  8.32it/s] 59%|█████▉    | 59/100 [00:07<00:04,  8.51it/s] 60%|██████    | 60/100 [00:07<00:05,  7.98it/s] 61%|██████    | 61/100 [00:07<00:04,  8.04it/s] 62%|██████▏   | 62/100 [00:07<00:05,  6.82it/s] 63%|██████▎   | 63/100 [00:07<00:05,  7.20it/s] 64%|██████▍   | 64/100 [00:07<00:04,  7.41it/s] 65%|██████▌   | 65/100 [00:07<00:04,  7.69it/s] 66%|██████▌   | 66/100 [00:07<00:04,  7.73it/s] 67%|██████▋   | 67/100 [00:08<00:04,  7.78it/s] 68%|██████▊   | 68/100 [00:08<00:04,  7.76it/s] 69%|██████▉   | 69/100 [00:08<00:04,  7.60it/s] 70%|███████   | 70/100 [00:08<00:04,  7.31it/s] 71%|███████   | 71/100 [00:08<00:03,  7.67it/s] 72%|███████▏  | 72/100 [00:08<00:03,  7.82it/s] 73%|███████▎  | 73/100 [00:08<00:03,  7.18it/s] 74%|███████▍  | 74/100 [00:09<00:03,  7.30it/s] 75%|███████▌  | 75/100 [00:09<00:03,  7.51it/s] 76%|███████▌  | 76/100 [00:09<00:03,  7.76it/s] 77%|███████▋  | 77/100 [00:09<00:02,  7.70it/s] 78%|███████▊  | 78/100 [00:09<00:02,  7.67it/s] 79%|███████▉  | 79/100 [00:09<00:02,  7.73it/s] 80%|████████  | 80/100 [00:09<00:02,  8.21it/s] 81%|████████  | 81/100 [00:09<00:02,  8.09it/s] 82%|████████▏ | 82/100 [00:10<00:02,  7.26it/s] 83%|████████▎ | 83/100 [00:10<00:02,  7.01it/s] 84%|████████▍ | 84/100 [00:10<00:02,  7.21it/s] 85%|████████▌ | 85/100 [00:10<00:02,  7.41it/s] 86%|████████▌ | 86/100 [00:10<00:01,  7.28it/s] 87%|████████▋ | 87/100 [00:10<00:01,  7.49it/s] 88%|████████▊ | 88/100 [00:10<00:01,  7.62it/s] 89%|████████▉ | 89/100 [00:11<00:01,  7.72it/s] 90%|█████████ | 90/100 [00:11<00:01,  7.80it/s] 91%|█████████ | 91/100 [00:11<00:01,  8.01it/s] 92%|█████████▏| 92/100 [00:11<00:01,  7.76it/s] 93%|█████████▎| 93/100 [00:11<00:00,  7.50it/s] 94%|█████████▍| 94/100 [00:11<00:00,  7.44it/s] 95%|█████████▌| 95/100 [00:11<00:00,  7.56it/s] 96%|█████████▌| 96/100 [00:11<00:00,  7.68it/s] 97%|█████████▋| 97/100 [00:12<00:00,  7.74it/s] 98%|█████████▊| 98/100 [00:12<00:00,  7.46it/s] 99%|█████████▉| 99/100 [00:12<00:00,  7.38it/s]100%|██████████| 100/100 [00:12<00:00,  7.48it/s]100%|██████████| 100/100 [00:12<00:00,  8.01it/s]
eval_p_index len:  19
individual_train 120
individual_eval 19
train data의 x, y, id 길이: 120 120 120
valid data의 x, y, id 길이: 10 10 10
test data의 x, y, id 길이: 9 9 9
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.677978, Valid_loss 0.666557
Epoch 2, Train Loss 0.665109, Valid_loss 0.645865
Epoch 3, Train Loss 0.661243, Valid_loss 0.631421
Epoch 4, Train Loss 0.644156, Valid_loss 0.622029
Epoch 5, Train Loss 0.636182, Valid_loss 0.614513
Epoch 6, Train Loss 0.632404, Valid_loss 0.608184
Epoch 7, Train Loss 0.633654, Valid_loss 0.602984
Epoch 8, Train Loss 0.625063, Valid_loss 0.599267
Epoch 9, Train Loss 0.626426, Valid_loss 0.595729
Epoch 10, Train Loss 0.624713, Valid_loss 0.592026
Epoch 11, Train Loss 0.622936, Valid_loss 0.587925
Epoch 12, Train Loss 0.622404, Valid_loss 0.583632
Epoch 13, Train Loss 0.611274, Valid_loss 0.578451
Epoch 14, Train Loss 0.614000, Valid_loss 0.571657
Epoch 15, Train Loss 0.612312, Valid_loss 0.563367
Epoch 16, Train Loss 0.615897, Valid_loss 0.553107
Epoch 17, Train Loss 0.604416, Valid_loss 0.541382
Epoch 18, Train Loss 0.598765, Valid_loss 0.525558
Epoch 19, Train Loss 0.584686, Valid_loss 0.509363
Epoch 20, Train Loss 0.576099, Valid_loss 0.487702
Epoch 21, Train Loss 0.556576, Valid_loss 0.457848
Epoch 22, Train Loss 0.549146, Valid_loss 0.439945
Epoch 23, Train Loss 0.526381, Valid_loss 0.424525
Epoch 24, Train Loss 0.500789, Valid_loss 0.387446
Epoch 25, Train Loss 0.493946, Valid_loss 0.405538
Epoch 26, Train Loss 0.485509, Valid_loss 0.399086
Epoch 27, Train Loss 0.469015, Valid_loss 0.382080
Epoch 28, Train Loss 0.468138, Valid_loss 0.409620
Epoch 29, Train Loss 0.464128, Valid_loss 0.386894
Epoch 30, Train Loss 0.456622, Valid_loss 0.373936
Epoch 31, Train Loss 0.461096, Valid_loss 0.394898
Epoch 32, Train Loss 0.457700, Valid_loss 0.378755
Epoch 33, Train Loss 0.449600, Valid_loss 0.389929
Epoch 34, Train Loss 0.451292, Valid_loss 0.382529
Epoch 35, Train Loss 0.446076, Valid_loss 0.381966
Epoch 36, Train Loss 0.455358, Valid_loss 0.385731
Epoch 37, Train Loss 0.446057, Valid_loss 0.378439
Epoch 38, Train Loss 0.440861, Valid_loss 0.373399
Epoch 39, Train Loss 0.444449, Valid_loss 0.380974
Epoch 40, Train Loss 0.438204, Valid_loss 0.368580
Epoch 41, Train Loss 0.437751, Valid_loss 0.373058
Epoch 42, Train Loss 0.444230, Valid_loss 0.367886
Epoch 43, Train Loss 0.446613, Valid_loss 0.373423
Epoch 44, Train Loss 0.439877, Valid_loss 0.364297
Epoch 45, Train Loss 0.430136, Valid_loss 0.360326
Epoch 46, Train Loss 0.429405, Valid_loss 0.370135
Epoch 47, Train Loss 0.435991, Valid_loss 0.361654
Epoch 48, Train Loss 0.430640, Valid_loss 0.365705
Epoch 49, Train Loss 0.434539, Valid_loss 0.361689
Epoch 50, Train Loss 0.432841, Valid_loss 0.362348
Epoch 51, Train Loss 0.431064, Valid_loss 0.360253
Epoch 52, Train Loss 0.440899, Valid_loss 0.361110
Epoch 53, Train Loss 0.432853, Valid_loss 0.363618
COVID19_Participant31 -- true: COVID-19 -- pred: COVID-19
Control_Participant3 -- true: normal -- pred: normal
Control_Participant1 -- true: normal -- pred: normal
Control_Participant7 -- true: normal -- pred: normal
COVID19_Participant26 -- true: COVID-19 -- pred: COVID-19
COVID19_Participant26 -- true: COVID-19 -- pred: normal
Control_Participant7 -- true: normal -- pred: COVID-19
COVID19_Participant13 -- true: COVID-19 -- pred: COVID-19
COVID19_Participant5 -- true: COVID-19 -- pred: COVID-19
true :  [1, 0, 0, 0, 1, 1, 0, 1, 1]
pred :  [1, 0, 0, 0, 1, 0, 1, 1, 1]
Confusion Matrix: [3 1 1 4]
Best performance: Epoch 51, Loss 0.431064, Test ACC 0.777778, Test AUC 0.850000, Test Recall 0.800000, Test Precision 0.800000
✅ Total valid splits used: 1
🔁 Repeat 1, Fold 1
🔍 Split #2
  → train_p_index 환자 수: 31
  → test_p_index 환자 수: 8
  → train 환자 ID: ['COVID19_Participant11', 'COVID19_Participant12', 'COVID19_Participant13', 'COVID19_Participant14', 'COVID19_Participant15', 'COVID19_Participant18', 'COVID19_Participant2', 'COVID19_Participant20', 'COVID19_Participant23', 'COVID19_Participant25', 'COVID19_Participant28', 'COVID19_Participant3', 'COVID19_Participant30', 'COVID19_Participant31', 'COVID19_Participant32', 'COVID19_Participant36', 'COVID19_Participant37', 'COVID19_Participant39', 'COVID19_Participant4', 'COVID19_Participant40', 'COVID19_Participant7', 'COVID19_Participant8', 'Control_Participant1', 'Control_Participant10', 'Control_Participant11', 'Control_Participant14', 'Control_Participant15', 'Control_Participant4', 'Control_Participant5', 'Control_Participant8', 'Control_Participant9']
  → test  환자 ID: ['Control_Participant1', 'Control_Participant5', 'COVID19_Participant8', 'COVID19_Participant31', 'Control_Participant10', 'Control_Participant4', 'Control_Participant10', 'COVID19_Participant13']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant12, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant18, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant3, Label: 1
    ID: COVID19_Participant30, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant36, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant10, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant14, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant4, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant8, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: Control_Participant1, Label: 1
    ID: Control_Participant5, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: Control_Participant10, Label: 1
    ID: Control_Participant4, Label: 0
    ID: Control_Participant10, Label: 0
    ID: COVID19_Participant13, Label: 0
train_p_index_ 20
valid_p_index 11
test_p_index 8
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Epithelial_cells', 'Platelets', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Keratinocytes', 'Macrophage', 'Epithelial_cells', 'B_cell', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
data augment 실행 함
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:10,  9.46it/s]  2%|▏         | 2/100 [00:00<00:10,  9.29it/s]  3%|▎         | 3/100 [00:00<00:10,  9.50it/s]  4%|▍         | 4/100 [00:00<00:10,  9.58it/s]  5%|▌         | 5/100 [00:00<00:10,  9.22it/s]  6%|▌         | 6/100 [00:00<00:10,  9.20it/s]  8%|▊         | 8/100 [00:00<00:09,  9.36it/s]  9%|▉         | 9/100 [00:00<00:09,  9.48it/s] 10%|█         | 10/100 [00:01<00:09,  9.18it/s] 11%|█         | 11/100 [00:01<00:09,  9.34it/s] 12%|█▏        | 12/100 [00:01<00:09,  8.99it/s] 14%|█▍        | 14/100 [00:01<00:08,  9.66it/s] 15%|█▌        | 15/100 [00:01<00:08,  9.59it/s] 16%|█▌        | 16/100 [00:01<00:08,  9.48it/s] 18%|█▊        | 18/100 [00:01<00:08,  9.79it/s] 20%|██        | 20/100 [00:02<00:08,  9.72it/s] 22%|██▏       | 22/100 [00:02<00:08,  9.63it/s] 23%|██▎       | 23/100 [00:02<00:07,  9.64it/s] 24%|██▍       | 24/100 [00:02<00:07,  9.58it/s] 25%|██▌       | 25/100 [00:02<00:08,  8.61it/s] 27%|██▋       | 27/100 [00:02<00:07,  9.14it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.82it/s] 30%|███       | 30/100 [00:03<00:07,  9.07it/s] 31%|███       | 31/100 [00:03<00:07,  9.25it/s] 32%|███▏      | 32/100 [00:03<00:07,  8.67it/s] 33%|███▎      | 33/100 [00:03<00:07,  8.92it/s] 34%|███▍      | 34/100 [00:03<00:07,  9.12it/s] 36%|███▌      | 36/100 [00:03<00:06,  9.42it/s] 37%|███▋      | 37/100 [00:03<00:06,  9.19it/s] 38%|███▊      | 38/100 [00:04<00:06,  9.13it/s] 39%|███▉      | 39/100 [00:04<00:06,  9.16it/s] 40%|████      | 40/100 [00:04<00:06,  9.30it/s] 42%|████▏     | 42/100 [00:04<00:05,  9.77it/s] 43%|████▎     | 43/100 [00:04<00:06,  9.42it/s] 44%|████▍     | 44/100 [00:04<00:06,  9.32it/s] 46%|████▌     | 46/100 [00:04<00:05,  9.74it/s] 47%|████▋     | 47/100 [00:05<00:05,  9.58it/s] 48%|████▊     | 48/100 [00:05<00:05,  9.51it/s] 49%|████▉     | 49/100 [00:05<00:05,  9.46it/s] 50%|█████     | 50/100 [00:05<00:05,  9.48it/s] 51%|█████     | 51/100 [00:05<00:05,  9.39it/s] 53%|█████▎    | 53/100 [00:05<00:04,  9.45it/s] 54%|█████▍    | 54/100 [00:05<00:04,  9.42it/s] 55%|█████▌    | 55/100 [00:05<00:04,  9.40it/s] 56%|█████▌    | 56/100 [00:05<00:04,  9.31it/s] 57%|█████▋    | 57/100 [00:06<00:04,  8.63it/s] 58%|█████▊    | 58/100 [00:06<00:04,  8.88it/s] 59%|█████▉    | 59/100 [00:06<00:04,  9.04it/s] 60%|██████    | 60/100 [00:06<00:04,  9.23it/s] 61%|██████    | 61/100 [00:06<00:04,  9.30it/s] 62%|██████▏   | 62/100 [00:06<00:04,  9.38it/s] 63%|██████▎   | 63/100 [00:06<00:04,  9.00it/s] 64%|██████▍   | 64/100 [00:06<00:04,  8.87it/s] 65%|██████▌   | 65/100 [00:07<00:04,  8.09it/s] 66%|██████▌   | 66/100 [00:07<00:04,  7.66it/s] 67%|██████▋   | 67/100 [00:07<00:04,  8.07it/s] 68%|██████▊   | 68/100 [00:07<00:03,  8.25it/s] 69%|██████▉   | 69/100 [00:07<00:03,  8.53it/s] 70%|███████   | 70/100 [00:07<00:03,  8.51it/s] 71%|███████   | 71/100 [00:07<00:03,  8.68it/s] 72%|███████▏  | 72/100 [00:07<00:03,  8.68it/s] 73%|███████▎  | 73/100 [00:07<00:03,  8.78it/s] 74%|███████▍  | 74/100 [00:08<00:03,  8.55it/s] 75%|███████▌  | 75/100 [00:08<00:02,  8.57it/s] 76%|███████▌  | 76/100 [00:08<00:02,  8.69it/s] 77%|███████▋  | 77/100 [00:08<00:02,  8.66it/s] 78%|███████▊  | 78/100 [00:08<00:02,  8.62it/s] 79%|███████▉  | 79/100 [00:08<00:02,  8.24it/s] 81%|████████  | 81/100 [00:08<00:02,  8.84it/s] 82%|████████▏ | 82/100 [00:09<00:02,  8.95it/s] 83%|████████▎ | 83/100 [00:09<00:01,  9.17it/s] 84%|████████▍ | 84/100 [00:09<00:01,  8.14it/s] 85%|████████▌ | 85/100 [00:09<00:01,  8.16it/s] 86%|████████▌ | 86/100 [00:09<00:01,  8.25it/s] 87%|████████▋ | 87/100 [00:09<00:01,  8.37it/s] 88%|████████▊ | 88/100 [00:09<00:01,  8.48it/s] 89%|████████▉ | 89/100 [00:09<00:01,  8.38it/s] 90%|█████████ | 90/100 [00:09<00:01,  8.49it/s] 91%|█████████ | 91/100 [00:10<00:01,  8.59it/s] 92%|█████████▏| 92/100 [00:10<00:00,  8.58it/s] 93%|█████████▎| 93/100 [00:10<00:00,  8.58it/s] 94%|█████████▍| 94/100 [00:10<00:00,  8.56it/s] 95%|█████████▌| 95/100 [00:10<00:00,  8.62it/s] 96%|█████████▌| 96/100 [00:10<00:00,  8.65it/s] 97%|█████████▋| 97/100 [00:10<00:00,  8.70it/s] 98%|█████████▊| 98/100 [00:10<00:00,  8.72it/s] 99%|█████████▉| 99/100 [00:11<00:00,  8.72it/s]100%|██████████| 100/100 [00:11<00:00,  8.75it/s]100%|██████████| 100/100 [00:11<00:00,  8.99it/s]
eval_p_index len:  19
individual_train 120
individual_eval 19
train data의 x, y, id 길이: 120 120 120
valid data의 x, y, id 길이: 11 11 11
test data의 x, y, id 길이: 8 8 8
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.839963, Valid_loss 0.860147
Epoch 2, Train Loss 0.822784, Valid_loss 0.852479
Epoch 3, Train Loss 0.829722, Valid_loss 0.842073
Epoch 4, Train Loss 0.815693, Valid_loss 0.832368
Epoch 5, Train Loss 0.812198, Valid_loss 0.830481
Epoch 6, Train Loss 0.812844, Valid_loss 0.825232
Epoch 7, Train Loss 0.808073, Valid_loss 0.820198
Epoch 8, Train Loss 0.795069, Valid_loss 0.820016
Epoch 9, Train Loss 0.799670, Valid_loss 0.817350
Epoch 10, Train Loss 0.799598, Valid_loss 0.813298
Epoch 11, Train Loss 0.792515, Valid_loss 0.812184
Epoch 12, Train Loss 0.792423, Valid_loss 0.808870
Epoch 13, Train Loss 0.795272, Valid_loss 0.805915
Epoch 14, Train Loss 0.791413, Valid_loss 0.802742
Epoch 15, Train Loss 0.789395, Valid_loss 0.800500
Epoch 16, Train Loss 0.781562, Valid_loss 0.797426
Epoch 17, Train Loss 0.790110, Valid_loss 0.793770
Epoch 18, Train Loss 0.773532, Valid_loss 0.791092
Epoch 19, Train Loss 0.769744, Valid_loss 0.784760
Epoch 20, Train Loss 0.760124, Valid_loss 0.775007
Epoch 21, Train Loss 0.753165, Valid_loss 0.734527
Epoch 22, Train Loss 0.698838, Valid_loss 0.666783
Epoch 23, Train Loss 0.678072, Valid_loss 0.642374
Epoch 24, Train Loss 0.672359, Valid_loss 0.630176
Epoch 25, Train Loss 0.655675, Valid_loss 0.616939
Epoch 26, Train Loss 0.650277, Valid_loss 0.611499
Epoch 27, Train Loss 0.627698, Valid_loss 0.607779
Epoch 28, Train Loss 0.633568, Valid_loss 0.584796
Epoch 29, Train Loss 0.613397, Valid_loss 0.570053
Epoch 30, Train Loss 0.607342, Valid_loss 0.558966
Epoch 31, Train Loss 0.603490, Valid_loss 0.553234
Epoch 32, Train Loss 0.592266, Valid_loss 0.544046
Epoch 33, Train Loss 0.599825, Valid_loss 0.541919
Epoch 34, Train Loss 0.580822, Valid_loss 0.536323
Epoch 35, Train Loss 0.574874, Valid_loss 0.533328
Epoch 36, Train Loss 0.571416, Valid_loss 0.530373
Epoch 37, Train Loss 0.575015, Valid_loss 0.526379
Epoch 38, Train Loss 0.568624, Valid_loss 0.523395
Epoch 39, Train Loss 0.560379, Valid_loss 0.519616
Epoch 40, Train Loss 0.560305, Valid_loss 0.516949
Epoch 41, Train Loss 0.558438, Valid_loss 0.514739
Epoch 42, Train Loss 0.557667, Valid_loss 0.512287
Epoch 43, Train Loss 0.558279, Valid_loss 0.510650
Epoch 44, Train Loss 0.559004, Valid_loss 0.508526
Epoch 45, Train Loss 0.548745, Valid_loss 0.506707
Epoch 46, Train Loss 0.546347, Valid_loss 0.505415
Epoch 47, Train Loss 0.551573, Valid_loss 0.503917
Epoch 48, Train Loss 0.545974, Valid_loss 0.501110
Epoch 49, Train Loss 0.543160, Valid_loss 0.501023
Epoch 50, Train Loss 0.541472, Valid_loss 0.499141
Epoch 51, Train Loss 0.544336, Valid_loss 0.498473
Epoch 52, Train Loss 0.539968, Valid_loss 0.497757
Epoch 53, Train Loss 0.545370, Valid_loss 0.497580
Epoch 54, Train Loss 0.542068, Valid_loss 0.496475
Epoch 55, Train Loss 0.536141, Valid_loss 0.496056
Epoch 56, Train Loss 0.535054, Valid_loss 0.495824
Epoch 57, Train Loss 0.538001, Valid_loss 0.495164
Epoch 58, Train Loss 0.533050, Valid_loss 0.494565
Epoch 59, Train Loss 0.541824, Valid_loss 0.493885
Epoch 60, Train Loss 0.535122, Valid_loss 0.493684
Epoch 61, Train Loss 0.529699, Valid_loss 0.493229
Epoch 62, Train Loss 0.538574, Valid_loss 0.492334
Epoch 63, Train Loss 0.536845, Valid_loss 0.491569
Epoch 64, Train Loss 0.528041, Valid_loss 0.491054
Epoch 65, Train Loss 0.531509, Valid_loss 0.490532
Epoch 66, Train Loss 0.526784, Valid_loss 0.489657
Epoch 67, Train Loss 0.525280, Valid_loss 0.488867
Epoch 68, Train Loss 0.527774, Valid_loss 0.489020
Epoch 69, Train Loss 0.527145, Valid_loss 0.487931
Epoch 70, Train Loss 0.531678, Valid_loss 0.487126
Epoch 71, Train Loss 0.530756, Valid_loss 0.487628
Epoch 72, Train Loss 0.529077, Valid_loss 0.487088
Epoch 73, Train Loss 0.521009, Valid_loss 0.486233
Epoch 74, Train Loss 0.521905, Valid_loss 0.485396
Epoch 75, Train Loss 0.524004, Valid_loss 0.484922
Epoch 76, Train Loss 0.522847, Valid_loss 0.484865
Epoch 77, Train Loss 0.518428, Valid_loss 0.483737
Epoch 78, Train Loss 0.517266, Valid_loss 0.484124
Epoch 79, Train Loss 0.522699, Valid_loss 0.482340
Epoch 80, Train Loss 0.519891, Valid_loss 0.482808
Epoch 81, Train Loss 0.519874, Valid_loss 0.481719
Epoch 82, Train Loss 0.516247, Valid_loss 0.481087
Epoch 83, Train Loss 0.524119, Valid_loss 0.481476
Epoch 84, Train Loss 0.514900, Valid_loss 0.480814
Epoch 85, Train Loss 0.514511, Valid_loss 0.479818
Epoch 86, Train Loss 0.518395, Valid_loss 0.480647
Epoch 87, Train Loss 0.512404, Valid_loss 0.479707
Epoch 88, Train Loss 0.521885, Valid_loss 0.479430
Epoch 89, Train Loss 0.515396, Valid_loss 0.479632
Epoch 90, Train Loss 0.507062, Valid_loss 0.477944
Epoch 91, Train Loss 0.517618, Valid_loss 0.479190
Epoch 92, Train Loss 0.511076, Valid_loss 0.477280
Epoch 93, Train Loss 0.512096, Valid_loss 0.476921
Epoch 94, Train Loss 0.507539, Valid_loss 0.477433
Epoch 95, Train Loss 0.510987, Valid_loss 0.476715
Epoch 96, Train Loss 0.513130, Valid_loss 0.477095
Epoch 97, Train Loss 0.512358, Valid_loss 0.476066
Epoch 98, Train Loss 0.512827, Valid_loss 0.475212
Epoch 99, Train Loss 0.506132, Valid_loss 0.475275
Epoch 100, Train Loss 0.508569, Valid_loss 0.474388
Control_Participant1 -- true: normal -- pred: normal
Control_Participant5 -- true: normal -- pred: normal
COVID19_Participant8 -- true: COVID-19 -- pred: COVID-19
COVID19_Participant31 -- true: COVID-19 -- pred: normal
Control_Participant10 -- true: normal -- pred: normal
Control_Participant4 -- true: normal -- pred: normal
Control_Participant10 -- true: normal -- pred: normal
COVID19_Participant13 -- true: COVID-19 -- pred: COVID-19
true :  [0, 0, 1, 1, 0, 0, 0, 1]
pred :  [0, 0, 1, 0, 0, 0, 0, 1]
Confusion Matrix: [5 0 1 2]
Best performance: Epoch 100, Loss 0.508569, Test ACC 0.875000, Test AUC 0.866667, Test Recall 0.666667, Test Precision 1.000000
✅ Total valid splits used: 2
🔁 Repeat 1, Fold 2
🔍 Split #3
  → train_p_index 환자 수: 32
  → test_p_index 환자 수: 7
  → train 환자 ID: ['COVID19_Participant11', 'COVID19_Participant13', 'COVID19_Participant15', 'COVID19_Participant17', 'COVID19_Participant18', 'COVID19_Participant19', 'COVID19_Participant2', 'COVID19_Participant22', 'COVID19_Participant23', 'COVID19_Participant25', 'COVID19_Participant26', 'COVID19_Participant28', 'COVID19_Participant29', 'COVID19_Participant31', 'COVID19_Participant32', 'COVID19_Participant36', 'COVID19_Participant37', 'COVID19_Participant39', 'COVID19_Participant4', 'COVID19_Participant7', 'COVID19_Participant8', 'Control_Participant1', 'Control_Participant10', 'Control_Participant11', 'Control_Participant14', 'Control_Participant15', 'Control_Participant3', 'Control_Participant5', 'Control_Participant6', 'Control_Participant7', 'Control_Participant8', 'Control_Participant9']
  → test  환자 ID: ['COVID19_Participant31', 'Control_Participant7', 'COVID19_Participant31', 'COVID19_Participant13', 'Control_Participant5', 'COVID19_Participant13', 'Control_Participant7']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant18, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant36, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant10, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant14, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant6, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant8, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: COVID19_Participant31, Label: 1
    ID: Control_Participant7, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: Control_Participant5, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: Control_Participant7, Label: 0
train_p_index_ 21
valid_p_index 11
test_p_index 7
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Keratinocytes', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Neurons', 'iPS_cells', 'Embryonic_stem_cells', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
data augment 실행 함
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:09,  9.99it/s]  2%|▏         | 2/100 [00:00<00:10,  9.58it/s]  3%|▎         | 3/100 [00:00<00:10,  9.47it/s]  4%|▍         | 4/100 [00:00<00:10,  9.25it/s]  5%|▌         | 5/100 [00:00<00:10,  9.35it/s]  6%|▌         | 6/100 [00:00<00:10,  9.04it/s]  8%|▊         | 8/100 [00:00<00:09,  9.49it/s]  9%|▉         | 9/100 [00:00<00:09,  9.38it/s] 10%|█         | 10/100 [00:01<00:09,  9.28it/s] 11%|█         | 11/100 [00:01<00:11,  7.91it/s] 12%|█▏        | 12/100 [00:01<00:10,  8.09it/s] 13%|█▎        | 13/100 [00:01<00:10,  8.25it/s] 14%|█▍        | 14/100 [00:01<00:10,  8.25it/s] 15%|█▌        | 15/100 [00:01<00:10,  8.26it/s] 16%|█▌        | 16/100 [00:01<00:10,  8.30it/s] 17%|█▋        | 17/100 [00:01<00:09,  8.58it/s] 18%|█▊        | 18/100 [00:02<00:09,  8.70it/s] 19%|█▉        | 19/100 [00:02<00:09,  8.61it/s] 20%|██        | 20/100 [00:02<00:09,  8.62it/s] 21%|██        | 21/100 [00:02<00:11,  7.14it/s] 22%|██▏       | 22/100 [00:02<00:10,  7.61it/s] 23%|██▎       | 23/100 [00:02<00:09,  7.99it/s] 24%|██▍       | 24/100 [00:02<00:09,  8.13it/s] 25%|██▌       | 25/100 [00:02<00:09,  8.22it/s] 26%|██▌       | 26/100 [00:03<00:09,  8.22it/s] 27%|██▋       | 27/100 [00:03<00:08,  8.30it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.51it/s] 29%|██▉       | 29/100 [00:03<00:08,  8.70it/s] 30%|███       | 30/100 [00:03<00:08,  8.68it/s] 31%|███       | 31/100 [00:03<00:07,  8.69it/s] 32%|███▏      | 32/100 [00:03<00:08,  8.30it/s] 33%|███▎      | 33/100 [00:03<00:07,  8.69it/s] 34%|███▍      | 34/100 [00:03<00:07,  8.57it/s] 35%|███▌      | 35/100 [00:04<00:07,  8.65it/s] 36%|███▌      | 36/100 [00:04<00:07,  8.56it/s] 37%|███▋      | 37/100 [00:04<00:07,  8.61it/s] 38%|███▊      | 38/100 [00:04<00:07,  8.50it/s] 39%|███▉      | 39/100 [00:04<00:07,  8.43it/s] 40%|████      | 40/100 [00:04<00:07,  8.38it/s] 41%|████      | 41/100 [00:04<00:07,  8.37it/s] 42%|████▏     | 42/100 [00:04<00:07,  8.26it/s] 43%|████▎     | 43/100 [00:05<00:06,  8.53it/s] 44%|████▍     | 44/100 [00:05<00:06,  8.48it/s] 45%|████▌     | 45/100 [00:05<00:06,  8.47it/s] 46%|████▌     | 46/100 [00:05<00:06,  8.32it/s] 47%|████▋     | 47/100 [00:05<00:06,  8.15it/s] 48%|████▊     | 48/100 [00:05<00:06,  8.02it/s] 49%|████▉     | 49/100 [00:05<00:07,  7.14it/s] 50%|█████     | 50/100 [00:05<00:06,  7.32it/s] 51%|█████     | 51/100 [00:06<00:06,  7.62it/s] 52%|█████▏    | 52/100 [00:06<00:06,  7.85it/s] 53%|█████▎    | 53/100 [00:06<00:05,  7.98it/s] 54%|█████▍    | 54/100 [00:06<00:05,  8.33it/s] 55%|█████▌    | 55/100 [00:06<00:05,  7.69it/s] 56%|█████▌    | 56/100 [00:06<00:05,  7.72it/s] 57%|█████▋    | 57/100 [00:06<00:05,  7.82it/s] 58%|█████▊    | 58/100 [00:06<00:05,  8.12it/s] 59%|█████▉    | 59/100 [00:07<00:05,  7.79it/s] 60%|██████    | 60/100 [00:07<00:05,  7.55it/s] 61%|██████    | 61/100 [00:07<00:04,  7.88it/s] 62%|██████▏   | 62/100 [00:07<00:04,  8.11it/s] 63%|██████▎   | 63/100 [00:07<00:04,  8.19it/s] 64%|██████▍   | 64/100 [00:07<00:04,  8.30it/s] 65%|██████▌   | 65/100 [00:07<00:04,  8.27it/s] 66%|██████▌   | 66/100 [00:07<00:04,  8.31it/s] 67%|██████▋   | 67/100 [00:08<00:04,  7.95it/s] 68%|██████▊   | 68/100 [00:08<00:03,  8.21it/s] 69%|██████▉   | 69/100 [00:08<00:03,  8.45it/s] 70%|███████   | 70/100 [00:08<00:03,  8.33it/s] 71%|███████   | 71/100 [00:08<00:03,  7.92it/s] 72%|███████▏  | 72/100 [00:08<00:03,  8.13it/s] 73%|███████▎  | 73/100 [00:08<00:03,  8.20it/s] 74%|███████▍  | 74/100 [00:08<00:03,  8.24it/s] 75%|███████▌  | 75/100 [00:09<00:03,  7.66it/s] 76%|███████▌  | 76/100 [00:09<00:03,  7.80it/s] 77%|███████▋  | 77/100 [00:09<00:02,  7.88it/s] 78%|███████▊  | 78/100 [00:09<00:02,  7.95it/s] 79%|███████▉  | 79/100 [00:09<00:02,  7.91it/s] 80%|████████  | 80/100 [00:09<00:02,  8.08it/s] 81%|████████  | 81/100 [00:09<00:02,  8.09it/s] 82%|████████▏ | 82/100 [00:09<00:02,  8.41it/s] 83%|████████▎ | 83/100 [00:10<00:02,  8.24it/s] 84%|████████▍ | 84/100 [00:10<00:01,  8.28it/s] 85%|████████▌ | 85/100 [00:10<00:01,  8.34it/s] 86%|████████▌ | 86/100 [00:10<00:01,  8.32it/s] 87%|████████▋ | 87/100 [00:10<00:01,  8.33it/s] 88%|████████▊ | 88/100 [00:10<00:01,  8.26it/s] 89%|████████▉ | 89/100 [00:10<00:01,  7.65it/s] 90%|█████████ | 90/100 [00:10<00:01,  7.73it/s] 91%|█████████ | 91/100 [00:11<00:01,  7.78it/s] 92%|█████████▏| 92/100 [00:11<00:01,  7.84it/s] 93%|█████████▎| 93/100 [00:11<00:00,  7.58it/s] 94%|█████████▍| 94/100 [00:11<00:00,  7.70it/s] 95%|█████████▌| 95/100 [00:11<00:00,  7.78it/s] 96%|█████████▌| 96/100 [00:11<00:00,  7.90it/s] 97%|█████████▋| 97/100 [00:11<00:00,  7.58it/s] 98%|█████████▊| 98/100 [00:11<00:00,  7.51it/s] 99%|█████████▉| 99/100 [00:12<00:00,  7.28it/s]100%|██████████| 100/100 [00:12<00:00,  7.31it/s]100%|██████████| 100/100 [00:12<00:00,  8.15it/s]
eval_p_index len:  18
individual_train 121
individual_eval 18
train data의 x, y, id 길이: 121 121 121
valid data의 x, y, id 길이: 11 11 11
test data의 x, y, id 길이: 7 7 7
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.660010, Valid_loss 0.639285
Epoch 2, Train Loss 0.654115, Valid_loss 0.626200
Epoch 3, Train Loss 0.644818, Valid_loss 0.615099
Epoch 4, Train Loss 0.635077, Valid_loss 0.606824
Epoch 5, Train Loss 0.629402, Valid_loss 0.599471
Epoch 6, Train Loss 0.623071, Valid_loss 0.591970
Epoch 7, Train Loss 0.608826, Valid_loss 0.583851
Epoch 8, Train Loss 0.602155, Valid_loss 0.572106
Epoch 9, Train Loss 0.592543, Valid_loss 0.559300
Epoch 10, Train Loss 0.580454, Valid_loss 0.539627
Epoch 11, Train Loss 0.560332, Valid_loss 0.519761
Epoch 12, Train Loss 0.541222, Valid_loss 0.501023
Epoch 13, Train Loss 0.523571, Valid_loss 0.464393
Epoch 14, Train Loss 0.512254, Valid_loss 0.459118
Epoch 15, Train Loss 0.506793, Valid_loss 0.450680
Epoch 16, Train Loss 0.505936, Valid_loss 0.446293
Epoch 17, Train Loss 0.496527, Valid_loss 0.457145
Epoch 18, Train Loss 0.497010, Valid_loss 0.448049
Epoch 19, Train Loss 0.494101, Valid_loss 0.446488
Epoch 20, Train Loss 0.483030, Valid_loss 0.443045
Epoch 21, Train Loss 0.481643, Valid_loss 0.443540
Epoch 22, Train Loss 0.476052, Valid_loss 0.434503
Epoch 23, Train Loss 0.476684, Valid_loss 0.436410
Epoch 24, Train Loss 0.471015, Valid_loss 0.432254
Epoch 25, Train Loss 0.476188, Valid_loss 0.427968
Epoch 26, Train Loss 0.472682, Valid_loss 0.431736
Epoch 27, Train Loss 0.475025, Valid_loss 0.428960
Epoch 28, Train Loss 0.464774, Valid_loss 0.428469
Epoch 29, Train Loss 0.465400, Valid_loss 0.429525
Epoch 30, Train Loss 0.467318, Valid_loss 0.427256
Epoch 31, Train Loss 0.462525, Valid_loss 0.430875
Epoch 32, Train Loss 0.458402, Valid_loss 0.429523
Epoch 33, Train Loss 0.457602, Valid_loss 0.425307
Epoch 34, Train Loss 0.460730, Valid_loss 0.434571
Epoch 35, Train Loss 0.457969, Valid_loss 0.428811
Epoch 36, Train Loss 0.457549, Valid_loss 0.429231
Epoch 37, Train Loss 0.457317, Valid_loss 0.436363
Epoch 38, Train Loss 0.451657, Valid_loss 0.434664
Epoch 39, Train Loss 0.449171, Valid_loss 0.429017
Epoch 40, Train Loss 0.449408, Valid_loss 0.438181
Epoch 41, Train Loss 0.445014, Valid_loss 0.432966
Epoch 42, Train Loss 0.445006, Valid_loss 0.434522
Epoch 43, Train Loss 0.446894, Valid_loss 0.440683
Epoch 44, Train Loss 0.442387, Valid_loss 0.420690
Epoch 45, Train Loss 0.440758, Valid_loss 0.441571
Epoch 46, Train Loss 0.440299, Valid_loss 0.433724
Epoch 47, Train Loss 0.436413, Valid_loss 0.433017
Epoch 48, Train Loss 0.440317, Valid_loss 0.440606
Epoch 49, Train Loss 0.442707, Valid_loss 0.436665
Epoch 50, Train Loss 0.435912, Valid_loss 0.436513
Epoch 51, Train Loss 0.434035, Valid_loss 0.436875
Epoch 52, Train Loss 0.435880, Valid_loss 0.438127
COVID19_Participant31 -- true: COVID-19 -- pred: COVID-19
Control_Participant7 -- true: normal -- pred: COVID-19
COVID19_Participant31 -- true: COVID-19 -- pred: COVID-19
COVID19_Participant13 -- true: COVID-19 -- pred: COVID-19
Control_Participant5 -- true: normal -- pred: normal
COVID19_Participant13 -- true: COVID-19 -- pred: COVID-19
Control_Participant7 -- true: normal -- pred: normal
true :  [1, 0, 1, 1, 0, 1, 0]
pred :  [1, 1, 1, 1, 0, 1, 0]
Confusion Matrix: [2 1 0 4]
Best performance: Epoch 44, Loss 0.442387, Test ACC 0.857143, Test AUC 1.000000, Test Recall 1.000000, Test Precision 0.800000
✅ Total valid splits used: 3
🔁 Repeat 1, Fold 3
🔍 Split #4
  → train_p_index 환자 수: 31
  → test_p_index 환자 수: 8
  → train 환자 ID: ['COVID19_Participant11', 'COVID19_Participant12', 'COVID19_Participant14', 'COVID19_Participant15', 'COVID19_Participant17', 'COVID19_Participant18', 'COVID19_Participant19', 'COVID19_Participant2', 'COVID19_Participant20', 'COVID19_Participant22', 'COVID19_Participant23', 'COVID19_Participant25', 'COVID19_Participant26', 'COVID19_Participant29', 'COVID19_Participant3', 'COVID19_Participant30', 'COVID19_Participant32', 'COVID19_Participant36', 'COVID19_Participant37', 'COVID19_Participant40', 'COVID19_Participant7', 'COVID19_Participant8', 'Control_Participant10', 'Control_Participant11', 'Control_Participant14', 'Control_Participant3', 'Control_Participant4', 'Control_Participant5', 'Control_Participant6', 'Control_Participant7', 'Control_Participant9']
  → test  환자 ID: ['Control_Participant7', 'COVID19_Participant26', 'Control_Participant7', 'COVID19_Participant7', 'Control_Participant5', 'COVID19_Participant26', 'Control_Participant3', 'Control_Participant5']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant12, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant18, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant3, Label: 1
    ID: COVID19_Participant30, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant36, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: Control_Participant10, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant14, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant4, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant6, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: Control_Participant7, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: Control_Participant7, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: Control_Participant5, Label: 1
    ID: COVID19_Participant26, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant5, Label: 0
train_p_index_ 20
valid_p_index 11
test_p_index 8
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Keratinocytes', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Neurons', 'iPS_cells', 'Embryonic_stem_cells', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
data augment 실행 함
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:11,  8.87it/s]  2%|▏         | 2/100 [00:00<00:11,  8.77it/s]  3%|▎         | 3/100 [00:00<00:10,  8.94it/s]  4%|▍         | 4/100 [00:00<00:10,  8.75it/s]  5%|▌         | 5/100 [00:00<00:11,  8.63it/s]  6%|▌         | 6/100 [00:00<00:10,  8.78it/s]  7%|▋         | 7/100 [00:00<00:10,  8.96it/s]  8%|▊         | 8/100 [00:00<00:10,  8.78it/s]  9%|▉         | 9/100 [00:01<00:10,  8.90it/s] 10%|█         | 10/100 [00:01<00:10,  8.97it/s] 11%|█         | 11/100 [00:01<00:10,  8.82it/s] 12%|█▏        | 12/100 [00:01<00:10,  8.72it/s] 13%|█▎        | 13/100 [00:01<00:09,  8.79it/s] 14%|█▍        | 14/100 [00:01<00:09,  8.77it/s] 15%|█▌        | 15/100 [00:01<00:09,  8.54it/s] 16%|█▌        | 16/100 [00:01<00:09,  8.43it/s] 17%|█▋        | 17/100 [00:01<00:09,  8.45it/s] 18%|█▊        | 18/100 [00:02<00:09,  8.48it/s] 19%|█▉        | 19/100 [00:02<00:09,  8.31it/s] 20%|██        | 20/100 [00:02<00:09,  8.32it/s] 21%|██        | 21/100 [00:02<00:09,  8.38it/s] 22%|██▏       | 22/100 [00:02<00:09,  8.41it/s] 23%|██▎       | 23/100 [00:02<00:09,  8.38it/s] 24%|██▍       | 24/100 [00:02<00:09,  8.41it/s] 25%|██▌       | 25/100 [00:02<00:09,  8.33it/s] 26%|██▌       | 26/100 [00:03<00:08,  8.42it/s] 27%|██▋       | 27/100 [00:03<00:08,  8.34it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.39it/s] 29%|██▉       | 29/100 [00:03<00:08,  8.13it/s] 30%|███       | 30/100 [00:03<00:08,  8.25it/s] 31%|███       | 31/100 [00:03<00:08,  8.07it/s] 32%|███▏      | 32/100 [00:03<00:07,  8.54it/s] 33%|███▎      | 33/100 [00:03<00:07,  8.65it/s] 34%|███▍      | 34/100 [00:03<00:07,  8.59it/s] 35%|███▌      | 35/100 [00:04<00:07,  8.66it/s] 36%|███▌      | 36/100 [00:04<00:07,  8.60it/s] 37%|███▋      | 37/100 [00:04<00:07,  8.53it/s] 38%|███▊      | 38/100 [00:04<00:07,  8.18it/s] 39%|███▉      | 39/100 [00:04<00:07,  8.15it/s] 40%|████      | 40/100 [00:04<00:07,  8.04it/s] 41%|████      | 41/100 [00:04<00:07,  8.22it/s] 42%|████▏     | 42/100 [00:04<00:07,  8.03it/s] 43%|████▎     | 43/100 [00:05<00:06,  8.22it/s] 44%|████▍     | 44/100 [00:05<00:06,  8.03it/s] 45%|████▌     | 45/100 [00:05<00:06,  8.16it/s] 46%|████▌     | 46/100 [00:05<00:06,  8.18it/s] 47%|████▋     | 47/100 [00:05<00:07,  7.46it/s] 48%|████▊     | 48/100 [00:05<00:06,  7.70it/s] 49%|████▉     | 49/100 [00:05<00:06,  8.10it/s] 50%|█████     | 50/100 [00:05<00:06,  8.20it/s] 51%|█████     | 51/100 [00:06<00:05,  8.27it/s] 52%|█████▏    | 52/100 [00:06<00:05,  8.18it/s] 53%|█████▎    | 53/100 [00:06<00:06,  7.67it/s] 54%|█████▍    | 54/100 [00:06<00:05,  7.77it/s] 55%|█████▌    | 55/100 [00:06<00:05,  7.97it/s] 56%|█████▌    | 56/100 [00:06<00:05,  7.90it/s] 57%|█████▋    | 57/100 [00:06<00:05,  7.90it/s] 58%|█████▊    | 58/100 [00:06<00:05,  7.91it/s] 59%|█████▉    | 59/100 [00:07<00:05,  8.09it/s] 60%|██████    | 60/100 [00:07<00:05,  7.84it/s] 61%|██████    | 61/100 [00:07<00:05,  7.70it/s] 62%|██████▏   | 62/100 [00:07<00:04,  7.62it/s] 63%|██████▎   | 63/100 [00:07<00:04,  7.65it/s] 64%|██████▍   | 64/100 [00:07<00:04,  7.54it/s] 65%|██████▌   | 65/100 [00:07<00:04,  7.42it/s] 66%|██████▌   | 66/100 [00:08<00:04,  7.64it/s] 67%|██████▋   | 67/100 [00:08<00:04,  7.72it/s] 68%|██████▊   | 68/100 [00:08<00:04,  7.80it/s] 69%|██████▉   | 69/100 [00:08<00:04,  7.70it/s] 70%|███████   | 70/100 [00:08<00:03,  7.83it/s] 71%|███████   | 71/100 [00:08<00:03,  7.76it/s] 72%|███████▏  | 72/100 [00:08<00:03,  7.71it/s] 73%|███████▎  | 73/100 [00:08<00:03,  7.82it/s] 74%|███████▍  | 74/100 [00:09<00:03,  7.70it/s] 75%|███████▌  | 75/100 [00:09<00:03,  7.74it/s] 76%|███████▌  | 76/100 [00:09<00:03,  7.30it/s] 77%|███████▋  | 77/100 [00:09<00:03,  7.16it/s] 78%|███████▊  | 78/100 [00:09<00:02,  7.46it/s] 79%|███████▉  | 79/100 [00:09<00:02,  7.40it/s] 80%|████████  | 80/100 [00:09<00:02,  7.67it/s] 81%|████████  | 81/100 [00:09<00:02,  7.64it/s] 82%|████████▏ | 82/100 [00:10<00:02,  7.67it/s] 83%|████████▎ | 83/100 [00:10<00:02,  7.67it/s] 84%|████████▍ | 84/100 [00:10<00:02,  7.74it/s] 85%|████████▌ | 85/100 [00:10<00:01,  7.85it/s] 86%|████████▌ | 86/100 [00:10<00:01,  7.91it/s] 87%|████████▋ | 87/100 [00:10<00:01,  7.95it/s] 88%|████████▊ | 88/100 [00:10<00:01,  8.00it/s] 89%|████████▉ | 89/100 [00:11<00:01,  7.95it/s] 90%|█████████ | 90/100 [00:11<00:01,  7.06it/s] 91%|█████████ | 91/100 [00:11<00:01,  7.41it/s] 92%|█████████▏| 92/100 [00:11<00:01,  7.52it/s] 93%|█████████▎| 93/100 [00:11<00:00,  7.64it/s] 94%|█████████▍| 94/100 [00:11<00:00,  7.86it/s] 95%|█████████▌| 95/100 [00:11<00:00,  7.82it/s] 96%|█████████▌| 96/100 [00:11<00:00,  7.83it/s] 97%|█████████▋| 97/100 [00:12<00:00,  7.90it/s] 98%|█████████▊| 98/100 [00:12<00:00,  8.03it/s] 99%|█████████▉| 99/100 [00:12<00:00,  6.98it/s]100%|██████████| 100/100 [00:12<00:00,  7.34it/s]100%|██████████| 100/100 [00:12<00:00,  8.01it/s]
eval_p_index len:  19
individual_train 120
individual_eval 19
train data의 x, y, id 길이: 120 120 120
valid data의 x, y, id 길이: 11 11 11
test data의 x, y, id 길이: 8 8 8
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.699253, Valid_loss 0.646740
Epoch 2, Train Loss 0.677906, Valid_loss 0.626551
Epoch 3, Train Loss 0.654808, Valid_loss 0.619443
Epoch 4, Train Loss 0.643553, Valid_loss 0.617086
Epoch 5, Train Loss 0.630216, Valid_loss 0.619654
Epoch 6, Train Loss 0.603196, Valid_loss 0.621057
Epoch 7, Train Loss 0.575462, Valid_loss 0.587133
Epoch 8, Train Loss 0.563186, Valid_loss 0.570737
Epoch 9, Train Loss 0.550539, Valid_loss 0.563498
Epoch 10, Train Loss 0.540621, Valid_loss 0.540994
Epoch 11, Train Loss 0.530210, Valid_loss 0.544531
Epoch 12, Train Loss 0.524282, Valid_loss 0.539028
Epoch 13, Train Loss 0.522533, Valid_loss 0.540788
Epoch 14, Train Loss 0.521406, Valid_loss 0.555757
Epoch 15, Train Loss 0.511621, Valid_loss 0.544132
Epoch 16, Train Loss 0.514271, Valid_loss 0.537843
Epoch 17, Train Loss 0.513393, Valid_loss 0.546723
Epoch 18, Train Loss 0.514380, Valid_loss 0.545771
Epoch 19, Train Loss 0.510838, Valid_loss 0.535270
Epoch 20, Train Loss 0.509256, Valid_loss 0.541594
Epoch 21, Train Loss 0.511716, Valid_loss 0.536598
Epoch 22, Train Loss 0.501832, Valid_loss 0.530475
Epoch 23, Train Loss 0.508411, Valid_loss 0.529978
Epoch 24, Train Loss 0.505570, Valid_loss 0.531345
Epoch 25, Train Loss 0.501168, Valid_loss 0.521895
Epoch 26, Train Loss 0.494898, Valid_loss 0.520649
Epoch 27, Train Loss 0.498150, Valid_loss 0.522558
Epoch 28, Train Loss 0.501657, Valid_loss 0.518060
Epoch 29, Train Loss 0.490152, Valid_loss 0.513520
Epoch 30, Train Loss 0.492667, Valid_loss 0.513321
Epoch 31, Train Loss 0.497822, Valid_loss 0.517905
Epoch 32, Train Loss 0.495023, Valid_loss 0.511021
Epoch 33, Train Loss 0.489800, Valid_loss 0.509191
Epoch 34, Train Loss 0.490560, Valid_loss 0.506297
Epoch 35, Train Loss 0.493824, Valid_loss 0.507972
Epoch 36, Train Loss 0.495546, Valid_loss 0.502792
Epoch 37, Train Loss 0.490052, Valid_loss 0.501742
Epoch 38, Train Loss 0.485516, Valid_loss 0.501585
Epoch 39, Train Loss 0.487336, Valid_loss 0.501167
Epoch 40, Train Loss 0.483039, Valid_loss 0.495931
Epoch 41, Train Loss 0.480805, Valid_loss 0.498686
Epoch 42, Train Loss 0.481065, Valid_loss 0.497223
Epoch 43, Train Loss 0.473750, Valid_loss 0.493161
Epoch 44, Train Loss 0.478102, Valid_loss 0.494394
Epoch 45, Train Loss 0.474736, Valid_loss 0.492911
Epoch 46, Train Loss 0.472180, Valid_loss 0.493001
Epoch 47, Train Loss 0.473214, Valid_loss 0.491844
Epoch 48, Train Loss 0.470978, Valid_loss 0.492157
Epoch 49, Train Loss 0.470644, Valid_loss 0.490440
Epoch 50, Train Loss 0.470727, Valid_loss 0.490630
Epoch 51, Train Loss 0.470606, Valid_loss 0.489296
Epoch 52, Train Loss 0.476072, Valid_loss 0.489811
Epoch 53, Train Loss 0.468812, Valid_loss 0.490466
Control_Participant7 -- true: normal -- pred: COVID-19
COVID19_Participant26 -- true: COVID-19 -- pred: COVID-19
Control_Participant7 -- true: normal -- pred: COVID-19
COVID19_Participant7 -- true: COVID-19 -- pred: COVID-19
Control_Participant5 -- true: normal -- pred: normal
COVID19_Participant26 -- true: COVID-19 -- pred: COVID-19
Control_Participant3 -- true: normal -- pred: normal
Control_Participant5 -- true: normal -- pred: normal
true :  [0, 1, 0, 1, 0, 1, 0, 0]
pred :  [1, 1, 1, 1, 0, 1, 0, 0]
Confusion Matrix: [3 2 0 3]
Best performance: Epoch 51, Loss 0.470606, Test ACC 0.750000, Test AUC 1.000000, Test Recall 1.000000, Test Precision 0.600000
✅ Total valid splits used: 4
🔁 Repeat 1, Fold 4
🔍 Split #5
  → train_p_index 환자 수: 32
  → test_p_index 환자 수: 7
  → train 환자 ID: ['COVID19_Participant11', 'COVID19_Participant12', 'COVID19_Participant13', 'COVID19_Participant14', 'COVID19_Participant17', 'COVID19_Participant19', 'COVID19_Participant2', 'COVID19_Participant20', 'COVID19_Participant22', 'COVID19_Participant23', 'COVID19_Participant25', 'COVID19_Participant26', 'COVID19_Participant28', 'COVID19_Participant29', 'COVID19_Participant3', 'COVID19_Participant30', 'COVID19_Participant31', 'COVID19_Participant36', 'COVID19_Participant37', 'COVID19_Participant39', 'COVID19_Participant4', 'COVID19_Participant40', 'COVID19_Participant7', 'Control_Participant1', 'Control_Participant15', 'Control_Participant3', 'Control_Participant4', 'Control_Participant5', 'Control_Participant6', 'Control_Participant7', 'Control_Participant8', 'Control_Participant9']
  → test  환자 ID: ['COVID19_Participant11', 'Control_Participant3', 'COVID19_Participant25', 'Control_Participant7', 'Control_Participant7', 'COVID19_Participant26', 'Control_Participant3']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant12, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant3, Label: 1
    ID: COVID19_Participant30, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant36, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant4, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant6, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant8, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: COVID19_Participant11, Label: 1
    ID: Control_Participant3, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: Control_Participant7, Label: 1
    ID: Control_Participant7, Label: 0
    ID: COVID19_Participant26, Label: 0
    ID: Control_Participant3, Label: 0
train_p_index_ 21
valid_p_index 11
test_p_index 7
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Keratinocytes', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Neurons', 'iPS_cells', 'Embryonic_stem_cells', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
data augment 실행 함
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:12,  8.21it/s]  2%|▏         | 2/100 [00:00<00:10,  9.04it/s]  3%|▎         | 3/100 [00:00<00:11,  8.75it/s]  4%|▍         | 4/100 [00:00<00:10,  8.77it/s]  5%|▌         | 5/100 [00:00<00:11,  8.35it/s]  7%|▋         | 7/100 [00:00<00:10,  8.94it/s]  8%|▊         | 8/100 [00:00<00:10,  8.86it/s]  9%|▉         | 9/100 [00:01<00:10,  8.80it/s] 10%|█         | 10/100 [00:01<00:10,  8.77it/s] 11%|█         | 11/100 [00:01<00:10,  8.43it/s] 12%|█▏        | 12/100 [00:01<00:10,  8.48it/s] 13%|█▎        | 13/100 [00:01<00:09,  8.72it/s] 14%|█▍        | 14/100 [00:01<00:09,  8.88it/s] 15%|█▌        | 15/100 [00:01<00:09,  9.15it/s] 16%|█▌        | 16/100 [00:01<00:09,  9.18it/s] 17%|█▋        | 17/100 [00:01<00:09,  8.79it/s] 18%|█▊        | 18/100 [00:02<00:09,  8.48it/s] 19%|█▉        | 19/100 [00:02<00:09,  8.47it/s] 20%|██        | 20/100 [00:02<00:09,  8.79it/s] 21%|██        | 21/100 [00:02<00:09,  8.67it/s] 22%|██▏       | 22/100 [00:02<00:08,  8.67it/s] 23%|██▎       | 23/100 [00:02<00:10,  7.33it/s] 24%|██▍       | 24/100 [00:02<00:10,  7.53it/s] 25%|██▌       | 25/100 [00:02<00:09,  7.95it/s] 26%|██▌       | 26/100 [00:03<00:08,  8.37it/s] 27%|██▋       | 27/100 [00:03<00:08,  8.51it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.47it/s] 29%|██▉       | 29/100 [00:03<00:08,  8.58it/s] 30%|███       | 30/100 [00:03<00:07,  8.85it/s] 31%|███       | 31/100 [00:03<00:07,  8.96it/s] 32%|███▏      | 32/100 [00:03<00:07,  8.83it/s] 33%|███▎      | 33/100 [00:03<00:07,  8.69it/s] 34%|███▍      | 34/100 [00:03<00:07,  8.67it/s] 35%|███▌      | 35/100 [00:04<00:07,  8.84it/s] 36%|███▌      | 36/100 [00:04<00:07,  8.78it/s] 37%|███▋      | 37/100 [00:04<00:07,  8.55it/s] 38%|███▊      | 38/100 [00:04<00:07,  8.36it/s] 39%|███▉      | 39/100 [00:04<00:07,  8.29it/s] 40%|████      | 40/100 [00:04<00:07,  8.37it/s] 41%|████      | 41/100 [00:04<00:07,  8.30it/s] 42%|████▏     | 42/100 [00:04<00:06,  8.39it/s] 43%|████▎     | 43/100 [00:05<00:06,  8.15it/s] 44%|████▍     | 44/100 [00:05<00:06,  8.18it/s] 45%|████▌     | 45/100 [00:05<00:07,  7.43it/s] 46%|████▌     | 46/100 [00:05<00:07,  7.47it/s] 47%|████▋     | 47/100 [00:05<00:06,  7.63it/s] 48%|████▊     | 48/100 [00:05<00:06,  7.91it/s] 49%|████▉     | 49/100 [00:05<00:06,  7.72it/s] 50%|█████     | 50/100 [00:05<00:06,  7.72it/s] 51%|█████     | 51/100 [00:06<00:06,  7.78it/s] 52%|█████▏    | 52/100 [00:06<00:06,  7.69it/s] 53%|█████▎    | 53/100 [00:06<00:06,  7.83it/s] 54%|█████▍    | 54/100 [00:06<00:05,  7.93it/s] 55%|█████▌    | 55/100 [00:06<00:05,  8.05it/s] 56%|█████▌    | 56/100 [00:06<00:06,  7.11it/s] 57%|█████▋    | 57/100 [00:06<00:05,  7.22it/s] 58%|█████▊    | 58/100 [00:07<00:06,  6.71it/s] 59%|█████▉    | 59/100 [00:07<00:06,  6.53it/s] 60%|██████    | 60/100 [00:07<00:05,  7.03it/s] 61%|██████    | 61/100 [00:07<00:05,  7.36it/s] 62%|██████▏   | 62/100 [00:07<00:04,  7.63it/s] 63%|██████▎   | 63/100 [00:07<00:04,  7.81it/s] 64%|██████▍   | 64/100 [00:07<00:04,  7.66it/s] 65%|██████▌   | 65/100 [00:07<00:04,  7.79it/s] 66%|██████▌   | 66/100 [00:08<00:04,  7.49it/s] 67%|██████▋   | 67/100 [00:08<00:04,  7.34it/s] 68%|██████▊   | 68/100 [00:08<00:04,  7.64it/s] 69%|██████▉   | 69/100 [00:08<00:04,  7.33it/s] 70%|███████   | 70/100 [00:08<00:03,  7.71it/s] 71%|███████   | 71/100 [00:08<00:03,  7.38it/s] 72%|███████▏  | 72/100 [00:08<00:03,  7.57it/s] 73%|███████▎  | 73/100 [00:09<00:03,  7.89it/s] 74%|███████▍  | 74/100 [00:09<00:03,  7.74it/s] 75%|███████▌  | 75/100 [00:09<00:03,  7.71it/s] 76%|███████▌  | 76/100 [00:09<00:03,  7.44it/s] 77%|███████▋  | 77/100 [00:09<00:02,  7.81it/s] 78%|███████▊  | 78/100 [00:09<00:02,  7.67it/s] 79%|███████▉  | 79/100 [00:09<00:02,  7.52it/s] 80%|████████  | 80/100 [00:10<00:02,  6.72it/s] 81%|████████  | 81/100 [00:10<00:02,  7.05it/s] 82%|████████▏ | 82/100 [00:10<00:02,  7.23it/s] 83%|████████▎ | 83/100 [00:10<00:02,  7.44it/s] 84%|████████▍ | 84/100 [00:10<00:02,  7.46it/s] 85%|████████▌ | 85/100 [00:10<00:01,  7.73it/s] 86%|████████▌ | 86/100 [00:10<00:01,  7.81it/s] 87%|████████▋ | 87/100 [00:10<00:02,  6.48it/s] 88%|████████▊ | 88/100 [00:11<00:01,  6.36it/s] 89%|████████▉ | 89/100 [00:11<00:01,  6.68it/s] 90%|█████████ | 90/100 [00:11<00:01,  7.03it/s] 91%|█████████ | 91/100 [00:11<00:01,  7.45it/s] 92%|█████████▏| 92/100 [00:11<00:01,  7.65it/s] 93%|█████████▎| 93/100 [00:11<00:00,  7.55it/s] 94%|█████████▍| 94/100 [00:11<00:00,  7.49it/s] 95%|█████████▌| 95/100 [00:12<00:00,  7.69it/s] 96%|█████████▌| 96/100 [00:12<00:00,  7.73it/s] 97%|█████████▋| 97/100 [00:12<00:00,  7.84it/s] 98%|█████████▊| 98/100 [00:12<00:00,  7.84it/s] 99%|█████████▉| 99/100 [00:12<00:00,  7.92it/s]100%|██████████| 100/100 [00:12<00:00,  7.81it/s]100%|██████████| 100/100 [00:12<00:00,  7.89it/s]
eval_p_index len:  18
individual_train 121
individual_eval 18
train data의 x, y, id 길이: 121 121 121
valid data의 x, y, id 길이: 11 11 11
test data의 x, y, id 길이: 7 7 7
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.572771, Valid_loss 0.585848
Epoch 2, Train Loss 0.560313, Valid_loss 0.574418
Epoch 3, Train Loss 0.553132, Valid_loss 0.566582
Epoch 4, Train Loss 0.558453, Valid_loss 0.564058
Epoch 5, Train Loss 0.555454, Valid_loss 0.557608
Epoch 6, Train Loss 0.536290, Valid_loss 0.550753
Epoch 7, Train Loss 0.531407, Valid_loss 0.542359
Epoch 8, Train Loss 0.537882, Valid_loss 0.532851
Epoch 9, Train Loss 0.518116, Valid_loss 0.525300
Epoch 10, Train Loss 0.508668, Valid_loss 0.517101
Epoch 11, Train Loss 0.488684, Valid_loss 0.515421
Epoch 12, Train Loss 0.477164, Valid_loss 0.501865
Epoch 13, Train Loss 0.469130, Valid_loss 0.504276
Epoch 14, Train Loss 0.470007, Valid_loss 0.497788
Epoch 15, Train Loss 0.467216, Valid_loss 0.494100
Epoch 16, Train Loss 0.460905, Valid_loss 0.488915
Epoch 17, Train Loss 0.460251, Valid_loss 0.493413
Epoch 18, Train Loss 0.454073, Valid_loss 0.486206
Epoch 19, Train Loss 0.452365, Valid_loss 0.489275
Epoch 20, Train Loss 0.455606, Valid_loss 0.481988
Epoch 21, Train Loss 0.448141, Valid_loss 0.483642
Epoch 22, Train Loss 0.450818, Valid_loss 0.479866
Epoch 23, Train Loss 0.454747, Valid_loss 0.482529
Epoch 24, Train Loss 0.447841, Valid_loss 0.476616
Epoch 25, Train Loss 0.442883, Valid_loss 0.474175
Epoch 26, Train Loss 0.454398, Valid_loss 0.469742
Epoch 27, Train Loss 0.443048, Valid_loss 0.468538
Epoch 28, Train Loss 0.431060, Valid_loss 0.463713
Epoch 29, Train Loss 0.430460, Valid_loss 0.462473
Epoch 30, Train Loss 0.428783, Valid_loss 0.462229
Epoch 31, Train Loss 0.436204, Valid_loss 0.465386
Epoch 32, Train Loss 0.443860, Valid_loss 0.463802
Epoch 33, Train Loss 0.438272, Valid_loss 0.461073
Epoch 34, Train Loss 0.424983, Valid_loss 0.461134
Epoch 35, Train Loss 0.430305, Valid_loss 0.462224
Epoch 36, Train Loss 0.430138, Valid_loss 0.459252
Epoch 37, Train Loss 0.436100, Valid_loss 0.457709
Epoch 38, Train Loss 0.425676, Valid_loss 0.458130
Epoch 39, Train Loss 0.432911, Valid_loss 0.454636
Epoch 40, Train Loss 0.436698, Valid_loss 0.451572
Epoch 41, Train Loss 0.427365, Valid_loss 0.449580
Epoch 42, Train Loss 0.419887, Valid_loss 0.446477
Epoch 43, Train Loss 0.419933, Valid_loss 0.442613
Epoch 44, Train Loss 0.415685, Valid_loss 0.439267
Epoch 45, Train Loss 0.412699, Valid_loss 0.431813
Epoch 46, Train Loss 0.401907, Valid_loss 0.429461
Epoch 47, Train Loss 0.402248, Valid_loss 0.425623
Epoch 48, Train Loss 0.401963, Valid_loss 0.421605
Epoch 49, Train Loss 0.402558, Valid_loss 0.420720
Epoch 50, Train Loss 0.400447, Valid_loss 0.415901
Epoch 51, Train Loss 0.394558, Valid_loss 0.414026
Epoch 52, Train Loss 0.393432, Valid_loss 0.412227
Epoch 53, Train Loss 0.389363, Valid_loss 0.410674
Epoch 54, Train Loss 0.399447, Valid_loss 0.409676
Epoch 55, Train Loss 0.389144, Valid_loss 0.406935
Epoch 56, Train Loss 0.388867, Valid_loss 0.406802
Epoch 57, Train Loss 0.393591, Valid_loss 0.406033
Epoch 58, Train Loss 0.403701, Valid_loss 0.403316
Epoch 59, Train Loss 0.386118, Valid_loss 0.403608
Epoch 60, Train Loss 0.387925, Valid_loss 0.401095
Epoch 61, Train Loss 0.385112, Valid_loss 0.399390
Epoch 62, Train Loss 0.385068, Valid_loss 0.398504
Epoch 63, Train Loss 0.377081, Valid_loss 0.396579
Epoch 64, Train Loss 0.383324, Valid_loss 0.395532
Epoch 65, Train Loss 0.381529, Valid_loss 0.393985
Epoch 66, Train Loss 0.374902, Valid_loss 0.392845
Epoch 67, Train Loss 0.374658, Valid_loss 0.392266
Epoch 68, Train Loss 0.382640, Valid_loss 0.389928
Epoch 69, Train Loss 0.379175, Valid_loss 0.388361
Epoch 70, Train Loss 0.373723, Valid_loss 0.386595
Epoch 71, Train Loss 0.371952, Valid_loss 0.385413
Epoch 72, Train Loss 0.384435, Valid_loss 0.385080
Epoch 73, Train Loss 0.369691, Valid_loss 0.382770
Epoch 74, Train Loss 0.375832, Valid_loss 0.381928
Epoch 75, Train Loss 0.372548, Valid_loss 0.381670
Epoch 76, Train Loss 0.380994, Valid_loss 0.380951
Epoch 77, Train Loss 0.370149, Valid_loss 0.379857
Epoch 78, Train Loss 0.387931, Valid_loss 0.379780
Epoch 79, Train Loss 0.368699, Valid_loss 0.378367
Epoch 80, Train Loss 0.372407, Valid_loss 0.377937
Epoch 81, Train Loss 0.378051, Valid_loss 0.375973
Epoch 82, Train Loss 0.367129, Valid_loss 0.375662
Epoch 83, Train Loss 0.370767, Valid_loss 0.374503
Epoch 84, Train Loss 0.373598, Valid_loss 0.372852
Epoch 85, Train Loss 0.370406, Valid_loss 0.373705
Epoch 86, Train Loss 0.379143, Valid_loss 0.371587
Epoch 87, Train Loss 0.377053, Valid_loss 0.371259
Epoch 88, Train Loss 0.371938, Valid_loss 0.370516
Epoch 89, Train Loss 0.365220, Valid_loss 0.368663
Epoch 90, Train Loss 0.359389, Valid_loss 0.368286
Epoch 91, Train Loss 0.371445, Valid_loss 0.367054
Epoch 92, Train Loss 0.369785, Valid_loss 0.366773
Epoch 93, Train Loss 0.362673, Valid_loss 0.366109
Epoch 94, Train Loss 0.365688, Valid_loss 0.364808
Epoch 95, Train Loss 0.365174, Valid_loss 0.364287
Epoch 96, Train Loss 0.370914, Valid_loss 0.363270
Epoch 97, Train Loss 0.362413, Valid_loss 0.362608
Epoch 98, Train Loss 0.363765, Valid_loss 0.362724
Epoch 99, Train Loss 0.362962, Valid_loss 0.361219
Epoch 100, Train Loss 0.364772, Valid_loss 0.360171
COVID19_Participant11 -- true: COVID-19 -- pred: normal
Control_Participant3 -- true: normal -- pred: normal
COVID19_Participant25 -- true: COVID-19 -- pred: COVID-19
Control_Participant7 -- true: normal -- pred: normal
Control_Participant7 -- true: normal -- pred: COVID-19
COVID19_Participant26 -- true: COVID-19 -- pred: COVID-19
Control_Participant3 -- true: normal -- pred: normal
true :  [1, 0, 1, 0, 0, 1, 0]
pred :  [0, 0, 1, 0, 1, 1, 0]
Confusion Matrix: [3 1 1 2]
Best performance: Epoch 100, Loss 0.364772, Test ACC 0.714286, Test AUC 0.666667, Test Recall 0.666667, Test Precision 0.666667
✅ Total valid splits used: 5

📌 Repeat 1: 평균 AUC = 0.8767, 표준편차 = 0.1227
🔁 Repeat 2, Fold 0
🔍 Split #1
  → train_p_index 환자 수: 31
  → test_p_index 환자 수: 8
  → train 환자 ID: ['COVID19_Participant11', 'COVID19_Participant13', 'COVID19_Participant14', 'COVID19_Participant15', 'COVID19_Participant17', 'COVID19_Participant18', 'COVID19_Participant19', 'COVID19_Participant2', 'COVID19_Participant22', 'COVID19_Participant23', 'COVID19_Participant25', 'COVID19_Participant26', 'COVID19_Participant28', 'COVID19_Participant29', 'COVID19_Participant3', 'COVID19_Participant31', 'COVID19_Participant32', 'COVID19_Participant36', 'COVID19_Participant37', 'COVID19_Participant39', 'COVID19_Participant40', 'COVID19_Participant8', 'Control_Participant1', 'Control_Participant10', 'Control_Participant11', 'Control_Participant14', 'Control_Participant15', 'Control_Participant3', 'Control_Participant4', 'Control_Participant6', 'Control_Participant7']
  → test  환자 ID: ['COVID19_Participant25', 'COVID19_Participant11', 'Control_Participant3', 'COVID19_Participant26', 'Control_Participant7', 'Control_Participant7', 'COVID19_Participant31', 'COVID19_Participant13']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant18, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant3, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant36, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant10, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant14, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant4, Label: 0
    ID: Control_Participant6, Label: 0
    ID: Control_Participant7, Label: 0
  → test 환자 ID 및 라벨:
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant11, Label: 1
    ID: Control_Participant3, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: Control_Participant7, Label: 1
    ID: Control_Participant7, Label: 0
    ID: COVID19_Participant31, Label: 0
    ID: COVID19_Participant13, Label: 0
train_p_index_ 20
valid_p_index 11
test_p_index 8
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Keratinocytes', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Neurons', 'iPS_cells', 'Embryonic_stem_cells', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
data augment 실행 함
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:10,  9.36it/s]  2%|▏         | 2/100 [00:00<00:11,  8.88it/s]  3%|▎         | 3/100 [00:00<00:10,  9.22it/s]  4%|▍         | 4/100 [00:00<00:10,  9.31it/s]  5%|▌         | 5/100 [00:00<00:10,  9.45it/s]  6%|▌         | 6/100 [00:00<00:09,  9.49it/s]  7%|▋         | 7/100 [00:00<00:09,  9.62it/s]  8%|▊         | 8/100 [00:00<00:09,  9.29it/s]  9%|▉         | 9/100 [00:00<00:09,  9.30it/s] 10%|█         | 10/100 [00:01<00:09,  9.37it/s] 11%|█         | 11/100 [00:01<00:10,  8.58it/s] 12%|█▏        | 12/100 [00:01<00:09,  8.96it/s] 13%|█▎        | 13/100 [00:01<00:09,  9.03it/s] 14%|█▍        | 14/100 [00:01<00:09,  8.80it/s] 15%|█▌        | 15/100 [00:01<00:10,  8.33it/s] 16%|█▌        | 16/100 [00:01<00:10,  8.29it/s] 17%|█▋        | 17/100 [00:01<00:09,  8.54it/s] 18%|█▊        | 18/100 [00:02<00:09,  8.78it/s] 19%|█▉        | 19/100 [00:02<00:09,  8.87it/s] 20%|██        | 20/100 [00:02<00:08,  8.93it/s] 21%|██        | 21/100 [00:02<00:08,  8.98it/s] 22%|██▏       | 22/100 [00:02<00:08,  8.82it/s] 23%|██▎       | 23/100 [00:02<00:08,  8.78it/s] 24%|██▍       | 24/100 [00:02<00:08,  8.82it/s] 25%|██▌       | 25/100 [00:02<00:08,  8.61it/s] 26%|██▌       | 26/100 [00:02<00:08,  8.64it/s] 27%|██▋       | 27/100 [00:03<00:08,  8.96it/s] 28%|██▊       | 28/100 [00:03<00:07,  9.05it/s] 29%|██▉       | 29/100 [00:03<00:08,  8.87it/s] 30%|███       | 30/100 [00:03<00:07,  8.96it/s] 31%|███       | 31/100 [00:03<00:07,  8.96it/s] 32%|███▏      | 32/100 [00:03<00:07,  8.81it/s] 33%|███▎      | 33/100 [00:03<00:07,  8.80it/s] 34%|███▍      | 34/100 [00:03<00:07,  8.78it/s] 35%|███▌      | 35/100 [00:03<00:07,  8.34it/s] 36%|███▌      | 36/100 [00:04<00:07,  8.50it/s] 37%|███▋      | 37/100 [00:04<00:07,  8.74it/s] 38%|███▊      | 38/100 [00:04<00:07,  8.75it/s] 39%|███▉      | 39/100 [00:04<00:06,  8.89it/s] 40%|████      | 40/100 [00:04<00:06,  8.89it/s] 41%|████      | 41/100 [00:04<00:06,  8.85it/s] 42%|████▏     | 42/100 [00:04<00:06,  8.90it/s] 43%|████▎     | 43/100 [00:04<00:06,  8.72it/s] 44%|████▍     | 44/100 [00:04<00:06,  8.91it/s] 45%|████▌     | 45/100 [00:05<00:06,  8.51it/s] 46%|████▌     | 46/100 [00:05<00:06,  8.59it/s] 47%|████▋     | 47/100 [00:05<00:06,  8.72it/s] 48%|████▊     | 48/100 [00:05<00:06,  8.58it/s] 49%|████▉     | 49/100 [00:05<00:05,  8.80it/s] 50%|█████     | 50/100 [00:05<00:05,  8.76it/s] 51%|█████     | 51/100 [00:05<00:05,  8.63it/s] 52%|█████▏    | 52/100 [00:05<00:05,  8.72it/s] 53%|█████▎    | 53/100 [00:05<00:05,  8.75it/s] 54%|█████▍    | 54/100 [00:06<00:05,  8.83it/s] 55%|█████▌    | 55/100 [00:06<00:05,  8.59it/s] 56%|█████▌    | 56/100 [00:06<00:05,  8.46it/s] 57%|█████▋    | 57/100 [00:06<00:05,  8.21it/s] 58%|█████▊    | 58/100 [00:06<00:05,  8.24it/s] 59%|█████▉    | 59/100 [00:06<00:04,  8.39it/s] 60%|██████    | 60/100 [00:06<00:04,  8.49it/s] 61%|██████    | 61/100 [00:06<00:04,  8.51it/s] 62%|██████▏   | 62/100 [00:07<00:04,  8.38it/s] 63%|██████▎   | 63/100 [00:07<00:04,  8.44it/s] 64%|██████▍   | 64/100 [00:07<00:04,  8.34it/s] 65%|██████▌   | 65/100 [00:07<00:04,  8.43it/s] 66%|██████▌   | 66/100 [00:07<00:03,  8.52it/s] 67%|██████▋   | 67/100 [00:07<00:03,  8.37it/s] 68%|██████▊   | 68/100 [00:07<00:03,  8.01it/s] 69%|██████▉   | 69/100 [00:07<00:03,  8.02it/s] 70%|███████   | 70/100 [00:08<00:03,  7.91it/s] 71%|███████   | 71/100 [00:08<00:03,  7.82it/s] 72%|███████▏  | 72/100 [00:08<00:03,  7.88it/s] 73%|███████▎  | 73/100 [00:08<00:03,  7.84it/s] 74%|███████▍  | 74/100 [00:08<00:03,  8.05it/s] 75%|███████▌  | 75/100 [00:08<00:03,  8.21it/s] 76%|███████▌  | 76/100 [00:08<00:02,  8.05it/s] 77%|███████▋  | 77/100 [00:08<00:02,  8.28it/s] 78%|███████▊  | 78/100 [00:09<00:02,  8.36it/s] 79%|███████▉  | 79/100 [00:09<00:02,  8.32it/s] 80%|████████  | 80/100 [00:09<00:02,  8.38it/s] 81%|████████  | 81/100 [00:09<00:02,  8.43it/s] 82%|████████▏ | 82/100 [00:09<00:02,  8.36it/s] 83%|████████▎ | 83/100 [00:09<00:02,  8.36it/s] 84%|████████▍ | 84/100 [00:09<00:01,  8.32it/s] 85%|████████▌ | 85/100 [00:09<00:01,  8.15it/s] 86%|████████▌ | 86/100 [00:10<00:01,  8.09it/s] 87%|████████▋ | 87/100 [00:10<00:01,  8.24it/s] 88%|████████▊ | 88/100 [00:10<00:01,  7.94it/s] 89%|████████▉ | 89/100 [00:10<00:01,  7.98it/s] 90%|█████████ | 90/100 [00:10<00:01,  8.02it/s] 91%|█████████ | 91/100 [00:10<00:01,  8.13it/s] 92%|█████████▏| 92/100 [00:10<00:00,  8.18it/s] 93%|█████████▎| 93/100 [00:10<00:00,  8.25it/s] 94%|█████████▍| 94/100 [00:11<00:00,  7.29it/s] 95%|█████████▌| 95/100 [00:11<00:00,  7.59it/s] 96%|█████████▌| 96/100 [00:11<00:00,  7.73it/s] 97%|█████████▋| 97/100 [00:11<00:00,  7.96it/s] 98%|█████████▊| 98/100 [00:11<00:00,  7.94it/s] 99%|█████████▉| 99/100 [00:11<00:00,  8.09it/s]100%|██████████| 100/100 [00:11<00:00,  8.30it/s]100%|██████████| 100/100 [00:11<00:00,  8.50it/s]
eval_p_index len:  19
individual_train 120
individual_eval 19
train data의 x, y, id 길이: 120 120 120
valid data의 x, y, id 길이: 11 11 11
test data의 x, y, id 길이: 8 8 8
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.678030, Valid_loss 0.658142
Epoch 2, Train Loss 0.676944, Valid_loss 0.646318
Epoch 3, Train Loss 0.661551, Valid_loss 0.631076
Epoch 4, Train Loss 0.661012, Valid_loss 0.620313
Epoch 5, Train Loss 0.654845, Valid_loss 0.612307
Epoch 6, Train Loss 0.647315, Valid_loss 0.605110
Epoch 7, Train Loss 0.641211, Valid_loss 0.597261
Epoch 8, Train Loss 0.633332, Valid_loss 0.588518
Epoch 9, Train Loss 0.633097, Valid_loss 0.576325
Epoch 10, Train Loss 0.622350, Valid_loss 0.558817
Epoch 11, Train Loss 0.601310, Valid_loss 0.552410
Epoch 12, Train Loss 0.593311, Valid_loss 0.530657
Epoch 13, Train Loss 0.595461, Valid_loss 0.518590
Epoch 14, Train Loss 0.581935, Valid_loss 0.516096
Epoch 15, Train Loss 0.576299, Valid_loss 0.501626
Epoch 16, Train Loss 0.560036, Valid_loss 0.485863
Epoch 17, Train Loss 0.546023, Valid_loss 0.476543
Epoch 18, Train Loss 0.548588, Valid_loss 0.471521
Epoch 19, Train Loss 0.531437, Valid_loss 0.462729
Epoch 20, Train Loss 0.528963, Valid_loss 0.450642
Epoch 21, Train Loss 0.524146, Valid_loss 0.446183
Epoch 22, Train Loss 0.502999, Valid_loss 0.448080
Epoch 23, Train Loss 0.501499, Valid_loss 0.462776
Epoch 24, Train Loss 0.491477, Valid_loss 0.466888
Epoch 25, Train Loss 0.486249, Valid_loss 0.460740
Epoch 26, Train Loss 0.488369, Valid_loss 0.442531
Epoch 27, Train Loss 0.481404, Valid_loss 0.443267
Epoch 28, Train Loss 0.476085, Valid_loss 0.437204
Epoch 29, Train Loss 0.466403, Valid_loss 0.424659
Epoch 30, Train Loss 0.463334, Valid_loss 0.431632
Epoch 31, Train Loss 0.466784, Valid_loss 0.426029
Epoch 32, Train Loss 0.469512, Valid_loss 0.420139
Epoch 33, Train Loss 0.461427, Valid_loss 0.420307
Epoch 34, Train Loss 0.457426, Valid_loss 0.415472
Epoch 35, Train Loss 0.451531, Valid_loss 0.409566
Epoch 36, Train Loss 0.454294, Valid_loss 0.407621
Epoch 37, Train Loss 0.456356, Valid_loss 0.408449
Epoch 38, Train Loss 0.451804, Valid_loss 0.401818
Epoch 39, Train Loss 0.449983, Valid_loss 0.394475
Epoch 40, Train Loss 0.452649, Valid_loss 0.389640
Epoch 41, Train Loss 0.441970, Valid_loss 0.392151
Epoch 42, Train Loss 0.446296, Valid_loss 0.384358
Epoch 43, Train Loss 0.451777, Valid_loss 0.386787
Epoch 44, Train Loss 0.446654, Valid_loss 0.382967
Epoch 45, Train Loss 0.445359, Valid_loss 0.381030
Epoch 46, Train Loss 0.438514, Valid_loss 0.380441
Epoch 47, Train Loss 0.441483, Valid_loss 0.377004
Epoch 48, Train Loss 0.438299, Valid_loss 0.374927
Epoch 49, Train Loss 0.440998, Valid_loss 0.372699
Epoch 50, Train Loss 0.441069, Valid_loss 0.371640
Epoch 51, Train Loss 0.428853, Valid_loss 0.371011
Epoch 52, Train Loss 0.434042, Valid_loss 0.370015
Epoch 53, Train Loss 0.434070, Valid_loss 0.368173
Epoch 54, Train Loss 0.434464, Valid_loss 0.368154
Epoch 55, Train Loss 0.439145, Valid_loss 0.367830
Epoch 56, Train Loss 0.437330, Valid_loss 0.367696
Epoch 57, Train Loss 0.433033, Valid_loss 0.367476
Epoch 58, Train Loss 0.436033, Valid_loss 0.367269
Epoch 59, Train Loss 0.425194, Valid_loss 0.369403
Epoch 60, Train Loss 0.428860, Valid_loss 0.369437
COVID19_Participant25 -- true: COVID-19 -- pred: COVID-19
COVID19_Participant11 -- true: COVID-19 -- pred: normal
Control_Participant3 -- true: normal -- pred: normal
COVID19_Participant26 -- true: COVID-19 -- pred: COVID-19
Control_Participant7 -- true: normal -- pred: normal
Control_Participant7 -- true: normal -- pred: normal
COVID19_Participant31 -- true: COVID-19 -- pred: normal
COVID19_Participant13 -- true: COVID-19 -- pred: COVID-19
true :  [1, 1, 0, 1, 0, 0, 1, 1]
pred :  [1, 0, 0, 1, 0, 0, 0, 1]
Confusion Matrix: [3 0 2 3]
Best performance: Epoch 58, Loss 0.436033, Test ACC 0.750000, Test AUC 0.866667, Test Recall 0.600000, Test Precision 1.000000
✅ Total valid splits used: 1
🔁 Repeat 2, Fold 1
🔍 Split #2
  → train_p_index 환자 수: 32
  → test_p_index 환자 수: 7
  → train 환자 ID: ['COVID19_Participant11', 'COVID19_Participant12', 'COVID19_Participant13', 'COVID19_Participant14', 'COVID19_Participant15', 'COVID19_Participant17', 'COVID19_Participant18', 'COVID19_Participant19', 'COVID19_Participant2', 'COVID19_Participant20', 'COVID19_Participant22', 'COVID19_Participant25', 'COVID19_Participant28', 'COVID19_Participant29', 'COVID19_Participant3', 'COVID19_Participant30', 'COVID19_Participant31', 'COVID19_Participant32', 'COVID19_Participant39', 'COVID19_Participant4', 'COVID19_Participant40', 'COVID19_Participant7', 'Control_Participant1', 'Control_Participant10', 'Control_Participant11', 'Control_Participant14', 'Control_Participant15', 'Control_Participant5', 'Control_Participant6', 'Control_Participant7', 'Control_Participant8', 'Control_Participant9']
  → test  환자 ID: ['COVID19_Participant19', 'Control_Participant7', 'Control_Participant5', 'COVID19_Participant11', 'Control_Participant5', 'COVID19_Participant13', 'COVID19_Participant13']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant12, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant18, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant3, Label: 1
    ID: COVID19_Participant30, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant10, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant14, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant6, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant8, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: COVID19_Participant19, Label: 1
    ID: Control_Participant7, Label: 1
    ID: Control_Participant5, Label: 1
    ID: COVID19_Participant11, Label: 1
    ID: Control_Participant5, Label: 1
    ID: COVID19_Participant13, Label: 0
    ID: COVID19_Participant13, Label: 0
train_p_index_ 21
valid_p_index 11
test_p_index 7
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Keratinocytes', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Neurons', 'iPS_cells', 'Embryonic_stem_cells', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
data augment 실행 함
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:13,  7.21it/s]  2%|▏         | 2/100 [00:00<00:11,  8.26it/s]  3%|▎         | 3/100 [00:00<00:11,  8.62it/s]  4%|▍         | 4/100 [00:00<00:11,  8.48it/s]  5%|▌         | 5/100 [00:00<00:11,  8.13it/s]  6%|▌         | 6/100 [00:00<00:11,  8.46it/s]  7%|▋         | 7/100 [00:00<00:10,  8.67it/s]  8%|▊         | 8/100 [00:00<00:10,  8.78it/s]  9%|▉         | 9/100 [00:01<00:15,  6.06it/s] 10%|█         | 10/100 [00:01<00:13,  6.70it/s] 11%|█         | 11/100 [00:01<00:12,  7.22it/s] 12%|█▏        | 12/100 [00:01<00:12,  7.10it/s] 13%|█▎        | 13/100 [00:01<00:11,  7.56it/s] 14%|█▍        | 14/100 [00:01<00:11,  7.72it/s] 15%|█▌        | 15/100 [00:01<00:10,  8.09it/s] 16%|█▌        | 16/100 [00:02<00:10,  8.35it/s] 17%|█▋        | 17/100 [00:02<00:09,  8.30it/s] 18%|█▊        | 18/100 [00:02<00:09,  8.66it/s] 19%|█▉        | 19/100 [00:02<00:09,  8.75it/s] 20%|██        | 20/100 [00:02<00:11,  6.82it/s] 21%|██        | 21/100 [00:02<00:11,  7.15it/s] 22%|██▏       | 22/100 [00:02<00:10,  7.60it/s] 23%|██▎       | 23/100 [00:03<00:10,  7.19it/s] 24%|██▍       | 24/100 [00:03<00:09,  7.63it/s] 25%|██▌       | 25/100 [00:03<00:09,  7.78it/s] 26%|██▌       | 26/100 [00:03<00:09,  7.76it/s] 27%|██▋       | 27/100 [00:03<00:09,  7.49it/s] 28%|██▊       | 28/100 [00:03<00:09,  7.68it/s] 29%|██▉       | 29/100 [00:03<00:08,  8.03it/s] 30%|███       | 30/100 [00:03<00:08,  8.32it/s] 31%|███       | 31/100 [00:03<00:08,  8.32it/s] 32%|███▏      | 32/100 [00:04<00:08,  8.31it/s] 33%|███▎      | 33/100 [00:04<00:07,  8.56it/s] 34%|███▍      | 34/100 [00:04<00:07,  8.60it/s] 35%|███▌      | 35/100 [00:04<00:08,  8.10it/s] 36%|███▌      | 36/100 [00:04<00:07,  8.44it/s] 37%|███▋      | 37/100 [00:04<00:07,  8.17it/s] 38%|███▊      | 38/100 [00:04<00:07,  8.14it/s] 39%|███▉      | 39/100 [00:04<00:07,  8.21it/s] 40%|████      | 40/100 [00:05<00:07,  8.44it/s] 41%|████      | 41/100 [00:05<00:06,  8.51it/s] 42%|████▏     | 42/100 [00:05<00:06,  8.36it/s] 43%|████▎     | 43/100 [00:05<00:06,  8.34it/s] 44%|████▍     | 44/100 [00:05<00:06,  8.46it/s] 45%|████▌     | 45/100 [00:05<00:06,  8.47it/s] 46%|████▌     | 46/100 [00:05<00:06,  8.26it/s] 47%|████▋     | 47/100 [00:05<00:06,  7.86it/s] 48%|████▊     | 48/100 [00:06<00:06,  7.77it/s] 49%|████▉     | 49/100 [00:06<00:06,  8.06it/s] 50%|█████     | 50/100 [00:06<00:06,  8.09it/s] 51%|█████     | 51/100 [00:06<00:06,  7.98it/s] 52%|█████▏    | 52/100 [00:06<00:06,  7.96it/s] 53%|█████▎    | 53/100 [00:06<00:07,  5.89it/s] 54%|█████▍    | 54/100 [00:06<00:07,  6.32it/s] 55%|█████▌    | 55/100 [00:07<00:06,  6.85it/s] 56%|█████▌    | 56/100 [00:07<00:06,  7.10it/s] 57%|█████▋    | 57/100 [00:07<00:05,  7.28it/s] 58%|█████▊    | 58/100 [00:07<00:05,  7.60it/s] 59%|█████▉    | 59/100 [00:07<00:05,  7.36it/s] 60%|██████    | 60/100 [00:07<00:05,  7.72it/s] 61%|██████    | 61/100 [00:07<00:06,  5.99it/s] 62%|██████▏   | 62/100 [00:08<00:05,  6.51it/s] 63%|██████▎   | 63/100 [00:08<00:05,  6.91it/s] 64%|██████▍   | 64/100 [00:08<00:04,  7.25it/s] 65%|██████▌   | 65/100 [00:08<00:04,  7.48it/s] 66%|██████▌   | 66/100 [00:08<00:04,  7.74it/s] 67%|██████▋   | 67/100 [00:08<00:04,  7.82it/s] 68%|██████▊   | 68/100 [00:08<00:04,  7.67it/s] 69%|██████▉   | 69/100 [00:08<00:04,  7.68it/s] 70%|███████   | 70/100 [00:09<00:03,  7.69it/s] 71%|███████   | 71/100 [00:09<00:03,  7.62it/s] 72%|███████▏  | 72/100 [00:09<00:03,  7.93it/s] 73%|███████▎  | 73/100 [00:09<00:03,  7.75it/s] 74%|███████▍  | 74/100 [00:09<00:03,  7.90it/s] 75%|███████▌  | 75/100 [00:09<00:03,  7.96it/s] 76%|███████▌  | 76/100 [00:09<00:02,  8.07it/s] 77%|███████▋  | 77/100 [00:09<00:02,  8.13it/s] 78%|███████▊  | 78/100 [00:10<00:02,  7.92it/s] 79%|███████▉  | 79/100 [00:10<00:02,  8.11it/s] 80%|████████  | 80/100 [00:10<00:02,  8.14it/s] 81%|████████  | 81/100 [00:10<00:02,  7.44it/s] 82%|████████▏ | 82/100 [00:10<00:02,  7.36it/s] 83%|████████▎ | 83/100 [00:10<00:02,  7.50it/s] 84%|████████▍ | 84/100 [00:10<00:02,  7.35it/s] 85%|████████▌ | 85/100 [00:11<00:01,  7.55it/s] 86%|████████▌ | 86/100 [00:11<00:01,  7.65it/s] 87%|████████▋ | 87/100 [00:11<00:01,  7.62it/s] 88%|████████▊ | 88/100 [00:11<00:01,  7.74it/s] 89%|████████▉ | 89/100 [00:11<00:01,  8.04it/s] 90%|█████████ | 90/100 [00:11<00:01,  7.92it/s] 91%|█████████ | 91/100 [00:11<00:01,  7.93it/s] 92%|█████████▏| 92/100 [00:11<00:01,  7.91it/s] 93%|█████████▎| 93/100 [00:12<00:00,  7.91it/s] 94%|█████████▍| 94/100 [00:12<00:00,  7.74it/s] 95%|█████████▌| 95/100 [00:12<00:00,  7.80it/s] 96%|█████████▌| 96/100 [00:12<00:00,  6.40it/s] 97%|█████████▋| 97/100 [00:12<00:00,  6.60it/s] 98%|█████████▊| 98/100 [00:12<00:00,  7.04it/s] 99%|█████████▉| 99/100 [00:12<00:00,  6.99it/s]100%|██████████| 100/100 [00:13<00:00,  7.30it/s]100%|██████████| 100/100 [00:13<00:00,  7.67it/s]
eval_p_index len:  18
individual_train 121
individual_eval 18
train data의 x, y, id 길이: 121 121 121
valid data의 x, y, id 길이: 11 11 11
test data의 x, y, id 길이: 7 7 7
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.846220, Valid_loss 0.913670
Epoch 2, Train Loss 0.831677, Valid_loss 0.891146
Epoch 3, Train Loss 0.810929, Valid_loss 0.866866
Epoch 4, Train Loss 0.783592, Valid_loss 0.824363
Epoch 5, Train Loss 0.742746, Valid_loss 0.766974
Epoch 6, Train Loss 0.720525, Valid_loss 0.733560
Epoch 7, Train Loss 0.688148, Valid_loss 0.716333
Epoch 8, Train Loss 0.663288, Valid_loss 0.687311
Epoch 9, Train Loss 0.650619, Valid_loss 0.663353
Epoch 10, Train Loss 0.640489, Valid_loss 0.653994
Epoch 11, Train Loss 0.630940, Valid_loss 0.659666
Epoch 12, Train Loss 0.616863, Valid_loss 0.651626
Epoch 13, Train Loss 0.616592, Valid_loss 0.643982
Epoch 14, Train Loss 0.601327, Valid_loss 0.638169
Epoch 15, Train Loss 0.595746, Valid_loss 0.635950
Epoch 16, Train Loss 0.586847, Valid_loss 0.629382
Epoch 17, Train Loss 0.592395, Valid_loss 0.625669
Epoch 18, Train Loss 0.581304, Valid_loss 0.622780
Epoch 19, Train Loss 0.572877, Valid_loss 0.615480
Epoch 20, Train Loss 0.569159, Valid_loss 0.616018
Epoch 21, Train Loss 0.570517, Valid_loss 0.611319
Epoch 22, Train Loss 0.563539, Valid_loss 0.612221
Epoch 23, Train Loss 0.563984, Valid_loss 0.611358
Epoch 24, Train Loss 0.553405, Valid_loss 0.606315
Epoch 25, Train Loss 0.554641, Valid_loss 0.606480
Epoch 26, Train Loss 0.552798, Valid_loss 0.604630
Epoch 27, Train Loss 0.555240, Valid_loss 0.602013
Epoch 28, Train Loss 0.548184, Valid_loss 0.599620
Epoch 29, Train Loss 0.552376, Valid_loss 0.598802
Epoch 30, Train Loss 0.545126, Valid_loss 0.596347
Epoch 31, Train Loss 0.549657, Valid_loss 0.591910
Epoch 32, Train Loss 0.545117, Valid_loss 0.594156
Epoch 33, Train Loss 0.544717, Valid_loss 0.588178
Epoch 34, Train Loss 0.543050, Valid_loss 0.591495
Epoch 35, Train Loss 0.543468, Valid_loss 0.584067
Epoch 36, Train Loss 0.546671, Valid_loss 0.583551
Epoch 37, Train Loss 0.532736, Valid_loss 0.584692
Epoch 38, Train Loss 0.532353, Valid_loss 0.582801
Epoch 39, Train Loss 0.543515, Valid_loss 0.579812
Epoch 40, Train Loss 0.536379, Valid_loss 0.580458
Epoch 41, Train Loss 0.536222, Valid_loss 0.579880
Epoch 42, Train Loss 0.524054, Valid_loss 0.578142
Epoch 43, Train Loss 0.527595, Valid_loss 0.577518
Epoch 44, Train Loss 0.529095, Valid_loss 0.575476
Epoch 45, Train Loss 0.527906, Valid_loss 0.574087
Epoch 46, Train Loss 0.526100, Valid_loss 0.573523
Epoch 47, Train Loss 0.523821, Valid_loss 0.572965
Epoch 48, Train Loss 0.523412, Valid_loss 0.569415
Epoch 49, Train Loss 0.520462, Valid_loss 0.570962
Epoch 50, Train Loss 0.520827, Valid_loss 0.568597
Epoch 51, Train Loss 0.512638, Valid_loss 0.566994
Epoch 52, Train Loss 0.520316, Valid_loss 0.567361
Epoch 53, Train Loss 0.520178, Valid_loss 0.568864
COVID19_Participant19 -- true: COVID-19 -- pred: COVID-19
Control_Participant7 -- true: normal -- pred: normal
Control_Participant5 -- true: normal -- pred: COVID-19
COVID19_Participant11 -- true: COVID-19 -- pred: normal
Control_Participant5 -- true: normal -- pred: normal
COVID19_Participant13 -- true: COVID-19 -- pred: COVID-19
COVID19_Participant13 -- true: COVID-19 -- pred: COVID-19
true :  [1, 0, 0, 1, 0, 1, 1]
pred :  [1, 0, 1, 0, 0, 1, 1]
Confusion Matrix: [2 1 1 3]
Best performance: Epoch 51, Loss 0.512638, Test ACC 0.714286, Test AUC 0.916667, Test Recall 0.750000, Test Precision 0.750000
✅ Total valid splits used: 2
🔁 Repeat 2, Fold 2
🔍 Split #3
  → train_p_index 환자 수: 32
  → test_p_index 환자 수: 7
  → train 환자 ID: ['COVID19_Participant11', 'COVID19_Participant12', 'COVID19_Participant13', 'COVID19_Participant14', 'COVID19_Participant18', 'COVID19_Participant19', 'COVID19_Participant2', 'COVID19_Participant20', 'COVID19_Participant23', 'COVID19_Participant25', 'COVID19_Participant26', 'COVID19_Participant29', 'COVID19_Participant30', 'COVID19_Participant31', 'COVID19_Participant36', 'COVID19_Participant37', 'COVID19_Participant39', 'COVID19_Participant4', 'COVID19_Participant40', 'COVID19_Participant7', 'COVID19_Participant8', 'Control_Participant1', 'Control_Participant10', 'Control_Participant11', 'Control_Participant14', 'Control_Participant15', 'Control_Participant3', 'Control_Participant4', 'Control_Participant5', 'Control_Participant7', 'Control_Participant8', 'Control_Participant9']
  → test  환자 ID: ['Control_Participant5', 'COVID19_Participant13', 'COVID19_Participant5', 'Control_Participant7', 'Control_Participant7', 'Control_Participant4', 'COVID19_Participant10']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant12, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant18, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant30, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant36, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant10, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant14, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant4, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant8, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: Control_Participant5, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant5, Label: 1
    ID: Control_Participant7, Label: 1
    ID: Control_Participant7, Label: 1
    ID: Control_Participant4, Label: 1
    ID: COVID19_Participant10, Label: 0
train_p_index_ 21
valid_p_index 11
test_p_index 7
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Keratinocytes', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Neurons', 'iPS_cells', 'Embryonic_stem_cells', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
data augment 실행 함
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:11,  8.79it/s]  2%|▏         | 2/100 [00:00<00:11,  8.87it/s]  3%|▎         | 3/100 [00:00<00:10,  8.89it/s]  4%|▍         | 4/100 [00:00<00:10,  8.89it/s]  5%|▌         | 5/100 [00:00<00:10,  8.67it/s]  6%|▌         | 6/100 [00:00<00:10,  8.64it/s]  7%|▋         | 7/100 [00:00<00:11,  7.87it/s]  8%|▊         | 8/100 [00:00<00:11,  8.18it/s]  9%|▉         | 9/100 [00:01<00:11,  7.70it/s] 10%|█         | 10/100 [00:01<00:11,  8.11it/s] 11%|█         | 11/100 [00:01<00:10,  8.26it/s] 12%|█▏        | 12/100 [00:01<00:10,  8.38it/s] 13%|█▎        | 13/100 [00:01<00:10,  8.31it/s] 14%|█▍        | 14/100 [00:01<00:10,  8.57it/s] 15%|█▌        | 15/100 [00:01<00:10,  8.40it/s] 16%|█▌        | 16/100 [00:01<00:09,  8.80it/s] 17%|█▋        | 17/100 [00:01<00:09,  8.98it/s] 18%|█▊        | 18/100 [00:02<00:09,  8.98it/s] 19%|█▉        | 19/100 [00:02<00:08,  9.05it/s] 20%|██        | 20/100 [00:02<00:08,  8.96it/s] 21%|██        | 21/100 [00:02<00:08,  9.11it/s] 22%|██▏       | 22/100 [00:02<00:08,  9.02it/s] 23%|██▎       | 23/100 [00:02<00:08,  8.95it/s] 24%|██▍       | 24/100 [00:02<00:08,  9.11it/s] 25%|██▌       | 25/100 [00:02<00:08,  9.14it/s] 26%|██▌       | 26/100 [00:02<00:08,  9.04it/s] 27%|██▋       | 27/100 [00:03<00:08,  8.72it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.80it/s] 29%|██▉       | 29/100 [00:03<00:08,  8.69it/s] 30%|███       | 30/100 [00:03<00:08,  8.66it/s] 31%|███       | 31/100 [00:03<00:08,  8.49it/s] 32%|███▏      | 32/100 [00:03<00:07,  8.65it/s] 33%|███▎      | 33/100 [00:03<00:08,  7.86it/s] 34%|███▍      | 34/100 [00:03<00:08,  8.06it/s] 35%|███▌      | 35/100 [00:04<00:07,  8.17it/s] 36%|███▌      | 36/100 [00:04<00:08,  7.66it/s] 37%|███▋      | 37/100 [00:04<00:08,  7.73it/s] 38%|███▊      | 38/100 [00:04<00:08,  7.68it/s] 39%|███▉      | 39/100 [00:04<00:07,  7.96it/s] 40%|████      | 40/100 [00:04<00:07,  7.66it/s] 41%|████      | 41/100 [00:04<00:07,  7.71it/s] 42%|████▏     | 42/100 [00:05<00:07,  7.67it/s] 43%|████▎     | 43/100 [00:05<00:07,  7.79it/s] 44%|████▍     | 44/100 [00:05<00:07,  7.88it/s] 45%|████▌     | 45/100 [00:05<00:07,  7.08it/s] 46%|████▌     | 46/100 [00:05<00:06,  7.73it/s] 47%|████▋     | 47/100 [00:05<00:06,  7.71it/s] 48%|████▊     | 48/100 [00:05<00:06,  7.88it/s] 49%|████▉     | 49/100 [00:05<00:06,  8.09it/s] 50%|█████     | 50/100 [00:06<00:06,  8.25it/s] 51%|█████     | 51/100 [00:06<00:05,  8.42it/s] 52%|█████▏    | 52/100 [00:06<00:05,  8.40it/s] 53%|█████▎    | 53/100 [00:06<00:05,  8.24it/s] 54%|█████▍    | 54/100 [00:06<00:05,  8.20it/s] 55%|█████▌    | 55/100 [00:06<00:05,  8.31it/s] 56%|█████▌    | 56/100 [00:06<00:05,  8.34it/s] 57%|█████▋    | 57/100 [00:06<00:05,  8.25it/s] 58%|█████▊    | 58/100 [00:06<00:05,  8.33it/s] 59%|█████▉    | 59/100 [00:07<00:05,  8.16it/s] 60%|██████    | 60/100 [00:07<00:04,  8.14it/s] 61%|██████    | 61/100 [00:07<00:04,  8.10it/s] 62%|██████▏   | 62/100 [00:07<00:04,  8.02it/s] 63%|██████▎   | 63/100 [00:07<00:04,  8.29it/s] 64%|██████▍   | 64/100 [00:07<00:04,  8.31it/s] 65%|██████▌   | 65/100 [00:07<00:04,  8.31it/s] 66%|██████▌   | 66/100 [00:07<00:04,  8.26it/s] 67%|██████▋   | 67/100 [00:08<00:04,  8.13it/s] 68%|██████▊   | 68/100 [00:08<00:03,  8.10it/s] 69%|██████▉   | 69/100 [00:08<00:03,  8.15it/s] 70%|███████   | 70/100 [00:08<00:03,  8.22it/s] 71%|███████   | 71/100 [00:08<00:03,  7.84it/s] 72%|███████▏  | 72/100 [00:08<00:03,  7.85it/s] 73%|███████▎  | 73/100 [00:08<00:03,  7.48it/s] 74%|███████▍  | 74/100 [00:08<00:03,  7.66it/s] 75%|███████▌  | 75/100 [00:09<00:03,  7.90it/s] 76%|███████▌  | 76/100 [00:09<00:03,  7.82it/s] 77%|███████▋  | 77/100 [00:09<00:02,  8.15it/s] 78%|███████▊  | 78/100 [00:09<00:02,  8.19it/s] 79%|███████▉  | 79/100 [00:09<00:02,  8.24it/s] 80%|████████  | 80/100 [00:09<00:02,  8.25it/s] 81%|████████  | 81/100 [00:09<00:02,  8.26it/s] 82%|████████▏ | 82/100 [00:09<00:02,  7.90it/s] 83%|████████▎ | 83/100 [00:10<00:02,  8.01it/s] 84%|████████▍ | 84/100 [00:10<00:02,  6.09it/s] 85%|████████▌ | 85/100 [00:10<00:02,  6.64it/s] 86%|████████▌ | 86/100 [00:10<00:02,  6.98it/s] 87%|████████▋ | 87/100 [00:10<00:01,  6.72it/s] 88%|████████▊ | 88/100 [00:10<00:01,  6.97it/s] 89%|████████▉ | 89/100 [00:11<00:01,  7.05it/s] 90%|█████████ | 90/100 [00:11<00:01,  7.29it/s] 91%|█████████ | 91/100 [00:11<00:01,  6.67it/s] 92%|█████████▏| 92/100 [00:11<00:01,  7.03it/s] 93%|█████████▎| 93/100 [00:11<00:00,  7.21it/s] 94%|█████████▍| 94/100 [00:11<00:00,  7.68it/s] 95%|█████████▌| 95/100 [00:11<00:00,  7.98it/s] 96%|█████████▌| 96/100 [00:11<00:00,  7.96it/s] 97%|█████████▋| 97/100 [00:12<00:00,  7.87it/s] 98%|█████████▊| 98/100 [00:12<00:00,  7.82it/s] 99%|█████████▉| 99/100 [00:12<00:00,  7.06it/s]100%|██████████| 100/100 [00:12<00:00,  7.42it/s]100%|██████████| 100/100 [00:12<00:00,  8.01it/s]
eval_p_index len:  18
individual_train 121
individual_eval 18
train data의 x, y, id 길이: 121 121 121
valid data의 x, y, id 길이: 11 11 11
test data의 x, y, id 길이: 7 7 7
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.670198, Valid_loss 0.640068
Epoch 2, Train Loss 0.661605, Valid_loss 0.624131
Epoch 3, Train Loss 0.649157, Valid_loss 0.615893
Epoch 4, Train Loss 0.627999, Valid_loss 0.603314
Epoch 5, Train Loss 0.606193, Valid_loss 0.590443
Epoch 6, Train Loss 0.592209, Valid_loss 0.563778
Epoch 7, Train Loss 0.574986, Valid_loss 0.556520
Epoch 8, Train Loss 0.563387, Valid_loss 0.540937
Epoch 9, Train Loss 0.555944, Valid_loss 0.525188
Epoch 10, Train Loss 0.553532, Valid_loss 0.520168
Epoch 11, Train Loss 0.553399, Valid_loss 0.514938
Epoch 12, Train Loss 0.548957, Valid_loss 0.515906
Epoch 13, Train Loss 0.547783, Valid_loss 0.512360
Epoch 14, Train Loss 0.545050, Valid_loss 0.504630
Epoch 15, Train Loss 0.543660, Valid_loss 0.503662
Epoch 16, Train Loss 0.540573, Valid_loss 0.501333
Epoch 17, Train Loss 0.538666, Valid_loss 0.496388
Epoch 18, Train Loss 0.531462, Valid_loss 0.499820
Epoch 19, Train Loss 0.528257, Valid_loss 0.493203
Epoch 20, Train Loss 0.536333, Valid_loss 0.493548
Epoch 21, Train Loss 0.529389, Valid_loss 0.491863
Epoch 22, Train Loss 0.527604, Valid_loss 0.491441
Epoch 23, Train Loss 0.528465, Valid_loss 0.499326
Epoch 24, Train Loss 0.526266, Valid_loss 0.485497
Epoch 25, Train Loss 0.525611, Valid_loss 0.494368
Epoch 26, Train Loss 0.526647, Valid_loss 0.484501
Epoch 27, Train Loss 0.523689, Valid_loss 0.489435
Epoch 28, Train Loss 0.514535, Valid_loss 0.493808
Epoch 29, Train Loss 0.513733, Valid_loss 0.487248
Epoch 30, Train Loss 0.517129, Valid_loss 0.490750
Epoch 31, Train Loss 0.511801, Valid_loss 0.480500
Epoch 32, Train Loss 0.516778, Valid_loss 0.481875
Epoch 33, Train Loss 0.510841, Valid_loss 0.488075
Epoch 34, Train Loss 0.511346, Valid_loss 0.493773
Epoch 35, Train Loss 0.515946, Valid_loss 0.488215
Epoch 36, Train Loss 0.515527, Valid_loss 0.489646
Epoch 37, Train Loss 0.508223, Valid_loss 0.485908
Epoch 38, Train Loss 0.512823, Valid_loss 0.491548
Epoch 39, Train Loss 0.502322, Valid_loss 0.502193
Epoch 40, Train Loss 0.515539, Valid_loss 0.489958
Epoch 41, Train Loss 0.503402, Valid_loss 0.506783
Epoch 42, Train Loss 0.502553, Valid_loss 0.497473
Epoch 43, Train Loss 0.510034, Valid_loss 0.498181
Epoch 44, Train Loss 0.507472, Valid_loss 0.500057
Epoch 45, Train Loss 0.504448, Valid_loss 0.514793
Epoch 46, Train Loss 0.499436, Valid_loss 0.512509
Epoch 47, Train Loss 0.500397, Valid_loss 0.498635
Epoch 48, Train Loss 0.495683, Valid_loss 0.509493
Epoch 49, Train Loss 0.503424, Valid_loss 0.510336
Epoch 50, Train Loss 0.499483, Valid_loss 0.507407
Epoch 51, Train Loss 0.496361, Valid_loss 0.504250
Epoch 52, Train Loss 0.490369, Valid_loss 0.509334
Epoch 53, Train Loss 0.500192, Valid_loss 0.505915
Epoch 54, Train Loss 0.492809, Valid_loss 0.513074
Epoch 55, Train Loss 0.492235, Valid_loss 0.511339
Epoch 56, Train Loss 0.494438, Valid_loss 0.510795
Epoch 57, Train Loss 0.492289, Valid_loss 0.513302
Epoch 58, Train Loss 0.494762, Valid_loss 0.508839
Epoch 59, Train Loss 0.494033, Valid_loss 0.506302
Epoch 60, Train Loss 0.495301, Valid_loss 0.504428
Epoch 61, Train Loss 0.493206, Valid_loss 0.508915
Epoch 62, Train Loss 0.488830, Valid_loss 0.512419
Control_Participant5 -- true: normal -- pred: normal
COVID19_Participant13 -- true: COVID-19 -- pred: COVID-19
COVID19_Participant5 -- true: COVID-19 -- pred: COVID-19
Control_Participant7 -- true: normal -- pred: COVID-19
Control_Participant7 -- true: normal -- pred: normal
Control_Participant4 -- true: normal -- pred: normal
COVID19_Participant10 -- true: COVID-19 -- pred: normal
true :  [0, 1, 1, 0, 0, 0, 1]
pred :  [0, 1, 1, 1, 0, 0, 0]
Confusion Matrix: [3 1 1 2]
Best performance: Epoch 31, Loss 0.511801, Test ACC 0.714286, Test AUC 0.750000, Test Recall 0.666667, Test Precision 0.666667
✅ Total valid splits used: 3
🔁 Repeat 2, Fold 3
🔍 Split #4
  → train_p_index 환자 수: 29
  → test_p_index 환자 수: 10
  → train 환자 ID: ['COVID19_Participant12', 'COVID19_Participant13', 'COVID19_Participant15', 'COVID19_Participant17', 'COVID19_Participant20', 'COVID19_Participant22', 'COVID19_Participant23', 'COVID19_Participant26', 'COVID19_Participant28', 'COVID19_Participant29', 'COVID19_Participant3', 'COVID19_Participant30', 'COVID19_Participant32', 'COVID19_Participant36', 'COVID19_Participant37', 'COVID19_Participant39', 'COVID19_Participant4', 'COVID19_Participant40', 'COVID19_Participant7', 'COVID19_Participant8', 'Control_Participant11', 'Control_Participant14', 'Control_Participant15', 'Control_Participant3', 'Control_Participant4', 'Control_Participant5', 'Control_Participant6', 'Control_Participant8', 'Control_Participant9']
  → test  환자 ID: ['COVID19_Participant26', 'Control_Participant3', 'COVID19_Participant8', 'COVID19_Participant7', 'Control_Participant9', 'COVID19_Participant26', 'Control_Participant12', 'Control_Participant4', 'Control_Participant5', 'COVID19_Participant13']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant12, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant3, Label: 1
    ID: COVID19_Participant30, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant36, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: Control_Participant11, Label: 0
    ID: Control_Participant14, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant4, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant6, Label: 0
    ID: Control_Participant8, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: COVID19_Participant26, Label: 1
    ID: Control_Participant3, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: Control_Participant9, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: Control_Participant12, Label: 1
    ID: Control_Participant4, Label: 0
    ID: Control_Participant5, Label: 0
    ID: COVID19_Participant13, Label: 0
train_p_index_ 19
valid_p_index 10
test_p_index 10
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Epithelial_cells', 'Platelets', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Keratinocytes', 'Macrophage', 'Epithelial_cells', 'B_cell', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
data augment 실행 함
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:13,  7.22it/s]  2%|▏         | 2/100 [00:00<00:12,  7.83it/s]  3%|▎         | 3/100 [00:00<00:12,  7.82it/s]  4%|▍         | 4/100 [00:00<00:11,  8.30it/s]  5%|▌         | 5/100 [00:00<00:11,  8.39it/s]  6%|▌         | 6/100 [00:00<00:11,  8.51it/s]  7%|▋         | 7/100 [00:00<00:10,  8.71it/s]  8%|▊         | 8/100 [00:00<00:10,  8.73it/s]  9%|▉         | 9/100 [00:01<00:10,  8.54it/s] 10%|█         | 10/100 [00:01<00:10,  8.52it/s] 11%|█         | 11/100 [00:01<00:10,  8.68it/s] 12%|█▏        | 12/100 [00:01<00:11,  7.94it/s] 13%|█▎        | 13/100 [00:01<00:10,  8.25it/s] 14%|█▍        | 14/100 [00:01<00:10,  8.36it/s] 15%|█▌        | 15/100 [00:01<00:09,  8.56it/s] 16%|█▌        | 16/100 [00:01<00:09,  8.72it/s] 17%|█▋        | 17/100 [00:02<00:09,  8.39it/s] 18%|█▊        | 18/100 [00:02<00:09,  8.65it/s] 19%|█▉        | 19/100 [00:02<00:09,  8.54it/s] 20%|██        | 20/100 [00:02<00:09,  8.40it/s] 21%|██        | 21/100 [00:02<00:09,  8.40it/s] 22%|██▏       | 22/100 [00:02<00:09,  8.48it/s] 23%|██▎       | 23/100 [00:02<00:08,  8.74it/s] 24%|██▍       | 24/100 [00:02<00:08,  8.82it/s] 25%|██▌       | 25/100 [00:02<00:08,  8.85it/s] 26%|██▌       | 26/100 [00:03<00:08,  8.72it/s] 27%|██▋       | 27/100 [00:03<00:08,  8.72it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.49it/s] 29%|██▉       | 29/100 [00:03<00:08,  8.42it/s] 30%|███       | 30/100 [00:03<00:08,  8.55it/s] 31%|███       | 31/100 [00:03<00:08,  8.52it/s] 32%|███▏      | 32/100 [00:03<00:07,  8.59it/s] 33%|███▎      | 33/100 [00:03<00:07,  8.51it/s] 34%|███▍      | 34/100 [00:04<00:07,  8.53it/s] 35%|███▌      | 35/100 [00:04<00:07,  8.49it/s] 36%|███▌      | 36/100 [00:04<00:07,  8.44it/s] 37%|███▋      | 37/100 [00:04<00:07,  8.03it/s] 38%|███▊      | 38/100 [00:04<00:07,  8.14it/s] 39%|███▉      | 39/100 [00:04<00:07,  8.28it/s] 40%|████      | 40/100 [00:04<00:07,  8.28it/s] 41%|████      | 41/100 [00:04<00:07,  8.34it/s] 42%|████▏     | 42/100 [00:04<00:07,  8.25it/s] 43%|████▎     | 43/100 [00:05<00:06,  8.25it/s] 44%|████▍     | 44/100 [00:05<00:06,  8.32it/s] 45%|████▌     | 45/100 [00:05<00:06,  8.00it/s] 46%|████▌     | 46/100 [00:05<00:06,  8.01it/s] 47%|████▋     | 47/100 [00:05<00:06,  8.14it/s] 48%|████▊     | 48/100 [00:05<00:06,  8.11it/s] 49%|████▉     | 49/100 [00:05<00:06,  7.96it/s] 50%|█████     | 50/100 [00:05<00:06,  8.23it/s] 51%|█████     | 51/100 [00:06<00:06,  8.12it/s] 52%|█████▏    | 52/100 [00:06<00:05,  8.03it/s] 53%|█████▎    | 53/100 [00:06<00:05,  7.99it/s] 54%|█████▍    | 54/100 [00:06<00:05,  8.10it/s] 55%|█████▌    | 55/100 [00:06<00:05,  8.18it/s] 56%|█████▌    | 56/100 [00:06<00:05,  8.18it/s] 57%|█████▋    | 57/100 [00:06<00:05,  8.26it/s] 58%|█████▊    | 58/100 [00:06<00:05,  8.21it/s] 59%|█████▉    | 59/100 [00:07<00:06,  6.24it/s] 60%|██████    | 60/100 [00:07<00:05,  6.86it/s] 61%|██████    | 61/100 [00:07<00:05,  7.27it/s] 62%|██████▏   | 62/100 [00:07<00:04,  7.90it/s] 63%|██████▎   | 63/100 [00:07<00:04,  7.90it/s] 64%|██████▍   | 64/100 [00:07<00:04,  8.17it/s] 65%|██████▌   | 65/100 [00:07<00:04,  8.10it/s] 66%|██████▌   | 66/100 [00:08<00:04,  8.11it/s] 67%|██████▋   | 67/100 [00:08<00:03,  8.38it/s] 68%|██████▊   | 68/100 [00:08<00:03,  8.20it/s] 69%|██████▉   | 69/100 [00:08<00:03,  8.15it/s] 70%|███████   | 70/100 [00:08<00:04,  7.36it/s] 71%|███████   | 71/100 [00:08<00:03,  7.45it/s] 72%|███████▏  | 72/100 [00:08<00:03,  7.65it/s] 73%|███████▎  | 73/100 [00:08<00:03,  7.75it/s] 74%|███████▍  | 74/100 [00:09<00:03,  7.80it/s] 75%|███████▌  | 75/100 [00:09<00:03,  7.78it/s] 76%|███████▌  | 76/100 [00:09<00:03,  7.91it/s] 77%|███████▋  | 77/100 [00:09<00:02,  7.87it/s] 78%|███████▊  | 78/100 [00:09<00:02,  7.96it/s] 79%|███████▉  | 79/100 [00:09<00:02,  7.84it/s] 80%|████████  | 80/100 [00:09<00:02,  7.97it/s] 81%|████████  | 81/100 [00:09<00:02,  8.01it/s] 82%|████████▏ | 82/100 [00:10<00:02,  8.02it/s] 83%|████████▎ | 83/100 [00:10<00:02,  7.86it/s] 84%|████████▍ | 84/100 [00:10<00:02,  7.90it/s] 85%|████████▌ | 85/100 [00:10<00:01,  7.98it/s] 86%|████████▌ | 86/100 [00:10<00:01,  7.48it/s] 87%|████████▋ | 87/100 [00:10<00:01,  7.74it/s] 88%|████████▊ | 88/100 [00:10<00:01,  7.52it/s] 89%|████████▉ | 89/100 [00:10<00:01,  7.47it/s] 90%|█████████ | 90/100 [00:11<00:01,  7.62it/s] 91%|█████████ | 91/100 [00:11<00:01,  7.67it/s] 92%|█████████▏| 92/100 [00:11<00:01,  7.40it/s] 93%|█████████▎| 93/100 [00:11<00:00,  7.51it/s] 94%|█████████▍| 94/100 [00:11<00:00,  7.59it/s] 95%|█████████▌| 95/100 [00:11<00:00,  7.76it/s] 96%|█████████▌| 96/100 [00:11<00:00,  7.57it/s] 97%|█████████▋| 97/100 [00:12<00:00,  6.37it/s] 98%|█████████▊| 98/100 [00:12<00:00,  6.81it/s] 99%|█████████▉| 99/100 [00:12<00:00,  7.11it/s]100%|██████████| 100/100 [00:12<00:00,  7.43it/s]100%|██████████| 100/100 [00:12<00:00,  8.01it/s]
eval_p_index len:  20
individual_train 119
individual_eval 20
train data의 x, y, id 길이: 119 119 119
valid data의 x, y, id 길이: 10 10 10
test data의 x, y, id 길이: 10 10 10
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.587561, Valid_loss 0.719365
Epoch 2, Train Loss 0.562726, Valid_loss 0.713681
Epoch 3, Train Loss 0.571926, Valid_loss 0.697450
Epoch 4, Train Loss 0.553777, Valid_loss 0.663137
Epoch 5, Train Loss 0.525786, Valid_loss 0.612405
Epoch 6, Train Loss 0.493406, Valid_loss 0.568978
Epoch 7, Train Loss 0.457475, Valid_loss 0.558989
Epoch 8, Train Loss 0.441898, Valid_loss 0.546971
Epoch 9, Train Loss 0.443208, Valid_loss 0.539669
Epoch 10, Train Loss 0.429354, Valid_loss 0.500240
Epoch 11, Train Loss 0.433339, Valid_loss 0.517269
Epoch 12, Train Loss 0.429527, Valid_loss 0.498395
Epoch 13, Train Loss 0.423386, Valid_loss 0.495443
Epoch 14, Train Loss 0.410110, Valid_loss 0.506975
Epoch 15, Train Loss 0.410776, Valid_loss 0.495767
Epoch 16, Train Loss 0.404299, Valid_loss 0.499285
Epoch 17, Train Loss 0.409941, Valid_loss 0.497344
Epoch 18, Train Loss 0.413304, Valid_loss 0.492484
Epoch 19, Train Loss 0.407113, Valid_loss 0.495473
Epoch 20, Train Loss 0.405895, Valid_loss 0.486389
Epoch 21, Train Loss 0.405069, Valid_loss 0.484254
Epoch 22, Train Loss 0.396665, Valid_loss 0.483996
Epoch 23, Train Loss 0.396396, Valid_loss 0.479464
Epoch 24, Train Loss 0.399890, Valid_loss 0.482277
Epoch 25, Train Loss 0.404577, Valid_loss 0.480379
Epoch 26, Train Loss 0.393457, Valid_loss 0.458470
Epoch 27, Train Loss 0.392531, Valid_loss 0.482566
Epoch 28, Train Loss 0.394900, Valid_loss 0.464374
Epoch 29, Train Loss 0.385064, Valid_loss 0.478230
Epoch 30, Train Loss 0.385995, Valid_loss 0.456373
Epoch 31, Train Loss 0.393678, Valid_loss 0.468608
Epoch 32, Train Loss 0.393406, Valid_loss 0.459323
Epoch 33, Train Loss 0.391694, Valid_loss 0.462247
Epoch 34, Train Loss 0.388167, Valid_loss 0.464752
Epoch 35, Train Loss 0.385261, Valid_loss 0.452144
Epoch 36, Train Loss 0.392077, Valid_loss 0.456266
Epoch 37, Train Loss 0.385739, Valid_loss 0.454181
Epoch 38, Train Loss 0.387603, Valid_loss 0.443881
Epoch 39, Train Loss 0.373417, Valid_loss 0.453150
Epoch 40, Train Loss 0.376921, Valid_loss 0.439382
Epoch 41, Train Loss 0.375845, Valid_loss 0.439754
Epoch 42, Train Loss 0.386701, Valid_loss 0.441895
Epoch 43, Train Loss 0.374882, Valid_loss 0.427055
Epoch 44, Train Loss 0.379832, Valid_loss 0.437803
Epoch 45, Train Loss 0.367947, Valid_loss 0.421451
Epoch 46, Train Loss 0.369410, Valid_loss 0.432266
Epoch 47, Train Loss 0.365603, Valid_loss 0.418808
Epoch 48, Train Loss 0.357733, Valid_loss 0.425664
Epoch 49, Train Loss 0.364739, Valid_loss 0.420625
Epoch 50, Train Loss 0.361307, Valid_loss 0.415877
Epoch 51, Train Loss 0.371632, Valid_loss 0.416165
Epoch 52, Train Loss 0.359559, Valid_loss 0.412201
Epoch 53, Train Loss 0.359991, Valid_loss 0.416971
Epoch 54, Train Loss 0.362913, Valid_loss 0.415632
Epoch 55, Train Loss 0.358157, Valid_loss 0.407676
Epoch 56, Train Loss 0.358328, Valid_loss 0.411117
Epoch 57, Train Loss 0.357011, Valid_loss 0.412885
COVID19_Participant26 -- true: COVID-19 -- pred: COVID-19
Control_Participant3 -- true: normal -- pred: normal
COVID19_Participant8 -- true: COVID-19 -- pred: COVID-19
COVID19_Participant7 -- true: COVID-19 -- pred: normal
Control_Participant9 -- true: normal -- pred: COVID-19
COVID19_Participant26 -- true: COVID-19 -- pred: COVID-19
Control_Participant12 -- true: normal -- pred: COVID-19
Control_Participant4 -- true: normal -- pred: COVID-19
Control_Participant5 -- true: normal -- pred: normal
COVID19_Participant13 -- true: COVID-19 -- pred: COVID-19
true :  [1, 0, 1, 1, 0, 1, 0, 0, 0, 1]
pred :  [1, 0, 1, 0, 1, 1, 1, 1, 0, 1]
Confusion Matrix: [2 3 1 4]
Best performance: Epoch 55, Loss 0.358157, Test ACC 0.600000, Test AUC 0.680000, Test Recall 0.800000, Test Precision 0.571429
✅ Total valid splits used: 4
🔁 Repeat 2, Fold 4
🔍 Split #5
  → train_p_index 환자 수: 32
  → test_p_index 환자 수: 7
  → train 환자 ID: ['COVID19_Participant11', 'COVID19_Participant12', 'COVID19_Participant14', 'COVID19_Participant15', 'COVID19_Participant17', 'COVID19_Participant18', 'COVID19_Participant19', 'COVID19_Participant2', 'COVID19_Participant20', 'COVID19_Participant22', 'COVID19_Participant23', 'COVID19_Participant25', 'COVID19_Participant26', 'COVID19_Participant28', 'COVID19_Participant3', 'COVID19_Participant30', 'COVID19_Participant31', 'COVID19_Participant32', 'COVID19_Participant36', 'COVID19_Participant37', 'COVID19_Participant4', 'COVID19_Participant7', 'COVID19_Participant8', 'Control_Participant1', 'Control_Participant10', 'Control_Participant3', 'Control_Participant4', 'Control_Participant5', 'Control_Participant6', 'Control_Participant7', 'Control_Participant8', 'Control_Participant9']
  → test  환자 ID: ['Control_Participant7', 'Control_Participant5', 'COVID19_Participant26', 'Control_Participant4', 'COVID19_Participant31', 'COVID19_Participant25', 'COVID19_Participant7']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant12, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant18, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant3, Label: 1
    ID: COVID19_Participant30, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant36, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant10, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant4, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant6, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant8, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: Control_Participant7, Label: 1
    ID: Control_Participant5, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: Control_Participant4, Label: 1
    ID: COVID19_Participant31, Label: 0
    ID: COVID19_Participant25, Label: 0
    ID: COVID19_Participant7, Label: 0
train_p_index_ 21
valid_p_index 11
test_p_index 7
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Keratinocytes', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Neurons', 'iPS_cells', 'Embryonic_stem_cells', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
data augment 실행 함
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:11,  8.68it/s]  2%|▏         | 2/100 [00:00<00:11,  8.40it/s]  3%|▎         | 3/100 [00:00<00:12,  7.95it/s]  4%|▍         | 4/100 [00:00<00:11,  8.38it/s]  5%|▌         | 5/100 [00:00<00:11,  8.63it/s]  6%|▌         | 6/100 [00:00<00:10,  8.77it/s]  7%|▋         | 7/100 [00:00<00:10,  9.05it/s]  8%|▊         | 8/100 [00:00<00:10,  8.99it/s]  9%|▉         | 9/100 [00:01<00:10,  8.85it/s] 10%|█         | 10/100 [00:01<00:10,  8.49it/s] 11%|█         | 11/100 [00:01<00:10,  8.83it/s] 12%|█▏        | 12/100 [00:01<00:10,  8.63it/s] 13%|█▎        | 13/100 [00:01<00:10,  8.49it/s] 14%|█▍        | 14/100 [00:01<00:10,  8.53it/s] 15%|█▌        | 15/100 [00:01<00:09,  8.65it/s] 16%|█▌        | 16/100 [00:01<00:09,  8.67it/s] 17%|█▋        | 17/100 [00:01<00:09,  8.80it/s] 18%|█▊        | 18/100 [00:02<00:09,  8.84it/s] 19%|█▉        | 19/100 [00:02<00:09,  8.68it/s] 20%|██        | 20/100 [00:02<00:09,  8.77it/s] 21%|██        | 21/100 [00:02<00:08,  8.80it/s] 22%|██▏       | 22/100 [00:02<00:08,  8.76it/s] 23%|██▎       | 23/100 [00:02<00:08,  9.08it/s] 24%|██▍       | 24/100 [00:02<00:09,  8.35it/s] 25%|██▌       | 25/100 [00:02<00:09,  8.04it/s] 26%|██▌       | 26/100 [00:03<00:09,  7.86it/s] 27%|██▋       | 27/100 [00:03<00:09,  7.96it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.14it/s] 29%|██▉       | 29/100 [00:03<00:08,  8.17it/s] 30%|███       | 30/100 [00:03<00:08,  8.03it/s] 31%|███       | 31/100 [00:03<00:08,  8.14it/s] 32%|███▏      | 32/100 [00:03<00:08,  8.31it/s] 33%|███▎      | 33/100 [00:03<00:08,  8.04it/s] 34%|███▍      | 34/100 [00:04<00:08,  7.96it/s] 35%|███▌      | 35/100 [00:04<00:08,  8.01it/s] 36%|███▌      | 36/100 [00:04<00:08,  7.87it/s] 37%|███▋      | 37/100 [00:04<00:08,  7.76it/s] 38%|███▊      | 38/100 [00:04<00:07,  8.20it/s] 39%|███▉      | 39/100 [00:04<00:07,  8.18it/s] 40%|████      | 40/100 [00:04<00:07,  8.16it/s] 41%|████      | 41/100 [00:04<00:07,  7.89it/s] 42%|████▏     | 42/100 [00:05<00:07,  7.95it/s] 43%|████▎     | 43/100 [00:05<00:07,  8.10it/s] 44%|████▍     | 44/100 [00:05<00:06,  8.23it/s] 45%|████▌     | 45/100 [00:05<00:06,  8.23it/s] 46%|████▌     | 46/100 [00:05<00:06,  8.34it/s] 47%|████▋     | 47/100 [00:05<00:06,  8.31it/s] 48%|████▊     | 48/100 [00:05<00:06,  8.40it/s] 49%|████▉     | 49/100 [00:05<00:06,  8.47it/s] 50%|█████     | 50/100 [00:05<00:05,  8.48it/s] 51%|█████     | 51/100 [00:06<00:05,  8.22it/s] 52%|█████▏    | 52/100 [00:06<00:06,  8.00it/s] 53%|█████▎    | 53/100 [00:06<00:05,  8.07it/s] 54%|█████▍    | 54/100 [00:06<00:05,  8.02it/s] 55%|█████▌    | 55/100 [00:06<00:05,  7.99it/s] 56%|█████▌    | 56/100 [00:06<00:05,  8.12it/s] 57%|█████▋    | 57/100 [00:06<00:05,  8.21it/s] 58%|█████▊    | 58/100 [00:06<00:05,  8.21it/s] 59%|█████▉    | 59/100 [00:07<00:04,  8.41it/s] 60%|██████    | 60/100 [00:07<00:04,  8.30it/s] 61%|██████    | 61/100 [00:07<00:04,  8.15it/s] 62%|██████▏   | 62/100 [00:07<00:04,  7.89it/s] 63%|██████▎   | 63/100 [00:07<00:04,  7.84it/s] 64%|██████▍   | 64/100 [00:07<00:04,  8.03it/s] 65%|██████▌   | 65/100 [00:07<00:04,  8.17it/s] 66%|██████▌   | 66/100 [00:07<00:04,  7.83it/s] 67%|██████▋   | 67/100 [00:08<00:04,  7.81it/s] 68%|██████▊   | 68/100 [00:08<00:04,  7.55it/s] 69%|██████▉   | 69/100 [00:08<00:03,  7.86it/s] 70%|███████   | 70/100 [00:08<00:03,  7.88it/s] 71%|███████   | 71/100 [00:08<00:03,  7.98it/s] 72%|███████▏  | 72/100 [00:08<00:03,  7.98it/s] 73%|███████▎  | 73/100 [00:08<00:03,  8.14it/s] 74%|███████▍  | 74/100 [00:08<00:03,  7.83it/s] 75%|███████▌  | 75/100 [00:09<00:03,  7.84it/s] 76%|███████▌  | 76/100 [00:09<00:02,  8.04it/s] 77%|███████▋  | 77/100 [00:09<00:02,  7.70it/s] 78%|███████▊  | 78/100 [00:09<00:02,  7.99it/s] 79%|███████▉  | 79/100 [00:09<00:02,  7.96it/s] 80%|████████  | 80/100 [00:09<00:02,  7.81it/s] 81%|████████  | 81/100 [00:09<00:02,  7.82it/s] 82%|████████▏ | 82/100 [00:10<00:02,  7.90it/s] 83%|████████▎ | 83/100 [00:10<00:02,  8.02it/s] 84%|████████▍ | 84/100 [00:10<00:01,  8.01it/s] 85%|████████▌ | 85/100 [00:10<00:01,  7.98it/s] 86%|████████▌ | 86/100 [00:10<00:01,  8.04it/s] 87%|████████▋ | 87/100 [00:10<00:01,  8.27it/s] 88%|████████▊ | 88/100 [00:10<00:01,  8.28it/s] 89%|████████▉ | 89/100 [00:10<00:01,  8.14it/s] 90%|█████████ | 90/100 [00:10<00:01,  7.98it/s] 91%|█████████ | 91/100 [00:11<00:01,  7.86it/s] 92%|█████████▏| 92/100 [00:11<00:01,  7.92it/s] 93%|█████████▎| 93/100 [00:11<00:00,  7.79it/s] 94%|█████████▍| 94/100 [00:11<00:00,  7.98it/s] 95%|█████████▌| 95/100 [00:11<00:00,  7.95it/s] 96%|█████████▌| 96/100 [00:11<00:00,  7.92it/s] 97%|█████████▋| 97/100 [00:11<00:00,  8.01it/s] 98%|█████████▊| 98/100 [00:11<00:00,  8.18it/s] 99%|█████████▉| 99/100 [00:12<00:00,  7.94it/s]100%|██████████| 100/100 [00:12<00:00,  7.98it/s]100%|██████████| 100/100 [00:12<00:00,  8.17it/s]
eval_p_index len:  18
individual_train 121
individual_eval 18
train data의 x, y, id 길이: 121 121 121
valid data의 x, y, id 길이: 11 11 11
test data의 x, y, id 길이: 7 7 7
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.675098, Valid_loss 0.629222
Epoch 2, Train Loss 0.635732, Valid_loss 0.590466
Epoch 3, Train Loss 0.601609, Valid_loss 0.579957
Epoch 4, Train Loss 0.599795, Valid_loss 0.578646
Epoch 5, Train Loss 0.594095, Valid_loss 0.570091
Epoch 6, Train Loss 0.581350, Valid_loss 0.557696
Epoch 7, Train Loss 0.574607, Valid_loss 0.549117
Epoch 8, Train Loss 0.568097, Valid_loss 0.542914
Epoch 9, Train Loss 0.556860, Valid_loss 0.535363
Epoch 10, Train Loss 0.545128, Valid_loss 0.528567
Epoch 11, Train Loss 0.540807, Valid_loss 0.514372
Epoch 12, Train Loss 0.518511, Valid_loss 0.485659
Epoch 13, Train Loss 0.484645, Valid_loss 0.458466
Epoch 14, Train Loss 0.470176, Valid_loss 0.458307
Epoch 15, Train Loss 0.466522, Valid_loss 0.456570
Epoch 16, Train Loss 0.459628, Valid_loss 0.449179
Epoch 17, Train Loss 0.446847, Valid_loss 0.439729
Epoch 18, Train Loss 0.450433, Valid_loss 0.443365
Epoch 19, Train Loss 0.448470, Valid_loss 0.433360
Epoch 20, Train Loss 0.442115, Valid_loss 0.432035
Epoch 21, Train Loss 0.441612, Valid_loss 0.435085
Epoch 22, Train Loss 0.437253, Valid_loss 0.426314
Epoch 23, Train Loss 0.431362, Valid_loss 0.432095
Epoch 24, Train Loss 0.434220, Valid_loss 0.426722
Epoch 25, Train Loss 0.438365, Valid_loss 0.428206
Epoch 26, Train Loss 0.431396, Valid_loss 0.417768
Epoch 27, Train Loss 0.432336, Valid_loss 0.431575
Epoch 28, Train Loss 0.429989, Valid_loss 0.420008
Epoch 29, Train Loss 0.429014, Valid_loss 0.416582
Epoch 30, Train Loss 0.428681, Valid_loss 0.429616
Epoch 31, Train Loss 0.421805, Valid_loss 0.414871
Epoch 32, Train Loss 0.419421, Valid_loss 0.424687
Epoch 33, Train Loss 0.419592, Valid_loss 0.411622
Epoch 34, Train Loss 0.420343, Valid_loss 0.417860
Epoch 35, Train Loss 0.424980, Valid_loss 0.410656
Epoch 36, Train Loss 0.417715, Valid_loss 0.414536
Epoch 37, Train Loss 0.422195, Valid_loss 0.407574
Epoch 38, Train Loss 0.411572, Valid_loss 0.409550
Epoch 39, Train Loss 0.418475, Valid_loss 0.405845
Epoch 40, Train Loss 0.408138, Valid_loss 0.408402
Epoch 41, Train Loss 0.415714, Valid_loss 0.401242
Epoch 42, Train Loss 0.412499, Valid_loss 0.405957
Epoch 43, Train Loss 0.414420, Valid_loss 0.399098
Epoch 44, Train Loss 0.404738, Valid_loss 0.398430
Epoch 45, Train Loss 0.414040, Valid_loss 0.398860
Epoch 46, Train Loss 0.405233, Valid_loss 0.394415
Epoch 47, Train Loss 0.403372, Valid_loss 0.394152
Epoch 48, Train Loss 0.405069, Valid_loss 0.391137
Epoch 49, Train Loss 0.408013, Valid_loss 0.391597
Epoch 50, Train Loss 0.406353, Valid_loss 0.389380
Epoch 51, Train Loss 0.408656, Valid_loss 0.389973
Epoch 52, Train Loss 0.406094, Valid_loss 0.387783
Epoch 53, Train Loss 0.405518, Valid_loss 0.386732
Epoch 54, Train Loss 0.405917, Valid_loss 0.389138
Epoch 55, Train Loss 0.408732, Valid_loss 0.386219
Epoch 56, Train Loss 0.405084, Valid_loss 0.385231
Epoch 57, Train Loss 0.407563, Valid_loss 0.386007
Epoch 58, Train Loss 0.408899, Valid_loss 0.384004
Epoch 59, Train Loss 0.403662, Valid_loss 0.383351
Epoch 60, Train Loss 0.403160, Valid_loss 0.383364
Epoch 61, Train Loss 0.407424, Valid_loss 0.382002
Epoch 62, Train Loss 0.396171, Valid_loss 0.381829
Epoch 63, Train Loss 0.403677, Valid_loss 0.380805
Epoch 64, Train Loss 0.399274, Valid_loss 0.380898
Epoch 65, Train Loss 0.396330, Valid_loss 0.379967
Epoch 66, Train Loss 0.401757, Valid_loss 0.379231
Epoch 67, Train Loss 0.398510, Valid_loss 0.378536
Epoch 68, Train Loss 0.399487, Valid_loss 0.377292
Epoch 69, Train Loss 0.400318, Valid_loss 0.377936
Epoch 70, Train Loss 0.401420, Valid_loss 0.376521
Epoch 71, Train Loss 0.398187, Valid_loss 0.375657
Epoch 72, Train Loss 0.400215, Valid_loss 0.376719
Epoch 73, Train Loss 0.400000, Valid_loss 0.374316
Epoch 74, Train Loss 0.396855, Valid_loss 0.374945
Epoch 75, Train Loss 0.390047, Valid_loss 0.373875
Epoch 76, Train Loss 0.393172, Valid_loss 0.372068
Epoch 77, Train Loss 0.392170, Valid_loss 0.372844
Epoch 78, Train Loss 0.401742, Valid_loss 0.371700
Epoch 79, Train Loss 0.393037, Valid_loss 0.369961
Epoch 80, Train Loss 0.401016, Valid_loss 0.370243
Epoch 81, Train Loss 0.391720, Valid_loss 0.369018
Epoch 82, Train Loss 0.392949, Valid_loss 0.368548
Epoch 83, Train Loss 0.393597, Valid_loss 0.367342
Epoch 84, Train Loss 0.392145, Valid_loss 0.366793
Epoch 85, Train Loss 0.392903, Valid_loss 0.366624
Epoch 86, Train Loss 0.397013, Valid_loss 0.365943
Epoch 87, Train Loss 0.389910, Valid_loss 0.364473
Epoch 88, Train Loss 0.388219, Valid_loss 0.364079
Epoch 89, Train Loss 0.393775, Valid_loss 0.364141
Epoch 90, Train Loss 0.397596, Valid_loss 0.362424
Epoch 91, Train Loss 0.390439, Valid_loss 0.362687
Epoch 92, Train Loss 0.390120, Valid_loss 0.361466
Epoch 93, Train Loss 0.388467, Valid_loss 0.360779
Epoch 94, Train Loss 0.389948, Valid_loss 0.359652
Epoch 95, Train Loss 0.395967, Valid_loss 0.359084
Epoch 96, Train Loss 0.392576, Valid_loss 0.359160
Epoch 97, Train Loss 0.386613, Valid_loss 0.357052
Epoch 98, Train Loss 0.388804, Valid_loss 0.357804
Epoch 99, Train Loss 0.383979, Valid_loss 0.356140
Epoch 100, Train Loss 0.394592, Valid_loss 0.355294
Control_Participant7 -- true: normal -- pred: normal
Control_Participant5 -- true: normal -- pred: normal
COVID19_Participant26 -- true: COVID-19 -- pred: normal
Control_Participant4 -- true: normal -- pred: COVID-19
COVID19_Participant31 -- true: COVID-19 -- pred: COVID-19
COVID19_Participant25 -- true: COVID-19 -- pred: COVID-19
COVID19_Participant7 -- true: COVID-19 -- pred: COVID-19
true :  [0, 0, 1, 0, 1, 1, 1]
pred :  [0, 0, 0, 1, 1, 1, 1]
Confusion Matrix: [2 1 1 3]
Best performance: Epoch 100, Loss 0.394592, Test ACC 0.714286, Test AUC 0.666667, Test Recall 0.750000, Test Precision 0.750000
✅ Total valid splits used: 5

📌 Repeat 2: 평균 AUC = 0.7760, 표준편차 = 0.0999
🔁 Repeat 3, Fold 0
🔍 Split #1
  → train_p_index 환자 수: 31
  → test_p_index 환자 수: 8
  → train 환자 ID: ['COVID19_Participant12', 'COVID19_Participant13', 'COVID19_Participant14', 'COVID19_Participant15', 'COVID19_Participant18', 'COVID19_Participant2', 'COVID19_Participant20', 'COVID19_Participant22', 'COVID19_Participant23', 'COVID19_Participant26', 'COVID19_Participant28', 'COVID19_Participant29', 'COVID19_Participant3', 'COVID19_Participant30', 'COVID19_Participant32', 'COVID19_Participant36', 'COVID19_Participant37', 'COVID19_Participant39', 'COVID19_Participant4', 'COVID19_Participant7', 'COVID19_Participant8', 'Control_Participant10', 'Control_Participant11', 'Control_Participant14', 'Control_Participant15', 'Control_Participant3', 'Control_Participant5', 'Control_Participant6', 'Control_Participant7', 'Control_Participant8', 'Control_Participant9']
  → test  환자 ID: ['COVID19_Participant13', 'Control_Participant5', 'COVID19_Participant26', 'COVID19_Participant13', 'Control_Participant7', 'Control_Participant3', 'COVID19_Participant26', 'Control_Participant7']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant12, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant18, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant3, Label: 1
    ID: COVID19_Participant30, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant36, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: Control_Participant10, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant14, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant6, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant8, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: COVID19_Participant13, Label: 1
    ID: Control_Participant5, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: Control_Participant7, Label: 1
    ID: Control_Participant3, Label: 1
    ID: COVID19_Participant26, Label: 0
    ID: Control_Participant7, Label: 0
train_p_index_ 20
valid_p_index 11
test_p_index 8
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Keratinocytes', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Neurons', 'iPS_cells', 'Embryonic_stem_cells', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
data augment 실행 함
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:10,  9.34it/s]  2%|▏         | 2/100 [00:00<00:10,  9.37it/s]  3%|▎         | 3/100 [00:00<00:10,  9.11it/s]  4%|▍         | 4/100 [00:00<00:11,  8.59it/s]  5%|▌         | 5/100 [00:00<00:10,  8.92it/s]  6%|▌         | 6/100 [00:00<00:10,  9.12it/s]  7%|▋         | 7/100 [00:00<00:09,  9.37it/s]  8%|▊         | 8/100 [00:00<00:10,  9.03it/s]  9%|▉         | 9/100 [00:00<00:09,  9.15it/s] 10%|█         | 10/100 [00:01<00:09,  9.25it/s] 11%|█         | 11/100 [00:01<00:09,  9.24it/s] 12%|█▏        | 12/100 [00:01<00:09,  9.23it/s] 13%|█▎        | 13/100 [00:01<00:09,  9.17it/s] 14%|█▍        | 14/100 [00:01<00:09,  9.12it/s] 15%|█▌        | 15/100 [00:01<00:09,  8.80it/s] 16%|█▌        | 16/100 [00:01<00:10,  8.13it/s] 17%|█▋        | 17/100 [00:01<00:09,  8.30it/s] 18%|█▊        | 18/100 [00:02<00:09,  8.60it/s] 19%|█▉        | 19/100 [00:02<00:09,  8.28it/s] 20%|██        | 20/100 [00:02<00:09,  8.42it/s] 21%|██        | 21/100 [00:02<00:09,  8.46it/s] 22%|██▏       | 22/100 [00:02<00:09,  8.22it/s] 23%|██▎       | 23/100 [00:02<00:08,  8.57it/s] 24%|██▍       | 24/100 [00:02<00:08,  8.73it/s] 25%|██▌       | 25/100 [00:02<00:08,  8.78it/s] 26%|██▌       | 26/100 [00:02<00:08,  8.83it/s] 27%|██▋       | 27/100 [00:03<00:08,  8.71it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.84it/s] 29%|██▉       | 29/100 [00:03<00:07,  9.03it/s] 30%|███       | 30/100 [00:03<00:07,  8.88it/s] 31%|███       | 31/100 [00:03<00:07,  8.64it/s] 32%|███▏      | 32/100 [00:03<00:08,  8.47it/s] 33%|███▎      | 33/100 [00:03<00:07,  8.66it/s] 34%|███▍      | 34/100 [00:03<00:07,  8.81it/s] 35%|███▌      | 35/100 [00:03<00:07,  8.86it/s] 36%|███▌      | 36/100 [00:04<00:07,  8.81it/s] 37%|███▋      | 37/100 [00:04<00:07,  8.56it/s] 38%|███▊      | 38/100 [00:04<00:07,  8.49it/s] 39%|███▉      | 39/100 [00:04<00:07,  8.65it/s] 40%|████      | 40/100 [00:04<00:06,  8.76it/s] 41%|████      | 41/100 [00:04<00:06,  8.65it/s] 42%|████▏     | 42/100 [00:04<00:06,  8.80it/s] 43%|████▎     | 43/100 [00:04<00:07,  8.09it/s] 44%|████▍     | 44/100 [00:05<00:06,  8.22it/s] 45%|████▌     | 45/100 [00:05<00:06,  8.27it/s] 46%|████▌     | 46/100 [00:05<00:06,  8.46it/s] 47%|████▋     | 47/100 [00:05<00:06,  8.43it/s] 48%|████▊     | 48/100 [00:05<00:06,  8.57it/s] 49%|████▉     | 49/100 [00:05<00:05,  8.76it/s] 50%|█████     | 50/100 [00:05<00:05,  8.34it/s] 51%|█████     | 51/100 [00:05<00:05,  8.42it/s] 52%|█████▏    | 52/100 [00:05<00:05,  8.41it/s] 53%|█████▎    | 53/100 [00:06<00:05,  8.43it/s] 54%|█████▍    | 54/100 [00:06<00:05,  8.54it/s] 55%|█████▌    | 55/100 [00:06<00:05,  8.27it/s] 56%|█████▌    | 56/100 [00:06<00:05,  8.32it/s] 57%|█████▋    | 57/100 [00:06<00:05,  8.23it/s] 58%|█████▊    | 58/100 [00:06<00:04,  8.50it/s] 59%|█████▉    | 59/100 [00:06<00:04,  8.26it/s] 60%|██████    | 60/100 [00:06<00:04,  8.22it/s] 61%|██████    | 61/100 [00:07<00:04,  8.07it/s] 62%|██████▏   | 62/100 [00:07<00:04,  8.16it/s] 63%|██████▎   | 63/100 [00:07<00:04,  8.20it/s] 64%|██████▍   | 64/100 [00:07<00:04,  8.29it/s] 65%|██████▌   | 65/100 [00:07<00:04,  8.36it/s] 66%|██████▌   | 66/100 [00:07<00:04,  8.20it/s] 67%|██████▋   | 67/100 [00:07<00:03,  8.47it/s] 68%|██████▊   | 68/100 [00:07<00:03,  8.43it/s] 69%|██████▉   | 69/100 [00:08<00:03,  8.18it/s] 70%|███████   | 70/100 [00:08<00:03,  7.97it/s] 72%|███████▏  | 72/100 [00:08<00:03,  8.57it/s] 73%|███████▎  | 73/100 [00:08<00:03,  8.45it/s] 74%|███████▍  | 74/100 [00:08<00:03,  8.27it/s] 75%|███████▌  | 75/100 [00:08<00:03,  8.33it/s] 76%|███████▌  | 76/100 [00:08<00:02,  8.17it/s] 77%|███████▋  | 77/100 [00:09<00:02,  8.29it/s] 78%|███████▊  | 78/100 [00:09<00:02,  7.80it/s] 79%|███████▉  | 79/100 [00:09<00:02,  7.85it/s] 80%|████████  | 80/100 [00:09<00:02,  7.87it/s] 81%|████████  | 81/100 [00:09<00:02,  7.87it/s] 82%|████████▏ | 82/100 [00:09<00:02,  7.54it/s] 83%|████████▎ | 83/100 [00:09<00:02,  7.54it/s] 84%|████████▍ | 84/100 [00:09<00:02,  7.81it/s] 85%|████████▌ | 85/100 [00:10<00:01,  7.91it/s] 86%|████████▌ | 86/100 [00:10<00:01,  7.95it/s] 87%|████████▋ | 87/100 [00:10<00:01,  7.82it/s] 88%|████████▊ | 88/100 [00:10<00:01,  7.82it/s] 89%|████████▉ | 89/100 [00:10<00:01,  7.72it/s] 90%|█████████ | 90/100 [00:10<00:01,  7.61it/s] 91%|█████████ | 91/100 [00:10<00:01,  7.72it/s] 92%|█████████▏| 92/100 [00:10<00:01,  7.51it/s] 93%|█████████▎| 93/100 [00:11<00:00,  7.46it/s] 94%|█████████▍| 94/100 [00:11<00:00,  7.48it/s] 95%|█████████▌| 95/100 [00:11<00:00,  7.66it/s] 96%|█████████▌| 96/100 [00:11<00:00,  7.89it/s] 97%|█████████▋| 97/100 [00:11<00:00,  7.99it/s] 98%|█████████▊| 98/100 [00:11<00:00,  7.90it/s] 99%|█████████▉| 99/100 [00:11<00:00,  7.91it/s]100%|██████████| 100/100 [00:12<00:00,  7.63it/s]100%|██████████| 100/100 [00:12<00:00,  8.33it/s]
eval_p_index len:  19
individual_train 120
individual_eval 19
train data의 x, y, id 길이: 120 120 120
valid data의 x, y, id 길이: 11 11 11
test data의 x, y, id 길이: 8 8 8
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.776913, Valid_loss 0.768979
Epoch 2, Train Loss 0.726899, Valid_loss 0.721844
Epoch 3, Train Loss 0.702394, Valid_loss 0.690976
Epoch 4, Train Loss 0.690712, Valid_loss 0.674739
Epoch 5, Train Loss 0.683030, Valid_loss 0.659137
Epoch 6, Train Loss 0.671143, Valid_loss 0.646373
Epoch 7, Train Loss 0.661217, Valid_loss 0.633652
Epoch 8, Train Loss 0.648711, Valid_loss 0.624576
Epoch 9, Train Loss 0.636006, Valid_loss 0.613578
Epoch 10, Train Loss 0.624993, Valid_loss 0.594380
Epoch 11, Train Loss 0.616982, Valid_loss 0.583096
Epoch 12, Train Loss 0.607250, Valid_loss 0.577333
Epoch 13, Train Loss 0.600462, Valid_loss 0.571679
Epoch 14, Train Loss 0.594596, Valid_loss 0.564758
Epoch 15, Train Loss 0.591754, Valid_loss 0.563726
Epoch 16, Train Loss 0.584087, Valid_loss 0.556584
Epoch 17, Train Loss 0.582989, Valid_loss 0.556919
Epoch 18, Train Loss 0.577233, Valid_loss 0.550596
Epoch 19, Train Loss 0.572109, Valid_loss 0.555763
Epoch 20, Train Loss 0.564752, Valid_loss 0.556410
Epoch 21, Train Loss 0.572448, Valid_loss 0.547134
Epoch 22, Train Loss 0.569170, Valid_loss 0.553613
Epoch 23, Train Loss 0.568554, Valid_loss 0.537231
Epoch 24, Train Loss 0.571349, Valid_loss 0.553777
Epoch 25, Train Loss 0.564928, Valid_loss 0.534516
Epoch 26, Train Loss 0.558314, Valid_loss 0.551499
Epoch 27, Train Loss 0.558737, Valid_loss 0.544009
Epoch 28, Train Loss 0.561534, Valid_loss 0.543140
Epoch 29, Train Loss 0.556493, Valid_loss 0.541688
Epoch 30, Train Loss 0.553698, Valid_loss 0.541843
Epoch 31, Train Loss 0.556231, Valid_loss 0.537860
Epoch 32, Train Loss 0.552541, Valid_loss 0.539850
Epoch 33, Train Loss 0.553687, Valid_loss 0.537514
Epoch 34, Train Loss 0.549030, Valid_loss 0.531685
Epoch 35, Train Loss 0.555014, Valid_loss 0.544632
Epoch 36, Train Loss 0.546772, Valid_loss 0.530585
Epoch 37, Train Loss 0.543057, Valid_loss 0.534050
Epoch 38, Train Loss 0.541643, Valid_loss 0.529158
Epoch 39, Train Loss 0.540277, Valid_loss 0.531343
Epoch 40, Train Loss 0.539848, Valid_loss 0.527573
Epoch 41, Train Loss 0.538839, Valid_loss 0.529240
Epoch 42, Train Loss 0.535502, Valid_loss 0.527231
Epoch 43, Train Loss 0.537412, Valid_loss 0.529775
Epoch 44, Train Loss 0.533078, Valid_loss 0.530372
Epoch 45, Train Loss 0.534510, Valid_loss 0.524817
Epoch 46, Train Loss 0.536082, Valid_loss 0.528733
Epoch 47, Train Loss 0.536096, Valid_loss 0.527850
Epoch 48, Train Loss 0.527709, Valid_loss 0.529194
Epoch 49, Train Loss 0.530544, Valid_loss 0.529813
Epoch 50, Train Loss 0.531770, Valid_loss 0.528562
Epoch 51, Train Loss 0.523483, Valid_loss 0.525327
Epoch 52, Train Loss 0.528802, Valid_loss 0.518085
Epoch 53, Train Loss 0.527907, Valid_loss 0.525490
Epoch 54, Train Loss 0.527162, Valid_loss 0.522282
Epoch 55, Train Loss 0.529111, Valid_loss 0.523925
Epoch 56, Train Loss 0.525431, Valid_loss 0.522729
Epoch 57, Train Loss 0.527669, Valid_loss 0.525063
Epoch 58, Train Loss 0.523880, Valid_loss 0.521294
Epoch 59, Train Loss 0.521815, Valid_loss 0.520479
Epoch 60, Train Loss 0.526096, Valid_loss 0.520075
Epoch 61, Train Loss 0.517785, Valid_loss 0.523184
Epoch 62, Train Loss 0.520394, Valid_loss 0.513622
Epoch 63, Train Loss 0.520346, Valid_loss 0.525374
Epoch 64, Train Loss 0.521686, Valid_loss 0.518094
Epoch 65, Train Loss 0.518480, Valid_loss 0.515599
Epoch 66, Train Loss 0.518982, Valid_loss 0.521392
Epoch 67, Train Loss 0.523695, Valid_loss 0.514110
Epoch 68, Train Loss 0.520628, Valid_loss 0.514190
Epoch 69, Train Loss 0.523274, Valid_loss 0.516278
COVID19_Participant13 -- true: COVID-19 -- pred: normal
Control_Participant5 -- true: normal -- pred: normal
COVID19_Participant26 -- true: COVID-19 -- pred: COVID-19
COVID19_Participant13 -- true: COVID-19 -- pred: COVID-19
Control_Participant7 -- true: normal -- pred: normal
Control_Participant3 -- true: normal -- pred: normal
COVID19_Participant26 -- true: COVID-19 -- pred: COVID-19
Control_Participant7 -- true: normal -- pred: normal
true :  [1, 0, 1, 1, 0, 0, 1, 0]
pred :  [0, 0, 1, 1, 0, 0, 1, 0]
Confusion Matrix: [4 0 1 3]
Best performance: Epoch 62, Loss 0.520394, Test ACC 0.875000, Test AUC 1.000000, Test Recall 0.750000, Test Precision 1.000000
✅ Total valid splits used: 1
🔁 Repeat 3, Fold 1
🔍 Split #2
  → train_p_index 환자 수: 32
  → test_p_index 환자 수: 7
  → train 환자 ID: ['COVID19_Participant11', 'COVID19_Participant12', 'COVID19_Participant13', 'COVID19_Participant14', 'COVID19_Participant17', 'COVID19_Participant19', 'COVID19_Participant2', 'COVID19_Participant20', 'COVID19_Participant22', 'COVID19_Participant23', 'COVID19_Participant25', 'COVID19_Participant26', 'COVID19_Participant28', 'COVID19_Participant29', 'COVID19_Participant31', 'COVID19_Participant32', 'COVID19_Participant36', 'COVID19_Participant37', 'COVID19_Participant4', 'COVID19_Participant40', 'COVID19_Participant8', 'Control_Participant1', 'Control_Participant11', 'Control_Participant14', 'Control_Participant15', 'Control_Participant3', 'Control_Participant4', 'Control_Participant5', 'Control_Participant6', 'Control_Participant7', 'Control_Participant8', 'Control_Participant9']
  → test  환자 ID: ['COVID19_Participant26', 'Control_Participant5', 'COVID19_Participant26', 'Control_Participant5', 'COVID19_Participant26', 'Control_Participant7', 'Control_Participant7']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant12, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant36, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant14, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant4, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant6, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant8, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: COVID19_Participant26, Label: 1
    ID: Control_Participant5, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: Control_Participant5, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: Control_Participant7, Label: 1
    ID: Control_Participant7, Label: 0
train_p_index_ 21
valid_p_index 11
test_p_index 7
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Keratinocytes', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Neurons', 'iPS_cells', 'Embryonic_stem_cells', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
data augment 실행 함
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:11,  8.74it/s]  2%|▏         | 2/100 [00:00<00:11,  8.82it/s]  3%|▎         | 3/100 [00:00<00:11,  8.69it/s]  4%|▍         | 4/100 [00:00<00:10,  8.89it/s]  5%|▌         | 5/100 [00:00<00:10,  8.86it/s]  6%|▌         | 6/100 [00:00<00:10,  9.19it/s]  7%|▋         | 7/100 [00:00<00:10,  9.03it/s]  9%|▉         | 9/100 [00:00<00:09,  9.23it/s] 10%|█         | 10/100 [00:01<00:10,  8.88it/s] 11%|█         | 11/100 [00:01<00:11,  7.79it/s] 12%|█▏        | 12/100 [00:01<00:10,  8.10it/s] 13%|█▎        | 13/100 [00:01<00:10,  7.92it/s] 14%|█▍        | 14/100 [00:01<00:10,  8.24it/s] 15%|█▌        | 15/100 [00:01<00:10,  8.40it/s] 16%|█▌        | 16/100 [00:01<00:10,  8.25it/s] 17%|█▋        | 17/100 [00:02<00:11,  7.34it/s] 18%|█▊        | 18/100 [00:02<00:10,  7.68it/s] 19%|█▉        | 19/100 [00:02<00:10,  7.94it/s] 20%|██        | 20/100 [00:02<00:10,  7.93it/s] 21%|██        | 21/100 [00:02<00:09,  8.15it/s] 22%|██▏       | 22/100 [00:02<00:09,  8.24it/s] 23%|██▎       | 23/100 [00:02<00:09,  8.33it/s] 24%|██▍       | 24/100 [00:02<00:08,  8.62it/s] 25%|██▌       | 25/100 [00:02<00:08,  8.51it/s] 26%|██▌       | 26/100 [00:03<00:08,  8.42it/s] 27%|██▋       | 27/100 [00:03<00:08,  8.54it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.48it/s] 29%|██▉       | 29/100 [00:03<00:08,  8.61it/s] 30%|███       | 30/100 [00:03<00:08,  8.72it/s] 31%|███       | 31/100 [00:03<00:07,  8.66it/s] 32%|███▏      | 32/100 [00:03<00:07,  8.80it/s] 33%|███▎      | 33/100 [00:03<00:07,  8.69it/s] 34%|███▍      | 34/100 [00:04<00:07,  8.64it/s] 35%|███▌      | 35/100 [00:04<00:07,  8.28it/s] 36%|███▌      | 36/100 [00:04<00:07,  8.62it/s] 37%|███▋      | 37/100 [00:04<00:08,  7.21it/s] 38%|███▊      | 38/100 [00:04<00:08,  7.53it/s] 39%|███▉      | 39/100 [00:04<00:07,  7.78it/s] 40%|████      | 40/100 [00:04<00:07,  8.15it/s] 41%|████      | 41/100 [00:04<00:07,  8.16it/s] 42%|████▏     | 42/100 [00:05<00:07,  8.26it/s] 43%|████▎     | 43/100 [00:05<00:06,  8.25it/s] 44%|████▍     | 44/100 [00:05<00:06,  8.23it/s] 45%|████▌     | 45/100 [00:05<00:06,  8.44it/s] 46%|████▌     | 46/100 [00:05<00:06,  8.43it/s] 47%|████▋     | 47/100 [00:05<00:06,  8.40it/s] 48%|████▊     | 48/100 [00:05<00:06,  8.17it/s] 49%|████▉     | 49/100 [00:05<00:06,  8.33it/s] 50%|█████     | 50/100 [00:06<00:06,  8.27it/s] 51%|█████     | 51/100 [00:06<00:05,  8.19it/s] 52%|█████▏    | 52/100 [00:06<00:06,  7.98it/s] 53%|█████▎    | 53/100 [00:06<00:05,  8.19it/s] 54%|█████▍    | 54/100 [00:06<00:05,  8.12it/s] 55%|█████▌    | 55/100 [00:06<00:05,  8.23it/s] 56%|█████▌    | 56/100 [00:06<00:05,  7.78it/s] 57%|█████▋    | 57/100 [00:06<00:05,  7.86it/s] 58%|█████▊    | 58/100 [00:07<00:05,  8.05it/s] 59%|█████▉    | 59/100 [00:07<00:05,  8.06it/s] 60%|██████    | 60/100 [00:07<00:04,  8.13it/s] 61%|██████    | 61/100 [00:07<00:04,  7.95it/s] 62%|██████▏   | 62/100 [00:07<00:04,  7.94it/s] 63%|██████▎   | 63/100 [00:07<00:04,  8.02it/s] 64%|██████▍   | 64/100 [00:07<00:04,  7.98it/s] 65%|██████▌   | 65/100 [00:07<00:04,  7.45it/s] 66%|██████▌   | 66/100 [00:08<00:04,  7.60it/s] 67%|██████▋   | 67/100 [00:08<00:04,  7.75it/s] 68%|██████▊   | 68/100 [00:08<00:04,  7.69it/s] 69%|██████▉   | 69/100 [00:08<00:04,  7.72it/s] 70%|███████   | 70/100 [00:08<00:04,  7.43it/s] 71%|███████   | 71/100 [00:08<00:03,  7.71it/s] 72%|███████▏  | 72/100 [00:08<00:03,  7.95it/s] 73%|███████▎  | 73/100 [00:09<00:03,  6.80it/s] 74%|███████▍  | 74/100 [00:09<00:03,  7.12it/s] 75%|███████▌  | 75/100 [00:09<00:03,  7.35it/s] 76%|███████▌  | 76/100 [00:09<00:03,  7.49it/s] 77%|███████▋  | 77/100 [00:09<00:02,  7.88it/s] 78%|███████▊  | 78/100 [00:09<00:02,  7.90it/s] 79%|███████▉  | 79/100 [00:09<00:02,  7.90it/s] 80%|████████  | 80/100 [00:09<00:02,  7.79it/s] 81%|████████  | 81/100 [00:10<00:02,  7.73it/s] 82%|████████▏ | 82/100 [00:10<00:02,  7.76it/s] 83%|████████▎ | 83/100 [00:10<00:02,  7.80it/s] 84%|████████▍ | 84/100 [00:10<00:02,  7.94it/s] 85%|████████▌ | 85/100 [00:10<00:01,  7.99it/s] 86%|████████▌ | 86/100 [00:10<00:01,  7.92it/s] 87%|████████▋ | 87/100 [00:10<00:01,  8.11it/s] 88%|████████▊ | 88/100 [00:10<00:01,  8.02it/s] 89%|████████▉ | 89/100 [00:11<00:01,  7.95it/s] 90%|█████████ | 90/100 [00:11<00:01,  8.02it/s] 91%|█████████ | 91/100 [00:11<00:01,  8.18it/s] 92%|█████████▏| 92/100 [00:11<00:01,  7.99it/s] 93%|█████████▎| 93/100 [00:11<00:00,  7.84it/s] 94%|█████████▍| 94/100 [00:11<00:00,  7.84it/s] 95%|█████████▌| 95/100 [00:11<00:00,  8.09it/s] 96%|█████████▌| 96/100 [00:11<00:00,  7.84it/s] 97%|█████████▋| 97/100 [00:12<00:00,  7.71it/s] 98%|█████████▊| 98/100 [00:12<00:00,  7.83it/s] 99%|█████████▉| 99/100 [00:12<00:00,  7.85it/s]100%|██████████| 100/100 [00:12<00:00,  7.83it/s]100%|██████████| 100/100 [00:12<00:00,  8.06it/s]
eval_p_index len:  18
individual_train 121
individual_eval 18
train data의 x, y, id 길이: 121 121 121
valid data의 x, y, id 길이: 11 11 11
test data의 x, y, id 길이: 7 7 7
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.697684, Valid_loss 0.583647
Epoch 2, Train Loss 0.698068, Valid_loss 0.586530
Epoch 3, Train Loss 0.694882, Valid_loss 0.582152
Epoch 4, Train Loss 0.683106, Valid_loss 0.582913
Epoch 5, Train Loss 0.686942, Valid_loss 0.575980
Epoch 6, Train Loss 0.672074, Valid_loss 0.573357
Epoch 7, Train Loss 0.665105, Valid_loss 0.568399
Epoch 8, Train Loss 0.660556, Valid_loss 0.566183
Epoch 9, Train Loss 0.667076, Valid_loss 0.558572
Epoch 10, Train Loss 0.651093, Valid_loss 0.557587
Epoch 11, Train Loss 0.645618, Valid_loss 0.555625
Epoch 12, Train Loss 0.635834, Valid_loss 0.547597
Epoch 13, Train Loss 0.635200, Valid_loss 0.541080
Epoch 14, Train Loss 0.624248, Valid_loss 0.544135
Epoch 15, Train Loss 0.621940, Valid_loss 0.526667
Epoch 16, Train Loss 0.610428, Valid_loss 0.546393
Epoch 17, Train Loss 0.602013, Valid_loss 0.524529
Epoch 18, Train Loss 0.601804, Valid_loss 0.529142
Epoch 19, Train Loss 0.582678, Valid_loss 0.526388
Epoch 20, Train Loss 0.577731, Valid_loss 0.520317
Epoch 21, Train Loss 0.562328, Valid_loss 0.533456
Epoch 22, Train Loss 0.555454, Valid_loss 0.480338
Epoch 23, Train Loss 0.535883, Valid_loss 0.501053
Epoch 24, Train Loss 0.523767, Valid_loss 0.500827
Epoch 25, Train Loss 0.532956, Valid_loss 0.498476
Epoch 26, Train Loss 0.519595, Valid_loss 0.499037
Epoch 27, Train Loss 0.515180, Valid_loss 0.503879
Epoch 28, Train Loss 0.519367, Valid_loss 0.496888
Epoch 29, Train Loss 0.522852, Valid_loss 0.497529
Epoch 30, Train Loss 0.518193, Valid_loss 0.494223
Epoch 31, Train Loss 0.515459, Valid_loss 0.502600
Epoch 32, Train Loss 0.513287, Valid_loss 0.487677
Epoch 33, Train Loss 0.509048, Valid_loss 0.506339
Epoch 34, Train Loss 0.518366, Valid_loss 0.489543
Epoch 35, Train Loss 0.512415, Valid_loss 0.499004
Epoch 36, Train Loss 0.507677, Valid_loss 0.499364
Epoch 37, Train Loss 0.513780, Valid_loss 0.497726
Epoch 38, Train Loss 0.513214, Valid_loss 0.499508
Epoch 39, Train Loss 0.507646, Valid_loss 0.498282
Epoch 40, Train Loss 0.500810, Valid_loss 0.499347
Epoch 41, Train Loss 0.511512, Valid_loss 0.500535
Epoch 42, Train Loss 0.502056, Valid_loss 0.494660
Epoch 43, Train Loss 0.500925, Valid_loss 0.500063
Epoch 44, Train Loss 0.504635, Valid_loss 0.493170
Epoch 45, Train Loss 0.508966, Valid_loss 0.494488
Epoch 46, Train Loss 0.505396, Valid_loss 0.495722
Epoch 47, Train Loss 0.503412, Valid_loss 0.498187
Epoch 48, Train Loss 0.501958, Valid_loss 0.492978
Epoch 49, Train Loss 0.497555, Valid_loss 0.493314
Epoch 50, Train Loss 0.497203, Valid_loss 0.495796
Epoch 51, Train Loss 0.497251, Valid_loss 0.492240
Epoch 52, Train Loss 0.501131, Valid_loss 0.493578
Epoch 53, Train Loss 0.492954, Valid_loss 0.493195
Epoch 54, Train Loss 0.502904, Valid_loss 0.492338
Epoch 55, Train Loss 0.495657, Valid_loss 0.493635
Epoch 56, Train Loss 0.497930, Valid_loss 0.490344
Epoch 57, Train Loss 0.506686, Valid_loss 0.492772
Epoch 58, Train Loss 0.494476, Valid_loss 0.491153
Epoch 59, Train Loss 0.497821, Valid_loss 0.492372
Epoch 60, Train Loss 0.490533, Valid_loss 0.492515
COVID19_Participant26 -- true: COVID-19 -- pred: COVID-19
Control_Participant5 -- true: normal -- pred: normal
COVID19_Participant26 -- true: COVID-19 -- pred: COVID-19
Control_Participant5 -- true: normal -- pred: normal
COVID19_Participant26 -- true: COVID-19 -- pred: COVID-19
Control_Participant7 -- true: normal -- pred: COVID-19
Control_Participant7 -- true: normal -- pred: COVID-19
true :  [1, 0, 1, 0, 1, 0, 0]
pred :  [1, 0, 1, 0, 1, 1, 1]
Confusion Matrix: [2 2 0 3]
Best performance: Epoch 22, Loss 0.555454, Test ACC 0.714286, Test AUC 0.916667, Test Recall 1.000000, Test Precision 0.600000
✅ Total valid splits used: 2
🔁 Repeat 3, Fold 2
🔍 Split #3
  → train_p_index 환자 수: 31
  → test_p_index 환자 수: 8
  → train 환자 ID: ['COVID19_Participant11', 'COVID19_Participant13', 'COVID19_Participant14', 'COVID19_Participant15', 'COVID19_Participant17', 'COVID19_Participant18', 'COVID19_Participant19', 'COVID19_Participant20', 'COVID19_Participant22', 'COVID19_Participant25', 'COVID19_Participant26', 'COVID19_Participant28', 'COVID19_Participant29', 'COVID19_Participant3', 'COVID19_Participant30', 'COVID19_Participant31', 'COVID19_Participant32', 'COVID19_Participant36', 'COVID19_Participant39', 'COVID19_Participant4', 'COVID19_Participant40', 'COVID19_Participant7', 'Control_Participant1', 'Control_Participant10', 'Control_Participant11', 'Control_Participant14', 'Control_Participant3', 'Control_Participant4', 'Control_Participant6', 'Control_Participant7', 'Control_Participant8']
  → test  환자 ID: ['Control_Participant4', 'COVID19_Participant26', 'COVID19_Participant26', 'COVID19_Participant31', 'COVID19_Participant13', 'Control_Participant4', 'Control_Participant7', 'Control_Participant7']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant18, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant3, Label: 1
    ID: COVID19_Participant30, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant36, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant10, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant14, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant4, Label: 0
    ID: Control_Participant6, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant8, Label: 0
  → test 환자 ID 및 라벨:
    ID: Control_Participant4, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: Control_Participant4, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant7, Label: 0
train_p_index_ 20
valid_p_index 11
test_p_index 8
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Keratinocytes', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Neurons', 'iPS_cells', 'Embryonic_stem_cells', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
data augment 실행 함
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:12,  7.66it/s]  2%|▏         | 2/100 [00:00<00:12,  8.11it/s]  4%|▍         | 4/100 [00:00<00:10,  9.02it/s]  5%|▌         | 5/100 [00:00<00:10,  8.85it/s]  6%|▌         | 6/100 [00:00<00:12,  7.37it/s]  7%|▋         | 7/100 [00:00<00:12,  7.72it/s]  8%|▊         | 8/100 [00:00<00:11,  8.16it/s]  9%|▉         | 9/100 [00:01<00:10,  8.52it/s] 10%|█         | 10/100 [00:01<00:10,  8.69it/s] 11%|█         | 11/100 [00:01<00:10,  8.25it/s] 13%|█▎        | 13/100 [00:01<00:10,  8.70it/s] 14%|█▍        | 14/100 [00:01<00:09,  8.86it/s] 15%|█▌        | 15/100 [00:01<00:09,  8.95it/s] 16%|█▌        | 16/100 [00:01<00:09,  8.90it/s] 17%|█▋        | 17/100 [00:01<00:09,  8.92it/s] 18%|█▊        | 18/100 [00:02<00:09,  8.94it/s] 19%|█▉        | 19/100 [00:02<00:09,  8.87it/s] 20%|██        | 20/100 [00:02<00:08,  8.92it/s] 21%|██        | 21/100 [00:02<00:08,  9.01it/s] 22%|██▏       | 22/100 [00:02<00:08,  9.03it/s] 23%|██▎       | 23/100 [00:02<00:08,  8.58it/s] 24%|██▍       | 24/100 [00:02<00:08,  8.87it/s] 25%|██▌       | 25/100 [00:02<00:08,  9.09it/s] 26%|██▌       | 26/100 [00:02<00:08,  9.00it/s] 27%|██▋       | 27/100 [00:03<00:08,  8.71it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.74it/s] 29%|██▉       | 29/100 [00:03<00:08,  8.63it/s] 30%|███       | 30/100 [00:03<00:08,  8.60it/s] 31%|███       | 31/100 [00:03<00:08,  8.59it/s] 32%|███▏      | 32/100 [00:03<00:08,  8.39it/s] 33%|███▎      | 33/100 [00:03<00:07,  8.47it/s] 34%|███▍      | 34/100 [00:03<00:07,  8.76it/s] 35%|███▌      | 35/100 [00:04<00:07,  8.64it/s] 36%|███▌      | 36/100 [00:04<00:07,  8.63it/s] 37%|███▋      | 37/100 [00:04<00:07,  8.58it/s] 38%|███▊      | 38/100 [00:04<00:07,  8.80it/s] 39%|███▉      | 39/100 [00:04<00:06,  8.75it/s] 40%|████      | 40/100 [00:04<00:07,  8.53it/s] 41%|████      | 41/100 [00:04<00:07,  7.55it/s] 42%|████▏     | 42/100 [00:04<00:07,  7.85it/s] 43%|████▎     | 43/100 [00:05<00:07,  7.62it/s] 44%|████▍     | 44/100 [00:05<00:07,  7.91it/s] 45%|████▌     | 45/100 [00:05<00:07,  7.32it/s] 46%|████▌     | 46/100 [00:05<00:07,  7.30it/s] 47%|████▋     | 47/100 [00:05<00:06,  7.65it/s] 48%|████▊     | 48/100 [00:05<00:06,  7.64it/s] 49%|████▉     | 49/100 [00:05<00:06,  7.84it/s] 51%|█████     | 51/100 [00:06<00:05,  8.42it/s] 52%|█████▏    | 52/100 [00:06<00:05,  8.31it/s] 53%|█████▎    | 53/100 [00:06<00:05,  8.33it/s] 54%|█████▍    | 54/100 [00:06<00:05,  8.06it/s] 55%|█████▌    | 55/100 [00:06<00:05,  8.17it/s] 56%|█████▌    | 56/100 [00:06<00:05,  8.50it/s] 57%|█████▋    | 57/100 [00:06<00:05,  8.44it/s] 58%|█████▊    | 58/100 [00:06<00:04,  8.51it/s] 59%|█████▉    | 59/100 [00:07<00:04,  8.41it/s] 60%|██████    | 60/100 [00:07<00:04,  8.35it/s] 61%|██████    | 61/100 [00:07<00:04,  8.40it/s] 62%|██████▏   | 62/100 [00:07<00:04,  8.14it/s] 63%|██████▎   | 63/100 [00:07<00:04,  8.13it/s] 64%|██████▍   | 64/100 [00:07<00:04,  8.10it/s] 65%|██████▌   | 65/100 [00:07<00:04,  8.19it/s] 66%|██████▌   | 66/100 [00:07<00:04,  8.22it/s] 67%|██████▋   | 67/100 [00:08<00:04,  8.10it/s] 68%|██████▊   | 68/100 [00:08<00:03,  8.05it/s] 69%|██████▉   | 69/100 [00:08<00:03,  8.11it/s] 70%|███████   | 70/100 [00:08<00:03,  8.05it/s] 71%|███████   | 71/100 [00:08<00:03,  7.96it/s] 72%|███████▏  | 72/100 [00:08<00:03,  7.68it/s] 73%|███████▎  | 73/100 [00:08<00:03,  7.79it/s] 74%|███████▍  | 74/100 [00:08<00:03,  7.17it/s] 75%|███████▌  | 75/100 [00:09<00:03,  6.58it/s] 76%|███████▌  | 76/100 [00:09<00:03,  6.92it/s] 77%|███████▋  | 77/100 [00:09<00:03,  7.15it/s] 78%|███████▊  | 78/100 [00:09<00:03,  7.17it/s] 79%|███████▉  | 79/100 [00:09<00:02,  7.33it/s] 80%|████████  | 80/100 [00:09<00:02,  7.72it/s] 81%|████████  | 81/100 [00:09<00:02,  7.89it/s] 82%|████████▏ | 82/100 [00:09<00:02,  8.09it/s] 83%|████████▎ | 83/100 [00:10<00:02,  8.08it/s] 84%|████████▍ | 84/100 [00:10<00:01,  8.30it/s] 85%|████████▌ | 85/100 [00:10<00:01,  8.37it/s] 86%|████████▌ | 86/100 [00:10<00:01,  8.26it/s] 87%|████████▋ | 87/100 [00:10<00:01,  7.78it/s] 88%|████████▊ | 88/100 [00:10<00:01,  8.02it/s] 89%|████████▉ | 89/100 [00:10<00:01,  8.12it/s] 90%|█████████ | 90/100 [00:10<00:01,  8.12it/s] 91%|█████████ | 91/100 [00:11<00:01,  8.14it/s] 92%|█████████▏| 92/100 [00:11<00:00,  8.01it/s] 93%|█████████▎| 93/100 [00:11<00:00,  8.06it/s] 94%|█████████▍| 94/100 [00:11<00:00,  8.24it/s] 95%|█████████▌| 95/100 [00:11<00:00,  8.09it/s] 96%|█████████▌| 96/100 [00:11<00:00,  7.89it/s] 97%|█████████▋| 97/100 [00:11<00:00,  8.07it/s] 98%|█████████▊| 98/100 [00:11<00:00,  7.79it/s] 99%|█████████▉| 99/100 [00:12<00:00,  7.85it/s]100%|██████████| 100/100 [00:12<00:00,  8.04it/s]100%|██████████| 100/100 [00:12<00:00,  8.18it/s]
eval_p_index len:  19
individual_train 120
individual_eval 19
train data의 x, y, id 길이: 120 120 120
valid data의 x, y, id 길이: 11 11 11
test data의 x, y, id 길이: 8 8 8
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.729568, Valid_loss 0.694907
Epoch 2, Train Loss 0.653998, Valid_loss 0.621994
Epoch 3, Train Loss 0.615587, Valid_loss 0.580306
Epoch 4, Train Loss 0.580922, Valid_loss 0.554635
Epoch 5, Train Loss 0.571298, Valid_loss 0.551518
Epoch 6, Train Loss 0.557001, Valid_loss 0.550362
Epoch 7, Train Loss 0.558370, Valid_loss 0.546346
Epoch 8, Train Loss 0.551641, Valid_loss 0.541851
Epoch 9, Train Loss 0.553245, Valid_loss 0.538094
Epoch 10, Train Loss 0.546650, Valid_loss 0.534557
Epoch 11, Train Loss 0.547350, Valid_loss 0.531466
Epoch 12, Train Loss 0.552227, Valid_loss 0.528763
Epoch 13, Train Loss 0.547761, Valid_loss 0.525211
Epoch 14, Train Loss 0.553948, Valid_loss 0.520808
Epoch 15, Train Loss 0.540806, Valid_loss 0.515603
Epoch 16, Train Loss 0.533745, Valid_loss 0.510276
Epoch 17, Train Loss 0.531867, Valid_loss 0.504978
Epoch 18, Train Loss 0.535367, Valid_loss 0.499328
Epoch 19, Train Loss 0.519086, Valid_loss 0.494033
Epoch 20, Train Loss 0.519674, Valid_loss 0.491753
Epoch 21, Train Loss 0.519377, Valid_loss 0.490101
Epoch 22, Train Loss 0.505491, Valid_loss 0.487670
Epoch 23, Train Loss 0.502727, Valid_loss 0.484101
Epoch 24, Train Loss 0.496773, Valid_loss 0.478942
Epoch 25, Train Loss 0.482772, Valid_loss 0.479109
Epoch 26, Train Loss 0.487634, Valid_loss 0.472692
Epoch 27, Train Loss 0.470730, Valid_loss 0.470244
Epoch 28, Train Loss 0.464809, Valid_loss 0.466046
Epoch 29, Train Loss 0.462690, Valid_loss 0.479493
Epoch 30, Train Loss 0.461252, Valid_loss 0.464596
Epoch 31, Train Loss 0.452699, Valid_loss 0.474346
Epoch 32, Train Loss 0.446988, Valid_loss 0.465999
Epoch 33, Train Loss 0.454964, Valid_loss 0.466955
Epoch 34, Train Loss 0.440071, Valid_loss 0.463384
Epoch 35, Train Loss 0.448555, Valid_loss 0.450939
Epoch 36, Train Loss 0.438708, Valid_loss 0.465236
Epoch 37, Train Loss 0.437730, Valid_loss 0.460602
Epoch 38, Train Loss 0.437277, Valid_loss 0.440802
Epoch 39, Train Loss 0.435899, Valid_loss 0.458926
Epoch 40, Train Loss 0.433577, Valid_loss 0.436125
Epoch 41, Train Loss 0.427404, Valid_loss 0.452109
Epoch 42, Train Loss 0.426831, Valid_loss 0.436392
Epoch 43, Train Loss 0.423420, Valid_loss 0.439412
Epoch 44, Train Loss 0.428719, Valid_loss 0.444077
Epoch 45, Train Loss 0.425067, Valid_loss 0.433392
Epoch 46, Train Loss 0.431892, Valid_loss 0.433866
Epoch 47, Train Loss 0.425586, Valid_loss 0.446850
Epoch 48, Train Loss 0.420388, Valid_loss 0.424284
Epoch 49, Train Loss 0.425679, Valid_loss 0.435944
Epoch 50, Train Loss 0.423087, Valid_loss 0.426861
Epoch 51, Train Loss 0.418676, Valid_loss 0.425302
Epoch 52, Train Loss 0.421984, Valid_loss 0.428810
Epoch 53, Train Loss 0.414490, Valid_loss 0.423639
Epoch 54, Train Loss 0.422973, Valid_loss 0.424628
Epoch 55, Train Loss 0.413504, Valid_loss 0.424908
Control_Participant4 -- true: normal -- pred: normal
COVID19_Participant26 -- true: COVID-19 -- pred: normal
COVID19_Participant26 -- true: COVID-19 -- pred: COVID-19
COVID19_Participant31 -- true: COVID-19 -- pred: COVID-19
COVID19_Participant13 -- true: COVID-19 -- pred: COVID-19
Control_Participant4 -- true: normal -- pred: normal
Control_Participant7 -- true: normal -- pred: normal
Control_Participant7 -- true: normal -- pred: COVID-19
true :  [0, 1, 1, 1, 1, 0, 0, 0]
pred :  [0, 0, 1, 1, 1, 0, 0, 1]
Confusion Matrix: [3 1 1 3]
Best performance: Epoch 53, Loss 0.414490, Test ACC 0.750000, Test AUC 0.812500, Test Recall 0.750000, Test Precision 0.750000
✅ Total valid splits used: 3
🔁 Repeat 3, Fold 3
🔍 Split #4
  → train_p_index 환자 수: 30
  → test_p_index 환자 수: 9
  → train 환자 ID: ['COVID19_Participant11', 'COVID19_Participant12', 'COVID19_Participant13', 'COVID19_Participant14', 'COVID19_Participant15', 'COVID19_Participant17', 'COVID19_Participant18', 'COVID19_Participant19', 'COVID19_Participant2', 'COVID19_Participant23', 'COVID19_Participant25', 'COVID19_Participant29', 'COVID19_Participant3', 'COVID19_Participant30', 'COVID19_Participant31', 'COVID19_Participant36', 'COVID19_Participant37', 'COVID19_Participant39', 'COVID19_Participant40', 'COVID19_Participant7', 'COVID19_Participant8', 'Control_Participant1', 'Control_Participant10', 'Control_Participant11', 'Control_Participant15', 'Control_Participant4', 'Control_Participant5', 'Control_Participant7', 'Control_Participant8', 'Control_Participant9']
  → test  환자 ID: ['Control_Participant10', 'Control_Participant5', 'Control_Participant7', 'COVID19_Participant25', 'Control_Participant9', 'Control_Participant1', 'Control_Participant10', 'COVID19_Participant13', 'Control_Participant10']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant12, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant18, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant3, Label: 1
    ID: COVID19_Participant30, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant36, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant10, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant4, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant8, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: Control_Participant10, Label: 1
    ID: Control_Participant5, Label: 1
    ID: Control_Participant7, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: Control_Participant9, Label: 1
    ID: Control_Participant1, Label: 1
    ID: Control_Participant10, Label: 0
    ID: COVID19_Participant13, Label: 0
    ID: Control_Participant10, Label: 0
train_p_index_ 20
valid_p_index 10
test_p_index 9
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Keratinocytes', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Neurons', 'iPS_cells', 'Embryonic_stem_cells', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
data augment 실행 함
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:10,  9.14it/s]  3%|▎         | 3/100 [00:00<00:10,  9.06it/s]  4%|▍         | 4/100 [00:00<00:10,  8.88it/s]  6%|▌         | 6/100 [00:00<00:10,  8.94it/s]  7%|▋         | 7/100 [00:00<00:10,  9.09it/s]  8%|▊         | 8/100 [00:00<00:09,  9.25it/s]  9%|▉         | 9/100 [00:00<00:09,  9.22it/s] 10%|█         | 10/100 [00:01<00:09,  9.11it/s] 11%|█         | 11/100 [00:01<00:09,  8.94it/s] 12%|█▏        | 12/100 [00:01<00:09,  9.16it/s] 13%|█▎        | 13/100 [00:01<00:11,  7.39it/s] 14%|█▍        | 14/100 [00:01<00:11,  7.82it/s] 16%|█▌        | 16/100 [00:01<00:09,  8.54it/s] 18%|█▊        | 18/100 [00:02<00:09,  8.92it/s] 19%|█▉        | 19/100 [00:02<00:09,  8.83it/s] 20%|██        | 20/100 [00:02<00:09,  8.83it/s] 21%|██        | 21/100 [00:02<00:09,  8.34it/s] 22%|██▏       | 22/100 [00:02<00:09,  8.26it/s] 23%|██▎       | 23/100 [00:02<00:09,  8.37it/s] 24%|██▍       | 24/100 [00:02<00:08,  8.57it/s] 25%|██▌       | 25/100 [00:02<00:08,  8.58it/s] 26%|██▌       | 26/100 [00:03<00:09,  8.13it/s] 27%|██▋       | 27/100 [00:03<00:08,  8.22it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.30it/s] 29%|██▉       | 29/100 [00:03<00:08,  8.43it/s] 31%|███       | 31/100 [00:03<00:07,  8.79it/s] 32%|███▏      | 32/100 [00:03<00:07,  8.79it/s] 33%|███▎      | 33/100 [00:03<00:07,  8.80it/s] 34%|███▍      | 34/100 [00:03<00:07,  8.60it/s] 35%|███▌      | 35/100 [00:04<00:07,  8.59it/s] 36%|███▌      | 36/100 [00:04<00:08,  8.00it/s] 37%|███▋      | 37/100 [00:04<00:07,  8.05it/s] 38%|███▊      | 38/100 [00:04<00:08,  7.68it/s] 39%|███▉      | 39/100 [00:04<00:07,  8.04it/s] 40%|████      | 40/100 [00:04<00:07,  8.47it/s] 41%|████      | 41/100 [00:04<00:06,  8.81it/s] 42%|████▏     | 42/100 [00:04<00:06,  8.72it/s] 43%|████▎     | 43/100 [00:05<00:06,  9.04it/s] 44%|████▍     | 44/100 [00:05<00:07,  7.71it/s] 45%|████▌     | 45/100 [00:05<00:06,  8.17it/s] 46%|████▌     | 46/100 [00:05<00:06,  8.63it/s] 47%|████▋     | 47/100 [00:05<00:06,  8.49it/s] 48%|████▊     | 48/100 [00:05<00:06,  8.05it/s] 49%|████▉     | 49/100 [00:05<00:06,  8.03it/s] 50%|█████     | 50/100 [00:05<00:06,  8.04it/s] 51%|█████     | 51/100 [00:05<00:05,  8.47it/s] 52%|█████▏    | 52/100 [00:06<00:05,  8.40it/s] 53%|█████▎    | 53/100 [00:06<00:05,  8.26it/s] 54%|█████▍    | 54/100 [00:06<00:05,  8.59it/s] 55%|█████▌    | 55/100 [00:06<00:05,  8.77it/s] 56%|█████▌    | 56/100 [00:06<00:04,  8.83it/s] 57%|█████▋    | 57/100 [00:06<00:05,  8.58it/s] 58%|█████▊    | 58/100 [00:06<00:04,  8.74it/s] 59%|█████▉    | 59/100 [00:06<00:04,  8.59it/s] 60%|██████    | 60/100 [00:07<00:04,  8.56it/s] 61%|██████    | 61/100 [00:07<00:04,  8.75it/s] 62%|██████▏   | 62/100 [00:07<00:04,  8.36it/s] 63%|██████▎   | 63/100 [00:07<00:04,  8.23it/s] 64%|██████▍   | 64/100 [00:07<00:04,  7.85it/s] 65%|██████▌   | 65/100 [00:07<00:04,  8.31it/s] 66%|██████▌   | 66/100 [00:07<00:04,  7.77it/s] 67%|██████▋   | 67/100 [00:07<00:04,  7.90it/s] 68%|██████▊   | 68/100 [00:08<00:03,  8.09it/s] 69%|██████▉   | 69/100 [00:08<00:03,  8.55it/s] 70%|███████   | 70/100 [00:08<00:03,  8.54it/s] 71%|███████   | 71/100 [00:08<00:03,  8.58it/s] 72%|███████▏  | 72/100 [00:08<00:03,  8.61it/s] 73%|███████▎  | 73/100 [00:08<00:03,  8.70it/s] 74%|███████▍  | 74/100 [00:08<00:02,  8.80it/s] 75%|███████▌  | 75/100 [00:08<00:03,  8.29it/s] 76%|███████▌  | 76/100 [00:09<00:03,  7.17it/s] 77%|███████▋  | 77/100 [00:09<00:02,  7.73it/s] 78%|███████▊  | 78/100 [00:09<00:02,  7.80it/s] 79%|███████▉  | 79/100 [00:09<00:02,  8.16it/s] 80%|████████  | 80/100 [00:09<00:02,  8.42it/s] 81%|████████  | 81/100 [00:09<00:02,  8.41it/s] 82%|████████▏ | 82/100 [00:09<00:02,  8.50it/s] 83%|████████▎ | 83/100 [00:09<00:02,  8.32it/s] 84%|████████▍ | 84/100 [00:09<00:01,  8.00it/s] 85%|████████▌ | 85/100 [00:10<00:01,  7.98it/s] 86%|████████▌ | 86/100 [00:10<00:01,  7.86it/s] 87%|████████▋ | 87/100 [00:10<00:01,  7.85it/s] 88%|████████▊ | 88/100 [00:10<00:01,  8.12it/s] 89%|████████▉ | 89/100 [00:10<00:01,  8.26it/s] 90%|█████████ | 90/100 [00:10<00:01,  8.28it/s] 91%|█████████ | 91/100 [00:10<00:01,  8.13it/s] 92%|█████████▏| 92/100 [00:10<00:01,  7.98it/s] 93%|█████████▎| 93/100 [00:11<00:00,  8.01it/s] 94%|█████████▍| 94/100 [00:11<00:00,  7.96it/s] 95%|█████████▌| 95/100 [00:11<00:00,  8.07it/s] 96%|█████████▌| 96/100 [00:11<00:00,  8.22it/s] 97%|█████████▋| 97/100 [00:11<00:00,  8.05it/s] 98%|█████████▊| 98/100 [00:11<00:00,  8.04it/s] 99%|█████████▉| 99/100 [00:11<00:00,  8.06it/s]100%|██████████| 100/100 [00:11<00:00,  8.18it/s]100%|██████████| 100/100 [00:11<00:00,  8.36it/s]
eval_p_index len:  19
individual_train 120
individual_eval 19
train data의 x, y, id 길이: 120 120 120
valid data의 x, y, id 길이: 10 10 10
test data의 x, y, id 길이: 9 9 9
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.649075, Valid_loss 0.645644
Epoch 2, Train Loss 0.619282, Valid_loss 0.626928
Epoch 3, Train Loss 0.615855, Valid_loss 0.613944
Epoch 4, Train Loss 0.597623, Valid_loss 0.602203
Epoch 5, Train Loss 0.590491, Valid_loss 0.587917
Epoch 6, Train Loss 0.564979, Valid_loss 0.570396
Epoch 7, Train Loss 0.549747, Valid_loss 0.551211
Epoch 8, Train Loss 0.534850, Valid_loss 0.531536
Epoch 9, Train Loss 0.525714, Valid_loss 0.513502
Epoch 10, Train Loss 0.507124, Valid_loss 0.493076
Epoch 11, Train Loss 0.491712, Valid_loss 0.476549
Epoch 12, Train Loss 0.477745, Valid_loss 0.461108
Epoch 13, Train Loss 0.457959, Valid_loss 0.445181
Epoch 14, Train Loss 0.452809, Valid_loss 0.424998
Epoch 15, Train Loss 0.445148, Valid_loss 0.413973
Epoch 16, Train Loss 0.430442, Valid_loss 0.406961
Epoch 17, Train Loss 0.425657, Valid_loss 0.399587
Epoch 18, Train Loss 0.414755, Valid_loss 0.392891
Epoch 19, Train Loss 0.422539, Valid_loss 0.389077
Epoch 20, Train Loss 0.414008, Valid_loss 0.382374
Epoch 21, Train Loss 0.410867, Valid_loss 0.378811
Epoch 22, Train Loss 0.414084, Valid_loss 0.375526
Epoch 23, Train Loss 0.409772, Valid_loss 0.371537
Epoch 24, Train Loss 0.403715, Valid_loss 0.366345
Epoch 25, Train Loss 0.401484, Valid_loss 0.363241
Epoch 26, Train Loss 0.399706, Valid_loss 0.362038
Epoch 27, Train Loss 0.402817, Valid_loss 0.358873
Epoch 28, Train Loss 0.393968, Valid_loss 0.354458
Epoch 29, Train Loss 0.393426, Valid_loss 0.353643
Epoch 30, Train Loss 0.397760, Valid_loss 0.350188
Epoch 31, Train Loss 0.392577, Valid_loss 0.347558
Epoch 32, Train Loss 0.388874, Valid_loss 0.345236
Epoch 33, Train Loss 0.383843, Valid_loss 0.343577
Epoch 34, Train Loss 0.386659, Valid_loss 0.340272
Epoch 35, Train Loss 0.388423, Valid_loss 0.335646
Epoch 36, Train Loss 0.381127, Valid_loss 0.334031
Epoch 37, Train Loss 0.386406, Valid_loss 0.335124
Epoch 38, Train Loss 0.388015, Valid_loss 0.328286
Epoch 39, Train Loss 0.379933, Valid_loss 0.326937
Epoch 40, Train Loss 0.375082, Valid_loss 0.326280
Epoch 41, Train Loss 0.381844, Valid_loss 0.322736
Epoch 42, Train Loss 0.383881, Valid_loss 0.322280
Epoch 43, Train Loss 0.375944, Valid_loss 0.320950
Epoch 44, Train Loss 0.376345, Valid_loss 0.317661
Epoch 45, Train Loss 0.379069, Valid_loss 0.317594
Epoch 46, Train Loss 0.377029, Valid_loss 0.316487
Epoch 47, Train Loss 0.378048, Valid_loss 0.312922
Epoch 48, Train Loss 0.371414, Valid_loss 0.313864
Epoch 49, Train Loss 0.373563, Valid_loss 0.309325
Epoch 50, Train Loss 0.366378, Valid_loss 0.311147
Epoch 51, Train Loss 0.371241, Valid_loss 0.307274
Epoch 52, Train Loss 0.371199, Valid_loss 0.305690
Epoch 53, Train Loss 0.373496, Valid_loss 0.306215
Epoch 54, Train Loss 0.362255, Valid_loss 0.304507
Epoch 55, Train Loss 0.359832, Valid_loss 0.305518
Epoch 56, Train Loss 0.368223, Valid_loss 0.303436
Epoch 57, Train Loss 0.375328, Valid_loss 0.300878
Epoch 58, Train Loss 0.375928, Valid_loss 0.301726
Epoch 59, Train Loss 0.361329, Valid_loss 0.299407
Epoch 60, Train Loss 0.367346, Valid_loss 0.299327
Epoch 61, Train Loss 0.358355, Valid_loss 0.298826
Epoch 62, Train Loss 0.362143, Valid_loss 0.298382
Epoch 63, Train Loss 0.360481, Valid_loss 0.296896
Epoch 64, Train Loss 0.369688, Valid_loss 0.296139
Epoch 65, Train Loss 0.363844, Valid_loss 0.296695
Epoch 66, Train Loss 0.357339, Valid_loss 0.295116
Epoch 67, Train Loss 0.365063, Valid_loss 0.296097
Epoch 68, Train Loss 0.365969, Valid_loss 0.292100
Epoch 69, Train Loss 0.366039, Valid_loss 0.293224
Epoch 70, Train Loss 0.362005, Valid_loss 0.292818
Epoch 71, Train Loss 0.356686, Valid_loss 0.290969
Epoch 72, Train Loss 0.359984, Valid_loss 0.290760
Epoch 73, Train Loss 0.368104, Valid_loss 0.289607
Epoch 74, Train Loss 0.357860, Valid_loss 0.291120
Epoch 75, Train Loss 0.362405, Valid_loss 0.287756
Epoch 76, Train Loss 0.360038, Valid_loss 0.287406
Epoch 77, Train Loss 0.352305, Valid_loss 0.287575
Epoch 78, Train Loss 0.356366, Valid_loss 0.287534
Epoch 79, Train Loss 0.367827, Valid_loss 0.286249
Epoch 80, Train Loss 0.360765, Valid_loss 0.283181
Epoch 81, Train Loss 0.355558, Valid_loss 0.284915
Epoch 82, Train Loss 0.354230, Valid_loss 0.284224
Epoch 83, Train Loss 0.360262, Valid_loss 0.283130
Epoch 84, Train Loss 0.351804, Valid_loss 0.281423
Epoch 85, Train Loss 0.357159, Valid_loss 0.282063
Epoch 86, Train Loss 0.353798, Valid_loss 0.281269
Epoch 87, Train Loss 0.349133, Valid_loss 0.279848
Epoch 88, Train Loss 0.357833, Valid_loss 0.280266
Epoch 89, Train Loss 0.356253, Valid_loss 0.279124
Epoch 90, Train Loss 0.349116, Valid_loss 0.277721
Epoch 91, Train Loss 0.356051, Valid_loss 0.277068
Epoch 92, Train Loss 0.348713, Valid_loss 0.276803
Epoch 93, Train Loss 0.348289, Valid_loss 0.276536
Epoch 94, Train Loss 0.351659, Valid_loss 0.275352
Epoch 95, Train Loss 0.349621, Valid_loss 0.275190
Epoch 96, Train Loss 0.354375, Valid_loss 0.274641
Epoch 97, Train Loss 0.355186, Valid_loss 0.274212
Epoch 98, Train Loss 0.341946, Valid_loss 0.273899
Epoch 99, Train Loss 0.350906, Valid_loss 0.273951
Epoch 100, Train Loss 0.350520, Valid_loss 0.271842
Control_Participant10 -- true: normal -- pred: COVID-19
Control_Participant5 -- true: normal -- pred: normal
Control_Participant7 -- true: normal -- pred: normal
COVID19_Participant25 -- true: COVID-19 -- pred: COVID-19
Control_Participant9 -- true: normal -- pred: normal
Control_Participant1 -- true: normal -- pred: COVID-19
Control_Participant10 -- true: normal -- pred: normal
COVID19_Participant13 -- true: COVID-19 -- pred: COVID-19
Control_Participant10 -- true: normal -- pred: normal
true :  [0, 0, 0, 1, 0, 0, 0, 1, 0]
pred :  [1, 0, 0, 1, 0, 1, 0, 1, 0]
Confusion Matrix: [5 2 0 2]
Best performance: Epoch 100, Loss 0.350520, Test ACC 0.777778, Test AUC 1.000000, Test Recall 1.000000, Test Precision 0.500000
✅ Total valid splits used: 4
🔁 Repeat 3, Fold 4
🔍 Split #5
  → train_p_index 환자 수: 32
  → test_p_index 환자 수: 7
  → train 환자 ID: ['COVID19_Participant11', 'COVID19_Participant12', 'COVID19_Participant15', 'COVID19_Participant17', 'COVID19_Participant18', 'COVID19_Participant19', 'COVID19_Participant2', 'COVID19_Participant20', 'COVID19_Participant22', 'COVID19_Participant23', 'COVID19_Participant25', 'COVID19_Participant26', 'COVID19_Participant28', 'COVID19_Participant3', 'COVID19_Participant30', 'COVID19_Participant31', 'COVID19_Participant32', 'COVID19_Participant37', 'COVID19_Participant39', 'COVID19_Participant4', 'COVID19_Participant40', 'COVID19_Participant7', 'COVID19_Participant8', 'Control_Participant1', 'Control_Participant10', 'Control_Participant14', 'Control_Participant15', 'Control_Participant3', 'Control_Participant4', 'Control_Participant5', 'Control_Participant6', 'Control_Participant9']
  → test  환자 ID: ['COVID19_Participant26', 'Control_Participant4', 'COVID19_Participant11', 'Control_Participant4', 'COVID19_Participant25', 'COVID19_Participant31', 'Control_Participant5']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant12, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant18, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant3, Label: 1
    ID: COVID19_Participant30, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant10, Label: 0
    ID: Control_Participant14, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant4, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant6, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: COVID19_Participant26, Label: 1
    ID: Control_Participant4, Label: 1
    ID: COVID19_Participant11, Label: 1
    ID: Control_Participant4, Label: 1
    ID: COVID19_Participant25, Label: 0
    ID: COVID19_Participant31, Label: 0
    ID: Control_Participant5, Label: 0
train_p_index_ 21
valid_p_index 11
test_p_index 7
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Epithelial_cells', 'Epithelial_cells', 'NK_cell', 'Epithelial_cells', 'Epithelial_cells', 'Keratinocytes', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
data augment 실행 함
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:18,  5.32it/s]  2%|▏         | 2/100 [00:00<00:14,  6.79it/s]  3%|▎         | 3/100 [00:00<00:12,  7.91it/s]  5%|▌         | 5/100 [00:00<00:10,  8.97it/s]  6%|▌         | 6/100 [00:00<00:10,  8.83it/s]  7%|▋         | 7/100 [00:00<00:10,  8.47it/s]  8%|▊         | 8/100 [00:00<00:10,  8.43it/s]  9%|▉         | 9/100 [00:01<00:10,  8.56it/s] 10%|█         | 10/100 [00:01<00:10,  8.63it/s] 11%|█         | 11/100 [00:01<00:10,  8.81it/s] 12%|█▏        | 12/100 [00:01<00:10,  8.62it/s] 13%|█▎        | 13/100 [00:01<00:10,  8.48it/s] 14%|█▍        | 14/100 [00:01<00:10,  8.31it/s] 15%|█▌        | 15/100 [00:01<00:11,  7.30it/s] 16%|█▌        | 16/100 [00:01<00:10,  7.81it/s] 17%|█▋        | 17/100 [00:02<00:10,  8.09it/s] 18%|█▊        | 18/100 [00:02<00:09,  8.55it/s] 19%|█▉        | 19/100 [00:02<00:09,  8.68it/s] 20%|██        | 20/100 [00:02<00:09,  8.57it/s] 21%|██        | 21/100 [00:02<00:09,  8.70it/s] 22%|██▏       | 22/100 [00:02<00:09,  8.55it/s] 23%|██▎       | 23/100 [00:02<00:08,  8.60it/s] 24%|██▍       | 24/100 [00:02<00:08,  8.78it/s] 25%|██▌       | 25/100 [00:02<00:08,  8.38it/s] 26%|██▌       | 26/100 [00:03<00:08,  8.31it/s] 27%|██▋       | 27/100 [00:03<00:09,  7.85it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.09it/s] 29%|██▉       | 29/100 [00:03<00:08,  8.54it/s] 30%|███       | 30/100 [00:03<00:08,  8.63it/s] 31%|███       | 31/100 [00:03<00:08,  8.43it/s] 32%|███▏      | 32/100 [00:03<00:07,  8.55it/s] 33%|███▎      | 33/100 [00:03<00:07,  8.56it/s] 34%|███▍      | 34/100 [00:04<00:07,  8.75it/s] 35%|███▌      | 35/100 [00:04<00:07,  8.75it/s] 36%|███▌      | 36/100 [00:04<00:07,  8.50it/s] 37%|███▋      | 37/100 [00:04<00:07,  8.71it/s] 38%|███▊      | 38/100 [00:04<00:07,  8.63it/s] 39%|███▉      | 39/100 [00:04<00:06,  8.82it/s] 40%|████      | 40/100 [00:04<00:06,  8.75it/s] 41%|████      | 41/100 [00:04<00:07,  8.06it/s] 42%|████▏     | 42/100 [00:05<00:07,  8.07it/s] 43%|████▎     | 43/100 [00:05<00:07,  7.83it/s] 44%|████▍     | 44/100 [00:05<00:06,  8.17it/s] 45%|████▌     | 45/100 [00:05<00:06,  8.24it/s] 46%|████▌     | 46/100 [00:05<00:06,  8.05it/s] 47%|████▋     | 47/100 [00:05<00:07,  7.30it/s] 48%|████▊     | 48/100 [00:05<00:06,  7.74it/s] 49%|████▉     | 49/100 [00:05<00:06,  8.13it/s] 50%|█████     | 50/100 [00:06<00:06,  8.09it/s] 51%|█████     | 51/100 [00:06<00:06,  7.63it/s] 52%|█████▏    | 52/100 [00:06<00:06,  7.99it/s] 53%|█████▎    | 53/100 [00:06<00:05,  8.04it/s] 54%|█████▍    | 54/100 [00:06<00:05,  8.21it/s] 55%|█████▌    | 55/100 [00:06<00:05,  8.38it/s] 56%|█████▌    | 56/100 [00:06<00:05,  8.41it/s] 57%|█████▋    | 57/100 [00:06<00:05,  8.07it/s] 58%|█████▊    | 58/100 [00:07<00:05,  8.24it/s] 59%|█████▉    | 59/100 [00:07<00:05,  8.16it/s] 60%|██████    | 60/100 [00:07<00:04,  8.32it/s] 61%|██████    | 61/100 [00:07<00:04,  8.26it/s] 62%|██████▏   | 62/100 [00:07<00:05,  6.98it/s] 63%|██████▎   | 63/100 [00:07<00:04,  7.45it/s] 64%|██████▍   | 64/100 [00:07<00:04,  7.69it/s] 65%|██████▌   | 65/100 [00:07<00:04,  7.77it/s] 66%|██████▌   | 66/100 [00:08<00:04,  7.78it/s] 67%|██████▋   | 67/100 [00:08<00:04,  8.06it/s] 68%|██████▊   | 68/100 [00:08<00:05,  6.06it/s] 69%|██████▉   | 69/100 [00:08<00:04,  6.59it/s] 70%|███████   | 70/100 [00:08<00:04,  7.08it/s] 71%|███████   | 71/100 [00:08<00:03,  7.36it/s] 72%|███████▏  | 72/100 [00:08<00:03,  7.88it/s] 73%|███████▎  | 73/100 [00:09<00:03,  8.04it/s] 74%|███████▍  | 74/100 [00:09<00:03,  8.22it/s] 75%|███████▌  | 75/100 [00:09<00:03,  8.22it/s] 76%|███████▌  | 76/100 [00:09<00:02,  8.29it/s] 77%|███████▋  | 77/100 [00:09<00:03,  7.19it/s] 78%|███████▊  | 78/100 [00:09<00:02,  7.38it/s] 79%|███████▉  | 79/100 [00:09<00:02,  7.63it/s] 80%|████████  | 80/100 [00:09<00:02,  7.97it/s] 81%|████████  | 81/100 [00:10<00:02,  7.75it/s] 82%|████████▏ | 82/100 [00:10<00:02,  8.12it/s] 83%|████████▎ | 83/100 [00:10<00:02,  8.16it/s] 84%|████████▍ | 84/100 [00:10<00:01,  8.21it/s] 85%|████████▌ | 85/100 [00:10<00:01,  8.32it/s] 86%|████████▌ | 86/100 [00:10<00:01,  8.44it/s] 87%|████████▋ | 87/100 [00:10<00:01,  8.19it/s] 88%|████████▊ | 88/100 [00:10<00:01,  8.06it/s] 89%|████████▉ | 89/100 [00:11<00:01,  7.57it/s] 90%|█████████ | 90/100 [00:11<00:01,  7.20it/s] 91%|█████████ | 91/100 [00:11<00:01,  7.41it/s] 92%|█████████▏| 92/100 [00:11<00:01,  7.71it/s] 93%|█████████▎| 93/100 [00:11<00:00,  7.66it/s] 94%|█████████▍| 94/100 [00:11<00:00,  7.78it/s] 95%|█████████▌| 95/100 [00:11<00:00,  7.84it/s] 96%|█████████▌| 96/100 [00:11<00:00,  7.89it/s] 97%|█████████▋| 97/100 [00:12<00:00,  7.85it/s] 98%|█████████▊| 98/100 [00:12<00:00,  8.08it/s] 99%|█████████▉| 99/100 [00:12<00:00,  8.12it/s]100%|██████████| 100/100 [00:12<00:00,  7.96it/s]100%|██████████| 100/100 [00:12<00:00,  8.04it/s]
eval_p_index len:  18
individual_train 121
individual_eval 18
train data의 x, y, id 길이: 121 121 121
valid data의 x, y, id 길이: 11 11 11
test data의 x, y, id 길이: 7 7 7
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.625752, Valid_loss 0.573370
Epoch 2, Train Loss 0.587633, Valid_loss 0.540920
Epoch 3, Train Loss 0.566286, Valid_loss 0.530088
Epoch 4, Train Loss 0.559894, Valid_loss 0.514977
Epoch 5, Train Loss 0.533959, Valid_loss 0.499470
Epoch 6, Train Loss 0.518141, Valid_loss 0.479935
Epoch 7, Train Loss 0.512731, Valid_loss 0.466767
Epoch 8, Train Loss 0.508399, Valid_loss 0.458656
Epoch 9, Train Loss 0.509227, Valid_loss 0.450061
Epoch 10, Train Loss 0.498807, Valid_loss 0.445689
Epoch 11, Train Loss 0.484109, Valid_loss 0.441171
Epoch 12, Train Loss 0.482585, Valid_loss 0.433678
Epoch 13, Train Loss 0.478696, Valid_loss 0.429913
Epoch 14, Train Loss 0.480603, Valid_loss 0.424089
Epoch 15, Train Loss 0.465479, Valid_loss 0.420034
Epoch 16, Train Loss 0.474536, Valid_loss 0.417261
Epoch 17, Train Loss 0.465917, Valid_loss 0.413408
Epoch 18, Train Loss 0.470133, Valid_loss 0.409191
Epoch 19, Train Loss 0.463371, Valid_loss 0.402027
Epoch 20, Train Loss 0.454959, Valid_loss 0.404399
Epoch 21, Train Loss 0.459437, Valid_loss 0.392670
Epoch 22, Train Loss 0.448154, Valid_loss 0.396170
Epoch 23, Train Loss 0.446467, Valid_loss 0.386289
Epoch 24, Train Loss 0.448674, Valid_loss 0.386905
Epoch 25, Train Loss 0.443830, Valid_loss 0.380787
Epoch 26, Train Loss 0.446095, Valid_loss 0.375522
Epoch 27, Train Loss 0.444027, Valid_loss 0.380179
Epoch 28, Train Loss 0.440240, Valid_loss 0.372158
Epoch 29, Train Loss 0.435033, Valid_loss 0.371318
Epoch 30, Train Loss 0.435145, Valid_loss 0.370345
Epoch 31, Train Loss 0.443488, Valid_loss 0.365049
Epoch 32, Train Loss 0.440156, Valid_loss 0.368681
Epoch 33, Train Loss 0.431722, Valid_loss 0.361938
Epoch 34, Train Loss 0.435502, Valid_loss 0.364033
Epoch 35, Train Loss 0.428469, Valid_loss 0.359367
Epoch 36, Train Loss 0.434651, Valid_loss 0.360172
Epoch 37, Train Loss 0.432043, Valid_loss 0.354889
Epoch 38, Train Loss 0.430209, Valid_loss 0.359719
Epoch 39, Train Loss 0.430339, Valid_loss 0.354645
Epoch 40, Train Loss 0.422798, Valid_loss 0.353415
Epoch 41, Train Loss 0.425842, Valid_loss 0.353078
Epoch 42, Train Loss 0.427242, Valid_loss 0.348743
Epoch 43, Train Loss 0.417833, Valid_loss 0.351651
Epoch 44, Train Loss 0.424337, Valid_loss 0.347574
Epoch 45, Train Loss 0.423519, Valid_loss 0.344835
Epoch 46, Train Loss 0.424032, Valid_loss 0.348149
Epoch 47, Train Loss 0.425503, Valid_loss 0.343067
Epoch 48, Train Loss 0.416607, Valid_loss 0.342191
Epoch 49, Train Loss 0.420169, Valid_loss 0.340168
Epoch 50, Train Loss 0.417155, Valid_loss 0.341069
Epoch 51, Train Loss 0.423487, Valid_loss 0.339033
Epoch 52, Train Loss 0.412689, Valid_loss 0.338116
Epoch 53, Train Loss 0.421652, Valid_loss 0.338507
Epoch 54, Train Loss 0.415022, Valid_loss 0.337399
Epoch 55, Train Loss 0.419127, Valid_loss 0.336262
Epoch 56, Train Loss 0.408444, Valid_loss 0.335991
Epoch 57, Train Loss 0.414798, Valid_loss 0.334571
Epoch 58, Train Loss 0.418441, Valid_loss 0.334300
Epoch 59, Train Loss 0.409049, Valid_loss 0.333428
Epoch 60, Train Loss 0.414915, Valid_loss 0.333138
Epoch 61, Train Loss 0.420428, Valid_loss 0.331646
Epoch 62, Train Loss 0.411589, Valid_loss 0.332385
Epoch 63, Train Loss 0.411146, Valid_loss 0.329809
Epoch 64, Train Loss 0.411162, Valid_loss 0.330688
Epoch 65, Train Loss 0.408828, Valid_loss 0.329257
Epoch 66, Train Loss 0.408594, Valid_loss 0.328963
Epoch 67, Train Loss 0.409363, Valid_loss 0.327533
Epoch 68, Train Loss 0.414179, Valid_loss 0.327508
Epoch 69, Train Loss 0.410035, Valid_loss 0.326176
Epoch 70, Train Loss 0.407519, Valid_loss 0.324983
Epoch 71, Train Loss 0.409799, Valid_loss 0.325378
Epoch 72, Train Loss 0.409259, Valid_loss 0.323297
Epoch 73, Train Loss 0.404312, Valid_loss 0.323574
Epoch 74, Train Loss 0.404605, Valid_loss 0.321435
Epoch 75, Train Loss 0.404167, Valid_loss 0.321880
Epoch 76, Train Loss 0.400435, Valid_loss 0.320329
Epoch 77, Train Loss 0.406250, Valid_loss 0.319764
Epoch 78, Train Loss 0.406996, Valid_loss 0.319152
Epoch 79, Train Loss 0.404041, Valid_loss 0.318177
Epoch 80, Train Loss 0.405512, Valid_loss 0.317131
Epoch 81, Train Loss 0.400795, Valid_loss 0.318513
Epoch 82, Train Loss 0.399031, Valid_loss 0.315832
Epoch 83, Train Loss 0.406955, Valid_loss 0.315581
Epoch 84, Train Loss 0.406270, Valid_loss 0.314996
Epoch 85, Train Loss 0.397912, Valid_loss 0.314045
Epoch 86, Train Loss 0.401454, Valid_loss 0.313811
Epoch 87, Train Loss 0.400538, Valid_loss 0.312168
Epoch 88, Train Loss 0.393493, Valid_loss 0.312337
Epoch 89, Train Loss 0.398226, Valid_loss 0.311003
Epoch 90, Train Loss 0.398701, Valid_loss 0.311302
Epoch 91, Train Loss 0.397723, Valid_loss 0.309061
Epoch 92, Train Loss 0.396233, Valid_loss 0.309867
Epoch 93, Train Loss 0.398877, Valid_loss 0.308119
Epoch 94, Train Loss 0.403341, Valid_loss 0.308415
Epoch 95, Train Loss 0.397173, Valid_loss 0.307502
Epoch 96, Train Loss 0.399966, Valid_loss 0.306160
Epoch 97, Train Loss 0.392305, Valid_loss 0.306214
Epoch 98, Train Loss 0.396693, Valid_loss 0.305172
Epoch 99, Train Loss 0.396521, Valid_loss 0.305286
Epoch 100, Train Loss 0.389374, Valid_loss 0.303847
COVID19_Participant26 -- true: COVID-19 -- pred: COVID-19
Control_Participant4 -- true: normal -- pred: COVID-19
COVID19_Participant11 -- true: COVID-19 -- pred: normal
Control_Participant4 -- true: normal -- pred: normal
COVID19_Participant25 -- true: COVID-19 -- pred: COVID-19
COVID19_Participant31 -- true: COVID-19 -- pred: COVID-19
Control_Participant5 -- true: normal -- pred: COVID-19
true :  [1, 0, 1, 0, 1, 1, 0]
pred :  [1, 1, 0, 0, 1, 1, 1]
Confusion Matrix: [1 2 1 3]
Best performance: Epoch 100, Loss 0.389374, Test ACC 0.571429, Test AUC 0.666667, Test Recall 0.750000, Test Precision 0.600000
✅ Total valid splits used: 5

📌 Repeat 3: 평균 AUC = 0.8792, 표준편차 = 0.1267
🔁 Repeat 4, Fold 0
🔍 Split #1
  → train_p_index 환자 수: 33
  → test_p_index 환자 수: 6
  → train 환자 ID: ['COVID19_Participant11', 'COVID19_Participant12', 'COVID19_Participant13', 'COVID19_Participant14', 'COVID19_Participant15', 'COVID19_Participant17', 'COVID19_Participant18', 'COVID19_Participant19', 'COVID19_Participant2', 'COVID19_Participant22', 'COVID19_Participant23', 'COVID19_Participant25', 'COVID19_Participant26', 'COVID19_Participant28', 'COVID19_Participant3', 'COVID19_Participant36', 'COVID19_Participant37', 'COVID19_Participant39', 'COVID19_Participant4', 'COVID19_Participant40', 'COVID19_Participant7', 'COVID19_Participant8', 'Control_Participant1', 'Control_Participant11', 'Control_Participant14', 'Control_Participant15', 'Control_Participant3', 'Control_Participant4', 'Control_Participant5', 'Control_Participant6', 'Control_Participant7', 'Control_Participant8', 'Control_Participant9']
  → test  환자 ID: ['COVID19_Participant11', 'Control_Participant5', 'Control_Participant3', 'Control_Participant7', 'COVID19_Participant26', 'Control_Participant7']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant12, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant18, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant3, Label: 1
    ID: COVID19_Participant36, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant14, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant4, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant6, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant8, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: COVID19_Participant11, Label: 1
    ID: Control_Participant5, Label: 1
    ID: Control_Participant3, Label: 1
    ID: Control_Participant7, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: Control_Participant7, Label: 0
train_p_index_ 22
valid_p_index 11
test_p_index 6
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Keratinocytes', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Neurons', 'iPS_cells', 'Embryonic_stem_cells', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
data augment 실행 함
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:11,  8.66it/s]  2%|▏         | 2/100 [00:00<00:11,  8.40it/s]  3%|▎         | 3/100 [00:00<00:12,  7.86it/s]  4%|▍         | 4/100 [00:00<00:12,  7.58it/s]  5%|▌         | 5/100 [00:00<00:12,  7.81it/s]  6%|▌         | 6/100 [00:00<00:11,  8.22it/s]  7%|▋         | 7/100 [00:00<00:11,  8.42it/s]  8%|▊         | 8/100 [00:00<00:10,  8.59it/s]  9%|▉         | 9/100 [00:01<00:10,  8.69it/s] 10%|█         | 10/100 [00:01<00:10,  8.92it/s] 11%|█         | 11/100 [00:01<00:10,  8.88it/s] 12%|█▏        | 12/100 [00:01<00:09,  8.84it/s] 13%|█▎        | 13/100 [00:01<00:09,  8.96it/s] 14%|█▍        | 14/100 [00:01<00:09,  8.93it/s] 15%|█▌        | 15/100 [00:01<00:09,  8.98it/s] 16%|█▌        | 16/100 [00:01<00:09,  8.88it/s] 17%|█▋        | 17/100 [00:01<00:09,  8.80it/s] 18%|█▊        | 18/100 [00:02<00:09,  8.71it/s] 19%|█▉        | 19/100 [00:02<00:09,  8.66it/s] 20%|██        | 20/100 [00:02<00:09,  8.74it/s] 21%|██        | 21/100 [00:02<00:09,  8.46it/s] 22%|██▏       | 22/100 [00:02<00:09,  8.49it/s] 23%|██▎       | 23/100 [00:02<00:08,  8.60it/s] 24%|██▍       | 24/100 [00:02<00:08,  8.63it/s] 25%|██▌       | 25/100 [00:02<00:08,  8.65it/s] 26%|██▌       | 26/100 [00:03<00:08,  8.62it/s] 27%|██▋       | 27/100 [00:03<00:08,  8.78it/s] 28%|██▊       | 28/100 [00:03<00:07,  9.09it/s] 29%|██▉       | 29/100 [00:03<00:07,  9.13it/s] 30%|███       | 30/100 [00:03<00:07,  8.96it/s] 31%|███       | 31/100 [00:03<00:07,  9.19it/s] 32%|███▏      | 32/100 [00:03<00:07,  8.81it/s] 33%|███▎      | 33/100 [00:03<00:07,  8.61it/s] 34%|███▍      | 34/100 [00:03<00:07,  8.59it/s] 35%|███▌      | 35/100 [00:04<00:07,  8.79it/s] 36%|███▌      | 36/100 [00:04<00:07,  8.79it/s] 37%|███▋      | 37/100 [00:04<00:07,  8.73it/s] 38%|███▊      | 38/100 [00:04<00:07,  8.64it/s] 39%|███▉      | 39/100 [00:04<00:07,  7.95it/s] 40%|████      | 40/100 [00:04<00:07,  8.11it/s] 41%|████      | 41/100 [00:04<00:07,  7.85it/s] 42%|████▏     | 42/100 [00:04<00:07,  8.16it/s] 43%|████▎     | 43/100 [00:05<00:06,  8.56it/s] 44%|████▍     | 44/100 [00:05<00:06,  8.46it/s] 45%|████▌     | 45/100 [00:05<00:06,  8.48it/s] 46%|████▌     | 46/100 [00:05<00:06,  8.50it/s] 47%|████▋     | 47/100 [00:05<00:06,  8.52it/s] 48%|████▊     | 48/100 [00:05<00:05,  8.80it/s] 49%|████▉     | 49/100 [00:05<00:05,  8.95it/s] 50%|█████     | 50/100 [00:05<00:05,  8.60it/s] 51%|█████     | 51/100 [00:06<00:08,  6.04it/s] 52%|█████▏    | 52/100 [00:06<00:07,  6.55it/s] 53%|█████▎    | 53/100 [00:06<00:06,  7.04it/s] 54%|█████▍    | 54/100 [00:06<00:06,  7.18it/s] 55%|█████▌    | 55/100 [00:06<00:06,  7.28it/s] 56%|█████▌    | 56/100 [00:06<00:05,  7.52it/s] 57%|█████▋    | 57/100 [00:06<00:05,  7.78it/s] 58%|█████▊    | 58/100 [00:06<00:05,  7.94it/s] 59%|█████▉    | 59/100 [00:07<00:05,  8.12it/s] 60%|██████    | 60/100 [00:07<00:04,  8.03it/s] 61%|██████    | 61/100 [00:07<00:04,  7.98it/s] 62%|██████▏   | 62/100 [00:07<00:04,  8.15it/s] 63%|██████▎   | 63/100 [00:07<00:04,  8.00it/s] 64%|██████▍   | 64/100 [00:07<00:04,  7.97it/s] 65%|██████▌   | 65/100 [00:07<00:04,  8.08it/s] 66%|██████▌   | 66/100 [00:07<00:04,  7.91it/s] 67%|██████▋   | 67/100 [00:08<00:04,  7.89it/s] 68%|██████▊   | 68/100 [00:08<00:04,  7.99it/s] 69%|██████▉   | 69/100 [00:08<00:03,  7.94it/s] 70%|███████   | 70/100 [00:08<00:03,  7.96it/s] 71%|███████   | 71/100 [00:08<00:03,  8.18it/s] 72%|███████▏  | 72/100 [00:08<00:03,  8.20it/s] 73%|███████▎  | 73/100 [00:08<00:03,  8.27it/s] 74%|███████▍  | 74/100 [00:08<00:03,  7.92it/s] 75%|███████▌  | 75/100 [00:09<00:03,  7.99it/s] 76%|███████▌  | 76/100 [00:09<00:02,  8.13it/s] 77%|███████▋  | 77/100 [00:09<00:02,  8.08it/s] 78%|███████▊  | 78/100 [00:09<00:02,  8.16it/s] 79%|███████▉  | 79/100 [00:09<00:02,  8.22it/s] 80%|████████  | 80/100 [00:09<00:02,  8.13it/s] 81%|████████  | 81/100 [00:09<00:02,  8.07it/s] 82%|████████▏ | 82/100 [00:09<00:02,  8.43it/s] 83%|████████▎ | 83/100 [00:10<00:02,  8.26it/s] 84%|████████▍ | 84/100 [00:10<00:01,  8.20it/s] 85%|████████▌ | 85/100 [00:10<00:01,  8.27it/s] 86%|████████▌ | 86/100 [00:10<00:01,  8.13it/s] 87%|████████▋ | 87/100 [00:10<00:01,  8.16it/s] 88%|████████▊ | 88/100 [00:10<00:01,  8.16it/s] 89%|████████▉ | 89/100 [00:10<00:01,  8.03it/s] 90%|█████████ | 90/100 [00:10<00:01,  8.05it/s] 91%|█████████ | 91/100 [00:11<00:01,  8.02it/s] 92%|█████████▏| 92/100 [00:11<00:01,  7.93it/s] 93%|█████████▎| 93/100 [00:11<00:00,  8.09it/s] 94%|█████████▍| 94/100 [00:11<00:00,  8.06it/s] 95%|█████████▌| 95/100 [00:11<00:00,  8.07it/s] 96%|█████████▌| 96/100 [00:11<00:00,  8.02it/s] 97%|█████████▋| 97/100 [00:11<00:00,  8.14it/s] 98%|█████████▊| 98/100 [00:11<00:00,  8.12it/s] 99%|█████████▉| 99/100 [00:12<00:00,  8.10it/s]100%|██████████| 100/100 [00:12<00:00,  7.97it/s]100%|██████████| 100/100 [00:12<00:00,  8.23it/s]
eval_p_index len:  17
individual_train 122
individual_eval 17
train data의 x, y, id 길이: 122 122 122
valid data의 x, y, id 길이: 11 11 11
test data의 x, y, id 길이: 6 6 6
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.681935, Valid_loss 0.657820
Epoch 2, Train Loss 0.664693, Valid_loss 0.641086
Epoch 3, Train Loss 0.651589, Valid_loss 0.625316
Epoch 4, Train Loss 0.642122, Valid_loss 0.613182
Epoch 5, Train Loss 0.633489, Valid_loss 0.606559
Epoch 6, Train Loss 0.627736, Valid_loss 0.601660
Epoch 7, Train Loss 0.620017, Valid_loss 0.595980
Epoch 8, Train Loss 0.615145, Valid_loss 0.588675
Epoch 9, Train Loss 0.607136, Valid_loss 0.582239
Epoch 10, Train Loss 0.600329, Valid_loss 0.574194
Epoch 11, Train Loss 0.593414, Valid_loss 0.568128
Epoch 12, Train Loss 0.589837, Valid_loss 0.561404
Epoch 13, Train Loss 0.579109, Valid_loss 0.552191
Epoch 14, Train Loss 0.573278, Valid_loss 0.542111
Epoch 15, Train Loss 0.562537, Valid_loss 0.536331
Epoch 16, Train Loss 0.556059, Valid_loss 0.528190
Epoch 17, Train Loss 0.545353, Valid_loss 0.518201
Epoch 18, Train Loss 0.538879, Valid_loss 0.511423
Epoch 19, Train Loss 0.534796, Valid_loss 0.505633
Epoch 20, Train Loss 0.525467, Valid_loss 0.497032
Epoch 21, Train Loss 0.520914, Valid_loss 0.496592
Epoch 22, Train Loss 0.517145, Valid_loss 0.490758
Epoch 23, Train Loss 0.516189, Valid_loss 0.484030
Epoch 24, Train Loss 0.516364, Valid_loss 0.480827
Epoch 25, Train Loss 0.509030, Valid_loss 0.479271
Epoch 26, Train Loss 0.506108, Valid_loss 0.475627
Epoch 27, Train Loss 0.507292, Valid_loss 0.474609
Epoch 28, Train Loss 0.502270, Valid_loss 0.470506
Epoch 29, Train Loss 0.499998, Valid_loss 0.468663
Epoch 30, Train Loss 0.495543, Valid_loss 0.467647
Epoch 31, Train Loss 0.497434, Valid_loss 0.465762
Epoch 32, Train Loss 0.494098, Valid_loss 0.463596
Epoch 33, Train Loss 0.487471, Valid_loss 0.461725
Epoch 34, Train Loss 0.490743, Valid_loss 0.461433
Epoch 35, Train Loss 0.492157, Valid_loss 0.458273
Epoch 36, Train Loss 0.482296, Valid_loss 0.456484
Epoch 37, Train Loss 0.484873, Valid_loss 0.457251
Epoch 38, Train Loss 0.483495, Valid_loss 0.454020
Epoch 39, Train Loss 0.482095, Valid_loss 0.452944
Epoch 40, Train Loss 0.480133, Valid_loss 0.452231
Epoch 41, Train Loss 0.478565, Valid_loss 0.451012
Epoch 42, Train Loss 0.476396, Valid_loss 0.448536
Epoch 43, Train Loss 0.474433, Valid_loss 0.446989
Epoch 44, Train Loss 0.474064, Valid_loss 0.446076
Epoch 45, Train Loss 0.475668, Valid_loss 0.444722
Epoch 46, Train Loss 0.474352, Valid_loss 0.442482
Epoch 47, Train Loss 0.471646, Valid_loss 0.441894
Epoch 48, Train Loss 0.469472, Valid_loss 0.440131
Epoch 49, Train Loss 0.470232, Valid_loss 0.438517
Epoch 50, Train Loss 0.466140, Valid_loss 0.437785
Epoch 51, Train Loss 0.464467, Valid_loss 0.436542
Epoch 52, Train Loss 0.464545, Valid_loss 0.435838
Epoch 53, Train Loss 0.466979, Valid_loss 0.435597
Epoch 54, Train Loss 0.464286, Valid_loss 0.434374
Epoch 55, Train Loss 0.465047, Valid_loss 0.433731
Epoch 56, Train Loss 0.460781, Valid_loss 0.433102
Epoch 57, Train Loss 0.460069, Valid_loss 0.432389
Epoch 58, Train Loss 0.456628, Valid_loss 0.431646
Epoch 59, Train Loss 0.461029, Valid_loss 0.431293
Epoch 60, Train Loss 0.461222, Valid_loss 0.429821
Epoch 61, Train Loss 0.463115, Valid_loss 0.429226
Epoch 62, Train Loss 0.459007, Valid_loss 0.429231
Epoch 63, Train Loss 0.460341, Valid_loss 0.428568
Epoch 64, Train Loss 0.458281, Valid_loss 0.427130
Epoch 65, Train Loss 0.461002, Valid_loss 0.426965
Epoch 66, Train Loss 0.459410, Valid_loss 0.426843
Epoch 67, Train Loss 0.459868, Valid_loss 0.425397
Epoch 68, Train Loss 0.454937, Valid_loss 0.424918
Epoch 69, Train Loss 0.454080, Valid_loss 0.425025
Epoch 70, Train Loss 0.456242, Valid_loss 0.423990
Epoch 71, Train Loss 0.452203, Valid_loss 0.423183
Epoch 72, Train Loss 0.455470, Valid_loss 0.422950
Epoch 73, Train Loss 0.455074, Valid_loss 0.422090
Epoch 74, Train Loss 0.450320, Valid_loss 0.421310
Epoch 75, Train Loss 0.449475, Valid_loss 0.420159
Epoch 76, Train Loss 0.451393, Valid_loss 0.420017
Epoch 77, Train Loss 0.451829, Valid_loss 0.419396
Epoch 78, Train Loss 0.450719, Valid_loss 0.418470
Epoch 79, Train Loss 0.448083, Valid_loss 0.417993
Epoch 80, Train Loss 0.446898, Valid_loss 0.418109
Epoch 81, Train Loss 0.450096, Valid_loss 0.416479
Epoch 82, Train Loss 0.449742, Valid_loss 0.415850
Epoch 83, Train Loss 0.447166, Valid_loss 0.414989
Epoch 84, Train Loss 0.446677, Valid_loss 0.415178
Epoch 85, Train Loss 0.446544, Valid_loss 0.414589
Epoch 86, Train Loss 0.444603, Valid_loss 0.413128
Epoch 87, Train Loss 0.446329, Valid_loss 0.413048
Epoch 88, Train Loss 0.442374, Valid_loss 0.412163
Epoch 89, Train Loss 0.444566, Valid_loss 0.411591
Epoch 90, Train Loss 0.443975, Valid_loss 0.410788
Epoch 91, Train Loss 0.444013, Valid_loss 0.410087
Epoch 92, Train Loss 0.441861, Valid_loss 0.409342
Epoch 93, Train Loss 0.440763, Valid_loss 0.408996
Epoch 94, Train Loss 0.441804, Valid_loss 0.407877
Epoch 95, Train Loss 0.444012, Valid_loss 0.408183
Epoch 96, Train Loss 0.438646, Valid_loss 0.406816
Epoch 97, Train Loss 0.438677, Valid_loss 0.406438
Epoch 98, Train Loss 0.441146, Valid_loss 0.405219
Epoch 99, Train Loss 0.438769, Valid_loss 0.404906
Epoch 100, Train Loss 0.438302, Valid_loss 0.404208
COVID19_Participant11 -- true: COVID-19 -- pred: normal
Control_Participant5 -- true: normal -- pred: COVID-19
Control_Participant3 -- true: normal -- pred: normal
Control_Participant7 -- true: normal -- pred: normal
COVID19_Participant26 -- true: COVID-19 -- pred: COVID-19
Control_Participant7 -- true: normal -- pred: COVID-19
true :  [1, 0, 0, 0, 1, 0]
pred :  [0, 1, 0, 0, 1, 1]
Confusion Matrix: [2 2 1 1]
Best performance: Epoch 100, Loss 0.438302, Test ACC 0.500000, Test AUC 0.500000, Test Recall 0.500000, Test Precision 0.333333
✅ Total valid splits used: 1
🔁 Repeat 4, Fold 1
🔍 Split #2
  → train_p_index 환자 수: 32
  → test_p_index 환자 수: 7
  → train 환자 ID: ['COVID19_Participant11', 'COVID19_Participant12', 'COVID19_Participant13', 'COVID19_Participant14', 'COVID19_Participant15', 'COVID19_Participant17', 'COVID19_Participant19', 'COVID19_Participant2', 'COVID19_Participant20', 'COVID19_Participant22', 'COVID19_Participant23', 'COVID19_Participant25', 'COVID19_Participant26', 'COVID19_Participant29', 'COVID19_Participant3', 'COVID19_Participant30', 'COVID19_Participant31', 'COVID19_Participant32', 'COVID19_Participant36', 'COVID19_Participant37', 'COVID19_Participant4', 'COVID19_Participant40', 'COVID19_Participant7', 'Control_Participant10', 'Control_Participant11', 'Control_Participant15', 'Control_Participant3', 'Control_Participant4', 'Control_Participant6', 'Control_Participant7', 'Control_Participant8', 'Control_Participant9']
  → test  환자 ID: ['COVID19_Participant25', 'COVID19_Participant31', 'COVID19_Participant26', 'COVID19_Participant13', 'Control_Participant7', 'Control_Participant4', 'Control_Participant7']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant12, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant3, Label: 1
    ID: COVID19_Participant30, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant36, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: Control_Participant10, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant4, Label: 0
    ID: Control_Participant6, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant8, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: Control_Participant7, Label: 0
    ID: Control_Participant4, Label: 0
    ID: Control_Participant7, Label: 0
train_p_index_ 21
valid_p_index 11
test_p_index 7
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Keratinocytes', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Neurons', 'iPS_cells', 'Embryonic_stem_cells', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
data augment 실행 함
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:11,  8.57it/s]  2%|▏         | 2/100 [00:00<00:12,  7.81it/s]  3%|▎         | 3/100 [00:00<00:11,  8.26it/s]  4%|▍         | 4/100 [00:00<00:11,  8.69it/s]  5%|▌         | 5/100 [00:00<00:10,  8.87it/s]  6%|▌         | 6/100 [00:00<00:10,  9.15it/s]  7%|▋         | 7/100 [00:00<00:10,  8.87it/s]  8%|▊         | 8/100 [00:00<00:10,  8.78it/s]  9%|▉         | 9/100 [00:01<00:10,  8.67it/s] 10%|█         | 10/100 [00:01<00:10,  8.56it/s] 11%|█         | 11/100 [00:01<00:10,  8.68it/s] 12%|█▏        | 12/100 [00:01<00:10,  8.70it/s] 13%|█▎        | 13/100 [00:01<00:10,  8.60it/s] 14%|█▍        | 14/100 [00:01<00:09,  8.72it/s] 15%|█▌        | 15/100 [00:01<00:09,  8.88it/s] 16%|█▌        | 16/100 [00:01<00:09,  8.93it/s] 17%|█▋        | 17/100 [00:01<00:09,  8.72it/s] 18%|█▊        | 18/100 [00:02<00:09,  8.60it/s] 19%|█▉        | 19/100 [00:02<00:09,  8.43it/s] 20%|██        | 20/100 [00:02<00:09,  8.55it/s] 21%|██        | 21/100 [00:02<00:09,  8.63it/s] 22%|██▏       | 22/100 [00:02<00:09,  8.49it/s] 23%|██▎       | 23/100 [00:02<00:09,  8.41it/s] 24%|██▍       | 24/100 [00:02<00:09,  8.29it/s] 25%|██▌       | 25/100 [00:02<00:08,  8.43it/s] 26%|██▌       | 26/100 [00:03<00:08,  8.36it/s] 27%|██▋       | 27/100 [00:03<00:08,  8.39it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.52it/s] 29%|██▉       | 29/100 [00:03<00:08,  8.45it/s] 30%|███       | 30/100 [00:03<00:08,  8.40it/s] 31%|███       | 31/100 [00:03<00:08,  8.48it/s] 32%|███▏      | 32/100 [00:03<00:08,  8.36it/s] 33%|███▎      | 33/100 [00:03<00:09,  7.21it/s] 34%|███▍      | 34/100 [00:04<00:08,  7.55it/s] 35%|███▌      | 35/100 [00:04<00:08,  7.61it/s] 36%|███▌      | 36/100 [00:04<00:08,  7.61it/s] 37%|███▋      | 37/100 [00:04<00:08,  7.62it/s] 38%|███▊      | 38/100 [00:04<00:08,  7.33it/s] 39%|███▉      | 39/100 [00:04<00:07,  7.69it/s] 40%|████      | 40/100 [00:04<00:07,  7.76it/s] 41%|████      | 41/100 [00:04<00:07,  8.09it/s] 42%|████▏     | 42/100 [00:05<00:06,  8.55it/s] 43%|████▎     | 43/100 [00:05<00:06,  8.44it/s] 44%|████▍     | 44/100 [00:05<00:06,  8.21it/s] 45%|████▌     | 45/100 [00:05<00:06,  7.94it/s] 46%|████▌     | 46/100 [00:05<00:07,  7.57it/s] 47%|████▋     | 47/100 [00:05<00:07,  7.49it/s] 48%|████▊     | 48/100 [00:05<00:06,  7.75it/s] 49%|████▉     | 49/100 [00:05<00:06,  7.95it/s] 50%|█████     | 50/100 [00:06<00:06,  8.08it/s] 51%|█████     | 51/100 [00:06<00:06,  8.16it/s] 52%|█████▏    | 52/100 [00:06<00:05,  8.18it/s] 53%|█████▎    | 53/100 [00:06<00:05,  8.02it/s] 54%|█████▍    | 54/100 [00:06<00:05,  8.11it/s] 55%|█████▌    | 55/100 [00:06<00:05,  8.12it/s] 56%|█████▌    | 56/100 [00:06<00:05,  7.99it/s] 57%|█████▋    | 57/100 [00:06<00:05,  8.14it/s] 58%|█████▊    | 58/100 [00:07<00:05,  8.29it/s] 59%|█████▉    | 59/100 [00:07<00:05,  8.19it/s] 60%|██████    | 60/100 [00:07<00:04,  8.24it/s] 61%|██████    | 61/100 [00:07<00:04,  7.86it/s] 62%|██████▏   | 62/100 [00:07<00:04,  8.16it/s] 63%|██████▎   | 63/100 [00:07<00:04,  8.21it/s] 64%|██████▍   | 64/100 [00:07<00:04,  8.14it/s] 65%|██████▌   | 65/100 [00:07<00:04,  8.37it/s] 66%|██████▌   | 66/100 [00:08<00:04,  8.27it/s] 67%|██████▋   | 67/100 [00:08<00:03,  8.50it/s] 68%|██████▊   | 68/100 [00:08<00:03,  8.31it/s] 69%|██████▉   | 69/100 [00:08<00:03,  8.19it/s] 70%|███████   | 70/100 [00:08<00:03,  8.25it/s] 71%|███████   | 71/100 [00:08<00:03,  8.25it/s] 72%|███████▏  | 72/100 [00:08<00:03,  8.21it/s] 73%|███████▎  | 73/100 [00:08<00:03,  8.34it/s] 74%|███████▍  | 74/100 [00:08<00:03,  8.38it/s] 75%|███████▌  | 75/100 [00:09<00:03,  7.89it/s] 76%|███████▌  | 76/100 [00:09<00:03,  7.92it/s] 77%|███████▋  | 77/100 [00:09<00:02,  7.99it/s] 78%|███████▊  | 78/100 [00:09<00:02,  7.54it/s] 79%|███████▉  | 79/100 [00:09<00:02,  7.47it/s] 80%|████████  | 80/100 [00:09<00:02,  8.05it/s] 81%|████████  | 81/100 [00:09<00:02,  8.32it/s] 82%|████████▏ | 82/100 [00:09<00:02,  8.17it/s] 83%|████████▎ | 83/100 [00:10<00:02,  7.87it/s] 84%|████████▍ | 84/100 [00:10<00:02,  7.84it/s] 85%|████████▌ | 85/100 [00:10<00:01,  7.58it/s] 86%|████████▌ | 86/100 [00:10<00:01,  7.47it/s] 87%|████████▋ | 87/100 [00:10<00:01,  7.64it/s] 88%|████████▊ | 88/100 [00:10<00:01,  7.65it/s] 89%|████████▉ | 89/100 [00:10<00:01,  7.55it/s] 90%|█████████ | 90/100 [00:11<00:01,  7.83it/s] 91%|█████████ | 91/100 [00:11<00:01,  8.02it/s] 92%|█████████▏| 92/100 [00:11<00:00,  8.16it/s] 93%|█████████▎| 93/100 [00:11<00:00,  8.00it/s] 94%|█████████▍| 94/100 [00:11<00:00,  7.91it/s] 95%|█████████▌| 95/100 [00:11<00:00,  7.97it/s] 96%|█████████▌| 96/100 [00:11<00:00,  8.08it/s] 97%|█████████▋| 97/100 [00:11<00:00,  8.14it/s] 98%|█████████▊| 98/100 [00:12<00:00,  7.83it/s] 99%|█████████▉| 99/100 [00:12<00:00,  7.89it/s]100%|██████████| 100/100 [00:12<00:00,  7.61it/s]100%|██████████| 100/100 [00:12<00:00,  8.12it/s]
eval_p_index len:  18
individual_train 121
individual_eval 18
train data의 x, y, id 길이: 121 121 121
valid data의 x, y, id 길이: 11 11 11
test data의 x, y, id 길이: 7 7 7
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.628917, Valid_loss 0.609306
Epoch 2, Train Loss 0.616451, Valid_loss 0.599802
Epoch 3, Train Loss 0.604217, Valid_loss 0.592270
Epoch 4, Train Loss 0.596018, Valid_loss 0.585518
Epoch 5, Train Loss 0.593597, Valid_loss 0.578481
Epoch 6, Train Loss 0.585930, Valid_loss 0.574132
Epoch 7, Train Loss 0.578859, Valid_loss 0.571465
Epoch 8, Train Loss 0.567528, Valid_loss 0.568028
Epoch 9, Train Loss 0.561657, Valid_loss 0.564791
Epoch 10, Train Loss 0.555212, Valid_loss 0.561564
Epoch 11, Train Loss 0.549541, Valid_loss 0.556360
Epoch 12, Train Loss 0.535146, Valid_loss 0.548986
Epoch 13, Train Loss 0.518258, Valid_loss 0.546559
Epoch 14, Train Loss 0.507970, Valid_loss 0.539732
Epoch 15, Train Loss 0.505764, Valid_loss 0.540382
Epoch 16, Train Loss 0.496492, Valid_loss 0.542008
Epoch 17, Train Loss 0.491983, Valid_loss 0.537018
Epoch 18, Train Loss 0.494207, Valid_loss 0.533503
Epoch 19, Train Loss 0.487425, Valid_loss 0.538810
Epoch 20, Train Loss 0.482088, Valid_loss 0.534843
Epoch 21, Train Loss 0.485001, Valid_loss 0.535061
Epoch 22, Train Loss 0.487119, Valid_loss 0.536538
Epoch 23, Train Loss 0.476659, Valid_loss 0.538233
Epoch 24, Train Loss 0.478274, Valid_loss 0.536357
Epoch 25, Train Loss 0.480626, Valid_loss 0.535355
Epoch 26, Train Loss 0.480215, Valid_loss 0.542704
Epoch 27, Train Loss 0.476845, Valid_loss 0.541677
Epoch 28, Train Loss 0.474930, Valid_loss 0.539052
Epoch 29, Train Loss 0.479597, Valid_loss 0.541630
Epoch 30, Train Loss 0.477724, Valid_loss 0.548434
Epoch 31, Train Loss 0.469260, Valid_loss 0.538044
Epoch 32, Train Loss 0.473520, Valid_loss 0.547284
Epoch 33, Train Loss 0.468331, Valid_loss 0.537818
Epoch 34, Train Loss 0.469500, Valid_loss 0.543541
Epoch 35, Train Loss 0.465456, Valid_loss 0.546799
Epoch 36, Train Loss 0.462313, Valid_loss 0.541544
Epoch 37, Train Loss 0.467435, Valid_loss 0.541635
Epoch 38, Train Loss 0.467540, Valid_loss 0.539550
Epoch 39, Train Loss 0.464792, Valid_loss 0.546628
Epoch 40, Train Loss 0.456938, Valid_loss 0.539066
Epoch 41, Train Loss 0.462379, Valid_loss 0.545058
Epoch 42, Train Loss 0.460838, Valid_loss 0.540467
Epoch 43, Train Loss 0.453832, Valid_loss 0.542864
Epoch 44, Train Loss 0.456901, Valid_loss 0.542513
Epoch 45, Train Loss 0.458594, Valid_loss 0.542289
Epoch 46, Train Loss 0.453368, Valid_loss 0.543985
Epoch 47, Train Loss 0.456886, Valid_loss 0.539906
Epoch 48, Train Loss 0.450300, Valid_loss 0.544565
Epoch 49, Train Loss 0.456986, Valid_loss 0.539410
Epoch 50, Train Loss 0.449733, Valid_loss 0.547360
Epoch 51, Train Loss 0.448565, Valid_loss 0.541556
Epoch 52, Train Loss 0.446826, Valid_loss 0.543030
Epoch 53, Train Loss 0.450524, Valid_loss 0.540472
Epoch 54, Train Loss 0.448709, Valid_loss 0.540801
Epoch 55, Train Loss 0.448104, Valid_loss 0.542237
COVID19_Participant25 -- true: COVID-19 -- pred: COVID-19
COVID19_Participant31 -- true: COVID-19 -- pred: COVID-19
COVID19_Participant26 -- true: COVID-19 -- pred: COVID-19
COVID19_Participant13 -- true: COVID-19 -- pred: COVID-19
Control_Participant7 -- true: normal -- pred: COVID-19
Control_Participant4 -- true: normal -- pred: COVID-19
Control_Participant7 -- true: normal -- pred: COVID-19
true :  [1, 1, 1, 1, 0, 0, 0]
pred :  [1, 1, 1, 1, 1, 1, 1]
Confusion Matrix: [0 3 0 4]
Best performance: Epoch 18, Loss 0.494207, Test ACC 0.571429, Test AUC 0.583333, Test Recall 1.000000, Test Precision 0.571429
✅ Total valid splits used: 2
🔁 Repeat 4, Fold 2
🔍 Split #3
  → train_p_index 환자 수: 29
  → test_p_index 환자 수: 10
  → train 환자 ID: ['COVID19_Participant12', 'COVID19_Participant13', 'COVID19_Participant14', 'COVID19_Participant15', 'COVID19_Participant17', 'COVID19_Participant18', 'COVID19_Participant20', 'COVID19_Participant23', 'COVID19_Participant25', 'COVID19_Participant28', 'COVID19_Participant29', 'COVID19_Participant30', 'COVID19_Participant31', 'COVID19_Participant32', 'COVID19_Participant36', 'COVID19_Participant37', 'COVID19_Participant39', 'COVID19_Participant4', 'COVID19_Participant40', 'COVID19_Participant8', 'Control_Participant1', 'Control_Participant10', 'Control_Participant11', 'Control_Participant14', 'Control_Participant3', 'Control_Participant5', 'Control_Participant6', 'Control_Participant7', 'Control_Participant9']
  → test  환자 ID: ['COVID19_Participant31', 'COVID19_Participant5', 'Control_Participant3', 'Control_Participant1', 'Control_Participant7', 'Control_Participant5', 'COVID19_Participant13', 'Control_Participant3', 'COVID19_Participant13', 'Control_Participant5']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant12, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant18, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant30, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant36, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant10, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant14, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant6, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant5, Label: 1
    ID: Control_Participant3, Label: 1
    ID: Control_Participant1, Label: 1
    ID: Control_Participant7, Label: 1
    ID: Control_Participant5, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: Control_Participant3, Label: 0
    ID: COVID19_Participant13, Label: 0
    ID: Control_Participant5, Label: 0
train_p_index_ 19
valid_p_index 10
test_p_index 10
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Keratinocytes', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Neurons', 'iPS_cells', 'Embryonic_stem_cells', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
data augment 실행 함
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:11,  8.81it/s]  2%|▏         | 2/100 [00:00<00:10,  9.13it/s]  3%|▎         | 3/100 [00:00<00:10,  9.21it/s]  4%|▍         | 4/100 [00:00<00:10,  9.06it/s]  5%|▌         | 5/100 [00:00<00:10,  8.69it/s]  6%|▌         | 6/100 [00:00<00:10,  8.89it/s]  7%|▋         | 7/100 [00:00<00:10,  9.02it/s]  8%|▊         | 8/100 [00:00<00:10,  8.84it/s]  9%|▉         | 9/100 [00:01<00:10,  8.67it/s] 10%|█         | 10/100 [00:01<00:10,  8.78it/s] 11%|█         | 11/100 [00:01<00:10,  8.59it/s] 12%|█▏        | 12/100 [00:01<00:10,  8.69it/s] 13%|█▎        | 13/100 [00:01<00:09,  8.74it/s] 14%|█▍        | 14/100 [00:01<00:09,  8.87it/s] 15%|█▌        | 15/100 [00:01<00:09,  9.02it/s] 16%|█▌        | 16/100 [00:01<00:09,  9.04it/s] 17%|█▋        | 17/100 [00:01<00:09,  9.15it/s] 18%|█▊        | 18/100 [00:02<00:09,  9.01it/s] 19%|█▉        | 19/100 [00:02<00:09,  8.94it/s] 20%|██        | 20/100 [00:02<00:09,  8.76it/s] 21%|██        | 21/100 [00:02<00:09,  8.72it/s] 22%|██▏       | 22/100 [00:02<00:09,  8.66it/s] 23%|██▎       | 23/100 [00:02<00:08,  8.69it/s] 24%|██▍       | 24/100 [00:02<00:08,  8.51it/s] 25%|██▌       | 25/100 [00:02<00:08,  8.44it/s] 26%|██▌       | 26/100 [00:02<00:08,  8.33it/s] 27%|██▋       | 27/100 [00:03<00:08,  8.55it/s] 28%|██▊       | 28/100 [00:03<00:09,  7.76it/s] 29%|██▉       | 29/100 [00:03<00:09,  7.84it/s] 30%|███       | 30/100 [00:03<00:08,  7.90it/s] 31%|███       | 31/100 [00:03<00:08,  8.14it/s] 32%|███▏      | 32/100 [00:03<00:08,  8.17it/s] 33%|███▎      | 33/100 [00:03<00:07,  8.51it/s] 34%|███▍      | 34/100 [00:03<00:07,  8.50it/s] 35%|███▌      | 35/100 [00:04<00:07,  8.36it/s] 36%|███▌      | 36/100 [00:04<00:07,  8.14it/s] 37%|███▋      | 37/100 [00:04<00:07,  7.91it/s] 38%|███▊      | 38/100 [00:04<00:08,  7.68it/s] 39%|███▉      | 39/100 [00:04<00:07,  7.77it/s] 40%|████      | 40/100 [00:04<00:07,  7.99it/s] 41%|████      | 41/100 [00:04<00:06,  8.47it/s] 42%|████▏     | 42/100 [00:04<00:06,  8.37it/s] 43%|████▎     | 43/100 [00:05<00:06,  8.60it/s] 44%|████▍     | 44/100 [00:05<00:06,  8.49it/s] 45%|████▌     | 45/100 [00:05<00:06,  8.41it/s] 46%|████▌     | 46/100 [00:05<00:06,  8.59it/s] 47%|████▋     | 47/100 [00:05<00:06,  8.57it/s] 48%|████▊     | 48/100 [00:05<00:05,  8.91it/s] 49%|████▉     | 49/100 [00:05<00:06,  7.63it/s] 50%|█████     | 50/100 [00:05<00:06,  7.97it/s] 51%|█████     | 51/100 [00:06<00:06,  7.75it/s] 52%|█████▏    | 52/100 [00:06<00:06,  7.94it/s] 53%|█████▎    | 53/100 [00:06<00:05,  8.15it/s] 54%|█████▍    | 54/100 [00:06<00:05,  7.82it/s] 55%|█████▌    | 55/100 [00:06<00:05,  7.98it/s] 56%|█████▌    | 56/100 [00:06<00:05,  8.05it/s] 57%|█████▋    | 57/100 [00:06<00:05,  8.22it/s] 58%|█████▊    | 58/100 [00:06<00:05,  7.62it/s] 59%|█████▉    | 59/100 [00:07<00:05,  7.79it/s] 60%|██████    | 60/100 [00:07<00:05,  7.91it/s] 61%|██████    | 61/100 [00:07<00:04,  8.13it/s] 62%|██████▏   | 62/100 [00:07<00:04,  8.16it/s] 63%|██████▎   | 63/100 [00:07<00:04,  8.28it/s] 64%|██████▍   | 64/100 [00:07<00:04,  7.98it/s] 65%|██████▌   | 65/100 [00:07<00:04,  7.78it/s] 66%|██████▌   | 66/100 [00:07<00:04,  7.99it/s] 67%|██████▋   | 67/100 [00:08<00:04,  8.23it/s] 68%|██████▊   | 68/100 [00:08<00:04,  7.29it/s] 69%|██████▉   | 69/100 [00:08<00:04,  7.20it/s] 70%|███████   | 70/100 [00:08<00:03,  7.57it/s] 71%|███████   | 71/100 [00:08<00:03,  7.66it/s] 72%|███████▏  | 72/100 [00:08<00:03,  7.82it/s] 73%|███████▎  | 73/100 [00:08<00:03,  7.99it/s] 74%|███████▍  | 74/100 [00:08<00:03,  7.80it/s] 75%|███████▌  | 75/100 [00:09<00:03,  6.86it/s] 76%|███████▌  | 76/100 [00:09<00:03,  7.13it/s] 77%|███████▋  | 77/100 [00:09<00:03,  7.30it/s] 78%|███████▊  | 78/100 [00:09<00:02,  7.52it/s] 79%|███████▉  | 79/100 [00:09<00:02,  7.71it/s] 80%|████████  | 80/100 [00:09<00:02,  7.56it/s] 81%|████████  | 81/100 [00:09<00:02,  7.55it/s] 82%|████████▏ | 82/100 [00:10<00:02,  7.78it/s] 83%|████████▎ | 83/100 [00:10<00:02,  7.82it/s] 84%|████████▍ | 84/100 [00:10<00:02,  7.87it/s] 85%|████████▌ | 85/100 [00:10<00:01,  8.08it/s] 86%|████████▌ | 86/100 [00:10<00:01,  8.00it/s] 87%|████████▋ | 87/100 [00:10<00:01,  8.00it/s] 88%|████████▊ | 88/100 [00:10<00:01,  8.12it/s] 89%|████████▉ | 89/100 [00:10<00:01,  8.06it/s] 90%|█████████ | 90/100 [00:11<00:01,  8.00it/s] 91%|█████████ | 91/100 [00:11<00:01,  7.98it/s] 92%|█████████▏| 92/100 [00:11<00:00,  8.03it/s] 93%|█████████▎| 93/100 [00:11<00:00,  8.09it/s] 94%|█████████▍| 94/100 [00:11<00:00,  8.00it/s] 95%|█████████▌| 95/100 [00:11<00:00,  7.88it/s] 96%|█████████▌| 96/100 [00:11<00:00,  7.86it/s] 97%|█████████▋| 97/100 [00:11<00:00,  7.78it/s] 98%|█████████▊| 98/100 [00:12<00:00,  7.83it/s] 99%|█████████▉| 99/100 [00:12<00:00,  7.89it/s]100%|██████████| 100/100 [00:12<00:00,  7.38it/s]100%|██████████| 100/100 [00:12<00:00,  8.11it/s]
eval_p_index len:  20
individual_train 119
individual_eval 20
train data의 x, y, id 길이: 119 119 119
valid data의 x, y, id 길이: 10 10 10
test data의 x, y, id 길이: 10 10 10
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.579974, Valid_loss 0.675258
Epoch 2, Train Loss 0.570094, Valid_loss 0.669772
Epoch 3, Train Loss 0.556717, Valid_loss 0.666363
Epoch 4, Train Loss 0.557758, Valid_loss 0.665410
Epoch 5, Train Loss 0.561501, Valid_loss 0.660065
Epoch 6, Train Loss 0.555132, Valid_loss 0.657026
Epoch 7, Train Loss 0.555644, Valid_loss 0.652373
Epoch 8, Train Loss 0.545804, Valid_loss 0.647261
Epoch 9, Train Loss 0.538940, Valid_loss 0.642569
Epoch 10, Train Loss 0.543285, Valid_loss 0.635330
Epoch 11, Train Loss 0.535798, Valid_loss 0.628893
Epoch 12, Train Loss 0.524166, Valid_loss 0.624932
Epoch 13, Train Loss 0.519571, Valid_loss 0.620710
Epoch 14, Train Loss 0.524597, Valid_loss 0.618368
Epoch 15, Train Loss 0.514517, Valid_loss 0.614804
Epoch 16, Train Loss 0.512773, Valid_loss 0.610426
Epoch 17, Train Loss 0.513292, Valid_loss 0.607812
Epoch 18, Train Loss 0.504076, Valid_loss 0.606367
Epoch 19, Train Loss 0.500740, Valid_loss 0.604239
Epoch 20, Train Loss 0.499790, Valid_loss 0.603475
Epoch 21, Train Loss 0.492234, Valid_loss 0.600022
Epoch 22, Train Loss 0.493643, Valid_loss 0.596521
Epoch 23, Train Loss 0.490006, Valid_loss 0.595602
Epoch 24, Train Loss 0.490148, Valid_loss 0.593479
Epoch 25, Train Loss 0.483966, Valid_loss 0.589861
Epoch 26, Train Loss 0.483706, Valid_loss 0.587956
Epoch 27, Train Loss 0.484091, Valid_loss 0.584845
Epoch 28, Train Loss 0.479647, Valid_loss 0.583373
Epoch 29, Train Loss 0.479555, Valid_loss 0.580470
Epoch 30, Train Loss 0.479138, Valid_loss 0.578229
Epoch 31, Train Loss 0.485293, Valid_loss 0.575809
Epoch 32, Train Loss 0.470271, Valid_loss 0.573474
Epoch 33, Train Loss 0.472806, Valid_loss 0.569873
Epoch 34, Train Loss 0.471244, Valid_loss 0.567422
Epoch 35, Train Loss 0.467352, Valid_loss 0.565214
Epoch 36, Train Loss 0.466477, Valid_loss 0.562800
Epoch 37, Train Loss 0.459855, Valid_loss 0.560252
Epoch 38, Train Loss 0.457404, Valid_loss 0.558540
Epoch 39, Train Loss 0.460822, Valid_loss 0.555909
Epoch 40, Train Loss 0.458486, Valid_loss 0.553176
Epoch 41, Train Loss 0.454467, Valid_loss 0.551605
Epoch 42, Train Loss 0.457570, Valid_loss 0.549610
Epoch 43, Train Loss 0.452887, Valid_loss 0.548463
Epoch 44, Train Loss 0.444242, Valid_loss 0.547277
Epoch 45, Train Loss 0.452435, Valid_loss 0.545541
Epoch 46, Train Loss 0.446156, Valid_loss 0.543913
Epoch 47, Train Loss 0.442971, Valid_loss 0.542845
Epoch 48, Train Loss 0.446266, Valid_loss 0.541722
Epoch 49, Train Loss 0.437448, Valid_loss 0.541842
Epoch 50, Train Loss 0.447455, Valid_loss 0.540234
Epoch 51, Train Loss 0.435100, Valid_loss 0.540200
Epoch 52, Train Loss 0.440766, Valid_loss 0.540559
Epoch 53, Train Loss 0.430960, Valid_loss 0.541002
COVID19_Participant31 -- true: COVID-19 -- pred: normal
COVID19_Participant5 -- true: COVID-19 -- pred: COVID-19
Control_Participant3 -- true: normal -- pred: normal
Control_Participant1 -- true: normal -- pred: normal
Control_Participant7 -- true: normal -- pred: COVID-19
Control_Participant5 -- true: normal -- pred: normal
COVID19_Participant13 -- true: COVID-19 -- pred: COVID-19
Control_Participant3 -- true: normal -- pred: normal
COVID19_Participant13 -- true: COVID-19 -- pred: COVID-19
Control_Participant5 -- true: normal -- pred: normal
true :  [1, 1, 0, 0, 0, 0, 1, 0, 1, 0]
pred :  [0, 1, 0, 0, 1, 0, 1, 0, 1, 0]
Confusion Matrix: [5 1 1 3]
Best performance: Epoch 51, Loss 0.435100, Test ACC 0.800000, Test AUC 0.958333, Test Recall 0.750000, Test Precision 0.750000
✅ Total valid splits used: 3
🔁 Repeat 4, Fold 3
🔍 Split #4
  → train_p_index 환자 수: 31
  → test_p_index 환자 수: 8
  → train 환자 ID: ['COVID19_Participant11', 'COVID19_Participant13', 'COVID19_Participant15', 'COVID19_Participant18', 'COVID19_Participant19', 'COVID19_Participant2', 'COVID19_Participant20', 'COVID19_Participant22', 'COVID19_Participant23', 'COVID19_Participant25', 'COVID19_Participant26', 'COVID19_Participant28', 'COVID19_Participant29', 'COVID19_Participant3', 'COVID19_Participant30', 'COVID19_Participant31', 'COVID19_Participant32', 'COVID19_Participant36', 'COVID19_Participant39', 'COVID19_Participant4', 'COVID19_Participant7', 'COVID19_Participant8', 'Control_Participant1', 'Control_Participant10', 'Control_Participant11', 'Control_Participant14', 'Control_Participant15', 'Control_Participant4', 'Control_Participant5', 'Control_Participant7', 'Control_Participant8']
  → test  환자 ID: ['Control_Participant5', 'Control_Participant4', 'Control_Participant4', 'COVID19_Participant26', 'COVID19_Participant7', 'Control_Participant7', 'Control_Participant5', 'COVID19_Participant31']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant18, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant3, Label: 1
    ID: COVID19_Participant30, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant36, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant10, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant14, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant4, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant8, Label: 0
  → test 환자 ID 및 라벨:
    ID: Control_Participant5, Label: 1
    ID: Control_Participant4, Label: 1
    ID: Control_Participant4, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: Control_Participant7, Label: 0
    ID: Control_Participant5, Label: 0
    ID: COVID19_Participant31, Label: 0
train_p_index_ 20
valid_p_index 11
test_p_index 8
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Keratinocytes', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Neurons', 'iPS_cells', 'Embryonic_stem_cells', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
data augment 실행 함
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:12,  8.10it/s]  2%|▏         | 2/100 [00:00<00:11,  8.82it/s]  4%|▍         | 4/100 [00:00<00:10,  9.32it/s]  5%|▌         | 5/100 [00:00<00:10,  9.42it/s]  6%|▌         | 6/100 [00:00<00:10,  9.20it/s]  8%|▊         | 8/100 [00:00<00:10,  9.18it/s]  9%|▉         | 9/100 [00:00<00:09,  9.17it/s] 10%|█         | 10/100 [00:01<00:09,  9.37it/s] 11%|█         | 11/100 [00:01<00:09,  9.42it/s] 12%|█▏        | 12/100 [00:01<00:09,  9.41it/s] 13%|█▎        | 13/100 [00:01<00:09,  9.29it/s] 14%|█▍        | 14/100 [00:01<00:09,  9.21it/s] 15%|█▌        | 15/100 [00:01<00:09,  9.24it/s] 16%|█▌        | 16/100 [00:01<00:09,  8.82it/s] 17%|█▋        | 17/100 [00:01<00:09,  8.96it/s] 18%|█▊        | 18/100 [00:01<00:09,  8.60it/s] 19%|█▉        | 19/100 [00:02<00:09,  8.70it/s] 20%|██        | 20/100 [00:02<00:09,  8.57it/s] 21%|██        | 21/100 [00:02<00:09,  8.48it/s] 22%|██▏       | 22/100 [00:02<00:09,  8.32it/s] 23%|██▎       | 23/100 [00:02<00:09,  8.53it/s] 24%|██▍       | 24/100 [00:02<00:08,  8.60it/s] 25%|██▌       | 25/100 [00:02<00:08,  8.56it/s] 26%|██▌       | 26/100 [00:02<00:08,  8.65it/s] 27%|██▋       | 27/100 [00:03<00:08,  8.98it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.67it/s] 29%|██▉       | 29/100 [00:03<00:08,  8.75it/s] 30%|███       | 30/100 [00:03<00:08,  8.08it/s] 31%|███       | 31/100 [00:03<00:08,  8.31it/s] 32%|███▏      | 32/100 [00:03<00:08,  8.38it/s] 33%|███▎      | 33/100 [00:03<00:08,  8.12it/s] 34%|███▍      | 34/100 [00:03<00:08,  8.18it/s] 35%|███▌      | 35/100 [00:04<00:08,  7.77it/s] 36%|███▌      | 36/100 [00:04<00:07,  8.04it/s] 37%|███▋      | 37/100 [00:04<00:07,  8.36it/s] 38%|███▊      | 38/100 [00:04<00:07,  8.28it/s] 39%|███▉      | 39/100 [00:04<00:07,  8.55it/s] 40%|████      | 40/100 [00:04<00:07,  8.45it/s] 41%|████      | 41/100 [00:04<00:07,  8.05it/s] 42%|████▏     | 42/100 [00:04<00:07,  8.27it/s] 43%|████▎     | 43/100 [00:04<00:06,  8.45it/s] 44%|████▍     | 44/100 [00:05<00:06,  8.64it/s] 45%|████▌     | 45/100 [00:05<00:06,  8.34it/s] 46%|████▌     | 46/100 [00:05<00:06,  8.07it/s] 47%|████▋     | 47/100 [00:05<00:06,  8.27it/s] 48%|████▊     | 48/100 [00:05<00:06,  8.58it/s] 49%|████▉     | 49/100 [00:05<00:06,  8.42it/s] 50%|█████     | 50/100 [00:05<00:05,  8.67it/s] 51%|█████     | 51/100 [00:05<00:05,  8.83it/s] 52%|█████▏    | 52/100 [00:06<00:05,  8.83it/s] 53%|█████▎    | 53/100 [00:06<00:05,  8.51it/s] 54%|█████▍    | 54/100 [00:06<00:05,  8.52it/s] 55%|█████▌    | 55/100 [00:06<00:05,  8.35it/s] 56%|█████▌    | 56/100 [00:06<00:05,  8.51it/s] 57%|█████▋    | 57/100 [00:06<00:05,  8.04it/s] 58%|█████▊    | 58/100 [00:06<00:05,  8.10it/s] 59%|█████▉    | 59/100 [00:06<00:05,  8.16it/s] 60%|██████    | 60/100 [00:07<00:04,  8.02it/s] 61%|██████    | 61/100 [00:07<00:04,  8.09it/s] 62%|██████▏   | 62/100 [00:07<00:04,  8.27it/s] 63%|██████▎   | 63/100 [00:07<00:04,  8.29it/s] 64%|██████▍   | 64/100 [00:07<00:04,  8.34it/s] 65%|██████▌   | 65/100 [00:07<00:04,  8.02it/s] 66%|██████▌   | 66/100 [00:07<00:04,  8.06it/s] 67%|██████▋   | 67/100 [00:07<00:04,  8.13it/s] 68%|██████▊   | 68/100 [00:07<00:03,  8.21it/s] 69%|██████▉   | 69/100 [00:08<00:03,  8.19it/s] 70%|███████   | 70/100 [00:08<00:03,  8.27it/s] 71%|███████   | 71/100 [00:08<00:03,  7.77it/s] 72%|███████▏  | 72/100 [00:08<00:03,  7.88it/s] 73%|███████▎  | 73/100 [00:08<00:03,  8.10it/s] 74%|███████▍  | 74/100 [00:08<00:03,  8.16it/s] 75%|███████▌  | 75/100 [00:08<00:03,  8.26it/s] 76%|███████▌  | 76/100 [00:08<00:02,  8.27it/s] 77%|███████▋  | 77/100 [00:09<00:02,  8.31it/s] 78%|███████▊  | 78/100 [00:09<00:02,  8.36it/s] 79%|███████▉  | 79/100 [00:09<00:02,  8.29it/s] 80%|████████  | 80/100 [00:09<00:02,  8.37it/s] 81%|████████  | 81/100 [00:09<00:02,  8.23it/s] 82%|████████▏ | 82/100 [00:09<00:02,  8.18it/s] 83%|████████▎ | 83/100 [00:09<00:02,  7.61it/s] 84%|████████▍ | 84/100 [00:09<00:02,  7.58it/s] 85%|████████▌ | 85/100 [00:10<00:01,  7.81it/s] 86%|████████▌ | 86/100 [00:10<00:01,  7.11it/s] 87%|████████▋ | 87/100 [00:10<00:01,  7.37it/s] 88%|████████▊ | 88/100 [00:10<00:01,  7.49it/s] 89%|████████▉ | 89/100 [00:10<00:01,  7.62it/s] 90%|█████████ | 90/100 [00:10<00:01,  6.86it/s] 91%|█████████ | 91/100 [00:10<00:01,  6.83it/s] 92%|█████████▏| 92/100 [00:11<00:01,  7.53it/s] 93%|█████████▎| 93/100 [00:11<00:00,  7.60it/s] 94%|█████████▍| 94/100 [00:11<00:00,  7.65it/s] 95%|█████████▌| 95/100 [00:11<00:00,  7.52it/s] 96%|█████████▌| 96/100 [00:11<00:00,  7.39it/s] 97%|█████████▋| 97/100 [00:11<00:00,  7.39it/s] 98%|█████████▊| 98/100 [00:11<00:00,  7.49it/s] 99%|█████████▉| 99/100 [00:12<00:00,  7.51it/s]100%|██████████| 100/100 [00:12<00:00,  7.73it/s]100%|██████████| 100/100 [00:12<00:00,  8.25it/s]
eval_p_index len:  19
individual_train 120
individual_eval 19
train data의 x, y, id 길이: 120 120 120
valid data의 x, y, id 길이: 11 11 11
test data의 x, y, id 길이: 8 8 8
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.704403, Valid_loss 0.659286
Epoch 2, Train Loss 0.686294, Valid_loss 0.644818
Epoch 3, Train Loss 0.682486, Valid_loss 0.635214
Epoch 4, Train Loss 0.674356, Valid_loss 0.628442
Epoch 5, Train Loss 0.678301, Valid_loss 0.622294
Epoch 6, Train Loss 0.667977, Valid_loss 0.616787
Epoch 7, Train Loss 0.671232, Valid_loss 0.610980
Epoch 8, Train Loss 0.662815, Valid_loss 0.606454
Epoch 9, Train Loss 0.654999, Valid_loss 0.601379
Epoch 10, Train Loss 0.653586, Valid_loss 0.595673
Epoch 11, Train Loss 0.652980, Valid_loss 0.591349
Epoch 12, Train Loss 0.647635, Valid_loss 0.585520
Epoch 13, Train Loss 0.641946, Valid_loss 0.578284
Epoch 14, Train Loss 0.639689, Valid_loss 0.570300
Epoch 15, Train Loss 0.631570, Valid_loss 0.562341
Epoch 16, Train Loss 0.627018, Valid_loss 0.559012
Epoch 17, Train Loss 0.614492, Valid_loss 0.544654
Epoch 18, Train Loss 0.609179, Valid_loss 0.537623
Epoch 19, Train Loss 0.602705, Valid_loss 0.524647
Epoch 20, Train Loss 0.590305, Valid_loss 0.525934
Epoch 21, Train Loss 0.587331, Valid_loss 0.513426
Epoch 22, Train Loss 0.581690, Valid_loss 0.501705
Epoch 23, Train Loss 0.576131, Valid_loss 0.503690
Epoch 24, Train Loss 0.571280, Valid_loss 0.490146
Epoch 25, Train Loss 0.569853, Valid_loss 0.481879
Epoch 26, Train Loss 0.554642, Valid_loss 0.487968
Epoch 27, Train Loss 0.553597, Valid_loss 0.482588
Epoch 28, Train Loss 0.551223, Valid_loss 0.473777
Epoch 29, Train Loss 0.546310, Valid_loss 0.474594
Epoch 30, Train Loss 0.538151, Valid_loss 0.475862
Epoch 31, Train Loss 0.540444, Valid_loss 0.473723
Epoch 32, Train Loss 0.534087, Valid_loss 0.471684
Epoch 33, Train Loss 0.534767, Valid_loss 0.467847
Epoch 34, Train Loss 0.532062, Valid_loss 0.479154
Epoch 35, Train Loss 0.522473, Valid_loss 0.477813
Epoch 36, Train Loss 0.526771, Valid_loss 0.476292
Epoch 37, Train Loss 0.532471, Valid_loss 0.486314
Epoch 38, Train Loss 0.526841, Valid_loss 0.477020
Epoch 39, Train Loss 0.517651, Valid_loss 0.483815
Epoch 40, Train Loss 0.515790, Valid_loss 0.478482
Epoch 41, Train Loss 0.519535, Valid_loss 0.487612
Epoch 42, Train Loss 0.509367, Valid_loss 0.480246
Epoch 43, Train Loss 0.509663, Valid_loss 0.487328
Epoch 44, Train Loss 0.512795, Valid_loss 0.481482
Epoch 45, Train Loss 0.515158, Valid_loss 0.485999
Epoch 46, Train Loss 0.511963, Valid_loss 0.482528
Epoch 47, Train Loss 0.506801, Valid_loss 0.483220
Epoch 48, Train Loss 0.499929, Valid_loss 0.484707
Epoch 49, Train Loss 0.499407, Valid_loss 0.484725
Epoch 50, Train Loss 0.495847, Valid_loss 0.481776
Epoch 51, Train Loss 0.496474, Valid_loss 0.481502
Epoch 52, Train Loss 0.490486, Valid_loss 0.481767
Epoch 53, Train Loss 0.496816, Valid_loss 0.482959
Control_Participant5 -- true: normal -- pred: normal
Control_Participant4 -- true: normal -- pred: normal
Control_Participant4 -- true: normal -- pred: COVID-19
COVID19_Participant26 -- true: COVID-19 -- pred: COVID-19
COVID19_Participant7 -- true: COVID-19 -- pred: normal
Control_Participant7 -- true: normal -- pred: COVID-19
Control_Participant5 -- true: normal -- pred: normal
COVID19_Participant31 -- true: COVID-19 -- pred: COVID-19
true :  [0, 0, 0, 1, 1, 0, 0, 1]
pred :  [0, 0, 1, 1, 0, 1, 0, 1]
Confusion Matrix: [3 2 1 2]
Best performance: Epoch 33, Loss 0.534767, Test ACC 0.625000, Test AUC 0.733333, Test Recall 0.666667, Test Precision 0.500000
✅ Total valid splits used: 4
🔁 Repeat 4, Fold 4
🔍 Split #5
  → train_p_index 환자 수: 31
  → test_p_index 환자 수: 8
  → train 환자 ID: ['COVID19_Participant11', 'COVID19_Participant12', 'COVID19_Participant14', 'COVID19_Participant17', 'COVID19_Participant18', 'COVID19_Participant19', 'COVID19_Participant2', 'COVID19_Participant20', 'COVID19_Participant22', 'COVID19_Participant26', 'COVID19_Participant28', 'COVID19_Participant29', 'COVID19_Participant3', 'COVID19_Participant30', 'COVID19_Participant31', 'COVID19_Participant32', 'COVID19_Participant37', 'COVID19_Participant39', 'COVID19_Participant40', 'COVID19_Participant7', 'COVID19_Participant8', 'Control_Participant1', 'Control_Participant10', 'Control_Participant14', 'Control_Participant15', 'Control_Participant3', 'Control_Participant4', 'Control_Participant5', 'Control_Participant6', 'Control_Participant8', 'Control_Participant9']
  → test  환자 ID: ['COVID19_Participant26', 'Control_Participant3', 'Control_Participant1', 'Control_Participant4', 'COVID19_Participant7', 'Control_Participant1', 'COVID19_Participant7', 'COVID19_Participant31']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant12, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant18, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant3, Label: 1
    ID: COVID19_Participant30, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant10, Label: 0
    ID: Control_Participant14, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant4, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant6, Label: 0
    ID: Control_Participant8, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: COVID19_Participant26, Label: 1
    ID: Control_Participant3, Label: 1
    ID: Control_Participant1, Label: 1
    ID: Control_Participant4, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: Control_Participant1, Label: 1
    ID: COVID19_Participant7, Label: 0
    ID: COVID19_Participant31, Label: 0
train_p_index_ 20
valid_p_index 11
test_p_index 8
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Epithelial_cells', 'Epithelial_cells', 'NK_cell', 'Epithelial_cells', 'Epithelial_cells', 'Keratinocytes', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
data augment 실행 함
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:12,  8.02it/s]  2%|▏         | 2/100 [00:00<00:11,  8.59it/s]  4%|▍         | 4/100 [00:00<00:10,  9.34it/s]  6%|▌         | 6/100 [00:00<00:09,  9.52it/s]  7%|▋         | 7/100 [00:00<00:09,  9.33it/s]  8%|▊         | 8/100 [00:00<00:09,  9.24it/s]  9%|▉         | 9/100 [00:00<00:10,  8.85it/s] 11%|█         | 11/100 [00:01<00:09,  8.95it/s] 13%|█▎        | 13/100 [00:01<00:09,  9.17it/s] 14%|█▍        | 14/100 [00:01<00:09,  9.13it/s] 15%|█▌        | 15/100 [00:01<00:09,  8.93it/s] 16%|█▌        | 16/100 [00:01<00:09,  9.17it/s] 17%|█▋        | 17/100 [00:01<00:09,  9.09it/s] 18%|█▊        | 18/100 [00:02<00:09,  8.23it/s] 19%|█▉        | 19/100 [00:02<00:10,  8.06it/s] 20%|██        | 20/100 [00:02<00:09,  8.17it/s] 21%|██        | 21/100 [00:02<00:09,  8.33it/s] 22%|██▏       | 22/100 [00:02<00:09,  8.12it/s] 23%|██▎       | 23/100 [00:02<00:09,  8.39it/s] 24%|██▍       | 24/100 [00:02<00:08,  8.53it/s] 25%|██▌       | 25/100 [00:02<00:08,  8.54it/s] 26%|██▌       | 26/100 [00:02<00:08,  8.39it/s] 27%|██▋       | 27/100 [00:03<00:10,  6.74it/s] 28%|██▊       | 28/100 [00:03<00:10,  7.18it/s] 29%|██▉       | 29/100 [00:03<00:10,  6.99it/s] 30%|███       | 30/100 [00:03<00:09,  7.34it/s] 31%|███       | 31/100 [00:03<00:08,  7.68it/s] 32%|███▏      | 32/100 [00:03<00:10,  6.19it/s] 33%|███▎      | 33/100 [00:04<00:10,  6.64it/s] 34%|███▍      | 34/100 [00:04<00:09,  7.00it/s] 35%|███▌      | 35/100 [00:04<00:08,  7.47it/s] 36%|███▌      | 36/100 [00:04<00:08,  7.56it/s] 37%|███▋      | 37/100 [00:04<00:08,  7.80it/s] 38%|███▊      | 38/100 [00:04<00:07,  7.96it/s] 39%|███▉      | 39/100 [00:04<00:07,  8.04it/s] 40%|████      | 40/100 [00:04<00:07,  8.09it/s] 41%|████      | 41/100 [00:05<00:07,  8.08it/s] 42%|████▏     | 42/100 [00:05<00:07,  8.19it/s] 43%|████▎     | 43/100 [00:05<00:06,  8.14it/s] 44%|████▍     | 44/100 [00:05<00:07,  7.80it/s] 45%|████▌     | 45/100 [00:05<00:07,  7.62it/s] 46%|████▌     | 46/100 [00:05<00:07,  7.62it/s] 47%|████▋     | 47/100 [00:05<00:07,  7.36it/s] 48%|████▊     | 48/100 [00:05<00:06,  7.60it/s] 49%|████▉     | 49/100 [00:06<00:06,  7.86it/s] 50%|█████     | 50/100 [00:06<00:06,  7.89it/s] 51%|█████     | 51/100 [00:06<00:05,  8.21it/s] 52%|█████▏    | 52/100 [00:06<00:06,  7.96it/s] 53%|█████▎    | 53/100 [00:06<00:05,  8.02it/s] 54%|█████▍    | 54/100 [00:06<00:05,  8.09it/s] 55%|█████▌    | 55/100 [00:06<00:05,  8.11it/s] 56%|█████▌    | 56/100 [00:07<00:07,  6.12it/s] 57%|█████▋    | 57/100 [00:07<00:06,  6.54it/s] 58%|█████▊    | 58/100 [00:07<00:06,  6.82it/s] 59%|█████▉    | 59/100 [00:07<00:06,  6.75it/s] 60%|██████    | 60/100 [00:07<00:05,  7.15it/s] 61%|██████    | 61/100 [00:07<00:05,  7.00it/s] 62%|██████▏   | 62/100 [00:07<00:05,  7.16it/s] 63%|██████▎   | 63/100 [00:08<00:05,  7.32it/s] 64%|██████▍   | 64/100 [00:08<00:04,  7.49it/s] 65%|██████▌   | 65/100 [00:08<00:04,  7.58it/s] 66%|██████▌   | 66/100 [00:08<00:04,  7.71it/s] 67%|██████▋   | 67/100 [00:08<00:04,  7.61it/s] 68%|██████▊   | 68/100 [00:08<00:04,  6.61it/s] 69%|██████▉   | 69/100 [00:08<00:04,  6.60it/s] 70%|███████   | 70/100 [00:09<00:04,  6.91it/s] 71%|███████   | 71/100 [00:09<00:04,  7.13it/s] 72%|███████▏  | 72/100 [00:09<00:03,  7.34it/s] 73%|███████▎  | 73/100 [00:09<00:03,  7.36it/s] 74%|███████▍  | 74/100 [00:09<00:03,  7.04it/s] 75%|███████▌  | 75/100 [00:09<00:03,  7.25it/s] 76%|███████▌  | 76/100 [00:09<00:03,  7.19it/s] 77%|███████▋  | 77/100 [00:09<00:03,  7.30it/s] 78%|███████▊  | 78/100 [00:10<00:03,  7.28it/s] 79%|███████▉  | 79/100 [00:10<00:02,  7.38it/s] 80%|████████  | 80/100 [00:10<00:02,  7.40it/s] 81%|████████  | 81/100 [00:10<00:02,  7.22it/s] 82%|████████▏ | 82/100 [00:10<00:02,  7.35it/s] 83%|████████▎ | 83/100 [00:10<00:02,  7.51it/s] 84%|████████▍ | 84/100 [00:10<00:02,  7.49it/s] 85%|████████▌ | 85/100 [00:11<00:01,  7.57it/s] 86%|████████▌ | 86/100 [00:11<00:01,  7.58it/s] 87%|████████▋ | 87/100 [00:11<00:01,  7.62it/s] 88%|████████▊ | 88/100 [00:11<00:01,  7.74it/s] 89%|████████▉ | 89/100 [00:11<00:01,  7.59it/s] 90%|█████████ | 90/100 [00:11<00:01,  7.55it/s] 91%|█████████ | 91/100 [00:11<00:01,  7.26it/s] 92%|█████████▏| 92/100 [00:11<00:01,  7.45it/s] 93%|█████████▎| 93/100 [00:12<00:00,  7.57it/s] 94%|█████████▍| 94/100 [00:12<00:00,  7.68it/s] 95%|█████████▌| 95/100 [00:12<00:00,  7.56it/s] 96%|█████████▌| 96/100 [00:12<00:00,  7.72it/s] 97%|█████████▋| 97/100 [00:12<00:00,  7.63it/s] 98%|█████████▊| 98/100 [00:12<00:00,  7.70it/s] 99%|█████████▉| 99/100 [00:12<00:00,  7.62it/s]100%|██████████| 100/100 [00:12<00:00,  7.56it/s]100%|██████████| 100/100 [00:12<00:00,  7.69it/s]
eval_p_index len:  19
individual_train 120
individual_eval 19
train data의 x, y, id 길이: 120 120 120
valid data의 x, y, id 길이: 11 11 11
test data의 x, y, id 길이: 8 8 8
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.776749, Valid_loss 0.733795
Epoch 2, Train Loss 0.695440, Valid_loss 0.656266
Epoch 3, Train Loss 0.655930, Valid_loss 0.621346
Epoch 4, Train Loss 0.643977, Valid_loss 0.604780
Epoch 5, Train Loss 0.633265, Valid_loss 0.594249
Epoch 6, Train Loss 0.617137, Valid_loss 0.585697
Epoch 7, Train Loss 0.606198, Valid_loss 0.577308
Epoch 8, Train Loss 0.597973, Valid_loss 0.567489
Epoch 9, Train Loss 0.583377, Valid_loss 0.557156
Epoch 10, Train Loss 0.579456, Valid_loss 0.549051
Epoch 11, Train Loss 0.556692, Valid_loss 0.540383
Epoch 12, Train Loss 0.553406, Valid_loss 0.531924
Epoch 13, Train Loss 0.545650, Valid_loss 0.519044
Epoch 14, Train Loss 0.539872, Valid_loss 0.505210
Epoch 15, Train Loss 0.525446, Valid_loss 0.494963
Epoch 16, Train Loss 0.518825, Valid_loss 0.483414
Epoch 17, Train Loss 0.512013, Valid_loss 0.472295
Epoch 18, Train Loss 0.510503, Valid_loss 0.463472
Epoch 19, Train Loss 0.504384, Valid_loss 0.458354
Epoch 20, Train Loss 0.501785, Valid_loss 0.454157
Epoch 21, Train Loss 0.492863, Valid_loss 0.454291
Epoch 22, Train Loss 0.491045, Valid_loss 0.450683
Epoch 23, Train Loss 0.493066, Valid_loss 0.449066
Epoch 24, Train Loss 0.491623, Valid_loss 0.446094
Epoch 25, Train Loss 0.491756, Valid_loss 0.445809
Epoch 26, Train Loss 0.485373, Valid_loss 0.441607
Epoch 27, Train Loss 0.487026, Valid_loss 0.440300
Epoch 28, Train Loss 0.488607, Valid_loss 0.438398
Epoch 29, Train Loss 0.487351, Valid_loss 0.438867
Epoch 30, Train Loss 0.482040, Valid_loss 0.436215
Epoch 31, Train Loss 0.486885, Valid_loss 0.435010
Epoch 32, Train Loss 0.484100, Valid_loss 0.434578
Epoch 33, Train Loss 0.475194, Valid_loss 0.433392
Epoch 34, Train Loss 0.482214, Valid_loss 0.431114
Epoch 35, Train Loss 0.475691, Valid_loss 0.429471
Epoch 36, Train Loss 0.476016, Valid_loss 0.427569
Epoch 37, Train Loss 0.470400, Valid_loss 0.428805
Epoch 38, Train Loss 0.469853, Valid_loss 0.429155
Epoch 39, Train Loss 0.470481, Valid_loss 0.427455
Epoch 40, Train Loss 0.473451, Valid_loss 0.425843
Epoch 41, Train Loss 0.474654, Valid_loss 0.425702
Epoch 42, Train Loss 0.467429, Valid_loss 0.424752
Epoch 43, Train Loss 0.462967, Valid_loss 0.423642
Epoch 44, Train Loss 0.468909, Valid_loss 0.423264
Epoch 45, Train Loss 0.471059, Valid_loss 0.423418
Epoch 46, Train Loss 0.462425, Valid_loss 0.421530
Epoch 47, Train Loss 0.464269, Valid_loss 0.420359
Epoch 48, Train Loss 0.458021, Valid_loss 0.420508
Epoch 49, Train Loss 0.455708, Valid_loss 0.420363
Epoch 50, Train Loss 0.457036, Valid_loss 0.418318
Epoch 51, Train Loss 0.453257, Valid_loss 0.417062
Epoch 52, Train Loss 0.456094, Valid_loss 0.416590
Epoch 53, Train Loss 0.456793, Valid_loss 0.417035
Epoch 54, Train Loss 0.454327, Valid_loss 0.417260
COVID19_Participant26 -- true: COVID-19 -- pred: COVID-19
Control_Participant3 -- true: normal -- pred: COVID-19
Control_Participant1 -- true: normal -- pred: normal
Control_Participant4 -- true: normal -- pred: normal
COVID19_Participant7 -- true: COVID-19 -- pred: COVID-19
Control_Participant1 -- true: normal -- pred: normal
COVID19_Participant7 -- true: COVID-19 -- pred: normal
COVID19_Participant31 -- true: COVID-19 -- pred: COVID-19
true :  [1, 0, 0, 0, 1, 0, 1, 1]
pred :  [1, 1, 0, 0, 1, 0, 0, 1]
Confusion Matrix: [3 1 1 3]
Best performance: Epoch 52, Loss 0.456094, Test ACC 0.750000, Test AUC 0.687500, Test Recall 0.750000, Test Precision 0.750000
✅ Total valid splits used: 5

📌 Repeat 4: 평균 AUC = 0.6925, 표준편차 = 0.1558
