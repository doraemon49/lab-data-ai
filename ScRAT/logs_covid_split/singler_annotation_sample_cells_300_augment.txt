Namespace(seed=240, batch_size=16, learning_rate=0.0001, weight_decay=0.0001, epochs=100, task='custom_covid', emb_dim=8, h_dim=128, dropout=0.0, layers=1, heads=4, train_sample_cells=300, test_sample_cells=300, train_num_sample=20, test_num_sample=100, model='Transformer', dataset=None, inter_only=False, same_pheno=0, augment_num=100, alpha=1.0, repeat=5, all=1, min_size=6000, n_splits=5, pca=False, mix_type=1, norm_first=False, warmup=False, top_k=1)
🔁 Repeat 0, Fold 0
🔍 Split #1
  → train_p_index 환자 수: 25
  → test_p_index 환자 수: 7
  → train 환자 ID: ['COVID19_Participant13', 'COVID19_Participant14', 'COVID19_Participant15', 'COVID19_Participant17', 'COVID19_Participant19', 'COVID19_Participant2', 'COVID19_Participant20', 'COVID19_Participant22', 'COVID19_Participant23', 'COVID19_Participant26', 'COVID19_Participant29', 'COVID19_Participant31', 'COVID19_Participant32', 'COVID19_Participant37', 'COVID19_Participant4', 'COVID19_Participant40', 'COVID19_Participant7', 'Control_Participant1', 'Control_Participant10', 'Control_Participant11', 'Control_Participant15', 'Control_Participant3', 'Control_Participant4', 'Control_Participant5', 'Control_Participant8']
  → test  환자 ID: ['COVID19_Participant5', 'COVID19_Participant31', 'COVID19_Participant7', 'Control_Participant1', 'Control_Participant4', 'COVID19_Participant13', 'COVID19_Participant26']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant10, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant4, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant8, Label: 0
  → test 환자 ID 및 라벨:
    ID: COVID19_Participant5, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: Control_Participant1, Label: 1
    ID: Control_Participant4, Label: 1
    ID: COVID19_Participant13, Label: 0
    ID: COVID19_Participant26, Label: 0
train_p_index_ 16
valid_p_index 9
test_p_index 7
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Epithelial_cells', 'Platelets', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Keratinocytes', 'Macrophage', 'Epithelial_cells', 'B_cell', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
data augment 실행 함
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:12,  7.99it/s]  2%|▏         | 2/100 [00:00<00:12,  8.08it/s]  3%|▎         | 3/100 [00:00<00:11,  8.22it/s]  4%|▍         | 4/100 [00:00<00:12,  7.90it/s]  5%|▌         | 5/100 [00:00<00:11,  8.18it/s]  6%|▌         | 6/100 [00:00<00:11,  8.29it/s]  7%|▋         | 7/100 [00:00<00:11,  8.31it/s]  8%|▊         | 8/100 [00:00<00:10,  8.41it/s]  9%|▉         | 9/100 [00:01<00:11,  7.93it/s] 10%|█         | 10/100 [00:01<00:11,  8.14it/s] 11%|█         | 11/100 [00:01<00:10,  8.36it/s] 12%|█▏        | 12/100 [00:01<00:10,  8.25it/s] 13%|█▎        | 13/100 [00:01<00:10,  8.33it/s] 14%|█▍        | 14/100 [00:01<00:10,  8.20it/s] 15%|█▌        | 15/100 [00:01<00:10,  8.32it/s] 16%|█▌        | 16/100 [00:01<00:10,  8.23it/s] 17%|█▋        | 17/100 [00:02<00:10,  8.27it/s] 18%|█▊        | 18/100 [00:02<00:09,  8.29it/s] 19%|█▉        | 19/100 [00:02<00:12,  6.57it/s] 20%|██        | 20/100 [00:02<00:11,  7.15it/s] 21%|██        | 21/100 [00:02<00:10,  7.44it/s] 22%|██▏       | 22/100 [00:02<00:09,  7.83it/s] 23%|██▎       | 23/100 [00:02<00:09,  7.94it/s] 24%|██▍       | 24/100 [00:02<00:09,  8.31it/s] 25%|██▌       | 25/100 [00:03<00:09,  8.28it/s] 26%|██▌       | 26/100 [00:03<00:09,  8.21it/s] 27%|██▋       | 27/100 [00:03<00:09,  8.11it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.18it/s] 29%|██▉       | 29/100 [00:03<00:08,  8.14it/s] 30%|███       | 30/100 [00:03<00:08,  8.14it/s] 31%|███       | 31/100 [00:03<00:08,  8.21it/s] 32%|███▏      | 32/100 [00:03<00:08,  8.10it/s] 33%|███▎      | 33/100 [00:04<00:08,  8.26it/s] 34%|███▍      | 34/100 [00:04<00:08,  8.23it/s] 35%|███▌      | 35/100 [00:04<00:08,  8.04it/s] 36%|███▌      | 36/100 [00:04<00:07,  8.12it/s] 37%|███▋      | 37/100 [00:04<00:07,  8.06it/s] 38%|███▊      | 38/100 [00:04<00:07,  8.26it/s] 39%|███▉      | 39/100 [00:04<00:07,  8.49it/s] 40%|████      | 40/100 [00:04<00:07,  8.23it/s] 41%|████      | 41/100 [00:05<00:07,  8.20it/s] 42%|████▏     | 42/100 [00:05<00:07,  8.07it/s] 43%|████▎     | 43/100 [00:05<00:07,  8.10it/s] 44%|████▍     | 44/100 [00:05<00:06,  8.09it/s] 45%|████▌     | 45/100 [00:05<00:06,  8.08it/s] 46%|████▌     | 46/100 [00:05<00:07,  7.55it/s] 47%|████▋     | 47/100 [00:05<00:06,  7.80it/s] 48%|████▊     | 48/100 [00:05<00:06,  7.92it/s] 49%|████▉     | 49/100 [00:06<00:06,  8.08it/s] 50%|█████     | 50/100 [00:06<00:06,  8.11it/s] 51%|█████     | 51/100 [00:06<00:05,  8.21it/s] 52%|█████▏    | 52/100 [00:06<00:05,  8.08it/s] 53%|█████▎    | 53/100 [00:06<00:05,  8.01it/s] 54%|█████▍    | 54/100 [00:06<00:05,  8.22it/s] 55%|█████▌    | 55/100 [00:06<00:05,  8.28it/s] 56%|█████▌    | 56/100 [00:06<00:05,  8.62it/s] 57%|█████▋    | 57/100 [00:07<00:04,  8.95it/s] 58%|█████▊    | 58/100 [00:07<00:04,  8.87it/s] 59%|█████▉    | 59/100 [00:07<00:04,  8.46it/s] 60%|██████    | 60/100 [00:07<00:04,  8.24it/s] 61%|██████    | 61/100 [00:07<00:04,  8.25it/s] 62%|██████▏   | 62/100 [00:07<00:04,  8.09it/s] 63%|██████▎   | 63/100 [00:07<00:04,  8.06it/s] 64%|██████▍   | 64/100 [00:07<00:04,  7.99it/s] 65%|██████▌   | 65/100 [00:08<00:04,  7.94it/s] 66%|██████▌   | 66/100 [00:08<00:04,  7.88it/s] 67%|██████▋   | 67/100 [00:08<00:04,  7.89it/s] 68%|██████▊   | 68/100 [00:08<00:04,  7.87it/s] 69%|██████▉   | 69/100 [00:08<00:03,  8.30it/s] 70%|███████   | 70/100 [00:08<00:03,  8.36it/s] 71%|███████   | 71/100 [00:08<00:03,  8.12it/s] 72%|███████▏  | 72/100 [00:08<00:03,  8.00it/s] 73%|███████▎  | 73/100 [00:09<00:03,  7.86it/s] 74%|███████▍  | 74/100 [00:09<00:03,  7.96it/s] 75%|███████▌  | 75/100 [00:09<00:03,  8.01it/s] 76%|███████▌  | 76/100 [00:09<00:03,  7.87it/s] 77%|███████▋  | 77/100 [00:09<00:02,  7.84it/s] 78%|███████▊  | 78/100 [00:09<00:02,  7.81it/s] 79%|███████▉  | 79/100 [00:09<00:02,  7.92it/s] 80%|████████  | 80/100 [00:09<00:02,  7.92it/s] 81%|████████  | 81/100 [00:10<00:02,  7.86it/s] 82%|████████▏ | 82/100 [00:10<00:02,  8.27it/s] 83%|████████▎ | 83/100 [00:10<00:02,  8.37it/s] 84%|████████▍ | 84/100 [00:10<00:01,  8.14it/s] 85%|████████▌ | 85/100 [00:10<00:01,  7.95it/s] 86%|████████▌ | 86/100 [00:10<00:01,  7.92it/s] 87%|████████▋ | 87/100 [00:10<00:01,  8.03it/s] 88%|████████▊ | 88/100 [00:10<00:01,  8.20it/s] 89%|████████▉ | 89/100 [00:11<00:01,  8.08it/s] 90%|█████████ | 90/100 [00:11<00:01,  7.75it/s] 91%|█████████ | 91/100 [00:11<00:01,  7.39it/s] 92%|█████████▏| 92/100 [00:11<00:01,  7.44it/s] 93%|█████████▎| 93/100 [00:11<00:00,  7.59it/s] 94%|█████████▍| 94/100 [00:11<00:00,  7.60it/s] 95%|█████████▌| 95/100 [00:11<00:00,  7.65it/s] 96%|█████████▌| 96/100 [00:11<00:00,  7.65it/s] 97%|█████████▋| 97/100 [00:12<00:00,  7.53it/s] 98%|█████████▊| 98/100 [00:12<00:00,  7.44it/s] 99%|█████████▉| 99/100 [00:12<00:00,  7.31it/s]100%|██████████| 100/100 [00:12<00:00,  7.43it/s]100%|██████████| 100/100 [00:12<00:00,  8.00it/s]
eval_p_index len:  16
individual_train 116
individual_eval 16
train data의 x, y, id 길이: 116 116 116
valid data의 x, y, id 길이: 9 9 9
test data의 x, y, id 길이: 7 7 7
output_class :  1
Memory Allocated: 0.44 MB
Memory Reserved: 2.00 MB
cuda
Epoch 1, Train Loss 0.589026, Valid_loss 0.730830
Epoch 2, Train Loss 0.620597, Valid_loss 0.726432
Epoch 3, Train Loss 0.604041, Valid_loss 0.713205
Epoch 4, Train Loss 0.588532, Valid_loss 0.700250
Epoch 5, Train Loss 0.596809, Valid_loss 0.693399
Epoch 6, Train Loss 0.572218, Valid_loss 0.677144
Epoch 7, Train Loss 0.582680, Valid_loss 0.668772
Epoch 8, Train Loss 0.540709, Valid_loss 0.647975
Epoch 9, Train Loss 0.546360, Valid_loss 0.660606
Epoch 10, Train Loss 0.542167, Valid_loss 0.663170
Epoch 11, Train Loss 0.553647, Valid_loss 0.637116
Epoch 12, Train Loss 0.526665, Valid_loss 0.630649
Epoch 13, Train Loss 0.527354, Valid_loss 0.672212
Epoch 14, Train Loss 0.521841, Valid_loss 0.651233
Epoch 15, Train Loss 0.496728, Valid_loss 0.641496
Epoch 16, Train Loss 0.506367, Valid_loss 0.644469
Epoch 17, Train Loss 0.506600, Valid_loss 0.657575
Epoch 18, Train Loss 0.504828, Valid_loss 0.652357
Epoch 19, Train Loss 0.487061, Valid_loss 0.643907
Epoch 20, Train Loss 0.494002, Valid_loss 0.650598
Epoch 21, Train Loss 0.476761, Valid_loss 0.639938
Epoch 22, Train Loss 0.494257, Valid_loss 0.641437
Epoch 23, Train Loss 0.481081, Valid_loss 0.646814
Epoch 24, Train Loss 0.479970, Valid_loss 0.633094
Epoch 25, Train Loss 0.467971, Valid_loss 0.649595
Epoch 26, Train Loss 0.491432, Valid_loss 0.630787
Epoch 27, Train Loss 0.479636, Valid_loss 0.631174
Epoch 28, Train Loss 0.469933, Valid_loss 0.650815
Epoch 29, Train Loss 0.484971, Valid_loss 0.626772
Epoch 30, Train Loss 0.473592, Valid_loss 0.651675
Epoch 31, Train Loss 0.473191, Valid_loss 0.638126
Epoch 32, Train Loss 0.471176, Valid_loss 0.651162
Epoch 33, Train Loss 0.483160, Valid_loss 0.647078
Epoch 34, Train Loss 0.476486, Valid_loss 0.647413
Epoch 35, Train Loss 0.472709, Valid_loss 0.640307
Epoch 36, Train Loss 0.466948, Valid_loss 0.656563
Epoch 37, Train Loss 0.472026, Valid_loss 0.643620
Epoch 38, Train Loss 0.458584, Valid_loss 0.644836
Epoch 39, Train Loss 0.474822, Valid_loss 0.643483
Epoch 40, Train Loss 0.457899, Valid_loss 0.646746
Epoch 41, Train Loss 0.459496, Valid_loss 0.639365
Epoch 42, Train Loss 0.461842, Valid_loss 0.655591
Epoch 43, Train Loss 0.460238, Valid_loss 0.627352
Epoch 44, Train Loss 0.453410, Valid_loss 0.646983
Epoch 45, Train Loss 0.474968, Valid_loss 0.642947
Epoch 46, Train Loss 0.457318, Valid_loss 0.642640
Epoch 47, Train Loss 0.460275, Valid_loss 0.647162
Epoch 48, Train Loss 0.463354, Valid_loss 0.646302
Epoch 49, Train Loss 0.461469, Valid_loss 0.638219
Epoch 50, Train Loss 0.472204, Valid_loss 0.635200
Epoch 51, Train Loss 0.468779, Valid_loss 0.635490
Epoch 52, Train Loss 0.456443, Valid_loss 0.642217
COVID19_Participant5 -- true: COVID-19 -- pred: COVID-19
COVID19_Participant31 -- true: COVID-19 -- pred: COVID-19
COVID19_Participant7 -- true: COVID-19 -- pred: COVID-19
Control_Participant1 -- true: normal -- pred: COVID-19
Control_Participant4 -- true: normal -- pred: COVID-19
COVID19_Participant13 -- true: COVID-19 -- pred: COVID-19
COVID19_Participant26 -- true: COVID-19 -- pred: COVID-19
true :  [1, 1, 1, 0, 0, 1, 1]
pred :  [1, 1, 1, 1, 1, 1, 1]
Confusion Matrix: [0 2 0 5]
Best performance: Epoch 29, Loss 0.484971, Test ACC 0.714286, Test AUC 0.800000, Test Recall 1.000000, Test Precision 0.714286
✅ Total valid splits used: 1
🔁 Repeat 0, Fold 1
🔍 Split #2
  → train_p_index 환자 수: 27
  → test_p_index 환자 수: 5
  → train 환자 ID: ['COVID19_Participant11', 'COVID19_Participant13', 'COVID19_Participant14', 'COVID19_Participant17', 'COVID19_Participant19', 'COVID19_Participant2', 'COVID19_Participant20', 'COVID19_Participant22', 'COVID19_Participant23', 'COVID19_Participant25', 'COVID19_Participant26', 'COVID19_Participant28', 'COVID19_Participant29', 'COVID19_Participant37', 'COVID19_Participant39', 'COVID19_Participant4', 'COVID19_Participant40', 'COVID19_Participant7', 'COVID19_Participant8', 'Control_Participant1', 'Control_Participant10', 'Control_Participant11', 'Control_Participant4', 'Control_Participant5', 'Control_Participant7', 'Control_Participant8', 'Control_Participant9']
  → test  환자 ID: ['Control_Participant5', 'Control_Participant7', 'Control_Participant4', 'COVID19_Participant19', 'Control_Participant7']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant10, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant4, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant8, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: Control_Participant5, Label: 1
    ID: Control_Participant7, Label: 1
    ID: Control_Participant4, Label: 1
    ID: COVID19_Participant19, Label: 0
    ID: Control_Participant7, Label: 0
train_p_index_ 18
valid_p_index 9
test_p_index 5
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Keratinocytes', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Neurons', 'iPS_cells', 'Embryonic_stem_cells', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
data augment 실행 함
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:12,  7.94it/s]  2%|▏         | 2/100 [00:00<00:11,  8.57it/s]  4%|▍         | 4/100 [00:00<00:09,  9.66it/s]  5%|▌         | 5/100 [00:00<00:09,  9.73it/s]  7%|▋         | 7/100 [00:00<00:09,  9.48it/s]  8%|▊         | 8/100 [00:00<00:09,  9.33it/s]  9%|▉         | 9/100 [00:00<00:09,  9.27it/s] 10%|█         | 10/100 [00:01<00:10,  8.83it/s] 11%|█         | 11/100 [00:01<00:09,  8.92it/s] 12%|█▏        | 12/100 [00:01<00:09,  8.90it/s] 13%|█▎        | 13/100 [00:01<00:09,  8.95it/s] 14%|█▍        | 14/100 [00:01<00:09,  8.94it/s] 15%|█▌        | 15/100 [00:01<00:09,  8.86it/s] 16%|█▌        | 16/100 [00:01<00:09,  9.01it/s] 17%|█▋        | 17/100 [00:01<00:09,  8.54it/s] 18%|█▊        | 18/100 [00:02<00:09,  8.67it/s] 19%|█▉        | 19/100 [00:02<00:09,  8.73it/s] 20%|██        | 20/100 [00:02<00:09,  8.79it/s] 21%|██        | 21/100 [00:02<00:09,  8.38it/s] 22%|██▏       | 22/100 [00:02<00:09,  8.03it/s] 23%|██▎       | 23/100 [00:02<00:09,  8.23it/s] 24%|██▍       | 24/100 [00:02<00:08,  8.61it/s] 26%|██▌       | 26/100 [00:02<00:08,  9.00it/s] 27%|██▋       | 27/100 [00:03<00:08,  8.83it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.85it/s] 29%|██▉       | 29/100 [00:03<00:07,  8.89it/s] 30%|███       | 30/100 [00:03<00:08,  8.67it/s] 31%|███       | 31/100 [00:03<00:07,  8.83it/s] 32%|███▏      | 32/100 [00:03<00:08,  8.49it/s] 33%|███▎      | 33/100 [00:03<00:08,  8.32it/s] 34%|███▍      | 34/100 [00:03<00:08,  8.07it/s] 35%|███▌      | 35/100 [00:04<00:08,  7.81it/s] 36%|███▌      | 36/100 [00:04<00:08,  7.96it/s] 37%|███▋      | 37/100 [00:04<00:07,  8.12it/s] 38%|███▊      | 38/100 [00:04<00:07,  8.34it/s] 39%|███▉      | 39/100 [00:04<00:07,  8.01it/s] 40%|████      | 40/100 [00:04<00:07,  8.12it/s] 41%|████      | 41/100 [00:04<00:06,  8.43it/s] 42%|████▏     | 42/100 [00:04<00:06,  8.49it/s] 43%|████▎     | 43/100 [00:04<00:06,  8.45it/s] 44%|████▍     | 44/100 [00:05<00:07,  7.88it/s] 45%|████▌     | 45/100 [00:05<00:06,  8.12it/s] 46%|████▌     | 46/100 [00:05<00:06,  8.23it/s] 47%|████▋     | 47/100 [00:05<00:06,  8.41it/s] 48%|████▊     | 48/100 [00:05<00:06,  8.49it/s] 49%|████▉     | 49/100 [00:05<00:06,  8.49it/s] 50%|█████     | 50/100 [00:05<00:05,  8.52it/s] 51%|█████     | 51/100 [00:05<00:05,  8.65it/s] 52%|█████▏    | 52/100 [00:06<00:05,  8.64it/s] 53%|█████▎    | 53/100 [00:06<00:05,  8.15it/s] 54%|█████▍    | 54/100 [00:06<00:05,  8.00it/s] 55%|█████▌    | 55/100 [00:06<00:05,  7.82it/s] 56%|█████▌    | 56/100 [00:06<00:05,  8.04it/s] 57%|█████▋    | 57/100 [00:06<00:05,  8.27it/s] 58%|█████▊    | 58/100 [00:06<00:04,  8.49it/s] 59%|█████▉    | 59/100 [00:06<00:04,  8.53it/s] 60%|██████    | 60/100 [00:07<00:04,  8.25it/s] 61%|██████    | 61/100 [00:07<00:04,  8.10it/s] 62%|██████▏   | 62/100 [00:07<00:04,  7.80it/s] 63%|██████▎   | 63/100 [00:07<00:04,  7.62it/s] 64%|██████▍   | 64/100 [00:07<00:04,  7.97it/s] 65%|██████▌   | 65/100 [00:07<00:04,  7.71it/s] 66%|██████▌   | 66/100 [00:07<00:04,  7.95it/s] 67%|██████▋   | 67/100 [00:07<00:04,  7.89it/s] 68%|██████▊   | 68/100 [00:08<00:03,  8.08it/s] 69%|██████▉   | 69/100 [00:08<00:03,  8.05it/s] 70%|███████   | 70/100 [00:08<00:03,  7.79it/s] 71%|███████   | 71/100 [00:08<00:03,  7.80it/s] 72%|███████▏  | 72/100 [00:08<00:03,  7.92it/s] 73%|███████▎  | 73/100 [00:08<00:03,  7.78it/s] 74%|███████▍  | 74/100 [00:08<00:03,  7.85it/s] 75%|███████▌  | 75/100 [00:08<00:03,  7.78it/s] 76%|███████▌  | 76/100 [00:09<00:03,  7.91it/s] 77%|███████▋  | 77/100 [00:09<00:02,  7.76it/s] 78%|███████▊  | 78/100 [00:09<00:02,  7.43it/s] 79%|███████▉  | 79/100 [00:09<00:02,  7.28it/s] 80%|████████  | 80/100 [00:09<00:02,  7.40it/s] 81%|████████  | 81/100 [00:09<00:02,  7.79it/s] 82%|████████▏ | 82/100 [00:09<00:02,  7.63it/s] 83%|████████▎ | 83/100 [00:10<00:02,  7.81it/s] 84%|████████▍ | 84/100 [00:10<00:01,  8.02it/s] 85%|████████▌ | 85/100 [00:10<00:02,  6.04it/s] 86%|████████▌ | 86/100 [00:10<00:02,  6.51it/s] 87%|████████▋ | 87/100 [00:10<00:01,  6.65it/s] 88%|████████▊ | 88/100 [00:10<00:01,  6.98it/s] 89%|████████▉ | 89/100 [00:10<00:01,  7.24it/s] 90%|█████████ | 90/100 [00:11<00:01,  7.28it/s] 91%|█████████ | 91/100 [00:11<00:01,  7.44it/s] 92%|█████████▏| 92/100 [00:11<00:01,  7.47it/s] 93%|█████████▎| 93/100 [00:11<00:00,  7.81it/s] 94%|█████████▍| 94/100 [00:11<00:00,  7.62it/s] 95%|█████████▌| 95/100 [00:11<00:00,  7.76it/s] 96%|█████████▌| 96/100 [00:11<00:00,  7.80it/s] 97%|█████████▋| 97/100 [00:11<00:00,  7.99it/s] 98%|█████████▊| 98/100 [00:12<00:00,  7.94it/s] 99%|█████████▉| 99/100 [00:12<00:00,  6.23it/s]100%|██████████| 100/100 [00:12<00:00,  6.37it/s]100%|██████████| 100/100 [00:12<00:00,  8.04it/s]
eval_p_index len:  14
individual_train 118
individual_eval 14
train data의 x, y, id 길이: 118 118 118
valid data의 x, y, id 길이: 9 9 9
test data의 x, y, id 길이: 5 5 5
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.650897, Valid_loss 0.670639
Epoch 2, Train Loss 0.603884, Valid_loss 0.671734
Epoch 3, Train Loss 0.601661, Valid_loss 0.676483
Epoch 4, Train Loss 0.576642, Valid_loss 0.678102
Epoch 5, Train Loss 0.571012, Valid_loss 0.679413
Epoch 6, Train Loss 0.568929, Valid_loss 0.678492
Epoch 7, Train Loss 0.560814, Valid_loss 0.674005
Epoch 8, Train Loss 0.554717, Valid_loss 0.667124
Epoch 9, Train Loss 0.552748, Valid_loss 0.656463
Epoch 10, Train Loss 0.543269, Valid_loss 0.643158
Epoch 11, Train Loss 0.525888, Valid_loss 0.632854
Epoch 12, Train Loss 0.526984, Valid_loss 0.624809
Epoch 13, Train Loss 0.511946, Valid_loss 0.612807
Epoch 14, Train Loss 0.503766, Valid_loss 0.598350
Epoch 15, Train Loss 0.491817, Valid_loss 0.573447
Epoch 16, Train Loss 0.478435, Valid_loss 0.568547
Epoch 17, Train Loss 0.476032, Valid_loss 0.564968
Epoch 18, Train Loss 0.481498, Valid_loss 0.548316
Epoch 19, Train Loss 0.474871, Valid_loss 0.556524
Epoch 20, Train Loss 0.475198, Valid_loss 0.550298
Epoch 21, Train Loss 0.468080, Valid_loss 0.550866
Epoch 22, Train Loss 0.470278, Valid_loss 0.550524
Epoch 23, Train Loss 0.463951, Valid_loss 0.553438
Epoch 24, Train Loss 0.468375, Valid_loss 0.548011
Epoch 25, Train Loss 0.460207, Valid_loss 0.545104
Epoch 26, Train Loss 0.456915, Valid_loss 0.549100
Epoch 27, Train Loss 0.451726, Valid_loss 0.545833
Epoch 28, Train Loss 0.461991, Valid_loss 0.545170
Epoch 29, Train Loss 0.456738, Valid_loss 0.547039
Epoch 30, Train Loss 0.453087, Valid_loss 0.546450
Epoch 31, Train Loss 0.445008, Valid_loss 0.543925
Epoch 32, Train Loss 0.457089, Valid_loss 0.544576
Epoch 33, Train Loss 0.451517, Valid_loss 0.545299
Epoch 34, Train Loss 0.454925, Valid_loss 0.540797
Epoch 35, Train Loss 0.447499, Valid_loss 0.541075
Epoch 36, Train Loss 0.450000, Valid_loss 0.551640
Epoch 37, Train Loss 0.439053, Valid_loss 0.542823
Epoch 38, Train Loss 0.450252, Valid_loss 0.542258
Epoch 39, Train Loss 0.451564, Valid_loss 0.540931
Epoch 40, Train Loss 0.436549, Valid_loss 0.537125
Epoch 41, Train Loss 0.447403, Valid_loss 0.549559
Epoch 42, Train Loss 0.448684, Valid_loss 0.546469
Epoch 43, Train Loss 0.446847, Valid_loss 0.546366
Epoch 44, Train Loss 0.435943, Valid_loss 0.541526
Epoch 45, Train Loss 0.441060, Valid_loss 0.545999
Epoch 46, Train Loss 0.437628, Valid_loss 0.555564
Epoch 47, Train Loss 0.448519, Valid_loss 0.548670
Epoch 48, Train Loss 0.425564, Valid_loss 0.553515
Epoch 49, Train Loss 0.430761, Valid_loss 0.555049
Epoch 50, Train Loss 0.432718, Valid_loss 0.553328
Epoch 51, Train Loss 0.427091, Valid_loss 0.550431
Epoch 52, Train Loss 0.430364, Valid_loss 0.552579
Epoch 53, Train Loss 0.430014, Valid_loss 0.557282
Control_Participant5 -- true: normal -- pred: normal
Control_Participant7 -- true: normal -- pred: COVID-19
Control_Participant4 -- true: normal -- pred: COVID-19
COVID19_Participant19 -- true: COVID-19 -- pred: COVID-19
Control_Participant7 -- true: normal -- pred: COVID-19
true :  [0, 0, 0, 1, 0]
pred :  [0, 1, 1, 1, 1]
Confusion Matrix: [1 3 0 1]
Best performance: Epoch 40, Loss 0.436549, Test ACC 0.400000, Test AUC 1.000000, Test Recall 1.000000, Test Precision 0.250000
✅ Total valid splits used: 2
🔁 Repeat 0, Fold 2
🔍 Split #3
  → train_p_index 환자 수: 26
  → test_p_index 환자 수: 6
  → train 환자 ID: ['COVID19_Participant11', 'COVID19_Participant13', 'COVID19_Participant15', 'COVID19_Participant17', 'COVID19_Participant19', 'COVID19_Participant20', 'COVID19_Participant22', 'COVID19_Participant25', 'COVID19_Participant26', 'COVID19_Participant28', 'COVID19_Participant29', 'COVID19_Participant31', 'COVID19_Participant32', 'COVID19_Participant37', 'COVID19_Participant39', 'COVID19_Participant40', 'COVID19_Participant7', 'COVID19_Participant8', 'Control_Participant1', 'Control_Participant10', 'Control_Participant15', 'Control_Participant3', 'Control_Participant5', 'Control_Participant7', 'Control_Participant8', 'Control_Participant9']
  → test  환자 ID: ['Control_Participant7', 'Control_Participant5', 'COVID19_Participant26', 'COVID19_Participant26', 'COVID19_Participant13', 'Control_Participant7']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant10, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant8, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: Control_Participant7, Label: 1
    ID: Control_Participant5, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant13, Label: 0
    ID: Control_Participant7, Label: 0
train_p_index_ 17
valid_p_index 9
test_p_index 6
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Keratinocytes', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Neurons', 'iPS_cells', 'Embryonic_stem_cells', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
data augment 실행 함
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:10,  9.46it/s]  2%|▏         | 2/100 [00:00<00:11,  8.88it/s]  3%|▎         | 3/100 [00:00<00:10,  9.12it/s]  4%|▍         | 4/100 [00:00<00:10,  9.14it/s]  5%|▌         | 5/100 [00:00<00:10,  8.73it/s]  6%|▌         | 6/100 [00:00<00:12,  7.53it/s]  8%|▊         | 8/100 [00:00<00:11,  8.00it/s]  9%|▉         | 9/100 [00:01<00:11,  8.26it/s] 10%|█         | 10/100 [00:01<00:11,  8.14it/s] 11%|█         | 11/100 [00:01<00:10,  8.43it/s] 12%|█▏        | 12/100 [00:01<00:10,  8.51it/s] 13%|█▎        | 13/100 [00:01<00:09,  8.77it/s] 14%|█▍        | 14/100 [00:01<00:10,  8.54it/s] 15%|█▌        | 15/100 [00:01<00:09,  8.75it/s] 16%|█▌        | 16/100 [00:01<00:09,  8.80it/s] 17%|█▋        | 17/100 [00:01<00:09,  8.71it/s] 18%|█▊        | 18/100 [00:02<00:09,  8.84it/s] 19%|█▉        | 19/100 [00:02<00:09,  8.80it/s] 20%|██        | 20/100 [00:02<00:09,  8.85it/s] 21%|██        | 21/100 [00:02<00:08,  8.79it/s] 22%|██▏       | 22/100 [00:02<00:08,  8.89it/s] 23%|██▎       | 23/100 [00:02<00:08,  8.80it/s] 24%|██▍       | 24/100 [00:02<00:08,  8.74it/s] 25%|██▌       | 25/100 [00:02<00:08,  8.67it/s] 26%|██▌       | 26/100 [00:03<00:08,  8.73it/s] 27%|██▋       | 27/100 [00:03<00:08,  8.76it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.51it/s] 29%|██▉       | 29/100 [00:03<00:08,  8.63it/s] 30%|███       | 30/100 [00:03<00:08,  8.60it/s] 31%|███       | 31/100 [00:03<00:07,  8.97it/s] 32%|███▏      | 32/100 [00:03<00:07,  9.02it/s] 33%|███▎      | 33/100 [00:03<00:07,  8.59it/s] 34%|███▍      | 34/100 [00:03<00:07,  8.38it/s] 35%|███▌      | 35/100 [00:04<00:07,  8.34it/s] 36%|███▌      | 36/100 [00:04<00:07,  8.24it/s] 37%|███▋      | 37/100 [00:04<00:07,  8.29it/s] 38%|███▊      | 38/100 [00:04<00:07,  8.35it/s] 39%|███▉      | 39/100 [00:04<00:07,  7.97it/s] 40%|████      | 40/100 [00:04<00:07,  8.13it/s] 41%|████      | 41/100 [00:04<00:07,  8.17it/s] 42%|████▏     | 42/100 [00:04<00:07,  8.20it/s] 43%|████▎     | 43/100 [00:05<00:06,  8.37it/s] 44%|████▍     | 44/100 [00:05<00:06,  8.38it/s] 45%|████▌     | 45/100 [00:05<00:06,  8.39it/s] 46%|████▌     | 46/100 [00:05<00:06,  8.27it/s] 47%|████▋     | 47/100 [00:05<00:06,  8.43it/s] 48%|████▊     | 48/100 [00:05<00:06,  8.46it/s] 49%|████▉     | 49/100 [00:05<00:05,  8.65it/s] 50%|█████     | 50/100 [00:05<00:06,  7.89it/s] 51%|█████     | 51/100 [00:06<00:08,  6.00it/s] 52%|█████▏    | 52/100 [00:06<00:07,  6.70it/s] 53%|█████▎    | 53/100 [00:06<00:06,  7.25it/s] 54%|█████▍    | 54/100 [00:06<00:06,  7.48it/s] 55%|█████▌    | 55/100 [00:06<00:05,  7.63it/s] 56%|█████▌    | 56/100 [00:06<00:05,  7.75it/s] 57%|█████▋    | 57/100 [00:06<00:05,  8.03it/s] 58%|█████▊    | 58/100 [00:06<00:05,  8.22it/s] 59%|█████▉    | 59/100 [00:07<00:05,  8.18it/s] 60%|██████    | 60/100 [00:07<00:04,  8.58it/s] 61%|██████    | 61/100 [00:07<00:04,  8.56it/s] 62%|██████▏   | 62/100 [00:07<00:04,  8.65it/s] 63%|██████▎   | 63/100 [00:07<00:06,  6.13it/s] 64%|██████▍   | 64/100 [00:07<00:05,  6.19it/s] 65%|██████▌   | 65/100 [00:07<00:05,  6.71it/s] 66%|██████▌   | 66/100 [00:08<00:04,  7.15it/s] 67%|██████▋   | 67/100 [00:08<00:04,  7.57it/s] 68%|██████▊   | 68/100 [00:08<00:04,  7.51it/s] 69%|██████▉   | 69/100 [00:08<00:04,  7.65it/s] 70%|███████   | 70/100 [00:08<00:03,  7.80it/s] 71%|███████   | 71/100 [00:08<00:03,  7.99it/s] 72%|███████▏  | 72/100 [00:08<00:03,  8.00it/s] 73%|███████▎  | 73/100 [00:08<00:03,  8.17it/s] 74%|███████▍  | 74/100 [00:09<00:03,  8.17it/s] 75%|███████▌  | 75/100 [00:09<00:03,  8.31it/s] 76%|███████▌  | 76/100 [00:09<00:02,  8.23it/s] 77%|███████▋  | 77/100 [00:09<00:02,  8.42it/s] 78%|███████▊  | 78/100 [00:09<00:02,  8.33it/s] 79%|███████▉  | 79/100 [00:09<00:02,  8.18it/s] 80%|████████  | 80/100 [00:09<00:02,  8.06it/s] 81%|████████  | 81/100 [00:09<00:02,  8.50it/s] 82%|████████▏ | 82/100 [00:10<00:02,  8.44it/s] 83%|████████▎ | 83/100 [00:10<00:01,  8.52it/s] 84%|████████▍ | 84/100 [00:10<00:01,  8.56it/s] 85%|████████▌ | 85/100 [00:10<00:01,  8.87it/s] 86%|████████▌ | 86/100 [00:10<00:01,  9.15it/s] 87%|████████▋ | 87/100 [00:10<00:01,  8.83it/s] 88%|████████▊ | 88/100 [00:10<00:01,  8.46it/s] 89%|████████▉ | 89/100 [00:10<00:01,  8.28it/s] 90%|█████████ | 90/100 [00:10<00:01,  8.24it/s] 91%|█████████ | 91/100 [00:11<00:01,  8.37it/s] 92%|█████████▏| 92/100 [00:11<00:00,  8.27it/s] 93%|█████████▎| 93/100 [00:11<00:00,  8.36it/s] 94%|█████████▍| 94/100 [00:11<00:00,  8.42it/s] 95%|█████████▌| 95/100 [00:11<00:00,  8.16it/s] 96%|█████████▌| 96/100 [00:11<00:00,  8.21it/s] 97%|█████████▋| 97/100 [00:11<00:00,  8.03it/s] 98%|█████████▊| 98/100 [00:11<00:00,  8.04it/s] 99%|█████████▉| 99/100 [00:12<00:00,  7.87it/s]100%|██████████| 100/100 [00:12<00:00,  8.21it/s]100%|██████████| 100/100 [00:12<00:00,  8.20it/s]
eval_p_index len:  15
individual_train 117
individual_eval 15
train data의 x, y, id 길이: 117 117 117
valid data의 x, y, id 길이: 9 9 9
test data의 x, y, id 길이: 6 6 6
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.887912, Valid_loss 0.662473
Epoch 2, Train Loss 0.749237, Valid_loss 0.649182
Epoch 3, Train Loss 0.666139, Valid_loss 0.649252
Epoch 4, Train Loss 0.608814, Valid_loss 0.659248
Epoch 5, Train Loss 0.589068, Valid_loss 0.675891
Epoch 6, Train Loss 0.561983, Valid_loss 0.689116
Epoch 7, Train Loss 0.554697, Valid_loss 0.699476
Epoch 8, Train Loss 0.538086, Valid_loss 0.708268
Epoch 9, Train Loss 0.538298, Valid_loss 0.714489
Epoch 10, Train Loss 0.537511, Valid_loss 0.715049
Epoch 11, Train Loss 0.531468, Valid_loss 0.713034
Epoch 12, Train Loss 0.538546, Valid_loss 0.711918
Epoch 13, Train Loss 0.526691, Valid_loss 0.709085
Epoch 14, Train Loss 0.531100, Valid_loss 0.705770
Epoch 15, Train Loss 0.509565, Valid_loss 0.700922
Epoch 16, Train Loss 0.517398, Valid_loss 0.698844
Epoch 17, Train Loss 0.505116, Valid_loss 0.695812
Epoch 18, Train Loss 0.524600, Valid_loss 0.690490
Epoch 19, Train Loss 0.509659, Valid_loss 0.680452
Epoch 20, Train Loss 0.507834, Valid_loss 0.670534
Epoch 21, Train Loss 0.488316, Valid_loss 0.651770
Epoch 22, Train Loss 0.486220, Valid_loss 0.643180
Epoch 23, Train Loss 0.480348, Valid_loss 0.638949
Epoch 24, Train Loss 0.476362, Valid_loss 0.627721
Epoch 25, Train Loss 0.466138, Valid_loss 0.622246
Epoch 26, Train Loss 0.468322, Valid_loss 0.602277
Epoch 27, Train Loss 0.459881, Valid_loss 0.585235
Epoch 28, Train Loss 0.458261, Valid_loss 0.576120
Epoch 29, Train Loss 0.448784, Valid_loss 0.566885
Epoch 30, Train Loss 0.454120, Valid_loss 0.564267
Epoch 31, Train Loss 0.450934, Valid_loss 0.567832
Epoch 32, Train Loss 0.446164, Valid_loss 0.570469
Epoch 33, Train Loss 0.444291, Valid_loss 0.570841
Epoch 34, Train Loss 0.433651, Valid_loss 0.572725
Epoch 35, Train Loss 0.444482, Valid_loss 0.572130
Epoch 36, Train Loss 0.436427, Valid_loss 0.570293
Epoch 37, Train Loss 0.426844, Valid_loss 0.569194
Epoch 38, Train Loss 0.431173, Valid_loss 0.568309
Epoch 39, Train Loss 0.420592, Valid_loss 0.571143
Epoch 40, Train Loss 0.438779, Valid_loss 0.572000
Epoch 41, Train Loss 0.417359, Valid_loss 0.566104
Epoch 42, Train Loss 0.428829, Valid_loss 0.565455
Epoch 43, Train Loss 0.420953, Valid_loss 0.568924
Epoch 44, Train Loss 0.419309, Valid_loss 0.568969
Epoch 45, Train Loss 0.434593, Valid_loss 0.566926
Epoch 46, Train Loss 0.413990, Valid_loss 0.564835
Epoch 47, Train Loss 0.420114, Valid_loss 0.566994
Epoch 48, Train Loss 0.430286, Valid_loss 0.564451
Epoch 49, Train Loss 0.414760, Valid_loss 0.561343
Epoch 50, Train Loss 0.409993, Valid_loss 0.557065
Epoch 51, Train Loss 0.418900, Valid_loss 0.561668
Epoch 52, Train Loss 0.417539, Valid_loss 0.565477
Control_Participant7 -- true: normal -- pred: normal
Control_Participant5 -- true: normal -- pred: normal
COVID19_Participant26 -- true: COVID-19 -- pred: COVID-19
COVID19_Participant26 -- true: COVID-19 -- pred: COVID-19
COVID19_Participant13 -- true: COVID-19 -- pred: COVID-19
Control_Participant7 -- true: normal -- pred: normal
true :  [0, 0, 1, 1, 1, 0]
pred :  [0, 0, 1, 1, 1, 0]
Confusion Matrix: [3 0 0 3]
Best performance: Epoch 50, Loss 0.409993, Test ACC 1.000000, Test AUC 1.000000, Test Recall 1.000000, Test Precision 1.000000
✅ Total valid splits used: 3
🔁 Repeat 0, Fold 3
🔍 Split #4
  → train_p_index 환자 수: 25
  → test_p_index 환자 수: 7
  → train 환자 ID: ['COVID19_Participant11', 'COVID19_Participant13', 'COVID19_Participant14', 'COVID19_Participant15', 'COVID19_Participant17', 'COVID19_Participant2', 'COVID19_Participant22', 'COVID19_Participant23', 'COVID19_Participant25', 'COVID19_Participant28', 'COVID19_Participant31', 'COVID19_Participant32', 'COVID19_Participant37', 'COVID19_Participant39', 'COVID19_Participant4', 'COVID19_Participant40', 'COVID19_Participant8', 'Control_Participant1', 'Control_Participant10', 'Control_Participant11', 'Control_Participant15', 'Control_Participant3', 'Control_Participant4', 'Control_Participant7', 'Control_Participant9']
  → test  환자 ID: ['Control_Participant12', 'Control_Participant3', 'Control_Participant7', 'COVID19_Participant11', 'COVID19_Participant13', 'COVID19_Participant13', 'COVID19_Participant25']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant10, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant4, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: Control_Participant12, Label: 1
    ID: Control_Participant3, Label: 1
    ID: Control_Participant7, Label: 1
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant13, Label: 0
    ID: COVID19_Participant25, Label: 0
train_p_index_ 16
valid_p_index 9
test_p_index 7
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Keratinocytes', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Neurons', 'iPS_cells', 'Embryonic_stem_cells', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
data augment 실행 함
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:10,  9.78it/s]  2%|▏         | 2/100 [00:00<00:10,  9.06it/s]  3%|▎         | 3/100 [00:00<00:10,  9.02it/s]  4%|▍         | 4/100 [00:00<00:10,  9.31it/s]  6%|▌         | 6/100 [00:00<00:09, 10.12it/s]  7%|▋         | 7/100 [00:00<00:09, 10.09it/s]  8%|▊         | 8/100 [00:00<00:09,  9.76it/s]  9%|▉         | 9/100 [00:00<00:09,  9.79it/s] 10%|█         | 10/100 [00:01<00:09,  9.76it/s] 11%|█         | 11/100 [00:01<00:09,  9.64it/s] 12%|█▏        | 12/100 [00:01<00:09,  9.30it/s] 13%|█▎        | 13/100 [00:01<00:09,  9.15it/s] 14%|█▍        | 14/100 [00:01<00:09,  9.08it/s] 15%|█▌        | 15/100 [00:01<00:09,  9.04it/s] 16%|█▌        | 16/100 [00:01<00:09,  9.03it/s] 17%|█▋        | 17/100 [00:01<00:09,  8.81it/s] 18%|█▊        | 18/100 [00:01<00:09,  8.76it/s] 19%|█▉        | 19/100 [00:02<00:09,  8.79it/s] 20%|██        | 20/100 [00:02<00:09,  8.76it/s] 21%|██        | 21/100 [00:02<00:08,  8.85it/s] 22%|██▏       | 22/100 [00:02<00:08,  8.74it/s] 24%|██▍       | 24/100 [00:02<00:08,  9.19it/s] 25%|██▌       | 25/100 [00:02<00:08,  8.92it/s] 26%|██▌       | 26/100 [00:02<00:08,  8.91it/s] 27%|██▋       | 27/100 [00:02<00:08,  9.07it/s] 28%|██▊       | 28/100 [00:03<00:07,  9.29it/s] 29%|██▉       | 29/100 [00:03<00:07,  9.01it/s] 30%|███       | 30/100 [00:03<00:07,  9.24it/s] 31%|███       | 31/100 [00:03<00:07,  9.27it/s] 32%|███▏      | 32/100 [00:03<00:07,  9.09it/s] 33%|███▎      | 33/100 [00:03<00:07,  8.78it/s] 34%|███▍      | 34/100 [00:03<00:07,  8.59it/s] 35%|███▌      | 35/100 [00:03<00:07,  8.87it/s] 36%|███▌      | 36/100 [00:03<00:07,  8.68it/s] 37%|███▋      | 37/100 [00:04<00:07,  8.65it/s] 38%|███▊      | 38/100 [00:04<00:07,  8.29it/s] 39%|███▉      | 39/100 [00:04<00:07,  8.52it/s] 40%|████      | 40/100 [00:04<00:07,  8.46it/s] 41%|████      | 41/100 [00:04<00:06,  8.70it/s] 42%|████▏     | 42/100 [00:04<00:06,  8.62it/s] 43%|████▎     | 43/100 [00:04<00:06,  8.35it/s] 44%|████▍     | 44/100 [00:04<00:06,  8.24it/s] 45%|████▌     | 45/100 [00:05<00:06,  8.24it/s] 46%|████▌     | 46/100 [00:05<00:06,  8.50it/s] 47%|████▋     | 47/100 [00:05<00:06,  8.42it/s] 48%|████▊     | 48/100 [00:05<00:06,  8.18it/s] 49%|████▉     | 49/100 [00:05<00:06,  8.35it/s] 50%|█████     | 50/100 [00:05<00:05,  8.43it/s] 51%|█████     | 51/100 [00:05<00:05,  8.37it/s] 52%|█████▏    | 52/100 [00:05<00:05,  8.47it/s] 53%|█████▎    | 53/100 [00:05<00:05,  8.27it/s] 54%|█████▍    | 54/100 [00:06<00:05,  8.09it/s] 55%|█████▌    | 55/100 [00:06<00:05,  8.51it/s] 56%|█████▌    | 56/100 [00:06<00:05,  8.59it/s] 57%|█████▋    | 57/100 [00:06<00:05,  8.22it/s] 58%|█████▊    | 58/100 [00:06<00:05,  8.15it/s] 59%|█████▉    | 59/100 [00:06<00:04,  8.59it/s] 60%|██████    | 60/100 [00:06<00:04,  8.63it/s] 61%|██████    | 61/100 [00:06<00:04,  8.36it/s] 62%|██████▏   | 62/100 [00:07<00:04,  8.56it/s] 63%|██████▎   | 63/100 [00:07<00:04,  8.30it/s] 64%|██████▍   | 64/100 [00:07<00:04,  8.21it/s] 65%|██████▌   | 65/100 [00:07<00:04,  8.18it/s] 66%|██████▌   | 66/100 [00:07<00:04,  8.10it/s] 67%|██████▋   | 67/100 [00:07<00:04,  8.19it/s] 68%|██████▊   | 68/100 [00:07<00:03,  8.01it/s] 69%|██████▉   | 69/100 [00:07<00:03,  7.83it/s] 70%|███████   | 70/100 [00:08<00:03,  7.74it/s] 71%|███████   | 71/100 [00:08<00:03,  8.14it/s] 72%|███████▏  | 72/100 [00:08<00:03,  8.25it/s] 73%|███████▎  | 73/100 [00:08<00:03,  8.15it/s] 74%|███████▍  | 74/100 [00:08<00:03,  8.10it/s] 75%|███████▌  | 75/100 [00:08<00:03,  8.07it/s] 76%|███████▌  | 76/100 [00:08<00:02,  8.05it/s] 77%|███████▋  | 77/100 [00:08<00:02,  8.00it/s] 78%|███████▊  | 78/100 [00:09<00:02,  7.41it/s] 79%|███████▉  | 79/100 [00:09<00:02,  7.60it/s] 80%|████████  | 80/100 [00:09<00:02,  7.76it/s] 81%|████████  | 81/100 [00:09<00:02,  7.74it/s] 82%|████████▏ | 82/100 [00:09<00:02,  7.85it/s] 83%|████████▎ | 83/100 [00:09<00:02,  8.00it/s] 84%|████████▍ | 84/100 [00:09<00:02,  7.87it/s] 85%|████████▌ | 85/100 [00:09<00:01,  7.71it/s] 86%|████████▌ | 86/100 [00:10<00:01,  7.38it/s] 87%|████████▋ | 87/100 [00:10<00:01,  7.59it/s] 88%|████████▊ | 88/100 [00:10<00:01,  7.63it/s] 89%|████████▉ | 89/100 [00:10<00:01,  7.86it/s] 90%|█████████ | 90/100 [00:10<00:01,  7.85it/s] 91%|█████████ | 91/100 [00:10<00:01,  7.76it/s] 92%|█████████▏| 92/100 [00:10<00:01,  7.75it/s] 93%|█████████▎| 93/100 [00:10<00:00,  7.89it/s] 94%|█████████▍| 94/100 [00:11<00:00,  7.81it/s] 95%|█████████▌| 95/100 [00:11<00:00,  7.82it/s] 96%|█████████▌| 96/100 [00:11<00:00,  7.56it/s] 97%|█████████▋| 97/100 [00:11<00:00,  7.52it/s] 98%|█████████▊| 98/100 [00:11<00:00,  7.46it/s] 99%|█████████▉| 99/100 [00:11<00:00,  7.37it/s]100%|██████████| 100/100 [00:11<00:00,  7.46it/s]100%|██████████| 100/100 [00:11<00:00,  8.38it/s]
eval_p_index len:  16
individual_train 116
individual_eval 16
train data의 x, y, id 길이: 116 116 116
valid data의 x, y, id 길이: 9 9 9
test data의 x, y, id 길이: 7 7 7
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.628982, Valid_loss 0.673935
Epoch 2, Train Loss 0.606045, Valid_loss 0.688294
Epoch 3, Train Loss 0.595636, Valid_loss 0.690707
Epoch 4, Train Loss 0.583294, Valid_loss 0.686334
Epoch 5, Train Loss 0.570880, Valid_loss 0.674675
Epoch 6, Train Loss 0.572360, Valid_loss 0.667748
Epoch 7, Train Loss 0.569744, Valid_loss 0.653411
Epoch 8, Train Loss 0.557279, Valid_loss 0.636672
Epoch 9, Train Loss 0.532675, Valid_loss 0.629199
Epoch 10, Train Loss 0.526144, Valid_loss 0.625904
Epoch 11, Train Loss 0.527008, Valid_loss 0.598731
Epoch 12, Train Loss 0.505325, Valid_loss 0.590268
Epoch 13, Train Loss 0.487588, Valid_loss 0.616303
Epoch 14, Train Loss 0.494014, Valid_loss 0.618109
Epoch 15, Train Loss 0.481708, Valid_loss 0.539662
Epoch 16, Train Loss 0.472678, Valid_loss 0.540721
Epoch 17, Train Loss 0.469006, Valid_loss 0.566435
Epoch 18, Train Loss 0.464958, Valid_loss 0.532226
Epoch 19, Train Loss 0.477838, Valid_loss 0.507814
Epoch 20, Train Loss 0.457402, Valid_loss 0.535928
Epoch 21, Train Loss 0.459871, Valid_loss 0.531200
Epoch 22, Train Loss 0.455489, Valid_loss 0.502381
Epoch 23, Train Loss 0.445926, Valid_loss 0.538216
Epoch 24, Train Loss 0.448488, Valid_loss 0.539022
Epoch 25, Train Loss 0.450900, Valid_loss 0.506673
Epoch 26, Train Loss 0.456387, Valid_loss 0.520819
Epoch 27, Train Loss 0.454574, Valid_loss 0.537985
Epoch 28, Train Loss 0.433542, Valid_loss 0.529653
Epoch 29, Train Loss 0.449450, Valid_loss 0.528818
Epoch 30, Train Loss 0.445611, Valid_loss 0.529053
Epoch 31, Train Loss 0.448070, Valid_loss 0.527261
Epoch 32, Train Loss 0.439487, Valid_loss 0.526208
Epoch 33, Train Loss 0.438888, Valid_loss 0.531912
Epoch 34, Train Loss 0.445285, Valid_loss 0.537872
Epoch 35, Train Loss 0.436823, Valid_loss 0.529843
Epoch 36, Train Loss 0.430061, Valid_loss 0.545816
Epoch 37, Train Loss 0.420528, Valid_loss 0.539213
Epoch 38, Train Loss 0.429082, Valid_loss 0.529644
Epoch 39, Train Loss 0.422851, Valid_loss 0.540520
Epoch 40, Train Loss 0.418583, Valid_loss 0.540287
Epoch 41, Train Loss 0.421342, Valid_loss 0.530939
Epoch 42, Train Loss 0.418721, Valid_loss 0.541117
Epoch 43, Train Loss 0.420804, Valid_loss 0.538392
Epoch 44, Train Loss 0.414353, Valid_loss 0.534186
Epoch 45, Train Loss 0.415655, Valid_loss 0.555110
Epoch 46, Train Loss 0.423015, Valid_loss 0.533912
Epoch 47, Train Loss 0.419097, Valid_loss 0.536228
Epoch 48, Train Loss 0.406770, Valid_loss 0.553456
Epoch 49, Train Loss 0.426216, Valid_loss 0.546568
Epoch 50, Train Loss 0.409632, Valid_loss 0.539478
Epoch 51, Train Loss 0.427505, Valid_loss 0.545662
Epoch 52, Train Loss 0.408649, Valid_loss 0.554850
Control_Participant12 -- true: normal -- pred: COVID-19
Control_Participant3 -- true: normal -- pred: normal
Control_Participant7 -- true: normal -- pred: normal
COVID19_Participant11 -- true: COVID-19 -- pred: COVID-19
COVID19_Participant13 -- true: COVID-19 -- pred: COVID-19
COVID19_Participant13 -- true: COVID-19 -- pred: COVID-19
COVID19_Participant25 -- true: COVID-19 -- pred: COVID-19
true :  [0, 0, 0, 1, 1, 1, 1]
pred :  [1, 0, 0, 1, 1, 1, 1]
Confusion Matrix: [2 1 0 4]
Best performance: Epoch 22, Loss 0.455489, Test ACC 0.857143, Test AUC 1.000000, Test Recall 1.000000, Test Precision 0.800000
✅ Total valid splits used: 4
🔁 Repeat 0, Fold 4
🔍 Split #5
  → train_p_index 환자 수: 25
  → test_p_index 환자 수: 7
  → train 환자 ID: ['COVID19_Participant11', 'COVID19_Participant14', 'COVID19_Participant15', 'COVID19_Participant19', 'COVID19_Participant2', 'COVID19_Participant20', 'COVID19_Participant23', 'COVID19_Participant25', 'COVID19_Participant26', 'COVID19_Participant28', 'COVID19_Participant29', 'COVID19_Participant31', 'COVID19_Participant32', 'COVID19_Participant39', 'COVID19_Participant4', 'COVID19_Participant7', 'COVID19_Participant8', 'Control_Participant11', 'Control_Participant15', 'Control_Participant3', 'Control_Participant4', 'Control_Participant5', 'Control_Participant7', 'Control_Participant8', 'Control_Participant9']
  → test  환자 ID: ['Control_Participant7', 'Control_Participant5', 'Control_Participant3', 'COVID19_Participant25', 'COVID19_Participant11', 'Control_Participant7', 'Control_Participant12']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: Control_Participant11, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant4, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant8, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: Control_Participant7, Label: 1
    ID: Control_Participant5, Label: 1
    ID: Control_Participant3, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant11, Label: 1
    ID: Control_Participant7, Label: 0
    ID: Control_Participant12, Label: 0
train_p_index_ 16
valid_p_index 9
test_p_index 7
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Keratinocytes', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Neurons', 'iPS_cells', 'Embryonic_stem_cells', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
data augment 실행 함
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:10,  9.41it/s]  2%|▏         | 2/100 [00:00<00:10,  9.11it/s]  3%|▎         | 3/100 [00:00<00:10,  9.23it/s]  4%|▍         | 4/100 [00:00<00:10,  9.12it/s]  5%|▌         | 5/100 [00:00<00:10,  8.96it/s]  6%|▌         | 6/100 [00:00<00:10,  8.93it/s]  7%|▋         | 7/100 [00:00<00:10,  9.02it/s]  8%|▊         | 8/100 [00:00<00:10,  8.96it/s]  9%|▉         | 9/100 [00:00<00:09,  9.11it/s] 10%|█         | 10/100 [00:01<00:10,  8.93it/s] 11%|█         | 11/100 [00:01<00:09,  9.03it/s] 12%|█▏        | 12/100 [00:01<00:10,  8.60it/s] 13%|█▎        | 13/100 [00:01<00:10,  8.59it/s] 14%|█▍        | 14/100 [00:01<00:09,  8.62it/s] 15%|█▌        | 15/100 [00:01<00:09,  8.80it/s] 16%|█▌        | 16/100 [00:01<00:09,  8.77it/s] 17%|█▋        | 17/100 [00:01<00:09,  8.68it/s] 18%|█▊        | 18/100 [00:02<00:09,  8.69it/s] 19%|█▉        | 19/100 [00:02<00:09,  8.65it/s] 20%|██        | 20/100 [00:02<00:09,  8.65it/s] 21%|██        | 21/100 [00:02<00:08,  8.83it/s] 22%|██▏       | 22/100 [00:02<00:09,  8.66it/s] 23%|██▎       | 23/100 [00:02<00:08,  8.77it/s] 24%|██▍       | 24/100 [00:02<00:08,  8.62it/s] 25%|██▌       | 25/100 [00:02<00:08,  8.81it/s] 26%|██▌       | 26/100 [00:02<00:08,  8.89it/s] 27%|██▋       | 27/100 [00:03<00:08,  8.80it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.76it/s] 29%|██▉       | 29/100 [00:03<00:08,  8.66it/s] 30%|███       | 30/100 [00:03<00:08,  8.67it/s] 31%|███       | 31/100 [00:03<00:08,  8.61it/s] 32%|███▏      | 32/100 [00:03<00:07,  8.91it/s] 33%|███▎      | 33/100 [00:03<00:07,  8.71it/s] 34%|███▍      | 34/100 [00:03<00:07,  8.63it/s] 35%|███▌      | 35/100 [00:03<00:07,  8.78it/s] 36%|███▌      | 36/100 [00:04<00:07,  8.65it/s] 37%|███▋      | 37/100 [00:04<00:07,  8.66it/s] 38%|███▊      | 38/100 [00:04<00:07,  8.73it/s] 39%|███▉      | 39/100 [00:04<00:06,  8.78it/s] 40%|████      | 40/100 [00:04<00:06,  8.60it/s] 41%|████      | 41/100 [00:04<00:06,  8.54it/s] 42%|████▏     | 42/100 [00:04<00:06,  8.48it/s] 43%|████▎     | 43/100 [00:04<00:06,  8.26it/s] 44%|████▍     | 44/100 [00:05<00:06,  8.23it/s] 45%|████▌     | 45/100 [00:05<00:06,  8.18it/s] 46%|████▌     | 46/100 [00:05<00:06,  8.20it/s] 47%|████▋     | 47/100 [00:05<00:06,  8.11it/s] 48%|████▊     | 48/100 [00:05<00:06,  8.18it/s] 49%|████▉     | 49/100 [00:05<00:06,  7.74it/s] 50%|█████     | 50/100 [00:05<00:06,  7.89it/s] 51%|█████     | 51/100 [00:05<00:06,  8.04it/s] 52%|█████▏    | 52/100 [00:06<00:05,  8.17it/s] 53%|█████▎    | 53/100 [00:06<00:05,  8.16it/s] 54%|█████▍    | 54/100 [00:06<00:05,  7.91it/s] 55%|█████▌    | 55/100 [00:06<00:05,  7.96it/s] 56%|█████▌    | 56/100 [00:06<00:05,  7.93it/s] 57%|█████▋    | 57/100 [00:06<00:05,  8.09it/s] 58%|█████▊    | 58/100 [00:06<00:05,  8.15it/s] 59%|█████▉    | 59/100 [00:06<00:04,  8.22it/s] 60%|██████    | 60/100 [00:07<00:04,  8.25it/s] 61%|██████    | 61/100 [00:07<00:04,  8.38it/s] 62%|██████▏   | 62/100 [00:07<00:04,  8.27it/s] 63%|██████▎   | 63/100 [00:07<00:04,  7.93it/s] 64%|██████▍   | 64/100 [00:07<00:04,  8.09it/s] 65%|██████▌   | 65/100 [00:07<00:04,  8.11it/s] 66%|██████▌   | 66/100 [00:07<00:04,  8.10it/s] 67%|██████▋   | 67/100 [00:07<00:04,  8.06it/s] 68%|██████▊   | 68/100 [00:08<00:04,  7.93it/s] 69%|██████▉   | 69/100 [00:08<00:03,  8.07it/s] 70%|███████   | 70/100 [00:08<00:03,  8.05it/s] 71%|███████   | 71/100 [00:08<00:03,  8.06it/s] 72%|███████▏  | 72/100 [00:08<00:03,  8.01it/s] 73%|███████▎  | 73/100 [00:08<00:03,  8.16it/s] 74%|███████▍  | 74/100 [00:08<00:03,  8.44it/s] 75%|███████▌  | 75/100 [00:08<00:02,  8.35it/s] 76%|███████▌  | 76/100 [00:08<00:02,  8.22it/s] 77%|███████▋  | 77/100 [00:09<00:02,  8.44it/s] 78%|███████▊  | 78/100 [00:09<00:02,  8.45it/s] 79%|███████▉  | 79/100 [00:09<00:02,  8.40it/s] 80%|████████  | 80/100 [00:09<00:02,  8.30it/s] 81%|████████  | 81/100 [00:09<00:02,  8.18it/s] 82%|████████▏ | 82/100 [00:09<00:02,  7.97it/s] 83%|████████▎ | 83/100 [00:09<00:02,  7.98it/s] 84%|████████▍ | 84/100 [00:09<00:02,  7.72it/s] 85%|████████▌ | 85/100 [00:10<00:01,  7.51it/s] 86%|████████▌ | 86/100 [00:10<00:01,  7.43it/s] 87%|████████▋ | 87/100 [00:10<00:01,  7.66it/s] 88%|████████▊ | 88/100 [00:10<00:01,  7.89it/s] 89%|████████▉ | 89/100 [00:10<00:01,  7.94it/s] 90%|█████████ | 90/100 [00:10<00:01,  7.88it/s] 91%|█████████ | 91/100 [00:10<00:01,  8.17it/s] 92%|█████████▏| 92/100 [00:11<00:00,  8.10it/s] 93%|█████████▎| 93/100 [00:11<00:00,  7.69it/s] 94%|█████████▍| 94/100 [00:11<00:00,  7.74it/s] 95%|█████████▌| 95/100 [00:11<00:00,  7.59it/s] 96%|█████████▌| 96/100 [00:11<00:00,  7.62it/s] 97%|█████████▋| 97/100 [00:11<00:00,  7.59it/s] 98%|█████████▊| 98/100 [00:11<00:00,  7.58it/s] 99%|█████████▉| 99/100 [00:11<00:00,  7.67it/s]100%|██████████| 100/100 [00:12<00:00,  7.71it/s]100%|██████████| 100/100 [00:12<00:00,  8.29it/s]
eval_p_index len:  16
individual_train 116
individual_eval 16
train data의 x, y, id 길이: 116 116 116
valid data의 x, y, id 길이: 9 9 9
test data의 x, y, id 길이: 7 7 7
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.702738, Valid_loss 0.680333
Epoch 2, Train Loss 0.671140, Valid_loss 0.692515
Epoch 3, Train Loss 0.660475, Valid_loss 0.681789
Epoch 4, Train Loss 0.649384, Valid_loss 0.659960
Epoch 5, Train Loss 0.645324, Valid_loss 0.650752
Epoch 6, Train Loss 0.643433, Valid_loss 0.652847
Epoch 7, Train Loss 0.628687, Valid_loss 0.638267
Epoch 8, Train Loss 0.624015, Valid_loss 0.633173
Epoch 9, Train Loss 0.613804, Valid_loss 0.626732
Epoch 10, Train Loss 0.602337, Valid_loss 0.620445
Epoch 11, Train Loss 0.596814, Valid_loss 0.609582
Epoch 12, Train Loss 0.599527, Valid_loss 0.603680
Epoch 13, Train Loss 0.583795, Valid_loss 0.602113
Epoch 14, Train Loss 0.578165, Valid_loss 0.594718
Epoch 15, Train Loss 0.565805, Valid_loss 0.588154
Epoch 16, Train Loss 0.559008, Valid_loss 0.583568
Epoch 17, Train Loss 0.565729, Valid_loss 0.580674
Epoch 18, Train Loss 0.563799, Valid_loss 0.580393
Epoch 19, Train Loss 0.569325, Valid_loss 0.574908
Epoch 20, Train Loss 0.557829, Valid_loss 0.570887
Epoch 21, Train Loss 0.560791, Valid_loss 0.569503
Epoch 22, Train Loss 0.556879, Valid_loss 0.566513
Epoch 23, Train Loss 0.549431, Valid_loss 0.567104
Epoch 24, Train Loss 0.551547, Valid_loss 0.562440
Epoch 25, Train Loss 0.544678, Valid_loss 0.560006
Epoch 26, Train Loss 0.539963, Valid_loss 0.559337
Epoch 27, Train Loss 0.544777, Valid_loss 0.557679
Epoch 28, Train Loss 0.538056, Valid_loss 0.555853
Epoch 29, Train Loss 0.542030, Valid_loss 0.554709
Epoch 30, Train Loss 0.534999, Valid_loss 0.553157
Epoch 31, Train Loss 0.526141, Valid_loss 0.555262
Epoch 32, Train Loss 0.539099, Valid_loss 0.550068
Epoch 33, Train Loss 0.526782, Valid_loss 0.548804
Epoch 34, Train Loss 0.537523, Valid_loss 0.549712
Epoch 35, Train Loss 0.534109, Valid_loss 0.547322
Epoch 36, Train Loss 0.547688, Valid_loss 0.549194
Epoch 37, Train Loss 0.528426, Valid_loss 0.546968
Epoch 38, Train Loss 0.527212, Valid_loss 0.548695
Epoch 39, Train Loss 0.528133, Valid_loss 0.548043
Epoch 40, Train Loss 0.517122, Valid_loss 0.548920
Epoch 41, Train Loss 0.518880, Valid_loss 0.549024
Epoch 42, Train Loss 0.522710, Valid_loss 0.546589
Epoch 43, Train Loss 0.517727, Valid_loss 0.545751
Epoch 44, Train Loss 0.509567, Valid_loss 0.546154
Epoch 45, Train Loss 0.512657, Valid_loss 0.545623
Epoch 46, Train Loss 0.510132, Valid_loss 0.543566
Epoch 47, Train Loss 0.509038, Valid_loss 0.546679
Epoch 48, Train Loss 0.511309, Valid_loss 0.544106
Epoch 49, Train Loss 0.512055, Valid_loss 0.547859
Epoch 50, Train Loss 0.501589, Valid_loss 0.545921
Epoch 51, Train Loss 0.508039, Valid_loss 0.546560
Epoch 52, Train Loss 0.513677, Valid_loss 0.546673
Control_Participant7 -- true: normal -- pred: normal
Control_Participant5 -- true: normal -- pred: normal
Control_Participant3 -- true: normal -- pred: normal
COVID19_Participant25 -- true: COVID-19 -- pred: COVID-19
COVID19_Participant11 -- true: COVID-19 -- pred: normal
Control_Participant7 -- true: normal -- pred: COVID-19
Control_Participant12 -- true: normal -- pred: COVID-19
true :  [0, 0, 0, 1, 1, 0, 0]
pred :  [0, 0, 0, 1, 0, 1, 1]
Confusion Matrix: [3 2 1 1]
Best performance: Epoch 46, Loss 0.510132, Test ACC 0.571429, Test AUC 0.700000, Test Recall 0.500000, Test Precision 0.333333
✅ Total valid splits used: 5

📌 Repeat 0: 평균 AUC = 0.9000, 표준편차 = 0.1265
🔁 Repeat 1, Fold 0
🔍 Split #1
  → train_p_index 환자 수: 24
  → test_p_index 환자 수: 8
  → train 환자 ID: ['COVID19_Participant13', 'COVID19_Participant14', 'COVID19_Participant15', 'COVID19_Participant17', 'COVID19_Participant19', 'COVID19_Participant20', 'COVID19_Participant22', 'COVID19_Participant26', 'COVID19_Participant28', 'COVID19_Participant29', 'COVID19_Participant31', 'COVID19_Participant32', 'COVID19_Participant39', 'COVID19_Participant4', 'COVID19_Participant40', 'COVID19_Participant8', 'Control_Participant1', 'Control_Participant10', 'Control_Participant11', 'Control_Participant15', 'Control_Participant3', 'Control_Participant4', 'Control_Participant7', 'Control_Participant8']
  → test  환자 ID: ['COVID19_Participant31', 'Control_Participant3', 'Control_Participant1', 'Control_Participant7', 'COVID19_Participant26', 'Control_Participant7', 'COVID19_Participant13', 'COVID19_Participant5']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant10, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant4, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant8, Label: 0
  → test 환자 ID 및 라벨:
    ID: COVID19_Participant31, Label: 1
    ID: Control_Participant3, Label: 1
    ID: Control_Participant1, Label: 1
    ID: Control_Participant7, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: Control_Participant7, Label: 1
    ID: COVID19_Participant13, Label: 0
    ID: COVID19_Participant5, Label: 0
train_p_index_ 16
valid_p_index 8
test_p_index 8
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Keratinocytes', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Neurons', 'iPS_cells', 'Embryonic_stem_cells', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
data augment 실행 함
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:10,  9.19it/s]  2%|▏         | 2/100 [00:00<00:11,  8.36it/s]  4%|▍         | 4/100 [00:00<00:10,  9.22it/s]  5%|▌         | 5/100 [00:00<00:10,  9.32it/s]  6%|▌         | 6/100 [00:00<00:10,  9.11it/s]  7%|▋         | 7/100 [00:00<00:10,  8.57it/s]  8%|▊         | 8/100 [00:00<00:10,  8.38it/s]  9%|▉         | 9/100 [00:01<00:10,  8.58it/s] 10%|█         | 10/100 [00:01<00:10,  8.64it/s] 11%|█         | 11/100 [00:01<00:10,  8.62it/s] 12%|█▏        | 12/100 [00:01<00:10,  8.77it/s] 13%|█▎        | 13/100 [00:01<00:09,  8.90it/s] 15%|█▌        | 15/100 [00:01<00:09,  9.05it/s] 16%|█▌        | 16/100 [00:01<00:09,  9.13it/s] 17%|█▋        | 17/100 [00:01<00:09,  8.86it/s] 18%|█▊        | 18/100 [00:02<00:09,  8.71it/s] 19%|█▉        | 19/100 [00:02<00:09,  8.88it/s] 20%|██        | 20/100 [00:02<00:09,  8.82it/s] 21%|██        | 21/100 [00:02<00:08,  9.09it/s] 22%|██▏       | 22/100 [00:02<00:08,  9.09it/s] 23%|██▎       | 23/100 [00:02<00:08,  9.06it/s] 24%|██▍       | 24/100 [00:02<00:09,  7.86it/s] 26%|██▌       | 26/100 [00:02<00:08,  8.61it/s] 27%|██▋       | 27/100 [00:03<00:08,  8.62it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.75it/s] 29%|██▉       | 29/100 [00:03<00:08,  8.77it/s] 30%|███       | 30/100 [00:03<00:07,  8.95it/s] 31%|███       | 31/100 [00:03<00:07,  8.98it/s] 32%|███▏      | 32/100 [00:03<00:07,  8.94it/s] 33%|███▎      | 33/100 [00:03<00:07,  9.07it/s] 34%|███▍      | 34/100 [00:03<00:07,  9.19it/s] 35%|███▌      | 35/100 [00:03<00:07,  9.22it/s] 36%|███▌      | 36/100 [00:04<00:07,  8.91it/s] 37%|███▋      | 37/100 [00:04<00:07,  8.98it/s] 38%|███▊      | 38/100 [00:04<00:06,  8.99it/s] 39%|███▉      | 39/100 [00:04<00:06,  8.94it/s] 40%|████      | 40/100 [00:04<00:06,  8.94it/s] 41%|████      | 41/100 [00:04<00:06,  8.97it/s] 42%|████▏     | 42/100 [00:04<00:06,  8.48it/s] 43%|████▎     | 43/100 [00:04<00:06,  8.75it/s] 44%|████▍     | 44/100 [00:04<00:06,  8.38it/s] 45%|████▌     | 45/100 [00:05<00:06,  8.39it/s] 46%|████▌     | 46/100 [00:05<00:06,  8.49it/s] 47%|████▋     | 47/100 [00:05<00:06,  8.49it/s] 48%|████▊     | 48/100 [00:05<00:06,  8.16it/s] 49%|████▉     | 49/100 [00:05<00:06,  8.31it/s] 50%|█████     | 50/100 [00:05<00:05,  8.61it/s] 51%|█████     | 51/100 [00:05<00:05,  8.41it/s] 52%|█████▏    | 52/100 [00:05<00:05,  8.50it/s] 53%|█████▎    | 53/100 [00:06<00:05,  8.54it/s] 54%|█████▍    | 54/100 [00:06<00:05,  8.30it/s] 55%|█████▌    | 55/100 [00:06<00:05,  8.18it/s] 56%|█████▌    | 56/100 [00:06<00:05,  8.09it/s] 57%|█████▋    | 57/100 [00:06<00:05,  8.01it/s] 58%|█████▊    | 58/100 [00:06<00:05,  7.81it/s] 59%|█████▉    | 59/100 [00:06<00:05,  7.87it/s] 60%|██████    | 60/100 [00:06<00:05,  7.64it/s] 61%|██████    | 61/100 [00:07<00:04,  8.18it/s] 62%|██████▏   | 62/100 [00:07<00:04,  8.33it/s] 63%|██████▎   | 63/100 [00:07<00:04,  8.30it/s] 64%|██████▍   | 64/100 [00:07<00:04,  8.15it/s] 65%|██████▌   | 65/100 [00:07<00:04,  8.22it/s] 66%|██████▌   | 66/100 [00:07<00:04,  8.04it/s] 67%|██████▋   | 67/100 [00:07<00:04,  8.21it/s] 68%|██████▊   | 68/100 [00:07<00:03,  8.12it/s] 69%|██████▉   | 69/100 [00:08<00:04,  7.62it/s] 70%|███████   | 70/100 [00:08<00:03,  7.93it/s] 71%|███████   | 71/100 [00:08<00:03,  7.91it/s] 72%|███████▏  | 72/100 [00:08<00:03,  7.94it/s] 73%|███████▎  | 73/100 [00:08<00:03,  7.91it/s] 74%|███████▍  | 74/100 [00:08<00:03,  8.00it/s] 75%|███████▌  | 75/100 [00:08<00:03,  8.04it/s] 76%|███████▌  | 76/100 [00:08<00:02,  8.18it/s] 77%|███████▋  | 77/100 [00:09<00:02,  7.98it/s] 78%|███████▊  | 78/100 [00:09<00:02,  7.96it/s] 79%|███████▉  | 79/100 [00:09<00:02,  7.88it/s] 80%|████████  | 80/100 [00:09<00:02,  7.83it/s] 81%|████████  | 81/100 [00:09<00:02,  7.81it/s] 82%|████████▏ | 82/100 [00:09<00:02,  7.92it/s] 83%|████████▎ | 83/100 [00:09<00:02,  7.01it/s] 84%|████████▍ | 84/100 [00:10<00:02,  7.24it/s] 85%|████████▌ | 85/100 [00:10<00:02,  7.44it/s] 86%|████████▌ | 86/100 [00:10<00:01,  7.73it/s] 87%|████████▋ | 87/100 [00:10<00:01,  8.05it/s] 88%|████████▊ | 88/100 [00:10<00:01,  7.47it/s] 89%|████████▉ | 89/100 [00:10<00:01,  7.61it/s] 90%|█████████ | 90/100 [00:10<00:01,  7.76it/s] 91%|█████████ | 91/100 [00:10<00:01,  7.69it/s] 92%|█████████▏| 92/100 [00:11<00:01,  7.77it/s] 93%|█████████▎| 93/100 [00:11<00:00,  7.74it/s] 94%|█████████▍| 94/100 [00:11<00:00,  7.78it/s] 95%|█████████▌| 95/100 [00:11<00:00,  7.54it/s] 96%|█████████▌| 96/100 [00:11<00:00,  7.51it/s] 97%|█████████▋| 97/100 [00:11<00:00,  7.69it/s] 98%|█████████▊| 98/100 [00:11<00:00,  7.71it/s] 99%|█████████▉| 99/100 [00:11<00:00,  7.77it/s]100%|██████████| 100/100 [00:12<00:00,  7.96it/s]100%|██████████| 100/100 [00:12<00:00,  8.29it/s]
eval_p_index len:  16
individual_train 116
individual_eval 16
train data의 x, y, id 길이: 116 116 116
valid data의 x, y, id 길이: 8 8 8
test data의 x, y, id 길이: 8 8 8
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.710694, Valid_loss 0.689016
Epoch 2, Train Loss 0.660207, Valid_loss 0.696650
Epoch 3, Train Loss 0.648773, Valid_loss 0.695714
Epoch 4, Train Loss 0.655038, Valid_loss 0.694043
Epoch 5, Train Loss 0.639780, Valid_loss 0.693733
Epoch 6, Train Loss 0.641124, Valid_loss 0.693614
Epoch 7, Train Loss 0.646305, Valid_loss 0.688540
Epoch 8, Train Loss 0.633009, Valid_loss 0.685964
Epoch 9, Train Loss 0.626500, Valid_loss 0.687179
Epoch 10, Train Loss 0.625966, Valid_loss 0.679579
Epoch 11, Train Loss 0.624955, Valid_loss 0.676394
Epoch 12, Train Loss 0.619655, Valid_loss 0.678061
Epoch 13, Train Loss 0.613094, Valid_loss 0.669457
Epoch 14, Train Loss 0.608169, Valid_loss 0.663140
Epoch 15, Train Loss 0.607446, Valid_loss 0.664639
Epoch 16, Train Loss 0.606054, Valid_loss 0.648301
Epoch 17, Train Loss 0.607053, Valid_loss 0.648777
Epoch 18, Train Loss 0.593405, Valid_loss 0.644788
Epoch 19, Train Loss 0.589874, Valid_loss 0.641591
Epoch 20, Train Loss 0.592805, Valid_loss 0.634770
Epoch 21, Train Loss 0.606748, Valid_loss 0.637711
Epoch 22, Train Loss 0.579009, Valid_loss 0.631871
Epoch 23, Train Loss 0.587242, Valid_loss 0.627089
Epoch 24, Train Loss 0.573514, Valid_loss 0.622333
Epoch 25, Train Loss 0.568036, Valid_loss 0.621906
Epoch 26, Train Loss 0.567986, Valid_loss 0.617910
Epoch 27, Train Loss 0.565189, Valid_loss 0.617672
Epoch 28, Train Loss 0.565148, Valid_loss 0.619040
Epoch 29, Train Loss 0.560228, Valid_loss 0.612558
Epoch 30, Train Loss 0.562613, Valid_loss 0.609057
Epoch 31, Train Loss 0.558717, Valid_loss 0.612577
Epoch 32, Train Loss 0.555279, Valid_loss 0.614828
Epoch 33, Train Loss 0.556415, Valid_loss 0.608514
Epoch 34, Train Loss 0.548238, Valid_loss 0.610983
Epoch 35, Train Loss 0.542509, Valid_loss 0.607692
Epoch 36, Train Loss 0.547487, Valid_loss 0.599333
Epoch 37, Train Loss 0.540000, Valid_loss 0.606089
Epoch 38, Train Loss 0.547222, Valid_loss 0.601244
Epoch 39, Train Loss 0.538440, Valid_loss 0.607910
Epoch 40, Train Loss 0.535024, Valid_loss 0.599921
Epoch 41, Train Loss 0.532841, Valid_loss 0.595835
Epoch 42, Train Loss 0.541884, Valid_loss 0.598452
Epoch 43, Train Loss 0.525825, Valid_loss 0.613316
Epoch 44, Train Loss 0.526830, Valid_loss 0.594756
Epoch 45, Train Loss 0.525223, Valid_loss 0.595482
Epoch 46, Train Loss 0.528931, Valid_loss 0.597314
Epoch 47, Train Loss 0.522469, Valid_loss 0.594374
Epoch 48, Train Loss 0.532717, Valid_loss 0.599925
Epoch 49, Train Loss 0.518981, Valid_loss 0.600883
Epoch 50, Train Loss 0.526068, Valid_loss 0.592216
Epoch 51, Train Loss 0.518748, Valid_loss 0.596412
Epoch 52, Train Loss 0.521933, Valid_loss 0.593538
Epoch 53, Train Loss 0.522911, Valid_loss 0.593494
Epoch 54, Train Loss 0.518341, Valid_loss 0.592756
Epoch 55, Train Loss 0.525903, Valid_loss 0.593581
Epoch 56, Train Loss 0.518172, Valid_loss 0.594423
COVID19_Participant31 -- true: COVID-19 -- pred: COVID-19
Control_Participant3 -- true: normal -- pred: normal
Control_Participant1 -- true: normal -- pred: COVID-19
Control_Participant7 -- true: normal -- pred: normal
COVID19_Participant26 -- true: COVID-19 -- pred: normal
Control_Participant7 -- true: normal -- pred: normal
COVID19_Participant13 -- true: COVID-19 -- pred: COVID-19
COVID19_Participant5 -- true: COVID-19 -- pred: COVID-19
true :  [1, 0, 0, 0, 1, 0, 1, 1]
pred :  [1, 0, 1, 0, 0, 0, 1, 1]
Confusion Matrix: [3 1 1 3]
Best performance: Epoch 50, Loss 0.526068, Test ACC 0.750000, Test AUC 0.937500, Test Recall 0.750000, Test Precision 0.750000
✅ Total valid splits used: 1
🔁 Repeat 1, Fold 1
🔍 Split #2
  → train_p_index 환자 수: 25
  → test_p_index 환자 수: 7
  → train 환자 ID: ['COVID19_Participant11', 'COVID19_Participant13', 'COVID19_Participant14', 'COVID19_Participant15', 'COVID19_Participant2', 'COVID19_Participant20', 'COVID19_Participant23', 'COVID19_Participant25', 'COVID19_Participant28', 'COVID19_Participant31', 'COVID19_Participant32', 'COVID19_Participant37', 'COVID19_Participant39', 'COVID19_Participant4', 'COVID19_Participant40', 'COVID19_Participant7', 'COVID19_Participant8', 'Control_Participant1', 'Control_Participant10', 'Control_Participant11', 'Control_Participant15', 'Control_Participant4', 'Control_Participant5', 'Control_Participant8', 'Control_Participant9']
  → test  환자 ID: ['Control_Participant1', 'Control_Participant5', 'COVID19_Participant8', 'COVID19_Participant31', 'Control_Participant10', 'Control_Participant4', 'COVID19_Participant13']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant10, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant4, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant8, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: Control_Participant1, Label: 1
    ID: Control_Participant5, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: Control_Participant10, Label: 1
    ID: Control_Participant4, Label: 0
    ID: COVID19_Participant13, Label: 0
train_p_index_ 16
valid_p_index 9
test_p_index 7
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Epithelial_cells', 'Platelets', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Keratinocytes', 'Macrophage', 'Epithelial_cells', 'B_cell', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
data augment 실행 함
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:11,  8.62it/s]  2%|▏         | 2/100 [00:00<00:11,  8.70it/s]  3%|▎         | 3/100 [00:00<00:10,  8.89it/s]  4%|▍         | 4/100 [00:00<00:11,  8.65it/s]  5%|▌         | 5/100 [00:00<00:10,  8.78it/s]  6%|▌         | 6/100 [00:00<00:10,  8.96it/s]  7%|▋         | 7/100 [00:00<00:10,  8.78it/s]  8%|▊         | 8/100 [00:00<00:11,  8.19it/s]  9%|▉         | 9/100 [00:01<00:10,  8.34it/s] 10%|█         | 10/100 [00:01<00:10,  8.42it/s] 11%|█         | 11/100 [00:01<00:11,  7.99it/s] 12%|█▏        | 12/100 [00:01<00:10,  8.47it/s] 13%|█▎        | 13/100 [00:01<00:09,  8.74it/s] 14%|█▍        | 14/100 [00:01<00:09,  8.77it/s] 15%|█▌        | 15/100 [00:01<00:09,  8.91it/s] 16%|█▌        | 16/100 [00:01<00:09,  8.63it/s] 17%|█▋        | 17/100 [00:01<00:09,  8.66it/s] 18%|█▊        | 18/100 [00:02<00:09,  8.56it/s] 19%|█▉        | 19/100 [00:02<00:09,  8.56it/s] 20%|██        | 20/100 [00:02<00:09,  8.24it/s] 21%|██        | 21/100 [00:02<00:09,  8.28it/s] 22%|██▏       | 22/100 [00:02<00:09,  8.32it/s] 23%|██▎       | 23/100 [00:02<00:09,  8.41it/s] 24%|██▍       | 24/100 [00:02<00:08,  8.57it/s] 25%|██▌       | 25/100 [00:02<00:08,  8.76it/s] 26%|██▌       | 26/100 [00:03<00:08,  8.82it/s] 27%|██▋       | 27/100 [00:03<00:08,  8.91it/s] 28%|██▊       | 28/100 [00:03<00:07,  9.00it/s] 29%|██▉       | 29/100 [00:03<00:08,  8.62it/s] 30%|███       | 30/100 [00:03<00:07,  8.79it/s] 31%|███       | 31/100 [00:03<00:07,  8.63it/s] 32%|███▏      | 32/100 [00:03<00:08,  8.41it/s] 33%|███▎      | 33/100 [00:03<00:08,  8.34it/s] 34%|███▍      | 34/100 [00:03<00:07,  8.55it/s] 35%|███▌      | 35/100 [00:04<00:07,  8.65it/s] 36%|███▌      | 36/100 [00:04<00:07,  8.64it/s] 37%|███▋      | 37/100 [00:04<00:07,  8.61it/s] 38%|███▊      | 38/100 [00:04<00:07,  8.54it/s] 39%|███▉      | 39/100 [00:04<00:07,  8.58it/s] 40%|████      | 40/100 [00:04<00:07,  8.55it/s] 41%|████      | 41/100 [00:04<00:06,  8.59it/s] 42%|████▏     | 42/100 [00:04<00:06,  8.52it/s] 43%|████▎     | 43/100 [00:05<00:06,  8.56it/s] 44%|████▍     | 44/100 [00:05<00:06,  8.32it/s] 45%|████▌     | 45/100 [00:05<00:06,  8.23it/s] 46%|████▌     | 46/100 [00:05<00:06,  8.21it/s] 47%|████▋     | 47/100 [00:05<00:06,  8.01it/s] 48%|████▊     | 48/100 [00:05<00:06,  7.98it/s] 49%|████▉     | 49/100 [00:05<00:06,  7.92it/s] 50%|█████     | 50/100 [00:05<00:06,  7.96it/s] 51%|█████     | 51/100 [00:06<00:06,  7.99it/s] 52%|█████▏    | 52/100 [00:06<00:05,  8.02it/s] 53%|█████▎    | 53/100 [00:06<00:05,  8.15it/s] 54%|█████▍    | 54/100 [00:06<00:05,  8.11it/s] 55%|█████▌    | 55/100 [00:06<00:05,  8.13it/s] 56%|█████▌    | 56/100 [00:06<00:05,  8.30it/s] 57%|█████▋    | 57/100 [00:06<00:05,  8.13it/s] 58%|█████▊    | 58/100 [00:06<00:05,  8.26it/s] 59%|█████▉    | 59/100 [00:07<00:05,  7.55it/s] 60%|██████    | 60/100 [00:07<00:05,  7.66it/s] 61%|██████    | 61/100 [00:07<00:04,  8.09it/s] 62%|██████▏   | 62/100 [00:07<00:04,  8.33it/s] 63%|██████▎   | 63/100 [00:07<00:04,  8.12it/s] 64%|██████▍   | 64/100 [00:07<00:04,  8.07it/s] 65%|██████▌   | 65/100 [00:07<00:04,  7.88it/s] 66%|██████▌   | 66/100 [00:07<00:04,  7.91it/s] 67%|██████▋   | 67/100 [00:08<00:04,  7.75it/s] 68%|██████▊   | 68/100 [00:08<00:04,  7.78it/s] 69%|██████▉   | 69/100 [00:08<00:04,  7.74it/s] 70%|███████   | 70/100 [00:08<00:03,  7.64it/s] 71%|███████   | 71/100 [00:08<00:03,  7.92it/s] 72%|███████▏  | 72/100 [00:08<00:03,  7.91it/s] 73%|███████▎  | 73/100 [00:08<00:03,  7.86it/s] 74%|███████▍  | 74/100 [00:08<00:03,  8.08it/s] 75%|███████▌  | 75/100 [00:09<00:03,  8.23it/s] 76%|███████▌  | 76/100 [00:09<00:02,  8.06it/s] 77%|███████▋  | 77/100 [00:09<00:02,  7.85it/s] 78%|███████▊  | 78/100 [00:09<00:02,  7.85it/s] 79%|███████▉  | 79/100 [00:09<00:02,  7.72it/s] 80%|████████  | 80/100 [00:09<00:02,  7.69it/s] 81%|████████  | 81/100 [00:09<00:02,  7.77it/s] 82%|████████▏ | 82/100 [00:09<00:02,  6.89it/s] 83%|████████▎ | 83/100 [00:10<00:02,  6.49it/s] 84%|████████▍ | 84/100 [00:10<00:02,  6.99it/s] 85%|████████▌ | 85/100 [00:10<00:02,  7.47it/s] 86%|████████▌ | 86/100 [00:10<00:01,  7.64it/s] 87%|████████▋ | 87/100 [00:10<00:01,  7.70it/s] 88%|████████▊ | 88/100 [00:10<00:01,  7.80it/s] 89%|████████▉ | 89/100 [00:10<00:01,  7.83it/s] 90%|█████████ | 90/100 [00:11<00:01,  8.20it/s] 91%|█████████ | 91/100 [00:11<00:01,  7.94it/s] 92%|█████████▏| 92/100 [00:11<00:01,  7.96it/s] 93%|█████████▎| 93/100 [00:11<00:00,  8.09it/s] 94%|█████████▍| 94/100 [00:11<00:00,  8.07it/s] 95%|█████████▌| 95/100 [00:11<00:00,  7.69it/s] 96%|█████████▌| 96/100 [00:11<00:00,  7.90it/s] 97%|█████████▋| 97/100 [00:11<00:00,  7.93it/s] 98%|█████████▊| 98/100 [00:12<00:00,  7.66it/s] 99%|█████████▉| 99/100 [00:12<00:00,  7.77it/s]100%|██████████| 100/100 [00:12<00:00,  7.30it/s]100%|██████████| 100/100 [00:12<00:00,  8.12it/s]
eval_p_index len:  16
individual_train 116
individual_eval 16
train data의 x, y, id 길이: 116 116 116
valid data의 x, y, id 길이: 9 9 9
test data의 x, y, id 길이: 7 7 7
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.620202, Valid_loss 0.701137
Epoch 2, Train Loss 0.584654, Valid_loss 0.703599
Epoch 3, Train Loss 0.575920, Valid_loss 0.706589
Epoch 4, Train Loss 0.560044, Valid_loss 0.706928
Epoch 5, Train Loss 0.542477, Valid_loss 0.703550
Epoch 6, Train Loss 0.542627, Valid_loss 0.689904
Epoch 7, Train Loss 0.532577, Valid_loss 0.680254
Epoch 8, Train Loss 0.515813, Valid_loss 0.671405
Epoch 9, Train Loss 0.495500, Valid_loss 0.660677
Epoch 10, Train Loss 0.523149, Valid_loss 0.654259
Epoch 11, Train Loss 0.505137, Valid_loss 0.648058
Epoch 12, Train Loss 0.493274, Valid_loss 0.643139
Epoch 13, Train Loss 0.480459, Valid_loss 0.634201
Epoch 14, Train Loss 0.465835, Valid_loss 0.637973
Epoch 15, Train Loss 0.444396, Valid_loss 0.645683
Epoch 16, Train Loss 0.447811, Valid_loss 0.645178
Epoch 17, Train Loss 0.444686, Valid_loss 0.640188
Epoch 18, Train Loss 0.429570, Valid_loss 0.648420
Epoch 19, Train Loss 0.445887, Valid_loss 0.640256
Epoch 20, Train Loss 0.442167, Valid_loss 0.639109
Epoch 21, Train Loss 0.423394, Valid_loss 0.641546
Epoch 22, Train Loss 0.436687, Valid_loss 0.643916
Epoch 23, Train Loss 0.450478, Valid_loss 0.641568
Epoch 24, Train Loss 0.426429, Valid_loss 0.641271
Epoch 25, Train Loss 0.442792, Valid_loss 0.645118
Epoch 26, Train Loss 0.424372, Valid_loss 0.645718
Epoch 27, Train Loss 0.432621, Valid_loss 0.645567
Epoch 28, Train Loss 0.431620, Valid_loss 0.653063
Epoch 29, Train Loss 0.419647, Valid_loss 0.646968
Epoch 30, Train Loss 0.425645, Valid_loss 0.651203
Epoch 31, Train Loss 0.413950, Valid_loss 0.645378
Epoch 32, Train Loss 0.415427, Valid_loss 0.651844
Epoch 33, Train Loss 0.406530, Valid_loss 0.654773
Epoch 34, Train Loss 0.441994, Valid_loss 0.654161
Epoch 35, Train Loss 0.414646, Valid_loss 0.644516
Epoch 36, Train Loss 0.413681, Valid_loss 0.655568
Epoch 37, Train Loss 0.420578, Valid_loss 0.661522
Epoch 38, Train Loss 0.409541, Valid_loss 0.643909
Epoch 39, Train Loss 0.417146, Valid_loss 0.667061
Epoch 40, Train Loss 0.419656, Valid_loss 0.657651
Epoch 41, Train Loss 0.429000, Valid_loss 0.657167
Epoch 42, Train Loss 0.397387, Valid_loss 0.657466
Epoch 43, Train Loss 0.437236, Valid_loss 0.658465
Epoch 44, Train Loss 0.411820, Valid_loss 0.654744
Epoch 45, Train Loss 0.406051, Valid_loss 0.652110
Epoch 46, Train Loss 0.420357, Valid_loss 0.667500
Epoch 47, Train Loss 0.394450, Valid_loss 0.658171
Epoch 48, Train Loss 0.416424, Valid_loss 0.667698
Epoch 49, Train Loss 0.390827, Valid_loss 0.667433
Epoch 50, Train Loss 0.410276, Valid_loss 0.668887
Epoch 51, Train Loss 0.407422, Valid_loss 0.659768
Epoch 52, Train Loss 0.407219, Valid_loss 0.664323
Epoch 53, Train Loss 0.398849, Valid_loss 0.668259
Control_Participant1 -- true: normal -- pred: COVID-19
Control_Participant5 -- true: normal -- pred: COVID-19
COVID19_Participant8 -- true: COVID-19 -- pred: COVID-19
COVID19_Participant31 -- true: COVID-19 -- pred: COVID-19
Control_Participant10 -- true: normal -- pred: COVID-19
Control_Participant4 -- true: normal -- pred: COVID-19
COVID19_Participant13 -- true: COVID-19 -- pred: COVID-19
true :  [0, 0, 1, 1, 0, 0, 1]
pred :  [1, 1, 1, 1, 1, 1, 1]
Confusion Matrix: [0 4 0 3]
Best performance: Epoch 13, Loss 0.480459, Test ACC 0.428571, Test AUC 0.750000, Test Recall 1.000000, Test Precision 0.428571
✅ Total valid splits used: 2
🔁 Repeat 1, Fold 2
🔍 Split #3
  → train_p_index 환자 수: 28
  → test_p_index 환자 수: 4
  → train 환자 ID: ['COVID19_Participant11', 'COVID19_Participant13', 'COVID19_Participant15', 'COVID19_Participant17', 'COVID19_Participant19', 'COVID19_Participant2', 'COVID19_Participant22', 'COVID19_Participant23', 'COVID19_Participant25', 'COVID19_Participant26', 'COVID19_Participant28', 'COVID19_Participant29', 'COVID19_Participant31', 'COVID19_Participant32', 'COVID19_Participant37', 'COVID19_Participant39', 'COVID19_Participant4', 'COVID19_Participant7', 'COVID19_Participant8', 'Control_Participant1', 'Control_Participant10', 'Control_Participant11', 'Control_Participant15', 'Control_Participant3', 'Control_Participant5', 'Control_Participant7', 'Control_Participant8', 'Control_Participant9']
  → test  환자 ID: ['Control_Participant7', 'COVID19_Participant31', 'COVID19_Participant13', 'Control_Participant7']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant10, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant8, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: Control_Participant7, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: Control_Participant7, Label: 0
train_p_index_ 18
valid_p_index 10
test_p_index 4
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Keratinocytes', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Neurons', 'iPS_cells', 'Embryonic_stem_cells', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
data augment 실행 함
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:12,  8.02it/s]  2%|▏         | 2/100 [00:00<00:11,  8.68it/s]  3%|▎         | 3/100 [00:00<00:10,  8.85it/s]  4%|▍         | 4/100 [00:00<00:10,  8.81it/s]  5%|▌         | 5/100 [00:00<00:10,  8.90it/s]  6%|▌         | 6/100 [00:00<00:10,  8.93it/s]  7%|▋         | 7/100 [00:00<00:10,  8.79it/s]  8%|▊         | 8/100 [00:00<00:10,  8.60it/s]  9%|▉         | 9/100 [00:01<00:10,  8.34it/s] 10%|█         | 10/100 [00:01<00:10,  8.45it/s] 11%|█         | 11/100 [00:01<00:10,  8.66it/s] 12%|█▏        | 12/100 [00:01<00:10,  8.46it/s] 13%|█▎        | 13/100 [00:01<00:10,  8.52it/s] 14%|█▍        | 14/100 [00:01<00:09,  8.72it/s] 15%|█▌        | 15/100 [00:01<00:09,  8.82it/s] 16%|█▌        | 16/100 [00:01<00:09,  8.87it/s] 17%|█▋        | 17/100 [00:01<00:09,  8.73it/s] 18%|█▊        | 18/100 [00:02<00:09,  8.66it/s] 19%|█▉        | 19/100 [00:02<00:09,  8.80it/s] 20%|██        | 20/100 [00:02<00:09,  8.84it/s] 21%|██        | 21/100 [00:02<00:09,  8.59it/s] 22%|██▏       | 22/100 [00:02<00:08,  8.75it/s] 23%|██▎       | 23/100 [00:02<00:09,  8.40it/s] 24%|██▍       | 24/100 [00:02<00:09,  8.41it/s] 25%|██▌       | 25/100 [00:02<00:08,  8.38it/s] 26%|██▌       | 26/100 [00:03<00:08,  8.31it/s] 27%|██▋       | 27/100 [00:03<00:08,  8.48it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.62it/s] 29%|██▉       | 29/100 [00:03<00:08,  8.60it/s] 30%|███       | 30/100 [00:03<00:08,  8.64it/s] 31%|███       | 31/100 [00:03<00:07,  8.70it/s] 32%|███▏      | 32/100 [00:03<00:07,  8.79it/s] 33%|███▎      | 33/100 [00:03<00:07,  8.64it/s] 34%|███▍      | 34/100 [00:03<00:07,  8.27it/s] 35%|███▌      | 35/100 [00:04<00:07,  8.36it/s] 36%|███▌      | 36/100 [00:04<00:07,  8.38it/s] 37%|███▋      | 37/100 [00:04<00:07,  8.13it/s] 38%|███▊      | 38/100 [00:04<00:09,  6.44it/s] 39%|███▉      | 39/100 [00:04<00:09,  6.63it/s] 40%|████      | 40/100 [00:04<00:08,  7.22it/s] 41%|████      | 41/100 [00:04<00:07,  7.44it/s] 42%|████▏     | 42/100 [00:05<00:07,  7.59it/s] 43%|████▎     | 43/100 [00:05<00:07,  7.31it/s] 44%|████▍     | 44/100 [00:05<00:07,  7.73it/s] 45%|████▌     | 45/100 [00:05<00:07,  7.81it/s] 46%|████▌     | 46/100 [00:05<00:06,  7.95it/s] 47%|████▋     | 47/100 [00:05<00:06,  8.18it/s] 48%|████▊     | 48/100 [00:05<00:06,  8.19it/s] 49%|████▉     | 49/100 [00:05<00:06,  8.23it/s] 50%|█████     | 50/100 [00:06<00:05,  8.40it/s] 51%|█████     | 51/100 [00:06<00:05,  8.34it/s] 52%|█████▏    | 52/100 [00:06<00:05,  8.42it/s] 53%|█████▎    | 53/100 [00:06<00:05,  8.53it/s] 54%|█████▍    | 54/100 [00:06<00:05,  8.40it/s] 55%|█████▌    | 55/100 [00:06<00:05,  8.55it/s] 56%|█████▌    | 56/100 [00:06<00:05,  8.63it/s] 57%|█████▋    | 57/100 [00:06<00:05,  8.32it/s] 58%|█████▊    | 58/100 [00:06<00:05,  8.15it/s] 59%|█████▉    | 59/100 [00:07<00:04,  8.26it/s] 60%|██████    | 60/100 [00:07<00:04,  8.21it/s] 61%|██████    | 61/100 [00:07<00:04,  8.32it/s] 62%|██████▏   | 62/100 [00:07<00:04,  8.38it/s] 63%|██████▎   | 63/100 [00:07<00:04,  8.52it/s] 64%|██████▍   | 64/100 [00:07<00:04,  8.42it/s] 65%|██████▌   | 65/100 [00:07<00:04,  8.36it/s] 66%|██████▌   | 66/100 [00:07<00:04,  8.38it/s] 67%|██████▋   | 67/100 [00:08<00:04,  8.09it/s] 68%|██████▊   | 68/100 [00:08<00:03,  8.24it/s] 69%|██████▉   | 69/100 [00:08<00:03,  8.27it/s] 70%|███████   | 70/100 [00:08<00:03,  8.22it/s] 71%|███████   | 71/100 [00:08<00:03,  8.14it/s] 72%|███████▏  | 72/100 [00:08<00:03,  8.19it/s] 73%|███████▎  | 73/100 [00:08<00:03,  6.89it/s] 74%|███████▍  | 74/100 [00:09<00:03,  7.17it/s] 75%|███████▌  | 75/100 [00:09<00:03,  7.46it/s] 76%|███████▌  | 76/100 [00:09<00:03,  6.70it/s] 77%|███████▋  | 77/100 [00:09<00:03,  6.81it/s] 78%|███████▊  | 78/100 [00:09<00:03,  6.48it/s] 79%|███████▉  | 79/100 [00:09<00:03,  6.79it/s] 80%|████████  | 80/100 [00:09<00:02,  7.14it/s] 81%|████████  | 81/100 [00:09<00:02,  7.47it/s] 82%|████████▏ | 82/100 [00:10<00:02,  6.25it/s] 83%|████████▎ | 83/100 [00:10<00:02,  6.66it/s] 84%|████████▍ | 84/100 [00:10<00:02,  7.07it/s] 85%|████████▌ | 85/100 [00:10<00:01,  7.66it/s] 86%|████████▌ | 86/100 [00:10<00:01,  8.01it/s] 87%|████████▋ | 87/100 [00:10<00:01,  8.10it/s] 88%|████████▊ | 88/100 [00:10<00:01,  7.90it/s] 89%|████████▉ | 89/100 [00:11<00:01,  8.04it/s] 90%|█████████ | 90/100 [00:11<00:01,  6.09it/s] 91%|█████████ | 91/100 [00:11<00:01,  6.51it/s] 92%|█████████▏| 92/100 [00:11<00:01,  6.82it/s] 93%|█████████▎| 93/100 [00:11<00:01,  5.92it/s] 94%|█████████▍| 94/100 [00:11<00:00,  6.42it/s] 95%|█████████▌| 95/100 [00:12<00:00,  6.75it/s] 96%|█████████▌| 96/100 [00:12<00:00,  7.08it/s] 97%|█████████▋| 97/100 [00:12<00:00,  7.00it/s] 98%|█████████▊| 98/100 [00:12<00:00,  7.34it/s] 99%|█████████▉| 99/100 [00:12<00:00,  7.42it/s]100%|██████████| 100/100 [00:12<00:00,  7.45it/s]100%|██████████| 100/100 [00:12<00:00,  7.87it/s]
eval_p_index len:  14
individual_train 118
individual_eval 14
train data의 x, y, id 길이: 118 118 118
valid data의 x, y, id 길이: 10 10 10
test data의 x, y, id 길이: 4 4 4
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.647967, Valid_loss 0.695015
Epoch 2, Train Loss 0.632390, Valid_loss 0.696248
Epoch 3, Train Loss 0.620456, Valid_loss 0.694292
Epoch 4, Train Loss 0.614216, Valid_loss 0.692836
Epoch 5, Train Loss 0.585574, Valid_loss 0.700207
Epoch 6, Train Loss 0.572127, Valid_loss 0.701334
Epoch 7, Train Loss 0.569380, Valid_loss 0.702527
Epoch 8, Train Loss 0.547614, Valid_loss 0.713674
Epoch 9, Train Loss 0.544087, Valid_loss 0.712378
Epoch 10, Train Loss 0.540042, Valid_loss 0.706768
Epoch 11, Train Loss 0.529837, Valid_loss 0.700445
Epoch 12, Train Loss 0.531599, Valid_loss 0.708125
Epoch 13, Train Loss 0.519819, Valid_loss 0.708423
Epoch 14, Train Loss 0.524480, Valid_loss 0.704303
Epoch 15, Train Loss 0.502751, Valid_loss 0.695560
Epoch 16, Train Loss 0.515123, Valid_loss 0.699758
Epoch 17, Train Loss 0.491167, Valid_loss 0.696808
Epoch 18, Train Loss 0.491825, Valid_loss 0.693018
Epoch 19, Train Loss 0.488626, Valid_loss 0.692130
Epoch 20, Train Loss 0.494209, Valid_loss 0.686571
Epoch 21, Train Loss 0.477861, Valid_loss 0.686991
Epoch 22, Train Loss 0.481348, Valid_loss 0.681525
Epoch 23, Train Loss 0.488381, Valid_loss 0.682227
Epoch 24, Train Loss 0.479699, Valid_loss 0.670672
Epoch 25, Train Loss 0.479446, Valid_loss 0.666746
Epoch 26, Train Loss 0.466398, Valid_loss 0.665713
Epoch 27, Train Loss 0.472092, Valid_loss 0.661824
Epoch 28, Train Loss 0.455678, Valid_loss 0.650762
Epoch 29, Train Loss 0.456460, Valid_loss 0.644438
Epoch 30, Train Loss 0.467085, Valid_loss 0.637809
Epoch 31, Train Loss 0.463767, Valid_loss 0.629582
Epoch 32, Train Loss 0.457298, Valid_loss 0.618943
Epoch 33, Train Loss 0.451124, Valid_loss 0.610891
Epoch 34, Train Loss 0.459376, Valid_loss 0.608252
Epoch 35, Train Loss 0.444389, Valid_loss 0.602540
Epoch 36, Train Loss 0.431851, Valid_loss 0.603768
Epoch 37, Train Loss 0.455534, Valid_loss 0.604804
Epoch 38, Train Loss 0.449457, Valid_loss 0.603303
Epoch 39, Train Loss 0.434341, Valid_loss 0.597558
Epoch 40, Train Loss 0.426386, Valid_loss 0.601461
Epoch 41, Train Loss 0.428637, Valid_loss 0.602515
Epoch 42, Train Loss 0.445170, Valid_loss 0.600636
Epoch 43, Train Loss 0.423174, Valid_loss 0.600650
Epoch 44, Train Loss 0.433830, Valid_loss 0.597948
Epoch 45, Train Loss 0.428639, Valid_loss 0.599942
Epoch 46, Train Loss 0.416233, Valid_loss 0.600063
Epoch 47, Train Loss 0.414834, Valid_loss 0.602286
Epoch 48, Train Loss 0.422932, Valid_loss 0.600923
Epoch 49, Train Loss 0.422839, Valid_loss 0.597728
Epoch 50, Train Loss 0.411982, Valid_loss 0.599340
Epoch 51, Train Loss 0.420734, Valid_loss 0.599012
Epoch 52, Train Loss 0.405013, Valid_loss 0.601646
Epoch 53, Train Loss 0.409446, Valid_loss 0.599354
Epoch 54, Train Loss 0.415852, Valid_loss 0.601975
Epoch 55, Train Loss 0.410153, Valid_loss 0.603459
Control_Participant7 -- true: normal -- pred: COVID-19
COVID19_Participant31 -- true: COVID-19 -- pred: COVID-19
COVID19_Participant13 -- true: COVID-19 -- pred: COVID-19
Control_Participant7 -- true: normal -- pred: COVID-19
true :  [0, 1, 1, 0]
pred :  [1, 1, 1, 1]
Confusion Matrix: [0 2 0 2]
Best performance: Epoch 39, Loss 0.434341, Test ACC 0.500000, Test AUC 1.000000, Test Recall 1.000000, Test Precision 0.500000
✅ Total valid splits used: 3
🔁 Repeat 1, Fold 3
🔍 Split #4
  → train_p_index 환자 수: 24
  → test_p_index 환자 수: 8
  → train 환자 ID: ['COVID19_Participant11', 'COVID19_Participant14', 'COVID19_Participant15', 'COVID19_Participant17', 'COVID19_Participant19', 'COVID19_Participant2', 'COVID19_Participant20', 'COVID19_Participant22', 'COVID19_Participant23', 'COVID19_Participant25', 'COVID19_Participant26', 'COVID19_Participant29', 'COVID19_Participant32', 'COVID19_Participant37', 'COVID19_Participant40', 'COVID19_Participant7', 'COVID19_Participant8', 'Control_Participant10', 'Control_Participant11', 'Control_Participant3', 'Control_Participant4', 'Control_Participant5', 'Control_Participant7', 'Control_Participant9']
  → test  환자 ID: ['Control_Participant7', 'COVID19_Participant26', 'Control_Participant7', 'COVID19_Participant7', 'Control_Participant5', 'COVID19_Participant26', 'Control_Participant3', 'Control_Participant5']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: Control_Participant10, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant4, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: Control_Participant7, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: Control_Participant7, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: Control_Participant5, Label: 1
    ID: COVID19_Participant26, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant5, Label: 0
train_p_index_ 16
valid_p_index 8
test_p_index 8
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Keratinocytes', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Neurons', 'iPS_cells', 'Embryonic_stem_cells', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
data augment 실행 함
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:10,  9.40it/s]  2%|▏         | 2/100 [00:00<00:10,  9.21it/s]  3%|▎         | 3/100 [00:00<00:10,  9.43it/s]  4%|▍         | 4/100 [00:00<00:10,  9.54it/s]  5%|▌         | 5/100 [00:00<00:10,  9.36it/s]  6%|▌         | 6/100 [00:00<00:10,  9.33it/s]  7%|▋         | 7/100 [00:00<00:10,  9.19it/s]  9%|▉         | 9/100 [00:00<00:09,  9.71it/s] 10%|█         | 10/100 [00:01<00:09,  9.68it/s] 11%|█         | 11/100 [00:01<00:09,  9.48it/s] 12%|█▏        | 12/100 [00:01<00:09,  9.48it/s] 13%|█▎        | 13/100 [00:01<00:09,  9.49it/s] 14%|█▍        | 14/100 [00:01<00:10,  8.15it/s] 15%|█▌        | 15/100 [00:01<00:10,  8.42it/s] 16%|█▌        | 16/100 [00:01<00:09,  8.64it/s] 17%|█▋        | 17/100 [00:01<00:09,  8.84it/s] 18%|█▊        | 18/100 [00:01<00:09,  8.74it/s] 19%|█▉        | 19/100 [00:02<00:08,  9.03it/s] 20%|██        | 20/100 [00:02<00:08,  9.01it/s] 21%|██        | 21/100 [00:02<00:08,  8.83it/s] 22%|██▏       | 22/100 [00:02<00:08,  9.04it/s] 23%|██▎       | 23/100 [00:02<00:08,  8.74it/s] 24%|██▍       | 24/100 [00:02<00:08,  8.75it/s] 25%|██▌       | 25/100 [00:02<00:08,  9.09it/s] 26%|██▌       | 26/100 [00:02<00:08,  9.09it/s] 27%|██▋       | 27/100 [00:02<00:08,  8.98it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.95it/s] 29%|██▉       | 29/100 [00:03<00:07,  8.88it/s] 30%|███       | 30/100 [00:03<00:07,  8.91it/s] 31%|███       | 31/100 [00:03<00:07,  8.82it/s] 32%|███▏      | 32/100 [00:03<00:07,  8.77it/s] 33%|███▎      | 33/100 [00:03<00:07,  8.72it/s] 34%|███▍      | 34/100 [00:03<00:07,  8.82it/s] 35%|███▌      | 35/100 [00:03<00:07,  8.85it/s] 36%|███▌      | 36/100 [00:03<00:07,  9.00it/s] 37%|███▋      | 37/100 [00:04<00:07,  8.95it/s] 38%|███▊      | 38/100 [00:04<00:06,  9.12it/s] 39%|███▉      | 39/100 [00:04<00:06,  9.13it/s] 40%|████      | 40/100 [00:04<00:06,  9.13it/s] 41%|████      | 41/100 [00:04<00:06,  9.11it/s] 42%|████▏     | 42/100 [00:04<00:06,  9.23it/s] 43%|████▎     | 43/100 [00:04<00:06,  9.30it/s] 44%|████▍     | 44/100 [00:04<00:06,  8.74it/s] 45%|████▌     | 45/100 [00:04<00:06,  8.91it/s] 46%|████▌     | 46/100 [00:05<00:05,  9.10it/s] 47%|████▋     | 47/100 [00:05<00:05,  9.07it/s] 49%|████▉     | 49/100 [00:05<00:05,  9.16it/s] 50%|█████     | 50/100 [00:05<00:05,  9.15it/s] 51%|█████     | 51/100 [00:05<00:05,  9.12it/s] 52%|█████▏    | 52/100 [00:05<00:05,  8.97it/s] 53%|█████▎    | 53/100 [00:05<00:05,  9.03it/s] 54%|█████▍    | 54/100 [00:05<00:05,  9.03it/s] 55%|█████▌    | 55/100 [00:06<00:05,  8.89it/s] 56%|█████▌    | 56/100 [00:06<00:04,  8.81it/s] 57%|█████▋    | 57/100 [00:06<00:04,  8.94it/s] 58%|█████▊    | 58/100 [00:06<00:04,  8.71it/s] 59%|█████▉    | 59/100 [00:06<00:04,  8.92it/s] 60%|██████    | 60/100 [00:06<00:04,  8.70it/s] 61%|██████    | 61/100 [00:06<00:04,  8.83it/s] 62%|██████▏   | 62/100 [00:06<00:04,  9.13it/s] 63%|██████▎   | 63/100 [00:07<00:04,  8.31it/s] 64%|██████▍   | 64/100 [00:07<00:04,  8.34it/s] 65%|██████▌   | 65/100 [00:07<00:04,  8.29it/s] 66%|██████▌   | 66/100 [00:07<00:04,  8.38it/s] 67%|██████▋   | 67/100 [00:07<00:03,  8.72it/s] 68%|██████▊   | 68/100 [00:07<00:03,  8.59it/s] 69%|██████▉   | 69/100 [00:07<00:03,  8.66it/s] 70%|███████   | 70/100 [00:07<00:03,  8.59it/s] 71%|███████   | 71/100 [00:07<00:03,  8.63it/s] 72%|███████▏  | 72/100 [00:08<00:03,  8.50it/s] 73%|███████▎  | 73/100 [00:08<00:03,  8.61it/s] 74%|███████▍  | 74/100 [00:08<00:02,  8.74it/s] 75%|███████▌  | 75/100 [00:08<00:02,  8.85it/s] 76%|███████▌  | 76/100 [00:08<00:02,  8.50it/s] 77%|███████▋  | 77/100 [00:08<00:02,  8.66it/s] 78%|███████▊  | 78/100 [00:08<00:02,  8.50it/s] 79%|███████▉  | 79/100 [00:08<00:02,  8.39it/s] 80%|████████  | 80/100 [00:09<00:02,  8.46it/s] 81%|████████  | 81/100 [00:09<00:02,  8.46it/s] 82%|████████▏ | 82/100 [00:09<00:02,  8.17it/s] 83%|████████▎ | 83/100 [00:09<00:02,  8.45it/s] 84%|████████▍ | 84/100 [00:09<00:01,  8.68it/s] 85%|████████▌ | 85/100 [00:09<00:01,  8.64it/s] 86%|████████▌ | 86/100 [00:09<00:01,  8.64it/s] 87%|████████▋ | 87/100 [00:09<00:01,  8.96it/s] 88%|████████▊ | 88/100 [00:09<00:01,  9.18it/s] 89%|████████▉ | 89/100 [00:10<00:01,  8.97it/s] 90%|█████████ | 90/100 [00:10<00:01,  8.89it/s] 91%|█████████ | 91/100 [00:10<00:01,  8.80it/s] 92%|█████████▏| 92/100 [00:10<00:00,  8.85it/s] 93%|█████████▎| 93/100 [00:10<00:00,  8.84it/s] 94%|█████████▍| 94/100 [00:10<00:00,  8.85it/s] 95%|█████████▌| 95/100 [00:10<00:00,  8.72it/s] 96%|█████████▌| 96/100 [00:10<00:00,  8.62it/s] 97%|█████████▋| 97/100 [00:10<00:00,  8.62it/s] 98%|█████████▊| 98/100 [00:11<00:00,  8.55it/s] 99%|█████████▉| 99/100 [00:11<00:00,  8.37it/s]100%|██████████| 100/100 [00:11<00:00,  8.29it/s]100%|██████████| 100/100 [00:11<00:00,  8.83it/s]
eval_p_index len:  16
individual_train 116
individual_eval 16
train data의 x, y, id 길이: 116 116 116
valid data의 x, y, id 길이: 8 8 8
test data의 x, y, id 길이: 8 8 8
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.695960, Valid_loss 0.661862
Epoch 2, Train Loss 0.652514, Valid_loss 0.661190
Epoch 3, Train Loss 0.646913, Valid_loss 0.650532
Epoch 4, Train Loss 0.615192, Valid_loss 0.649612
Epoch 5, Train Loss 0.611073, Valid_loss 0.653152
Epoch 6, Train Loss 0.611943, Valid_loss 0.654081
Epoch 7, Train Loss 0.585505, Valid_loss 0.647518
Epoch 8, Train Loss 0.579207, Valid_loss 0.637897
Epoch 9, Train Loss 0.574414, Valid_loss 0.627296
Epoch 10, Train Loss 0.550961, Valid_loss 0.592519
Epoch 11, Train Loss 0.537195, Valid_loss 0.571996
Epoch 12, Train Loss 0.529431, Valid_loss 0.562694
Epoch 13, Train Loss 0.514057, Valid_loss 0.549331
Epoch 14, Train Loss 0.519450, Valid_loss 0.542587
Epoch 15, Train Loss 0.499404, Valid_loss 0.535732
Epoch 16, Train Loss 0.493246, Valid_loss 0.530965
Epoch 17, Train Loss 0.493496, Valid_loss 0.527791
Epoch 18, Train Loss 0.494154, Valid_loss 0.525514
Epoch 19, Train Loss 0.488285, Valid_loss 0.519952
Epoch 20, Train Loss 0.478908, Valid_loss 0.517882
Epoch 21, Train Loss 0.485394, Valid_loss 0.512834
Epoch 22, Train Loss 0.491094, Valid_loss 0.509033
Epoch 23, Train Loss 0.468964, Valid_loss 0.504321
Epoch 24, Train Loss 0.465971, Valid_loss 0.505190
Epoch 25, Train Loss 0.464416, Valid_loss 0.501738
Epoch 26, Train Loss 0.471393, Valid_loss 0.499478
Epoch 27, Train Loss 0.468039, Valid_loss 0.498517
Epoch 28, Train Loss 0.468424, Valid_loss 0.494472
Epoch 29, Train Loss 0.461859, Valid_loss 0.496524
Epoch 30, Train Loss 0.458156, Valid_loss 0.494626
Epoch 31, Train Loss 0.458616, Valid_loss 0.499939
Epoch 32, Train Loss 0.448576, Valid_loss 0.492964
Epoch 33, Train Loss 0.458328, Valid_loss 0.494683
Epoch 34, Train Loss 0.448787, Valid_loss 0.504071
Epoch 35, Train Loss 0.446453, Valid_loss 0.486975
Epoch 36, Train Loss 0.446717, Valid_loss 0.497651
Epoch 37, Train Loss 0.443859, Valid_loss 0.489710
Epoch 38, Train Loss 0.442841, Valid_loss 0.489924
Epoch 39, Train Loss 0.435024, Valid_loss 0.498161
Epoch 40, Train Loss 0.443349, Valid_loss 0.489227
Epoch 41, Train Loss 0.445075, Valid_loss 0.489413
Epoch 42, Train Loss 0.434696, Valid_loss 0.489091
Epoch 43, Train Loss 0.437748, Valid_loss 0.489935
Epoch 44, Train Loss 0.425833, Valid_loss 0.490168
Epoch 45, Train Loss 0.424528, Valid_loss 0.487657
Epoch 46, Train Loss 0.422904, Valid_loss 0.485584
Epoch 47, Train Loss 0.421471, Valid_loss 0.487301
Epoch 48, Train Loss 0.421051, Valid_loss 0.484877
Epoch 49, Train Loss 0.425753, Valid_loss 0.490014
Epoch 50, Train Loss 0.425699, Valid_loss 0.485231
Epoch 51, Train Loss 0.424448, Valid_loss 0.483204
Epoch 52, Train Loss 0.421540, Valid_loss 0.492218
Epoch 53, Train Loss 0.424590, Valid_loss 0.486657
Epoch 54, Train Loss 0.423209, Valid_loss 0.484124
Epoch 55, Train Loss 0.420196, Valid_loss 0.489914
Epoch 56, Train Loss 0.427753, Valid_loss 0.483878
Epoch 57, Train Loss 0.422963, Valid_loss 0.489308
Epoch 58, Train Loss 0.432492, Valid_loss 0.485531
Epoch 59, Train Loss 0.418949, Valid_loss 0.491968
Epoch 60, Train Loss 0.410315, Valid_loss 0.492085
Control_Participant7 -- true: normal -- pred: normal
COVID19_Participant26 -- true: COVID-19 -- pred: COVID-19
Control_Participant7 -- true: normal -- pred: COVID-19
COVID19_Participant7 -- true: COVID-19 -- pred: COVID-19
Control_Participant5 -- true: normal -- pred: normal
COVID19_Participant26 -- true: COVID-19 -- pred: COVID-19
Control_Participant3 -- true: normal -- pred: normal
Control_Participant5 -- true: normal -- pred: normal
true :  [0, 1, 0, 1, 0, 1, 0, 0]
pred :  [0, 1, 1, 1, 0, 1, 0, 0]
Confusion Matrix: [4 1 0 3]
Best performance: Epoch 51, Loss 0.424448, Test ACC 0.875000, Test AUC 0.933333, Test Recall 1.000000, Test Precision 0.750000
✅ Total valid splits used: 4
🔁 Repeat 1, Fold 4
🔍 Split #5
  → train_p_index 환자 수: 27
  → test_p_index 환자 수: 5
  → train 환자 ID: ['COVID19_Participant11', 'COVID19_Participant13', 'COVID19_Participant14', 'COVID19_Participant17', 'COVID19_Participant19', 'COVID19_Participant2', 'COVID19_Participant20', 'COVID19_Participant22', 'COVID19_Participant23', 'COVID19_Participant25', 'COVID19_Participant26', 'COVID19_Participant28', 'COVID19_Participant29', 'COVID19_Participant31', 'COVID19_Participant37', 'COVID19_Participant39', 'COVID19_Participant4', 'COVID19_Participant40', 'COVID19_Participant7', 'Control_Participant1', 'Control_Participant15', 'Control_Participant3', 'Control_Participant4', 'Control_Participant5', 'Control_Participant7', 'Control_Participant8', 'Control_Participant9']
  → test  환자 ID: ['COVID19_Participant11', 'COVID19_Participant25', 'Control_Participant7', 'Control_Participant7', 'COVID19_Participant26']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant4, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant8, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: Control_Participant7, Label: 1
    ID: Control_Participant7, Label: 0
    ID: COVID19_Participant26, Label: 0
train_p_index_ 18
valid_p_index 9
test_p_index 5
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Keratinocytes', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Neurons', 'iPS_cells', 'Embryonic_stem_cells', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
data augment 실행 함
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:11,  8.61it/s]  3%|▎         | 3/100 [00:00<00:11,  8.71it/s]  4%|▍         | 4/100 [00:00<00:11,  8.52it/s]  5%|▌         | 5/100 [00:00<00:11,  8.03it/s]  6%|▌         | 6/100 [00:00<00:11,  8.39it/s]  7%|▋         | 7/100 [00:00<00:10,  8.74it/s]  8%|▊         | 8/100 [00:00<00:10,  8.68it/s]  9%|▉         | 9/100 [00:01<00:10,  8.71it/s] 10%|█         | 10/100 [00:01<00:10,  8.64it/s] 11%|█         | 11/100 [00:01<00:10,  8.78it/s] 12%|█▏        | 12/100 [00:01<00:09,  9.04it/s] 13%|█▎        | 13/100 [00:01<00:09,  8.90it/s] 14%|█▍        | 14/100 [00:01<00:09,  8.86it/s] 15%|█▌        | 15/100 [00:01<00:09,  9.00it/s] 16%|█▌        | 16/100 [00:01<00:09,  8.85it/s] 17%|█▋        | 17/100 [00:01<00:09,  9.09it/s] 18%|█▊        | 18/100 [00:02<00:09,  9.11it/s] 19%|█▉        | 19/100 [00:02<00:08,  9.24it/s] 20%|██        | 20/100 [00:02<00:08,  9.38it/s] 21%|██        | 21/100 [00:02<00:08,  9.29it/s] 22%|██▏       | 22/100 [00:02<00:08,  9.04it/s] 23%|██▎       | 23/100 [00:02<00:08,  8.82it/s] 24%|██▍       | 24/100 [00:02<00:08,  8.49it/s] 25%|██▌       | 25/100 [00:02<00:08,  8.56it/s] 26%|██▌       | 26/100 [00:02<00:08,  8.52it/s] 27%|██▋       | 27/100 [00:03<00:09,  7.98it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.20it/s] 29%|██▉       | 29/100 [00:03<00:08,  8.57it/s] 30%|███       | 30/100 [00:03<00:08,  8.34it/s] 31%|███       | 31/100 [00:03<00:08,  8.47it/s] 32%|███▏      | 32/100 [00:03<00:07,  8.56it/s] 33%|███▎      | 33/100 [00:03<00:07,  8.41it/s] 34%|███▍      | 34/100 [00:03<00:07,  8.83it/s] 35%|███▌      | 35/100 [00:04<00:07,  8.30it/s] 36%|███▌      | 36/100 [00:04<00:07,  8.06it/s] 37%|███▋      | 37/100 [00:04<00:07,  8.21it/s] 38%|███▊      | 38/100 [00:04<00:07,  8.45it/s] 39%|███▉      | 39/100 [00:04<00:07,  8.69it/s] 40%|████      | 40/100 [00:04<00:06,  8.71it/s] 41%|████      | 41/100 [00:04<00:06,  8.75it/s] 42%|████▏     | 42/100 [00:04<00:07,  7.83it/s] 43%|████▎     | 43/100 [00:05<00:07,  7.87it/s] 44%|████▍     | 44/100 [00:05<00:07,  7.92it/s] 45%|████▌     | 45/100 [00:05<00:06,  7.95it/s] 46%|████▌     | 46/100 [00:05<00:06,  7.83it/s] 47%|████▋     | 47/100 [00:05<00:06,  8.03it/s] 48%|████▊     | 48/100 [00:05<00:06,  8.05it/s] 49%|████▉     | 49/100 [00:05<00:06,  8.27it/s] 50%|█████     | 50/100 [00:05<00:06,  8.25it/s] 51%|█████     | 51/100 [00:06<00:06,  8.15it/s] 52%|█████▏    | 52/100 [00:06<00:05,  8.05it/s] 53%|█████▎    | 53/100 [00:06<00:05,  8.34it/s] 54%|█████▍    | 54/100 [00:06<00:05,  8.29it/s] 55%|█████▌    | 55/100 [00:06<00:05,  8.06it/s] 56%|█████▌    | 56/100 [00:06<00:05,  8.14it/s] 57%|█████▋    | 57/100 [00:06<00:05,  8.32it/s] 58%|█████▊    | 58/100 [00:06<00:05,  8.38it/s] 59%|█████▉    | 59/100 [00:06<00:04,  8.51it/s] 60%|██████    | 60/100 [00:07<00:04,  8.36it/s] 61%|██████    | 61/100 [00:07<00:04,  8.22it/s] 62%|██████▏   | 62/100 [00:07<00:04,  8.10it/s] 63%|██████▎   | 63/100 [00:07<00:04,  8.18it/s] 64%|██████▍   | 64/100 [00:07<00:04,  8.26it/s] 65%|██████▌   | 65/100 [00:07<00:04,  8.19it/s] 66%|██████▌   | 66/100 [00:07<00:04,  8.11it/s] 67%|██████▋   | 67/100 [00:07<00:04,  7.73it/s] 68%|██████▊   | 68/100 [00:08<00:04,  8.00it/s] 69%|██████▉   | 69/100 [00:08<00:03,  8.01it/s] 70%|███████   | 70/100 [00:08<00:03,  8.01it/s] 71%|███████   | 71/100 [00:08<00:03,  8.20it/s] 72%|███████▏  | 72/100 [00:08<00:03,  8.08it/s] 73%|███████▎  | 73/100 [00:08<00:03,  8.07it/s] 74%|███████▍  | 74/100 [00:08<00:03,  8.05it/s] 75%|███████▌  | 75/100 [00:08<00:03,  7.31it/s] 76%|███████▌  | 76/100 [00:09<00:03,  7.40it/s] 77%|███████▋  | 77/100 [00:09<00:02,  7.77it/s] 78%|███████▊  | 78/100 [00:09<00:02,  7.82it/s] 79%|███████▉  | 79/100 [00:09<00:02,  7.83it/s] 80%|████████  | 80/100 [00:09<00:02,  7.95it/s] 81%|████████  | 81/100 [00:09<00:02,  7.86it/s] 82%|████████▏ | 82/100 [00:09<00:02,  7.83it/s] 83%|████████▎ | 83/100 [00:09<00:02,  7.87it/s] 84%|████████▍ | 84/100 [00:10<00:02,  7.84it/s] 85%|████████▌ | 85/100 [00:10<00:01,  7.94it/s] 86%|████████▌ | 86/100 [00:10<00:01,  7.90it/s] 87%|████████▋ | 87/100 [00:10<00:01,  7.77it/s] 88%|████████▊ | 88/100 [00:10<00:01,  7.96it/s] 89%|████████▉ | 89/100 [00:10<00:01,  7.82it/s] 90%|█████████ | 90/100 [00:10<00:01,  7.64it/s] 91%|█████████ | 91/100 [00:11<00:01,  7.80it/s] 92%|█████████▏| 92/100 [00:11<00:01,  7.60it/s] 93%|█████████▎| 93/100 [00:11<00:00,  7.54it/s] 94%|█████████▍| 94/100 [00:11<00:00,  7.48it/s] 95%|█████████▌| 95/100 [00:11<00:00,  7.57it/s] 96%|█████████▌| 96/100 [00:11<00:00,  7.60it/s] 97%|█████████▋| 97/100 [00:11<00:00,  7.51it/s] 98%|█████████▊| 98/100 [00:11<00:00,  7.82it/s] 99%|█████████▉| 99/100 [00:12<00:00,  7.50it/s]100%|██████████| 100/100 [00:12<00:00,  7.45it/s]100%|██████████| 100/100 [00:12<00:00,  8.18it/s]
eval_p_index len:  14
individual_train 118
individual_eval 14
train data의 x, y, id 길이: 118 118 118
valid data의 x, y, id 길이: 9 9 9
test data의 x, y, id 길이: 5 5 5
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.729824, Valid_loss 0.698250
Epoch 2, Train Loss 0.704260, Valid_loss 0.688155
Epoch 3, Train Loss 0.688241, Valid_loss 0.688268
Epoch 4, Train Loss 0.677564, Valid_loss 0.683165
Epoch 5, Train Loss 0.669328, Valid_loss 0.678914
Epoch 6, Train Loss 0.658899, Valid_loss 0.675045
Epoch 7, Train Loss 0.647049, Valid_loss 0.671422
Epoch 8, Train Loss 0.631913, Valid_loss 0.667504
Epoch 9, Train Loss 0.616173, Valid_loss 0.662326
Epoch 10, Train Loss 0.605978, Valid_loss 0.657365
Epoch 11, Train Loss 0.598463, Valid_loss 0.648958
Epoch 12, Train Loss 0.571218, Valid_loss 0.639889
Epoch 13, Train Loss 0.567866, Valid_loss 0.631121
Epoch 14, Train Loss 0.533022, Valid_loss 0.617147
Epoch 15, Train Loss 0.536102, Valid_loss 0.586435
Epoch 16, Train Loss 0.506576, Valid_loss 0.565034
Epoch 17, Train Loss 0.504522, Valid_loss 0.562078
Epoch 18, Train Loss 0.493980, Valid_loss 0.556715
Epoch 19, Train Loss 0.495231, Valid_loss 0.555956
Epoch 20, Train Loss 0.490767, Valid_loss 0.555803
Epoch 21, Train Loss 0.486392, Valid_loss 0.555832
Epoch 22, Train Loss 0.485564, Valid_loss 0.557032
Epoch 23, Train Loss 0.478327, Valid_loss 0.554668
Epoch 24, Train Loss 0.485835, Valid_loss 0.554774
Epoch 25, Train Loss 0.476192, Valid_loss 0.554216
Epoch 26, Train Loss 0.477800, Valid_loss 0.552721
Epoch 27, Train Loss 0.470880, Valid_loss 0.551823
Epoch 28, Train Loss 0.468224, Valid_loss 0.550136
Epoch 29, Train Loss 0.478885, Valid_loss 0.548858
Epoch 30, Train Loss 0.471614, Valid_loss 0.549612
Epoch 31, Train Loss 0.473900, Valid_loss 0.550034
Epoch 32, Train Loss 0.463207, Valid_loss 0.547973
Epoch 33, Train Loss 0.463626, Valid_loss 0.548435
Epoch 34, Train Loss 0.468200, Valid_loss 0.546574
Epoch 35, Train Loss 0.468992, Valid_loss 0.547438
Epoch 36, Train Loss 0.463690, Valid_loss 0.547844
Epoch 37, Train Loss 0.467443, Valid_loss 0.546408
Epoch 38, Train Loss 0.466587, Valid_loss 0.547752
Epoch 39, Train Loss 0.459535, Valid_loss 0.546206
Epoch 40, Train Loss 0.453320, Valid_loss 0.546040
Epoch 41, Train Loss 0.463861, Valid_loss 0.545537
Epoch 42, Train Loss 0.450203, Valid_loss 0.547715
Epoch 43, Train Loss 0.454855, Valid_loss 0.545652
Epoch 44, Train Loss 0.463921, Valid_loss 0.542386
Epoch 45, Train Loss 0.452058, Valid_loss 0.546543
Epoch 46, Train Loss 0.455077, Valid_loss 0.543479
Epoch 47, Train Loss 0.450106, Valid_loss 0.549752
Epoch 48, Train Loss 0.441920, Valid_loss 0.547098
Epoch 49, Train Loss 0.443747, Valid_loss 0.548006
Epoch 50, Train Loss 0.453182, Valid_loss 0.548192
Epoch 51, Train Loss 0.444157, Valid_loss 0.547351
Epoch 52, Train Loss 0.450762, Valid_loss 0.547821
Epoch 53, Train Loss 0.441835, Valid_loss 0.547407
Epoch 54, Train Loss 0.436882, Valid_loss 0.547264
Epoch 55, Train Loss 0.441553, Valid_loss 0.546488
Epoch 56, Train Loss 0.447418, Valid_loss 0.545255
Epoch 57, Train Loss 0.445189, Valid_loss 0.544489
Epoch 58, Train Loss 0.440891, Valid_loss 0.545799
Epoch 59, Train Loss 0.449642, Valid_loss 0.543743
Epoch 60, Train Loss 0.431906, Valid_loss 0.545146
Epoch 61, Train Loss 0.433574, Valid_loss 0.545499
COVID19_Participant11 -- true: COVID-19 -- pred: normal
COVID19_Participant25 -- true: COVID-19 -- pred: normal
Control_Participant7 -- true: normal -- pred: normal
Control_Participant7 -- true: normal -- pred: COVID-19
COVID19_Participant26 -- true: COVID-19 -- pred: COVID-19
true :  [1, 1, 0, 0, 1]
pred :  [0, 0, 0, 1, 1]
Confusion Matrix: [1 1 2 1]
Best performance: Epoch 44, Loss 0.463921, Test ACC 0.400000, Test AUC 0.333333, Test Recall 0.333333, Test Precision 0.500000
✅ Total valid splits used: 5

📌 Repeat 1: 평균 AUC = 0.7908, 표준편차 = 0.2435
🔁 Repeat 2, Fold 0
🔍 Split #1
  → train_p_index 환자 수: 26
  → test_p_index 환자 수: 6
  → train 환자 ID: ['COVID19_Participant11', 'COVID19_Participant13', 'COVID19_Participant14', 'COVID19_Participant15', 'COVID19_Participant17', 'COVID19_Participant19', 'COVID19_Participant2', 'COVID19_Participant22', 'COVID19_Participant23', 'COVID19_Participant25', 'COVID19_Participant26', 'COVID19_Participant28', 'COVID19_Participant29', 'COVID19_Participant31', 'COVID19_Participant32', 'COVID19_Participant37', 'COVID19_Participant39', 'COVID19_Participant40', 'COVID19_Participant8', 'Control_Participant1', 'Control_Participant10', 'Control_Participant11', 'Control_Participant15', 'Control_Participant3', 'Control_Participant4', 'Control_Participant7']
  → test  환자 ID: ['COVID19_Participant11', 'COVID19_Participant26', 'Control_Participant7', 'Control_Participant7', 'COVID19_Participant31', 'COVID19_Participant13']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant10, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant4, Label: 0
    ID: Control_Participant7, Label: 0
  → test 환자 ID 및 라벨:
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: Control_Participant7, Label: 1
    ID: Control_Participant7, Label: 0
    ID: COVID19_Participant31, Label: 0
    ID: COVID19_Participant13, Label: 0
train_p_index_ 17
valid_p_index 9
test_p_index 6
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Keratinocytes', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Neurons', 'iPS_cells', 'Embryonic_stem_cells', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
data augment 실행 함
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:10,  9.28it/s]  2%|▏         | 2/100 [00:00<00:10,  9.18it/s]  4%|▍         | 4/100 [00:00<00:09,  9.65it/s]  5%|▌         | 5/100 [00:00<00:10,  9.43it/s]  6%|▌         | 6/100 [00:00<00:10,  8.99it/s]  7%|▋         | 7/100 [00:00<00:10,  9.23it/s]  8%|▊         | 8/100 [00:00<00:10,  9.16it/s]  9%|▉         | 9/100 [00:00<00:09,  9.17it/s] 10%|█         | 10/100 [00:01<00:09,  9.23it/s] 11%|█         | 11/100 [00:01<00:09,  9.03it/s] 12%|█▏        | 12/100 [00:01<00:09,  9.01it/s] 13%|█▎        | 13/100 [00:01<00:09,  9.03it/s] 14%|█▍        | 14/100 [00:01<00:09,  9.00it/s] 15%|█▌        | 15/100 [00:01<00:09,  8.97it/s] 16%|█▌        | 16/100 [00:01<00:09,  8.99it/s] 17%|█▋        | 17/100 [00:01<00:09,  8.97it/s] 18%|█▊        | 18/100 [00:01<00:09,  8.77it/s] 19%|█▉        | 19/100 [00:02<00:09,  8.99it/s] 20%|██        | 20/100 [00:02<00:08,  8.97it/s] 21%|██        | 21/100 [00:02<00:08,  8.97it/s] 22%|██▏       | 22/100 [00:02<00:08,  8.96it/s] 23%|██▎       | 23/100 [00:02<00:08,  8.97it/s] 24%|██▍       | 24/100 [00:02<00:08,  9.08it/s] 25%|██▌       | 25/100 [00:02<00:08,  8.81it/s] 26%|██▌       | 26/100 [00:02<00:08,  8.56it/s] 27%|██▋       | 27/100 [00:03<00:08,  8.57it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.65it/s] 29%|██▉       | 29/100 [00:03<00:08,  8.35it/s] 30%|███       | 30/100 [00:03<00:08,  8.66it/s] 31%|███       | 31/100 [00:03<00:08,  8.55it/s] 32%|███▏      | 32/100 [00:03<00:08,  8.38it/s] 33%|███▎      | 33/100 [00:03<00:08,  8.30it/s] 34%|███▍      | 34/100 [00:03<00:07,  8.49it/s] 35%|███▌      | 35/100 [00:03<00:07,  8.50it/s] 36%|███▌      | 36/100 [00:04<00:07,  8.78it/s] 37%|███▋      | 37/100 [00:04<00:07,  8.55it/s] 38%|███▊      | 38/100 [00:04<00:07,  8.49it/s] 39%|███▉      | 39/100 [00:04<00:07,  8.35it/s] 40%|████      | 40/100 [00:04<00:07,  8.20it/s] 41%|████      | 41/100 [00:04<00:07,  8.23it/s] 42%|████▏     | 42/100 [00:04<00:07,  8.06it/s] 43%|████▎     | 43/100 [00:04<00:06,  8.27it/s] 44%|████▍     | 44/100 [00:05<00:07,  7.65it/s] 45%|████▌     | 45/100 [00:05<00:06,  7.91it/s] 46%|████▌     | 46/100 [00:05<00:06,  8.15it/s] 47%|████▋     | 47/100 [00:05<00:06,  8.01it/s] 48%|████▊     | 48/100 [00:05<00:06,  8.15it/s] 49%|████▉     | 49/100 [00:05<00:05,  8.50it/s] 50%|█████     | 50/100 [00:05<00:05,  8.48it/s] 51%|█████     | 51/100 [00:05<00:05,  8.42it/s] 52%|█████▏    | 52/100 [00:06<00:05,  8.21it/s] 53%|█████▎    | 53/100 [00:06<00:05,  8.02it/s] 54%|█████▍    | 54/100 [00:06<00:05,  8.13it/s] 55%|█████▌    | 55/100 [00:06<00:05,  8.17it/s] 56%|█████▌    | 56/100 [00:06<00:05,  8.30it/s] 57%|█████▋    | 57/100 [00:06<00:06,  6.29it/s] 58%|█████▊    | 58/100 [00:06<00:06,  6.74it/s] 59%|█████▉    | 59/100 [00:07<00:06,  6.69it/s] 60%|██████    | 60/100 [00:07<00:05,  7.18it/s] 61%|██████    | 61/100 [00:07<00:05,  7.53it/s] 62%|██████▏   | 62/100 [00:07<00:04,  7.71it/s] 63%|██████▎   | 63/100 [00:07<00:04,  7.82it/s] 64%|██████▍   | 64/100 [00:07<00:04,  7.90it/s] 65%|██████▌   | 65/100 [00:07<00:04,  8.02it/s] 66%|██████▌   | 66/100 [00:07<00:04,  7.95it/s] 67%|██████▋   | 67/100 [00:08<00:04,  7.99it/s] 68%|██████▊   | 68/100 [00:08<00:04,  7.91it/s] 69%|██████▉   | 69/100 [00:08<00:03,  7.89it/s] 70%|███████   | 70/100 [00:08<00:04,  7.26it/s] 71%|███████   | 71/100 [00:08<00:03,  7.53it/s] 72%|███████▏  | 72/100 [00:08<00:03,  7.77it/s] 73%|███████▎  | 73/100 [00:08<00:03,  7.81it/s] 74%|███████▍  | 74/100 [00:08<00:03,  7.69it/s] 75%|███████▌  | 75/100 [00:09<00:03,  7.79it/s] 76%|███████▌  | 76/100 [00:09<00:03,  7.55it/s] 77%|███████▋  | 77/100 [00:09<00:03,  7.64it/s] 78%|███████▊  | 78/100 [00:09<00:02,  7.70it/s] 79%|███████▉  | 79/100 [00:09<00:02,  7.94it/s] 80%|████████  | 80/100 [00:09<00:02,  8.05it/s] 81%|████████  | 81/100 [00:09<00:02,  8.06it/s] 82%|████████▏ | 82/100 [00:09<00:02,  8.30it/s] 83%|████████▎ | 83/100 [00:10<00:02,  8.13it/s] 84%|████████▍ | 84/100 [00:10<00:01,  8.11it/s] 85%|████████▌ | 85/100 [00:10<00:01,  8.07it/s] 86%|████████▌ | 86/100 [00:10<00:01,  7.97it/s] 87%|████████▋ | 87/100 [00:10<00:01,  7.94it/s] 88%|████████▊ | 88/100 [00:10<00:01,  8.01it/s] 89%|████████▉ | 89/100 [00:10<00:01,  7.62it/s] 90%|█████████ | 90/100 [00:10<00:01,  7.63it/s] 91%|█████████ | 91/100 [00:11<00:01,  7.69it/s] 92%|█████████▏| 92/100 [00:11<00:01,  7.62it/s] 93%|█████████▎| 93/100 [00:11<00:00,  7.63it/s] 94%|█████████▍| 94/100 [00:11<00:00,  7.85it/s] 95%|█████████▌| 95/100 [00:11<00:00,  7.97it/s] 96%|█████████▌| 96/100 [00:11<00:00,  7.95it/s] 97%|█████████▋| 97/100 [00:11<00:00,  7.64it/s] 98%|█████████▊| 98/100 [00:11<00:00,  7.64it/s] 99%|█████████▉| 99/100 [00:12<00:00,  6.86it/s]100%|██████████| 100/100 [00:12<00:00,  7.10it/s]100%|██████████| 100/100 [00:12<00:00,  8.13it/s]
eval_p_index len:  15
individual_train 117
individual_eval 15
train data의 x, y, id 길이: 117 117 117
valid data의 x, y, id 길이: 9 9 9
test data의 x, y, id 길이: 6 6 6
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.549576, Valid_loss 0.711173
Epoch 2, Train Loss 0.471683, Valid_loss 0.738087
Epoch 3, Train Loss 0.466032, Valid_loss 0.751753
Epoch 4, Train Loss 0.439290, Valid_loss 0.756688
Epoch 5, Train Loss 0.458031, Valid_loss 0.759805
Epoch 6, Train Loss 0.445031, Valid_loss 0.761231
Epoch 7, Train Loss 0.434971, Valid_loss 0.762146
Epoch 8, Train Loss 0.435450, Valid_loss 0.761989
Epoch 9, Train Loss 0.448116, Valid_loss 0.761716
Epoch 10, Train Loss 0.431323, Valid_loss 0.758831
Epoch 11, Train Loss 0.428749, Valid_loss 0.755002
Epoch 12, Train Loss 0.448138, Valid_loss 0.753070
Epoch 13, Train Loss 0.438901, Valid_loss 0.747551
Epoch 14, Train Loss 0.426287, Valid_loss 0.744157
Epoch 15, Train Loss 0.420351, Valid_loss 0.740502
Epoch 16, Train Loss 0.442347, Valid_loss 0.736368
Epoch 17, Train Loss 0.437509, Valid_loss 0.731976
Epoch 18, Train Loss 0.413614, Valid_loss 0.722552
Epoch 19, Train Loss 0.438785, Valid_loss 0.717070
Epoch 20, Train Loss 0.411616, Valid_loss 0.701437
Epoch 21, Train Loss 0.405146, Valid_loss 0.692374
Epoch 22, Train Loss 0.410960, Valid_loss 0.670586
Epoch 23, Train Loss 0.408792, Valid_loss 0.651800
Epoch 24, Train Loss 0.404563, Valid_loss 0.634050
Epoch 25, Train Loss 0.396432, Valid_loss 0.601953
Epoch 26, Train Loss 0.387836, Valid_loss 0.582684
Epoch 27, Train Loss 0.370738, Valid_loss 0.582892
Epoch 28, Train Loss 0.367320, Valid_loss 0.569321
Epoch 29, Train Loss 0.364811, Valid_loss 0.568099
Epoch 30, Train Loss 0.366481, Valid_loss 0.565490
Epoch 31, Train Loss 0.364097, Valid_loss 0.560252
Epoch 32, Train Loss 0.384552, Valid_loss 0.554892
Epoch 33, Train Loss 0.358129, Valid_loss 0.553274
Epoch 34, Train Loss 0.363193, Valid_loss 0.546179
Epoch 35, Train Loss 0.362144, Valid_loss 0.540136
Epoch 36, Train Loss 0.352472, Valid_loss 0.538344
Epoch 37, Train Loss 0.353794, Valid_loss 0.535932
Epoch 38, Train Loss 0.357675, Valid_loss 0.533125
Epoch 39, Train Loss 0.355000, Valid_loss 0.529567
Epoch 40, Train Loss 0.352003, Valid_loss 0.527029
Epoch 41, Train Loss 0.357872, Valid_loss 0.526686
Epoch 42, Train Loss 0.366382, Valid_loss 0.527365
Epoch 43, Train Loss 0.354523, Valid_loss 0.520330
Epoch 44, Train Loss 0.351953, Valid_loss 0.517322
Epoch 45, Train Loss 0.354487, Valid_loss 0.517907
Epoch 46, Train Loss 0.340570, Valid_loss 0.515516
Epoch 47, Train Loss 0.351475, Valid_loss 0.516238
Epoch 48, Train Loss 0.346481, Valid_loss 0.513498
Epoch 49, Train Loss 0.350939, Valid_loss 0.512439
Epoch 50, Train Loss 0.353350, Valid_loss 0.510802
Epoch 51, Train Loss 0.348310, Valid_loss 0.509623
Epoch 52, Train Loss 0.342630, Valid_loss 0.507956
Epoch 53, Train Loss 0.344582, Valid_loss 0.508187
Epoch 54, Train Loss 0.352166, Valid_loss 0.507172
Epoch 55, Train Loss 0.354790, Valid_loss 0.506445
Epoch 56, Train Loss 0.341434, Valid_loss 0.506218
Epoch 57, Train Loss 0.344205, Valid_loss 0.503760
Epoch 58, Train Loss 0.356370, Valid_loss 0.503056
Epoch 59, Train Loss 0.346736, Valid_loss 0.503794
Epoch 60, Train Loss 0.336856, Valid_loss 0.502344
Epoch 61, Train Loss 0.336808, Valid_loss 0.502330
Epoch 62, Train Loss 0.334620, Valid_loss 0.501714
Epoch 63, Train Loss 0.338265, Valid_loss 0.501001
Epoch 64, Train Loss 0.333298, Valid_loss 0.501040
Epoch 65, Train Loss 0.335929, Valid_loss 0.500240
Epoch 66, Train Loss 0.334482, Valid_loss 0.500174
Epoch 67, Train Loss 0.337360, Valid_loss 0.499334
Epoch 68, Train Loss 0.339717, Valid_loss 0.498121
Epoch 69, Train Loss 0.333694, Valid_loss 0.499569
Epoch 70, Train Loss 0.348343, Valid_loss 0.498895
Epoch 71, Train Loss 0.325404, Valid_loss 0.496817
Epoch 72, Train Loss 0.325235, Valid_loss 0.496097
Epoch 73, Train Loss 0.337413, Valid_loss 0.496059
Epoch 74, Train Loss 0.336813, Valid_loss 0.495640
Epoch 75, Train Loss 0.324339, Valid_loss 0.494721
Epoch 76, Train Loss 0.337648, Valid_loss 0.495018
Epoch 77, Train Loss 0.326716, Valid_loss 0.494537
Epoch 78, Train Loss 0.334801, Valid_loss 0.494051
Epoch 79, Train Loss 0.321909, Valid_loss 0.493748
Epoch 80, Train Loss 0.343512, Valid_loss 0.492461
Epoch 81, Train Loss 0.323544, Valid_loss 0.493678
Epoch 82, Train Loss 0.329519, Valid_loss 0.491927
Epoch 83, Train Loss 0.331396, Valid_loss 0.491967
Epoch 84, Train Loss 0.324797, Valid_loss 0.491530
Epoch 85, Train Loss 0.321376, Valid_loss 0.491952
Epoch 86, Train Loss 0.328238, Valid_loss 0.489548
Epoch 87, Train Loss 0.320436, Valid_loss 0.488543
Epoch 88, Train Loss 0.334022, Valid_loss 0.488537
Epoch 89, Train Loss 0.324471, Valid_loss 0.490805
Epoch 90, Train Loss 0.321493, Valid_loss 0.489837
Epoch 91, Train Loss 0.339842, Valid_loss 0.488769
Epoch 92, Train Loss 0.317535, Valid_loss 0.487832
Epoch 93, Train Loss 0.339276, Valid_loss 0.486252
Epoch 94, Train Loss 0.320782, Valid_loss 0.487795
Epoch 95, Train Loss 0.320135, Valid_loss 0.486727
Epoch 96, Train Loss 0.329620, Valid_loss 0.486795
Epoch 97, Train Loss 0.316127, Valid_loss 0.487035
COVID19_Participant11 -- true: COVID-19 -- pred: normal
COVID19_Participant26 -- true: COVID-19 -- pred: COVID-19
Control_Participant7 -- true: normal -- pred: normal
Control_Participant7 -- true: normal -- pred: normal
COVID19_Participant31 -- true: COVID-19 -- pred: COVID-19
COVID19_Participant13 -- true: COVID-19 -- pred: COVID-19
true :  [1, 1, 0, 0, 1, 1]
pred :  [0, 1, 0, 0, 1, 1]
Confusion Matrix: [2 0 1 3]
Best performance: Epoch 93, Loss 0.339276, Test ACC 0.833333, Test AUC 0.750000, Test Recall 0.750000, Test Precision 1.000000
✅ Total valid splits used: 1
🔁 Repeat 2, Fold 1
🔍 Split #2
  → train_p_index 환자 수: 26
  → test_p_index 환자 수: 6
  → train 환자 ID: ['COVID19_Participant11', 'COVID19_Participant13', 'COVID19_Participant14', 'COVID19_Participant15', 'COVID19_Participant17', 'COVID19_Participant19', 'COVID19_Participant2', 'COVID19_Participant20', 'COVID19_Participant22', 'COVID19_Participant25', 'COVID19_Participant28', 'COVID19_Participant29', 'COVID19_Participant31', 'COVID19_Participant32', 'COVID19_Participant39', 'COVID19_Participant4', 'COVID19_Participant40', 'COVID19_Participant7', 'Control_Participant1', 'Control_Participant10', 'Control_Participant11', 'Control_Participant15', 'Control_Participant5', 'Control_Participant7', 'Control_Participant8', 'Control_Participant9']
  → test  환자 ID: ['COVID19_Participant19', 'Control_Participant7', 'COVID19_Participant11', 'Control_Participant5', 'COVID19_Participant13', 'COVID19_Participant13']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant10, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant8, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: COVID19_Participant19, Label: 1
    ID: Control_Participant7, Label: 1
    ID: COVID19_Participant11, Label: 1
    ID: Control_Participant5, Label: 1
    ID: COVID19_Participant13, Label: 0
    ID: COVID19_Participant13, Label: 0
train_p_index_ 17
valid_p_index 9
test_p_index 6
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Keratinocytes', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Neurons', 'iPS_cells', 'Embryonic_stem_cells', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
data augment 실행 함
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:10,  9.51it/s]  2%|▏         | 2/100 [00:00<00:11,  8.27it/s]  3%|▎         | 3/100 [00:00<00:11,  8.68it/s]  4%|▍         | 4/100 [00:00<00:10,  8.75it/s]  5%|▌         | 5/100 [00:00<00:10,  8.66it/s]  6%|▌         | 6/100 [00:00<00:10,  8.66it/s]  7%|▋         | 7/100 [00:00<00:10,  8.68it/s]  8%|▊         | 8/100 [00:00<00:10,  8.53it/s]  9%|▉         | 9/100 [00:01<00:10,  8.39it/s] 10%|█         | 10/100 [00:01<00:10,  8.74it/s] 11%|█         | 11/100 [00:01<00:10,  8.62it/s] 12%|█▏        | 12/100 [00:01<00:09,  8.85it/s] 13%|█▎        | 13/100 [00:01<00:09,  9.05it/s] 14%|█▍        | 14/100 [00:01<00:09,  9.07it/s] 15%|█▌        | 15/100 [00:01<00:09,  9.19it/s] 16%|█▌        | 16/100 [00:01<00:09,  9.26it/s] 17%|█▋        | 17/100 [00:01<00:09,  8.99it/s] 18%|█▊        | 18/100 [00:02<00:09,  8.99it/s] 19%|█▉        | 19/100 [00:02<00:08,  9.03it/s] 20%|██        | 20/100 [00:02<00:08,  9.13it/s] 21%|██        | 21/100 [00:02<00:08,  8.99it/s] 22%|██▏       | 22/100 [00:02<00:08,  9.11it/s] 23%|██▎       | 23/100 [00:02<00:08,  9.19it/s] 24%|██▍       | 24/100 [00:02<00:08,  9.18it/s] 25%|██▌       | 25/100 [00:02<00:08,  8.70it/s] 26%|██▌       | 26/100 [00:02<00:08,  8.87it/s] 27%|██▋       | 27/100 [00:03<00:08,  8.95it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.99it/s] 29%|██▉       | 29/100 [00:03<00:08,  8.37it/s] 30%|███       | 30/100 [00:03<00:08,  8.57it/s] 31%|███       | 31/100 [00:03<00:08,  8.41it/s] 32%|███▏      | 32/100 [00:03<00:08,  8.49it/s] 33%|███▎      | 33/100 [00:03<00:07,  8.61it/s] 34%|███▍      | 34/100 [00:03<00:07,  8.67it/s] 35%|███▌      | 35/100 [00:03<00:07,  8.87it/s] 36%|███▌      | 36/100 [00:04<00:07,  8.66it/s] 37%|███▋      | 37/100 [00:04<00:07,  8.65it/s] 38%|███▊      | 38/100 [00:04<00:07,  8.52it/s] 39%|███▉      | 39/100 [00:04<00:07,  8.58it/s] 40%|████      | 40/100 [00:04<00:06,  8.80it/s] 41%|████      | 41/100 [00:04<00:07,  8.27it/s] 42%|████▏     | 42/100 [00:04<00:06,  8.46it/s] 43%|████▎     | 43/100 [00:04<00:07,  8.03it/s] 44%|████▍     | 44/100 [00:05<00:07,  7.89it/s] 45%|████▌     | 45/100 [00:05<00:06,  8.01it/s] 46%|████▌     | 46/100 [00:05<00:06,  8.39it/s] 47%|████▋     | 47/100 [00:05<00:06,  8.37it/s] 48%|████▊     | 48/100 [00:05<00:06,  8.00it/s] 49%|████▉     | 49/100 [00:05<00:06,  8.16it/s] 50%|█████     | 50/100 [00:05<00:06,  8.03it/s] 51%|█████     | 51/100 [00:05<00:05,  8.18it/s] 52%|█████▏    | 52/100 [00:06<00:05,  8.02it/s] 53%|█████▎    | 53/100 [00:06<00:05,  8.22it/s] 54%|█████▍    | 54/100 [00:06<00:05,  8.30it/s] 55%|█████▌    | 55/100 [00:06<00:05,  8.42it/s] 56%|█████▌    | 56/100 [00:06<00:05,  8.40it/s] 57%|█████▋    | 57/100 [00:06<00:05,  8.57it/s] 58%|█████▊    | 58/100 [00:06<00:04,  8.48it/s] 59%|█████▉    | 59/100 [00:06<00:04,  8.35it/s] 60%|██████    | 60/100 [00:06<00:04,  8.40it/s] 61%|██████    | 61/100 [00:07<00:04,  8.21it/s] 62%|██████▏   | 62/100 [00:07<00:04,  8.40it/s] 63%|██████▎   | 63/100 [00:07<00:04,  8.28it/s] 64%|██████▍   | 64/100 [00:07<00:04,  8.17it/s] 65%|██████▌   | 65/100 [00:07<00:04,  8.21it/s] 66%|██████▌   | 66/100 [00:07<00:04,  8.28it/s] 67%|██████▋   | 67/100 [00:07<00:04,  7.93it/s] 68%|██████▊   | 68/100 [00:07<00:03,  8.02it/s] 69%|██████▉   | 69/100 [00:08<00:03,  7.82it/s] 70%|███████   | 70/100 [00:08<00:03,  7.97it/s] 71%|███████   | 71/100 [00:08<00:03,  8.10it/s] 72%|███████▏  | 72/100 [00:08<00:03,  7.92it/s] 73%|███████▎  | 73/100 [00:08<00:03,  8.12it/s] 74%|███████▍  | 74/100 [00:08<00:03,  7.91it/s] 75%|███████▌  | 75/100 [00:08<00:03,  8.06it/s] 76%|███████▌  | 76/100 [00:08<00:02,  8.30it/s] 77%|███████▋  | 77/100 [00:09<00:02,  8.19it/s] 78%|███████▊  | 78/100 [00:09<00:02,  7.87it/s] 79%|███████▉  | 79/100 [00:09<00:02,  7.93it/s] 80%|████████  | 80/100 [00:09<00:02,  7.74it/s] 81%|████████  | 81/100 [00:09<00:02,  7.45it/s] 82%|████████▏ | 82/100 [00:09<00:02,  7.59it/s] 83%|████████▎ | 83/100 [00:09<00:02,  7.76it/s] 84%|████████▍ | 84/100 [00:10<00:02,  7.92it/s] 85%|████████▌ | 85/100 [00:10<00:01,  7.93it/s] 86%|████████▌ | 86/100 [00:10<00:01,  7.53it/s] 87%|████████▋ | 87/100 [00:10<00:01,  7.51it/s] 88%|████████▊ | 88/100 [00:10<00:01,  7.55it/s] 89%|████████▉ | 89/100 [00:10<00:01,  7.49it/s] 90%|█████████ | 90/100 [00:10<00:01,  7.39it/s] 91%|█████████ | 91/100 [00:10<00:01,  7.43it/s] 92%|█████████▏| 92/100 [00:11<00:01,  7.41it/s] 93%|█████████▎| 93/100 [00:11<00:00,  7.43it/s] 94%|█████████▍| 94/100 [00:11<00:00,  7.66it/s] 95%|█████████▌| 95/100 [00:11<00:00,  7.52it/s] 96%|█████████▌| 96/100 [00:11<00:00,  7.65it/s] 97%|█████████▋| 97/100 [00:11<00:00,  7.72it/s] 98%|█████████▊| 98/100 [00:11<00:00,  7.80it/s] 99%|█████████▉| 99/100 [00:11<00:00,  7.94it/s]100%|██████████| 100/100 [00:12<00:00,  7.83it/s]100%|██████████| 100/100 [00:12<00:00,  8.26it/s]
eval_p_index len:  15
individual_train 117
individual_eval 15
train data의 x, y, id 길이: 117 117 117
valid data의 x, y, id 길이: 9 9 9
test data의 x, y, id 길이: 6 6 6
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.871654, Valid_loss 0.690053
Epoch 2, Train Loss 0.843239, Valid_loss 0.681958
Epoch 3, Train Loss 0.802504, Valid_loss 0.670144
Epoch 4, Train Loss 0.761769, Valid_loss 0.667640
Epoch 5, Train Loss 0.731672, Valid_loss 0.670007
Epoch 6, Train Loss 0.711793, Valid_loss 0.673998
Epoch 7, Train Loss 0.702237, Valid_loss 0.678562
Epoch 8, Train Loss 0.696254, Valid_loss 0.681767
Epoch 9, Train Loss 0.691537, Valid_loss 0.683413
Epoch 10, Train Loss 0.695298, Valid_loss 0.684238
Epoch 11, Train Loss 0.686433, Valid_loss 0.683703
Epoch 12, Train Loss 0.690253, Valid_loss 0.681717
Epoch 13, Train Loss 0.672021, Valid_loss 0.675068
Epoch 14, Train Loss 0.657020, Valid_loss 0.674425
Epoch 15, Train Loss 0.640364, Valid_loss 0.673398
Epoch 16, Train Loss 0.632566, Valid_loss 0.665592
Epoch 17, Train Loss 0.633600, Valid_loss 0.653843
Epoch 18, Train Loss 0.620296, Valid_loss 0.639532
Epoch 19, Train Loss 0.612996, Valid_loss 0.630076
Epoch 20, Train Loss 0.604646, Valid_loss 0.629084
Epoch 21, Train Loss 0.608170, Valid_loss 0.627308
Epoch 22, Train Loss 0.596549, Valid_loss 0.626875
Epoch 23, Train Loss 0.595497, Valid_loss 0.622009
Epoch 24, Train Loss 0.587756, Valid_loss 0.611433
Epoch 25, Train Loss 0.587478, Valid_loss 0.605097
Epoch 26, Train Loss 0.570338, Valid_loss 0.613472
Epoch 27, Train Loss 0.549309, Valid_loss 0.604939
Epoch 28, Train Loss 0.534343, Valid_loss 0.596866
Epoch 29, Train Loss 0.518107, Valid_loss 0.586165
Epoch 30, Train Loss 0.511787, Valid_loss 0.573269
Epoch 31, Train Loss 0.503269, Valid_loss 0.576087
Epoch 32, Train Loss 0.500338, Valid_loss 0.572343
Epoch 33, Train Loss 0.496598, Valid_loss 0.569379
Epoch 34, Train Loss 0.492107, Valid_loss 0.577225
Epoch 35, Train Loss 0.485950, Valid_loss 0.569090
Epoch 36, Train Loss 0.483946, Valid_loss 0.573780
Epoch 37, Train Loss 0.483512, Valid_loss 0.565972
Epoch 38, Train Loss 0.486172, Valid_loss 0.569074
Epoch 39, Train Loss 0.475385, Valid_loss 0.567879
Epoch 40, Train Loss 0.464256, Valid_loss 0.571200
Epoch 41, Train Loss 0.464613, Valid_loss 0.564418
Epoch 42, Train Loss 0.459029, Valid_loss 0.571913
Epoch 43, Train Loss 0.462415, Valid_loss 0.564341
Epoch 44, Train Loss 0.454036, Valid_loss 0.570449
Epoch 45, Train Loss 0.447630, Valid_loss 0.574449
Epoch 46, Train Loss 0.457846, Valid_loss 0.570169
Epoch 47, Train Loss 0.452569, Valid_loss 0.573109
Epoch 48, Train Loss 0.451067, Valid_loss 0.578398
Epoch 49, Train Loss 0.451037, Valid_loss 0.578256
Epoch 50, Train Loss 0.434994, Valid_loss 0.579026
Epoch 51, Train Loss 0.435755, Valid_loss 0.582534
Epoch 52, Train Loss 0.436591, Valid_loss 0.579569
Epoch 53, Train Loss 0.439986, Valid_loss 0.580439
Epoch 54, Train Loss 0.433204, Valid_loss 0.584251
COVID19_Participant19 -- true: COVID-19 -- pred: COVID-19
Control_Participant7 -- true: normal -- pred: normal
COVID19_Participant11 -- true: COVID-19 -- pred: COVID-19
Control_Participant5 -- true: normal -- pred: normal
COVID19_Participant13 -- true: COVID-19 -- pred: COVID-19
COVID19_Participant13 -- true: COVID-19 -- pred: COVID-19
true :  [1, 0, 1, 0, 1, 1]
pred :  [1, 0, 1, 0, 1, 1]
Confusion Matrix: [2 0 0 4]
Best performance: Epoch 43, Loss 0.462415, Test ACC 1.000000, Test AUC 1.000000, Test Recall 1.000000, Test Precision 1.000000
✅ Total valid splits used: 2
🔁 Repeat 2, Fold 2
🔍 Split #3
  → train_p_index 환자 수: 27
  → test_p_index 환자 수: 5
  → train 환자 ID: ['COVID19_Participant11', 'COVID19_Participant13', 'COVID19_Participant14', 'COVID19_Participant19', 'COVID19_Participant2', 'COVID19_Participant20', 'COVID19_Participant23', 'COVID19_Participant25', 'COVID19_Participant26', 'COVID19_Participant29', 'COVID19_Participant31', 'COVID19_Participant37', 'COVID19_Participant39', 'COVID19_Participant4', 'COVID19_Participant40', 'COVID19_Participant7', 'COVID19_Participant8', 'Control_Participant1', 'Control_Participant10', 'Control_Participant11', 'Control_Participant15', 'Control_Participant3', 'Control_Participant4', 'Control_Participant5', 'Control_Participant7', 'Control_Participant8', 'Control_Participant9']
  → test  환자 ID: ['Control_Participant5', 'COVID19_Participant13', 'COVID19_Participant5', 'Control_Participant7', 'Control_Participant4']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant10, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant4, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant8, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: Control_Participant5, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant5, Label: 1
    ID: Control_Participant7, Label: 1
    ID: Control_Participant4, Label: 1
train_p_index_ 18
valid_p_index 9
test_p_index 5
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Keratinocytes', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Neurons', 'iPS_cells', 'Embryonic_stem_cells', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
data augment 실행 함
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:10,  9.59it/s]  2%|▏         | 2/100 [00:00<00:10,  8.97it/s]  4%|▍         | 4/100 [00:00<00:10,  9.03it/s]  5%|▌         | 5/100 [00:00<00:10,  9.11it/s]  6%|▌         | 6/100 [00:00<00:10,  9.21it/s]  7%|▋         | 7/100 [00:00<00:09,  9.42it/s]  9%|▉         | 9/100 [00:00<00:09,  9.39it/s] 10%|█         | 10/100 [00:01<00:09,  9.48it/s] 12%|█▏        | 12/100 [00:01<00:09,  9.50it/s] 13%|█▎        | 13/100 [00:01<00:09,  9.31it/s] 14%|█▍        | 14/100 [00:01<00:09,  9.42it/s] 15%|█▌        | 15/100 [00:01<00:09,  9.29it/s] 16%|█▌        | 16/100 [00:01<00:08,  9.41it/s] 17%|█▋        | 17/100 [00:01<00:08,  9.38it/s] 18%|█▊        | 18/100 [00:01<00:08,  9.31it/s] 19%|█▉        | 19/100 [00:02<00:08,  9.35it/s] 20%|██        | 20/100 [00:02<00:08,  9.07it/s] 21%|██        | 21/100 [00:02<00:08,  9.13it/s] 22%|██▏       | 22/100 [00:02<00:08,  9.31it/s] 23%|██▎       | 23/100 [00:02<00:08,  9.28it/s] 24%|██▍       | 24/100 [00:02<00:08,  8.97it/s] 26%|██▌       | 26/100 [00:02<00:07,  9.30it/s] 27%|██▋       | 27/100 [00:02<00:07,  9.35it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.73it/s] 29%|██▉       | 29/100 [00:03<00:08,  8.83it/s] 30%|███       | 30/100 [00:03<00:07,  9.12it/s] 31%|███       | 31/100 [00:03<00:07,  9.15it/s] 32%|███▏      | 32/100 [00:03<00:07,  9.07it/s] 33%|███▎      | 33/100 [00:03<00:07,  8.41it/s] 34%|███▍      | 34/100 [00:03<00:07,  8.35it/s] 35%|███▌      | 35/100 [00:03<00:07,  8.37it/s] 36%|███▌      | 36/100 [00:03<00:07,  8.44it/s] 37%|███▋      | 37/100 [00:04<00:07,  8.45it/s] 38%|███▊      | 38/100 [00:04<00:07,  8.18it/s] 39%|███▉      | 39/100 [00:04<00:07,  8.29it/s] 40%|████      | 40/100 [00:04<00:07,  8.31it/s] 41%|████      | 41/100 [00:04<00:06,  8.57it/s] 42%|████▏     | 42/100 [00:04<00:06,  8.32it/s] 43%|████▎     | 43/100 [00:04<00:06,  8.23it/s] 44%|████▍     | 44/100 [00:04<00:06,  8.27it/s] 45%|████▌     | 45/100 [00:05<00:06,  8.34it/s] 46%|████▌     | 46/100 [00:05<00:06,  8.63it/s] 47%|████▋     | 47/100 [00:05<00:06,  8.70it/s] 48%|████▊     | 48/100 [00:05<00:06,  8.62it/s] 49%|████▉     | 49/100 [00:05<00:06,  8.45it/s] 50%|█████     | 50/100 [00:05<00:05,  8.34it/s] 51%|█████     | 51/100 [00:05<00:05,  8.49it/s] 52%|█████▏    | 52/100 [00:05<00:05,  8.33it/s] 53%|█████▎    | 53/100 [00:05<00:05,  8.26it/s] 54%|█████▍    | 54/100 [00:06<00:05,  8.61it/s] 55%|█████▌    | 55/100 [00:06<00:05,  8.59it/s] 56%|█████▌    | 56/100 [00:06<00:05,  8.45it/s] 57%|█████▋    | 57/100 [00:06<00:04,  8.65it/s] 58%|█████▊    | 58/100 [00:06<00:04,  8.64it/s] 59%|█████▉    | 59/100 [00:06<00:04,  8.43it/s] 60%|██████    | 60/100 [00:06<00:04,  8.31it/s] 61%|██████    | 61/100 [00:06<00:04,  8.48it/s] 62%|██████▏   | 62/100 [00:07<00:04,  8.39it/s] 63%|██████▎   | 63/100 [00:07<00:04,  8.47it/s] 64%|██████▍   | 64/100 [00:07<00:04,  8.32it/s] 65%|██████▌   | 65/100 [00:07<00:04,  8.22it/s] 66%|██████▌   | 66/100 [00:07<00:04,  8.10it/s] 67%|██████▋   | 67/100 [00:07<00:03,  8.41it/s] 68%|██████▊   | 68/100 [00:07<00:03,  8.44it/s] 69%|██████▉   | 69/100 [00:07<00:03,  8.17it/s] 70%|███████   | 70/100 [00:08<00:03,  8.23it/s] 71%|███████   | 71/100 [00:08<00:03,  8.25it/s] 72%|███████▏  | 72/100 [00:08<00:03,  8.19it/s] 73%|███████▎  | 73/100 [00:08<00:03,  8.21it/s] 74%|███████▍  | 74/100 [00:08<00:03,  8.16it/s] 75%|███████▌  | 75/100 [00:08<00:03,  8.29it/s] 76%|███████▌  | 76/100 [00:08<00:02,  8.39it/s] 77%|███████▋  | 77/100 [00:08<00:02,  8.56it/s] 78%|███████▊  | 78/100 [00:08<00:02,  8.62it/s] 79%|███████▉  | 79/100 [00:09<00:02,  8.35it/s] 80%|████████  | 80/100 [00:09<00:02,  8.27it/s] 81%|████████  | 81/100 [00:09<00:02,  8.16it/s] 82%|████████▏ | 82/100 [00:09<00:02,  8.19it/s] 83%|████████▎ | 83/100 [00:09<00:02,  8.18it/s] 84%|████████▍ | 84/100 [00:09<00:01,  8.20it/s] 85%|████████▌ | 85/100 [00:09<00:01,  8.16it/s] 86%|████████▌ | 86/100 [00:09<00:01,  8.04it/s] 87%|████████▋ | 87/100 [00:10<00:01,  8.10it/s] 88%|████████▊ | 88/100 [00:10<00:01,  8.20it/s] 89%|████████▉ | 89/100 [00:10<00:01,  8.38it/s] 90%|█████████ | 90/100 [00:10<00:01,  8.68it/s] 91%|█████████ | 91/100 [00:10<00:01,  8.60it/s] 92%|█████████▏| 92/100 [00:10<00:00,  8.34it/s] 93%|█████████▎| 93/100 [00:10<00:00,  8.06it/s] 94%|█████████▍| 94/100 [00:10<00:00,  8.15it/s] 95%|█████████▌| 95/100 [00:11<00:00,  7.85it/s] 96%|█████████▌| 96/100 [00:11<00:00,  7.74it/s] 97%|█████████▋| 97/100 [00:11<00:00,  7.48it/s] 98%|█████████▊| 98/100 [00:11<00:00,  7.57it/s] 99%|█████████▉| 99/100 [00:11<00:00,  7.69it/s]100%|██████████| 100/100 [00:11<00:00,  8.19it/s]100%|██████████| 100/100 [00:11<00:00,  8.55it/s]
eval_p_index len:  14
individual_train 118
individual_eval 14
train data의 x, y, id 길이: 118 118 118
valid data의 x, y, id 길이: 9 9 9
test data의 x, y, id 길이: 5 5 5
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.648007, Valid_loss 0.676152
Epoch 2, Train Loss 0.642359, Valid_loss 0.671074
Epoch 3, Train Loss 0.628519, Valid_loss 0.666860
Epoch 4, Train Loss 0.623859, Valid_loss 0.665679
Epoch 5, Train Loss 0.597408, Valid_loss 0.658948
Epoch 6, Train Loss 0.617503, Valid_loss 0.651212
Epoch 7, Train Loss 0.603330, Valid_loss 0.637370
Epoch 8, Train Loss 0.598156, Valid_loss 0.626971
Epoch 9, Train Loss 0.571369, Valid_loss 0.614027
Epoch 10, Train Loss 0.560765, Valid_loss 0.602326
Epoch 11, Train Loss 0.567607, Valid_loss 0.597942
Epoch 12, Train Loss 0.547431, Valid_loss 0.579668
Epoch 13, Train Loss 0.540945, Valid_loss 0.573564
Epoch 14, Train Loss 0.537569, Valid_loss 0.562340
Epoch 15, Train Loss 0.530613, Valid_loss 0.550634
Epoch 16, Train Loss 0.519792, Valid_loss 0.540019
Epoch 17, Train Loss 0.516238, Valid_loss 0.534837
Epoch 18, Train Loss 0.514401, Valid_loss 0.516473
Epoch 19, Train Loss 0.506852, Valid_loss 0.499764
Epoch 20, Train Loss 0.492230, Valid_loss 0.494919
Epoch 21, Train Loss 0.488421, Valid_loss 0.487706
Epoch 22, Train Loss 0.488169, Valid_loss 0.478642
Epoch 23, Train Loss 0.491683, Valid_loss 0.478767
Epoch 24, Train Loss 0.490030, Valid_loss 0.480343
Epoch 25, Train Loss 0.484159, Valid_loss 0.471912
Epoch 26, Train Loss 0.473001, Valid_loss 0.469265
Epoch 27, Train Loss 0.479061, Valid_loss 0.470526
Epoch 28, Train Loss 0.476727, Valid_loss 0.468927
Epoch 29, Train Loss 0.462979, Valid_loss 0.465640
Epoch 30, Train Loss 0.468422, Valid_loss 0.466514
Epoch 31, Train Loss 0.463526, Valid_loss 0.464227
Epoch 32, Train Loss 0.464117, Valid_loss 0.466050
Epoch 33, Train Loss 0.469201, Valid_loss 0.468953
Epoch 34, Train Loss 0.466105, Valid_loss 0.462951
Epoch 35, Train Loss 0.463112, Valid_loss 0.466829
Epoch 36, Train Loss 0.458149, Valid_loss 0.463605
Epoch 37, Train Loss 0.471678, Valid_loss 0.465086
Epoch 38, Train Loss 0.468905, Valid_loss 0.459989
Epoch 39, Train Loss 0.457268, Valid_loss 0.462779
Epoch 40, Train Loss 0.459578, Valid_loss 0.458288
Epoch 41, Train Loss 0.459795, Valid_loss 0.461037
Epoch 42, Train Loss 0.454627, Valid_loss 0.459308
Epoch 43, Train Loss 0.450719, Valid_loss 0.457386
Epoch 44, Train Loss 0.457157, Valid_loss 0.456424
Epoch 45, Train Loss 0.455560, Valid_loss 0.457602
Epoch 46, Train Loss 0.443237, Valid_loss 0.455534
Epoch 47, Train Loss 0.446353, Valid_loss 0.455214
Epoch 48, Train Loss 0.450645, Valid_loss 0.453493
Epoch 49, Train Loss 0.450116, Valid_loss 0.452634
Epoch 50, Train Loss 0.450726, Valid_loss 0.454747
Epoch 51, Train Loss 0.451566, Valid_loss 0.449885
Epoch 52, Train Loss 0.446644, Valid_loss 0.452549
Epoch 53, Train Loss 0.437804, Valid_loss 0.452864
Control_Participant5 -- true: normal -- pred: normal
COVID19_Participant13 -- true: COVID-19 -- pred: COVID-19
COVID19_Participant5 -- true: COVID-19 -- pred: COVID-19
Control_Participant7 -- true: normal -- pred: COVID-19
Control_Participant4 -- true: normal -- pred: COVID-19
true :  [0, 1, 1, 0, 0]
pred :  [0, 1, 1, 1, 1]
Confusion Matrix: [1 2 0 2]
Best performance: Epoch 51, Loss 0.451566, Test ACC 0.600000, Test AUC 1.000000, Test Recall 1.000000, Test Precision 0.500000
✅ Total valid splits used: 3
🔁 Repeat 2, Fold 3
🔍 Split #4
  → train_p_index 환자 수: 23
  → test_p_index 환자 수: 9
  → train 환자 ID: ['COVID19_Participant13', 'COVID19_Participant15', 'COVID19_Participant17', 'COVID19_Participant20', 'COVID19_Participant22', 'COVID19_Participant23', 'COVID19_Participant26', 'COVID19_Participant28', 'COVID19_Participant29', 'COVID19_Participant32', 'COVID19_Participant37', 'COVID19_Participant39', 'COVID19_Participant4', 'COVID19_Participant40', 'COVID19_Participant7', 'COVID19_Participant8', 'Control_Participant11', 'Control_Participant15', 'Control_Participant3', 'Control_Participant4', 'Control_Participant5', 'Control_Participant8', 'Control_Participant9']
  → test  환자 ID: ['COVID19_Participant26', 'Control_Participant3', 'COVID19_Participant7', 'Control_Participant9', 'COVID19_Participant26', 'Control_Participant12', 'Control_Participant4', 'Control_Participant5', 'COVID19_Participant13']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: Control_Participant11, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant4, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant8, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: COVID19_Participant26, Label: 1
    ID: Control_Participant3, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: Control_Participant9, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: Control_Participant12, Label: 1
    ID: Control_Participant4, Label: 0
    ID: Control_Participant5, Label: 0
    ID: COVID19_Participant13, Label: 0
train_p_index_ 15
valid_p_index 8
test_p_index 9
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Epithelial_cells', 'Platelets', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Keratinocytes', 'Macrophage', 'Epithelial_cells', 'B_cell', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
data augment 실행 함
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:11,  8.34it/s]  2%|▏         | 2/100 [00:00<00:12,  7.99it/s]  3%|▎         | 3/100 [00:00<00:11,  8.23it/s]  4%|▍         | 4/100 [00:00<00:11,  8.45it/s]  6%|▌         | 6/100 [00:00<00:10,  9.01it/s]  7%|▋         | 7/100 [00:00<00:10,  8.97it/s]  8%|▊         | 8/100 [00:00<00:10,  8.95it/s]  9%|▉         | 9/100 [00:01<00:10,  8.90it/s] 10%|█         | 10/100 [00:01<00:10,  8.73it/s] 11%|█         | 11/100 [00:01<00:10,  8.77it/s] 12%|█▏        | 12/100 [00:01<00:10,  8.79it/s] 13%|█▎        | 13/100 [00:01<00:10,  8.60it/s] 14%|█▍        | 14/100 [00:01<00:09,  8.73it/s] 15%|█▌        | 15/100 [00:01<00:10,  8.27it/s] 16%|█▌        | 16/100 [00:01<00:10,  8.24it/s] 17%|█▋        | 17/100 [00:01<00:09,  8.48it/s] 19%|█▉        | 19/100 [00:02<00:08,  9.01it/s] 20%|██        | 20/100 [00:02<00:08,  8.91it/s] 21%|██        | 21/100 [00:02<00:08,  8.91it/s] 23%|██▎       | 23/100 [00:02<00:08,  9.21it/s] 24%|██▍       | 24/100 [00:02<00:08,  9.35it/s] 25%|██▌       | 25/100 [00:02<00:08,  9.07it/s] 26%|██▌       | 26/100 [00:02<00:08,  8.93it/s] 27%|██▋       | 27/100 [00:03<00:08,  8.75it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.66it/s] 29%|██▉       | 29/100 [00:03<00:08,  8.52it/s] 30%|███       | 30/100 [00:03<00:08,  8.61it/s] 31%|███       | 31/100 [00:03<00:07,  8.77it/s] 32%|███▏      | 32/100 [00:03<00:07,  8.66it/s] 33%|███▎      | 33/100 [00:03<00:07,  8.53it/s] 34%|███▍      | 34/100 [00:03<00:07,  8.52it/s] 35%|███▌      | 35/100 [00:04<00:07,  8.43it/s] 36%|███▌      | 36/100 [00:04<00:07,  8.40it/s] 37%|███▋      | 37/100 [00:04<00:07,  8.21it/s] 38%|███▊      | 38/100 [00:04<00:07,  8.24it/s] 39%|███▉      | 39/100 [00:04<00:07,  8.21it/s] 40%|████      | 40/100 [00:04<00:07,  8.14it/s] 41%|████      | 41/100 [00:04<00:07,  8.23it/s] 42%|████▏     | 42/100 [00:04<00:06,  8.32it/s] 43%|████▎     | 43/100 [00:04<00:06,  8.31it/s] 44%|████▍     | 44/100 [00:05<00:06,  8.40it/s] 45%|████▌     | 45/100 [00:05<00:06,  8.28it/s] 46%|████▌     | 46/100 [00:05<00:06,  8.35it/s] 47%|████▋     | 47/100 [00:05<00:06,  8.41it/s] 48%|████▊     | 48/100 [00:05<00:06,  8.29it/s] 49%|████▉     | 49/100 [00:05<00:06,  8.28it/s] 50%|█████     | 50/100 [00:05<00:05,  8.38it/s] 51%|█████     | 51/100 [00:05<00:05,  8.26it/s] 52%|█████▏    | 52/100 [00:06<00:05,  8.26it/s] 53%|█████▎    | 53/100 [00:06<00:06,  7.59it/s] 54%|█████▍    | 54/100 [00:06<00:05,  7.94it/s] 55%|█████▌    | 55/100 [00:06<00:05,  7.88it/s] 56%|█████▌    | 56/100 [00:06<00:05,  7.91it/s] 57%|█████▋    | 57/100 [00:06<00:05,  7.67it/s] 58%|█████▊    | 58/100 [00:06<00:05,  7.87it/s] 59%|█████▉    | 59/100 [00:06<00:05,  8.02it/s] 60%|██████    | 60/100 [00:07<00:05,  7.91it/s] 61%|██████    | 61/100 [00:07<00:04,  8.24it/s] 62%|██████▏   | 62/100 [00:07<00:04,  8.28it/s] 63%|██████▎   | 63/100 [00:07<00:04,  8.13it/s] 64%|██████▍   | 64/100 [00:07<00:04,  8.22it/s] 65%|██████▌   | 65/100 [00:07<00:04,  8.12it/s] 66%|██████▌   | 66/100 [00:07<00:04,  7.80it/s] 67%|██████▋   | 67/100 [00:07<00:04,  7.63it/s] 68%|██████▊   | 68/100 [00:08<00:04,  7.57it/s] 69%|██████▉   | 69/100 [00:08<00:03,  7.87it/s] 70%|███████   | 70/100 [00:08<00:03,  8.07it/s] 71%|███████   | 71/100 [00:08<00:03,  8.08it/s] 72%|███████▏  | 72/100 [00:08<00:03,  7.78it/s] 73%|███████▎  | 73/100 [00:08<00:03,  7.76it/s] 74%|███████▍  | 74/100 [00:08<00:03,  7.88it/s] 75%|███████▌  | 75/100 [00:08<00:03,  7.77it/s] 76%|███████▌  | 76/100 [00:09<00:03,  7.91it/s] 77%|███████▋  | 77/100 [00:09<00:02,  8.11it/s] 78%|███████▊  | 78/100 [00:09<00:02,  8.18it/s] 79%|███████▉  | 79/100 [00:09<00:02,  8.34it/s] 80%|████████  | 80/100 [00:09<00:02,  8.07it/s] 81%|████████  | 81/100 [00:09<00:02,  8.02it/s] 82%|████████▏ | 82/100 [00:09<00:02,  8.07it/s] 83%|████████▎ | 83/100 [00:09<00:02,  7.91it/s] 84%|████████▍ | 84/100 [00:10<00:02,  7.98it/s] 85%|████████▌ | 85/100 [00:10<00:01,  7.65it/s] 86%|████████▌ | 86/100 [00:10<00:01,  8.13it/s] 87%|████████▋ | 87/100 [00:10<00:01,  8.14it/s] 88%|████████▊ | 88/100 [00:10<00:01,  7.97it/s] 89%|████████▉ | 89/100 [00:10<00:01,  7.99it/s] 90%|█████████ | 90/100 [00:10<00:01,  8.03it/s] 91%|█████████ | 91/100 [00:10<00:01,  8.19it/s] 92%|█████████▏| 92/100 [00:11<00:01,  7.80it/s] 93%|█████████▎| 93/100 [00:11<00:00,  7.61it/s] 94%|█████████▍| 94/100 [00:11<00:00,  7.53it/s] 95%|█████████▌| 95/100 [00:11<00:00,  7.81it/s] 96%|█████████▌| 96/100 [00:11<00:00,  7.93it/s] 97%|█████████▋| 97/100 [00:11<00:00,  7.66it/s] 98%|█████████▊| 98/100 [00:11<00:00,  7.19it/s] 99%|█████████▉| 99/100 [00:12<00:00,  7.39it/s]100%|██████████| 100/100 [00:12<00:00,  7.60it/s]100%|██████████| 100/100 [00:12<00:00,  8.21it/s]
eval_p_index len:  17
individual_train 115
individual_eval 17
train data의 x, y, id 길이: 115 115 115
valid data의 x, y, id 길이: 8 8 8
test data의 x, y, id 길이: 9 9 9
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.747369, Valid_loss 0.726401
Epoch 2, Train Loss 0.725068, Valid_loss 0.712830
Epoch 3, Train Loss 0.696053, Valid_loss 0.700349
Epoch 4, Train Loss 0.667898, Valid_loss 0.688784
Epoch 5, Train Loss 0.652506, Valid_loss 0.678808
Epoch 6, Train Loss 0.619288, Valid_loss 0.671231
Epoch 7, Train Loss 0.598897, Valid_loss 0.666624
Epoch 8, Train Loss 0.591605, Valid_loss 0.664891
Epoch 9, Train Loss 0.585211, Valid_loss 0.664372
Epoch 10, Train Loss 0.591296, Valid_loss 0.662605
Epoch 11, Train Loss 0.594079, Valid_loss 0.660173
Epoch 12, Train Loss 0.586181, Valid_loss 0.657731
Epoch 13, Train Loss 0.581729, Valid_loss 0.655241
Epoch 14, Train Loss 0.588648, Valid_loss 0.652589
Epoch 15, Train Loss 0.593703, Valid_loss 0.650143
Epoch 16, Train Loss 0.571000, Valid_loss 0.647276
Epoch 17, Train Loss 0.569404, Valid_loss 0.644567
Epoch 18, Train Loss 0.582477, Valid_loss 0.643093
Epoch 19, Train Loss 0.555212, Valid_loss 0.639770
Epoch 20, Train Loss 0.562784, Valid_loss 0.639270
Epoch 21, Train Loss 0.572000, Valid_loss 0.634907
Epoch 22, Train Loss 0.552390, Valid_loss 0.629648
Epoch 23, Train Loss 0.547043, Valid_loss 0.628992
Epoch 24, Train Loss 0.541916, Valid_loss 0.625957
Epoch 25, Train Loss 0.541060, Valid_loss 0.622788
Epoch 26, Train Loss 0.547482, Valid_loss 0.621069
Epoch 27, Train Loss 0.535701, Valid_loss 0.618227
Epoch 28, Train Loss 0.526000, Valid_loss 0.614720
Epoch 29, Train Loss 0.525069, Valid_loss 0.611859
Epoch 30, Train Loss 0.515715, Valid_loss 0.609453
Epoch 31, Train Loss 0.522934, Valid_loss 0.605888
Epoch 32, Train Loss 0.518042, Valid_loss 0.602825
Epoch 33, Train Loss 0.501050, Valid_loss 0.601792
Epoch 34, Train Loss 0.496724, Valid_loss 0.598390
Epoch 35, Train Loss 0.501521, Valid_loss 0.597934
Epoch 36, Train Loss 0.511156, Valid_loss 0.597026
Epoch 37, Train Loss 0.497287, Valid_loss 0.594952
Epoch 38, Train Loss 0.486171, Valid_loss 0.595400
Epoch 39, Train Loss 0.484600, Valid_loss 0.592726
Epoch 40, Train Loss 0.491357, Valid_loss 0.592309
Epoch 41, Train Loss 0.482867, Valid_loss 0.589493
Epoch 42, Train Loss 0.475749, Valid_loss 0.588520
Epoch 43, Train Loss 0.489690, Valid_loss 0.587643
Epoch 44, Train Loss 0.471192, Valid_loss 0.587153
Epoch 45, Train Loss 0.480113, Valid_loss 0.589190
Epoch 46, Train Loss 0.462668, Valid_loss 0.585373
Epoch 47, Train Loss 0.460580, Valid_loss 0.583170
Epoch 48, Train Loss 0.458081, Valid_loss 0.582845
Epoch 49, Train Loss 0.469459, Valid_loss 0.583636
Epoch 50, Train Loss 0.463307, Valid_loss 0.582338
Epoch 51, Train Loss 0.461447, Valid_loss 0.581585
Epoch 52, Train Loss 0.467931, Valid_loss 0.581687
Epoch 53, Train Loss 0.458621, Valid_loss 0.581890
COVID19_Participant26 -- true: COVID-19 -- pred: normal
Control_Participant3 -- true: normal -- pred: normal
COVID19_Participant7 -- true: COVID-19 -- pred: normal
Control_Participant9 -- true: normal -- pred: normal
COVID19_Participant26 -- true: COVID-19 -- pred: COVID-19
Control_Participant12 -- true: normal -- pred: COVID-19
Control_Participant4 -- true: normal -- pred: normal
Control_Participant5 -- true: normal -- pred: normal
COVID19_Participant13 -- true: COVID-19 -- pred: COVID-19
true :  [1, 0, 1, 0, 1, 0, 0, 0, 1]
pred :  [0, 0, 0, 0, 1, 1, 0, 0, 1]
Confusion Matrix: [4 1 2 2]
Best performance: Epoch 51, Loss 0.461447, Test ACC 0.666667, Test AUC 0.650000, Test Recall 0.500000, Test Precision 0.666667
✅ Total valid splits used: 4
🔁 Repeat 2, Fold 4
🔍 Split #5
  → train_p_index 환자 수: 26
  → test_p_index 환자 수: 6
  → train 환자 ID: ['COVID19_Participant11', 'COVID19_Participant14', 'COVID19_Participant15', 'COVID19_Participant17', 'COVID19_Participant19', 'COVID19_Participant2', 'COVID19_Participant20', 'COVID19_Participant22', 'COVID19_Participant23', 'COVID19_Participant25', 'COVID19_Participant26', 'COVID19_Participant28', 'COVID19_Participant31', 'COVID19_Participant32', 'COVID19_Participant37', 'COVID19_Participant4', 'COVID19_Participant7', 'COVID19_Participant8', 'Control_Participant1', 'Control_Participant10', 'Control_Participant3', 'Control_Participant4', 'Control_Participant5', 'Control_Participant7', 'Control_Participant8', 'Control_Participant9']
  → test  환자 ID: ['Control_Participant7', 'Control_Participant5', 'COVID19_Participant26', 'Control_Participant4', 'COVID19_Participant31', 'COVID19_Participant7']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant10, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant4, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant8, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: Control_Participant7, Label: 1
    ID: Control_Participant5, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: Control_Participant4, Label: 1
    ID: COVID19_Participant31, Label: 0
    ID: COVID19_Participant7, Label: 0
train_p_index_ 17
valid_p_index 9
test_p_index 6
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Keratinocytes', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Neurons', 'iPS_cells', 'Embryonic_stem_cells', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
data augment 실행 함
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:10,  9.47it/s]  2%|▏         | 2/100 [00:00<00:10,  9.05it/s]  3%|▎         | 3/100 [00:00<00:10,  9.12it/s]  4%|▍         | 4/100 [00:00<00:10,  9.06it/s]  5%|▌         | 5/100 [00:00<00:10,  8.71it/s]  6%|▌         | 6/100 [00:00<00:10,  8.83it/s]  7%|▋         | 7/100 [00:00<00:10,  8.87it/s]  8%|▊         | 8/100 [00:00<00:10,  9.02it/s]  9%|▉         | 9/100 [00:00<00:09,  9.21it/s] 10%|█         | 10/100 [00:01<00:09,  9.09it/s] 11%|█         | 11/100 [00:01<00:09,  9.20it/s] 12%|█▏        | 12/100 [00:01<00:09,  9.10it/s] 13%|█▎        | 13/100 [00:01<00:10,  8.33it/s] 14%|█▍        | 14/100 [00:01<00:10,  8.55it/s] 15%|█▌        | 15/100 [00:01<00:09,  8.66it/s] 16%|█▌        | 16/100 [00:01<00:09,  8.82it/s] 17%|█▋        | 17/100 [00:01<00:09,  8.74it/s] 18%|█▊        | 18/100 [00:02<00:09,  8.89it/s] 19%|█▉        | 19/100 [00:02<00:09,  8.61it/s] 20%|██        | 20/100 [00:02<00:09,  8.81it/s] 21%|██        | 21/100 [00:02<00:08,  8.90it/s] 22%|██▏       | 22/100 [00:02<00:08,  8.78it/s] 23%|██▎       | 23/100 [00:02<00:08,  8.82it/s] 24%|██▍       | 24/100 [00:02<00:09,  8.36it/s] 25%|██▌       | 25/100 [00:02<00:08,  8.37it/s] 26%|██▌       | 26/100 [00:02<00:08,  8.39it/s] 27%|██▋       | 27/100 [00:03<00:08,  8.47it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.44it/s] 29%|██▉       | 29/100 [00:03<00:08,  8.59it/s] 30%|███       | 30/100 [00:03<00:08,  8.62it/s] 31%|███       | 31/100 [00:03<00:08,  8.62it/s] 32%|███▏      | 32/100 [00:03<00:08,  8.44it/s] 33%|███▎      | 33/100 [00:03<00:08,  8.32it/s] 34%|███▍      | 34/100 [00:03<00:07,  8.50it/s] 35%|███▌      | 35/100 [00:04<00:07,  8.13it/s] 36%|███▌      | 36/100 [00:04<00:07,  8.41it/s] 37%|███▋      | 37/100 [00:04<00:07,  8.43it/s] 38%|███▊      | 38/100 [00:04<00:07,  8.41it/s] 39%|███▉      | 39/100 [00:04<00:07,  8.68it/s] 40%|████      | 40/100 [00:04<00:07,  8.52it/s] 41%|████      | 41/100 [00:04<00:06,  8.51it/s] 42%|████▏     | 42/100 [00:04<00:09,  6.33it/s] 43%|████▎     | 43/100 [00:05<00:08,  6.37it/s] 44%|████▍     | 44/100 [00:05<00:08,  6.52it/s] 45%|████▌     | 45/100 [00:05<00:07,  7.04it/s] 46%|████▌     | 46/100 [00:05<00:07,  7.31it/s] 47%|████▋     | 47/100 [00:05<00:06,  7.60it/s] 48%|████▊     | 48/100 [00:05<00:06,  7.88it/s] 49%|████▉     | 49/100 [00:05<00:06,  8.02it/s] 50%|█████     | 50/100 [00:06<00:06,  8.07it/s] 51%|█████     | 51/100 [00:06<00:06,  8.13it/s] 52%|█████▏    | 52/100 [00:06<00:05,  8.26it/s] 53%|█████▎    | 53/100 [00:06<00:05,  8.27it/s] 54%|█████▍    | 54/100 [00:06<00:05,  8.14it/s] 55%|█████▌    | 55/100 [00:06<00:05,  8.27it/s] 56%|█████▌    | 56/100 [00:06<00:05,  8.12it/s] 57%|█████▋    | 57/100 [00:06<00:05,  8.15it/s] 58%|█████▊    | 58/100 [00:06<00:05,  8.12it/s] 59%|█████▉    | 59/100 [00:07<00:04,  8.27it/s] 60%|██████    | 60/100 [00:07<00:05,  7.51it/s] 61%|██████    | 61/100 [00:07<00:05,  7.75it/s] 62%|██████▏   | 62/100 [00:07<00:04,  7.68it/s] 63%|██████▎   | 63/100 [00:07<00:04,  7.82it/s] 64%|██████▍   | 64/100 [00:07<00:04,  7.93it/s] 65%|██████▌   | 65/100 [00:07<00:04,  8.08it/s] 66%|██████▌   | 66/100 [00:08<00:04,  7.68it/s] 67%|██████▋   | 67/100 [00:08<00:04,  7.80it/s] 68%|██████▊   | 68/100 [00:08<00:04,  7.87it/s] 69%|██████▉   | 69/100 [00:08<00:03,  7.93it/s] 70%|███████   | 70/100 [00:08<00:03,  7.83it/s] 71%|███████   | 71/100 [00:08<00:03,  7.64it/s] 72%|███████▏  | 72/100 [00:08<00:03,  7.69it/s] 73%|███████▎  | 73/100 [00:08<00:03,  7.83it/s] 74%|███████▍  | 74/100 [00:09<00:03,  7.98it/s] 75%|███████▌  | 75/100 [00:09<00:03,  7.96it/s] 76%|███████▌  | 76/100 [00:09<00:02,  8.04it/s] 77%|███████▋  | 77/100 [00:09<00:02,  8.22it/s] 78%|███████▊  | 78/100 [00:09<00:02,  8.04it/s] 79%|███████▉  | 79/100 [00:09<00:02,  7.77it/s] 80%|████████  | 80/100 [00:09<00:02,  7.80it/s] 81%|████████  | 81/100 [00:09<00:02,  8.00it/s] 82%|████████▏ | 82/100 [00:10<00:02,  8.19it/s] 83%|████████▎ | 83/100 [00:10<00:02,  8.27it/s] 84%|████████▍ | 84/100 [00:10<00:02,  7.86it/s] 85%|████████▌ | 85/100 [00:10<00:01,  7.90it/s] 86%|████████▌ | 86/100 [00:10<00:01,  8.00it/s] 87%|████████▋ | 87/100 [00:10<00:01,  7.94it/s] 88%|████████▊ | 88/100 [00:10<00:01,  8.17it/s] 89%|████████▉ | 89/100 [00:10<00:01,  7.83it/s] 90%|█████████ | 90/100 [00:11<00:01,  7.83it/s] 91%|█████████ | 91/100 [00:11<00:01,  8.09it/s] 92%|█████████▏| 92/100 [00:11<00:01,  7.84it/s] 93%|█████████▎| 93/100 [00:11<00:00,  7.02it/s] 94%|█████████▍| 94/100 [00:11<00:00,  7.15it/s] 95%|█████████▌| 95/100 [00:11<00:00,  7.44it/s] 96%|█████████▌| 96/100 [00:11<00:00,  7.58it/s] 97%|█████████▋| 97/100 [00:11<00:00,  7.62it/s] 98%|█████████▊| 98/100 [00:12<00:00,  7.69it/s] 99%|█████████▉| 99/100 [00:12<00:00,  6.80it/s]100%|██████████| 100/100 [00:12<00:00,  7.08it/s]100%|██████████| 100/100 [00:12<00:00,  8.05it/s]
eval_p_index len:  15
individual_train 117
individual_eval 15
train data의 x, y, id 길이: 117 117 117
valid data의 x, y, id 길이: 9 9 9
test data의 x, y, id 길이: 6 6 6
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.683488, Valid_loss 0.688241
Epoch 2, Train Loss 0.608093, Valid_loss 0.717777
Epoch 3, Train Loss 0.560388, Valid_loss 0.744848
Epoch 4, Train Loss 0.535204, Valid_loss 0.759548
Epoch 5, Train Loss 0.526098, Valid_loss 0.765876
Epoch 6, Train Loss 0.512950, Valid_loss 0.762709
Epoch 7, Train Loss 0.513892, Valid_loss 0.754452
Epoch 8, Train Loss 0.520553, Valid_loss 0.737819
Epoch 9, Train Loss 0.498901, Valid_loss 0.714795
Epoch 10, Train Loss 0.478836, Valid_loss 0.685110
Epoch 11, Train Loss 0.476227, Valid_loss 0.664256
Epoch 12, Train Loss 0.458723, Valid_loss 0.640969
Epoch 13, Train Loss 0.457985, Valid_loss 0.637477
Epoch 14, Train Loss 0.433570, Valid_loss 0.648269
Epoch 15, Train Loss 0.427500, Valid_loss 0.632650
Epoch 16, Train Loss 0.415271, Valid_loss 0.644853
Epoch 17, Train Loss 0.409125, Valid_loss 0.643721
Epoch 18, Train Loss 0.420889, Valid_loss 0.644138
Epoch 19, Train Loss 0.410127, Valid_loss 0.639951
Epoch 20, Train Loss 0.413482, Valid_loss 0.640025
Epoch 21, Train Loss 0.411257, Valid_loss 0.640415
Epoch 22, Train Loss 0.405229, Valid_loss 0.628354
Epoch 23, Train Loss 0.399859, Valid_loss 0.640494
Epoch 24, Train Loss 0.401791, Valid_loss 0.655782
Epoch 25, Train Loss 0.404010, Valid_loss 0.662033
Epoch 26, Train Loss 0.393773, Valid_loss 0.671529
Epoch 27, Train Loss 0.377390, Valid_loss 0.678440
Epoch 28, Train Loss 0.381197, Valid_loss 0.684310
Epoch 29, Train Loss 0.376404, Valid_loss 0.686465
Epoch 30, Train Loss 0.395326, Valid_loss 0.694010
Epoch 31, Train Loss 0.369859, Valid_loss 0.699865
Epoch 32, Train Loss 0.377765, Valid_loss 0.693649
Epoch 33, Train Loss 0.361723, Valid_loss 0.696915
Epoch 34, Train Loss 0.372560, Valid_loss 0.699838
Epoch 35, Train Loss 0.372639, Valid_loss 0.696027
Epoch 36, Train Loss 0.366677, Valid_loss 0.696023
Epoch 37, Train Loss 0.372270, Valid_loss 0.701073
Epoch 38, Train Loss 0.360218, Valid_loss 0.688984
Epoch 39, Train Loss 0.374341, Valid_loss 0.703699
Epoch 40, Train Loss 0.364359, Valid_loss 0.700393
Epoch 41, Train Loss 0.363181, Valid_loss 0.681609
Epoch 42, Train Loss 0.358568, Valid_loss 0.689251
Epoch 43, Train Loss 0.358071, Valid_loss 0.688266
Epoch 44, Train Loss 0.350811, Valid_loss 0.693294
Epoch 45, Train Loss 0.345934, Valid_loss 0.681780
Epoch 46, Train Loss 0.351381, Valid_loss 0.689404
Epoch 47, Train Loss 0.339878, Valid_loss 0.688041
Epoch 48, Train Loss 0.354544, Valid_loss 0.683093
Epoch 49, Train Loss 0.339055, Valid_loss 0.681954
Epoch 50, Train Loss 0.344938, Valid_loss 0.688452
Epoch 51, Train Loss 0.344287, Valid_loss 0.684394
Epoch 52, Train Loss 0.339409, Valid_loss 0.685793
Epoch 53, Train Loss 0.346559, Valid_loss 0.679148
Epoch 54, Train Loss 0.340242, Valid_loss 0.679172
Epoch 55, Train Loss 0.337160, Valid_loss 0.678234
Epoch 56, Train Loss 0.332405, Valid_loss 0.679710
Epoch 57, Train Loss 0.341367, Valid_loss 0.678015
Epoch 58, Train Loss 0.349740, Valid_loss 0.676023
Epoch 59, Train Loss 0.345647, Valid_loss 0.674239
Epoch 60, Train Loss 0.341910, Valid_loss 0.671674
Epoch 61, Train Loss 0.343505, Valid_loss 0.672883
Epoch 62, Train Loss 0.347195, Valid_loss 0.677119
Control_Participant7 -- true: normal -- pred: normal
Control_Participant5 -- true: normal -- pred: normal
COVID19_Participant26 -- true: COVID-19 -- pred: normal
Control_Participant4 -- true: normal -- pred: normal
COVID19_Participant31 -- true: COVID-19 -- pred: COVID-19
COVID19_Participant7 -- true: COVID-19 -- pred: normal
true :  [0, 0, 1, 0, 1, 1]
pred :  [0, 0, 0, 0, 1, 0]
Confusion Matrix: [3 0 2 1]
Best performance: Epoch 22, Loss 0.405229, Test ACC 0.666667, Test AUC 0.444444, Test Recall 0.333333, Test Precision 1.000000
✅ Total valid splits used: 5

📌 Repeat 2: 평균 AUC = 0.7689, 표준편차 = 0.2129
🔁 Repeat 3, Fold 0
🔍 Split #1
  → train_p_index 환자 수: 24
  → test_p_index 환자 수: 8
  → train 환자 ID: ['COVID19_Participant13', 'COVID19_Participant14', 'COVID19_Participant15', 'COVID19_Participant2', 'COVID19_Participant20', 'COVID19_Participant22', 'COVID19_Participant23', 'COVID19_Participant26', 'COVID19_Participant28', 'COVID19_Participant29', 'COVID19_Participant32', 'COVID19_Participant37', 'COVID19_Participant39', 'COVID19_Participant4', 'COVID19_Participant7', 'COVID19_Participant8', 'Control_Participant10', 'Control_Participant11', 'Control_Participant15', 'Control_Participant3', 'Control_Participant5', 'Control_Participant7', 'Control_Participant8', 'Control_Participant9']
  → test  환자 ID: ['COVID19_Participant13', 'Control_Participant5', 'COVID19_Participant26', 'COVID19_Participant13', 'Control_Participant7', 'Control_Participant3', 'COVID19_Participant26', 'Control_Participant7']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: Control_Participant10, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant8, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: COVID19_Participant13, Label: 1
    ID: Control_Participant5, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: Control_Participant7, Label: 1
    ID: Control_Participant3, Label: 1
    ID: COVID19_Participant26, Label: 0
    ID: Control_Participant7, Label: 0
train_p_index_ 16
valid_p_index 8
test_p_index 8
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Keratinocytes', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Neurons', 'iPS_cells', 'Embryonic_stem_cells', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
data augment 실행 함
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:10,  9.21it/s]  2%|▏         | 2/100 [00:00<00:10,  9.47it/s]  3%|▎         | 3/100 [00:00<00:10,  9.06it/s]  4%|▍         | 4/100 [00:00<00:10,  8.90it/s]  5%|▌         | 5/100 [00:00<00:10,  9.10it/s]  6%|▌         | 6/100 [00:00<00:10,  9.03it/s]  7%|▋         | 7/100 [00:00<00:10,  9.14it/s]  8%|▊         | 8/100 [00:00<00:10,  9.16it/s]  9%|▉         | 9/100 [00:00<00:09,  9.38it/s] 10%|█         | 10/100 [00:01<00:09,  9.24it/s] 11%|█         | 11/100 [00:01<00:09,  9.14it/s] 12%|█▏        | 12/100 [00:01<00:09,  9.19it/s] 13%|█▎        | 13/100 [00:01<00:09,  9.36it/s] 14%|█▍        | 14/100 [00:01<00:09,  9.41it/s] 15%|█▌        | 15/100 [00:01<00:09,  8.62it/s] 16%|█▌        | 16/100 [00:01<00:09,  8.89it/s] 17%|█▋        | 17/100 [00:01<00:09,  8.76it/s] 18%|█▊        | 18/100 [00:01<00:09,  8.74it/s] 19%|█▉        | 19/100 [00:02<00:09,  8.73it/s] 20%|██        | 20/100 [00:02<00:09,  8.66it/s] 21%|██        | 21/100 [00:02<00:09,  8.60it/s] 22%|██▏       | 22/100 [00:02<00:08,  8.76it/s] 23%|██▎       | 23/100 [00:02<00:08,  8.76it/s] 24%|██▍       | 24/100 [00:02<00:08,  8.70it/s] 25%|██▌       | 25/100 [00:02<00:08,  8.44it/s] 26%|██▌       | 26/100 [00:02<00:08,  8.61it/s] 27%|██▋       | 27/100 [00:03<00:08,  8.40it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.53it/s] 29%|██▉       | 29/100 [00:03<00:08,  8.53it/s] 30%|███       | 30/100 [00:03<00:08,  8.49it/s] 31%|███       | 31/100 [00:03<00:08,  8.49it/s] 32%|███▏      | 32/100 [00:03<00:08,  8.44it/s] 33%|███▎      | 33/100 [00:03<00:07,  8.39it/s] 34%|███▍      | 34/100 [00:03<00:07,  8.50it/s] 35%|███▌      | 35/100 [00:03<00:07,  8.40it/s] 36%|███▌      | 36/100 [00:04<00:07,  8.11it/s] 37%|███▋      | 37/100 [00:04<00:07,  8.37it/s] 38%|███▊      | 38/100 [00:04<00:07,  8.42it/s] 39%|███▉      | 39/100 [00:04<00:07,  8.30it/s] 40%|████      | 40/100 [00:04<00:07,  8.16it/s] 41%|████      | 41/100 [00:04<00:07,  8.36it/s] 42%|████▏     | 42/100 [00:04<00:06,  8.32it/s] 43%|████▎     | 43/100 [00:04<00:06,  8.30it/s] 44%|████▍     | 44/100 [00:05<00:06,  8.50it/s] 45%|████▌     | 45/100 [00:05<00:06,  8.37it/s] 46%|████▌     | 46/100 [00:05<00:06,  8.32it/s] 47%|████▋     | 47/100 [00:05<00:06,  8.37it/s] 48%|████▊     | 48/100 [00:05<00:06,  8.50it/s] 49%|████▉     | 49/100 [00:05<00:06,  8.36it/s] 50%|█████     | 50/100 [00:05<00:05,  8.42it/s] 51%|█████     | 51/100 [00:05<00:05,  8.45it/s] 52%|█████▏    | 52/100 [00:06<00:05,  8.42it/s] 53%|█████▎    | 53/100 [00:06<00:05,  8.26it/s] 54%|█████▍    | 54/100 [00:06<00:05,  8.27it/s] 55%|█████▌    | 55/100 [00:06<00:05,  8.26it/s] 56%|█████▌    | 56/100 [00:06<00:05,  8.31it/s] 57%|█████▋    | 57/100 [00:06<00:05,  8.20it/s] 58%|█████▊    | 58/100 [00:06<00:05,  8.14it/s] 59%|█████▉    | 59/100 [00:06<00:04,  8.25it/s] 60%|██████    | 60/100 [00:06<00:04,  8.31it/s] 61%|██████    | 61/100 [00:07<00:05,  7.73it/s] 62%|██████▏   | 62/100 [00:07<00:04,  7.89it/s] 63%|██████▎   | 63/100 [00:07<00:04,  7.82it/s] 64%|██████▍   | 64/100 [00:07<00:04,  7.83it/s] 65%|██████▌   | 65/100 [00:07<00:04,  7.77it/s] 66%|██████▌   | 66/100 [00:07<00:04,  7.84it/s] 67%|██████▋   | 67/100 [00:07<00:04,  8.05it/s] 68%|██████▊   | 68/100 [00:08<00:04,  7.91it/s] 69%|██████▉   | 69/100 [00:08<00:03,  8.06it/s] 70%|███████   | 70/100 [00:08<00:03,  7.91it/s] 71%|███████   | 71/100 [00:08<00:03,  7.84it/s] 72%|███████▏  | 72/100 [00:08<00:03,  7.75it/s] 73%|███████▎  | 73/100 [00:08<00:03,  7.61it/s] 74%|███████▍  | 74/100 [00:08<00:03,  7.65it/s] 75%|███████▌  | 75/100 [00:08<00:03,  7.78it/s] 76%|███████▌  | 76/100 [00:09<00:03,  7.61it/s] 77%|███████▋  | 77/100 [00:09<00:02,  7.68it/s] 78%|███████▊  | 78/100 [00:09<00:02,  7.82it/s] 79%|███████▉  | 79/100 [00:09<00:02,  7.85it/s] 80%|████████  | 80/100 [00:09<00:02,  7.99it/s] 81%|████████  | 81/100 [00:09<00:02,  8.08it/s] 82%|████████▏ | 82/100 [00:09<00:02,  8.32it/s] 83%|████████▎ | 83/100 [00:09<00:02,  8.29it/s] 84%|████████▍ | 84/100 [00:10<00:02,  7.95it/s] 85%|████████▌ | 85/100 [00:10<00:01,  7.91it/s] 86%|████████▌ | 86/100 [00:10<00:01,  7.88it/s] 87%|████████▋ | 87/100 [00:10<00:01,  7.73it/s] 88%|████████▊ | 88/100 [00:10<00:01,  7.71it/s] 89%|████████▉ | 89/100 [00:10<00:01,  7.67it/s] 90%|█████████ | 90/100 [00:10<00:01,  7.56it/s] 91%|█████████ | 91/100 [00:10<00:01,  7.65it/s] 92%|█████████▏| 92/100 [00:11<00:01,  7.63it/s] 93%|█████████▎| 93/100 [00:11<00:00,  7.81it/s] 94%|█████████▍| 94/100 [00:11<00:00,  7.87it/s] 95%|█████████▌| 95/100 [00:11<00:00,  7.80it/s] 96%|█████████▌| 96/100 [00:11<00:00,  8.07it/s] 97%|█████████▋| 97/100 [00:11<00:00,  8.15it/s] 98%|█████████▊| 98/100 [00:11<00:00,  8.09it/s] 99%|█████████▉| 99/100 [00:11<00:00,  7.94it/s]100%|██████████| 100/100 [00:12<00:00,  7.90it/s]100%|██████████| 100/100 [00:12<00:00,  8.26it/s]
eval_p_index len:  16
individual_train 116
individual_eval 16
train data의 x, y, id 길이: 116 116 116
valid data의 x, y, id 길이: 8 8 8
test data의 x, y, id 길이: 8 8 8
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.841352, Valid_loss 0.712257
Epoch 2, Train Loss 0.807054, Valid_loss 0.695193
Epoch 3, Train Loss 0.767788, Valid_loss 0.683061
Epoch 4, Train Loss 0.735416, Valid_loss 0.673053
Epoch 5, Train Loss 0.698924, Valid_loss 0.664752
Epoch 6, Train Loss 0.668347, Valid_loss 0.659603
Epoch 7, Train Loss 0.647158, Valid_loss 0.666302
Epoch 8, Train Loss 0.639412, Valid_loss 0.666107
Epoch 9, Train Loss 0.635284, Valid_loss 0.661665
Epoch 10, Train Loss 0.624240, Valid_loss 0.655026
Epoch 11, Train Loss 0.629191, Valid_loss 0.650407
Epoch 12, Train Loss 0.617641, Valid_loss 0.643782
Epoch 13, Train Loss 0.614697, Valid_loss 0.635192
Epoch 14, Train Loss 0.611136, Valid_loss 0.621551
Epoch 15, Train Loss 0.601427, Valid_loss 0.606775
Epoch 16, Train Loss 0.596388, Valid_loss 0.596623
Epoch 17, Train Loss 0.590945, Valid_loss 0.588002
Epoch 18, Train Loss 0.581697, Valid_loss 0.581015
Epoch 19, Train Loss 0.584858, Valid_loss 0.576267
Epoch 20, Train Loss 0.578753, Valid_loss 0.574889
Epoch 21, Train Loss 0.574961, Valid_loss 0.574660
Epoch 22, Train Loss 0.550619, Valid_loss 0.570042
Epoch 23, Train Loss 0.533165, Valid_loss 0.566215
Epoch 24, Train Loss 0.506529, Valid_loss 0.542294
Epoch 25, Train Loss 0.479798, Valid_loss 0.524292
Epoch 26, Train Loss 0.471775, Valid_loss 0.517515
Epoch 27, Train Loss 0.463529, Valid_loss 0.517000
Epoch 28, Train Loss 0.459995, Valid_loss 0.509071
Epoch 29, Train Loss 0.457750, Valid_loss 0.496684
Epoch 30, Train Loss 0.443361, Valid_loss 0.489407
Epoch 31, Train Loss 0.443068, Valid_loss 0.485573
Epoch 32, Train Loss 0.428906, Valid_loss 0.482110
Epoch 33, Train Loss 0.435716, Valid_loss 0.481066
Epoch 34, Train Loss 0.428562, Valid_loss 0.478909
Epoch 35, Train Loss 0.422100, Valid_loss 0.477873
Epoch 36, Train Loss 0.425001, Valid_loss 0.476940
Epoch 37, Train Loss 0.419184, Valid_loss 0.475441
Epoch 38, Train Loss 0.421619, Valid_loss 0.474332
Epoch 39, Train Loss 0.416747, Valid_loss 0.473256
Epoch 40, Train Loss 0.422496, Valid_loss 0.472257
Epoch 41, Train Loss 0.411601, Valid_loss 0.471367
Epoch 42, Train Loss 0.411810, Valid_loss 0.470179
Epoch 43, Train Loss 0.407628, Valid_loss 0.468217
Epoch 44, Train Loss 0.415128, Valid_loss 0.467362
Epoch 45, Train Loss 0.408316, Valid_loss 0.466594
Epoch 46, Train Loss 0.403122, Valid_loss 0.466425
Epoch 47, Train Loss 0.409259, Valid_loss 0.466562
Epoch 48, Train Loss 0.400279, Valid_loss 0.465656
Epoch 49, Train Loss 0.414413, Valid_loss 0.465063
Epoch 50, Train Loss 0.404283, Valid_loss 0.464211
Epoch 51, Train Loss 0.396935, Valid_loss 0.463820
Epoch 52, Train Loss 0.407739, Valid_loss 0.463480
Epoch 53, Train Loss 0.394635, Valid_loss 0.463181
Epoch 54, Train Loss 0.402185, Valid_loss 0.462917
Epoch 55, Train Loss 0.395399, Valid_loss 0.462500
Epoch 56, Train Loss 0.392081, Valid_loss 0.462381
Epoch 57, Train Loss 0.392211, Valid_loss 0.462293
Epoch 58, Train Loss 0.392462, Valid_loss 0.461895
Epoch 59, Train Loss 0.397842, Valid_loss 0.462111
Epoch 60, Train Loss 0.390313, Valid_loss 0.461214
Epoch 61, Train Loss 0.398066, Valid_loss 0.460814
Epoch 62, Train Loss 0.410719, Valid_loss 0.460557
Epoch 63, Train Loss 0.406466, Valid_loss 0.460935
Epoch 64, Train Loss 0.384321, Valid_loss 0.461329
COVID19_Participant13 -- true: COVID-19 -- pred: COVID-19
Control_Participant5 -- true: normal -- pred: normal
COVID19_Participant26 -- true: COVID-19 -- pred: COVID-19
COVID19_Participant13 -- true: COVID-19 -- pred: COVID-19
Control_Participant7 -- true: normal -- pred: normal
Control_Participant3 -- true: normal -- pred: normal
COVID19_Participant26 -- true: COVID-19 -- pred: COVID-19
Control_Participant7 -- true: normal -- pred: normal
true :  [1, 0, 1, 1, 0, 0, 1, 0]
pred :  [1, 0, 1, 1, 0, 0, 1, 0]
Confusion Matrix: [4 0 0 4]
Best performance: Epoch 62, Loss 0.410719, Test ACC 1.000000, Test AUC 1.000000, Test Recall 1.000000, Test Precision 1.000000
✅ Total valid splits used: 1
🔁 Repeat 3, Fold 1
🔍 Split #2
  → train_p_index 환자 수: 28
  → test_p_index 환자 수: 4
  → train 환자 ID: ['COVID19_Participant11', 'COVID19_Participant13', 'COVID19_Participant14', 'COVID19_Participant17', 'COVID19_Participant19', 'COVID19_Participant2', 'COVID19_Participant20', 'COVID19_Participant22', 'COVID19_Participant23', 'COVID19_Participant25', 'COVID19_Participant26', 'COVID19_Participant28', 'COVID19_Participant29', 'COVID19_Participant31', 'COVID19_Participant32', 'COVID19_Participant37', 'COVID19_Participant4', 'COVID19_Participant40', 'COVID19_Participant8', 'Control_Participant1', 'Control_Participant11', 'Control_Participant15', 'Control_Participant3', 'Control_Participant4', 'Control_Participant5', 'Control_Participant7', 'Control_Participant8', 'Control_Participant9']
  → test  환자 ID: ['COVID19_Participant26', 'COVID19_Participant26', 'Control_Participant7', 'Control_Participant7']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant4, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant8, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: Control_Participant7, Label: 1
    ID: Control_Participant7, Label: 0
train_p_index_ 18
valid_p_index 10
test_p_index 4
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Keratinocytes', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Neurons', 'iPS_cells', 'Embryonic_stem_cells', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
data augment 실행 함
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:11,  8.53it/s]  2%|▏         | 2/100 [00:00<00:11,  8.56it/s]  3%|▎         | 3/100 [00:00<00:10,  8.98it/s]  4%|▍         | 4/100 [00:00<00:10,  8.90it/s]  5%|▌         | 5/100 [00:00<00:10,  8.92it/s]  6%|▌         | 6/100 [00:00<00:10,  8.90it/s]  8%|▊         | 8/100 [00:00<00:09,  9.57it/s]  9%|▉         | 9/100 [00:00<00:09,  9.23it/s] 10%|█         | 10/100 [00:01<00:10,  8.93it/s] 11%|█         | 11/100 [00:01<00:09,  9.10it/s] 12%|█▏        | 12/100 [00:01<00:09,  8.89it/s] 13%|█▎        | 13/100 [00:01<00:09,  8.78it/s] 14%|█▍        | 14/100 [00:01<00:09,  8.71it/s] 15%|█▌        | 15/100 [00:01<00:09,  8.87it/s] 16%|█▌        | 16/100 [00:01<00:09,  8.66it/s] 17%|█▋        | 17/100 [00:01<00:09,  8.59it/s] 18%|█▊        | 18/100 [00:02<00:09,  8.56it/s] 19%|█▉        | 19/100 [00:02<00:09,  8.30it/s] 20%|██        | 20/100 [00:02<00:09,  8.37it/s] 21%|██        | 21/100 [00:02<00:09,  8.59it/s] 22%|██▏       | 22/100 [00:02<00:09,  8.64it/s] 23%|██▎       | 23/100 [00:02<00:08,  8.64it/s] 24%|██▍       | 24/100 [00:02<00:09,  8.05it/s] 25%|██▌       | 25/100 [00:02<00:09,  8.07it/s] 26%|██▌       | 26/100 [00:03<00:09,  8.07it/s] 27%|██▋       | 27/100 [00:03<00:08,  8.17it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.42it/s] 29%|██▉       | 29/100 [00:03<00:08,  8.23it/s] 30%|███       | 30/100 [00:03<00:08,  8.38it/s] 31%|███       | 31/100 [00:03<00:08,  8.18it/s] 32%|███▏      | 32/100 [00:03<00:08,  8.42it/s] 33%|███▎      | 33/100 [00:03<00:08,  8.19it/s] 34%|███▍      | 34/100 [00:03<00:08,  8.02it/s] 35%|███▌      | 35/100 [00:04<00:08,  8.07it/s] 36%|███▌      | 36/100 [00:04<00:07,  8.26it/s] 37%|███▋      | 37/100 [00:04<00:07,  7.94it/s] 38%|███▊      | 38/100 [00:04<00:07,  8.05it/s] 39%|███▉      | 39/100 [00:04<00:07,  8.09it/s] 40%|████      | 40/100 [00:04<00:07,  8.11it/s] 41%|████      | 41/100 [00:04<00:07,  8.20it/s] 42%|████▏     | 42/100 [00:04<00:07,  8.10it/s] 43%|████▎     | 43/100 [00:05<00:07,  8.13it/s] 44%|████▍     | 44/100 [00:05<00:06,  8.14it/s] 45%|████▌     | 45/100 [00:05<00:06,  7.91it/s] 46%|████▌     | 46/100 [00:05<00:06,  8.09it/s] 47%|████▋     | 47/100 [00:05<00:06,  7.99it/s] 48%|████▊     | 48/100 [00:05<00:06,  7.57it/s] 49%|████▉     | 49/100 [00:05<00:06,  7.79it/s] 50%|█████     | 50/100 [00:05<00:06,  7.79it/s] 51%|█████     | 51/100 [00:06<00:06,  8.07it/s] 52%|█████▏    | 52/100 [00:06<00:05,  8.19it/s] 53%|█████▎    | 53/100 [00:06<00:05,  8.31it/s] 54%|█████▍    | 54/100 [00:06<00:05,  8.25it/s] 55%|█████▌    | 55/100 [00:06<00:05,  8.34it/s] 56%|█████▌    | 56/100 [00:06<00:05,  8.40it/s] 57%|█████▋    | 57/100 [00:06<00:05,  8.59it/s] 58%|█████▊    | 58/100 [00:06<00:05,  8.32it/s] 59%|█████▉    | 59/100 [00:07<00:05,  7.74it/s] 60%|██████    | 60/100 [00:07<00:05,  7.98it/s] 61%|██████    | 61/100 [00:07<00:04,  8.07it/s] 62%|██████▏   | 62/100 [00:07<00:04,  8.30it/s] 63%|██████▎   | 63/100 [00:07<00:04,  8.30it/s] 64%|██████▍   | 64/100 [00:07<00:04,  8.27it/s] 65%|██████▌   | 65/100 [00:07<00:04,  8.21it/s] 66%|██████▌   | 66/100 [00:07<00:04,  7.90it/s] 67%|██████▋   | 67/100 [00:08<00:04,  7.83it/s] 68%|██████▊   | 68/100 [00:08<00:04,  7.62it/s] 69%|██████▉   | 69/100 [00:08<00:04,  6.84it/s] 70%|███████   | 70/100 [00:08<00:04,  6.93it/s] 71%|███████   | 71/100 [00:08<00:03,  7.41it/s] 72%|███████▏  | 72/100 [00:08<00:03,  7.59it/s] 73%|███████▎  | 73/100 [00:08<00:04,  6.60it/s] 74%|███████▍  | 74/100 [00:09<00:03,  6.85it/s] 75%|███████▌  | 75/100 [00:09<00:03,  7.18it/s] 76%|███████▌  | 76/100 [00:09<00:03,  7.37it/s] 77%|███████▋  | 77/100 [00:09<00:03,  7.44it/s] 78%|███████▊  | 78/100 [00:09<00:02,  7.35it/s] 79%|███████▉  | 79/100 [00:09<00:02,  7.38it/s] 80%|████████  | 80/100 [00:09<00:02,  7.53it/s] 81%|████████  | 81/100 [00:10<00:02,  7.65it/s] 82%|████████▏ | 82/100 [00:10<00:02,  7.52it/s] 83%|████████▎ | 83/100 [00:10<00:02,  7.53it/s] 84%|████████▍ | 84/100 [00:10<00:02,  7.19it/s] 85%|████████▌ | 85/100 [00:10<00:02,  7.29it/s] 86%|████████▌ | 86/100 [00:10<00:01,  7.55it/s] 87%|████████▋ | 87/100 [00:10<00:01,  7.48it/s] 88%|████████▊ | 88/100 [00:10<00:01,  7.51it/s] 89%|████████▉ | 89/100 [00:11<00:01,  7.69it/s] 90%|█████████ | 90/100 [00:11<00:01,  7.21it/s] 91%|█████████ | 91/100 [00:11<00:01,  7.39it/s] 92%|█████████▏| 92/100 [00:11<00:01,  7.41it/s] 93%|█████████▎| 93/100 [00:11<00:00,  7.26it/s] 94%|█████████▍| 94/100 [00:11<00:00,  7.20it/s] 95%|█████████▌| 95/100 [00:11<00:00,  7.10it/s] 96%|█████████▌| 96/100 [00:12<00:00,  7.14it/s] 97%|█████████▋| 97/100 [00:12<00:00,  6.72it/s] 98%|█████████▊| 98/100 [00:12<00:00,  6.91it/s] 99%|█████████▉| 99/100 [00:12<00:00,  5.94it/s]100%|██████████| 100/100 [00:12<00:00,  6.30it/s]100%|██████████| 100/100 [00:12<00:00,  7.86it/s]
eval_p_index len:  14
individual_train 118
individual_eval 14
train data의 x, y, id 길이: 118 118 118
valid data의 x, y, id 길이: 10 10 10
test data의 x, y, id 길이: 4 4 4
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.632545, Valid_loss 0.711575
Epoch 2, Train Loss 0.619594, Valid_loss 0.714433
Epoch 3, Train Loss 0.597253, Valid_loss 0.716579
Epoch 4, Train Loss 0.599049, Valid_loss 0.718204
Epoch 5, Train Loss 0.593491, Valid_loss 0.719547
Epoch 6, Train Loss 0.581805, Valid_loss 0.720470
Epoch 7, Train Loss 0.584795, Valid_loss 0.721086
Epoch 8, Train Loss 0.574401, Valid_loss 0.721056
Epoch 9, Train Loss 0.568140, Valid_loss 0.719497
Epoch 10, Train Loss 0.564864, Valid_loss 0.714458
Epoch 11, Train Loss 0.558061, Valid_loss 0.698402
Epoch 12, Train Loss 0.542777, Valid_loss 0.681278
Epoch 13, Train Loss 0.544922, Valid_loss 0.673613
Epoch 14, Train Loss 0.531927, Valid_loss 0.665643
Epoch 15, Train Loss 0.524528, Valid_loss 0.665159
Epoch 16, Train Loss 0.514938, Valid_loss 0.659557
Epoch 17, Train Loss 0.518398, Valid_loss 0.654470
Epoch 18, Train Loss 0.510356, Valid_loss 0.652885
Epoch 19, Train Loss 0.506431, Valid_loss 0.654194
Epoch 20, Train Loss 0.513605, Valid_loss 0.652886
Epoch 21, Train Loss 0.500212, Valid_loss 0.645271
Epoch 22, Train Loss 0.498373, Valid_loss 0.639011
Epoch 23, Train Loss 0.496552, Valid_loss 0.653631
Epoch 24, Train Loss 0.497174, Valid_loss 0.636880
Epoch 25, Train Loss 0.494221, Valid_loss 0.648481
Epoch 26, Train Loss 0.492746, Valid_loss 0.644815
Epoch 27, Train Loss 0.490809, Valid_loss 0.664765
Epoch 28, Train Loss 0.490098, Valid_loss 0.668240
Epoch 29, Train Loss 0.481612, Valid_loss 0.648291
Epoch 30, Train Loss 0.484139, Valid_loss 0.667668
Epoch 31, Train Loss 0.480049, Valid_loss 0.670910
Epoch 32, Train Loss 0.478212, Valid_loss 0.674813
Epoch 33, Train Loss 0.476948, Valid_loss 0.675586
Epoch 34, Train Loss 0.469990, Valid_loss 0.677252
Epoch 35, Train Loss 0.477830, Valid_loss 0.680218
Epoch 36, Train Loss 0.468592, Valid_loss 0.685948
Epoch 37, Train Loss 0.473051, Valid_loss 0.694287
Epoch 38, Train Loss 0.461885, Valid_loss 0.692650
Epoch 39, Train Loss 0.467877, Valid_loss 0.694355
Epoch 40, Train Loss 0.464127, Valid_loss 0.700279
Epoch 41, Train Loss 0.464464, Valid_loss 0.700741
Epoch 42, Train Loss 0.462607, Valid_loss 0.708378
Epoch 43, Train Loss 0.458010, Valid_loss 0.703954
Epoch 44, Train Loss 0.461427, Valid_loss 0.705587
Epoch 45, Train Loss 0.453432, Valid_loss 0.709689
Epoch 46, Train Loss 0.455286, Valid_loss 0.713720
Epoch 47, Train Loss 0.458667, Valid_loss 0.715737
Epoch 48, Train Loss 0.452130, Valid_loss 0.719473
Epoch 49, Train Loss 0.455371, Valid_loss 0.722817
Epoch 50, Train Loss 0.457262, Valid_loss 0.716112
Epoch 51, Train Loss 0.451639, Valid_loss 0.721184
Epoch 52, Train Loss 0.448799, Valid_loss 0.721469
COVID19_Participant26 -- true: COVID-19 -- pred: normal
COVID19_Participant26 -- true: COVID-19 -- pred: COVID-19
Control_Participant7 -- true: normal -- pred: COVID-19
Control_Participant7 -- true: normal -- pred: COVID-19
true :  [1, 1, 0, 0]
pred :  [0, 1, 1, 1]
Confusion Matrix: [0 2 1 1]
Best performance: Epoch 24, Loss 0.497174, Test ACC 0.250000, Test AUC 0.500000, Test Recall 0.500000, Test Precision 0.333333
✅ Total valid splits used: 2
🔁 Repeat 3, Fold 2
🔍 Split #3
  → train_p_index 환자 수: 25
  → test_p_index 환자 수: 7
  → train 환자 ID: ['COVID19_Participant11', 'COVID19_Participant13', 'COVID19_Participant14', 'COVID19_Participant15', 'COVID19_Participant17', 'COVID19_Participant19', 'COVID19_Participant20', 'COVID19_Participant22', 'COVID19_Participant25', 'COVID19_Participant26', 'COVID19_Participant28', 'COVID19_Participant29', 'COVID19_Participant31', 'COVID19_Participant32', 'COVID19_Participant39', 'COVID19_Participant4', 'COVID19_Participant40', 'COVID19_Participant7', 'Control_Participant1', 'Control_Participant10', 'Control_Participant11', 'Control_Participant3', 'Control_Participant4', 'Control_Participant7', 'Control_Participant8']
  → test  환자 ID: ['COVID19_Participant26', 'COVID19_Participant26', 'COVID19_Participant31', 'COVID19_Participant13', 'Control_Participant4', 'Control_Participant7', 'Control_Participant7']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant10, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant4, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant8, Label: 0
  → test 환자 ID 및 라벨:
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: Control_Participant4, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant7, Label: 0
train_p_index_ 16
valid_p_index 9
test_p_index 7
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Keratinocytes', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Neurons', 'iPS_cells', 'Embryonic_stem_cells', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
data augment 실행 함
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:11,  8.57it/s]  2%|▏         | 2/100 [00:00<00:10,  9.17it/s]  4%|▍         | 4/100 [00:00<00:10,  9.38it/s]  5%|▌         | 5/100 [00:00<00:10,  8.69it/s]  6%|▌         | 6/100 [00:00<00:10,  8.78it/s]  7%|▋         | 7/100 [00:00<00:10,  9.01it/s]  8%|▊         | 8/100 [00:00<00:10,  9.10it/s]  9%|▉         | 9/100 [00:01<00:10,  8.90it/s] 10%|█         | 10/100 [00:01<00:10,  8.89it/s] 11%|█         | 11/100 [00:01<00:10,  8.80it/s] 13%|█▎        | 13/100 [00:01<00:09,  8.85it/s] 14%|█▍        | 14/100 [00:01<00:10,  8.37it/s] 15%|█▌        | 15/100 [00:01<00:09,  8.62it/s] 16%|█▌        | 16/100 [00:01<00:10,  8.32it/s] 17%|█▋        | 17/100 [00:01<00:09,  8.53it/s] 18%|█▊        | 18/100 [00:02<00:09,  8.70it/s] 19%|█▉        | 19/100 [00:02<00:09,  8.68it/s] 20%|██        | 20/100 [00:02<00:09,  8.39it/s] 21%|██        | 21/100 [00:02<00:09,  8.31it/s] 22%|██▏       | 22/100 [00:02<00:09,  8.48it/s] 23%|██▎       | 23/100 [00:02<00:08,  8.68it/s] 24%|██▍       | 24/100 [00:02<00:08,  8.58it/s] 25%|██▌       | 25/100 [00:02<00:08,  8.53it/s] 26%|██▌       | 26/100 [00:03<00:08,  8.26it/s] 27%|██▋       | 27/100 [00:03<00:08,  8.24it/s] 28%|██▊       | 28/100 [00:03<00:09,  7.97it/s] 29%|██▉       | 29/100 [00:03<00:08,  8.19it/s] 30%|███       | 30/100 [00:03<00:08,  8.35it/s] 31%|███       | 31/100 [00:03<00:08,  8.50it/s] 32%|███▏      | 32/100 [00:03<00:08,  8.40it/s] 33%|███▎      | 33/100 [00:03<00:08,  8.32it/s] 34%|███▍      | 34/100 [00:04<00:09,  6.82it/s] 35%|███▌      | 35/100 [00:04<00:09,  7.16it/s] 36%|███▌      | 36/100 [00:04<00:08,  7.54it/s] 37%|███▋      | 37/100 [00:04<00:08,  7.68it/s] 38%|███▊      | 38/100 [00:04<00:07,  8.05it/s] 39%|███▉      | 39/100 [00:04<00:07,  8.09it/s] 40%|████      | 40/100 [00:04<00:07,  8.16it/s] 41%|████      | 41/100 [00:04<00:07,  8.23it/s] 42%|████▏     | 42/100 [00:05<00:06,  8.30it/s] 43%|████▎     | 43/100 [00:05<00:06,  8.39it/s] 44%|████▍     | 44/100 [00:05<00:06,  8.19it/s] 45%|████▌     | 45/100 [00:05<00:06,  8.52it/s] 46%|████▌     | 46/100 [00:05<00:06,  8.47it/s] 47%|████▋     | 47/100 [00:05<00:06,  8.42it/s] 48%|████▊     | 48/100 [00:05<00:06,  8.32it/s] 49%|████▉     | 49/100 [00:05<00:06,  8.32it/s] 50%|█████     | 50/100 [00:05<00:06,  8.26it/s] 51%|█████     | 51/100 [00:06<00:05,  8.36it/s] 52%|█████▏    | 52/100 [00:06<00:05,  8.10it/s] 53%|█████▎    | 53/100 [00:06<00:05,  7.97it/s] 54%|█████▍    | 54/100 [00:06<00:05,  8.13it/s] 55%|█████▌    | 55/100 [00:06<00:05,  8.17it/s] 56%|█████▌    | 56/100 [00:06<00:05,  8.14it/s] 57%|█████▋    | 57/100 [00:06<00:05,  8.18it/s] 58%|█████▊    | 58/100 [00:06<00:05,  7.94it/s] 59%|█████▉    | 59/100 [00:07<00:05,  7.91it/s] 60%|██████    | 60/100 [00:07<00:05,  7.99it/s] 61%|██████    | 61/100 [00:07<00:04,  7.94it/s] 62%|██████▏   | 62/100 [00:07<00:04,  7.61it/s] 63%|██████▎   | 63/100 [00:07<00:05,  7.17it/s] 64%|██████▍   | 64/100 [00:07<00:04,  7.31it/s] 65%|██████▌   | 65/100 [00:07<00:04,  7.07it/s] 66%|██████▌   | 66/100 [00:08<00:04,  7.28it/s] 67%|██████▋   | 67/100 [00:08<00:04,  7.41it/s] 68%|██████▊   | 68/100 [00:08<00:04,  7.05it/s] 69%|██████▉   | 69/100 [00:08<00:04,  7.05it/s] 70%|███████   | 70/100 [00:08<00:04,  6.96it/s] 71%|███████   | 71/100 [00:08<00:04,  7.25it/s] 72%|███████▏  | 72/100 [00:08<00:03,  7.58it/s] 73%|███████▎  | 73/100 [00:09<00:03,  7.72it/s] 74%|███████▍  | 74/100 [00:09<00:03,  7.75it/s] 75%|███████▌  | 75/100 [00:09<00:03,  8.27it/s] 76%|███████▌  | 76/100 [00:09<00:03,  7.94it/s] 77%|███████▋  | 77/100 [00:09<00:02,  8.03it/s] 78%|███████▊  | 78/100 [00:09<00:02,  7.90it/s] 79%|███████▉  | 79/100 [00:09<00:02,  7.97it/s] 80%|████████  | 80/100 [00:09<00:02,  7.77it/s] 81%|████████  | 81/100 [00:10<00:02,  7.77it/s] 82%|████████▏ | 82/100 [00:10<00:02,  7.73it/s] 83%|████████▎ | 83/100 [00:10<00:02,  7.81it/s] 84%|████████▍ | 84/100 [00:10<00:02,  7.82it/s] 85%|████████▌ | 85/100 [00:10<00:02,  6.67it/s] 86%|████████▌ | 86/100 [00:10<00:02,  6.59it/s] 87%|████████▋ | 87/100 [00:10<00:01,  7.02it/s] 88%|████████▊ | 88/100 [00:10<00:01,  7.40it/s] 89%|████████▉ | 89/100 [00:11<00:01,  7.39it/s] 90%|█████████ | 90/100 [00:11<00:01,  7.69it/s] 91%|█████████ | 91/100 [00:11<00:01,  7.62it/s] 92%|█████████▏| 92/100 [00:11<00:01,  7.85it/s] 93%|█████████▎| 93/100 [00:11<00:00,  7.72it/s] 94%|█████████▍| 94/100 [00:11<00:00,  7.09it/s] 95%|█████████▌| 95/100 [00:11<00:00,  7.20it/s] 96%|█████████▌| 96/100 [00:12<00:00,  7.65it/s] 97%|█████████▋| 97/100 [00:12<00:00,  7.66it/s] 98%|█████████▊| 98/100 [00:12<00:00,  7.53it/s] 99%|█████████▉| 99/100 [00:12<00:00,  7.52it/s]100%|██████████| 100/100 [00:12<00:00,  7.39it/s]100%|██████████| 100/100 [00:12<00:00,  7.94it/s]
eval_p_index len:  16
individual_train 116
individual_eval 16
train data의 x, y, id 길이: 116 116 116
valid data의 x, y, id 길이: 9 9 9
test data의 x, y, id 길이: 7 7 7
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.654542, Valid_loss 0.660024
Epoch 2, Train Loss 0.624169, Valid_loss 0.652200
Epoch 3, Train Loss 0.616600, Valid_loss 0.646324
Epoch 4, Train Loss 0.610064, Valid_loss 0.638982
Epoch 5, Train Loss 0.600115, Valid_loss 0.635028
Epoch 6, Train Loss 0.604044, Valid_loss 0.629044
Epoch 7, Train Loss 0.589007, Valid_loss 0.625769
Epoch 8, Train Loss 0.578402, Valid_loss 0.623043
Epoch 9, Train Loss 0.598205, Valid_loss 0.620705
Epoch 10, Train Loss 0.575836, Valid_loss 0.619700
Epoch 11, Train Loss 0.561113, Valid_loss 0.616717
Epoch 12, Train Loss 0.566359, Valid_loss 0.614443
Epoch 13, Train Loss 0.546077, Valid_loss 0.608745
Epoch 14, Train Loss 0.545596, Valid_loss 0.592585
Epoch 15, Train Loss 0.530627, Valid_loss 0.577803
Epoch 16, Train Loss 0.502076, Valid_loss 0.576838
Epoch 17, Train Loss 0.492336, Valid_loss 0.564488
Epoch 18, Train Loss 0.471442, Valid_loss 0.563253
Epoch 19, Train Loss 0.479410, Valid_loss 0.558456
Epoch 20, Train Loss 0.479055, Valid_loss 0.552244
Epoch 21, Train Loss 0.458855, Valid_loss 0.548691
Epoch 22, Train Loss 0.446120, Valid_loss 0.555969
Epoch 23, Train Loss 0.459453, Valid_loss 0.537247
Epoch 24, Train Loss 0.452548, Valid_loss 0.538632
Epoch 25, Train Loss 0.448985, Valid_loss 0.537683
Epoch 26, Train Loss 0.436688, Valid_loss 0.531863
Epoch 27, Train Loss 0.434228, Valid_loss 0.526117
Epoch 28, Train Loss 0.452288, Valid_loss 0.518960
Epoch 29, Train Loss 0.447181, Valid_loss 0.515290
Epoch 30, Train Loss 0.436078, Valid_loss 0.506925
Epoch 31, Train Loss 0.437148, Valid_loss 0.504740
Epoch 32, Train Loss 0.449219, Valid_loss 0.498392
Epoch 33, Train Loss 0.422719, Valid_loss 0.497568
Epoch 34, Train Loss 0.427736, Valid_loss 0.490179
Epoch 35, Train Loss 0.430101, Valid_loss 0.488003
Epoch 36, Train Loss 0.432686, Valid_loss 0.478707
Epoch 37, Train Loss 0.432471, Valid_loss 0.473226
Epoch 38, Train Loss 0.433235, Valid_loss 0.467370
Epoch 39, Train Loss 0.427766, Valid_loss 0.461206
Epoch 40, Train Loss 0.422302, Valid_loss 0.459772
Epoch 41, Train Loss 0.430800, Valid_loss 0.453470
Epoch 42, Train Loss 0.416196, Valid_loss 0.445383
Epoch 43, Train Loss 0.430836, Valid_loss 0.443181
Epoch 44, Train Loss 0.413374, Valid_loss 0.434129
Epoch 45, Train Loss 0.414937, Valid_loss 0.431255
Epoch 46, Train Loss 0.416586, Valid_loss 0.424733
Epoch 47, Train Loss 0.409656, Valid_loss 0.419765
Epoch 48, Train Loss 0.403590, Valid_loss 0.420501
Epoch 49, Train Loss 0.409317, Valid_loss 0.416886
Epoch 50, Train Loss 0.404104, Valid_loss 0.420708
Epoch 51, Train Loss 0.415686, Valid_loss 0.415565
Epoch 52, Train Loss 0.398042, Valid_loss 0.415298
Epoch 53, Train Loss 0.413593, Valid_loss 0.413105
Epoch 54, Train Loss 0.412729, Valid_loss 0.414603
Epoch 55, Train Loss 0.407199, Valid_loss 0.411680
Epoch 56, Train Loss 0.403543, Valid_loss 0.409177
Epoch 57, Train Loss 0.400507, Valid_loss 0.410112
Epoch 58, Train Loss 0.412963, Valid_loss 0.408501
Epoch 59, Train Loss 0.401313, Valid_loss 0.405411
Epoch 60, Train Loss 0.416891, Valid_loss 0.407688
Epoch 61, Train Loss 0.404155, Valid_loss 0.408475
COVID19_Participant26 -- true: COVID-19 -- pred: normal
COVID19_Participant26 -- true: COVID-19 -- pred: COVID-19
COVID19_Participant31 -- true: COVID-19 -- pred: COVID-19
COVID19_Participant13 -- true: COVID-19 -- pred: COVID-19
Control_Participant4 -- true: normal -- pred: COVID-19
Control_Participant7 -- true: normal -- pred: normal
Control_Participant7 -- true: normal -- pred: COVID-19
true :  [1, 1, 1, 1, 0, 0, 0]
pred :  [0, 1, 1, 1, 1, 0, 1]
Confusion Matrix: [1 2 1 3]
Best performance: Epoch 59, Loss 0.401313, Test ACC 0.571429, Test AUC 0.500000, Test Recall 0.750000, Test Precision 0.600000
✅ Total valid splits used: 3
🔁 Repeat 3, Fold 3
🔍 Split #4
  → train_p_index 환자 수: 25
  → test_p_index 환자 수: 7
  → train 환자 ID: ['COVID19_Participant11', 'COVID19_Participant13', 'COVID19_Participant14', 'COVID19_Participant15', 'COVID19_Participant17', 'COVID19_Participant19', 'COVID19_Participant2', 'COVID19_Participant23', 'COVID19_Participant25', 'COVID19_Participant29', 'COVID19_Participant31', 'COVID19_Participant37', 'COVID19_Participant39', 'COVID19_Participant40', 'COVID19_Participant7', 'COVID19_Participant8', 'Control_Participant1', 'Control_Participant10', 'Control_Participant11', 'Control_Participant15', 'Control_Participant4', 'Control_Participant5', 'Control_Participant7', 'Control_Participant8', 'Control_Participant9']
  → test  환자 ID: ['Control_Participant10', 'Control_Participant5', 'Control_Participant7', 'COVID19_Participant25', 'Control_Participant9', 'Control_Participant1', 'COVID19_Participant13']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant10, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant4, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant8, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: Control_Participant10, Label: 1
    ID: Control_Participant5, Label: 1
    ID: Control_Participant7, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: Control_Participant9, Label: 1
    ID: Control_Participant1, Label: 1
    ID: COVID19_Participant13, Label: 0
train_p_index_ 16
valid_p_index 9
test_p_index 7
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Keratinocytes', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Neurons', 'iPS_cells', 'Embryonic_stem_cells', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
data augment 실행 함
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:11,  8.74it/s]  2%|▏         | 2/100 [00:00<00:10,  8.95it/s]  3%|▎         | 3/100 [00:00<00:10,  9.08it/s]  4%|▍         | 4/100 [00:00<00:10,  9.19it/s]  5%|▌         | 5/100 [00:00<00:10,  9.24it/s]  6%|▌         | 6/100 [00:00<00:10,  9.23it/s]  7%|▋         | 7/100 [00:00<00:10,  8.86it/s]  8%|▊         | 8/100 [00:00<00:10,  8.73it/s]  9%|▉         | 9/100 [00:01<00:10,  8.84it/s] 10%|█         | 10/100 [00:01<00:10,  8.98it/s] 11%|█         | 11/100 [00:01<00:09,  8.91it/s] 12%|█▏        | 12/100 [00:01<00:10,  8.76it/s] 13%|█▎        | 13/100 [00:01<00:09,  8.76it/s] 14%|█▍        | 14/100 [00:01<00:10,  8.31it/s] 15%|█▌        | 15/100 [00:01<00:13,  6.40it/s] 16%|█▌        | 16/100 [00:01<00:11,  7.07it/s] 17%|█▋        | 17/100 [00:02<00:10,  7.67it/s] 18%|█▊        | 18/100 [00:02<00:10,  7.98it/s] 19%|█▉        | 19/100 [00:02<00:09,  8.41it/s] 20%|██        | 20/100 [00:02<00:09,  8.43it/s] 21%|██        | 21/100 [00:02<00:09,  8.23it/s] 22%|██▏       | 22/100 [00:02<00:09,  8.59it/s] 23%|██▎       | 23/100 [00:02<00:09,  8.50it/s] 24%|██▍       | 24/100 [00:02<00:08,  8.49it/s] 25%|██▌       | 25/100 [00:02<00:08,  8.41it/s] 26%|██▌       | 26/100 [00:03<00:08,  8.63it/s] 27%|██▋       | 27/100 [00:03<00:08,  8.57it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.61it/s] 29%|██▉       | 29/100 [00:03<00:08,  8.37it/s] 30%|███       | 30/100 [00:03<00:08,  8.48it/s] 31%|███       | 31/100 [00:03<00:07,  8.66it/s] 32%|███▏      | 32/100 [00:03<00:08,  8.48it/s] 33%|███▎      | 33/100 [00:03<00:08,  8.31it/s] 34%|███▍      | 34/100 [00:04<00:07,  8.39it/s] 35%|███▌      | 35/100 [00:04<00:07,  8.38it/s] 36%|███▌      | 36/100 [00:04<00:07,  8.28it/s] 37%|███▋      | 37/100 [00:04<00:07,  8.09it/s] 38%|███▊      | 38/100 [00:04<00:07,  8.53it/s] 39%|███▉      | 39/100 [00:04<00:07,  8.54it/s] 40%|████      | 40/100 [00:04<00:06,  8.57it/s] 41%|████      | 41/100 [00:04<00:06,  8.56it/s] 42%|████▏     | 42/100 [00:04<00:06,  8.48it/s] 43%|████▎     | 43/100 [00:05<00:06,  8.62it/s] 44%|████▍     | 44/100 [00:05<00:06,  8.54it/s] 45%|████▌     | 45/100 [00:05<00:06,  8.30it/s] 46%|████▌     | 46/100 [00:05<00:06,  8.29it/s] 47%|████▋     | 47/100 [00:05<00:06,  8.43it/s] 48%|████▊     | 48/100 [00:05<00:06,  8.23it/s] 49%|████▉     | 49/100 [00:05<00:06,  8.28it/s] 50%|█████     | 50/100 [00:05<00:05,  8.42it/s] 51%|█████     | 51/100 [00:06<00:05,  8.39it/s] 52%|█████▏    | 52/100 [00:06<00:05,  8.66it/s] 53%|█████▎    | 53/100 [00:06<00:05,  8.55it/s] 54%|█████▍    | 54/100 [00:06<00:05,  8.68it/s] 55%|█████▌    | 55/100 [00:06<00:05,  8.50it/s] 56%|█████▌    | 56/100 [00:06<00:05,  8.28it/s] 57%|█████▋    | 57/100 [00:06<00:05,  8.46it/s] 58%|█████▊    | 58/100 [00:06<00:04,  8.41it/s] 59%|█████▉    | 59/100 [00:07<00:04,  8.24it/s] 60%|██████    | 60/100 [00:07<00:04,  8.24it/s] 61%|██████    | 61/100 [00:07<00:04,  8.40it/s] 62%|██████▏   | 62/100 [00:07<00:04,  7.94it/s] 63%|██████▎   | 63/100 [00:07<00:04,  7.96it/s] 64%|██████▍   | 64/100 [00:07<00:04,  8.11it/s] 65%|██████▌   | 65/100 [00:07<00:04,  7.92it/s] 66%|██████▌   | 66/100 [00:07<00:04,  8.41it/s] 67%|██████▋   | 67/100 [00:08<00:04,  7.90it/s] 68%|██████▊   | 68/100 [00:08<00:04,  7.98it/s] 69%|██████▉   | 69/100 [00:08<00:03,  7.93it/s] 70%|███████   | 70/100 [00:08<00:03,  7.97it/s] 71%|███████   | 71/100 [00:08<00:03,  7.87it/s] 72%|███████▏  | 72/100 [00:08<00:03,  8.02it/s] 73%|███████▎  | 73/100 [00:08<00:03,  8.06it/s] 74%|███████▍  | 74/100 [00:08<00:03,  8.17it/s] 75%|███████▌  | 75/100 [00:08<00:03,  8.09it/s] 76%|███████▌  | 76/100 [00:09<00:02,  8.09it/s] 77%|███████▋  | 77/100 [00:09<00:02,  8.15it/s] 78%|███████▊  | 78/100 [00:09<00:02,  8.53it/s] 79%|███████▉  | 79/100 [00:09<00:02,  8.46it/s] 80%|████████  | 80/100 [00:09<00:02,  8.53it/s] 81%|████████  | 81/100 [00:09<00:02,  8.45it/s] 82%|████████▏ | 82/100 [00:09<00:02,  8.50it/s] 83%|████████▎ | 83/100 [00:09<00:01,  8.84it/s] 84%|████████▍ | 84/100 [00:10<00:01,  8.85it/s] 85%|████████▌ | 85/100 [00:10<00:01,  8.51it/s] 86%|████████▌ | 86/100 [00:10<00:01,  8.27it/s] 87%|████████▋ | 87/100 [00:10<00:01,  8.16it/s] 88%|████████▊ | 88/100 [00:10<00:01,  7.97it/s] 89%|████████▉ | 89/100 [00:10<00:01,  7.92it/s] 90%|█████████ | 90/100 [00:10<00:01,  7.83it/s] 91%|█████████ | 91/100 [00:10<00:01,  8.06it/s] 92%|█████████▏| 92/100 [00:11<00:01,  7.82it/s] 93%|█████████▎| 93/100 [00:11<00:00,  7.64it/s] 94%|█████████▍| 94/100 [00:11<00:00,  7.96it/s] 95%|█████████▌| 95/100 [00:11<00:00,  7.70it/s] 96%|█████████▌| 96/100 [00:11<00:00,  7.93it/s] 97%|█████████▋| 97/100 [00:11<00:00,  8.06it/s] 98%|█████████▊| 98/100 [00:11<00:00,  8.09it/s] 99%|█████████▉| 99/100 [00:12<00:00,  5.90it/s]100%|██████████| 100/100 [00:12<00:00,  6.39it/s]100%|██████████| 100/100 [00:12<00:00,  8.19it/s]
eval_p_index len:  16
individual_train 116
individual_eval 16
train data의 x, y, id 길이: 116 116 116
valid data의 x, y, id 길이: 9 9 9
test data의 x, y, id 길이: 7 7 7
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.686206, Valid_loss 0.678594
Epoch 2, Train Loss 0.657436, Valid_loss 0.670588
Epoch 3, Train Loss 0.631058, Valid_loss 0.671677
Epoch 4, Train Loss 0.633809, Valid_loss 0.674541
Epoch 5, Train Loss 0.625539, Valid_loss 0.671406
Epoch 6, Train Loss 0.611595, Valid_loss 0.666427
Epoch 7, Train Loss 0.605082, Valid_loss 0.662352
Epoch 8, Train Loss 0.601318, Valid_loss 0.658377
Epoch 9, Train Loss 0.602225, Valid_loss 0.654233
Epoch 10, Train Loss 0.582304, Valid_loss 0.647687
Epoch 11, Train Loss 0.577760, Valid_loss 0.643098
Epoch 12, Train Loss 0.568250, Valid_loss 0.634664
Epoch 13, Train Loss 0.558639, Valid_loss 0.628555
Epoch 14, Train Loss 0.547901, Valid_loss 0.615641
Epoch 15, Train Loss 0.516209, Valid_loss 0.603972
Epoch 16, Train Loss 0.491630, Valid_loss 0.611156
Epoch 17, Train Loss 0.496769, Valid_loss 0.608764
Epoch 18, Train Loss 0.485576, Valid_loss 0.613114
Epoch 19, Train Loss 0.476312, Valid_loss 0.604689
Epoch 20, Train Loss 0.488383, Valid_loss 0.603515
Epoch 21, Train Loss 0.470637, Valid_loss 0.606935
Epoch 22, Train Loss 0.469451, Valid_loss 0.598669
Epoch 23, Train Loss 0.478669, Valid_loss 0.601602
Epoch 24, Train Loss 0.458484, Valid_loss 0.600589
Epoch 25, Train Loss 0.459773, Valid_loss 0.598832
Epoch 26, Train Loss 0.461680, Valid_loss 0.601590
Epoch 27, Train Loss 0.459173, Valid_loss 0.597601
Epoch 28, Train Loss 0.454736, Valid_loss 0.598107
Epoch 29, Train Loss 0.460260, Valid_loss 0.600239
Epoch 30, Train Loss 0.455018, Valid_loss 0.598461
Epoch 31, Train Loss 0.439831, Valid_loss 0.593635
Epoch 32, Train Loss 0.449264, Valid_loss 0.593709
Epoch 33, Train Loss 0.446497, Valid_loss 0.590568
Epoch 34, Train Loss 0.456232, Valid_loss 0.595124
Epoch 35, Train Loss 0.435514, Valid_loss 0.592851
Epoch 36, Train Loss 0.444505, Valid_loss 0.595992
Epoch 37, Train Loss 0.456253, Valid_loss 0.587924
Epoch 38, Train Loss 0.441097, Valid_loss 0.594034
Epoch 39, Train Loss 0.434353, Valid_loss 0.587236
Epoch 40, Train Loss 0.443627, Valid_loss 0.589190
Epoch 41, Train Loss 0.427875, Valid_loss 0.590007
Epoch 42, Train Loss 0.441337, Valid_loss 0.589650
Epoch 43, Train Loss 0.443151, Valid_loss 0.593827
Epoch 44, Train Loss 0.437808, Valid_loss 0.584971
Epoch 45, Train Loss 0.425309, Valid_loss 0.590514
Epoch 46, Train Loss 0.433381, Valid_loss 0.589331
Epoch 47, Train Loss 0.426554, Valid_loss 0.588778
Epoch 48, Train Loss 0.419551, Valid_loss 0.588976
Epoch 49, Train Loss 0.418448, Valid_loss 0.586670
Epoch 50, Train Loss 0.439858, Valid_loss 0.588295
Epoch 51, Train Loss 0.412597, Valid_loss 0.585091
Epoch 52, Train Loss 0.441977, Valid_loss 0.585681
Epoch 53, Train Loss 0.415612, Valid_loss 0.584359
Epoch 54, Train Loss 0.432443, Valid_loss 0.587200
Epoch 55, Train Loss 0.420675, Valid_loss 0.588624
Control_Participant10 -- true: normal -- pred: COVID-19
Control_Participant5 -- true: normal -- pred: normal
Control_Participant7 -- true: normal -- pred: COVID-19
COVID19_Participant25 -- true: COVID-19 -- pred: COVID-19
Control_Participant9 -- true: normal -- pred: COVID-19
Control_Participant1 -- true: normal -- pred: COVID-19
COVID19_Participant13 -- true: COVID-19 -- pred: COVID-19
true :  [0, 0, 0, 1, 0, 0, 1]
pred :  [1, 0, 1, 1, 1, 1, 1]
Confusion Matrix: [1 4 0 2]
Best performance: Epoch 53, Loss 0.415612, Test ACC 0.428571, Test AUC 0.700000, Test Recall 1.000000, Test Precision 0.333333
✅ Total valid splits used: 4
🔁 Repeat 3, Fold 4
🔍 Split #5
  → train_p_index 환자 수: 26
  → test_p_index 환자 수: 6
  → train 환자 ID: ['COVID19_Participant11', 'COVID19_Participant15', 'COVID19_Participant17', 'COVID19_Participant19', 'COVID19_Participant2', 'COVID19_Participant20', 'COVID19_Participant22', 'COVID19_Participant23', 'COVID19_Participant25', 'COVID19_Participant26', 'COVID19_Participant28', 'COVID19_Participant31', 'COVID19_Participant32', 'COVID19_Participant37', 'COVID19_Participant39', 'COVID19_Participant4', 'COVID19_Participant40', 'COVID19_Participant7', 'COVID19_Participant8', 'Control_Participant1', 'Control_Participant10', 'Control_Participant15', 'Control_Participant3', 'Control_Participant4', 'Control_Participant5', 'Control_Participant9']
  → test  환자 ID: ['COVID19_Participant26', 'Control_Participant4', 'COVID19_Participant11', 'COVID19_Participant25', 'COVID19_Participant31', 'Control_Participant5']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant10, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant4, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: COVID19_Participant26, Label: 1
    ID: Control_Participant4, Label: 1
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant25, Label: 0
    ID: COVID19_Participant31, Label: 0
    ID: Control_Participant5, Label: 0
train_p_index_ 17
valid_p_index 9
test_p_index 6
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Epithelial_cells', 'Epithelial_cells', 'NK_cell', 'Epithelial_cells', 'Epithelial_cells', 'Keratinocytes', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
data augment 실행 함
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:11,  8.90it/s]  2%|▏         | 2/100 [00:00<00:11,  8.82it/s]  3%|▎         | 3/100 [00:00<00:10,  8.91it/s]  4%|▍         | 4/100 [00:00<00:10,  9.10it/s]  6%|▌         | 6/100 [00:00<00:10,  9.07it/s]  7%|▋         | 7/100 [00:00<00:10,  8.96it/s]  8%|▊         | 8/100 [00:00<00:10,  9.02it/s]  9%|▉         | 9/100 [00:01<00:10,  8.82it/s] 10%|█         | 10/100 [00:01<00:10,  8.82it/s] 11%|█         | 11/100 [00:01<00:10,  8.83it/s] 12%|█▏        | 12/100 [00:01<00:09,  8.96it/s] 13%|█▎        | 13/100 [00:01<00:09,  8.86it/s] 14%|█▍        | 14/100 [00:01<00:09,  8.73it/s] 15%|█▌        | 15/100 [00:01<00:09,  8.65it/s] 16%|█▌        | 16/100 [00:01<00:09,  8.84it/s] 17%|█▋        | 17/100 [00:01<00:09,  9.03it/s] 18%|█▊        | 18/100 [00:02<00:09,  9.04it/s] 19%|█▉        | 19/100 [00:02<00:09,  8.98it/s] 21%|██        | 21/100 [00:02<00:08,  9.16it/s] 22%|██▏       | 22/100 [00:02<00:08,  9.09it/s] 23%|██▎       | 23/100 [00:02<00:08,  9.07it/s] 24%|██▍       | 24/100 [00:02<00:08,  8.60it/s] 25%|██▌       | 25/100 [00:02<00:08,  8.57it/s] 26%|██▌       | 26/100 [00:02<00:08,  8.70it/s] 27%|██▋       | 27/100 [00:03<00:08,  8.47it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.59it/s] 29%|██▉       | 29/100 [00:03<00:08,  8.51it/s] 30%|███       | 30/100 [00:03<00:08,  8.42it/s] 31%|███       | 31/100 [00:03<00:08,  8.41it/s] 32%|███▏      | 32/100 [00:03<00:08,  8.39it/s] 33%|███▎      | 33/100 [00:03<00:08,  7.92it/s] 34%|███▍      | 34/100 [00:03<00:08,  8.11it/s] 35%|███▌      | 35/100 [00:04<00:07,  8.33it/s] 36%|███▌      | 36/100 [00:04<00:07,  8.06it/s] 37%|███▋      | 37/100 [00:04<00:07,  8.14it/s] 38%|███▊      | 38/100 [00:04<00:07,  8.35it/s] 39%|███▉      | 39/100 [00:04<00:07,  8.12it/s] 40%|████      | 40/100 [00:04<00:07,  8.21it/s] 41%|████      | 41/100 [00:04<00:07,  8.34it/s] 42%|████▏     | 42/100 [00:04<00:06,  8.53it/s] 43%|████▎     | 43/100 [00:04<00:06,  8.37it/s] 44%|████▍     | 44/100 [00:05<00:06,  8.13it/s] 45%|████▌     | 45/100 [00:05<00:06,  8.00it/s] 46%|████▌     | 46/100 [00:05<00:06,  7.74it/s] 47%|████▋     | 47/100 [00:05<00:06,  7.92it/s] 48%|████▊     | 48/100 [00:05<00:06,  7.98it/s] 49%|████▉     | 49/100 [00:05<00:06,  8.29it/s] 50%|█████     | 50/100 [00:05<00:05,  8.36it/s] 51%|█████     | 51/100 [00:05<00:05,  8.33it/s] 52%|█████▏    | 52/100 [00:06<00:05,  8.16it/s] 53%|█████▎    | 53/100 [00:06<00:05,  7.86it/s] 54%|█████▍    | 54/100 [00:06<00:05,  7.72it/s] 55%|█████▌    | 55/100 [00:06<00:05,  7.75it/s] 56%|█████▌    | 56/100 [00:06<00:05,  7.96it/s] 57%|█████▋    | 57/100 [00:06<00:05,  8.06it/s] 58%|█████▊    | 58/100 [00:06<00:05,  8.12it/s] 59%|█████▉    | 59/100 [00:06<00:05,  7.98it/s] 60%|██████    | 60/100 [00:07<00:05,  7.99it/s] 61%|██████    | 61/100 [00:07<00:04,  7.97it/s] 62%|██████▏   | 62/100 [00:07<00:05,  7.36it/s] 63%|██████▎   | 63/100 [00:07<00:04,  7.68it/s] 64%|██████▍   | 64/100 [00:07<00:04,  7.24it/s] 65%|██████▌   | 65/100 [00:07<00:04,  7.50it/s] 66%|██████▌   | 66/100 [00:07<00:04,  7.81it/s] 67%|██████▋   | 67/100 [00:08<00:04,  7.68it/s] 68%|██████▊   | 68/100 [00:08<00:04,  7.58it/s] 69%|██████▉   | 69/100 [00:08<00:04,  7.55it/s] 70%|███████   | 70/100 [00:08<00:03,  7.73it/s] 71%|███████   | 71/100 [00:08<00:03,  7.97it/s] 72%|███████▏  | 72/100 [00:08<00:03,  7.43it/s] 73%|███████▎  | 73/100 [00:08<00:03,  7.58it/s] 74%|███████▍  | 74/100 [00:08<00:03,  7.66it/s] 75%|███████▌  | 75/100 [00:09<00:03,  7.65it/s] 76%|███████▌  | 76/100 [00:09<00:03,  7.39it/s] 77%|███████▋  | 77/100 [00:09<00:03,  7.56it/s] 78%|███████▊  | 78/100 [00:09<00:02,  7.53it/s] 79%|███████▉  | 79/100 [00:09<00:02,  7.66it/s] 80%|████████  | 80/100 [00:09<00:02,  7.66it/s] 81%|████████  | 81/100 [00:09<00:02,  7.85it/s] 82%|████████▏ | 82/100 [00:10<00:02,  7.88it/s] 83%|████████▎ | 83/100 [00:10<00:02,  7.89it/s] 84%|████████▍ | 84/100 [00:10<00:02,  7.92it/s] 85%|████████▌ | 85/100 [00:10<00:01,  7.79it/s] 86%|████████▌ | 86/100 [00:10<00:01,  7.76it/s] 87%|████████▋ | 87/100 [00:10<00:01,  7.46it/s] 88%|████████▊ | 88/100 [00:10<00:01,  6.98it/s] 89%|████████▉ | 89/100 [00:10<00:01,  7.19it/s] 90%|█████████ | 90/100 [00:11<00:01,  7.49it/s] 91%|█████████ | 91/100 [00:11<00:01,  7.45it/s] 92%|█████████▏| 92/100 [00:11<00:01,  7.49it/s] 93%|█████████▎| 93/100 [00:11<00:00,  7.61it/s] 94%|█████████▍| 94/100 [00:11<00:00,  7.65it/s] 95%|█████████▌| 95/100 [00:11<00:00,  7.56it/s] 96%|█████████▌| 96/100 [00:11<00:00,  7.47it/s] 97%|█████████▋| 97/100 [00:12<00:00,  7.61it/s] 98%|█████████▊| 98/100 [00:12<00:00,  7.66it/s] 99%|█████████▉| 99/100 [00:12<00:00,  7.75it/s]100%|██████████| 100/100 [00:12<00:00,  7.60it/s]100%|██████████| 100/100 [00:12<00:00,  8.07it/s]
eval_p_index len:  15
individual_train 117
individual_eval 15
train data의 x, y, id 길이: 117 117 117
valid data의 x, y, id 길이: 9 9 9
test data의 x, y, id 길이: 6 6 6
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.556502, Valid_loss 0.711436
Epoch 2, Train Loss 0.540481, Valid_loss 0.709786
Epoch 3, Train Loss 0.521028, Valid_loss 0.702585
Epoch 4, Train Loss 0.519963, Valid_loss 0.681225
Epoch 5, Train Loss 0.500580, Valid_loss 0.671004
Epoch 6, Train Loss 0.515554, Valid_loss 0.657284
Epoch 7, Train Loss 0.480897, Valid_loss 0.633918
Epoch 8, Train Loss 0.473606, Valid_loss 0.638872
Epoch 9, Train Loss 0.469594, Valid_loss 0.623313
Epoch 10, Train Loss 0.457072, Valid_loss 0.609248
Epoch 11, Train Loss 0.452829, Valid_loss 0.594955
Epoch 12, Train Loss 0.449116, Valid_loss 0.569906
Epoch 13, Train Loss 0.439876, Valid_loss 0.547169
Epoch 14, Train Loss 0.427321, Valid_loss 0.534266
Epoch 15, Train Loss 0.430737, Valid_loss 0.504546
Epoch 16, Train Loss 0.412281, Valid_loss 0.491591
Epoch 17, Train Loss 0.382253, Valid_loss 0.536519
Epoch 18, Train Loss 0.378235, Valid_loss 0.454428
Epoch 19, Train Loss 0.362603, Valid_loss 0.423774
Epoch 20, Train Loss 0.372590, Valid_loss 0.463976
Epoch 21, Train Loss 0.357920, Valid_loss 0.426235
Epoch 22, Train Loss 0.362396, Valid_loss 0.409942
Epoch 23, Train Loss 0.350755, Valid_loss 0.423729
Epoch 24, Train Loss 0.357411, Valid_loss 0.414018
Epoch 25, Train Loss 0.351338, Valid_loss 0.406694
Epoch 26, Train Loss 0.345433, Valid_loss 0.402643
Epoch 27, Train Loss 0.354600, Valid_loss 0.397117
Epoch 28, Train Loss 0.353784, Valid_loss 0.404763
Epoch 29, Train Loss 0.352096, Valid_loss 0.397788
Epoch 30, Train Loss 0.342238, Valid_loss 0.401860
Epoch 31, Train Loss 0.348003, Valid_loss 0.399951
Epoch 32, Train Loss 0.342439, Valid_loss 0.426030
Epoch 33, Train Loss 0.344215, Valid_loss 0.386504
Epoch 34, Train Loss 0.340948, Valid_loss 0.390350
Epoch 35, Train Loss 0.337160, Valid_loss 0.391203
Epoch 36, Train Loss 0.339677, Valid_loss 0.384948
Epoch 37, Train Loss 0.339056, Valid_loss 0.384652
Epoch 38, Train Loss 0.334421, Valid_loss 0.385511
Epoch 39, Train Loss 0.328842, Valid_loss 0.385221
Epoch 40, Train Loss 0.338142, Valid_loss 0.380790
Epoch 41, Train Loss 0.332598, Valid_loss 0.383357
Epoch 42, Train Loss 0.327611, Valid_loss 0.375672
Epoch 43, Train Loss 0.331163, Valid_loss 0.383226
Epoch 44, Train Loss 0.334058, Valid_loss 0.376653
Epoch 45, Train Loss 0.335228, Valid_loss 0.376133
Epoch 46, Train Loss 0.330904, Valid_loss 0.379427
Epoch 47, Train Loss 0.328316, Valid_loss 0.376636
Epoch 48, Train Loss 0.332098, Valid_loss 0.378398
Epoch 49, Train Loss 0.327321, Valid_loss 0.367072
Epoch 50, Train Loss 0.325056, Valid_loss 0.372405
Epoch 51, Train Loss 0.325666, Valid_loss 0.368553
Epoch 52, Train Loss 0.323741, Valid_loss 0.376390
Epoch 53, Train Loss 0.324328, Valid_loss 0.368824
Epoch 54, Train Loss 0.325572, Valid_loss 0.369868
Epoch 55, Train Loss 0.327005, Valid_loss 0.371367
COVID19_Participant26 -- true: COVID-19 -- pred: COVID-19
Control_Participant4 -- true: normal -- pred: COVID-19
COVID19_Participant11 -- true: COVID-19 -- pred: COVID-19
COVID19_Participant25 -- true: COVID-19 -- pred: COVID-19
COVID19_Participant31 -- true: COVID-19 -- pred: COVID-19
Control_Participant5 -- true: normal -- pred: COVID-19
true :  [1, 0, 1, 1, 1, 0]
pred :  [1, 1, 1, 1, 1, 1]
Confusion Matrix: [0 2 0 4]
Best performance: Epoch 49, Loss 0.327321, Test ACC 0.666667, Test AUC 0.625000, Test Recall 1.000000, Test Precision 0.666667
✅ Total valid splits used: 5

📌 Repeat 3: 평균 AUC = 0.6650, 표준편차 = 0.1841
🔁 Repeat 4, Fold 0
🔍 Split #1
  → train_p_index 환자 수: 27
  → test_p_index 환자 수: 5
  → train 환자 ID: ['COVID19_Participant11', 'COVID19_Participant13', 'COVID19_Participant14', 'COVID19_Participant15', 'COVID19_Participant17', 'COVID19_Participant19', 'COVID19_Participant2', 'COVID19_Participant22', 'COVID19_Participant23', 'COVID19_Participant25', 'COVID19_Participant26', 'COVID19_Participant28', 'COVID19_Participant37', 'COVID19_Participant39', 'COVID19_Participant4', 'COVID19_Participant40', 'COVID19_Participant7', 'COVID19_Participant8', 'Control_Participant1', 'Control_Participant11', 'Control_Participant15', 'Control_Participant3', 'Control_Participant4', 'Control_Participant5', 'Control_Participant7', 'Control_Participant8', 'Control_Participant9']
  → test  환자 ID: ['COVID19_Participant11', 'Control_Participant5', 'Control_Participant7', 'COVID19_Participant26', 'Control_Participant7']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant4, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant8, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: COVID19_Participant11, Label: 1
    ID: Control_Participant5, Label: 1
    ID: Control_Participant7, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: Control_Participant7, Label: 0
train_p_index_ 18
valid_p_index 9
test_p_index 5
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Keratinocytes', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Neurons', 'iPS_cells', 'Embryonic_stem_cells', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
data augment 실행 함
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  2%|▏         | 2/100 [00:00<00:10,  9.08it/s]  3%|▎         | 3/100 [00:00<00:10,  9.28it/s]  4%|▍         | 4/100 [00:00<00:10,  9.05it/s]  5%|▌         | 5/100 [00:00<00:10,  9.20it/s]  6%|▌         | 6/100 [00:00<00:10,  9.23it/s]  8%|▊         | 8/100 [00:00<00:09,  9.27it/s] 10%|█         | 10/100 [00:01<00:09,  9.74it/s] 11%|█         | 11/100 [00:01<00:09,  9.57it/s] 13%|█▎        | 13/100 [00:01<00:09,  9.41it/s] 15%|█▌        | 15/100 [00:01<00:08,  9.51it/s] 16%|█▌        | 16/100 [00:01<00:08,  9.45it/s] 17%|█▋        | 17/100 [00:01<00:09,  9.12it/s] 18%|█▊        | 18/100 [00:01<00:09,  9.09it/s] 19%|█▉        | 19/100 [00:02<00:09,  8.94it/s] 21%|██        | 21/100 [00:02<00:08,  9.34it/s] 22%|██▏       | 22/100 [00:02<00:08,  9.35it/s] 23%|██▎       | 23/100 [00:02<00:08,  9.03it/s] 25%|██▌       | 25/100 [00:02<00:08,  9.35it/s] 26%|██▌       | 26/100 [00:02<00:07,  9.37it/s] 27%|██▋       | 27/100 [00:02<00:07,  9.49it/s] 28%|██▊       | 28/100 [00:03<00:07,  9.10it/s] 29%|██▉       | 29/100 [00:03<00:07,  9.11it/s] 30%|███       | 30/100 [00:03<00:07,  9.23it/s] 31%|███       | 31/100 [00:03<00:07,  9.27it/s] 32%|███▏      | 32/100 [00:03<00:07,  8.90it/s] 33%|███▎      | 33/100 [00:03<00:07,  9.06it/s] 34%|███▍      | 34/100 [00:03<00:07,  8.83it/s] 35%|███▌      | 35/100 [00:03<00:07,  8.39it/s] 36%|███▌      | 36/100 [00:03<00:07,  8.69it/s] 37%|███▋      | 37/100 [00:04<00:07,  8.44it/s] 38%|███▊      | 38/100 [00:04<00:07,  8.63it/s] 39%|███▉      | 39/100 [00:04<00:06,  9.00it/s] 40%|████      | 40/100 [00:04<00:06,  9.03it/s] 41%|████      | 41/100 [00:04<00:06,  9.24it/s] 42%|████▏     | 42/100 [00:04<00:06,  9.23it/s] 43%|████▎     | 43/100 [00:04<00:06,  9.41it/s] 45%|████▌     | 45/100 [00:04<00:05,  9.63it/s] 46%|████▌     | 46/100 [00:04<00:05,  9.63it/s] 47%|████▋     | 47/100 [00:05<00:05,  9.64it/s] 48%|████▊     | 48/100 [00:05<00:05,  9.23it/s] 49%|████▉     | 49/100 [00:05<00:05,  9.32it/s] 50%|█████     | 50/100 [00:05<00:05,  9.08it/s] 51%|█████     | 51/100 [00:05<00:05,  8.83it/s] 52%|█████▏    | 52/100 [00:05<00:05,  8.48it/s] 53%|█████▎    | 53/100 [00:05<00:05,  8.61it/s] 54%|█████▍    | 54/100 [00:05<00:05,  8.20it/s] 55%|█████▌    | 55/100 [00:06<00:07,  5.75it/s] 56%|█████▌    | 56/100 [00:06<00:06,  6.36it/s] 57%|█████▋    | 57/100 [00:06<00:06,  6.65it/s] 58%|█████▊    | 58/100 [00:06<00:05,  7.20it/s] 59%|█████▉    | 59/100 [00:06<00:05,  7.64it/s] 60%|██████    | 60/100 [00:06<00:04,  8.04it/s] 61%|██████    | 61/100 [00:06<00:04,  8.00it/s] 62%|██████▏   | 62/100 [00:07<00:04,  8.35it/s] 63%|██████▎   | 63/100 [00:07<00:04,  8.37it/s] 64%|██████▍   | 64/100 [00:07<00:04,  8.54it/s] 65%|██████▌   | 65/100 [00:07<00:04,  8.55it/s] 66%|██████▌   | 66/100 [00:07<00:03,  8.71it/s] 67%|██████▋   | 67/100 [00:07<00:03,  8.73it/s] 68%|██████▊   | 68/100 [00:07<00:03,  8.52it/s] 69%|██████▉   | 69/100 [00:07<00:03,  8.72it/s] 70%|███████   | 70/100 [00:07<00:03,  8.24it/s] 71%|███████   | 71/100 [00:08<00:03,  8.62it/s] 72%|███████▏  | 72/100 [00:08<00:03,  8.67it/s] 73%|███████▎  | 73/100 [00:08<00:03,  8.83it/s] 74%|███████▍  | 74/100 [00:08<00:02,  8.86it/s] 75%|███████▌  | 75/100 [00:08<00:02,  8.83it/s] 76%|███████▌  | 76/100 [00:08<00:02,  8.76it/s] 77%|███████▋  | 77/100 [00:08<00:02,  8.96it/s] 78%|███████▊  | 78/100 [00:08<00:02,  8.71it/s] 79%|███████▉  | 79/100 [00:08<00:02,  8.93it/s] 80%|████████  | 80/100 [00:09<00:02,  8.60it/s] 81%|████████  | 81/100 [00:09<00:02,  8.68it/s] 82%|████████▏ | 82/100 [00:09<00:02,  8.73it/s] 83%|████████▎ | 83/100 [00:09<00:01,  8.85it/s] 84%|████████▍ | 84/100 [00:09<00:01,  8.87it/s] 85%|████████▌ | 85/100 [00:09<00:01,  9.10it/s] 86%|████████▌ | 86/100 [00:09<00:01,  9.10it/s] 87%|████████▋ | 87/100 [00:09<00:01,  8.90it/s] 88%|████████▊ | 88/100 [00:09<00:01,  9.15it/s] 89%|████████▉ | 89/100 [00:10<00:01,  8.86it/s] 90%|█████████ | 90/100 [00:10<00:01,  8.85it/s] 91%|█████████ | 91/100 [00:10<00:01,  8.13it/s] 92%|█████████▏| 92/100 [00:10<00:00,  8.29it/s] 93%|█████████▎| 93/100 [00:10<00:00,  7.31it/s] 94%|█████████▍| 94/100 [00:10<00:00,  7.66it/s] 95%|█████████▌| 95/100 [00:10<00:00,  7.90it/s] 96%|█████████▌| 96/100 [00:11<00:00,  8.19it/s] 97%|█████████▋| 97/100 [00:11<00:00,  8.28it/s] 99%|█████████▉| 99/100 [00:11<00:00,  8.77it/s]100%|██████████| 100/100 [00:11<00:00,  8.81it/s]100%|██████████| 100/100 [00:11<00:00,  8.73it/s]
eval_p_index len:  14
individual_train 118
individual_eval 14
train data의 x, y, id 길이: 118 118 118
valid data의 x, y, id 길이: 9 9 9
test data의 x, y, id 길이: 5 5 5
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.661456, Valid_loss 0.680095
Epoch 2, Train Loss 0.646405, Valid_loss 0.672342
Epoch 3, Train Loss 0.635232, Valid_loss 0.662939
Epoch 4, Train Loss 0.628095, Valid_loss 0.656931
Epoch 5, Train Loss 0.618307, Valid_loss 0.654619
Epoch 6, Train Loss 0.614520, Valid_loss 0.649953
Epoch 7, Train Loss 0.610470, Valid_loss 0.648395
Epoch 8, Train Loss 0.605779, Valid_loss 0.644353
Epoch 9, Train Loss 0.601080, Valid_loss 0.641418
Epoch 10, Train Loss 0.598843, Valid_loss 0.638715
Epoch 11, Train Loss 0.599393, Valid_loss 0.636717
Epoch 12, Train Loss 0.597316, Valid_loss 0.636010
Epoch 13, Train Loss 0.594405, Valid_loss 0.634507
Epoch 14, Train Loss 0.593493, Valid_loss 0.633318
Epoch 15, Train Loss 0.562587, Valid_loss 0.613234
Epoch 16, Train Loss 0.555476, Valid_loss 0.600074
Epoch 17, Train Loss 0.537232, Valid_loss 0.590954
Epoch 18, Train Loss 0.535597, Valid_loss 0.583491
Epoch 19, Train Loss 0.537862, Valid_loss 0.576558
Epoch 20, Train Loss 0.531734, Valid_loss 0.572380
Epoch 21, Train Loss 0.524288, Valid_loss 0.570547
Epoch 22, Train Loss 0.526143, Valid_loss 0.568906
Epoch 23, Train Loss 0.518599, Valid_loss 0.567393
Epoch 24, Train Loss 0.521241, Valid_loss 0.564629
Epoch 25, Train Loss 0.516249, Valid_loss 0.563577
Epoch 26, Train Loss 0.511708, Valid_loss 0.561310
Epoch 27, Train Loss 0.523266, Valid_loss 0.558108
Epoch 28, Train Loss 0.514721, Valid_loss 0.554511
Epoch 29, Train Loss 0.514584, Valid_loss 0.554385
Epoch 30, Train Loss 0.514168, Valid_loss 0.551047
Epoch 31, Train Loss 0.509217, Valid_loss 0.549199
Epoch 32, Train Loss 0.509303, Valid_loss 0.546316
Epoch 33, Train Loss 0.500300, Valid_loss 0.545961
Epoch 34, Train Loss 0.505785, Valid_loss 0.545012
Epoch 35, Train Loss 0.505796, Valid_loss 0.542511
Epoch 36, Train Loss 0.499562, Valid_loss 0.541978
Epoch 37, Train Loss 0.499372, Valid_loss 0.542223
Epoch 38, Train Loss 0.497643, Valid_loss 0.540975
Epoch 39, Train Loss 0.502989, Valid_loss 0.540847
Epoch 40, Train Loss 0.493833, Valid_loss 0.537469
Epoch 41, Train Loss 0.495629, Valid_loss 0.537762
Epoch 42, Train Loss 0.488967, Valid_loss 0.536234
Epoch 43, Train Loss 0.496807, Valid_loss 0.535030
Epoch 44, Train Loss 0.489124, Valid_loss 0.534271
Epoch 45, Train Loss 0.491293, Valid_loss 0.531406
Epoch 46, Train Loss 0.494930, Valid_loss 0.531417
Epoch 47, Train Loss 0.488792, Valid_loss 0.528614
Epoch 48, Train Loss 0.484443, Valid_loss 0.526846
Epoch 49, Train Loss 0.485591, Valid_loss 0.526113
Epoch 50, Train Loss 0.487207, Valid_loss 0.524610
Epoch 51, Train Loss 0.482568, Valid_loss 0.524688
Epoch 52, Train Loss 0.489034, Valid_loss 0.524379
Epoch 53, Train Loss 0.485645, Valid_loss 0.523633
Epoch 54, Train Loss 0.481792, Valid_loss 0.523082
Epoch 55, Train Loss 0.491205, Valid_loss 0.522892
Epoch 56, Train Loss 0.480863, Valid_loss 0.521751
Epoch 57, Train Loss 0.484235, Valid_loss 0.520916
Epoch 58, Train Loss 0.481217, Valid_loss 0.521107
Epoch 59, Train Loss 0.477501, Valid_loss 0.520856
Epoch 60, Train Loss 0.472969, Valid_loss 0.521009
Epoch 61, Train Loss 0.476934, Valid_loss 0.520511
Epoch 62, Train Loss 0.488494, Valid_loss 0.520510
Epoch 63, Train Loss 0.479695, Valid_loss 0.519264
Epoch 64, Train Loss 0.484208, Valid_loss 0.518458
Epoch 65, Train Loss 0.476999, Valid_loss 0.518538
Epoch 66, Train Loss 0.480667, Valid_loss 0.518252
Epoch 67, Train Loss 0.479982, Valid_loss 0.517089
Epoch 68, Train Loss 0.474086, Valid_loss 0.516468
Epoch 69, Train Loss 0.483383, Valid_loss 0.516528
Epoch 70, Train Loss 0.471957, Valid_loss 0.516457
Epoch 71, Train Loss 0.476525, Valid_loss 0.515914
Epoch 72, Train Loss 0.474545, Valid_loss 0.515912
Epoch 73, Train Loss 0.467880, Valid_loss 0.515053
Epoch 74, Train Loss 0.474405, Valid_loss 0.514552
Epoch 75, Train Loss 0.469530, Valid_loss 0.513683
Epoch 76, Train Loss 0.478361, Valid_loss 0.513651
Epoch 77, Train Loss 0.474471, Valid_loss 0.512914
Epoch 78, Train Loss 0.474412, Valid_loss 0.512952
Epoch 79, Train Loss 0.476057, Valid_loss 0.513370
COVID19_Participant11 -- true: COVID-19 -- pred: normal
Control_Participant5 -- true: normal -- pred: normal
Control_Participant7 -- true: normal -- pred: COVID-19
COVID19_Participant26 -- true: COVID-19 -- pred: normal
Control_Participant7 -- true: normal -- pred: COVID-19
true :  [1, 0, 0, 1, 0]
pred :  [0, 0, 1, 0, 1]
Confusion Matrix: [1 2 2 0]
Best performance: Epoch 77, Loss 0.474471, Test ACC 0.200000, Test AUC 0.166667, Test Recall 0.000000, Test Precision 0.000000
✅ Total valid splits used: 1
🔁 Repeat 4, Fold 1
🔍 Split #2
  → train_p_index 환자 수: 27
  → test_p_index 환자 수: 5
  → train 환자 ID: ['COVID19_Participant11', 'COVID19_Participant13', 'COVID19_Participant14', 'COVID19_Participant15', 'COVID19_Participant17', 'COVID19_Participant19', 'COVID19_Participant2', 'COVID19_Participant20', 'COVID19_Participant22', 'COVID19_Participant23', 'COVID19_Participant25', 'COVID19_Participant26', 'COVID19_Participant29', 'COVID19_Participant31', 'COVID19_Participant32', 'COVID19_Participant37', 'COVID19_Participant4', 'COVID19_Participant40', 'COVID19_Participant7', 'Control_Participant10', 'Control_Participant11', 'Control_Participant15', 'Control_Participant3', 'Control_Participant4', 'Control_Participant7', 'Control_Participant8', 'Control_Participant9']
  → test  환자 ID: ['COVID19_Participant31', 'COVID19_Participant26', 'COVID19_Participant13', 'Control_Participant7', 'Control_Participant7']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: Control_Participant10, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant4, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant8, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: Control_Participant7, Label: 0
    ID: Control_Participant7, Label: 0
train_p_index_ 18
valid_p_index 9
test_p_index 5
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Keratinocytes', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Neurons', 'iPS_cells', 'Embryonic_stem_cells', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
data augment 실행 함
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:10,  9.27it/s]  2%|▏         | 2/100 [00:00<00:10,  9.08it/s]  3%|▎         | 3/100 [00:00<00:10,  8.92it/s]  4%|▍         | 4/100 [00:00<00:10,  9.14it/s]  5%|▌         | 5/100 [00:00<00:10,  9.12it/s]  6%|▌         | 6/100 [00:00<00:10,  9.26it/s]  7%|▋         | 7/100 [00:00<00:10,  9.04it/s]  8%|▊         | 8/100 [00:00<00:10,  9.16it/s]  9%|▉         | 9/100 [00:00<00:10,  8.98it/s] 10%|█         | 10/100 [00:01<00:10,  8.85it/s] 11%|█         | 11/100 [00:01<00:09,  8.91it/s] 12%|█▏        | 12/100 [00:01<00:09,  9.00it/s] 13%|█▎        | 13/100 [00:01<00:09,  9.01it/s] 14%|█▍        | 14/100 [00:01<00:09,  8.90it/s] 16%|█▌        | 16/100 [00:01<00:09,  9.18it/s] 17%|█▋        | 17/100 [00:01<00:09,  9.12it/s] 18%|█▊        | 18/100 [00:02<00:09,  8.76it/s] 19%|█▉        | 19/100 [00:02<00:09,  8.87it/s] 20%|██        | 20/100 [00:02<00:08,  9.10it/s] 21%|██        | 21/100 [00:02<00:10,  7.19it/s] 22%|██▏       | 22/100 [00:02<00:10,  7.46it/s] 23%|██▎       | 23/100 [00:02<00:09,  8.03it/s] 24%|██▍       | 24/100 [00:02<00:09,  8.09it/s] 25%|██▌       | 25/100 [00:02<00:09,  8.10it/s] 26%|██▌       | 26/100 [00:03<00:09,  8.02it/s] 27%|██▋       | 27/100 [00:03<00:08,  8.38it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.34it/s] 29%|██▉       | 29/100 [00:03<00:08,  8.36it/s] 30%|███       | 30/100 [00:03<00:08,  8.53it/s] 31%|███       | 31/100 [00:03<00:07,  8.64it/s] 32%|███▏      | 32/100 [00:03<00:07,  8.71it/s] 33%|███▎      | 33/100 [00:03<00:07,  8.68it/s] 34%|███▍      | 34/100 [00:03<00:07,  8.73it/s] 35%|███▌      | 35/100 [00:04<00:07,  8.61it/s] 36%|███▌      | 36/100 [00:04<00:07,  8.67it/s] 37%|███▋      | 37/100 [00:04<00:07,  8.60it/s] 38%|███▊      | 38/100 [00:04<00:07,  8.36it/s] 39%|███▉      | 39/100 [00:04<00:07,  8.57it/s] 40%|████      | 40/100 [00:04<00:06,  8.69it/s] 41%|████      | 41/100 [00:04<00:06,  8.54it/s] 42%|████▏     | 42/100 [00:04<00:06,  8.39it/s] 43%|████▎     | 43/100 [00:05<00:06,  8.33it/s] 44%|████▍     | 44/100 [00:05<00:06,  8.30it/s] 45%|████▌     | 45/100 [00:05<00:06,  8.12it/s] 46%|████▌     | 46/100 [00:05<00:06,  8.28it/s] 47%|████▋     | 47/100 [00:05<00:06,  8.47it/s] 48%|████▊     | 48/100 [00:05<00:06,  8.59it/s] 49%|████▉     | 49/100 [00:05<00:05,  8.63it/s] 50%|█████     | 50/100 [00:05<00:05,  8.76it/s] 51%|█████     | 51/100 [00:05<00:05,  8.58it/s] 52%|█████▏    | 52/100 [00:06<00:05,  8.07it/s] 53%|█████▎    | 53/100 [00:06<00:05,  8.16it/s] 54%|█████▍    | 54/100 [00:06<00:05,  7.97it/s] 55%|█████▌    | 55/100 [00:06<00:05,  8.02it/s] 56%|█████▌    | 56/100 [00:06<00:05,  8.05it/s] 57%|█████▋    | 57/100 [00:06<00:05,  8.09it/s] 58%|█████▊    | 58/100 [00:06<00:05,  8.16it/s] 59%|█████▉    | 59/100 [00:06<00:05,  8.18it/s] 60%|██████    | 60/100 [00:07<00:04,  8.18it/s] 61%|██████    | 61/100 [00:07<00:04,  8.22it/s] 62%|██████▏   | 62/100 [00:07<00:04,  8.26it/s] 63%|██████▎   | 63/100 [00:07<00:04,  8.19it/s] 64%|██████▍   | 64/100 [00:07<00:04,  8.30it/s] 65%|██████▌   | 65/100 [00:07<00:04,  8.16it/s] 66%|██████▌   | 66/100 [00:07<00:04,  8.17it/s] 67%|██████▋   | 67/100 [00:07<00:04,  8.08it/s] 68%|██████▊   | 68/100 [00:08<00:04,  7.89it/s] 69%|██████▉   | 69/100 [00:08<00:04,  7.69it/s] 70%|███████   | 70/100 [00:08<00:03,  7.77it/s] 71%|███████   | 71/100 [00:08<00:03,  7.77it/s] 72%|███████▏  | 72/100 [00:08<00:03,  7.12it/s] 73%|███████▎  | 73/100 [00:08<00:03,  7.42it/s] 74%|███████▍  | 74/100 [00:08<00:03,  7.68it/s] 75%|███████▌  | 75/100 [00:08<00:03,  7.95it/s] 76%|███████▌  | 76/100 [00:09<00:03,  7.97it/s] 77%|███████▋  | 77/100 [00:09<00:02,  8.12it/s] 78%|███████▊  | 78/100 [00:09<00:02,  8.11it/s] 79%|███████▉  | 79/100 [00:09<00:02,  7.85it/s] 80%|████████  | 80/100 [00:09<00:02,  7.84it/s] 81%|████████  | 81/100 [00:09<00:02,  7.79it/s] 82%|████████▏ | 82/100 [00:09<00:02,  7.86it/s] 83%|████████▎ | 83/100 [00:10<00:02,  7.35it/s] 84%|████████▍ | 84/100 [00:10<00:02,  7.52it/s] 85%|████████▌ | 85/100 [00:10<00:01,  7.65it/s] 86%|████████▌ | 86/100 [00:10<00:01,  7.75it/s] 87%|████████▋ | 87/100 [00:10<00:01,  7.83it/s] 88%|████████▊ | 88/100 [00:10<00:01,  7.87it/s] 89%|████████▉ | 89/100 [00:10<00:01,  7.92it/s] 90%|█████████ | 90/100 [00:10<00:01,  8.10it/s] 91%|█████████ | 91/100 [00:11<00:01,  8.04it/s] 92%|█████████▏| 92/100 [00:11<00:00,  8.16it/s] 93%|█████████▎| 93/100 [00:11<00:00,  7.73it/s] 94%|█████████▍| 94/100 [00:11<00:00,  8.02it/s] 95%|█████████▌| 95/100 [00:11<00:00,  7.32it/s] 96%|█████████▌| 96/100 [00:11<00:00,  7.49it/s] 97%|█████████▋| 97/100 [00:11<00:00,  7.74it/s] 98%|█████████▊| 98/100 [00:11<00:00,  7.42it/s] 99%|█████████▉| 99/100 [00:12<00:00,  7.54it/s]100%|██████████| 100/100 [00:12<00:00,  7.58it/s]100%|██████████| 100/100 [00:12<00:00,  8.20it/s]
eval_p_index len:  14
individual_train 118
individual_eval 14
train data의 x, y, id 길이: 118 118 118
valid data의 x, y, id 길이: 9 9 9
test data의 x, y, id 길이: 5 5 5
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.911843, Valid_loss 0.749747
Epoch 2, Train Loss 0.867250, Valid_loss 0.734315
Epoch 3, Train Loss 0.849322, Valid_loss 0.728324
Epoch 4, Train Loss 0.835662, Valid_loss 0.724067
Epoch 5, Train Loss 0.818559, Valid_loss 0.719720
Epoch 6, Train Loss 0.805119, Valid_loss 0.715170
Epoch 7, Train Loss 0.798185, Valid_loss 0.710852
Epoch 8, Train Loss 0.782559, Valid_loss 0.706654
Epoch 9, Train Loss 0.775396, Valid_loss 0.702661
Epoch 10, Train Loss 0.766059, Valid_loss 0.698934
Epoch 11, Train Loss 0.757871, Valid_loss 0.695476
Epoch 12, Train Loss 0.739647, Valid_loss 0.692463
Epoch 13, Train Loss 0.727368, Valid_loss 0.690187
Epoch 14, Train Loss 0.721151, Valid_loss 0.688053
Epoch 15, Train Loss 0.712643, Valid_loss 0.686206
Epoch 16, Train Loss 0.700917, Valid_loss 0.684596
Epoch 17, Train Loss 0.698230, Valid_loss 0.683177
Epoch 18, Train Loss 0.689069, Valid_loss 0.681862
Epoch 19, Train Loss 0.689262, Valid_loss 0.680690
Epoch 20, Train Loss 0.676290, Valid_loss 0.679686
Epoch 21, Train Loss 0.666137, Valid_loss 0.678763
Epoch 22, Train Loss 0.662545, Valid_loss 0.677865
Epoch 23, Train Loss 0.657626, Valid_loss 0.676995
Epoch 24, Train Loss 0.648999, Valid_loss 0.677181
Epoch 25, Train Loss 0.645710, Valid_loss 0.677053
Epoch 26, Train Loss 0.654649, Valid_loss 0.676244
Epoch 27, Train Loss 0.645938, Valid_loss 0.675340
Epoch 28, Train Loss 0.645414, Valid_loss 0.674679
Epoch 29, Train Loss 0.638728, Valid_loss 0.674292
Epoch 30, Train Loss 0.648454, Valid_loss 0.673752
Epoch 31, Train Loss 0.642147, Valid_loss 0.673087
Epoch 32, Train Loss 0.640044, Valid_loss 0.671997
Epoch 33, Train Loss 0.639059, Valid_loss 0.670987
Epoch 34, Train Loss 0.632467, Valid_loss 0.669971
Epoch 35, Train Loss 0.632935, Valid_loss 0.667502
Epoch 36, Train Loss 0.636429, Valid_loss 0.666354
Epoch 37, Train Loss 0.632667, Valid_loss 0.665065
Epoch 38, Train Loss 0.635003, Valid_loss 0.663403
Epoch 39, Train Loss 0.629298, Valid_loss 0.661558
Epoch 40, Train Loss 0.625896, Valid_loss 0.660978
Epoch 41, Train Loss 0.625596, Valid_loss 0.658597
Epoch 42, Train Loss 0.619766, Valid_loss 0.657557
Epoch 43, Train Loss 0.619401, Valid_loss 0.655955
Epoch 44, Train Loss 0.614351, Valid_loss 0.650803
Epoch 45, Train Loss 0.612928, Valid_loss 0.648855
Epoch 46, Train Loss 0.608894, Valid_loss 0.646934
Epoch 47, Train Loss 0.609289, Valid_loss 0.639997
Epoch 48, Train Loss 0.598681, Valid_loss 0.633789
Epoch 49, Train Loss 0.608833, Valid_loss 0.628115
Epoch 50, Train Loss 0.584663, Valid_loss 0.631935
Epoch 51, Train Loss 0.599343, Valid_loss 0.625866
Epoch 52, Train Loss 0.584442, Valid_loss 0.623319
Epoch 53, Train Loss 0.585734, Valid_loss 0.623405
Epoch 54, Train Loss 0.574523, Valid_loss 0.622549
Epoch 55, Train Loss 0.577487, Valid_loss 0.622977
Epoch 56, Train Loss 0.579206, Valid_loss 0.621588
Epoch 57, Train Loss 0.573820, Valid_loss 0.621568
Epoch 58, Train Loss 0.576478, Valid_loss 0.620465
Epoch 59, Train Loss 0.569630, Valid_loss 0.620327
Epoch 60, Train Loss 0.571723, Valid_loss 0.619201
Epoch 61, Train Loss 0.569533, Valid_loss 0.618749
Epoch 62, Train Loss 0.578369, Valid_loss 0.618074
Epoch 63, Train Loss 0.568313, Valid_loss 0.617913
Epoch 64, Train Loss 0.563254, Valid_loss 0.617478
Epoch 65, Train Loss 0.564936, Valid_loss 0.616099
Epoch 66, Train Loss 0.563143, Valid_loss 0.616623
Epoch 67, Train Loss 0.565876, Valid_loss 0.617828
COVID19_Participant31 -- true: COVID-19 -- pred: COVID-19
COVID19_Participant26 -- true: COVID-19 -- pred: normal
COVID19_Participant13 -- true: COVID-19 -- pred: COVID-19
Control_Participant7 -- true: normal -- pred: COVID-19
Control_Participant7 -- true: normal -- pred: COVID-19
true :  [1, 1, 1, 0, 0]
pred :  [1, 0, 1, 1, 1]
Confusion Matrix: [0 2 1 2]
Best performance: Epoch 65, Loss 0.564936, Test ACC 0.400000, Test AUC 0.333333, Test Recall 0.666667, Test Precision 0.500000
✅ Total valid splits used: 2
🔁 Repeat 4, Fold 2
🔍 Split #3
  → train_p_index 환자 수: 23
  → test_p_index 환자 수: 9
  → train 환자 ID: ['COVID19_Participant13', 'COVID19_Participant14', 'COVID19_Participant15', 'COVID19_Participant17', 'COVID19_Participant20', 'COVID19_Participant23', 'COVID19_Participant25', 'COVID19_Participant28', 'COVID19_Participant29', 'COVID19_Participant31', 'COVID19_Participant32', 'COVID19_Participant37', 'COVID19_Participant39', 'COVID19_Participant4', 'COVID19_Participant40', 'COVID19_Participant8', 'Control_Participant1', 'Control_Participant10', 'Control_Participant11', 'Control_Participant3', 'Control_Participant5', 'Control_Participant7', 'Control_Participant9']
  → test  환자 ID: ['COVID19_Participant31', 'COVID19_Participant5', 'Control_Participant3', 'Control_Participant1', 'Control_Participant7', 'COVID19_Participant13', 'Control_Participant3', 'COVID19_Participant13', 'Control_Participant5']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant10, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant5, Label: 1
    ID: Control_Participant3, Label: 1
    ID: Control_Participant1, Label: 1
    ID: Control_Participant7, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: Control_Participant3, Label: 0
    ID: COVID19_Participant13, Label: 0
    ID: Control_Participant5, Label: 0
train_p_index_ 15
valid_p_index 8
test_p_index 9
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Keratinocytes', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Neurons', 'iPS_cells', 'Embryonic_stem_cells', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
data augment 실행 함
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:11,  8.34it/s]  2%|▏         | 2/100 [00:00<00:11,  8.54it/s]  3%|▎         | 3/100 [00:00<00:11,  8.14it/s]  4%|▍         | 4/100 [00:00<00:11,  8.44it/s]  5%|▌         | 5/100 [00:00<00:11,  8.49it/s]  6%|▌         | 6/100 [00:00<00:11,  8.18it/s]  7%|▋         | 7/100 [00:00<00:11,  8.18it/s]  8%|▊         | 8/100 [00:00<00:11,  8.04it/s]  9%|▉         | 9/100 [00:01<00:10,  8.32it/s] 10%|█         | 10/100 [00:01<00:10,  8.21it/s] 11%|█         | 11/100 [00:01<00:10,  8.36it/s] 12%|█▏        | 12/100 [00:01<00:10,  8.47it/s] 13%|█▎        | 13/100 [00:01<00:10,  8.41it/s] 14%|█▍        | 14/100 [00:01<00:10,  8.35it/s] 15%|█▌        | 15/100 [00:01<00:10,  8.28it/s] 16%|█▌        | 16/100 [00:01<00:09,  8.50it/s] 17%|█▋        | 17/100 [00:02<00:09,  8.41it/s] 18%|█▊        | 18/100 [00:02<00:09,  8.25it/s] 19%|█▉        | 19/100 [00:02<00:09,  8.19it/s] 20%|██        | 20/100 [00:02<00:09,  8.30it/s] 21%|██        | 21/100 [00:02<00:10,  7.89it/s] 22%|██▏       | 22/100 [00:02<00:09,  8.01it/s] 23%|██▎       | 23/100 [00:02<00:09,  8.01it/s] 24%|██▍       | 24/100 [00:02<00:09,  8.02it/s] 25%|██▌       | 25/100 [00:03<00:09,  7.85it/s] 26%|██▌       | 26/100 [00:03<00:09,  7.86it/s] 27%|██▋       | 27/100 [00:03<00:09,  8.06it/s] 28%|██▊       | 28/100 [00:03<00:09,  7.77it/s] 29%|██▉       | 29/100 [00:03<00:09,  7.72it/s] 30%|███       | 30/100 [00:03<00:08,  7.78it/s] 31%|███       | 31/100 [00:03<00:08,  7.88it/s] 32%|███▏      | 32/100 [00:03<00:08,  8.00it/s] 33%|███▎      | 33/100 [00:04<00:08,  8.05it/s] 34%|███▍      | 34/100 [00:04<00:08,  7.85it/s] 35%|███▌      | 35/100 [00:04<00:08,  7.92it/s] 36%|███▌      | 36/100 [00:04<00:08,  7.65it/s] 37%|███▋      | 37/100 [00:04<00:08,  7.74it/s] 38%|███▊      | 38/100 [00:04<00:07,  7.78it/s] 39%|███▉      | 39/100 [00:04<00:07,  7.92it/s] 40%|████      | 40/100 [00:04<00:07,  8.04it/s] 41%|████      | 41/100 [00:05<00:07,  7.97it/s] 42%|████▏     | 42/100 [00:05<00:07,  8.21it/s] 43%|████▎     | 43/100 [00:05<00:07,  7.96it/s] 44%|████▍     | 44/100 [00:05<00:07,  7.86it/s] 45%|████▌     | 45/100 [00:05<00:06,  7.94it/s] 46%|████▌     | 46/100 [00:05<00:06,  7.87it/s] 47%|████▋     | 47/100 [00:05<00:06,  7.73it/s] 48%|████▊     | 48/100 [00:05<00:06,  7.52it/s] 49%|████▉     | 49/100 [00:06<00:06,  7.65it/s] 50%|█████     | 50/100 [00:06<00:06,  7.67it/s] 51%|█████     | 51/100 [00:06<00:06,  7.66it/s] 52%|█████▏    | 52/100 [00:06<00:06,  7.89it/s] 53%|█████▎    | 53/100 [00:06<00:05,  7.85it/s] 54%|█████▍    | 54/100 [00:06<00:05,  7.91it/s] 55%|█████▌    | 55/100 [00:06<00:05,  7.87it/s] 56%|█████▌    | 56/100 [00:07<00:05,  7.79it/s] 57%|█████▋    | 57/100 [00:07<00:05,  7.90it/s] 58%|█████▊    | 58/100 [00:07<00:05,  7.98it/s] 59%|█████▉    | 59/100 [00:07<00:05,  8.02it/s] 60%|██████    | 60/100 [00:07<00:05,  7.94it/s] 61%|██████    | 61/100 [00:07<00:04,  8.19it/s] 62%|██████▏   | 62/100 [00:07<00:04,  8.01it/s] 63%|██████▎   | 63/100 [00:07<00:04,  7.92it/s] 64%|██████▍   | 64/100 [00:08<00:04,  7.83it/s] 65%|██████▌   | 65/100 [00:08<00:04,  7.84it/s] 66%|██████▌   | 66/100 [00:08<00:04,  7.62it/s] 67%|██████▋   | 67/100 [00:08<00:04,  7.73it/s] 68%|██████▊   | 68/100 [00:08<00:04,  7.77it/s] 69%|██████▉   | 69/100 [00:08<00:03,  7.89it/s] 70%|███████   | 70/100 [00:08<00:03,  7.93it/s] 71%|███████   | 71/100 [00:08<00:03,  7.72it/s] 72%|███████▏  | 72/100 [00:09<00:03,  7.86it/s] 73%|███████▎  | 73/100 [00:09<00:03,  7.90it/s] 74%|███████▍  | 74/100 [00:09<00:03,  7.75it/s] 75%|███████▌  | 75/100 [00:09<00:03,  7.67it/s] 76%|███████▌  | 76/100 [00:09<00:03,  7.67it/s] 77%|███████▋  | 77/100 [00:09<00:03,  7.58it/s] 78%|███████▊  | 78/100 [00:09<00:02,  7.72it/s] 79%|███████▉  | 79/100 [00:09<00:02,  7.89it/s] 80%|████████  | 80/100 [00:10<00:02,  7.66it/s] 81%|████████  | 81/100 [00:10<00:02,  7.51it/s] 82%|████████▏ | 82/100 [00:10<00:02,  7.17it/s] 83%|████████▎ | 83/100 [00:10<00:02,  7.34it/s] 84%|████████▍ | 84/100 [00:10<00:02,  7.17it/s] 85%|████████▌ | 85/100 [00:10<00:02,  7.28it/s] 86%|████████▌ | 86/100 [00:10<00:01,  7.33it/s] 87%|████████▋ | 87/100 [00:11<00:01,  7.45it/s] 88%|████████▊ | 88/100 [00:11<00:01,  7.39it/s] 89%|████████▉ | 89/100 [00:11<00:01,  7.14it/s] 90%|█████████ | 90/100 [00:11<00:01,  7.08it/s] 91%|█████████ | 91/100 [00:11<00:01,  7.32it/s] 92%|█████████▏| 92/100 [00:11<00:01,  7.11it/s] 93%|█████████▎| 93/100 [00:11<00:00,  7.18it/s] 94%|█████████▍| 94/100 [00:12<00:00,  7.38it/s] 95%|█████████▌| 95/100 [00:12<00:00,  7.51it/s] 96%|█████████▌| 96/100 [00:12<00:00,  7.76it/s] 97%|█████████▋| 97/100 [00:12<00:00,  7.64it/s] 98%|█████████▊| 98/100 [00:12<00:00,  7.34it/s] 99%|█████████▉| 99/100 [00:12<00:00,  7.31it/s]100%|██████████| 100/100 [00:12<00:00,  7.41it/s]100%|██████████| 100/100 [00:12<00:00,  7.81it/s]
eval_p_index len:  17
individual_train 115
individual_eval 17
train data의 x, y, id 길이: 115 115 115
valid data의 x, y, id 길이: 8 8 8
test data의 x, y, id 길이: 9 9 9
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.694400, Valid_loss 0.669127
Epoch 2, Train Loss 0.657652, Valid_loss 0.650564
Epoch 3, Train Loss 0.607672, Valid_loss 0.644588
Epoch 4, Train Loss 0.608732, Valid_loss 0.642091
Epoch 5, Train Loss 0.606838, Valid_loss 0.641436
Epoch 6, Train Loss 0.596564, Valid_loss 0.639579
Epoch 7, Train Loss 0.582014, Valid_loss 0.636575
Epoch 8, Train Loss 0.577261, Valid_loss 0.633337
Epoch 9, Train Loss 0.557143, Valid_loss 0.627755
Epoch 10, Train Loss 0.567345, Valid_loss 0.623946
Epoch 11, Train Loss 0.545352, Valid_loss 0.616840
Epoch 12, Train Loss 0.529931, Valid_loss 0.608528
Epoch 13, Train Loss 0.536728, Valid_loss 0.604211
Epoch 14, Train Loss 0.533944, Valid_loss 0.600625
Epoch 15, Train Loss 0.515760, Valid_loss 0.597548
Epoch 16, Train Loss 0.510947, Valid_loss 0.594659
Epoch 17, Train Loss 0.522925, Valid_loss 0.587607
Epoch 18, Train Loss 0.488036, Valid_loss 0.576216
Epoch 19, Train Loss 0.500612, Valid_loss 0.568568
Epoch 20, Train Loss 0.502396, Valid_loss 0.559849
Epoch 21, Train Loss 0.484032, Valid_loss 0.550207
Epoch 22, Train Loss 0.467797, Valid_loss 0.544218
Epoch 23, Train Loss 0.469249, Valid_loss 0.547340
Epoch 24, Train Loss 0.471093, Valid_loss 0.542734
Epoch 25, Train Loss 0.474640, Valid_loss 0.532489
Epoch 26, Train Loss 0.452923, Valid_loss 0.525015
Epoch 27, Train Loss 0.469309, Valid_loss 0.529300
Epoch 28, Train Loss 0.468945, Valid_loss 0.525619
Epoch 29, Train Loss 0.457182, Valid_loss 0.514113
Epoch 30, Train Loss 0.442061, Valid_loss 0.511119
Epoch 31, Train Loss 0.444017, Valid_loss 0.515029
Epoch 32, Train Loss 0.449344, Valid_loss 0.507776
Epoch 33, Train Loss 0.437852, Valid_loss 0.502713
Epoch 34, Train Loss 0.441902, Valid_loss 0.501250
Epoch 35, Train Loss 0.441480, Valid_loss 0.501583
Epoch 36, Train Loss 0.425581, Valid_loss 0.499709
Epoch 37, Train Loss 0.442452, Valid_loss 0.497876
Epoch 38, Train Loss 0.439169, Valid_loss 0.496443
Epoch 39, Train Loss 0.433519, Valid_loss 0.492058
Epoch 40, Train Loss 0.425209, Valid_loss 0.493574
Epoch 41, Train Loss 0.432886, Valid_loss 0.490246
Epoch 42, Train Loss 0.420160, Valid_loss 0.489866
Epoch 43, Train Loss 0.432136, Valid_loss 0.489637
Epoch 44, Train Loss 0.432860, Valid_loss 0.487207
Epoch 45, Train Loss 0.416115, Valid_loss 0.487896
Epoch 46, Train Loss 0.408753, Valid_loss 0.486146
Epoch 47, Train Loss 0.420472, Valid_loss 0.484476
Epoch 48, Train Loss 0.417384, Valid_loss 0.482726
Epoch 49, Train Loss 0.424593, Valid_loss 0.479276
Epoch 50, Train Loss 0.422328, Valid_loss 0.481108
Epoch 51, Train Loss 0.416610, Valid_loss 0.483057
Epoch 52, Train Loss 0.427919, Valid_loss 0.481713
Epoch 53, Train Loss 0.421947, Valid_loss 0.478031
Epoch 54, Train Loss 0.412269, Valid_loss 0.477575
Epoch 55, Train Loss 0.406173, Valid_loss 0.479908
Epoch 56, Train Loss 0.417206, Valid_loss 0.479957
COVID19_Participant31 -- true: COVID-19 -- pred: normal
COVID19_Participant5 -- true: COVID-19 -- pred: COVID-19
Control_Participant3 -- true: normal -- pred: normal
Control_Participant1 -- true: normal -- pred: normal
Control_Participant7 -- true: normal -- pred: normal
COVID19_Participant13 -- true: COVID-19 -- pred: COVID-19
Control_Participant3 -- true: normal -- pred: normal
COVID19_Participant13 -- true: COVID-19 -- pred: COVID-19
Control_Participant5 -- true: normal -- pred: normal
true :  [1, 1, 0, 0, 0, 1, 0, 1, 0]
pred :  [0, 1, 0, 0, 0, 1, 0, 1, 0]
Confusion Matrix: [5 0 1 3]
Best performance: Epoch 54, Loss 0.412269, Test ACC 0.888889, Test AUC 0.950000, Test Recall 0.750000, Test Precision 1.000000
✅ Total valid splits used: 3
🔁 Repeat 4, Fold 3
🔍 Split #4
  → train_p_index 환자 수: 26
  → test_p_index 환자 수: 6
  → train 환자 ID: ['COVID19_Participant11', 'COVID19_Participant13', 'COVID19_Participant15', 'COVID19_Participant19', 'COVID19_Participant2', 'COVID19_Participant20', 'COVID19_Participant22', 'COVID19_Participant23', 'COVID19_Participant25', 'COVID19_Participant26', 'COVID19_Participant28', 'COVID19_Participant29', 'COVID19_Participant31', 'COVID19_Participant32', 'COVID19_Participant39', 'COVID19_Participant4', 'COVID19_Participant7', 'COVID19_Participant8', 'Control_Participant1', 'Control_Participant10', 'Control_Participant11', 'Control_Participant15', 'Control_Participant4', 'Control_Participant5', 'Control_Participant7', 'Control_Participant8']
  → test  환자 ID: ['Control_Participant4', 'Control_Participant4', 'COVID19_Participant26', 'COVID19_Participant7', 'Control_Participant7', 'COVID19_Participant31']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant10, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant4, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant8, Label: 0
  → test 환자 ID 및 라벨:
    ID: Control_Participant4, Label: 1
    ID: Control_Participant4, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: Control_Participant7, Label: 0
    ID: COVID19_Participant31, Label: 0
train_p_index_ 17
valid_p_index 9
test_p_index 6
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Keratinocytes', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Neurons', 'iPS_cells', 'Embryonic_stem_cells', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
data augment 실행 함
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:11,  8.62it/s]  2%|▏         | 2/100 [00:00<00:10,  9.18it/s]  3%|▎         | 3/100 [00:00<00:11,  8.79it/s]  4%|▍         | 4/100 [00:00<00:10,  8.95it/s]  5%|▌         | 5/100 [00:00<00:10,  9.27it/s]  6%|▌         | 6/100 [00:00<00:10,  9.12it/s]  7%|▋         | 7/100 [00:00<00:10,  8.92it/s]  8%|▊         | 8/100 [00:00<00:10,  8.84it/s]  9%|▉         | 9/100 [00:00<00:09,  9.15it/s] 10%|█         | 10/100 [00:01<00:09,  9.22it/s] 11%|█         | 11/100 [00:01<00:09,  9.06it/s] 12%|█▏        | 12/100 [00:01<00:10,  8.71it/s] 13%|█▎        | 13/100 [00:01<00:10,  8.69it/s] 14%|█▍        | 14/100 [00:01<00:09,  8.74it/s] 15%|█▌        | 15/100 [00:01<00:10,  8.48it/s] 16%|█▌        | 16/100 [00:01<00:10,  8.33it/s] 17%|█▋        | 17/100 [00:01<00:09,  8.71it/s] 18%|█▊        | 18/100 [00:02<00:09,  8.81it/s] 20%|██        | 20/100 [00:02<00:08,  8.95it/s] 21%|██        | 21/100 [00:02<00:08,  8.89it/s] 22%|██▏       | 22/100 [00:02<00:08,  8.89it/s] 23%|██▎       | 23/100 [00:02<00:08,  9.04it/s] 24%|██▍       | 24/100 [00:02<00:08,  9.15it/s] 25%|██▌       | 25/100 [00:02<00:08,  9.17it/s] 26%|██▌       | 26/100 [00:02<00:08,  8.67it/s] 27%|██▋       | 27/100 [00:03<00:08,  8.65it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.70it/s] 29%|██▉       | 29/100 [00:03<00:07,  8.92it/s] 30%|███       | 30/100 [00:03<00:08,  8.54it/s] 31%|███       | 31/100 [00:03<00:07,  8.84it/s] 32%|███▏      | 32/100 [00:03<00:07,  8.68it/s] 33%|███▎      | 33/100 [00:03<00:07,  8.85it/s] 34%|███▍      | 34/100 [00:03<00:07,  8.97it/s] 35%|███▌      | 35/100 [00:03<00:07,  8.80it/s] 36%|███▌      | 36/100 [00:04<00:07,  8.30it/s] 37%|███▋      | 37/100 [00:04<00:07,  8.61it/s] 38%|███▊      | 38/100 [00:04<00:07,  8.79it/s] 39%|███▉      | 39/100 [00:04<00:06,  8.96it/s] 40%|████      | 40/100 [00:04<00:06,  8.88it/s] 41%|████      | 41/100 [00:04<00:06,  8.86it/s] 42%|████▏     | 42/100 [00:04<00:06,  8.91it/s] 43%|████▎     | 43/100 [00:04<00:06,  8.58it/s] 44%|████▍     | 44/100 [00:04<00:06,  8.64it/s] 45%|████▌     | 45/100 [00:05<00:06,  8.66it/s] 46%|████▌     | 46/100 [00:05<00:06,  8.55it/s] 47%|████▋     | 47/100 [00:05<00:06,  8.47it/s] 48%|████▊     | 48/100 [00:05<00:06,  8.50it/s] 49%|████▉     | 49/100 [00:05<00:05,  8.70it/s] 50%|█████     | 50/100 [00:05<00:05,  8.58it/s] 51%|█████     | 51/100 [00:05<00:05,  8.61it/s] 52%|█████▏    | 52/100 [00:05<00:05,  8.37it/s] 53%|█████▎    | 53/100 [00:06<00:05,  8.16it/s] 54%|█████▍    | 54/100 [00:06<00:05,  8.52it/s] 55%|█████▌    | 55/100 [00:06<00:05,  8.44it/s] 56%|█████▌    | 56/100 [00:06<00:05,  8.34it/s] 57%|█████▋    | 57/100 [00:06<00:05,  8.40it/s] 58%|█████▊    | 58/100 [00:06<00:05,  8.29it/s] 59%|█████▉    | 59/100 [00:06<00:05,  8.16it/s] 60%|██████    | 60/100 [00:06<00:04,  8.34it/s] 61%|██████    | 61/100 [00:07<00:04,  8.12it/s] 62%|██████▏   | 62/100 [00:07<00:04,  8.05it/s] 63%|██████▎   | 63/100 [00:07<00:04,  8.13it/s] 64%|██████▍   | 64/100 [00:07<00:04,  8.07it/s] 65%|██████▌   | 65/100 [00:07<00:04,  8.19it/s] 66%|██████▌   | 66/100 [00:07<00:04,  7.98it/s] 67%|██████▋   | 67/100 [00:07<00:04,  8.06it/s] 68%|██████▊   | 68/100 [00:07<00:03,  8.12it/s] 69%|██████▉   | 69/100 [00:08<00:03,  8.19it/s] 70%|███████   | 70/100 [00:08<00:03,  7.85it/s] 71%|███████   | 71/100 [00:08<00:03,  8.10it/s] 72%|███████▏  | 72/100 [00:08<00:03,  8.10it/s] 73%|███████▎  | 73/100 [00:08<00:03,  7.55it/s] 74%|███████▍  | 74/100 [00:08<00:03,  7.73it/s] 75%|███████▌  | 75/100 [00:08<00:03,  7.88it/s] 76%|███████▌  | 76/100 [00:08<00:03,  7.98it/s] 77%|███████▋  | 77/100 [00:09<00:02,  8.04it/s] 78%|███████▊  | 78/100 [00:09<00:02,  8.07it/s] 79%|███████▉  | 79/100 [00:09<00:02,  8.00it/s] 80%|████████  | 80/100 [00:09<00:02,  7.91it/s] 81%|████████  | 81/100 [00:09<00:02,  8.15it/s] 82%|████████▏ | 82/100 [00:09<00:02,  8.12it/s] 83%|████████▎ | 83/100 [00:09<00:02,  8.36it/s] 84%|████████▍ | 84/100 [00:09<00:01,  8.28it/s] 85%|████████▌ | 85/100 [00:10<00:01,  8.27it/s] 86%|████████▌ | 86/100 [00:10<00:01,  8.11it/s] 87%|████████▋ | 87/100 [00:10<00:01,  7.89it/s] 88%|████████▊ | 88/100 [00:10<00:01,  7.77it/s] 89%|████████▉ | 89/100 [00:10<00:01,  7.82it/s] 90%|█████████ | 90/100 [00:10<00:01,  7.87it/s] 91%|█████████ | 91/100 [00:10<00:01,  7.51it/s] 92%|█████████▏| 92/100 [00:10<00:01,  7.58it/s] 93%|█████████▎| 93/100 [00:11<00:00,  7.72it/s] 94%|█████████▍| 94/100 [00:11<00:00,  7.78it/s] 95%|█████████▌| 95/100 [00:11<00:00,  7.68it/s] 96%|█████████▌| 96/100 [00:11<00:00,  7.75it/s] 97%|█████████▋| 97/100 [00:11<00:00,  7.81it/s] 98%|█████████▊| 98/100 [00:11<00:00,  7.68it/s] 99%|█████████▉| 99/100 [00:11<00:00,  7.92it/s]100%|██████████| 100/100 [00:11<00:00,  8.04it/s]100%|██████████| 100/100 [00:11<00:00,  8.38it/s]
eval_p_index len:  15
individual_train 117
individual_eval 15
train data의 x, y, id 길이: 117 117 117
valid data의 x, y, id 길이: 9 9 9
test data의 x, y, id 길이: 6 6 6
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.507243, Valid_loss 0.807999
Epoch 2, Train Loss 0.478760, Valid_loss 0.827462
Epoch 3, Train Loss 0.491194, Valid_loss 0.845412
Epoch 4, Train Loss 0.476986, Valid_loss 0.862095
Epoch 5, Train Loss 0.456917, Valid_loss 0.878942
Epoch 6, Train Loss 0.458595, Valid_loss 0.893209
Epoch 7, Train Loss 0.450505, Valid_loss 0.906180
Epoch 8, Train Loss 0.454413, Valid_loss 0.913807
Epoch 9, Train Loss 0.426026, Valid_loss 0.907380
Epoch 10, Train Loss 0.397673, Valid_loss 0.904997
Epoch 11, Train Loss 0.397572, Valid_loss 0.923630
Epoch 12, Train Loss 0.383828, Valid_loss 0.908466
Epoch 13, Train Loss 0.388804, Valid_loss 0.919756
Epoch 14, Train Loss 0.381864, Valid_loss 0.918806
Epoch 15, Train Loss 0.375539, Valid_loss 0.915191
Epoch 16, Train Loss 0.371942, Valid_loss 0.906963
Epoch 17, Train Loss 0.393865, Valid_loss 0.897417
Epoch 18, Train Loss 0.381134, Valid_loss 0.884318
Epoch 19, Train Loss 0.385172, Valid_loss 0.875081
Epoch 20, Train Loss 0.376969, Valid_loss 0.851841
Epoch 21, Train Loss 0.351123, Valid_loss 0.848341
Epoch 22, Train Loss 0.362575, Valid_loss 0.845980
Epoch 23, Train Loss 0.357880, Valid_loss 0.840677
Epoch 24, Train Loss 0.341277, Valid_loss 0.848074
Epoch 25, Train Loss 0.358433, Valid_loss 0.854217
Epoch 26, Train Loss 0.350958, Valid_loss 0.857502
Epoch 27, Train Loss 0.351610, Valid_loss 0.853481
Epoch 28, Train Loss 0.333739, Valid_loss 0.856883
Epoch 29, Train Loss 0.334611, Valid_loss 0.855546
Epoch 30, Train Loss 0.328535, Valid_loss 0.854091
Epoch 31, Train Loss 0.338704, Valid_loss 0.856423
Epoch 32, Train Loss 0.327704, Valid_loss 0.857797
Epoch 33, Train Loss 0.327753, Valid_loss 0.852866
Epoch 34, Train Loss 0.359665, Valid_loss 0.855919
Epoch 35, Train Loss 0.346296, Valid_loss 0.855652
Epoch 36, Train Loss 0.324218, Valid_loss 0.848838
Epoch 37, Train Loss 0.347092, Valid_loss 0.858371
Epoch 38, Train Loss 0.326100, Valid_loss 0.842053
Epoch 39, Train Loss 0.335696, Valid_loss 0.849816
Epoch 40, Train Loss 0.316597, Valid_loss 0.838985
Epoch 41, Train Loss 0.315334, Valid_loss 0.846046
Epoch 42, Train Loss 0.322018, Valid_loss 0.834159
Epoch 43, Train Loss 0.318816, Valid_loss 0.842489
Epoch 44, Train Loss 0.326948, Valid_loss 0.828895
Epoch 45, Train Loss 0.325309, Valid_loss 0.814869
Epoch 46, Train Loss 0.317681, Valid_loss 0.816136
Epoch 47, Train Loss 0.320736, Valid_loss 0.805497
Epoch 48, Train Loss 0.318891, Valid_loss 0.811152
Epoch 49, Train Loss 0.311181, Valid_loss 0.817667
Epoch 50, Train Loss 0.310831, Valid_loss 0.810812
Epoch 51, Train Loss 0.299134, Valid_loss 0.812303
Epoch 52, Train Loss 0.306910, Valid_loss 0.815961
Control_Participant4 -- true: normal -- pred: COVID-19
Control_Participant4 -- true: normal -- pred: COVID-19
COVID19_Participant26 -- true: COVID-19 -- pred: COVID-19
COVID19_Participant7 -- true: COVID-19 -- pred: COVID-19
Control_Participant7 -- true: normal -- pred: COVID-19
COVID19_Participant31 -- true: COVID-19 -- pred: COVID-19
true :  [0, 0, 1, 1, 0, 1]
pred :  [1, 1, 1, 1, 1, 1]
Confusion Matrix: [0 3 0 3]
Best performance: Epoch 47, Loss 0.320736, Test ACC 0.500000, Test AUC 0.333333, Test Recall 1.000000, Test Precision 0.500000
✅ Total valid splits used: 4
🔁 Repeat 4, Fold 4
🔍 Split #5
  → train_p_index 환자 수: 25
  → test_p_index 환자 수: 7
  → train 환자 ID: ['COVID19_Participant11', 'COVID19_Participant14', 'COVID19_Participant17', 'COVID19_Participant19', 'COVID19_Participant2', 'COVID19_Participant20', 'COVID19_Participant22', 'COVID19_Participant26', 'COVID19_Participant28', 'COVID19_Participant29', 'COVID19_Participant31', 'COVID19_Participant32', 'COVID19_Participant37', 'COVID19_Participant39', 'COVID19_Participant40', 'COVID19_Participant7', 'COVID19_Participant8', 'Control_Participant1', 'Control_Participant10', 'Control_Participant15', 'Control_Participant3', 'Control_Participant4', 'Control_Participant5', 'Control_Participant8', 'Control_Participant9']
  → test  환자 ID: ['COVID19_Participant26', 'Control_Participant3', 'Control_Participant1', 'Control_Participant4', 'Control_Participant1', 'COVID19_Participant7', 'COVID19_Participant31']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant10, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant4, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant8, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: COVID19_Participant26, Label: 1
    ID: Control_Participant3, Label: 1
    ID: Control_Participant1, Label: 1
    ID: Control_Participant4, Label: 1
    ID: Control_Participant1, Label: 1
    ID: COVID19_Participant7, Label: 0
    ID: COVID19_Participant31, Label: 0
train_p_index_ 16
valid_p_index 9
test_p_index 7
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Epithelial_cells', 'Epithelial_cells', 'NK_cell', 'Epithelial_cells', 'Epithelial_cells', 'Keratinocytes', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
data augment 실행 함
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:10,  9.06it/s]  2%|▏         | 2/100 [00:00<00:10,  9.00it/s]  3%|▎         | 3/100 [00:00<00:11,  8.59it/s]  4%|▍         | 4/100 [00:00<00:11,  8.71it/s]  5%|▌         | 5/100 [00:00<00:10,  8.84it/s]  6%|▌         | 6/100 [00:00<00:10,  9.01it/s]  7%|▋         | 7/100 [00:00<00:10,  9.11it/s]  8%|▊         | 8/100 [00:00<00:10,  9.02it/s]  9%|▉         | 9/100 [00:01<00:10,  9.04it/s] 10%|█         | 10/100 [00:01<00:10,  8.91it/s] 11%|█         | 11/100 [00:01<00:09,  8.97it/s] 12%|█▏        | 12/100 [00:01<00:09,  9.00it/s] 13%|█▎        | 13/100 [00:01<00:10,  8.43it/s] 14%|█▍        | 14/100 [00:01<00:10,  8.58it/s] 15%|█▌        | 15/100 [00:01<00:09,  8.74it/s] 16%|█▌        | 16/100 [00:01<00:09,  8.83it/s] 17%|█▋        | 17/100 [00:01<00:09,  8.50it/s] 18%|█▊        | 18/100 [00:02<00:09,  8.55it/s] 19%|█▉        | 19/100 [00:02<00:09,  8.53it/s] 20%|██        | 20/100 [00:02<00:09,  8.57it/s] 21%|██        | 21/100 [00:02<00:09,  8.40it/s] 22%|██▏       | 22/100 [00:02<00:09,  8.35it/s] 23%|██▎       | 23/100 [00:02<00:09,  8.17it/s] 24%|██▍       | 24/100 [00:02<00:09,  8.13it/s] 25%|██▌       | 25/100 [00:02<00:09,  8.28it/s] 26%|██▌       | 26/100 [00:03<00:09,  8.22it/s] 27%|██▋       | 27/100 [00:03<00:08,  8.18it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.37it/s] 29%|██▉       | 29/100 [00:03<00:08,  8.51it/s] 30%|███       | 30/100 [00:03<00:08,  8.58it/s] 31%|███       | 31/100 [00:03<00:07,  8.66it/s] 32%|███▏      | 32/100 [00:03<00:07,  8.71it/s] 33%|███▎      | 33/100 [00:03<00:07,  8.63it/s] 34%|███▍      | 34/100 [00:03<00:07,  8.62it/s] 35%|███▌      | 35/100 [00:04<00:07,  8.39it/s] 36%|███▌      | 36/100 [00:04<00:07,  8.08it/s] 37%|███▋      | 37/100 [00:04<00:07,  7.92it/s] 38%|███▊      | 38/100 [00:04<00:07,  7.93it/s] 39%|███▉      | 39/100 [00:04<00:07,  8.03it/s] 40%|████      | 40/100 [00:04<00:07,  7.95it/s] 41%|████      | 41/100 [00:04<00:08,  6.95it/s] 42%|████▏     | 42/100 [00:05<00:08,  7.23it/s] 43%|████▎     | 43/100 [00:05<00:07,  7.30it/s] 44%|████▍     | 44/100 [00:05<00:07,  7.69it/s] 45%|████▌     | 45/100 [00:05<00:07,  7.72it/s] 46%|████▌     | 46/100 [00:05<00:06,  7.82it/s] 47%|████▋     | 47/100 [00:05<00:06,  7.97it/s] 48%|████▊     | 48/100 [00:05<00:06,  7.89it/s] 49%|████▉     | 49/100 [00:05<00:06,  7.88it/s] 50%|█████     | 50/100 [00:06<00:06,  7.94it/s] 51%|█████     | 51/100 [00:06<00:06,  8.01it/s] 52%|█████▏    | 52/100 [00:06<00:05,  8.14it/s] 53%|█████▎    | 53/100 [00:06<00:05,  8.16it/s] 54%|█████▍    | 54/100 [00:06<00:06,  7.44it/s] 55%|█████▌    | 55/100 [00:06<00:06,  7.28it/s] 56%|█████▌    | 56/100 [00:06<00:05,  7.45it/s] 57%|█████▋    | 57/100 [00:06<00:05,  7.61it/s] 58%|█████▊    | 58/100 [00:07<00:05,  7.76it/s] 59%|█████▉    | 59/100 [00:07<00:05,  7.33it/s] 60%|██████    | 60/100 [00:07<00:05,  7.38it/s] 61%|██████    | 61/100 [00:07<00:05,  7.48it/s] 62%|██████▏   | 62/100 [00:07<00:04,  7.61it/s] 63%|██████▎   | 63/100 [00:07<00:04,  7.49it/s] 64%|██████▍   | 64/100 [00:07<00:04,  7.26it/s] 65%|██████▌   | 65/100 [00:08<00:05,  6.92it/s] 66%|██████▌   | 66/100 [00:08<00:04,  7.29it/s] 67%|██████▋   | 67/100 [00:08<00:04,  7.44it/s] 68%|██████▊   | 68/100 [00:08<00:04,  7.36it/s] 69%|██████▉   | 69/100 [00:08<00:04,  7.47it/s] 70%|███████   | 70/100 [00:08<00:03,  7.64it/s] 71%|███████   | 71/100 [00:08<00:03,  7.79it/s] 72%|███████▏  | 72/100 [00:08<00:03,  7.91it/s] 73%|███████▎  | 73/100 [00:09<00:03,  8.02it/s] 74%|███████▍  | 74/100 [00:09<00:03,  7.99it/s] 75%|███████▌  | 75/100 [00:09<00:03,  8.03it/s] 76%|███████▌  | 76/100 [00:09<00:03,  7.81it/s] 77%|███████▋  | 77/100 [00:09<00:02,  8.06it/s] 78%|███████▊  | 78/100 [00:09<00:02,  8.10it/s] 79%|███████▉  | 79/100 [00:09<00:02,  8.19it/s] 80%|████████  | 80/100 [00:09<00:02,  7.81it/s] 81%|████████  | 81/100 [00:10<00:02,  7.58it/s] 82%|████████▏ | 82/100 [00:10<00:02,  7.84it/s] 83%|████████▎ | 83/100 [00:10<00:02,  7.62it/s] 84%|████████▍ | 84/100 [00:10<00:02,  7.83it/s] 85%|████████▌ | 85/100 [00:10<00:01,  7.96it/s] 86%|████████▌ | 86/100 [00:10<00:01,  7.76it/s] 87%|████████▋ | 87/100 [00:10<00:01,  7.96it/s] 88%|████████▊ | 88/100 [00:10<00:01,  7.89it/s] 89%|████████▉ | 89/100 [00:11<00:01,  7.91it/s] 90%|█████████ | 90/100 [00:11<00:01,  7.83it/s] 91%|█████████ | 91/100 [00:11<00:01,  7.82it/s] 92%|█████████▏| 92/100 [00:11<00:01,  7.83it/s] 93%|█████████▎| 93/100 [00:11<00:00,  7.81it/s] 94%|█████████▍| 94/100 [00:11<00:00,  7.68it/s] 95%|█████████▌| 95/100 [00:11<00:00,  7.52it/s] 96%|█████████▌| 96/100 [00:12<00:00,  7.28it/s] 97%|█████████▋| 97/100 [00:12<00:00,  7.51it/s] 98%|█████████▊| 98/100 [00:12<00:00,  7.79it/s] 99%|█████████▉| 99/100 [00:12<00:00,  7.80it/s]100%|██████████| 100/100 [00:12<00:00,  7.72it/s]100%|██████████| 100/100 [00:12<00:00,  7.98it/s]
eval_p_index len:  16
individual_train 116
individual_eval 16
train data의 x, y, id 길이: 116 116 116
valid data의 x, y, id 길이: 9 9 9
test data의 x, y, id 길이: 7 7 7
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 1.112279, Valid_loss 0.881953
Epoch 2, Train Loss 1.079272, Valid_loss 0.827066
Epoch 3, Train Loss 1.005043, Valid_loss 0.784260
Epoch 4, Train Loss 0.910587, Valid_loss 0.763808
Epoch 5, Train Loss 0.839269, Valid_loss 0.765679
Epoch 6, Train Loss 0.819802, Valid_loss 0.754184
Epoch 7, Train Loss 0.804535, Valid_loss 0.744673
Epoch 8, Train Loss 0.806823, Valid_loss 0.744259
Epoch 9, Train Loss 0.797810, Valid_loss 0.745074
Epoch 10, Train Loss 0.818365, Valid_loss 0.743869
Epoch 11, Train Loss 0.783127, Valid_loss 0.742521
Epoch 12, Train Loss 0.781681, Valid_loss 0.741681
Epoch 13, Train Loss 0.777125, Valid_loss 0.739905
Epoch 14, Train Loss 0.777208, Valid_loss 0.739617
Epoch 15, Train Loss 0.781338, Valid_loss 0.736542
Epoch 16, Train Loss 0.797932, Valid_loss 0.735367
Epoch 17, Train Loss 0.788885, Valid_loss 0.733609
Epoch 18, Train Loss 0.781278, Valid_loss 0.731554
Epoch 19, Train Loss 0.775019, Valid_loss 0.730784
Epoch 20, Train Loss 0.787817, Valid_loss 0.729438
Epoch 21, Train Loss 0.779015, Valid_loss 0.726192
Epoch 22, Train Loss 0.772308, Valid_loss 0.725000
Epoch 23, Train Loss 0.767014, Valid_loss 0.723096
Epoch 24, Train Loss 0.770874, Valid_loss 0.720011
Epoch 25, Train Loss 0.769907, Valid_loss 0.721479
Epoch 26, Train Loss 0.761935, Valid_loss 0.718172
Epoch 27, Train Loss 0.766401, Valid_loss 0.718780
Epoch 28, Train Loss 0.740563, Valid_loss 0.715907
Epoch 29, Train Loss 0.740696, Valid_loss 0.714672
Epoch 30, Train Loss 0.767490, Valid_loss 0.711903
Epoch 31, Train Loss 0.732583, Valid_loss 0.710655
Epoch 32, Train Loss 0.743419, Valid_loss 0.709627
Epoch 33, Train Loss 0.755267, Valid_loss 0.706873
Epoch 34, Train Loss 0.739834, Valid_loss 0.707130
Epoch 35, Train Loss 0.742268, Valid_loss 0.704989
Epoch 36, Train Loss 0.756754, Valid_loss 0.703480
Epoch 37, Train Loss 0.733506, Valid_loss 0.701696
Epoch 38, Train Loss 0.745203, Valid_loss 0.700968
Epoch 39, Train Loss 0.743211, Valid_loss 0.698430
Epoch 40, Train Loss 0.733410, Valid_loss 0.699351
Epoch 41, Train Loss 0.733104, Valid_loss 0.696819
Epoch 42, Train Loss 0.736469, Valid_loss 0.695047
Epoch 43, Train Loss 0.732390, Valid_loss 0.692727
Epoch 44, Train Loss 0.733061, Valid_loss 0.692085
Epoch 45, Train Loss 0.724921, Valid_loss 0.690439
Epoch 46, Train Loss 0.731050, Valid_loss 0.688632
Epoch 47, Train Loss 0.728792, Valid_loss 0.687617
Epoch 48, Train Loss 0.716451, Valid_loss 0.684007
Epoch 49, Train Loss 0.730306, Valid_loss 0.686479
Epoch 50, Train Loss 0.732228, Valid_loss 0.683068
Epoch 51, Train Loss 0.727012, Valid_loss 0.683507
Epoch 52, Train Loss 0.727720, Valid_loss 0.683929
COVID19_Participant26 -- true: COVID-19 -- pred: normal
Control_Participant3 -- true: normal -- pred: normal
Control_Participant1 -- true: normal -- pred: normal
Control_Participant4 -- true: normal -- pred: normal
Control_Participant1 -- true: normal -- pred: normal
COVID19_Participant7 -- true: COVID-19 -- pred: normal
COVID19_Participant31 -- true: COVID-19 -- pred: normal
true :  [1, 0, 0, 0, 0, 1, 1]
pred :  [0, 0, 0, 0, 0, 0, 0]
Confusion Matrix: [4 0 3 0]
Best performance: Epoch 50, Loss 0.732228, Test ACC 0.571429, Test AUC 0.833333, Test Recall 0.000000, Test Precision 0.000000
✅ Total valid splits used: 5

📌 Repeat 4: 평균 AUC = 0.5233, 표준편차 = 0.3090
