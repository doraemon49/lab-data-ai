Namespace(seed=240, batch_size=16, learning_rate=0.003, weight_decay=0.0001, epochs=100, task='custom_kidney', emb_dim=128, h_dim=128, dropout=0.3, layers=1, heads=8, train_sample_cells=500, test_sample_cells=500, train_num_sample=20, test_num_sample=100, model='Transformer', dataset='/data/project/kim89/0819_kidney', inter_only=False, same_pheno=0, augment_num=100, alpha=1.0, repeat=5, all=1, min_size=6000, n_splits=5, pca=False, mix_type=1, norm_first=False, warmup=False, top_k=1, cell_type_annotation='singler_annotation')
🔁 Repeat 0, Fold 0
cell type :  S2008000628HRT_AAACCCAAGACGCTCC-1                   DC
S2008000628HRT_AAACCCAAGTAGCCAG-1              T_cells
S2008000628HRT_AAACCCAGTCCAGAAG-1              T_cells
S2008000628HRT_AAACCCAGTGTATCCA-1               B_cell
S2008000628HRT_AAACGAAAGCGTTAGG-1          Fibroblasts
                                           ...        
Sample1162EO2_TTTGGAGAGCAGGCAT-1      Epithelial_cells
Sample1162EO2_TTTGGAGAGTCGCGAA-1     Endothelial_cells
Sample1162EO2_TTTGGAGAGTGCTCGC-1           Hepatocytes
Sample1162EO2_TTTGGAGGTGATACTC-1      Epithelial_cells
Sample1162EO2_TTTGGTTCAGTAGAAT-1      Epithelial_cells
Name: singler_annotation, Length: 186636, dtype: string
cell type annotation :  S2008000628HRT_AAACCCAAGACGCTCC-1                   DC
S2008000628HRT_AAACCCAAGTAGCCAG-1              T_cells
S2008000628HRT_AAACCCAGTCCAGAAG-1              T_cells
S2008000628HRT_AAACCCAGTGTATCCA-1               B_cell
S2008000628HRT_AAACGAAAGCGTTAGG-1          Fibroblasts
                                           ...        
Sample1162EO2_TTTGGAGAGCAGGCAT-1      Epithelial_cells
Sample1162EO2_TTTGGAGAGTCGCGAA-1     Endothelial_cells
Sample1162EO2_TTTGGAGAGTGCTCGC-1           Hepatocytes
Sample1162EO2_TTTGGAGGTGATACTC-1      Epithelial_cells
Sample1162EO2_TTTGGTTCAGTAGAAT-1      Epithelial_cells
Name: singler_annotation, Length: 186636, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['DC', 'T_cells', 'B_cell', 'Fibroblasts', 'Macrophage', 'Monocyte', 'HSC_-G-CSF', 'Pre-B_cell_CD34-', 'Neutrophils', 'GMP', 'Smooth_muscle_cells', 'MSC', 'NK_cell', 'Epithelial_cells', 'iPS_cells', 'HSC_CD34+', 'Chondrocytes', 'Platelets', 'Pro-B_cell_CD34+', 'Myelocyte', 'Osteoblasts', 'BM', 'Pro-Myelocyte', 'Endothelial_cells', 'Tissue_stem_cells', 'CMP', 'Astrocyte', 'Embryonic_stem_cells', 'Hepatocytes', 'Neurons', 'Keratinocytes', 'Neuroepithelial_cell', 'MEP', 'BM & Prog.', 'Erythroblast', 'Unknown', 'Gametocytes']
라벨별 그룹 개수 {0: 20, 1: 29, 2: 12}
cell type :  S2008000605HRT_AAACCCAGTGCACATT-1        Epithelial_cells
S2008000605HRT_AAACCCAGTGCCTACG-1        Epithelial_cells
S2008000605HRT_AAAGAACGTAGAGACC-1               Astrocyte
S2008000605HRT_AAAGAACGTCGGAACA-1        Epithelial_cells
S2008000605HRT_AAAGAACGTTAACAGA-1        Epithelial_cells
                                             ...         
Sample1158EO2_TTTGACTAGGACACTG-1                  NK_cell
Sample1158EO2_TTTGACTTCCTCTTTC-1      Smooth_muscle_cells
Sample1158EO2_TTTGATCAGCTAAACA-1     Embryonic_stem_cells
Sample1158EO2_TTTGATCTCACTTATC-1     Neuroepithelial_cell
Sample1158EO2_TTTGTTGCAATACGCT-1     Embryonic_stem_cells
Name: singler_annotation, Length: 38541, dtype: string
cell type annotation :  S2008000605HRT_AAACCCAGTGCACATT-1        Epithelial_cells
S2008000605HRT_AAACCCAGTGCCTACG-1        Epithelial_cells
S2008000605HRT_AAAGAACGTAGAGACC-1               Astrocyte
S2008000605HRT_AAAGAACGTCGGAACA-1        Epithelial_cells
S2008000605HRT_AAAGAACGTTAACAGA-1        Epithelial_cells
                                             ...         
Sample1158EO2_TTTGACTAGGACACTG-1                  NK_cell
Sample1158EO2_TTTGACTTCCTCTTTC-1      Smooth_muscle_cells
Sample1158EO2_TTTGATCAGCTAAACA-1     Embryonic_stem_cells
Sample1158EO2_TTTGATCTCACTTATC-1     Neuroepithelial_cell
Sample1158EO2_TTTGTTGCAATACGCT-1     Embryonic_stem_cells
Name: singler_annotation, Length: 38541, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Epithelial_cells', 'Astrocyte', 'MSC', 'Keratinocytes', 'Neurons', 'Endothelial_cells', 'Fibroblasts', 'Tissue_stem_cells', 'Smooth_muscle_cells', 'T_cells', 'Neuroepithelial_cell', 'NK_cell', 'Chondrocytes', 'Osteoblasts', 'Monocyte', 'Hepatocytes', 'Macrophage', 'CMP', 'Embryonic_stem_cells', 'DC', 'BM & Prog.', 'MEP', 'Neutrophils', 'Pro-Myelocyte', 'iPS_cells', 'Pre-B_cell_CD34-', 'HSC_-G-CSF', 'GMP', 'B_cell', 'HSC_CD34+', 'Myelocyte', 'BM', 'Platelets', 'Pro-B_cell_CD34+', 'Unknown', 'Gametocytes', 'Erythroblast']
라벨별 그룹 개수 {0: 6, 1: 8, 2: 2}
🔍 Split #1
  → train_p_index 환자 수 (환자 단위로 묶인 index list): 61
  → test_p_index 환자 수  (환자 단위로 묶인 index list): 16
  → train 환자 ID: ['163-2', '163-4', '164-10', '164-3', '164-6', '165-9', '27-10039', '27-10053', '27-10071', '27-10119', '28-10051', '28-12263', '28-12381', '28-12518', '29-10006', '29-10010', '29-10011', '29-10013', '29-10016', '29-10280', '29-10380', '29-10398', '29-10404', '29-10406', '29-10410', '30-10034', '30-10123', '30-10929', '30-11051', '31-10000', '31-10001', '31-10013', '31-10035', '31-10040', '31-10042', '31-10078', '31-10154', '31-10210', '31-10236', '32-10003', '32-10034', '32-10074', '33-10005', '33-10006', '34-10050', '34-10184', '34-10187', 'PRE019', 'PRE027', 'PRE038', 'PRE055-1', 'PRE062-1', 'PRE98sc', 'Sample1153-EO1', 'Sample1153-EO2', 'Sample1157-EO1', 'Sample1157-EO2', 'Sample1157-EO3', 'Sample1158-EO3', 'Sample1162-EO1', 'Sample1162-EO2']
  → test  환자 ID: ['163-3', '163-5', '27-10041', '27-10112', '28-11515', '28-12490', '29-10008', '29-10012', '29-10386', '29-10400', '30-10018', '30-10125', 'PRE018-1', 'Sample1153-EO3', 'Sample1158-EO1', 'Sample1158-EO2']
  → train 환자 ID 및 라벨:
    ID: 163-2, Label: 0
    ID: 163-4, Label: 0
    ID: 164-10, Label: 0
    ID: 164-3, Label: 0
    ID: 164-6, Label: 0
    ID: 165-9, Label: 0
    ID: 27-10039, Label: 1
    ID: 27-10053, Label: 1
    ID: 27-10071, Label: 1
    ID: 27-10119, Label: 1
    ID: 28-10051, Label: 1
    ID: 28-12263, Label: 1
    ID: 28-12381, Label: 1
    ID: 28-12518, Label: 1
    ID: 29-10006, Label: 1
    ID: 29-10010, Label: 1
    ID: 29-10011, Label: 1
    ID: 29-10013, Label: 1
    ID: 29-10016, Label: 1
    ID: 29-10280, Label: 1
    ID: 29-10380, Label: 1
    ID: 29-10398, Label: 1
    ID: 29-10404, Label: 1
    ID: 29-10406, Label: 1
    ID: 29-10410, Label: 1
    ID: 30-10034, Label: 2
    ID: 30-10123, Label: 2
    ID: 30-10929, Label: 2
    ID: 30-11051, Label: 2
    ID: 31-10000, Label: 1
    ID: 31-10001, Label: 1
    ID: 31-10013, Label: 1
    ID: 31-10035, Label: 1
    ID: 31-10040, Label: 1
    ID: 31-10042, Label: 1
    ID: 31-10078, Label: 1
    ID: 31-10154, Label: 1
    ID: 31-10210, Label: 1
    ID: 31-10236, Label: 1
    ID: 32-10003, Label: 2
    ID: 32-10034, Label: 2
    ID: 32-10074, Label: 2
    ID: 33-10005, Label: 2
    ID: 33-10006, Label: 2
    ID: 34-10050, Label: 2
    ID: 34-10184, Label: 2
    ID: 34-10187, Label: 2
    ID: PRE019, Label: 0
    ID: PRE027, Label: 0
    ID: PRE038, Label: 0
    ID: PRE055-1, Label: 0
    ID: PRE062-1, Label: 0
    ID: PRE98sc, Label: 0
    ID: Sample1153-EO1, Label: 0
    ID: Sample1153-EO2, Label: 0
    ID: Sample1157-EO1, Label: 0
    ID: Sample1157-EO2, Label: 0
    ID: Sample1157-EO3, Label: 0
    ID: Sample1158-EO3, Label: 0
    ID: Sample1162-EO1, Label: 0
    ID: Sample1162-EO2, Label: 0
  → test 환자 ID 및 라벨:
    ID: 163-3, Label: 0
    ID: 163-5, Label: 0
    ID: 27-10041, Label: 1
    ID: 27-10112, Label: 1
    ID: 28-11515, Label: 1
    ID: 28-12490, Label: 1
    ID: 29-10008, Label: 1
    ID: 29-10012, Label: 1
    ID: 29-10386, Label: 1
    ID: 29-10400, Label: 1
    ID: 30-10018, Label: 2
    ID: 30-10125, Label: 2
    ID: PRE018-1, Label: 0
    ID: Sample1153-EO3, Label: 0
    ID: Sample1158-EO1, Label: 0
    ID: Sample1158-EO2, Label: 0
전체 데이터 index 길이 77
label_stat (train 환자 라벨 목록) 갯수 61
train_data에서 환자 단위로, train과 validation 나누기
기존 train_p_index 61
기존 (train) label_stat 61
train-vali 분할 후! 
train y 의 classes : {0, 1, 2} valid y 의 classes : {0, 1, 2} label_stat 의 classes : {0, 1, 2}
train_p_index_ 40
valid_p_index 21
test_p_index 16
→ train 환자 ID 및 라벨:
   총 개수: 40
   환자ID=29-10398, Label=1, 셀개수=3993
   환자ID=31-10236, Label=1, 셀개수=3458
   환자ID=Sample1153-EO2, Label=0, 셀개수=916
   환자ID=Sample1157-EO3, Label=0, 셀개수=807
   환자ID=32-10074, Label=2, 셀개수=6304
   환자ID=164-3, Label=0, 셀개수=1639
   환자ID=29-10013, Label=1, 셀개수=3706
   환자ID=PRE038, Label=0, 셀개수=2666
   환자ID=31-10040, Label=1, 셀개수=4543
   환자ID=31-10013, Label=1, 셀개수=3161
   환자ID=163-4, Label=0, 셀개수=1339
   환자ID=28-12263, Label=1, 셀개수=7527
   환자ID=27-10039, Label=1, 셀개수=4638
   환자ID=27-10053, Label=1, 셀개수=728
   환자ID=163-2, Label=0, 셀개수=2535
   환자ID=30-11051, Label=2, 셀개수=2454
   환자ID=31-10078, Label=1, 셀개수=2827
   환자ID=31-10001, Label=1, 셀개수=1133
   환자ID=29-10406, Label=1, 셀개수=3484
   환자ID=31-10042, Label=1, 셀개수=1222
   환자ID=164-10, Label=0, 셀개수=4041
   환자ID=32-10034, Label=2, 셀개수=1555
   환자ID=PRE062-1, Label=0, 셀개수=907
   환자ID=30-10123, Label=2, 셀개수=1273
   환자ID=28-12518, Label=1, 셀개수=1215
   환자ID=Sample1162-EO1, Label=0, 셀개수=1053
   환자ID=31-10154, Label=1, 셀개수=6568
   환자ID=PRE019, Label=0, 셀개수=3795
   환자ID=28-10051, Label=1, 셀개수=300
   환자ID=29-10011, Label=1, 셀개수=3072
   환자ID=28-12381, Label=1, 셀개수=1099
   환자ID=165-9, Label=0, 셀개수=2926
   환자ID=30-10034, Label=2, 셀개수=1240
   환자ID=34-10184, Label=2, 셀개수=2699
   환자ID=29-10404, Label=1, 셀개수=3988
   환자ID=33-10006, Label=2, 셀개수=457
   환자ID=33-10005, Label=2, 셀개수=8904
   환자ID=32-10003, Label=2, 셀개수=2978
   환자ID=29-10380, Label=1, 셀개수=4799
   환자ID=29-10010, Label=1, 셀개수=5305
→ valid 환자 ID 및 라벨:
   총 개수: 21
   환자ID=Sample1162-EO2, Label=0, 셀개수=1510
   환자ID=29-10280, Label=1, 셀개수=2375
   환자ID=31-10210, Label=1, 셀개수=3510
   환자ID=PRE98sc, Label=0, 셀개수=1568
   환자ID=Sample1157-EO2, Label=0, 셀개수=1395
   환자ID=PRE055-1, Label=0, 셀개수=597
   환자ID=Sample1157-EO1, Label=0, 셀개수=1152
   환자ID=31-10000, Label=1, 셀개수=8870
   환자ID=31-10035, Label=1, 셀개수=2974
   환자ID=30-10929, Label=2, 셀개수=5812
   환자ID=Sample1158-EO3, Label=0, 셀개수=1096
   환자ID=27-10119, Label=1, 셀개수=3346
   환자ID=29-10410, Label=1, 셀개수=2834
   환자ID=Sample1153-EO1, Label=0, 셀개수=911
   환자ID=34-10187, Label=2, 셀개수=3739
   환자ID=PRE027, Label=0, 셀개수=2078
   환자ID=164-6, Label=0, 셀개수=3038
   환자ID=29-10016, Label=1, 셀개수=4854
   환자ID=27-10071, Label=1, 셀개수=1478
   환자ID=29-10006, Label=1, 셀개수=11461
   환자ID=34-10050, Label=2, 셀개수=4784
→ test 환자 ID 및 라벨:
   총 개수: 16
   환자ID=163-3, Label=0, 셀개수=1335
   환자ID=163-5, Label=0, 셀개수=1210
   환자ID=27-10041, Label=1, 셀개수=2145
   환자ID=27-10112, Label=1, 셀개수=1470
   환자ID=28-11515, Label=1, 셀개수=930
   환자ID=28-12490, Label=1, 셀개수=5973
   환자ID=29-10008, Label=1, 셀개수=1913
   환자ID=29-10012, Label=1, 셀개수=6245
   환자ID=29-10386, Label=1, 셀개수=802
   환자ID=29-10400, Label=1, 셀개수=2684
   환자ID=30-10018, Label=2, 셀개수=5170
   환자ID=30-10125, Label=2, 셀개수=3798
   환자ID=PRE018-1, Label=0, 셀개수=1349
   환자ID=Sample1153-EO3, Label=0, 셀개수=1516
   환자ID=Sample1158-EO1, Label=0, 셀개수=574
   환자ID=Sample1158-EO2, Label=0, 셀개수=1427
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['DC', 'T_cells', 'T_cells', 'B_cell', 'Fibroblasts', 'Macrophage', 'DC', 'Monocyte', 'T_cells', 'Fibroblasts']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
전체 데이터 길이 225177
전체 cell type 길이 0                           DC
1                      T_cells
2                      T_cells
3                       B_cell
4                  Fibroblasts
                  ...         
225172                 NK_cell
225173     Smooth_muscle_cells
225174    Embryonic_stem_cells
225175    Neuroepithelial_cell
225176    Embryonic_stem_cells
Length: 225177, dtype: string
cell type의 NaN 개수 체크 0
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:12,  8.15it/s]  2%|▏         | 2/100 [00:00<00:11,  8.70it/s]  3%|▎         | 3/100 [00:00<00:11,  8.64it/s]  4%|▍         | 4/100 [00:00<00:11,  8.18it/s]  5%|▌         | 5/100 [00:00<00:11,  8.51it/s]  6%|▌         | 6/100 [00:00<00:10,  8.79it/s]  7%|▋         | 7/100 [00:00<00:10,  8.69it/s]  8%|▊         | 8/100 [00:00<00:10,  8.88it/s]  9%|▉         | 9/100 [00:01<00:10,  9.00it/s] 10%|█         | 10/100 [00:01<00:09,  9.02it/s] 11%|█         | 11/100 [00:01<00:10,  8.86it/s] 12%|█▏        | 12/100 [00:01<00:09,  8.81it/s] 14%|█▍        | 14/100 [00:01<00:09,  9.12it/s] 15%|█▌        | 15/100 [00:01<00:09,  9.19it/s] 16%|█▌        | 16/100 [00:01<00:09,  9.07it/s] 17%|█▋        | 17/100 [00:01<00:10,  7.91it/s] 18%|█▊        | 18/100 [00:02<00:10,  7.76it/s] 19%|█▉        | 19/100 [00:02<00:10,  8.04it/s] 20%|██        | 20/100 [00:02<00:09,  8.21it/s] 21%|██        | 21/100 [00:02<00:09,  8.32it/s] 22%|██▏       | 22/100 [00:02<00:09,  8.49it/s] 23%|██▎       | 23/100 [00:02<00:08,  8.56it/s] 24%|██▍       | 24/100 [00:02<00:08,  8.82it/s] 25%|██▌       | 25/100 [00:02<00:08,  8.86it/s] 26%|██▌       | 26/100 [00:03<00:08,  8.93it/s] 27%|██▋       | 27/100 [00:03<00:08,  8.87it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.87it/s] 29%|██▉       | 29/100 [00:03<00:08,  7.98it/s] 30%|███       | 30/100 [00:03<00:09,  7.69it/s] 31%|███       | 31/100 [00:03<00:08,  8.01it/s] 32%|███▏      | 32/100 [00:03<00:08,  8.16it/s] 33%|███▎      | 33/100 [00:03<00:07,  8.49it/s] 34%|███▍      | 34/100 [00:03<00:07,  8.45it/s] 35%|███▌      | 35/100 [00:04<00:07,  8.53it/s] 36%|███▌      | 36/100 [00:04<00:07,  8.53it/s] 37%|███▋      | 37/100 [00:04<00:07,  8.64it/s] 38%|███▊      | 38/100 [00:04<00:07,  8.52it/s] 39%|███▉      | 39/100 [00:04<00:07,  8.63it/s] 40%|████      | 40/100 [00:04<00:07,  8.45it/s] 41%|████      | 41/100 [00:04<00:09,  6.10it/s] 42%|████▏     | 42/100 [00:05<00:08,  6.66it/s] 43%|████▎     | 43/100 [00:05<00:08,  6.76it/s] 44%|████▍     | 44/100 [00:05<00:08,  6.90it/s] 45%|████▌     | 45/100 [00:05<00:07,  7.14it/s] 46%|████▌     | 46/100 [00:05<00:07,  7.62it/s] 47%|████▋     | 47/100 [00:05<00:06,  7.76it/s] 48%|████▊     | 48/100 [00:05<00:06,  7.90it/s] 49%|████▉     | 49/100 [00:05<00:06,  8.09it/s] 50%|█████     | 50/100 [00:06<00:06,  8.16it/s] 51%|█████     | 51/100 [00:06<00:05,  8.19it/s] 52%|█████▏    | 52/100 [00:06<00:05,  8.29it/s] 53%|█████▎    | 53/100 [00:06<00:05,  8.38it/s] 54%|█████▍    | 54/100 [00:06<00:05,  8.47it/s] 55%|█████▌    | 55/100 [00:06<00:05,  8.45it/s] 56%|█████▌    | 56/100 [00:06<00:06,  6.71it/s] 57%|█████▋    | 57/100 [00:07<00:06,  7.09it/s] 58%|█████▊    | 58/100 [00:07<00:05,  7.41it/s] 59%|█████▉    | 59/100 [00:07<00:05,  7.54it/s] 60%|██████    | 60/100 [00:07<00:05,  7.65it/s] 61%|██████    | 61/100 [00:07<00:05,  7.76it/s] 62%|██████▏   | 62/100 [00:07<00:04,  7.98it/s] 63%|██████▎   | 63/100 [00:07<00:04,  8.12it/s] 64%|██████▍   | 64/100 [00:08<00:06,  5.86it/s] 65%|██████▌   | 65/100 [00:08<00:05,  6.41it/s] 66%|██████▌   | 66/100 [00:08<00:05,  6.71it/s] 67%|██████▋   | 67/100 [00:08<00:04,  7.09it/s] 68%|██████▊   | 68/100 [00:08<00:04,  7.47it/s] 69%|██████▉   | 69/100 [00:08<00:04,  7.70it/s] 70%|███████   | 70/100 [00:08<00:03,  7.52it/s] 71%|███████   | 71/100 [00:08<00:03,  7.64it/s] 72%|███████▏  | 72/100 [00:09<00:03,  7.64it/s] 73%|███████▎  | 73/100 [00:09<00:03,  7.67it/s] 74%|███████▍  | 74/100 [00:09<00:03,  7.73it/s] 75%|███████▌  | 75/100 [00:09<00:03,  7.90it/s] 76%|███████▌  | 76/100 [00:09<00:03,  7.99it/s] 77%|███████▋  | 77/100 [00:09<00:02,  8.02it/s] 78%|███████▊  | 78/100 [00:09<00:02,  8.14it/s] 79%|███████▉  | 79/100 [00:09<00:02,  7.98it/s] 80%|████████  | 80/100 [00:10<00:02,  8.13it/s] 81%|████████  | 81/100 [00:10<00:02,  7.96it/s] 82%|████████▏ | 82/100 [00:10<00:02,  7.90it/s] 83%|████████▎ | 83/100 [00:10<00:02,  7.92it/s] 84%|████████▍ | 84/100 [00:10<00:02,  7.91it/s] 85%|████████▌ | 85/100 [00:10<00:01,  7.86it/s] 86%|████████▌ | 86/100 [00:10<00:01,  7.84it/s] 87%|████████▋ | 87/100 [00:10<00:01,  7.99it/s] 88%|████████▊ | 88/100 [00:11<00:01,  7.98it/s] 89%|████████▉ | 89/100 [00:11<00:01,  8.03it/s] 90%|█████████ | 90/100 [00:11<00:01,  8.04it/s] 91%|█████████ | 91/100 [00:11<00:01,  8.04it/s] 92%|█████████▏| 92/100 [00:11<00:01,  7.97it/s] 93%|█████████▎| 93/100 [00:11<00:00,  7.84it/s] 94%|█████████▍| 94/100 [00:11<00:00,  6.93it/s] 95%|█████████▌| 95/100 [00:11<00:00,  6.98it/s] 96%|█████████▌| 96/100 [00:12<00:00,  7.19it/s] 97%|█████████▋| 97/100 [00:12<00:00,  7.47it/s] 98%|█████████▊| 98/100 [00:12<00:00,  7.51it/s] 99%|█████████▉| 99/100 [00:12<00:00,  7.54it/s]100%|██████████| 100/100 [00:12<00:00,  7.75it/s]100%|██████████| 100/100 [00:12<00:00,  7.92it/s]
[I 2025-08-31 00:38:49,754] A new study created in memory with name: no-name-ab1ed037-04d2-4b79-b1cd-c45593630ab5
👉 train samples(학습 샘플(bag))=140, batch_size=16 -> steps(샘플수/batch크기)=9
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 1.76 MB
Memory Reserved: 2.00 MB
cuda
Epoch 1, Train Loss 1.073895, Valid_loss 1.011929
Epoch 2, Train Loss 0.954533, Valid_loss 0.986151
Epoch 3, Train Loss 0.946943, Valid_loss 0.985877
Epoch 4, Train Loss 0.950726, Valid_loss 0.964387
Epoch 5, Train Loss 0.937609, Valid_loss 0.938171
Epoch 6, Train Loss 0.881338, Valid_loss 0.907956
Epoch 7, Train Loss 0.822865, Valid_loss 0.855683
Epoch 8, Train Loss 0.809662, Valid_loss 0.793653
Epoch 9, Train Loss 0.753017, Valid_loss 0.736152
Epoch 10, Train Loss 0.707161, Valid_loss 0.708104
Epoch 11, Train Loss 0.713712, Valid_loss 0.658142
Epoch 12, Train Loss 0.669715, Valid_loss 0.664387
Epoch 13, Train Loss 0.664659, Valid_loss 0.636375
Epoch 14, Train Loss 0.637911, Valid_loss 0.733911
Epoch 15, Train Loss 0.582089, Valid_loss 0.596049
Epoch 16, Train Loss 0.629874, Valid_loss 0.705146
Epoch 17, Train Loss 0.582576, Valid_loss 0.615852
Epoch 18, Train Loss 0.563919, Valid_loss 0.670355
Epoch 19, Train Loss 0.610248, Valid_loss 0.646590
Epoch 20, Train Loss 0.616493, Valid_loss 0.659476
Epoch 21, Train Loss 0.552228, Valid_loss 0.657769
Epoch 22, Train Loss 0.568926, Valid_loss 0.600345
Epoch 23, Train Loss 0.511595, Valid_loss 0.676171
Epoch 24, Train Loss 0.514033, Valid_loss 0.606754
Epoch 25, Train Loss 0.565558, Valid_loss 0.579482
Epoch 26, Train Loss 0.494482, Valid_loss 0.682530
Epoch 27, Train Loss 0.475769, Valid_loss 0.688862
Epoch 28, Train Loss 0.471093, Valid_loss 0.610201
Epoch 29, Train Loss 0.450296, Valid_loss 0.594929
Epoch 30, Train Loss 0.454497, Valid_loss 0.648909
Epoch 31, Train Loss 0.454055, Valid_loss 0.656762
Epoch 32, Train Loss 0.440154, Valid_loss 0.653472
Epoch 33, Train Loss 0.451556, Valid_loss 0.594069
Epoch 34, Train Loss 0.425972, Valid_loss 0.541466
Epoch 35, Train Loss 0.442696, Valid_loss 0.683306
Epoch 36, Train Loss 0.423582, Valid_loss 0.582409
Epoch 37, Train Loss 0.442125, Valid_loss 0.525959
Epoch 38, Train Loss 0.421484, Valid_loss 0.625044
Epoch 39, Train Loss 0.416083, Valid_loss 0.559250
Epoch 40, Train Loss 0.428089, Valid_loss 0.633635
Epoch 41, Train Loss 0.394335, Valid_loss 0.502876
Epoch 42, Train Loss 0.408412, Valid_loss 0.684119
Epoch 43, Train Loss 0.379777, Valid_loss 0.548217
Epoch 44, Train Loss 0.366377, Valid_loss 0.613349
Epoch 45, Train Loss 0.336179, Valid_loss 0.535197
Epoch 46, Train Loss 0.338631, Valid_loss 0.645881
Epoch 47, Train Loss 0.395451, Valid_loss 0.491575
Epoch 48, Train Loss 0.350088, Valid_loss 0.538367
Epoch 49, Train Loss 0.377089, Valid_loss 0.567454
Epoch 50, Train Loss 0.324471, Valid_loss 0.575455
Epoch 51, Train Loss 0.324536, Valid_loss 0.580723
Epoch 52, Train Loss 0.336520, Valid_loss 0.563696
Epoch 53, Train Loss 0.340517, Valid_loss 0.596569
Epoch 54, Train Loss 0.340328, Valid_loss 0.553278
Epoch 55, Train Loss 0.330499, Valid_loss 0.596663
Epoch 56, Train Loss 0.347978, Valid_loss 0.551688
Epoch 57, Train Loss 0.327423, Valid_loss 0.575723
Epoch 58, Train Loss 0.328449, Valid_loss 0.574299
Epoch 59, Train Loss 0.332108, Valid_loss 0.531512
Epoch 60, Train Loss 0.322680, Valid_loss 0.592813
Epoch 61, Train Loss 0.312194, Valid_loss 0.530789
Epoch 62, Train Loss 0.335943, Valid_loss 0.575876
Epoch 63, Train Loss 0.347477, Valid_loss 0.566409
Epoch 64, Train Loss 0.344715, Valid_loss 0.564907
Epoch 65, Train Loss 0.304865, Valid_loss 0.579599
Epoch 66, Train Loss 0.304299, Valid_loss 0.577462
Epoch 67, Train Loss 0.288014, Valid_loss 0.566873
Epoch 68, Train Loss 0.308397, Valid_loss 0.546679
Epoch 69, Train Loss 0.278759, Valid_loss 0.577880
Epoch 70, Train Loss 0.301735, Valid_loss 0.547234
Epoch 71, Train Loss 0.282336, Valid_loss 0.589646
Epoch 72, Train Loss 0.301361, Valid_loss 0.607844
[I 2025-08-31 00:49:53,181] Trial 0 finished with value: 0.49157537307058063 and parameters: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 2, 'dropout': 0.3, 'weight_decay': 0.01, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.49157537307058063.
👉 train samples(학습 샘플(bag))=140, batch_size=16 -> steps(샘플수/batch크기)=9
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 27.97 MB
Memory Reserved: 36.00 MB
cuda
Epoch 1, Train Loss 1.107333, Valid_loss 0.990277
Epoch 2, Train Loss 1.013105, Valid_loss 0.969524
Epoch 3, Train Loss 0.989588, Valid_loss 0.918253
Epoch 4, Train Loss 0.920565, Valid_loss 0.889630
Epoch 5, Train Loss 0.871244, Valid_loss 0.836119
Epoch 6, Train Loss 0.791216, Valid_loss 0.810414
Epoch 7, Train Loss 0.770294, Valid_loss 0.770071
Epoch 8, Train Loss 0.763006, Valid_loss 0.684558
Epoch 9, Train Loss 0.755210, Valid_loss 0.779881
Epoch 10, Train Loss 0.751824, Valid_loss 0.635234
Epoch 11, Train Loss 0.707778, Valid_loss 0.694357
Epoch 12, Train Loss 0.635673, Valid_loss 0.575054
Epoch 13, Train Loss 0.680801, Valid_loss 0.620442
Epoch 14, Train Loss 0.587373, Valid_loss 0.609355
Epoch 15, Train Loss 0.626654, Valid_loss 0.591532
Epoch 16, Train Loss 0.614499, Valid_loss 0.581261
Epoch 17, Train Loss 0.571967, Valid_loss 0.663232
Epoch 18, Train Loss 0.593833, Valid_loss 0.604798
Epoch 19, Train Loss 0.540748, Valid_loss 0.650792
Epoch 20, Train Loss 0.533330, Valid_loss 0.570186
Epoch 21, Train Loss 0.553858, Valid_loss 0.624497
Epoch 22, Train Loss 0.562357, Valid_loss 0.600393
Epoch 23, Train Loss 0.600229, Valid_loss 0.486403
Epoch 24, Train Loss 0.551191, Valid_loss 0.568287
Epoch 25, Train Loss 0.533359, Valid_loss 0.533432
Epoch 26, Train Loss 0.514716, Valid_loss 0.595777
Epoch 27, Train Loss 0.498456, Valid_loss 0.557474
Epoch 28, Train Loss 0.537642, Valid_loss 0.614235
Epoch 29, Train Loss 0.565687, Valid_loss 0.500879
Epoch 30, Train Loss 0.519507, Valid_loss 0.612865
Epoch 31, Train Loss 0.463795, Valid_loss 0.509121
Epoch 32, Train Loss 0.578973, Valid_loss 0.526759
Epoch 33, Train Loss 0.561679, Valid_loss 0.412832
Epoch 34, Train Loss 0.538318, Valid_loss 0.729747
Epoch 35, Train Loss 0.510083, Valid_loss 0.486576
Epoch 36, Train Loss 0.490602, Valid_loss 0.488766
Epoch 37, Train Loss 0.443141, Valid_loss 0.644697
Epoch 38, Train Loss 0.464108, Valid_loss 0.576333
Epoch 39, Train Loss 0.439834, Valid_loss 0.687604
Epoch 40, Train Loss 0.428736, Valid_loss 0.511975
Epoch 41, Train Loss 0.417847, Valid_loss 0.747657
Epoch 42, Train Loss 0.468295, Valid_loss 0.508191
Epoch 43, Train Loss 0.373578, Valid_loss 0.725218
Epoch 44, Train Loss 0.432523, Valid_loss 0.741014
Epoch 45, Train Loss 0.390626, Valid_loss 0.437611
Epoch 46, Train Loss 0.451228, Valid_loss 0.548758
Epoch 47, Train Loss 0.411608, Valid_loss 0.607083
Epoch 48, Train Loss 0.376843, Valid_loss 0.483731
Epoch 49, Train Loss 0.427583, Valid_loss 0.835706
Epoch 50, Train Loss 0.421681, Valid_loss 0.376364
Epoch 51, Train Loss 0.408303, Valid_loss 0.483183
Epoch 52, Train Loss 0.369643, Valid_loss 0.622581
[I 2025-08-31 00:58:10,249] Trial 1 finished with value: 0.3763637842521781 and parameters: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 2, 'dropout': 0.7, 'weight_decay': 0.0001, 'emb_dim': 64, 'augment_num': 100, 'pca': False}. Best is trial 1 with value: 0.3763637842521781.
👉 train samples(학습 샘플(bag))=140, batch_size=16 -> steps(샘플수/batch크기)=9
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 26.13 MB
Memory Reserved: 36.00 MB
cuda
Epoch 1, Train Loss 0.968524, Valid_loss 0.967760
Epoch 2, Train Loss 0.863243, Valid_loss 0.923765
Epoch 3, Train Loss 0.873235, Valid_loss 0.821928
Epoch 4, Train Loss 0.744471, Valid_loss 0.854852
Epoch 5, Train Loss 0.717758, Valid_loss 0.661731
Epoch 6, Train Loss 0.627515, Valid_loss 0.543644
Epoch 7, Train Loss 0.521906, Valid_loss 0.591672
Epoch 8, Train Loss 0.537302, Valid_loss 0.634456
Epoch 9, Train Loss 0.522555, Valid_loss 0.704329
Epoch 10, Train Loss 0.437869, Valid_loss 0.916113
Epoch 11, Train Loss 0.506256, Valid_loss 0.402431
Epoch 12, Train Loss 0.496234, Valid_loss 0.853745
Epoch 13, Train Loss 0.520921, Valid_loss 0.435285
Epoch 14, Train Loss 0.399535, Valid_loss 0.628970
Epoch 15, Train Loss 0.457006, Valid_loss 0.540485
Epoch 16, Train Loss 0.365158, Valid_loss 0.696810
Epoch 17, Train Loss 0.335006, Valid_loss 0.414145
Epoch 18, Train Loss 0.402854, Valid_loss 0.369632
Epoch 19, Train Loss 0.392426, Valid_loss 0.822690
Epoch 20, Train Loss 0.371882, Valid_loss 0.446548
Epoch 21, Train Loss 0.367383, Valid_loss 0.988626
Epoch 22, Train Loss 0.410920, Valid_loss 0.354326
Epoch 23, Train Loss 0.356913, Valid_loss 0.414813
Epoch 24, Train Loss 0.451482, Valid_loss 0.475541
Epoch 25, Train Loss 0.362540, Valid_loss 0.377804
Epoch 26, Train Loss 0.321757, Valid_loss 0.728719
Epoch 27, Train Loss 0.310684, Valid_loss 0.851485
Epoch 28, Train Loss 0.264492, Valid_loss 0.487742
Epoch 29, Train Loss 0.272720, Valid_loss 0.418400
Epoch 30, Train Loss 0.279322, Valid_loss 0.515866
Epoch 31, Train Loss 0.279032, Valid_loss 0.436089
Epoch 32, Train Loss 0.251696, Valid_loss 0.501274
Epoch 33, Train Loss 0.241880, Valid_loss 0.468317
Epoch 34, Train Loss 0.209937, Valid_loss 0.446549
Epoch 35, Train Loss 0.195523, Valid_loss 0.457306
Epoch 36, Train Loss 0.182968, Valid_loss 0.531924
Epoch 37, Train Loss 0.223592, Valid_loss 0.200205
Epoch 38, Train Loss 0.368968, Valid_loss 0.414622
Epoch 39, Train Loss 0.288954, Valid_loss 0.379208
Epoch 40, Train Loss 0.245847, Valid_loss 0.229599
Epoch 41, Train Loss 0.368193, Valid_loss 0.378579
Epoch 42, Train Loss 0.243270, Valid_loss 0.400589
Epoch 43, Train Loss 0.178021, Valid_loss 0.248545
Epoch 44, Train Loss 0.265873, Valid_loss 0.210022
Epoch 45, Train Loss 0.366654, Valid_loss 0.549929
Epoch 46, Train Loss 0.278653, Valid_loss 0.196616
Epoch 47, Train Loss 0.207841, Valid_loss 0.436549
Epoch 48, Train Loss 0.311427, Valid_loss 0.541665
Epoch 49, Train Loss 0.304079, Valid_loss 0.177456
Epoch 50, Train Loss 0.271377, Valid_loss 0.362252
Epoch 51, Train Loss 0.237602, Valid_loss 0.370916
Epoch 52, Train Loss 0.198452, Valid_loss 0.564946
[I 2025-08-31 01:03:54,304] Trial 2 finished with value: 0.17745563004254586 and parameters: {'learning_rate': 0.001, 'epochs': 100, 'heads': 1, 'dropout': 0.3, 'weight_decay': 0.0001, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 2 with value: 0.17745563004254586.
선택된 trial params: {'learning_rate': 0.001, 'epochs': 100, 'heads': 1, 'dropout': 0.3, 'weight_decay': 0.0001, 'emb_dim': 32, 'augment_num': 100, 'pca': False}
👉 train samples(학습 샘플(bag))=140, batch_size=16 -> steps(샘플수/batch크기)=9
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=16, batch_size=1 -> steps=16
Memory Allocated: 26.13 MB
Memory Reserved: 36.00 MB
cuda
Epoch 1, Train Loss 0.910702, Valid_loss 0.880395
Epoch 2, Train Loss 0.805968, Valid_loss 0.726745
Epoch 3, Train Loss 0.620075, Valid_loss 0.641258
Epoch 4, Train Loss 0.536841, Valid_loss 0.556284
Epoch 5, Train Loss 0.620724, Valid_loss 0.615779
Epoch 6, Train Loss 0.666900, Valid_loss 0.761379
Epoch 7, Train Loss 0.578905, Valid_loss 0.438914
Epoch 8, Train Loss 0.552322, Valid_loss 0.471727
Epoch 9, Train Loss 0.504026, Valid_loss 0.596858
Epoch 10, Train Loss 0.497264, Valid_loss 0.407637
Epoch 11, Train Loss 0.509187, Valid_loss 0.654447
Epoch 12, Train Loss 0.434595, Valid_loss 0.541019
Epoch 13, Train Loss 0.400135, Valid_loss 0.540725
Epoch 14, Train Loss 0.512797, Valid_loss 0.612749
Epoch 15, Train Loss 0.518015, Valid_loss 0.396432
Epoch 16, Train Loss 0.402776, Valid_loss 0.790540
Epoch 17, Train Loss 0.408286, Valid_loss 0.357781
Epoch 18, Train Loss 0.444484, Valid_loss 0.670352
Epoch 19, Train Loss 0.370212, Valid_loss 0.769264
Epoch 20, Train Loss 0.353921, Valid_loss 0.489645
Epoch 21, Train Loss 0.350724, Valid_loss 0.388811
Epoch 22, Train Loss 0.341662, Valid_loss 0.568128
Epoch 23, Train Loss 0.327540, Valid_loss 0.545733
Epoch 24, Train Loss 0.304562, Valid_loss 0.623385
Epoch 25, Train Loss 0.358659, Valid_loss 0.843204
Epoch 26, Train Loss 0.310476, Valid_loss 0.636592
Epoch 27, Train Loss 0.306974, Valid_loss 0.662326
Epoch 28, Train Loss 0.273479, Valid_loss 0.542565
Epoch 29, Train Loss 0.276151, Valid_loss 0.261276
Epoch 30, Train Loss 0.335075, Valid_loss 0.285302
Epoch 31, Train Loss 0.262937, Valid_loss 0.282157
Epoch 32, Train Loss 0.305457, Valid_loss 0.939369
Epoch 33, Train Loss 0.380729, Valid_loss 0.302376
Epoch 34, Train Loss 0.267852, Valid_loss 0.309931
Epoch 35, Train Loss 0.230714, Valid_loss 0.763601
Epoch 36, Train Loss 0.242723, Valid_loss 0.602322
Epoch 37, Train Loss 0.233047, Valid_loss 0.540627
Epoch 38, Train Loss 0.243605, Valid_loss 0.305885
Epoch 39, Train Loss 0.293382, Valid_loss 1.045556
Epoch 40, Train Loss 0.379214, Valid_loss 0.977807
Epoch 41, Train Loss 0.356252, Valid_loss 0.442009
Epoch 42, Train Loss 0.285077, Valid_loss 0.297679
Epoch 43, Train Loss 0.234413, Valid_loss 0.523179
Epoch 44, Train Loss 0.202314, Valid_loss 0.490477
Epoch 45, Train Loss 0.178885, Valid_loss 0.607423
Epoch 46, Train Loss 0.194054, Valid_loss 0.195382
Epoch 47, Train Loss 0.257661, Valid_loss 0.346259
Epoch 48, Train Loss 0.230656, Valid_loss 0.881162
Epoch 49, Train Loss 0.185527, Valid_loss 0.577519
Epoch 50, Train Loss 0.187470, Valid_loss 0.341010
Epoch 51, Train Loss 0.188077, Valid_loss 0.719502
Epoch 52, Train Loss 0.154944, Valid_loss 0.345536
Epoch 53, Train Loss 0.162206, Valid_loss 0.668875
Epoch 54, Train Loss 0.140148, Valid_loss 0.526519
Epoch 55, Train Loss 0.123328, Valid_loss 0.567565
Epoch 56, Train Loss 0.130591, Valid_loss 0.633590
환자ID=163-3 -- true: [[0]] -- pred: tensor([[-0.5094,  2.5569, -1.5763]], device='cuda:0')
환자ID=163-5 -- true: [[0]] -- pred: tensor([[ 3.5221, -1.5416, -3.0610]], device='cuda:0')
환자ID=27-10041 -- true: [[1]] -- pred: tensor([[-1.4676,  2.8469, -0.2804]], device='cuda:0')
환자ID=27-10112 -- true: [[1]] -- pred: tensor([[-1.2625,  2.7732, -0.5584]], device='cuda:0')
환자ID=28-11515 -- true: [[1]] -- pred: tensor([[-0.7005,  2.6474, -1.4775]], device='cuda:0')
환자ID=28-12490 -- true: [[1]] -- pred: tensor([[-1.8024,  2.6775,  0.2653]], device='cuda:0')
환자ID=29-10008 -- true: [[1]] -- pred: tensor([[-1.7552,  2.7149,  0.2004]], device='cuda:0')
환자ID=29-10012 -- true: [[1]] -- pred: tensor([[-0.3580,  2.4181, -1.8024]], device='cuda:0')
환자ID=29-10386 -- true: [[1]] -- pred: tensor([[-1.1284,  2.7237, -0.8843]], device='cuda:0')
환자ID=29-10400 -- true: [[1]] -- pred: tensor([[-0.7167,  2.6579, -1.4544]], device='cuda:0')
환자ID=30-10018 -- true: [[2]] -- pred: tensor([[-2.4705,  1.3696,  1.8083]], device='cuda:0')
환자ID=30-10125 -- true: [[2]] -- pred: tensor([[-2.5509,  0.7668,  2.2644]], device='cuda:0')
환자ID=PRE018-1 -- true: [[0]] -- pred: tensor([[ 3.6931, -1.4966, -3.5692]], device='cuda:0')
환자ID=Sample1153-EO3 -- true: [[0]] -- pred: tensor([[ 3.6831, -1.4880, -3.5609]], device='cuda:0')
환자ID=Sample1158-EO1 -- true: [[0]] -- pred: tensor([[ 3.6604, -1.4691, -3.5658]], device='cuda:0')
환자ID=Sample1158-EO2 -- true: [[0]] -- pred: tensor([[ 3.6922, -1.5093, -3.5539]], device='cuda:0')
Best performance: Epoch 46, Loss 0.194054, Test ACC 0.937500, Test AUC 0.986111, Test Recall 0.944444, Test Precision 0.962963
Confusion Matrix:
 [[5 1 0]
 [0 8 0]
 [0 0 2]]
✅ Total valid splits used: 1
🔁 Repeat 0, Fold 1
cell type :  S2008000605HRT_AAACCCAGTGCACATT-1     Epithelial_cells
S2008000605HRT_AAACCCAGTGCCTACG-1     Epithelial_cells
S2008000605HRT_AAAGAACGTAGAGACC-1            Astrocyte
S2008000605HRT_AAAGAACGTCGGAACA-1     Epithelial_cells
S2008000605HRT_AAAGAACGTTAACAGA-1     Epithelial_cells
                                           ...        
Sample1162EO2_TTTGGAGAGCAGGCAT-1      Epithelial_cells
Sample1162EO2_TTTGGAGAGTCGCGAA-1     Endothelial_cells
Sample1162EO2_TTTGGAGAGTGCTCGC-1           Hepatocytes
Sample1162EO2_TTTGGAGGTGATACTC-1      Epithelial_cells
Sample1162EO2_TTTGGTTCAGTAGAAT-1      Epithelial_cells
Name: singler_annotation, Length: 175951, dtype: string
cell type annotation :  S2008000605HRT_AAACCCAGTGCACATT-1     Epithelial_cells
S2008000605HRT_AAACCCAGTGCCTACG-1     Epithelial_cells
S2008000605HRT_AAAGAACGTAGAGACC-1            Astrocyte
S2008000605HRT_AAAGAACGTCGGAACA-1     Epithelial_cells
S2008000605HRT_AAAGAACGTTAACAGA-1     Epithelial_cells
                                           ...        
Sample1162EO2_TTTGGAGAGCAGGCAT-1      Epithelial_cells
Sample1162EO2_TTTGGAGAGTCGCGAA-1     Endothelial_cells
Sample1162EO2_TTTGGAGAGTGCTCGC-1           Hepatocytes
Sample1162EO2_TTTGGAGGTGATACTC-1      Epithelial_cells
Sample1162EO2_TTTGGTTCAGTAGAAT-1      Epithelial_cells
Name: singler_annotation, Length: 175951, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Epithelial_cells', 'Astrocyte', 'MSC', 'Keratinocytes', 'Neurons', 'Endothelial_cells', 'Fibroblasts', 'Tissue_stem_cells', 'Smooth_muscle_cells', 'T_cells', 'Neuroepithelial_cell', 'NK_cell', 'Chondrocytes', 'Osteoblasts', 'Monocyte', 'Hepatocytes', 'Macrophage', 'CMP', 'Embryonic_stem_cells', 'DC', 'BM & Prog.', 'MEP', 'Neutrophils', 'Pro-Myelocyte', 'iPS_cells', 'Pre-B_cell_CD34-', 'HSC_-G-CSF', 'B_cell', 'GMP', 'HSC_CD34+', 'Platelets', 'Pro-B_cell_CD34+', 'Myelocyte', 'BM', 'Erythroblast', 'Unknown', 'Gametocytes']
라벨별 그룹 개수 {0: 21, 1: 29, 2: 11}
cell type :  S1908009883_AAACCCAGTACAGCGA-1            Fibroblasts
S1908009883_AAACCCATCAAACGTC-1                T_cells
S1908009883_AAACCCATCAACGCTA-1                Neurons
S1908009883_AAACCCATCTGTTGGA-1      Endothelial_cells
S1908009883_AAAGGATAGAATACAC-1                NK_cell
                                          ...        
Sample1157EO2_TTTGGAGCATCGTGGC-1     Epithelial_cells
Sample1157EO2_TTTGGTTCAATGCAGG-1    Tissue_stem_cells
Sample1157EO2_TTTGGTTGTTTAGAGA-1              Neurons
Sample1157EO2_TTTGTTGAGGATATGT-1          Hepatocytes
Sample1157EO2_TTTGTTGAGTCCCTAA-1              Neurons
Name: singler_annotation, Length: 49226, dtype: string
cell type annotation :  S1908009883_AAACCCAGTACAGCGA-1            Fibroblasts
S1908009883_AAACCCATCAAACGTC-1                T_cells
S1908009883_AAACCCATCAACGCTA-1                Neurons
S1908009883_AAACCCATCTGTTGGA-1      Endothelial_cells
S1908009883_AAAGGATAGAATACAC-1                NK_cell
                                          ...        
Sample1157EO2_TTTGGAGCATCGTGGC-1     Epithelial_cells
Sample1157EO2_TTTGGTTCAATGCAGG-1    Tissue_stem_cells
Sample1157EO2_TTTGGTTGTTTAGAGA-1              Neurons
Sample1157EO2_TTTGTTGAGGATATGT-1          Hepatocytes
Sample1157EO2_TTTGTTGAGTCCCTAA-1              Neurons
Name: singler_annotation, Length: 49226, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Fibroblasts', 'T_cells', 'Neurons', 'Endothelial_cells', 'NK_cell', 'Epithelial_cells', 'Neutrophils', 'B_cell', 'Hepatocytes', 'Macrophage', 'Astrocyte', 'Neuroepithelial_cell', 'Erythroblast', 'Smooth_muscle_cells', 'iPS_cells', 'Monocyte', 'Embryonic_stem_cells', 'MSC', 'Osteoblasts', 'BM & Prog.', 'MEP', 'CMP', 'BM', 'GMP', 'DC', 'Tissue_stem_cells', 'Chondrocytes', 'Pro-B_cell_CD34+', 'Keratinocytes', 'Pre-B_cell_CD34-', 'HSC_-G-CSF', 'Unknown', 'HSC_CD34+', 'Pro-Myelocyte', 'Platelets', 'Myelocyte', 'Gametocytes']
라벨별 그룹 개수 {1: 8, 2: 3, 0: 5}
🔍 Split #2
  → train_p_index 환자 수 (환자 단위로 묶인 index list): 61
  → test_p_index 환자 수  (환자 단위로 묶인 index list): 16
  → train 환자 ID: ['163-2', '163-3', '163-4', '163-5', '164-10', '164-3', '164-6', '165-9', '27-10039', '27-10041', '27-10053', '27-10071', '27-10112', '28-11515', '28-12263', '28-12381', '28-12490', '28-12518', '29-10006', '29-10008', '29-10010', '29-10011', '29-10012', '29-10013', '29-10386', '29-10398', '29-10400', '29-10404', '29-10406', '29-10410', '30-10018', '30-10034', '30-10123', '30-10125', '31-10001', '31-10013', '31-10035', '31-10040', '31-10078', '31-10210', '31-10236', '32-10003', '32-10034', '32-10074', '33-10005', '34-10050', '34-10184', '34-10187', 'PRE018-1', 'PRE027', 'PRE038', 'PRE055-1', 'PRE062-1', 'PRE98sc', 'Sample1153-EO3', 'Sample1157-EO3', 'Sample1158-EO1', 'Sample1158-EO2', 'Sample1158-EO3', 'Sample1162-EO1', 'Sample1162-EO2']
  → test  환자 ID: ['27-10119', '28-10051', '29-10016', '29-10280', '29-10380', '30-10929', '30-11051', '31-10000', '31-10042', '31-10154', '33-10006', 'PRE019', 'Sample1153-EO1', 'Sample1153-EO2', 'Sample1157-EO1', 'Sample1157-EO2']
  → train 환자 ID 및 라벨:
    ID: 163-2, Label: 0
    ID: 163-3, Label: 0
    ID: 163-4, Label: 0
    ID: 163-5, Label: 0
    ID: 164-10, Label: 0
    ID: 164-3, Label: 0
    ID: 164-6, Label: 0
    ID: 165-9, Label: 0
    ID: 27-10039, Label: 1
    ID: 27-10041, Label: 1
    ID: 27-10053, Label: 1
    ID: 27-10071, Label: 1
    ID: 27-10112, Label: 1
    ID: 28-11515, Label: 1
    ID: 28-12263, Label: 1
    ID: 28-12381, Label: 1
    ID: 28-12490, Label: 1
    ID: 28-12518, Label: 1
    ID: 29-10006, Label: 1
    ID: 29-10008, Label: 1
    ID: 29-10010, Label: 1
    ID: 29-10011, Label: 1
    ID: 29-10012, Label: 1
    ID: 29-10013, Label: 1
    ID: 29-10386, Label: 1
    ID: 29-10398, Label: 1
    ID: 29-10400, Label: 1
    ID: 29-10404, Label: 1
    ID: 29-10406, Label: 1
    ID: 29-10410, Label: 1
    ID: 30-10018, Label: 2
    ID: 30-10034, Label: 2
    ID: 30-10123, Label: 2
    ID: 30-10125, Label: 2
    ID: 31-10001, Label: 1
    ID: 31-10013, Label: 1
    ID: 31-10035, Label: 1
    ID: 31-10040, Label: 1
    ID: 31-10078, Label: 1
    ID: 31-10210, Label: 1
    ID: 31-10236, Label: 1
    ID: 32-10003, Label: 2
    ID: 32-10034, Label: 2
    ID: 32-10074, Label: 2
    ID: 33-10005, Label: 2
    ID: 34-10050, Label: 2
    ID: 34-10184, Label: 2
    ID: 34-10187, Label: 2
    ID: PRE018-1, Label: 0
    ID: PRE027, Label: 0
    ID: PRE038, Label: 0
    ID: PRE055-1, Label: 0
    ID: PRE062-1, Label: 0
    ID: PRE98sc, Label: 0
    ID: Sample1153-EO3, Label: 0
    ID: Sample1157-EO3, Label: 0
    ID: Sample1158-EO1, Label: 0
    ID: Sample1158-EO2, Label: 0
    ID: Sample1158-EO3, Label: 0
    ID: Sample1162-EO1, Label: 0
    ID: Sample1162-EO2, Label: 0
  → test 환자 ID 및 라벨:
    ID: 27-10119, Label: 1
    ID: 28-10051, Label: 1
    ID: 29-10016, Label: 1
    ID: 29-10280, Label: 1
    ID: 29-10380, Label: 1
    ID: 30-10929, Label: 2
    ID: 30-11051, Label: 2
    ID: 31-10000, Label: 1
    ID: 31-10042, Label: 1
    ID: 31-10154, Label: 1
    ID: 33-10006, Label: 2
    ID: PRE019, Label: 0
    ID: Sample1153-EO1, Label: 0
    ID: Sample1153-EO2, Label: 0
    ID: Sample1157-EO1, Label: 0
    ID: Sample1157-EO2, Label: 0
전체 데이터 index 길이 77
label_stat (train 환자 라벨 목록) 갯수 61
train_data에서 환자 단위로, train과 validation 나누기
기존 train_p_index 61
기존 (train) label_stat 61
train-vali 분할 후! 
train y 의 classes : {0, 1, 2} valid y 의 classes : {0, 1, 2} label_stat 의 classes : {0, 1, 2}
train_p_index_ 40
valid_p_index 21
test_p_index 16
→ train 환자 ID 및 라벨:
   총 개수: 40
   환자ID=29-10011, Label=1, 셀개수=3072
   환자ID=31-10078, Label=1, 셀개수=2827
   환자ID=Sample1153-EO3, Label=0, 셀개수=1516
   환자ID=Sample1158-EO2, Label=0, 셀개수=1427
   환자ID=32-10003, Label=2, 셀개수=2978
   환자ID=163-5, Label=0, 셀개수=1210
   환자ID=28-12518, Label=1, 셀개수=1215
   환자ID=PRE027, Label=0, 셀개수=2078
   환자ID=30-10125, Label=2, 셀개수=3798
   환자ID=30-10034, Label=2, 셀개수=1240
   환자ID=163-3, Label=0, 셀개수=1335
   환자ID=27-10071, Label=1, 셀개수=1478
   환자ID=164-6, Label=0, 셀개수=3038
   환자ID=165-9, Label=0, 셀개수=2926
   환자ID=163-2, Label=0, 셀개수=2535
   환자ID=29-10406, Label=1, 셀개수=3484
   환자ID=31-10013, Label=1, 셀개수=3161
   환자ID=30-10018, Label=2, 셀개수=5170
   환자ID=29-10013, Label=1, 셀개수=3706
   환자ID=31-10001, Label=1, 셀개수=1133
   환자ID=163-4, Label=0, 셀개수=1339
   환자ID=31-10236, Label=1, 셀개수=3458
   환자ID=PRE055-1, Label=0, 셀개수=597
   환자ID=29-10400, Label=1, 셀개수=2684
   환자ID=28-11515, Label=1, 셀개수=930
   환자ID=Sample1162-EO1, Label=0, 셀개수=1053
   환자ID=31-10035, Label=1, 셀개수=2974
   환자ID=34-10187, Label=2, 셀개수=3739
   환자ID=27-10053, Label=1, 셀개수=728
   환자ID=28-12490, Label=1, 셀개수=5973
   환자ID=27-10112, Label=1, 셀개수=1470
   환자ID=164-3, Label=0, 셀개수=1639
   환자ID=29-10398, Label=1, 셀개수=3993
   환자ID=34-10050, Label=2, 셀개수=4784
   환자ID=29-10012, Label=1, 셀개수=6245
   환자ID=32-10074, Label=2, 셀개수=6304
   환자ID=32-10034, Label=2, 셀개수=1555
   환자ID=31-10210, Label=1, 셀개수=3510
   환자ID=29-10010, Label=1, 셀개수=5305
   환자ID=28-12381, Label=1, 셀개수=1099
→ valid 환자 ID 및 라벨:
   총 개수: 21
   환자ID=Sample1162-EO2, Label=0, 셀개수=1510
   환자ID=29-10008, Label=1, 셀개수=1913
   환자ID=31-10040, Label=1, 셀개수=4543
   환자ID=PRE062-1, Label=0, 셀개수=907
   환자ID=Sample1158-EO1, Label=0, 셀개수=574
   환자ID=PRE038, Label=0, 셀개수=2666
   환자ID=Sample1157-EO3, Label=0, 셀개수=807
   환자ID=29-10410, Label=1, 셀개수=2834
   환자ID=30-10123, Label=2, 셀개수=1273
   환자ID=29-10404, Label=1, 셀개수=3988
   환자ID=Sample1158-EO3, Label=0, 셀개수=1096
   환자ID=27-10041, Label=1, 셀개수=2145
   환자ID=29-10386, Label=1, 셀개수=802
   환자ID=PRE98sc, Label=0, 셀개수=1568
   환자ID=34-10184, Label=2, 셀개수=2699
   환자ID=PRE018-1, Label=0, 셀개수=1349
   환자ID=164-10, Label=0, 셀개수=4041
   환자ID=29-10006, Label=1, 셀개수=11461
   환자ID=27-10039, Label=1, 셀개수=4638
   환자ID=28-12263, Label=1, 셀개수=7527
   환자ID=33-10005, Label=2, 셀개수=8904
→ test 환자 ID 및 라벨:
   총 개수: 16
   환자ID=27-10119, Label=1, 셀개수=3346
   환자ID=28-10051, Label=1, 셀개수=300
   환자ID=29-10016, Label=1, 셀개수=4854
   환자ID=29-10280, Label=1, 셀개수=2375
   환자ID=29-10380, Label=1, 셀개수=4799
   환자ID=30-10929, Label=2, 셀개수=5812
   환자ID=30-11051, Label=2, 셀개수=2454
   환자ID=31-10000, Label=1, 셀개수=8870
   환자ID=31-10042, Label=1, 셀개수=1222
   환자ID=31-10154, Label=1, 셀개수=6568
   환자ID=33-10006, Label=2, 셀개수=457
   환자ID=PRE019, Label=0, 셀개수=3795
   환자ID=Sample1153-EO1, Label=0, 셀개수=911
   환자ID=Sample1153-EO2, Label=0, 셀개수=916
   환자ID=Sample1157-EO1, Label=0, 셀개수=1152
   환자ID=Sample1157-EO2, Label=0, 셀개수=1395
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Epithelial_cells', 'Epithelial_cells', 'Astrocyte', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'MSC', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
전체 데이터 길이 225177
전체 cell type 길이 0          Epithelial_cells
1          Epithelial_cells
2                 Astrocyte
3          Epithelial_cells
4          Epithelial_cells
                ...        
225172     Epithelial_cells
225173    Tissue_stem_cells
225174              Neurons
225175          Hepatocytes
225176              Neurons
Length: 225177, dtype: string
cell type의 NaN 개수 체크 0
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:12,  8.07it/s]  2%|▏         | 2/100 [00:00<00:16,  6.08it/s]  3%|▎         | 3/100 [00:00<00:13,  7.16it/s]  4%|▍         | 4/100 [00:00<00:12,  7.88it/s]  5%|▌         | 5/100 [00:00<00:11,  8.15it/s]  6%|▌         | 6/100 [00:00<00:11,  8.50it/s]  8%|▊         | 8/100 [00:00<00:10,  9.17it/s]  9%|▉         | 9/100 [00:01<00:10,  8.69it/s] 10%|█         | 10/100 [00:01<00:10,  8.95it/s] 11%|█         | 11/100 [00:01<00:10,  8.85it/s] 12%|█▏        | 12/100 [00:01<00:09,  8.82it/s] 13%|█▎        | 13/100 [00:01<00:09,  8.84it/s] 14%|█▍        | 14/100 [00:01<00:09,  8.77it/s] 15%|█▌        | 15/100 [00:01<00:09,  9.06it/s] 16%|█▌        | 16/100 [00:01<00:09,  8.92it/s] 17%|█▋        | 17/100 [00:01<00:09,  9.08it/s] 18%|█▊        | 18/100 [00:02<00:09,  9.05it/s] 19%|█▉        | 19/100 [00:02<00:11,  7.33it/s] 20%|██        | 20/100 [00:02<00:10,  7.64it/s] 21%|██        | 21/100 [00:02<00:10,  7.89it/s] 22%|██▏       | 22/100 [00:02<00:09,  8.25it/s] 23%|██▎       | 23/100 [00:02<00:09,  8.53it/s] 24%|██▍       | 24/100 [00:02<00:08,  8.60it/s] 25%|██▌       | 25/100 [00:02<00:08,  8.57it/s] 26%|██▌       | 26/100 [00:03<00:08,  8.78it/s] 27%|██▋       | 27/100 [00:03<00:08,  8.86it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.57it/s] 29%|██▉       | 29/100 [00:03<00:11,  6.42it/s] 30%|███       | 30/100 [00:03<00:10,  6.50it/s] 31%|███       | 31/100 [00:03<00:09,  7.12it/s] 32%|███▏      | 32/100 [00:03<00:09,  7.46it/s] 33%|███▎      | 33/100 [00:04<00:08,  7.65it/s] 34%|███▍      | 34/100 [00:04<00:08,  8.04it/s] 35%|███▌      | 35/100 [00:04<00:07,  8.20it/s] 36%|███▌      | 36/100 [00:04<00:07,  8.40it/s] 37%|███▋      | 37/100 [00:04<00:07,  8.61it/s] 38%|███▊      | 38/100 [00:04<00:07,  8.74it/s] 39%|███▉      | 39/100 [00:04<00:06,  8.75it/s] 40%|████      | 40/100 [00:04<00:06,  8.61it/s] 41%|████      | 41/100 [00:04<00:06,  8.47it/s] 42%|████▏     | 42/100 [00:05<00:07,  8.25it/s] 43%|████▎     | 43/100 [00:05<00:06,  8.21it/s] 44%|████▍     | 44/100 [00:05<00:06,  8.24it/s] 45%|████▌     | 45/100 [00:05<00:07,  7.20it/s] 46%|████▌     | 46/100 [00:05<00:07,  7.63it/s] 47%|████▋     | 47/100 [00:05<00:06,  7.75it/s] 48%|████▊     | 48/100 [00:05<00:06,  7.87it/s] 49%|████▉     | 49/100 [00:05<00:06,  8.15it/s] 50%|█████     | 50/100 [00:06<00:06,  8.17it/s] 51%|█████     | 51/100 [00:06<00:05,  8.26it/s] 52%|█████▏    | 52/100 [00:06<00:05,  8.32it/s] 53%|█████▎    | 53/100 [00:06<00:05,  8.54it/s] 54%|█████▍    | 54/100 [00:06<00:05,  8.22it/s] 55%|█████▌    | 55/100 [00:06<00:05,  8.22it/s] 56%|█████▌    | 56/100 [00:06<00:05,  8.23it/s] 57%|█████▋    | 57/100 [00:06<00:05,  8.32it/s] 58%|█████▊    | 58/100 [00:07<00:05,  8.32it/s] 59%|█████▉    | 59/100 [00:07<00:04,  8.35it/s] 60%|██████    | 60/100 [00:07<00:04,  8.30it/s] 61%|██████    | 61/100 [00:07<00:04,  8.43it/s] 62%|██████▏   | 62/100 [00:07<00:04,  8.51it/s] 63%|██████▎   | 63/100 [00:07<00:04,  8.41it/s] 64%|██████▍   | 64/100 [00:07<00:04,  8.39it/s] 65%|██████▌   | 65/100 [00:07<00:04,  8.39it/s] 66%|██████▌   | 66/100 [00:08<00:04,  8.41it/s] 67%|██████▋   | 67/100 [00:08<00:04,  6.88it/s] 68%|██████▊   | 68/100 [00:08<00:04,  7.38it/s] 69%|██████▉   | 69/100 [00:08<00:04,  7.58it/s] 70%|███████   | 70/100 [00:08<00:03,  7.62it/s] 71%|███████   | 71/100 [00:08<00:03,  7.84it/s] 72%|███████▏  | 72/100 [00:08<00:03,  7.99it/s] 73%|███████▎  | 73/100 [00:08<00:03,  8.17it/s] 74%|███████▍  | 74/100 [00:09<00:03,  7.43it/s] 75%|███████▌  | 75/100 [00:09<00:03,  7.69it/s] 76%|███████▌  | 76/100 [00:09<00:03,  7.81it/s] 77%|███████▋  | 77/100 [00:09<00:02,  7.81it/s] 78%|███████▊  | 78/100 [00:09<00:02,  7.88it/s] 79%|███████▉  | 79/100 [00:09<00:02,  7.62it/s] 80%|████████  | 80/100 [00:09<00:02,  7.59it/s] 81%|████████  | 81/100 [00:10<00:02,  7.66it/s] 82%|████████▏ | 82/100 [00:10<00:02,  7.77it/s] 83%|████████▎ | 83/100 [00:10<00:02,  7.30it/s] 84%|████████▍ | 84/100 [00:10<00:02,  7.56it/s] 85%|████████▌ | 85/100 [00:10<00:01,  7.76it/s] 86%|████████▌ | 86/100 [00:10<00:01,  7.54it/s] 87%|████████▋ | 87/100 [00:10<00:01,  7.74it/s] 88%|████████▊ | 88/100 [00:10<00:01,  7.27it/s] 89%|████████▉ | 89/100 [00:11<00:01,  7.51it/s] 90%|█████████ | 90/100 [00:11<00:01,  7.55it/s] 91%|█████████ | 91/100 [00:11<00:01,  7.74it/s] 92%|█████████▏| 92/100 [00:11<00:01,  7.81it/s] 93%|█████████▎| 93/100 [00:11<00:00,  7.74it/s] 94%|█████████▍| 94/100 [00:11<00:00,  7.80it/s] 95%|█████████▌| 95/100 [00:11<00:00,  7.76it/s] 96%|█████████▌| 96/100 [00:11<00:00,  7.40it/s] 97%|█████████▋| 97/100 [00:12<00:00,  7.35it/s] 98%|█████████▊| 98/100 [00:12<00:00,  7.76it/s] 99%|█████████▉| 99/100 [00:12<00:00,  7.93it/s]100%|██████████| 100/100 [00:12<00:00,  7.87it/s]100%|██████████| 100/100 [00:12<00:00,  8.00it/s]
[I 2025-08-31 01:10:22,451] A new study created in memory with name: no-name-b0dc5ded-8e40-47e3-9d43-c8c9f5497ae8
👉 train samples(학습 샘플(bag))=140, batch_size=16 -> steps(샘플수/batch크기)=9
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 27.97 MB
Memory Reserved: 36.00 MB
cuda
Epoch 1, Train Loss 1.161248, Valid_loss 0.988664
Epoch 2, Train Loss 1.032372, Valid_loss 1.004893
Epoch 3, Train Loss 0.952900, Valid_loss 0.958217
Epoch 4, Train Loss 0.962804, Valid_loss 0.949002
Epoch 5, Train Loss 0.931620, Valid_loss 0.942590
Epoch 6, Train Loss 0.874462, Valid_loss 0.900026
Epoch 7, Train Loss 0.848409, Valid_loss 0.859204
Epoch 8, Train Loss 0.767455, Valid_loss 0.786813
Epoch 9, Train Loss 0.737924, Valid_loss 0.705255
Epoch 10, Train Loss 0.685515, Valid_loss 0.613797
Epoch 11, Train Loss 0.705670, Valid_loss 0.657676
Epoch 12, Train Loss 0.676042, Valid_loss 0.650779
Epoch 13, Train Loss 0.653857, Valid_loss 0.597335
Epoch 14, Train Loss 0.606889, Valid_loss 0.571206
Epoch 15, Train Loss 0.616422, Valid_loss 0.584062
Epoch 16, Train Loss 0.568151, Valid_loss 0.558916
Epoch 17, Train Loss 0.575681, Valid_loss 0.506777
Epoch 18, Train Loss 0.559444, Valid_loss 0.522252
Epoch 19, Train Loss 0.482599, Valid_loss 0.516197
Epoch 20, Train Loss 0.540376, Valid_loss 0.500978
Epoch 21, Train Loss 0.454779, Valid_loss 0.508190
Epoch 22, Train Loss 0.500359, Valid_loss 0.487622
Epoch 23, Train Loss 0.560836, Valid_loss 0.560126
Epoch 24, Train Loss 0.535127, Valid_loss 0.548957
Epoch 25, Train Loss 0.464700, Valid_loss 0.493548
Epoch 26, Train Loss 0.506886, Valid_loss 0.464948
Epoch 27, Train Loss 0.465723, Valid_loss 0.452228
Epoch 28, Train Loss 0.450145, Valid_loss 0.467611
Epoch 29, Train Loss 0.483125, Valid_loss 0.489478
Epoch 30, Train Loss 0.452821, Valid_loss 0.447105
Epoch 31, Train Loss 0.408345, Valid_loss 0.461657
Epoch 32, Train Loss 0.436404, Valid_loss 0.438716
Epoch 33, Train Loss 0.380098, Valid_loss 0.456670
Epoch 34, Train Loss 0.377017, Valid_loss 0.441572
Epoch 35, Train Loss 0.448615, Valid_loss 0.423170
Epoch 36, Train Loss 0.380923, Valid_loss 0.414622
Epoch 37, Train Loss 0.427182, Valid_loss 0.433084
Epoch 38, Train Loss 0.376472, Valid_loss 0.444525
Epoch 39, Train Loss 0.337737, Valid_loss 0.441974
Epoch 40, Train Loss 0.344657, Valid_loss 0.426453
Epoch 41, Train Loss 0.351952, Valid_loss 0.430750
Epoch 42, Train Loss 0.314803, Valid_loss 0.433954
Epoch 43, Train Loss 0.398544, Valid_loss 0.405538
Epoch 44, Train Loss 0.314978, Valid_loss 0.438076
Epoch 45, Train Loss 0.345126, Valid_loss 0.416825
Epoch 46, Train Loss 0.371461, Valid_loss 0.415675
Epoch 47, Train Loss 0.412111, Valid_loss 0.440371
Epoch 48, Train Loss 0.394145, Valid_loss 0.460706
Epoch 49, Train Loss 0.359052, Valid_loss 0.413286
Epoch 50, Train Loss 0.357211, Valid_loss 0.402821
Epoch 51, Train Loss 0.326351, Valid_loss 0.421037
Epoch 52, Train Loss 0.341022, Valid_loss 0.439715
[I 2025-08-31 01:14:58,420] Trial 0 finished with value: 0.40282084828331355 and parameters: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 2, 'dropout': 0.7, 'weight_decay': 0.01, 'emb_dim': 64, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.40282084828331355.
👉 train samples(학습 샘플(bag))=140, batch_size=16 -> steps(샘플수/batch크기)=9
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 26.13 MB
Memory Reserved: 36.00 MB
cuda
Epoch 1, Train Loss 1.242948, Valid_loss 1.029689
Epoch 2, Train Loss 1.128197, Valid_loss 0.998847
Epoch 3, Train Loss 1.045874, Valid_loss 0.988597
Epoch 4, Train Loss 1.050769, Valid_loss 0.981111
Epoch 5, Train Loss 1.019351, Valid_loss 0.976188
Epoch 6, Train Loss 0.950225, Valid_loss 0.955547
Epoch 7, Train Loss 0.952454, Valid_loss 0.943557
Epoch 8, Train Loss 0.893361, Valid_loss 0.924521
Epoch 9, Train Loss 0.988116, Valid_loss 0.902359
Epoch 10, Train Loss 0.895119, Valid_loss 0.887357
Epoch 11, Train Loss 0.840953, Valid_loss 0.845750
Epoch 12, Train Loss 0.812250, Valid_loss 0.797425
Epoch 13, Train Loss 0.856004, Valid_loss 0.802340
Epoch 14, Train Loss 0.791555, Valid_loss 0.773483
Epoch 15, Train Loss 0.783753, Valid_loss 0.743503
Epoch 16, Train Loss 0.718366, Valid_loss 0.721751
Epoch 17, Train Loss 0.707593, Valid_loss 0.679455
Epoch 18, Train Loss 0.647776, Valid_loss 0.659287
Epoch 19, Train Loss 0.684033, Valid_loss 0.666498
Epoch 20, Train Loss 0.708358, Valid_loss 0.676543
Epoch 21, Train Loss 0.709774, Valid_loss 0.653544
Epoch 22, Train Loss 0.710209, Valid_loss 0.652041
Epoch 23, Train Loss 0.584665, Valid_loss 0.622834
Epoch 24, Train Loss 0.640195, Valid_loss 0.677698
Epoch 25, Train Loss 0.609664, Valid_loss 0.613113
Epoch 26, Train Loss 0.621396, Valid_loss 0.618366
Epoch 27, Train Loss 0.634993, Valid_loss 0.607097
Epoch 28, Train Loss 0.601187, Valid_loss 0.621546
Epoch 29, Train Loss 0.658627, Valid_loss 0.589683
Epoch 30, Train Loss 0.658842, Valid_loss 0.582213
Epoch 31, Train Loss 0.605358, Valid_loss 0.564292
Epoch 32, Train Loss 0.602467, Valid_loss 0.587014
Epoch 33, Train Loss 0.568536, Valid_loss 0.535799
Epoch 34, Train Loss 0.592868, Valid_loss 0.567790
Epoch 35, Train Loss 0.581241, Valid_loss 0.538766
Epoch 36, Train Loss 0.570307, Valid_loss 0.539826
Epoch 37, Train Loss 0.544975, Valid_loss 0.501096
Epoch 38, Train Loss 0.575154, Valid_loss 0.504926
Epoch 39, Train Loss 0.500866, Valid_loss 0.507814
Epoch 40, Train Loss 0.518788, Valid_loss 0.497638
Epoch 41, Train Loss 0.575200, Valid_loss 0.517922
Epoch 42, Train Loss 0.549424, Valid_loss 0.489460
Epoch 43, Train Loss 0.530004, Valid_loss 0.480331
Epoch 44, Train Loss 0.470158, Valid_loss 0.483958
Epoch 45, Train Loss 0.420211, Valid_loss 0.451614
Epoch 46, Train Loss 0.512811, Valid_loss 0.448385
Epoch 47, Train Loss 0.562695, Valid_loss 0.464433
Epoch 48, Train Loss 0.489623, Valid_loss 0.464479
Epoch 49, Train Loss 0.519771, Valid_loss 0.494377
Epoch 50, Train Loss 0.498820, Valid_loss 0.467069
Epoch 51, Train Loss 0.444180, Valid_loss 0.466548
Epoch 52, Train Loss 0.466060, Valid_loss 0.459680
Epoch 53, Train Loss 0.555699, Valid_loss 0.441819
Epoch 54, Train Loss 0.474897, Valid_loss 0.458605
Epoch 55, Train Loss 0.486149, Valid_loss 0.470725
[I 2025-08-31 01:21:41,721] Trial 1 finished with value: 0.44181914982341586 and parameters: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 4, 'dropout': 0.7, 'weight_decay': 0.0001, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.40282084828331355.
👉 train samples(학습 샘플(bag))=140, batch_size=16 -> steps(샘플수/batch크기)=9
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 24.81 MB
Memory Reserved: 36.00 MB
cuda
Epoch 1, Train Loss 1.222399, Valid_loss 1.026605
Epoch 2, Train Loss 1.044742, Valid_loss 1.015604
Epoch 3, Train Loss 1.026941, Valid_loss 1.012918
Epoch 4, Train Loss 1.114105, Valid_loss 1.010816
Epoch 5, Train Loss 1.017360, Valid_loss 1.007620
Epoch 6, Train Loss 1.084888, Valid_loss 1.003285
Epoch 7, Train Loss 1.018976, Valid_loss 1.000612
Epoch 8, Train Loss 0.983369, Valid_loss 0.998184
Epoch 9, Train Loss 1.006682, Valid_loss 0.996924
Epoch 10, Train Loss 0.988553, Valid_loss 0.994109
Epoch 11, Train Loss 1.004035, Valid_loss 0.983133
Epoch 12, Train Loss 0.963674, Valid_loss 0.989715
Epoch 13, Train Loss 0.945379, Valid_loss 0.976889
Epoch 14, Train Loss 1.011512, Valid_loss 0.975948
Epoch 15, Train Loss 0.952312, Valid_loss 0.949667
Epoch 16, Train Loss 0.914155, Valid_loss 0.942265
Epoch 17, Train Loss 0.964173, Valid_loss 0.910012
Epoch 18, Train Loss 0.906136, Valid_loss 0.889155
Epoch 19, Train Loss 0.885797, Valid_loss 0.838249
Epoch 20, Train Loss 0.871331, Valid_loss 0.861068
Epoch 21, Train Loss 0.835415, Valid_loss 0.794503
Epoch 22, Train Loss 0.861589, Valid_loss 0.758216
Epoch 23, Train Loss 0.842121, Valid_loss 0.725148
Epoch 24, Train Loss 0.914470, Valid_loss 0.704074
Epoch 25, Train Loss 0.846346, Valid_loss 0.709515
Epoch 26, Train Loss 0.871774, Valid_loss 0.704725
Epoch 27, Train Loss 0.824305, Valid_loss 0.697311
Epoch 28, Train Loss 0.849606, Valid_loss 0.677844
Epoch 29, Train Loss 0.783331, Valid_loss 0.661084
Epoch 30, Train Loss 0.820082, Valid_loss 0.643894
Epoch 31, Train Loss 0.804227, Valid_loss 0.631563
Epoch 32, Train Loss 0.782111, Valid_loss 0.638951
Epoch 33, Train Loss 0.861436, Valid_loss 0.617925
Epoch 34, Train Loss 0.794159, Valid_loss 0.617930
Epoch 35, Train Loss 0.766374, Valid_loss 0.725148
Epoch 36, Train Loss 0.829767, Valid_loss 0.605960
Epoch 37, Train Loss 0.793958, Valid_loss 0.630741
Epoch 38, Train Loss 0.764879, Valid_loss 0.589238
Epoch 39, Train Loss 0.721137, Valid_loss 0.596042
Epoch 40, Train Loss 0.705012, Valid_loss 0.597842
Epoch 41, Train Loss 0.729571, Valid_loss 0.588650
Epoch 42, Train Loss 0.707137, Valid_loss 0.603870
Epoch 43, Train Loss 0.768155, Valid_loss 0.817498
Epoch 44, Train Loss 0.764788, Valid_loss 0.568901
Epoch 45, Train Loss 0.719471, Valid_loss 0.584671
Epoch 46, Train Loss 0.725637, Valid_loss 0.577890
Epoch 47, Train Loss 0.686967, Valid_loss 0.560340
Epoch 48, Train Loss 0.749277, Valid_loss 0.556498
Epoch 49, Train Loss 0.766553, Valid_loss 0.525659
Epoch 50, Train Loss 0.680964, Valid_loss 0.521086
Epoch 51, Train Loss 0.664854, Valid_loss 0.516241
Epoch 52, Train Loss 0.587550, Valid_loss 0.537305
Epoch 53, Train Loss 0.670005, Valid_loss 0.537100
Epoch 54, Train Loss 0.644440, Valid_loss 0.534348
Epoch 55, Train Loss 0.629206, Valid_loss 0.558145
Epoch 56, Train Loss 0.671192, Valid_loss 0.535105
Epoch 57, Train Loss 0.749667, Valid_loss 0.522227
Epoch 58, Train Loss 0.679916, Valid_loss 0.570481
Epoch 59, Train Loss 0.656775, Valid_loss 0.539603
Epoch 60, Train Loss 0.641315, Valid_loss 0.513200
Epoch 61, Train Loss 0.655421, Valid_loss 0.531403
Epoch 62, Train Loss 0.650712, Valid_loss 0.536674
[I 2025-08-31 01:27:08,185] Trial 2 finished with value: 0.513200058113961 and parameters: {'learning_rate': 0.001, 'epochs': 100, 'heads': 2, 'dropout': 0.7, 'weight_decay': 0.001, 'emb_dim': 8, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.40282084828331355.
선택된 trial params: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 2, 'dropout': 0.7, 'weight_decay': 0.01, 'emb_dim': 64, 'augment_num': 100, 'pca': False}
👉 train samples(학습 샘플(bag))=140, batch_size=16 -> steps(샘플수/batch크기)=9
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=16, batch_size=1 -> steps=16
Memory Allocated: 27.97 MB
Memory Reserved: 36.00 MB
cuda
Epoch 1, Train Loss 1.144506, Valid_loss 1.007330
Epoch 2, Train Loss 1.054784, Valid_loss 1.004279
Epoch 3, Train Loss 1.031954, Valid_loss 0.990309
Epoch 4, Train Loss 0.987910, Valid_loss 0.988911
Epoch 5, Train Loss 0.931422, Valid_loss 0.993711
Epoch 6, Train Loss 0.937781, Valid_loss 0.963853
Epoch 7, Train Loss 0.940041, Valid_loss 0.931755
Epoch 8, Train Loss 0.893581, Valid_loss 0.890897
Epoch 9, Train Loss 0.863109, Valid_loss 0.860547
Epoch 10, Train Loss 0.786250, Valid_loss 0.811765
Epoch 11, Train Loss 0.743228, Valid_loss 0.750643
Epoch 12, Train Loss 0.751528, Valid_loss 0.668377
Epoch 13, Train Loss 0.660158, Valid_loss 0.671758
Epoch 14, Train Loss 0.695666, Valid_loss 0.623441
Epoch 15, Train Loss 0.655757, Valid_loss 0.588303
Epoch 16, Train Loss 0.613360, Valid_loss 0.579489
Epoch 17, Train Loss 0.585326, Valid_loss 0.578660
Epoch 18, Train Loss 0.533873, Valid_loss 0.589636
Epoch 19, Train Loss 0.602675, Valid_loss 0.575534
Epoch 20, Train Loss 0.619188, Valid_loss 0.565523
Epoch 21, Train Loss 0.637362, Valid_loss 0.623484
Epoch 22, Train Loss 0.565658, Valid_loss 0.572294
Epoch 23, Train Loss 0.500687, Valid_loss 0.517112
Epoch 24, Train Loss 0.473535, Valid_loss 0.525595
Epoch 25, Train Loss 0.508903, Valid_loss 0.514311
Epoch 26, Train Loss 0.477409, Valid_loss 0.527014
Epoch 27, Train Loss 0.489193, Valid_loss 0.541887
Epoch 28, Train Loss 0.451510, Valid_loss 0.502655
Epoch 29, Train Loss 0.478734, Valid_loss 0.495264
Epoch 30, Train Loss 0.511024, Valid_loss 0.519516
Epoch 31, Train Loss 0.486725, Valid_loss 0.540066
Epoch 32, Train Loss 0.470046, Valid_loss 0.514134
Epoch 33, Train Loss 0.457465, Valid_loss 0.490337
Epoch 34, Train Loss 0.405004, Valid_loss 0.523912
Epoch 35, Train Loss 0.436343, Valid_loss 0.488266
Epoch 36, Train Loss 0.456852, Valid_loss 0.496676
Epoch 37, Train Loss 0.452664, Valid_loss 0.470442
Epoch 38, Train Loss 0.430126, Valid_loss 0.504445
Epoch 39, Train Loss 0.448435, Valid_loss 0.497932
Epoch 40, Train Loss 0.418868, Valid_loss 0.504209
Epoch 41, Train Loss 0.382889, Valid_loss 0.445785
Epoch 42, Train Loss 0.393753, Valid_loss 0.484594
Epoch 43, Train Loss 0.378745, Valid_loss 0.448281
Epoch 44, Train Loss 0.339522, Valid_loss 0.460099
Epoch 45, Train Loss 0.398556, Valid_loss 0.494390
Epoch 46, Train Loss 0.380185, Valid_loss 0.458387
Epoch 47, Train Loss 0.393503, Valid_loss 0.477961
Epoch 48, Train Loss 0.434962, Valid_loss 0.442317
Epoch 49, Train Loss 0.347859, Valid_loss 0.467503
Epoch 50, Train Loss 0.380553, Valid_loss 0.457289
Epoch 51, Train Loss 0.335090, Valid_loss 0.441589
Epoch 52, Train Loss 0.334817, Valid_loss 0.450726
Epoch 53, Train Loss 0.335799, Valid_loss 0.463904
환자ID=27-10119 -- true: [[1]] -- pred: tensor([[-0.0037,  1.6644, -1.4773]], device='cuda:0')
환자ID=28-10051 -- true: [[1]] -- pred: tensor([[-0.4224,  1.4164, -0.9764]], device='cuda:0')
환자ID=29-10016 -- true: [[1]] -- pred: tensor([[-0.2406,  1.5310, -1.3882]], device='cuda:0')
환자ID=29-10280 -- true: [[1]] -- pred: tensor([[-0.7583,  2.0126, -0.3947]], device='cuda:0')
환자ID=29-10380 -- true: [[1]] -- pred: tensor([[-0.7273,  2.0610, -0.4359]], device='cuda:0')
환자ID=30-10929 -- true: [[2]] -- pred: tensor([[-0.8951,  1.7412,  0.1232]], device='cuda:0')
환자ID=30-11051 -- true: [[2]] -- pred: tensor([[-1.0389,  1.2373,  0.7988]], device='cuda:0')
환자ID=31-10000 -- true: [[1]] -- pred: tensor([[-0.6158,  1.9151, -0.6548]], device='cuda:0')
환자ID=31-10042 -- true: [[1]] -- pred: tensor([[-0.8854,  1.8350, -0.1137]], device='cuda:0')
환자ID=31-10154 -- true: [[1]] -- pred: tensor([[ 0.1441,  1.5600, -1.4209]], device='cuda:0')
환자ID=33-10006 -- true: [[2]] -- pred: tensor([[-1.1146,  1.3161,  0.8696]], device='cuda:0')
환자ID=PRE019 -- true: [[0]] -- pred: tensor([[ 2.0123, -0.9514, -1.4208]], device='cuda:0')
환자ID=Sample1153-EO1 -- true: [[0]] -- pred: tensor([[ 1.9997, -0.9464, -1.4398]], device='cuda:0')
환자ID=Sample1153-EO2 -- true: [[0]] -- pred: tensor([[ 2.0256, -0.9678, -1.3904]], device='cuda:0')
환자ID=Sample1157-EO1 -- true: [[0]] -- pred: tensor([[ 1.9828, -0.9188, -1.4371]], device='cuda:0')
환자ID=Sample1157-EO2 -- true: [[0]] -- pred: tensor([[ 1.8431, -0.7906, -1.5368]], device='cuda:0')
Best performance: Epoch 51, Loss 0.335090, Test ACC 0.812500, Test AUC 0.993056, Test Recall 0.666667, Test Precision 0.575758
Confusion Matrix:
 [[5 0 0]
 [0 8 0]
 [0 3 0]]
✅ Total valid splits used: 2
🔁 Repeat 0, Fold 2
cell type :  S2008000605HRT_AAACCCAGTGCACATT-1     Epithelial_cells
S2008000605HRT_AAACCCAGTGCCTACG-1     Epithelial_cells
S2008000605HRT_AAAGAACGTAGAGACC-1            Astrocyte
S2008000605HRT_AAAGAACGTCGGAACA-1     Epithelial_cells
S2008000605HRT_AAAGAACGTTAACAGA-1     Epithelial_cells
                                           ...        
Sample1158EO3_TTTGACTGTACTGAGG-1     Endothelial_cells
Sample1158EO3_TTTGACTTCGTGGACC-1               Neurons
Sample1158EO3_TTTGATCGTGTCCCTT-1      Epithelial_cells
Sample1158EO3_TTTGGAGTCATGTCTT-1      Epithelial_cells
Sample1158EO3_TTTGGTTTCGCGTGAC-1           Hepatocytes
Name: singler_annotation, Length: 192340, dtype: string
cell type annotation :  S2008000605HRT_AAACCCAGTGCACATT-1     Epithelial_cells
S2008000605HRT_AAACCCAGTGCCTACG-1     Epithelial_cells
S2008000605HRT_AAAGAACGTAGAGACC-1            Astrocyte
S2008000605HRT_AAAGAACGTCGGAACA-1     Epithelial_cells
S2008000605HRT_AAAGAACGTTAACAGA-1     Epithelial_cells
                                           ...        
Sample1158EO3_TTTGACTGTACTGAGG-1     Endothelial_cells
Sample1158EO3_TTTGACTTCGTGGACC-1               Neurons
Sample1158EO3_TTTGATCGTGTCCCTT-1      Epithelial_cells
Sample1158EO3_TTTGGAGTCATGTCTT-1      Epithelial_cells
Sample1158EO3_TTTGGTTTCGCGTGAC-1           Hepatocytes
Name: singler_annotation, Length: 192340, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Epithelial_cells', 'Astrocyte', 'MSC', 'Keratinocytes', 'Neurons', 'Endothelial_cells', 'Fibroblasts', 'Tissue_stem_cells', 'Smooth_muscle_cells', 'T_cells', 'Neuroepithelial_cell', 'NK_cell', 'Chondrocytes', 'Osteoblasts', 'Monocyte', 'Hepatocytes', 'Macrophage', 'CMP', 'Embryonic_stem_cells', 'DC', 'BM & Prog.', 'MEP', 'Neutrophils', 'Pro-Myelocyte', 'iPS_cells', 'Pre-B_cell_CD34-', 'HSC_-G-CSF', 'B_cell', 'GMP', 'HSC_CD34+', 'Platelets', 'Pro-B_cell_CD34+', 'Myelocyte', 'BM', 'Erythroblast', 'Gametocytes', 'Unknown']
라벨별 그룹 개수 {0: 21, 1: 30, 2: 11}
cell type :  S2008000651HRT_AAACCCACAGAGTGTG-1              T_cells
S2008000651HRT_AAACCCACATGACTGT-1              T_cells
S2008000651HRT_AAACGAAGTTAATCGC-1          Fibroblasts
S2008000651HRT_AAACGCTAGGCTTAAA-1              T_cells
S2008000651HRT_AAAGAACAGGAACTCG-1              T_cells
                                           ...        
Sample1162EO2_TTTGGAGAGCAGGCAT-1      Epithelial_cells
Sample1162EO2_TTTGGAGAGTCGCGAA-1     Endothelial_cells
Sample1162EO2_TTTGGAGAGTGCTCGC-1           Hepatocytes
Sample1162EO2_TTTGGAGGTGATACTC-1      Epithelial_cells
Sample1162EO2_TTTGGTTCAGTAGAAT-1      Epithelial_cells
Name: singler_annotation, Length: 32837, dtype: string
cell type annotation :  S2008000651HRT_AAACCCACAGAGTGTG-1              T_cells
S2008000651HRT_AAACCCACATGACTGT-1              T_cells
S2008000651HRT_AAACGAAGTTAATCGC-1          Fibroblasts
S2008000651HRT_AAACGCTAGGCTTAAA-1              T_cells
S2008000651HRT_AAAGAACAGGAACTCG-1              T_cells
                                           ...        
Sample1162EO2_TTTGGAGAGCAGGCAT-1      Epithelial_cells
Sample1162EO2_TTTGGAGAGTCGCGAA-1     Endothelial_cells
Sample1162EO2_TTTGGAGAGTGCTCGC-1           Hepatocytes
Sample1162EO2_TTTGGAGGTGATACTC-1      Epithelial_cells
Sample1162EO2_TTTGGTTCAGTAGAAT-1      Epithelial_cells
Name: singler_annotation, Length: 32837, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['T_cells', 'Fibroblasts', 'B_cell', 'Macrophage', 'Pre-B_cell_CD34-', 'NK_cell', 'Endothelial_cells', 'Chondrocytes', 'HSC_-G-CSF', 'CMP', 'Monocyte', 'Smooth_muscle_cells', 'DC', 'BM', 'Tissue_stem_cells', 'Platelets', 'GMP', 'Neutrophils', 'Epithelial_cells', 'HSC_CD34+', 'MSC', 'Pro-Myelocyte', 'iPS_cells', 'Pro-B_cell_CD34+', 'Hepatocytes', 'Neuroepithelial_cell', 'Neurons', 'Astrocyte', 'Embryonic_stem_cells', 'Keratinocytes', 'Unknown', 'BM & Prog.', 'Erythroblast', 'MEP', 'Osteoblasts', 'Gametocytes', 'Myelocyte']
라벨별 그룹 개수 {0: 5, 1: 7, 2: 3}
🔍 Split #3
  → train_p_index 환자 수 (환자 단위로 묶인 index list): 62
  → test_p_index 환자 수  (환자 단위로 묶인 index list): 15
  → train 환자 ID: ['163-2', '163-3', '163-5', '164-3', '165-9', '27-10039', '27-10041', '27-10053', '27-10112', '27-10119', '28-10051', '28-11515', '28-12263', '28-12490', '29-10006', '29-10008', '29-10010', '29-10012', '29-10013', '29-10016', '29-10280', '29-10380', '29-10386', '29-10398', '29-10400', '29-10404', '29-10410', '30-10018', '30-10123', '30-10125', '30-10929', '30-11051', '31-10000', '31-10013', '31-10035', '31-10040', '31-10042', '31-10078', '31-10154', '31-10210', '32-10034', '32-10074', '33-10005', '33-10006', '34-10050', '34-10187', 'PRE018-1', 'PRE019', 'PRE027', 'PRE038', 'PRE055-1', 'PRE062-1', 'PRE98sc', 'Sample1153-EO1', 'Sample1153-EO2', 'Sample1153-EO3', 'Sample1157-EO1', 'Sample1157-EO2', 'Sample1157-EO3', 'Sample1158-EO1', 'Sample1158-EO2', 'Sample1158-EO3']
  → test  환자 ID: ['163-4', '164-10', '164-6', '27-10071', '28-12381', '28-12518', '29-10011', '29-10406', '30-10034', '31-10001', '31-10236', '32-10003', '34-10184', 'Sample1162-EO1', 'Sample1162-EO2']
  → train 환자 ID 및 라벨:
    ID: 163-2, Label: 0
    ID: 163-3, Label: 0
    ID: 163-5, Label: 0
    ID: 164-3, Label: 0
    ID: 165-9, Label: 0
    ID: 27-10039, Label: 1
    ID: 27-10041, Label: 1
    ID: 27-10053, Label: 1
    ID: 27-10112, Label: 1
    ID: 27-10119, Label: 1
    ID: 28-10051, Label: 1
    ID: 28-11515, Label: 1
    ID: 28-12263, Label: 1
    ID: 28-12490, Label: 1
    ID: 29-10006, Label: 1
    ID: 29-10008, Label: 1
    ID: 29-10010, Label: 1
    ID: 29-10012, Label: 1
    ID: 29-10013, Label: 1
    ID: 29-10016, Label: 1
    ID: 29-10280, Label: 1
    ID: 29-10380, Label: 1
    ID: 29-10386, Label: 1
    ID: 29-10398, Label: 1
    ID: 29-10400, Label: 1
    ID: 29-10404, Label: 1
    ID: 29-10410, Label: 1
    ID: 30-10018, Label: 2
    ID: 30-10123, Label: 2
    ID: 30-10125, Label: 2
    ID: 30-10929, Label: 2
    ID: 30-11051, Label: 2
    ID: 31-10000, Label: 1
    ID: 31-10013, Label: 1
    ID: 31-10035, Label: 1
    ID: 31-10040, Label: 1
    ID: 31-10042, Label: 1
    ID: 31-10078, Label: 1
    ID: 31-10154, Label: 1
    ID: 31-10210, Label: 1
    ID: 32-10034, Label: 2
    ID: 32-10074, Label: 2
    ID: 33-10005, Label: 2
    ID: 33-10006, Label: 2
    ID: 34-10050, Label: 2
    ID: 34-10187, Label: 2
    ID: PRE018-1, Label: 0
    ID: PRE019, Label: 0
    ID: PRE027, Label: 0
    ID: PRE038, Label: 0
    ID: PRE055-1, Label: 0
    ID: PRE062-1, Label: 0
    ID: PRE98sc, Label: 0
    ID: Sample1153-EO1, Label: 0
    ID: Sample1153-EO2, Label: 0
    ID: Sample1153-EO3, Label: 0
    ID: Sample1157-EO1, Label: 0
    ID: Sample1157-EO2, Label: 0
    ID: Sample1157-EO3, Label: 0
    ID: Sample1158-EO1, Label: 0
    ID: Sample1158-EO2, Label: 0
    ID: Sample1158-EO3, Label: 0
  → test 환자 ID 및 라벨:
    ID: 163-4, Label: 0
    ID: 164-10, Label: 0
    ID: 164-6, Label: 0
    ID: 27-10071, Label: 1
    ID: 28-12381, Label: 1
    ID: 28-12518, Label: 1
    ID: 29-10011, Label: 1
    ID: 29-10406, Label: 1
    ID: 30-10034, Label: 2
    ID: 31-10001, Label: 1
    ID: 31-10236, Label: 1
    ID: 32-10003, Label: 2
    ID: 34-10184, Label: 2
    ID: Sample1162-EO1, Label: 0
    ID: Sample1162-EO2, Label: 0
전체 데이터 index 길이 77
label_stat (train 환자 라벨 목록) 갯수 62
train_data에서 환자 단위로, train과 validation 나누기
기존 train_p_index 62
기존 (train) label_stat 62
train-vali 분할 후! 
train y 의 classes : {0, 1, 2} valid y 의 classes : {0, 1, 2} label_stat 의 classes : {0, 1, 2}
train_p_index_ 41
valid_p_index 21
test_p_index 15
→ train 환자 ID 및 라벨:
   총 개수: 41
   환자ID=29-10380, Label=1, 셀개수=4799
   환자ID=31-10154, Label=1, 셀개수=6568
   환자ID=PRE018-1, Label=0, 셀개수=1349
   환자ID=32-10074, Label=2, 셀개수=6304
   환자ID=Sample1157-EO3, Label=0, 셀개수=807
   환자ID=164-3, Label=0, 셀개수=1639
   환자ID=29-10012, Label=1, 셀개수=6245
   환자ID=PRE055-1, Label=0, 셀개수=597
   환자ID=31-10013, Label=1, 셀개수=3161
   환자ID=30-11051, Label=2, 셀개수=2454
   환자ID=163-3, Label=0, 셀개수=1335
   환자ID=28-11515, Label=1, 셀개수=930
   환자ID=27-10041, Label=1, 셀개수=2145
   환자ID=27-10053, Label=1, 셀개수=728
   환자ID=163-2, Label=0, 셀개수=2535
   환자ID=30-10123, Label=2, 셀개수=1273
   환자ID=31-10040, Label=1, 셀개수=4543
   환자ID=30-10929, Label=2, 셀개수=5812
   환자ID=Sample1158-EO1, Label=0, 셀개수=574
   환자ID=29-10398, Label=1, 셀개수=3993
   환자ID=31-10035, Label=1, 셀개수=2974
   환자ID=163-5, Label=0, 셀개수=1210
   환자ID=32-10034, Label=2, 셀개수=1555
   환자ID=PRE98sc, Label=0, 셀개수=1568
   환자ID=29-10410, Label=1, 셀개수=2834
   환자ID=28-12490, Label=1, 셀개수=5973
   환자ID=Sample1158-EO2, Label=0, 셀개수=1427
   환자ID=31-10042, Label=1, 셀개수=1222
   환자ID=PRE019, Label=0, 셀개수=3795
   환자ID=28-10051, Label=1, 셀개수=300
   환자ID=29-10010, Label=1, 셀개수=5305
   환자ID=28-12263, Label=1, 셀개수=7527
   환자ID=27-10039, Label=1, 셀개수=4638
   환자ID=29-10404, Label=1, 셀개수=3988
   환자ID=34-10187, Label=2, 셀개수=3739
   환자ID=29-10386, Label=1, 셀개수=802
   환자ID=33-10006, Label=2, 셀개수=457
   환자ID=33-10005, Label=2, 셀개수=8904
   환자ID=31-10210, Label=1, 셀개수=3510
   환자ID=29-10280, Label=1, 셀개수=2375
   환자ID=29-10008, Label=1, 셀개수=1913
→ valid 환자 ID 및 라벨:
   총 개수: 21
   환자ID=Sample1158-EO3, Label=0, 셀개수=1096
   환자ID=29-10016, Label=1, 셀개수=4854
   환자ID=31-10078, Label=1, 셀개수=2827
   환자ID=Sample1153-EO1, Label=0, 셀개수=911
   환자ID=34-10050, Label=2, 셀개수=4784
   환자ID=PRE062-1, Label=0, 셀개수=907
   환자ID=Sample1157-EO1, Label=0, 셀개수=1152
   환자ID=30-10125, Label=2, 셀개수=3798
   환자ID=31-10000, Label=1, 셀개수=8870
   환자ID=30-10018, Label=2, 셀개수=5170
   환자ID=Sample1157-EO2, Label=0, 셀개수=1395
   환자ID=27-10119, Label=1, 셀개수=3346
   환자ID=29-10400, Label=1, 셀개수=2684
   환자ID=Sample1153-EO2, Label=0, 셀개수=916
   환자ID=PRE038, Label=0, 셀개수=2666
   환자ID=PRE027, Label=0, 셀개수=2078
   환자ID=165-9, Label=0, 셀개수=2926
   환자ID=29-10013, Label=1, 셀개수=3706
   환자ID=27-10112, Label=1, 셀개수=1470
   환자ID=29-10006, Label=1, 셀개수=11461
   환자ID=Sample1153-EO3, Label=0, 셀개수=1516
→ test 환자 ID 및 라벨:
   총 개수: 15
   환자ID=163-4, Label=0, 셀개수=1339
   환자ID=164-10, Label=0, 셀개수=4041
   환자ID=164-6, Label=0, 셀개수=3038
   환자ID=27-10071, Label=1, 셀개수=1478
   환자ID=28-12381, Label=1, 셀개수=1099
   환자ID=28-12518, Label=1, 셀개수=1215
   환자ID=29-10011, Label=1, 셀개수=3072
   환자ID=29-10406, Label=1, 셀개수=3484
   환자ID=30-10034, Label=2, 셀개수=1240
   환자ID=31-10001, Label=1, 셀개수=1133
   환자ID=31-10236, Label=1, 셀개수=3458
   환자ID=32-10003, Label=2, 셀개수=2978
   환자ID=34-10184, Label=2, 셀개수=2699
   환자ID=Sample1162-EO1, Label=0, 셀개수=1053
   환자ID=Sample1162-EO2, Label=0, 셀개수=1510
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Epithelial_cells', 'Epithelial_cells', 'Astrocyte', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'MSC', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
전체 데이터 길이 225177
전체 cell type 길이 0          Epithelial_cells
1          Epithelial_cells
2                 Astrocyte
3          Epithelial_cells
4          Epithelial_cells
                ...        
225172     Epithelial_cells
225173    Endothelial_cells
225174          Hepatocytes
225175     Epithelial_cells
225176     Epithelial_cells
Length: 225177, dtype: string
cell type의 NaN 개수 체크 0
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:12,  8.04it/s]  2%|▏         | 2/100 [00:00<00:11,  8.57it/s]  3%|▎         | 3/100 [00:00<00:11,  8.56it/s]  4%|▍         | 4/100 [00:00<00:10,  9.05it/s]  5%|▌         | 5/100 [00:00<00:13,  7.18it/s]  6%|▌         | 6/100 [00:00<00:12,  7.76it/s]  7%|▋         | 7/100 [00:00<00:12,  7.61it/s]  8%|▊         | 8/100 [00:01<00:11,  7.99it/s]  9%|▉         | 9/100 [00:01<00:11,  7.67it/s] 10%|█         | 10/100 [00:01<00:13,  6.84it/s] 11%|█         | 11/100 [00:01<00:12,  7.31it/s] 12%|█▏        | 12/100 [00:01<00:11,  7.68it/s] 13%|█▎        | 13/100 [00:01<00:10,  7.99it/s] 14%|█▍        | 14/100 [00:01<00:10,  8.10it/s] 15%|█▌        | 15/100 [00:01<00:10,  8.27it/s] 16%|█▌        | 16/100 [00:02<00:10,  8.38it/s] 17%|█▋        | 17/100 [00:02<00:09,  8.59it/s] 18%|█▊        | 18/100 [00:02<00:10,  7.46it/s] 19%|█▉        | 19/100 [00:02<00:10,  7.76it/s] 20%|██        | 20/100 [00:02<00:09,  8.13it/s] 21%|██        | 21/100 [00:02<00:09,  8.36it/s] 22%|██▏       | 22/100 [00:02<00:09,  8.37it/s] 23%|██▎       | 23/100 [00:02<00:09,  8.37it/s] 24%|██▍       | 24/100 [00:03<00:09,  8.30it/s] 25%|██▌       | 25/100 [00:03<00:08,  8.44it/s] 26%|██▌       | 26/100 [00:03<00:08,  8.45it/s] 28%|██▊       | 28/100 [00:03<00:08,  9.00it/s] 30%|███       | 30/100 [00:03<00:07,  9.18it/s] 31%|███       | 31/100 [00:03<00:07,  9.26it/s] 32%|███▏      | 32/100 [00:03<00:07,  9.02it/s] 33%|███▎      | 33/100 [00:04<00:07,  8.55it/s] 34%|███▍      | 34/100 [00:04<00:07,  8.71it/s] 35%|███▌      | 35/100 [00:04<00:07,  8.53it/s] 36%|███▌      | 36/100 [00:04<00:07,  8.46it/s] 37%|███▋      | 37/100 [00:04<00:07,  8.56it/s] 38%|███▊      | 38/100 [00:04<00:07,  8.76it/s] 39%|███▉      | 39/100 [00:04<00:07,  8.71it/s] 40%|████      | 40/100 [00:04<00:06,  8.93it/s] 41%|████      | 41/100 [00:04<00:06,  9.18it/s] 42%|████▏     | 42/100 [00:05<00:06,  8.99it/s] 43%|████▎     | 43/100 [00:05<00:06,  8.74it/s] 44%|████▍     | 44/100 [00:05<00:06,  8.74it/s] 45%|████▌     | 45/100 [00:05<00:06,  8.69it/s] 46%|████▌     | 46/100 [00:05<00:06,  8.50it/s] 47%|████▋     | 47/100 [00:05<00:06,  8.47it/s] 48%|████▊     | 48/100 [00:05<00:06,  8.60it/s] 49%|████▉     | 49/100 [00:05<00:06,  7.86it/s] 50%|█████     | 50/100 [00:06<00:06,  7.74it/s] 51%|█████     | 51/100 [00:06<00:06,  7.90it/s] 52%|█████▏    | 52/100 [00:06<00:06,  7.84it/s] 53%|█████▎    | 53/100 [00:06<00:05,  7.90it/s] 54%|█████▍    | 54/100 [00:06<00:05,  7.75it/s] 55%|█████▌    | 55/100 [00:06<00:05,  8.07it/s] 56%|█████▌    | 56/100 [00:06<00:05,  7.45it/s] 57%|█████▋    | 57/100 [00:06<00:05,  7.61it/s] 58%|█████▊    | 58/100 [00:07<00:05,  7.83it/s] 59%|█████▉    | 59/100 [00:07<00:05,  8.03it/s] 60%|██████    | 60/100 [00:07<00:05,  7.61it/s] 61%|██████    | 61/100 [00:07<00:05,  7.67it/s] 62%|██████▏   | 62/100 [00:07<00:04,  8.02it/s] 63%|██████▎   | 63/100 [00:07<00:04,  8.19it/s] 64%|██████▍   | 64/100 [00:07<00:04,  8.11it/s] 65%|██████▌   | 65/100 [00:07<00:04,  8.15it/s] 66%|██████▌   | 66/100 [00:08<00:04,  8.07it/s] 67%|██████▋   | 67/100 [00:08<00:04,  8.18it/s] 68%|██████▊   | 68/100 [00:08<00:03,  8.45it/s] 69%|██████▉   | 69/100 [00:08<00:03,  8.40it/s] 70%|███████   | 70/100 [00:08<00:03,  8.44it/s] 71%|███████   | 71/100 [00:08<00:03,  8.19it/s] 72%|███████▏  | 72/100 [00:08<00:03,  8.11it/s] 73%|███████▎  | 73/100 [00:08<00:03,  8.10it/s] 74%|███████▍  | 74/100 [00:09<00:03,  7.92it/s] 75%|███████▌  | 75/100 [00:09<00:03,  7.86it/s] 76%|███████▌  | 76/100 [00:09<00:03,  7.04it/s] 77%|███████▋  | 77/100 [00:09<00:03,  7.51it/s] 78%|███████▊  | 78/100 [00:09<00:02,  7.71it/s] 79%|███████▉  | 79/100 [00:09<00:02,  8.00it/s] 80%|████████  | 80/100 [00:09<00:02,  7.80it/s] 81%|████████  | 81/100 [00:09<00:02,  7.92it/s] 82%|████████▏ | 82/100 [00:10<00:02,  7.87it/s] 83%|████████▎ | 83/100 [00:10<00:02,  7.98it/s] 84%|████████▍ | 84/100 [00:10<00:02,  7.98it/s] 85%|████████▌ | 85/100 [00:10<00:01,  8.01it/s] 86%|████████▌ | 86/100 [00:10<00:01,  7.97it/s] 87%|████████▋ | 87/100 [00:10<00:01,  7.85it/s] 88%|████████▊ | 88/100 [00:10<00:01,  8.02it/s] 89%|████████▉ | 89/100 [00:10<00:01,  7.99it/s] 90%|█████████ | 90/100 [00:11<00:01,  8.05it/s] 91%|█████████ | 91/100 [00:11<00:01,  8.06it/s] 92%|█████████▏| 92/100 [00:11<00:00,  8.18it/s] 93%|█████████▎| 93/100 [00:11<00:00,  8.12it/s] 94%|█████████▍| 94/100 [00:11<00:00,  7.89it/s] 95%|█████████▌| 95/100 [00:11<00:00,  8.21it/s] 96%|█████████▌| 96/100 [00:11<00:00,  8.02it/s] 97%|█████████▋| 97/100 [00:11<00:00,  7.78it/s] 98%|█████████▊| 98/100 [00:12<00:00,  7.83it/s] 99%|█████████▉| 99/100 [00:12<00:00,  8.12it/s]100%|██████████| 100/100 [00:12<00:00,  6.88it/s]100%|██████████| 100/100 [00:12<00:00,  8.08it/s]
[I 2025-08-31 01:32:07,123] A new study created in memory with name: no-name-5fa4a4e2-17e6-41ff-870c-519a3ad95a7e
👉 train samples(학습 샘플(bag))=141, batch_size=16 -> steps(샘플수/batch크기)=9
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 26.13 MB
Memory Reserved: 36.00 MB
cuda
Epoch 1, Train Loss 1.012829, Valid_loss 0.974832
Epoch 2, Train Loss 0.944479, Valid_loss 0.943700
Epoch 3, Train Loss 0.902605, Valid_loss 0.893376
Epoch 4, Train Loss 0.889544, Valid_loss 0.858556
Epoch 5, Train Loss 0.811027, Valid_loss 0.789044
Epoch 6, Train Loss 0.745367, Valid_loss 0.736703
Epoch 7, Train Loss 0.762825, Valid_loss 0.738495
Epoch 8, Train Loss 0.753047, Valid_loss 0.653235
Epoch 9, Train Loss 0.618880, Valid_loss 0.712832
Epoch 10, Train Loss 0.649140, Valid_loss 0.622744
Epoch 11, Train Loss 0.613291, Valid_loss 0.614049
Epoch 12, Train Loss 0.630767, Valid_loss 0.653655
Epoch 13, Train Loss 0.633604, Valid_loss 0.590982
Epoch 14, Train Loss 0.602740, Valid_loss 0.586964
Epoch 15, Train Loss 0.578219, Valid_loss 0.595151
Epoch 16, Train Loss 0.588893, Valid_loss 0.586251
Epoch 17, Train Loss 0.567282, Valid_loss 0.527597
Epoch 18, Train Loss 0.548929, Valid_loss 0.627841
Epoch 19, Train Loss 0.578193, Valid_loss 0.498459
Epoch 20, Train Loss 0.595933, Valid_loss 0.573062
Epoch 21, Train Loss 0.533539, Valid_loss 0.508440
Epoch 22, Train Loss 0.500680, Valid_loss 0.510003
Epoch 23, Train Loss 0.535583, Valid_loss 0.558545
Epoch 24, Train Loss 0.536318, Valid_loss 0.487818
Epoch 25, Train Loss 0.519081, Valid_loss 0.554132
Epoch 26, Train Loss 0.493283, Valid_loss 0.470344
Epoch 27, Train Loss 0.522531, Valid_loss 0.540159
Epoch 28, Train Loss 0.475157, Valid_loss 0.468553
Epoch 29, Train Loss 0.494299, Valid_loss 0.506423
Epoch 30, Train Loss 0.466414, Valid_loss 0.436646
Epoch 31, Train Loss 0.473198, Valid_loss 0.471174
Epoch 32, Train Loss 0.485805, Valid_loss 0.463685
Epoch 33, Train Loss 0.494382, Valid_loss 0.486675
Epoch 34, Train Loss 0.487870, Valid_loss 0.409664
Epoch 35, Train Loss 0.451443, Valid_loss 0.452070
Epoch 36, Train Loss 0.444693, Valid_loss 0.454813
Epoch 37, Train Loss 0.481635, Valid_loss 0.430255
Epoch 38, Train Loss 0.442827, Valid_loss 0.442247
Epoch 39, Train Loss 0.465794, Valid_loss 0.420408
Epoch 40, Train Loss 0.431646, Valid_loss 0.396221
Epoch 41, Train Loss 0.411705, Valid_loss 0.371002
Epoch 42, Train Loss 0.427051, Valid_loss 0.451479
Epoch 43, Train Loss 0.432123, Valid_loss 0.369074
Epoch 44, Train Loss 0.421327, Valid_loss 0.407908
Epoch 45, Train Loss 0.423415, Valid_loss 0.370356
Epoch 46, Train Loss 0.381773, Valid_loss 0.339664
Epoch 47, Train Loss 0.396490, Valid_loss 0.424291
Epoch 48, Train Loss 0.429110, Valid_loss 0.326257
Epoch 49, Train Loss 0.418400, Valid_loss 0.440099
Epoch 50, Train Loss 0.385603, Valid_loss 0.336898
Epoch 51, Train Loss 0.412352, Valid_loss 0.343331
Epoch 52, Train Loss 0.400174, Valid_loss 0.350660
[I 2025-08-31 01:37:56,204] Trial 0 finished with value: 0.3262566558661915 and parameters: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 1, 'dropout': 0.5, 'weight_decay': 0.01, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.3262566558661915.
👉 train samples(학습 샘플(bag))=141, batch_size=16 -> steps(샘플수/batch크기)=9
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 26.13 MB
Memory Reserved: 36.00 MB
cuda
Epoch 1, Train Loss 1.169365, Valid_loss 1.010227
Epoch 2, Train Loss 1.086266, Valid_loss 0.998629
Epoch 3, Train Loss 0.993422, Valid_loss 0.978150
Epoch 4, Train Loss 0.935993, Valid_loss 0.962354
Epoch 5, Train Loss 0.952845, Valid_loss 0.941678
Epoch 6, Train Loss 0.906319, Valid_loss 0.910392
Epoch 7, Train Loss 0.840844, Valid_loss 0.851411
Epoch 8, Train Loss 0.855419, Valid_loss 0.801746
Epoch 9, Train Loss 0.789010, Valid_loss 0.756097
Epoch 10, Train Loss 0.736588, Valid_loss 0.681241
Epoch 11, Train Loss 0.719282, Valid_loss 0.673323
Epoch 12, Train Loss 0.700902, Valid_loss 0.603847
Epoch 13, Train Loss 0.688722, Valid_loss 0.556423
Epoch 14, Train Loss 0.657298, Valid_loss 0.560164
Epoch 15, Train Loss 0.623588, Valid_loss 0.577802
Epoch 16, Train Loss 0.642065, Valid_loss 0.524951
Epoch 17, Train Loss 0.636389, Valid_loss 0.532270
Epoch 18, Train Loss 0.599081, Valid_loss 0.485423
Epoch 19, Train Loss 0.592261, Valid_loss 0.479469
Epoch 20, Train Loss 0.532326, Valid_loss 0.493322
Epoch 21, Train Loss 0.539288, Valid_loss 0.440319
Epoch 22, Train Loss 0.535530, Valid_loss 0.470223
Epoch 23, Train Loss 0.554330, Valid_loss 0.451846
Epoch 24, Train Loss 0.572143, Valid_loss 0.444829
Epoch 25, Train Loss 0.539496, Valid_loss 0.438486
Epoch 26, Train Loss 0.498291, Valid_loss 0.414104
Epoch 27, Train Loss 0.483649, Valid_loss 0.451801
Epoch 28, Train Loss 0.448570, Valid_loss 0.389697
Epoch 29, Train Loss 0.472211, Valid_loss 0.431163
Epoch 30, Train Loss 0.412768, Valid_loss 0.375366
Epoch 31, Train Loss 0.459007, Valid_loss 0.405226
Epoch 32, Train Loss 0.405039, Valid_loss 0.354093
Epoch 33, Train Loss 0.467053, Valid_loss 0.373991
Epoch 34, Train Loss 0.462240, Valid_loss 0.373294
Epoch 35, Train Loss 0.424857, Valid_loss 0.385937
Epoch 36, Train Loss 0.417267, Valid_loss 0.371867
Epoch 37, Train Loss 0.412887, Valid_loss 0.327319
Epoch 38, Train Loss 0.400647, Valid_loss 0.365773
Epoch 39, Train Loss 0.421013, Valid_loss 0.324843
Epoch 40, Train Loss 0.405430, Valid_loss 0.347104
Epoch 41, Train Loss 0.372661, Valid_loss 0.316750
Epoch 42, Train Loss 0.387577, Valid_loss 0.315982
Epoch 43, Train Loss 0.357403, Valid_loss 0.331698
Epoch 44, Train Loss 0.405528, Valid_loss 0.320043
Epoch 45, Train Loss 0.376430, Valid_loss 0.282726
Epoch 46, Train Loss 0.424267, Valid_loss 0.297901
Epoch 47, Train Loss 0.377455, Valid_loss 0.298686
Epoch 48, Train Loss 0.390009, Valid_loss 0.274780
Epoch 49, Train Loss 0.346619, Valid_loss 0.318393
Epoch 50, Train Loss 0.389547, Valid_loss 0.271393
Epoch 51, Train Loss 0.383127, Valid_loss 0.288513
Epoch 52, Train Loss 0.352469, Valid_loss 0.301695
[I 2025-08-31 01:43:46,245] Trial 1 finished with value: 0.2713934041204907 and parameters: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 1, 'dropout': 0.5, 'weight_decay': 0.0001, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 1 with value: 0.2713934041204907.
👉 train samples(학습 샘플(bag))=141, batch_size=16 -> steps(샘플수/batch크기)=9
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 24.81 MB
Memory Reserved: 36.00 MB
cuda
Epoch 1, Train Loss 0.999763, Valid_loss 1.043088
Epoch 2, Train Loss 0.938122, Valid_loss 1.032820
Epoch 3, Train Loss 0.930449, Valid_loss 1.039526
Epoch 4, Train Loss 0.927776, Valid_loss 1.026755
Epoch 5, Train Loss 0.920214, Valid_loss 1.038818
Epoch 6, Train Loss 0.894306, Valid_loss 0.921203
Epoch 7, Train Loss 0.820830, Valid_loss 1.062571
Epoch 8, Train Loss 0.827940, Valid_loss 0.776924
Epoch 9, Train Loss 0.643589, Valid_loss 0.724177
Epoch 10, Train Loss 0.576151, Valid_loss 0.597653
Epoch 11, Train Loss 0.569008, Valid_loss 0.505126
Epoch 12, Train Loss 0.457179, Valid_loss 0.483366
Epoch 13, Train Loss 0.473076, Valid_loss 0.424752
Epoch 14, Train Loss 0.422969, Valid_loss 0.517137
Epoch 15, Train Loss 0.367265, Valid_loss 0.447472
Epoch 16, Train Loss 0.546959, Valid_loss 0.906648
Epoch 17, Train Loss 1.259161, Valid_loss 1.081753
Epoch 18, Train Loss 1.021734, Valid_loss 1.009649
Epoch 19, Train Loss 0.960796, Valid_loss 1.038984
Epoch 20, Train Loss 0.943588, Valid_loss 1.066346
Epoch 21, Train Loss 0.935172, Valid_loss 1.044305
Epoch 22, Train Loss 0.930231, Valid_loss 1.021780
Epoch 23, Train Loss 0.934159, Valid_loss 1.040043
Epoch 24, Train Loss 0.937469, Valid_loss 1.031254
Epoch 25, Train Loss 0.926453, Valid_loss 1.047294
Epoch 26, Train Loss 0.933623, Valid_loss 1.051184
Epoch 27, Train Loss 0.929978, Valid_loss 1.041534
Epoch 28, Train Loss 0.930799, Valid_loss 1.025732
Epoch 29, Train Loss 0.934769, Valid_loss 1.046783
Epoch 30, Train Loss 0.933125, Valid_loss 1.045298
Epoch 31, Train Loss 0.930870, Valid_loss 1.039619
Epoch 32, Train Loss 0.934261, Valid_loss 1.054513
Epoch 33, Train Loss 0.931328, Valid_loss 1.034201
Epoch 34, Train Loss 0.931216, Valid_loss 1.029256
Epoch 35, Train Loss 0.934817, Valid_loss 1.053097
Epoch 36, Train Loss 0.929821, Valid_loss 1.045725
Epoch 37, Train Loss 0.927613, Valid_loss 1.040003
Epoch 38, Train Loss 0.931889, Valid_loss 1.055631
Epoch 39, Train Loss 0.932726, Valid_loss 1.058819
Epoch 40, Train Loss 0.932689, Valid_loss 1.041143
Epoch 41, Train Loss 0.930267, Valid_loss 1.032676
Epoch 42, Train Loss 0.929561, Valid_loss 1.056090
Epoch 43, Train Loss 0.930341, Valid_loss 1.051644
Epoch 44, Train Loss 0.930358, Valid_loss 1.056515
Epoch 45, Train Loss 0.925269, Valid_loss 1.041542
Epoch 46, Train Loss 0.929758, Valid_loss 1.047907
Epoch 47, Train Loss 0.930428, Valid_loss 1.050236
Epoch 48, Train Loss 0.927176, Valid_loss 1.041514
Epoch 49, Train Loss 0.930550, Valid_loss 1.044428
Epoch 50, Train Loss 0.931172, Valid_loss 1.057262
Epoch 51, Train Loss 0.924443, Valid_loss 1.048764
Epoch 52, Train Loss 0.916762, Valid_loss 0.991829
Epoch 53, Train Loss 0.911392, Valid_loss 1.070915
Epoch 54, Train Loss 0.873772, Valid_loss 0.821340
Epoch 55, Train Loss 0.801814, Valid_loss 0.831952
Epoch 56, Train Loss 0.709753, Valid_loss 0.753351
Epoch 57, Train Loss 0.716549, Valid_loss 1.199991
Epoch 58, Train Loss 0.919133, Valid_loss 0.932663
Epoch 59, Train Loss 0.744117, Valid_loss 0.802885
Epoch 60, Train Loss 0.647331, Valid_loss 0.789771
Epoch 61, Train Loss 0.519445, Valid_loss 0.548875
Epoch 62, Train Loss 0.484771, Valid_loss 0.563383
Epoch 63, Train Loss 0.514937, Valid_loss 0.513933
Epoch 64, Train Loss 0.536882, Valid_loss 0.824277
Epoch 65, Train Loss 0.544074, Valid_loss 0.534691
Epoch 66, Train Loss 0.471186, Valid_loss 0.435710
Epoch 67, Train Loss 0.400643, Valid_loss 0.420450
Epoch 68, Train Loss 0.379058, Valid_loss 0.474303
Epoch 69, Train Loss 0.351469, Valid_loss 0.397460
Epoch 70, Train Loss 0.351120, Valid_loss 0.391006
Epoch 71, Train Loss 0.467420, Valid_loss 0.487543
Epoch 72, Train Loss 0.670068, Valid_loss 1.034618
[I 2025-08-31 01:51:38,738] Trial 2 finished with value: 0.3910061229197752 and parameters: {'learning_rate': 0.01, 'epochs': 100, 'heads': 1, 'dropout': 0.0, 'weight_decay': 0.01, 'emb_dim': 8, 'augment_num': 100, 'pca': False}. Best is trial 1 with value: 0.2713934041204907.
선택된 trial params: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 1, 'dropout': 0.5, 'weight_decay': 0.0001, 'emb_dim': 32, 'augment_num': 100, 'pca': False}
👉 train samples(학습 샘플(bag))=141, batch_size=16 -> steps(샘플수/batch크기)=9
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=15, batch_size=1 -> steps=15
Memory Allocated: 26.13 MB
Memory Reserved: 36.00 MB
cuda
Epoch 1, Train Loss 1.047546, Valid_loss 1.002318
Epoch 2, Train Loss 0.985208, Valid_loss 0.977506
Epoch 3, Train Loss 0.927282, Valid_loss 0.973193
Epoch 4, Train Loss 0.905467, Valid_loss 0.913732
Epoch 5, Train Loss 0.877442, Valid_loss 0.837123
Epoch 6, Train Loss 0.826337, Valid_loss 0.754605
Epoch 7, Train Loss 0.763101, Valid_loss 0.674323
Epoch 8, Train Loss 0.725982, Valid_loss 0.639546
Epoch 9, Train Loss 0.652110, Valid_loss 0.580228
Epoch 10, Train Loss 0.652468, Valid_loss 0.532753
Epoch 11, Train Loss 0.629608, Valid_loss 0.544580
Epoch 12, Train Loss 0.574365, Valid_loss 0.492801
Epoch 13, Train Loss 0.575129, Valid_loss 0.521102
Epoch 14, Train Loss 0.602486, Valid_loss 0.453152
Epoch 15, Train Loss 0.541526, Valid_loss 0.465973
Epoch 16, Train Loss 0.502781, Valid_loss 0.458747
Epoch 17, Train Loss 0.540373, Valid_loss 0.468866
Epoch 18, Train Loss 0.465832, Valid_loss 0.462783
Epoch 19, Train Loss 0.503101, Valid_loss 0.439786
Epoch 20, Train Loss 0.457146, Valid_loss 0.462125
Epoch 21, Train Loss 0.496424, Valid_loss 0.480146
Epoch 22, Train Loss 0.499789, Valid_loss 0.396980
Epoch 23, Train Loss 0.442929, Valid_loss 0.463240
Epoch 24, Train Loss 0.467538, Valid_loss 0.436782
Epoch 25, Train Loss 0.454188, Valid_loss 0.381792
Epoch 26, Train Loss 0.439026, Valid_loss 0.465154
Epoch 27, Train Loss 0.427297, Valid_loss 0.398328
Epoch 28, Train Loss 0.454806, Valid_loss 0.556424
Epoch 29, Train Loss 0.427529, Valid_loss 0.368471
Epoch 30, Train Loss 0.422223, Valid_loss 0.522500
Epoch 31, Train Loss 0.432554, Valid_loss 0.355812
Epoch 32, Train Loss 0.421253, Valid_loss 0.471575
Epoch 33, Train Loss 0.411102, Valid_loss 0.386665
Epoch 34, Train Loss 0.433628, Valid_loss 0.477734
Epoch 35, Train Loss 0.413985, Valid_loss 0.358586
Epoch 36, Train Loss 0.425669, Valid_loss 0.437660
Epoch 37, Train Loss 0.410327, Valid_loss 0.373747
Epoch 38, Train Loss 0.433508, Valid_loss 0.379056
Epoch 39, Train Loss 0.407838, Valid_loss 0.396202
Epoch 40, Train Loss 0.360752, Valid_loss 0.402028
Epoch 41, Train Loss 0.380577, Valid_loss 0.386862
Epoch 42, Train Loss 0.364408, Valid_loss 0.401979
Epoch 43, Train Loss 0.381901, Valid_loss 0.313184
Epoch 44, Train Loss 0.360392, Valid_loss 0.424547
Epoch 45, Train Loss 0.371852, Valid_loss 0.330609
Epoch 46, Train Loss 0.361548, Valid_loss 0.352685
Epoch 47, Train Loss 0.374857, Valid_loss 0.395393
Epoch 48, Train Loss 0.355259, Valid_loss 0.312300
Epoch 49, Train Loss 0.341894, Valid_loss 0.365626
Epoch 50, Train Loss 0.356220, Valid_loss 0.340945
Epoch 51, Train Loss 0.364328, Valid_loss 0.354424
Epoch 52, Train Loss 0.327290, Valid_loss 0.326607
Epoch 53, Train Loss 0.354717, Valid_loss 0.339191
Epoch 54, Train Loss 0.353955, Valid_loss 0.323851
Epoch 55, Train Loss 0.338423, Valid_loss 0.336757
Epoch 56, Train Loss 0.354570, Valid_loss 0.300056
Epoch 57, Train Loss 0.348412, Valid_loss 0.326490
Epoch 58, Train Loss 0.345733, Valid_loss 0.297723
Epoch 59, Train Loss 0.353634, Valid_loss 0.313551
Epoch 60, Train Loss 0.321942, Valid_loss 0.321122
환자ID=163-4 -- true: [[0]] -- pred: tensor([[ 2.2037, -0.8357, -1.6868]], device='cuda:0')
환자ID=164-10 -- true: [[0]] -- pred: tensor([[ 2.1822, -0.6889, -1.6924]], device='cuda:0')
환자ID=164-6 -- true: [[0]] -- pred: tensor([[ 2.2012, -0.6616, -1.7431]], device='cuda:0')
환자ID=27-10071 -- true: [[1]] -- pred: tensor([[-0.9813,  1.4091, -0.2110]], device='cuda:0')
환자ID=28-12381 -- true: [[1]] -- pred: tensor([[-0.2933,  1.7632, -0.7283]], device='cuda:0')
환자ID=28-12518 -- true: [[1]] -- pred: tensor([[-0.5488,  1.9281, -0.6780]], device='cuda:0')
환자ID=29-10011 -- true: [[1]] -- pred: tensor([[-0.4803,  1.7006, -0.5843]], device='cuda:0')
환자ID=29-10406 -- true: [[1]] -- pred: tensor([[-0.5973,  1.8463, -0.7707]], device='cuda:0')
환자ID=30-10034 -- true: [[2]] -- pred: tensor([[-0.3867,  1.9285, -0.6638]], device='cuda:0')
환자ID=31-10001 -- true: [[1]] -- pred: tensor([[-0.6590,  1.7630, -0.4671]], device='cuda:0')
환자ID=31-10236 -- true: [[1]] -- pred: tensor([[-0.7426,  1.8161, -0.5731]], device='cuda:0')
환자ID=32-10003 -- true: [[2]] -- pred: tensor([[-1.2405,  1.0187,  0.0879]], device='cuda:0')
환자ID=34-10184 -- true: [[2]] -- pred: tensor([[-0.8097,  1.7617, -0.6369]], device='cuda:0')
환자ID=Sample1162-EO1 -- true: [[0]] -- pred: tensor([[ 2.2079, -0.7881, -1.7122]], device='cuda:0')
환자ID=Sample1162-EO2 -- true: [[0]] -- pred: tensor([[ 2.1978, -0.8914, -1.6961]], device='cuda:0')
Best performance: Epoch 58, Loss 0.345733, Test ACC 0.800000, Test AUC 0.857143, Test Recall 0.666667, Test Precision 0.566667
Confusion Matrix:
 [[5 0 0]
 [0 7 0]
 [0 3 0]]
✅ Total valid splits used: 3
🔁 Repeat 0, Fold 3
cell type :  S2008000605HRT_AAACCCAGTGCACATT-1     Epithelial_cells
S2008000605HRT_AAACCCAGTGCCTACG-1     Epithelial_cells
S2008000605HRT_AAAGAACGTAGAGACC-1            Astrocyte
S2008000605HRT_AAAGAACGTCGGAACA-1     Epithelial_cells
S2008000605HRT_AAAGAACGTTAACAGA-1     Epithelial_cells
                                           ...        
Sample1162EO2_TTTGGAGAGCAGGCAT-1      Epithelial_cells
Sample1162EO2_TTTGGAGAGTCGCGAA-1     Endothelial_cells
Sample1162EO2_TTTGGAGAGTGCTCGC-1           Hepatocytes
Sample1162EO2_TTTGGAGGTGATACTC-1      Epithelial_cells
Sample1162EO2_TTTGGTTCAGTAGAAT-1      Epithelial_cells
Name: singler_annotation, Length: 163460, dtype: string
cell type annotation :  S2008000605HRT_AAACCCAGTGCACATT-1     Epithelial_cells
S2008000605HRT_AAACCCAGTGCCTACG-1     Epithelial_cells
S2008000605HRT_AAAGAACGTAGAGACC-1            Astrocyte
S2008000605HRT_AAAGAACGTCGGAACA-1     Epithelial_cells
S2008000605HRT_AAAGAACGTTAACAGA-1     Epithelial_cells
                                           ...        
Sample1162EO2_TTTGGAGAGCAGGCAT-1      Epithelial_cells
Sample1162EO2_TTTGGAGAGTCGCGAA-1     Endothelial_cells
Sample1162EO2_TTTGGAGAGTGCTCGC-1           Hepatocytes
Sample1162EO2_TTTGGAGGTGATACTC-1      Epithelial_cells
Sample1162EO2_TTTGGTTCAGTAGAAT-1      Epithelial_cells
Name: singler_annotation, Length: 163460, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Epithelial_cells', 'Astrocyte', 'MSC', 'Keratinocytes', 'Neurons', 'Endothelial_cells', 'Fibroblasts', 'Tissue_stem_cells', 'Smooth_muscle_cells', 'T_cells', 'Neuroepithelial_cell', 'NK_cell', 'Chondrocytes', 'Osteoblasts', 'Monocyte', 'Hepatocytes', 'Macrophage', 'CMP', 'Embryonic_stem_cells', 'DC', 'BM & Prog.', 'MEP', 'Neutrophils', 'Pro-Myelocyte', 'iPS_cells', 'Pre-B_cell_CD34-', 'HSC_-G-CSF', 'B_cell', 'BM', 'Platelets', 'GMP', 'HSC_CD34+', 'Pro-B_cell_CD34+', 'Myelocyte', 'Unknown', 'Erythroblast', 'Gametocytes']
라벨별 그룹 개수 {0: 21, 1: 30, 2: 11}
cell type :  S2008000628HRT_AAACCCAAGACGCTCC-1                      DC
S2008000628HRT_AAACCCAAGTAGCCAG-1                 T_cells
S2008000628HRT_AAACCCAGTCCAGAAG-1                 T_cells
S2008000628HRT_AAACCCAGTGTATCCA-1                  B_cell
S2008000628HRT_AAACGAAAGCGTTAGG-1             Fibroblasts
                                             ...         
PRE98sc_TTTGGTTAGCTGTACT-1              Endothelial_cells
PRE98sc_TTTGGTTAGGATCACG-1           Neuroepithelial_cell
PRE98sc_TTTGGTTGTGCCCGTA-1              Endothelial_cells
PRE98sc_TTTGTTGAGTTCTCTT-1               Epithelial_cells
PRE98sc_TTTGTTGGTGTCGCTG-1                    Hepatocytes
Name: singler_annotation, Length: 61717, dtype: string
cell type annotation :  S2008000628HRT_AAACCCAAGACGCTCC-1                      DC
S2008000628HRT_AAACCCAAGTAGCCAG-1                 T_cells
S2008000628HRT_AAACCCAGTCCAGAAG-1                 T_cells
S2008000628HRT_AAACCCAGTGTATCCA-1                  B_cell
S2008000628HRT_AAACGAAAGCGTTAGG-1             Fibroblasts
                                             ...         
PRE98sc_TTTGGTTAGCTGTACT-1              Endothelial_cells
PRE98sc_TTTGGTTAGGATCACG-1           Neuroepithelial_cell
PRE98sc_TTTGGTTGTGCCCGTA-1              Endothelial_cells
PRE98sc_TTTGTTGAGTTCTCTT-1               Epithelial_cells
PRE98sc_TTTGTTGGTGTCGCTG-1                    Hepatocytes
Name: singler_annotation, Length: 61717, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['DC', 'T_cells', 'B_cell', 'Fibroblasts', 'Macrophage', 'Monocyte', 'HSC_-G-CSF', 'Pre-B_cell_CD34-', 'Neutrophils', 'GMP', 'Smooth_muscle_cells', 'MSC', 'NK_cell', 'Epithelial_cells', 'iPS_cells', 'HSC_CD34+', 'Chondrocytes', 'Platelets', 'Pro-B_cell_CD34+', 'Myelocyte', 'Osteoblasts', 'BM', 'Pro-Myelocyte', 'Endothelial_cells', 'Tissue_stem_cells', 'CMP', 'Astrocyte', 'Embryonic_stem_cells', 'Hepatocytes', 'Neurons', 'Keratinocytes', 'Neuroepithelial_cell', 'MEP', 'BM & Prog.', 'Erythroblast', 'Unknown', 'Gametocytes']
라벨별 그룹 개수 {0: 5, 1: 7, 2: 3}
🔍 Split #4
  → train_p_index 환자 수 (환자 단위로 묶인 index list): 62
  → test_p_index 환자 수  (환자 단위로 묶인 index list): 15
  → train 환자 ID: ['163-3', '163-4', '163-5', '164-10', '164-6', '165-9', '27-10041', '27-10053', '27-10071', '27-10112', '27-10119', '28-10051', '28-11515', '28-12381', '28-12490', '28-12518', '29-10008', '29-10010', '29-10011', '29-10012', '29-10016', '29-10280', '29-10380', '29-10386', '29-10398', '29-10400', '29-10406', '30-10018', '30-10034', '30-10125', '30-10929', '30-11051', '31-10000', '31-10001', '31-10035', '31-10040', '31-10042', '31-10078', '31-10154', '31-10210', '31-10236', '32-10003', '32-10034', '32-10074', '33-10006', '34-10050', '34-10184', 'PRE018-1', 'PRE019', 'PRE055-1', 'PRE062-1', 'Sample1153-EO1', 'Sample1153-EO2', 'Sample1153-EO3', 'Sample1157-EO1', 'Sample1157-EO2', 'Sample1157-EO3', 'Sample1158-EO1', 'Sample1158-EO2', 'Sample1158-EO3', 'Sample1162-EO1', 'Sample1162-EO2']
  → test  환자 ID: ['163-2', '164-3', '27-10039', '28-12263', '29-10006', '29-10013', '29-10404', '29-10410', '30-10123', '31-10013', '33-10005', '34-10187', 'PRE027', 'PRE038', 'PRE98sc']
  → train 환자 ID 및 라벨:
    ID: 163-3, Label: 0
    ID: 163-4, Label: 0
    ID: 163-5, Label: 0
    ID: 164-10, Label: 0
    ID: 164-6, Label: 0
    ID: 165-9, Label: 0
    ID: 27-10041, Label: 1
    ID: 27-10053, Label: 1
    ID: 27-10071, Label: 1
    ID: 27-10112, Label: 1
    ID: 27-10119, Label: 1
    ID: 28-10051, Label: 1
    ID: 28-11515, Label: 1
    ID: 28-12381, Label: 1
    ID: 28-12490, Label: 1
    ID: 28-12518, Label: 1
    ID: 29-10008, Label: 1
    ID: 29-10010, Label: 1
    ID: 29-10011, Label: 1
    ID: 29-10012, Label: 1
    ID: 29-10016, Label: 1
    ID: 29-10280, Label: 1
    ID: 29-10380, Label: 1
    ID: 29-10386, Label: 1
    ID: 29-10398, Label: 1
    ID: 29-10400, Label: 1
    ID: 29-10406, Label: 1
    ID: 30-10018, Label: 2
    ID: 30-10034, Label: 2
    ID: 30-10125, Label: 2
    ID: 30-10929, Label: 2
    ID: 30-11051, Label: 2
    ID: 31-10000, Label: 1
    ID: 31-10001, Label: 1
    ID: 31-10035, Label: 1
    ID: 31-10040, Label: 1
    ID: 31-10042, Label: 1
    ID: 31-10078, Label: 1
    ID: 31-10154, Label: 1
    ID: 31-10210, Label: 1
    ID: 31-10236, Label: 1
    ID: 32-10003, Label: 2
    ID: 32-10034, Label: 2
    ID: 32-10074, Label: 2
    ID: 33-10006, Label: 2
    ID: 34-10050, Label: 2
    ID: 34-10184, Label: 2
    ID: PRE018-1, Label: 0
    ID: PRE019, Label: 0
    ID: PRE055-1, Label: 0
    ID: PRE062-1, Label: 0
    ID: Sample1153-EO1, Label: 0
    ID: Sample1153-EO2, Label: 0
    ID: Sample1153-EO3, Label: 0
    ID: Sample1157-EO1, Label: 0
    ID: Sample1157-EO2, Label: 0
    ID: Sample1157-EO3, Label: 0
    ID: Sample1158-EO1, Label: 0
    ID: Sample1158-EO2, Label: 0
    ID: Sample1158-EO3, Label: 0
    ID: Sample1162-EO1, Label: 0
    ID: Sample1162-EO2, Label: 0
  → test 환자 ID 및 라벨:
    ID: 163-2, Label: 0
    ID: 164-3, Label: 0
    ID: 27-10039, Label: 1
    ID: 28-12263, Label: 1
    ID: 29-10006, Label: 1
    ID: 29-10013, Label: 1
    ID: 29-10404, Label: 1
    ID: 29-10410, Label: 1
    ID: 30-10123, Label: 2
    ID: 31-10013, Label: 1
    ID: 33-10005, Label: 2
    ID: 34-10187, Label: 2
    ID: PRE027, Label: 0
    ID: PRE038, Label: 0
    ID: PRE98sc, Label: 0
전체 데이터 index 길이 77
label_stat (train 환자 라벨 목록) 갯수 62
train_data에서 환자 단위로, train과 validation 나누기
기존 train_p_index 62
기존 (train) label_stat 62
train-vali 분할 후! 
train y 의 classes : {0, 1, 2} valid y 의 classes : {0, 1, 2} label_stat 의 classes : {0, 1, 2}
train_p_index_ 41
valid_p_index 21
test_p_index 15
→ train 환자 ID 및 라벨:
   총 개수: 41
   환자ID=29-10280, Label=1, 셀개수=2375
   환자ID=31-10154, Label=1, 셀개수=6568
   환자ID=34-10184, Label=2, 셀개수=2699
   환자ID=32-10003, Label=2, 셀개수=2978
   환자ID=Sample1158-EO2, Label=0, 셀개수=1427
   환자ID=164-10, Label=0, 셀개수=4041
   환자ID=29-10010, Label=1, 셀개수=5305
   환자ID=PRE062-1, Label=0, 셀개수=907
   환자ID=31-10001, Label=1, 셀개수=1133
   환자ID=30-11051, Label=2, 셀개수=2454
   환자ID=163-4, Label=0, 셀개수=1339
   환자ID=28-10051, Label=1, 셀개수=300
   환자ID=27-10041, Label=1, 셀개수=2145
   환자ID=27-10053, Label=1, 셀개수=728
   환자ID=163-3, Label=0, 셀개수=1335
   환자ID=30-10034, Label=2, 셀개수=1240
   환자ID=31-10040, Label=1, 셀개수=4543
   환자ID=30-10929, Label=2, 셀개수=5812
   환자ID=Sample1158-EO3, Label=0, 셀개수=1096
   환자ID=29-10386, Label=1, 셀개수=802
   환자ID=31-10035, Label=1, 셀개수=2974
   환자ID=163-5, Label=0, 셀개수=1210
   환자ID=31-10236, Label=1, 셀개수=3458
   환자ID=Sample1153-EO2, Label=0, 셀개수=916
   환자ID=29-10406, Label=1, 셀개수=3484
   환자ID=28-12381, Label=1, 셀개수=1099
   환자ID=Sample1162-EO1, Label=0, 셀개수=1053
   환자ID=31-10042, Label=1, 셀개수=1222
   환자ID=PRE018-1, Label=0, 셀개수=1349
   환자ID=27-10119, Label=1, 셀개수=3346
   환자ID=29-10008, Label=1, 셀개수=1913
   환자ID=28-11515, Label=1, 셀개수=930
   환자ID=165-9, Label=0, 셀개수=2926
   환자ID=29-10400, Label=1, 셀개수=2684
   환자ID=34-10050, Label=2, 셀개수=4784
   환자ID=29-10380, Label=1, 셀개수=4799
   환자ID=32-10074, Label=2, 셀개수=6304
   환자ID=32-10034, Label=2, 셀개수=1555
   환자ID=31-10210, Label=1, 셀개수=3510
   환자ID=29-10016, Label=1, 셀개수=4854
   환자ID=28-12518, Label=1, 셀개수=1215
→ valid 환자 ID 및 라벨:
   총 개수: 21
   환자ID=Sample1162-EO2, Label=0, 셀개수=1510
   환자ID=29-10012, Label=1, 셀개수=6245
   환자ID=31-10078, Label=1, 셀개수=2827
   환자ID=Sample1153-EO3, Label=0, 셀개수=1516
   환자ID=33-10006, Label=2, 셀개수=457
   환자ID=Sample1153-EO1, Label=0, 셀개수=911
   환자ID=Sample1157-EO3, Label=0, 셀개수=807
   환자ID=30-10125, Label=2, 셀개수=3798
   환자ID=31-10000, Label=1, 셀개수=8870
   환자ID=30-10018, Label=2, 셀개수=5170
   환자ID=Sample1158-EO1, Label=0, 셀개수=574
   환자ID=27-10112, Label=1, 셀개수=1470
   환자ID=29-10398, Label=1, 셀개수=3993
   환자ID=Sample1157-EO1, Label=0, 셀개수=1152
   환자ID=PRE055-1, Label=0, 셀개수=597
   환자ID=PRE019, Label=0, 셀개수=3795
   환자ID=164-6, Label=0, 셀개수=3038
   환자ID=29-10011, Label=1, 셀개수=3072
   환자ID=27-10071, Label=1, 셀개수=1478
   환자ID=28-12490, Label=1, 셀개수=5973
   환자ID=Sample1157-EO2, Label=0, 셀개수=1395
→ test 환자 ID 및 라벨:
   총 개수: 15
   환자ID=163-2, Label=0, 셀개수=2535
   환자ID=164-3, Label=0, 셀개수=1639
   환자ID=27-10039, Label=1, 셀개수=4638
   환자ID=28-12263, Label=1, 셀개수=7527
   환자ID=29-10006, Label=1, 셀개수=11461
   환자ID=29-10013, Label=1, 셀개수=3706
   환자ID=29-10404, Label=1, 셀개수=3988
   환자ID=29-10410, Label=1, 셀개수=2834
   환자ID=30-10123, Label=2, 셀개수=1273
   환자ID=31-10013, Label=1, 셀개수=3161
   환자ID=33-10005, Label=2, 셀개수=8904
   환자ID=34-10187, Label=2, 셀개수=3739
   환자ID=PRE027, Label=0, 셀개수=2078
   환자ID=PRE038, Label=0, 셀개수=2666
   환자ID=PRE98sc, Label=0, 셀개수=1568
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Epithelial_cells', 'Epithelial_cells', 'Astrocyte', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'MSC', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
전체 데이터 길이 225177
전체 cell type 길이 0             Epithelial_cells
1             Epithelial_cells
2                    Astrocyte
3             Epithelial_cells
4             Epithelial_cells
                  ...         
225172       Endothelial_cells
225173    Neuroepithelial_cell
225174       Endothelial_cells
225175        Epithelial_cells
225176             Hepatocytes
Length: 225177, dtype: string
cell type의 NaN 개수 체크 0
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  2%|▏         | 2/100 [00:00<00:10,  9.64it/s]  3%|▎         | 3/100 [00:00<00:09,  9.74it/s]  4%|▍         | 4/100 [00:00<00:10,  9.44it/s]  5%|▌         | 5/100 [00:00<00:09,  9.56it/s]  6%|▌         | 6/100 [00:00<00:10,  9.37it/s]  8%|▊         | 8/100 [00:00<00:09,  9.46it/s]  9%|▉         | 9/100 [00:00<00:09,  9.37it/s] 10%|█         | 10/100 [00:01<00:09,  9.24it/s] 11%|█         | 11/100 [00:01<00:09,  9.24it/s] 12%|█▏        | 12/100 [00:01<00:09,  9.03it/s] 13%|█▎        | 13/100 [00:01<00:09,  8.91it/s] 14%|█▍        | 14/100 [00:01<00:10,  8.08it/s] 16%|█▌        | 16/100 [00:01<00:09,  8.51it/s] 17%|█▋        | 17/100 [00:01<00:09,  8.45it/s] 18%|█▊        | 18/100 [00:02<00:09,  8.73it/s] 19%|█▉        | 19/100 [00:02<00:09,  8.86it/s] 20%|██        | 20/100 [00:02<00:08,  8.92it/s] 21%|██        | 21/100 [00:02<00:09,  8.74it/s] 22%|██▏       | 22/100 [00:02<00:08,  8.91it/s] 23%|██▎       | 23/100 [00:02<00:13,  5.55it/s] 24%|██▍       | 24/100 [00:02<00:12,  6.23it/s] 25%|██▌       | 25/100 [00:03<00:11,  6.68it/s] 26%|██▌       | 26/100 [00:03<00:10,  7.21it/s] 27%|██▋       | 27/100 [00:03<00:09,  7.78it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.13it/s] 29%|██▉       | 29/100 [00:03<00:08,  8.22it/s] 30%|███       | 30/100 [00:03<00:09,  7.68it/s] 31%|███       | 31/100 [00:03<00:08,  8.01it/s] 32%|███▏      | 32/100 [00:03<00:08,  7.97it/s] 34%|███▍      | 34/100 [00:04<00:07,  8.68it/s] 35%|███▌      | 35/100 [00:04<00:07,  8.71it/s] 36%|███▌      | 36/100 [00:04<00:07,  8.84it/s] 37%|███▋      | 37/100 [00:04<00:07,  8.86it/s] 38%|███▊      | 38/100 [00:04<00:06,  8.98it/s] 39%|███▉      | 39/100 [00:04<00:06,  8.94it/s] 40%|████      | 40/100 [00:04<00:06,  9.05it/s] 41%|████      | 41/100 [00:04<00:06,  9.16it/s] 42%|████▏     | 42/100 [00:04<00:06,  8.99it/s] 43%|████▎     | 43/100 [00:05<00:06,  8.69it/s] 44%|████▍     | 44/100 [00:05<00:06,  8.42it/s] 45%|████▌     | 45/100 [00:05<00:06,  8.32it/s] 46%|████▌     | 46/100 [00:05<00:06,  8.53it/s] 47%|████▋     | 47/100 [00:05<00:06,  8.39it/s] 48%|████▊     | 48/100 [00:05<00:07,  7.00it/s] 49%|████▉     | 49/100 [00:05<00:06,  7.62it/s] 50%|█████     | 50/100 [00:05<00:06,  8.06it/s] 51%|█████     | 51/100 [00:06<00:05,  8.23it/s] 52%|█████▏    | 52/100 [00:06<00:05,  8.37it/s] 53%|█████▎    | 53/100 [00:06<00:05,  8.57it/s] 54%|█████▍    | 54/100 [00:06<00:05,  8.62it/s] 55%|█████▌    | 55/100 [00:06<00:05,  8.48it/s] 56%|█████▌    | 56/100 [00:06<00:05,  8.47it/s] 57%|█████▋    | 57/100 [00:06<00:04,  8.61it/s] 58%|█████▊    | 58/100 [00:06<00:04,  8.43it/s] 59%|█████▉    | 59/100 [00:07<00:04,  8.37it/s] 60%|██████    | 60/100 [00:07<00:04,  8.22it/s] 61%|██████    | 61/100 [00:07<00:04,  8.43it/s] 62%|██████▏   | 62/100 [00:07<00:04,  8.43it/s] 63%|██████▎   | 63/100 [00:07<00:04,  8.37it/s] 64%|██████▍   | 64/100 [00:07<00:04,  8.25it/s] 65%|██████▌   | 65/100 [00:07<00:04,  8.35it/s] 66%|██████▌   | 66/100 [00:07<00:04,  8.28it/s] 67%|██████▋   | 67/100 [00:07<00:03,  8.40it/s] 68%|██████▊   | 68/100 [00:08<00:03,  8.49it/s] 69%|██████▉   | 69/100 [00:08<00:03,  8.56it/s] 70%|███████   | 70/100 [00:08<00:03,  8.37it/s] 71%|███████   | 71/100 [00:08<00:03,  8.25it/s] 72%|███████▏  | 72/100 [00:08<00:03,  8.29it/s] 73%|███████▎  | 73/100 [00:08<00:03,  8.29it/s] 74%|███████▍  | 74/100 [00:08<00:03,  7.81it/s] 75%|███████▌  | 75/100 [00:08<00:03,  7.83it/s] 76%|███████▌  | 76/100 [00:09<00:02,  8.05it/s] 77%|███████▋  | 77/100 [00:09<00:02,  8.21it/s] 78%|███████▊  | 78/100 [00:09<00:02,  8.25it/s] 79%|███████▉  | 79/100 [00:09<00:02,  8.23it/s] 80%|████████  | 80/100 [00:09<00:02,  7.74it/s] 81%|████████  | 81/100 [00:09<00:02,  7.64it/s] 82%|████████▏ | 82/100 [00:09<00:02,  7.70it/s] 83%|████████▎ | 83/100 [00:09<00:02,  7.78it/s] 84%|████████▍ | 84/100 [00:10<00:02,  7.99it/s] 85%|████████▌ | 85/100 [00:10<00:01,  8.07it/s] 86%|████████▌ | 86/100 [00:10<00:01,  7.20it/s] 87%|████████▋ | 87/100 [00:10<00:01,  7.49it/s] 88%|████████▊ | 88/100 [00:10<00:01,  7.61it/s] 89%|████████▉ | 89/100 [00:10<00:01,  7.52it/s] 90%|█████████ | 90/100 [00:10<00:01,  7.73it/s] 91%|█████████ | 91/100 [00:11<00:01,  7.87it/s] 92%|█████████▏| 92/100 [00:11<00:01,  7.66it/s] 93%|█████████▎| 93/100 [00:11<00:00,  7.69it/s] 94%|█████████▍| 94/100 [00:11<00:00,  7.77it/s] 95%|█████████▌| 95/100 [00:11<00:00,  7.69it/s] 96%|█████████▌| 96/100 [00:11<00:00,  7.68it/s] 97%|█████████▋| 97/100 [00:11<00:00,  7.92it/s] 98%|█████████▊| 98/100 [00:11<00:00,  7.99it/s] 99%|█████████▉| 99/100 [00:12<00:00,  7.69it/s]100%|██████████| 100/100 [00:12<00:00,  7.65it/s]100%|██████████| 100/100 [00:12<00:00,  8.20it/s]
[I 2025-08-31 01:58:38,576] A new study created in memory with name: no-name-4ccc67b9-c6f7-401e-80ed-232e5cdd3288
👉 train samples(학습 샘플(bag))=141, batch_size=16 -> steps(샘플수/batch크기)=9
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 24.81 MB
Memory Reserved: 36.00 MB
cuda
Epoch 1, Train Loss 0.954518, Valid_loss 1.022718
Epoch 2, Train Loss 0.885906, Valid_loss 0.999278
Epoch 3, Train Loss 0.874369, Valid_loss 0.873517
Epoch 4, Train Loss 0.787562, Valid_loss 0.769772
Epoch 5, Train Loss 0.700249, Valid_loss 0.566516
Epoch 6, Train Loss 0.848073, Valid_loss 0.612081
Epoch 7, Train Loss 0.848502, Valid_loss 0.715042
Epoch 8, Train Loss 0.575322, Valid_loss 0.617304
Epoch 9, Train Loss 0.581135, Valid_loss 0.591116
Epoch 10, Train Loss 0.611671, Valid_loss 0.551788
Epoch 11, Train Loss 0.646638, Valid_loss 0.512203
Epoch 12, Train Loss 0.485628, Valid_loss 0.451572
Epoch 13, Train Loss 0.485744, Valid_loss 0.560686
Epoch 14, Train Loss 0.615370, Valid_loss 0.845264
Epoch 15, Train Loss 1.001736, Valid_loss 1.087473
Epoch 16, Train Loss 0.939340, Valid_loss 0.972487
Epoch 17, Train Loss 0.870971, Valid_loss 0.883526
Epoch 18, Train Loss 0.778854, Valid_loss 0.732543
Epoch 19, Train Loss 0.655259, Valid_loss 0.671232
Epoch 20, Train Loss 0.502607, Valid_loss 0.685962
Epoch 21, Train Loss 0.731705, Valid_loss 1.037585
Epoch 22, Train Loss 0.794433, Valid_loss 0.665078
Epoch 23, Train Loss 0.693650, Valid_loss 0.544592
Epoch 24, Train Loss 0.651387, Valid_loss 0.590905
Epoch 25, Train Loss 0.679361, Valid_loss 0.504036
Epoch 26, Train Loss 0.568130, Valid_loss 0.481919
Epoch 27, Train Loss 0.499576, Valid_loss 0.690098
Epoch 28, Train Loss 0.553119, Valid_loss 0.744553
Epoch 29, Train Loss 0.503990, Valid_loss 0.581449
Epoch 30, Train Loss 0.573542, Valid_loss 0.661427
Epoch 31, Train Loss 0.632847, Valid_loss 0.555832
Epoch 32, Train Loss 0.581961, Valid_loss 0.489210
Epoch 33, Train Loss 0.482603, Valid_loss 0.418965
Epoch 34, Train Loss 0.541990, Valid_loss 0.536390
Epoch 35, Train Loss 0.610191, Valid_loss 0.571790
Epoch 36, Train Loss 0.511529, Valid_loss 0.571865
Epoch 37, Train Loss 0.521109, Valid_loss 0.775509
Epoch 38, Train Loss 0.408512, Valid_loss 0.682500
Epoch 39, Train Loss 0.433066, Valid_loss 0.443370
Epoch 40, Train Loss 0.526901, Valid_loss 0.617101
Epoch 41, Train Loss 0.474201, Valid_loss 0.675535
Epoch 42, Train Loss 0.504533, Valid_loss 0.425496
Epoch 43, Train Loss 0.663290, Valid_loss 0.807960
Epoch 44, Train Loss 0.637644, Valid_loss 0.745234
Epoch 45, Train Loss 0.565996, Valid_loss 1.123279
Epoch 46, Train Loss 0.461579, Valid_loss 1.477800
Epoch 47, Train Loss 0.818401, Valid_loss 1.321130
Epoch 48, Train Loss 1.057941, Valid_loss 1.071893
Epoch 49, Train Loss 0.895316, Valid_loss 1.020520
Epoch 50, Train Loss 0.875507, Valid_loss 1.011136
Epoch 51, Train Loss 0.868914, Valid_loss 1.010586
Epoch 52, Train Loss 0.865943, Valid_loss 1.010904
Epoch 53, Train Loss 0.868502, Valid_loss 1.013263
[I 2025-08-31 02:03:29,460] Trial 0 finished with value: 0.41896539536260424 and parameters: {'learning_rate': 0.01, 'epochs': 100, 'heads': 2, 'dropout': 0.3, 'weight_decay': 0.01, 'emb_dim': 8, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.41896539536260424.
👉 train samples(학습 샘플(bag))=141, batch_size=16 -> steps(샘플수/batch크기)=9
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 26.13 MB
Memory Reserved: 36.00 MB
cuda
Epoch 1, Train Loss 0.950696, Valid_loss 0.988359
Epoch 2, Train Loss 0.906694, Valid_loss 0.997358
Epoch 3, Train Loss 0.873340, Valid_loss 0.949763
Epoch 4, Train Loss 0.803718, Valid_loss 0.797194
Epoch 5, Train Loss 0.684913, Valid_loss 0.632157
Epoch 6, Train Loss 0.605107, Valid_loss 0.458581
Epoch 7, Train Loss 0.533045, Valid_loss 0.422090
Epoch 8, Train Loss 0.507613, Valid_loss 0.468166
Epoch 9, Train Loss 0.524723, Valid_loss 0.510814
Epoch 10, Train Loss 0.508891, Valid_loss 0.376883
Epoch 11, Train Loss 0.408742, Valid_loss 0.348220
Epoch 12, Train Loss 0.402322, Valid_loss 0.403520
Epoch 13, Train Loss 0.408196, Valid_loss 0.410104
Epoch 14, Train Loss 0.385090, Valid_loss 0.322616
Epoch 15, Train Loss 0.378435, Valid_loss 0.317979
Epoch 16, Train Loss 0.435453, Valid_loss 0.309908
Epoch 17, Train Loss 0.357239, Valid_loss 0.294413
Epoch 18, Train Loss 0.366575, Valid_loss 0.378037
Epoch 19, Train Loss 0.359780, Valid_loss 0.281437
Epoch 20, Train Loss 0.376125, Valid_loss 0.292588
Epoch 21, Train Loss 0.317380, Valid_loss 0.321870
Epoch 22, Train Loss 0.291453, Valid_loss 0.248518
Epoch 23, Train Loss 0.286884, Valid_loss 0.249081
Epoch 24, Train Loss 0.297967, Valid_loss 0.224647
Epoch 25, Train Loss 0.276046, Valid_loss 0.247627
Epoch 26, Train Loss 0.256794, Valid_loss 0.213626
Epoch 27, Train Loss 0.259585, Valid_loss 0.267385
Epoch 28, Train Loss 0.239407, Valid_loss 0.214533
Epoch 29, Train Loss 0.241238, Valid_loss 0.210838
Epoch 30, Train Loss 0.216191, Valid_loss 0.220130
Epoch 31, Train Loss 0.204081, Valid_loss 0.205608
Epoch 32, Train Loss 0.242789, Valid_loss 0.276930
Epoch 33, Train Loss 0.448205, Valid_loss 0.473318
Epoch 34, Train Loss 0.306621, Valid_loss 0.349034
Epoch 35, Train Loss 0.201307, Valid_loss 0.209909
Epoch 36, Train Loss 0.276425, Valid_loss 0.183291
Epoch 37, Train Loss 0.251901, Valid_loss 0.358059
Epoch 38, Train Loss 0.282913, Valid_loss 0.177305
Epoch 39, Train Loss 0.210129, Valid_loss 0.220512
Epoch 40, Train Loss 0.188674, Valid_loss 0.192947
Epoch 41, Train Loss 0.170330, Valid_loss 0.173258
Epoch 42, Train Loss 0.181310, Valid_loss 0.185300
Epoch 43, Train Loss 0.169285, Valid_loss 0.175309
Epoch 44, Train Loss 0.150942, Valid_loss 0.237706
Epoch 45, Train Loss 0.161829, Valid_loss 0.210862
Epoch 46, Train Loss 0.135699, Valid_loss 0.155851
Epoch 47, Train Loss 0.151359, Valid_loss 0.191401
Epoch 48, Train Loss 0.329120, Valid_loss 0.241060
Epoch 49, Train Loss 0.211426, Valid_loss 0.228103
Epoch 50, Train Loss 0.175631, Valid_loss 0.231034
Epoch 51, Train Loss 0.186464, Valid_loss 0.162894
Epoch 52, Train Loss 0.144830, Valid_loss 0.178201
Epoch 53, Train Loss 0.147603, Valid_loss 0.219417
[I 2025-08-31 02:07:48,333] Trial 1 finished with value: 0.15585063668411403 and parameters: {'learning_rate': 0.001, 'epochs': 100, 'heads': 1, 'dropout': 0.3, 'weight_decay': 0.0001, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 1 with value: 0.15585063668411403.
👉 train samples(학습 샘플(bag))=141, batch_size=16 -> steps(샘플수/batch크기)=9
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 27.97 MB
Memory Reserved: 36.00 MB
cuda
Epoch 1, Train Loss 1.025524, Valid_loss 1.026904
Epoch 2, Train Loss 0.975710, Valid_loss 1.037153
Epoch 3, Train Loss 0.975197, Valid_loss 1.028807
Epoch 4, Train Loss 0.987206, Valid_loss 1.036495
Epoch 5, Train Loss 0.929405, Valid_loss 1.004366
Epoch 6, Train Loss 0.938810, Valid_loss 0.989824
Epoch 7, Train Loss 0.885938, Valid_loss 0.969703
Epoch 8, Train Loss 0.882626, Valid_loss 0.910573
Epoch 9, Train Loss 0.817801, Valid_loss 0.743752
Epoch 10, Train Loss 0.662352, Valid_loss 0.655815
Epoch 11, Train Loss 0.659754, Valid_loss 0.761244
Epoch 12, Train Loss 0.718338, Valid_loss 0.488100
Epoch 13, Train Loss 0.618753, Valid_loss 0.496311
Epoch 14, Train Loss 0.478618, Valid_loss 0.487028
Epoch 15, Train Loss 0.439721, Valid_loss 0.567264
Epoch 16, Train Loss 0.558801, Valid_loss 0.363855
Epoch 17, Train Loss 0.541750, Valid_loss 0.378567
Epoch 18, Train Loss 0.582936, Valid_loss 0.432242
Epoch 19, Train Loss 0.449660, Valid_loss 0.385238
Epoch 20, Train Loss 0.460660, Valid_loss 0.508540
Epoch 21, Train Loss 0.431982, Valid_loss 0.366439
Epoch 22, Train Loss 0.389568, Valid_loss 0.315822
Epoch 23, Train Loss 0.482069, Valid_loss 0.439780
Epoch 24, Train Loss 0.486608, Valid_loss 0.324478
Epoch 25, Train Loss 0.374768, Valid_loss 0.352446
Epoch 26, Train Loss 0.345497, Valid_loss 0.308670
Epoch 27, Train Loss 0.374127, Valid_loss 0.295184
Epoch 28, Train Loss 0.335767, Valid_loss 0.542082
Epoch 29, Train Loss 0.337637, Valid_loss 0.329840
Epoch 30, Train Loss 0.358681, Valid_loss 0.285483
Epoch 31, Train Loss 0.521205, Valid_loss 0.564648
Epoch 32, Train Loss 0.303450, Valid_loss 0.330906
Epoch 33, Train Loss 0.280155, Valid_loss 0.270360
Epoch 34, Train Loss 0.274443, Valid_loss 0.853353
Epoch 35, Train Loss 0.556881, Valid_loss 0.363012
Epoch 36, Train Loss 0.535066, Valid_loss 0.770234
Epoch 37, Train Loss 0.340314, Valid_loss 0.384509
Epoch 38, Train Loss 0.306290, Valid_loss 0.508518
Epoch 39, Train Loss 0.323238, Valid_loss 0.290729
Epoch 40, Train Loss 0.359065, Valid_loss 0.568061
Epoch 41, Train Loss 0.294197, Valid_loss 0.366182
Epoch 42, Train Loss 0.229148, Valid_loss 0.671520
Epoch 43, Train Loss 0.303889, Valid_loss 0.279495
Epoch 44, Train Loss 0.331976, Valid_loss 0.298275
Epoch 45, Train Loss 0.320807, Valid_loss 0.466624
Epoch 46, Train Loss 0.252276, Valid_loss 0.219393
Epoch 47, Train Loss 0.263256, Valid_loss 0.713499
Epoch 48, Train Loss 0.232416, Valid_loss 0.395728
Epoch 49, Train Loss 0.211664, Valid_loss 0.268339
Epoch 50, Train Loss 0.197734, Valid_loss 0.587318
Epoch 51, Train Loss 0.190984, Valid_loss 0.357329
Epoch 52, Train Loss 0.177730, Valid_loss 0.607114
Epoch 53, Train Loss 0.178245, Valid_loss 0.281366
Epoch 54, Train Loss 0.178517, Valid_loss 0.598621
Epoch 55, Train Loss 0.181929, Valid_loss 0.264205
Epoch 56, Train Loss 0.151690, Valid_loss 0.503939
Epoch 57, Train Loss 0.154982, Valid_loss 0.464596
Epoch 58, Train Loss 0.165581, Valid_loss 0.535141
Epoch 59, Train Loss 0.167930, Valid_loss 0.541829
[I 2025-08-31 02:13:16,397] Trial 2 finished with value: 0.2193933971714051 and parameters: {'learning_rate': 0.001, 'epochs': 100, 'heads': 2, 'dropout': 0.7, 'weight_decay': 0.0001, 'emb_dim': 64, 'augment_num': 100, 'pca': False}. Best is trial 1 with value: 0.15585063668411403.
선택된 trial params: {'learning_rate': 0.001, 'epochs': 100, 'heads': 1, 'dropout': 0.3, 'weight_decay': 0.0001, 'emb_dim': 32, 'augment_num': 100, 'pca': False}
👉 train samples(학습 샘플(bag))=141, batch_size=16 -> steps(샘플수/batch크기)=9
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=15, batch_size=1 -> steps=15
Memory Allocated: 26.13 MB
Memory Reserved: 36.00 MB
cuda
Epoch 1, Train Loss 1.054085, Valid_loss 1.024657
Epoch 2, Train Loss 0.920243, Valid_loss 1.018399
Epoch 3, Train Loss 0.938688, Valid_loss 1.000556
Epoch 4, Train Loss 0.903035, Valid_loss 0.972495
Epoch 5, Train Loss 0.847318, Valid_loss 0.907818
Epoch 6, Train Loss 0.763547, Valid_loss 0.706687
Epoch 7, Train Loss 0.681980, Valid_loss 0.606223
Epoch 8, Train Loss 0.653331, Valid_loss 0.499009
Epoch 9, Train Loss 0.574310, Valid_loss 0.488394
Epoch 10, Train Loss 0.502290, Valid_loss 0.455263
Epoch 11, Train Loss 0.496082, Valid_loss 0.503249
Epoch 12, Train Loss 0.491391, Valid_loss 0.459289
Epoch 13, Train Loss 0.425554, Valid_loss 0.358250
Epoch 14, Train Loss 0.406874, Valid_loss 0.385321
Epoch 15, Train Loss 0.389399, Valid_loss 0.393583
Epoch 16, Train Loss 0.414726, Valid_loss 0.523489
Epoch 17, Train Loss 0.433625, Valid_loss 0.331924
Epoch 18, Train Loss 0.365734, Valid_loss 0.305665
Epoch 19, Train Loss 0.366922, Valid_loss 0.292787
Epoch 20, Train Loss 0.296986, Valid_loss 0.481385
Epoch 21, Train Loss 0.454034, Valid_loss 0.296842
Epoch 22, Train Loss 0.320339, Valid_loss 0.289967
Epoch 23, Train Loss 0.291290, Valid_loss 0.284991
Epoch 24, Train Loss 0.279223, Valid_loss 0.421062
Epoch 25, Train Loss 0.378818, Valid_loss 0.238303
Epoch 26, Train Loss 0.369824, Valid_loss 0.244263
Epoch 27, Train Loss 0.342959, Valid_loss 0.242839
Epoch 28, Train Loss 0.262437, Valid_loss 0.222676
Epoch 29, Train Loss 0.239591, Valid_loss 0.237215
Epoch 30, Train Loss 0.199054, Valid_loss 0.208066
Epoch 31, Train Loss 0.213349, Valid_loss 0.220395
Epoch 32, Train Loss 0.216464, Valid_loss 0.198122
Epoch 33, Train Loss 0.222353, Valid_loss 0.204656
Epoch 34, Train Loss 0.210696, Valid_loss 0.181216
Epoch 35, Train Loss 0.208410, Valid_loss 0.196815
Epoch 36, Train Loss 0.148330, Valid_loss 0.183247
Epoch 37, Train Loss 0.217656, Valid_loss 0.204027
Epoch 38, Train Loss 0.215759, Valid_loss 0.164304
Epoch 39, Train Loss 0.242449, Valid_loss 0.168095
Epoch 40, Train Loss 0.210626, Valid_loss 0.352471
Epoch 41, Train Loss 0.182984, Valid_loss 0.232112
Epoch 42, Train Loss 0.158408, Valid_loss 0.141213
Epoch 43, Train Loss 0.141677, Valid_loss 0.226746
Epoch 44, Train Loss 0.128377, Valid_loss 0.137522
Epoch 45, Train Loss 0.135607, Valid_loss 0.128332
Epoch 46, Train Loss 0.201828, Valid_loss 0.119873
Epoch 47, Train Loss 0.575250, Valid_loss 0.633544
Epoch 48, Train Loss 0.507160, Valid_loss 0.441494
Epoch 49, Train Loss 0.344361, Valid_loss 0.186862
Epoch 50, Train Loss 0.343190, Valid_loss 0.162834
Epoch 51, Train Loss 0.207796, Valid_loss 0.237418
Epoch 52, Train Loss 0.169623, Valid_loss 0.209287
Epoch 53, Train Loss 0.139417, Valid_loss 0.181988
Epoch 54, Train Loss 0.159673, Valid_loss 0.219415
Epoch 55, Train Loss 0.135874, Valid_loss 0.217083
Epoch 56, Train Loss 0.130293, Valid_loss 0.168241
Epoch 57, Train Loss 0.121158, Valid_loss 0.239923
Epoch 58, Train Loss 0.121407, Valid_loss 0.153116
Epoch 59, Train Loss 0.106795, Valid_loss 0.152792
Epoch 60, Train Loss 0.126401, Valid_loss 0.228307
Epoch 61, Train Loss 0.110182, Valid_loss 0.167831
Epoch 62, Train Loss 0.100439, Valid_loss 0.245055
Epoch 63, Train Loss 0.105408, Valid_loss 0.181970
Epoch 64, Train Loss 0.101954, Valid_loss 0.150382
Epoch 65, Train Loss 0.119683, Valid_loss 0.175471
Epoch 66, Train Loss 0.098661, Valid_loss 0.245193
환자ID=163-2 -- true: [[0]] -- pred: tensor([[-1.5226,  1.6941, -0.4874]], device='cuda:0')
환자ID=164-3 -- true: [[0]] -- pred: tensor([[ 3.5093, -1.9713, -2.7186]], device='cuda:0')
환자ID=27-10039 -- true: [[1]] -- pred: tensor([[-1.8770,  2.5267, -0.5242]], device='cuda:0')
환자ID=28-12263 -- true: [[1]] -- pred: tensor([[-1.2003,  2.9578, -1.7215]], device='cuda:0')
환자ID=29-10006 -- true: [[1]] -- pred: tensor([[-1.6637,  2.7930, -0.9547]], device='cuda:0')
환자ID=29-10013 -- true: [[1]] -- pred: tensor([[-0.7892,  2.7637, -2.0435]], device='cuda:0')
환자ID=29-10404 -- true: [[1]] -- pred: tensor([[-1.8109,  2.6410, -0.7074]], device='cuda:0')
환자ID=29-10410 -- true: [[1]] -- pred: tensor([[-1.7567,  2.6792, -0.8151]], device='cuda:0')
환자ID=30-10123 -- true: [[2]] -- pred: tensor([[-2.3443,  1.4485,  0.7071]], device='cuda:0')
환자ID=31-10013 -- true: [[1]] -- pred: tensor([[-1.4004,  3.0427, -1.5188]], device='cuda:0')
환자ID=33-10005 -- true: [[2]] -- pred: tensor([[-1.5634,  2.9580, -1.1896]], device='cuda:0')
환자ID=34-10187 -- true: [[2]] -- pred: tensor([[-1.8051,  2.6258, -0.6907]], device='cuda:0')
환자ID=PRE027 -- true: [[0]] -- pred: tensor([[ 3.5317, -1.9983, -2.6541]], device='cuda:0')
환자ID=PRE038 -- true: [[0]] -- pred: tensor([[ 3.4963, -1.9023, -2.8206]], device='cuda:0')
환자ID=PRE98sc -- true: [[0]] -- pred: tensor([[ 3.5377, -1.9914, -2.6608]], device='cuda:0')
Best performance: Epoch 46, Loss 0.201828, Test ACC 0.733333, Test AUC 0.890476, Test Recall 0.600000, Test Precision 0.545455
Confusion Matrix:
 [[4 1 0]
 [0 7 0]
 [0 3 0]]
✅ Total valid splits used: 4
🔁 Repeat 0, Fold 4
cell type :  S2008000605HRT_AAACCCAGTGCACATT-1     Epithelial_cells
S2008000605HRT_AAACCCAGTGCCTACG-1     Epithelial_cells
S2008000605HRT_AAAGAACGTAGAGACC-1            Astrocyte
S2008000605HRT_AAAGAACGTCGGAACA-1     Epithelial_cells
S2008000605HRT_AAAGAACGTTAACAGA-1     Epithelial_cells
                                           ...        
Sample1162EO2_TTTGGAGAGCAGGCAT-1      Epithelial_cells
Sample1162EO2_TTTGGAGAGTCGCGAA-1     Endothelial_cells
Sample1162EO2_TTTGGAGAGTGCTCGC-1           Hepatocytes
Sample1162EO2_TTTGGAGGTGATACTC-1      Epithelial_cells
Sample1162EO2_TTTGGTTCAGTAGAAT-1      Epithelial_cells
Name: singler_annotation, Length: 182321, dtype: string
cell type annotation :  S2008000605HRT_AAACCCAGTGCACATT-1     Epithelial_cells
S2008000605HRT_AAACCCAGTGCCTACG-1     Epithelial_cells
S2008000605HRT_AAAGAACGTAGAGACC-1            Astrocyte
S2008000605HRT_AAAGAACGTCGGAACA-1     Epithelial_cells
S2008000605HRT_AAAGAACGTTAACAGA-1     Epithelial_cells
                                           ...        
Sample1162EO2_TTTGGAGAGCAGGCAT-1      Epithelial_cells
Sample1162EO2_TTTGGAGAGTCGCGAA-1     Endothelial_cells
Sample1162EO2_TTTGGAGAGTGCTCGC-1           Hepatocytes
Sample1162EO2_TTTGGAGGTGATACTC-1      Epithelial_cells
Sample1162EO2_TTTGGTTCAGTAGAAT-1      Epithelial_cells
Name: singler_annotation, Length: 182321, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Epithelial_cells', 'Astrocyte', 'MSC', 'Keratinocytes', 'Neurons', 'Endothelial_cells', 'Fibroblasts', 'Tissue_stem_cells', 'Smooth_muscle_cells', 'T_cells', 'Neuroepithelial_cell', 'NK_cell', 'Chondrocytes', 'Osteoblasts', 'Monocyte', 'Hepatocytes', 'Macrophage', 'CMP', 'Embryonic_stem_cells', 'DC', 'BM & Prog.', 'MEP', 'Neutrophils', 'Pro-Myelocyte', 'iPS_cells', 'Pre-B_cell_CD34-', 'HSC_-G-CSF', 'B_cell', 'GMP', 'HSC_CD34+', 'Platelets', 'Pro-B_cell_CD34+', 'Myelocyte', 'BM', 'Erythroblast', 'Unknown', 'Gametocytes']
라벨별 그룹 개수 {0: 21, 1: 30, 2: 11}
cell type :  S2108005518HRT_AAACCCAAGCAAGTCG-1     Epithelial_cells
S2108005518HRT_AAACCCAGTAGCCAGA-1     Epithelial_cells
S2108005518HRT_AAACCCAGTCAAGCGA-1    Endothelial_cells
S2108005518HRT_AAACCCAGTTCCGCGA-1              T_cells
S2108005518HRT_AAACCCATCGCTATTT-1          Hepatocytes
                                           ...        
Sample1158EO3_TTTGACTGTACTGAGG-1     Endothelial_cells
Sample1158EO3_TTTGACTTCGTGGACC-1               Neurons
Sample1158EO3_TTTGATCGTGTCCCTT-1      Epithelial_cells
Sample1158EO3_TTTGGAGTCATGTCTT-1      Epithelial_cells
Sample1158EO3_TTTGGTTTCGCGTGAC-1           Hepatocytes
Name: singler_annotation, Length: 42856, dtype: string
cell type annotation :  S2108005518HRT_AAACCCAAGCAAGTCG-1     Epithelial_cells
S2108005518HRT_AAACCCAGTAGCCAGA-1     Epithelial_cells
S2108005518HRT_AAACCCAGTCAAGCGA-1    Endothelial_cells
S2108005518HRT_AAACCCAGTTCCGCGA-1              T_cells
S2108005518HRT_AAACCCATCGCTATTT-1          Hepatocytes
                                           ...        
Sample1158EO3_TTTGACTGTACTGAGG-1     Endothelial_cells
Sample1158EO3_TTTGACTTCGTGGACC-1               Neurons
Sample1158EO3_TTTGATCGTGTCCCTT-1      Epithelial_cells
Sample1158EO3_TTTGGAGTCATGTCTT-1      Epithelial_cells
Sample1158EO3_TTTGGTTTCGCGTGAC-1           Hepatocytes
Name: singler_annotation, Length: 42856, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Epithelial_cells', 'Endothelial_cells', 'T_cells', 'Hepatocytes', 'Astrocyte', 'Smooth_muscle_cells', 'GMP', 'Neuroepithelial_cell', 'Tissue_stem_cells', 'Embryonic_stem_cells', 'Fibroblasts', 'iPS_cells', 'Neurons', 'NK_cell', 'CMP', 'Macrophage', 'Chondrocytes', 'Keratinocytes', 'Osteoblasts', 'DC', 'MEP', 'Gametocytes', 'Platelets', 'HSC_CD34+', 'HSC_-G-CSF', 'Monocyte', 'MSC', 'BM & Prog.', 'Neutrophils', 'BM', 'Erythroblast', 'B_cell', 'Pre-B_cell_CD34-', 'Unknown', 'Pro-Myelocyte', 'Myelocyte', 'Pro-B_cell_CD34+']
라벨별 그룹 개수 {0: 5, 1: 7, 2: 3}
🔍 Split #5
  → train_p_index 환자 수 (환자 단위로 묶인 index list): 62
  → test_p_index 환자 수  (환자 단위로 묶인 index list): 15
  → train 환자 ID: ['163-2', '163-3', '163-4', '163-5', '164-10', '164-3', '164-6', '27-10039', '27-10041', '27-10071', '27-10112', '27-10119', '28-10051', '28-11515', '28-12263', '28-12381', '28-12490', '28-12518', '29-10006', '29-10008', '29-10011', '29-10012', '29-10013', '29-10016', '29-10280', '29-10380', '29-10386', '29-10400', '29-10404', '29-10406', '29-10410', '30-10018', '30-10034', '30-10123', '30-10125', '30-10929', '30-11051', '31-10000', '31-10001', '31-10013', '31-10042', '31-10154', '31-10236', '32-10003', '33-10005', '33-10006', '34-10184', '34-10187', 'PRE018-1', 'PRE019', 'PRE027', 'PRE038', 'PRE98sc', 'Sample1153-EO1', 'Sample1153-EO2', 'Sample1153-EO3', 'Sample1157-EO1', 'Sample1157-EO2', 'Sample1158-EO1', 'Sample1158-EO2', 'Sample1162-EO1', 'Sample1162-EO2']
  → test  환자 ID: ['165-9', '27-10053', '29-10010', '29-10398', '31-10035', '31-10040', '31-10078', '31-10210', '32-10034', '32-10074', '34-10050', 'PRE055-1', 'PRE062-1', 'Sample1157-EO3', 'Sample1158-EO3']
  → train 환자 ID 및 라벨:
    ID: 163-2, Label: 0
    ID: 163-3, Label: 0
    ID: 163-4, Label: 0
    ID: 163-5, Label: 0
    ID: 164-10, Label: 0
    ID: 164-3, Label: 0
    ID: 164-6, Label: 0
    ID: 27-10039, Label: 1
    ID: 27-10041, Label: 1
    ID: 27-10071, Label: 1
    ID: 27-10112, Label: 1
    ID: 27-10119, Label: 1
    ID: 28-10051, Label: 1
    ID: 28-11515, Label: 1
    ID: 28-12263, Label: 1
    ID: 28-12381, Label: 1
    ID: 28-12490, Label: 1
    ID: 28-12518, Label: 1
    ID: 29-10006, Label: 1
    ID: 29-10008, Label: 1
    ID: 29-10011, Label: 1
    ID: 29-10012, Label: 1
    ID: 29-10013, Label: 1
    ID: 29-10016, Label: 1
    ID: 29-10280, Label: 1
    ID: 29-10380, Label: 1
    ID: 29-10386, Label: 1
    ID: 29-10400, Label: 1
    ID: 29-10404, Label: 1
    ID: 29-10406, Label: 1
    ID: 29-10410, Label: 1
    ID: 30-10018, Label: 2
    ID: 30-10034, Label: 2
    ID: 30-10123, Label: 2
    ID: 30-10125, Label: 2
    ID: 30-10929, Label: 2
    ID: 30-11051, Label: 2
    ID: 31-10000, Label: 1
    ID: 31-10001, Label: 1
    ID: 31-10013, Label: 1
    ID: 31-10042, Label: 1
    ID: 31-10154, Label: 1
    ID: 31-10236, Label: 1
    ID: 32-10003, Label: 2
    ID: 33-10005, Label: 2
    ID: 33-10006, Label: 2
    ID: 34-10184, Label: 2
    ID: 34-10187, Label: 2
    ID: PRE018-1, Label: 0
    ID: PRE019, Label: 0
    ID: PRE027, Label: 0
    ID: PRE038, Label: 0
    ID: PRE98sc, Label: 0
    ID: Sample1153-EO1, Label: 0
    ID: Sample1153-EO2, Label: 0
    ID: Sample1153-EO3, Label: 0
    ID: Sample1157-EO1, Label: 0
    ID: Sample1157-EO2, Label: 0
    ID: Sample1158-EO1, Label: 0
    ID: Sample1158-EO2, Label: 0
    ID: Sample1162-EO1, Label: 0
    ID: Sample1162-EO2, Label: 0
  → test 환자 ID 및 라벨:
    ID: 165-9, Label: 0
    ID: 27-10053, Label: 1
    ID: 29-10010, Label: 1
    ID: 29-10398, Label: 1
    ID: 31-10035, Label: 1
    ID: 31-10040, Label: 1
    ID: 31-10078, Label: 1
    ID: 31-10210, Label: 1
    ID: 32-10034, Label: 2
    ID: 32-10074, Label: 2
    ID: 34-10050, Label: 2
    ID: PRE055-1, Label: 0
    ID: PRE062-1, Label: 0
    ID: Sample1157-EO3, Label: 0
    ID: Sample1158-EO3, Label: 0
전체 데이터 index 길이 77
label_stat (train 환자 라벨 목록) 갯수 62
train_data에서 환자 단위로, train과 validation 나누기
기존 train_p_index 62
기존 (train) label_stat 62
train-vali 분할 후! 
train y 의 classes : {0, 1, 2} valid y 의 classes : {0, 1, 2} label_stat 의 classes : {0, 1, 2}
train_p_index_ 41
valid_p_index 21
test_p_index 15
→ train 환자 ID 및 라벨:
   총 개수: 41
   환자ID=29-10012, Label=1, 셀개수=6245
   환자ID=31-10001, Label=1, 셀개수=1133
   환자ID=34-10184, Label=2, 셀개수=2699
   환자ID=31-10154, Label=1, 셀개수=6568
   환자ID=Sample1158-EO1, Label=0, 셀개수=574
   환자ID=163-5, Label=0, 셀개수=1210
   환자ID=28-12518, Label=1, 셀개수=1215
   환자ID=PRE027, Label=0, 셀개수=2078
   환자ID=30-10123, Label=2, 셀개수=1273
   환자ID=30-10018, Label=2, 셀개수=5170
   환자ID=163-3, Label=0, 셀개수=1335
   환자ID=27-10119, Label=1, 셀개수=3346
   환자ID=164-6, Label=0, 셀개수=3038
   환자ID=27-10039, Label=1, 셀개수=4638
   환자ID=163-2, Label=0, 셀개수=2535
   환자ID=29-10404, Label=1, 셀개수=3988
   환자ID=30-10929, Label=2, 셀개수=5812
   환자ID=29-10410, Label=1, 셀개수=2834
   환자ID=Sample1158-EO2, Label=0, 셀개수=1427
   환자ID=29-10016, Label=1, 셀개수=4854
   환자ID=30-10125, Label=2, 셀개수=3798
   환자ID=163-4, Label=0, 셀개수=1339
   환자ID=31-10042, Label=1, 셀개수=1222
   환자ID=PRE98sc, Label=0, 셀개수=1568
   환자ID=29-10386, Label=1, 셀개수=802
   환자ID=28-11515, Label=1, 셀개수=930
   환자ID=Sample1162-EO1, Label=0, 셀개수=1053
   환자ID=30-11051, Label=2, 셀개수=2454
   환자ID=34-10187, Label=2, 셀개수=3739
   환자ID=27-10112, Label=1, 셀개수=1470
   환자ID=28-12490, Label=1, 셀개수=5973
   환자ID=28-10051, Label=1, 셀개수=300
   환자ID=164-3, Label=0, 셀개수=1639
   환자ID=29-10380, Label=1, 셀개수=4799
   환자ID=33-10006, Label=2, 셀개수=457
   환자ID=29-10013, Label=1, 셀개수=3706
   환자ID=32-10003, Label=2, 셀개수=2978
   환자ID=31-10236, Label=1, 셀개수=3458
   환자ID=31-10013, Label=1, 셀개수=3161
   환자ID=29-10011, Label=1, 셀개수=3072
   환자ID=28-12381, Label=1, 셀개수=1099
→ valid 환자 ID 및 라벨:
   총 개수: 21
   환자ID=Sample1162-EO2, Label=0, 셀개수=1510
   환자ID=29-10008, Label=1, 셀개수=1913
   환자ID=31-10000, Label=1, 셀개수=8870
   환자ID=Sample1153-EO1, Label=0, 셀개수=911
   환자ID=33-10005, Label=2, 셀개수=8904
   환자ID=PRE038, Label=0, 셀개수=2666
   환자ID=Sample1157-EO1, Label=0, 셀개수=1152
   환자ID=29-10406, Label=1, 셀개수=3484
   환자ID=30-10034, Label=2, 셀개수=1240
   환자ID=29-10400, Label=1, 셀개수=2684
   환자ID=Sample1157-EO2, Label=0, 셀개수=1395
   환자ID=27-10071, Label=1, 셀개수=1478
   환자ID=29-10280, Label=1, 셀개수=2375
   환자ID=Sample1153-EO2, Label=0, 셀개수=916
   환자ID=PRE019, Label=0, 셀개수=3795
   환자ID=PRE018-1, Label=0, 셀개수=1349
   환자ID=164-10, Label=0, 셀개수=4041
   환자ID=29-10006, Label=1, 셀개수=11461
   환자ID=27-10041, Label=1, 셀개수=2145
   환자ID=28-12263, Label=1, 셀개수=7527
   환자ID=Sample1153-EO3, Label=0, 셀개수=1516
→ test 환자 ID 및 라벨:
   총 개수: 15
   환자ID=165-9, Label=0, 셀개수=2926
   환자ID=27-10053, Label=1, 셀개수=728
   환자ID=29-10010, Label=1, 셀개수=5305
   환자ID=29-10398, Label=1, 셀개수=3993
   환자ID=31-10035, Label=1, 셀개수=2974
   환자ID=31-10040, Label=1, 셀개수=4543
   환자ID=31-10078, Label=1, 셀개수=2827
   환자ID=31-10210, Label=1, 셀개수=3510
   환자ID=32-10034, Label=2, 셀개수=1555
   환자ID=32-10074, Label=2, 셀개수=6304
   환자ID=34-10050, Label=2, 셀개수=4784
   환자ID=PRE055-1, Label=0, 셀개수=597
   환자ID=PRE062-1, Label=0, 셀개수=907
   환자ID=Sample1157-EO3, Label=0, 셀개수=807
   환자ID=Sample1158-EO3, Label=0, 셀개수=1096
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Epithelial_cells', 'Epithelial_cells', 'Astrocyte', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'MSC', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
전체 데이터 길이 225177
전체 cell type 길이 0          Epithelial_cells
1          Epithelial_cells
2                 Astrocyte
3          Epithelial_cells
4          Epithelial_cells
                ...        
225172    Endothelial_cells
225173              Neurons
225174     Epithelial_cells
225175     Epithelial_cells
225176          Hepatocytes
Length: 225177, dtype: string
cell type의 NaN 개수 체크 0
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:11,  8.65it/s]  2%|▏         | 2/100 [00:00<00:10,  9.29it/s]  3%|▎         | 3/100 [00:00<00:10,  9.41it/s]  4%|▍         | 4/100 [00:00<00:10,  9.24it/s]  5%|▌         | 5/100 [00:00<00:10,  9.21it/s]  6%|▌         | 6/100 [00:00<00:10,  9.09it/s]  7%|▋         | 7/100 [00:00<00:10,  8.81it/s]  8%|▊         | 8/100 [00:00<00:10,  8.69it/s]  9%|▉         | 9/100 [00:01<00:10,  8.82it/s] 10%|█         | 10/100 [00:01<00:10,  8.84it/s] 11%|█         | 11/100 [00:01<00:10,  8.75it/s] 12%|█▏        | 12/100 [00:01<00:10,  8.73it/s] 13%|█▎        | 13/100 [00:01<00:09,  8.87it/s] 14%|█▍        | 14/100 [00:01<00:09,  8.76it/s] 15%|█▌        | 15/100 [00:01<00:09,  8.77it/s] 16%|█▌        | 16/100 [00:01<00:09,  8.79it/s] 17%|█▋        | 17/100 [00:01<00:09,  8.86it/s] 18%|█▊        | 18/100 [00:02<00:10,  7.98it/s] 19%|█▉        | 19/100 [00:02<00:09,  8.10it/s] 20%|██        | 20/100 [00:02<00:09,  8.19it/s] 21%|██        | 21/100 [00:02<00:09,  8.28it/s] 22%|██▏       | 22/100 [00:02<00:11,  7.00it/s] 23%|██▎       | 23/100 [00:02<00:10,  7.38it/s] 24%|██▍       | 24/100 [00:02<00:09,  7.68it/s] 25%|██▌       | 25/100 [00:02<00:09,  8.12it/s] 26%|██▌       | 26/100 [00:03<00:08,  8.23it/s] 27%|██▋       | 27/100 [00:03<00:08,  8.56it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.79it/s] 29%|██▉       | 29/100 [00:03<00:09,  7.55it/s] 30%|███       | 30/100 [00:03<00:08,  7.83it/s] 31%|███       | 31/100 [00:03<00:08,  7.94it/s] 32%|███▏      | 32/100 [00:03<00:08,  8.00it/s] 33%|███▎      | 33/100 [00:03<00:08,  8.18it/s] 34%|███▍      | 34/100 [00:04<00:07,  8.48it/s] 35%|███▌      | 35/100 [00:04<00:07,  8.56it/s] 36%|███▌      | 36/100 [00:04<00:07,  8.69it/s] 37%|███▋      | 37/100 [00:04<00:07,  8.65it/s] 38%|███▊      | 38/100 [00:04<00:07,  8.11it/s] 39%|███▉      | 39/100 [00:04<00:07,  8.18it/s] 40%|████      | 40/100 [00:04<00:07,  8.24it/s] 41%|████      | 41/100 [00:04<00:07,  8.18it/s] 42%|████▏     | 42/100 [00:05<00:06,  8.33it/s] 43%|████▎     | 43/100 [00:05<00:06,  8.38it/s] 44%|████▍     | 44/100 [00:05<00:06,  8.51it/s] 45%|████▌     | 45/100 [00:05<00:06,  8.57it/s] 46%|████▌     | 46/100 [00:05<00:06,  8.45it/s] 47%|████▋     | 47/100 [00:05<00:06,  8.22it/s] 48%|████▊     | 48/100 [00:05<00:06,  8.20it/s] 49%|████▉     | 49/100 [00:05<00:06,  8.18it/s] 50%|█████     | 50/100 [00:05<00:06,  8.18it/s] 51%|█████     | 51/100 [00:06<00:06,  8.02it/s] 52%|█████▏    | 52/100 [00:06<00:06,  7.83it/s] 53%|█████▎    | 53/100 [00:06<00:05,  8.08it/s] 54%|█████▍    | 54/100 [00:06<00:05,  8.18it/s] 55%|█████▌    | 55/100 [00:06<00:05,  8.20it/s] 56%|█████▌    | 56/100 [00:06<00:05,  8.15it/s] 57%|█████▋    | 57/100 [00:06<00:05,  7.52it/s] 58%|█████▊    | 58/100 [00:07<00:05,  7.51it/s] 59%|█████▉    | 59/100 [00:07<00:05,  7.73it/s] 60%|██████    | 60/100 [00:07<00:05,  7.88it/s] 61%|██████    | 61/100 [00:07<00:04,  7.93it/s] 62%|██████▏   | 62/100 [00:07<00:04,  8.06it/s] 63%|██████▎   | 63/100 [00:07<00:04,  7.95it/s] 64%|██████▍   | 64/100 [00:07<00:04,  7.94it/s] 65%|██████▌   | 65/100 [00:07<00:04,  8.11it/s] 66%|██████▌   | 66/100 [00:07<00:04,  8.42it/s] 67%|██████▋   | 67/100 [00:08<00:03,  8.44it/s] 68%|██████▊   | 68/100 [00:08<00:03,  8.12it/s] 69%|██████▉   | 69/100 [00:08<00:03,  8.05it/s] 70%|███████   | 70/100 [00:08<00:03,  8.04it/s] 71%|███████   | 71/100 [00:08<00:03,  7.74it/s] 72%|███████▏  | 72/100 [00:08<00:03,  7.60it/s] 73%|███████▎  | 73/100 [00:08<00:03,  7.78it/s] 74%|███████▍  | 74/100 [00:09<00:03,  7.92it/s] 75%|███████▌  | 75/100 [00:09<00:03,  7.88it/s] 76%|███████▌  | 76/100 [00:09<00:03,  7.84it/s] 77%|███████▋  | 77/100 [00:09<00:02,  7.99it/s] 78%|███████▊  | 78/100 [00:09<00:02,  8.11it/s] 79%|███████▉  | 79/100 [00:09<00:02,  7.93it/s] 80%|████████  | 80/100 [00:09<00:02,  7.93it/s] 81%|████████  | 81/100 [00:09<00:02,  7.13it/s] 82%|████████▏ | 82/100 [00:10<00:02,  7.13it/s] 83%|████████▎ | 83/100 [00:10<00:02,  7.51it/s] 84%|████████▍ | 84/100 [00:10<00:02,  7.63it/s] 85%|████████▌ | 85/100 [00:10<00:01,  7.50it/s] 86%|████████▌ | 86/100 [00:10<00:01,  7.74it/s] 87%|████████▋ | 87/100 [00:10<00:01,  6.81it/s] 88%|████████▊ | 88/100 [00:10<00:01,  7.17it/s] 89%|████████▉ | 89/100 [00:11<00:01,  7.42it/s] 90%|█████████ | 90/100 [00:11<00:01,  7.42it/s] 91%|█████████ | 91/100 [00:11<00:01,  7.72it/s] 92%|█████████▏| 92/100 [00:11<00:01,  7.76it/s] 93%|█████████▎| 93/100 [00:11<00:00,  7.64it/s] 94%|█████████▍| 94/100 [00:11<00:00,  7.74it/s] 95%|█████████▌| 95/100 [00:11<00:00,  6.45it/s] 96%|█████████▌| 96/100 [00:11<00:00,  6.81it/s] 97%|█████████▋| 97/100 [00:12<00:00,  7.00it/s] 98%|█████████▊| 98/100 [00:12<00:00,  7.16it/s] 99%|█████████▉| 99/100 [00:12<00:00,  7.27it/s]100%|██████████| 100/100 [00:12<00:00,  7.29it/s]100%|██████████| 100/100 [00:12<00:00,  7.98it/s]
[I 2025-08-31 02:18:59,181] A new study created in memory with name: no-name-016db6ef-c591-40e8-9baa-b025f61a926e
👉 train samples(학습 샘플(bag))=141, batch_size=16 -> steps(샘플수/batch크기)=9
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 24.81 MB
Memory Reserved: 36.00 MB
cuda
Epoch 1, Train Loss 1.110714, Valid_loss 1.006261
Epoch 2, Train Loss 0.956611, Valid_loss 0.972608
Epoch 3, Train Loss 0.919518, Valid_loss 0.958887
Epoch 4, Train Loss 0.925264, Valid_loss 0.953252
Epoch 5, Train Loss 0.895919, Valid_loss 0.949894
Epoch 6, Train Loss 0.872386, Valid_loss 0.973451
Epoch 7, Train Loss 0.894603, Valid_loss 0.969020
Epoch 8, Train Loss 0.868174, Valid_loss 0.962637
Epoch 9, Train Loss 0.878485, Valid_loss 0.970009
Epoch 10, Train Loss 0.867158, Valid_loss 0.973632
Epoch 11, Train Loss 0.858635, Valid_loss 0.969305
Epoch 12, Train Loss 0.865191, Valid_loss 0.973277
Epoch 13, Train Loss 0.901031, Valid_loss 0.964391
Epoch 14, Train Loss 0.879701, Valid_loss 0.973446
Epoch 15, Train Loss 0.864375, Valid_loss 0.971408
Epoch 16, Train Loss 0.883606, Valid_loss 0.970993
Epoch 17, Train Loss 0.872050, Valid_loss 0.973675
Epoch 18, Train Loss 0.878696, Valid_loss 0.973487
Epoch 19, Train Loss 0.878041, Valid_loss 0.976492
Epoch 20, Train Loss 0.869961, Valid_loss 0.975950
Epoch 21, Train Loss 0.858916, Valid_loss 0.976583
Epoch 22, Train Loss 0.866704, Valid_loss 0.977344
Epoch 23, Train Loss 0.860050, Valid_loss 0.987301
Epoch 24, Train Loss 0.858254, Valid_loss 0.983269
Epoch 25, Train Loss 0.875804, Valid_loss 0.974108
Epoch 26, Train Loss 0.878790, Valid_loss 0.968751
Epoch 27, Train Loss 0.867384, Valid_loss 0.976563
Epoch 28, Train Loss 0.879306, Valid_loss 0.977750
Epoch 29, Train Loss 0.862756, Valid_loss 0.975831
Epoch 30, Train Loss 0.873225, Valid_loss 0.967769
Epoch 31, Train Loss 0.878034, Valid_loss 0.982056
Epoch 32, Train Loss 0.851149, Valid_loss 0.989818
Epoch 33, Train Loss 0.868847, Valid_loss 0.987416
Epoch 34, Train Loss 0.876690, Valid_loss 0.971182
Epoch 35, Train Loss 0.878888, Valid_loss 0.970141
Epoch 36, Train Loss 0.858233, Valid_loss 0.969001
Epoch 37, Train Loss 0.858658, Valid_loss 0.970373
Epoch 38, Train Loss 0.866546, Valid_loss 0.974550
Epoch 39, Train Loss 0.854521, Valid_loss 0.980964
Epoch 40, Train Loss 0.860807, Valid_loss 0.988587
Epoch 41, Train Loss 0.875994, Valid_loss 0.981377
Epoch 42, Train Loss 0.850499, Valid_loss 0.991417
Epoch 43, Train Loss 0.844587, Valid_loss 0.992397
Epoch 44, Train Loss 0.852058, Valid_loss 1.004766
Epoch 45, Train Loss 0.876376, Valid_loss 0.989608
Epoch 46, Train Loss 0.854736, Valid_loss 0.976280
Epoch 47, Train Loss 0.866755, Valid_loss 0.966874
Epoch 48, Train Loss 0.870891, Valid_loss 0.968882
Epoch 49, Train Loss 0.864945, Valid_loss 0.967417
Epoch 50, Train Loss 0.866713, Valid_loss 0.973556
Epoch 51, Train Loss 0.858553, Valid_loss 0.977132
Epoch 52, Train Loss 0.851660, Valid_loss 0.982366
[I 2025-08-31 02:23:54,190] Trial 0 finished with value: 0.9498940337271917 and parameters: {'learning_rate': 0.01, 'epochs': 100, 'heads': 2, 'dropout': 0.7, 'weight_decay': 0.01, 'emb_dim': 8, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.9498940337271917.
👉 train samples(학습 샘플(bag))=141, batch_size=16 -> steps(샘플수/batch크기)=9
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 24.81 MB
Memory Reserved: 36.00 MB
cuda
Epoch 1, Train Loss 1.193859, Valid_loss 1.235681
Epoch 2, Train Loss 1.164812, Valid_loss 1.208569
Epoch 3, Train Loss 1.142198, Valid_loss 1.157417
Epoch 4, Train Loss 1.109739, Valid_loss 1.123160
Epoch 5, Train Loss 1.078998, Valid_loss 1.094022
Epoch 6, Train Loss 1.059491, Valid_loss 1.078776
Epoch 7, Train Loss 1.040897, Valid_loss 1.039953
Epoch 8, Train Loss 1.013365, Valid_loss 0.985328
Epoch 9, Train Loss 0.944398, Valid_loss 0.967988
Epoch 10, Train Loss 0.884862, Valid_loss 0.882064
Epoch 11, Train Loss 0.856333, Valid_loss 0.846544
Epoch 12, Train Loss 0.824175, Valid_loss 0.810490
Epoch 13, Train Loss 0.819644, Valid_loss 0.842645
Epoch 14, Train Loss 0.814824, Valid_loss 0.786892
Epoch 15, Train Loss 0.784892, Valid_loss 0.794302
Epoch 16, Train Loss 0.774190, Valid_loss 0.795424
Epoch 17, Train Loss 0.762153, Valid_loss 0.789943
Epoch 18, Train Loss 0.753509, Valid_loss 0.771238
Epoch 19, Train Loss 0.748376, Valid_loss 0.789979
Epoch 20, Train Loss 0.734070, Valid_loss 0.756906
Epoch 21, Train Loss 0.733727, Valid_loss 0.758249
Epoch 22, Train Loss 0.723387, Valid_loss 0.768095
Epoch 23, Train Loss 0.710070, Valid_loss 0.761240
Epoch 24, Train Loss 0.702640, Valid_loss 0.740304
Epoch 25, Train Loss 0.700114, Valid_loss 0.746757
Epoch 26, Train Loss 0.693829, Valid_loss 0.750888
Epoch 27, Train Loss 0.683570, Valid_loss 0.741984
Epoch 28, Train Loss 0.680667, Valid_loss 0.727485
Epoch 29, Train Loss 0.678538, Valid_loss 0.725411
Epoch 30, Train Loss 0.670151, Valid_loss 0.722555
Epoch 31, Train Loss 0.664011, Valid_loss 0.707094
Epoch 32, Train Loss 0.661045, Valid_loss 0.732014
Epoch 33, Train Loss 0.654291, Valid_loss 0.726351
Epoch 34, Train Loss 0.645945, Valid_loss 0.708907
Epoch 35, Train Loss 0.648005, Valid_loss 0.701297
Epoch 36, Train Loss 0.645099, Valid_loss 0.714297
Epoch 37, Train Loss 0.636246, Valid_loss 0.698927
Epoch 38, Train Loss 0.641009, Valid_loss 0.720505
Epoch 39, Train Loss 0.633669, Valid_loss 0.695085
Epoch 40, Train Loss 0.634631, Valid_loss 0.711523
Epoch 41, Train Loss 0.622925, Valid_loss 0.698595
Epoch 42, Train Loss 0.615553, Valid_loss 0.702589
Epoch 43, Train Loss 0.607903, Valid_loss 0.690889
Epoch 44, Train Loss 0.607183, Valid_loss 0.704819
Epoch 45, Train Loss 0.603727, Valid_loss 0.683546
Epoch 46, Train Loss 0.599024, Valid_loss 0.691910
Epoch 47, Train Loss 0.593205, Valid_loss 0.700881
Epoch 48, Train Loss 0.595240, Valid_loss 0.685916
Epoch 49, Train Loss 0.595791, Valid_loss 0.691009
Epoch 50, Train Loss 0.591059, Valid_loss 0.699897
Epoch 51, Train Loss 0.588525, Valid_loss 0.667657
Epoch 52, Train Loss 0.583056, Valid_loss 0.677167
Epoch 53, Train Loss 0.583796, Valid_loss 0.692915
[I 2025-08-31 02:28:48,358] Trial 1 finished with value: 0.6676571567853292 and parameters: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 2, 'dropout': 0.0, 'weight_decay': 0.0001, 'emb_dim': 8, 'augment_num': 100, 'pca': False}. Best is trial 1 with value: 0.6676571567853292.
👉 train samples(학습 샘플(bag))=141, batch_size=16 -> steps(샘플수/batch크기)=9
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 26.13 MB
Memory Reserved: 36.00 MB
cuda
Epoch 1, Train Loss 1.053879, Valid_loss 0.959646
Epoch 2, Train Loss 0.991597, Valid_loss 0.958372
Epoch 3, Train Loss 0.930733, Valid_loss 0.997287
Epoch 4, Train Loss 0.923919, Valid_loss 0.960557
Epoch 5, Train Loss 0.921155, Valid_loss 0.947019
Epoch 6, Train Loss 0.914158, Valid_loss 0.975522
Epoch 7, Train Loss 0.909458, Valid_loss 0.960342
Epoch 8, Train Loss 0.889777, Valid_loss 0.984365
Epoch 9, Train Loss 0.918991, Valid_loss 0.967338
Epoch 10, Train Loss 0.898973, Valid_loss 0.966704
Epoch 11, Train Loss 0.885189, Valid_loss 0.976660
Epoch 12, Train Loss 0.891774, Valid_loss 0.990104
Epoch 13, Train Loss 0.894177, Valid_loss 0.974291
Epoch 14, Train Loss 0.904894, Valid_loss 0.968482
Epoch 15, Train Loss 0.891503, Valid_loss 0.968903
Epoch 16, Train Loss 0.871127, Valid_loss 0.987617
Epoch 17, Train Loss 0.864650, Valid_loss 0.982964
Epoch 18, Train Loss 0.860229, Valid_loss 1.000560
Epoch 19, Train Loss 0.885980, Valid_loss 0.991884
Epoch 20, Train Loss 0.845504, Valid_loss 0.984138
Epoch 21, Train Loss 0.861120, Valid_loss 0.983499
Epoch 22, Train Loss 0.857166, Valid_loss 1.003404
Epoch 23, Train Loss 0.876815, Valid_loss 0.987237
Epoch 24, Train Loss 0.849478, Valid_loss 0.976535
Epoch 25, Train Loss 0.856442, Valid_loss 0.976532
Epoch 26, Train Loss 0.873538, Valid_loss 0.982422
Epoch 27, Train Loss 0.863833, Valid_loss 0.995678
Epoch 28, Train Loss 0.845039, Valid_loss 1.002376
Epoch 29, Train Loss 0.869062, Valid_loss 0.975599
Epoch 30, Train Loss 0.883420, Valid_loss 0.995729
Epoch 31, Train Loss 0.867594, Valid_loss 1.001222
Epoch 32, Train Loss 0.870135, Valid_loss 1.005013
Epoch 33, Train Loss 0.878721, Valid_loss 0.981395
Epoch 34, Train Loss 0.859214, Valid_loss 0.994017
Epoch 35, Train Loss 0.832525, Valid_loss 1.019020
Epoch 36, Train Loss 0.878007, Valid_loss 0.991329
Epoch 37, Train Loss 0.860846, Valid_loss 0.983581
Epoch 38, Train Loss 0.840680, Valid_loss 0.999639
Epoch 39, Train Loss 0.877992, Valid_loss 0.998928
Epoch 40, Train Loss 0.857733, Valid_loss 0.987323
Epoch 41, Train Loss 0.866699, Valid_loss 0.998130
Epoch 42, Train Loss 0.839532, Valid_loss 1.004529
Epoch 43, Train Loss 0.853559, Valid_loss 1.022583
Epoch 44, Train Loss 0.845109, Valid_loss 1.021867
Epoch 45, Train Loss 0.876354, Valid_loss 0.999639
Epoch 46, Train Loss 0.850948, Valid_loss 0.968860
Epoch 47, Train Loss 0.892443, Valid_loss 0.958705
Epoch 48, Train Loss 0.862020, Valid_loss 0.992758
Epoch 49, Train Loss 0.866775, Valid_loss 0.990481
Epoch 50, Train Loss 0.870024, Valid_loss 0.993701
Epoch 51, Train Loss 0.855308, Valid_loss 1.000864
Epoch 52, Train Loss 0.859520, Valid_loss 0.995066
Epoch 53, Train Loss 0.854829, Valid_loss 0.987462
Epoch 54, Train Loss 0.853259, Valid_loss 0.997729
Epoch 55, Train Loss 0.856041, Valid_loss 1.007043
[I 2025-08-31 02:33:20,049] Trial 2 finished with value: 0.9470189015070597 and parameters: {'learning_rate': 0.01, 'epochs': 100, 'heads': 1, 'dropout': 0.7, 'weight_decay': 0.01, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 1 with value: 0.6676571567853292.
선택된 trial params: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 2, 'dropout': 0.0, 'weight_decay': 0.0001, 'emb_dim': 8, 'augment_num': 100, 'pca': False}
👉 train samples(학습 샘플(bag))=141, batch_size=16 -> steps(샘플수/batch크기)=9
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=15, batch_size=1 -> steps=15
Memory Allocated: 24.81 MB
Memory Reserved: 36.00 MB
cuda
Epoch 1, Train Loss 0.928205, Valid_loss 0.989579
Epoch 2, Train Loss 0.887536, Valid_loss 0.963750
Epoch 3, Train Loss 0.881726, Valid_loss 0.961001
Epoch 4, Train Loss 0.879006, Valid_loss 0.959412
Epoch 5, Train Loss 0.873430, Valid_loss 0.956412
Epoch 6, Train Loss 0.869505, Valid_loss 0.953442
Epoch 7, Train Loss 0.865745, Valid_loss 0.944566
Epoch 8, Train Loss 0.854876, Valid_loss 0.938761
Epoch 9, Train Loss 0.848029, Valid_loss 0.928678
Epoch 10, Train Loss 0.835181, Valid_loss 0.887035
Epoch 11, Train Loss 0.810337, Valid_loss 0.866561
Epoch 12, Train Loss 0.792362, Valid_loss 0.851057
Epoch 13, Train Loss 0.780997, Valid_loss 0.839458
Epoch 14, Train Loss 0.770441, Valid_loss 0.823181
Epoch 15, Train Loss 0.769406, Valid_loss 0.822787
Epoch 16, Train Loss 0.756858, Valid_loss 0.792319
Epoch 17, Train Loss 0.756942, Valid_loss 0.797091
Epoch 18, Train Loss 0.741642, Valid_loss 0.781094
Epoch 19, Train Loss 0.737046, Valid_loss 0.767385
Epoch 20, Train Loss 0.729386, Valid_loss 0.786327
Epoch 21, Train Loss 0.723627, Valid_loss 0.748891
Epoch 22, Train Loss 0.720001, Valid_loss 0.780180
Epoch 23, Train Loss 0.720741, Valid_loss 0.762317
Epoch 24, Train Loss 0.712040, Valid_loss 0.725225
Epoch 25, Train Loss 0.704830, Valid_loss 0.737922
Epoch 26, Train Loss 0.696936, Valid_loss 0.727287
Epoch 27, Train Loss 0.692683, Valid_loss 0.720786
Epoch 28, Train Loss 0.690520, Valid_loss 0.715639
Epoch 29, Train Loss 0.687565, Valid_loss 0.731929
Epoch 30, Train Loss 0.689844, Valid_loss 0.678665
Epoch 31, Train Loss 0.684236, Valid_loss 0.687911
Epoch 32, Train Loss 0.674916, Valid_loss 0.706618
Epoch 33, Train Loss 0.670538, Valid_loss 0.667501
Epoch 34, Train Loss 0.671098, Valid_loss 0.678878
Epoch 35, Train Loss 0.662951, Valid_loss 0.709420
Epoch 36, Train Loss 0.660420, Valid_loss 0.672617
Epoch 37, Train Loss 0.651352, Valid_loss 0.657013
Epoch 38, Train Loss 0.647124, Valid_loss 0.670398
Epoch 39, Train Loss 0.641725, Valid_loss 0.649679
Epoch 40, Train Loss 0.640780, Valid_loss 0.659322
Epoch 41, Train Loss 0.636343, Valid_loss 0.646191
Epoch 42, Train Loss 0.631113, Valid_loss 0.633133
Epoch 43, Train Loss 0.626364, Valid_loss 0.655574
Epoch 44, Train Loss 0.623544, Valid_loss 0.636654
Epoch 45, Train Loss 0.620234, Valid_loss 0.640075
Epoch 46, Train Loss 0.618305, Valid_loss 0.625915
Epoch 47, Train Loss 0.610980, Valid_loss 0.613631
Epoch 48, Train Loss 0.609935, Valid_loss 0.615918
Epoch 49, Train Loss 0.605015, Valid_loss 0.612318
Epoch 50, Train Loss 0.599318, Valid_loss 0.612044
Epoch 51, Train Loss 0.597282, Valid_loss 0.602187
Epoch 52, Train Loss 0.594791, Valid_loss 0.612358
Epoch 53, Train Loss 0.598173, Valid_loss 0.605061
Epoch 54, Train Loss 0.588941, Valid_loss 0.601039
Epoch 55, Train Loss 0.591031, Valid_loss 0.601525
Epoch 56, Train Loss 0.585756, Valid_loss 0.597698
Epoch 57, Train Loss 0.588418, Valid_loss 0.595180
Epoch 58, Train Loss 0.584333, Valid_loss 0.595255
Epoch 59, Train Loss 0.583386, Valid_loss 0.594673
Epoch 60, Train Loss 0.582250, Valid_loss 0.583188
Epoch 61, Train Loss 0.579725, Valid_loss 0.595736
Epoch 62, Train Loss 0.577048, Valid_loss 0.595898
환자ID=165-9 -- true: [[0]] -- pred: tensor([[ 0.9761,  0.2697, -0.7179]], device='cuda:0')
환자ID=27-10053 -- true: [[1]] -- pred: tensor([[-0.4834,  0.8036, -0.5752]], device='cuda:0')
환자ID=29-10010 -- true: [[1]] -- pred: tensor([[-0.7830,  0.5980,  0.0116]], device='cuda:0')
환자ID=29-10398 -- true: [[1]] -- pred: tensor([[-0.6775,  0.7451, -0.2742]], device='cuda:0')
환자ID=31-10035 -- true: [[1]] -- pred: tensor([[-0.4860,  0.7952, -0.5641]], device='cuda:0')
환자ID=31-10040 -- true: [[1]] -- pred: tensor([[-0.5420,  0.7999, -0.4670]], device='cuda:0')
환자ID=31-10078 -- true: [[1]] -- pred: tensor([[-0.6081,  0.7856, -0.3989]], device='cuda:0')
환자ID=31-10210 -- true: [[1]] -- pred: tensor([[-0.3753,  0.8114, -0.7061]], device='cuda:0')
환자ID=32-10034 -- true: [[2]] -- pred: tensor([[-0.7186,  0.7368, -0.2157]], device='cuda:0')
환자ID=32-10074 -- true: [[2]] -- pred: tensor([[-0.7329,  0.6977, -0.1627]], device='cuda:0')
환자ID=34-10050 -- true: [[2]] -- pred: tensor([[-0.7328,  0.7271, -0.1913]], device='cuda:0')
환자ID=PRE055-1 -- true: [[0]] -- pred: tensor([[ 0.8810,  0.1697, -0.7781]], device='cuda:0')
환자ID=PRE062-1 -- true: [[0]] -- pred: tensor([[ 0.9239,  0.2164, -0.7737]], device='cuda:0')
환자ID=Sample1157-EO3 -- true: [[0]] -- pred: tensor([[ 0.9089,  0.1912, -0.8078]], device='cuda:0')
환자ID=Sample1158-EO3 -- true: [[0]] -- pred: tensor([[ 0.9136,  0.1941, -0.7810]], device='cuda:0')
Best performance: Epoch 60, Loss 0.582250, Test ACC 0.800000, Test AUC 0.952381, Test Recall 0.666667, Test Precision 0.566667
Confusion Matrix:
 [[5 0 0]
 [0 7 0]
 [0 3 0]]
✅ Total valid splits used: 5

📌 Repeat 0: 평균 AUC = 0.9358, 표준편차 = 0.0535
Test ACC 평균 0.816667, Test Recall 평균 0.708889, Test Precision 평균 0.643502
fold_aucs = [0.986111111111111, 0.9930555555555557, 0.8571428571428571, 0.8904761904761905, 0.9523809523809524]
NaN 개수: 0 / 전체 5개

🔁 Repeat 1, Fold 0
cell type :  S2008000605HRT_AAACCCAGTGCACATT-1    Epithelial_cells
S2008000605HRT_AAACCCAGTGCCTACG-1    Epithelial_cells
S2008000605HRT_AAAGAACGTAGAGACC-1           Astrocyte
S2008000605HRT_AAAGAACGTCGGAACA-1    Epithelial_cells
S2008000605HRT_AAAGAACGTTAACAGA-1    Epithelial_cells
                                           ...       
Sample1162EO1_TTTCACAAGGGCAGAG-1            iPS_cells
Sample1162EO1_TTTCCTCAGCGTGCCT-1          Hepatocytes
Sample1162EO1_TTTCCTCAGTACTGTC-1     Epithelial_cells
Sample1162EO1_TTTGGTTTCCACATAG-1          Hepatocytes
Sample1162EO1_TTTGTTGCACACGCCA-1     Epithelial_cells
Name: singler_annotation, Length: 182232, dtype: string
cell type annotation :  S2008000605HRT_AAACCCAGTGCACATT-1    Epithelial_cells
S2008000605HRT_AAACCCAGTGCCTACG-1    Epithelial_cells
S2008000605HRT_AAAGAACGTAGAGACC-1           Astrocyte
S2008000605HRT_AAAGAACGTCGGAACA-1    Epithelial_cells
S2008000605HRT_AAAGAACGTTAACAGA-1    Epithelial_cells
                                           ...       
Sample1162EO1_TTTCACAAGGGCAGAG-1            iPS_cells
Sample1162EO1_TTTCCTCAGCGTGCCT-1          Hepatocytes
Sample1162EO1_TTTCCTCAGTACTGTC-1     Epithelial_cells
Sample1162EO1_TTTGGTTTCCACATAG-1          Hepatocytes
Sample1162EO1_TTTGTTGCACACGCCA-1     Epithelial_cells
Name: singler_annotation, Length: 182232, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Epithelial_cells', 'Astrocyte', 'MSC', 'Keratinocytes', 'Neurons', 'Endothelial_cells', 'Fibroblasts', 'Tissue_stem_cells', 'Smooth_muscle_cells', 'T_cells', 'Neuroepithelial_cell', 'NK_cell', 'Chondrocytes', 'Osteoblasts', 'Monocyte', 'Hepatocytes', 'Macrophage', 'CMP', 'Embryonic_stem_cells', 'DC', 'BM & Prog.', 'MEP', 'Neutrophils', 'Pro-Myelocyte', 'iPS_cells', 'Pre-B_cell_CD34-', 'HSC_-G-CSF', 'B_cell', 'GMP', 'HSC_CD34+', 'Platelets', 'Pro-B_cell_CD34+', 'Myelocyte', 'BM', 'Unknown', 'Erythroblast', 'Gametocytes']
라벨별 그룹 개수 {0: 20, 1: 29, 2: 12}
cell type :  S2008006722HRT_AAACGCTTCGGCTCTT-1       Tissue_stem_cells
S2008006722HRT_AAAGAACGTACTCCCT-1       Endothelial_cells
S2008006722HRT_AAAGAACGTATGTCAC-1               Astrocyte
S2008006722HRT_AAAGGATTCATCGCCT-1    Embryonic_stem_cells
S2008006722HRT_AAAGGGCTCGTCGCTT-1        Epithelial_cells
                                             ...         
Sample1162EO2_TTTGGAGAGCAGGCAT-1         Epithelial_cells
Sample1162EO2_TTTGGAGAGTCGCGAA-1        Endothelial_cells
Sample1162EO2_TTTGGAGAGTGCTCGC-1              Hepatocytes
Sample1162EO2_TTTGGAGGTGATACTC-1         Epithelial_cells
Sample1162EO2_TTTGGTTCAGTAGAAT-1         Epithelial_cells
Name: singler_annotation, Length: 42945, dtype: string
cell type annotation :  S2008006722HRT_AAACGCTTCGGCTCTT-1       Tissue_stem_cells
S2008006722HRT_AAAGAACGTACTCCCT-1       Endothelial_cells
S2008006722HRT_AAAGAACGTATGTCAC-1               Astrocyte
S2008006722HRT_AAAGGATTCATCGCCT-1    Embryonic_stem_cells
S2008006722HRT_AAAGGGCTCGTCGCTT-1        Epithelial_cells
                                             ...         
Sample1162EO2_TTTGGAGAGCAGGCAT-1         Epithelial_cells
Sample1162EO2_TTTGGAGAGTCGCGAA-1        Endothelial_cells
Sample1162EO2_TTTGGAGAGTGCTCGC-1              Hepatocytes
Sample1162EO2_TTTGGAGGTGATACTC-1         Epithelial_cells
Sample1162EO2_TTTGGTTCAGTAGAAT-1         Epithelial_cells
Name: singler_annotation, Length: 42945, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Tissue_stem_cells', 'Endothelial_cells', 'Astrocyte', 'Embryonic_stem_cells', 'Epithelial_cells', 'Hepatocytes', 'Smooth_muscle_cells', 'Neurons', 'Fibroblasts', 'NK_cell', 'Keratinocytes', 'Neuroepithelial_cell', 'MEP', 'Pre-B_cell_CD34-', 'Monocyte', 'Pro-Myelocyte', 'MSC', 'CMP', 'BM & Prog.', 'BM', 'Macrophage', 'Chondrocytes', 'iPS_cells', 'T_cells', 'HSC_-G-CSF', 'Erythroblast', 'Osteoblasts', 'DC', 'GMP', 'Pro-B_cell_CD34+', 'B_cell', 'Gametocytes', 'Unknown', 'Myelocyte', 'Platelets', 'HSC_CD34+', 'Neutrophils']
라벨별 그룹 개수 {0: 6, 1: 8, 2: 2}
🔍 Split #1
  → train_p_index 환자 수 (환자 단위로 묶인 index list): 61
  → test_p_index 환자 수  (환자 단위로 묶인 index list): 16
  → train 환자 ID: ['163-2', '163-3', '163-4', '163-5', '164-10', '164-6', '165-9', '27-10039', '27-10041', '27-10053', '27-10071', '27-10112', '28-12263', '28-12381', '28-12490', '28-12518', '29-10006', '29-10008', '29-10010', '29-10011', '29-10012', '29-10013', '29-10016', '29-10280', '29-10380', '29-10386', '29-10398', '29-10400', '29-10410', '30-10018', '30-10034', '30-10125', '30-10929', '30-11051', '31-10000', '31-10001', '31-10013', '31-10040', '31-10042', '31-10078', '31-10210', '32-10003', '32-10034', '33-10005', '33-10006', '34-10050', '34-10184', '34-10187', 'PRE018-1', 'PRE019', 'PRE055-1', 'PRE062-1', 'PRE98sc', 'Sample1153-EO2', 'Sample1157-EO1', 'Sample1157-EO2', 'Sample1157-EO3', 'Sample1158-EO1', 'Sample1158-EO2', 'Sample1158-EO3', 'Sample1162-EO1']
  → test  환자 ID: ['164-3', '27-10119', '28-10051', '28-11515', '29-10404', '29-10406', '30-10123', '31-10035', '31-10154', '31-10236', '32-10074', 'PRE027', 'PRE038', 'Sample1153-EO1', 'Sample1153-EO3', 'Sample1162-EO2']
  → train 환자 ID 및 라벨:
    ID: 163-2, Label: 0
    ID: 163-3, Label: 0
    ID: 163-4, Label: 0
    ID: 163-5, Label: 0
    ID: 164-10, Label: 0
    ID: 164-6, Label: 0
    ID: 165-9, Label: 0
    ID: 27-10039, Label: 1
    ID: 27-10041, Label: 1
    ID: 27-10053, Label: 1
    ID: 27-10071, Label: 1
    ID: 27-10112, Label: 1
    ID: 28-12263, Label: 1
    ID: 28-12381, Label: 1
    ID: 28-12490, Label: 1
    ID: 28-12518, Label: 1
    ID: 29-10006, Label: 1
    ID: 29-10008, Label: 1
    ID: 29-10010, Label: 1
    ID: 29-10011, Label: 1
    ID: 29-10012, Label: 1
    ID: 29-10013, Label: 1
    ID: 29-10016, Label: 1
    ID: 29-10280, Label: 1
    ID: 29-10380, Label: 1
    ID: 29-10386, Label: 1
    ID: 29-10398, Label: 1
    ID: 29-10400, Label: 1
    ID: 29-10410, Label: 1
    ID: 30-10018, Label: 2
    ID: 30-10034, Label: 2
    ID: 30-10125, Label: 2
    ID: 30-10929, Label: 2
    ID: 30-11051, Label: 2
    ID: 31-10000, Label: 1
    ID: 31-10001, Label: 1
    ID: 31-10013, Label: 1
    ID: 31-10040, Label: 1
    ID: 31-10042, Label: 1
    ID: 31-10078, Label: 1
    ID: 31-10210, Label: 1
    ID: 32-10003, Label: 2
    ID: 32-10034, Label: 2
    ID: 33-10005, Label: 2
    ID: 33-10006, Label: 2
    ID: 34-10050, Label: 2
    ID: 34-10184, Label: 2
    ID: 34-10187, Label: 2
    ID: PRE018-1, Label: 0
    ID: PRE019, Label: 0
    ID: PRE055-1, Label: 0
    ID: PRE062-1, Label: 0
    ID: PRE98sc, Label: 0
    ID: Sample1153-EO2, Label: 0
    ID: Sample1157-EO1, Label: 0
    ID: Sample1157-EO2, Label: 0
    ID: Sample1157-EO3, Label: 0
    ID: Sample1158-EO1, Label: 0
    ID: Sample1158-EO2, Label: 0
    ID: Sample1158-EO3, Label: 0
    ID: Sample1162-EO1, Label: 0
  → test 환자 ID 및 라벨:
    ID: 164-3, Label: 0
    ID: 27-10119, Label: 1
    ID: 28-10051, Label: 1
    ID: 28-11515, Label: 1
    ID: 29-10404, Label: 1
    ID: 29-10406, Label: 1
    ID: 30-10123, Label: 2
    ID: 31-10035, Label: 1
    ID: 31-10154, Label: 1
    ID: 31-10236, Label: 1
    ID: 32-10074, Label: 2
    ID: PRE027, Label: 0
    ID: PRE038, Label: 0
    ID: Sample1153-EO1, Label: 0
    ID: Sample1153-EO3, Label: 0
    ID: Sample1162-EO2, Label: 0
전체 데이터 index 길이 77
label_stat (train 환자 라벨 목록) 갯수 61
train_data에서 환자 단위로, train과 validation 나누기
기존 train_p_index 61
기존 (train) label_stat 61
train-vali 분할 후! 
train y 의 classes : {0, 1, 2} valid y 의 classes : {0, 1, 2} label_stat 의 classes : {0, 1, 2}
train_p_index_ 40
valid_p_index 21
test_p_index 16
→ train 환자 ID 및 라벨:
   총 개수: 40
   환자ID=29-10013, Label=1, 셀개수=3706
   환자ID=31-10042, Label=1, 셀개수=1222
   환자ID=Sample1157-EO1, Label=0, 셀개수=1152
   환자ID=Sample1158-EO1, Label=0, 셀개수=574
   환자ID=32-10003, Label=2, 셀개수=2978
   환자ID=163-5, Label=0, 셀개수=1210
   환자ID=29-10008, Label=1, 셀개수=1913
   환자ID=PRE019, Label=0, 셀개수=3795
   환자ID=30-11051, Label=2, 셀개수=2454
   환자ID=30-10125, Label=2, 셀개수=3798
   환자ID=163-3, Label=0, 셀개수=1335
   환자ID=27-10112, Label=1, 셀개수=1470
   환자ID=165-9, Label=0, 셀개수=2926
   환자ID=27-10039, Label=1, 셀개수=4638
   환자ID=163-2, Label=0, 셀개수=2535
   환자ID=29-10410, Label=1, 셀개수=2834
   환자ID=31-10001, Label=1, 셀개수=1133
   환자ID=30-10034, Label=2, 셀개수=1240
   환자ID=29-10280, Label=1, 셀개수=2375
   환자ID=31-10000, Label=1, 셀개수=8870
   환자ID=163-4, Label=0, 셀개수=1339
   환자ID=31-10210, Label=1, 셀개수=3510
   환자ID=PRE062-1, Label=0, 셀개수=907
   환자ID=29-10398, Label=1, 셀개수=3993
   환자ID=28-12381, Label=1, 셀개수=1099
   환자ID=Sample1158-EO3, Label=0, 셀개수=1096
   환자ID=31-10013, Label=1, 셀개수=3161
   환자ID=34-10187, Label=2, 셀개수=3739
   환자ID=27-10071, Label=1, 셀개수=1478
   환자ID=29-10006, Label=1, 셀개수=11461
   환자ID=28-12263, Label=1, 셀개수=7527
   환자ID=164-6, Label=0, 셀개수=3038
   환자ID=29-10386, Label=1, 셀개수=802
   환자ID=34-10050, Label=2, 셀개수=4784
   환자ID=29-10016, Label=1, 셀개수=4854
   환자ID=33-10005, Label=2, 셀개수=8904
   환자ID=32-10034, Label=2, 셀개수=1555
   환자ID=31-10078, Label=1, 셀개수=2827
   환자ID=29-10012, Label=1, 셀개수=6245
   환자ID=28-12518, Label=1, 셀개수=1215
→ valid 환자 ID 및 라벨:
   총 개수: 21
   환자ID=Sample1162-EO1, Label=0, 셀개수=1053
   환자ID=29-10011, Label=1, 셀개수=3072
   환자ID=31-10040, Label=1, 셀개수=4543
   환자ID=PRE98sc, Label=0, 셀개수=1568
   환자ID=Sample1157-EO3, Label=0, 셀개수=807
   환자ID=PRE055-1, Label=0, 셀개수=597
   환자ID=Sample1157-EO2, Label=0, 셀개수=1395
   환자ID=30-10018, Label=2, 셀개수=5170
   환자ID=30-10929, Label=2, 셀개수=5812
   환자ID=29-10400, Label=1, 셀개수=2684
   환자ID=Sample1158-EO2, Label=0, 셀개수=1427
   환자ID=27-10053, Label=1, 셀개수=728
   환자ID=29-10380, Label=1, 셀개수=4799
   환자ID=Sample1153-EO2, Label=0, 셀개수=916
   환자ID=34-10184, Label=2, 셀개수=2699
   환자ID=PRE018-1, Label=0, 셀개수=1349
   환자ID=164-10, Label=0, 셀개수=4041
   환자ID=29-10010, Label=1, 셀개수=5305
   환자ID=27-10041, Label=1, 셀개수=2145
   환자ID=28-12490, Label=1, 셀개수=5973
   환자ID=33-10006, Label=2, 셀개수=457
→ test 환자 ID 및 라벨:
   총 개수: 16
   환자ID=164-3, Label=0, 셀개수=1639
   환자ID=27-10119, Label=1, 셀개수=3346
   환자ID=28-10051, Label=1, 셀개수=300
   환자ID=28-11515, Label=1, 셀개수=930
   환자ID=29-10404, Label=1, 셀개수=3988
   환자ID=29-10406, Label=1, 셀개수=3484
   환자ID=30-10123, Label=2, 셀개수=1273
   환자ID=31-10035, Label=1, 셀개수=2974
   환자ID=31-10154, Label=1, 셀개수=6568
   환자ID=31-10236, Label=1, 셀개수=3458
   환자ID=32-10074, Label=2, 셀개수=6304
   환자ID=PRE027, Label=0, 셀개수=2078
   환자ID=PRE038, Label=0, 셀개수=2666
   환자ID=Sample1153-EO1, Label=0, 셀개수=911
   환자ID=Sample1153-EO3, Label=0, 셀개수=1516
   환자ID=Sample1162-EO2, Label=0, 셀개수=1510
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Epithelial_cells', 'Epithelial_cells', 'Astrocyte', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'MSC', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
전체 데이터 길이 225177
전체 cell type 길이 0          Epithelial_cells
1          Epithelial_cells
2                 Astrocyte
3          Epithelial_cells
4          Epithelial_cells
                ...        
225172     Epithelial_cells
225173    Endothelial_cells
225174          Hepatocytes
225175     Epithelial_cells
225176     Epithelial_cells
Length: 225177, dtype: string
cell type의 NaN 개수 체크 0
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:12,  7.81it/s]  2%|▏         | 2/100 [00:00<00:11,  8.52it/s]  3%|▎         | 3/100 [00:00<00:12,  8.00it/s]  4%|▍         | 4/100 [00:00<00:11,  8.39it/s]  5%|▌         | 5/100 [00:00<00:10,  8.65it/s]  6%|▌         | 6/100 [00:00<00:10,  8.81it/s]  7%|▋         | 7/100 [00:00<00:10,  8.87it/s]  8%|▊         | 8/100 [00:00<00:10,  9.03it/s]  9%|▉         | 9/100 [00:01<00:10,  8.90it/s] 10%|█         | 10/100 [00:01<00:10,  8.88it/s] 11%|█         | 11/100 [00:01<00:10,  8.85it/s] 12%|█▏        | 12/100 [00:01<00:09,  9.14it/s] 13%|█▎        | 13/100 [00:01<00:09,  9.19it/s] 14%|█▍        | 14/100 [00:01<00:09,  9.18it/s] 15%|█▌        | 15/100 [00:01<00:09,  9.24it/s] 16%|█▌        | 16/100 [00:01<00:09,  9.14it/s] 17%|█▋        | 17/100 [00:01<00:09,  9.11it/s] 18%|█▊        | 18/100 [00:02<00:09,  8.91it/s] 19%|█▉        | 19/100 [00:02<00:09,  8.67it/s] 20%|██        | 20/100 [00:02<00:09,  8.73it/s] 21%|██        | 21/100 [00:02<00:09,  8.71it/s] 22%|██▏       | 22/100 [00:02<00:08,  8.79it/s] 23%|██▎       | 23/100 [00:02<00:08,  8.82it/s] 24%|██▍       | 24/100 [00:02<00:08,  8.99it/s] 25%|██▌       | 25/100 [00:02<00:09,  8.04it/s] 26%|██▌       | 26/100 [00:03<00:12,  6.15it/s] 27%|██▋       | 27/100 [00:03<00:10,  6.73it/s] 28%|██▊       | 28/100 [00:03<00:09,  7.27it/s] 29%|██▉       | 29/100 [00:03<00:09,  7.77it/s] 30%|███       | 30/100 [00:03<00:08,  8.24it/s] 31%|███       | 31/100 [00:03<00:08,  8.21it/s] 32%|███▏      | 32/100 [00:03<00:08,  8.25it/s] 33%|███▎      | 33/100 [00:03<00:08,  8.25it/s] 34%|███▍      | 34/100 [00:04<00:09,  6.93it/s] 35%|███▌      | 35/100 [00:04<00:08,  7.40it/s] 36%|███▌      | 36/100 [00:04<00:08,  7.73it/s] 37%|███▋      | 37/100 [00:04<00:07,  8.03it/s] 38%|███▊      | 38/100 [00:04<00:08,  7.51it/s] 39%|███▉      | 39/100 [00:04<00:07,  7.65it/s] 40%|████      | 40/100 [00:04<00:07,  7.87it/s] 41%|████      | 41/100 [00:04<00:07,  8.19it/s] 42%|████▏     | 42/100 [00:05<00:07,  8.17it/s] 43%|████▎     | 43/100 [00:05<00:07,  7.37it/s] 44%|████▍     | 44/100 [00:05<00:07,  7.35it/s] 45%|████▌     | 45/100 [00:05<00:07,  7.67it/s] 46%|████▌     | 46/100 [00:05<00:06,  7.73it/s] 47%|████▋     | 47/100 [00:05<00:06,  7.93it/s] 48%|████▊     | 48/100 [00:05<00:06,  8.29it/s] 49%|████▉     | 49/100 [00:05<00:06,  8.13it/s] 50%|█████     | 50/100 [00:06<00:06,  8.14it/s] 51%|█████     | 51/100 [00:06<00:06,  8.10it/s] 52%|█████▏    | 52/100 [00:06<00:05,  8.52it/s] 53%|█████▎    | 53/100 [00:06<00:05,  8.52it/s] 54%|█████▍    | 54/100 [00:06<00:05,  8.40it/s] 55%|█████▌    | 55/100 [00:06<00:05,  8.44it/s] 56%|█████▌    | 56/100 [00:06<00:05,  8.31it/s] 57%|█████▋    | 57/100 [00:06<00:05,  8.19it/s] 58%|█████▊    | 58/100 [00:07<00:05,  8.21it/s] 59%|█████▉    | 59/100 [00:07<00:04,  8.30it/s] 60%|██████    | 60/100 [00:07<00:04,  8.33it/s] 61%|██████    | 61/100 [00:07<00:04,  8.40it/s] 62%|██████▏   | 62/100 [00:07<00:04,  8.20it/s] 63%|██████▎   | 63/100 [00:07<00:04,  8.13it/s] 64%|██████▍   | 64/100 [00:07<00:04,  8.20it/s] 65%|██████▌   | 65/100 [00:07<00:04,  7.76it/s] 66%|██████▌   | 66/100 [00:08<00:04,  7.55it/s] 67%|██████▋   | 67/100 [00:08<00:04,  7.62it/s] 68%|██████▊   | 68/100 [00:08<00:04,  7.89it/s] 69%|██████▉   | 69/100 [00:08<00:03,  7.89it/s] 70%|███████   | 70/100 [00:08<00:03,  7.78it/s] 71%|███████   | 71/100 [00:08<00:04,  6.22it/s] 72%|███████▏  | 72/100 [00:08<00:04,  6.74it/s] 73%|███████▎  | 73/100 [00:09<00:03,  7.14it/s] 74%|███████▍  | 74/100 [00:09<00:03,  7.17it/s] 75%|███████▌  | 75/100 [00:09<00:03,  7.33it/s] 76%|███████▌  | 76/100 [00:09<00:03,  6.94it/s] 77%|███████▋  | 77/100 [00:09<00:03,  7.33it/s] 78%|███████▊  | 78/100 [00:09<00:02,  7.65it/s] 79%|███████▉  | 79/100 [00:09<00:02,  7.78it/s] 80%|████████  | 80/100 [00:09<00:02,  7.84it/s] 81%|████████  | 81/100 [00:10<00:02,  8.04it/s] 82%|████████▏ | 82/100 [00:10<00:02,  7.93it/s] 83%|████████▎ | 83/100 [00:10<00:02,  6.20it/s] 84%|████████▍ | 84/100 [00:10<00:02,  6.76it/s] 85%|████████▌ | 85/100 [00:10<00:02,  7.12it/s] 86%|████████▌ | 86/100 [00:10<00:01,  7.38it/s] 87%|████████▋ | 87/100 [00:10<00:01,  7.53it/s] 88%|████████▊ | 88/100 [00:11<00:01,  7.74it/s] 89%|████████▉ | 89/100 [00:11<00:01,  7.46it/s] 90%|█████████ | 90/100 [00:11<00:01,  7.46it/s] 91%|█████████ | 91/100 [00:11<00:01,  7.60it/s] 92%|█████████▏| 92/100 [00:11<00:01,  7.72it/s] 93%|█████████▎| 93/100 [00:11<00:00,  7.82it/s] 94%|█████████▍| 94/100 [00:11<00:00,  7.96it/s] 95%|█████████▌| 95/100 [00:11<00:00,  7.76it/s] 96%|█████████▌| 96/100 [00:12<00:00,  7.64it/s] 97%|█████████▋| 97/100 [00:12<00:00,  7.77it/s] 98%|█████████▊| 98/100 [00:12<00:00,  6.65it/s] 99%|█████████▉| 99/100 [00:12<00:00,  7.03it/s]100%|██████████| 100/100 [00:12<00:00,  7.13it/s]100%|██████████| 100/100 [00:12<00:00,  7.87it/s]
[I 2025-08-31 02:39:25,455] A new study created in memory with name: no-name-b02938d7-14a9-4c53-acab-f8648ee6c187
👉 train samples(학습 샘플(bag))=140, batch_size=16 -> steps(샘플수/batch크기)=9
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 24.81 MB
Memory Reserved: 36.00 MB
cuda
CUDA OOM 발생 — 단계적 백오프 시작.
[OOM RETRY] batch_size 16 → 8 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=140, batch_size=8 -> steps(샘플수/batch크기)=18
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 2125.43 MB
Memory Reserved: 2136.00 MB
cuda
[OOM RETRY] batch_size=8에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 16 → 4 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=140, batch_size=4 -> steps(샘플수/batch크기)=35
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 3175.96 MB
Memory Reserved: 3186.00 MB
cuda
Epoch 1, Train Loss 1.060268, Valid_loss 1.051040
Epoch 2, Train Loss 0.969510, Valid_loss 1.076288
Epoch 3, Train Loss 0.924090, Valid_loss 1.100559
Epoch 4, Train Loss 0.976248, Valid_loss 1.090894
Epoch 5, Train Loss 0.943653, Valid_loss 1.083958
Epoch 6, Train Loss 0.930903, Valid_loss 1.091055
Epoch 7, Train Loss 0.982290, Valid_loss 1.094341
Epoch 8, Train Loss 0.932530, Valid_loss 1.092336
Epoch 9, Train Loss 0.925323, Valid_loss 1.093674
Epoch 10, Train Loss 0.920754, Valid_loss 1.097427
Epoch 11, Train Loss 0.932618, Valid_loss 1.089179
Epoch 12, Train Loss 0.927280, Valid_loss 1.093629
Epoch 13, Train Loss 0.913758, Valid_loss 1.100570
Epoch 14, Train Loss 0.916692, Valid_loss 1.106946
Epoch 15, Train Loss 0.921432, Valid_loss 1.112824
Epoch 16, Train Loss 0.912318, Valid_loss 1.116928
Epoch 17, Train Loss 0.922044, Valid_loss 1.101378
Epoch 18, Train Loss 0.919668, Valid_loss 1.109688
Epoch 19, Train Loss 0.914706, Valid_loss 1.111943
Epoch 20, Train Loss 0.915014, Valid_loss 1.108639
Epoch 21, Train Loss 0.913443, Valid_loss 1.124792
Epoch 22, Train Loss 0.913980, Valid_loss 1.120879
Epoch 23, Train Loss 0.910902, Valid_loss 1.136579
Epoch 24, Train Loss 0.904184, Valid_loss 1.172558
Epoch 25, Train Loss 0.919569, Valid_loss 1.120376
Epoch 26, Train Loss 0.913286, Valid_loss 1.115275
Epoch 27, Train Loss 0.910836, Valid_loss 1.137157
Epoch 28, Train Loss 0.918224, Valid_loss 1.114864
Epoch 29, Train Loss 0.914863, Valid_loss 1.110300
Epoch 30, Train Loss 0.916447, Valid_loss 1.112293
Epoch 31, Train Loss 0.914143, Valid_loss 1.109596
Epoch 32, Train Loss 0.912974, Valid_loss 1.113523
Epoch 33, Train Loss 0.912601, Valid_loss 1.113186
Epoch 34, Train Loss 0.912938, Valid_loss 1.112133
Epoch 35, Train Loss 0.916891, Valid_loss 1.118340
Epoch 36, Train Loss 0.914237, Valid_loss 1.111525
Epoch 37, Train Loss 0.913090, Valid_loss 1.117094
Epoch 38, Train Loss 0.912662, Valid_loss 1.117579
Epoch 39, Train Loss 0.913634, Valid_loss 1.113299
Epoch 40, Train Loss 0.912543, Valid_loss 1.115571
Epoch 41, Train Loss 0.912805, Valid_loss 1.116782
Epoch 42, Train Loss 0.913728, Valid_loss 1.118183
Epoch 43, Train Loss 0.917553, Valid_loss 1.115238
Epoch 44, Train Loss 0.914041, Valid_loss 1.114845
Epoch 45, Train Loss 0.913628, Valid_loss 1.116391
Epoch 46, Train Loss 0.914780, Valid_loss 1.117871
Epoch 47, Train Loss 0.913867, Valid_loss 1.114480
Epoch 48, Train Loss 0.912801, Valid_loss 1.118312
Epoch 49, Train Loss 0.912824, Valid_loss 1.116176
Epoch 50, Train Loss 0.912750, Valid_loss 1.115056
Epoch 51, Train Loss 0.912690, Valid_loss 1.114955
Epoch 52, Train Loss 0.912343, Valid_loss 1.117440
Epoch 53, Train Loss 0.912350, Valid_loss 1.115633
Epoch 54, Train Loss 0.912292, Valid_loss 1.115973
Epoch 55, Train Loss 0.912530, Valid_loss 1.116241
[I 2025-08-31 02:50:43,466] Trial 0 finished with value: 1.0510402634030296 and parameters: {'learning_rate': 0.01, 'epochs': 100, 'heads': 4, 'dropout': 0.7, 'weight_decay': 0.0001, 'emb_dim': 8, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 1.0510402634030296.
👉 train samples(학습 샘플(bag))=140, batch_size=16 -> steps(샘플수/batch크기)=9
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 1076.66 MB
Memory Reserved: 1088.00 MB
cuda
CUDA OOM 발생 — 단계적 백오프 시작.
[OOM RETRY] batch_size 16 → 8 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=140, batch_size=8 -> steps(샘플수/batch크기)=18
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 3178.60 MB
Memory Reserved: 3190.00 MB
cuda
Epoch 1, Train Loss 1.023600, Valid_loss 1.061595
Epoch 2, Train Loss 0.969534, Valid_loss 1.055719
Epoch 3, Train Loss 0.919666, Valid_loss 1.043949
Epoch 4, Train Loss 0.904181, Valid_loss 1.040192
Epoch 5, Train Loss 0.910268, Valid_loss 0.999734
Epoch 6, Train Loss 0.914111, Valid_loss 0.956628
Epoch 7, Train Loss 0.861437, Valid_loss 0.906591
Epoch 8, Train Loss 0.817457, Valid_loss 0.820055
Epoch 9, Train Loss 0.814627, Valid_loss 0.807777
Epoch 10, Train Loss 0.770783, Valid_loss 0.806224
Epoch 11, Train Loss 0.773437, Valid_loss 0.751537
Epoch 12, Train Loss 0.721497, Valid_loss 0.765127
Epoch 13, Train Loss 0.719309, Valid_loss 0.733677
Epoch 14, Train Loss 0.652219, Valid_loss 0.712331
Epoch 15, Train Loss 0.628429, Valid_loss 0.665935
Epoch 16, Train Loss 0.630878, Valid_loss 0.674113
Epoch 17, Train Loss 0.604389, Valid_loss 0.703006
Epoch 18, Train Loss 0.612783, Valid_loss 0.616085
Epoch 19, Train Loss 0.607760, Valid_loss 0.657786
Epoch 20, Train Loss 0.637258, Valid_loss 0.672246
Epoch 21, Train Loss 0.522971, Valid_loss 0.668197
Epoch 22, Train Loss 0.621696, Valid_loss 0.633584
Epoch 23, Train Loss 0.553840, Valid_loss 0.607057
Epoch 24, Train Loss 0.533355, Valid_loss 0.624166
Epoch 25, Train Loss 0.514317, Valid_loss 0.622639
Epoch 26, Train Loss 0.545528, Valid_loss 0.591913
Epoch 27, Train Loss 0.522032, Valid_loss 0.589668
Epoch 28, Train Loss 0.474293, Valid_loss 0.603061
Epoch 29, Train Loss 0.537447, Valid_loss 0.593730
Epoch 30, Train Loss 0.584673, Valid_loss 0.577485
Epoch 31, Train Loss 0.531374, Valid_loss 0.727640
Epoch 32, Train Loss 0.517739, Valid_loss 0.596146
Epoch 33, Train Loss 0.480322, Valid_loss 0.563284
Epoch 34, Train Loss 0.462300, Valid_loss 0.603473
Epoch 35, Train Loss 0.421406, Valid_loss 0.631136
Epoch 36, Train Loss 0.449434, Valid_loss 0.608265
Epoch 37, Train Loss 0.453403, Valid_loss 0.589127
Epoch 38, Train Loss 0.454485, Valid_loss 0.586547
Epoch 39, Train Loss 0.450843, Valid_loss 0.548040
Epoch 40, Train Loss 0.433344, Valid_loss 0.553952
Epoch 41, Train Loss 0.503154, Valid_loss 0.640591
Epoch 42, Train Loss 0.486898, Valid_loss 0.600043
Epoch 43, Train Loss 0.421998, Valid_loss 0.545133
Epoch 44, Train Loss 0.425581, Valid_loss 0.552486
Epoch 45, Train Loss 0.415010, Valid_loss 0.585799
Epoch 46, Train Loss 0.415438, Valid_loss 0.564351
Epoch 47, Train Loss 0.391200, Valid_loss 0.597278
Epoch 48, Train Loss 0.399623, Valid_loss 0.559617
Epoch 49, Train Loss 0.403213, Valid_loss 0.563472
Epoch 50, Train Loss 0.382604, Valid_loss 0.562499
Epoch 51, Train Loss 0.401745, Valid_loss 0.612266
Epoch 52, Train Loss 0.399217, Valid_loss 0.574231
Epoch 53, Train Loss 0.404624, Valid_loss 0.567790
Epoch 54, Train Loss 0.383139, Valid_loss 0.558957
Epoch 55, Train Loss 0.386420, Valid_loss 0.540884
Epoch 56, Train Loss 0.410607, Valid_loss 0.550641
Epoch 57, Train Loss 0.370530, Valid_loss 0.556848
[I 2025-08-31 03:00:43,184] Trial 1 finished with value: 0.5408839186032613 and parameters: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 2, 'dropout': 0.5, 'weight_decay': 0.01, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 1 with value: 0.5408839186032613.
👉 train samples(학습 샘플(bag))=140, batch_size=16 -> steps(샘플수/batch크기)=9
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 3180.44 MB
Memory Reserved: 3188.00 MB
cuda
CUDA OOM 발생 — 단계적 백오프 시작.
[OOM RETRY] batch_size 16 → 8 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=140, batch_size=8 -> steps(샘플수/batch크기)=18
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 5284.21 MB
Memory Reserved: 5290.00 MB
cuda
Epoch 1, Train Loss 1.112911, Valid_loss 1.093091
Epoch 2, Train Loss 0.990913, Valid_loss 1.124941
Epoch 3, Train Loss 0.970831, Valid_loss 1.110442
Epoch 4, Train Loss 0.967530, Valid_loss 1.138279
Epoch 5, Train Loss 0.977546, Valid_loss 1.098510
Epoch 6, Train Loss 0.965527, Valid_loss 1.120647
Epoch 7, Train Loss 0.924057, Valid_loss 1.122612
Epoch 8, Train Loss 0.952702, Valid_loss 1.114887
Epoch 9, Train Loss 0.932230, Valid_loss 1.146159
Epoch 10, Train Loss 0.935442, Valid_loss 1.153485
Epoch 11, Train Loss 0.937595, Valid_loss 1.118602
Epoch 12, Train Loss 0.951809, Valid_loss 1.121632
Epoch 13, Train Loss 0.941313, Valid_loss 1.093759
Epoch 14, Train Loss 0.929789, Valid_loss 1.119633
Epoch 15, Train Loss 0.924208, Valid_loss 1.132588
Epoch 16, Train Loss 0.972663, Valid_loss 1.120349
Epoch 17, Train Loss 0.962402, Valid_loss 1.106032
Epoch 18, Train Loss 0.934167, Valid_loss 1.086658
Epoch 19, Train Loss 0.930145, Valid_loss 1.139515
Epoch 20, Train Loss 0.923217, Valid_loss 1.143867
Epoch 21, Train Loss 0.957036, Valid_loss 1.098734
Epoch 22, Train Loss 0.932293, Valid_loss 1.119335
Epoch 23, Train Loss 0.929091, Valid_loss 1.121138
Epoch 24, Train Loss 0.914505, Valid_loss 1.141024
Epoch 25, Train Loss 0.919660, Valid_loss 1.135718
Epoch 26, Train Loss 0.924232, Valid_loss 1.130451
Epoch 27, Train Loss 0.919796, Valid_loss 1.132709
Epoch 28, Train Loss 0.923244, Valid_loss 1.145654
Epoch 29, Train Loss 0.930432, Valid_loss 1.160766
Epoch 30, Train Loss 0.914571, Valid_loss 1.136558
Epoch 31, Train Loss 0.928460, Valid_loss 1.139249
Epoch 32, Train Loss 0.925327, Valid_loss 1.136265
Epoch 33, Train Loss 0.915825, Valid_loss 1.116470
Epoch 34, Train Loss 0.925084, Valid_loss 1.111278
Epoch 35, Train Loss 0.940734, Valid_loss 1.100253
Epoch 36, Train Loss 0.916126, Valid_loss 1.102481
Epoch 37, Train Loss 0.924584, Valid_loss 1.117906
Epoch 38, Train Loss 0.914476, Valid_loss 1.103197
Epoch 39, Train Loss 0.926043, Valid_loss 1.095114
Epoch 40, Train Loss 0.922050, Valid_loss 1.103217
Epoch 41, Train Loss 0.911396, Valid_loss 1.114097
Epoch 42, Train Loss 0.910291, Valid_loss 1.112555
Epoch 43, Train Loss 0.908777, Valid_loss 1.135960
Epoch 44, Train Loss 0.906277, Valid_loss 1.153864
Epoch 45, Train Loss 0.904936, Valid_loss 1.152701
Epoch 46, Train Loss 0.910646, Valid_loss 1.142581
Epoch 47, Train Loss 0.911218, Valid_loss 1.126334
Epoch 48, Train Loss 0.911668, Valid_loss 1.143014
Epoch 49, Train Loss 0.907206, Valid_loss 1.127716
Epoch 50, Train Loss 0.902390, Valid_loss 1.163548
Epoch 51, Train Loss 0.922766, Valid_loss 1.147803
Epoch 52, Train Loss 0.899137, Valid_loss 1.159504
Epoch 53, Train Loss 0.923373, Valid_loss 1.129513
Epoch 54, Train Loss 0.921054, Valid_loss 1.119978
Epoch 55, Train Loss 0.902773, Valid_loss 1.131084
Epoch 56, Train Loss 0.903645, Valid_loss 1.145731
[I 2025-08-31 03:12:10,030] Trial 2 finished with value: 1.0866583330290658 and parameters: {'learning_rate': 0.01, 'epochs': 100, 'heads': 2, 'dropout': 0.7, 'weight_decay': 0.001, 'emb_dim': 64, 'augment_num': 100, 'pca': False}. Best is trial 1 with value: 0.5408839186032613.
선택된 trial params: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 2, 'dropout': 0.5, 'weight_decay': 0.01, 'emb_dim': 32, 'augment_num': 100, 'pca': False}
👉 train samples(학습 샘플(bag))=140, batch_size=16 -> steps(샘플수/batch크기)=9
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=16, batch_size=1 -> steps=16
Memory Allocated: 5282.37 MB
Memory Reserved: 5290.00 MB
cuda
CUDA OOM 발생 — 단계적 백오프 시작.
[OOM RETRY] batch_size 16 → 8 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=140, batch_size=8 -> steps(샘플수/batch크기)=18
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=16, batch_size=1 -> steps=16
Memory Allocated: 7384.31 MB
Memory Reserved: 7392.00 MB
cuda
[OOM RETRY] batch_size=8에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 16 → 4 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=140, batch_size=4 -> steps(샘플수/batch크기)=35
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=16, batch_size=1 -> steps=16
Memory Allocated: 12489.74 MB
Memory Reserved: 12498.00 MB
cuda
Epoch 1, Train Loss 1.024007, Valid_loss 1.037124
Epoch 2, Train Loss 0.898983, Valid_loss 1.000247
Epoch 3, Train Loss 0.893435, Valid_loss 0.972595
Epoch 4, Train Loss 0.884349, Valid_loss 0.856317
Epoch 5, Train Loss 0.837196, Valid_loss 0.820375
Epoch 6, Train Loss 0.815240, Valid_loss 0.778820
Epoch 7, Train Loss 0.726071, Valid_loss 0.750391
Epoch 8, Train Loss 0.770446, Valid_loss 0.803600
Epoch 9, Train Loss 0.707557, Valid_loss 0.669168
Epoch 10, Train Loss 0.692629, Valid_loss 0.635551
Epoch 11, Train Loss 0.672827, Valid_loss 0.753501
Epoch 12, Train Loss 0.662233, Valid_loss 0.622072
Epoch 13, Train Loss 0.613508, Valid_loss 0.626587
Epoch 14, Train Loss 0.635064, Valid_loss 0.701057
Epoch 15, Train Loss 0.564672, Valid_loss 0.678870
Epoch 16, Train Loss 0.559918, Valid_loss 0.601266
Epoch 17, Train Loss 0.564455, Valid_loss 0.621453
Epoch 18, Train Loss 0.532582, Valid_loss 0.577349
Epoch 19, Train Loss 0.603336, Valid_loss 0.678735
Epoch 20, Train Loss 0.567133, Valid_loss 0.549932
Epoch 21, Train Loss 0.607746, Valid_loss 0.546942
Epoch 22, Train Loss 0.544935, Valid_loss 0.736978
Epoch 23, Train Loss 0.562747, Valid_loss 0.672159
Epoch 24, Train Loss 0.469787, Valid_loss 0.552206
Epoch 25, Train Loss 0.485238, Valid_loss 0.642108
Epoch 26, Train Loss 0.484753, Valid_loss 0.557558
Epoch 27, Train Loss 0.487827, Valid_loss 0.684476
Epoch 28, Train Loss 0.540051, Valid_loss 0.493269
Epoch 29, Train Loss 0.511443, Valid_loss 0.675055
Epoch 30, Train Loss 0.442645, Valid_loss 0.494143
Epoch 31, Train Loss 0.480891, Valid_loss 0.554272
Epoch 32, Train Loss 0.439250, Valid_loss 0.481219
Epoch 33, Train Loss 0.457042, Valid_loss 0.817269
Epoch 34, Train Loss 0.480054, Valid_loss 0.539358
Epoch 35, Train Loss 0.426552, Valid_loss 0.555049
Epoch 36, Train Loss 0.459395, Valid_loss 0.590082
Epoch 37, Train Loss 0.445752, Valid_loss 0.664701
Epoch 38, Train Loss 0.453489, Valid_loss 0.482959
Epoch 39, Train Loss 0.428614, Valid_loss 0.545224
Epoch 40, Train Loss 0.410154, Valid_loss 0.546714
Epoch 41, Train Loss 0.379251, Valid_loss 0.551320
Epoch 42, Train Loss 0.388407, Valid_loss 0.535813
Epoch 43, Train Loss 0.438164, Valid_loss 0.461574
Epoch 44, Train Loss 0.583401, Valid_loss 0.476518
Epoch 45, Train Loss 0.387168, Valid_loss 0.489873
Epoch 46, Train Loss 0.430817, Valid_loss 0.523152
Epoch 47, Train Loss 0.421936, Valid_loss 0.580242
Epoch 48, Train Loss 0.402822, Valid_loss 0.485780
Epoch 49, Train Loss 0.384382, Valid_loss 0.473929
Epoch 50, Train Loss 0.407679, Valid_loss 0.474000
Epoch 51, Train Loss 0.360500, Valid_loss 0.502394
Epoch 52, Train Loss 0.348277, Valid_loss 0.458363
Epoch 53, Train Loss 0.319730, Valid_loss 0.522303
Epoch 54, Train Loss 0.356087, Valid_loss 0.555025
환자ID=164-3 -- true: [[0]] -- pred: tensor([[ 2.2534, -0.8079, -1.5816]], device='cuda:0')
환자ID=27-10119 -- true: [[1]] -- pred: tensor([[ 0.0622,  1.1913, -1.8535]], device='cuda:0')
환자ID=28-10051 -- true: [[1]] -- pred: tensor([[-0.6292,  1.0778,  0.0632]], device='cuda:0')
환자ID=28-11515 -- true: [[1]] -- pred: tensor([[-0.6227,  1.3751, -0.7620]], device='cuda:0')
환자ID=29-10404 -- true: [[1]] -- pred: tensor([[-0.6308,  1.4208, -0.4628]], device='cuda:0')
환자ID=29-10406 -- true: [[1]] -- pred: tensor([[-0.4341,  1.5029, -0.9891]], device='cuda:0')
환자ID=30-10123 -- true: [[2]] -- pred: tensor([[-0.0579,  1.2785, -1.5387]], device='cuda:0')
환자ID=31-10035 -- true: [[1]] -- pred: tensor([[-0.4826,  1.1845, -0.6983]], device='cuda:0')
환자ID=31-10154 -- true: [[1]] -- pred: tensor([[-0.2676,  1.4175, -1.3059]], device='cuda:0')
환자ID=31-10236 -- true: [[1]] -- pred: tensor([[-0.4596,  1.5432, -0.8310]], device='cuda:0')
환자ID=32-10074 -- true: [[2]] -- pred: tensor([[-1.0132,  0.8168,  0.0360]], device='cuda:0')
환자ID=PRE027 -- true: [[0]] -- pred: tensor([[ 2.2685, -0.8145, -1.5210]], device='cuda:0')
환자ID=PRE038 -- true: [[0]] -- pred: tensor([[ 2.2625, -0.8145, -1.5158]], device='cuda:0')
환자ID=Sample1153-EO1 -- true: [[0]] -- pred: tensor([[ 2.2902, -0.9104, -1.4386]], device='cuda:0')
환자ID=Sample1153-EO3 -- true: [[0]] -- pred: tensor([[ 2.2977, -0.9423, -1.3789]], device='cuda:0')
환자ID=Sample1162-EO2 -- true: [[0]] -- pred: tensor([[ 2.2867, -0.8687, -1.4689]], device='cuda:0')
Best performance: Epoch 52, Loss 0.348277, Test ACC 0.875000, Test AUC 0.895833, Test Recall 0.666667, Test Precision 0.600000
Confusion Matrix:
 [[6 0 0]
 [0 8 0]
 [0 2 0]]
✅ Total valid splits used: 1
🔁 Repeat 1, Fold 1
cell type :  S2008000605HRT_AAACCCAGTGCACATT-1     Epithelial_cells
S2008000605HRT_AAACCCAGTGCCTACG-1     Epithelial_cells
S2008000605HRT_AAAGAACGTAGAGACC-1            Astrocyte
S2008000605HRT_AAAGAACGTCGGAACA-1     Epithelial_cells
S2008000605HRT_AAAGAACGTTAACAGA-1     Epithelial_cells
                                           ...        
Sample1162EO2_TTTGGAGAGCAGGCAT-1      Epithelial_cells
Sample1162EO2_TTTGGAGAGTCGCGAA-1     Endothelial_cells
Sample1162EO2_TTTGGAGAGTGCTCGC-1           Hepatocytes
Sample1162EO2_TTTGGAGGTGATACTC-1      Epithelial_cells
Sample1162EO2_TTTGGTTCAGTAGAAT-1      Epithelial_cells
Name: singler_annotation, Length: 178684, dtype: string
cell type annotation :  S2008000605HRT_AAACCCAGTGCACATT-1     Epithelial_cells
S2008000605HRT_AAACCCAGTGCCTACG-1     Epithelial_cells
S2008000605HRT_AAAGAACGTAGAGACC-1            Astrocyte
S2008000605HRT_AAAGAACGTCGGAACA-1     Epithelial_cells
S2008000605HRT_AAAGAACGTTAACAGA-1     Epithelial_cells
                                           ...        
Sample1162EO2_TTTGGAGAGCAGGCAT-1      Epithelial_cells
Sample1162EO2_TTTGGAGAGTCGCGAA-1     Endothelial_cells
Sample1162EO2_TTTGGAGAGTGCTCGC-1           Hepatocytes
Sample1162EO2_TTTGGAGGTGATACTC-1      Epithelial_cells
Sample1162EO2_TTTGGTTCAGTAGAAT-1      Epithelial_cells
Name: singler_annotation, Length: 178684, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Epithelial_cells', 'Astrocyte', 'MSC', 'Keratinocytes', 'Neurons', 'Endothelial_cells', 'Fibroblasts', 'Tissue_stem_cells', 'Smooth_muscle_cells', 'T_cells', 'Neuroepithelial_cell', 'NK_cell', 'Chondrocytes', 'Osteoblasts', 'Monocyte', 'Hepatocytes', 'Macrophage', 'CMP', 'Embryonic_stem_cells', 'DC', 'BM & Prog.', 'MEP', 'Neutrophils', 'Pro-Myelocyte', 'iPS_cells', 'Pre-B_cell_CD34-', 'HSC_-G-CSF', 'B_cell', 'GMP', 'HSC_CD34+', 'Platelets', 'Pro-B_cell_CD34+', 'Myelocyte', 'BM', 'Erythroblast', 'Gametocytes', 'Unknown']
라벨별 그룹 개수 {0: 21, 1: 29, 2: 11}
cell type :  S2107011581HRT_AAACCCAGTTTCCAAG-1       Endothelial_cells
S2107011581HRT_AAACCCATCACTACTT-1       Endothelial_cells
S2107011581HRT_AAACGAAAGGGCCCTT-1     Smooth_muscle_cells
S2107011581HRT_AAACGAAAGTAGAATC-1             Hepatocytes
S2107011581HRT_AAACGAATCACTCGAA-1    Neuroepithelial_cell
                                             ...         
Sample1158EO2_TTTGACTAGGACACTG-1                  NK_cell
Sample1158EO2_TTTGACTTCCTCTTTC-1      Smooth_muscle_cells
Sample1158EO2_TTTGATCAGCTAAACA-1     Embryonic_stem_cells
Sample1158EO2_TTTGATCTCACTTATC-1     Neuroepithelial_cell
Sample1158EO2_TTTGTTGCAATACGCT-1     Embryonic_stem_cells
Name: singler_annotation, Length: 46493, dtype: string
cell type annotation :  S2107011581HRT_AAACCCAGTTTCCAAG-1       Endothelial_cells
S2107011581HRT_AAACCCATCACTACTT-1       Endothelial_cells
S2107011581HRT_AAACGAAAGGGCCCTT-1     Smooth_muscle_cells
S2107011581HRT_AAACGAAAGTAGAATC-1             Hepatocytes
S2107011581HRT_AAACGAATCACTCGAA-1    Neuroepithelial_cell
                                             ...         
Sample1158EO2_TTTGACTAGGACACTG-1                  NK_cell
Sample1158EO2_TTTGACTTCCTCTTTC-1      Smooth_muscle_cells
Sample1158EO2_TTTGATCAGCTAAACA-1     Embryonic_stem_cells
Sample1158EO2_TTTGATCTCACTTATC-1     Neuroepithelial_cell
Sample1158EO2_TTTGTTGCAATACGCT-1     Embryonic_stem_cells
Name: singler_annotation, Length: 46493, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Endothelial_cells', 'Smooth_muscle_cells', 'Hepatocytes', 'Neuroepithelial_cell', 'Neurons', 'Epithelial_cells', 'Fibroblasts', 'CMP', 'Astrocyte', 'NK_cell', 'T_cells', 'Pro-B_cell_CD34+', 'Monocyte', 'Embryonic_stem_cells', 'iPS_cells', 'DC', 'Keratinocytes', 'B_cell', 'Neutrophils', 'Unknown', 'GMP', 'Chondrocytes', 'BM & Prog.', 'Tissue_stem_cells', 'Pre-B_cell_CD34-', 'HSC_CD34+', 'Macrophage', 'HSC_-G-CSF', 'Platelets', 'Erythroblast', 'MEP', 'Osteoblasts', 'Gametocytes', 'MSC', 'BM', 'Pro-Myelocyte', 'Myelocyte']
라벨별 그룹 개수 {0: 5, 1: 8, 2: 3}
🔍 Split #2
  → train_p_index 환자 수 (환자 단위로 묶인 index list): 61
  → test_p_index 환자 수  (환자 단위로 묶인 index list): 16
  → train 환자 ID: ['163-2', '163-3', '163-4', '163-5', '164-10', '164-3', '165-9', '27-10039', '27-10053', '27-10071', '27-10112', '27-10119', '28-10051', '28-11515', '28-12263', '28-12381', '28-12490', '29-10006', '29-10008', '29-10010', '29-10011', '29-10012', '29-10016', '29-10280', '29-10380', '29-10400', '29-10404', '29-10406', '29-10410', '30-10018', '30-10034', '30-10123', '30-11051', '31-10001', '31-10035', '31-10040', '31-10078', '31-10154', '31-10210', '31-10236', '32-10003', '32-10034', '32-10074', '33-10005', '33-10006', '34-10184', '34-10187', 'PRE019', 'PRE027', 'PRE038', 'PRE062-1', 'PRE98sc', 'Sample1153-EO1', 'Sample1153-EO2', 'Sample1153-EO3', 'Sample1157-EO1', 'Sample1157-EO2', 'Sample1157-EO3', 'Sample1158-EO3', 'Sample1162-EO1', 'Sample1162-EO2']
  → test  환자 ID: ['164-6', '27-10041', '28-12518', '29-10013', '29-10386', '29-10398', '30-10125', '30-10929', '31-10000', '31-10013', '31-10042', '34-10050', 'PRE018-1', 'PRE055-1', 'Sample1158-EO1', 'Sample1158-EO2']
  → train 환자 ID 및 라벨:
    ID: 163-2, Label: 0
    ID: 163-3, Label: 0
    ID: 163-4, Label: 0
    ID: 163-5, Label: 0
    ID: 164-10, Label: 0
    ID: 164-3, Label: 0
    ID: 165-9, Label: 0
    ID: 27-10039, Label: 1
    ID: 27-10053, Label: 1
    ID: 27-10071, Label: 1
    ID: 27-10112, Label: 1
    ID: 27-10119, Label: 1
    ID: 28-10051, Label: 1
    ID: 28-11515, Label: 1
    ID: 28-12263, Label: 1
    ID: 28-12381, Label: 1
    ID: 28-12490, Label: 1
    ID: 29-10006, Label: 1
    ID: 29-10008, Label: 1
    ID: 29-10010, Label: 1
    ID: 29-10011, Label: 1
    ID: 29-10012, Label: 1
    ID: 29-10016, Label: 1
    ID: 29-10280, Label: 1
    ID: 29-10380, Label: 1
    ID: 29-10400, Label: 1
    ID: 29-10404, Label: 1
    ID: 29-10406, Label: 1
    ID: 29-10410, Label: 1
    ID: 30-10018, Label: 2
    ID: 30-10034, Label: 2
    ID: 30-10123, Label: 2
    ID: 30-11051, Label: 2
    ID: 31-10001, Label: 1
    ID: 31-10035, Label: 1
    ID: 31-10040, Label: 1
    ID: 31-10078, Label: 1
    ID: 31-10154, Label: 1
    ID: 31-10210, Label: 1
    ID: 31-10236, Label: 1
    ID: 32-10003, Label: 2
    ID: 32-10034, Label: 2
    ID: 32-10074, Label: 2
    ID: 33-10005, Label: 2
    ID: 33-10006, Label: 2
    ID: 34-10184, Label: 2
    ID: 34-10187, Label: 2
    ID: PRE019, Label: 0
    ID: PRE027, Label: 0
    ID: PRE038, Label: 0
    ID: PRE062-1, Label: 0
    ID: PRE98sc, Label: 0
    ID: Sample1153-EO1, Label: 0
    ID: Sample1153-EO2, Label: 0
    ID: Sample1153-EO3, Label: 0
    ID: Sample1157-EO1, Label: 0
    ID: Sample1157-EO2, Label: 0
    ID: Sample1157-EO3, Label: 0
    ID: Sample1158-EO3, Label: 0
    ID: Sample1162-EO1, Label: 0
    ID: Sample1162-EO2, Label: 0
  → test 환자 ID 및 라벨:
    ID: 164-6, Label: 0
    ID: 27-10041, Label: 1
    ID: 28-12518, Label: 1
    ID: 29-10013, Label: 1
    ID: 29-10386, Label: 1
    ID: 29-10398, Label: 1
    ID: 30-10125, Label: 2
    ID: 30-10929, Label: 2
    ID: 31-10000, Label: 1
    ID: 31-10013, Label: 1
    ID: 31-10042, Label: 1
    ID: 34-10050, Label: 2
    ID: PRE018-1, Label: 0
    ID: PRE055-1, Label: 0
    ID: Sample1158-EO1, Label: 0
    ID: Sample1158-EO2, Label: 0
전체 데이터 index 길이 77
label_stat (train 환자 라벨 목록) 갯수 61
train_data에서 환자 단위로, train과 validation 나누기
기존 train_p_index 61
기존 (train) label_stat 61
train-vali 분할 후! 
train y 의 classes : {0, 1, 2} valid y 의 classes : {0, 1, 2} label_stat 의 classes : {0, 1, 2}
train_p_index_ 40
valid_p_index 21
test_p_index 16
→ train 환자 ID 및 라벨:
   총 개수: 40
   환자ID=29-10012, Label=1, 셀개수=6245
   환자ID=31-10210, Label=1, 셀개수=3510
   환자ID=Sample1153-EO3, Label=0, 셀개수=1516
   환자ID=Sample1157-EO3, Label=0, 셀개수=807
   환자ID=32-10034, Label=2, 셀개수=1555
   환자ID=163-5, Label=0, 셀개수=1210
   환자ID=29-10006, Label=1, 셀개수=11461
   환자ID=PRE038, Label=0, 셀개수=2666
   환자ID=31-10001, Label=1, 셀개수=1133
   환자ID=30-10123, Label=2, 셀개수=1273
   환자ID=163-3, Label=0, 셀개수=1335
   환자ID=27-10119, Label=1, 셀개수=3346
   환자ID=165-9, Label=0, 셀개수=2926
   환자ID=27-10039, Label=1, 셀개수=4638
   환자ID=163-2, Label=0, 셀개수=2535
   환자ID=29-10410, Label=1, 셀개수=2834
   환자ID=31-10040, Label=1, 셀개수=4543
   환자ID=30-10034, Label=2, 셀개수=1240
   환자ID=29-10280, Label=1, 셀개수=2375
   환자ID=31-10035, Label=1, 셀개수=2974
   환자ID=163-4, Label=0, 셀개수=1339
   환자ID=32-10003, Label=2, 셀개수=2978
   환자ID=PRE98sc, Label=0, 셀개수=1568
   환자ID=29-10404, Label=1, 셀개수=3988
   환자ID=28-11515, Label=1, 셀개수=930
   환자ID=Sample1162-EO1, Label=0, 셀개수=1053
   환자ID=31-10078, Label=1, 셀개수=2827
   환자ID=PRE019, Label=0, 셀개수=3795
   환자ID=27-10112, Label=1, 셀개수=1470
   환자ID=28-12490, Label=1, 셀개수=5973
   환자ID=28-10051, Label=1, 셀개수=300
   환자ID=164-3, Label=0, 셀개수=1639
   환자ID=29-10400, Label=1, 셀개수=2684
   환자ID=34-10184, Label=2, 셀개수=2699
   환자ID=29-10016, Label=1, 셀개수=4854
   환자ID=33-10005, Label=2, 셀개수=8904
   환자ID=32-10074, Label=2, 셀개수=6304
   환자ID=31-10236, Label=1, 셀개수=3458
   환자ID=29-10011, Label=1, 셀개수=3072
   환자ID=28-12381, Label=1, 셀개수=1099
→ valid 환자 ID 및 라벨:
   총 개수: 21
   환자ID=Sample1162-EO2, Label=0, 셀개수=1510
   환자ID=29-10010, Label=1, 셀개수=5305
   환자ID=31-10154, Label=1, 셀개수=6568
   환자ID=Sample1153-EO1, Label=0, 셀개수=911
   환자ID=Sample1157-EO2, Label=0, 셀개수=1395
   환자ID=PRE062-1, Label=0, 셀개수=907
   환자ID=Sample1157-EO1, Label=0, 셀개수=1152
   환자ID=30-10018, Label=2, 셀개수=5170
   환자ID=30-11051, Label=2, 셀개수=2454
   환자ID=29-10406, Label=1, 셀개수=3484
   환자ID=Sample1158-EO3, Label=0, 셀개수=1096
   환자ID=27-10071, Label=1, 셀개수=1478
   환자ID=29-10380, Label=1, 셀개수=4799
   환자ID=Sample1153-EO2, Label=0, 셀개수=916
   환자ID=34-10187, Label=2, 셀개수=3739
   환자ID=PRE027, Label=0, 셀개수=2078
   환자ID=164-10, Label=0, 셀개수=4041
   환자ID=29-10008, Label=1, 셀개수=1913
   환자ID=27-10053, Label=1, 셀개수=728
   환자ID=28-12263, Label=1, 셀개수=7527
   환자ID=33-10006, Label=2, 셀개수=457
→ test 환자 ID 및 라벨:
   총 개수: 16
   환자ID=164-6, Label=0, 셀개수=3038
   환자ID=27-10041, Label=1, 셀개수=2145
   환자ID=28-12518, Label=1, 셀개수=1215
   환자ID=29-10013, Label=1, 셀개수=3706
   환자ID=29-10386, Label=1, 셀개수=802
   환자ID=29-10398, Label=1, 셀개수=3993
   환자ID=30-10125, Label=2, 셀개수=3798
   환자ID=30-10929, Label=2, 셀개수=5812
   환자ID=31-10000, Label=1, 셀개수=8870
   환자ID=31-10013, Label=1, 셀개수=3161
   환자ID=31-10042, Label=1, 셀개수=1222
   환자ID=34-10050, Label=2, 셀개수=4784
   환자ID=PRE018-1, Label=0, 셀개수=1349
   환자ID=PRE055-1, Label=0, 셀개수=597
   환자ID=Sample1158-EO1, Label=0, 셀개수=574
   환자ID=Sample1158-EO2, Label=0, 셀개수=1427
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Epithelial_cells', 'Epithelial_cells', 'Astrocyte', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'MSC', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
전체 데이터 길이 225177
전체 cell type 길이 0             Epithelial_cells
1             Epithelial_cells
2                    Astrocyte
3             Epithelial_cells
4             Epithelial_cells
                  ...         
225172                 NK_cell
225173     Smooth_muscle_cells
225174    Embryonic_stem_cells
225175    Neuroepithelial_cell
225176    Embryonic_stem_cells
Length: 225177, dtype: string
cell type의 NaN 개수 체크 0
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:10,  9.14it/s]  2%|▏         | 2/100 [00:00<00:12,  8.14it/s]  3%|▎         | 3/100 [00:00<00:11,  8.37it/s]  4%|▍         | 4/100 [00:00<00:11,  8.21it/s]  5%|▌         | 5/100 [00:00<00:14,  6.73it/s]  6%|▌         | 6/100 [00:00<00:12,  7.55it/s]  7%|▋         | 7/100 [00:00<00:12,  7.49it/s]  8%|▊         | 8/100 [00:01<00:11,  8.09it/s]  9%|▉         | 9/100 [00:01<00:10,  8.51it/s] 10%|█         | 10/100 [00:01<00:10,  8.63it/s] 11%|█         | 11/100 [00:01<00:11,  7.72it/s] 12%|█▏        | 12/100 [00:01<00:10,  8.12it/s] 14%|█▍        | 14/100 [00:01<00:09,  8.92it/s] 15%|█▌        | 15/100 [00:01<00:09,  8.65it/s] 16%|█▌        | 16/100 [00:01<00:09,  8.48it/s] 17%|█▋        | 17/100 [00:02<00:09,  8.71it/s] 18%|█▊        | 18/100 [00:02<00:09,  8.67it/s] 19%|█▉        | 19/100 [00:02<00:09,  8.60it/s] 20%|██        | 20/100 [00:02<00:08,  8.92it/s] 21%|██        | 21/100 [00:02<00:09,  8.29it/s] 22%|██▏       | 22/100 [00:02<00:10,  7.69it/s] 23%|██▎       | 23/100 [00:02<00:09,  7.90it/s] 24%|██▍       | 24/100 [00:02<00:09,  8.01it/s] 25%|██▌       | 25/100 [00:03<00:09,  8.17it/s] 26%|██▌       | 26/100 [00:03<00:09,  8.17it/s] 27%|██▋       | 27/100 [00:03<00:08,  8.36it/s] 28%|██▊       | 28/100 [00:03<00:10,  6.76it/s] 29%|██▉       | 29/100 [00:03<00:09,  7.21it/s] 30%|███       | 30/100 [00:03<00:09,  7.66it/s] 31%|███       | 31/100 [00:03<00:08,  7.82it/s] 32%|███▏      | 32/100 [00:03<00:08,  7.73it/s] 33%|███▎      | 33/100 [00:04<00:08,  7.86it/s] 34%|███▍      | 34/100 [00:04<00:10,  6.56it/s] 35%|███▌      | 35/100 [00:04<00:09,  7.13it/s] 36%|███▌      | 36/100 [00:04<00:08,  7.42it/s] 37%|███▋      | 37/100 [00:04<00:08,  7.79it/s] 38%|███▊      | 38/100 [00:04<00:09,  6.48it/s] 39%|███▉      | 39/100 [00:04<00:08,  6.99it/s] 40%|████      | 40/100 [00:05<00:08,  7.30it/s] 41%|████      | 41/100 [00:05<00:07,  7.41it/s] 42%|████▏     | 42/100 [00:05<00:07,  7.28it/s] 43%|████▎     | 43/100 [00:05<00:08,  6.57it/s] 44%|████▍     | 44/100 [00:05<00:07,  7.12it/s] 45%|████▌     | 45/100 [00:05<00:07,  7.62it/s] 46%|████▌     | 46/100 [00:06<00:08,  6.41it/s] 47%|████▋     | 47/100 [00:06<00:07,  6.87it/s] 48%|████▊     | 48/100 [00:06<00:07,  7.22it/s] 49%|████▉     | 49/100 [00:06<00:06,  7.85it/s] 50%|█████     | 50/100 [00:06<00:06,  8.02it/s] 51%|█████     | 51/100 [00:06<00:05,  8.18it/s] 52%|█████▏    | 52/100 [00:06<00:05,  8.63it/s] 53%|█████▎    | 53/100 [00:06<00:05,  8.56it/s] 54%|█████▍    | 54/100 [00:06<00:05,  8.44it/s] 55%|█████▌    | 55/100 [00:07<00:05,  8.47it/s] 56%|█████▌    | 56/100 [00:07<00:05,  8.39it/s] 57%|█████▋    | 57/100 [00:07<00:05,  8.44it/s] 58%|█████▊    | 58/100 [00:07<00:05,  8.35it/s] 59%|█████▉    | 59/100 [00:07<00:04,  8.34it/s] 60%|██████    | 60/100 [00:07<00:04,  8.37it/s] 61%|██████    | 61/100 [00:07<00:05,  7.39it/s] 62%|██████▏   | 62/100 [00:07<00:05,  7.53it/s] 63%|██████▎   | 63/100 [00:08<00:04,  7.87it/s] 64%|██████▍   | 64/100 [00:08<00:05,  6.68it/s] 65%|██████▌   | 65/100 [00:08<00:04,  7.08it/s] 66%|██████▌   | 66/100 [00:08<00:04,  7.43it/s] 67%|██████▋   | 67/100 [00:08<00:04,  7.64it/s] 68%|██████▊   | 68/100 [00:08<00:04,  7.17it/s] 69%|██████▉   | 69/100 [00:08<00:04,  7.29it/s] 70%|███████   | 70/100 [00:09<00:04,  7.41it/s] 71%|███████   | 71/100 [00:09<00:03,  7.55it/s] 72%|███████▏  | 72/100 [00:09<00:03,  7.68it/s] 73%|███████▎  | 73/100 [00:09<00:03,  7.85it/s] 74%|███████▍  | 74/100 [00:09<00:03,  7.28it/s] 75%|███████▌  | 75/100 [00:09<00:03,  7.48it/s] 76%|███████▌  | 76/100 [00:09<00:03,  7.37it/s] 77%|███████▋  | 77/100 [00:09<00:03,  7.53it/s] 78%|███████▊  | 78/100 [00:10<00:02,  7.69it/s] 79%|███████▉  | 79/100 [00:10<00:02,  7.73it/s] 80%|████████  | 80/100 [00:10<00:02,  7.09it/s] 81%|████████  | 81/100 [00:10<00:02,  7.18it/s] 82%|████████▏ | 82/100 [00:10<00:02,  7.46it/s] 83%|████████▎ | 83/100 [00:10<00:02,  7.68it/s] 84%|████████▍ | 84/100 [00:10<00:02,  7.65it/s] 85%|████████▌ | 85/100 [00:11<00:02,  5.04it/s] 86%|████████▌ | 86/100 [00:11<00:02,  5.71it/s] 87%|████████▋ | 87/100 [00:11<00:02,  6.14it/s] 88%|████████▊ | 88/100 [00:11<00:01,  6.73it/s] 89%|████████▉ | 89/100 [00:11<00:01,  7.34it/s] 90%|█████████ | 90/100 [00:11<00:01,  7.68it/s] 91%|█████████ | 91/100 [00:11<00:01,  7.74it/s] 92%|█████████▏| 92/100 [00:12<00:01,  7.84it/s] 93%|█████████▎| 93/100 [00:12<00:00,  7.79it/s] 94%|█████████▍| 94/100 [00:12<00:00,  7.81it/s] 95%|█████████▌| 95/100 [00:12<00:00,  7.95it/s] 96%|█████████▌| 96/100 [00:12<00:00,  7.95it/s] 97%|█████████▋| 97/100 [00:12<00:00,  7.86it/s] 98%|█████████▊| 98/100 [00:12<00:00,  7.89it/s] 99%|█████████▉| 99/100 [00:12<00:00,  7.99it/s]100%|██████████| 100/100 [00:13<00:00,  7.81it/s]100%|██████████| 100/100 [00:13<00:00,  7.62it/s]
[I 2025-08-31 03:21:13,658] A new study created in memory with name: no-name-3b639c0e-67c1-4ef9-a257-7105815f1f8c
👉 train samples(학습 샘플(bag))=140, batch_size=16 -> steps(샘플수/batch크기)=9
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 26.13 MB
Memory Reserved: 36.00 MB
cuda
Epoch 1, Train Loss 1.160465, Valid_loss 1.074713
Epoch 2, Train Loss 1.064976, Valid_loss 1.058353
Epoch 3, Train Loss 0.980963, Valid_loss 1.046301
Epoch 4, Train Loss 0.988249, Valid_loss 1.030358
Epoch 5, Train Loss 0.960436, Valid_loss 1.015114
Epoch 6, Train Loss 0.928642, Valid_loss 1.003622
Epoch 7, Train Loss 0.908106, Valid_loss 0.989642
Epoch 8, Train Loss 0.882593, Valid_loss 0.972699
Epoch 9, Train Loss 0.874824, Valid_loss 0.945668
Epoch 10, Train Loss 0.864589, Valid_loss 0.912860
Epoch 11, Train Loss 0.840603, Valid_loss 0.869314
Epoch 12, Train Loss 0.775067, Valid_loss 0.822069
Epoch 13, Train Loss 0.731972, Valid_loss 0.785514
Epoch 14, Train Loss 0.716749, Valid_loss 0.796289
Epoch 15, Train Loss 0.731468, Valid_loss 0.794322
Epoch 16, Train Loss 0.701160, Valid_loss 0.718458
Epoch 17, Train Loss 0.700670, Valid_loss 0.775290
Epoch 18, Train Loss 0.670571, Valid_loss 0.764720
Epoch 19, Train Loss 0.652324, Valid_loss 0.831711
Epoch 20, Train Loss 0.667680, Valid_loss 0.758159
Epoch 21, Train Loss 0.639003, Valid_loss 0.793058
Epoch 22, Train Loss 0.657803, Valid_loss 0.745570
Epoch 23, Train Loss 0.615256, Valid_loss 0.758248
Epoch 24, Train Loss 0.628793, Valid_loss 0.759960
Epoch 25, Train Loss 0.561877, Valid_loss 0.792759
Epoch 26, Train Loss 0.625561, Valid_loss 0.722645
Epoch 27, Train Loss 0.654941, Valid_loss 0.803683
Epoch 28, Train Loss 0.531911, Valid_loss 0.726070
Epoch 29, Train Loss 0.550884, Valid_loss 0.777790
Epoch 30, Train Loss 0.578272, Valid_loss 0.743328
Epoch 31, Train Loss 0.586288, Valid_loss 0.816478
Epoch 32, Train Loss 0.546268, Valid_loss 0.708300
Epoch 33, Train Loss 0.571670, Valid_loss 0.734607
Epoch 34, Train Loss 0.536952, Valid_loss 0.703352
Epoch 35, Train Loss 0.549987, Valid_loss 0.763398
Epoch 36, Train Loss 0.529386, Valid_loss 0.713246
Epoch 37, Train Loss 0.573638, Valid_loss 0.758884
Epoch 38, Train Loss 0.494889, Valid_loss 0.746394
Epoch 39, Train Loss 0.494139, Valid_loss 0.711051
Epoch 40, Train Loss 0.492051, Valid_loss 0.886639
Epoch 41, Train Loss 0.488373, Valid_loss 0.710537
Epoch 42, Train Loss 0.484093, Valid_loss 0.798262
Epoch 43, Train Loss 0.484179, Valid_loss 0.799914
Epoch 44, Train Loss 0.501372, Valid_loss 0.838260
Epoch 45, Train Loss 0.480237, Valid_loss 0.647939
Epoch 46, Train Loss 0.530514, Valid_loss 0.828936
Epoch 47, Train Loss 0.480407, Valid_loss 0.679346
Epoch 48, Train Loss 0.492136, Valid_loss 0.765253
Epoch 49, Train Loss 0.460405, Valid_loss 0.785214
Epoch 50, Train Loss 0.446118, Valid_loss 0.735974
Epoch 51, Train Loss 0.454110, Valid_loss 0.786305
Epoch 52, Train Loss 0.436556, Valid_loss 0.818275
[I 2025-08-31 03:29:18,032] Trial 0 finished with value: 0.6479391299542927 and parameters: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 1, 'dropout': 0.5, 'weight_decay': 0.001, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.6479391299542927.
👉 train samples(학습 샘플(bag))=140, batch_size=16 -> steps(샘플수/batch크기)=9
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 26.13 MB
Memory Reserved: 36.00 MB
cuda
CUDA OOM 발생 — 단계적 백오프 시작.
[OOM RETRY] batch_size 16 → 8 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=140, batch_size=8 -> steps(샘플수/batch크기)=18
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 2128.07 MB
Memory Reserved: 2138.00 MB
cuda
Epoch 1, Train Loss 0.957292, Valid_loss 1.034731
Epoch 2, Train Loss 0.979067, Valid_loss 1.027155
Epoch 3, Train Loss 0.904503, Valid_loss 1.032826
Epoch 4, Train Loss 0.900446, Valid_loss 0.992887
Epoch 5, Train Loss 0.848794, Valid_loss 0.959493
Epoch 6, Train Loss 0.806941, Valid_loss 0.876110
Epoch 7, Train Loss 0.794716, Valid_loss 0.908822
Epoch 8, Train Loss 0.769821, Valid_loss 0.845912
Epoch 9, Train Loss 0.730137, Valid_loss 0.752808
Epoch 10, Train Loss 0.691231, Valid_loss 0.752874
Epoch 11, Train Loss 0.731041, Valid_loss 0.754725
Epoch 12, Train Loss 0.618568, Valid_loss 0.849248
Epoch 13, Train Loss 0.667522, Valid_loss 0.658655
Epoch 14, Train Loss 0.655315, Valid_loss 0.633869
Epoch 15, Train Loss 0.596967, Valid_loss 0.646727
Epoch 16, Train Loss 0.648192, Valid_loss 0.681317
Epoch 17, Train Loss 0.633393, Valid_loss 0.741470
Epoch 18, Train Loss 0.596721, Valid_loss 0.674750
Epoch 19, Train Loss 0.557525, Valid_loss 0.637874
Epoch 20, Train Loss 0.596521, Valid_loss 0.757019
Epoch 21, Train Loss 0.571234, Valid_loss 0.697765
Epoch 22, Train Loss 0.546608, Valid_loss 0.655077
Epoch 23, Train Loss 0.484470, Valid_loss 0.598336
Epoch 24, Train Loss 0.522513, Valid_loss 0.620141
Epoch 25, Train Loss 0.582653, Valid_loss 0.782962
Epoch 26, Train Loss 0.528581, Valid_loss 0.723371
Epoch 27, Train Loss 0.514381, Valid_loss 0.672474
Epoch 28, Train Loss 0.507723, Valid_loss 0.650025
Epoch 29, Train Loss 0.472493, Valid_loss 0.564049
Epoch 30, Train Loss 0.489911, Valid_loss 0.738810
Epoch 31, Train Loss 0.491792, Valid_loss 0.768166
Epoch 32, Train Loss 0.460616, Valid_loss 0.621676
Epoch 33, Train Loss 0.457297, Valid_loss 0.618968
Epoch 34, Train Loss 0.491526, Valid_loss 0.626980
Epoch 35, Train Loss 0.445027, Valid_loss 0.663206
Epoch 36, Train Loss 0.470946, Valid_loss 0.610289
Epoch 37, Train Loss 0.444475, Valid_loss 0.568083
Epoch 38, Train Loss 0.452026, Valid_loss 0.657581
Epoch 39, Train Loss 0.460738, Valid_loss 0.686344
Epoch 40, Train Loss 0.436683, Valid_loss 0.633147
Epoch 41, Train Loss 0.419118, Valid_loss 0.759446
Epoch 42, Train Loss 0.404593, Valid_loss 0.661852
Epoch 43, Train Loss 0.425625, Valid_loss 0.624518
Epoch 44, Train Loss 0.425562, Valid_loss 0.651041
Epoch 45, Train Loss 0.383543, Valid_loss 0.782576
Epoch 46, Train Loss 0.399764, Valid_loss 0.784646
Epoch 47, Train Loss 0.380948, Valid_loss 0.765016
Epoch 48, Train Loss 0.426649, Valid_loss 0.701890
Epoch 49, Train Loss 0.424652, Valid_loss 0.653003
Epoch 50, Train Loss 0.346161, Valid_loss 0.547354
Epoch 51, Train Loss 0.405244, Valid_loss 0.727495
Epoch 52, Train Loss 0.414049, Valid_loss 0.643772
Epoch 53, Train Loss 0.367683, Valid_loss 0.725718
Epoch 54, Train Loss 0.383911, Valid_loss 0.704145
Epoch 55, Train Loss 0.369942, Valid_loss 0.674478
Epoch 56, Train Loss 0.386855, Valid_loss 0.710906
Epoch 57, Train Loss 0.344235, Valid_loss 0.703446
Epoch 58, Train Loss 0.379584, Valid_loss 0.656910
Epoch 59, Train Loss 0.332250, Valid_loss 0.718654
Epoch 60, Train Loss 0.350830, Valid_loss 0.685255
Epoch 61, Train Loss 0.381301, Valid_loss 0.735884
Epoch 62, Train Loss 0.376657, Valid_loss 0.647014
Epoch 63, Train Loss 0.360966, Valid_loss 0.693497
Epoch 64, Train Loss 0.378041, Valid_loss 0.762243
[I 2025-08-31 03:40:18,731] Trial 1 finished with value: 0.5473542766911643 and parameters: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 2, 'dropout': 0.5, 'weight_decay': 0.001, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 1 with value: 0.5473542766911643.
👉 train samples(학습 샘플(bag))=140, batch_size=16 -> steps(샘플수/batch크기)=9
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 2126.75 MB
Memory Reserved: 2138.00 MB
cuda
CUDA OOM 발생 — 단계적 백오프 시작.
[OOM RETRY] batch_size 16 → 8 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=140, batch_size=8 -> steps(샘플수/batch크기)=18
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 4227.36 MB
Memory Reserved: 4238.00 MB
cuda
[OOM RETRY] batch_size=8에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 16 → 4 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=140, batch_size=4 -> steps(샘플수/batch크기)=35
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 5277.89 MB
Memory Reserved: 5288.00 MB
cuda
Epoch 1, Train Loss 1.182214, Valid_loss 1.053768
Epoch 2, Train Loss 1.009428, Valid_loss 1.071467
Epoch 3, Train Loss 0.950146, Valid_loss 1.102959
Epoch 4, Train Loss 0.937574, Valid_loss 1.092287
Epoch 5, Train Loss 0.928173, Valid_loss 1.114987
Epoch 6, Train Loss 0.946554, Valid_loss 1.080314
Epoch 7, Train Loss 0.916024, Valid_loss 1.110551
Epoch 8, Train Loss 0.921176, Valid_loss 1.100223
Epoch 9, Train Loss 0.901724, Valid_loss 1.119449
Epoch 10, Train Loss 0.934196, Valid_loss 1.103783
Epoch 11, Train Loss 0.918100, Valid_loss 1.107818
Epoch 12, Train Loss 0.907385, Valid_loss 1.132666
Epoch 13, Train Loss 0.907113, Valid_loss 1.109017
Epoch 14, Train Loss 0.906023, Valid_loss 1.123402
Epoch 15, Train Loss 0.896693, Valid_loss 1.120006
Epoch 16, Train Loss 0.902059, Valid_loss 1.144718
Epoch 17, Train Loss 0.910486, Valid_loss 1.123165
Epoch 18, Train Loss 0.905853, Valid_loss 1.134323
Epoch 19, Train Loss 0.889956, Valid_loss 1.144458
Epoch 20, Train Loss 0.899398, Valid_loss 1.136788
Epoch 21, Train Loss 0.897479, Valid_loss 1.142984
Epoch 22, Train Loss 0.903686, Valid_loss 1.138366
Epoch 23, Train Loss 0.903109, Valid_loss 1.135584
Epoch 24, Train Loss 0.907062, Valid_loss 1.140350
Epoch 25, Train Loss 0.885972, Valid_loss 1.159091
Epoch 26, Train Loss 0.906246, Valid_loss 1.143246
Epoch 27, Train Loss 0.910698, Valid_loss 1.133223
Epoch 28, Train Loss 0.906985, Valid_loss 1.126066
Epoch 29, Train Loss 0.901936, Valid_loss 1.131274
Epoch 30, Train Loss 0.903764, Valid_loss 1.119653
Epoch 31, Train Loss 0.905729, Valid_loss 1.124274
Epoch 32, Train Loss 0.899139, Valid_loss 1.125861
Epoch 33, Train Loss 0.903502, Valid_loss 1.135552
Epoch 34, Train Loss 0.903428, Valid_loss 1.121727
Epoch 35, Train Loss 0.903750, Valid_loss 1.120174
Epoch 36, Train Loss 0.903722, Valid_loss 1.113761
Epoch 37, Train Loss 0.909277, Valid_loss 1.117730
Epoch 38, Train Loss 0.899950, Valid_loss 1.119487
Epoch 39, Train Loss 0.903108, Valid_loss 1.111108
Epoch 40, Train Loss 0.902097, Valid_loss 1.119836
Epoch 41, Train Loss 0.902539, Valid_loss 1.114800
Epoch 42, Train Loss 0.902318, Valid_loss 1.123216
Epoch 43, Train Loss 0.900389, Valid_loss 1.124672
Epoch 44, Train Loss 0.900121, Valid_loss 1.123592
Epoch 45, Train Loss 0.902242, Valid_loss 1.120812
Epoch 46, Train Loss 0.900934, Valid_loss 1.120796
Epoch 47, Train Loss 0.901584, Valid_loss 1.123347
Epoch 48, Train Loss 0.901260, Valid_loss 1.116909
Epoch 49, Train Loss 0.900104, Valid_loss 1.124008
Epoch 50, Train Loss 0.897099, Valid_loss 1.122339
Epoch 51, Train Loss 0.902053, Valid_loss 1.123408
Epoch 52, Train Loss 0.897242, Valid_loss 1.130559
[I 2025-08-31 03:51:09,807] Trial 2 finished with value: 1.053767618678865 and parameters: {'learning_rate': 0.01, 'epochs': 100, 'heads': 4, 'dropout': 0.7, 'weight_decay': 0.001, 'emb_dim': 8, 'augment_num': 100, 'pca': False}. Best is trial 1 with value: 0.5473542766911643.
선택된 trial params: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 2, 'dropout': 0.5, 'weight_decay': 0.001, 'emb_dim': 32, 'augment_num': 100, 'pca': False}
👉 train samples(학습 샘플(bag))=140, batch_size=16 -> steps(샘플수/batch크기)=9
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=16, batch_size=1 -> steps=16
Memory Allocated: 5279.21 MB
Memory Reserved: 5290.00 MB
cuda
CUDA OOM 발생 — 단계적 백오프 시작.
[OOM RETRY] batch_size 16 → 8 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=140, batch_size=8 -> steps(샘플수/batch크기)=18
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=16, batch_size=1 -> steps=16
Memory Allocated: 7381.15 MB
Memory Reserved: 7392.00 MB
cuda
[OOM RETRY] batch_size=8에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 16 → 4 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=140, batch_size=4 -> steps(샘플수/batch크기)=35
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=16, batch_size=1 -> steps=16
Memory Allocated: 12487.82 MB
Memory Reserved: 12498.00 MB
cuda
Epoch 1, Train Loss 0.986738, Valid_loss 1.020152
Epoch 2, Train Loss 0.948577, Valid_loss 0.983757
Epoch 3, Train Loss 0.897134, Valid_loss 0.940188
Epoch 4, Train Loss 0.830926, Valid_loss 0.850971
Epoch 5, Train Loss 0.831042, Valid_loss 0.798631
Epoch 6, Train Loss 0.762276, Valid_loss 0.703623
Epoch 7, Train Loss 0.755584, Valid_loss 0.753152
Epoch 8, Train Loss 0.687384, Valid_loss 0.708255
Epoch 9, Train Loss 0.652402, Valid_loss 0.720119
Epoch 10, Train Loss 0.711892, Valid_loss 0.780254
Epoch 11, Train Loss 0.630240, Valid_loss 0.696833
Epoch 12, Train Loss 0.647780, Valid_loss 0.609784
Epoch 13, Train Loss 0.627670, Valid_loss 0.687592
Epoch 14, Train Loss 0.610179, Valid_loss 0.589338
Epoch 15, Train Loss 0.581556, Valid_loss 0.758056
Epoch 16, Train Loss 0.574474, Valid_loss 0.662936
Epoch 17, Train Loss 0.609235, Valid_loss 0.628458
Epoch 18, Train Loss 0.508710, Valid_loss 0.604709
Epoch 19, Train Loss 0.537703, Valid_loss 0.611052
Epoch 20, Train Loss 0.530151, Valid_loss 0.796878
Epoch 21, Train Loss 0.495863, Valid_loss 0.825077
Epoch 22, Train Loss 0.571026, Valid_loss 0.551213
Epoch 23, Train Loss 0.460791, Valid_loss 0.655834
Epoch 24, Train Loss 0.520144, Valid_loss 0.737996
Epoch 25, Train Loss 0.462711, Valid_loss 0.746640
Epoch 26, Train Loss 0.434062, Valid_loss 0.570504
Epoch 27, Train Loss 0.460914, Valid_loss 0.531525
Epoch 28, Train Loss 0.444362, Valid_loss 0.789064
Epoch 29, Train Loss 0.495005, Valid_loss 0.522619
Epoch 30, Train Loss 0.460674, Valid_loss 0.677932
Epoch 31, Train Loss 0.496419, Valid_loss 0.777737
Epoch 32, Train Loss 0.493472, Valid_loss 0.667859
Epoch 33, Train Loss 0.452663, Valid_loss 0.725464
Epoch 34, Train Loss 0.430750, Valid_loss 0.624134
Epoch 35, Train Loss 0.422241, Valid_loss 0.514733
Epoch 36, Train Loss 0.413994, Valid_loss 0.730836
Epoch 37, Train Loss 0.394490, Valid_loss 0.884387
Epoch 38, Train Loss 0.434296, Valid_loss 0.899127
Epoch 39, Train Loss 0.389882, Valid_loss 0.694023
Epoch 40, Train Loss 0.379426, Valid_loss 0.738384
Epoch 41, Train Loss 0.387985, Valid_loss 0.726904
Epoch 42, Train Loss 0.384763, Valid_loss 0.877968
Epoch 43, Train Loss 0.402163, Valid_loss 0.904498
Epoch 44, Train Loss 0.362312, Valid_loss 0.646792
Epoch 45, Train Loss 0.342051, Valid_loss 0.802482
Epoch 46, Train Loss 0.427489, Valid_loss 0.622651
Epoch 47, Train Loss 0.378497, Valid_loss 0.658387
Epoch 48, Train Loss 0.367776, Valid_loss 0.873229
Epoch 49, Train Loss 0.374274, Valid_loss 0.798857
Epoch 50, Train Loss 0.335579, Valid_loss 0.908521
Epoch 51, Train Loss 0.308361, Valid_loss 0.795781
Epoch 52, Train Loss 0.316721, Valid_loss 0.827386
Epoch 53, Train Loss 0.339242, Valid_loss 0.934166
환자ID=164-6 -- true: [[0]] -- pred: tensor([[ 1.8114, -0.6077, -1.5842]], device='cuda:0')
환자ID=27-10041 -- true: [[1]] -- pred: tensor([[-0.9680,  1.3857, -0.0796]], device='cuda:0')
환자ID=28-12518 -- true: [[1]] -- pred: tensor([[-1.0429,  1.0603,  0.0094]], device='cuda:0')
환자ID=29-10013 -- true: [[1]] -- pred: tensor([[-0.0833,  1.0969, -0.5573]], device='cuda:0')
환자ID=29-10386 -- true: [[1]] -- pred: tensor([[-0.4508,  1.4403, -0.2928]], device='cuda:0')
환자ID=29-10398 -- true: [[1]] -- pred: tensor([[-0.9803,  1.3212, -0.0372]], device='cuda:0')
환자ID=30-10125 -- true: [[2]] -- pred: tensor([[-0.9986,  1.1574,  0.0707]], device='cuda:0')
환자ID=30-10929 -- true: [[2]] -- pred: tensor([[-1.1109,  1.2635,  0.1045]], device='cuda:0')
환자ID=31-10000 -- true: [[1]] -- pred: tensor([[-1.1055,  1.2085, -0.0411]], device='cuda:0')
환자ID=31-10013 -- true: [[1]] -- pred: tensor([[-0.7292,  1.2569, -0.1855]], device='cuda:0')
환자ID=31-10042 -- true: [[1]] -- pred: tensor([[-1.0819,  1.2923,  0.0476]], device='cuda:0')
환자ID=34-10050 -- true: [[2]] -- pred: tensor([[-1.1505,  1.2201,  0.1572]], device='cuda:0')
환자ID=PRE018-1 -- true: [[0]] -- pred: tensor([[ 1.7575, -0.8692, -1.5528]], device='cuda:0')
환자ID=PRE055-1 -- true: [[0]] -- pred: tensor([[ 1.7208, -0.9068, -1.5432]], device='cuda:0')
환자ID=Sample1158-EO1 -- true: [[0]] -- pred: tensor([[ 1.6752, -0.9463, -1.5130]], device='cuda:0')
환자ID=Sample1158-EO2 -- true: [[0]] -- pred: tensor([[ 1.7095, -0.9049, -1.5518]], device='cuda:0')
Best performance: Epoch 35, Loss 0.422241, Test ACC 0.812500, Test AUC 0.944444, Test Recall 0.666667, Test Precision 0.575758
Confusion Matrix:
 [[5 0 0]
 [0 8 0]
 [0 3 0]]
✅ Total valid splits used: 2
🔁 Repeat 1, Fold 2
cell type :  S2008000605HRT_AAACCCAGTGCACATT-1     Epithelial_cells
S2008000605HRT_AAACCCAGTGCCTACG-1     Epithelial_cells
S2008000605HRT_AAAGAACGTAGAGACC-1            Astrocyte
S2008000605HRT_AAAGAACGTCGGAACA-1     Epithelial_cells
S2008000605HRT_AAAGAACGTTAACAGA-1     Epithelial_cells
                                           ...        
Sample1162EO2_TTTGGAGAGCAGGCAT-1      Epithelial_cells
Sample1162EO2_TTTGGAGAGTCGCGAA-1     Endothelial_cells
Sample1162EO2_TTTGGAGAGTGCTCGC-1           Hepatocytes
Sample1162EO2_TTTGGAGGTGATACTC-1      Epithelial_cells
Sample1162EO2_TTTGGTTCAGTAGAAT-1      Epithelial_cells
Name: singler_annotation, Length: 170064, dtype: string
cell type annotation :  S2008000605HRT_AAACCCAGTGCACATT-1     Epithelial_cells
S2008000605HRT_AAACCCAGTGCCTACG-1     Epithelial_cells
S2008000605HRT_AAAGAACGTAGAGACC-1            Astrocyte
S2008000605HRT_AAAGAACGTCGGAACA-1     Epithelial_cells
S2008000605HRT_AAAGAACGTTAACAGA-1     Epithelial_cells
                                           ...        
Sample1162EO2_TTTGGAGAGCAGGCAT-1      Epithelial_cells
Sample1162EO2_TTTGGAGAGTCGCGAA-1     Endothelial_cells
Sample1162EO2_TTTGGAGAGTGCTCGC-1           Hepatocytes
Sample1162EO2_TTTGGAGGTGATACTC-1      Epithelial_cells
Sample1162EO2_TTTGGTTCAGTAGAAT-1      Epithelial_cells
Name: singler_annotation, Length: 170064, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Epithelial_cells', 'Astrocyte', 'MSC', 'Keratinocytes', 'Neurons', 'Endothelial_cells', 'Fibroblasts', 'Tissue_stem_cells', 'Smooth_muscle_cells', 'T_cells', 'Neuroepithelial_cell', 'NK_cell', 'Chondrocytes', 'Osteoblasts', 'Monocyte', 'Hepatocytes', 'Macrophage', 'CMP', 'Embryonic_stem_cells', 'DC', 'BM & Prog.', 'MEP', 'Neutrophils', 'Pro-Myelocyte', 'iPS_cells', 'Pre-B_cell_CD34-', 'HSC_-G-CSF', 'B_cell', 'BM', 'Platelets', 'GMP', 'HSC_CD34+', 'Pro-B_cell_CD34+', 'Erythroblast', 'Myelocyte', 'Unknown', 'Gametocytes']
라벨별 그룹 개수 {0: 21, 1: 30, 2: 11}
cell type :  S2008000628HRT_AAACCCAAGACGCTCC-1                  DC
S2008000628HRT_AAACCCAAGTAGCCAG-1             T_cells
S2008000628HRT_AAACCCAGTCCAGAAG-1             T_cells
S2008000628HRT_AAACCCAGTGTATCCA-1              B_cell
S2008000628HRT_AAACGAAAGCGTTAGG-1         Fibroblasts
                                           ...       
Sample1162EO1_TTTCACAAGGGCAGAG-1            iPS_cells
Sample1162EO1_TTTCCTCAGCGTGCCT-1          Hepatocytes
Sample1162EO1_TTTCCTCAGTACTGTC-1     Epithelial_cells
Sample1162EO1_TTTGGTTTCCACATAG-1          Hepatocytes
Sample1162EO1_TTTGTTGCACACGCCA-1     Epithelial_cells
Name: singler_annotation, Length: 55113, dtype: string
cell type annotation :  S2008000628HRT_AAACCCAAGACGCTCC-1                  DC
S2008000628HRT_AAACCCAAGTAGCCAG-1             T_cells
S2008000628HRT_AAACCCAGTCCAGAAG-1             T_cells
S2008000628HRT_AAACCCAGTGTATCCA-1              B_cell
S2008000628HRT_AAACGAAAGCGTTAGG-1         Fibroblasts
                                           ...       
Sample1162EO1_TTTCACAAGGGCAGAG-1            iPS_cells
Sample1162EO1_TTTCCTCAGCGTGCCT-1          Hepatocytes
Sample1162EO1_TTTCCTCAGTACTGTC-1     Epithelial_cells
Sample1162EO1_TTTGGTTTCCACATAG-1          Hepatocytes
Sample1162EO1_TTTGTTGCACACGCCA-1     Epithelial_cells
Name: singler_annotation, Length: 55113, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['DC', 'T_cells', 'B_cell', 'Fibroblasts', 'Macrophage', 'Monocyte', 'HSC_-G-CSF', 'Pre-B_cell_CD34-', 'Neutrophils', 'GMP', 'Smooth_muscle_cells', 'MSC', 'NK_cell', 'Epithelial_cells', 'iPS_cells', 'HSC_CD34+', 'Chondrocytes', 'Platelets', 'Pro-B_cell_CD34+', 'Myelocyte', 'Osteoblasts', 'BM', 'Pro-Myelocyte', 'Endothelial_cells', 'Tissue_stem_cells', 'CMP', 'Astrocyte', 'Neurons', 'Embryonic_stem_cells', 'Hepatocytes', 'Neuroepithelial_cell', 'Keratinocytes', 'MEP', 'Erythroblast', 'Unknown', 'BM & Prog.', 'Gametocytes']
라벨별 그룹 개수 {0: 5, 1: 7, 2: 3}
🔍 Split #3
  → train_p_index 환자 수 (환자 단위로 묶인 index list): 62
  → test_p_index 환자 수  (환자 단위로 묶인 index list): 15
  → train 환자 ID: ['163-3', '163-4', '163-5', '164-10', '164-3', '164-6', '165-9', '27-10039', '27-10041', '27-10053', '27-10112', '27-10119', '28-10051', '28-11515', '28-12263', '28-12381', '28-12518', '29-10011', '29-10012', '29-10013', '29-10016', '29-10280', '29-10380', '29-10386', '29-10398', '29-10404', '29-10406', '29-10410', '30-10018', '30-10034', '30-10123', '30-10125', '30-10929', '30-11051', '31-10000', '31-10001', '31-10013', '31-10035', '31-10040', '31-10042', '31-10078', '31-10154', '31-10236', '32-10003', '32-10074', '33-10006', '34-10050', '34-10187', 'PRE018-1', 'PRE027', 'PRE038', 'PRE055-1', 'PRE062-1', 'PRE98sc', 'Sample1153-EO1', 'Sample1153-EO2', 'Sample1153-EO3', 'Sample1157-EO2', 'Sample1157-EO3', 'Sample1158-EO1', 'Sample1158-EO2', 'Sample1162-EO2']
  → test  환자 ID: ['163-2', '27-10071', '28-12490', '29-10006', '29-10008', '29-10010', '29-10400', '31-10210', '32-10034', '33-10005', '34-10184', 'PRE019', 'Sample1157-EO1', 'Sample1158-EO3', 'Sample1162-EO1']
  → train 환자 ID 및 라벨:
    ID: 163-3, Label: 0
    ID: 163-4, Label: 0
    ID: 163-5, Label: 0
    ID: 164-10, Label: 0
    ID: 164-3, Label: 0
    ID: 164-6, Label: 0
    ID: 165-9, Label: 0
    ID: 27-10039, Label: 1
    ID: 27-10041, Label: 1
    ID: 27-10053, Label: 1
    ID: 27-10112, Label: 1
    ID: 27-10119, Label: 1
    ID: 28-10051, Label: 1
    ID: 28-11515, Label: 1
    ID: 28-12263, Label: 1
    ID: 28-12381, Label: 1
    ID: 28-12518, Label: 1
    ID: 29-10011, Label: 1
    ID: 29-10012, Label: 1
    ID: 29-10013, Label: 1
    ID: 29-10016, Label: 1
    ID: 29-10280, Label: 1
    ID: 29-10380, Label: 1
    ID: 29-10386, Label: 1
    ID: 29-10398, Label: 1
    ID: 29-10404, Label: 1
    ID: 29-10406, Label: 1
    ID: 29-10410, Label: 1
    ID: 30-10018, Label: 2
    ID: 30-10034, Label: 2
    ID: 30-10123, Label: 2
    ID: 30-10125, Label: 2
    ID: 30-10929, Label: 2
    ID: 30-11051, Label: 2
    ID: 31-10000, Label: 1
    ID: 31-10001, Label: 1
    ID: 31-10013, Label: 1
    ID: 31-10035, Label: 1
    ID: 31-10040, Label: 1
    ID: 31-10042, Label: 1
    ID: 31-10078, Label: 1
    ID: 31-10154, Label: 1
    ID: 31-10236, Label: 1
    ID: 32-10003, Label: 2
    ID: 32-10074, Label: 2
    ID: 33-10006, Label: 2
    ID: 34-10050, Label: 2
    ID: 34-10187, Label: 2
    ID: PRE018-1, Label: 0
    ID: PRE027, Label: 0
    ID: PRE038, Label: 0
    ID: PRE055-1, Label: 0
    ID: PRE062-1, Label: 0
    ID: PRE98sc, Label: 0
    ID: Sample1153-EO1, Label: 0
    ID: Sample1153-EO2, Label: 0
    ID: Sample1153-EO3, Label: 0
    ID: Sample1157-EO2, Label: 0
    ID: Sample1157-EO3, Label: 0
    ID: Sample1158-EO1, Label: 0
    ID: Sample1158-EO2, Label: 0
    ID: Sample1162-EO2, Label: 0
  → test 환자 ID 및 라벨:
    ID: 163-2, Label: 0
    ID: 27-10071, Label: 1
    ID: 28-12490, Label: 1
    ID: 29-10006, Label: 1
    ID: 29-10008, Label: 1
    ID: 29-10010, Label: 1
    ID: 29-10400, Label: 1
    ID: 31-10210, Label: 1
    ID: 32-10034, Label: 2
    ID: 33-10005, Label: 2
    ID: 34-10184, Label: 2
    ID: PRE019, Label: 0
    ID: Sample1157-EO1, Label: 0
    ID: Sample1158-EO3, Label: 0
    ID: Sample1162-EO1, Label: 0
전체 데이터 index 길이 77
label_stat (train 환자 라벨 목록) 갯수 62
train_data에서 환자 단위로, train과 validation 나누기
기존 train_p_index 62
기존 (train) label_stat 62
train-vali 분할 후! 
train y 의 classes : {0, 1, 2} valid y 의 classes : {0, 1, 2} label_stat 의 classes : {0, 1, 2}
train_p_index_ 41
valid_p_index 21
test_p_index 15
→ train 환자 ID 및 라벨:
   총 개수: 41
   환자ID=29-10280, Label=1, 셀개수=2375
   환자ID=31-10040, Label=1, 셀개수=4543
   환자ID=34-10050, Label=2, 셀개수=4784
   환자ID=31-10154, Label=1, 셀개수=6568
   환자ID=Sample1157-EO3, Label=0, 셀개수=807
   환자ID=164-10, Label=0, 셀개수=4041
   환자ID=29-10011, Label=1, 셀개수=3072
   환자ID=PRE038, Label=0, 셀개수=2666
   환자ID=30-11051, Label=2, 셀개수=2454
   환자ID=30-10125, Label=2, 셀개수=3798
   환자ID=163-4, Label=0, 셀개수=1339
   환자ID=27-10119, Label=1, 셀개수=3346
   환자ID=165-9, Label=0, 셀개수=2926
   환자ID=27-10039, Label=1, 셀개수=4638
   환자ID=163-3, Label=0, 셀개수=1335
   환자ID=30-10018, Label=2, 셀개수=5170
   환자ID=31-10001, Label=1, 셀개수=1133
   환자ID=30-10123, Label=2, 셀개수=1273
   환자ID=Sample1158-EO1, Label=0, 셀개수=574
   환자ID=29-10386, Label=1, 셀개수=802
   환자ID=31-10000, Label=1, 셀개수=8870
   환자ID=163-5, Label=0, 셀개수=1210
   환자ID=31-10078, Label=1, 셀개수=2827
   환자ID=PRE062-1, Label=0, 셀개수=907
   환자ID=29-10406, Label=1, 셀개수=3484
   환자ID=28-11515, Label=1, 셀개수=930
   환자ID=Sample1158-EO2, Label=0, 셀개수=1427
   환자ID=31-10013, Label=1, 셀개수=3161
   환자ID=34-10187, Label=2, 셀개수=3739
   환자ID=27-10112, Label=1, 셀개수=1470
   환자ID=28-12518, Label=1, 셀개수=1215
   환자ID=28-10051, Label=1, 셀개수=300
   환자ID=164-6, Label=0, 셀개수=3038
   환자ID=29-10404, Label=1, 셀개수=3988
   환자ID=33-10006, Label=2, 셀개수=457
   환자ID=29-10380, Label=1, 셀개수=4799
   환자ID=32-10003, Label=2, 셀개수=2978
   환자ID=31-10236, Label=1, 셀개수=3458
   환자ID=31-10042, Label=1, 셀개수=1222
   환자ID=29-10016, Label=1, 셀개수=4854
   환자ID=28-12381, Label=1, 셀개수=1099
→ valid 환자 ID 및 라벨:
   총 개수: 21
   환자ID=Sample1162-EO2, Label=0, 셀개수=1510
   환자ID=29-10013, Label=1, 셀개수=3706
   환자ID=31-10035, Label=1, 셀개수=2974
   환자ID=PRE98sc, Label=0, 셀개수=1568
   환자ID=32-10074, Label=2, 셀개수=6304
   환자ID=PRE055-1, Label=0, 셀개수=597
   환자ID=Sample1153-EO3, Label=0, 셀개수=1516
   환자ID=30-10034, Label=2, 셀개수=1240
   환자ID=30-10929, Label=2, 셀개수=5812
   환자ID=29-10410, Label=1, 셀개수=2834
   환자ID=Sample1157-EO2, Label=0, 셀개수=1395
   환자ID=27-10053, Label=1, 셀개수=728
   환자ID=29-10398, Label=1, 셀개수=3993
   환자ID=Sample1153-EO1, Label=0, 셀개수=911
   환자ID=PRE027, Label=0, 셀개수=2078
   환자ID=PRE018-1, Label=0, 셀개수=1349
   환자ID=164-3, Label=0, 셀개수=1639
   환자ID=29-10012, Label=1, 셀개수=6245
   환자ID=27-10041, Label=1, 셀개수=2145
   환자ID=28-12263, Label=1, 셀개수=7527
   환자ID=Sample1153-EO2, Label=0, 셀개수=916
→ test 환자 ID 및 라벨:
   총 개수: 15
   환자ID=163-2, Label=0, 셀개수=2535
   환자ID=27-10071, Label=1, 셀개수=1478
   환자ID=28-12490, Label=1, 셀개수=5973
   환자ID=29-10006, Label=1, 셀개수=11461
   환자ID=29-10008, Label=1, 셀개수=1913
   환자ID=29-10010, Label=1, 셀개수=5305
   환자ID=29-10400, Label=1, 셀개수=2684
   환자ID=31-10210, Label=1, 셀개수=3510
   환자ID=32-10034, Label=2, 셀개수=1555
   환자ID=33-10005, Label=2, 셀개수=8904
   환자ID=34-10184, Label=2, 셀개수=2699
   환자ID=PRE019, Label=0, 셀개수=3795
   환자ID=Sample1157-EO1, Label=0, 셀개수=1152
   환자ID=Sample1158-EO3, Label=0, 셀개수=1096
   환자ID=Sample1162-EO1, Label=0, 셀개수=1053
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Epithelial_cells', 'Epithelial_cells', 'Astrocyte', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'MSC', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
전체 데이터 길이 225177
전체 cell type 길이 0         Epithelial_cells
1         Epithelial_cells
2                Astrocyte
3         Epithelial_cells
4         Epithelial_cells
                ...       
225172           iPS_cells
225173         Hepatocytes
225174    Epithelial_cells
225175         Hepatocytes
225176    Epithelial_cells
Length: 225177, dtype: string
cell type의 NaN 개수 체크 0
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:11,  8.89it/s]  2%|▏         | 2/100 [00:00<00:23,  4.08it/s]  3%|▎         | 3/100 [00:00<00:17,  5.50it/s]  4%|▍         | 4/100 [00:00<00:14,  6.50it/s]  5%|▌         | 5/100 [00:00<00:13,  7.24it/s]  6%|▌         | 6/100 [00:00<00:12,  7.72it/s]  7%|▋         | 7/100 [00:01<00:11,  8.06it/s]  8%|▊         | 8/100 [00:01<00:10,  8.39it/s]  9%|▉         | 9/100 [00:01<00:10,  8.83it/s] 10%|█         | 10/100 [00:01<00:10,  8.29it/s] 11%|█         | 11/100 [00:01<00:10,  8.45it/s] 12%|█▏        | 12/100 [00:01<00:09,  8.84it/s] 13%|█▎        | 13/100 [00:01<00:10,  8.67it/s] 14%|█▍        | 14/100 [00:01<00:09,  8.67it/s] 15%|█▌        | 15/100 [00:01<00:09,  8.75it/s] 16%|█▌        | 16/100 [00:02<00:09,  8.92it/s] 17%|█▋        | 17/100 [00:02<00:10,  8.12it/s] 18%|█▊        | 18/100 [00:02<00:12,  6.49it/s] 19%|█▉        | 19/100 [00:02<00:11,  7.25it/s] 20%|██        | 20/100 [00:02<00:10,  7.58it/s] 21%|██        | 21/100 [00:02<00:09,  7.96it/s] 22%|██▏       | 22/100 [00:02<00:09,  8.42it/s] 23%|██▎       | 23/100 [00:02<00:09,  8.32it/s] 24%|██▍       | 24/100 [00:03<00:08,  8.65it/s] 25%|██▌       | 25/100 [00:03<00:08,  8.60it/s] 26%|██▌       | 26/100 [00:03<00:08,  8.66it/s] 27%|██▋       | 27/100 [00:03<00:08,  8.72it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.75it/s] 29%|██▉       | 29/100 [00:03<00:08,  8.12it/s] 30%|███       | 30/100 [00:03<00:08,  8.21it/s] 31%|███       | 31/100 [00:03<00:08,  8.40it/s] 32%|███▏      | 32/100 [00:04<00:08,  8.38it/s] 33%|███▎      | 33/100 [00:04<00:07,  8.45it/s] 34%|███▍      | 34/100 [00:04<00:07,  8.56it/s] 35%|███▌      | 35/100 [00:04<00:07,  8.60it/s] 36%|███▌      | 36/100 [00:04<00:07,  8.56it/s] 37%|███▋      | 37/100 [00:04<00:07,  8.62it/s] 38%|███▊      | 38/100 [00:04<00:07,  8.73it/s] 39%|███▉      | 39/100 [00:04<00:07,  8.66it/s] 40%|████      | 40/100 [00:04<00:06,  8.68it/s] 41%|████      | 41/100 [00:05<00:06,  8.73it/s] 42%|████▏     | 42/100 [00:05<00:06,  8.65it/s] 43%|████▎     | 43/100 [00:05<00:06,  8.35it/s] 44%|████▍     | 44/100 [00:05<00:06,  8.39it/s] 45%|████▌     | 45/100 [00:05<00:06,  8.45it/s] 46%|████▌     | 46/100 [00:05<00:06,  8.60it/s] 47%|████▋     | 47/100 [00:05<00:06,  7.63it/s] 48%|████▊     | 48/100 [00:05<00:06,  7.88it/s] 49%|████▉     | 49/100 [00:06<00:06,  8.00it/s] 50%|█████     | 50/100 [00:06<00:06,  8.06it/s] 51%|█████     | 51/100 [00:06<00:05,  8.20it/s] 52%|█████▏    | 52/100 [00:06<00:05,  8.25it/s] 53%|█████▎    | 53/100 [00:06<00:05,  8.19it/s] 54%|█████▍    | 54/100 [00:06<00:06,  7.65it/s] 55%|█████▌    | 55/100 [00:06<00:05,  7.62it/s] 56%|█████▌    | 56/100 [00:06<00:05,  7.35it/s] 57%|█████▋    | 57/100 [00:07<00:05,  7.42it/s] 58%|█████▊    | 58/100 [00:07<00:05,  7.75it/s] 59%|█████▉    | 59/100 [00:07<00:05,  8.13it/s] 60%|██████    | 60/100 [00:07<00:04,  8.30it/s] 61%|██████    | 61/100 [00:07<00:04,  8.09it/s] 62%|██████▏   | 62/100 [00:07<00:04,  7.98it/s] 63%|██████▎   | 63/100 [00:07<00:04,  8.00it/s] 64%|██████▍   | 64/100 [00:07<00:04,  8.17it/s] 65%|██████▌   | 65/100 [00:08<00:04,  8.10it/s] 66%|██████▌   | 66/100 [00:08<00:04,  8.25it/s] 67%|██████▋   | 67/100 [00:08<00:04,  8.20it/s] 68%|██████▊   | 68/100 [00:08<00:03,  8.33it/s] 69%|██████▉   | 69/100 [00:08<00:04,  6.75it/s] 70%|███████   | 70/100 [00:08<00:04,  7.20it/s] 71%|███████   | 71/100 [00:08<00:03,  7.60it/s] 72%|███████▏  | 72/100 [00:08<00:03,  7.77it/s] 73%|███████▎  | 73/100 [00:09<00:03,  7.82it/s] 74%|███████▍  | 74/100 [00:09<00:03,  6.74it/s] 75%|███████▌  | 75/100 [00:09<00:03,  7.16it/s] 76%|███████▌  | 76/100 [00:09<00:03,  7.49it/s] 77%|███████▋  | 77/100 [00:09<00:03,  7.57it/s] 78%|███████▊  | 78/100 [00:09<00:02,  7.77it/s] 79%|███████▉  | 79/100 [00:09<00:02,  8.20it/s] 80%|████████  | 80/100 [00:10<00:02,  8.22it/s] 81%|████████  | 81/100 [00:10<00:02,  7.93it/s] 82%|████████▏ | 82/100 [00:10<00:02,  8.10it/s] 83%|████████▎ | 83/100 [00:10<00:02,  8.31it/s] 84%|████████▍ | 84/100 [00:10<00:01,  8.30it/s] 85%|████████▌ | 85/100 [00:10<00:01,  8.27it/s] 86%|████████▌ | 86/100 [00:10<00:01,  8.08it/s] 87%|████████▋ | 87/100 [00:10<00:01,  7.79it/s] 88%|████████▊ | 88/100 [00:11<00:01,  7.77it/s] 89%|████████▉ | 89/100 [00:11<00:01,  7.45it/s] 90%|█████████ | 90/100 [00:11<00:01,  7.72it/s] 91%|█████████ | 91/100 [00:11<00:01,  7.72it/s] 92%|█████████▏| 92/100 [00:11<00:01,  7.89it/s] 93%|█████████▎| 93/100 [00:11<00:00,  7.81it/s] 94%|█████████▍| 94/100 [00:11<00:00,  7.72it/s] 95%|█████████▌| 95/100 [00:11<00:00,  7.82it/s] 96%|█████████▌| 96/100 [00:12<00:00,  7.44it/s] 97%|█████████▋| 97/100 [00:12<00:00,  7.53it/s] 98%|█████████▊| 98/100 [00:12<00:00,  7.66it/s] 99%|█████████▉| 99/100 [00:12<00:00,  7.62it/s]100%|██████████| 100/100 [00:12<00:00,  7.76it/s]100%|██████████| 100/100 [00:12<00:00,  7.95it/s]
[I 2025-08-31 04:00:00,988] A new study created in memory with name: no-name-8f860b12-d973-4786-840b-f2106c4e84b3
👉 train samples(학습 샘플(bag))=141, batch_size=16 -> steps(샘플수/batch크기)=9
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 26.13 MB
Memory Reserved: 36.00 MB
cuda
CUDA OOM 발생 — 단계적 백오프 시작.
[OOM RETRY] batch_size 16 → 8 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=141, batch_size=8 -> steps(샘플수/batch크기)=18
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 1654.03 MB
Memory Reserved: 1664.00 MB
cuda
Epoch 1, Train Loss 0.952714, Valid_loss 1.164979
Epoch 2, Train Loss 0.906922, Valid_loss 1.091521
Epoch 3, Train Loss 0.898126, Valid_loss 1.097403
Epoch 4, Train Loss 0.880229, Valid_loss 1.065644
Epoch 5, Train Loss 0.901220, Valid_loss 1.063317
Epoch 6, Train Loss 0.897038, Valid_loss 1.133134
Epoch 7, Train Loss 0.873075, Valid_loss 1.095919
Epoch 8, Train Loss 0.909895, Valid_loss 1.111326
Epoch 9, Train Loss 0.888687, Valid_loss 1.067272
Epoch 10, Train Loss 0.877869, Valid_loss 1.136253
Epoch 11, Train Loss 0.882327, Valid_loss 1.100270
Epoch 12, Train Loss 0.908782, Valid_loss 1.101896
Epoch 13, Train Loss 0.885472, Valid_loss 1.081226
Epoch 14, Train Loss 0.901300, Valid_loss 1.126830
Epoch 15, Train Loss 0.889758, Valid_loss 1.103082
Epoch 16, Train Loss 0.887348, Valid_loss 1.117162
Epoch 17, Train Loss 0.881520, Valid_loss 1.108382
Epoch 18, Train Loss 0.890177, Valid_loss 1.127559
Epoch 19, Train Loss 0.892139, Valid_loss 1.127886
Epoch 20, Train Loss 0.877405, Valid_loss 1.105857
Epoch 21, Train Loss 0.861384, Valid_loss 1.165776
Epoch 22, Train Loss 0.885135, Valid_loss 1.088964
Epoch 23, Train Loss 0.880189, Valid_loss 1.130352
Epoch 24, Train Loss 0.895260, Valid_loss 1.154188
Epoch 25, Train Loss 0.889828, Valid_loss 1.071885
Epoch 26, Train Loss 0.873514, Valid_loss 1.134872
Epoch 27, Train Loss 0.882740, Valid_loss 1.100213
Epoch 28, Train Loss 0.897827, Valid_loss 1.128634
Epoch 29, Train Loss 0.883113, Valid_loss 1.131286
Epoch 30, Train Loss 0.868969, Valid_loss 1.126878
Epoch 31, Train Loss 0.872612, Valid_loss 1.203530
Epoch 32, Train Loss 0.872875, Valid_loss 1.123587
Epoch 33, Train Loss 0.871011, Valid_loss 1.105559
Epoch 34, Train Loss 0.871575, Valid_loss 1.162454
Epoch 35, Train Loss 0.868455, Valid_loss 1.148071
Epoch 36, Train Loss 0.877160, Valid_loss 1.119402
Epoch 37, Train Loss 0.891718, Valid_loss 1.162892
Epoch 38, Train Loss 0.876744, Valid_loss 1.085783
Epoch 39, Train Loss 0.865753, Valid_loss 1.217223
Epoch 40, Train Loss 0.881930, Valid_loss 1.140618
Epoch 41, Train Loss 0.873734, Valid_loss 1.076165
Epoch 42, Train Loss 0.862122, Valid_loss 1.144520
Epoch 43, Train Loss 0.876527, Valid_loss 1.156760
Epoch 44, Train Loss 0.877112, Valid_loss 1.185136
Epoch 45, Train Loss 0.890441, Valid_loss 1.116696
Epoch 46, Train Loss 0.870936, Valid_loss 1.129913
Epoch 47, Train Loss 0.872264, Valid_loss 1.152219
Epoch 48, Train Loss 0.885204, Valid_loss 1.167651
Epoch 49, Train Loss 0.866719, Valid_loss 1.145279
Epoch 50, Train Loss 0.878760, Valid_loss 1.187020
Epoch 51, Train Loss 0.861227, Valid_loss 1.170396
Epoch 52, Train Loss 0.868381, Valid_loss 1.194511
Epoch 53, Train Loss 0.870196, Valid_loss 1.192638
Epoch 54, Train Loss 0.868440, Valid_loss 1.199718
Epoch 55, Train Loss 0.848235, Valid_loss 1.234296
[I 2025-08-31 04:11:00,402] Trial 0 finished with value: 1.0633172988891602 and parameters: {'learning_rate': 0.01, 'epochs': 100, 'heads': 4, 'dropout': 0.3, 'weight_decay': 0.001, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 1.0633172988891602.
👉 train samples(학습 샘플(bag))=141, batch_size=16 -> steps(샘플수/batch크기)=9
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 1655.87 MB
Memory Reserved: 1664.00 MB
cuda
Epoch 1, Train Loss 0.984380, Valid_loss 1.229869
Epoch 2, Train Loss 0.949368, Valid_loss 1.074058
Epoch 3, Train Loss 0.949057, Valid_loss 1.095660
Epoch 4, Train Loss 0.898400, Valid_loss 1.044561
Epoch 5, Train Loss 0.897127, Valid_loss 1.077315
Epoch 6, Train Loss 0.896010, Valid_loss 1.081040
Epoch 7, Train Loss 0.931005, Valid_loss 1.159524
Epoch 8, Train Loss 0.897112, Valid_loss 1.097443
Epoch 9, Train Loss 0.909046, Valid_loss 1.074177
Epoch 10, Train Loss 0.878650, Valid_loss 1.088278
Epoch 11, Train Loss 0.900316, Valid_loss 1.058228
Epoch 12, Train Loss 0.860693, Valid_loss 1.089585
Epoch 13, Train Loss 0.914158, Valid_loss 1.108100
Epoch 14, Train Loss 0.889024, Valid_loss 1.101468
Epoch 15, Train Loss 0.889361, Valid_loss 1.142532
Epoch 16, Train Loss 0.888429, Valid_loss 1.096754
Epoch 17, Train Loss 0.885784, Valid_loss 1.068043
Epoch 18, Train Loss 0.922642, Valid_loss 1.106547
Epoch 19, Train Loss 0.895655, Valid_loss 1.089381
Epoch 20, Train Loss 0.889114, Valid_loss 1.096869
Epoch 21, Train Loss 0.874990, Valid_loss 1.111957
Epoch 22, Train Loss 0.902624, Valid_loss 1.147569
Epoch 23, Train Loss 0.902982, Valid_loss 1.052228
Epoch 24, Train Loss 0.890140, Valid_loss 1.092977
Epoch 25, Train Loss 0.888360, Valid_loss 1.126703
Epoch 26, Train Loss 0.882408, Valid_loss 1.097405
Epoch 27, Train Loss 0.877980, Valid_loss 1.087681
Epoch 28, Train Loss 0.876037, Valid_loss 1.121835
Epoch 29, Train Loss 0.911305, Valid_loss 1.070440
Epoch 30, Train Loss 0.901795, Valid_loss 1.102803
Epoch 31, Train Loss 0.869432, Valid_loss 1.128573
Epoch 32, Train Loss 0.887391, Valid_loss 1.096912
Epoch 33, Train Loss 0.870432, Valid_loss 1.118849
Epoch 34, Train Loss 0.878026, Valid_loss 1.115185
Epoch 35, Train Loss 0.917390, Valid_loss 1.108423
Epoch 36, Train Loss 0.896848, Valid_loss 1.109573
Epoch 37, Train Loss 0.905432, Valid_loss 1.088340
Epoch 38, Train Loss 0.898226, Valid_loss 1.045923
Epoch 39, Train Loss 0.883395, Valid_loss 1.163289
Epoch 40, Train Loss 0.869443, Valid_loss 1.134312
Epoch 41, Train Loss 0.889484, Valid_loss 1.095383
Epoch 42, Train Loss 0.878080, Valid_loss 1.096315
Epoch 43, Train Loss 0.885194, Valid_loss 1.111630
Epoch 44, Train Loss 0.874344, Valid_loss 1.110645
Epoch 45, Train Loss 0.885803, Valid_loss 1.101499
Epoch 46, Train Loss 0.888456, Valid_loss 1.097282
Epoch 47, Train Loss 0.885886, Valid_loss 1.084656
Epoch 48, Train Loss 0.875307, Valid_loss 1.103916
Epoch 49, Train Loss 0.884848, Valid_loss 1.101588
Epoch 50, Train Loss 0.862407, Valid_loss 1.125187
Epoch 51, Train Loss 0.890494, Valid_loss 1.143408
Epoch 52, Train Loss 0.880366, Valid_loss 1.099764
Epoch 53, Train Loss 0.891333, Valid_loss 1.108383
Epoch 54, Train Loss 0.863203, Valid_loss 1.121700
[I 2025-08-31 04:17:01,927] Trial 1 finished with value: 1.0445613037972223 and parameters: {'learning_rate': 0.01, 'epochs': 100, 'heads': 1, 'dropout': 0.5, 'weight_decay': 0.0001, 'emb_dim': 64, 'augment_num': 100, 'pca': False}. Best is trial 1 with value: 1.0445613037972223.
👉 train samples(학습 샘플(bag))=141, batch_size=16 -> steps(샘플수/batch크기)=9
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 1652.71 MB
Memory Reserved: 1664.00 MB
cuda
Epoch 1, Train Loss 0.910096, Valid_loss 1.088297
Epoch 2, Train Loss 0.868974, Valid_loss 1.058676
Epoch 3, Train Loss 0.843404, Valid_loss 0.958702
Epoch 4, Train Loss 0.794095, Valid_loss 0.914453
Epoch 5, Train Loss 0.754636, Valid_loss 0.773745
Epoch 6, Train Loss 0.740870, Valid_loss 0.741777
Epoch 7, Train Loss 0.559095, Valid_loss 0.706270
Epoch 8, Train Loss 0.516512, Valid_loss 0.670040
Epoch 9, Train Loss 0.497261, Valid_loss 0.640373
Epoch 10, Train Loss 0.543270, Valid_loss 0.527240
Epoch 11, Train Loss 0.393813, Valid_loss 0.421347
Epoch 12, Train Loss 0.389075, Valid_loss 0.399985
Epoch 13, Train Loss 0.401357, Valid_loss 0.440272
Epoch 14, Train Loss 0.414941, Valid_loss 0.829166
Epoch 15, Train Loss 0.552692, Valid_loss 0.892789
Epoch 16, Train Loss 0.529172, Valid_loss 0.396273
Epoch 17, Train Loss 0.464851, Valid_loss 0.422753
Epoch 18, Train Loss 0.376621, Valid_loss 0.569026
Epoch 19, Train Loss 0.422269, Valid_loss 0.408336
Epoch 20, Train Loss 0.352851, Valid_loss 0.723753
Epoch 21, Train Loss 0.307239, Valid_loss 1.062516
Epoch 22, Train Loss 0.374849, Valid_loss 0.393725
Epoch 23, Train Loss 0.374395, Valid_loss 0.515993
Epoch 24, Train Loss 0.328713, Valid_loss 0.495983
Epoch 25, Train Loss 0.296686, Valid_loss 0.495659
Epoch 26, Train Loss 0.286063, Valid_loss 0.428104
Epoch 27, Train Loss 0.263819, Valid_loss 0.777244
Epoch 28, Train Loss 0.266273, Valid_loss 0.551916
Epoch 29, Train Loss 0.228971, Valid_loss 0.527342
Epoch 30, Train Loss 0.198812, Valid_loss 0.345736
Epoch 31, Train Loss 0.200078, Valid_loss 0.772722
Epoch 32, Train Loss 0.242445, Valid_loss 0.363294
Epoch 33, Train Loss 0.212173, Valid_loss 0.444810
Epoch 34, Train Loss 0.272558, Valid_loss 0.315013
Epoch 35, Train Loss 0.183931, Valid_loss 0.654081
Epoch 36, Train Loss 0.154683, Valid_loss 0.648783
Epoch 37, Train Loss 0.139466, Valid_loss 0.534645
Epoch 38, Train Loss 0.196915, Valid_loss 0.449927
Epoch 39, Train Loss 0.141632, Valid_loss 0.855606
Epoch 40, Train Loss 0.132681, Valid_loss 0.474972
Epoch 41, Train Loss 0.126557, Valid_loss 0.476012
Epoch 42, Train Loss 0.178355, Valid_loss 0.967278
Epoch 43, Train Loss 0.243008, Valid_loss 0.992964
Epoch 44, Train Loss 0.249710, Valid_loss 0.674957
Epoch 45, Train Loss 0.166733, Valid_loss 0.934753
Epoch 46, Train Loss 0.153734, Valid_loss 0.895313
Epoch 47, Train Loss 0.106592, Valid_loss 0.710961
Epoch 48, Train Loss 0.128752, Valid_loss 0.653714
Epoch 49, Train Loss 0.095749, Valid_loss 0.896185
Epoch 50, Train Loss 0.127633, Valid_loss 0.530837
Epoch 51, Train Loss 0.137228, Valid_loss 1.105401
Epoch 52, Train Loss 0.091840, Valid_loss 0.711910
Epoch 53, Train Loss 0.086924, Valid_loss 0.953337
Epoch 54, Train Loss 0.070515, Valid_loss 0.999474
[I 2025-08-31 04:22:51,563] Trial 2 finished with value: 0.31501268032228663 and parameters: {'learning_rate': 0.01, 'epochs': 100, 'heads': 1, 'dropout': 0.0, 'weight_decay': 0.001, 'emb_dim': 8, 'augment_num': 100, 'pca': False}. Best is trial 2 with value: 0.31501268032228663.
선택된 trial params: {'learning_rate': 0.01, 'epochs': 100, 'heads': 1, 'dropout': 0.0, 'weight_decay': 0.001, 'emb_dim': 8, 'augment_num': 100, 'pca': False}
👉 train samples(학습 샘플(bag))=141, batch_size=16 -> steps(샘플수/batch크기)=9
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=15, batch_size=1 -> steps=15
Memory Allocated: 1652.71 MB
Memory Reserved: 1664.00 MB
cuda
Epoch 1, Train Loss 0.900880, Valid_loss 1.122272
Epoch 2, Train Loss 0.891296, Valid_loss 1.063753
Epoch 3, Train Loss 0.881944, Valid_loss 1.081627
Epoch 4, Train Loss 0.870505, Valid_loss 1.106013
Epoch 5, Train Loss 0.883412, Valid_loss 1.119082
Epoch 6, Train Loss 0.875710, Valid_loss 1.091308
Epoch 7, Train Loss 0.874089, Valid_loss 1.064793
Epoch 8, Train Loss 0.869972, Valid_loss 1.101051
Epoch 9, Train Loss 0.858241, Valid_loss 1.068656
Epoch 10, Train Loss 0.879934, Valid_loss 1.067344
Epoch 11, Train Loss 0.881106, Valid_loss 1.105758
Epoch 12, Train Loss 0.835615, Valid_loss 1.069463
Epoch 13, Train Loss 0.775789, Valid_loss 0.800408
Epoch 14, Train Loss 0.672691, Valid_loss 0.820645
Epoch 15, Train Loss 0.612812, Valid_loss 0.882435
Epoch 16, Train Loss 0.611524, Valid_loss 0.951142
Epoch 17, Train Loss 0.585617, Valid_loss 0.669434
Epoch 18, Train Loss 0.471552, Valid_loss 0.641925
Epoch 19, Train Loss 0.428507, Valid_loss 1.056927
Epoch 20, Train Loss 0.443282, Valid_loss 0.915464
Epoch 21, Train Loss 0.439524, Valid_loss 1.095764
Epoch 22, Train Loss 0.451062, Valid_loss 0.642998
Epoch 23, Train Loss 0.428326, Valid_loss 0.535102
Epoch 24, Train Loss 0.382031, Valid_loss 0.498499
Epoch 25, Train Loss 0.366280, Valid_loss 0.389332
Epoch 26, Train Loss 0.346333, Valid_loss 0.564354
Epoch 27, Train Loss 0.385898, Valid_loss 0.931462
Epoch 28, Train Loss 0.404298, Valid_loss 0.593947
Epoch 29, Train Loss 0.445688, Valid_loss 0.948293
Epoch 30, Train Loss 0.374248, Valid_loss 0.794797
Epoch 31, Train Loss 0.338029, Valid_loss 0.592117
Epoch 32, Train Loss 0.633698, Valid_loss 0.608023
Epoch 33, Train Loss 0.461219, Valid_loss 0.590496
Epoch 34, Train Loss 0.396580, Valid_loss 0.451307
Epoch 35, Train Loss 0.459257, Valid_loss 0.963475
Epoch 36, Train Loss 0.406702, Valid_loss 0.461041
Epoch 37, Train Loss 0.352774, Valid_loss 0.388249
Epoch 38, Train Loss 0.341525, Valid_loss 0.454573
Epoch 39, Train Loss 0.273773, Valid_loss 0.605036
Epoch 40, Train Loss 0.249902, Valid_loss 0.551011
Epoch 41, Train Loss 0.249705, Valid_loss 0.461910
Epoch 42, Train Loss 0.431507, Valid_loss 0.697538
Epoch 43, Train Loss 0.274944, Valid_loss 0.550805
Epoch 44, Train Loss 0.308833, Valid_loss 1.015592
Epoch 45, Train Loss 0.242701, Valid_loss 0.751587
Epoch 46, Train Loss 0.215109, Valid_loss 0.380680
Epoch 47, Train Loss 0.278701, Valid_loss 0.701249
Epoch 48, Train Loss 0.286841, Valid_loss 1.277330
Epoch 49, Train Loss 0.276785, Valid_loss 0.488824
Epoch 50, Train Loss 0.223601, Valid_loss 0.738663
Epoch 51, Train Loss 0.200267, Valid_loss 0.777836
Epoch 52, Train Loss 0.175090, Valid_loss 0.708815
Epoch 53, Train Loss 0.150321, Valid_loss 0.961828
Epoch 54, Train Loss 0.144608, Valid_loss 1.067268
환자ID=163-2 -- true: [[0]] -- pred: tensor([[ 3.0101, -1.0379, -5.4807]], device='cuda:0')
환자ID=27-10071 -- true: [[1]] -- pred: tensor([[-2.6358,  1.3920, -0.0085]], device='cuda:0')
환자ID=28-12490 -- true: [[1]] -- pred: tensor([[-2.1056,  1.7160, -1.0750]], device='cuda:0')
환자ID=29-10006 -- true: [[1]] -- pred: tensor([[-2.4855,  1.4885, -0.3325]], device='cuda:0')
환자ID=29-10008 -- true: [[1]] -- pred: tensor([[-2.8752,  1.1303,  0.6264]], device='cuda:0')
환자ID=29-10010 -- true: [[1]] -- pred: tensor([[-2.0196,  1.7348, -1.2173]], device='cuda:0')
환자ID=29-10400 -- true: [[1]] -- pred: tensor([[-2.5527,  1.4426, -0.1872]], device='cuda:0')
환자ID=31-10210 -- true: [[1]] -- pred: tensor([[ 0.7291,  1.1363, -4.2249]], device='cuda:0')
환자ID=32-10034 -- true: [[2]] -- pred: tensor([[-1.9073,  1.8269, -1.4240]], device='cuda:0')
환자ID=33-10005 -- true: [[2]] -- pred: tensor([[-2.1086,  1.7013, -1.0675]], device='cuda:0')
환자ID=34-10184 -- true: [[2]] -- pred: tensor([[-2.2678,  1.6335, -0.7754]], device='cuda:0')
환자ID=PRE019 -- true: [[0]] -- pred: tensor([[ 2.2831, -0.2421, -5.1685]], device='cuda:0')
환자ID=Sample1157-EO1 -- true: [[0]] -- pred: tensor([[ 3.0410, -0.9970, -5.4812]], device='cuda:0')
환자ID=Sample1158-EO3 -- true: [[0]] -- pred: tensor([[ 0.0833,  1.6073, -3.7002]], device='cuda:0')
환자ID=Sample1162-EO1 -- true: [[0]] -- pred: tensor([[ 3.1956, -1.2481, -5.5322]], device='cuda:0')
Best performance: Epoch 46, Loss 0.215109, Test ACC 0.733333, Test AUC 0.734921, Test Recall 0.600000, Test Precision 0.545455
Confusion Matrix:
 [[4 1 0]
 [0 7 0]
 [0 3 0]]
✅ Total valid splits used: 3
🔁 Repeat 1, Fold 3
cell type :  S2008000628HRT_AAACCCAAGACGCTCC-1                   DC
S2008000628HRT_AAACCCAAGTAGCCAG-1              T_cells
S2008000628HRT_AAACCCAGTCCAGAAG-1              T_cells
S2008000628HRT_AAACCCAGTGTATCCA-1               B_cell
S2008000628HRT_AAACGAAAGCGTTAGG-1          Fibroblasts
                                           ...        
Sample1162EO2_TTTGGAGAGCAGGCAT-1      Epithelial_cells
Sample1162EO2_TTTGGAGAGTCGCGAA-1     Endothelial_cells
Sample1162EO2_TTTGGAGAGTGCTCGC-1           Hepatocytes
Sample1162EO2_TTTGGAGGTGATACTC-1      Epithelial_cells
Sample1162EO2_TTTGGTTCAGTAGAAT-1      Epithelial_cells
Name: singler_annotation, Length: 174296, dtype: string
cell type annotation :  S2008000628HRT_AAACCCAAGACGCTCC-1                   DC
S2008000628HRT_AAACCCAAGTAGCCAG-1              T_cells
S2008000628HRT_AAACCCAGTCCAGAAG-1              T_cells
S2008000628HRT_AAACCCAGTGTATCCA-1               B_cell
S2008000628HRT_AAACGAAAGCGTTAGG-1          Fibroblasts
                                           ...        
Sample1162EO2_TTTGGAGAGCAGGCAT-1      Epithelial_cells
Sample1162EO2_TTTGGAGAGTCGCGAA-1     Endothelial_cells
Sample1162EO2_TTTGGAGAGTGCTCGC-1           Hepatocytes
Sample1162EO2_TTTGGAGGTGATACTC-1      Epithelial_cells
Sample1162EO2_TTTGGTTCAGTAGAAT-1      Epithelial_cells
Name: singler_annotation, Length: 174296, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['DC', 'T_cells', 'B_cell', 'Fibroblasts', 'Macrophage', 'Monocyte', 'HSC_-G-CSF', 'Pre-B_cell_CD34-', 'Neutrophils', 'GMP', 'Smooth_muscle_cells', 'MSC', 'NK_cell', 'Epithelial_cells', 'iPS_cells', 'HSC_CD34+', 'Chondrocytes', 'Platelets', 'Pro-B_cell_CD34+', 'Myelocyte', 'Osteoblasts', 'BM', 'Pro-Myelocyte', 'Endothelial_cells', 'Tissue_stem_cells', 'CMP', 'Astrocyte', 'Embryonic_stem_cells', 'Hepatocytes', 'Neurons', 'Keratinocytes', 'Neuroepithelial_cell', 'MEP', 'BM & Prog.', 'Erythroblast', 'Unknown', 'Gametocytes']
라벨별 그룹 개수 {0: 21, 1: 30, 2: 11}
cell type :  S2008000605HRT_AAACCCAGTGCACATT-1       Epithelial_cells
S2008000605HRT_AAACCCAGTGCCTACG-1       Epithelial_cells
S2008000605HRT_AAAGAACGTAGAGACC-1              Astrocyte
S2008000605HRT_AAAGAACGTCGGAACA-1       Epithelial_cells
S2008000605HRT_AAAGAACGTTAACAGA-1       Epithelial_cells
                                            ...         
Sample1153EO2_TTTGATCAGACTGAGC-1               iPS_cells
Sample1153EO2_TTTGATCAGATGCTAA-1     Smooth_muscle_cells
Sample1153EO2_TTTGATCTCAGAGCAG-1        Epithelial_cells
Sample1153EO2_TTTGGAGCAAACTCGT-1       Endothelial_cells
Sample1153EO2_TTTGGAGGTTCGAACT-1                 NK_cell
Name: singler_annotation, Length: 50881, dtype: string
cell type annotation :  S2008000605HRT_AAACCCAGTGCACATT-1       Epithelial_cells
S2008000605HRT_AAACCCAGTGCCTACG-1       Epithelial_cells
S2008000605HRT_AAAGAACGTAGAGACC-1              Astrocyte
S2008000605HRT_AAAGAACGTCGGAACA-1       Epithelial_cells
S2008000605HRT_AAAGAACGTTAACAGA-1       Epithelial_cells
                                            ...         
Sample1153EO2_TTTGATCAGACTGAGC-1               iPS_cells
Sample1153EO2_TTTGATCAGATGCTAA-1     Smooth_muscle_cells
Sample1153EO2_TTTGATCTCAGAGCAG-1        Epithelial_cells
Sample1153EO2_TTTGGAGCAAACTCGT-1       Endothelial_cells
Sample1153EO2_TTTGGAGGTTCGAACT-1                 NK_cell
Name: singler_annotation, Length: 50881, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Epithelial_cells', 'Astrocyte', 'MSC', 'Keratinocytes', 'Neurons', 'Endothelial_cells', 'Fibroblasts', 'Tissue_stem_cells', 'Smooth_muscle_cells', 'T_cells', 'Neuroepithelial_cell', 'NK_cell', 'Chondrocytes', 'Osteoblasts', 'Monocyte', 'Hepatocytes', 'Macrophage', 'CMP', 'Embryonic_stem_cells', 'DC', 'BM & Prog.', 'MEP', 'Neutrophils', 'Pro-Myelocyte', 'iPS_cells', 'Pre-B_cell_CD34-', 'HSC_-G-CSF', 'B_cell', 'BM', 'Platelets', 'GMP', 'HSC_CD34+', 'Pro-B_cell_CD34+', 'Gametocytes', 'Erythroblast', 'Unknown', 'Myelocyte']
라벨별 그룹 개수 {0: 5, 1: 7, 2: 3}
🔍 Split #4
  → train_p_index 환자 수 (환자 단위로 묶인 index list): 62
  → test_p_index 환자 수  (환자 단위로 묶인 index list): 15
  → train 환자 ID: ['163-2', '163-5', '164-3', '164-6', '27-10041', '27-10053', '27-10071', '27-10112', '27-10119', '28-10051', '28-11515', '28-12381', '28-12490', '28-12518', '29-10006', '29-10008', '29-10010', '29-10011', '29-10013', '29-10016', '29-10280', '29-10386', '29-10398', '29-10400', '29-10404', '29-10406', '30-10034', '30-10123', '30-10125', '30-10929', '30-11051', '31-10000', '31-10013', '31-10035', '31-10042', '31-10078', '31-10154', '31-10210', '31-10236', '32-10034', '32-10074', '33-10005', '34-10050', '34-10184', '34-10187', 'PRE018-1', 'PRE019', 'PRE027', 'PRE038', 'PRE055-1', 'PRE062-1', 'PRE98sc', 'Sample1153-EO1', 'Sample1153-EO3', 'Sample1157-EO1', 'Sample1157-EO2', 'Sample1157-EO3', 'Sample1158-EO1', 'Sample1158-EO2', 'Sample1158-EO3', 'Sample1162-EO1', 'Sample1162-EO2']
  → test  환자 ID: ['163-3', '163-4', '164-10', '165-9', '27-10039', '28-12263', '29-10012', '29-10380', '29-10410', '30-10018', '31-10001', '31-10040', '32-10003', '33-10006', 'Sample1153-EO2']
  → train 환자 ID 및 라벨:
    ID: 163-2, Label: 0
    ID: 163-5, Label: 0
    ID: 164-3, Label: 0
    ID: 164-6, Label: 0
    ID: 27-10041, Label: 1
    ID: 27-10053, Label: 1
    ID: 27-10071, Label: 1
    ID: 27-10112, Label: 1
    ID: 27-10119, Label: 1
    ID: 28-10051, Label: 1
    ID: 28-11515, Label: 1
    ID: 28-12381, Label: 1
    ID: 28-12490, Label: 1
    ID: 28-12518, Label: 1
    ID: 29-10006, Label: 1
    ID: 29-10008, Label: 1
    ID: 29-10010, Label: 1
    ID: 29-10011, Label: 1
    ID: 29-10013, Label: 1
    ID: 29-10016, Label: 1
    ID: 29-10280, Label: 1
    ID: 29-10386, Label: 1
    ID: 29-10398, Label: 1
    ID: 29-10400, Label: 1
    ID: 29-10404, Label: 1
    ID: 29-10406, Label: 1
    ID: 30-10034, Label: 2
    ID: 30-10123, Label: 2
    ID: 30-10125, Label: 2
    ID: 30-10929, Label: 2
    ID: 30-11051, Label: 2
    ID: 31-10000, Label: 1
    ID: 31-10013, Label: 1
    ID: 31-10035, Label: 1
    ID: 31-10042, Label: 1
    ID: 31-10078, Label: 1
    ID: 31-10154, Label: 1
    ID: 31-10210, Label: 1
    ID: 31-10236, Label: 1
    ID: 32-10034, Label: 2
    ID: 32-10074, Label: 2
    ID: 33-10005, Label: 2
    ID: 34-10050, Label: 2
    ID: 34-10184, Label: 2
    ID: 34-10187, Label: 2
    ID: PRE018-1, Label: 0
    ID: PRE019, Label: 0
    ID: PRE027, Label: 0
    ID: PRE038, Label: 0
    ID: PRE055-1, Label: 0
    ID: PRE062-1, Label: 0
    ID: PRE98sc, Label: 0
    ID: Sample1153-EO1, Label: 0
    ID: Sample1153-EO3, Label: 0
    ID: Sample1157-EO1, Label: 0
    ID: Sample1157-EO2, Label: 0
    ID: Sample1157-EO3, Label: 0
    ID: Sample1158-EO1, Label: 0
    ID: Sample1158-EO2, Label: 0
    ID: Sample1158-EO3, Label: 0
    ID: Sample1162-EO1, Label: 0
    ID: Sample1162-EO2, Label: 0
  → test 환자 ID 및 라벨:
    ID: 163-3, Label: 0
    ID: 163-4, Label: 0
    ID: 164-10, Label: 0
    ID: 165-9, Label: 0
    ID: 27-10039, Label: 1
    ID: 28-12263, Label: 1
    ID: 29-10012, Label: 1
    ID: 29-10380, Label: 1
    ID: 29-10410, Label: 1
    ID: 30-10018, Label: 2
    ID: 31-10001, Label: 1
    ID: 31-10040, Label: 1
    ID: 32-10003, Label: 2
    ID: 33-10006, Label: 2
    ID: Sample1153-EO2, Label: 0
전체 데이터 index 길이 77
label_stat (train 환자 라벨 목록) 갯수 62
train_data에서 환자 단위로, train과 validation 나누기
기존 train_p_index 62
기존 (train) label_stat 62
train-vali 분할 후! 
train y 의 classes : {0, 1, 2} valid y 의 classes : {0, 1, 2} label_stat 의 classes : {0, 1, 2}
train_p_index_ 41
valid_p_index 21
test_p_index 15
→ train 환자 ID 및 라벨:
   총 개수: 41
   환자ID=29-10386, Label=1, 셀개수=802
   환자ID=31-10236, Label=1, 셀개수=3458
   환자ID=PRE019, Label=0, 셀개수=3795
   환자ID=33-10005, Label=2, 셀개수=8904
   환자ID=Sample1158-EO2, Label=0, 셀개수=1427
   환자ID=164-6, Label=0, 셀개수=3038
   환자ID=29-10011, Label=1, 셀개수=3072
   환자ID=PRE062-1, Label=0, 셀개수=907
   환자ID=31-10035, Label=1, 셀개수=2974
   환자ID=31-10000, Label=1, 셀개수=8870
   환자ID=163-5, Label=0, 셀개수=1210
   환자ID=28-12381, Label=1, 셀개수=1099
   환자ID=27-10071, Label=1, 셀개수=1478
   환자ID=27-10112, Label=1, 셀개수=1470
   환자ID=163-2, Label=0, 셀개수=2535
   환자ID=30-10125, Label=2, 셀개수=3798
   환자ID=31-10078, Label=1, 셀개수=2827
   환자ID=30-11051, Label=2, 셀개수=2454
   환자ID=Sample1158-EO3, Label=0, 셀개수=1096
   환자ID=29-10400, Label=1, 셀개수=2684
   환자ID=31-10042, Label=1, 셀개수=1222
   환자ID=164-3, Label=0, 셀개수=1639
   환자ID=32-10074, Label=2, 셀개수=6304
   환자ID=Sample1153-EO1, Label=0, 셀개수=911
   환자ID=30-10034, Label=2, 셀개수=1240
   환자ID=28-12518, Label=1, 셀개수=1215
   환자ID=Sample1162-EO1, Label=0, 셀개수=1053
   환자ID=31-10154, Label=1, 셀개수=6568
   환자ID=PRE027, Label=0, 셀개수=2078
   환자ID=28-11515, Label=1, 셀개수=930
   환자ID=29-10010, Label=1, 셀개수=5305
   환자ID=28-12490, Label=1, 셀개수=5973
   환자ID=27-10053, Label=1, 셀개수=728
   환자ID=29-10406, Label=1, 셀개수=3484
   환자ID=PRE018-1, Label=0, 셀개수=1349
   환자ID=29-10398, Label=1, 셀개수=3993
   환자ID=34-10184, Label=2, 셀개수=2699
   환자ID=34-10050, Label=2, 셀개수=4784
   환자ID=32-10034, Label=2, 셀개수=1555
   환자ID=29-10280, Label=1, 셀개수=2375
   환자ID=29-10008, Label=1, 셀개수=1913
→ valid 환자 ID 및 라벨:
   총 개수: 21
   환자ID=Sample1162-EO2, Label=0, 셀개수=1510
   환자ID=29-10016, Label=1, 셀개수=4854
   환자ID=31-10210, Label=1, 셀개수=3510
   환자ID=Sample1153-EO3, Label=0, 셀개수=1516
   환자ID=34-10187, Label=2, 셀개수=3739
   환자ID=PRE98sc, Label=0, 셀개수=1568
   환자ID=Sample1157-EO3, Label=0, 셀개수=807
   환자ID=30-10929, Label=2, 셀개수=5812
   환자ID=31-10013, Label=1, 셀개수=3161
   환자ID=30-10123, Label=2, 셀개수=1273
   환자ID=Sample1158-EO1, Label=0, 셀개수=574
   환자ID=28-10051, Label=1, 셀개수=300
   환자ID=29-10404, Label=1, 셀개수=3988
   환자ID=Sample1157-EO1, Label=0, 셀개수=1152
   환자ID=PRE055-1, Label=0, 셀개수=597
   환자ID=PRE038, Label=0, 셀개수=2666
   환자ID=27-10041, Label=1, 셀개수=2145
   환자ID=29-10013, Label=1, 셀개수=3706
   환자ID=27-10119, Label=1, 셀개수=3346
   환자ID=29-10006, Label=1, 셀개수=11461
   환자ID=Sample1157-EO2, Label=0, 셀개수=1395
→ test 환자 ID 및 라벨:
   총 개수: 15
   환자ID=163-3, Label=0, 셀개수=1335
   환자ID=163-4, Label=0, 셀개수=1339
   환자ID=164-10, Label=0, 셀개수=4041
   환자ID=165-9, Label=0, 셀개수=2926
   환자ID=27-10039, Label=1, 셀개수=4638
   환자ID=28-12263, Label=1, 셀개수=7527
   환자ID=29-10012, Label=1, 셀개수=6245
   환자ID=29-10380, Label=1, 셀개수=4799
   환자ID=29-10410, Label=1, 셀개수=2834
   환자ID=30-10018, Label=2, 셀개수=5170
   환자ID=31-10001, Label=1, 셀개수=1133
   환자ID=31-10040, Label=1, 셀개수=4543
   환자ID=32-10003, Label=2, 셀개수=2978
   환자ID=33-10006, Label=2, 셀개수=457
   환자ID=Sample1153-EO2, Label=0, 셀개수=916
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['DC', 'T_cells', 'T_cells', 'B_cell', 'Fibroblasts', 'Macrophage', 'DC', 'Monocyte', 'T_cells', 'Fibroblasts']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
전체 데이터 길이 225177
전체 cell type 길이 0                          DC
1                     T_cells
2                     T_cells
3                      B_cell
4                 Fibroblasts
                 ...         
225172              iPS_cells
225173    Smooth_muscle_cells
225174       Epithelial_cells
225175      Endothelial_cells
225176                NK_cell
Length: 225177, dtype: string
cell type의 NaN 개수 체크 0
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:10,  9.51it/s]  2%|▏         | 2/100 [00:00<00:11,  8.63it/s]  3%|▎         | 3/100 [00:00<00:10,  8.96it/s]  4%|▍         | 4/100 [00:00<00:10,  8.97it/s]  5%|▌         | 5/100 [00:00<00:10,  9.12it/s]  6%|▌         | 6/100 [00:00<00:10,  9.18it/s]  7%|▋         | 7/100 [00:00<00:10,  9.29it/s]  8%|▊         | 8/100 [00:00<00:10,  9.02it/s]  9%|▉         | 9/100 [00:00<00:10,  8.97it/s] 10%|█         | 10/100 [00:01<00:09,  9.18it/s] 11%|█         | 11/100 [00:01<00:09,  9.14it/s] 12%|█▏        | 12/100 [00:01<00:09,  8.91it/s] 13%|█▎        | 13/100 [00:01<00:09,  8.77it/s] 14%|█▍        | 14/100 [00:01<00:09,  8.71it/s] 15%|█▌        | 15/100 [00:01<00:09,  8.92it/s] 16%|█▌        | 16/100 [00:01<00:10,  7.89it/s] 17%|█▋        | 17/100 [00:01<00:09,  8.36it/s] 18%|█▊        | 18/100 [00:02<00:09,  8.50it/s] 19%|█▉        | 19/100 [00:02<00:09,  8.79it/s] 20%|██        | 20/100 [00:02<00:08,  8.90it/s] 21%|██        | 21/100 [00:02<00:08,  8.96it/s] 22%|██▏       | 22/100 [00:02<00:08,  8.78it/s] 23%|██▎       | 23/100 [00:02<00:08,  8.65it/s] 24%|██▍       | 24/100 [00:02<00:08,  8.82it/s] 25%|██▌       | 25/100 [00:02<00:08,  8.74it/s] 26%|██▌       | 26/100 [00:02<00:08,  8.61it/s] 27%|██▋       | 27/100 [00:03<00:08,  8.55it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.84it/s] 29%|██▉       | 29/100 [00:03<00:07,  9.01it/s] 30%|███       | 30/100 [00:03<00:07,  8.81it/s] 31%|███       | 31/100 [00:03<00:07,  8.77it/s] 32%|███▏      | 32/100 [00:03<00:07,  8.97it/s] 33%|███▎      | 33/100 [00:03<00:07,  9.03it/s] 34%|███▍      | 34/100 [00:03<00:07,  8.91it/s] 35%|███▌      | 35/100 [00:03<00:07,  8.65it/s] 36%|███▌      | 36/100 [00:04<00:07,  8.75it/s] 37%|███▋      | 37/100 [00:04<00:06,  9.05it/s] 38%|███▊      | 38/100 [00:04<00:06,  9.03it/s] 39%|███▉      | 39/100 [00:04<00:06,  8.85it/s] 40%|████      | 40/100 [00:04<00:06,  8.69it/s] 41%|████      | 41/100 [00:04<00:07,  7.93it/s] 42%|████▏     | 42/100 [00:04<00:07,  7.63it/s] 43%|████▎     | 43/100 [00:04<00:07,  7.97it/s] 44%|████▍     | 44/100 [00:05<00:06,  8.31it/s] 45%|████▌     | 45/100 [00:05<00:06,  8.45it/s] 46%|████▌     | 46/100 [00:05<00:06,  8.52it/s] 47%|████▋     | 47/100 [00:05<00:06,  8.31it/s] 48%|████▊     | 48/100 [00:05<00:06,  8.19it/s] 49%|████▉     | 49/100 [00:05<00:06,  7.96it/s] 50%|█████     | 50/100 [00:05<00:06,  7.98it/s] 51%|█████     | 51/100 [00:05<00:06,  8.05it/s] 52%|█████▏    | 52/100 [00:06<00:05,  8.23it/s] 53%|█████▎    | 53/100 [00:06<00:05,  8.50it/s] 54%|█████▍    | 54/100 [00:06<00:05,  8.56it/s] 55%|█████▌    | 55/100 [00:06<00:05,  8.44it/s] 56%|█████▌    | 56/100 [00:06<00:05,  8.37it/s] 57%|█████▋    | 57/100 [00:06<00:05,  8.50it/s] 58%|█████▊    | 58/100 [00:06<00:05,  7.67it/s] 59%|█████▉    | 59/100 [00:06<00:05,  7.62it/s] 60%|██████    | 60/100 [00:07<00:05,  7.90it/s] 61%|██████    | 61/100 [00:07<00:04,  7.93it/s] 62%|██████▏   | 62/100 [00:07<00:04,  8.07it/s] 63%|██████▎   | 63/100 [00:07<00:04,  8.10it/s] 64%|██████▍   | 64/100 [00:07<00:04,  8.00it/s] 65%|██████▌   | 65/100 [00:07<00:04,  7.96it/s] 66%|██████▌   | 66/100 [00:07<00:04,  8.40it/s] 67%|██████▋   | 67/100 [00:07<00:03,  8.42it/s] 68%|██████▊   | 68/100 [00:07<00:03,  8.36it/s] 69%|██████▉   | 69/100 [00:08<00:03,  8.24it/s] 70%|███████   | 70/100 [00:08<00:03,  8.23it/s] 71%|███████   | 71/100 [00:08<00:03,  8.43it/s] 72%|███████▏  | 72/100 [00:08<00:03,  8.28it/s] 73%|███████▎  | 73/100 [00:08<00:03,  8.05it/s] 74%|███████▍  | 74/100 [00:08<00:03,  7.99it/s] 75%|███████▌  | 75/100 [00:08<00:03,  8.18it/s] 76%|███████▌  | 76/100 [00:08<00:02,  8.05it/s] 77%|███████▋  | 77/100 [00:09<00:02,  7.89it/s] 78%|███████▊  | 78/100 [00:09<00:02,  8.06it/s] 79%|███████▉  | 79/100 [00:09<00:02,  8.22it/s] 80%|████████  | 80/100 [00:09<00:02,  8.24it/s] 81%|████████  | 81/100 [00:09<00:02,  8.26it/s] 82%|████████▏ | 82/100 [00:09<00:02,  8.11it/s] 83%|████████▎ | 83/100 [00:09<00:02,  7.99it/s] 84%|████████▍ | 84/100 [00:09<00:02,  7.74it/s] 85%|████████▌ | 85/100 [00:10<00:01,  7.71it/s] 86%|████████▌ | 86/100 [00:10<00:01,  7.70it/s] 87%|████████▋ | 87/100 [00:10<00:01,  7.80it/s] 88%|████████▊ | 88/100 [00:10<00:01,  7.97it/s] 89%|████████▉ | 89/100 [00:10<00:01,  8.05it/s] 90%|█████████ | 90/100 [00:10<00:01,  8.00it/s] 91%|█████████ | 91/100 [00:10<00:01,  8.11it/s] 92%|█████████▏| 92/100 [00:10<00:00,  8.14it/s] 93%|█████████▎| 93/100 [00:11<00:01,  6.90it/s] 94%|█████████▍| 94/100 [00:11<00:00,  6.94it/s] 95%|█████████▌| 95/100 [00:11<00:00,  7.22it/s] 96%|█████████▌| 96/100 [00:11<00:00,  7.45it/s] 97%|█████████▋| 97/100 [00:11<00:00,  7.45it/s] 98%|█████████▊| 98/100 [00:11<00:00,  7.62it/s] 99%|█████████▉| 99/100 [00:11<00:00,  7.93it/s]100%|██████████| 100/100 [00:12<00:00,  8.16it/s]100%|██████████| 100/100 [00:12<00:00,  8.30it/s]
[I 2025-08-31 04:28:58,380] A new study created in memory with name: no-name-a05a5b42-0f8d-4672-9550-ef925eeaf757
👉 train samples(학습 샘플(bag))=141, batch_size=16 -> steps(샘플수/batch크기)=9
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 24.81 MB
Memory Reserved: 36.00 MB
cuda
CUDA OOM 발생 — 단계적 백오프 시작.
[OOM RETRY] batch_size 16 → 8 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=141, batch_size=8 -> steps(샘플수/batch크기)=18
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 1657.39 MB
Memory Reserved: 1668.00 MB
cuda
Epoch 1, Train Loss 1.194807, Valid_loss 1.016363
Epoch 2, Train Loss 1.102590, Valid_loss 1.053116
Epoch 3, Train Loss 1.079760, Valid_loss 1.010900
Epoch 4, Train Loss 1.034744, Valid_loss 1.005981
Epoch 5, Train Loss 1.014068, Valid_loss 1.004030
Epoch 6, Train Loss 1.008803, Valid_loss 1.005057
Epoch 7, Train Loss 1.008880, Valid_loss 1.005952
Epoch 8, Train Loss 0.978201, Valid_loss 1.006994
Epoch 9, Train Loss 0.990064, Valid_loss 1.007474
Epoch 10, Train Loss 0.989828, Valid_loss 1.000308
Epoch 11, Train Loss 1.015492, Valid_loss 1.007997
Epoch 12, Train Loss 0.994581, Valid_loss 1.010227
Epoch 13, Train Loss 1.000354, Valid_loss 1.010440
Epoch 14, Train Loss 0.976712, Valid_loss 1.010191
Epoch 15, Train Loss 0.974271, Valid_loss 1.010647
Epoch 16, Train Loss 0.988325, Valid_loss 1.004626
Epoch 17, Train Loss 0.997032, Valid_loss 0.992231
Epoch 18, Train Loss 0.971479, Valid_loss 0.933708
Epoch 19, Train Loss 0.979538, Valid_loss 0.962501
Epoch 20, Train Loss 0.973124, Valid_loss 0.932457
Epoch 21, Train Loss 0.934380, Valid_loss 0.920531
Epoch 22, Train Loss 0.946830, Valid_loss 0.881583
Epoch 23, Train Loss 0.913058, Valid_loss 0.926223
Epoch 24, Train Loss 0.903057, Valid_loss 0.913048
Epoch 25, Train Loss 0.859324, Valid_loss 0.831703
Epoch 26, Train Loss 0.849273, Valid_loss 0.795796
Epoch 27, Train Loss 0.919107, Valid_loss 0.884822
Epoch 28, Train Loss 0.856067, Valid_loss 0.863813
Epoch 29, Train Loss 0.919269, Valid_loss 0.854390
Epoch 30, Train Loss 0.847993, Valid_loss 0.955994
Epoch 31, Train Loss 0.886660, Valid_loss 0.784083
Epoch 32, Train Loss 0.819092, Valid_loss 0.797882
Epoch 33, Train Loss 0.801522, Valid_loss 0.765252
Epoch 34, Train Loss 0.796406, Valid_loss 0.876516
Epoch 35, Train Loss 0.925293, Valid_loss 0.813611
Epoch 36, Train Loss 0.832985, Valid_loss 0.756500
Epoch 37, Train Loss 0.847126, Valid_loss 0.743653
Epoch 38, Train Loss 0.932409, Valid_loss 0.838589
Epoch 39, Train Loss 0.786241, Valid_loss 0.877747
Epoch 40, Train Loss 0.835001, Valid_loss 0.704309
Epoch 41, Train Loss 0.787125, Valid_loss 0.773826
Epoch 42, Train Loss 0.894725, Valid_loss 0.731497
Epoch 43, Train Loss 0.815729, Valid_loss 0.686361
Epoch 44, Train Loss 0.824472, Valid_loss 0.781843
Epoch 45, Train Loss 0.802923, Valid_loss 0.744870
Epoch 46, Train Loss 0.787601, Valid_loss 0.738848
Epoch 47, Train Loss 0.721148, Valid_loss 0.763834
Epoch 48, Train Loss 0.784809, Valid_loss 0.758355
Epoch 49, Train Loss 0.773061, Valid_loss 0.721547
Epoch 50, Train Loss 0.752179, Valid_loss 0.650819
Epoch 51, Train Loss 0.705092, Valid_loss 0.790380
Epoch 52, Train Loss 0.756561, Valid_loss 0.722300
Epoch 53, Train Loss 0.710503, Valid_loss 0.782488
Epoch 54, Train Loss 0.778623, Valid_loss 0.733702
Epoch 55, Train Loss 0.779953, Valid_loss 0.757345
Epoch 56, Train Loss 0.717086, Valid_loss 0.767520
[I 2025-08-31 04:40:19,025] Trial 0 finished with value: 0.65081901209695 and parameters: {'learning_rate': 0.001, 'epochs': 100, 'heads': 4, 'dropout': 0.7, 'weight_decay': 0.01, 'emb_dim': 8, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.65081901209695.
👉 train samples(학습 샘플(bag))=141, batch_size=16 -> steps(샘플수/batch크기)=9
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 1657.39 MB
Memory Reserved: 1668.00 MB
cuda
Epoch 1, Train Loss 1.215123, Valid_loss 1.050187
Epoch 2, Train Loss 1.065190, Valid_loss 1.013305
Epoch 3, Train Loss 0.993791, Valid_loss 1.024099
Epoch 4, Train Loss 0.971303, Valid_loss 1.013729
Epoch 5, Train Loss 0.985100, Valid_loss 1.016885
Epoch 6, Train Loss 0.959677, Valid_loss 1.022116
Epoch 7, Train Loss 0.950197, Valid_loss 1.027980
Epoch 8, Train Loss 0.986666, Valid_loss 1.017795
Epoch 9, Train Loss 0.963524, Valid_loss 1.017012
Epoch 10, Train Loss 0.974884, Valid_loss 1.019025
Epoch 11, Train Loss 0.955191, Valid_loss 1.013817
Epoch 12, Train Loss 0.977452, Valid_loss 1.027833
Epoch 13, Train Loss 0.979164, Valid_loss 1.031029
Epoch 14, Train Loss 0.960503, Valid_loss 1.025837
Epoch 15, Train Loss 0.981669, Valid_loss 1.020564
Epoch 16, Train Loss 0.970566, Valid_loss 1.015960
Epoch 17, Train Loss 0.962038, Valid_loss 1.018559
Epoch 18, Train Loss 0.963756, Valid_loss 1.018752
Epoch 19, Train Loss 0.976981, Valid_loss 1.022063
Epoch 20, Train Loss 0.977825, Valid_loss 1.023417
Epoch 21, Train Loss 0.971513, Valid_loss 1.020813
Epoch 22, Train Loss 0.975009, Valid_loss 1.020895
Epoch 23, Train Loss 0.961833, Valid_loss 1.024155
Epoch 24, Train Loss 0.967223, Valid_loss 1.023080
Epoch 25, Train Loss 0.983154, Valid_loss 1.025389
Epoch 26, Train Loss 0.978467, Valid_loss 1.019810
Epoch 27, Train Loss 0.960433, Valid_loss 1.024164
Epoch 28, Train Loss 0.976023, Valid_loss 1.026386
Epoch 29, Train Loss 0.959182, Valid_loss 1.023272
Epoch 30, Train Loss 0.977894, Valid_loss 1.022433
Epoch 31, Train Loss 0.962627, Valid_loss 1.013219
Epoch 32, Train Loss 0.969244, Valid_loss 0.984668
Epoch 33, Train Loss 0.951583, Valid_loss 0.995636
Epoch 34, Train Loss 0.910338, Valid_loss 0.863709
Epoch 35, Train Loss 0.824410, Valid_loss 0.855352
Epoch 36, Train Loss 0.832850, Valid_loss 1.036544
Epoch 37, Train Loss 0.801627, Valid_loss 0.618029
Epoch 38, Train Loss 0.805180, Valid_loss 0.909946
Epoch 39, Train Loss 0.847535, Valid_loss 0.639956
Epoch 40, Train Loss 0.784202, Valid_loss 0.914664
Epoch 41, Train Loss 0.805214, Valid_loss 0.630635
Epoch 42, Train Loss 0.693743, Valid_loss 0.550328
Epoch 43, Train Loss 0.723007, Valid_loss 0.472363
Epoch 44, Train Loss 0.633324, Valid_loss 0.621585
Epoch 45, Train Loss 0.632368, Valid_loss 1.161127
Epoch 46, Train Loss 0.683349, Valid_loss 0.545480
Epoch 47, Train Loss 0.594197, Valid_loss 0.420250
Epoch 48, Train Loss 0.605275, Valid_loss 0.658778
Epoch 49, Train Loss 0.601397, Valid_loss 0.399642
Epoch 50, Train Loss 0.598856, Valid_loss 0.881343
Epoch 51, Train Loss 0.558204, Valid_loss 0.402692
Epoch 52, Train Loss 0.759501, Valid_loss 0.413008
Epoch 53, Train Loss 0.631211, Valid_loss 0.585523
[I 2025-08-31 04:48:54,353] Trial 1 finished with value: 0.3996415516095502 and parameters: {'learning_rate': 0.01, 'epochs': 100, 'heads': 2, 'dropout': 0.3, 'weight_decay': 0.001, 'emb_dim': 8, 'augment_num': 100, 'pca': False}. Best is trial 1 with value: 0.3996415516095502.
👉 train samples(학습 샘플(bag))=141, batch_size=16 -> steps(샘플수/batch크기)=9
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 1657.39 MB
Memory Reserved: 1668.00 MB
cuda
Epoch 1, Train Loss 1.106684, Valid_loss 1.060662
Epoch 2, Train Loss 1.111734, Valid_loss 1.052733
Epoch 3, Train Loss 1.109508, Valid_loss 1.043991
Epoch 4, Train Loss 1.081119, Valid_loss 1.037624
Epoch 5, Train Loss 1.088678, Valid_loss 1.035535
Epoch 6, Train Loss 1.100841, Valid_loss 1.034172
Epoch 7, Train Loss 1.082134, Valid_loss 1.032946
Epoch 8, Train Loss 1.076382, Valid_loss 1.025523
Epoch 9, Train Loss 1.066731, Valid_loss 1.021012
Epoch 10, Train Loss 1.070462, Valid_loss 1.015942
Epoch 11, Train Loss 1.074025, Valid_loss 1.014037
Epoch 12, Train Loss 1.080659, Valid_loss 0.997631
Epoch 13, Train Loss 1.054760, Valid_loss 1.006503
Epoch 14, Train Loss 1.047279, Valid_loss 0.997932
Epoch 15, Train Loss 1.041013, Valid_loss 1.005073
Epoch 16, Train Loss 1.063293, Valid_loss 0.989056
Epoch 17, Train Loss 1.042054, Valid_loss 0.982075
Epoch 18, Train Loss 1.044944, Valid_loss 0.984259
Epoch 19, Train Loss 1.014447, Valid_loss 0.981144
Epoch 20, Train Loss 1.035635, Valid_loss 0.987849
Epoch 21, Train Loss 1.055175, Valid_loss 0.970400
Epoch 22, Train Loss 1.038524, Valid_loss 0.948750
Epoch 23, Train Loss 1.030455, Valid_loss 0.979359
Epoch 24, Train Loss 1.013550, Valid_loss 0.952976
Epoch 25, Train Loss 0.996905, Valid_loss 0.978167
Epoch 26, Train Loss 1.004526, Valid_loss 0.960395
Epoch 27, Train Loss 1.011853, Valid_loss 0.933603
Epoch 28, Train Loss 1.005178, Valid_loss 0.950222
Epoch 29, Train Loss 1.021590, Valid_loss 0.938414
Epoch 30, Train Loss 0.992222, Valid_loss 0.918150
Epoch 31, Train Loss 1.000769, Valid_loss 0.944918
Epoch 32, Train Loss 1.004497, Valid_loss 0.925064
Epoch 33, Train Loss 0.992408, Valid_loss 0.902193
Epoch 34, Train Loss 0.988786, Valid_loss 0.908710
Epoch 35, Train Loss 1.006720, Valid_loss 0.911117
Epoch 36, Train Loss 0.978458, Valid_loss 0.896366
Epoch 37, Train Loss 0.963873, Valid_loss 0.910380
Epoch 38, Train Loss 0.963067, Valid_loss 0.900093
Epoch 39, Train Loss 0.960993, Valid_loss 0.889509
Epoch 40, Train Loss 0.949958, Valid_loss 0.908749
Epoch 41, Train Loss 0.950222, Valid_loss 0.880233
Epoch 42, Train Loss 0.961777, Valid_loss 0.919395
Epoch 43, Train Loss 0.931700, Valid_loss 0.885662
Epoch 44, Train Loss 0.960921, Valid_loss 0.909708
Epoch 45, Train Loss 0.923829, Valid_loss 0.869342
Epoch 46, Train Loss 0.962249, Valid_loss 0.870610
Epoch 47, Train Loss 0.939993, Valid_loss 0.843642
Epoch 48, Train Loss 0.952311, Valid_loss 0.903467
Epoch 49, Train Loss 0.957231, Valid_loss 0.902979
Epoch 50, Train Loss 0.975254, Valid_loss 0.844922
Epoch 51, Train Loss 0.940944, Valid_loss 0.847963
Epoch 52, Train Loss 0.935746, Valid_loss 0.893534
[I 2025-08-31 04:54:38,091] Trial 2 finished with value: 0.8436423965862819 and parameters: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 1, 'dropout': 0.7, 'weight_decay': 0.001, 'emb_dim': 8, 'augment_num': 100, 'pca': False}. Best is trial 1 with value: 0.3996415516095502.
선택된 trial params: {'learning_rate': 0.01, 'epochs': 100, 'heads': 2, 'dropout': 0.3, 'weight_decay': 0.001, 'emb_dim': 8, 'augment_num': 100, 'pca': False}
👉 train samples(학습 샘플(bag))=141, batch_size=16 -> steps(샘플수/batch크기)=9
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=15, batch_size=1 -> steps=15
Memory Allocated: 1657.39 MB
Memory Reserved: 1668.00 MB
cuda
Epoch 1, Train Loss 1.062763, Valid_loss 1.014078
Epoch 2, Train Loss 1.009693, Valid_loss 1.027976
Epoch 3, Train Loss 1.009260, Valid_loss 1.036678
Epoch 4, Train Loss 0.968603, Valid_loss 1.013344
Epoch 5, Train Loss 0.983703, Valid_loss 1.008416
Epoch 6, Train Loss 0.978603, Valid_loss 1.018536
Epoch 7, Train Loss 0.969825, Valid_loss 1.010252
Epoch 8, Train Loss 0.972719, Valid_loss 1.002536
Epoch 9, Train Loss 0.944793, Valid_loss 0.976200
Epoch 10, Train Loss 0.906211, Valid_loss 0.935907
Epoch 11, Train Loss 0.858960, Valid_loss 0.813320
Epoch 12, Train Loss 0.755245, Valid_loss 0.587251
Epoch 13, Train Loss 0.761024, Valid_loss 0.693244
Epoch 14, Train Loss 0.889513, Valid_loss 0.583887
Epoch 15, Train Loss 0.768052, Valid_loss 0.519684
Epoch 16, Train Loss 0.747966, Valid_loss 1.251015
Epoch 17, Train Loss 0.667428, Valid_loss 0.462713
Epoch 18, Train Loss 0.647134, Valid_loss 0.863737
Epoch 19, Train Loss 0.629749, Valid_loss 0.430391
Epoch 20, Train Loss 0.646718, Valid_loss 0.730245
Epoch 21, Train Loss 0.540777, Valid_loss 0.617823
Epoch 22, Train Loss 0.539541, Valid_loss 1.219608
Epoch 23, Train Loss 0.568007, Valid_loss 1.274391
Epoch 24, Train Loss 0.588519, Valid_loss 1.064727
Epoch 25, Train Loss 0.686458, Valid_loss 0.421159
Epoch 26, Train Loss 0.632855, Valid_loss 0.981013
Epoch 27, Train Loss 0.558109, Valid_loss 0.881019
Epoch 28, Train Loss 0.565582, Valid_loss 0.848027
Epoch 29, Train Loss 0.495523, Valid_loss 1.106003
Epoch 30, Train Loss 0.482686, Valid_loss 0.520131
Epoch 31, Train Loss 0.654637, Valid_loss 0.623208
Epoch 32, Train Loss 0.577433, Valid_loss 0.537532
Epoch 33, Train Loss 0.657308, Valid_loss 0.411663
Epoch 34, Train Loss 0.576452, Valid_loss 0.381926
Epoch 35, Train Loss 0.643385, Valid_loss 0.370843
Epoch 36, Train Loss 0.563152, Valid_loss 0.705997
Epoch 37, Train Loss 0.510222, Valid_loss 0.996321
Epoch 38, Train Loss 0.537901, Valid_loss 0.596205
Epoch 39, Train Loss 0.553085, Valid_loss 0.618243
Epoch 40, Train Loss 0.522117, Valid_loss 0.622102
Epoch 41, Train Loss 0.495208, Valid_loss 0.932946
Epoch 42, Train Loss 0.480229, Valid_loss 0.783551
Epoch 43, Train Loss 0.508227, Valid_loss 0.435827
Epoch 44, Train Loss 0.558345, Valid_loss 0.915138
Epoch 45, Train Loss 0.571996, Valid_loss 0.493383
Epoch 46, Train Loss 0.487911, Valid_loss 0.463682
Epoch 47, Train Loss 0.531737, Valid_loss 0.527455
Epoch 48, Train Loss 0.517589, Valid_loss 0.965379
Epoch 49, Train Loss 0.518402, Valid_loss 0.543481
Epoch 50, Train Loss 0.512354, Valid_loss 0.872279
Epoch 51, Train Loss 0.461356, Valid_loss 0.468544
Epoch 52, Train Loss 0.475538, Valid_loss 0.777992
Epoch 53, Train Loss 0.406430, Valid_loss 0.553959
Epoch 54, Train Loss 0.499959, Valid_loss 0.722415
Epoch 55, Train Loss 0.402383, Valid_loss 0.534438
Epoch 56, Train Loss 0.420000, Valid_loss 0.627928
Epoch 57, Train Loss 0.427057, Valid_loss 0.511901
Epoch 58, Train Loss 0.428274, Valid_loss 0.388336
Epoch 59, Train Loss 0.438700, Valid_loss 0.638538
Epoch 60, Train Loss 0.408684, Valid_loss 0.561360
Epoch 61, Train Loss 0.380834, Valid_loss 0.486858
Epoch 62, Train Loss 0.401032, Valid_loss 0.324761
Epoch 63, Train Loss 0.505170, Valid_loss 0.484402
Epoch 64, Train Loss 0.366624, Valid_loss 0.430059
Epoch 65, Train Loss 0.366735, Valid_loss 0.354151
Epoch 66, Train Loss 0.433306, Valid_loss 0.553436
Epoch 67, Train Loss 0.375180, Valid_loss 0.395208
Epoch 68, Train Loss 0.355628, Valid_loss 0.628582
Epoch 69, Train Loss 0.410643, Valid_loss 0.369452
Epoch 70, Train Loss 0.389845, Valid_loss 0.390680
Epoch 71, Train Loss 0.386935, Valid_loss 0.432082
환자ID=163-3 -- true: [[0]] -- pred: tensor([[-1.9677,  1.3093,  0.3938]], device='cuda:0')
환자ID=163-4 -- true: [[0]] -- pred: tensor([[ 3.8831, -1.3830, -4.5259]], device='cuda:0')
환자ID=164-10 -- true: [[0]] -- pred: tensor([[ 3.1267, -0.7920, -4.5089]], device='cuda:0')
환자ID=165-9 -- true: [[0]] -- pred: tensor([[ 3.2232, -0.8574, -4.5366]], device='cuda:0')
환자ID=27-10039 -- true: [[1]] -- pred: tensor([[-1.9633,  1.3530,  0.3069]], device='cuda:0')
환자ID=28-12263 -- true: [[1]] -- pred: tensor([[-1.9680,  1.3535,  0.3229]], device='cuda:0')
환자ID=29-10012 -- true: [[1]] -- pred: tensor([[-1.2718,  1.5861, -1.4366]], device='cuda:0')
환자ID=29-10380 -- true: [[1]] -- pred: tensor([[-1.6183,  1.5426, -0.7194]], device='cuda:0')
환자ID=29-10410 -- true: [[1]] -- pred: tensor([[-1.8708,  1.4261, -0.0435]], device='cuda:0')
환자ID=30-10018 -- true: [[2]] -- pred: tensor([[-2.0259,  1.2353,  0.7173]], device='cuda:0')
환자ID=31-10001 -- true: [[1]] -- pred: tensor([[-1.8412,  1.4226, -0.1136]], device='cuda:0')
환자ID=31-10040 -- true: [[1]] -- pred: tensor([[-1.5289,  1.5557, -0.9119]], device='cuda:0')
환자ID=32-10003 -- true: [[2]] -- pred: tensor([[-2.0235,  1.2222,  0.7489]], device='cuda:0')
환자ID=33-10006 -- true: [[2]] -- pred: tensor([[-1.8267,  1.0624,  0.8028]], device='cuda:0')
환자ID=Sample1153-EO2 -- true: [[0]] -- pred: tensor([[ 3.8580, -1.3217, -4.6281]], device='cuda:0')
Best performance: Epoch 62, Loss 0.401032, Test ACC 0.733333, Test AUC 0.965079, Test Recall 0.600000, Test Precision 0.545455
Confusion Matrix:
 [[4 1 0]
 [0 7 0]
 [0 3 0]]
✅ Total valid splits used: 4
🔁 Repeat 1, Fold 4
cell type :  S2008000605HRT_AAACCCAGTGCACATT-1     Epithelial_cells
S2008000605HRT_AAACCCAGTGCCTACG-1     Epithelial_cells
S2008000605HRT_AAAGAACGTAGAGACC-1            Astrocyte
S2008000605HRT_AAAGAACGTCGGAACA-1     Epithelial_cells
S2008000605HRT_AAAGAACGTTAACAGA-1     Epithelial_cells
                                           ...        
Sample1162EO2_TTTGGAGAGCAGGCAT-1      Epithelial_cells
Sample1162EO2_TTTGGAGAGTCGCGAA-1     Endothelial_cells
Sample1162EO2_TTTGGAGAGTGCTCGC-1           Hepatocytes
Sample1162EO2_TTTGGAGGTGATACTC-1      Epithelial_cells
Sample1162EO2_TTTGGTTCAGTAGAAT-1      Epithelial_cells
Name: singler_annotation, Length: 195432, dtype: string
cell type annotation :  S2008000605HRT_AAACCCAGTGCACATT-1     Epithelial_cells
S2008000605HRT_AAACCCAGTGCCTACG-1     Epithelial_cells
S2008000605HRT_AAAGAACGTAGAGACC-1            Astrocyte
S2008000605HRT_AAAGAACGTCGGAACA-1     Epithelial_cells
S2008000605HRT_AAAGAACGTTAACAGA-1     Epithelial_cells
                                           ...        
Sample1162EO2_TTTGGAGAGCAGGCAT-1      Epithelial_cells
Sample1162EO2_TTTGGAGAGTCGCGAA-1     Endothelial_cells
Sample1162EO2_TTTGGAGAGTGCTCGC-1           Hepatocytes
Sample1162EO2_TTTGGAGGTGATACTC-1      Epithelial_cells
Sample1162EO2_TTTGGTTCAGTAGAAT-1      Epithelial_cells
Name: singler_annotation, Length: 195432, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Epithelial_cells', 'Astrocyte', 'MSC', 'Keratinocytes', 'Neurons', 'Endothelial_cells', 'Fibroblasts', 'Tissue_stem_cells', 'Smooth_muscle_cells', 'T_cells', 'Neuroepithelial_cell', 'NK_cell', 'Chondrocytes', 'Osteoblasts', 'Monocyte', 'Hepatocytes', 'Macrophage', 'CMP', 'Embryonic_stem_cells', 'DC', 'BM & Prog.', 'MEP', 'Neutrophils', 'Pro-Myelocyte', 'iPS_cells', 'Pre-B_cell_CD34-', 'HSC_-G-CSF', 'B_cell', 'GMP', 'HSC_CD34+', 'Platelets', 'Pro-B_cell_CD34+', 'Myelocyte', 'BM', 'Erythroblast', 'Unknown', 'Gametocytes']
라벨별 그룹 개수 {0: 21, 1: 30, 2: 11}
cell type :  S2106003885HRT_AAACGCTAGCACCTGC-1             Macrophage
S2106003885HRT_AAACGCTCAAGCCATT-1             HSC_-G-CSF
S2106003885HRT_AAACGCTGTCACTGAT-1    Smooth_muscle_cells
S2106003885HRT_AAACGCTGTCGTTCAA-1             Macrophage
S2106003885HRT_AAACGCTGTGATGAAT-1                T_cells
                                            ...         
Sample1157EO3_TTTGATCGTGGTCCCA-1        Epithelial_cells
Sample1157EO3_TTTGGAGGTAGTCGTT-1        Epithelial_cells
Sample1157EO3_TTTGGTTAGTTTGCTG-1        Epithelial_cells
Sample1157EO3_TTTGGTTTCACACCGG-1                 T_cells
Sample1157EO3_TTTGTTGGTTCATCTT-1        Epithelial_cells
Name: singler_annotation, Length: 29745, dtype: string
cell type annotation :  S2106003885HRT_AAACGCTAGCACCTGC-1             Macrophage
S2106003885HRT_AAACGCTCAAGCCATT-1             HSC_-G-CSF
S2106003885HRT_AAACGCTGTCACTGAT-1    Smooth_muscle_cells
S2106003885HRT_AAACGCTGTCGTTCAA-1             Macrophage
S2106003885HRT_AAACGCTGTGATGAAT-1                T_cells
                                            ...         
Sample1157EO3_TTTGATCGTGGTCCCA-1        Epithelial_cells
Sample1157EO3_TTTGGAGGTAGTCGTT-1        Epithelial_cells
Sample1157EO3_TTTGGTTAGTTTGCTG-1        Epithelial_cells
Sample1157EO3_TTTGGTTTCACACCGG-1                 T_cells
Sample1157EO3_TTTGTTGGTTCATCTT-1        Epithelial_cells
Name: singler_annotation, Length: 29745, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Macrophage', 'HSC_-G-CSF', 'Smooth_muscle_cells', 'T_cells', 'Monocyte', 'Chondrocytes', 'Fibroblasts', 'Neutrophils', 'Endothelial_cells', 'DC', 'GMP', 'B_cell', 'Pre-B_cell_CD34-', 'NK_cell', 'CMP', 'MSC', 'Epithelial_cells', 'Tissue_stem_cells', 'Neurons', 'HSC_CD34+', 'Myelocyte', 'iPS_cells', 'BM', 'Platelets', 'Pro-B_cell_CD34+', 'Osteoblasts', 'Pro-Myelocyte', 'Astrocyte', 'Embryonic_stem_cells', 'Hepatocytes', 'Neuroepithelial_cell', 'Keratinocytes', 'MEP', 'Unknown', 'Erythroblast', 'BM & Prog.', 'Gametocytes']
라벨별 그룹 개수 {0: 5, 1: 7, 2: 3}
🔍 Split #5
  → train_p_index 환자 수 (환자 단위로 묶인 index list): 62
  → test_p_index 환자 수  (환자 단위로 묶인 index list): 15
  → train 환자 ID: ['163-2', '163-3', '163-4', '164-10', '164-3', '164-6', '165-9', '27-10039', '27-10041', '27-10071', '27-10119', '28-10051', '28-11515', '28-12263', '28-12490', '28-12518', '29-10006', '29-10008', '29-10010', '29-10012', '29-10013', '29-10380', '29-10386', '29-10398', '29-10400', '29-10404', '29-10406', '29-10410', '30-10018', '30-10123', '30-10125', '30-10929', '31-10000', '31-10001', '31-10013', '31-10035', '31-10040', '31-10042', '31-10154', '31-10210', '31-10236', '32-10003', '32-10034', '32-10074', '33-10005', '33-10006', '34-10050', '34-10184', 'PRE018-1', 'PRE019', 'PRE027', 'PRE038', 'PRE055-1', 'Sample1153-EO1', 'Sample1153-EO2', 'Sample1153-EO3', 'Sample1157-EO1', 'Sample1158-EO1', 'Sample1158-EO2', 'Sample1158-EO3', 'Sample1162-EO1', 'Sample1162-EO2']
  → test  환자 ID: ['163-5', '27-10053', '27-10112', '28-12381', '29-10011', '29-10016', '29-10280', '30-10034', '30-11051', '31-10078', '34-10187', 'PRE062-1', 'PRE98sc', 'Sample1157-EO2', 'Sample1157-EO3']
  → train 환자 ID 및 라벨:
    ID: 163-2, Label: 0
    ID: 163-3, Label: 0
    ID: 163-4, Label: 0
    ID: 164-10, Label: 0
    ID: 164-3, Label: 0
    ID: 164-6, Label: 0
    ID: 165-9, Label: 0
    ID: 27-10039, Label: 1
    ID: 27-10041, Label: 1
    ID: 27-10071, Label: 1
    ID: 27-10119, Label: 1
    ID: 28-10051, Label: 1
    ID: 28-11515, Label: 1
    ID: 28-12263, Label: 1
    ID: 28-12490, Label: 1
    ID: 28-12518, Label: 1
    ID: 29-10006, Label: 1
    ID: 29-10008, Label: 1
    ID: 29-10010, Label: 1
    ID: 29-10012, Label: 1
    ID: 29-10013, Label: 1
    ID: 29-10380, Label: 1
    ID: 29-10386, Label: 1
    ID: 29-10398, Label: 1
    ID: 29-10400, Label: 1
    ID: 29-10404, Label: 1
    ID: 29-10406, Label: 1
    ID: 29-10410, Label: 1
    ID: 30-10018, Label: 2
    ID: 30-10123, Label: 2
    ID: 30-10125, Label: 2
    ID: 30-10929, Label: 2
    ID: 31-10000, Label: 1
    ID: 31-10001, Label: 1
    ID: 31-10013, Label: 1
    ID: 31-10035, Label: 1
    ID: 31-10040, Label: 1
    ID: 31-10042, Label: 1
    ID: 31-10154, Label: 1
    ID: 31-10210, Label: 1
    ID: 31-10236, Label: 1
    ID: 32-10003, Label: 2
    ID: 32-10034, Label: 2
    ID: 32-10074, Label: 2
    ID: 33-10005, Label: 2
    ID: 33-10006, Label: 2
    ID: 34-10050, Label: 2
    ID: 34-10184, Label: 2
    ID: PRE018-1, Label: 0
    ID: PRE019, Label: 0
    ID: PRE027, Label: 0
    ID: PRE038, Label: 0
    ID: PRE055-1, Label: 0
    ID: Sample1153-EO1, Label: 0
    ID: Sample1153-EO2, Label: 0
    ID: Sample1153-EO3, Label: 0
    ID: Sample1157-EO1, Label: 0
    ID: Sample1158-EO1, Label: 0
    ID: Sample1158-EO2, Label: 0
    ID: Sample1158-EO3, Label: 0
    ID: Sample1162-EO1, Label: 0
    ID: Sample1162-EO2, Label: 0
  → test 환자 ID 및 라벨:
    ID: 163-5, Label: 0
    ID: 27-10053, Label: 1
    ID: 27-10112, Label: 1
    ID: 28-12381, Label: 1
    ID: 29-10011, Label: 1
    ID: 29-10016, Label: 1
    ID: 29-10280, Label: 1
    ID: 30-10034, Label: 2
    ID: 30-11051, Label: 2
    ID: 31-10078, Label: 1
    ID: 34-10187, Label: 2
    ID: PRE062-1, Label: 0
    ID: PRE98sc, Label: 0
    ID: Sample1157-EO2, Label: 0
    ID: Sample1157-EO3, Label: 0
전체 데이터 index 길이 77
label_stat (train 환자 라벨 목록) 갯수 62
train_data에서 환자 단위로, train과 validation 나누기
기존 train_p_index 62
기존 (train) label_stat 62
train-vali 분할 후! 
train y 의 classes : {0, 1, 2} valid y 의 classes : {0, 1, 2} label_stat 의 classes : {0, 1, 2}
train_p_index_ 41
valid_p_index 21
test_p_index 15
→ train 환자 ID 및 라벨:
   총 개수: 41
   환자ID=29-10380, Label=1, 셀개수=4799
   환자ID=31-10154, Label=1, 셀개수=6568
   환자ID=34-10050, Label=2, 셀개수=4784
   환자ID=32-10003, Label=2, 셀개수=2978
   환자ID=Sample1158-EO2, Label=0, 셀개수=1427
   환자ID=164-10, Label=0, 셀개수=4041
   환자ID=29-10008, Label=1, 셀개수=1913
   환자ID=PRE027, Label=0, 셀개수=2078
   환자ID=31-10001, Label=1, 셀개수=1133
   환자ID=30-10929, Label=2, 셀개수=5812
   환자ID=163-3, Label=0, 셀개수=1335
   환자ID=28-10051, Label=1, 셀개수=300
   환자ID=165-9, Label=0, 셀개수=2926
   환자ID=27-10039, Label=1, 셀개수=4638
   환자ID=163-2, Label=0, 셀개수=2535
   환자ID=30-10018, Label=2, 셀개수=5170
   환자ID=31-10035, Label=1, 셀개수=2974
   환자ID=30-10125, Label=2, 셀개수=3798
   환자ID=Sample1158-EO3, Label=0, 셀개수=1096
   환자ID=29-10398, Label=1, 셀개수=3993
   환자ID=31-10013, Label=1, 셀개수=3161
   환자ID=163-4, Label=0, 셀개수=1339
   환자ID=31-10236, Label=1, 셀개수=3458
   환자ID=PRE055-1, Label=0, 셀개수=597
   환자ID=29-10406, Label=1, 셀개수=3484
   환자ID=28-12263, Label=1, 셀개수=7527
   환자ID=Sample1162-EO1, Label=0, 셀개수=1053
   환자ID=31-10040, Label=1, 셀개수=4543
   환자ID=34-10184, Label=2, 셀개수=2699
   환자ID=27-10119, Label=1, 셀개수=3346
   환자ID=29-10006, Label=1, 셀개수=11461
   환자ID=28-11515, Label=1, 셀개수=930
   환자ID=164-6, Label=0, 셀개수=3038
   환자ID=29-10404, Label=1, 셀개수=3988
   환자ID=33-10006, Label=2, 셀개수=457
   환자ID=29-10386, Label=1, 셀개수=802
   환자ID=32-10074, Label=2, 셀개수=6304
   환자ID=32-10034, Label=2, 셀개수=1555
   환자ID=31-10210, Label=1, 셀개수=3510
   환자ID=29-10013, Label=1, 셀개수=3706
   환자ID=28-12518, Label=1, 셀개수=1215
→ valid 환자 ID 및 라벨:
   총 개수: 21
   환자ID=Sample1162-EO2, Label=0, 셀개수=1510
   환자ID=29-10012, Label=1, 셀개수=6245
   환자ID=31-10042, Label=1, 셀개수=1222
   환자ID=Sample1153-EO1, Label=0, 셀개수=911
   환자ID=33-10005, Label=2, 셀개수=8904
   환자ID=PRE038, Label=0, 셀개수=2666
   환자ID=Sample1157-EO1, Label=0, 셀개수=1152
   환자ID=30-10123, Label=2, 셀개수=1273
   환자ID=31-10000, Label=1, 셀개수=8870
   환자ID=29-10410, Label=1, 셀개수=2834
   환자ID=Sample1158-EO1, Label=0, 셀개수=574
   환자ID=27-10071, Label=1, 셀개수=1478
   환자ID=29-10400, Label=1, 셀개수=2684
   환자ID=Sample1153-EO2, Label=0, 셀개수=916
   환자ID=PRE019, Label=0, 셀개수=3795
   환자ID=PRE018-1, Label=0, 셀개수=1349
   환자ID=164-3, Label=0, 셀개수=1639
   환자ID=29-10010, Label=1, 셀개수=5305
   환자ID=27-10041, Label=1, 셀개수=2145
   환자ID=28-12490, Label=1, 셀개수=5973
   환자ID=Sample1153-EO3, Label=0, 셀개수=1516
→ test 환자 ID 및 라벨:
   총 개수: 15
   환자ID=163-5, Label=0, 셀개수=1210
   환자ID=27-10053, Label=1, 셀개수=728
   환자ID=27-10112, Label=1, 셀개수=1470
   환자ID=28-12381, Label=1, 셀개수=1099
   환자ID=29-10011, Label=1, 셀개수=3072
   환자ID=29-10016, Label=1, 셀개수=4854
   환자ID=29-10280, Label=1, 셀개수=2375
   환자ID=30-10034, Label=2, 셀개수=1240
   환자ID=30-11051, Label=2, 셀개수=2454
   환자ID=31-10078, Label=1, 셀개수=2827
   환자ID=34-10187, Label=2, 셀개수=3739
   환자ID=PRE062-1, Label=0, 셀개수=907
   환자ID=PRE98sc, Label=0, 셀개수=1568
   환자ID=Sample1157-EO2, Label=0, 셀개수=1395
   환자ID=Sample1157-EO3, Label=0, 셀개수=807
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Epithelial_cells', 'Epithelial_cells', 'Astrocyte', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'MSC', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
전체 데이터 길이 225177
전체 cell type 길이 0         Epithelial_cells
1         Epithelial_cells
2                Astrocyte
3         Epithelial_cells
4         Epithelial_cells
                ...       
225172    Epithelial_cells
225173    Epithelial_cells
225174    Epithelial_cells
225175             T_cells
225176    Epithelial_cells
Length: 225177, dtype: string
cell type의 NaN 개수 체크 0
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:10,  9.47it/s]  2%|▏         | 2/100 [00:00<00:10,  9.50it/s]  3%|▎         | 3/100 [00:00<00:11,  8.68it/s]  4%|▍         | 4/100 [00:00<00:10,  8.89it/s]  5%|▌         | 5/100 [00:00<00:10,  8.88it/s]  6%|▌         | 6/100 [00:00<00:10,  8.98it/s]  8%|▊         | 8/100 [00:00<00:09,  9.59it/s]  9%|▉         | 9/100 [00:00<00:09,  9.40it/s] 10%|█         | 10/100 [00:01<00:09,  9.28it/s] 12%|█▏        | 12/100 [00:01<00:09,  9.69it/s] 13%|█▎        | 13/100 [00:01<00:09,  9.39it/s] 14%|█▍        | 14/100 [00:01<00:09,  9.35it/s] 15%|█▌        | 15/100 [00:01<00:09,  9.34it/s] 16%|█▌        | 16/100 [00:01<00:08,  9.48it/s] 17%|█▋        | 17/100 [00:01<00:08,  9.60it/s] 18%|█▊        | 18/100 [00:01<00:08,  9.69it/s] 19%|█▉        | 19/100 [00:02<00:08,  9.50it/s] 20%|██        | 20/100 [00:02<00:08,  9.32it/s] 22%|██▏       | 22/100 [00:02<00:08,  9.61it/s] 23%|██▎       | 23/100 [00:02<00:08,  9.44it/s] 24%|██▍       | 24/100 [00:02<00:08,  9.34it/s] 25%|██▌       | 25/100 [00:02<00:08,  9.20it/s] 26%|██▌       | 26/100 [00:02<00:08,  9.11it/s] 27%|██▋       | 27/100 [00:02<00:08,  8.96it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.95it/s] 29%|██▉       | 29/100 [00:03<00:07,  8.90it/s] 30%|███       | 30/100 [00:03<00:07,  8.88it/s] 31%|███       | 31/100 [00:03<00:07,  8.75it/s] 32%|███▏      | 32/100 [00:03<00:07,  8.93it/s] 33%|███▎      | 33/100 [00:03<00:07,  8.79it/s] 34%|███▍      | 34/100 [00:03<00:08,  8.10it/s] 35%|███▌      | 35/100 [00:03<00:07,  8.27it/s] 36%|███▌      | 36/100 [00:03<00:07,  8.26it/s] 37%|███▋      | 37/100 [00:04<00:07,  8.32it/s] 38%|███▊      | 38/100 [00:04<00:07,  8.26it/s] 39%|███▉      | 39/100 [00:04<00:07,  8.43it/s] 40%|████      | 40/100 [00:04<00:07,  8.44it/s] 41%|████      | 41/100 [00:04<00:06,  8.48it/s] 42%|████▏     | 42/100 [00:04<00:06,  8.68it/s] 43%|████▎     | 43/100 [00:04<00:06,  8.71it/s] 44%|████▍     | 44/100 [00:04<00:06,  8.52it/s] 45%|████▌     | 45/100 [00:05<00:06,  8.51it/s] 46%|████▌     | 46/100 [00:05<00:06,  8.52it/s] 47%|████▋     | 47/100 [00:05<00:06,  8.18it/s] 48%|████▊     | 48/100 [00:05<00:06,  8.06it/s] 49%|████▉     | 49/100 [00:05<00:06,  8.17it/s] 50%|█████     | 50/100 [00:05<00:05,  8.46it/s] 51%|█████     | 51/100 [00:05<00:05,  8.40it/s] 52%|█████▏    | 52/100 [00:05<00:05,  8.37it/s] 53%|█████▎    | 53/100 [00:05<00:05,  8.33it/s] 54%|█████▍    | 54/100 [00:06<00:06,  7.49it/s] 55%|█████▌    | 55/100 [00:06<00:05,  7.77it/s] 56%|█████▌    | 56/100 [00:06<00:05,  7.97it/s] 57%|█████▋    | 57/100 [00:06<00:05,  8.04it/s] 58%|█████▊    | 58/100 [00:06<00:05,  8.24it/s] 59%|█████▉    | 59/100 [00:06<00:04,  8.21it/s] 60%|██████    | 60/100 [00:06<00:04,  8.07it/s] 61%|██████    | 61/100 [00:07<00:04,  8.05it/s] 62%|██████▏   | 62/100 [00:07<00:04,  8.00it/s] 63%|██████▎   | 63/100 [00:07<00:04,  7.82it/s] 64%|██████▍   | 64/100 [00:07<00:04,  7.90it/s] 65%|██████▌   | 65/100 [00:07<00:04,  8.00it/s] 66%|██████▌   | 66/100 [00:07<00:04,  8.18it/s] 67%|██████▋   | 67/100 [00:07<00:04,  7.97it/s] 68%|██████▊   | 68/100 [00:07<00:04,  7.96it/s] 69%|██████▉   | 69/100 [00:08<00:03,  7.77it/s] 70%|███████   | 70/100 [00:08<00:03,  7.87it/s] 71%|███████   | 71/100 [00:08<00:03,  7.76it/s] 72%|███████▏  | 72/100 [00:08<00:03,  7.88it/s] 73%|███████▎  | 73/100 [00:08<00:03,  8.13it/s] 74%|███████▍  | 74/100 [00:08<00:03,  8.17it/s] 75%|███████▌  | 75/100 [00:08<00:03,  6.77it/s] 76%|███████▌  | 76/100 [00:08<00:03,  7.06it/s] 77%|███████▋  | 77/100 [00:09<00:03,  7.34it/s] 78%|███████▊  | 78/100 [00:09<00:02,  7.62it/s] 79%|███████▉  | 79/100 [00:09<00:02,  7.87it/s] 80%|████████  | 80/100 [00:09<00:02,  8.12it/s] 81%|████████  | 81/100 [00:09<00:02,  8.27it/s] 82%|████████▏ | 82/100 [00:09<00:02,  8.38it/s] 83%|████████▎ | 83/100 [00:09<00:02,  8.24it/s] 84%|████████▍ | 84/100 [00:09<00:01,  8.27it/s] 85%|████████▌ | 85/100 [00:10<00:01,  8.17it/s] 86%|████████▌ | 86/100 [00:10<00:01,  8.14it/s] 87%|████████▋ | 87/100 [00:10<00:01,  7.99it/s] 88%|████████▊ | 88/100 [00:10<00:01,  8.03it/s] 89%|████████▉ | 89/100 [00:10<00:01,  8.00it/s] 90%|█████████ | 90/100 [00:10<00:01,  7.99it/s] 91%|█████████ | 91/100 [00:10<00:01,  7.81it/s] 92%|█████████▏| 92/100 [00:10<00:01,  7.79it/s] 93%|█████████▎| 93/100 [00:11<00:00,  7.78it/s] 94%|█████████▍| 94/100 [00:11<00:00,  7.80it/s] 95%|█████████▌| 95/100 [00:11<00:00,  7.76it/s] 96%|█████████▌| 96/100 [00:11<00:00,  8.03it/s] 97%|█████████▋| 97/100 [00:11<00:00,  8.08it/s] 98%|█████████▊| 98/100 [00:11<00:00,  8.04it/s] 99%|█████████▉| 99/100 [00:11<00:00,  7.98it/s]100%|██████████| 100/100 [00:11<00:00,  8.08it/s]100%|██████████| 100/100 [00:11<00:00,  8.38it/s]
[I 2025-08-31 05:06:35,715] A new study created in memory with name: no-name-25dfb77e-f085-40df-b62f-aa431e4f3751
👉 train samples(학습 샘플(bag))=141, batch_size=16 -> steps(샘플수/batch크기)=9
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 24.81 MB
Memory Reserved: 36.00 MB
cuda
CUDA OOM 발생 — 단계적 백오프 시작.
[OOM RETRY] batch_size 16 → 8 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=141, batch_size=8 -> steps(샘플수/batch크기)=18
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 2125.43 MB
Memory Reserved: 2136.00 MB
cuda
[OOM RETRY] batch_size=8에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 16 → 4 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=141, batch_size=4 -> steps(샘플수/batch크기)=36
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 3175.96 MB
Memory Reserved: 3186.00 MB
cuda
Epoch 1, Train Loss 1.119365, Valid_loss 0.943340
Epoch 2, Train Loss 1.014037, Valid_loss 0.921192
Epoch 3, Train Loss 1.063938, Valid_loss 0.894356
Epoch 4, Train Loss 0.996612, Valid_loss 0.868042
Epoch 5, Train Loss 0.941349, Valid_loss 0.833994
Epoch 6, Train Loss 0.899899, Valid_loss 0.771093
Epoch 7, Train Loss 0.922529, Valid_loss 0.790482
Epoch 8, Train Loss 0.910641, Valid_loss 0.754440
Epoch 9, Train Loss 0.860795, Valid_loss 0.766157
Epoch 10, Train Loss 0.834947, Valid_loss 0.754766
Epoch 11, Train Loss 0.813398, Valid_loss 0.761025
Epoch 12, Train Loss 0.866043, Valid_loss 0.814172
Epoch 13, Train Loss 0.844580, Valid_loss 0.757908
Epoch 14, Train Loss 0.756745, Valid_loss 0.734671
Epoch 15, Train Loss 0.833411, Valid_loss 0.772729
Epoch 16, Train Loss 0.738140, Valid_loss 0.785065
Epoch 17, Train Loss 0.831639, Valid_loss 0.806303
Epoch 18, Train Loss 0.803786, Valid_loss 0.823540
Epoch 19, Train Loss 0.768142, Valid_loss 0.783484
Epoch 20, Train Loss 0.783892, Valid_loss 0.695268
Epoch 21, Train Loss 0.769661, Valid_loss 0.804282
Epoch 22, Train Loss 0.728811, Valid_loss 0.763369
Epoch 23, Train Loss 0.761845, Valid_loss 0.745381
Epoch 24, Train Loss 0.711567, Valid_loss 0.703205
Epoch 25, Train Loss 0.714850, Valid_loss 0.735663
Epoch 26, Train Loss 0.706448, Valid_loss 0.703321
Epoch 27, Train Loss 0.688565, Valid_loss 0.715121
Epoch 28, Train Loss 0.712576, Valid_loss 0.733472
Epoch 29, Train Loss 0.651655, Valid_loss 0.725275
Epoch 30, Train Loss 0.681208, Valid_loss 0.744048
Epoch 31, Train Loss 0.723991, Valid_loss 0.732609
Epoch 32, Train Loss 0.656102, Valid_loss 0.731088
Epoch 33, Train Loss 0.710638, Valid_loss 0.684422
Epoch 34, Train Loss 0.674595, Valid_loss 0.781268
Epoch 35, Train Loss 0.657776, Valid_loss 0.677092
Epoch 36, Train Loss 0.692642, Valid_loss 0.748333
Epoch 37, Train Loss 0.704499, Valid_loss 0.694321
Epoch 38, Train Loss 0.604125, Valid_loss 0.624021
Epoch 39, Train Loss 0.624677, Valid_loss 0.686351
Epoch 40, Train Loss 0.683107, Valid_loss 0.640050
Epoch 41, Train Loss 0.610845, Valid_loss 0.645557
Epoch 42, Train Loss 0.597370, Valid_loss 0.600638
Epoch 43, Train Loss 0.587650, Valid_loss 0.654580
Epoch 44, Train Loss 0.607531, Valid_loss 0.607890
Epoch 45, Train Loss 0.616379, Valid_loss 0.685097
Epoch 46, Train Loss 0.533079, Valid_loss 0.609253
Epoch 47, Train Loss 0.545656, Valid_loss 0.648052
Epoch 48, Train Loss 0.561062, Valid_loss 0.713040
Epoch 49, Train Loss 0.658136, Valid_loss 0.552148
Epoch 50, Train Loss 0.612093, Valid_loss 0.588646
Epoch 51, Train Loss 0.595855, Valid_loss 0.633888
Epoch 52, Train Loss 0.554774, Valid_loss 0.634516
[I 2025-08-31 05:17:42,208] Trial 0 finished with value: 0.55214819028264 and parameters: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 4, 'dropout': 0.3, 'weight_decay': 0.01, 'emb_dim': 8, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.55214819028264.
👉 train samples(학습 샘플(bag))=141, batch_size=16 -> steps(샘플수/batch크기)=9
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 1075.34 MB
Memory Reserved: 1086.00 MB
cuda
CUDA OOM 발생 — 단계적 백오프 시작.
[OOM RETRY] batch_size 16 → 8 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=141, batch_size=8 -> steps(샘플수/batch크기)=18
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 3175.96 MB
Memory Reserved: 3186.00 MB
cuda
[OOM RETRY] batch_size=8에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 16 → 4 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=141, batch_size=4 -> steps(샘플수/batch크기)=36
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 4226.48 MB
Memory Reserved: 4238.00 MB
cuda
Epoch 1, Train Loss 1.001895, Valid_loss 1.030984
Epoch 2, Train Loss 0.932060, Valid_loss 1.003297
Epoch 3, Train Loss 0.934739, Valid_loss 0.984647
Epoch 4, Train Loss 0.959163, Valid_loss 0.981984
Epoch 5, Train Loss 0.975983, Valid_loss 1.002875
Epoch 6, Train Loss 0.932115, Valid_loss 0.995191
Epoch 7, Train Loss 0.950594, Valid_loss 0.995825
Epoch 8, Train Loss 0.953005, Valid_loss 1.007452
Epoch 9, Train Loss 0.975904, Valid_loss 1.024436
Epoch 10, Train Loss 0.934084, Valid_loss 1.000886
Epoch 11, Train Loss 0.953963, Valid_loss 0.987928
Epoch 12, Train Loss 0.927559, Valid_loss 1.011845
Epoch 13, Train Loss 0.930803, Valid_loss 1.009328
Epoch 14, Train Loss 0.938322, Valid_loss 1.008708
Epoch 15, Train Loss 0.926637, Valid_loss 1.000250
Epoch 16, Train Loss 0.924185, Valid_loss 1.007895
Epoch 17, Train Loss 0.935902, Valid_loss 1.012139
Epoch 18, Train Loss 0.921572, Valid_loss 1.001273
Epoch 19, Train Loss 0.920703, Valid_loss 1.005249
Epoch 20, Train Loss 0.933381, Valid_loss 1.006703
Epoch 21, Train Loss 0.919397, Valid_loss 0.998694
Epoch 22, Train Loss 0.916620, Valid_loss 0.997636
Epoch 23, Train Loss 0.916949, Valid_loss 1.029145
Epoch 24, Train Loss 0.925196, Valid_loss 1.019724
Epoch 25, Train Loss 0.916837, Valid_loss 1.025132
Epoch 26, Train Loss 0.931200, Valid_loss 1.024198
Epoch 27, Train Loss 0.922484, Valid_loss 0.997807
Epoch 28, Train Loss 0.918697, Valid_loss 1.000973
Epoch 29, Train Loss 0.914630, Valid_loss 1.005066
Epoch 30, Train Loss 0.933952, Valid_loss 1.016665
Epoch 31, Train Loss 0.918749, Valid_loss 1.009476
Epoch 32, Train Loss 0.918423, Valid_loss 1.006219
Epoch 33, Train Loss 0.954592, Valid_loss 1.001512
Epoch 34, Train Loss 0.919350, Valid_loss 1.001255
Epoch 35, Train Loss 0.918132, Valid_loss 1.009390
Epoch 36, Train Loss 0.918205, Valid_loss 1.015455
Epoch 37, Train Loss 0.917577, Valid_loss 1.008208
Epoch 38, Train Loss 0.916884, Valid_loss 1.011813
Epoch 39, Train Loss 0.930648, Valid_loss 1.004052
Epoch 40, Train Loss 0.932600, Valid_loss 1.001617
Epoch 41, Train Loss 0.951661, Valid_loss 0.999484
Epoch 42, Train Loss 0.930110, Valid_loss 1.003016
Epoch 43, Train Loss 0.934545, Valid_loss 1.007265
Epoch 44, Train Loss 0.932895, Valid_loss 0.997828
Epoch 45, Train Loss 0.919016, Valid_loss 0.997345
Epoch 46, Train Loss 0.919237, Valid_loss 0.999045
Epoch 47, Train Loss 0.917164, Valid_loss 1.006830
Epoch 48, Train Loss 0.932813, Valid_loss 1.014026
Epoch 49, Train Loss 0.919180, Valid_loss 1.006431
Epoch 50, Train Loss 0.933349, Valid_loss 1.011401
Epoch 51, Train Loss 0.930550, Valid_loss 1.005531
Epoch 52, Train Loss 0.917981, Valid_loss 0.998949
Epoch 53, Train Loss 0.917820, Valid_loss 1.005045
Epoch 54, Train Loss 0.916771, Valid_loss 1.006582
[I 2025-08-31 05:29:21,493] Trial 1 finished with value: 0.9819835254124233 and parameters: {'learning_rate': 0.01, 'epochs': 100, 'heads': 4, 'dropout': 0.5, 'weight_decay': 0.001, 'emb_dim': 8, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.55214819028264.
👉 train samples(학습 샘플(bag))=141, batch_size=16 -> steps(샘플수/batch크기)=9
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 4227.80 MB
Memory Reserved: 4238.00 MB
cuda
CUDA OOM 발생 — 단계적 백오프 시작.
[OOM RETRY] batch_size 16 → 8 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=141, batch_size=8 -> steps(샘플수/batch크기)=18
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 6329.74 MB
Memory Reserved: 6340.00 MB
cuda
[OOM RETRY] batch_size=8에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 16 → 4 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=141, batch_size=4 -> steps(샘플수/batch크기)=36
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 5279.65 MB
Memory Reserved: 5290.00 MB
cuda
Epoch 1, Train Loss 1.031278, Valid_loss 1.018706
Epoch 2, Train Loss 1.033115, Valid_loss 0.956732
Epoch 3, Train Loss 1.032981, Valid_loss 1.004392
Epoch 4, Train Loss 0.959176, Valid_loss 0.973546
Epoch 5, Train Loss 0.921972, Valid_loss 1.050149
Epoch 6, Train Loss 0.976675, Valid_loss 0.998948
Epoch 7, Train Loss 0.928482, Valid_loss 1.034939
Epoch 8, Train Loss 0.970938, Valid_loss 0.966543
Epoch 9, Train Loss 0.953726, Valid_loss 1.011476
Epoch 10, Train Loss 0.953982, Valid_loss 1.005721
Epoch 11, Train Loss 0.946651, Valid_loss 0.990412
Epoch 12, Train Loss 0.944704, Valid_loss 0.981902
Epoch 13, Train Loss 0.926738, Valid_loss 1.001071
Epoch 14, Train Loss 0.935119, Valid_loss 1.012442
Epoch 15, Train Loss 0.946767, Valid_loss 1.018765
Epoch 16, Train Loss 0.920939, Valid_loss 1.020296
Epoch 17, Train Loss 0.924803, Valid_loss 1.002205
Epoch 18, Train Loss 0.925812, Valid_loss 1.005158
Epoch 19, Train Loss 0.946752, Valid_loss 1.024914
Epoch 20, Train Loss 0.933048, Valid_loss 1.007105
Epoch 21, Train Loss 0.919885, Valid_loss 1.000947
Epoch 22, Train Loss 0.913308, Valid_loss 0.988139
Epoch 23, Train Loss 0.910964, Valid_loss 1.042598
Epoch 24, Train Loss 0.936221, Valid_loss 1.019807
Epoch 25, Train Loss 0.917989, Valid_loss 1.009266
Epoch 26, Train Loss 0.915087, Valid_loss 1.029609
Epoch 27, Train Loss 0.941161, Valid_loss 1.004748
Epoch 28, Train Loss 0.919555, Valid_loss 1.009551
Epoch 29, Train Loss 0.924546, Valid_loss 1.004376
Epoch 30, Train Loss 0.918872, Valid_loss 1.013555
Epoch 31, Train Loss 0.932383, Valid_loss 1.008294
Epoch 32, Train Loss 0.932099, Valid_loss 1.006065
Epoch 33, Train Loss 0.953797, Valid_loss 0.997420
Epoch 34, Train Loss 0.933736, Valid_loss 1.005775
Epoch 35, Train Loss 0.937664, Valid_loss 0.998658
Epoch 36, Train Loss 0.918085, Valid_loss 1.001112
Epoch 37, Train Loss 0.919166, Valid_loss 1.026640
Epoch 38, Train Loss 0.920989, Valid_loss 1.007725
Epoch 39, Train Loss 0.918825, Valid_loss 1.005832
Epoch 40, Train Loss 0.949500, Valid_loss 1.017134
Epoch 41, Train Loss 0.921122, Valid_loss 1.011414
Epoch 42, Train Loss 0.918211, Valid_loss 1.015916
Epoch 43, Train Loss 0.927428, Valid_loss 1.006011
Epoch 44, Train Loss 0.940077, Valid_loss 1.001712
Epoch 45, Train Loss 0.915776, Valid_loss 1.002901
Epoch 46, Train Loss 0.935394, Valid_loss 1.004714
Epoch 47, Train Loss 0.920077, Valid_loss 0.998171
Epoch 48, Train Loss 0.918830, Valid_loss 1.001456
Epoch 49, Train Loss 0.917354, Valid_loss 1.016009
Epoch 50, Train Loss 0.918220, Valid_loss 1.009744
Epoch 51, Train Loss 0.921006, Valid_loss 1.011952
Epoch 52, Train Loss 0.914804, Valid_loss 1.012066
[I 2025-08-31 05:40:40,517] Trial 2 finished with value: 0.9567324632690066 and parameters: {'learning_rate': 0.01, 'epochs': 100, 'heads': 4, 'dropout': 0.7, 'weight_decay': 0.001, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.55214819028264.
선택된 trial params: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 4, 'dropout': 0.3, 'weight_decay': 0.01, 'emb_dim': 8, 'augment_num': 100, 'pca': False}
👉 train samples(학습 샘플(bag))=141, batch_size=16 -> steps(샘플수/batch크기)=9
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=15, batch_size=1 -> steps=15
Memory Allocated: 5278.33 MB
Memory Reserved: 5290.00 MB
cuda
CUDA OOM 발생 — 단계적 백오프 시작.
[OOM RETRY] batch_size 16 → 8 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=141, batch_size=8 -> steps(샘플수/batch크기)=18
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=15, batch_size=1 -> steps=15
Memory Allocated: 7378.95 MB
Memory Reserved: 7390.00 MB
cuda
[OOM RETRY] batch_size=8에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 16 → 4 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=141, batch_size=4 -> steps(샘플수/batch크기)=36
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=15, batch_size=1 -> steps=15
Memory Allocated: 8429.47 MB
Memory Reserved: 8440.00 MB
cuda
[OOM RETRY] batch_size=4에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 16 → 2 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=141, batch_size=2 -> steps(샘플수/batch크기)=71
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=15, batch_size=1 -> steps=15
Memory Allocated: 12972.16 MB
Memory Reserved: 12980.00 MB
cuda
Epoch 1, Train Loss 1.032888, Valid_loss 1.023257
Epoch 2, Train Loss 0.983353, Valid_loss 0.962811
Epoch 3, Train Loss 0.964428, Valid_loss 0.903716
Epoch 4, Train Loss 0.946717, Valid_loss 0.888979
Epoch 5, Train Loss 0.909689, Valid_loss 0.872304
Epoch 6, Train Loss 0.895225, Valid_loss 0.859438
Epoch 7, Train Loss 0.897003, Valid_loss 0.839447
Epoch 8, Train Loss 0.893139, Valid_loss 0.830368
Epoch 9, Train Loss 0.846016, Valid_loss 0.812411
Epoch 10, Train Loss 0.853672, Valid_loss 0.828901
Epoch 11, Train Loss 0.879297, Valid_loss 0.812739
Epoch 12, Train Loss 0.842858, Valid_loss 0.858201
Epoch 13, Train Loss 0.865220, Valid_loss 0.745250
Epoch 14, Train Loss 0.819321, Valid_loss 0.766496
Epoch 15, Train Loss 0.764920, Valid_loss 0.748151
Epoch 16, Train Loss 0.822844, Valid_loss 0.759640
Epoch 17, Train Loss 0.773997, Valid_loss 0.837636
Epoch 18, Train Loss 0.761074, Valid_loss 0.731853
Epoch 19, Train Loss 0.779993, Valid_loss 0.712241
Epoch 20, Train Loss 0.726439, Valid_loss 0.832237
Epoch 21, Train Loss 0.758537, Valid_loss 0.716867
Epoch 22, Train Loss 0.691685, Valid_loss 0.703712
Epoch 23, Train Loss 0.751086, Valid_loss 0.677415
Epoch 24, Train Loss 0.730617, Valid_loss 0.798177
Epoch 25, Train Loss 0.717904, Valid_loss 0.719727
Epoch 26, Train Loss 0.668716, Valid_loss 0.754460
Epoch 27, Train Loss 0.688835, Valid_loss 0.710122
Epoch 28, Train Loss 0.646211, Valid_loss 0.760415
Epoch 29, Train Loss 0.685407, Valid_loss 0.623661
Epoch 30, Train Loss 0.637954, Valid_loss 0.768461
Epoch 31, Train Loss 0.654758, Valid_loss 0.692659
Epoch 32, Train Loss 0.645696, Valid_loss 0.777434
Epoch 33, Train Loss 0.650868, Valid_loss 0.588785
Epoch 34, Train Loss 0.710495, Valid_loss 0.552154
Epoch 35, Train Loss 0.636301, Valid_loss 0.723352
Epoch 36, Train Loss 0.640506, Valid_loss 0.638796
Epoch 37, Train Loss 0.635855, Valid_loss 0.721748
Epoch 38, Train Loss 0.616764, Valid_loss 0.615361
Epoch 39, Train Loss 0.632268, Valid_loss 0.772732
Epoch 40, Train Loss 0.605002, Valid_loss 0.671867
Epoch 41, Train Loss 0.575811, Valid_loss 0.692564
Epoch 42, Train Loss 0.606003, Valid_loss 0.662904
Epoch 43, Train Loss 0.547126, Valid_loss 0.643216
Epoch 44, Train Loss 0.571176, Valid_loss 0.701057
Epoch 45, Train Loss 0.532770, Valid_loss 0.666441
Epoch 46, Train Loss 0.583427, Valid_loss 0.677777
Epoch 47, Train Loss 0.567807, Valid_loss 0.765470
Epoch 48, Train Loss 0.562367, Valid_loss 0.648927
Epoch 49, Train Loss 0.521782, Valid_loss 0.658766
Epoch 50, Train Loss 0.591408, Valid_loss 0.611222
Epoch 51, Train Loss 0.494775, Valid_loss 0.717394
Epoch 52, Train Loss 0.535066, Valid_loss 0.620620
Epoch 53, Train Loss 0.536254, Valid_loss 0.686632
Epoch 54, Train Loss 0.522727, Valid_loss 0.647706
Epoch 55, Train Loss 0.560072, Valid_loss 0.675339
Epoch 56, Train Loss 0.551091, Valid_loss 0.685556
환자ID=163-5 -- true: [[0]] -- pred: tensor([[ 0.3596, -0.4383,  0.0281]], device='cuda:0')
환자ID=27-10053 -- true: [[1]] -- pred: tensor([[-0.0807,  1.0900, -0.5965]], device='cuda:0')
환자ID=27-10112 -- true: [[1]] -- pred: tensor([[-0.0629,  1.0170, -0.2378]], device='cuda:0')
환자ID=28-12381 -- true: [[1]] -- pred: tensor([[-0.0692,  0.9828, -0.2390]], device='cuda:0')
환자ID=29-10011 -- true: [[1]] -- pred: tensor([[-0.0758,  0.8120,  0.0703]], device='cuda:0')
환자ID=29-10016 -- true: [[1]] -- pred: tensor([[-0.0991,  0.9944, -0.7084]], device='cuda:0')
환자ID=29-10280 -- true: [[1]] -- pred: tensor([[-0.0572,  1.0576, -0.3894]], device='cuda:0')
환자ID=30-10034 -- true: [[2]] -- pred: tensor([[-0.0544,  1.0030, -0.3213]], device='cuda:0')
환자ID=30-11051 -- true: [[2]] -- pred: tensor([[-0.1258,  0.6714,  0.1993]], device='cuda:0')
환자ID=31-10078 -- true: [[1]] -- pred: tensor([[-0.0596,  1.0533, -0.4949]], device='cuda:0')
환자ID=34-10187 -- true: [[2]] -- pred: tensor([[-0.0745,  1.0830, -0.5687]], device='cuda:0')
환자ID=PRE062-1 -- true: [[0]] -- pred: tensor([[ 0.9723, -0.7974, -0.4382]], device='cuda:0')
환자ID=PRE98sc -- true: [[0]] -- pred: tensor([[ 0.9437, -0.7078, -0.5387]], device='cuda:0')
환자ID=Sample1157-EO2 -- true: [[0]] -- pred: tensor([[ 0.9543, -0.7021, -0.5446]], device='cuda:0')
환자ID=Sample1157-EO3 -- true: [[0]] -- pred: tensor([[ 0.9805, -0.7609, -0.5020]], device='cuda:0')
Best performance: Epoch 34, Loss 0.710495, Test ACC 0.800000, Test AUC 0.776190, Test Recall 0.666667, Test Precision 0.566667
Confusion Matrix:
 [[5 0 0]
 [0 7 0]
 [0 3 0]]
✅ Total valid splits used: 5

📌 Repeat 1: 평균 AUC = 0.8633, 표준편차 = 0.0917
Test ACC 평균 0.790833, Test Recall 평균 0.640000, Test Precision 평균 0.566667
fold_aucs = [0.8958333333333334, 0.9444444444444443, 0.734920634920635, 0.9650793650793651, 0.7761904761904762]
NaN 개수: 0 / 전체 5개

🔁 Repeat 2, Fold 0
cell type :  S2008000605HRT_AAACCCAGTGCACATT-1     Epithelial_cells
S2008000605HRT_AAACCCAGTGCCTACG-1     Epithelial_cells
S2008000605HRT_AAAGAACGTAGAGACC-1            Astrocyte
S2008000605HRT_AAAGAACGTCGGAACA-1     Epithelial_cells
S2008000605HRT_AAAGAACGTTAACAGA-1     Epithelial_cells
                                           ...        
Sample1162EO2_TTTGGAGAGCAGGCAT-1      Epithelial_cells
Sample1162EO2_TTTGGAGAGTCGCGAA-1     Endothelial_cells
Sample1162EO2_TTTGGAGAGTGCTCGC-1           Hepatocytes
Sample1162EO2_TTTGGAGGTGATACTC-1      Epithelial_cells
Sample1162EO2_TTTGGTTCAGTAGAAT-1      Epithelial_cells
Name: singler_annotation, Length: 176846, dtype: string
cell type annotation :  S2008000605HRT_AAACCCAGTGCACATT-1     Epithelial_cells
S2008000605HRT_AAACCCAGTGCCTACG-1     Epithelial_cells
S2008000605HRT_AAAGAACGTAGAGACC-1            Astrocyte
S2008000605HRT_AAAGAACGTCGGAACA-1     Epithelial_cells
S2008000605HRT_AAAGAACGTTAACAGA-1     Epithelial_cells
                                           ...        
Sample1162EO2_TTTGGAGAGCAGGCAT-1      Epithelial_cells
Sample1162EO2_TTTGGAGAGTCGCGAA-1     Endothelial_cells
Sample1162EO2_TTTGGAGAGTGCTCGC-1           Hepatocytes
Sample1162EO2_TTTGGAGGTGATACTC-1      Epithelial_cells
Sample1162EO2_TTTGGTTCAGTAGAAT-1      Epithelial_cells
Name: singler_annotation, Length: 176846, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Epithelial_cells', 'Astrocyte', 'MSC', 'Keratinocytes', 'Neurons', 'Endothelial_cells', 'Fibroblasts', 'Tissue_stem_cells', 'Smooth_muscle_cells', 'T_cells', 'Neuroepithelial_cell', 'NK_cell', 'Chondrocytes', 'Osteoblasts', 'Monocyte', 'Hepatocytes', 'Macrophage', 'CMP', 'Embryonic_stem_cells', 'DC', 'BM & Prog.', 'MEP', 'Neutrophils', 'Pro-Myelocyte', 'iPS_cells', 'Pre-B_cell_CD34-', 'HSC_-G-CSF', 'B_cell', 'BM', 'Platelets', 'GMP', 'HSC_CD34+', 'Pro-B_cell_CD34+', 'Erythroblast', 'Myelocyte', 'Unknown', 'Gametocytes']
라벨별 그룹 개수 {0: 20, 1: 29, 2: 12}
cell type :  S2008000628HRT_AAACCCAAGACGCTCC-1                     DC
S2008000628HRT_AAACCCAAGTAGCCAG-1                T_cells
S2008000628HRT_AAACCCAGTCCAGAAG-1                T_cells
S2008000628HRT_AAACCCAGTGTATCCA-1                 B_cell
S2008000628HRT_AAACGAAAGCGTTAGG-1            Fibroblasts
                                            ...         
Sample1153EO2_TTTGATCAGACTGAGC-1               iPS_cells
Sample1153EO2_TTTGATCAGATGCTAA-1     Smooth_muscle_cells
Sample1153EO2_TTTGATCTCAGAGCAG-1        Epithelial_cells
Sample1153EO2_TTTGGAGCAAACTCGT-1       Endothelial_cells
Sample1153EO2_TTTGGAGGTTCGAACT-1                 NK_cell
Name: singler_annotation, Length: 48331, dtype: string
cell type annotation :  S2008000628HRT_AAACCCAAGACGCTCC-1                     DC
S2008000628HRT_AAACCCAAGTAGCCAG-1                T_cells
S2008000628HRT_AAACCCAGTCCAGAAG-1                T_cells
S2008000628HRT_AAACCCAGTGTATCCA-1                 B_cell
S2008000628HRT_AAACGAAAGCGTTAGG-1            Fibroblasts
                                            ...         
Sample1153EO2_TTTGATCAGACTGAGC-1               iPS_cells
Sample1153EO2_TTTGATCAGATGCTAA-1     Smooth_muscle_cells
Sample1153EO2_TTTGATCTCAGAGCAG-1        Epithelial_cells
Sample1153EO2_TTTGGAGCAAACTCGT-1       Endothelial_cells
Sample1153EO2_TTTGGAGGTTCGAACT-1                 NK_cell
Name: singler_annotation, Length: 48331, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['DC', 'T_cells', 'B_cell', 'Fibroblasts', 'Macrophage', 'Monocyte', 'HSC_-G-CSF', 'Pre-B_cell_CD34-', 'Neutrophils', 'GMP', 'Smooth_muscle_cells', 'MSC', 'NK_cell', 'Epithelial_cells', 'iPS_cells', 'HSC_CD34+', 'Chondrocytes', 'Platelets', 'Pro-B_cell_CD34+', 'Myelocyte', 'Osteoblasts', 'BM', 'Pro-Myelocyte', 'Endothelial_cells', 'Tissue_stem_cells', 'CMP', 'Astrocyte', 'Hepatocytes', 'Neurons', 'Keratinocytes', 'Neuroepithelial_cell', 'Embryonic_stem_cells', 'MEP', 'BM & Prog.', 'Erythroblast', 'Gametocytes', 'Unknown']
라벨별 그룹 개수 {0: 6, 1: 8, 2: 2}
🔍 Split #1
  → train_p_index 환자 수 (환자 단위로 묶인 index list): 61
  → test_p_index 환자 수  (환자 단위로 묶인 index list): 16
  → train 환자 ID: ['163-3', '163-4', '163-5', '164-3', '164-6', '165-9', '27-10039', '27-10053', '27-10071', '27-10112', '27-10119', '28-11515', '28-12263', '28-12381', '28-12490', '28-12518', '29-10008', '29-10010', '29-10011', '29-10012', '29-10013', '29-10380', '29-10386', '29-10400', '29-10404', '29-10406', '29-10410', '30-10018', '30-10034', '30-10123', '30-10125', '30-10929', '31-10000', '31-10013', '31-10035', '31-10040', '31-10042', '31-10078', '31-10210', '31-10236', '32-10003', '32-10034', '32-10074', '33-10005', '33-10006', '34-10050', '34-10187', 'PRE019', 'PRE027', 'PRE038', 'PRE062-1', 'PRE98sc', 'Sample1153-EO3', 'Sample1157-EO1', 'Sample1157-EO2', 'Sample1157-EO3', 'Sample1158-EO1', 'Sample1158-EO2', 'Sample1158-EO3', 'Sample1162-EO1', 'Sample1162-EO2']
  → test  환자 ID: ['163-2', '164-10', '27-10041', '28-10051', '29-10006', '29-10016', '29-10280', '29-10398', '30-11051', '31-10001', '31-10154', '34-10184', 'PRE018-1', 'PRE055-1', 'Sample1153-EO1', 'Sample1153-EO2']
  → train 환자 ID 및 라벨:
    ID: 163-3, Label: 0
    ID: 163-4, Label: 0
    ID: 163-5, Label: 0
    ID: 164-3, Label: 0
    ID: 164-6, Label: 0
    ID: 165-9, Label: 0
    ID: 27-10039, Label: 1
    ID: 27-10053, Label: 1
    ID: 27-10071, Label: 1
    ID: 27-10112, Label: 1
    ID: 27-10119, Label: 1
    ID: 28-11515, Label: 1
    ID: 28-12263, Label: 1
    ID: 28-12381, Label: 1
    ID: 28-12490, Label: 1
    ID: 28-12518, Label: 1
    ID: 29-10008, Label: 1
    ID: 29-10010, Label: 1
    ID: 29-10011, Label: 1
    ID: 29-10012, Label: 1
    ID: 29-10013, Label: 1
    ID: 29-10380, Label: 1
    ID: 29-10386, Label: 1
    ID: 29-10400, Label: 1
    ID: 29-10404, Label: 1
    ID: 29-10406, Label: 1
    ID: 29-10410, Label: 1
    ID: 30-10018, Label: 2
    ID: 30-10034, Label: 2
    ID: 30-10123, Label: 2
    ID: 30-10125, Label: 2
    ID: 30-10929, Label: 2
    ID: 31-10000, Label: 1
    ID: 31-10013, Label: 1
    ID: 31-10035, Label: 1
    ID: 31-10040, Label: 1
    ID: 31-10042, Label: 1
    ID: 31-10078, Label: 1
    ID: 31-10210, Label: 1
    ID: 31-10236, Label: 1
    ID: 32-10003, Label: 2
    ID: 32-10034, Label: 2
    ID: 32-10074, Label: 2
    ID: 33-10005, Label: 2
    ID: 33-10006, Label: 2
    ID: 34-10050, Label: 2
    ID: 34-10187, Label: 2
    ID: PRE019, Label: 0
    ID: PRE027, Label: 0
    ID: PRE038, Label: 0
    ID: PRE062-1, Label: 0
    ID: PRE98sc, Label: 0
    ID: Sample1153-EO3, Label: 0
    ID: Sample1157-EO1, Label: 0
    ID: Sample1157-EO2, Label: 0
    ID: Sample1157-EO3, Label: 0
    ID: Sample1158-EO1, Label: 0
    ID: Sample1158-EO2, Label: 0
    ID: Sample1158-EO3, Label: 0
    ID: Sample1162-EO1, Label: 0
    ID: Sample1162-EO2, Label: 0
  → test 환자 ID 및 라벨:
    ID: 163-2, Label: 0
    ID: 164-10, Label: 0
    ID: 27-10041, Label: 1
    ID: 28-10051, Label: 1
    ID: 29-10006, Label: 1
    ID: 29-10016, Label: 1
    ID: 29-10280, Label: 1
    ID: 29-10398, Label: 1
    ID: 30-11051, Label: 2
    ID: 31-10001, Label: 1
    ID: 31-10154, Label: 1
    ID: 34-10184, Label: 2
    ID: PRE018-1, Label: 0
    ID: PRE055-1, Label: 0
    ID: Sample1153-EO1, Label: 0
    ID: Sample1153-EO2, Label: 0
전체 데이터 index 길이 77
label_stat (train 환자 라벨 목록) 갯수 61
train_data에서 환자 단위로, train과 validation 나누기
기존 train_p_index 61
기존 (train) label_stat 61
train-vali 분할 후! 
train y 의 classes : {0, 1, 2} valid y 의 classes : {0, 1, 2} label_stat 의 classes : {0, 1, 2}
train_p_index_ 40
valid_p_index 21
test_p_index 16
→ train 환자 ID 및 라벨:
   총 개수: 40
   환자ID=29-10380, Label=1, 셀개수=4799
   환자ID=31-10210, Label=1, 셀개수=3510
   환자ID=Sample1157-EO2, Label=0, 셀개수=1395
   환자ID=Sample1158-EO2, Label=0, 셀개수=1427
   환자ID=32-10034, Label=2, 셀개수=1555
   환자ID=164-3, Label=0, 셀개수=1639
   환자ID=29-10010, Label=1, 셀개수=5305
   환자ID=PRE038, Label=0, 셀개수=2666
   환자ID=31-10013, Label=1, 셀개수=3161
   환자ID=30-10929, Label=2, 셀개수=5812
   환자ID=163-4, Label=0, 셀개수=1339
   환자ID=28-11515, Label=1, 셀개수=930
   환자ID=27-10039, Label=1, 셀개수=4638
   환자ID=27-10053, Label=1, 셀개수=728
   환자ID=163-3, Label=0, 셀개수=1335
   환자ID=30-10034, Label=2, 셀개수=1240
   환자ID=31-10040, Label=1, 셀개수=4543
   환자ID=30-10125, Label=2, 셀개수=3798
   환자ID=29-10400, Label=1, 셀개수=2684
   환자ID=31-10035, Label=1, 셀개수=2974
   환자ID=163-5, Label=0, 셀개수=1210
   환자ID=32-10003, Label=2, 셀개수=2978
   환자ID=PRE98sc, Label=0, 셀개수=1568
   환자ID=29-10410, Label=1, 셀개수=2834
   환자ID=28-12381, Label=1, 셀개수=1099
   환자ID=Sample1162-EO1, Label=0, 셀개수=1053
   환자ID=31-10042, Label=1, 셀개수=1222
   환자ID=PRE019, Label=0, 셀개수=3795
   환자ID=27-10119, Label=1, 셀개수=3346
   환자ID=29-10008, Label=1, 셀개수=1913
   환자ID=28-12263, Label=1, 셀개수=7527
   환자ID=165-9, Label=0, 셀개수=2926
   환자ID=29-10406, Label=1, 셀개수=3484
   환자ID=34-10050, Label=2, 셀개수=4784
   환자ID=29-10386, Label=1, 셀개수=802
   환자ID=33-10005, Label=2, 셀개수=8904
   환자ID=32-10074, Label=2, 셀개수=6304
   환자ID=31-10236, Label=1, 셀개수=3458
   환자ID=29-10013, Label=1, 셀개수=3706
   환자ID=28-12518, Label=1, 셀개수=1215
→ valid 환자 ID 및 라벨:
   총 개수: 21
   환자ID=Sample1162-EO2, Label=0, 셀개수=1510
   환자ID=29-10012, Label=1, 셀개수=6245
   환자ID=31-10078, Label=1, 셀개수=2827
   환자ID=Sample1153-EO3, Label=0, 셀개수=1516
   환자ID=Sample1158-EO1, Label=0, 셀개수=574
   환자ID=PRE062-1, Label=0, 셀개수=907
   환자ID=Sample1157-EO3, Label=0, 셀개수=807
   환자ID=30-10123, Label=2, 셀개수=1273
   환자ID=31-10000, Label=1, 셀개수=8870
   환자ID=30-10018, Label=2, 셀개수=5170
   환자ID=Sample1158-EO3, Label=0, 셀개수=1096
   환자ID=27-10112, Label=1, 셀개수=1470
   환자ID=29-10404, Label=1, 셀개수=3988
   환자ID=Sample1157-EO1, Label=0, 셀개수=1152
   환자ID=34-10187, Label=2, 셀개수=3739
   환자ID=PRE027, Label=0, 셀개수=2078
   환자ID=164-6, Label=0, 셀개수=3038
   환자ID=29-10011, Label=1, 셀개수=3072
   환자ID=27-10071, Label=1, 셀개수=1478
   환자ID=28-12490, Label=1, 셀개수=5973
   환자ID=33-10006, Label=2, 셀개수=457
→ test 환자 ID 및 라벨:
   총 개수: 16
   환자ID=163-2, Label=0, 셀개수=2535
   환자ID=164-10, Label=0, 셀개수=4041
   환자ID=27-10041, Label=1, 셀개수=2145
   환자ID=28-10051, Label=1, 셀개수=300
   환자ID=29-10006, Label=1, 셀개수=11461
   환자ID=29-10016, Label=1, 셀개수=4854
   환자ID=29-10280, Label=1, 셀개수=2375
   환자ID=29-10398, Label=1, 셀개수=3993
   환자ID=30-11051, Label=2, 셀개수=2454
   환자ID=31-10001, Label=1, 셀개수=1133
   환자ID=31-10154, Label=1, 셀개수=6568
   환자ID=34-10184, Label=2, 셀개수=2699
   환자ID=PRE018-1, Label=0, 셀개수=1349
   환자ID=PRE055-1, Label=0, 셀개수=597
   환자ID=Sample1153-EO1, Label=0, 셀개수=911
   환자ID=Sample1153-EO2, Label=0, 셀개수=916
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Epithelial_cells', 'Epithelial_cells', 'Astrocyte', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'MSC', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
전체 데이터 길이 225177
전체 cell type 길이 0            Epithelial_cells
1            Epithelial_cells
2                   Astrocyte
3            Epithelial_cells
4            Epithelial_cells
                 ...         
225172              iPS_cells
225173    Smooth_muscle_cells
225174       Epithelial_cells
225175      Endothelial_cells
225176                NK_cell
Length: 225177, dtype: string
cell type의 NaN 개수 체크 0
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:12,  8.25it/s]  2%|▏         | 2/100 [00:00<00:11,  8.56it/s]  3%|▎         | 3/100 [00:00<00:10,  9.06it/s]  4%|▍         | 4/100 [00:00<00:10,  9.10it/s]  5%|▌         | 5/100 [00:00<00:10,  8.90it/s]  6%|▌         | 6/100 [00:00<00:10,  9.12it/s]  7%|▋         | 7/100 [00:00<00:11,  8.07it/s]  9%|▉         | 9/100 [00:01<00:10,  8.92it/s] 10%|█         | 10/100 [00:01<00:10,  8.96it/s] 11%|█         | 11/100 [00:01<00:10,  8.53it/s] 12%|█▏        | 12/100 [00:01<00:10,  8.55it/s] 13%|█▎        | 13/100 [00:01<00:10,  8.60it/s] 14%|█▍        | 14/100 [00:01<00:09,  8.67it/s] 15%|█▌        | 15/100 [00:01<00:10,  8.40it/s] 16%|█▌        | 16/100 [00:01<00:10,  8.35it/s] 17%|█▋        | 17/100 [00:01<00:09,  8.73it/s] 18%|█▊        | 18/100 [00:02<00:09,  8.87it/s] 19%|█▉        | 19/100 [00:02<00:09,  8.77it/s] 20%|██        | 20/100 [00:02<00:09,  8.62it/s] 21%|██        | 21/100 [00:02<00:09,  8.73it/s] 22%|██▏       | 22/100 [00:02<00:09,  8.65it/s] 23%|██▎       | 23/100 [00:02<00:08,  8.58it/s] 24%|██▍       | 24/100 [00:02<00:08,  8.71it/s] 25%|██▌       | 25/100 [00:02<00:08,  8.91it/s] 26%|██▌       | 26/100 [00:02<00:08,  8.69it/s] 27%|██▋       | 27/100 [00:03<00:08,  8.63it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.51it/s] 29%|██▉       | 29/100 [00:03<00:08,  8.25it/s] 30%|███       | 30/100 [00:03<00:08,  8.19it/s] 31%|███       | 31/100 [00:03<00:08,  8.28it/s] 32%|███▏      | 32/100 [00:03<00:07,  8.61it/s] 33%|███▎      | 33/100 [00:03<00:07,  8.66it/s] 34%|███▍      | 34/100 [00:04<00:09,  7.21it/s] 35%|███▌      | 35/100 [00:04<00:09,  7.01it/s] 36%|███▌      | 36/100 [00:04<00:08,  7.48it/s] 37%|███▋      | 37/100 [00:04<00:07,  7.89it/s] 38%|███▊      | 38/100 [00:04<00:08,  7.68it/s] 39%|███▉      | 39/100 [00:04<00:07,  7.75it/s] 40%|████      | 40/100 [00:04<00:07,  7.90it/s] 41%|████      | 41/100 [00:04<00:07,  8.02it/s] 42%|████▏     | 42/100 [00:05<00:07,  8.16it/s] 43%|████▎     | 43/100 [00:05<00:06,  8.19it/s] 44%|████▍     | 44/100 [00:05<00:08,  6.31it/s] 45%|████▌     | 45/100 [00:05<00:07,  6.88it/s] 46%|████▌     | 46/100 [00:05<00:07,  7.21it/s] 47%|████▋     | 47/100 [00:05<00:07,  7.50it/s] 48%|████▊     | 48/100 [00:05<00:06,  7.73it/s] 49%|████▉     | 49/100 [00:05<00:06,  7.84it/s] 50%|█████     | 50/100 [00:06<00:06,  7.96it/s] 51%|█████     | 51/100 [00:06<00:06,  8.00it/s] 52%|█████▏    | 52/100 [00:06<00:05,  8.13it/s] 53%|█████▎    | 53/100 [00:06<00:05,  8.16it/s] 54%|█████▍    | 54/100 [00:06<00:05,  8.43it/s] 55%|█████▌    | 55/100 [00:06<00:05,  8.39it/s] 56%|█████▌    | 56/100 [00:06<00:05,  8.48it/s] 57%|█████▋    | 57/100 [00:06<00:05,  8.56it/s] 58%|█████▊    | 58/100 [00:07<00:04,  8.62it/s] 59%|█████▉    | 59/100 [00:07<00:04,  8.64it/s] 60%|██████    | 60/100 [00:07<00:04,  8.37it/s] 61%|██████    | 61/100 [00:07<00:04,  8.18it/s] 62%|██████▏   | 62/100 [00:07<00:04,  8.38it/s] 63%|██████▎   | 63/100 [00:07<00:04,  8.41it/s] 64%|██████▍   | 64/100 [00:07<00:04,  8.08it/s] 65%|██████▌   | 65/100 [00:07<00:04,  7.66it/s] 66%|██████▌   | 66/100 [00:08<00:04,  7.77it/s] 67%|██████▋   | 67/100 [00:08<00:04,  7.90it/s] 68%|██████▊   | 68/100 [00:08<00:04,  7.99it/s] 69%|██████▉   | 69/100 [00:08<00:03,  8.01it/s] 70%|███████   | 70/100 [00:08<00:03,  8.06it/s] 71%|███████   | 71/100 [00:08<00:04,  6.99it/s] 72%|███████▏  | 72/100 [00:08<00:03,  7.29it/s] 73%|███████▎  | 73/100 [00:08<00:03,  7.45it/s] 74%|███████▍  | 74/100 [00:09<00:03,  6.89it/s] 75%|███████▌  | 75/100 [00:09<00:03,  7.30it/s] 76%|███████▌  | 76/100 [00:09<00:03,  7.65it/s] 77%|███████▋  | 77/100 [00:09<00:02,  7.72it/s] 78%|███████▊  | 78/100 [00:09<00:02,  7.69it/s] 79%|███████▉  | 79/100 [00:09<00:02,  7.75it/s] 80%|████████  | 80/100 [00:09<00:02,  7.95it/s] 81%|████████  | 81/100 [00:10<00:02,  7.84it/s] 82%|████████▏ | 82/100 [00:10<00:02,  7.73it/s] 83%|████████▎ | 83/100 [00:10<00:02,  6.55it/s] 84%|████████▍ | 84/100 [00:10<00:02,  6.91it/s] 85%|████████▌ | 85/100 [00:10<00:02,  7.20it/s] 86%|████████▌ | 86/100 [00:10<00:01,  7.40it/s] 87%|████████▋ | 87/100 [00:10<00:01,  7.53it/s] 88%|████████▊ | 88/100 [00:11<00:01,  7.30it/s] 89%|████████▉ | 89/100 [00:11<00:01,  7.33it/s] 90%|█████████ | 90/100 [00:11<00:01,  7.36it/s] 91%|█████████ | 91/100 [00:11<00:01,  7.55it/s] 92%|█████████▏| 92/100 [00:11<00:01,  7.57it/s] 93%|█████████▎| 93/100 [00:11<00:00,  7.57it/s] 94%|█████████▍| 94/100 [00:11<00:00,  7.69it/s] 95%|█████████▌| 95/100 [00:11<00:00,  7.70it/s] 96%|█████████▌| 96/100 [00:12<00:00,  7.74it/s] 97%|█████████▋| 97/100 [00:12<00:00,  7.69it/s] 98%|█████████▊| 98/100 [00:12<00:00,  7.73it/s] 99%|█████████▉| 99/100 [00:12<00:00,  7.68it/s]100%|██████████| 100/100 [00:12<00:00,  7.69it/s]100%|██████████| 100/100 [00:12<00:00,  7.96it/s]
[I 2025-08-31 05:52:54,607] A new study created in memory with name: no-name-d41a84ce-1396-49cf-a377-2b6bd6fe22bf
👉 train samples(학습 샘플(bag))=140, batch_size=16 -> steps(샘플수/batch크기)=9
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 26.13 MB
Memory Reserved: 36.00 MB
cuda
Epoch 1, Train Loss 1.049022, Valid_loss 1.081295
Epoch 2, Train Loss 0.938967, Valid_loss 1.069298
Epoch 3, Train Loss 0.915390, Valid_loss 1.045398
Epoch 4, Train Loss 0.868492, Valid_loss 1.013631
Epoch 5, Train Loss 0.871793, Valid_loss 0.930935
Epoch 6, Train Loss 0.885535, Valid_loss 0.901153
Epoch 7, Train Loss 0.816783, Valid_loss 0.807961
Epoch 8, Train Loss 0.813240, Valid_loss 0.746671
Epoch 9, Train Loss 0.816254, Valid_loss 0.759944
Epoch 10, Train Loss 0.718370, Valid_loss 0.697860
Epoch 11, Train Loss 0.689789, Valid_loss 0.684103
Epoch 12, Train Loss 0.655655, Valid_loss 0.687723
Epoch 13, Train Loss 0.691221, Valid_loss 0.643850
Epoch 14, Train Loss 0.658039, Valid_loss 0.679191
Epoch 15, Train Loss 0.603351, Valid_loss 0.632455
Epoch 16, Train Loss 0.613063, Valid_loss 0.662288
Epoch 17, Train Loss 0.599638, Valid_loss 0.613987
Epoch 18, Train Loss 0.592644, Valid_loss 0.626189
Epoch 19, Train Loss 0.623333, Valid_loss 0.623104
Epoch 20, Train Loss 0.577730, Valid_loss 0.609608
Epoch 21, Train Loss 0.608446, Valid_loss 0.590440
Epoch 22, Train Loss 0.566755, Valid_loss 0.644932
Epoch 23, Train Loss 0.559848, Valid_loss 0.581285
Epoch 24, Train Loss 0.577380, Valid_loss 0.611410
Epoch 25, Train Loss 0.547416, Valid_loss 0.581749
Epoch 26, Train Loss 0.535289, Valid_loss 0.602337
Epoch 27, Train Loss 0.541234, Valid_loss 0.554868
Epoch 28, Train Loss 0.505463, Valid_loss 0.574910
Epoch 29, Train Loss 0.504182, Valid_loss 0.553089
Epoch 30, Train Loss 0.539270, Valid_loss 0.546515
Epoch 31, Train Loss 0.523036, Valid_loss 0.541144
Epoch 32, Train Loss 0.507106, Valid_loss 0.543220
Epoch 33, Train Loss 0.477208, Valid_loss 0.544270
Epoch 34, Train Loss 0.479922, Valid_loss 0.539959
Epoch 35, Train Loss 0.489224, Valid_loss 0.532829
Epoch 36, Train Loss 0.504500, Valid_loss 0.512200
Epoch 37, Train Loss 0.479678, Valid_loss 0.569560
Epoch 38, Train Loss 0.475464, Valid_loss 0.507252
Epoch 39, Train Loss 0.460710, Valid_loss 0.525716
Epoch 40, Train Loss 0.465028, Valid_loss 0.498231
Epoch 41, Train Loss 0.426452, Valid_loss 0.504940
Epoch 42, Train Loss 0.464474, Valid_loss 0.502650
Epoch 43, Train Loss 0.479673, Valid_loss 0.516286
Epoch 44, Train Loss 0.463575, Valid_loss 0.492355
Epoch 45, Train Loss 0.443145, Valid_loss 0.480099
Epoch 46, Train Loss 0.423384, Valid_loss 0.495977
Epoch 47, Train Loss 0.430680, Valid_loss 0.500949
Epoch 48, Train Loss 0.418293, Valid_loss 0.478697
Epoch 49, Train Loss 0.413139, Valid_loss 0.520496
Epoch 50, Train Loss 0.426038, Valid_loss 0.478079
Epoch 51, Train Loss 0.377652, Valid_loss 0.482132
Epoch 52, Train Loss 0.395378, Valid_loss 0.476537
Epoch 53, Train Loss 0.409853, Valid_loss 0.482657
Epoch 54, Train Loss 0.371725, Valid_loss 0.467553
Epoch 55, Train Loss 0.400138, Valid_loss 0.468125
Epoch 56, Train Loss 0.397859, Valid_loss 0.466203
Epoch 57, Train Loss 0.383276, Valid_loss 0.473610
Epoch 58, Train Loss 0.361807, Valid_loss 0.482847
[I 2025-08-31 06:01:45,300] Trial 0 finished with value: 0.4662033851657595 and parameters: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 2, 'dropout': 0.5, 'weight_decay': 0.001, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.4662033851657595.
👉 train samples(학습 샘플(bag))=140, batch_size=16 -> steps(샘플수/batch크기)=9
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 24.81 MB
Memory Reserved: 36.00 MB
cuda
Epoch 1, Train Loss 1.157958, Valid_loss 1.240845
Epoch 2, Train Loss 1.240008, Valid_loss 1.213063
Epoch 3, Train Loss 1.182192, Valid_loss 1.186753
Epoch 4, Train Loss 1.092955, Valid_loss 1.158395
Epoch 5, Train Loss 1.080130, Valid_loss 1.128225
Epoch 6, Train Loss 1.035203, Valid_loss 1.104706
Epoch 7, Train Loss 1.037225, Valid_loss 1.087960
Epoch 8, Train Loss 1.041272, Valid_loss 1.054595
Epoch 9, Train Loss 1.011714, Valid_loss 1.059877
Epoch 10, Train Loss 1.001940, Valid_loss 1.028200
Epoch 11, Train Loss 0.945490, Valid_loss 1.018310
Epoch 12, Train Loss 0.966550, Valid_loss 0.992077
Epoch 13, Train Loss 0.972673, Valid_loss 0.977875
Epoch 14, Train Loss 0.928067, Valid_loss 0.960735
Epoch 15, Train Loss 0.923442, Valid_loss 0.948482
Epoch 16, Train Loss 0.876204, Valid_loss 0.937894
Epoch 17, Train Loss 0.870189, Valid_loss 0.871865
Epoch 18, Train Loss 0.786562, Valid_loss 0.846946
Epoch 19, Train Loss 0.830039, Valid_loss 0.841206
Epoch 20, Train Loss 0.858818, Valid_loss 0.840969
Epoch 21, Train Loss 0.748968, Valid_loss 0.801616
Epoch 22, Train Loss 0.752867, Valid_loss 0.803431
Epoch 23, Train Loss 0.777340, Valid_loss 0.798812
Epoch 24, Train Loss 0.811723, Valid_loss 0.753946
Epoch 25, Train Loss 0.753991, Valid_loss 0.751553
Epoch 26, Train Loss 0.759562, Valid_loss 0.734007
Epoch 27, Train Loss 0.751641, Valid_loss 0.722659
Epoch 28, Train Loss 0.730742, Valid_loss 0.722668
Epoch 29, Train Loss 0.704499, Valid_loss 0.695632
Epoch 30, Train Loss 0.710990, Valid_loss 0.690388
Epoch 31, Train Loss 0.695374, Valid_loss 0.670763
Epoch 32, Train Loss 0.712573, Valid_loss 0.657970
Epoch 33, Train Loss 0.680728, Valid_loss 0.659285
Epoch 34, Train Loss 0.741623, Valid_loss 0.652578
Epoch 35, Train Loss 0.693956, Valid_loss 0.657907
Epoch 36, Train Loss 0.610659, Valid_loss 0.628025
Epoch 37, Train Loss 0.627483, Valid_loss 0.687575
Epoch 38, Train Loss 0.624673, Valid_loss 0.617654
Epoch 39, Train Loss 0.586038, Valid_loss 0.624665
Epoch 40, Train Loss 0.664244, Valid_loss 0.608046
Epoch 41, Train Loss 0.612069, Valid_loss 0.597025
Epoch 42, Train Loss 0.583311, Valid_loss 0.620019
Epoch 43, Train Loss 0.643668, Valid_loss 0.587169
Epoch 44, Train Loss 0.618074, Valid_loss 0.590863
Epoch 45, Train Loss 0.650049, Valid_loss 0.589749
Epoch 46, Train Loss 0.620036, Valid_loss 0.590638
Epoch 47, Train Loss 0.589506, Valid_loss 0.596250
Epoch 48, Train Loss 0.631048, Valid_loss 0.569484
Epoch 49, Train Loss 0.617423, Valid_loss 0.575454
Epoch 50, Train Loss 0.630330, Valid_loss 0.562976
Epoch 51, Train Loss 0.606776, Valid_loss 0.588725
Epoch 52, Train Loss 0.619269, Valid_loss 0.564587
Epoch 53, Train Loss 0.672229, Valid_loss 0.561629
Epoch 54, Train Loss 0.665010, Valid_loss 0.562322
Epoch 55, Train Loss 0.638577, Valid_loss 0.566323
[I 2025-08-31 06:10:06,802] Trial 1 finished with value: 0.5616294961600077 and parameters: {'learning_rate': 0.001, 'epochs': 100, 'heads': 2, 'dropout': 0.7, 'weight_decay': 0.0001, 'emb_dim': 8, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.4662033851657595.
👉 train samples(학습 샘플(bag))=140, batch_size=16 -> steps(샘플수/batch크기)=9
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 24.81 MB
Memory Reserved: 36.00 MB
cuda
Epoch 1, Train Loss 0.987848, Valid_loss 1.122811
Epoch 2, Train Loss 0.959459, Valid_loss 1.109336
Epoch 3, Train Loss 0.956174, Valid_loss 1.098075
Epoch 4, Train Loss 0.905924, Valid_loss 1.115235
Epoch 5, Train Loss 0.954723, Valid_loss 1.116485
Epoch 6, Train Loss 0.936358, Valid_loss 1.107105
Epoch 7, Train Loss 0.935708, Valid_loss 1.095853
Epoch 8, Train Loss 0.907527, Valid_loss 1.115298
Epoch 9, Train Loss 0.928547, Valid_loss 1.133953
Epoch 10, Train Loss 0.915965, Valid_loss 1.120997
Epoch 11, Train Loss 0.912728, Valid_loss 1.121867
Epoch 12, Train Loss 0.927741, Valid_loss 1.117940
Epoch 13, Train Loss 0.935704, Valid_loss 1.091739
Epoch 14, Train Loss 0.928417, Valid_loss 1.104932
Epoch 15, Train Loss 0.916283, Valid_loss 1.116876
Epoch 16, Train Loss 0.928625, Valid_loss 1.094293
Epoch 17, Train Loss 0.931516, Valid_loss 1.087098
Epoch 18, Train Loss 0.930867, Valid_loss 1.086826
Epoch 19, Train Loss 0.941543, Valid_loss 1.053798
Epoch 20, Train Loss 0.925439, Valid_loss 1.082907
Epoch 21, Train Loss 0.897540, Valid_loss 1.053466
Epoch 22, Train Loss 0.895468, Valid_loss 1.020926
Epoch 23, Train Loss 0.888019, Valid_loss 1.043220
Epoch 24, Train Loss 0.889563, Valid_loss 1.109439
Epoch 25, Train Loss 0.852584, Valid_loss 0.900593
Epoch 26, Train Loss 0.778758, Valid_loss 0.674244
Epoch 27, Train Loss 0.653040, Valid_loss 0.613534
Epoch 28, Train Loss 0.593484, Valid_loss 0.644478
Epoch 29, Train Loss 0.586496, Valid_loss 0.818662
Epoch 30, Train Loss 0.586319, Valid_loss 0.462986
Epoch 31, Train Loss 0.601421, Valid_loss 0.464852
Epoch 32, Train Loss 0.465234, Valid_loss 0.550694
Epoch 33, Train Loss 0.459033, Valid_loss 0.509375
Epoch 34, Train Loss 0.491962, Valid_loss 0.452919
Epoch 35, Train Loss 0.499564, Valid_loss 0.441364
Epoch 36, Train Loss 0.636277, Valid_loss 0.529712
Epoch 37, Train Loss 0.411056, Valid_loss 0.455496
Epoch 38, Train Loss 0.404282, Valid_loss 0.665655
Epoch 39, Train Loss 0.476155, Valid_loss 0.449728
Epoch 40, Train Loss 0.356924, Valid_loss 0.648750
Epoch 41, Train Loss 0.501855, Valid_loss 0.438500
Epoch 42, Train Loss 0.379351, Valid_loss 0.436110
Epoch 43, Train Loss 0.501392, Valid_loss 0.779057
Epoch 44, Train Loss 0.465866, Valid_loss 0.446389
Epoch 45, Train Loss 0.512111, Valid_loss 0.428082
Epoch 46, Train Loss 0.383158, Valid_loss 0.413488
Epoch 47, Train Loss 0.394617, Valid_loss 0.413355
Epoch 48, Train Loss 0.349406, Valid_loss 0.444835
Epoch 49, Train Loss 0.428751, Valid_loss 0.439695
Epoch 50, Train Loss 0.403315, Valid_loss 0.423348
Epoch 51, Train Loss 0.362284, Valid_loss 0.483841
Epoch 52, Train Loss 0.354184, Valid_loss 0.471330
Epoch 53, Train Loss 0.377818, Valid_loss 0.414642
Epoch 54, Train Loss 0.316499, Valid_loss 0.459293
Epoch 55, Train Loss 0.334547, Valid_loss 0.438603
Epoch 56, Train Loss 0.359817, Valid_loss 0.420245
Epoch 57, Train Loss 0.305355, Valid_loss 0.417417
Epoch 58, Train Loss 0.320045, Valid_loss 0.432751
Epoch 59, Train Loss 0.361789, Valid_loss 0.426559
Epoch 60, Train Loss 0.307903, Valid_loss 0.450613
Epoch 61, Train Loss 0.300957, Valid_loss 0.442716
Epoch 62, Train Loss 0.316126, Valid_loss 0.452959
Epoch 63, Train Loss 0.347512, Valid_loss 0.426490
Epoch 64, Train Loss 0.297983, Valid_loss 0.730821
Epoch 65, Train Loss 0.320297, Valid_loss 0.408454
Epoch 66, Train Loss 0.325615, Valid_loss 0.646806
Epoch 67, Train Loss 0.530238, Valid_loss 0.414028
Epoch 68, Train Loss 0.632171, Valid_loss 0.675708
Epoch 69, Train Loss 0.500731, Valid_loss 0.394192
Epoch 70, Train Loss 0.373659, Valid_loss 0.480626
Epoch 71, Train Loss 0.365376, Valid_loss 0.388009
Epoch 72, Train Loss 0.324132, Valid_loss 0.396496
Epoch 73, Train Loss 0.297765, Valid_loss 0.411889
[I 2025-08-31 06:18:04,936] Trial 2 finished with value: 0.3880087191327697 and parameters: {'learning_rate': 0.01, 'epochs': 100, 'heads': 1, 'dropout': 0.3, 'weight_decay': 0.001, 'emb_dim': 8, 'augment_num': 100, 'pca': False}. Best is trial 2 with value: 0.3880087191327697.
선택된 trial params: {'learning_rate': 0.01, 'epochs': 100, 'heads': 1, 'dropout': 0.3, 'weight_decay': 0.001, 'emb_dim': 8, 'augment_num': 100, 'pca': False}
👉 train samples(학습 샘플(bag))=140, batch_size=16 -> steps(샘플수/batch크기)=9
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=16, batch_size=1 -> steps=16
Memory Allocated: 24.81 MB
Memory Reserved: 36.00 MB
cuda
Epoch 1, Train Loss 0.949612, Valid_loss 1.138783
Epoch 2, Train Loss 0.941576, Valid_loss 1.089551
Epoch 3, Train Loss 0.947629, Valid_loss 1.089236
Epoch 4, Train Loss 0.930774, Valid_loss 1.124738
Epoch 5, Train Loss 0.909052, Valid_loss 1.132196
Epoch 6, Train Loss 0.919336, Valid_loss 1.115162
Epoch 7, Train Loss 0.917625, Valid_loss 1.116775
Epoch 8, Train Loss 0.932754, Valid_loss 1.108763
Epoch 9, Train Loss 0.942001, Valid_loss 1.095549
Epoch 10, Train Loss 0.923183, Valid_loss 1.111771
Epoch 11, Train Loss 0.924494, Valid_loss 1.113907
Epoch 12, Train Loss 0.925929, Valid_loss 1.126391
Epoch 13, Train Loss 0.929726, Valid_loss 1.099735
Epoch 14, Train Loss 0.924306, Valid_loss 1.096391
Epoch 15, Train Loss 0.919002, Valid_loss 1.103574
Epoch 16, Train Loss 0.930916, Valid_loss 1.116863
Epoch 17, Train Loss 0.931870, Valid_loss 1.109664
Epoch 18, Train Loss 0.919395, Valid_loss 1.118457
Epoch 19, Train Loss 0.911697, Valid_loss 1.105717
Epoch 20, Train Loss 0.921387, Valid_loss 1.104797
Epoch 21, Train Loss 0.900709, Valid_loss 1.060409
Epoch 22, Train Loss 0.883234, Valid_loss 1.058427
Epoch 23, Train Loss 0.808153, Valid_loss 0.907219
Epoch 24, Train Loss 0.782259, Valid_loss 0.720694
Epoch 25, Train Loss 0.614830, Valid_loss 0.583817
Epoch 26, Train Loss 1.121271, Valid_loss 1.208231
Epoch 27, Train Loss 0.883109, Valid_loss 0.998471
Epoch 28, Train Loss 0.861815, Valid_loss 0.884890
Epoch 29, Train Loss 0.815267, Valid_loss 0.806097
Epoch 30, Train Loss 0.748912, Valid_loss 0.656431
Epoch 31, Train Loss 0.629666, Valid_loss 0.628978
Epoch 32, Train Loss 0.596325, Valid_loss 0.530448
Epoch 33, Train Loss 0.634225, Valid_loss 0.497612
Epoch 34, Train Loss 0.637112, Valid_loss 0.689978
Epoch 35, Train Loss 0.613289, Valid_loss 0.493917
Epoch 36, Train Loss 0.511724, Valid_loss 0.497919
Epoch 37, Train Loss 0.513120, Valid_loss 0.528656
Epoch 38, Train Loss 0.557900, Valid_loss 0.491565
Epoch 39, Train Loss 0.538058, Valid_loss 0.483364
Epoch 40, Train Loss 0.483078, Valid_loss 0.487156
Epoch 41, Train Loss 0.474066, Valid_loss 0.462956
Epoch 42, Train Loss 0.485648, Valid_loss 0.580048
Epoch 43, Train Loss 0.421850, Valid_loss 0.465550
Epoch 44, Train Loss 0.417172, Valid_loss 0.623882
Epoch 45, Train Loss 0.466760, Valid_loss 0.440827
Epoch 46, Train Loss 0.468460, Valid_loss 0.435843
Epoch 47, Train Loss 0.421902, Valid_loss 0.435043
Epoch 48, Train Loss 0.429910, Valid_loss 0.424446
Epoch 49, Train Loss 0.448024, Valid_loss 0.430850
Epoch 50, Train Loss 0.504423, Valid_loss 0.441590
Epoch 51, Train Loss 0.436310, Valid_loss 0.431559
Epoch 52, Train Loss 0.418054, Valid_loss 0.438575
Epoch 53, Train Loss 0.390502, Valid_loss 0.441306
환자ID=163-2 -- true: [[0]] -- pred: tensor([[ 3.0880, -0.5821, -2.9788]], device='cuda:0')
환자ID=164-10 -- true: [[0]] -- pred: tensor([[ 3.1261, -0.6107, -3.0451]], device='cuda:0')
환자ID=27-10041 -- true: [[1]] -- pred: tensor([[-1.6882,  1.5459,  0.1080]], device='cuda:0')
환자ID=28-10051 -- true: [[1]] -- pred: tensor([[-1.6690,  1.5349,  0.0972]], device='cuda:0')
환자ID=29-10006 -- true: [[1]] -- pred: tensor([[-1.6746,  1.5381,  0.1000]], device='cuda:0')
환자ID=29-10016 -- true: [[1]] -- pred: tensor([[-1.2155,  1.3131, -0.3403]], device='cuda:0')
환자ID=29-10280 -- true: [[1]] -- pred: tensor([[-1.6451,  1.5210,  0.0867]], device='cuda:0')
환자ID=29-10398 -- true: [[1]] -- pred: tensor([[-1.6205,  1.5067,  0.0761]], device='cuda:0')
환자ID=30-11051 -- true: [[2]] -- pred: tensor([[-1.6372,  1.5163,  0.0842]], device='cuda:0')
환자ID=31-10001 -- true: [[1]] -- pred: tensor([[-1.6497,  1.5237,  0.0886]], device='cuda:0')
환자ID=31-10154 -- true: [[1]] -- pred: tensor([[-1.6637,  1.5319,  0.0938]], device='cuda:0')
환자ID=34-10184 -- true: [[2]] -- pred: tensor([[-1.6745,  1.5381,  0.0990]], device='cuda:0')
환자ID=PRE018-1 -- true: [[0]] -- pred: tensor([[ 3.1124, -0.5976, -3.0130]], device='cuda:0')
환자ID=PRE055-1 -- true: [[0]] -- pred: tensor([[ 3.1195, -0.5986, -3.0099]], device='cuda:0')
환자ID=Sample1153-EO1 -- true: [[0]] -- pred: tensor([[ 3.1195, -0.6018, -3.0219]], device='cuda:0')
환자ID=Sample1153-EO2 -- true: [[0]] -- pred: tensor([[ 3.1044, -0.5902, -2.9929]], device='cuda:0')
Best performance: Epoch 48, Loss 0.429910, Test ACC 0.875000, Test AUC 0.843750, Test Recall 0.666667, Test Precision 0.600000
Confusion Matrix:
 [[6 0 0]
 [0 8 0]
 [0 2 0]]
✅ Total valid splits used: 1
🔁 Repeat 2, Fold 1
cell type :  S2008000605HRT_AAACCCAGTGCACATT-1    Epithelial_cells
S2008000605HRT_AAACCCAGTGCCTACG-1    Epithelial_cells
S2008000605HRT_AAAGAACGTAGAGACC-1           Astrocyte
S2008000605HRT_AAAGAACGTCGGAACA-1    Epithelial_cells
S2008000605HRT_AAAGAACGTTAACAGA-1    Epithelial_cells
                                           ...       
Sample1162EO1_TTTCACAAGGGCAGAG-1            iPS_cells
Sample1162EO1_TTTCCTCAGCGTGCCT-1          Hepatocytes
Sample1162EO1_TTTCCTCAGTACTGTC-1     Epithelial_cells
Sample1162EO1_TTTGGTTTCCACATAG-1          Hepatocytes
Sample1162EO1_TTTGTTGCACACGCCA-1     Epithelial_cells
Name: singler_annotation, Length: 178640, dtype: string
cell type annotation :  S2008000605HRT_AAACCCAGTGCACATT-1    Epithelial_cells
S2008000605HRT_AAACCCAGTGCCTACG-1    Epithelial_cells
S2008000605HRT_AAAGAACGTAGAGACC-1           Astrocyte
S2008000605HRT_AAAGAACGTCGGAACA-1    Epithelial_cells
S2008000605HRT_AAAGAACGTTAACAGA-1    Epithelial_cells
                                           ...       
Sample1162EO1_TTTCACAAGGGCAGAG-1            iPS_cells
Sample1162EO1_TTTCCTCAGCGTGCCT-1          Hepatocytes
Sample1162EO1_TTTCCTCAGTACTGTC-1     Epithelial_cells
Sample1162EO1_TTTGGTTTCCACATAG-1          Hepatocytes
Sample1162EO1_TTTGTTGCACACGCCA-1     Epithelial_cells
Name: singler_annotation, Length: 178640, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Epithelial_cells', 'Astrocyte', 'MSC', 'Keratinocytes', 'Neurons', 'Endothelial_cells', 'Fibroblasts', 'Tissue_stem_cells', 'Smooth_muscle_cells', 'T_cells', 'Neuroepithelial_cell', 'NK_cell', 'Chondrocytes', 'Osteoblasts', 'Monocyte', 'Hepatocytes', 'Macrophage', 'CMP', 'Embryonic_stem_cells', 'DC', 'BM & Prog.', 'MEP', 'Neutrophils', 'Pro-Myelocyte', 'iPS_cells', 'Pre-B_cell_CD34-', 'HSC_-G-CSF', 'B_cell', 'GMP', 'HSC_CD34+', 'Platelets', 'Pro-B_cell_CD34+', 'Myelocyte', 'BM', 'Erythroblast', 'Unknown', 'Gametocytes']
라벨별 그룹 개수 {0: 21, 1: 29, 2: 11}
cell type :  S2008000651HRT_AAACCCACAGAGTGTG-1              T_cells
S2008000651HRT_AAACCCACATGACTGT-1              T_cells
S2008000651HRT_AAACGAAGTTAATCGC-1          Fibroblasts
S2008000651HRT_AAACGCTAGGCTTAAA-1              T_cells
S2008000651HRT_AAAGAACAGGAACTCG-1              T_cells
                                           ...        
Sample1162EO2_TTTGGAGAGCAGGCAT-1      Epithelial_cells
Sample1162EO2_TTTGGAGAGTCGCGAA-1     Endothelial_cells
Sample1162EO2_TTTGGAGAGTGCTCGC-1           Hepatocytes
Sample1162EO2_TTTGGAGGTGATACTC-1      Epithelial_cells
Sample1162EO2_TTTGGTTCAGTAGAAT-1      Epithelial_cells
Name: singler_annotation, Length: 46537, dtype: string
cell type annotation :  S2008000651HRT_AAACCCACAGAGTGTG-1              T_cells
S2008000651HRT_AAACCCACATGACTGT-1              T_cells
S2008000651HRT_AAACGAAGTTAATCGC-1          Fibroblasts
S2008000651HRT_AAACGCTAGGCTTAAA-1              T_cells
S2008000651HRT_AAAGAACAGGAACTCG-1              T_cells
                                           ...        
Sample1162EO2_TTTGGAGAGCAGGCAT-1      Epithelial_cells
Sample1162EO2_TTTGGAGAGTCGCGAA-1     Endothelial_cells
Sample1162EO2_TTTGGAGAGTGCTCGC-1           Hepatocytes
Sample1162EO2_TTTGGAGGTGATACTC-1      Epithelial_cells
Sample1162EO2_TTTGGTTCAGTAGAAT-1      Epithelial_cells
Name: singler_annotation, Length: 46537, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['T_cells', 'Fibroblasts', 'B_cell', 'Macrophage', 'Pre-B_cell_CD34-', 'NK_cell', 'Endothelial_cells', 'Chondrocytes', 'HSC_-G-CSF', 'CMP', 'Monocyte', 'Smooth_muscle_cells', 'DC', 'BM', 'Tissue_stem_cells', 'Platelets', 'GMP', 'Neutrophils', 'Epithelial_cells', 'HSC_CD34+', 'MSC', 'Pro-Myelocyte', 'iPS_cells', 'Pro-B_cell_CD34+', 'Hepatocytes', 'Astrocyte', 'Neuroepithelial_cell', 'Embryonic_stem_cells', 'Neurons', 'Keratinocytes', 'Osteoblasts', 'MEP', 'Gametocytes', 'BM & Prog.', 'Erythroblast', 'Unknown', 'Myelocyte']
라벨별 그룹 개수 {0: 5, 1: 8, 2: 3}
🔍 Split #2
  → train_p_index 환자 수 (환자 단위로 묶인 index list): 61
  → test_p_index 환자 수  (환자 단위로 묶인 index list): 16
  → train 환자 ID: ['163-2', '163-3', '163-5', '164-10', '164-3', '164-6', '27-10039', '27-10041', '27-10053', '27-10071', '27-10112', '27-10119', '28-10051', '28-11515', '28-12263', '28-12381', '28-12490', '28-12518', '29-10006', '29-10010', '29-10011', '29-10012', '29-10013', '29-10016', '29-10280', '29-10398', '29-10404', '30-10018', '30-10034', '30-10123', '30-10929', '30-11051', '31-10000', '31-10001', '31-10013', '31-10035', '31-10040', '31-10154', '31-10210', '31-10236', '32-10003', '32-10034', '33-10005', '33-10006', '34-10184', '34-10187', 'PRE018-1', 'PRE027', 'PRE038', 'PRE055-1', 'PRE062-1', 'PRE98sc', 'Sample1153-EO1', 'Sample1153-EO2', 'Sample1157-EO1', 'Sample1157-EO2', 'Sample1157-EO3', 'Sample1158-EO1', 'Sample1158-EO2', 'Sample1158-EO3', 'Sample1162-EO1']
  → test  환자 ID: ['163-4', '165-9', '29-10008', '29-10380', '29-10386', '29-10400', '29-10406', '29-10410', '30-10125', '31-10042', '31-10078', '32-10074', '34-10050', 'PRE019', 'Sample1153-EO3', 'Sample1162-EO2']
  → train 환자 ID 및 라벨:
    ID: 163-2, Label: 0
    ID: 163-3, Label: 0
    ID: 163-5, Label: 0
    ID: 164-10, Label: 0
    ID: 164-3, Label: 0
    ID: 164-6, Label: 0
    ID: 27-10039, Label: 1
    ID: 27-10041, Label: 1
    ID: 27-10053, Label: 1
    ID: 27-10071, Label: 1
    ID: 27-10112, Label: 1
    ID: 27-10119, Label: 1
    ID: 28-10051, Label: 1
    ID: 28-11515, Label: 1
    ID: 28-12263, Label: 1
    ID: 28-12381, Label: 1
    ID: 28-12490, Label: 1
    ID: 28-12518, Label: 1
    ID: 29-10006, Label: 1
    ID: 29-10010, Label: 1
    ID: 29-10011, Label: 1
    ID: 29-10012, Label: 1
    ID: 29-10013, Label: 1
    ID: 29-10016, Label: 1
    ID: 29-10280, Label: 1
    ID: 29-10398, Label: 1
    ID: 29-10404, Label: 1
    ID: 30-10018, Label: 2
    ID: 30-10034, Label: 2
    ID: 30-10123, Label: 2
    ID: 30-10929, Label: 2
    ID: 30-11051, Label: 2
    ID: 31-10000, Label: 1
    ID: 31-10001, Label: 1
    ID: 31-10013, Label: 1
    ID: 31-10035, Label: 1
    ID: 31-10040, Label: 1
    ID: 31-10154, Label: 1
    ID: 31-10210, Label: 1
    ID: 31-10236, Label: 1
    ID: 32-10003, Label: 2
    ID: 32-10034, Label: 2
    ID: 33-10005, Label: 2
    ID: 33-10006, Label: 2
    ID: 34-10184, Label: 2
    ID: 34-10187, Label: 2
    ID: PRE018-1, Label: 0
    ID: PRE027, Label: 0
    ID: PRE038, Label: 0
    ID: PRE055-1, Label: 0
    ID: PRE062-1, Label: 0
    ID: PRE98sc, Label: 0
    ID: Sample1153-EO1, Label: 0
    ID: Sample1153-EO2, Label: 0
    ID: Sample1157-EO1, Label: 0
    ID: Sample1157-EO2, Label: 0
    ID: Sample1157-EO3, Label: 0
    ID: Sample1158-EO1, Label: 0
    ID: Sample1158-EO2, Label: 0
    ID: Sample1158-EO3, Label: 0
    ID: Sample1162-EO1, Label: 0
  → test 환자 ID 및 라벨:
    ID: 163-4, Label: 0
    ID: 165-9, Label: 0
    ID: 29-10008, Label: 1
    ID: 29-10380, Label: 1
    ID: 29-10386, Label: 1
    ID: 29-10400, Label: 1
    ID: 29-10406, Label: 1
    ID: 29-10410, Label: 1
    ID: 30-10125, Label: 2
    ID: 31-10042, Label: 1
    ID: 31-10078, Label: 1
    ID: 32-10074, Label: 2
    ID: 34-10050, Label: 2
    ID: PRE019, Label: 0
    ID: Sample1153-EO3, Label: 0
    ID: Sample1162-EO2, Label: 0
전체 데이터 index 길이 77
label_stat (train 환자 라벨 목록) 갯수 61
train_data에서 환자 단위로, train과 validation 나누기
기존 train_p_index 61
기존 (train) label_stat 61
train-vali 분할 후! 
train y 의 classes : {0, 1, 2} valid y 의 classes : {0, 1, 2} label_stat 의 classes : {0, 1, 2}
train_p_index_ 40
valid_p_index 21
test_p_index 16
→ train 환자 ID 및 라벨:
   총 개수: 40
   환자ID=29-10012, Label=1, 셀개수=6245
   환자ID=31-10210, Label=1, 셀개수=3510
   환자ID=Sample1157-EO1, Label=0, 셀개수=1152
   환자ID=Sample1158-EO1, Label=0, 셀개수=574
   환자ID=32-10034, Label=2, 셀개수=1555
   환자ID=164-10, Label=0, 셀개수=4041
   환자ID=28-12518, Label=1, 셀개수=1215
   환자ID=PRE055-1, Label=0, 셀개수=597
   환자ID=31-10001, Label=1, 셀개수=1133
   환자ID=30-11051, Label=2, 셀개수=2454
   환자ID=163-3, Label=0, 셀개수=1335
   환자ID=27-10119, Label=1, 셀개수=3346
   환자ID=27-10039, Label=1, 셀개수=4638
   환자ID=27-10041, Label=1, 셀개수=2145
   환자ID=163-2, Label=0, 셀개수=2535
   환자ID=30-10034, Label=2, 셀개수=1240
   환자ID=31-10035, Label=1, 셀개수=2974
   환자ID=30-10929, Label=2, 셀개수=5812
   환자ID=29-10016, Label=1, 셀개수=4854
   환자ID=31-10013, Label=1, 셀개수=3161
   환자ID=163-5, Label=0, 셀개수=1210
   환자ID=32-10003, Label=2, 셀개수=2978
   환자ID=PRE98sc, Label=0, 셀개수=1568
   환자ID=29-10404, Label=1, 셀개수=3988
   환자ID=28-11515, Label=1, 셀개수=930
   환자ID=Sample1158-EO3, Label=0, 셀개수=1096
   환자ID=31-10040, Label=1, 셀개수=4543
   환자ID=PRE027, Label=0, 셀개수=2078
   환자ID=27-10112, Label=1, 셀개수=1470
   환자ID=28-12490, Label=1, 셀개수=5973
   환자ID=28-10051, Label=1, 셀개수=300
   환자ID=164-6, Label=0, 셀개수=3038
   환자ID=29-10398, Label=1, 셀개수=3993
   환자ID=34-10187, Label=2, 셀개수=3739
   환자ID=29-10013, Label=1, 셀개수=3706
   환자ID=33-10006, Label=2, 셀개수=457
   환자ID=33-10005, Label=2, 셀개수=8904
   환자ID=31-10236, Label=1, 셀개수=3458
   환자ID=29-10011, Label=1, 셀개수=3072
   환자ID=28-12381, Label=1, 셀개수=1099
→ valid 환자 ID 및 라벨:
   총 개수: 21
   환자ID=Sample1162-EO1, Label=0, 셀개수=1053
   환자ID=29-10010, Label=1, 셀개수=5305
   환자ID=31-10154, Label=1, 셀개수=6568
   환자ID=Sample1153-EO1, Label=0, 셀개수=911
   환자ID=Sample1157-EO3, Label=0, 셀개수=807
   환자ID=PRE062-1, Label=0, 셀개수=907
   환자ID=Sample1157-EO2, Label=0, 셀개수=1395
   환자ID=30-10123, Label=2, 셀개수=1273
   환자ID=31-10000, Label=1, 셀개수=8870
   환자ID=30-10018, Label=2, 셀개수=5170
   환자ID=Sample1158-EO2, Label=0, 셀개수=1427
   환자ID=27-10071, Label=1, 셀개수=1478
   환자ID=29-10280, Label=1, 셀개수=2375
   환자ID=Sample1153-EO2, Label=0, 셀개수=916
   환자ID=PRE018-1, Label=0, 셀개수=1349
   환자ID=PRE038, Label=0, 셀개수=2666
   환자ID=164-3, Label=0, 셀개수=1639
   환자ID=29-10006, Label=1, 셀개수=11461
   환자ID=27-10053, Label=1, 셀개수=728
   환자ID=28-12263, Label=1, 셀개수=7527
   환자ID=34-10184, Label=2, 셀개수=2699
→ test 환자 ID 및 라벨:
   총 개수: 16
   환자ID=163-4, Label=0, 셀개수=1339
   환자ID=165-9, Label=0, 셀개수=2926
   환자ID=29-10008, Label=1, 셀개수=1913
   환자ID=29-10380, Label=1, 셀개수=4799
   환자ID=29-10386, Label=1, 셀개수=802
   환자ID=29-10400, Label=1, 셀개수=2684
   환자ID=29-10406, Label=1, 셀개수=3484
   환자ID=29-10410, Label=1, 셀개수=2834
   환자ID=30-10125, Label=2, 셀개수=3798
   환자ID=31-10042, Label=1, 셀개수=1222
   환자ID=31-10078, Label=1, 셀개수=2827
   환자ID=32-10074, Label=2, 셀개수=6304
   환자ID=34-10050, Label=2, 셀개수=4784
   환자ID=PRE019, Label=0, 셀개수=3795
   환자ID=Sample1153-EO3, Label=0, 셀개수=1516
   환자ID=Sample1162-EO2, Label=0, 셀개수=1510
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Epithelial_cells', 'Epithelial_cells', 'Astrocyte', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'MSC', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
전체 데이터 길이 225177
전체 cell type 길이 0          Epithelial_cells
1          Epithelial_cells
2                 Astrocyte
3          Epithelial_cells
4          Epithelial_cells
                ...        
225172     Epithelial_cells
225173    Endothelial_cells
225174          Hepatocytes
225175     Epithelial_cells
225176     Epithelial_cells
Length: 225177, dtype: string
cell type의 NaN 개수 체크 0
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:11,  8.82it/s]  2%|▏         | 2/100 [00:00<00:10,  9.10it/s]  4%|▍         | 4/100 [00:00<00:09,  9.70it/s]  5%|▌         | 5/100 [00:00<00:09,  9.72it/s]  7%|▋         | 7/100 [00:00<00:09,  9.74it/s]  8%|▊         | 8/100 [00:00<00:09,  9.75it/s]  9%|▉         | 9/100 [00:00<00:09,  9.81it/s] 10%|█         | 10/100 [00:01<00:09,  9.78it/s] 11%|█         | 11/100 [00:01<00:09,  9.69it/s] 12%|█▏        | 12/100 [00:01<00:09,  9.50it/s] 13%|█▎        | 13/100 [00:01<00:09,  9.51it/s] 14%|█▍        | 14/100 [00:01<00:09,  9.54it/s] 15%|█▌        | 15/100 [00:01<00:09,  9.20it/s] 16%|█▌        | 16/100 [00:01<00:09,  9.03it/s] 17%|█▋        | 17/100 [00:01<00:09,  9.15it/s] 18%|█▊        | 18/100 [00:01<00:08,  9.31it/s] 20%|██        | 20/100 [00:02<00:08,  9.46it/s] 21%|██        | 21/100 [00:02<00:08,  8.84it/s] 22%|██▏       | 22/100 [00:02<00:08,  9.04it/s] 23%|██▎       | 23/100 [00:02<00:08,  9.15it/s] 24%|██▍       | 24/100 [00:02<00:08,  9.19it/s] 25%|██▌       | 25/100 [00:02<00:08,  8.44it/s] 26%|██▌       | 26/100 [00:02<00:08,  8.49it/s] 27%|██▋       | 27/100 [00:02<00:08,  8.77it/s] 28%|██▊       | 28/100 [00:03<00:07,  9.03it/s] 29%|██▉       | 29/100 [00:03<00:07,  9.23it/s] 30%|███       | 30/100 [00:03<00:07,  9.03it/s] 31%|███       | 31/100 [00:03<00:07,  9.04it/s] 33%|███▎      | 33/100 [00:03<00:07,  9.42it/s] 34%|███▍      | 34/100 [00:03<00:07,  9.39it/s] 35%|███▌      | 35/100 [00:03<00:07,  9.21it/s] 36%|███▌      | 36/100 [00:03<00:06,  9.31it/s] 37%|███▋      | 37/100 [00:03<00:06,  9.20it/s] 38%|███▊      | 38/100 [00:04<00:08,  7.55it/s] 40%|████      | 40/100 [00:04<00:07,  8.43it/s] 41%|████      | 41/100 [00:04<00:06,  8.57it/s] 42%|████▏     | 42/100 [00:04<00:08,  6.50it/s] 43%|████▎     | 43/100 [00:04<00:08,  6.95it/s] 44%|████▍     | 44/100 [00:04<00:07,  7.35it/s] 45%|████▌     | 45/100 [00:05<00:07,  7.49it/s] 46%|████▌     | 46/100 [00:05<00:06,  7.90it/s] 47%|████▋     | 47/100 [00:05<00:06,  8.12it/s] 48%|████▊     | 48/100 [00:05<00:06,  8.39it/s] 49%|████▉     | 49/100 [00:05<00:06,  7.38it/s] 50%|█████     | 50/100 [00:05<00:06,  7.85it/s] 51%|█████     | 51/100 [00:05<00:05,  8.23it/s] 52%|█████▏    | 52/100 [00:05<00:05,  8.20it/s] 53%|█████▎    | 53/100 [00:06<00:05,  8.34it/s] 54%|█████▍    | 54/100 [00:06<00:05,  7.80it/s] 55%|█████▌    | 55/100 [00:06<00:05,  8.06it/s] 56%|█████▌    | 56/100 [00:06<00:05,  8.15it/s] 57%|█████▋    | 57/100 [00:06<00:05,  8.13it/s] 58%|█████▊    | 58/100 [00:06<00:05,  8.32it/s] 59%|█████▉    | 59/100 [00:06<00:04,  8.32it/s] 60%|██████    | 60/100 [00:06<00:04,  8.41it/s] 61%|██████    | 61/100 [00:07<00:04,  8.45it/s] 62%|██████▏   | 62/100 [00:07<00:04,  8.50it/s] 63%|██████▎   | 63/100 [00:07<00:04,  8.01it/s] 64%|██████▍   | 64/100 [00:07<00:04,  8.04it/s] 65%|██████▌   | 65/100 [00:07<00:04,  8.00it/s] 66%|██████▌   | 66/100 [00:07<00:04,  8.24it/s] 67%|██████▋   | 67/100 [00:07<00:04,  7.76it/s] 68%|██████▊   | 68/100 [00:07<00:03,  8.12it/s] 69%|██████▉   | 69/100 [00:08<00:04,  7.62it/s] 70%|███████   | 70/100 [00:08<00:03,  7.83it/s] 71%|███████   | 71/100 [00:08<00:03,  7.92it/s] 72%|███████▏  | 72/100 [00:08<00:03,  8.29it/s] 73%|███████▎  | 73/100 [00:08<00:03,  8.22it/s] 74%|███████▍  | 74/100 [00:08<00:03,  7.50it/s] 75%|███████▌  | 75/100 [00:08<00:03,  7.88it/s] 76%|███████▌  | 76/100 [00:08<00:03,  7.90it/s] 77%|███████▋  | 77/100 [00:09<00:03,  7.23it/s] 78%|███████▊  | 78/100 [00:09<00:03,  7.06it/s] 79%|███████▉  | 79/100 [00:09<00:02,  7.36it/s] 80%|████████  | 80/100 [00:09<00:02,  7.65it/s] 81%|████████  | 81/100 [00:09<00:02,  7.72it/s] 82%|████████▏ | 82/100 [00:09<00:02,  8.15it/s] 83%|████████▎ | 83/100 [00:09<00:02,  8.26it/s] 84%|████████▍ | 84/100 [00:09<00:01,  8.02it/s] 85%|████████▌ | 85/100 [00:10<00:01,  7.92it/s] 86%|████████▌ | 86/100 [00:10<00:01,  8.02it/s] 87%|████████▋ | 87/100 [00:10<00:01,  8.00it/s] 88%|████████▊ | 88/100 [00:10<00:01,  7.97it/s] 89%|████████▉ | 89/100 [00:10<00:01,  7.94it/s] 90%|█████████ | 90/100 [00:10<00:01,  7.92it/s] 91%|█████████ | 91/100 [00:10<00:01,  8.02it/s] 92%|█████████▏| 92/100 [00:11<00:01,  6.85it/s] 93%|█████████▎| 93/100 [00:11<00:00,  7.06it/s] 94%|█████████▍| 94/100 [00:11<00:00,  7.29it/s] 95%|█████████▌| 95/100 [00:11<00:00,  7.43it/s] 96%|█████████▌| 96/100 [00:11<00:00,  7.61it/s] 97%|█████████▋| 97/100 [00:11<00:00,  7.71it/s] 98%|█████████▊| 98/100 [00:11<00:00,  7.71it/s] 99%|█████████▉| 99/100 [00:11<00:00,  7.67it/s]100%|██████████| 100/100 [00:12<00:00,  7.66it/s]100%|██████████| 100/100 [00:12<00:00,  8.27it/s]
[I 2025-08-31 06:24:08,889] A new study created in memory with name: no-name-8deb85b5-a038-4448-9227-553072ee117b
👉 train samples(학습 샘플(bag))=140, batch_size=16 -> steps(샘플수/batch크기)=9
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 26.13 MB
Memory Reserved: 36.00 MB
cuda
Epoch 1, Train Loss 0.925569, Valid_loss 1.159272
Epoch 2, Train Loss 0.876042, Valid_loss 1.110099
Epoch 3, Train Loss 0.876658, Valid_loss 1.157166
Epoch 4, Train Loss 0.866097, Valid_loss 1.114688
Epoch 5, Train Loss 0.866595, Valid_loss 1.157620
Epoch 6, Train Loss 0.873227, Valid_loss 1.109113
Epoch 7, Train Loss 0.853562, Valid_loss 1.171221
Epoch 8, Train Loss 0.883848, Valid_loss 1.170082
Epoch 9, Train Loss 0.868679, Valid_loss 1.076276
Epoch 10, Train Loss 0.857000, Valid_loss 1.182254
Epoch 11, Train Loss 0.859842, Valid_loss 1.139131
Epoch 12, Train Loss 0.863443, Valid_loss 1.138589
Epoch 13, Train Loss 0.877074, Valid_loss 1.223634
Epoch 14, Train Loss 0.845409, Valid_loss 1.122490
Epoch 15, Train Loss 0.853465, Valid_loss 1.195384
Epoch 16, Train Loss 0.828654, Valid_loss 1.146969
Epoch 17, Train Loss 0.722107, Valid_loss 0.890823
Epoch 18, Train Loss 0.689283, Valid_loss 0.951888
Epoch 19, Train Loss 0.495214, Valid_loss 0.551152
Epoch 20, Train Loss 0.521170, Valid_loss 0.621107
Epoch 21, Train Loss 0.387816, Valid_loss 0.708753
Epoch 22, Train Loss 0.478918, Valid_loss 0.694407
Epoch 23, Train Loss 0.351958, Valid_loss 0.455380
Epoch 24, Train Loss 0.366162, Valid_loss 0.654377
Epoch 25, Train Loss 0.392723, Valid_loss 0.540599
Epoch 26, Train Loss 0.348722, Valid_loss 0.571575
Epoch 27, Train Loss 0.282833, Valid_loss 0.405821
Epoch 28, Train Loss 0.232415, Valid_loss 0.370870
Epoch 29, Train Loss 0.504734, Valid_loss 0.701069
Epoch 30, Train Loss 0.385821, Valid_loss 0.465528
Epoch 31, Train Loss 0.411717, Valid_loss 0.761965
Epoch 32, Train Loss 0.399203, Valid_loss 0.459018
Epoch 33, Train Loss 0.343873, Valid_loss 0.624159
Epoch 34, Train Loss 0.246252, Valid_loss 0.540263
Epoch 35, Train Loss 0.201915, Valid_loss 0.660236
Epoch 36, Train Loss 0.185270, Valid_loss 0.618634
Epoch 37, Train Loss 0.203095, Valid_loss 0.613356
Epoch 38, Train Loss 0.220224, Valid_loss 0.441667
Epoch 39, Train Loss 0.353969, Valid_loss 0.468837
Epoch 40, Train Loss 0.441459, Valid_loss 0.860041
Epoch 41, Train Loss 0.416416, Valid_loss 0.635864
Epoch 42, Train Loss 0.327131, Valid_loss 0.493085
Epoch 43, Train Loss 0.302532, Valid_loss 0.451635
Epoch 44, Train Loss 0.314255, Valid_loss 0.553573
Epoch 45, Train Loss 0.227848, Valid_loss 0.605942
Epoch 46, Train Loss 0.206245, Valid_loss 0.692044
Epoch 47, Train Loss 0.187131, Valid_loss 0.872904
Epoch 48, Train Loss 0.262573, Valid_loss 0.606099
Epoch 49, Train Loss 0.227990, Valid_loss 0.521130
Epoch 50, Train Loss 0.267950, Valid_loss 0.688516
Epoch 51, Train Loss 0.157558, Valid_loss 0.654281
Epoch 52, Train Loss 0.135211, Valid_loss 0.620757
Epoch 53, Train Loss 0.118592, Valid_loss 0.583461
Epoch 54, Train Loss 0.116848, Valid_loss 0.841613
Epoch 55, Train Loss 0.127064, Valid_loss 0.608172
Epoch 56, Train Loss 0.109706, Valid_loss 0.554238
Epoch 57, Train Loss 0.099303, Valid_loss 0.896676
Epoch 58, Train Loss 0.088694, Valid_loss 0.541247
Epoch 59, Train Loss 0.079005, Valid_loss 0.710706
Epoch 60, Train Loss 0.058350, Valid_loss 0.658192
Epoch 61, Train Loss 0.062641, Valid_loss 0.703346
Epoch 62, Train Loss 0.080889, Valid_loss 0.686053
Epoch 63, Train Loss 0.059009, Valid_loss 0.771740
Epoch 64, Train Loss 0.060157, Valid_loss 0.696920
Epoch 65, Train Loss 0.078646, Valid_loss 0.867538
Epoch 66, Train Loss 0.100582, Valid_loss 0.793286
Epoch 67, Train Loss 0.048487, Valid_loss 0.838223
Epoch 68, Train Loss 0.075767, Valid_loss 0.816462
Epoch 69, Train Loss 0.073388, Valid_loss 1.203327
Epoch 70, Train Loss 0.122602, Valid_loss 0.914727
Epoch 71, Train Loss 0.089364, Valid_loss 0.777889
Epoch 72, Train Loss 0.076742, Valid_loss 1.022386
Epoch 73, Train Loss 0.076851, Valid_loss 1.300448
[I 2025-08-31 06:32:03,378] Trial 0 finished with value: 0.37087034425210386 and parameters: {'learning_rate': 0.01, 'epochs': 100, 'heads': 1, 'dropout': 0.0, 'weight_decay': 0.001, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.37087034425210386.
👉 train samples(학습 샘플(bag))=140, batch_size=16 -> steps(샘플수/batch크기)=9
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 26.13 MB
Memory Reserved: 36.00 MB
cuda
CUDA OOM 발생 — 단계적 백오프 시작.
[OOM RETRY] batch_size 16 → 8 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=140, batch_size=8 -> steps(샘플수/batch크기)=18
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 1660.03 MB
Memory Reserved: 1670.00 MB
cuda
Epoch 1, Train Loss 0.988150, Valid_loss 0.990310
Epoch 2, Train Loss 0.883848, Valid_loss 1.008476
Epoch 3, Train Loss 0.859542, Valid_loss 0.833698
Epoch 4, Train Loss 0.682004, Valid_loss 0.709521
Epoch 5, Train Loss 0.753020, Valid_loss 0.699640
Epoch 6, Train Loss 0.641020, Valid_loss 0.716856
Epoch 7, Train Loss 0.624903, Valid_loss 0.740706
Epoch 8, Train Loss 0.530591, Valid_loss 0.587394
Epoch 9, Train Loss 0.471353, Valid_loss 0.463010
Epoch 10, Train Loss 0.547431, Valid_loss 0.488030
Epoch 11, Train Loss 0.468283, Valid_loss 0.439896
Epoch 12, Train Loss 0.445152, Valid_loss 0.475080
Epoch 13, Train Loss 0.407202, Valid_loss 0.453262
Epoch 14, Train Loss 0.393785, Valid_loss 0.685412
Epoch 15, Train Loss 0.359259, Valid_loss 0.512428
Epoch 16, Train Loss 0.391417, Valid_loss 0.560341
Epoch 17, Train Loss 0.394457, Valid_loss 0.467822
Epoch 18, Train Loss 0.348209, Valid_loss 0.429018
Epoch 19, Train Loss 0.296266, Valid_loss 0.458330
Epoch 20, Train Loss 0.325893, Valid_loss 0.484643
Epoch 21, Train Loss 0.358094, Valid_loss 0.433813
Epoch 22, Train Loss 0.488040, Valid_loss 0.493707
Epoch 23, Train Loss 0.344914, Valid_loss 0.475185
Epoch 24, Train Loss 0.307046, Valid_loss 0.547631
Epoch 25, Train Loss 0.247992, Valid_loss 0.690745
Epoch 26, Train Loss 0.337021, Valid_loss 0.482432
Epoch 27, Train Loss 0.370939, Valid_loss 0.525603
Epoch 28, Train Loss 0.294453, Valid_loss 0.465468
Epoch 29, Train Loss 0.298520, Valid_loss 0.470606
Epoch 30, Train Loss 0.304259, Valid_loss 0.646998
Epoch 31, Train Loss 0.273150, Valid_loss 0.396713
Epoch 32, Train Loss 0.435279, Valid_loss 0.524303
Epoch 33, Train Loss 0.409932, Valid_loss 0.686940
Epoch 34, Train Loss 0.349969, Valid_loss 0.825082
Epoch 35, Train Loss 0.297847, Valid_loss 0.604207
Epoch 36, Train Loss 0.215902, Valid_loss 0.515601
Epoch 37, Train Loss 0.237004, Valid_loss 0.526836
Epoch 38, Train Loss 0.206036, Valid_loss 0.501288
Epoch 39, Train Loss 0.199918, Valid_loss 0.453001
Epoch 40, Train Loss 0.225053, Valid_loss 0.462393
Epoch 41, Train Loss 0.227600, Valid_loss 0.522366
Epoch 42, Train Loss 0.215125, Valid_loss 0.440516
Epoch 43, Train Loss 0.263112, Valid_loss 0.550971
Epoch 44, Train Loss 0.188688, Valid_loss 0.567641
Epoch 45, Train Loss 0.201811, Valid_loss 0.620620
Epoch 46, Train Loss 0.186345, Valid_loss 0.539269
Epoch 47, Train Loss 0.150994, Valid_loss 0.662964
Epoch 48, Train Loss 0.170210, Valid_loss 0.540498
Epoch 49, Train Loss 0.208472, Valid_loss 0.816279
Epoch 50, Train Loss 0.281962, Valid_loss 0.613473
Epoch 51, Train Loss 0.210041, Valid_loss 0.684528
Epoch 52, Train Loss 0.194797, Valid_loss 0.614323
Epoch 53, Train Loss 0.164758, Valid_loss 0.689747
Epoch 54, Train Loss 0.144806, Valid_loss 0.539765
Epoch 55, Train Loss 0.140431, Valid_loss 0.583742
Epoch 56, Train Loss 0.149939, Valid_loss 0.584127
[I 2025-08-31 06:43:14,477] Trial 1 finished with value: 0.39671344673704534 and parameters: {'learning_rate': 0.001, 'epochs': 100, 'heads': 4, 'dropout': 0.5, 'weight_decay': 0.001, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.37087034425210386.
👉 train samples(학습 샘플(bag))=140, batch_size=16 -> steps(샘플수/batch크기)=9
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 1660.03 MB
Memory Reserved: 1670.00 MB
cuda
Epoch 1, Train Loss 0.923656, Valid_loss 1.133981
Epoch 2, Train Loss 0.873904, Valid_loss 1.096494
Epoch 3, Train Loss 0.867917, Valid_loss 1.100332
Epoch 4, Train Loss 0.874814, Valid_loss 1.139153
Epoch 5, Train Loss 0.859332, Valid_loss 1.091678
Epoch 6, Train Loss 0.855433, Valid_loss 1.136722
Epoch 7, Train Loss 0.869150, Valid_loss 1.152076
Epoch 8, Train Loss 0.842708, Valid_loss 1.098674
Epoch 9, Train Loss 0.804812, Valid_loss 1.194811
Epoch 10, Train Loss 0.713806, Valid_loss 0.908695
Epoch 11, Train Loss 0.539610, Valid_loss 0.624271
Epoch 12, Train Loss 0.427417, Valid_loss 0.671179
Epoch 13, Train Loss 0.465316, Valid_loss 0.575276
Epoch 14, Train Loss 0.540584, Valid_loss 0.605051
Epoch 15, Train Loss 0.405191, Valid_loss 0.401436
Epoch 16, Train Loss 0.479903, Valid_loss 0.437028
Epoch 17, Train Loss 0.581878, Valid_loss 0.477817
Epoch 18, Train Loss 0.415622, Valid_loss 0.604651
Epoch 19, Train Loss 0.342154, Valid_loss 0.675876
Epoch 20, Train Loss 0.331678, Valid_loss 0.533220
Epoch 21, Train Loss 0.420168, Valid_loss 0.715688
Epoch 22, Train Loss 0.502521, Valid_loss 0.445601
Epoch 23, Train Loss 0.422006, Valid_loss 0.432761
Epoch 24, Train Loss 0.299304, Valid_loss 0.503649
Epoch 25, Train Loss 0.258626, Valid_loss 0.626143
Epoch 26, Train Loss 0.271350, Valid_loss 0.458565
Epoch 27, Train Loss 0.222906, Valid_loss 0.328594
Epoch 28, Train Loss 0.223387, Valid_loss 0.479914
Epoch 29, Train Loss 0.303305, Valid_loss 0.435050
Epoch 30, Train Loss 0.415887, Valid_loss 0.551047
Epoch 31, Train Loss 0.266707, Valid_loss 1.150161
Epoch 32, Train Loss 0.315146, Valid_loss 0.570482
Epoch 33, Train Loss 0.261261, Valid_loss 0.511286
Epoch 34, Train Loss 0.198384, Valid_loss 0.593712
Epoch 35, Train Loss 0.157064, Valid_loss 0.490704
Epoch 36, Train Loss 0.174078, Valid_loss 0.458336
Epoch 37, Train Loss 0.181093, Valid_loss 0.434028
Epoch 38, Train Loss 0.131726, Valid_loss 0.500371
Epoch 39, Train Loss 0.204520, Valid_loss 0.595682
Epoch 40, Train Loss 0.246665, Valid_loss 0.521596
Epoch 41, Train Loss 0.205153, Valid_loss 0.656961
Epoch 42, Train Loss 0.237270, Valid_loss 0.625892
Epoch 43, Train Loss 0.155599, Valid_loss 0.519855
Epoch 44, Train Loss 0.122417, Valid_loss 0.604969
Epoch 45, Train Loss 0.100244, Valid_loss 0.874754
Epoch 46, Train Loss 0.111904, Valid_loss 0.730102
Epoch 47, Train Loss 0.079141, Valid_loss 0.931842
Epoch 48, Train Loss 0.191998, Valid_loss 0.682584
Epoch 49, Train Loss 0.091136, Valid_loss 0.497252
Epoch 50, Train Loss 0.109027, Valid_loss 0.511122
Epoch 51, Train Loss 0.134621, Valid_loss 0.553190
Epoch 52, Train Loss 0.134170, Valid_loss 0.510207
Epoch 53, Train Loss 0.072738, Valid_loss 0.721481
Epoch 54, Train Loss 0.126136, Valid_loss 0.445333
Epoch 55, Train Loss 0.117057, Valid_loss 0.633301
Epoch 56, Train Loss 0.089719, Valid_loss 0.899338
[I 2025-08-31 06:51:49,063] Trial 2 finished with value: 0.3285935960843095 and parameters: {'learning_rate': 0.01, 'epochs': 100, 'heads': 2, 'dropout': 0.0, 'weight_decay': 0.001, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 2 with value: 0.3285935960843095.
선택된 trial params: {'learning_rate': 0.01, 'epochs': 100, 'heads': 2, 'dropout': 0.0, 'weight_decay': 0.001, 'emb_dim': 32, 'augment_num': 100, 'pca': False}
👉 train samples(학습 샘플(bag))=140, batch_size=16 -> steps(샘플수/batch크기)=9
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=16, batch_size=1 -> steps=16
Memory Allocated: 1660.03 MB
Memory Reserved: 1670.00 MB
cuda
Epoch 1, Train Loss 0.934399, Valid_loss 1.174268
Epoch 2, Train Loss 0.879246, Valid_loss 1.089798
Epoch 3, Train Loss 0.889965, Valid_loss 1.185392
Epoch 4, Train Loss 0.882148, Valid_loss 1.104891
Epoch 5, Train Loss 0.858119, Valid_loss 1.140842
Epoch 6, Train Loss 0.862159, Valid_loss 1.113464
Epoch 7, Train Loss 0.880310, Valid_loss 1.168319
Epoch 8, Train Loss 0.867284, Valid_loss 1.127832
Epoch 9, Train Loss 0.867167, Valid_loss 1.095323
Epoch 10, Train Loss 0.865982, Valid_loss 1.152991
Epoch 11, Train Loss 0.866860, Valid_loss 1.149806
Epoch 12, Train Loss 0.857826, Valid_loss 1.115796
Epoch 13, Train Loss 0.861311, Valid_loss 1.166426
Epoch 14, Train Loss 0.856182, Valid_loss 1.128973
Epoch 15, Train Loss 0.859083, Valid_loss 1.140208
Epoch 16, Train Loss 0.855543, Valid_loss 1.170629
Epoch 17, Train Loss 0.878182, Valid_loss 1.198360
Epoch 18, Train Loss 0.863553, Valid_loss 1.079825
Epoch 19, Train Loss 0.862519, Valid_loss 1.152580
Epoch 20, Train Loss 0.853601, Valid_loss 1.142068
Epoch 21, Train Loss 0.857118, Valid_loss 1.156384
Epoch 22, Train Loss 0.856153, Valid_loss 1.158882
Epoch 23, Train Loss 0.849197, Valid_loss 1.129596
Epoch 24, Train Loss 0.854941, Valid_loss 1.150570
Epoch 25, Train Loss 0.852120, Valid_loss 1.196457
Epoch 26, Train Loss 0.867047, Valid_loss 1.137577
Epoch 27, Train Loss 0.861417, Valid_loss 1.149749
Epoch 28, Train Loss 0.860780, Valid_loss 1.156456
Epoch 29, Train Loss 0.858984, Valid_loss 1.123341
Epoch 30, Train Loss 0.856581, Valid_loss 1.122323
Epoch 31, Train Loss 0.851822, Valid_loss 1.158991
Epoch 32, Train Loss 0.846650, Valid_loss 1.149850
Epoch 33, Train Loss 0.853633, Valid_loss 1.112073
Epoch 34, Train Loss 0.865816, Valid_loss 1.105550
Epoch 35, Train Loss 0.861178, Valid_loss 1.176157
Epoch 36, Train Loss 0.851311, Valid_loss 1.152146
Epoch 37, Train Loss 0.851135, Valid_loss 1.149393
Epoch 38, Train Loss 0.848583, Valid_loss 1.154905
Epoch 39, Train Loss 0.850920, Valid_loss 1.167742
Epoch 40, Train Loss 0.853943, Valid_loss 1.131431
Epoch 41, Train Loss 0.856516, Valid_loss 1.117849
Epoch 42, Train Loss 0.867220, Valid_loss 1.169944
Epoch 43, Train Loss 0.854154, Valid_loss 1.104720
Epoch 44, Train Loss 0.854665, Valid_loss 1.110734
Epoch 45, Train Loss 0.861692, Valid_loss 1.148068
Epoch 46, Train Loss 0.845102, Valid_loss 1.073223
Epoch 47, Train Loss 0.857061, Valid_loss 1.092990
Epoch 48, Train Loss 0.849190, Valid_loss 1.094075
Epoch 49, Train Loss 0.843404, Valid_loss 1.090493
Epoch 50, Train Loss 0.863361, Valid_loss 1.113242
Epoch 51, Train Loss 0.845584, Valid_loss 1.109195
Epoch 52, Train Loss 0.844092, Valid_loss 1.087935
Epoch 53, Train Loss 0.847874, Valid_loss 1.113676
Epoch 54, Train Loss 0.840459, Valid_loss 1.075507
Epoch 55, Train Loss 0.847139, Valid_loss 1.069779
Epoch 56, Train Loss 0.845601, Valid_loss 1.095763
Epoch 57, Train Loss 0.840603, Valid_loss 1.060270
Epoch 58, Train Loss 0.841078, Valid_loss 1.071126
Epoch 59, Train Loss 0.847936, Valid_loss 1.117456
환자ID=163-4 -- true: [[0]] -- pred: tensor([[ 0.3138,  0.7349, -1.1220]], device='cuda:0')
환자ID=165-9 -- true: [[0]] -- pred: tensor([[ 0.3065,  0.7264, -1.1309]], device='cuda:0')
환자ID=29-10008 -- true: [[1]] -- pred: tensor([[ 0.3072,  0.7272, -1.1302]], device='cuda:0')
환자ID=29-10380 -- true: [[1]] -- pred: tensor([[ 0.3098,  0.7302, -1.1264]], device='cuda:0')
환자ID=29-10386 -- true: [[1]] -- pred: tensor([[ 0.3112,  0.7320, -1.1241]], device='cuda:0')
환자ID=29-10400 -- true: [[1]] -- pred: tensor([[ 0.3103,  0.7308, -1.1257]], device='cuda:0')
환자ID=29-10406 -- true: [[1]] -- pred: tensor([[ 0.3091,  0.7294, -1.1274]], device='cuda:0')
환자ID=29-10410 -- true: [[1]] -- pred: tensor([[ 0.3120,  0.7329, -1.1237]], device='cuda:0')
환자ID=30-10125 -- true: [[2]] -- pred: tensor([[ 0.3137,  0.7350, -1.1218]], device='cuda:0')
환자ID=31-10042 -- true: [[1]] -- pred: tensor([[ 0.3094,  0.7298, -1.1271]], device='cuda:0')
환자ID=31-10078 -- true: [[1]] -- pred: tensor([[ 0.3098,  0.7303, -1.1264]], device='cuda:0')
환자ID=32-10074 -- true: [[2]] -- pred: tensor([[ 0.3109,  0.7316, -1.1251]], device='cuda:0')
환자ID=34-10050 -- true: [[2]] -- pred: tensor([[ 0.3103,  0.7308, -1.1259]], device='cuda:0')
환자ID=PRE019 -- true: [[0]] -- pred: tensor([[ 0.3060,  0.7258, -1.1318]], device='cuda:0')
환자ID=Sample1153-EO3 -- true: [[0]] -- pred: tensor([[ 0.3067,  0.7266, -1.1309]], device='cuda:0')
환자ID=Sample1162-EO2 -- true: [[0]] -- pred: tensor([[ 0.3070,  0.7270, -1.1301]], device='cuda:0')
Best performance: Epoch 57, Loss 0.840603, Test ACC 0.500000, Test AUC 0.705556, Test Recall 0.333333, Test Precision 0.166667
Confusion Matrix:
 [[0 5 0]
 [0 8 0]
 [0 3 0]]
✅ Total valid splits used: 2
🔁 Repeat 2, Fold 2
cell type :  S2008000605HRT_AAACCCAGTGCACATT-1     Epithelial_cells
S2008000605HRT_AAACCCAGTGCCTACG-1     Epithelial_cells
S2008000605HRT_AAAGAACGTAGAGACC-1            Astrocyte
S2008000605HRT_AAAGAACGTCGGAACA-1     Epithelial_cells
S2008000605HRT_AAAGAACGTTAACAGA-1     Epithelial_cells
                                           ...        
Sample1162EO2_TTTGGAGAGCAGGCAT-1      Epithelial_cells
Sample1162EO2_TTTGGAGAGTCGCGAA-1     Endothelial_cells
Sample1162EO2_TTTGGAGAGTGCTCGC-1           Hepatocytes
Sample1162EO2_TTTGGAGGTGATACTC-1      Epithelial_cells
Sample1162EO2_TTTGGTTCAGTAGAAT-1      Epithelial_cells
Name: singler_annotation, Length: 184429, dtype: string
cell type annotation :  S2008000605HRT_AAACCCAGTGCACATT-1     Epithelial_cells
S2008000605HRT_AAACCCAGTGCCTACG-1     Epithelial_cells
S2008000605HRT_AAAGAACGTAGAGACC-1            Astrocyte
S2008000605HRT_AAAGAACGTCGGAACA-1     Epithelial_cells
S2008000605HRT_AAAGAACGTTAACAGA-1     Epithelial_cells
                                           ...        
Sample1162EO2_TTTGGAGAGCAGGCAT-1      Epithelial_cells
Sample1162EO2_TTTGGAGAGTCGCGAA-1     Endothelial_cells
Sample1162EO2_TTTGGAGAGTGCTCGC-1           Hepatocytes
Sample1162EO2_TTTGGAGGTGATACTC-1      Epithelial_cells
Sample1162EO2_TTTGGTTCAGTAGAAT-1      Epithelial_cells
Name: singler_annotation, Length: 184429, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Epithelial_cells', 'Astrocyte', 'MSC', 'Keratinocytes', 'Neurons', 'Endothelial_cells', 'Fibroblasts', 'Tissue_stem_cells', 'Smooth_muscle_cells', 'T_cells', 'Neuroepithelial_cell', 'NK_cell', 'Chondrocytes', 'Osteoblasts', 'Monocyte', 'Hepatocytes', 'Macrophage', 'CMP', 'Embryonic_stem_cells', 'DC', 'BM & Prog.', 'MEP', 'Neutrophils', 'Pro-Myelocyte', 'iPS_cells', 'Pre-B_cell_CD34-', 'HSC_-G-CSF', 'B_cell', 'GMP', 'HSC_CD34+', 'Platelets', 'Pro-B_cell_CD34+', 'Myelocyte', 'BM', 'Erythroblast', 'Gametocytes', 'Unknown']
라벨별 그룹 개수 {0: 21, 1: 30, 2: 11}
cell type :  S2107011581HRT_AAACCCAGTTTCCAAG-1       Endothelial_cells
S2107011581HRT_AAACCCATCACTACTT-1       Endothelial_cells
S2107011581HRT_AAACGAAAGGGCCCTT-1     Smooth_muscle_cells
S2107011581HRT_AAACGAAAGTAGAATC-1             Hepatocytes
S2107011581HRT_AAACGAATCACTCGAA-1    Neuroepithelial_cell
                                             ...         
Sample1162EO1_TTTCACAAGGGCAGAG-1                iPS_cells
Sample1162EO1_TTTCCTCAGCGTGCCT-1              Hepatocytes
Sample1162EO1_TTTCCTCAGTACTGTC-1         Epithelial_cells
Sample1162EO1_TTTGGTTTCCACATAG-1              Hepatocytes
Sample1162EO1_TTTGTTGCACACGCCA-1         Epithelial_cells
Name: singler_annotation, Length: 40748, dtype: string
cell type annotation :  S2107011581HRT_AAACCCAGTTTCCAAG-1       Endothelial_cells
S2107011581HRT_AAACCCATCACTACTT-1       Endothelial_cells
S2107011581HRT_AAACGAAAGGGCCCTT-1     Smooth_muscle_cells
S2107011581HRT_AAACGAAAGTAGAATC-1             Hepatocytes
S2107011581HRT_AAACGAATCACTCGAA-1    Neuroepithelial_cell
                                             ...         
Sample1162EO1_TTTCACAAGGGCAGAG-1                iPS_cells
Sample1162EO1_TTTCCTCAGCGTGCCT-1              Hepatocytes
Sample1162EO1_TTTCCTCAGTACTGTC-1         Epithelial_cells
Sample1162EO1_TTTGGTTTCCACATAG-1              Hepatocytes
Sample1162EO1_TTTGTTGCACACGCCA-1         Epithelial_cells
Name: singler_annotation, Length: 40748, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Endothelial_cells', 'Smooth_muscle_cells', 'Hepatocytes', 'Neuroepithelial_cell', 'Neurons', 'Epithelial_cells', 'Fibroblasts', 'CMP', 'Astrocyte', 'NK_cell', 'T_cells', 'Pro-B_cell_CD34+', 'Monocyte', 'Embryonic_stem_cells', 'iPS_cells', 'DC', 'Keratinocytes', 'B_cell', 'Neutrophils', 'Unknown', 'GMP', 'Chondrocytes', 'BM & Prog.', 'Tissue_stem_cells', 'Pre-B_cell_CD34-', 'HSC_CD34+', 'Macrophage', 'HSC_-G-CSF', 'Platelets', 'Erythroblast', 'MEP', 'Osteoblasts', 'Gametocytes', 'MSC', 'BM', 'Pro-Myelocyte', 'Myelocyte']
라벨별 그룹 개수 {0: 5, 1: 7, 2: 3}
🔍 Split #3
  → train_p_index 환자 수 (환자 단위로 묶인 index list): 62
  → test_p_index 환자 수  (환자 단위로 묶인 index list): 15
  → train 환자 ID: ['163-2', '163-3', '163-4', '163-5', '164-10', '164-3', '165-9', '27-10039', '27-10041', '27-10112', '27-10119', '28-10051', '28-12263', '28-12381', '28-12518', '29-10006', '29-10008', '29-10010', '29-10011', '29-10013', '29-10016', '29-10280', '29-10380', '29-10386', '29-10398', '29-10400', '29-10406', '29-10410', '30-10018', '30-10034', '30-10123', '30-10125', '30-10929', '30-11051', '31-10000', '31-10001', '31-10035', '31-10040', '31-10042', '31-10078', '31-10154', '31-10210', '31-10236', '32-10003', '32-10074', '34-10050', '34-10184', '34-10187', 'PRE018-1', 'PRE019', 'PRE027', 'PRE038', 'PRE055-1', 'PRE062-1', 'Sample1153-EO1', 'Sample1153-EO2', 'Sample1153-EO3', 'Sample1157-EO1', 'Sample1157-EO2', 'Sample1157-EO3', 'Sample1158-EO2', 'Sample1162-EO2']
  → test  환자 ID: ['164-6', '27-10053', '27-10071', '28-11515', '28-12490', '29-10012', '29-10404', '31-10013', '32-10034', '33-10005', '33-10006', 'PRE98sc', 'Sample1158-EO1', 'Sample1158-EO3', 'Sample1162-EO1']
  → train 환자 ID 및 라벨:
    ID: 163-2, Label: 0
    ID: 163-3, Label: 0
    ID: 163-4, Label: 0
    ID: 163-5, Label: 0
    ID: 164-10, Label: 0
    ID: 164-3, Label: 0
    ID: 165-9, Label: 0
    ID: 27-10039, Label: 1
    ID: 27-10041, Label: 1
    ID: 27-10112, Label: 1
    ID: 27-10119, Label: 1
    ID: 28-10051, Label: 1
    ID: 28-12263, Label: 1
    ID: 28-12381, Label: 1
    ID: 28-12518, Label: 1
    ID: 29-10006, Label: 1
    ID: 29-10008, Label: 1
    ID: 29-10010, Label: 1
    ID: 29-10011, Label: 1
    ID: 29-10013, Label: 1
    ID: 29-10016, Label: 1
    ID: 29-10280, Label: 1
    ID: 29-10380, Label: 1
    ID: 29-10386, Label: 1
    ID: 29-10398, Label: 1
    ID: 29-10400, Label: 1
    ID: 29-10406, Label: 1
    ID: 29-10410, Label: 1
    ID: 30-10018, Label: 2
    ID: 30-10034, Label: 2
    ID: 30-10123, Label: 2
    ID: 30-10125, Label: 2
    ID: 30-10929, Label: 2
    ID: 30-11051, Label: 2
    ID: 31-10000, Label: 1
    ID: 31-10001, Label: 1
    ID: 31-10035, Label: 1
    ID: 31-10040, Label: 1
    ID: 31-10042, Label: 1
    ID: 31-10078, Label: 1
    ID: 31-10154, Label: 1
    ID: 31-10210, Label: 1
    ID: 31-10236, Label: 1
    ID: 32-10003, Label: 2
    ID: 32-10074, Label: 2
    ID: 34-10050, Label: 2
    ID: 34-10184, Label: 2
    ID: 34-10187, Label: 2
    ID: PRE018-1, Label: 0
    ID: PRE019, Label: 0
    ID: PRE027, Label: 0
    ID: PRE038, Label: 0
    ID: PRE055-1, Label: 0
    ID: PRE062-1, Label: 0
    ID: Sample1153-EO1, Label: 0
    ID: Sample1153-EO2, Label: 0
    ID: Sample1153-EO3, Label: 0
    ID: Sample1157-EO1, Label: 0
    ID: Sample1157-EO2, Label: 0
    ID: Sample1157-EO3, Label: 0
    ID: Sample1158-EO2, Label: 0
    ID: Sample1162-EO2, Label: 0
  → test 환자 ID 및 라벨:
    ID: 164-6, Label: 0
    ID: 27-10053, Label: 1
    ID: 27-10071, Label: 1
    ID: 28-11515, Label: 1
    ID: 28-12490, Label: 1
    ID: 29-10012, Label: 1
    ID: 29-10404, Label: 1
    ID: 31-10013, Label: 1
    ID: 32-10034, Label: 2
    ID: 33-10005, Label: 2
    ID: 33-10006, Label: 2
    ID: PRE98sc, Label: 0
    ID: Sample1158-EO1, Label: 0
    ID: Sample1158-EO3, Label: 0
    ID: Sample1162-EO1, Label: 0
전체 데이터 index 길이 77
label_stat (train 환자 라벨 목록) 갯수 62
train_data에서 환자 단위로, train과 validation 나누기
기존 train_p_index 62
기존 (train) label_stat 62
train-vali 분할 후! 
train y 의 classes : {0, 1, 2} valid y 의 classes : {0, 1, 2} label_stat 의 classes : {0, 1, 2}
train_p_index_ 41
valid_p_index 21
test_p_index 15
→ train 환자 ID 및 라벨:
   총 개수: 41
   환자ID=29-10280, Label=1, 셀개수=2375
   환자ID=31-10042, Label=1, 셀개수=1222
   환자ID=34-10184, Label=2, 셀개수=2699
   환자ID=31-10210, Label=1, 셀개수=3510
   환자ID=Sample1157-EO2, Label=0, 셀개수=1395
   환자ID=163-5, Label=0, 셀개수=1210
   환자ID=29-10010, Label=1, 셀개수=5305
   환자ID=PRE027, Label=0, 셀개수=2078
   환자ID=30-11051, Label=2, 셀개수=2454
   환자ID=30-10125, Label=2, 셀개수=3798
   환자ID=163-3, Label=0, 셀개수=1335
   환자ID=28-10051, Label=1, 셀개수=300
   환자ID=165-9, Label=0, 셀개수=2926
   환자ID=27-10039, Label=1, 셀개수=4638
   환자ID=163-2, Label=0, 셀개수=2535
   환자ID=30-10018, Label=2, 셀개수=5170
   환자ID=31-10001, Label=1, 셀개수=1133
   환자ID=30-10123, Label=2, 셀개수=1273
   환자ID=Sample1157-EO3, Label=0, 셀개수=807
   환자ID=29-10386, Label=1, 셀개수=802
   환자ID=31-10000, Label=1, 셀개수=8870
   환자ID=163-4, Label=0, 셀개수=1339
   환자ID=31-10154, Label=1, 셀개수=6568
   환자ID=PRE055-1, Label=0, 셀개수=597
   환자ID=29-10406, Label=1, 셀개수=3484
   환자ID=28-12381, Label=1, 셀개수=1099
   환자ID=Sample1158-EO2, Label=0, 셀개수=1427
   환자ID=31-10035, Label=1, 셀개수=2974
   환자ID=34-10187, Label=2, 셀개수=3739
   환자ID=27-10119, Label=1, 셀개수=3346
   환자ID=29-10008, Label=1, 셀개수=1913
   환자ID=28-12263, Label=1, 셀개수=7527
   환자ID=164-3, Label=0, 셀개수=1639
   환자ID=29-10400, Label=1, 셀개수=2684
   환자ID=34-10050, Label=2, 셀개수=4784
   환자ID=29-10380, Label=1, 셀개수=4799
   환자ID=32-10003, Label=2, 셀개수=2978
   환자ID=31-10236, Label=1, 셀개수=3458
   환자ID=31-10078, Label=1, 셀개수=2827
   환자ID=29-10016, Label=1, 셀개수=4854
   환자ID=29-10006, Label=1, 셀개수=11461
→ valid 환자 ID 및 라벨:
   총 개수: 21
   환자ID=Sample1162-EO2, Label=0, 셀개수=1510
   환자ID=29-10013, Label=1, 셀개수=3706
   환자ID=31-10040, Label=1, 셀개수=4543
   환자ID=PRE062-1, Label=0, 셀개수=907
   환자ID=32-10074, Label=2, 셀개수=6304
   환자ID=PRE038, Label=0, 셀개수=2666
   환자ID=Sample1153-EO3, Label=0, 셀개수=1516
   환자ID=30-10034, Label=2, 셀개수=1240
   환자ID=30-10929, Label=2, 셀개수=5812
   환자ID=29-10410, Label=1, 셀개수=2834
   환자ID=Sample1157-EO1, Label=0, 셀개수=1152
   환자ID=27-10112, Label=1, 셀개수=1470
   환자ID=29-10398, Label=1, 셀개수=3993
   환자ID=Sample1153-EO1, Label=0, 셀개수=911
   환자ID=PRE019, Label=0, 셀개수=3795
   환자ID=PRE018-1, Label=0, 셀개수=1349
   환자ID=164-10, Label=0, 셀개수=4041
   환자ID=29-10011, Label=1, 셀개수=3072
   환자ID=27-10041, Label=1, 셀개수=2145
   환자ID=28-12518, Label=1, 셀개수=1215
   환자ID=Sample1153-EO2, Label=0, 셀개수=916
→ test 환자 ID 및 라벨:
   총 개수: 15
   환자ID=164-6, Label=0, 셀개수=3038
   환자ID=27-10053, Label=1, 셀개수=728
   환자ID=27-10071, Label=1, 셀개수=1478
   환자ID=28-11515, Label=1, 셀개수=930
   환자ID=28-12490, Label=1, 셀개수=5973
   환자ID=29-10012, Label=1, 셀개수=6245
   환자ID=29-10404, Label=1, 셀개수=3988
   환자ID=31-10013, Label=1, 셀개수=3161
   환자ID=32-10034, Label=2, 셀개수=1555
   환자ID=33-10005, Label=2, 셀개수=8904
   환자ID=33-10006, Label=2, 셀개수=457
   환자ID=PRE98sc, Label=0, 셀개수=1568
   환자ID=Sample1158-EO1, Label=0, 셀개수=574
   환자ID=Sample1158-EO3, Label=0, 셀개수=1096
   환자ID=Sample1162-EO1, Label=0, 셀개수=1053
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Epithelial_cells', 'Epithelial_cells', 'Astrocyte', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'MSC', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
전체 데이터 길이 225177
전체 cell type 길이 0         Epithelial_cells
1         Epithelial_cells
2                Astrocyte
3         Epithelial_cells
4         Epithelial_cells
                ...       
225172           iPS_cells
225173         Hepatocytes
225174    Epithelial_cells
225175         Hepatocytes
225176    Epithelial_cells
Length: 225177, dtype: string
cell type의 NaN 개수 체크 0
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:10,  9.65it/s]  3%|▎         | 3/100 [00:00<00:10,  9.20it/s]  4%|▍         | 4/100 [00:00<00:10,  9.34it/s]  5%|▌         | 5/100 [00:00<00:09,  9.54it/s]  6%|▌         | 6/100 [00:00<00:09,  9.49it/s]  8%|▊         | 8/100 [00:00<00:09,  9.84it/s]  9%|▉         | 9/100 [00:00<00:09,  9.51it/s] 10%|█         | 10/100 [00:01<00:09,  9.29it/s] 11%|█         | 11/100 [00:01<00:09,  9.20it/s] 12%|█▏        | 12/100 [00:01<00:11,  7.68it/s] 13%|█▎        | 13/100 [00:01<00:10,  8.03it/s] 14%|█▍        | 14/100 [00:01<00:10,  8.08it/s] 15%|█▌        | 15/100 [00:01<00:10,  8.48it/s] 17%|█▋        | 17/100 [00:01<00:09,  9.01it/s] 18%|█▊        | 18/100 [00:02<00:09,  8.98it/s] 19%|█▉        | 19/100 [00:02<00:09,  8.88it/s] 20%|██        | 20/100 [00:02<00:09,  8.82it/s] 21%|██        | 21/100 [00:02<00:10,  7.55it/s] 22%|██▏       | 22/100 [00:02<00:09,  7.87it/s] 23%|██▎       | 23/100 [00:02<00:09,  8.15it/s] 24%|██▍       | 24/100 [00:02<00:10,  7.47it/s] 25%|██▌       | 25/100 [00:02<00:10,  6.85it/s] 26%|██▌       | 26/100 [00:03<00:09,  7.44it/s] 27%|██▋       | 27/100 [00:03<00:09,  7.73it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.09it/s] 29%|██▉       | 29/100 [00:03<00:08,  8.25it/s] 30%|███       | 30/100 [00:03<00:08,  8.12it/s] 31%|███       | 31/100 [00:03<00:08,  7.96it/s] 32%|███▏      | 32/100 [00:03<00:08,  8.13it/s] 33%|███▎      | 33/100 [00:03<00:08,  8.25it/s] 34%|███▍      | 34/100 [00:04<00:07,  8.30it/s] 35%|███▌      | 35/100 [00:04<00:07,  8.57it/s] 36%|███▌      | 36/100 [00:04<00:07,  8.72it/s] 37%|███▋      | 37/100 [00:04<00:07,  8.85it/s] 38%|███▊      | 38/100 [00:04<00:06,  8.90it/s] 39%|███▉      | 39/100 [00:04<00:06,  8.77it/s] 40%|████      | 40/100 [00:04<00:06,  8.73it/s] 41%|████      | 41/100 [00:04<00:06,  8.71it/s] 42%|████▏     | 42/100 [00:04<00:06,  8.87it/s] 43%|████▎     | 43/100 [00:05<00:07,  7.63it/s] 44%|████▍     | 44/100 [00:05<00:08,  6.65it/s] 45%|████▌     | 45/100 [00:05<00:07,  7.11it/s] 46%|████▌     | 46/100 [00:05<00:07,  7.56it/s] 47%|████▋     | 47/100 [00:05<00:06,  7.74it/s] 48%|████▊     | 48/100 [00:05<00:06,  7.94it/s] 49%|████▉     | 49/100 [00:05<00:06,  8.08it/s] 50%|█████     | 50/100 [00:06<00:06,  8.14it/s] 51%|█████     | 51/100 [00:06<00:05,  8.32it/s] 52%|█████▏    | 52/100 [00:06<00:06,  7.67it/s] 53%|█████▎    | 53/100 [00:06<00:05,  8.05it/s] 54%|█████▍    | 54/100 [00:06<00:05,  8.30it/s] 55%|█████▌    | 55/100 [00:06<00:05,  8.42it/s] 56%|█████▌    | 56/100 [00:06<00:05,  8.52it/s] 57%|█████▋    | 57/100 [00:06<00:05,  8.48it/s] 58%|█████▊    | 58/100 [00:06<00:04,  8.50it/s] 59%|█████▉    | 59/100 [00:07<00:04,  8.40it/s] 60%|██████    | 60/100 [00:07<00:04,  8.30it/s] 61%|██████    | 61/100 [00:07<00:05,  6.55it/s] 62%|██████▏   | 62/100 [00:07<00:05,  7.10it/s] 63%|██████▎   | 63/100 [00:07<00:05,  7.37it/s] 64%|██████▍   | 64/100 [00:07<00:04,  7.51it/s] 65%|██████▌   | 65/100 [00:07<00:04,  7.86it/s] 66%|██████▌   | 66/100 [00:08<00:04,  8.31it/s] 67%|██████▋   | 67/100 [00:08<00:04,  8.15it/s] 68%|██████▊   | 68/100 [00:08<00:03,  8.27it/s] 69%|██████▉   | 69/100 [00:08<00:03,  7.94it/s] 70%|███████   | 70/100 [00:08<00:03,  8.17it/s] 71%|███████   | 71/100 [00:08<00:03,  8.22it/s] 72%|███████▏  | 72/100 [00:08<00:03,  8.30it/s] 73%|███████▎  | 73/100 [00:08<00:03,  8.33it/s] 74%|███████▍  | 74/100 [00:09<00:03,  8.16it/s] 75%|███████▌  | 75/100 [00:09<00:03,  8.28it/s] 76%|███████▌  | 76/100 [00:09<00:02,  8.29it/s] 77%|███████▋  | 77/100 [00:09<00:02,  8.13it/s] 78%|███████▊  | 78/100 [00:09<00:02,  7.62it/s] 79%|███████▉  | 79/100 [00:09<00:02,  7.72it/s] 80%|████████  | 80/100 [00:09<00:02,  7.73it/s] 81%|████████  | 81/100 [00:09<00:02,  7.79it/s] 82%|████████▏ | 82/100 [00:10<00:02,  7.94it/s] 83%|████████▎ | 83/100 [00:10<00:02,  8.17it/s] 84%|████████▍ | 84/100 [00:10<00:01,  8.01it/s] 85%|████████▌ | 85/100 [00:10<00:01,  7.94it/s] 86%|████████▌ | 86/100 [00:10<00:01,  7.54it/s] 87%|████████▋ | 87/100 [00:10<00:01,  7.71it/s] 88%|████████▊ | 88/100 [00:10<00:01,  7.88it/s] 89%|████████▉ | 89/100 [00:10<00:01,  7.95it/s] 90%|█████████ | 90/100 [00:11<00:01,  7.81it/s] 91%|█████████ | 91/100 [00:11<00:01,  7.88it/s] 92%|█████████▏| 92/100 [00:11<00:01,  6.79it/s] 93%|█████████▎| 93/100 [00:11<00:00,  7.17it/s] 94%|█████████▍| 94/100 [00:11<00:00,  7.36it/s] 95%|█████████▌| 95/100 [00:11<00:00,  6.85it/s] 96%|█████████▌| 96/100 [00:11<00:00,  7.18it/s] 97%|█████████▋| 97/100 [00:12<00:00,  7.37it/s] 98%|█████████▊| 98/100 [00:12<00:00,  7.41it/s] 99%|█████████▉| 99/100 [00:12<00:00,  7.66it/s]100%|██████████| 100/100 [00:12<00:00,  7.69it/s]100%|██████████| 100/100 [00:12<00:00,  8.05it/s]
[I 2025-08-31 07:01:11,762] A new study created in memory with name: no-name-f7d11573-86cf-4104-ac30-3a788302b356
👉 train samples(학습 샘플(bag))=141, batch_size=16 -> steps(샘플수/batch크기)=9
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 24.81 MB
Memory Reserved: 36.00 MB
cuda
CUDA OOM 발생 — 단계적 백오프 시작.
[OOM RETRY] batch_size 16 → 8 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=141, batch_size=8 -> steps(샘플수/batch크기)=18
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 2125.43 MB
Memory Reserved: 2136.00 MB
cuda
[OOM RETRY] batch_size=8에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 16 → 4 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=141, batch_size=4 -> steps(샘플수/batch크기)=36
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 3175.96 MB
Memory Reserved: 3186.00 MB
cuda
Epoch 1, Train Loss 0.968606, Valid_loss 1.042369
Epoch 2, Train Loss 0.859914, Valid_loss 1.069541
Epoch 3, Train Loss 0.886728, Valid_loss 1.088401
Epoch 4, Train Loss 0.875542, Valid_loss 1.068382
Epoch 5, Train Loss 0.890250, Valid_loss 1.079616
Epoch 6, Train Loss 0.918619, Valid_loss 1.064668
Epoch 7, Train Loss 0.894018, Valid_loss 1.071743
Epoch 8, Train Loss 0.874475, Valid_loss 1.101862
Epoch 9, Train Loss 0.860142, Valid_loss 1.094270
Epoch 10, Train Loss 0.869482, Valid_loss 1.082482
Epoch 11, Train Loss 0.910889, Valid_loss 1.091405
Epoch 12, Train Loss 0.864358, Valid_loss 1.108801
Epoch 13, Train Loss 0.851624, Valid_loss 1.105101
Epoch 14, Train Loss 0.902975, Valid_loss 1.098313
Epoch 15, Train Loss 0.901052, Valid_loss 1.078622
Epoch 16, Train Loss 0.867423, Valid_loss 1.107468
Epoch 17, Train Loss 0.877633, Valid_loss 1.208747
Epoch 18, Train Loss 0.887978, Valid_loss 1.086846
Epoch 19, Train Loss 0.867860, Valid_loss 1.080897
Epoch 20, Train Loss 0.841531, Valid_loss 1.149810
Epoch 21, Train Loss 0.866044, Valid_loss 1.111702
Epoch 22, Train Loss 0.842288, Valid_loss 1.174843
Epoch 23, Train Loss 0.838053, Valid_loss 1.201288
Epoch 24, Train Loss 0.850123, Valid_loss 1.197526
Epoch 25, Train Loss 0.847319, Valid_loss 1.247135
Epoch 26, Train Loss 0.857684, Valid_loss 1.222870
Epoch 27, Train Loss 0.849438, Valid_loss 1.222581
Epoch 28, Train Loss 0.850247, Valid_loss 1.118688
Epoch 29, Train Loss 0.846773, Valid_loss 1.174761
Epoch 30, Train Loss 0.852980, Valid_loss 1.147785
Epoch 31, Train Loss 0.887818, Valid_loss 1.145993
Epoch 32, Train Loss 0.844902, Valid_loss 1.176102
Epoch 33, Train Loss 0.845080, Valid_loss 1.063318
Epoch 34, Train Loss 0.868430, Valid_loss 1.079898
Epoch 35, Train Loss 0.860001, Valid_loss 1.093959
Epoch 36, Train Loss 0.859028, Valid_loss 1.081269
Epoch 37, Train Loss 0.896325, Valid_loss 1.128553
Epoch 38, Train Loss 0.851552, Valid_loss 1.113934
Epoch 39, Train Loss 0.863593, Valid_loss 1.100798
Epoch 40, Train Loss 0.855790, Valid_loss 1.126635
Epoch 41, Train Loss 0.850902, Valid_loss 1.150800
Epoch 42, Train Loss 0.871820, Valid_loss 1.077557
Epoch 43, Train Loss 0.856308, Valid_loss 1.081540
Epoch 44, Train Loss 0.899704, Valid_loss 1.101231
Epoch 45, Train Loss 0.857790, Valid_loss 1.104950
Epoch 46, Train Loss 0.845091, Valid_loss 1.189589
Epoch 47, Train Loss 0.846977, Valid_loss 1.155874
Epoch 48, Train Loss 0.849337, Valid_loss 1.152540
Epoch 49, Train Loss 0.855427, Valid_loss 1.136485
Epoch 50, Train Loss 0.856740, Valid_loss 1.129765
Epoch 51, Train Loss 0.849685, Valid_loss 1.126389
Epoch 52, Train Loss 0.890432, Valid_loss 1.138612
Epoch 53, Train Loss 0.844193, Valid_loss 1.135376
Epoch 54, Train Loss 0.877263, Valid_loss 1.164347
Epoch 55, Train Loss 0.846784, Valid_loss 1.143742
Epoch 56, Train Loss 0.854695, Valid_loss 1.154036
Epoch 57, Train Loss 0.838871, Valid_loss 1.164942
[I 2025-08-31 07:13:06,301] Trial 0 finished with value: 1.042369115920294 and parameters: {'learning_rate': 0.01, 'epochs': 100, 'heads': 4, 'dropout': 0.5, 'weight_decay': 0.001, 'emb_dim': 8, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 1.042369115920294.
👉 train samples(학습 샘플(bag))=141, batch_size=16 -> steps(샘플수/batch크기)=9
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 1076.66 MB
Memory Reserved: 1088.00 MB
cuda
CUDA OOM 발생 — 단계적 백오프 시작.
[OOM RETRY] batch_size 16 → 8 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=141, batch_size=8 -> steps(샘플수/batch크기)=18
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 11254.98 MB
Memory Reserved: 11268.00 MB
cuda
[OOM RETRY] batch_size=8에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 16 → 4 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=141, batch_size=4 -> steps(샘플수/batch크기)=36
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 6167.58 MB
Memory Reserved: 6182.00 MB
cuda
Epoch 1, Train Loss 0.890174, Valid_loss 1.215850
Epoch 2, Train Loss 0.908138, Valid_loss 1.035473
Epoch 3, Train Loss 0.875487, Valid_loss 1.069891
Epoch 4, Train Loss 0.882074, Valid_loss 1.074860
Epoch 5, Train Loss 0.860776, Valid_loss 1.126447
Epoch 6, Train Loss 0.867006, Valid_loss 1.110400
Epoch 7, Train Loss 0.863639, Valid_loss 1.105441
Epoch 8, Train Loss 0.871542, Valid_loss 1.145563
Epoch 9, Train Loss 0.882543, Valid_loss 1.113299
Epoch 10, Train Loss 0.856206, Valid_loss 1.148400
Epoch 11, Train Loss 0.859576, Valid_loss 1.233216
Epoch 12, Train Loss 0.854851, Valid_loss 1.191137
Epoch 13, Train Loss 0.856614, Valid_loss 1.204386
Epoch 14, Train Loss 0.851145, Valid_loss 1.164318
Epoch 15, Train Loss 0.842203, Valid_loss 1.322201
Epoch 16, Train Loss 0.837389, Valid_loss 1.426865
Epoch 17, Train Loss 0.855670, Valid_loss 1.280829
Epoch 18, Train Loss 0.830178, Valid_loss 1.507865
Epoch 19, Train Loss 0.879896, Valid_loss 1.194869
Epoch 20, Train Loss 0.873596, Valid_loss 1.283022
Epoch 21, Train Loss 0.811137, Valid_loss 1.571617
Epoch 22, Train Loss 0.870327, Valid_loss 1.266756
Epoch 23, Train Loss 0.832480, Valid_loss 1.308866
Epoch 24, Train Loss 0.855664, Valid_loss 1.446437
Epoch 25, Train Loss 0.855895, Valid_loss 1.206017
Epoch 26, Train Loss 0.833194, Valid_loss 1.390156
Epoch 27, Train Loss 0.818945, Valid_loss 1.441279
Epoch 28, Train Loss 0.839457, Valid_loss 1.454996
Epoch 29, Train Loss 0.845983, Valid_loss 1.430180
Epoch 30, Train Loss 0.841627, Valid_loss 1.443191
Epoch 31, Train Loss 0.828649, Valid_loss 1.429800
Epoch 32, Train Loss 0.815192, Valid_loss 1.470260
Epoch 33, Train Loss 0.803786, Valid_loss 1.659974
Epoch 34, Train Loss 0.801359, Valid_loss 1.523750
Epoch 35, Train Loss 0.812536, Valid_loss 1.363602
Epoch 36, Train Loss 0.812078, Valid_loss 1.432224
Epoch 37, Train Loss 0.926783, Valid_loss 1.575249
Epoch 38, Train Loss 0.826141, Valid_loss 1.333476
Epoch 39, Train Loss 0.853104, Valid_loss 1.206027
Epoch 40, Train Loss 0.813846, Valid_loss 1.399694
Epoch 41, Train Loss 0.823165, Valid_loss 1.377278
Epoch 42, Train Loss 0.815383, Valid_loss 1.475705
Epoch 43, Train Loss 0.824217, Valid_loss 1.437375
Epoch 44, Train Loss 0.806305, Valid_loss 1.494613
Epoch 45, Train Loss 0.814494, Valid_loss 1.481198
Epoch 46, Train Loss 0.815450, Valid_loss 1.401936
Epoch 47, Train Loss 0.808183, Valid_loss 1.482157
Epoch 48, Train Loss 0.811018, Valid_loss 1.527933
Epoch 49, Train Loss 0.793600, Valid_loss 1.606772
Epoch 50, Train Loss 0.804647, Valid_loss 1.547238
Epoch 51, Train Loss 0.791258, Valid_loss 1.562004
Epoch 52, Train Loss 0.785853, Valid_loss 1.568272
[I 2025-08-31 07:21:10,443] Trial 1 finished with value: 1.0354726967357455 and parameters: {'learning_rate': 0.01, 'epochs': 100, 'heads': 2, 'dropout': 0.0, 'weight_decay': 0.001, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 1 with value: 1.0354726967357455.
👉 train samples(학습 샘플(bag))=141, batch_size=16 -> steps(샘플수/batch크기)=9
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 6166.26 MB
Memory Reserved: 6182.00 MB
cuda
CUDA OOM 발생 — 단계적 백오프 시작.
[OOM RETRY] batch_size 16 → 8 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=141, batch_size=8 -> steps(샘플수/batch크기)=18
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 8266.87 MB
Memory Reserved: 8282.00 MB
cuda
[OOM RETRY] batch_size=8에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 16 → 4 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=141, batch_size=4 -> steps(샘플수/batch크기)=36
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 9317.40 MB
Memory Reserved: 9332.00 MB
cuda
[OOM RETRY] batch_size=4에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 16 → 2 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=141, batch_size=2 -> steps(샘플수/batch크기)=71
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 13860.09 MB
Memory Reserved: 13870.00 MB
cuda
Epoch 1, Train Loss 0.946569, Valid_loss 1.053801
Epoch 2, Train Loss 0.916009, Valid_loss 1.064396
Epoch 3, Train Loss 0.892859, Valid_loss 1.076930
Epoch 4, Train Loss 0.888512, Valid_loss 1.050916
Epoch 5, Train Loss 0.867222, Valid_loss 1.048965
Epoch 6, Train Loss 0.852758, Valid_loss 1.102147
Epoch 7, Train Loss 0.886034, Valid_loss 1.060128
Epoch 8, Train Loss 0.875808, Valid_loss 1.061833
Epoch 9, Train Loss 0.874274, Valid_loss 1.057567
Epoch 10, Train Loss 0.873216, Valid_loss 1.051862
Epoch 11, Train Loss 0.863999, Valid_loss 1.070077
Epoch 12, Train Loss 0.863261, Valid_loss 1.058594
Epoch 13, Train Loss 0.860615, Valid_loss 1.078709
Epoch 14, Train Loss 0.860952, Valid_loss 1.060855
Epoch 15, Train Loss 0.863391, Valid_loss 1.071586
Epoch 16, Train Loss 0.865820, Valid_loss 1.055849
Epoch 17, Train Loss 0.878385, Valid_loss 1.067041
Epoch 18, Train Loss 0.864946, Valid_loss 1.062241
Epoch 19, Train Loss 0.860432, Valid_loss 1.063190
Epoch 20, Train Loss 0.860441, Valid_loss 1.068136
Epoch 21, Train Loss 0.861347, Valid_loss 1.062199
Epoch 22, Train Loss 0.859228, Valid_loss 1.069362
Epoch 23, Train Loss 0.861317, Valid_loss 1.069894
Epoch 24, Train Loss 0.861320, Valid_loss 1.062523
Epoch 25, Train Loss 0.860236, Valid_loss 1.064492
Epoch 26, Train Loss 0.862684, Valid_loss 1.060812
Epoch 27, Train Loss 0.860626, Valid_loss 1.067551
Epoch 28, Train Loss 0.874327, Valid_loss 1.065695
Epoch 29, Train Loss 0.861268, Valid_loss 1.063673
Epoch 30, Train Loss 0.863663, Valid_loss 1.070090
Epoch 31, Train Loss 0.860266, Valid_loss 1.062923
Epoch 32, Train Loss 0.860731, Valid_loss 1.060283
Epoch 33, Train Loss 0.861947, Valid_loss 1.072067
Epoch 34, Train Loss 0.862274, Valid_loss 1.070086
Epoch 35, Train Loss 0.858449, Valid_loss 1.065549
Epoch 36, Train Loss 0.858393, Valid_loss 1.064850
Epoch 37, Train Loss 0.862796, Valid_loss 1.072276
Epoch 38, Train Loss 0.861995, Valid_loss 1.064006
Epoch 39, Train Loss 0.862734, Valid_loss 1.065884
Epoch 40, Train Loss 0.862811, Valid_loss 1.062404
Epoch 41, Train Loss 0.859514, Valid_loss 1.057981
Epoch 42, Train Loss 0.860399, Valid_loss 1.068964
Epoch 43, Train Loss 0.859021, Valid_loss 1.070679
Epoch 44, Train Loss 0.859660, Valid_loss 1.066497
Epoch 45, Train Loss 0.859867, Valid_loss 1.063296
Epoch 46, Train Loss 0.862656, Valid_loss 1.068722
Epoch 47, Train Loss 0.859897, Valid_loss 1.065993
Epoch 48, Train Loss 0.877867, Valid_loss 1.074205
Epoch 49, Train Loss 0.875342, Valid_loss 1.074800
Epoch 50, Train Loss 0.860749, Valid_loss 1.060187
Epoch 51, Train Loss 0.863670, Valid_loss 1.061500
Epoch 52, Train Loss 0.858524, Valid_loss 1.066803
[I 2025-08-31 07:31:54,950] Trial 2 finished with value: 1.0489648779233296 and parameters: {'learning_rate': 0.01, 'epochs': 100, 'heads': 4, 'dropout': 0.7, 'weight_decay': 0.01, 'emb_dim': 8, 'augment_num': 100, 'pca': False}. Best is trial 1 with value: 1.0354726967357455.
선택된 trial params: {'learning_rate': 0.01, 'epochs': 100, 'heads': 2, 'dropout': 0.0, 'weight_decay': 0.001, 'emb_dim': 32, 'augment_num': 100, 'pca': False}
👉 train samples(학습 샘플(bag))=141, batch_size=16 -> steps(샘플수/batch크기)=9
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=15, batch_size=1 -> steps=15
Memory Allocated: 10710.26 MB
Memory Reserved: 10722.00 MB
cuda
CUDA OOM 발생 — 단계적 백오프 시작.
[OOM RETRY] batch_size 16 → 8 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=141, batch_size=8 -> steps(샘플수/batch크기)=18
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=15, batch_size=1 -> steps=15
Memory Allocated: 12812.20 MB
Memory Reserved: 12824.00 MB
cuda
[OOM RETRY] batch_size=8에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 16 → 4 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=141, batch_size=4 -> steps(샘플수/batch크기)=36
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=15, batch_size=1 -> steps=15
Memory Allocated: 17902.84 MB
Memory Reserved: 17916.00 MB
cuda
[OOM RETRY] batch_size=4에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 16 → 2 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=141, batch_size=2 -> steps(샘플수/batch크기)=71
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=15, batch_size=1 -> steps=15
Memory Allocated: 15360.82 MB
Memory Reserved: 15396.00 MB
cuda
Epoch 1, Train Loss 0.946844, Valid_loss 1.150406
Epoch 2, Train Loss 0.921069, Valid_loss 1.126199
Epoch 3, Train Loss 0.879705, Valid_loss 1.161603
Epoch 4, Train Loss 0.885639, Valid_loss 1.056877
Epoch 5, Train Loss 0.882356, Valid_loss 1.086719
Epoch 6, Train Loss 0.882597, Valid_loss 1.080409
Epoch 7, Train Loss 0.869001, Valid_loss 1.078597
Epoch 8, Train Loss 0.871776, Valid_loss 1.092741
Epoch 9, Train Loss 0.860155, Valid_loss 1.126335
Epoch 10, Train Loss 0.855471, Valid_loss 1.345108
Epoch 11, Train Loss 0.844105, Valid_loss 1.243579
Epoch 12, Train Loss 0.884486, Valid_loss 1.106479
Epoch 13, Train Loss 0.861452, Valid_loss 1.190478
Epoch 14, Train Loss 0.859749, Valid_loss 1.360011
Epoch 15, Train Loss 0.856053, Valid_loss 1.414892
Epoch 16, Train Loss 0.853023, Valid_loss 1.381720
Epoch 17, Train Loss 0.846297, Valid_loss 1.384233
Epoch 18, Train Loss 0.867963, Valid_loss 1.252637
Epoch 19, Train Loss 0.832644, Valid_loss 1.223259
Epoch 20, Train Loss 0.830775, Valid_loss 1.576290
Epoch 21, Train Loss 0.879310, Valid_loss 1.128321
Epoch 22, Train Loss 0.834544, Valid_loss 1.423886
Epoch 23, Train Loss 0.836949, Valid_loss 1.461871
Epoch 24, Train Loss 0.843518, Valid_loss 1.330148
Epoch 25, Train Loss 0.845451, Valid_loss 1.501656
Epoch 26, Train Loss 0.835891, Valid_loss 1.567791
Epoch 27, Train Loss 0.861472, Valid_loss 1.369856
Epoch 28, Train Loss 0.899633, Valid_loss 1.107148
Epoch 29, Train Loss 0.863125, Valid_loss 1.040357
Epoch 30, Train Loss 0.871208, Valid_loss 1.053489
Epoch 31, Train Loss 0.866107, Valid_loss 1.047774
Epoch 32, Train Loss 0.872557, Valid_loss 1.197434
Epoch 33, Train Loss 0.839621, Valid_loss 1.282736
Epoch 34, Train Loss 0.833793, Valid_loss 1.588845
Epoch 35, Train Loss 0.895424, Valid_loss 1.088887
Epoch 36, Train Loss 0.875522, Valid_loss 1.241703
Epoch 37, Train Loss 0.867401, Valid_loss 1.047703
Epoch 38, Train Loss 0.862594, Valid_loss 1.088932
Epoch 39, Train Loss 0.853003, Valid_loss 1.155036
Epoch 40, Train Loss 0.861761, Valid_loss 1.145908
Epoch 41, Train Loss 0.860254, Valid_loss 1.094942
Epoch 42, Train Loss 0.858001, Valid_loss 1.125870
Epoch 43, Train Loss 0.851246, Valid_loss 1.152046
Epoch 44, Train Loss 0.857726, Valid_loss 1.122223
Epoch 45, Train Loss 0.848404, Valid_loss 1.180817
Epoch 46, Train Loss 0.847556, Valid_loss 1.179699
Epoch 47, Train Loss 0.838800, Valid_loss 1.140189
Epoch 48, Train Loss 0.880566, Valid_loss 1.044449
Epoch 49, Train Loss 0.870971, Valid_loss 1.053595
Epoch 50, Train Loss 0.863276, Valid_loss 1.054143
Epoch 51, Train Loss 0.863105, Valid_loss 1.058047
Epoch 52, Train Loss 0.858922, Valid_loss 1.063041
환자ID=164-6 -- true: [[0]] -- pred: tensor([[ 0.0426,  0.3472, -1.3543]], device='cuda:0')
환자ID=27-10053 -- true: [[1]] -- pred: tensor([[ 0.0426,  0.3472, -1.3543]], device='cuda:0')
환자ID=27-10071 -- true: [[1]] -- pred: tensor([[ 0.0426,  0.3472, -1.3543]], device='cuda:0')
환자ID=28-11515 -- true: [[1]] -- pred: tensor([[ 0.0426,  0.3472, -1.3543]], device='cuda:0')
환자ID=28-12490 -- true: [[1]] -- pred: tensor([[ 0.0426,  0.3472, -1.3543]], device='cuda:0')
환자ID=29-10012 -- true: [[1]] -- pred: tensor([[ 0.0426,  0.3472, -1.3543]], device='cuda:0')
환자ID=29-10404 -- true: [[1]] -- pred: tensor([[ 0.0426,  0.3472, -1.3543]], device='cuda:0')
환자ID=31-10013 -- true: [[1]] -- pred: tensor([[ 0.0426,  0.3472, -1.3543]], device='cuda:0')
환자ID=32-10034 -- true: [[2]] -- pred: tensor([[ 0.0426,  0.3472, -1.3543]], device='cuda:0')
환자ID=33-10005 -- true: [[2]] -- pred: tensor([[ 0.0426,  0.3472, -1.3543]], device='cuda:0')
환자ID=33-10006 -- true: [[2]] -- pred: tensor([[ 0.0426,  0.3472, -1.3543]], device='cuda:0')
환자ID=PRE98sc -- true: [[0]] -- pred: tensor([[ 0.0426,  0.3472, -1.3543]], device='cuda:0')
환자ID=Sample1158-EO1 -- true: [[0]] -- pred: tensor([[ 0.0426,  0.3472, -1.3543]], device='cuda:0')
환자ID=Sample1158-EO3 -- true: [[0]] -- pred: tensor([[ 0.0426,  0.3472, -1.3543]], device='cuda:0')
환자ID=Sample1162-EO1 -- true: [[0]] -- pred: tensor([[ 0.0426,  0.3472, -1.3543]], device='cuda:0')
Best performance: Epoch 29, Loss 0.863125, Test ACC 0.466667, Test AUC 0.633333, Test Recall 0.333333, Test Precision 0.155556
Confusion Matrix:
 [[0 5 0]
 [0 7 0]
 [0 3 0]]
✅ Total valid splits used: 3
🔁 Repeat 2, Fold 3
cell type :  S2008000605HRT_AAACCCAGTGCACATT-1     Epithelial_cells
S2008000605HRT_AAACCCAGTGCCTACG-1     Epithelial_cells
S2008000605HRT_AAAGAACGTAGAGACC-1            Astrocyte
S2008000605HRT_AAAGAACGTCGGAACA-1     Epithelial_cells
S2008000605HRT_AAAGAACGTTAACAGA-1     Epithelial_cells
                                           ...        
Sample1162EO2_TTTGGAGAGCAGGCAT-1      Epithelial_cells
Sample1162EO2_TTTGGAGAGTCGCGAA-1     Endothelial_cells
Sample1162EO2_TTTGGAGAGTGCTCGC-1           Hepatocytes
Sample1162EO2_TTTGGAGGTGATACTC-1      Epithelial_cells
Sample1162EO2_TTTGGTTCAGTAGAAT-1      Epithelial_cells
Name: singler_annotation, Length: 180382, dtype: string
cell type annotation :  S2008000605HRT_AAACCCAGTGCACATT-1     Epithelial_cells
S2008000605HRT_AAACCCAGTGCCTACG-1     Epithelial_cells
S2008000605HRT_AAAGAACGTAGAGACC-1            Astrocyte
S2008000605HRT_AAAGAACGTCGGAACA-1     Epithelial_cells
S2008000605HRT_AAAGAACGTTAACAGA-1     Epithelial_cells
                                           ...        
Sample1162EO2_TTTGGAGAGCAGGCAT-1      Epithelial_cells
Sample1162EO2_TTTGGAGAGTCGCGAA-1     Endothelial_cells
Sample1162EO2_TTTGGAGAGTGCTCGC-1           Hepatocytes
Sample1162EO2_TTTGGAGGTGATACTC-1      Epithelial_cells
Sample1162EO2_TTTGGTTCAGTAGAAT-1      Epithelial_cells
Name: singler_annotation, Length: 180382, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Epithelial_cells', 'Astrocyte', 'MSC', 'Keratinocytes', 'Neurons', 'Endothelial_cells', 'Fibroblasts', 'Tissue_stem_cells', 'Smooth_muscle_cells', 'T_cells', 'Neuroepithelial_cell', 'NK_cell', 'Chondrocytes', 'Osteoblasts', 'Monocyte', 'Hepatocytes', 'Macrophage', 'CMP', 'Embryonic_stem_cells', 'DC', 'BM & Prog.', 'MEP', 'Neutrophils', 'Pro-Myelocyte', 'iPS_cells', 'Pre-B_cell_CD34-', 'HSC_-G-CSF', 'B_cell', 'GMP', 'HSC_CD34+', 'Platelets', 'Pro-B_cell_CD34+', 'Myelocyte', 'BM', 'Unknown', 'Erythroblast', 'Gametocytes']
라벨별 그룹 개수 {0: 21, 1: 30, 2: 11}
cell type :  S2008006722HRT_AAACGCTTCGGCTCTT-1       Tissue_stem_cells
S2008006722HRT_AAAGAACGTACTCCCT-1       Endothelial_cells
S2008006722HRT_AAAGAACGTATGTCAC-1               Astrocyte
S2008006722HRT_AAAGGATTCATCGCCT-1    Embryonic_stem_cells
S2008006722HRT_AAAGGGCTCGTCGCTT-1        Epithelial_cells
                                             ...         
Sample1157EO3_TTTGATCGTGGTCCCA-1         Epithelial_cells
Sample1157EO3_TTTGGAGGTAGTCGTT-1         Epithelial_cells
Sample1157EO3_TTTGGTTAGTTTGCTG-1         Epithelial_cells
Sample1157EO3_TTTGGTTTCACACCGG-1                  T_cells
Sample1157EO3_TTTGTTGGTTCATCTT-1         Epithelial_cells
Name: singler_annotation, Length: 44795, dtype: string
cell type annotation :  S2008006722HRT_AAACGCTTCGGCTCTT-1       Tissue_stem_cells
S2008006722HRT_AAAGAACGTACTCCCT-1       Endothelial_cells
S2008006722HRT_AAAGAACGTATGTCAC-1               Astrocyte
S2008006722HRT_AAAGGATTCATCGCCT-1    Embryonic_stem_cells
S2008006722HRT_AAAGGGCTCGTCGCTT-1        Epithelial_cells
                                             ...         
Sample1157EO3_TTTGATCGTGGTCCCA-1         Epithelial_cells
Sample1157EO3_TTTGGAGGTAGTCGTT-1         Epithelial_cells
Sample1157EO3_TTTGGTTAGTTTGCTG-1         Epithelial_cells
Sample1157EO3_TTTGGTTTCACACCGG-1                  T_cells
Sample1157EO3_TTTGTTGGTTCATCTT-1         Epithelial_cells
Name: singler_annotation, Length: 44795, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Tissue_stem_cells', 'Endothelial_cells', 'Astrocyte', 'Embryonic_stem_cells', 'Epithelial_cells', 'Hepatocytes', 'Smooth_muscle_cells', 'Neurons', 'Fibroblasts', 'NK_cell', 'Keratinocytes', 'Neuroepithelial_cell', 'MEP', 'Pre-B_cell_CD34-', 'Monocyte', 'Pro-Myelocyte', 'MSC', 'CMP', 'BM & Prog.', 'BM', 'Macrophage', 'Chondrocytes', 'iPS_cells', 'T_cells', 'HSC_-G-CSF', 'Erythroblast', 'Osteoblasts', 'DC', 'GMP', 'Pro-B_cell_CD34+', 'Neutrophils', 'B_cell', 'HSC_CD34+', 'Myelocyte', 'Platelets', 'Unknown', 'Gametocytes']
라벨별 그룹 개수 {0: 5, 1: 7, 2: 3}
🔍 Split #4
  → train_p_index 환자 수 (환자 단위로 묶인 index list): 62
  → test_p_index 환자 수  (환자 단위로 묶인 index list): 15
  → train 환자 ID: ['163-2', '163-3', '163-4', '164-10', '164-6', '165-9', '27-10041', '27-10053', '27-10071', '27-10112', '27-10119', '28-10051', '28-11515', '28-12263', '28-12490', '28-12518', '29-10006', '29-10008', '29-10012', '29-10013', '29-10016', '29-10280', '29-10380', '29-10386', '29-10398', '29-10400', '29-10404', '29-10406', '29-10410', '30-10018', '30-10034', '30-10123', '30-10125', '30-11051', '31-10000', '31-10001', '31-10013', '31-10035', '31-10042', '31-10078', '31-10154', '32-10034', '32-10074', '33-10005', '33-10006', '34-10050', '34-10184', 'PRE018-1', 'PRE019', 'PRE038', 'PRE055-1', 'PRE98sc', 'Sample1153-EO1', 'Sample1153-EO2', 'Sample1153-EO3', 'Sample1157-EO1', 'Sample1157-EO2', 'Sample1158-EO1', 'Sample1158-EO2', 'Sample1158-EO3', 'Sample1162-EO1', 'Sample1162-EO2']
  → test  환자 ID: ['163-5', '164-3', '27-10039', '28-12381', '29-10010', '29-10011', '30-10929', '31-10040', '31-10210', '31-10236', '32-10003', '34-10187', 'PRE027', 'PRE062-1', 'Sample1157-EO3']
  → train 환자 ID 및 라벨:
    ID: 163-2, Label: 0
    ID: 163-3, Label: 0
    ID: 163-4, Label: 0
    ID: 164-10, Label: 0
    ID: 164-6, Label: 0
    ID: 165-9, Label: 0
    ID: 27-10041, Label: 1
    ID: 27-10053, Label: 1
    ID: 27-10071, Label: 1
    ID: 27-10112, Label: 1
    ID: 27-10119, Label: 1
    ID: 28-10051, Label: 1
    ID: 28-11515, Label: 1
    ID: 28-12263, Label: 1
    ID: 28-12490, Label: 1
    ID: 28-12518, Label: 1
    ID: 29-10006, Label: 1
    ID: 29-10008, Label: 1
    ID: 29-10012, Label: 1
    ID: 29-10013, Label: 1
    ID: 29-10016, Label: 1
    ID: 29-10280, Label: 1
    ID: 29-10380, Label: 1
    ID: 29-10386, Label: 1
    ID: 29-10398, Label: 1
    ID: 29-10400, Label: 1
    ID: 29-10404, Label: 1
    ID: 29-10406, Label: 1
    ID: 29-10410, Label: 1
    ID: 30-10018, Label: 2
    ID: 30-10034, Label: 2
    ID: 30-10123, Label: 2
    ID: 30-10125, Label: 2
    ID: 30-11051, Label: 2
    ID: 31-10000, Label: 1
    ID: 31-10001, Label: 1
    ID: 31-10013, Label: 1
    ID: 31-10035, Label: 1
    ID: 31-10042, Label: 1
    ID: 31-10078, Label: 1
    ID: 31-10154, Label: 1
    ID: 32-10034, Label: 2
    ID: 32-10074, Label: 2
    ID: 33-10005, Label: 2
    ID: 33-10006, Label: 2
    ID: 34-10050, Label: 2
    ID: 34-10184, Label: 2
    ID: PRE018-1, Label: 0
    ID: PRE019, Label: 0
    ID: PRE038, Label: 0
    ID: PRE055-1, Label: 0
    ID: PRE98sc, Label: 0
    ID: Sample1153-EO1, Label: 0
    ID: Sample1153-EO2, Label: 0
    ID: Sample1153-EO3, Label: 0
    ID: Sample1157-EO1, Label: 0
    ID: Sample1157-EO2, Label: 0
    ID: Sample1158-EO1, Label: 0
    ID: Sample1158-EO2, Label: 0
    ID: Sample1158-EO3, Label: 0
    ID: Sample1162-EO1, Label: 0
    ID: Sample1162-EO2, Label: 0
  → test 환자 ID 및 라벨:
    ID: 163-5, Label: 0
    ID: 164-3, Label: 0
    ID: 27-10039, Label: 1
    ID: 28-12381, Label: 1
    ID: 29-10010, Label: 1
    ID: 29-10011, Label: 1
    ID: 30-10929, Label: 2
    ID: 31-10040, Label: 1
    ID: 31-10210, Label: 1
    ID: 31-10236, Label: 1
    ID: 32-10003, Label: 2
    ID: 34-10187, Label: 2
    ID: PRE027, Label: 0
    ID: PRE062-1, Label: 0
    ID: Sample1157-EO3, Label: 0
전체 데이터 index 길이 77
label_stat (train 환자 라벨 목록) 갯수 62
train_data에서 환자 단위로, train과 validation 나누기
기존 train_p_index 62
기존 (train) label_stat 62
train-vali 분할 후! 
train y 의 classes : {0, 1, 2} valid y 의 classes : {0, 1, 2} label_stat 의 classes : {0, 1, 2}
train_p_index_ 41
valid_p_index 21
test_p_index 15
→ train 환자 ID 및 라벨:
   총 개수: 41
   환자ID=29-10280, Label=1, 셀개수=2375
   환자ID=31-10042, Label=1, 셀개수=1222
   환자ID=34-10184, Label=2, 셀개수=2699
   환자ID=32-10034, Label=2, 셀개수=1555
   환자ID=Sample1158-EO2, Label=0, 셀개수=1427
   환자ID=164-10, Label=0, 셀개수=4041
   환자ID=29-10008, Label=1, 셀개수=1913
   환자ID=PRE055-1, Label=0, 셀개수=597
   환자ID=30-11051, Label=2, 셀개수=2454
   환자ID=30-10123, Label=2, 셀개수=1273
   환자ID=163-3, Label=0, 셀개수=1335
   환자ID=28-10051, Label=1, 셀개수=300
   환자ID=27-10041, Label=1, 셀개수=2145
   환자ID=27-10053, Label=1, 셀개수=728
   환자ID=163-2, Label=0, 셀개수=2535
   환자ID=29-10410, Label=1, 셀개수=2834
   환자ID=31-10001, Label=1, 셀개수=1133
   환자ID=30-10034, Label=2, 셀개수=1240
   환자ID=Sample1158-EO3, Label=0, 셀개수=1096
   환자ID=29-10386, Label=1, 셀개수=802
   환자ID=31-10000, Label=1, 셀개수=8870
   환자ID=163-4, Label=0, 셀개수=1339
   환자ID=31-10154, Label=1, 셀개수=6568
   환자ID=Sample1153-EO1, Label=0, 셀개수=911
   환자ID=29-10404, Label=1, 셀개수=3988
   환자ID=28-12263, Label=1, 셀개수=7527
   환자ID=Sample1162-EO1, Label=0, 셀개수=1053
   환자ID=31-10013, Label=1, 셀개수=3161
   환자ID=PRE018-1, Label=0, 셀개수=1349
   환자ID=27-10119, Label=1, 셀개수=3346
   환자ID=29-10006, Label=1, 셀개수=11461
   환자ID=28-11515, Label=1, 셀개수=930
   환자ID=165-9, Label=0, 셀개수=2926
   환자ID=29-10400, Label=1, 셀개수=2684
   환자ID=34-10050, Label=2, 셀개수=4784
   환자ID=29-10380, Label=1, 셀개수=4799
   환자ID=33-10005, Label=2, 셀개수=8904
   환자ID=32-10074, Label=2, 셀개수=6304
   환자ID=31-10078, Label=1, 셀개수=2827
   환자ID=29-10016, Label=1, 셀개수=4854
   환자ID=28-12518, Label=1, 셀개수=1215
→ valid 환자 ID 및 라벨:
   총 개수: 21
   환자ID=Sample1162-EO2, Label=0, 셀개수=1510
   환자ID=29-10013, Label=1, 셀개수=3706
   환자ID=31-10035, Label=1, 셀개수=2974
   환자ID=Sample1153-EO2, Label=0, 셀개수=916
   환자ID=33-10006, Label=2, 셀개수=457
   환자ID=PRE98sc, Label=0, 셀개수=1568
   환자ID=Sample1157-EO2, Label=0, 셀개수=1395
   환자ID=30-10018, Label=2, 셀개수=5170
   환자ID=30-10125, Label=2, 셀개수=3798
   환자ID=29-10406, Label=1, 셀개수=3484
   환자ID=Sample1158-EO1, Label=0, 셀개수=574
   환자ID=27-10112, Label=1, 셀개수=1470
   환자ID=29-10398, Label=1, 셀개수=3993
   환자ID=Sample1153-EO3, Label=0, 셀개수=1516
   환자ID=PRE038, Label=0, 셀개수=2666
   환자ID=PRE019, Label=0, 셀개수=3795
   환자ID=164-6, Label=0, 셀개수=3038
   환자ID=29-10012, Label=1, 셀개수=6245
   환자ID=27-10071, Label=1, 셀개수=1478
   환자ID=28-12490, Label=1, 셀개수=5973
   환자ID=Sample1157-EO1, Label=0, 셀개수=1152
→ test 환자 ID 및 라벨:
   총 개수: 15
   환자ID=163-5, Label=0, 셀개수=1210
   환자ID=164-3, Label=0, 셀개수=1639
   환자ID=27-10039, Label=1, 셀개수=4638
   환자ID=28-12381, Label=1, 셀개수=1099
   환자ID=29-10010, Label=1, 셀개수=5305
   환자ID=29-10011, Label=1, 셀개수=3072
   환자ID=30-10929, Label=2, 셀개수=5812
   환자ID=31-10040, Label=1, 셀개수=4543
   환자ID=31-10210, Label=1, 셀개수=3510
   환자ID=31-10236, Label=1, 셀개수=3458
   환자ID=32-10003, Label=2, 셀개수=2978
   환자ID=34-10187, Label=2, 셀개수=3739
   환자ID=PRE027, Label=0, 셀개수=2078
   환자ID=PRE062-1, Label=0, 셀개수=907
   환자ID=Sample1157-EO3, Label=0, 셀개수=807
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Epithelial_cells', 'Epithelial_cells', 'Astrocyte', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'MSC', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
전체 데이터 길이 225177
전체 cell type 길이 0         Epithelial_cells
1         Epithelial_cells
2                Astrocyte
3         Epithelial_cells
4         Epithelial_cells
                ...       
225172    Epithelial_cells
225173    Epithelial_cells
225174    Epithelial_cells
225175             T_cells
225176    Epithelial_cells
Length: 225177, dtype: string
cell type의 NaN 개수 체크 0
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:10,  9.35it/s]  2%|▏         | 2/100 [00:00<00:10,  9.35it/s]  3%|▎         | 3/100 [00:00<00:10,  9.44it/s]  4%|▍         | 4/100 [00:00<00:10,  9.55it/s]  5%|▌         | 5/100 [00:00<00:13,  7.26it/s]  7%|▋         | 7/100 [00:00<00:11,  8.33it/s]  8%|▊         | 8/100 [00:01<00:12,  7.40it/s]  9%|▉         | 9/100 [00:01<00:11,  7.80it/s] 10%|█         | 10/100 [00:01<00:10,  8.28it/s] 11%|█         | 11/100 [00:01<00:10,  8.42it/s] 12%|█▏        | 12/100 [00:01<00:10,  8.65it/s] 13%|█▎        | 13/100 [00:01<00:09,  8.84it/s] 14%|█▍        | 14/100 [00:01<00:09,  9.03it/s] 15%|█▌        | 15/100 [00:01<00:09,  8.57it/s] 16%|█▌        | 16/100 [00:01<00:09,  8.67it/s] 17%|█▋        | 17/100 [00:01<00:09,  8.95it/s] 18%|█▊        | 18/100 [00:02<00:09,  8.76it/s] 19%|█▉        | 19/100 [00:02<00:09,  8.84it/s] 20%|██        | 20/100 [00:02<00:09,  8.82it/s] 21%|██        | 21/100 [00:02<00:08,  9.04it/s] 22%|██▏       | 22/100 [00:02<00:08,  9.22it/s] 23%|██▎       | 23/100 [00:02<00:08,  9.30it/s] 24%|██▍       | 24/100 [00:02<00:08,  9.41it/s] 25%|██▌       | 25/100 [00:02<00:08,  9.18it/s] 26%|██▌       | 26/100 [00:02<00:08,  9.23it/s] 27%|██▋       | 27/100 [00:03<00:08,  9.04it/s] 28%|██▊       | 28/100 [00:03<00:07,  9.26it/s] 29%|██▉       | 29/100 [00:03<00:07,  9.12it/s] 30%|███       | 30/100 [00:03<00:07,  8.88it/s] 31%|███       | 31/100 [00:03<00:07,  8.63it/s] 32%|███▏      | 32/100 [00:03<00:07,  8.80it/s] 33%|███▎      | 33/100 [00:03<00:07,  8.48it/s] 34%|███▍      | 34/100 [00:03<00:07,  8.56it/s] 35%|███▌      | 35/100 [00:04<00:07,  8.49it/s] 36%|███▌      | 36/100 [00:04<00:07,  8.66it/s] 37%|███▋      | 37/100 [00:04<00:07,  8.71it/s] 38%|███▊      | 38/100 [00:04<00:07,  8.61it/s] 39%|███▉      | 39/100 [00:04<00:06,  8.88it/s] 40%|████      | 40/100 [00:04<00:07,  8.03it/s] 41%|████      | 41/100 [00:04<00:07,  8.23it/s] 42%|████▏     | 42/100 [00:04<00:07,  8.29it/s] 43%|████▎     | 43/100 [00:04<00:06,  8.33it/s] 44%|████▍     | 44/100 [00:05<00:06,  8.47it/s] 45%|████▌     | 45/100 [00:05<00:06,  8.52it/s] 46%|████▌     | 46/100 [00:05<00:06,  8.45it/s] 47%|████▋     | 47/100 [00:05<00:06,  8.47it/s] 48%|████▊     | 48/100 [00:05<00:06,  8.37it/s] 49%|████▉     | 49/100 [00:05<00:05,  8.54it/s] 50%|█████     | 50/100 [00:05<00:05,  8.74it/s] 51%|█████     | 51/100 [00:05<00:05,  8.68it/s] 52%|█████▏    | 52/100 [00:06<00:05,  8.71it/s] 53%|█████▎    | 53/100 [00:06<00:05,  8.62it/s] 54%|█████▍    | 54/100 [00:06<00:05,  8.59it/s] 55%|█████▌    | 55/100 [00:06<00:05,  8.43it/s] 56%|█████▌    | 56/100 [00:06<00:05,  8.30it/s] 57%|█████▋    | 57/100 [00:06<00:05,  8.38it/s] 58%|█████▊    | 58/100 [00:06<00:04,  8.72it/s] 59%|█████▉    | 59/100 [00:06<00:04,  8.66it/s] 60%|██████    | 60/100 [00:06<00:04,  8.62it/s] 61%|██████    | 61/100 [00:07<00:05,  7.23it/s] 62%|██████▏   | 62/100 [00:07<00:04,  7.64it/s] 63%|██████▎   | 63/100 [00:07<00:04,  8.02it/s] 64%|██████▍   | 64/100 [00:07<00:04,  7.96it/s] 65%|██████▌   | 65/100 [00:07<00:04,  7.99it/s] 66%|██████▌   | 66/100 [00:07<00:04,  8.27it/s] 67%|██████▋   | 67/100 [00:07<00:04,  8.04it/s] 68%|██████▊   | 68/100 [00:07<00:03,  8.13it/s] 69%|██████▉   | 69/100 [00:08<00:04,  7.18it/s] 70%|███████   | 70/100 [00:08<00:04,  7.47it/s] 71%|███████   | 71/100 [00:08<00:03,  7.92it/s] 72%|███████▏  | 72/100 [00:08<00:03,  7.84it/s] 73%|███████▎  | 73/100 [00:08<00:03,  7.91it/s] 74%|███████▍  | 74/100 [00:08<00:03,  8.23it/s] 75%|███████▌  | 75/100 [00:08<00:03,  8.22it/s] 76%|███████▌  | 76/100 [00:09<00:02,  8.09it/s] 77%|███████▋  | 77/100 [00:09<00:02,  8.00it/s] 78%|███████▊  | 78/100 [00:09<00:02,  8.21it/s] 79%|███████▉  | 79/100 [00:09<00:02,  8.42it/s] 80%|████████  | 80/100 [00:09<00:02,  8.34it/s] 81%|████████  | 81/100 [00:09<00:02,  8.26it/s] 82%|████████▏ | 82/100 [00:09<00:02,  8.22it/s] 83%|████████▎ | 83/100 [00:09<00:02,  8.22it/s] 84%|████████▍ | 84/100 [00:09<00:01,  8.10it/s] 85%|████████▌ | 85/100 [00:10<00:01,  8.40it/s] 86%|████████▌ | 86/100 [00:10<00:01,  8.31it/s] 87%|████████▋ | 87/100 [00:10<00:01,  8.33it/s] 88%|████████▊ | 88/100 [00:10<00:01,  7.96it/s] 89%|████████▉ | 89/100 [00:10<00:01,  8.07it/s] 90%|█████████ | 90/100 [00:10<00:01,  8.11it/s] 91%|█████████ | 91/100 [00:10<00:01,  8.01it/s] 92%|█████████▏| 92/100 [00:11<00:01,  6.57it/s] 93%|█████████▎| 93/100 [00:11<00:00,  7.09it/s] 94%|█████████▍| 94/100 [00:11<00:00,  7.52it/s] 95%|█████████▌| 95/100 [00:11<00:00,  7.70it/s] 96%|█████████▌| 96/100 [00:11<00:00,  7.75it/s] 97%|█████████▋| 97/100 [00:11<00:00,  7.69it/s] 98%|█████████▊| 98/100 [00:11<00:00,  7.16it/s] 99%|█████████▉| 99/100 [00:11<00:00,  7.34it/s]100%|██████████| 100/100 [00:12<00:00,  7.63it/s]100%|██████████| 100/100 [00:12<00:00,  8.28it/s]
[I 2025-08-31 07:40:29,187] A new study created in memory with name: no-name-2c78507d-f0eb-48e0-b02c-844c98daca8d
👉 train samples(학습 샘플(bag))=141, batch_size=16 -> steps(샘플수/batch크기)=9
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 27.97 MB
Memory Reserved: 36.00 MB
cuda
Epoch 1, Train Loss 0.940789, Valid_loss 1.116468
Epoch 2, Train Loss 0.873926, Valid_loss 1.232996
Epoch 3, Train Loss 0.901894, Valid_loss 1.103844
Epoch 4, Train Loss 0.867497, Valid_loss 1.147878
Epoch 5, Train Loss 0.848903, Valid_loss 1.178365
Epoch 6, Train Loss 0.875711, Valid_loss 1.154897
Epoch 7, Train Loss 0.867393, Valid_loss 1.104358
Epoch 8, Train Loss 0.850308, Valid_loss 1.155498
Epoch 9, Train Loss 0.830603, Valid_loss 1.229621
Epoch 10, Train Loss 0.879820, Valid_loss 1.200890
Epoch 11, Train Loss 0.847689, Valid_loss 1.068121
Epoch 12, Train Loss 0.765340, Valid_loss 0.765443
Epoch 13, Train Loss 0.760379, Valid_loss 0.928643
Epoch 14, Train Loss 0.696932, Valid_loss 0.636746
Epoch 15, Train Loss 0.704560, Valid_loss 1.431793
Epoch 16, Train Loss 0.862992, Valid_loss 0.705044
Epoch 17, Train Loss 0.731380, Valid_loss 0.563058
Epoch 18, Train Loss 0.940222, Valid_loss 1.336009
Epoch 19, Train Loss 0.881107, Valid_loss 0.897377
Epoch 20, Train Loss 0.720159, Valid_loss 0.702136
Epoch 21, Train Loss 0.706427, Valid_loss 1.272853
Epoch 22, Train Loss 0.711718, Valid_loss 0.938955
Epoch 23, Train Loss 0.619746, Valid_loss 0.525083
Epoch 24, Train Loss 0.561954, Valid_loss 0.498925
Epoch 25, Train Loss 0.653243, Valid_loss 0.528218
Epoch 26, Train Loss 0.778825, Valid_loss 1.085214
Epoch 27, Train Loss 0.669315, Valid_loss 0.830955
Epoch 28, Train Loss 0.622204, Valid_loss 0.674175
Epoch 29, Train Loss 0.579888, Valid_loss 0.526737
Epoch 30, Train Loss 0.539999, Valid_loss 0.468422
Epoch 31, Train Loss 0.567607, Valid_loss 0.462501
Epoch 32, Train Loss 0.564729, Valid_loss 0.537075
Epoch 33, Train Loss 0.552276, Valid_loss 0.616848
Epoch 34, Train Loss 0.528944, Valid_loss 0.612512
Epoch 35, Train Loss 0.505235, Valid_loss 0.503841
Epoch 36, Train Loss 0.542237, Valid_loss 0.942305
Epoch 37, Train Loss 0.622428, Valid_loss 0.717989
Epoch 38, Train Loss 0.616091, Valid_loss 0.640622
Epoch 39, Train Loss 0.488445, Valid_loss 0.445828
Epoch 40, Train Loss 0.414525, Valid_loss 0.406443
Epoch 41, Train Loss 0.426239, Valid_loss 0.417130
Epoch 42, Train Loss 0.497075, Valid_loss 0.888713
Epoch 43, Train Loss 0.605710, Valid_loss 0.782473
Epoch 44, Train Loss 0.574762, Valid_loss 0.443705
Epoch 45, Train Loss 0.551959, Valid_loss 0.430701
Epoch 46, Train Loss 0.533036, Valid_loss 0.779684
Epoch 47, Train Loss 0.624558, Valid_loss 0.512978
Epoch 48, Train Loss 0.460136, Valid_loss 0.443862
Epoch 49, Train Loss 0.481777, Valid_loss 0.408990
Epoch 50, Train Loss 0.429808, Valid_loss 0.542874
Epoch 51, Train Loss 0.495970, Valid_loss 0.433135
Epoch 52, Train Loss 0.420600, Valid_loss 0.481311
Epoch 53, Train Loss 0.391385, Valid_loss 0.510105
[I 2025-08-31 07:48:56,732] Trial 0 finished with value: 0.40644314973836854 and parameters: {'learning_rate': 0.01, 'epochs': 100, 'heads': 1, 'dropout': 0.3, 'weight_decay': 0.01, 'emb_dim': 64, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.40644314973836854.
👉 train samples(학습 샘플(bag))=141, batch_size=16 -> steps(샘플수/batch크기)=9
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 26.13 MB
Memory Reserved: 36.00 MB
cuda
Epoch 1, Train Loss 1.179425, Valid_loss 1.068196
Epoch 2, Train Loss 1.084608, Valid_loss 1.045944
Epoch 3, Train Loss 1.015279, Valid_loss 1.006812
Epoch 4, Train Loss 1.000032, Valid_loss 1.026510
Epoch 5, Train Loss 0.938700, Valid_loss 1.004868
Epoch 6, Train Loss 0.938677, Valid_loss 0.967546
Epoch 7, Train Loss 0.884766, Valid_loss 0.932877
Epoch 8, Train Loss 0.865078, Valid_loss 0.902678
Epoch 9, Train Loss 0.848535, Valid_loss 0.922241
Epoch 10, Train Loss 0.806349, Valid_loss 0.833167
Epoch 11, Train Loss 0.783441, Valid_loss 0.826715
Epoch 12, Train Loss 0.711401, Valid_loss 0.749661
Epoch 13, Train Loss 0.776147, Valid_loss 0.736503
Epoch 14, Train Loss 0.753195, Valid_loss 0.687637
Epoch 15, Train Loss 0.683450, Valid_loss 0.693457
Epoch 16, Train Loss 0.652296, Valid_loss 0.622150
Epoch 17, Train Loss 0.672167, Valid_loss 0.649282
Epoch 18, Train Loss 0.681918, Valid_loss 0.717643
Epoch 19, Train Loss 0.694374, Valid_loss 0.582793
Epoch 20, Train Loss 0.653752, Valid_loss 0.673171
Epoch 21, Train Loss 0.656614, Valid_loss 0.637602
Epoch 22, Train Loss 0.657805, Valid_loss 0.645103
Epoch 23, Train Loss 0.594513, Valid_loss 0.600986
Epoch 24, Train Loss 0.619210, Valid_loss 0.608784
Epoch 25, Train Loss 0.623930, Valid_loss 0.562457
Epoch 26, Train Loss 0.603229, Valid_loss 0.644805
Epoch 27, Train Loss 0.612031, Valid_loss 0.560952
Epoch 28, Train Loss 0.610815, Valid_loss 0.560919
Epoch 29, Train Loss 0.618099, Valid_loss 0.581293
Epoch 30, Train Loss 0.617439, Valid_loss 0.549455
Epoch 31, Train Loss 0.616570, Valid_loss 0.551363
Epoch 32, Train Loss 0.562638, Valid_loss 0.549054
Epoch 33, Train Loss 0.576469, Valid_loss 0.537278
Epoch 34, Train Loss 0.513963, Valid_loss 0.541319
Epoch 35, Train Loss 0.563095, Valid_loss 0.502661
Epoch 36, Train Loss 0.576309, Valid_loss 0.577451
Epoch 37, Train Loss 0.556863, Valid_loss 0.514004
Epoch 38, Train Loss 0.516591, Valid_loss 0.493682
Epoch 39, Train Loss 0.513232, Valid_loss 0.525325
Epoch 40, Train Loss 0.523721, Valid_loss 0.490696
Epoch 41, Train Loss 0.485277, Valid_loss 0.531226
Epoch 42, Train Loss 0.532483, Valid_loss 0.525247
Epoch 43, Train Loss 0.481159, Valid_loss 0.494453
Epoch 44, Train Loss 0.539789, Valid_loss 0.527470
Epoch 45, Train Loss 0.497667, Valid_loss 0.534095
Epoch 46, Train Loss 0.498836, Valid_loss 0.503484
Epoch 47, Train Loss 0.495699, Valid_loss 0.520172
Epoch 48, Train Loss 0.468489, Valid_loss 0.462555
Epoch 49, Train Loss 0.462357, Valid_loss 0.491302
Epoch 50, Train Loss 0.488515, Valid_loss 0.494130
Epoch 51, Train Loss 0.466596, Valid_loss 0.472505
Epoch 52, Train Loss 0.446541, Valid_loss 0.485269
Epoch 53, Train Loss 0.469588, Valid_loss 0.478603
Epoch 54, Train Loss 0.465862, Valid_loss 0.501769
Epoch 55, Train Loss 0.474951, Valid_loss 0.488444
Epoch 56, Train Loss 0.486015, Valid_loss 0.486363
Epoch 57, Train Loss 0.474341, Valid_loss 0.482057
Epoch 58, Train Loss 0.448176, Valid_loss 0.465487
Epoch 59, Train Loss 0.475476, Valid_loss 0.488757
Epoch 60, Train Loss 0.454454, Valid_loss 0.455452
Epoch 61, Train Loss 0.480816, Valid_loss 0.503049
Epoch 62, Train Loss 0.456751, Valid_loss 0.460019
Epoch 63, Train Loss 0.466054, Valid_loss 0.487607
Epoch 64, Train Loss 0.417652, Valid_loss 0.469651
Epoch 65, Train Loss 0.438341, Valid_loss 0.483622
Epoch 66, Train Loss 0.432447, Valid_loss 0.478008
Epoch 67, Train Loss 0.435643, Valid_loss 0.471174
Epoch 68, Train Loss 0.472149, Valid_loss 0.482019
Epoch 69, Train Loss 0.457962, Valid_loss 0.452226
Epoch 70, Train Loss 0.444655, Valid_loss 0.480729
Epoch 71, Train Loss 0.408546, Valid_loss 0.461674
Epoch 72, Train Loss 0.433919, Valid_loss 0.468218
Epoch 73, Train Loss 0.425281, Valid_loss 0.447462
Epoch 74, Train Loss 0.390804, Valid_loss 0.459514
Epoch 75, Train Loss 0.429156, Valid_loss 0.453731
Epoch 76, Train Loss 0.412179, Valid_loss 0.458142
Epoch 77, Train Loss 0.392802, Valid_loss 0.462958
[I 2025-08-31 08:01:15,928] Trial 1 finished with value: 0.4474622110525767 and parameters: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 1, 'dropout': 0.5, 'weight_decay': 0.001, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.40644314973836854.
👉 train samples(학습 샘플(bag))=141, batch_size=8 -> steps(샘플수/batch크기)=18
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 27.97 MB
Memory Reserved: 36.00 MB
cuda
CUDA OOM 발생 — 단계적 백오프 시작.
[OOM RETRY] batch_size 8 → 8 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=141, batch_size=8 -> steps(샘플수/batch크기)=18
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 1081.66 MB
Memory Reserved: 1086.00 MB
cuda
[OOM RETRY] batch_size=8에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 8 → 4 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=141, batch_size=4 -> steps(샘플수/batch크기)=36
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 2135.85 MB
Memory Reserved: 2138.00 MB
cuda
Epoch 1, Train Loss 0.955951, Valid_loss 1.154387
Epoch 2, Train Loss 0.864636, Valid_loss 1.136329
Epoch 3, Train Loss 0.858042, Valid_loss 0.967683
Epoch 4, Train Loss 0.721096, Valid_loss 0.630556
Epoch 5, Train Loss 0.580511, Valid_loss 0.500985
Epoch 6, Train Loss 0.575286, Valid_loss 0.565658
Epoch 7, Train Loss 0.658922, Valid_loss 0.691614
Epoch 8, Train Loss 0.547942, Valid_loss 0.439179
Epoch 9, Train Loss 0.516139, Valid_loss 0.443192
Epoch 10, Train Loss 0.512055, Valid_loss 0.418876
Epoch 11, Train Loss 0.468804, Valid_loss 0.368287
Epoch 12, Train Loss 0.409963, Valid_loss 0.364030
Epoch 13, Train Loss 0.467259, Valid_loss 0.407993
Epoch 14, Train Loss 0.460641, Valid_loss 0.345736
Epoch 15, Train Loss 0.404975, Valid_loss 0.311987
Epoch 16, Train Loss 0.415577, Valid_loss 0.436364
Epoch 17, Train Loss 0.341131, Valid_loss 0.301885
Epoch 18, Train Loss 0.286452, Valid_loss 0.299086
Epoch 19, Train Loss 0.377089, Valid_loss 0.291725
Epoch 20, Train Loss 0.357464, Valid_loss 0.559150
Epoch 21, Train Loss 0.356614, Valid_loss 0.399141
Epoch 22, Train Loss 0.495618, Valid_loss 0.607515
Epoch 23, Train Loss 0.318634, Valid_loss 0.330868
Epoch 24, Train Loss 0.496655, Valid_loss 0.387743
Epoch 25, Train Loss 0.296909, Valid_loss 0.330593
Epoch 26, Train Loss 0.302279, Valid_loss 0.256863
Epoch 27, Train Loss 0.347250, Valid_loss 0.261140
Epoch 28, Train Loss 0.279733, Valid_loss 0.328417
Epoch 29, Train Loss 0.342284, Valid_loss 0.275252
Epoch 30, Train Loss 0.280439, Valid_loss 0.228872
Epoch 31, Train Loss 0.289927, Valid_loss 0.340782
Epoch 32, Train Loss 0.303563, Valid_loss 0.208384
Epoch 33, Train Loss 0.264148, Valid_loss 0.323046
Epoch 34, Train Loss 0.245500, Valid_loss 0.214168
Epoch 35, Train Loss 0.336039, Valid_loss 0.189515
Epoch 36, Train Loss 0.320232, Valid_loss 0.191287
Epoch 37, Train Loss 0.243760, Valid_loss 0.442139
Epoch 38, Train Loss 0.201562, Valid_loss 0.255092
Epoch 39, Train Loss 0.253155, Valid_loss 0.405964
Epoch 40, Train Loss 0.391029, Valid_loss 0.225065
Epoch 41, Train Loss 0.308799, Valid_loss 0.247846
Epoch 42, Train Loss 0.212897, Valid_loss 0.298274
Epoch 43, Train Loss 0.211777, Valid_loss 0.201893
Epoch 44, Train Loss 0.336640, Valid_loss 0.196253
Epoch 45, Train Loss 0.221327, Valid_loss 0.372080
Epoch 46, Train Loss 0.272373, Valid_loss 0.284521
Epoch 47, Train Loss 0.283368, Valid_loss 0.210500
Epoch 48, Train Loss 0.319074, Valid_loss 0.259709
Epoch 49, Train Loss 0.235362, Valid_loss 0.209956
Epoch 50, Train Loss 0.260684, Valid_loss 0.165122
Epoch 51, Train Loss 0.249442, Valid_loss 0.165526
Epoch 52, Train Loss 0.208526, Valid_loss 0.143294
Epoch 53, Train Loss 0.146715, Valid_loss 0.297479
Epoch 54, Train Loss 0.211661, Valid_loss 0.313029
[I 2025-08-31 08:12:46,435] Trial 2 finished with value: 0.1432938070945619 and parameters: {'learning_rate': 0.001, 'epochs': 100, 'heads': 4, 'dropout': 0.5, 'weight_decay': 0.001, 'emb_dim': 64, 'augment_num': 100, 'pca': False}. Best is trial 2 with value: 0.1432938070945619.
선택된 trial params: {'learning_rate': 0.001, 'epochs': 100, 'heads': 4, 'dropout': 0.5, 'weight_decay': 0.001, 'emb_dim': 64, 'augment_num': 100, 'pca': False}
👉 train samples(학습 샘플(bag))=141, batch_size=8 -> steps(샘플수/batch크기)=18
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=15, batch_size=1 -> steps=15
Memory Allocated: 2135.85 MB
Memory Reserved: 2138.00 MB
cuda
CUDA OOM 발생 — 단계적 백오프 시작.
[OOM RETRY] batch_size 8 → 8 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=141, batch_size=8 -> steps(샘플수/batch크기)=18
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=15, batch_size=1 -> steps=15
Memory Allocated: 1082.16 MB
Memory Reserved: 1088.00 MB
cuda
[OOM RETRY] batch_size=8에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 8 → 4 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=141, batch_size=4 -> steps(샘플수/batch크기)=36
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=15, batch_size=1 -> steps=15
Memory Allocated: 2135.85 MB
Memory Reserved: 2138.00 MB
cuda
Epoch 1, Train Loss 0.948494, Valid_loss 1.090087
Epoch 2, Train Loss 0.920161, Valid_loss 1.209466
Epoch 3, Train Loss 0.893775, Valid_loss 1.085826
Epoch 4, Train Loss 0.827034, Valid_loss 1.201941
Epoch 5, Train Loss 0.858202, Valid_loss 1.031375
Epoch 6, Train Loss 0.823585, Valid_loss 0.827082
Epoch 7, Train Loss 0.742816, Valid_loss 1.138255
Epoch 8, Train Loss 0.732866, Valid_loss 0.560923
Epoch 9, Train Loss 0.781002, Valid_loss 0.806670
Epoch 10, Train Loss 0.530999, Valid_loss 0.650123
Epoch 11, Train Loss 0.582341, Valid_loss 0.447129
Epoch 12, Train Loss 0.580421, Valid_loss 0.475690
Epoch 13, Train Loss 0.504692, Valid_loss 0.455529
Epoch 14, Train Loss 0.525193, Valid_loss 0.411378
Epoch 15, Train Loss 0.478734, Valid_loss 0.601998
Epoch 16, Train Loss 0.578223, Valid_loss 0.751729
Epoch 17, Train Loss 0.499588, Valid_loss 0.399344
Epoch 18, Train Loss 0.530997, Valid_loss 0.434476
Epoch 19, Train Loss 0.484467, Valid_loss 0.415861
Epoch 20, Train Loss 0.442499, Valid_loss 0.425713
Epoch 21, Train Loss 0.433541, Valid_loss 0.403969
Epoch 22, Train Loss 0.427707, Valid_loss 0.410503
Epoch 23, Train Loss 0.503552, Valid_loss 0.425396
Epoch 24, Train Loss 0.482285, Valid_loss 0.403701
Epoch 25, Train Loss 0.426648, Valid_loss 0.342675
Epoch 26, Train Loss 0.318035, Valid_loss 0.360423
Epoch 27, Train Loss 0.344988, Valid_loss 0.388252
Epoch 28, Train Loss 0.382319, Valid_loss 0.352322
Epoch 29, Train Loss 0.384513, Valid_loss 0.358254
Epoch 30, Train Loss 0.345339, Valid_loss 0.343359
Epoch 31, Train Loss 0.314985, Valid_loss 0.287064
Epoch 32, Train Loss 0.400281, Valid_loss 0.388226
Epoch 33, Train Loss 0.307381, Valid_loss 0.295372
Epoch 34, Train Loss 0.293992, Valid_loss 0.297317
Epoch 35, Train Loss 0.404651, Valid_loss 0.293541
Epoch 36, Train Loss 0.298667, Valid_loss 0.599026
Epoch 37, Train Loss 0.286331, Valid_loss 0.265818
Epoch 38, Train Loss 0.260961, Valid_loss 0.228270
Epoch 39, Train Loss 0.256386, Valid_loss 0.312588
Epoch 40, Train Loss 0.252409, Valid_loss 0.214818
Epoch 41, Train Loss 0.477626, Valid_loss 0.201907
Epoch 42, Train Loss 0.247637, Valid_loss 0.225786
Epoch 43, Train Loss 0.332261, Valid_loss 0.253750
Epoch 44, Train Loss 0.285240, Valid_loss 0.345310
Epoch 45, Train Loss 0.246131, Valid_loss 0.213187
Epoch 46, Train Loss 0.196493, Valid_loss 0.190412
Epoch 47, Train Loss 0.247623, Valid_loss 0.278972
Epoch 48, Train Loss 0.338961, Valid_loss 0.246184
Epoch 49, Train Loss 0.265776, Valid_loss 0.210848
Epoch 50, Train Loss 0.224598, Valid_loss 0.164658
Epoch 51, Train Loss 0.257426, Valid_loss 0.157193
Epoch 52, Train Loss 0.185427, Valid_loss 0.242022
Epoch 53, Train Loss 0.183749, Valid_loss 0.276352
환자ID=163-5 -- true: [[0]] -- pred: tensor([[ 4.5132, -2.7167, -4.4236]], device='cuda:0')
환자ID=164-3 -- true: [[0]] -- pred: tensor([[ 3.0605, -0.9237, -5.1654]], device='cuda:0')
환자ID=27-10039 -- true: [[1]] -- pred: tensor([[-3.3656,  1.3981, -0.3459]], device='cuda:0')
환자ID=28-12381 -- true: [[1]] -- pred: tensor([[-2.5338,  1.9024, -2.3763]], device='cuda:0')
환자ID=29-10010 -- true: [[1]] -- pred: tensor([[-3.1485,  1.6524, -1.0931]], device='cuda:0')
환자ID=29-10011 -- true: [[1]] -- pred: tensor([[-3.4264,  1.2968, -0.1365]], device='cuda:0')
환자ID=30-10929 -- true: [[2]] -- pred: tensor([[-3.4224,  1.1693,  0.1103]], device='cuda:0')
환자ID=31-10040 -- true: [[1]] -- pred: tensor([[-2.5860,  1.9014, -2.2776]], device='cuda:0')
환자ID=31-10210 -- true: [[1]] -- pred: tensor([[-0.7668,  1.5995, -3.9930]], device='cuda:0')
환자ID=31-10236 -- true: [[1]] -- pred: tensor([[-2.2816,  1.9222, -2.7647]], device='cuda:0')
환자ID=32-10003 -- true: [[2]] -- pred: tensor([[-3.3699,  1.3921, -0.3456]], device='cuda:0')
환자ID=34-10187 -- true: [[2]] -- pred: tensor([[-3.1701,  1.6320, -1.0098]], device='cuda:0')
환자ID=PRE027 -- true: [[0]] -- pred: tensor([[ 3.9602, -1.8062, -5.0105]], device='cuda:0')
환자ID=PRE062-1 -- true: [[0]] -- pred: tensor([[ 4.1956, -2.1187, -4.8854]], device='cuda:0')
환자ID=Sample1157-EO3 -- true: [[0]] -- pred: tensor([[ 3.8012, -1.6219, -5.0641]], device='cuda:0')
Best performance: Epoch 51, Loss 0.257426, Test ACC 0.800000, Test AUC 0.944444, Test Recall 0.666667, Test Precision 0.566667
Confusion Matrix:
 [[5 0 0]
 [0 7 0]
 [0 3 0]]
✅ Total valid splits used: 4
🔁 Repeat 2, Fold 4
cell type :  S2008000628HRT_AAACCCAAGACGCTCC-1                   DC
S2008000628HRT_AAACCCAAGTAGCCAG-1              T_cells
S2008000628HRT_AAACCCAGTCCAGAAG-1              T_cells
S2008000628HRT_AAACCCAGTGTATCCA-1               B_cell
S2008000628HRT_AAACGAAAGCGTTAGG-1          Fibroblasts
                                           ...        
Sample1162EO2_TTTGGAGAGCAGGCAT-1      Epithelial_cells
Sample1162EO2_TTTGGAGAGTCGCGAA-1     Endothelial_cells
Sample1162EO2_TTTGGAGAGTGCTCGC-1           Hepatocytes
Sample1162EO2_TTTGGAGGTGATACTC-1      Epithelial_cells
Sample1162EO2_TTTGGTTCAGTAGAAT-1      Epithelial_cells
Name: singler_annotation, Length: 180411, dtype: string
cell type annotation :  S2008000628HRT_AAACCCAAGACGCTCC-1                   DC
S2008000628HRT_AAACCCAAGTAGCCAG-1              T_cells
S2008000628HRT_AAACCCAGTCCAGAAG-1              T_cells
S2008000628HRT_AAACCCAGTGTATCCA-1               B_cell
S2008000628HRT_AAACGAAAGCGTTAGG-1          Fibroblasts
                                           ...        
Sample1162EO2_TTTGGAGAGCAGGCAT-1      Epithelial_cells
Sample1162EO2_TTTGGAGAGTCGCGAA-1     Endothelial_cells
Sample1162EO2_TTTGGAGAGTGCTCGC-1           Hepatocytes
Sample1162EO2_TTTGGAGGTGATACTC-1      Epithelial_cells
Sample1162EO2_TTTGGTTCAGTAGAAT-1      Epithelial_cells
Name: singler_annotation, Length: 180411, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['DC', 'T_cells', 'B_cell', 'Fibroblasts', 'Macrophage', 'Monocyte', 'HSC_-G-CSF', 'Pre-B_cell_CD34-', 'Neutrophils', 'GMP', 'Smooth_muscle_cells', 'MSC', 'NK_cell', 'Epithelial_cells', 'iPS_cells', 'HSC_CD34+', 'Chondrocytes', 'Platelets', 'Pro-B_cell_CD34+', 'Myelocyte', 'Osteoblasts', 'BM', 'Pro-Myelocyte', 'Endothelial_cells', 'Tissue_stem_cells', 'CMP', 'Astrocyte', 'Embryonic_stem_cells', 'Hepatocytes', 'Neurons', 'Keratinocytes', 'Neuroepithelial_cell', 'MEP', 'BM & Prog.', 'Erythroblast', 'Unknown', 'Gametocytes']
라벨별 그룹 개수 {0: 21, 1: 30, 2: 11}
cell type :  S2008000605HRT_AAACCCAGTGCACATT-1        Epithelial_cells
S2008000605HRT_AAACCCAGTGCCTACG-1        Epithelial_cells
S2008000605HRT_AAAGAACGTAGAGACC-1               Astrocyte
S2008000605HRT_AAAGAACGTCGGAACA-1        Epithelial_cells
S2008000605HRT_AAAGAACGTTAACAGA-1        Epithelial_cells
                                             ...         
Sample1158EO2_TTTGACTAGGACACTG-1                  NK_cell
Sample1158EO2_TTTGACTTCCTCTTTC-1      Smooth_muscle_cells
Sample1158EO2_TTTGATCAGCTAAACA-1     Embryonic_stem_cells
Sample1158EO2_TTTGATCTCACTTATC-1     Neuroepithelial_cell
Sample1158EO2_TTTGTTGCAATACGCT-1     Embryonic_stem_cells
Name: singler_annotation, Length: 44766, dtype: string
cell type annotation :  S2008000605HRT_AAACCCAGTGCACATT-1        Epithelial_cells
S2008000605HRT_AAACCCAGTGCCTACG-1        Epithelial_cells
S2008000605HRT_AAAGAACGTAGAGACC-1               Astrocyte
S2008000605HRT_AAAGAACGTCGGAACA-1        Epithelial_cells
S2008000605HRT_AAAGAACGTTAACAGA-1        Epithelial_cells
                                             ...         
Sample1158EO2_TTTGACTAGGACACTG-1                  NK_cell
Sample1158EO2_TTTGACTTCCTCTTTC-1      Smooth_muscle_cells
Sample1158EO2_TTTGATCAGCTAAACA-1     Embryonic_stem_cells
Sample1158EO2_TTTGATCTCACTTATC-1     Neuroepithelial_cell
Sample1158EO2_TTTGTTGCAATACGCT-1     Embryonic_stem_cells
Name: singler_annotation, Length: 44766, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Epithelial_cells', 'Astrocyte', 'MSC', 'Keratinocytes', 'Neurons', 'Endothelial_cells', 'Fibroblasts', 'Tissue_stem_cells', 'Smooth_muscle_cells', 'T_cells', 'Neuroepithelial_cell', 'NK_cell', 'Chondrocytes', 'Osteoblasts', 'Monocyte', 'Hepatocytes', 'Macrophage', 'CMP', 'Embryonic_stem_cells', 'DC', 'BM & Prog.', 'MEP', 'Neutrophils', 'Pro-Myelocyte', 'iPS_cells', 'Pre-B_cell_CD34-', 'HSC_-G-CSF', 'GMP', 'HSC_CD34+', 'Pro-B_cell_CD34+', 'Unknown', 'Platelets', 'B_cell', 'BM', 'Gametocytes', 'Myelocyte', 'Erythroblast']
라벨별 그룹 개수 {0: 5, 1: 7, 2: 3}
🔍 Split #5
  → train_p_index 환자 수 (환자 단위로 묶인 index list): 62
  → test_p_index 환자 수  (환자 단위로 묶인 index list): 15
  → train 환자 ID: ['163-2', '163-4', '163-5', '164-10', '164-3', '164-6', '165-9', '27-10039', '27-10041', '27-10053', '27-10071', '28-10051', '28-11515', '28-12381', '28-12490', '29-10006', '29-10008', '29-10010', '29-10011', '29-10012', '29-10016', '29-10280', '29-10380', '29-10386', '29-10398', '29-10400', '29-10404', '29-10406', '29-10410', '30-10125', '30-10929', '30-11051', '31-10001', '31-10013', '31-10040', '31-10042', '31-10078', '31-10154', '31-10210', '31-10236', '32-10003', '32-10034', '32-10074', '33-10005', '33-10006', '34-10050', '34-10184', '34-10187', 'PRE018-1', 'PRE019', 'PRE027', 'PRE055-1', 'PRE062-1', 'PRE98sc', 'Sample1153-EO1', 'Sample1153-EO2', 'Sample1153-EO3', 'Sample1157-EO3', 'Sample1158-EO1', 'Sample1158-EO3', 'Sample1162-EO1', 'Sample1162-EO2']
  → test  환자 ID: ['163-3', '27-10112', '27-10119', '28-12263', '28-12518', '29-10013', '30-10018', '30-10034', '30-10123', '31-10000', '31-10035', 'PRE038', 'Sample1157-EO1', 'Sample1157-EO2', 'Sample1158-EO2']
  → train 환자 ID 및 라벨:
    ID: 163-2, Label: 0
    ID: 163-4, Label: 0
    ID: 163-5, Label: 0
    ID: 164-10, Label: 0
    ID: 164-3, Label: 0
    ID: 164-6, Label: 0
    ID: 165-9, Label: 0
    ID: 27-10039, Label: 1
    ID: 27-10041, Label: 1
    ID: 27-10053, Label: 1
    ID: 27-10071, Label: 1
    ID: 28-10051, Label: 1
    ID: 28-11515, Label: 1
    ID: 28-12381, Label: 1
    ID: 28-12490, Label: 1
    ID: 29-10006, Label: 1
    ID: 29-10008, Label: 1
    ID: 29-10010, Label: 1
    ID: 29-10011, Label: 1
    ID: 29-10012, Label: 1
    ID: 29-10016, Label: 1
    ID: 29-10280, Label: 1
    ID: 29-10380, Label: 1
    ID: 29-10386, Label: 1
    ID: 29-10398, Label: 1
    ID: 29-10400, Label: 1
    ID: 29-10404, Label: 1
    ID: 29-10406, Label: 1
    ID: 29-10410, Label: 1
    ID: 30-10125, Label: 2
    ID: 30-10929, Label: 2
    ID: 30-11051, Label: 2
    ID: 31-10001, Label: 1
    ID: 31-10013, Label: 1
    ID: 31-10040, Label: 1
    ID: 31-10042, Label: 1
    ID: 31-10078, Label: 1
    ID: 31-10154, Label: 1
    ID: 31-10210, Label: 1
    ID: 31-10236, Label: 1
    ID: 32-10003, Label: 2
    ID: 32-10034, Label: 2
    ID: 32-10074, Label: 2
    ID: 33-10005, Label: 2
    ID: 33-10006, Label: 2
    ID: 34-10050, Label: 2
    ID: 34-10184, Label: 2
    ID: 34-10187, Label: 2
    ID: PRE018-1, Label: 0
    ID: PRE019, Label: 0
    ID: PRE027, Label: 0
    ID: PRE055-1, Label: 0
    ID: PRE062-1, Label: 0
    ID: PRE98sc, Label: 0
    ID: Sample1153-EO1, Label: 0
    ID: Sample1153-EO2, Label: 0
    ID: Sample1153-EO3, Label: 0
    ID: Sample1157-EO3, Label: 0
    ID: Sample1158-EO1, Label: 0
    ID: Sample1158-EO3, Label: 0
    ID: Sample1162-EO1, Label: 0
    ID: Sample1162-EO2, Label: 0
  → test 환자 ID 및 라벨:
    ID: 163-3, Label: 0
    ID: 27-10112, Label: 1
    ID: 27-10119, Label: 1
    ID: 28-12263, Label: 1
    ID: 28-12518, Label: 1
    ID: 29-10013, Label: 1
    ID: 30-10018, Label: 2
    ID: 30-10034, Label: 2
    ID: 30-10123, Label: 2
    ID: 31-10000, Label: 1
    ID: 31-10035, Label: 1
    ID: PRE038, Label: 0
    ID: Sample1157-EO1, Label: 0
    ID: Sample1157-EO2, Label: 0
    ID: Sample1158-EO2, Label: 0
전체 데이터 index 길이 77
label_stat (train 환자 라벨 목록) 갯수 62
train_data에서 환자 단위로, train과 validation 나누기
기존 train_p_index 62
기존 (train) label_stat 62
train-vali 분할 후! 
train y 의 classes : {0, 1, 2} valid y 의 classes : {0, 1, 2} label_stat 의 classes : {0, 1, 2}
train_p_index_ 41
valid_p_index 21
test_p_index 15
→ train 환자 ID 및 라벨:
   총 개수: 41
   환자ID=29-10280, Label=1, 셀개수=2375
   환자ID=31-10210, Label=1, 셀개수=3510
   환자ID=34-10184, Label=2, 셀개수=2699
   환자ID=32-10034, Label=2, 셀개수=1555
   환자ID=Sample1158-EO1, Label=0, 셀개수=574
   환자ID=164-10, Label=0, 셀개수=4041
   환자ID=29-10010, Label=1, 셀개수=5305
   환자ID=PRE027, Label=0, 셀개수=2078
   환자ID=31-10013, Label=1, 셀개수=3161
   환자ID=30-11051, Label=2, 셀개수=2454
   환자ID=163-4, Label=0, 셀개수=1339
   환자ID=28-10051, Label=1, 셀개수=300
   환자ID=165-9, Label=0, 셀개수=2926
   환자ID=27-10039, Label=1, 셀개수=4638
   환자ID=163-2, Label=0, 셀개수=2535
   환자ID=29-10410, Label=1, 셀개수=2834
   환자ID=31-10042, Label=1, 셀개수=1222
   환자ID=30-10929, Label=2, 셀개수=5812
   환자ID=Sample1158-EO3, Label=0, 셀개수=1096
   환자ID=29-10386, Label=1, 셀개수=802
   환자ID=31-10040, Label=1, 셀개수=4543
   환자ID=163-5, Label=0, 셀개수=1210
   환자ID=32-10003, Label=2, 셀개수=2978
   환자ID=PRE062-1, Label=0, 셀개수=907
   환자ID=29-10404, Label=1, 셀개수=3988
   환자ID=28-12381, Label=1, 셀개수=1099
   환자ID=Sample1162-EO1, Label=0, 셀개수=1053
   환자ID=31-10078, Label=1, 셀개수=2827
   환자ID=34-10187, Label=2, 셀개수=3739
   환자ID=27-10071, Label=1, 셀개수=1478
   환자ID=29-10008, Label=1, 셀개수=1913
   환자ID=28-11515, Label=1, 셀개수=930
   환자ID=164-6, Label=0, 셀개수=3038
   환자ID=29-10400, Label=1, 셀개수=2684
   환자ID=34-10050, Label=2, 셀개수=4784
   환자ID=29-10380, Label=1, 셀개수=4799
   환자ID=33-10005, Label=2, 셀개수=8904
   환자ID=32-10074, Label=2, 셀개수=6304
   환자ID=31-10236, Label=1, 셀개수=3458
   환자ID=29-10016, Label=1, 셀개수=4854
   환자ID=29-10006, Label=1, 셀개수=11461
→ valid 환자 ID 및 라벨:
   총 개수: 21
   환자ID=Sample1162-EO2, Label=0, 셀개수=1510
   환자ID=29-10012, Label=1, 셀개수=6245
   환자ID=31-10154, Label=1, 셀개수=6568
   환자ID=PRE98sc, Label=0, 셀개수=1568
   환자ID=33-10006, Label=2, 셀개수=457
   환자ID=PRE055-1, Label=0, 셀개수=597
   환자ID=Sample1153-EO3, Label=0, 셀개수=1516
   환자ID=30-10125, Label=2, 셀개수=3798
   환자ID=31-10001, Label=1, 셀개수=1133
   환자ID=29-10406, Label=1, 셀개수=3484
   환자ID=Sample1157-EO3, Label=0, 셀개수=807
   환자ID=27-10053, Label=1, 셀개수=728
   환자ID=29-10398, Label=1, 셀개수=3993
   환자ID=Sample1153-EO1, Label=0, 셀개수=911
   환자ID=PRE019, Label=0, 셀개수=3795
   환자ID=PRE018-1, Label=0, 셀개수=1349
   환자ID=164-3, Label=0, 셀개수=1639
   환자ID=29-10011, Label=1, 셀개수=3072
   환자ID=27-10041, Label=1, 셀개수=2145
   환자ID=28-12490, Label=1, 셀개수=5973
   환자ID=Sample1153-EO2, Label=0, 셀개수=916
→ test 환자 ID 및 라벨:
   총 개수: 15
   환자ID=163-3, Label=0, 셀개수=1335
   환자ID=27-10112, Label=1, 셀개수=1470
   환자ID=27-10119, Label=1, 셀개수=3346
   환자ID=28-12263, Label=1, 셀개수=7527
   환자ID=28-12518, Label=1, 셀개수=1215
   환자ID=29-10013, Label=1, 셀개수=3706
   환자ID=30-10018, Label=2, 셀개수=5170
   환자ID=30-10034, Label=2, 셀개수=1240
   환자ID=30-10123, Label=2, 셀개수=1273
   환자ID=31-10000, Label=1, 셀개수=8870
   환자ID=31-10035, Label=1, 셀개수=2974
   환자ID=PRE038, Label=0, 셀개수=2666
   환자ID=Sample1157-EO1, Label=0, 셀개수=1152
   환자ID=Sample1157-EO2, Label=0, 셀개수=1395
   환자ID=Sample1158-EO2, Label=0, 셀개수=1427
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['DC', 'T_cells', 'T_cells', 'B_cell', 'Fibroblasts', 'Macrophage', 'DC', 'Monocyte', 'T_cells', 'Fibroblasts']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
전체 데이터 길이 225177
전체 cell type 길이 0                           DC
1                      T_cells
2                      T_cells
3                       B_cell
4                  Fibroblasts
                  ...         
225172                 NK_cell
225173     Smooth_muscle_cells
225174    Embryonic_stem_cells
225175    Neuroepithelial_cell
225176    Embryonic_stem_cells
Length: 225177, dtype: string
cell type의 NaN 개수 체크 0
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:10,  9.26it/s]  2%|▏         | 2/100 [00:00<00:11,  8.38it/s]  3%|▎         | 3/100 [00:00<00:11,  8.55it/s]  4%|▍         | 4/100 [00:00<00:11,  8.66it/s]  5%|▌         | 5/100 [00:00<00:10,  8.72it/s]  6%|▌         | 6/100 [00:00<00:10,  8.94it/s]  7%|▋         | 7/100 [00:00<00:11,  8.45it/s]  8%|▊         | 8/100 [00:00<00:11,  8.26it/s]  9%|▉         | 9/100 [00:01<00:10,  8.45it/s] 10%|█         | 10/100 [00:01<00:10,  8.72it/s] 11%|█         | 11/100 [00:01<00:10,  8.90it/s] 12%|█▏        | 12/100 [00:01<00:09,  9.06it/s] 13%|█▎        | 13/100 [00:01<00:09,  9.01it/s] 15%|█▌        | 15/100 [00:01<00:09,  9.18it/s] 16%|█▌        | 16/100 [00:01<00:08,  9.34it/s] 17%|█▋        | 17/100 [00:01<00:09,  9.22it/s] 18%|█▊        | 18/100 [00:02<00:08,  9.21it/s] 19%|█▉        | 19/100 [00:02<00:09,  8.90it/s] 20%|██        | 20/100 [00:02<00:08,  8.95it/s] 21%|██        | 21/100 [00:02<00:08,  8.91it/s] 22%|██▏       | 22/100 [00:02<00:08,  9.10it/s] 23%|██▎       | 23/100 [00:02<00:08,  9.03it/s] 24%|██▍       | 24/100 [00:02<00:08,  9.09it/s] 25%|██▌       | 25/100 [00:02<00:08,  8.95it/s] 26%|██▌       | 26/100 [00:02<00:08,  9.00it/s] 27%|██▋       | 27/100 [00:03<00:07,  9.13it/s] 28%|██▊       | 28/100 [00:03<00:07,  9.05it/s] 29%|██▉       | 29/100 [00:03<00:07,  9.07it/s] 30%|███       | 30/100 [00:03<00:08,  8.45it/s] 31%|███       | 31/100 [00:03<00:08,  8.61it/s] 32%|███▏      | 32/100 [00:03<00:07,  8.67it/s] 33%|███▎      | 33/100 [00:03<00:07,  8.83it/s] 34%|███▍      | 34/100 [00:03<00:07,  8.76it/s] 35%|███▌      | 35/100 [00:03<00:07,  8.67it/s] 36%|███▌      | 36/100 [00:04<00:07,  8.78it/s] 37%|███▋      | 37/100 [00:04<00:07,  8.75it/s] 38%|███▊      | 38/100 [00:04<00:07,  7.83it/s] 39%|███▉      | 39/100 [00:04<00:07,  8.10it/s] 40%|████      | 40/100 [00:04<00:07,  8.21it/s] 41%|████      | 41/100 [00:04<00:07,  8.32it/s] 42%|████▏     | 42/100 [00:04<00:06,  8.40it/s] 43%|████▎     | 43/100 [00:04<00:06,  8.33it/s] 44%|████▍     | 44/100 [00:05<00:06,  8.34it/s] 45%|████▌     | 45/100 [00:05<00:07,  7.81it/s] 46%|████▌     | 46/100 [00:05<00:06,  8.02it/s] 47%|████▋     | 47/100 [00:05<00:06,  8.50it/s] 48%|████▊     | 48/100 [00:05<00:06,  8.13it/s] 49%|████▉     | 49/100 [00:05<00:06,  8.25it/s] 50%|█████     | 50/100 [00:05<00:06,  8.31it/s] 51%|█████     | 51/100 [00:05<00:06,  8.00it/s] 52%|█████▏    | 52/100 [00:06<00:05,  8.11it/s] 53%|█████▎    | 53/100 [00:06<00:07,  6.11it/s] 54%|█████▍    | 54/100 [00:06<00:06,  6.73it/s] 55%|█████▌    | 55/100 [00:06<00:06,  7.18it/s] 56%|█████▌    | 56/100 [00:06<00:05,  7.34it/s] 57%|█████▋    | 57/100 [00:06<00:06,  6.88it/s] 58%|█████▊    | 58/100 [00:06<00:05,  7.27it/s] 59%|█████▉    | 59/100 [00:07<00:05,  7.49it/s] 60%|██████    | 60/100 [00:07<00:05,  7.73it/s] 61%|██████    | 61/100 [00:07<00:04,  7.85it/s] 62%|██████▏   | 62/100 [00:07<00:04,  7.77it/s] 63%|██████▎   | 63/100 [00:07<00:04,  8.04it/s] 64%|██████▍   | 64/100 [00:07<00:04,  7.31it/s] 65%|██████▌   | 65/100 [00:07<00:04,  7.38it/s] 66%|██████▌   | 66/100 [00:07<00:04,  7.49it/s] 67%|██████▋   | 67/100 [00:08<00:04,  7.69it/s] 68%|██████▊   | 68/100 [00:08<00:04,  7.80it/s] 69%|██████▉   | 69/100 [00:08<00:03,  7.88it/s] 70%|███████   | 70/100 [00:08<00:04,  6.70it/s] 71%|███████   | 71/100 [00:08<00:04,  7.11it/s] 72%|███████▏  | 72/100 [00:08<00:03,  7.39it/s] 73%|███████▎  | 73/100 [00:08<00:03,  7.53it/s] 74%|███████▍  | 74/100 [00:09<00:03,  7.53it/s] 75%|███████▌  | 75/100 [00:09<00:03,  7.83it/s] 76%|███████▌  | 76/100 [00:09<00:03,  7.90it/s] 77%|███████▋  | 77/100 [00:09<00:02,  7.93it/s] 78%|███████▊  | 78/100 [00:09<00:02,  7.93it/s] 79%|███████▉  | 79/100 [00:09<00:02,  7.98it/s] 80%|████████  | 80/100 [00:09<00:02,  8.04it/s] 81%|████████  | 81/100 [00:09<00:02,  7.97it/s] 82%|████████▏ | 82/100 [00:10<00:02,  7.91it/s] 83%|████████▎ | 83/100 [00:10<00:02,  8.19it/s] 84%|████████▍ | 84/100 [00:10<00:01,  8.09it/s] 85%|████████▌ | 85/100 [00:10<00:01,  8.04it/s] 86%|████████▌ | 86/100 [00:10<00:01,  8.00it/s] 87%|████████▋ | 87/100 [00:10<00:01,  7.93it/s] 88%|████████▊ | 88/100 [00:10<00:01,  8.00it/s] 89%|████████▉ | 89/100 [00:10<00:01,  8.03it/s] 90%|█████████ | 90/100 [00:11<00:01,  8.07it/s] 91%|█████████ | 91/100 [00:11<00:01,  7.88it/s] 92%|█████████▏| 92/100 [00:11<00:01,  7.91it/s] 93%|█████████▎| 93/100 [00:11<00:00,  7.80it/s] 94%|█████████▍| 94/100 [00:11<00:00,  7.84it/s] 95%|█████████▌| 95/100 [00:11<00:00,  7.65it/s] 96%|█████████▌| 96/100 [00:11<00:00,  6.34it/s] 97%|█████████▋| 97/100 [00:12<00:00,  6.20it/s] 98%|█████████▊| 98/100 [00:12<00:00,  6.72it/s] 99%|█████████▉| 99/100 [00:12<00:00,  6.01it/s]100%|██████████| 100/100 [00:12<00:00,  6.46it/s]100%|██████████| 100/100 [00:12<00:00,  7.98it/s]
[I 2025-08-31 08:24:21,549] A new study created in memory with name: no-name-26084c00-16b2-4e53-8ee6-3c18e1fafd9a
👉 train samples(학습 샘플(bag))=141, batch_size=8 -> steps(샘플수/batch크기)=18
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 27.97 MB
Memory Reserved: 36.00 MB
cuda
Epoch 1, Train Loss 0.982598, Valid_loss 0.940547
Epoch 2, Train Loss 0.914883, Valid_loss 1.045840
Epoch 3, Train Loss 0.955849, Valid_loss 0.946632
Epoch 4, Train Loss 0.922111, Valid_loss 0.947210
Epoch 5, Train Loss 0.903894, Valid_loss 0.947631
Epoch 6, Train Loss 0.911130, Valid_loss 0.949831
Epoch 7, Train Loss 0.907858, Valid_loss 0.954188
Epoch 8, Train Loss 0.918396, Valid_loss 0.952535
Epoch 9, Train Loss 0.905603, Valid_loss 0.955176
Epoch 10, Train Loss 0.906311, Valid_loss 0.949844
Epoch 11, Train Loss 0.904073, Valid_loss 0.945558
Epoch 12, Train Loss 0.916005, Valid_loss 0.942503
Epoch 13, Train Loss 0.917051, Valid_loss 0.956514
Epoch 14, Train Loss 0.928835, Valid_loss 0.940783
Epoch 15, Train Loss 0.918626, Valid_loss 0.948828
Epoch 16, Train Loss 0.902664, Valid_loss 0.947182
Epoch 17, Train Loss 0.899086, Valid_loss 0.948049
Epoch 18, Train Loss 0.901147, Valid_loss 0.948029
Epoch 19, Train Loss 0.900776, Valid_loss 0.945289
Epoch 20, Train Loss 0.900825, Valid_loss 0.951952
Epoch 21, Train Loss 0.900277, Valid_loss 0.948186
Epoch 22, Train Loss 0.903868, Valid_loss 0.943600
Epoch 23, Train Loss 0.906262, Valid_loss 0.957753
Epoch 24, Train Loss 0.911102, Valid_loss 0.946239
Epoch 25, Train Loss 0.915819, Valid_loss 0.955728
Epoch 26, Train Loss 0.898983, Valid_loss 0.942655
Epoch 27, Train Loss 0.917188, Valid_loss 0.943120
Epoch 28, Train Loss 0.910788, Valid_loss 0.955543
Epoch 29, Train Loss 0.912136, Valid_loss 0.948218
Epoch 30, Train Loss 0.900836, Valid_loss 0.954689
Epoch 31, Train Loss 0.900664, Valid_loss 0.949722
Epoch 32, Train Loss 0.909579, Valid_loss 0.951491
Epoch 33, Train Loss 0.913398, Valid_loss 0.954526
Epoch 34, Train Loss 0.915532, Valid_loss 0.942125
Epoch 35, Train Loss 0.903648, Valid_loss 0.952507
Epoch 36, Train Loss 0.907641, Valid_loss 0.949320
Epoch 37, Train Loss 0.900984, Valid_loss 0.942020
Epoch 38, Train Loss 0.903591, Valid_loss 0.954174
Epoch 39, Train Loss 0.897977, Valid_loss 0.949548
Epoch 40, Train Loss 0.903158, Valid_loss 0.944386
Epoch 41, Train Loss 0.907217, Valid_loss 0.946772
Epoch 42, Train Loss 0.901529, Valid_loss 0.950515
Epoch 43, Train Loss 0.924939, Valid_loss 0.968708
Epoch 44, Train Loss 0.912893, Valid_loss 0.941071
Epoch 45, Train Loss 0.898469, Valid_loss 0.949651
Epoch 46, Train Loss 0.915996, Valid_loss 0.962686
Epoch 47, Train Loss 0.899767, Valid_loss 0.945381
Epoch 48, Train Loss 0.901607, Valid_loss 0.944637
Epoch 49, Train Loss 0.902160, Valid_loss 0.949951
Epoch 50, Train Loss 0.898820, Valid_loss 0.954642
Epoch 51, Train Loss 0.899989, Valid_loss 0.953272
Epoch 52, Train Loss 0.899333, Valid_loss 0.947211
Epoch 53, Train Loss 0.905084, Valid_loss 0.948013
Epoch 54, Train Loss 0.902180, Valid_loss 0.947736
Epoch 55, Train Loss 0.900017, Valid_loss 0.951968
Epoch 56, Train Loss 0.904993, Valid_loss 0.944759
Epoch 57, Train Loss 0.908642, Valid_loss 0.949026
Epoch 58, Train Loss 0.898453, Valid_loss 0.945793
Epoch 59, Train Loss 0.897839, Valid_loss 0.947414
Epoch 60, Train Loss 0.905399, Valid_loss 0.949167
[I 2025-08-31 08:34:12,424] Trial 0 finished with value: 0.9405469809259687 and parameters: {'learning_rate': 0.01, 'epochs': 100, 'heads': 2, 'dropout': 0.0, 'weight_decay': 0.01, 'emb_dim': 64, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.9405469809259687.
👉 train samples(학습 샘플(bag))=141, batch_size=8 -> steps(샘플수/batch크기)=18
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 26.13 MB
Memory Reserved: 36.00 MB
cuda
Epoch 1, Train Loss 0.932089, Valid_loss 0.911874
Epoch 2, Train Loss 0.860320, Valid_loss 0.829810
Epoch 3, Train Loss 0.725008, Valid_loss 0.677801
Epoch 4, Train Loss 0.578344, Valid_loss 0.449649
Epoch 5, Train Loss 0.467902, Valid_loss 0.514115
Epoch 6, Train Loss 0.528216, Valid_loss 0.382025
Epoch 7, Train Loss 0.473453, Valid_loss 0.504220
Epoch 8, Train Loss 0.400615, Valid_loss 0.359981
Epoch 9, Train Loss 0.390239, Valid_loss 0.482315
Epoch 10, Train Loss 0.463686, Valid_loss 0.403856
Epoch 11, Train Loss 0.471435, Valid_loss 0.317663
Epoch 12, Train Loss 0.392578, Valid_loss 0.397491
Epoch 13, Train Loss 0.336489, Valid_loss 0.280138
Epoch 14, Train Loss 0.322059, Valid_loss 0.250123
Epoch 15, Train Loss 0.351844, Valid_loss 0.247249
Epoch 16, Train Loss 0.312862, Valid_loss 0.263320
Epoch 17, Train Loss 0.315147, Valid_loss 0.256274
Epoch 18, Train Loss 0.281701, Valid_loss 0.230250
Epoch 19, Train Loss 0.283401, Valid_loss 0.236024
Epoch 20, Train Loss 0.380738, Valid_loss 0.355395
Epoch 21, Train Loss 0.407011, Valid_loss 0.240671
Epoch 22, Train Loss 0.292380, Valid_loss 0.196880
Epoch 23, Train Loss 0.261512, Valid_loss 0.236824
Epoch 24, Train Loss 0.254300, Valid_loss 0.270907
Epoch 25, Train Loss 0.254623, Valid_loss 0.280926
Epoch 26, Train Loss 0.241617, Valid_loss 0.400912
Epoch 27, Train Loss 0.262551, Valid_loss 0.314820
Epoch 28, Train Loss 0.226772, Valid_loss 0.207196
Epoch 29, Train Loss 0.212533, Valid_loss 0.486336
Epoch 30, Train Loss 0.294882, Valid_loss 0.379429
Epoch 31, Train Loss 0.279553, Valid_loss 0.401052
Epoch 32, Train Loss 0.268035, Valid_loss 0.434770
Epoch 33, Train Loss 0.227508, Valid_loss 0.174147
Epoch 34, Train Loss 0.327956, Valid_loss 0.270247
Epoch 35, Train Loss 0.317089, Valid_loss 0.486457
Epoch 36, Train Loss 0.270336, Valid_loss 0.223899
Epoch 37, Train Loss 0.202715, Valid_loss 0.176708
Epoch 38, Train Loss 0.187997, Valid_loss 0.152955
Epoch 39, Train Loss 0.204057, Valid_loss 0.201923
Epoch 40, Train Loss 0.184696, Valid_loss 0.159413
Epoch 41, Train Loss 0.205346, Valid_loss 0.284116
Epoch 42, Train Loss 0.183999, Valid_loss 0.355978
Epoch 43, Train Loss 0.198574, Valid_loss 0.467972
Epoch 44, Train Loss 0.257398, Valid_loss 0.383049
Epoch 45, Train Loss 0.225377, Valid_loss 0.153397
Epoch 46, Train Loss 0.199952, Valid_loss 0.152985
Epoch 47, Train Loss 0.202774, Valid_loss 0.161720
Epoch 48, Train Loss 0.256923, Valid_loss 0.203960
Epoch 49, Train Loss 0.199580, Valid_loss 0.210659
Epoch 50, Train Loss 0.170065, Valid_loss 0.119118
Epoch 51, Train Loss 0.191708, Valid_loss 0.182799
Epoch 52, Train Loss 0.151075, Valid_loss 0.158436
Epoch 53, Train Loss 0.145300, Valid_loss 0.334592
Epoch 54, Train Loss 0.154226, Valid_loss 0.377028
[I 2025-08-31 08:43:01,519] Trial 1 finished with value: 0.11911835406152975 and parameters: {'learning_rate': 0.001, 'epochs': 100, 'heads': 2, 'dropout': 0.0, 'weight_decay': 0.01, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 1 with value: 0.11911835406152975.
👉 train samples(학습 샘플(bag))=141, batch_size=8 -> steps(샘플수/batch크기)=18
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 26.13 MB
Memory Reserved: 36.00 MB
cuda
Epoch 1, Train Loss 1.236124, Valid_loss 0.969338
Epoch 2, Train Loss 0.949426, Valid_loss 0.846528
Epoch 3, Train Loss 0.867579, Valid_loss 0.751953
Epoch 4, Train Loss 0.792846, Valid_loss 0.638971
Epoch 5, Train Loss 0.680694, Valid_loss 0.659190
Epoch 6, Train Loss 0.638453, Valid_loss 0.545814
Epoch 7, Train Loss 0.614436, Valid_loss 0.572161
Epoch 8, Train Loss 0.570205, Valid_loss 0.507472
Epoch 9, Train Loss 0.592686, Valid_loss 0.452393
Epoch 10, Train Loss 0.565388, Valid_loss 0.447302
Epoch 11, Train Loss 0.576372, Valid_loss 0.454717
Epoch 12, Train Loss 0.591734, Valid_loss 0.451160
Epoch 13, Train Loss 0.502643, Valid_loss 0.417055
Epoch 14, Train Loss 0.496421, Valid_loss 0.424059
Epoch 15, Train Loss 0.452063, Valid_loss 0.471748
Epoch 16, Train Loss 0.504929, Valid_loss 0.371511
Epoch 17, Train Loss 0.503057, Valid_loss 0.368582
Epoch 18, Train Loss 0.463589, Valid_loss 0.372815
Epoch 19, Train Loss 0.487925, Valid_loss 0.440173
Epoch 20, Train Loss 0.472512, Valid_loss 0.391241
Epoch 21, Train Loss 0.452888, Valid_loss 0.358890
Epoch 22, Train Loss 0.473602, Valid_loss 0.355467
Epoch 23, Train Loss 0.437796, Valid_loss 0.406075
Epoch 24, Train Loss 0.419720, Valid_loss 0.388378
Epoch 25, Train Loss 0.439998, Valid_loss 0.324240
Epoch 26, Train Loss 0.415117, Valid_loss 0.316899
Epoch 27, Train Loss 0.461143, Valid_loss 0.424666
Epoch 28, Train Loss 0.401479, Valid_loss 0.315220
Epoch 29, Train Loss 0.459665, Valid_loss 0.404410
Epoch 30, Train Loss 0.411008, Valid_loss 0.490703
Epoch 31, Train Loss 0.451941, Valid_loss 0.370165
Epoch 32, Train Loss 0.420306, Valid_loss 0.338366
Epoch 33, Train Loss 0.385742, Valid_loss 0.397455
Epoch 34, Train Loss 0.375039, Valid_loss 0.362427
Epoch 35, Train Loss 0.385301, Valid_loss 0.361872
Epoch 36, Train Loss 0.411953, Valid_loss 0.329284
Epoch 37, Train Loss 0.394582, Valid_loss 0.334147
Epoch 38, Train Loss 0.363811, Valid_loss 0.320452
Epoch 39, Train Loss 0.339182, Valid_loss 0.305020
Epoch 40, Train Loss 0.375931, Valid_loss 0.298599
Epoch 41, Train Loss 0.386350, Valid_loss 0.292536
Epoch 42, Train Loss 0.356583, Valid_loss 0.385509
Epoch 43, Train Loss 0.352621, Valid_loss 0.353118
Epoch 44, Train Loss 0.350269, Valid_loss 0.325678
Epoch 45, Train Loss 0.353844, Valid_loss 0.376701
Epoch 46, Train Loss 0.422546, Valid_loss 0.392651
Epoch 47, Train Loss 0.327157, Valid_loss 0.393449
Epoch 48, Train Loss 0.339745, Valid_loss 0.294938
Epoch 49, Train Loss 0.339388, Valid_loss 0.376543
Epoch 50, Train Loss 0.319137, Valid_loss 0.297944
Epoch 51, Train Loss 0.324520, Valid_loss 0.265155
Epoch 52, Train Loss 0.323124, Valid_loss 0.284994
Epoch 53, Train Loss 0.319008, Valid_loss 0.281300
Epoch 54, Train Loss 0.317245, Valid_loss 0.278207
Epoch 55, Train Loss 0.328414, Valid_loss 0.262903
Epoch 56, Train Loss 0.321358, Valid_loss 0.267929
Epoch 57, Train Loss 0.319974, Valid_loss 0.307160
[I 2025-08-31 08:50:54,810] Trial 2 finished with value: 0.2629032688481467 and parameters: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 1, 'dropout': 0.3, 'weight_decay': 0.01, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 1 with value: 0.11911835406152975.
선택된 trial params: {'learning_rate': 0.001, 'epochs': 100, 'heads': 2, 'dropout': 0.0, 'weight_decay': 0.01, 'emb_dim': 32, 'augment_num': 100, 'pca': False}
👉 train samples(학습 샘플(bag))=141, batch_size=8 -> steps(샘플수/batch크기)=18
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=15, batch_size=1 -> steps=15
Memory Allocated: 26.13 MB
Memory Reserved: 36.00 MB
cuda
Epoch 1, Train Loss 0.943860, Valid_loss 0.928875
Epoch 2, Train Loss 0.829734, Valid_loss 0.772042
Epoch 3, Train Loss 0.636374, Valid_loss 0.466409
Epoch 4, Train Loss 0.508267, Valid_loss 0.401507
Epoch 5, Train Loss 0.529788, Valid_loss 0.358525
Epoch 6, Train Loss 0.442667, Valid_loss 0.393627
Epoch 7, Train Loss 0.383127, Valid_loss 0.309504
Epoch 8, Train Loss 0.385794, Valid_loss 0.379837
Epoch 9, Train Loss 0.433117, Valid_loss 0.480324
Epoch 10, Train Loss 0.343259, Valid_loss 0.328781
Epoch 11, Train Loss 0.351144, Valid_loss 0.276032
Epoch 12, Train Loss 0.337890, Valid_loss 0.341176
Epoch 13, Train Loss 0.362788, Valid_loss 0.263074
Epoch 14, Train Loss 0.387836, Valid_loss 0.338674
Epoch 15, Train Loss 0.300387, Valid_loss 0.271415
Epoch 16, Train Loss 0.315447, Valid_loss 0.254061
Epoch 17, Train Loss 0.284290, Valid_loss 0.397171
Epoch 18, Train Loss 0.321697, Valid_loss 0.260561
Epoch 19, Train Loss 0.277446, Valid_loss 0.271917
Epoch 20, Train Loss 0.266288, Valid_loss 0.274214
Epoch 21, Train Loss 0.288867, Valid_loss 0.221270
Epoch 22, Train Loss 0.254512, Valid_loss 0.221624
Epoch 23, Train Loss 0.281367, Valid_loss 0.220621
Epoch 24, Train Loss 0.301428, Valid_loss 0.222354
Epoch 25, Train Loss 0.298553, Valid_loss 0.344263
Epoch 26, Train Loss 0.248837, Valid_loss 0.197836
Epoch 27, Train Loss 0.234803, Valid_loss 0.425584
Epoch 28, Train Loss 0.314397, Valid_loss 0.238672
Epoch 29, Train Loss 0.274328, Valid_loss 0.213538
Epoch 30, Train Loss 0.260200, Valid_loss 0.401619
Epoch 31, Train Loss 0.285508, Valid_loss 0.260868
Epoch 32, Train Loss 0.231382, Valid_loss 0.206652
Epoch 33, Train Loss 0.232924, Valid_loss 0.192007
Epoch 34, Train Loss 0.227205, Valid_loss 0.476036
Epoch 35, Train Loss 0.228143, Valid_loss 0.247268
Epoch 36, Train Loss 0.234393, Valid_loss 0.206659
Epoch 37, Train Loss 0.263118, Valid_loss 0.359988
Epoch 38, Train Loss 0.244737, Valid_loss 0.202454
Epoch 39, Train Loss 0.270755, Valid_loss 0.176888
Epoch 40, Train Loss 0.356766, Valid_loss 0.191053
Epoch 41, Train Loss 0.290960, Valid_loss 0.265285
Epoch 42, Train Loss 0.214179, Valid_loss 0.285056
Epoch 43, Train Loss 0.210842, Valid_loss 0.232328
Epoch 44, Train Loss 0.183525, Valid_loss 0.336783
Epoch 45, Train Loss 0.236722, Valid_loss 0.230456
Epoch 46, Train Loss 0.188080, Valid_loss 0.193353
Epoch 47, Train Loss 0.174226, Valid_loss 0.369117
Epoch 48, Train Loss 0.203235, Valid_loss 0.383167
Epoch 49, Train Loss 0.247600, Valid_loss 0.162347
Epoch 50, Train Loss 0.191848, Valid_loss 0.164416
Epoch 51, Train Loss 0.198173, Valid_loss 0.338993
Epoch 52, Train Loss 0.241819, Valid_loss 0.152974
Epoch 53, Train Loss 0.212171, Valid_loss 0.107372
Epoch 54, Train Loss 0.202224, Valid_loss 0.194395
Epoch 55, Train Loss 0.176731, Valid_loss 0.136505
Epoch 56, Train Loss 0.178252, Valid_loss 0.353137
Epoch 57, Train Loss 0.187609, Valid_loss 0.212884
Epoch 58, Train Loss 0.159397, Valid_loss 0.191598
Epoch 59, Train Loss 0.138275, Valid_loss 0.318208
Epoch 60, Train Loss 0.149827, Valid_loss 0.251294
Epoch 61, Train Loss 0.145844, Valid_loss 0.247975
Epoch 62, Train Loss 0.162975, Valid_loss 0.324249
Epoch 63, Train Loss 0.140171, Valid_loss 0.248950
Epoch 64, Train Loss 0.158211, Valid_loss 0.266817
Epoch 65, Train Loss 0.164289, Valid_loss 0.479183
환자ID=163-3 -- true: [[0]] -- pred: tensor([[ 1.3820,  0.2533, -4.3113]], device='cuda:0')
환자ID=27-10112 -- true: [[1]] -- pred: tensor([[-1.3891,  2.3476, -2.3569]], device='cuda:0')
환자ID=27-10119 -- true: [[1]] -- pred: tensor([[-0.6533,  1.8969, -3.0059]], device='cuda:0')
환자ID=28-12263 -- true: [[1]] -- pred: tensor([[-1.9229,  2.2202, -1.1788]], device='cuda:0')
환자ID=28-12518 -- true: [[1]] -- pred: tensor([[-2.0599,  1.9906, -0.8421]], device='cuda:0')
환자ID=29-10013 -- true: [[1]] -- pred: tensor([[ 1.7968, -0.2581, -4.1605]], device='cuda:0')
환자ID=30-10018 -- true: [[2]] -- pred: tensor([[-2.2900,  1.2412,  0.5315]], device='cuda:0')
환자ID=30-10034 -- true: [[2]] -- pred: tensor([[-1.4291,  2.3676, -2.3125]], device='cuda:0')
환자ID=30-10123 -- true: [[2]] -- pred: tensor([[-2.1000,  2.0083, -0.6874]], device='cuda:0')
환자ID=31-10000 -- true: [[1]] -- pred: tensor([[-0.9079,  2.0471, -2.7374]], device='cuda:0')
환자ID=31-10035 -- true: [[1]] -- pred: tensor([[-1.9695,  2.1648, -1.1969]], device='cuda:0')
환자ID=PRE038 -- true: [[0]] -- pred: tensor([[ 2.6690, -1.1789, -4.1498]], device='cuda:0')
환자ID=Sample1157-EO1 -- true: [[0]] -- pred: tensor([[ 2.8145, -1.3573, -4.0622]], device='cuda:0')
환자ID=Sample1157-EO2 -- true: [[0]] -- pred: tensor([[ 2.6027, -1.0738, -4.2105]], device='cuda:0')
환자ID=Sample1158-EO2 -- true: [[0]] -- pred: tensor([[ 2.9579, -1.5643, -3.8690]], device='cuda:0')
Best performance: Epoch 53, Loss 0.212171, Test ACC 0.733333, Test AUC 0.887302, Test Recall 0.619048, Test Precision 0.500000
Confusion Matrix:
 [[5 0 0]
 [1 6 0]
 [0 3 0]]
✅ Total valid splits used: 5

📌 Repeat 2: 평균 AUC = 0.8029, 표준편차 = 0.1158
Test ACC 평균 0.675000, Test Recall 평균 0.523810, Test Precision 평균 0.397778
fold_aucs = [0.84375, 0.7055555555555556, 0.6333333333333333, 0.9444444444444445, 0.8873015873015874]
NaN 개수: 0 / 전체 5개

🔁 Repeat 3, Fold 0
cell type :  S2008000605HRT_AAACCCAGTGCACATT-1     Epithelial_cells
S2008000605HRT_AAACCCAGTGCCTACG-1     Epithelial_cells
S2008000605HRT_AAAGAACGTAGAGACC-1            Astrocyte
S2008000605HRT_AAAGAACGTCGGAACA-1     Epithelial_cells
S2008000605HRT_AAAGAACGTTAACAGA-1     Epithelial_cells
                                           ...        
Sample1162EO2_TTTGGAGAGCAGGCAT-1      Epithelial_cells
Sample1162EO2_TTTGGAGAGTCGCGAA-1     Endothelial_cells
Sample1162EO2_TTTGGAGAGTGCTCGC-1           Hepatocytes
Sample1162EO2_TTTGGAGGTGATACTC-1      Epithelial_cells
Sample1162EO2_TTTGGTTCAGTAGAAT-1      Epithelial_cells
Name: singler_annotation, Length: 175879, dtype: string
cell type annotation :  S2008000605HRT_AAACCCAGTGCACATT-1     Epithelial_cells
S2008000605HRT_AAACCCAGTGCCTACG-1     Epithelial_cells
S2008000605HRT_AAAGAACGTAGAGACC-1            Astrocyte
S2008000605HRT_AAAGAACGTCGGAACA-1     Epithelial_cells
S2008000605HRT_AAAGAACGTTAACAGA-1     Epithelial_cells
                                           ...        
Sample1162EO2_TTTGGAGAGCAGGCAT-1      Epithelial_cells
Sample1162EO2_TTTGGAGAGTCGCGAA-1     Endothelial_cells
Sample1162EO2_TTTGGAGAGTGCTCGC-1           Hepatocytes
Sample1162EO2_TTTGGAGGTGATACTC-1      Epithelial_cells
Sample1162EO2_TTTGGTTCAGTAGAAT-1      Epithelial_cells
Name: singler_annotation, Length: 175879, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Epithelial_cells', 'Astrocyte', 'MSC', 'Keratinocytes', 'Neurons', 'Endothelial_cells', 'Fibroblasts', 'Tissue_stem_cells', 'Smooth_muscle_cells', 'T_cells', 'Neuroepithelial_cell', 'NK_cell', 'Chondrocytes', 'Osteoblasts', 'Monocyte', 'Hepatocytes', 'Macrophage', 'CMP', 'Embryonic_stem_cells', 'DC', 'BM & Prog.', 'MEP', 'Neutrophils', 'Pro-Myelocyte', 'iPS_cells', 'Pre-B_cell_CD34-', 'HSC_-G-CSF', 'B_cell', 'GMP', 'HSC_CD34+', 'Platelets', 'Pro-B_cell_CD34+', 'Myelocyte', 'BM', 'Erythroblast', 'Unknown', 'Gametocytes']
라벨별 그룹 개수 {0: 20, 1: 29, 2: 12}
cell type :  S2108005583HRT_AAACCCAAGATACGAT-1          Fibroblasts
S2108005583HRT_AAACCCAAGCAGCCCT-1            Astrocyte
S2108005583HRT_AAACCCAAGGTCCCGT-1          Hepatocytes
S2108005583HRT_AAACCCACAGAGTTCT-1          Fibroblasts
S2108005583HRT_AAACCCACAGCGTAGA-1          Hepatocytes
                                           ...        
Sample1158EO3_TTTGACTGTACTGAGG-1     Endothelial_cells
Sample1158EO3_TTTGACTTCGTGGACC-1               Neurons
Sample1158EO3_TTTGATCGTGTCCCTT-1      Epithelial_cells
Sample1158EO3_TTTGGAGTCATGTCTT-1      Epithelial_cells
Sample1158EO3_TTTGGTTTCGCGTGAC-1           Hepatocytes
Name: singler_annotation, Length: 49298, dtype: string
cell type annotation :  S2108005583HRT_AAACCCAAGATACGAT-1          Fibroblasts
S2108005583HRT_AAACCCAAGCAGCCCT-1            Astrocyte
S2108005583HRT_AAACCCAAGGTCCCGT-1          Hepatocytes
S2108005583HRT_AAACCCACAGAGTTCT-1          Fibroblasts
S2108005583HRT_AAACCCACAGCGTAGA-1          Hepatocytes
                                           ...        
Sample1158EO3_TTTGACTGTACTGAGG-1     Endothelial_cells
Sample1158EO3_TTTGACTTCGTGGACC-1               Neurons
Sample1158EO3_TTTGATCGTGTCCCTT-1      Epithelial_cells
Sample1158EO3_TTTGGAGTCATGTCTT-1      Epithelial_cells
Sample1158EO3_TTTGGTTTCGCGTGAC-1           Hepatocytes
Name: singler_annotation, Length: 49298, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Fibroblasts', 'Astrocyte', 'Hepatocytes', 'Endothelial_cells', 'Epithelial_cells', 'Neurons', 'Smooth_muscle_cells', 'Keratinocytes', 'iPS_cells', 'Neuroepithelial_cell', 'Monocyte', 'Chondrocytes', 'NK_cell', 'Embryonic_stem_cells', 'Tissue_stem_cells', 'GMP', 'Pre-B_cell_CD34-', 'MEP', 'Macrophage', 'Pro-B_cell_CD34+', 'BM & Prog.', 'Erythroblast', 'Osteoblasts', 'CMP', 'HSC_CD34+', 'Neutrophils', 'Pro-Myelocyte', 'HSC_-G-CSF', 'Gametocytes', 'BM', 'T_cells', 'Platelets', 'MSC', 'Unknown', 'B_cell', 'DC', 'Myelocyte']
라벨별 그룹 개수 {0: 6, 1: 8, 2: 2}
🔍 Split #1
  → train_p_index 환자 수 (환자 단위로 묶인 index list): 61
  → test_p_index 환자 수  (환자 단위로 묶인 index list): 16
  → train 환자 ID: ['163-2', '163-3', '163-4', '163-5', '164-3', '164-6', '165-9', '27-10039', '27-10041', '27-10053', '27-10071', '27-10112', '27-10119', '28-10051', '28-11515', '28-12490', '28-12518', '29-10006', '29-10008', '29-10010', '29-10011', '29-10012', '29-10013', '29-10380', '29-10386', '29-10398', '29-10400', '29-10406', '29-10410', '30-10018', '30-10034', '30-10125', '30-10929', '30-11051', '31-10001', '31-10013', '31-10035', '31-10040', '31-10042', '31-10154', '31-10210', '32-10034', '32-10074', '33-10005', '33-10006', '34-10050', '34-10184', '34-10187', 'PRE019', 'PRE038', 'PRE055-1', 'PRE062-1', 'PRE98sc', 'Sample1153-EO2', 'Sample1153-EO3', 'Sample1157-EO1', 'Sample1157-EO2', 'Sample1157-EO3', 'Sample1158-EO2', 'Sample1162-EO1', 'Sample1162-EO2']
  → test  환자 ID: ['164-10', '28-12263', '28-12381', '29-10016', '29-10280', '29-10404', '30-10123', '31-10000', '31-10078', '31-10236', '32-10003', 'PRE018-1', 'PRE027', 'Sample1153-EO1', 'Sample1158-EO1', 'Sample1158-EO3']
  → train 환자 ID 및 라벨:
    ID: 163-2, Label: 0
    ID: 163-3, Label: 0
    ID: 163-4, Label: 0
    ID: 163-5, Label: 0
    ID: 164-3, Label: 0
    ID: 164-6, Label: 0
    ID: 165-9, Label: 0
    ID: 27-10039, Label: 1
    ID: 27-10041, Label: 1
    ID: 27-10053, Label: 1
    ID: 27-10071, Label: 1
    ID: 27-10112, Label: 1
    ID: 27-10119, Label: 1
    ID: 28-10051, Label: 1
    ID: 28-11515, Label: 1
    ID: 28-12490, Label: 1
    ID: 28-12518, Label: 1
    ID: 29-10006, Label: 1
    ID: 29-10008, Label: 1
    ID: 29-10010, Label: 1
    ID: 29-10011, Label: 1
    ID: 29-10012, Label: 1
    ID: 29-10013, Label: 1
    ID: 29-10380, Label: 1
    ID: 29-10386, Label: 1
    ID: 29-10398, Label: 1
    ID: 29-10400, Label: 1
    ID: 29-10406, Label: 1
    ID: 29-10410, Label: 1
    ID: 30-10018, Label: 2
    ID: 30-10034, Label: 2
    ID: 30-10125, Label: 2
    ID: 30-10929, Label: 2
    ID: 30-11051, Label: 2
    ID: 31-10001, Label: 1
    ID: 31-10013, Label: 1
    ID: 31-10035, Label: 1
    ID: 31-10040, Label: 1
    ID: 31-10042, Label: 1
    ID: 31-10154, Label: 1
    ID: 31-10210, Label: 1
    ID: 32-10034, Label: 2
    ID: 32-10074, Label: 2
    ID: 33-10005, Label: 2
    ID: 33-10006, Label: 2
    ID: 34-10050, Label: 2
    ID: 34-10184, Label: 2
    ID: 34-10187, Label: 2
    ID: PRE019, Label: 0
    ID: PRE038, Label: 0
    ID: PRE055-1, Label: 0
    ID: PRE062-1, Label: 0
    ID: PRE98sc, Label: 0
    ID: Sample1153-EO2, Label: 0
    ID: Sample1153-EO3, Label: 0
    ID: Sample1157-EO1, Label: 0
    ID: Sample1157-EO2, Label: 0
    ID: Sample1157-EO3, Label: 0
    ID: Sample1158-EO2, Label: 0
    ID: Sample1162-EO1, Label: 0
    ID: Sample1162-EO2, Label: 0
  → test 환자 ID 및 라벨:
    ID: 164-10, Label: 0
    ID: 28-12263, Label: 1
    ID: 28-12381, Label: 1
    ID: 29-10016, Label: 1
    ID: 29-10280, Label: 1
    ID: 29-10404, Label: 1
    ID: 30-10123, Label: 2
    ID: 31-10000, Label: 1
    ID: 31-10078, Label: 1
    ID: 31-10236, Label: 1
    ID: 32-10003, Label: 2
    ID: PRE018-1, Label: 0
    ID: PRE027, Label: 0
    ID: Sample1153-EO1, Label: 0
    ID: Sample1158-EO1, Label: 0
    ID: Sample1158-EO3, Label: 0
전체 데이터 index 길이 77
label_stat (train 환자 라벨 목록) 갯수 61
train_data에서 환자 단위로, train과 validation 나누기
기존 train_p_index 61
기존 (train) label_stat 61
train-vali 분할 후! 
train y 의 classes : {0, 1, 2} valid y 의 classes : {0, 1, 2} label_stat 의 classes : {0, 1, 2}
train_p_index_ 40
valid_p_index 21
test_p_index 16
→ train 환자 ID 및 라벨:
   총 개수: 40
   환자ID=29-10012, Label=1, 셀개수=6245
   환자ID=31-10042, Label=1, 셀개수=1222
   환자ID=Sample1153-EO3, Label=0, 셀개수=1516
   환자ID=Sample1157-EO3, Label=0, 셀개수=807
   환자ID=32-10034, Label=2, 셀개수=1555
   환자ID=163-5, Label=0, 셀개수=1210
   환자ID=29-10006, Label=1, 셀개수=11461
   환자ID=PRE038, Label=0, 셀개수=2666
   환자ID=30-11051, Label=2, 셀개수=2454
   환자ID=30-10125, Label=2, 셀개수=3798
   환자ID=163-3, Label=0, 셀개수=1335
   환자ID=27-10112, Label=1, 셀개수=1470
   환자ID=165-9, Label=0, 셀개수=2926
   환자ID=27-10039, Label=1, 셀개수=4638
   환자ID=163-2, Label=0, 셀개수=2535
   환자ID=29-10410, Label=1, 셀개수=2834
   환자ID=31-10013, Label=1, 셀개수=3161
   환자ID=30-10034, Label=2, 셀개수=1240
   환자ID=29-10380, Label=1, 셀개수=4799
   환자ID=31-10001, Label=1, 셀개수=1133
   환자ID=163-4, Label=0, 셀개수=1339
   환자ID=31-10210, Label=1, 셀개수=3510
   환자ID=PRE062-1, Label=0, 셀개수=907
   환자ID=29-10400, Label=1, 셀개수=2684
   환자ID=28-10051, Label=1, 셀개수=300
   환자ID=Sample1162-EO1, Label=0, 셀개수=1053
   환자ID=31-10035, Label=1, 셀개수=2974
   환자ID=34-10187, Label=2, 셀개수=3739
   환자ID=27-10071, Label=1, 셀개수=1478
   환자ID=28-12518, Label=1, 셀개수=1215
   환자ID=27-10119, Label=1, 셀개수=3346
   환자ID=164-6, Label=0, 셀개수=3038
   환자ID=29-10398, Label=1, 셀개수=3993
   환자ID=34-10050, Label=2, 셀개수=4784
   환자ID=29-10013, Label=1, 셀개수=3706
   환자ID=33-10005, Label=2, 셀개수=8904
   환자ID=32-10074, Label=2, 셀개수=6304
   환자ID=31-10154, Label=1, 셀개수=6568
   환자ID=29-10011, Label=1, 셀개수=3072
   환자ID=28-12490, Label=1, 셀개수=5973
→ valid 환자 ID 및 라벨:
   총 개수: 21
   환자ID=Sample1162-EO2, Label=0, 셀개수=1510
   환자ID=29-10010, Label=1, 셀개수=5305
   환자ID=31-10040, Label=1, 셀개수=4543
   환자ID=PRE98sc, Label=0, 셀개수=1568
   환자ID=Sample1157-EO2, Label=0, 셀개수=1395
   환자ID=PRE055-1, Label=0, 셀개수=597
   환자ID=Sample1157-EO1, Label=0, 셀개수=1152
   환자ID=30-10018, Label=2, 셀개수=5170
   환자ID=30-10929, Label=2, 셀개수=5812
   환자ID=29-10406, Label=1, 셀개수=3484
   환자ID=Sample1158-EO2, Label=0, 셀개수=1427
   환자ID=27-10053, Label=1, 셀개수=728
   환자ID=29-10386, Label=1, 셀개수=802
   환자ID=Sample1153-EO2, Label=0, 셀개수=916
   환자ID=34-10184, Label=2, 셀개수=2699
   환자ID=PRE019, Label=0, 셀개수=3795
   환자ID=164-3, Label=0, 셀개수=1639
   환자ID=29-10008, Label=1, 셀개수=1913
   환자ID=27-10041, Label=1, 셀개수=2145
   환자ID=28-11515, Label=1, 셀개수=930
   환자ID=33-10006, Label=2, 셀개수=457
→ test 환자 ID 및 라벨:
   총 개수: 16
   환자ID=164-10, Label=0, 셀개수=4041
   환자ID=28-12263, Label=1, 셀개수=7527
   환자ID=28-12381, Label=1, 셀개수=1099
   환자ID=29-10016, Label=1, 셀개수=4854
   환자ID=29-10280, Label=1, 셀개수=2375
   환자ID=29-10404, Label=1, 셀개수=3988
   환자ID=30-10123, Label=2, 셀개수=1273
   환자ID=31-10000, Label=1, 셀개수=8870
   환자ID=31-10078, Label=1, 셀개수=2827
   환자ID=31-10236, Label=1, 셀개수=3458
   환자ID=32-10003, Label=2, 셀개수=2978
   환자ID=PRE018-1, Label=0, 셀개수=1349
   환자ID=PRE027, Label=0, 셀개수=2078
   환자ID=Sample1153-EO1, Label=0, 셀개수=911
   환자ID=Sample1158-EO1, Label=0, 셀개수=574
   환자ID=Sample1158-EO3, Label=0, 셀개수=1096
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Epithelial_cells', 'Epithelial_cells', 'Astrocyte', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'MSC', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
전체 데이터 길이 225177
전체 cell type 길이 0          Epithelial_cells
1          Epithelial_cells
2                 Astrocyte
3          Epithelial_cells
4          Epithelial_cells
                ...        
225172    Endothelial_cells
225173              Neurons
225174     Epithelial_cells
225175     Epithelial_cells
225176          Hepatocytes
Length: 225177, dtype: string
cell type의 NaN 개수 체크 0
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:10,  9.30it/s]  2%|▏         | 2/100 [00:00<00:10,  9.54it/s]  3%|▎         | 3/100 [00:00<00:10,  9.20it/s]  5%|▌         | 5/100 [00:00<00:09,  9.54it/s]  6%|▌         | 6/100 [00:00<00:09,  9.66it/s]  7%|▋         | 7/100 [00:00<00:09,  9.63it/s]  8%|▊         | 8/100 [00:00<00:10,  8.90it/s]  9%|▉         | 9/100 [00:00<00:10,  8.91it/s] 10%|█         | 10/100 [00:01<00:10,  9.00it/s] 11%|█         | 11/100 [00:01<00:09,  9.14it/s] 12%|█▏        | 12/100 [00:01<00:09,  9.01it/s] 14%|█▍        | 14/100 [00:01<00:09,  9.24it/s] 15%|█▌        | 15/100 [00:01<00:09,  9.41it/s] 16%|█▌        | 16/100 [00:01<00:08,  9.34it/s] 17%|█▋        | 17/100 [00:01<00:09,  8.49it/s] 18%|█▊        | 18/100 [00:01<00:09,  8.44it/s] 19%|█▉        | 19/100 [00:02<00:09,  8.72it/s] 20%|██        | 20/100 [00:02<00:09,  8.52it/s] 21%|██        | 21/100 [00:02<00:09,  8.65it/s] 22%|██▏       | 22/100 [00:02<00:08,  8.89it/s] 23%|██▎       | 23/100 [00:02<00:08,  8.83it/s] 24%|██▍       | 24/100 [00:02<00:08,  9.05it/s] 25%|██▌       | 25/100 [00:02<00:08,  8.78it/s] 26%|██▌       | 26/100 [00:02<00:08,  8.93it/s] 27%|██▋       | 27/100 [00:03<00:08,  8.86it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.66it/s] 29%|██▉       | 29/100 [00:03<00:08,  8.57it/s] 30%|███       | 30/100 [00:03<00:09,  7.26it/s] 31%|███       | 31/100 [00:03<00:08,  7.78it/s] 32%|███▏      | 32/100 [00:03<00:09,  7.55it/s] 33%|███▎      | 33/100 [00:03<00:08,  7.91it/s] 34%|███▍      | 34/100 [00:03<00:08,  8.14it/s] 35%|███▌      | 35/100 [00:04<00:07,  8.43it/s] 36%|███▌      | 36/100 [00:04<00:07,  8.59it/s] 37%|███▋      | 37/100 [00:04<00:07,  8.69it/s] 38%|███▊      | 38/100 [00:04<00:07,  8.73it/s] 39%|███▉      | 39/100 [00:04<00:06,  8.81it/s] 40%|████      | 40/100 [00:04<00:06,  8.82it/s] 41%|████      | 41/100 [00:04<00:06,  8.62it/s] 42%|████▏     | 42/100 [00:04<00:06,  8.60it/s] 43%|████▎     | 43/100 [00:04<00:06,  8.48it/s] 44%|████▍     | 44/100 [00:05<00:06,  8.68it/s] 45%|████▌     | 45/100 [00:05<00:06,  8.73it/s] 46%|████▌     | 46/100 [00:05<00:06,  8.70it/s] 47%|████▋     | 47/100 [00:05<00:06,  8.19it/s] 48%|████▊     | 48/100 [00:05<00:07,  7.40it/s] 49%|████▉     | 49/100 [00:05<00:06,  7.75it/s] 50%|█████     | 50/100 [00:05<00:06,  7.93it/s] 51%|█████     | 51/100 [00:05<00:06,  8.02it/s] 52%|█████▏    | 52/100 [00:06<00:06,  8.00it/s] 53%|█████▎    | 53/100 [00:06<00:05,  8.15it/s] 54%|█████▍    | 54/100 [00:06<00:05,  8.27it/s] 55%|█████▌    | 55/100 [00:06<00:05,  7.60it/s] 56%|█████▌    | 56/100 [00:06<00:05,  7.98it/s] 57%|█████▋    | 57/100 [00:06<00:05,  7.86it/s] 58%|█████▊    | 58/100 [00:06<00:05,  8.25it/s] 59%|█████▉    | 59/100 [00:06<00:04,  8.35it/s] 60%|██████    | 60/100 [00:07<00:04,  8.12it/s] 61%|██████    | 61/100 [00:07<00:04,  8.29it/s] 62%|██████▏   | 62/100 [00:07<00:04,  7.94it/s] 63%|██████▎   | 63/100 [00:07<00:04,  8.08it/s] 64%|██████▍   | 64/100 [00:07<00:04,  8.44it/s] 65%|██████▌   | 65/100 [00:07<00:04,  8.23it/s] 66%|██████▌   | 66/100 [00:07<00:04,  7.68it/s] 67%|██████▋   | 67/100 [00:07<00:04,  7.87it/s] 68%|██████▊   | 68/100 [00:08<00:04,  7.76it/s] 69%|██████▉   | 69/100 [00:08<00:03,  7.87it/s] 70%|███████   | 70/100 [00:08<00:03,  7.93it/s] 71%|███████   | 71/100 [00:08<00:03,  8.02it/s] 72%|███████▏  | 72/100 [00:08<00:03,  8.03it/s] 73%|███████▎  | 73/100 [00:08<00:03,  8.32it/s] 74%|███████▍  | 74/100 [00:08<00:03,  8.25it/s] 75%|███████▌  | 75/100 [00:08<00:03,  8.27it/s] 76%|███████▌  | 76/100 [00:09<00:02,  8.52it/s] 77%|███████▋  | 77/100 [00:09<00:02,  8.39it/s] 78%|███████▊  | 78/100 [00:09<00:02,  8.41it/s] 79%|███████▉  | 79/100 [00:09<00:02,  8.24it/s] 80%|████████  | 80/100 [00:09<00:02,  8.21it/s] 81%|████████  | 81/100 [00:09<00:02,  8.13it/s] 82%|████████▏ | 82/100 [00:09<00:02,  8.02it/s] 83%|████████▎ | 83/100 [00:09<00:02,  8.16it/s] 84%|████████▍ | 84/100 [00:09<00:01,  8.31it/s] 85%|████████▌ | 85/100 [00:10<00:01,  8.16it/s] 86%|████████▌ | 86/100 [00:10<00:01,  8.19it/s] 87%|████████▋ | 87/100 [00:10<00:01,  8.26it/s] 88%|████████▊ | 88/100 [00:10<00:01,  8.16it/s] 89%|████████▉ | 89/100 [00:10<00:01,  8.19it/s] 90%|█████████ | 90/100 [00:10<00:01,  7.44it/s] 91%|█████████ | 91/100 [00:10<00:01,  7.74it/s] 92%|█████████▏| 92/100 [00:11<00:01,  7.88it/s] 93%|█████████▎| 93/100 [00:11<00:00,  7.82it/s] 94%|█████████▍| 94/100 [00:11<00:00,  7.93it/s] 95%|█████████▌| 95/100 [00:11<00:00,  7.91it/s] 96%|█████████▌| 96/100 [00:11<00:00,  7.86it/s] 97%|█████████▋| 97/100 [00:11<00:00,  8.00it/s] 98%|█████████▊| 98/100 [00:11<00:00,  7.73it/s] 99%|█████████▉| 99/100 [00:11<00:00,  7.87it/s]100%|██████████| 100/100 [00:12<00:00,  7.76it/s]100%|██████████| 100/100 [00:12<00:00,  8.31it/s]
[I 2025-08-31 09:01:51,278] A new study created in memory with name: no-name-a4541c16-2c69-45aa-a5f1-ed488f852b6c
👉 train samples(학습 샘플(bag))=140, batch_size=8 -> steps(샘플수/batch크기)=18
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 27.97 MB
Memory Reserved: 36.00 MB
cuda
CUDA OOM 발생 — 단계적 백오프 시작.
[OOM RETRY] batch_size 8 → 8 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=140, batch_size=8 -> steps(샘플수/batch크기)=18
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 1081.66 MB
Memory Reserved: 1086.00 MB
cuda
[OOM RETRY] batch_size=8에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 8 → 4 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=140, batch_size=4 -> steps(샘플수/batch크기)=35
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 2135.85 MB
Memory Reserved: 2138.00 MB
cuda
Epoch 1, Train Loss 1.104016, Valid_loss 1.095930
Epoch 2, Train Loss 0.971612, Valid_loss 1.064869
Epoch 3, Train Loss 0.921235, Valid_loss 1.043582
Epoch 4, Train Loss 0.914764, Valid_loss 0.983672
Epoch 5, Train Loss 0.860741, Valid_loss 0.961760
Epoch 6, Train Loss 0.817318, Valid_loss 0.774647
Epoch 7, Train Loss 0.768029, Valid_loss 0.787435
Epoch 8, Train Loss 0.797392, Valid_loss 0.712152
Epoch 9, Train Loss 0.683999, Valid_loss 0.659245
Epoch 10, Train Loss 0.668268, Valid_loss 0.631759
Epoch 11, Train Loss 0.647252, Valid_loss 0.736613
Epoch 12, Train Loss 0.610454, Valid_loss 0.534771
Epoch 13, Train Loss 0.554337, Valid_loss 0.650283
Epoch 14, Train Loss 0.532796, Valid_loss 0.526355
Epoch 15, Train Loss 0.606112, Valid_loss 0.589265
Epoch 16, Train Loss 0.589363, Valid_loss 0.467840
Epoch 17, Train Loss 0.529384, Valid_loss 0.518222
Epoch 18, Train Loss 0.522265, Valid_loss 0.538886
Epoch 19, Train Loss 0.595069, Valid_loss 0.527908
Epoch 20, Train Loss 0.482086, Valid_loss 0.708799
Epoch 21, Train Loss 0.481254, Valid_loss 0.524157
Epoch 22, Train Loss 0.566023, Valid_loss 0.589744
Epoch 23, Train Loss 0.472322, Valid_loss 0.606630
Epoch 24, Train Loss 0.425337, Valid_loss 0.472249
Epoch 25, Train Loss 0.528854, Valid_loss 0.678007
Epoch 26, Train Loss 0.468793, Valid_loss 0.690324
Epoch 27, Train Loss 0.413030, Valid_loss 0.405197
Epoch 28, Train Loss 0.485724, Valid_loss 0.609939
Epoch 29, Train Loss 0.421119, Valid_loss 0.463849
Epoch 30, Train Loss 0.436277, Valid_loss 0.419006
Epoch 31, Train Loss 0.411218, Valid_loss 0.708541
Epoch 32, Train Loss 0.443362, Valid_loss 0.618318
Epoch 33, Train Loss 0.406973, Valid_loss 0.508017
Epoch 34, Train Loss 0.455830, Valid_loss 0.473455
Epoch 35, Train Loss 0.398742, Valid_loss 0.480226
Epoch 36, Train Loss 0.375498, Valid_loss 0.501157
Epoch 37, Train Loss 0.374876, Valid_loss 0.430020
Epoch 38, Train Loss 0.408346, Valid_loss 0.458851
Epoch 39, Train Loss 0.342468, Valid_loss 0.558957
Epoch 40, Train Loss 0.362664, Valid_loss 0.378263
Epoch 41, Train Loss 0.403318, Valid_loss 0.370593
Epoch 42, Train Loss 0.396746, Valid_loss 0.551555
Epoch 43, Train Loss 0.329689, Valid_loss 0.397941
Epoch 44, Train Loss 0.419694, Valid_loss 0.427361
Epoch 45, Train Loss 0.373653, Valid_loss 0.458443
Epoch 46, Train Loss 0.356056, Valid_loss 0.506921
Epoch 47, Train Loss 0.332915, Valid_loss 0.436293
Epoch 48, Train Loss 0.372770, Valid_loss 0.407214
Epoch 49, Train Loss 0.336016, Valid_loss 0.419763
Epoch 50, Train Loss 0.473676, Valid_loss 0.543958
Epoch 51, Train Loss 0.311879, Valid_loss 0.737792
Epoch 52, Train Loss 0.333586, Valid_loss 0.598448
Epoch 53, Train Loss 0.298571, Valid_loss 0.489889
Epoch 54, Train Loss 0.306213, Valid_loss 0.622975
Epoch 55, Train Loss 0.300233, Valid_loss 0.484566
Epoch 56, Train Loss 0.296729, Valid_loss 0.428615
Epoch 57, Train Loss 0.298700, Valid_loss 0.468682
Epoch 58, Train Loss 0.293126, Valid_loss 0.447677
Epoch 59, Train Loss 0.290919, Valid_loss 0.471904
Epoch 60, Train Loss 0.323421, Valid_loss 0.481910
[I 2025-08-31 09:13:57,505] Trial 0 finished with value: 0.3705926289161046 and parameters: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 4, 'dropout': 0.7, 'weight_decay': 0.001, 'emb_dim': 64, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.3705926289161046.
👉 train samples(학습 샘플(bag))=140, batch_size=8 -> steps(샘플수/batch크기)=18
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 1082.16 MB
Memory Reserved: 1088.00 MB
cuda
CUDA OOM 발생 — 단계적 백오프 시작.
[OOM RETRY] batch_size 8 → 8 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=140, batch_size=8 -> steps(샘플수/batch크기)=18
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 2135.85 MB
Memory Reserved: 2138.00 MB
cuda
[OOM RETRY] batch_size=8에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 8 → 4 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=140, batch_size=4 -> steps(샘플수/batch크기)=35
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 3189.54 MB
Memory Reserved: 3208.00 MB
cuda
Epoch 1, Train Loss 1.067634, Valid_loss 1.138593
Epoch 2, Train Loss 0.995858, Valid_loss 1.249267
Epoch 3, Train Loss 0.985012, Valid_loss 1.128207
Epoch 4, Train Loss 0.933940, Valid_loss 1.008355
Epoch 5, Train Loss 0.841822, Valid_loss 0.744340
Epoch 6, Train Loss 0.715158, Valid_loss 0.656987
Epoch 7, Train Loss 0.704496, Valid_loss 0.895505
Epoch 8, Train Loss 0.656924, Valid_loss 0.469025
Epoch 9, Train Loss 0.683179, Valid_loss 0.616419
Epoch 10, Train Loss 0.607814, Valid_loss 0.504248
Epoch 11, Train Loss 0.654022, Valid_loss 0.517546
Epoch 12, Train Loss 0.600683, Valid_loss 0.599429
Epoch 13, Train Loss 0.579863, Valid_loss 0.580401
Epoch 14, Train Loss 0.538081, Valid_loss 0.510921
Epoch 15, Train Loss 0.578831, Valid_loss 0.838429
Epoch 16, Train Loss 0.482529, Valid_loss 0.544179
Epoch 17, Train Loss 0.494683, Valid_loss 0.360155
Epoch 18, Train Loss 0.459240, Valid_loss 0.563856
Epoch 19, Train Loss 0.528458, Valid_loss 0.590273
Epoch 20, Train Loss 0.420265, Valid_loss 1.175537
Epoch 21, Train Loss 0.403888, Valid_loss 0.531229
Epoch 22, Train Loss 0.383237, Valid_loss 0.787517
Epoch 23, Train Loss 0.452772, Valid_loss 0.387061
Epoch 24, Train Loss 0.607277, Valid_loss 0.460917
Epoch 25, Train Loss 0.406915, Valid_loss 0.706903
Epoch 26, Train Loss 0.397158, Valid_loss 0.385716
Epoch 27, Train Loss 0.428201, Valid_loss 0.374410
Epoch 28, Train Loss 0.345297, Valid_loss 0.682746
Epoch 29, Train Loss 0.348905, Valid_loss 0.657290
Epoch 30, Train Loss 0.327317, Valid_loss 0.464120
Epoch 31, Train Loss 0.330204, Valid_loss 0.332629
Epoch 32, Train Loss 0.363414, Valid_loss 0.540301
Epoch 33, Train Loss 0.389039, Valid_loss 0.848181
Epoch 34, Train Loss 0.303375, Valid_loss 0.493106
Epoch 35, Train Loss 0.298106, Valid_loss 0.345591
Epoch 36, Train Loss 0.378221, Valid_loss 1.349098
Epoch 37, Train Loss 0.361709, Valid_loss 1.187540
Epoch 38, Train Loss 0.369163, Valid_loss 1.019194
Epoch 39, Train Loss 0.387662, Valid_loss 0.418067
Epoch 40, Train Loss 0.533540, Valid_loss 0.735416
Epoch 41, Train Loss 0.407729, Valid_loss 0.560655
Epoch 42, Train Loss 0.318134, Valid_loss 0.561570
Epoch 43, Train Loss 0.290435, Valid_loss 0.661455
Epoch 44, Train Loss 0.362310, Valid_loss 0.915756
Epoch 45, Train Loss 0.334495, Valid_loss 0.394395
Epoch 46, Train Loss 0.419566, Valid_loss 0.335458
Epoch 47, Train Loss 0.321991, Valid_loss 0.793601
Epoch 48, Train Loss 0.273008, Valid_loss 0.996929
Epoch 49, Train Loss 0.281381, Valid_loss 0.552745
Epoch 50, Train Loss 0.246476, Valid_loss 0.624049
Epoch 51, Train Loss 0.224047, Valid_loss 0.701429
Epoch 52, Train Loss 0.255219, Valid_loss 0.550188
Epoch 53, Train Loss 0.240224, Valid_loss 0.795232
Epoch 54, Train Loss 0.256179, Valid_loss 0.589631
Epoch 55, Train Loss 0.225518, Valid_loss 0.761238
Epoch 56, Train Loss 0.235387, Valid_loss 0.505272
Epoch 57, Train Loss 0.243879, Valid_loss 0.631542
Epoch 58, Train Loss 0.178053, Valid_loss 0.593188
Epoch 59, Train Loss 0.220649, Valid_loss 0.469345
Epoch 60, Train Loss 0.194283, Valid_loss 0.506541
Epoch 61, Train Loss 0.206169, Valid_loss 0.537031
[I 2025-08-31 09:26:28,891] Trial 1 finished with value: 0.33262909280269276 and parameters: {'learning_rate': 0.001, 'epochs': 100, 'heads': 4, 'dropout': 0.7, 'weight_decay': 0.0001, 'emb_dim': 64, 'augment_num': 100, 'pca': False}. Best is trial 1 with value: 0.33262909280269276.
👉 train samples(학습 샘플(bag))=140, batch_size=8 -> steps(샘플수/batch크기)=18
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 3187.70 MB
Memory Reserved: 3190.00 MB
cuda
Epoch 1, Train Loss 0.948059, Valid_loss 1.059385
Epoch 2, Train Loss 1.002353, Valid_loss 1.044439
Epoch 3, Train Loss 0.900993, Valid_loss 1.018231
Epoch 4, Train Loss 0.879567, Valid_loss 0.981019
Epoch 5, Train Loss 0.799619, Valid_loss 0.917340
Epoch 6, Train Loss 0.825680, Valid_loss 0.805350
Epoch 7, Train Loss 0.766402, Valid_loss 0.791779
Epoch 8, Train Loss 0.755151, Valid_loss 0.772900
Epoch 9, Train Loss 0.730169, Valid_loss 0.864165
Epoch 10, Train Loss 0.693429, Valid_loss 0.726517
Epoch 11, Train Loss 0.647895, Valid_loss 0.807924
Epoch 12, Train Loss 0.633281, Valid_loss 0.688658
Epoch 13, Train Loss 0.665541, Valid_loss 0.664734
Epoch 14, Train Loss 0.588641, Valid_loss 0.760232
Epoch 15, Train Loss 0.615669, Valid_loss 0.640866
Epoch 16, Train Loss 0.650295, Valid_loss 0.650391
Epoch 17, Train Loss 0.606719, Valid_loss 0.673618
Epoch 18, Train Loss 0.577612, Valid_loss 0.812881
Epoch 19, Train Loss 0.554866, Valid_loss 0.716442
Epoch 20, Train Loss 0.578417, Valid_loss 0.576796
Epoch 21, Train Loss 0.574641, Valid_loss 0.808832
Epoch 22, Train Loss 0.561386, Valid_loss 0.878671
Epoch 23, Train Loss 0.629085, Valid_loss 0.573029
Epoch 24, Train Loss 0.560000, Valid_loss 0.556637
Epoch 25, Train Loss 0.565261, Valid_loss 0.728284
Epoch 26, Train Loss 0.509619, Valid_loss 0.750936
Epoch 27, Train Loss 0.497757, Valid_loss 0.579903
Epoch 28, Train Loss 0.497861, Valid_loss 0.760877
Epoch 29, Train Loss 0.507813, Valid_loss 0.883055
Epoch 30, Train Loss 0.505540, Valid_loss 0.680237
Epoch 31, Train Loss 0.466677, Valid_loss 0.757257
Epoch 32, Train Loss 0.455516, Valid_loss 0.595982
Epoch 33, Train Loss 0.463720, Valid_loss 0.564579
Epoch 34, Train Loss 0.493325, Valid_loss 0.773163
Epoch 35, Train Loss 0.452967, Valid_loss 0.614991
Epoch 36, Train Loss 0.457505, Valid_loss 0.602670
Epoch 37, Train Loss 0.456186, Valid_loss 0.498434
Epoch 38, Train Loss 0.472155, Valid_loss 0.535498
Epoch 39, Train Loss 0.479705, Valid_loss 0.639410
Epoch 40, Train Loss 0.454509, Valid_loss 0.501931
Epoch 41, Train Loss 0.459293, Valid_loss 0.524375
Epoch 42, Train Loss 0.433589, Valid_loss 0.778493
Epoch 43, Train Loss 0.423496, Valid_loss 0.580486
Epoch 44, Train Loss 0.398756, Valid_loss 0.513124
Epoch 45, Train Loss 0.474480, Valid_loss 0.598553
Epoch 46, Train Loss 0.404970, Valid_loss 0.797007
Epoch 47, Train Loss 0.390480, Valid_loss 0.762358
Epoch 48, Train Loss 0.415067, Valid_loss 0.647906
Epoch 49, Train Loss 0.376567, Valid_loss 0.656266
Epoch 50, Train Loss 0.421832, Valid_loss 0.461232
Epoch 51, Train Loss 0.412566, Valid_loss 0.744669
Epoch 52, Train Loss 0.360500, Valid_loss 0.593588
Epoch 53, Train Loss 0.362530, Valid_loss 0.640596
Epoch 54, Train Loss 0.339734, Valid_loss 0.669212
[I 2025-08-31 09:35:45,352] Trial 2 finished with value: 0.4612322442588352 and parameters: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 2, 'dropout': 0.5, 'weight_decay': 0.001, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 1 with value: 0.33262909280269276.
선택된 trial params: {'learning_rate': 0.001, 'epochs': 100, 'heads': 4, 'dropout': 0.7, 'weight_decay': 0.0001, 'emb_dim': 64, 'augment_num': 100, 'pca': False}
👉 train samples(학습 샘플(bag))=140, batch_size=8 -> steps(샘플수/batch크기)=18
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=16, batch_size=1 -> steps=16
Memory Allocated: 3189.54 MB
Memory Reserved: 3208.00 MB
cuda
CUDA OOM 발생 — 단계적 백오프 시작.
[OOM RETRY] batch_size 8 → 8 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=140, batch_size=8 -> steps(샘플수/batch크기)=18
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=16, batch_size=1 -> steps=16
Memory Allocated: 4243.23 MB
Memory Reserved: 4260.00 MB
cuda
[OOM RETRY] batch_size=8에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 8 → 4 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=140, batch_size=4 -> steps(샘플수/batch크기)=35
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=16, batch_size=1 -> steps=16
Memory Allocated: 5296.91 MB
Memory Reserved: 5310.00 MB
cuda
Epoch 1, Train Loss 1.091500, Valid_loss 1.109998
Epoch 2, Train Loss 0.955980, Valid_loss 1.181500
Epoch 3, Train Loss 0.984066, Valid_loss 1.193979
Epoch 4, Train Loss 0.938377, Valid_loss 1.116974
Epoch 5, Train Loss 0.929615, Valid_loss 1.144309
Epoch 6, Train Loss 0.927865, Valid_loss 1.103803
Epoch 7, Train Loss 0.924280, Valid_loss 1.128981
Epoch 8, Train Loss 0.895027, Valid_loss 0.980642
Epoch 9, Train Loss 0.750640, Valid_loss 0.623465
Epoch 10, Train Loss 0.766888, Valid_loss 0.901246
Epoch 11, Train Loss 0.671919, Valid_loss 0.552779
Epoch 12, Train Loss 0.626450, Valid_loss 0.787762
Epoch 13, Train Loss 0.624470, Valid_loss 0.471904
Epoch 14, Train Loss 0.597943, Valid_loss 0.553948
Epoch 15, Train Loss 0.541797, Valid_loss 0.610858
Epoch 16, Train Loss 0.528841, Valid_loss 0.432125
Epoch 17, Train Loss 0.546827, Valid_loss 0.532871
Epoch 18, Train Loss 0.615651, Valid_loss 0.477306
Epoch 19, Train Loss 0.525122, Valid_loss 0.447505
Epoch 20, Train Loss 0.494015, Valid_loss 0.601249
Epoch 21, Train Loss 0.480405, Valid_loss 0.847144
Epoch 22, Train Loss 0.552081, Valid_loss 0.435137
Epoch 23, Train Loss 0.518298, Valid_loss 0.542463
Epoch 24, Train Loss 0.431792, Valid_loss 0.495090
Epoch 25, Train Loss 0.420494, Valid_loss 0.676413
Epoch 26, Train Loss 0.405736, Valid_loss 0.664368
Epoch 27, Train Loss 0.361097, Valid_loss 1.116213
Epoch 28, Train Loss 0.390599, Valid_loss 0.512659
Epoch 29, Train Loss 0.404071, Valid_loss 0.601647
Epoch 30, Train Loss 0.341103, Valid_loss 0.407498
Epoch 31, Train Loss 0.772425, Valid_loss 1.050006
Epoch 32, Train Loss 0.567728, Valid_loss 1.198868
Epoch 33, Train Loss 0.445943, Valid_loss 0.699495
Epoch 34, Train Loss 0.354157, Valid_loss 1.162902
Epoch 35, Train Loss 0.351871, Valid_loss 0.298169
Epoch 36, Train Loss 0.445712, Valid_loss 0.487007
Epoch 37, Train Loss 0.424380, Valid_loss 0.398727
Epoch 38, Train Loss 0.283882, Valid_loss 0.678482
Epoch 39, Train Loss 0.316953, Valid_loss 0.529479
Epoch 40, Train Loss 0.428348, Valid_loss 0.445164
Epoch 41, Train Loss 0.324676, Valid_loss 1.149248
Epoch 42, Train Loss 0.318648, Valid_loss 0.562124
Epoch 43, Train Loss 0.283459, Valid_loss 0.960046
Epoch 44, Train Loss 0.378368, Valid_loss 0.637870
Epoch 45, Train Loss 0.296334, Valid_loss 0.582845
Epoch 46, Train Loss 0.290302, Valid_loss 0.836740
Epoch 47, Train Loss 0.318387, Valid_loss 0.645113
Epoch 48, Train Loss 0.303499, Valid_loss 0.841079
Epoch 49, Train Loss 0.333877, Valid_loss 0.358630
Epoch 50, Train Loss 0.313518, Valid_loss 0.655416
Epoch 51, Train Loss 0.296121, Valid_loss 0.764821
Epoch 52, Train Loss 0.261846, Valid_loss 0.901695
환자ID=164-10 -- true: [[0]] -- pred: tensor([[ 3.6878, -2.2365, -4.9077]], device='cuda:0')
환자ID=28-12263 -- true: [[1]] -- pred: tensor([[-1.1225,  1.9249, -0.5046]], device='cuda:0')
환자ID=28-12381 -- true: [[1]] -- pred: tensor([[-0.7581,  2.0967, -0.8968]], device='cuda:0')
환자ID=29-10016 -- true: [[1]] -- pred: tensor([[ 0.1786,  1.7421, -1.9919]], device='cuda:0')
환자ID=29-10280 -- true: [[1]] -- pred: tensor([[-1.0929,  1.9126, -0.5152]], device='cuda:0')
환자ID=29-10404 -- true: [[1]] -- pred: tensor([[-1.7627,  1.4376,  0.3766]], device='cuda:0')
환자ID=30-10123 -- true: [[2]] -- pred: tensor([[-1.4793,  1.6771, -0.0203]], device='cuda:0')
환자ID=31-10000 -- true: [[1]] -- pred: tensor([[-1.3117,  1.7969, -0.2338]], device='cuda:0')
환자ID=31-10078 -- true: [[1]] -- pred: tensor([[-1.0153,  1.9697, -0.6031]], device='cuda:0')
환자ID=31-10236 -- true: [[1]] -- pred: tensor([[-1.0626,  1.9496, -0.5577]], device='cuda:0')
환자ID=32-10003 -- true: [[2]] -- pred: tensor([[-2.0368,  1.1650,  0.7898]], device='cuda:0')
환자ID=PRE018-1 -- true: [[0]] -- pred: tensor([[ 3.7201, -2.3369, -4.9166]], device='cuda:0')
환자ID=PRE027 -- true: [[0]] -- pred: tensor([[ 3.7139, -2.3143, -4.9122]], device='cuda:0')
환자ID=Sample1153-EO1 -- true: [[0]] -- pred: tensor([[ 3.7083, -2.3038, -4.9129]], device='cuda:0')
환자ID=Sample1158-EO1 -- true: [[0]] -- pred: tensor([[ 3.7188, -2.3329, -4.9166]], device='cuda:0')
환자ID=Sample1158-EO3 -- true: [[0]] -- pred: tensor([[ 3.7136, -2.3168, -4.9141]], device='cuda:0')
Best performance: Epoch 35, Loss 0.351871, Test ACC 0.875000, Test AUC 0.968750, Test Recall 0.666667, Test Precision 0.600000
Confusion Matrix:
 [[6 0 0]
 [0 8 0]
 [0 2 0]]
✅ Total valid splits used: 1
🔁 Repeat 3, Fold 1
cell type :  S2008000605HRT_AAACCCAGTGCACATT-1    Epithelial_cells
S2008000605HRT_AAACCCAGTGCCTACG-1    Epithelial_cells
S2008000605HRT_AAAGAACGTAGAGACC-1           Astrocyte
S2008000605HRT_AAAGAACGTCGGAACA-1    Epithelial_cells
S2008000605HRT_AAAGAACGTTAACAGA-1    Epithelial_cells
                                           ...       
Sample1162EO1_TTTCACAAGGGCAGAG-1            iPS_cells
Sample1162EO1_TTTCCTCAGCGTGCCT-1          Hepatocytes
Sample1162EO1_TTTCCTCAGTACTGTC-1     Epithelial_cells
Sample1162EO1_TTTGGTTTCCACATAG-1          Hepatocytes
Sample1162EO1_TTTGTTGCACACGCCA-1     Epithelial_cells
Name: singler_annotation, Length: 190037, dtype: string
cell type annotation :  S2008000605HRT_AAACCCAGTGCACATT-1    Epithelial_cells
S2008000605HRT_AAACCCAGTGCCTACG-1    Epithelial_cells
S2008000605HRT_AAAGAACGTAGAGACC-1           Astrocyte
S2008000605HRT_AAAGAACGTCGGAACA-1    Epithelial_cells
S2008000605HRT_AAAGAACGTTAACAGA-1    Epithelial_cells
                                           ...       
Sample1162EO1_TTTCACAAGGGCAGAG-1            iPS_cells
Sample1162EO1_TTTCCTCAGCGTGCCT-1          Hepatocytes
Sample1162EO1_TTTCCTCAGTACTGTC-1     Epithelial_cells
Sample1162EO1_TTTGGTTTCCACATAG-1          Hepatocytes
Sample1162EO1_TTTGTTGCACACGCCA-1     Epithelial_cells
Name: singler_annotation, Length: 190037, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Epithelial_cells', 'Astrocyte', 'MSC', 'Keratinocytes', 'Neurons', 'Endothelial_cells', 'Fibroblasts', 'Tissue_stem_cells', 'Smooth_muscle_cells', 'T_cells', 'Neuroepithelial_cell', 'NK_cell', 'Chondrocytes', 'Osteoblasts', 'Monocyte', 'Hepatocytes', 'Macrophage', 'CMP', 'Embryonic_stem_cells', 'DC', 'BM & Prog.', 'MEP', 'Neutrophils', 'Pro-Myelocyte', 'iPS_cells', 'Pre-B_cell_CD34-', 'HSC_-G-CSF', 'B_cell', 'GMP', 'HSC_CD34+', 'Platelets', 'Pro-B_cell_CD34+', 'Myelocyte', 'BM', 'Erythroblast', 'Unknown', 'Gametocytes']
라벨별 그룹 개수 {0: 21, 1: 29, 2: 11}
cell type :  S1903005471_AAACCCACAAACGTGG-1                 Astrocyte
S1903005471_AAACCCACAAGGGTCA-1      Embryonic_stem_cells
S1903005471_AAACCCAGTATGGTAA-1          Epithelial_cells
S1903005471_AAACGAACAAATAAGC-1         Endothelial_cells
S1903005471_AAACGAACAATAGTGA-1          Epithelial_cells
                                            ...         
Sample1162EO2_TTTGGAGAGCAGGCAT-1        Epithelial_cells
Sample1162EO2_TTTGGAGAGTCGCGAA-1       Endothelial_cells
Sample1162EO2_TTTGGAGAGTGCTCGC-1             Hepatocytes
Sample1162EO2_TTTGGAGGTGATACTC-1        Epithelial_cells
Sample1162EO2_TTTGGTTCAGTAGAAT-1        Epithelial_cells
Name: singler_annotation, Length: 35140, dtype: string
cell type annotation :  S1903005471_AAACCCACAAACGTGG-1                 Astrocyte
S1903005471_AAACCCACAAGGGTCA-1      Embryonic_stem_cells
S1903005471_AAACCCAGTATGGTAA-1          Epithelial_cells
S1903005471_AAACGAACAAATAAGC-1         Endothelial_cells
S1903005471_AAACGAACAATAGTGA-1          Epithelial_cells
                                            ...         
Sample1162EO2_TTTGGAGAGCAGGCAT-1        Epithelial_cells
Sample1162EO2_TTTGGAGAGTCGCGAA-1       Endothelial_cells
Sample1162EO2_TTTGGAGAGTGCTCGC-1             Hepatocytes
Sample1162EO2_TTTGGAGGTGATACTC-1        Epithelial_cells
Sample1162EO2_TTTGGTTCAGTAGAAT-1        Epithelial_cells
Name: singler_annotation, Length: 35140, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Astrocyte', 'Embryonic_stem_cells', 'Epithelial_cells', 'Endothelial_cells', 'Fibroblasts', 'Hepatocytes', 'Neurons', 'Monocyte', 'Smooth_muscle_cells', 'iPS_cells', 'B_cell', 'Neuroepithelial_cell', 'Keratinocytes', 'T_cells', 'MEP', 'Osteoblasts', 'HSC_-G-CSF', 'DC', 'Unknown', 'Pre-B_cell_CD34-', 'CMP', 'MSC', 'Macrophage', 'Chondrocytes', 'Erythroblast', 'BM', 'HSC_CD34+', 'GMP', 'BM & Prog.', 'NK_cell', 'Pro-Myelocyte', 'Tissue_stem_cells', 'Pro-B_cell_CD34+', 'Neutrophils', 'Myelocyte', 'Platelets', 'Gametocytes']
라벨별 그룹 개수 {1: 8, 2: 3, 0: 5}
🔍 Split #2
  → train_p_index 환자 수 (환자 단위로 묶인 index list): 61
  → test_p_index 환자 수  (환자 단위로 묶인 index list): 16
  → train 환자 ID: ['163-2', '163-3', '163-4', '163-5', '164-10', '164-3', '164-6', '165-9', '27-10053', '27-10071', '27-10112', '27-10119', '28-10051', '28-11515', '28-12263', '28-12381', '28-12490', '28-12518', '29-10006', '29-10008', '29-10010', '29-10011', '29-10012', '29-10013', '29-10016', '29-10280', '29-10380', '29-10398', '29-10400', '29-10404', '29-10406', '30-10018', '30-10034', '30-10123', '30-10125', '30-10929', '31-10000', '31-10013', '31-10078', '31-10154', '31-10210', '31-10236', '32-10003', '32-10034', '32-10074', '33-10005', '33-10006', '34-10050', 'PRE018-1', 'PRE019', 'PRE027', 'PRE038', 'PRE98sc', 'Sample1153-EO1', 'Sample1153-EO2', 'Sample1157-EO1', 'Sample1157-EO2', 'Sample1157-EO3', 'Sample1158-EO1', 'Sample1158-EO3', 'Sample1162-EO1']
  → test  환자 ID: ['27-10039', '27-10041', '29-10386', '29-10410', '30-11051', '31-10001', '31-10035', '31-10040', '31-10042', '34-10184', '34-10187', 'PRE055-1', 'PRE062-1', 'Sample1153-EO3', 'Sample1158-EO2', 'Sample1162-EO2']
  → train 환자 ID 및 라벨:
    ID: 163-2, Label: 0
    ID: 163-3, Label: 0
    ID: 163-4, Label: 0
    ID: 163-5, Label: 0
    ID: 164-10, Label: 0
    ID: 164-3, Label: 0
    ID: 164-6, Label: 0
    ID: 165-9, Label: 0
    ID: 27-10053, Label: 1
    ID: 27-10071, Label: 1
    ID: 27-10112, Label: 1
    ID: 27-10119, Label: 1
    ID: 28-10051, Label: 1
    ID: 28-11515, Label: 1
    ID: 28-12263, Label: 1
    ID: 28-12381, Label: 1
    ID: 28-12490, Label: 1
    ID: 28-12518, Label: 1
    ID: 29-10006, Label: 1
    ID: 29-10008, Label: 1
    ID: 29-10010, Label: 1
    ID: 29-10011, Label: 1
    ID: 29-10012, Label: 1
    ID: 29-10013, Label: 1
    ID: 29-10016, Label: 1
    ID: 29-10280, Label: 1
    ID: 29-10380, Label: 1
    ID: 29-10398, Label: 1
    ID: 29-10400, Label: 1
    ID: 29-10404, Label: 1
    ID: 29-10406, Label: 1
    ID: 30-10018, Label: 2
    ID: 30-10034, Label: 2
    ID: 30-10123, Label: 2
    ID: 30-10125, Label: 2
    ID: 30-10929, Label: 2
    ID: 31-10000, Label: 1
    ID: 31-10013, Label: 1
    ID: 31-10078, Label: 1
    ID: 31-10154, Label: 1
    ID: 31-10210, Label: 1
    ID: 31-10236, Label: 1
    ID: 32-10003, Label: 2
    ID: 32-10034, Label: 2
    ID: 32-10074, Label: 2
    ID: 33-10005, Label: 2
    ID: 33-10006, Label: 2
    ID: 34-10050, Label: 2
    ID: PRE018-1, Label: 0
    ID: PRE019, Label: 0
    ID: PRE027, Label: 0
    ID: PRE038, Label: 0
    ID: PRE98sc, Label: 0
    ID: Sample1153-EO1, Label: 0
    ID: Sample1153-EO2, Label: 0
    ID: Sample1157-EO1, Label: 0
    ID: Sample1157-EO2, Label: 0
    ID: Sample1157-EO3, Label: 0
    ID: Sample1158-EO1, Label: 0
    ID: Sample1158-EO3, Label: 0
    ID: Sample1162-EO1, Label: 0
  → test 환자 ID 및 라벨:
    ID: 27-10039, Label: 1
    ID: 27-10041, Label: 1
    ID: 29-10386, Label: 1
    ID: 29-10410, Label: 1
    ID: 30-11051, Label: 2
    ID: 31-10001, Label: 1
    ID: 31-10035, Label: 1
    ID: 31-10040, Label: 1
    ID: 31-10042, Label: 1
    ID: 34-10184, Label: 2
    ID: 34-10187, Label: 2
    ID: PRE055-1, Label: 0
    ID: PRE062-1, Label: 0
    ID: Sample1153-EO3, Label: 0
    ID: Sample1158-EO2, Label: 0
    ID: Sample1162-EO2, Label: 0
전체 데이터 index 길이 77
label_stat (train 환자 라벨 목록) 갯수 61
train_data에서 환자 단위로, train과 validation 나누기
기존 train_p_index 61
기존 (train) label_stat 61
train-vali 분할 후! 
train y 의 classes : {0, 1, 2} valid y 의 classes : {0, 1, 2} label_stat 의 classes : {0, 1, 2}
train_p_index_ 40
valid_p_index 21
test_p_index 16
→ train 환자 ID 및 라벨:
   총 개수: 40
   환자ID=29-10011, Label=1, 셀개수=3072
   환자ID=31-10078, Label=1, 셀개수=2827
   환자ID=Sample1153-EO2, Label=0, 셀개수=916
   환자ID=Sample1157-EO3, Label=0, 셀개수=807
   환자ID=31-10236, Label=1, 셀개수=3458
   환자ID=163-5, Label=0, 셀개수=1210
   환자ID=28-12518, Label=1, 셀개수=1215
   환자ID=PRE019, Label=0, 셀개수=3795
   환자ID=30-10123, Label=2, 셀개수=1273
   환자ID=30-10018, Label=2, 셀개수=5170
   환자ID=163-3, Label=0, 셀개수=1335
   환자ID=27-10119, Label=1, 셀개수=3346
   환자ID=164-6, Label=0, 셀개수=3038
   환자ID=165-9, Label=0, 셀개수=2926
   환자ID=163-2, Label=0, 셀개수=2535
   환자ID=29-10400, Label=1, 셀개수=2684
   환자ID=30-10929, Label=2, 셀개수=5812
   환자ID=29-10406, Label=1, 셀개수=3484
   환자ID=29-10013, Label=1, 셀개수=3706
   환자ID=30-10125, Label=2, 셀개수=3798
   환자ID=163-4, Label=0, 셀개수=1339
   환자ID=31-10210, Label=1, 셀개수=3510
   환자ID=PRE038, Label=0, 셀개수=2666
   환자ID=29-10380, Label=1, 셀개수=4799
   환자ID=28-11515, Label=1, 셀개수=930
   환자ID=Sample1158-EO3, Label=0, 셀개수=1096
   환자ID=31-10000, Label=1, 셀개수=8870
   환자ID=34-10050, Label=2, 셀개수=4784
   환자ID=27-10112, Label=1, 셀개수=1470
   환자ID=28-12490, Label=1, 셀개수=5973
   환자ID=28-10051, Label=1, 셀개수=300
   환자ID=164-3, Label=0, 셀개수=1639
   환자ID=29-10280, Label=1, 셀개수=2375
   환자ID=33-10005, Label=2, 셀개수=8904
   환자ID=29-10012, Label=1, 셀개수=6245
   환자ID=32-10034, Label=2, 셀개수=1555
   환자ID=32-10003, Label=2, 셀개수=2978
   환자ID=31-10154, Label=1, 셀개수=6568
   환자ID=29-10010, Label=1, 셀개수=5305
   환자ID=28-12381, Label=1, 셀개수=1099
→ valid 환자 ID 및 라벨:
   총 개수: 21
   환자ID=Sample1162-EO1, Label=0, 셀개수=1053
   환자ID=29-10008, Label=1, 셀개수=1913
   환자ID=31-10013, Label=1, 셀개수=3161
   환자ID=PRE98sc, Label=0, 셀개수=1568
   환자ID=Sample1157-EO2, Label=0, 셀개수=1395
   환자ID=PRE027, Label=0, 셀개수=2078
   환자ID=Sample1157-EO1, Label=0, 셀개수=1152
   환자ID=29-10404, Label=1, 셀개수=3988
   환자ID=30-10034, Label=2, 셀개수=1240
   환자ID=29-10398, Label=1, 셀개수=3993
   환자ID=Sample1158-EO1, Label=0, 셀개수=574
   환자ID=27-10071, Label=1, 셀개수=1478
   환자ID=29-10016, Label=1, 셀개수=4854
   환자ID=Sample1153-EO1, Label=0, 셀개수=911
   환자ID=33-10006, Label=2, 셀개수=457
   환자ID=PRE018-1, Label=0, 셀개수=1349
   환자ID=164-10, Label=0, 셀개수=4041
   환자ID=29-10006, Label=1, 셀개수=11461
   환자ID=27-10053, Label=1, 셀개수=728
   환자ID=28-12263, Label=1, 셀개수=7527
   환자ID=32-10074, Label=2, 셀개수=6304
→ test 환자 ID 및 라벨:
   총 개수: 16
   환자ID=27-10039, Label=1, 셀개수=4638
   환자ID=27-10041, Label=1, 셀개수=2145
   환자ID=29-10386, Label=1, 셀개수=802
   환자ID=29-10410, Label=1, 셀개수=2834
   환자ID=30-11051, Label=2, 셀개수=2454
   환자ID=31-10001, Label=1, 셀개수=1133
   환자ID=31-10035, Label=1, 셀개수=2974
   환자ID=31-10040, Label=1, 셀개수=4543
   환자ID=31-10042, Label=1, 셀개수=1222
   환자ID=34-10184, Label=2, 셀개수=2699
   환자ID=34-10187, Label=2, 셀개수=3739
   환자ID=PRE055-1, Label=0, 셀개수=597
   환자ID=PRE062-1, Label=0, 셀개수=907
   환자ID=Sample1153-EO3, Label=0, 셀개수=1516
   환자ID=Sample1158-EO2, Label=0, 셀개수=1427
   환자ID=Sample1162-EO2, Label=0, 셀개수=1510
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Epithelial_cells', 'Epithelial_cells', 'Astrocyte', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'MSC', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
전체 데이터 길이 225177
전체 cell type 길이 0          Epithelial_cells
1          Epithelial_cells
2                 Astrocyte
3          Epithelial_cells
4          Epithelial_cells
                ...        
225172     Epithelial_cells
225173    Endothelial_cells
225174          Hepatocytes
225175     Epithelial_cells
225176     Epithelial_cells
Length: 225177, dtype: string
cell type의 NaN 개수 체크 0
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:11,  8.71it/s]  2%|▏         | 2/100 [00:00<00:10,  9.23it/s]  3%|▎         | 3/100 [00:00<00:10,  9.51it/s]  4%|▍         | 4/100 [00:00<00:10,  9.17it/s]  5%|▌         | 5/100 [00:00<00:11,  8.53it/s]  6%|▌         | 6/100 [00:00<00:10,  8.61it/s]  7%|▋         | 7/100 [00:00<00:12,  7.66it/s]  8%|▊         | 8/100 [00:00<00:11,  8.12it/s]  9%|▉         | 9/100 [00:01<00:10,  8.57it/s] 10%|█         | 10/100 [00:01<00:10,  8.74it/s] 11%|█         | 11/100 [00:01<00:10,  8.44it/s] 12%|█▏        | 12/100 [00:01<00:09,  8.85it/s] 13%|█▎        | 13/100 [00:01<00:09,  8.94it/s] 14%|█▍        | 14/100 [00:01<00:10,  7.94it/s] 15%|█▌        | 15/100 [00:01<00:11,  7.71it/s] 16%|█▌        | 16/100 [00:01<00:10,  8.09it/s] 17%|█▋        | 17/100 [00:02<00:09,  8.42it/s] 18%|█▊        | 18/100 [00:02<00:09,  8.66it/s] 19%|█▉        | 19/100 [00:02<00:09,  8.80it/s] 20%|██        | 20/100 [00:02<00:09,  8.26it/s] 21%|██        | 21/100 [00:02<00:09,  8.62it/s] 22%|██▏       | 22/100 [00:02<00:09,  8.63it/s] 23%|██▎       | 23/100 [00:02<00:08,  8.87it/s] 24%|██▍       | 24/100 [00:02<00:08,  8.81it/s] 25%|██▌       | 25/100 [00:02<00:08,  8.86it/s] 26%|██▌       | 26/100 [00:03<00:08,  8.80it/s] 27%|██▋       | 27/100 [00:03<00:08,  8.65it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.78it/s] 29%|██▉       | 29/100 [00:03<00:10,  7.01it/s] 30%|███       | 30/100 [00:03<00:09,  7.53it/s] 31%|███       | 31/100 [00:03<00:08,  7.86it/s] 32%|███▏      | 32/100 [00:03<00:08,  8.20it/s] 33%|███▎      | 33/100 [00:03<00:09,  7.36it/s] 34%|███▍      | 34/100 [00:04<00:09,  7.24it/s] 35%|███▌      | 35/100 [00:04<00:08,  7.64it/s] 36%|███▌      | 36/100 [00:04<00:08,  7.72it/s] 37%|███▋      | 37/100 [00:04<00:07,  7.97it/s] 38%|███▊      | 38/100 [00:04<00:07,  8.25it/s] 39%|███▉      | 39/100 [00:04<00:07,  8.26it/s] 40%|████      | 40/100 [00:04<00:08,  7.33it/s] 41%|████      | 41/100 [00:04<00:07,  7.76it/s] 42%|████▏     | 42/100 [00:05<00:07,  8.11it/s] 43%|████▎     | 43/100 [00:05<00:07,  8.11it/s] 44%|████▍     | 44/100 [00:05<00:06,  8.12it/s] 45%|████▌     | 45/100 [00:05<00:06,  8.30it/s] 46%|████▌     | 46/100 [00:05<00:06,  8.42it/s] 47%|████▋     | 47/100 [00:05<00:06,  8.52it/s] 48%|████▊     | 48/100 [00:05<00:06,  8.64it/s] 49%|████▉     | 49/100 [00:05<00:06,  8.04it/s] 50%|█████     | 50/100 [00:06<00:06,  8.15it/s] 51%|█████     | 51/100 [00:06<00:05,  8.24it/s] 52%|█████▏    | 52/100 [00:06<00:06,  7.25it/s] 53%|█████▎    | 53/100 [00:06<00:06,  7.73it/s] 54%|█████▍    | 54/100 [00:06<00:05,  8.02it/s] 55%|█████▌    | 55/100 [00:06<00:05,  8.37it/s] 56%|█████▌    | 56/100 [00:06<00:05,  8.58it/s] 57%|█████▋    | 57/100 [00:06<00:05,  7.98it/s] 58%|█████▊    | 58/100 [00:07<00:05,  8.07it/s] 59%|█████▉    | 59/100 [00:07<00:05,  7.52it/s] 60%|██████    | 60/100 [00:07<00:05,  7.72it/s] 61%|██████    | 61/100 [00:07<00:04,  8.07it/s] 62%|██████▏   | 62/100 [00:07<00:04,  8.19it/s] 63%|██████▎   | 63/100 [00:07<00:04,  8.15it/s] 64%|██████▍   | 64/100 [00:07<00:04,  8.15it/s] 65%|██████▌   | 65/100 [00:07<00:04,  8.24it/s] 66%|██████▌   | 66/100 [00:08<00:04,  8.26it/s] 67%|██████▋   | 67/100 [00:08<00:04,  8.25it/s] 68%|██████▊   | 68/100 [00:08<00:03,  8.10it/s] 69%|██████▉   | 69/100 [00:08<00:03,  8.26it/s] 70%|███████   | 70/100 [00:08<00:03,  8.21it/s] 71%|███████   | 71/100 [00:08<00:03,  8.20it/s] 72%|███████▏  | 72/100 [00:08<00:03,  8.16it/s] 73%|███████▎  | 73/100 [00:08<00:03,  8.02it/s] 74%|███████▍  | 74/100 [00:09<00:03,  7.74it/s] 75%|███████▌  | 75/100 [00:09<00:03,  7.89it/s] 76%|███████▌  | 76/100 [00:09<00:03,  7.86it/s] 77%|███████▋  | 77/100 [00:09<00:02,  7.78it/s] 78%|███████▊  | 78/100 [00:09<00:02,  7.87it/s] 79%|███████▉  | 79/100 [00:09<00:02,  7.80it/s] 80%|████████  | 80/100 [00:09<00:02,  7.78it/s] 81%|████████  | 81/100 [00:09<00:02,  7.32it/s] 82%|████████▏ | 82/100 [00:10<00:02,  7.58it/s] 83%|████████▎ | 83/100 [00:10<00:02,  7.67it/s] 84%|████████▍ | 84/100 [00:10<00:02,  7.60it/s] 85%|████████▌ | 85/100 [00:10<00:02,  6.78it/s] 86%|████████▌ | 86/100 [00:10<00:02,  5.49it/s] 87%|████████▋ | 87/100 [00:10<00:02,  6.02it/s] 88%|████████▊ | 88/100 [00:11<00:01,  6.41it/s] 89%|████████▉ | 89/100 [00:11<00:01,  6.84it/s] 90%|█████████ | 90/100 [00:11<00:01,  7.14it/s] 91%|█████████ | 91/100 [00:11<00:01,  7.33it/s] 92%|█████████▏| 92/100 [00:11<00:01,  7.42it/s] 93%|█████████▎| 93/100 [00:11<00:00,  7.47it/s] 94%|█████████▍| 94/100 [00:11<00:00,  7.55it/s] 95%|█████████▌| 95/100 [00:12<00:00,  5.90it/s] 96%|█████████▌| 96/100 [00:12<00:00,  6.45it/s] 97%|█████████▋| 97/100 [00:12<00:00,  6.76it/s] 98%|█████████▊| 98/100 [00:12<00:00,  6.90it/s] 99%|█████████▉| 99/100 [00:12<00:00,  6.35it/s]100%|██████████| 100/100 [00:13<00:00,  4.64it/s]100%|██████████| 100/100 [00:13<00:00,  7.68it/s]
[I 2025-08-31 09:46:55,063] A new study created in memory with name: no-name-62864e18-08a2-4a95-a81b-6cb4f6bb8338
👉 train samples(학습 샘플(bag))=140, batch_size=8 -> steps(샘플수/batch크기)=18
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 26.13 MB
Memory Reserved: 36.00 MB
cuda
Epoch 1, Train Loss 0.949842, Valid_loss 1.037758
Epoch 2, Train Loss 0.856123, Valid_loss 1.069942
Epoch 3, Train Loss 0.857327, Valid_loss 1.058082
Epoch 4, Train Loss 0.850417, Valid_loss 0.973490
Epoch 5, Train Loss 0.747243, Valid_loss 0.710633
Epoch 6, Train Loss 0.567655, Valid_loss 0.536372
Epoch 7, Train Loss 0.498478, Valid_loss 0.437994
Epoch 8, Train Loss 0.488744, Valid_loss 0.555176
Epoch 9, Train Loss 0.400593, Valid_loss 0.489406
Epoch 10, Train Loss 0.505943, Valid_loss 0.548802
Epoch 11, Train Loss 0.450512, Valid_loss 0.744741
Epoch 12, Train Loss 0.479170, Valid_loss 0.528941
Epoch 13, Train Loss 0.411227, Valid_loss 0.450114
Epoch 14, Train Loss 0.360023, Valid_loss 0.423257
Epoch 15, Train Loss 0.417884, Valid_loss 0.439952
Epoch 16, Train Loss 0.309341, Valid_loss 0.424474
Epoch 17, Train Loss 0.294909, Valid_loss 0.507397
Epoch 18, Train Loss 0.281273, Valid_loss 0.381926
Epoch 19, Train Loss 0.236090, Valid_loss 0.464181
Epoch 20, Train Loss 0.280083, Valid_loss 0.433535
Epoch 21, Train Loss 0.266202, Valid_loss 0.551901
Epoch 22, Train Loss 0.260950, Valid_loss 0.491085
Epoch 23, Train Loss 0.266131, Valid_loss 0.447026
Epoch 24, Train Loss 0.262377, Valid_loss 0.381832
Epoch 25, Train Loss 0.253139, Valid_loss 0.397233
Epoch 26, Train Loss 0.190925, Valid_loss 0.427882
Epoch 27, Train Loss 0.227524, Valid_loss 0.414153
Epoch 28, Train Loss 0.453943, Valid_loss 0.404950
Epoch 29, Train Loss 0.319025, Valid_loss 0.381223
Epoch 30, Train Loss 0.203067, Valid_loss 0.478923
Epoch 31, Train Loss 0.215975, Valid_loss 0.520530
Epoch 32, Train Loss 0.182515, Valid_loss 0.448395
Epoch 33, Train Loss 0.174341, Valid_loss 0.520087
Epoch 34, Train Loss 0.165236, Valid_loss 0.366295
Epoch 35, Train Loss 0.195546, Valid_loss 0.397500
Epoch 36, Train Loss 0.171191, Valid_loss 0.411270
Epoch 37, Train Loss 0.182599, Valid_loss 0.464930
Epoch 38, Train Loss 0.174533, Valid_loss 0.417724
Epoch 39, Train Loss 0.217461, Valid_loss 0.393156
Epoch 40, Train Loss 0.273424, Valid_loss 0.458133
Epoch 41, Train Loss 0.162741, Valid_loss 0.438805
Epoch 42, Train Loss 0.189966, Valid_loss 0.454566
Epoch 43, Train Loss 0.144771, Valid_loss 0.473091
Epoch 44, Train Loss 0.173137, Valid_loss 0.406651
Epoch 45, Train Loss 0.144717, Valid_loss 0.401850
Epoch 46, Train Loss 0.148939, Valid_loss 0.382570
Epoch 47, Train Loss 0.196732, Valid_loss 0.418825
Epoch 48, Train Loss 0.152007, Valid_loss 0.449057
Epoch 49, Train Loss 0.152534, Valid_loss 0.488924
Epoch 50, Train Loss 0.129302, Valid_loss 0.413899
Epoch 51, Train Loss 0.124157, Valid_loss 0.399776
Epoch 52, Train Loss 0.208017, Valid_loss 0.409773
Epoch 53, Train Loss 0.128945, Valid_loss 0.403514
Epoch 54, Train Loss 0.118727, Valid_loss 0.453483
Epoch 55, Train Loss 0.124302, Valid_loss 0.397282
Epoch 56, Train Loss 0.150903, Valid_loss 0.451540
Epoch 57, Train Loss 0.236917, Valid_loss 0.636261
[I 2025-08-31 09:55:47,388] Trial 0 finished with value: 0.36629484097162884 and parameters: {'learning_rate': 0.001, 'epochs': 100, 'heads': 4, 'dropout': 0.0, 'weight_decay': 0.001, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.36629484097162884.
👉 train samples(학습 샘플(bag))=140, batch_size=8 -> steps(샘플수/batch크기)=18
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 27.97 MB
Memory Reserved: 36.00 MB
cuda
Epoch 1, Train Loss 0.965333, Valid_loss 1.156037
Epoch 2, Train Loss 0.920115, Valid_loss 1.108463
Epoch 3, Train Loss 0.903534, Valid_loss 1.113952
Epoch 4, Train Loss 0.883376, Valid_loss 1.060923
Epoch 5, Train Loss 0.881604, Valid_loss 1.055031
Epoch 6, Train Loss 0.895027, Valid_loss 1.127310
Epoch 7, Train Loss 0.882781, Valid_loss 1.064844
Epoch 8, Train Loss 0.876315, Valid_loss 1.060730
Epoch 9, Train Loss 0.875554, Valid_loss 1.101866
Epoch 10, Train Loss 0.892834, Valid_loss 1.079156
Epoch 11, Train Loss 0.871382, Valid_loss 1.164228
Epoch 12, Train Loss 0.908037, Valid_loss 1.123806
Epoch 13, Train Loss 0.898762, Valid_loss 1.098876
Epoch 14, Train Loss 0.870557, Valid_loss 1.100850
Epoch 15, Train Loss 0.866785, Valid_loss 1.008813
Epoch 16, Train Loss 0.900014, Valid_loss 1.038454
Epoch 17, Train Loss 0.891921, Valid_loss 1.019833
Epoch 18, Train Loss 0.884321, Valid_loss 1.086035
Epoch 19, Train Loss 0.871079, Valid_loss 1.061580
Epoch 20, Train Loss 0.875870, Valid_loss 1.068277
Epoch 21, Train Loss 0.870907, Valid_loss 1.123331
Epoch 22, Train Loss 0.870717, Valid_loss 1.079974
Epoch 23, Train Loss 0.877941, Valid_loss 1.064882
Epoch 24, Train Loss 0.885531, Valid_loss 1.096008
Epoch 25, Train Loss 0.867006, Valid_loss 1.108230
Epoch 26, Train Loss 0.866367, Valid_loss 1.144289
Epoch 27, Train Loss 0.846316, Valid_loss 1.046450
Epoch 28, Train Loss 0.837620, Valid_loss 0.987986
Epoch 29, Train Loss 0.785635, Valid_loss 1.314927
Epoch 30, Train Loss 0.947591, Valid_loss 1.043055
Epoch 31, Train Loss 0.900387, Valid_loss 1.057627
Epoch 32, Train Loss 0.875156, Valid_loss 1.053692
Epoch 33, Train Loss 0.872968, Valid_loss 1.079574
Epoch 34, Train Loss 0.868336, Valid_loss 1.091490
Epoch 35, Train Loss 0.863362, Valid_loss 1.099552
Epoch 36, Train Loss 0.885639, Valid_loss 1.056621
Epoch 37, Train Loss 0.863618, Valid_loss 1.113999
Epoch 38, Train Loss 0.889870, Valid_loss 1.131669
Epoch 39, Train Loss 0.865602, Valid_loss 1.095153
Epoch 40, Train Loss 0.862716, Valid_loss 1.143231
Epoch 41, Train Loss 0.875318, Valid_loss 1.071000
Epoch 42, Train Loss 0.860169, Valid_loss 1.173718
Epoch 43, Train Loss 0.872515, Valid_loss 1.064082
Epoch 44, Train Loss 0.838082, Valid_loss 0.904089
Epoch 45, Train Loss 0.884285, Valid_loss 1.069124
Epoch 46, Train Loss 0.869987, Valid_loss 1.115366
Epoch 47, Train Loss 0.893283, Valid_loss 1.128946
Epoch 48, Train Loss 0.890048, Valid_loss 1.076115
Epoch 49, Train Loss 0.866187, Valid_loss 1.108916
Epoch 50, Train Loss 0.866628, Valid_loss 1.090089
Epoch 51, Train Loss 0.785521, Valid_loss 1.403786
Epoch 52, Train Loss 0.948360, Valid_loss 1.150212
Epoch 53, Train Loss 0.876735, Valid_loss 1.106582
Epoch 54, Train Loss 0.862008, Valid_loss 1.129492
Epoch 55, Train Loss 0.862586, Valid_loss 1.113225
Epoch 56, Train Loss 0.855101, Valid_loss 1.126943
Epoch 57, Train Loss 0.859774, Valid_loss 1.145785
[I 2025-08-31 10:02:17,577] Trial 1 finished with value: 0.90408903218451 and parameters: {'learning_rate': 0.01, 'epochs': 100, 'heads': 2, 'dropout': 0.0, 'weight_decay': 0.001, 'emb_dim': 64, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.36629484097162884.
👉 train samples(학습 샘플(bag))=140, batch_size=8 -> steps(샘플수/batch크기)=18
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 27.97 MB
Memory Reserved: 36.00 MB
cuda
Epoch 1, Train Loss 0.971547, Valid_loss 1.201710
Epoch 2, Train Loss 0.925365, Valid_loss 1.098999
Epoch 3, Train Loss 0.896975, Valid_loss 1.031665
Epoch 4, Train Loss 0.883574, Valid_loss 1.152394
Epoch 5, Train Loss 0.930129, Valid_loss 1.018398
Epoch 6, Train Loss 0.879846, Valid_loss 1.071189
Epoch 7, Train Loss 0.946029, Valid_loss 1.085068
Epoch 8, Train Loss 0.893250, Valid_loss 1.034458
Epoch 9, Train Loss 0.899727, Valid_loss 1.090613
Epoch 10, Train Loss 0.874383, Valid_loss 1.066652
Epoch 11, Train Loss 0.892906, Valid_loss 1.055632
Epoch 12, Train Loss 0.879354, Valid_loss 1.098922
Epoch 13, Train Loss 0.874173, Valid_loss 1.050130
Epoch 14, Train Loss 0.877765, Valid_loss 1.085490
Epoch 15, Train Loss 0.878712, Valid_loss 1.045669
Epoch 16, Train Loss 0.882526, Valid_loss 1.096732
Epoch 17, Train Loss 0.882148, Valid_loss 1.033594
Epoch 18, Train Loss 0.879356, Valid_loss 1.072321
Epoch 19, Train Loss 0.887435, Valid_loss 1.129847
Epoch 20, Train Loss 0.882932, Valid_loss 1.037600
Epoch 21, Train Loss 0.900083, Valid_loss 1.101214
Epoch 22, Train Loss 0.884549, Valid_loss 1.053673
Epoch 23, Train Loss 0.889010, Valid_loss 1.044208
Epoch 24, Train Loss 0.875475, Valid_loss 1.067664
Epoch 25, Train Loss 0.879706, Valid_loss 1.089759
Epoch 26, Train Loss 0.876961, Valid_loss 1.078459
Epoch 27, Train Loss 0.872768, Valid_loss 1.091212
Epoch 28, Train Loss 0.871012, Valid_loss 1.070649
Epoch 29, Train Loss 0.901920, Valid_loss 1.028133
Epoch 30, Train Loss 0.947780, Valid_loss 1.018947
Epoch 31, Train Loss 0.907618, Valid_loss 1.034139
Epoch 32, Train Loss 0.880093, Valid_loss 1.057479
Epoch 33, Train Loss 0.880495, Valid_loss 1.077360
Epoch 34, Train Loss 0.874047, Valid_loss 1.055807
Epoch 35, Train Loss 0.878556, Valid_loss 1.075317
Epoch 36, Train Loss 0.879371, Valid_loss 1.067618
Epoch 37, Train Loss 0.870633, Valid_loss 1.064158
Epoch 38, Train Loss 0.876201, Valid_loss 1.061986
Epoch 39, Train Loss 0.876220, Valid_loss 1.049999
Epoch 40, Train Loss 0.863868, Valid_loss 1.115967
Epoch 41, Train Loss 0.879642, Valid_loss 1.061245
Epoch 42, Train Loss 0.877853, Valid_loss 1.083887
Epoch 43, Train Loss 0.870072, Valid_loss 1.065652
Epoch 44, Train Loss 0.867818, Valid_loss 1.055821
Epoch 45, Train Loss 0.866059, Valid_loss 1.098080
Epoch 46, Train Loss 0.875956, Valid_loss 1.060259
Epoch 47, Train Loss 0.870502, Valid_loss 1.081868
Epoch 48, Train Loss 0.869364, Valid_loss 1.061384
Epoch 49, Train Loss 0.878165, Valid_loss 1.110660
Epoch 50, Train Loss 0.898935, Valid_loss 1.051031
Epoch 51, Train Loss 0.866500, Valid_loss 1.099639
Epoch 52, Train Loss 0.865878, Valid_loss 1.092988
Epoch 53, Train Loss 0.866074, Valid_loss 1.099384
Epoch 54, Train Loss 0.863401, Valid_loss 1.087916
Epoch 55, Train Loss 0.872488, Valid_loss 1.095662
Epoch 56, Train Loss 0.865068, Valid_loss 1.081480
Epoch 57, Train Loss 0.863056, Valid_loss 1.090512
Epoch 58, Train Loss 0.867807, Valid_loss 1.106249
[I 2025-08-31 10:08:55,078] Trial 2 finished with value: 1.0183978080749512 and parameters: {'learning_rate': 0.01, 'epochs': 100, 'heads': 2, 'dropout': 0.0, 'weight_decay': 0.0001, 'emb_dim': 64, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.36629484097162884.
선택된 trial params: {'learning_rate': 0.001, 'epochs': 100, 'heads': 4, 'dropout': 0.0, 'weight_decay': 0.001, 'emb_dim': 32, 'augment_num': 100, 'pca': False}
👉 train samples(학습 샘플(bag))=140, batch_size=8 -> steps(샘플수/batch크기)=18
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=16, batch_size=1 -> steps=16
Memory Allocated: 26.13 MB
Memory Reserved: 36.00 MB
cuda
Epoch 1, Train Loss 0.835105, Valid_loss 0.766465
Epoch 2, Train Loss 0.693337, Valid_loss 0.539869
Epoch 3, Train Loss 0.610792, Valid_loss 0.695848
Epoch 4, Train Loss 0.509646, Valid_loss 0.578064
Epoch 5, Train Loss 0.449572, Valid_loss 0.427630
Epoch 6, Train Loss 0.506160, Valid_loss 0.466404
Epoch 7, Train Loss 0.454790, Valid_loss 0.545099
Epoch 8, Train Loss 0.390495, Valid_loss 0.429904
Epoch 9, Train Loss 0.402017, Valid_loss 0.430040
Epoch 10, Train Loss 0.438386, Valid_loss 0.533920
Epoch 11, Train Loss 0.367213, Valid_loss 0.381892
Epoch 12, Train Loss 0.394126, Valid_loss 0.389094
Epoch 13, Train Loss 0.301750, Valid_loss 0.404061
Epoch 14, Train Loss 0.280229, Valid_loss 0.376011
Epoch 15, Train Loss 0.275480, Valid_loss 0.345019
Epoch 16, Train Loss 0.357008, Valid_loss 0.478288
Epoch 17, Train Loss 0.413439, Valid_loss 0.568563
Epoch 18, Train Loss 0.232629, Valid_loss 0.533628
Epoch 19, Train Loss 0.294752, Valid_loss 0.336406
Epoch 20, Train Loss 0.232950, Valid_loss 0.360103
Epoch 21, Train Loss 0.232470, Valid_loss 0.400228
Epoch 22, Train Loss 0.264811, Valid_loss 0.666096
Epoch 23, Train Loss 0.293607, Valid_loss 0.547355
Epoch 24, Train Loss 0.235777, Valid_loss 0.347622
Epoch 25, Train Loss 0.205726, Valid_loss 0.399825
Epoch 26, Train Loss 0.172683, Valid_loss 0.373314
Epoch 27, Train Loss 0.183074, Valid_loss 0.387016
Epoch 28, Train Loss 0.189018, Valid_loss 0.517985
Epoch 29, Train Loss 0.197355, Valid_loss 0.581583
Epoch 30, Train Loss 0.178071, Valid_loss 0.522496
Epoch 31, Train Loss 0.244247, Valid_loss 0.548750
Epoch 32, Train Loss 0.299010, Valid_loss 0.711779
Epoch 33, Train Loss 0.340864, Valid_loss 0.520163
Epoch 34, Train Loss 0.206075, Valid_loss 0.399152
Epoch 35, Train Loss 0.193400, Valid_loss 0.446025
Epoch 36, Train Loss 0.187369, Valid_loss 0.598661
Epoch 37, Train Loss 0.184528, Valid_loss 0.451980
Epoch 38, Train Loss 0.227396, Valid_loss 0.553002
Epoch 39, Train Loss 0.224327, Valid_loss 0.601521
Epoch 40, Train Loss 0.212402, Valid_loss 0.426939
Epoch 41, Train Loss 0.161335, Valid_loss 0.424536
Epoch 42, Train Loss 0.179454, Valid_loss 0.400765
Epoch 43, Train Loss 0.119337, Valid_loss 0.462087
Epoch 44, Train Loss 0.261319, Valid_loss 0.581455
Epoch 45, Train Loss 0.206499, Valid_loss 0.755042
Epoch 46, Train Loss 0.219162, Valid_loss 0.472687
Epoch 47, Train Loss 0.167476, Valid_loss 0.462218
Epoch 48, Train Loss 0.171720, Valid_loss 0.419202
Epoch 49, Train Loss 0.239104, Valid_loss 0.672603
Epoch 50, Train Loss 0.188783, Valid_loss 0.608958
Epoch 51, Train Loss 0.138544, Valid_loss 0.434120
Epoch 52, Train Loss 0.130435, Valid_loss 0.436756
Epoch 53, Train Loss 0.144657, Valid_loss 0.523953
환자ID=27-10039 -- true: [[1]] -- pred: tensor([[-2.3036,  1.5226,  0.0557]], device='cuda:0')
환자ID=27-10041 -- true: [[1]] -- pred: tensor([[-1.6200,  2.0340, -1.3081]], device='cuda:0')
환자ID=29-10386 -- true: [[1]] -- pred: tensor([[ 0.0042,  1.0988, -2.3502]], device='cuda:0')
환자ID=29-10410 -- true: [[1]] -- pred: tensor([[-1.7503,  1.9831, -1.2114]], device='cuda:0')
환자ID=30-11051 -- true: [[2]] -- pred: tensor([[-2.4201,  1.3999, -0.0455]], device='cuda:0')
환자ID=31-10001 -- true: [[1]] -- pred: tensor([[-1.9959,  1.9066, -0.7354]], device='cuda:0')
환자ID=31-10035 -- true: [[1]] -- pred: tensor([[-1.8440,  1.8959, -0.8864]], device='cuda:0')
환자ID=31-10040 -- true: [[1]] -- pred: tensor([[-0.3428,  1.3985, -2.4054]], device='cuda:0')
환자ID=31-10042 -- true: [[1]] -- pred: tensor([[-1.9892,  1.9535, -0.8803]], device='cuda:0')
환자ID=34-10184 -- true: [[2]] -- pred: tensor([[-1.3220,  2.0196, -1.5260]], device='cuda:0')
환자ID=34-10187 -- true: [[2]] -- pred: tensor([[-2.3700,  1.2585,  0.2972]], device='cuda:0')
환자ID=PRE055-1 -- true: [[0]] -- pred: tensor([[ 2.5857, -1.5296, -3.5150]], device='cuda:0')
환자ID=PRE062-1 -- true: [[0]] -- pred: tensor([[ 2.5615, -1.3533, -3.5535]], device='cuda:0')
환자ID=Sample1153-EO3 -- true: [[0]] -- pred: tensor([[ 2.5948, -1.4672, -3.5428]], device='cuda:0')
환자ID=Sample1158-EO2 -- true: [[0]] -- pred: tensor([[ 2.6114, -1.4405, -3.5837]], device='cuda:0')
환자ID=Sample1162-EO2 -- true: [[0]] -- pred: tensor([[ 2.6096, -1.4034, -3.5709]], device='cuda:0')
Best performance: Epoch 19, Loss 0.294752, Test ACC 0.812500, Test AUC 0.902778, Test Recall 0.666667, Test Precision 0.575758
Confusion Matrix:
 [[5 0 0]
 [0 8 0]
 [0 3 0]]
✅ Total valid splits used: 2
🔁 Repeat 3, Fold 2
cell type :  S2008000605HRT_AAACCCAGTGCACATT-1     Epithelial_cells
S2008000605HRT_AAACCCAGTGCCTACG-1     Epithelial_cells
S2008000605HRT_AAAGAACGTAGAGACC-1            Astrocyte
S2008000605HRT_AAAGAACGTCGGAACA-1     Epithelial_cells
S2008000605HRT_AAAGAACGTTAACAGA-1     Epithelial_cells
                                           ...        
Sample1162EO2_TTTGGAGAGCAGGCAT-1      Epithelial_cells
Sample1162EO2_TTTGGAGAGTCGCGAA-1     Endothelial_cells
Sample1162EO2_TTTGGAGAGTGCTCGC-1           Hepatocytes
Sample1162EO2_TTTGGAGGTGATACTC-1      Epithelial_cells
Sample1162EO2_TTTGGTTCAGTAGAAT-1      Epithelial_cells
Name: singler_annotation, Length: 179426, dtype: string
cell type annotation :  S2008000605HRT_AAACCCAGTGCACATT-1     Epithelial_cells
S2008000605HRT_AAACCCAGTGCCTACG-1     Epithelial_cells
S2008000605HRT_AAAGAACGTAGAGACC-1            Astrocyte
S2008000605HRT_AAAGAACGTCGGAACA-1     Epithelial_cells
S2008000605HRT_AAAGAACGTTAACAGA-1     Epithelial_cells
                                           ...        
Sample1162EO2_TTTGGAGAGCAGGCAT-1      Epithelial_cells
Sample1162EO2_TTTGGAGAGTCGCGAA-1     Endothelial_cells
Sample1162EO2_TTTGGAGAGTGCTCGC-1           Hepatocytes
Sample1162EO2_TTTGGAGGTGATACTC-1      Epithelial_cells
Sample1162EO2_TTTGGTTCAGTAGAAT-1      Epithelial_cells
Name: singler_annotation, Length: 179426, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Epithelial_cells', 'Astrocyte', 'MSC', 'Keratinocytes', 'Neurons', 'Endothelial_cells', 'Fibroblasts', 'Tissue_stem_cells', 'Smooth_muscle_cells', 'T_cells', 'Neuroepithelial_cell', 'NK_cell', 'Chondrocytes', 'Osteoblasts', 'Monocyte', 'Hepatocytes', 'Macrophage', 'CMP', 'Embryonic_stem_cells', 'DC', 'BM & Prog.', 'MEP', 'Neutrophils', 'Pro-Myelocyte', 'iPS_cells', 'Pre-B_cell_CD34-', 'HSC_-G-CSF', 'B_cell', 'GMP', 'HSC_CD34+', 'Platelets', 'Pro-B_cell_CD34+', 'Myelocyte', 'BM', 'Erythroblast', 'Unknown', 'Gametocytes']
라벨별 그룹 개수 {0: 21, 1: 30, 2: 11}
cell type :  S2008000651HRT_AAACCCACAGAGTGTG-1             T_cells
S2008000651HRT_AAACCCACATGACTGT-1             T_cells
S2008000651HRT_AAACGAAGTTAATCGC-1         Fibroblasts
S2008000651HRT_AAACGCTAGGCTTAAA-1             T_cells
S2008000651HRT_AAAGAACAGGAACTCG-1             T_cells
                                           ...       
Sample1157EO1_TTTGGTTAGCTGTTCA-1     Epithelial_cells
Sample1157EO1_TTTGGTTTCGTTGTTT-1            Astrocyte
Sample1157EO1_TTTGGTTTCTCGACCT-1                  GMP
Sample1157EO1_TTTGTTGAGCCTTCTC-1         Chondrocytes
Sample1157EO1_TTTGTTGGTGTAGCAG-1     Epithelial_cells
Name: singler_annotation, Length: 45751, dtype: string
cell type annotation :  S2008000651HRT_AAACCCACAGAGTGTG-1             T_cells
S2008000651HRT_AAACCCACATGACTGT-1             T_cells
S2008000651HRT_AAACGAAGTTAATCGC-1         Fibroblasts
S2008000651HRT_AAACGCTAGGCTTAAA-1             T_cells
S2008000651HRT_AAAGAACAGGAACTCG-1             T_cells
                                           ...       
Sample1157EO1_TTTGGTTAGCTGTTCA-1     Epithelial_cells
Sample1157EO1_TTTGGTTTCGTTGTTT-1            Astrocyte
Sample1157EO1_TTTGGTTTCTCGACCT-1                  GMP
Sample1157EO1_TTTGTTGAGCCTTCTC-1         Chondrocytes
Sample1157EO1_TTTGTTGGTGTAGCAG-1     Epithelial_cells
Name: singler_annotation, Length: 45751, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['T_cells', 'Fibroblasts', 'B_cell', 'Macrophage', 'Pre-B_cell_CD34-', 'NK_cell', 'Endothelial_cells', 'Chondrocytes', 'HSC_-G-CSF', 'CMP', 'Monocyte', 'Smooth_muscle_cells', 'DC', 'BM', 'Tissue_stem_cells', 'Platelets', 'GMP', 'Neutrophils', 'Epithelial_cells', 'HSC_CD34+', 'MSC', 'Pro-Myelocyte', 'iPS_cells', 'Pro-B_cell_CD34+', 'Neurons', 'Myelocyte', 'Osteoblasts', 'Hepatocytes', 'Astrocyte', 'Neuroepithelial_cell', 'Embryonic_stem_cells', 'Keratinocytes', 'MEP', 'Gametocytes', 'BM & Prog.', 'Erythroblast', 'Unknown']
라벨별 그룹 개수 {0: 5, 1: 7, 2: 3}
🔍 Split #3
  → train_p_index 환자 수 (환자 단위로 묶인 index list): 62
  → test_p_index 환자 수  (환자 단위로 묶인 index list): 15
  → train 환자 ID: ['163-2', '163-3', '164-10', '164-3', '164-6', '27-10039', '27-10041', '27-10053', '27-10071', '27-10119', '28-10051', '28-12263', '28-12381', '28-12490', '28-12518', '29-10006', '29-10012', '29-10013', '29-10016', '29-10280', '29-10380', '29-10386', '29-10398', '29-10400', '29-10404', '29-10410', '30-10034', '30-10123', '30-10929', '30-11051', '31-10000', '31-10001', '31-10013', '31-10035', '31-10040', '31-10042', '31-10078', '31-10154', '31-10236', '32-10003', '32-10034', '32-10074', '33-10006', '34-10050', '34-10184', '34-10187', 'PRE018-1', 'PRE019', 'PRE027', 'PRE038', 'PRE055-1', 'PRE062-1', 'Sample1153-EO1', 'Sample1153-EO2', 'Sample1153-EO3', 'Sample1157-EO2', 'Sample1157-EO3', 'Sample1158-EO1', 'Sample1158-EO2', 'Sample1158-EO3', 'Sample1162-EO1', 'Sample1162-EO2']
  → test  환자 ID: ['163-4', '163-5', '165-9', '27-10112', '28-11515', '29-10008', '29-10010', '29-10011', '29-10406', '30-10018', '30-10125', '31-10210', '33-10005', 'PRE98sc', 'Sample1157-EO1']
  → train 환자 ID 및 라벨:
    ID: 163-2, Label: 0
    ID: 163-3, Label: 0
    ID: 164-10, Label: 0
    ID: 164-3, Label: 0
    ID: 164-6, Label: 0
    ID: 27-10039, Label: 1
    ID: 27-10041, Label: 1
    ID: 27-10053, Label: 1
    ID: 27-10071, Label: 1
    ID: 27-10119, Label: 1
    ID: 28-10051, Label: 1
    ID: 28-12263, Label: 1
    ID: 28-12381, Label: 1
    ID: 28-12490, Label: 1
    ID: 28-12518, Label: 1
    ID: 29-10006, Label: 1
    ID: 29-10012, Label: 1
    ID: 29-10013, Label: 1
    ID: 29-10016, Label: 1
    ID: 29-10280, Label: 1
    ID: 29-10380, Label: 1
    ID: 29-10386, Label: 1
    ID: 29-10398, Label: 1
    ID: 29-10400, Label: 1
    ID: 29-10404, Label: 1
    ID: 29-10410, Label: 1
    ID: 30-10034, Label: 2
    ID: 30-10123, Label: 2
    ID: 30-10929, Label: 2
    ID: 30-11051, Label: 2
    ID: 31-10000, Label: 1
    ID: 31-10001, Label: 1
    ID: 31-10013, Label: 1
    ID: 31-10035, Label: 1
    ID: 31-10040, Label: 1
    ID: 31-10042, Label: 1
    ID: 31-10078, Label: 1
    ID: 31-10154, Label: 1
    ID: 31-10236, Label: 1
    ID: 32-10003, Label: 2
    ID: 32-10034, Label: 2
    ID: 32-10074, Label: 2
    ID: 33-10006, Label: 2
    ID: 34-10050, Label: 2
    ID: 34-10184, Label: 2
    ID: 34-10187, Label: 2
    ID: PRE018-1, Label: 0
    ID: PRE019, Label: 0
    ID: PRE027, Label: 0
    ID: PRE038, Label: 0
    ID: PRE055-1, Label: 0
    ID: PRE062-1, Label: 0
    ID: Sample1153-EO1, Label: 0
    ID: Sample1153-EO2, Label: 0
    ID: Sample1153-EO3, Label: 0
    ID: Sample1157-EO2, Label: 0
    ID: Sample1157-EO3, Label: 0
    ID: Sample1158-EO1, Label: 0
    ID: Sample1158-EO2, Label: 0
    ID: Sample1158-EO3, Label: 0
    ID: Sample1162-EO1, Label: 0
    ID: Sample1162-EO2, Label: 0
  → test 환자 ID 및 라벨:
    ID: 163-4, Label: 0
    ID: 163-5, Label: 0
    ID: 165-9, Label: 0
    ID: 27-10112, Label: 1
    ID: 28-11515, Label: 1
    ID: 29-10008, Label: 1
    ID: 29-10010, Label: 1
    ID: 29-10011, Label: 1
    ID: 29-10406, Label: 1
    ID: 30-10018, Label: 2
    ID: 30-10125, Label: 2
    ID: 31-10210, Label: 1
    ID: 33-10005, Label: 2
    ID: PRE98sc, Label: 0
    ID: Sample1157-EO1, Label: 0
전체 데이터 index 길이 77
label_stat (train 환자 라벨 목록) 갯수 62
train_data에서 환자 단위로, train과 validation 나누기
기존 train_p_index 62
기존 (train) label_stat 62
train-vali 분할 후! 
train y 의 classes : {0, 1, 2} valid y 의 classes : {0, 1, 2} label_stat 의 classes : {0, 1, 2}
train_p_index_ 41
valid_p_index 21
test_p_index 15
→ train 환자 ID 및 라벨:
   총 개수: 41
   환자ID=29-10386, Label=1, 셀개수=802
   환자ID=31-10236, Label=1, 셀개수=3458
   환자ID=PRE018-1, Label=0, 셀개수=1349
   환자ID=32-10074, Label=2, 셀개수=6304
   환자ID=Sample1158-EO2, Label=0, 셀개수=1427
   환자ID=164-3, Label=0, 셀개수=1639
   환자ID=29-10013, Label=1, 셀개수=3706
   환자ID=PRE055-1, Label=0, 셀개수=597
   환자ID=31-10035, Label=1, 셀개수=2974
   환자ID=31-10001, Label=1, 셀개수=1133
   환자ID=163-3, Label=0, 셀개수=1335
   환자ID=28-12263, Label=1, 셀개수=7527
   환자ID=27-10041, Label=1, 셀개수=2145
   환자ID=27-10053, Label=1, 셀개수=728
   환자ID=163-2, Label=0, 셀개수=2535
   환자ID=30-10929, Label=2, 셀개수=5812
   환자ID=31-10042, Label=1, 셀개수=1222
   환자ID=31-10000, Label=1, 셀개수=8870
   환자ID=Sample1158-EO3, Label=0, 셀개수=1096
   환자ID=29-10400, Label=1, 셀개수=2684
   환자ID=31-10040, Label=1, 셀개수=4543
   환자ID=164-10, Label=0, 셀개수=4041
   환자ID=32-10034, Label=2, 셀개수=1555
   환자ID=Sample1153-EO1, Label=0, 셀개수=911
   환자ID=30-10034, Label=2, 셀개수=1240
   환자ID=28-12490, Label=1, 셀개수=5973
   환자ID=Sample1162-EO1, Label=0, 셀개수=1053
   환자ID=31-10078, Label=1, 셀개수=2827
   환자ID=PRE019, Label=0, 셀개수=3795
   환자ID=28-10051, Label=1, 셀개수=300
   환자ID=29-10012, Label=1, 셀개수=6245
   환자ID=28-12381, Label=1, 셀개수=1099
   환자ID=27-10039, Label=1, 셀개수=4638
   환자ID=29-10410, Label=1, 셀개수=2834
   환자ID=34-10187, Label=2, 셀개수=3739
   환자ID=29-10398, Label=1, 셀개수=3993
   환자ID=34-10050, Label=2, 셀개수=4784
   환자ID=33-10006, Label=2, 셀개수=457
   환자ID=32-10003, Label=2, 셀개수=2978
   환자ID=29-10380, Label=1, 셀개수=4799
   환자ID=29-10006, Label=1, 셀개수=11461
→ valid 환자 ID 및 라벨:
   총 개수: 21
   환자ID=Sample1162-EO2, Label=0, 셀개수=1510
   환자ID=29-10280, Label=1, 셀개수=2375
   환자ID=31-10154, Label=1, 셀개수=6568
   환자ID=Sample1153-EO2, Label=0, 셀개수=916
   환자ID=34-10184, Label=2, 셀개수=2699
   환자ID=PRE062-1, Label=0, 셀개수=907
   환자ID=Sample1157-EO3, Label=0, 셀개수=807
   환자ID=30-11051, Label=2, 셀개수=2454
   환자ID=31-10013, Label=1, 셀개수=3161
   환자ID=30-10123, Label=2, 셀개수=1273
   환자ID=Sample1158-EO1, Label=0, 셀개수=574
   환자ID=27-10119, Label=1, 셀개수=3346
   환자ID=29-10404, Label=1, 셀개수=3988
   환자ID=Sample1153-EO3, Label=0, 셀개수=1516
   환자ID=PRE038, Label=0, 셀개수=2666
   환자ID=PRE027, Label=0, 셀개수=2078
   환자ID=164-6, Label=0, 셀개수=3038
   환자ID=29-10016, Label=1, 셀개수=4854
   환자ID=27-10071, Label=1, 셀개수=1478
   환자ID=28-12518, Label=1, 셀개수=1215
   환자ID=Sample1157-EO2, Label=0, 셀개수=1395
→ test 환자 ID 및 라벨:
   총 개수: 15
   환자ID=163-4, Label=0, 셀개수=1339
   환자ID=163-5, Label=0, 셀개수=1210
   환자ID=165-9, Label=0, 셀개수=2926
   환자ID=27-10112, Label=1, 셀개수=1470
   환자ID=28-11515, Label=1, 셀개수=930
   환자ID=29-10008, Label=1, 셀개수=1913
   환자ID=29-10010, Label=1, 셀개수=5305
   환자ID=29-10011, Label=1, 셀개수=3072
   환자ID=29-10406, Label=1, 셀개수=3484
   환자ID=30-10018, Label=2, 셀개수=5170
   환자ID=30-10125, Label=2, 셀개수=3798
   환자ID=31-10210, Label=1, 셀개수=3510
   환자ID=33-10005, Label=2, 셀개수=8904
   환자ID=PRE98sc, Label=0, 셀개수=1568
   환자ID=Sample1157-EO1, Label=0, 셀개수=1152
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Epithelial_cells', 'Epithelial_cells', 'Astrocyte', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'MSC', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
전체 데이터 길이 225177
전체 cell type 길이 0         Epithelial_cells
1         Epithelial_cells
2                Astrocyte
3         Epithelial_cells
4         Epithelial_cells
                ...       
225172    Epithelial_cells
225173           Astrocyte
225174                 GMP
225175        Chondrocytes
225176    Epithelial_cells
Length: 225177, dtype: string
cell type의 NaN 개수 체크 0
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:10,  9.36it/s]  2%|▏         | 2/100 [00:00<00:11,  8.36it/s]  4%|▍         | 4/100 [00:00<00:10,  9.35it/s]  6%|▌         | 6/100 [00:00<00:09,  9.87it/s]  7%|▋         | 7/100 [00:00<00:09,  9.77it/s]  8%|▊         | 8/100 [00:00<00:09,  9.64it/s] 10%|█         | 10/100 [00:01<00:09,  9.64it/s] 11%|█         | 11/100 [00:01<00:09,  9.56it/s] 12%|█▏        | 12/100 [00:01<00:09,  9.57it/s] 13%|█▎        | 13/100 [00:01<00:09,  9.61it/s] 15%|█▌        | 15/100 [00:01<00:08,  9.78it/s] 16%|█▌        | 16/100 [00:01<00:08,  9.80it/s] 17%|█▋        | 17/100 [00:01<00:08,  9.84it/s] 18%|█▊        | 18/100 [00:01<00:08,  9.61it/s] 19%|█▉        | 19/100 [00:01<00:08,  9.38it/s] 20%|██        | 20/100 [00:02<00:08,  9.21it/s] 21%|██        | 21/100 [00:02<00:08,  9.41it/s] 22%|██▏       | 22/100 [00:02<00:08,  9.22it/s] 23%|██▎       | 23/100 [00:02<00:08,  9.37it/s] 24%|██▍       | 24/100 [00:02<00:08,  9.16it/s] 25%|██▌       | 25/100 [00:02<00:09,  8.29it/s] 26%|██▌       | 26/100 [00:02<00:08,  8.51it/s] 28%|██▊       | 28/100 [00:02<00:07,  9.06it/s] 29%|██▉       | 29/100 [00:03<00:07,  9.11it/s] 30%|███       | 30/100 [00:03<00:07,  9.19it/s] 31%|███       | 31/100 [00:03<00:07,  9.36it/s] 32%|███▏      | 32/100 [00:03<00:07,  9.22it/s] 33%|███▎      | 33/100 [00:03<00:07,  9.27it/s] 34%|███▍      | 34/100 [00:03<00:07,  9.28it/s] 35%|███▌      | 35/100 [00:03<00:07,  8.56it/s] 36%|███▌      | 36/100 [00:03<00:07,  8.73it/s] 37%|███▋      | 37/100 [00:04<00:07,  7.99it/s] 38%|███▊      | 38/100 [00:04<00:07,  8.38it/s] 39%|███▉      | 39/100 [00:04<00:07,  8.40it/s] 40%|████      | 40/100 [00:04<00:06,  8.75it/s] 41%|████      | 41/100 [00:04<00:06,  9.01it/s] 42%|████▏     | 42/100 [00:04<00:06,  9.28it/s] 43%|████▎     | 43/100 [00:04<00:06,  9.37it/s] 44%|████▍     | 44/100 [00:04<00:06,  9.29it/s] 45%|████▌     | 45/100 [00:04<00:05,  9.23it/s] 46%|████▌     | 46/100 [00:04<00:05,  9.26it/s] 47%|████▋     | 47/100 [00:05<00:07,  6.91it/s] 48%|████▊     | 48/100 [00:05<00:07,  7.34it/s] 49%|████▉     | 49/100 [00:05<00:06,  7.74it/s] 50%|█████     | 50/100 [00:05<00:06,  8.08it/s] 51%|█████     | 51/100 [00:05<00:05,  8.27it/s] 52%|█████▏    | 52/100 [00:05<00:06,  8.00it/s] 53%|█████▎    | 53/100 [00:05<00:05,  8.31it/s] 54%|█████▍    | 54/100 [00:06<00:05,  8.32it/s] 55%|█████▌    | 55/100 [00:06<00:05,  8.53it/s] 56%|█████▌    | 56/100 [00:06<00:05,  8.70it/s] 57%|█████▋    | 57/100 [00:06<00:04,  8.96it/s] 58%|█████▊    | 58/100 [00:06<00:04,  8.91it/s] 59%|█████▉    | 59/100 [00:06<00:04,  8.88it/s] 60%|██████    | 60/100 [00:06<00:04,  8.87it/s] 61%|██████    | 61/100 [00:06<00:04,  8.88it/s] 62%|██████▏   | 62/100 [00:06<00:04,  8.72it/s] 63%|██████▎   | 63/100 [00:07<00:04,  8.42it/s] 64%|██████▍   | 64/100 [00:07<00:04,  8.18it/s] 65%|██████▌   | 65/100 [00:07<00:04,  8.19it/s] 66%|██████▌   | 66/100 [00:07<00:04,  8.29it/s] 67%|██████▋   | 67/100 [00:07<00:03,  8.44it/s] 68%|██████▊   | 68/100 [00:07<00:03,  8.54it/s] 69%|██████▉   | 69/100 [00:07<00:03,  8.47it/s] 70%|███████   | 70/100 [00:07<00:03,  8.56it/s] 71%|███████   | 71/100 [00:08<00:03,  8.52it/s] 72%|███████▏  | 72/100 [00:08<00:03,  8.45it/s] 73%|███████▎  | 73/100 [00:08<00:03,  8.54it/s] 74%|███████▍  | 74/100 [00:08<00:03,  8.60it/s] 75%|███████▌  | 75/100 [00:08<00:02,  8.77it/s] 76%|███████▌  | 76/100 [00:08<00:02,  8.99it/s] 77%|███████▋  | 77/100 [00:08<00:02,  8.57it/s] 78%|███████▊  | 78/100 [00:08<00:02,  8.35it/s] 79%|███████▉  | 79/100 [00:08<00:02,  8.32it/s] 80%|████████  | 80/100 [00:09<00:02,  8.33it/s] 81%|████████  | 81/100 [00:09<00:02,  8.27it/s] 82%|████████▏ | 82/100 [00:09<00:02,  8.37it/s] 83%|████████▎ | 83/100 [00:09<00:02,  8.33it/s] 84%|████████▍ | 84/100 [00:09<00:01,  8.16it/s] 85%|████████▌ | 85/100 [00:09<00:01,  8.29it/s] 86%|████████▌ | 86/100 [00:09<00:01,  8.27it/s] 87%|████████▋ | 87/100 [00:09<00:01,  7.75it/s] 88%|████████▊ | 88/100 [00:10<00:01,  7.51it/s] 89%|████████▉ | 89/100 [00:10<00:01,  7.78it/s] 90%|█████████ | 90/100 [00:10<00:01,  7.77it/s] 91%|█████████ | 91/100 [00:10<00:01,  7.91it/s] 92%|█████████▏| 92/100 [00:10<00:00,  8.02it/s] 93%|█████████▎| 93/100 [00:10<00:00,  8.00it/s] 94%|█████████▍| 94/100 [00:10<00:00,  7.95it/s] 95%|█████████▌| 95/100 [00:10<00:00,  8.19it/s] 96%|█████████▌| 96/100 [00:11<00:00,  8.33it/s] 97%|█████████▋| 97/100 [00:11<00:00,  8.33it/s] 98%|█████████▊| 98/100 [00:11<00:00,  8.36it/s] 99%|█████████▉| 99/100 [00:11<00:00,  8.45it/s]100%|██████████| 100/100 [00:11<00:00,  8.48it/s]100%|██████████| 100/100 [00:11<00:00,  8.67it/s]
[I 2025-08-31 10:17:19,485] A new study created in memory with name: no-name-3a97092d-1a1a-4ed7-bc16-ea7f853ed0f0
👉 train samples(학습 샘플(bag))=141, batch_size=8 -> steps(샘플수/batch크기)=18
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 26.13 MB
Memory Reserved: 36.00 MB
cuda
Epoch 1, Train Loss 1.159641, Valid_loss 0.993504
Epoch 2, Train Loss 1.065149, Valid_loss 0.978546
Epoch 3, Train Loss 1.037783, Valid_loss 0.960818
Epoch 4, Train Loss 0.913973, Valid_loss 0.926173
Epoch 5, Train Loss 0.880017, Valid_loss 0.913492
Epoch 6, Train Loss 0.878232, Valid_loss 0.845778
Epoch 7, Train Loss 0.818616, Valid_loss 0.823019
Epoch 8, Train Loss 0.842244, Valid_loss 0.772623
Epoch 9, Train Loss 0.823583, Valid_loss 0.727946
Epoch 10, Train Loss 0.835051, Valid_loss 0.748575
Epoch 11, Train Loss 0.758951, Valid_loss 0.732859
Epoch 12, Train Loss 0.698226, Valid_loss 0.762300
Epoch 13, Train Loss 0.747340, Valid_loss 0.686673
Epoch 14, Train Loss 0.690061, Valid_loss 0.640728
Epoch 15, Train Loss 0.687794, Valid_loss 0.612473
Epoch 16, Train Loss 0.762267, Valid_loss 0.688255
Epoch 17, Train Loss 0.665883, Valid_loss 0.699316
Epoch 18, Train Loss 0.705536, Valid_loss 0.665159
Epoch 19, Train Loss 0.618071, Valid_loss 0.586322
Epoch 20, Train Loss 0.717357, Valid_loss 0.761495
Epoch 21, Train Loss 0.655549, Valid_loss 0.557671
Epoch 22, Train Loss 0.672504, Valid_loss 0.697348
Epoch 23, Train Loss 0.568017, Valid_loss 0.633175
Epoch 24, Train Loss 0.674242, Valid_loss 0.545578
Epoch 25, Train Loss 0.607793, Valid_loss 0.650815
Epoch 26, Train Loss 0.616608, Valid_loss 0.568371
Epoch 27, Train Loss 0.606229, Valid_loss 0.743193
Epoch 28, Train Loss 0.542234, Valid_loss 0.557307
Epoch 29, Train Loss 0.573283, Valid_loss 0.570005
Epoch 30, Train Loss 0.599073, Valid_loss 0.598956
Epoch 31, Train Loss 0.560660, Valid_loss 0.674092
Epoch 32, Train Loss 0.539368, Valid_loss 0.626351
Epoch 33, Train Loss 0.525892, Valid_loss 0.583349
Epoch 34, Train Loss 0.605322, Valid_loss 0.594875
Epoch 35, Train Loss 0.609612, Valid_loss 0.537274
Epoch 36, Train Loss 0.509847, Valid_loss 0.631710
Epoch 37, Train Loss 0.510934, Valid_loss 0.571208
Epoch 38, Train Loss 0.526304, Valid_loss 0.523342
Epoch 39, Train Loss 0.531244, Valid_loss 0.682855
Epoch 40, Train Loss 0.603975, Valid_loss 0.520411
Epoch 41, Train Loss 0.528681, Valid_loss 0.582419
Epoch 42, Train Loss 0.592482, Valid_loss 0.661131
Epoch 43, Train Loss 0.515394, Valid_loss 0.573998
Epoch 44, Train Loss 0.549198, Valid_loss 0.490650
Epoch 45, Train Loss 0.534090, Valid_loss 0.522240
Epoch 46, Train Loss 0.476990, Valid_loss 0.583613
Epoch 47, Train Loss 0.550954, Valid_loss 0.458060
Epoch 48, Train Loss 0.550308, Valid_loss 0.669715
Epoch 49, Train Loss 0.621069, Valid_loss 0.546612
Epoch 50, Train Loss 0.652626, Valid_loss 0.466709
Epoch 51, Train Loss 0.636953, Valid_loss 0.485727
Epoch 52, Train Loss 0.544007, Valid_loss 0.636970
[I 2025-08-31 10:25:58,114] Trial 0 finished with value: 0.45806020711149487 and parameters: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 2, 'dropout': 0.7, 'weight_decay': 0.01, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.45806020711149487.
👉 train samples(학습 샘플(bag))=141, batch_size=8 -> steps(샘플수/batch크기)=18
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 27.97 MB
Memory Reserved: 36.00 MB
cuda
Epoch 1, Train Loss 0.994086, Valid_loss 1.106107
Epoch 2, Train Loss 0.911878, Valid_loss 1.136153
Epoch 3, Train Loss 0.897966, Valid_loss 1.096659
Epoch 4, Train Loss 0.891974, Valid_loss 1.030941
Epoch 5, Train Loss 0.901515, Valid_loss 1.059648
Epoch 6, Train Loss 0.888310, Valid_loss 1.045995
Epoch 7, Train Loss 0.884630, Valid_loss 1.093933
Epoch 8, Train Loss 0.892562, Valid_loss 1.060794
Epoch 9, Train Loss 0.882328, Valid_loss 1.079689
Epoch 10, Train Loss 0.891118, Valid_loss 1.098943
Epoch 11, Train Loss 0.884474, Valid_loss 1.075490
Epoch 12, Train Loss 0.894802, Valid_loss 1.056892
Epoch 13, Train Loss 0.896661, Valid_loss 1.049029
Epoch 14, Train Loss 0.883078, Valid_loss 1.083678
Epoch 15, Train Loss 0.887429, Valid_loss 1.035663
Epoch 16, Train Loss 0.881505, Valid_loss 1.080696
Epoch 17, Train Loss 0.873741, Valid_loss 1.088880
Epoch 18, Train Loss 0.884191, Valid_loss 1.134232
Epoch 19, Train Loss 0.882243, Valid_loss 1.095009
Epoch 20, Train Loss 0.891567, Valid_loss 1.086634
Epoch 21, Train Loss 0.878248, Valid_loss 1.125630
Epoch 22, Train Loss 0.885635, Valid_loss 1.062191
Epoch 23, Train Loss 0.888996, Valid_loss 1.123744
Epoch 24, Train Loss 0.870049, Valid_loss 1.102287
Epoch 25, Train Loss 0.902807, Valid_loss 1.138607
Epoch 26, Train Loss 0.883136, Valid_loss 1.062632
Epoch 27, Train Loss 0.874230, Valid_loss 1.120093
Epoch 28, Train Loss 0.876580, Valid_loss 1.097871
Epoch 29, Train Loss 0.879113, Valid_loss 1.080622
Epoch 30, Train Loss 0.870883, Valid_loss 1.123511
Epoch 31, Train Loss 0.877758, Valid_loss 1.071901
Epoch 32, Train Loss 0.872481, Valid_loss 1.104240
Epoch 33, Train Loss 0.874744, Valid_loss 1.093535
Epoch 34, Train Loss 0.874704, Valid_loss 1.108029
Epoch 35, Train Loss 0.887923, Valid_loss 1.111535
Epoch 36, Train Loss 0.873600, Valid_loss 1.116777
Epoch 37, Train Loss 0.881045, Valid_loss 1.151611
Epoch 38, Train Loss 0.887534, Valid_loss 1.131819
Epoch 39, Train Loss 0.877229, Valid_loss 1.154786
Epoch 40, Train Loss 0.885750, Valid_loss 1.161962
Epoch 41, Train Loss 0.891101, Valid_loss 1.096969
Epoch 42, Train Loss 0.872044, Valid_loss 1.141412
Epoch 43, Train Loss 0.868205, Valid_loss 1.119294
Epoch 44, Train Loss 0.870217, Valid_loss 1.128983
Epoch 45, Train Loss 0.876433, Valid_loss 1.143533
Epoch 46, Train Loss 0.879397, Valid_loss 1.105090
Epoch 47, Train Loss 0.879394, Valid_loss 1.164145
Epoch 48, Train Loss 0.870649, Valid_loss 1.089076
Epoch 49, Train Loss 0.872610, Valid_loss 1.122089
Epoch 50, Train Loss 0.875533, Valid_loss 1.134495
Epoch 51, Train Loss 0.869834, Valid_loss 1.119579
Epoch 52, Train Loss 0.893012, Valid_loss 1.164400
Epoch 53, Train Loss 0.882074, Valid_loss 1.113011
Epoch 54, Train Loss 0.868098, Valid_loss 1.116503
Epoch 55, Train Loss 0.867042, Valid_loss 1.164902
[I 2025-08-31 10:34:46,507] Trial 1 finished with value: 1.0309407909711201 and parameters: {'learning_rate': 0.01, 'epochs': 100, 'heads': 2, 'dropout': 0.0, 'weight_decay': 0.0001, 'emb_dim': 64, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.45806020711149487.
👉 train samples(학습 샘플(bag))=141, batch_size=8 -> steps(샘플수/batch크기)=18
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 26.13 MB
Memory Reserved: 36.00 MB
cuda
Epoch 1, Train Loss 1.031865, Valid_loss 0.981834
Epoch 2, Train Loss 0.895235, Valid_loss 0.972737
Epoch 3, Train Loss 0.930109, Valid_loss 0.950925
Epoch 4, Train Loss 0.896966, Valid_loss 0.909790
Epoch 5, Train Loss 0.812542, Valid_loss 0.841484
Epoch 6, Train Loss 0.807967, Valid_loss 0.747983
Epoch 7, Train Loss 0.737490, Valid_loss 0.787759
Epoch 8, Train Loss 0.665854, Valid_loss 0.677907
Epoch 9, Train Loss 0.625968, Valid_loss 0.624592
Epoch 10, Train Loss 0.635003, Valid_loss 0.641806
Epoch 11, Train Loss 0.577199, Valid_loss 0.644296
Epoch 12, Train Loss 0.563337, Valid_loss 0.549869
Epoch 13, Train Loss 0.581306, Valid_loss 0.607033
Epoch 14, Train Loss 0.529186, Valid_loss 0.603603
Epoch 15, Train Loss 0.551472, Valid_loss 0.654986
Epoch 16, Train Loss 0.562478, Valid_loss 0.566937
Epoch 17, Train Loss 0.522519, Valid_loss 0.590789
Epoch 18, Train Loss 0.483641, Valid_loss 0.594658
Epoch 19, Train Loss 0.501585, Valid_loss 0.590431
Epoch 20, Train Loss 0.465788, Valid_loss 0.597092
Epoch 21, Train Loss 0.518451, Valid_loss 0.484864
Epoch 22, Train Loss 0.432017, Valid_loss 0.511490
Epoch 23, Train Loss 0.455663, Valid_loss 0.515279
Epoch 24, Train Loss 0.449369, Valid_loss 0.475415
Epoch 25, Train Loss 0.491365, Valid_loss 0.476629
Epoch 26, Train Loss 0.468840, Valid_loss 0.492459
Epoch 27, Train Loss 0.432687, Valid_loss 0.541635
Epoch 28, Train Loss 0.448919, Valid_loss 0.551807
Epoch 29, Train Loss 0.433296, Valid_loss 0.540043
Epoch 30, Train Loss 0.423464, Valid_loss 0.438234
Epoch 31, Train Loss 0.499494, Valid_loss 0.520646
Epoch 32, Train Loss 0.442778, Valid_loss 0.499200
Epoch 33, Train Loss 0.412736, Valid_loss 0.457078
Epoch 34, Train Loss 0.418344, Valid_loss 0.575232
Epoch 35, Train Loss 0.399615, Valid_loss 0.581654
Epoch 36, Train Loss 0.408965, Valid_loss 0.477122
Epoch 37, Train Loss 0.386089, Valid_loss 0.591424
Epoch 38, Train Loss 0.380404, Valid_loss 0.457228
Epoch 39, Train Loss 0.397652, Valid_loss 0.454965
Epoch 40, Train Loss 0.389569, Valid_loss 0.528960
Epoch 41, Train Loss 0.417666, Valid_loss 0.619427
Epoch 42, Train Loss 0.389724, Valid_loss 0.493966
Epoch 43, Train Loss 0.355964, Valid_loss 0.487048
Epoch 44, Train Loss 0.377695, Valid_loss 0.655609
Epoch 45, Train Loss 0.398766, Valid_loss 0.494455
Epoch 46, Train Loss 0.368920, Valid_loss 0.466662
Epoch 47, Train Loss 0.370562, Valid_loss 0.511644
Epoch 48, Train Loss 0.388201, Valid_loss 0.585586
Epoch 49, Train Loss 0.337111, Valid_loss 0.580245
Epoch 50, Train Loss 0.383722, Valid_loss 0.545252
Epoch 51, Train Loss 0.375516, Valid_loss 0.470192
Epoch 52, Train Loss 0.363762, Valid_loss 0.530153
Epoch 53, Train Loss 0.380886, Valid_loss 0.499887
Epoch 54, Train Loss 0.376970, Valid_loss 0.473419
Epoch 55, Train Loss 0.343548, Valid_loss 0.511181
Epoch 56, Train Loss 0.358031, Valid_loss 0.530336
[I 2025-08-31 10:42:22,912] Trial 2 finished with value: 0.4382341791476522 and parameters: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 1, 'dropout': 0.5, 'weight_decay': 0.01, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 2 with value: 0.4382341791476522.
선택된 trial params: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 1, 'dropout': 0.5, 'weight_decay': 0.01, 'emb_dim': 32, 'augment_num': 100, 'pca': False}
👉 train samples(학습 샘플(bag))=141, batch_size=8 -> steps(샘플수/batch크기)=18
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=15, batch_size=1 -> steps=15
Memory Allocated: 26.13 MB
Memory Reserved: 36.00 MB
cuda
Epoch 1, Train Loss 0.926894, Valid_loss 0.951880
Epoch 2, Train Loss 0.916074, Valid_loss 0.918042
Epoch 3, Train Loss 0.833610, Valid_loss 0.739720
Epoch 4, Train Loss 0.744573, Valid_loss 0.664678
Epoch 5, Train Loss 0.727335, Valid_loss 0.650502
Epoch 6, Train Loss 0.659715, Valid_loss 0.574822
Epoch 7, Train Loss 0.665192, Valid_loss 0.590125
Epoch 8, Train Loss 0.593111, Valid_loss 0.564534
Epoch 9, Train Loss 0.613627, Valid_loss 0.526092
Epoch 10, Train Loss 0.660698, Valid_loss 0.612676
Epoch 11, Train Loss 0.570281, Valid_loss 0.659966
Epoch 12, Train Loss 0.595100, Valid_loss 0.519535
Epoch 13, Train Loss 0.558855, Valid_loss 0.548453
Epoch 14, Train Loss 0.567312, Valid_loss 0.557882
Epoch 15, Train Loss 0.526282, Valid_loss 0.555418
Epoch 16, Train Loss 0.523018, Valid_loss 0.550448
Epoch 17, Train Loss 0.492399, Valid_loss 0.564546
Epoch 18, Train Loss 0.454405, Valid_loss 0.475521
Epoch 19, Train Loss 0.518828, Valid_loss 0.456967
Epoch 20, Train Loss 0.508223, Valid_loss 0.593701
Epoch 21, Train Loss 0.522103, Valid_loss 0.551084
Epoch 22, Train Loss 0.540175, Valid_loss 0.496137
Epoch 23, Train Loss 0.473018, Valid_loss 0.511339
Epoch 24, Train Loss 0.527155, Valid_loss 0.540746
Epoch 25, Train Loss 0.477422, Valid_loss 0.496503
Epoch 26, Train Loss 0.477226, Valid_loss 0.524031
Epoch 27, Train Loss 0.440108, Valid_loss 0.485483
Epoch 28, Train Loss 0.475913, Valid_loss 0.521426
Epoch 29, Train Loss 0.437994, Valid_loss 0.475308
Epoch 30, Train Loss 0.457598, Valid_loss 0.462199
Epoch 31, Train Loss 0.459463, Valid_loss 0.461758
Epoch 32, Train Loss 0.423880, Valid_loss 0.426095
Epoch 33, Train Loss 0.473273, Valid_loss 0.455785
Epoch 34, Train Loss 0.448244, Valid_loss 0.557519
Epoch 35, Train Loss 0.423168, Valid_loss 0.493077
Epoch 36, Train Loss 0.426923, Valid_loss 0.515846
Epoch 37, Train Loss 0.436571, Valid_loss 0.469697
Epoch 38, Train Loss 0.409932, Valid_loss 0.532725
Epoch 39, Train Loss 0.424404, Valid_loss 0.437842
Epoch 40, Train Loss 0.421742, Valid_loss 0.472468
Epoch 41, Train Loss 0.388423, Valid_loss 0.503677
Epoch 42, Train Loss 0.444121, Valid_loss 0.566038
Epoch 43, Train Loss 0.418129, Valid_loss 0.469284
Epoch 44, Train Loss 0.402643, Valid_loss 0.534850
Epoch 45, Train Loss 0.420778, Valid_loss 0.512874
Epoch 46, Train Loss 0.351064, Valid_loss 0.430002
Epoch 47, Train Loss 0.414016, Valid_loss 0.419442
Epoch 48, Train Loss 0.394465, Valid_loss 0.471428
Epoch 49, Train Loss 0.371034, Valid_loss 0.457277
Epoch 50, Train Loss 0.369219, Valid_loss 0.422976
Epoch 51, Train Loss 0.340918, Valid_loss 0.517206
Epoch 52, Train Loss 0.365272, Valid_loss 0.498533
Epoch 53, Train Loss 0.358139, Valid_loss 0.487667
Epoch 54, Train Loss 0.352102, Valid_loss 0.432478
Epoch 55, Train Loss 0.351128, Valid_loss 0.491540
Epoch 56, Train Loss 0.361389, Valid_loss 0.511727
환자ID=163-4 -- true: [[0]] -- pred: tensor([[-0.4890,  1.4949, -0.0051]], device='cuda:0')
환자ID=163-5 -- true: [[0]] -- pred: tensor([[-0.1360,  0.3082,  0.4387]], device='cuda:0')
환자ID=165-9 -- true: [[0]] -- pred: tensor([[ 2.0729, -0.4158, -1.3376]], device='cuda:0')
환자ID=27-10112 -- true: [[1]] -- pred: tensor([[-0.5171,  1.7388, -0.3529]], device='cuda:0')
환자ID=28-11515 -- true: [[1]] -- pred: tensor([[-0.0367,  1.7660, -0.5373]], device='cuda:0')
환자ID=29-10008 -- true: [[1]] -- pred: tensor([[-0.5510,  1.7210, -0.3681]], device='cuda:0')
환자ID=29-10010 -- true: [[1]] -- pred: tensor([[ 0.0768,  1.5380, -0.4155]], device='cuda:0')
환자ID=29-10011 -- true: [[1]] -- pred: tensor([[-0.6911,  1.5612, -0.1388]], device='cuda:0')
환자ID=29-10406 -- true: [[1]] -- pred: tensor([[-0.1173,  1.7506, -0.6658]], device='cuda:0')
환자ID=30-10018 -- true: [[2]] -- pred: tensor([[-0.8621,  1.4026, -0.0180]], device='cuda:0')
환자ID=30-10125 -- true: [[2]] -- pred: tensor([[-0.9759,  1.2740,  0.1861]], device='cuda:0')
환자ID=31-10210 -- true: [[1]] -- pred: tensor([[-0.0650,  1.7892, -0.6114]], device='cuda:0')
환자ID=33-10005 -- true: [[2]] -- pred: tensor([[-0.7166,  1.3431,  0.1094]], device='cuda:0')
환자ID=PRE98sc -- true: [[0]] -- pred: tensor([[ 2.0756, -0.3756, -1.3671]], device='cuda:0')
환자ID=Sample1157-EO1 -- true: [[0]] -- pred: tensor([[ 2.0993, -0.6861, -1.2791]], device='cuda:0')
Best performance: Epoch 47, Loss 0.414016, Test ACC 0.666667, Test AUC 0.934921, Test Recall 0.533333, Test Precision 0.545455
Confusion Matrix:
 [[3 1 1]
 [0 7 0]
 [0 3 0]]
✅ Total valid splits used: 3
🔁 Repeat 3, Fold 3
cell type :  S2008000651HRT_AAACCCACAGAGTGTG-1              T_cells
S2008000651HRT_AAACCCACATGACTGT-1              T_cells
S2008000651HRT_AAACGAAGTTAATCGC-1          Fibroblasts
S2008000651HRT_AAACGCTAGGCTTAAA-1              T_cells
S2008000651HRT_AAAGAACAGGAACTCG-1              T_cells
                                           ...        
Sample1162EO2_TTTGGAGAGCAGGCAT-1      Epithelial_cells
Sample1162EO2_TTTGGAGAGTCGCGAA-1     Endothelial_cells
Sample1162EO2_TTTGGAGAGTGCTCGC-1           Hepatocytes
Sample1162EO2_TTTGGAGGTGATACTC-1      Epithelial_cells
Sample1162EO2_TTTGGTTCAGTAGAAT-1      Epithelial_cells
Name: singler_annotation, Length: 185814, dtype: string
cell type annotation :  S2008000651HRT_AAACCCACAGAGTGTG-1              T_cells
S2008000651HRT_AAACCCACATGACTGT-1              T_cells
S2008000651HRT_AAACGAAGTTAATCGC-1          Fibroblasts
S2008000651HRT_AAACGCTAGGCTTAAA-1              T_cells
S2008000651HRT_AAAGAACAGGAACTCG-1              T_cells
                                           ...        
Sample1162EO2_TTTGGAGAGCAGGCAT-1      Epithelial_cells
Sample1162EO2_TTTGGAGAGTCGCGAA-1     Endothelial_cells
Sample1162EO2_TTTGGAGAGTGCTCGC-1           Hepatocytes
Sample1162EO2_TTTGGAGGTGATACTC-1      Epithelial_cells
Sample1162EO2_TTTGGTTCAGTAGAAT-1      Epithelial_cells
Name: singler_annotation, Length: 185814, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['T_cells', 'Fibroblasts', 'B_cell', 'Macrophage', 'Pre-B_cell_CD34-', 'NK_cell', 'Endothelial_cells', 'Chondrocytes', 'HSC_-G-CSF', 'CMP', 'Monocyte', 'Smooth_muscle_cells', 'DC', 'BM', 'Tissue_stem_cells', 'Platelets', 'GMP', 'Neutrophils', 'Epithelial_cells', 'HSC_CD34+', 'MSC', 'Pro-Myelocyte', 'iPS_cells', 'Pro-B_cell_CD34+', 'Astrocyte', 'Embryonic_stem_cells', 'Hepatocytes', 'Neurons', 'Keratinocytes', 'Neuroepithelial_cell', 'MEP', 'BM & Prog.', 'Erythroblast', 'Osteoblasts', 'Myelocyte', 'Gametocytes', 'Unknown']
라벨별 그룹 개수 {0: 21, 1: 30, 2: 11}
cell type :  S2008000605HRT_AAACCCAGTGCACATT-1    Epithelial_cells
S2008000605HRT_AAACCCAGTGCCTACG-1    Epithelial_cells
S2008000605HRT_AAAGAACGTAGAGACC-1           Astrocyte
S2008000605HRT_AAAGAACGTCGGAACA-1    Epithelial_cells
S2008000605HRT_AAAGAACGTTAACAGA-1    Epithelial_cells
                                           ...       
Sample1157EO3_TTTGATCGTGGTCCCA-1     Epithelial_cells
Sample1157EO3_TTTGGAGGTAGTCGTT-1     Epithelial_cells
Sample1157EO3_TTTGGTTAGTTTGCTG-1     Epithelial_cells
Sample1157EO3_TTTGGTTTCACACCGG-1              T_cells
Sample1157EO3_TTTGTTGGTTCATCTT-1     Epithelial_cells
Name: singler_annotation, Length: 39363, dtype: string
cell type annotation :  S2008000605HRT_AAACCCAGTGCACATT-1    Epithelial_cells
S2008000605HRT_AAACCCAGTGCCTACG-1    Epithelial_cells
S2008000605HRT_AAAGAACGTAGAGACC-1           Astrocyte
S2008000605HRT_AAAGAACGTCGGAACA-1    Epithelial_cells
S2008000605HRT_AAAGAACGTTAACAGA-1    Epithelial_cells
                                           ...       
Sample1157EO3_TTTGATCGTGGTCCCA-1     Epithelial_cells
Sample1157EO3_TTTGGAGGTAGTCGTT-1     Epithelial_cells
Sample1157EO3_TTTGGTTAGTTTGCTG-1     Epithelial_cells
Sample1157EO3_TTTGGTTTCACACCGG-1              T_cells
Sample1157EO3_TTTGTTGGTTCATCTT-1     Epithelial_cells
Name: singler_annotation, Length: 39363, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Epithelial_cells', 'Astrocyte', 'MSC', 'Keratinocytes', 'Neurons', 'Endothelial_cells', 'Fibroblasts', 'Tissue_stem_cells', 'Smooth_muscle_cells', 'T_cells', 'Neuroepithelial_cell', 'NK_cell', 'Chondrocytes', 'Osteoblasts', 'Monocyte', 'Hepatocytes', 'Macrophage', 'CMP', 'Embryonic_stem_cells', 'DC', 'BM & Prog.', 'MEP', 'Neutrophils', 'Pro-Myelocyte', 'iPS_cells', 'Pre-B_cell_CD34-', 'HSC_-G-CSF', 'B_cell', 'GMP', 'HSC_CD34+', 'Platelets', 'Pro-B_cell_CD34+', 'Myelocyte', 'BM', 'Unknown', 'Erythroblast', 'Gametocytes']
라벨별 그룹 개수 {0: 5, 1: 7, 2: 3}
🔍 Split #4
  → train_p_index 환자 수 (환자 단위로 묶인 index list): 62
  → test_p_index 환자 수  (환자 단위로 묶인 index list): 15
  → train 환자 ID: ['163-4', '163-5', '164-10', '164-3', '165-9', '27-10039', '27-10041', '27-10053', '27-10071', '27-10112', '27-10119', '28-11515', '28-12263', '28-12381', '29-10006', '29-10008', '29-10010', '29-10011', '29-10012', '29-10013', '29-10016', '29-10280', '29-10386', '29-10404', '29-10406', '29-10410', '30-10018', '30-10123', '30-10125', '30-11051', '31-10000', '31-10001', '31-10035', '31-10040', '31-10042', '31-10078', '31-10154', '31-10210', '31-10236', '32-10003', '32-10074', '33-10005', '33-10006', '34-10050', '34-10184', '34-10187', 'PRE018-1', 'PRE019', 'PRE027', 'PRE038', 'PRE055-1', 'PRE062-1', 'PRE98sc', 'Sample1153-EO1', 'Sample1153-EO3', 'Sample1157-EO1', 'Sample1157-EO2', 'Sample1158-EO1', 'Sample1158-EO2', 'Sample1158-EO3', 'Sample1162-EO1', 'Sample1162-EO2']
  → test  환자 ID: ['163-2', '163-3', '164-6', '28-10051', '28-12490', '28-12518', '29-10380', '29-10398', '29-10400', '30-10034', '30-10929', '31-10013', '32-10034', 'Sample1153-EO2', 'Sample1157-EO3']
  → train 환자 ID 및 라벨:
    ID: 163-4, Label: 0
    ID: 163-5, Label: 0
    ID: 164-10, Label: 0
    ID: 164-3, Label: 0
    ID: 165-9, Label: 0
    ID: 27-10039, Label: 1
    ID: 27-10041, Label: 1
    ID: 27-10053, Label: 1
    ID: 27-10071, Label: 1
    ID: 27-10112, Label: 1
    ID: 27-10119, Label: 1
    ID: 28-11515, Label: 1
    ID: 28-12263, Label: 1
    ID: 28-12381, Label: 1
    ID: 29-10006, Label: 1
    ID: 29-10008, Label: 1
    ID: 29-10010, Label: 1
    ID: 29-10011, Label: 1
    ID: 29-10012, Label: 1
    ID: 29-10013, Label: 1
    ID: 29-10016, Label: 1
    ID: 29-10280, Label: 1
    ID: 29-10386, Label: 1
    ID: 29-10404, Label: 1
    ID: 29-10406, Label: 1
    ID: 29-10410, Label: 1
    ID: 30-10018, Label: 2
    ID: 30-10123, Label: 2
    ID: 30-10125, Label: 2
    ID: 30-11051, Label: 2
    ID: 31-10000, Label: 1
    ID: 31-10001, Label: 1
    ID: 31-10035, Label: 1
    ID: 31-10040, Label: 1
    ID: 31-10042, Label: 1
    ID: 31-10078, Label: 1
    ID: 31-10154, Label: 1
    ID: 31-10210, Label: 1
    ID: 31-10236, Label: 1
    ID: 32-10003, Label: 2
    ID: 32-10074, Label: 2
    ID: 33-10005, Label: 2
    ID: 33-10006, Label: 2
    ID: 34-10050, Label: 2
    ID: 34-10184, Label: 2
    ID: 34-10187, Label: 2
    ID: PRE018-1, Label: 0
    ID: PRE019, Label: 0
    ID: PRE027, Label: 0
    ID: PRE038, Label: 0
    ID: PRE055-1, Label: 0
    ID: PRE062-1, Label: 0
    ID: PRE98sc, Label: 0
    ID: Sample1153-EO1, Label: 0
    ID: Sample1153-EO3, Label: 0
    ID: Sample1157-EO1, Label: 0
    ID: Sample1157-EO2, Label: 0
    ID: Sample1158-EO1, Label: 0
    ID: Sample1158-EO2, Label: 0
    ID: Sample1158-EO3, Label: 0
    ID: Sample1162-EO1, Label: 0
    ID: Sample1162-EO2, Label: 0
  → test 환자 ID 및 라벨:
    ID: 163-2, Label: 0
    ID: 163-3, Label: 0
    ID: 164-6, Label: 0
    ID: 28-10051, Label: 1
    ID: 28-12490, Label: 1
    ID: 28-12518, Label: 1
    ID: 29-10380, Label: 1
    ID: 29-10398, Label: 1
    ID: 29-10400, Label: 1
    ID: 30-10034, Label: 2
    ID: 30-10929, Label: 2
    ID: 31-10013, Label: 1
    ID: 32-10034, Label: 2
    ID: Sample1153-EO2, Label: 0
    ID: Sample1157-EO3, Label: 0
전체 데이터 index 길이 77
label_stat (train 환자 라벨 목록) 갯수 62
train_data에서 환자 단위로, train과 validation 나누기
기존 train_p_index 62
기존 (train) label_stat 62
train-vali 분할 후! 
train y 의 classes : {0, 1, 2} valid y 의 classes : {0, 1, 2} label_stat 의 classes : {0, 1, 2}
train_p_index_ 41
valid_p_index 21
test_p_index 15
→ train 환자 ID 및 라벨:
   총 개수: 41
   환자ID=29-10280, Label=1, 셀개수=2375
   환자ID=31-10236, Label=1, 셀개수=3458
   환자ID=PRE018-1, Label=0, 셀개수=1349
   환자ID=33-10005, Label=2, 셀개수=8904
   환자ID=Sample1158-EO2, Label=0, 셀개수=1427
   환자ID=164-3, Label=0, 셀개수=1639
   환자ID=29-10011, Label=1, 셀개수=3072
   환자ID=PRE055-1, Label=0, 셀개수=597
   환자ID=31-10040, Label=1, 셀개수=4543
   환자ID=31-10001, Label=1, 셀개수=1133
   환자ID=163-5, Label=0, 셀개수=1210
   환자ID=28-11515, Label=1, 셀개수=930
   환자ID=27-10041, Label=1, 셀개수=2145
   환자ID=27-10053, Label=1, 셀개수=728
   환자ID=163-4, Label=0, 셀개수=1339
   환자ID=30-10125, Label=2, 셀개수=3798
   환자ID=31-10078, Label=1, 셀개수=2827
   환자ID=31-10000, Label=1, 셀개수=8870
   환자ID=Sample1158-EO3, Label=0, 셀개수=1096
   환자ID=29-10404, Label=1, 셀개수=3988
   환자ID=31-10042, Label=1, 셀개수=1222
   환자ID=164-10, Label=0, 셀개수=4041
   환자ID=32-10074, Label=2, 셀개수=6304
   환자ID=PRE98sc, Label=0, 셀개수=1568
   환자ID=30-10018, Label=2, 셀개수=5170
   환자ID=28-12381, Label=1, 셀개수=1099
   환자ID=Sample1162-EO1, Label=0, 셀개수=1053
   환자ID=31-10154, Label=1, 셀개수=6568
   환자ID=PRE019, Label=0, 셀개수=3795
   환자ID=27-10119, Label=1, 셀개수=3346
   환자ID=29-10010, Label=1, 셀개수=5305
   환자ID=28-12263, Label=1, 셀개수=7527
   환자ID=27-10039, Label=1, 셀개수=4638
   환자ID=29-10410, Label=1, 셀개수=2834
   환자ID=34-10187, Label=2, 셀개수=3739
   환자ID=29-10386, Label=1, 셀개수=802
   환자ID=34-10050, Label=2, 셀개수=4784
   환자ID=33-10006, Label=2, 셀개수=457
   환자ID=32-10003, Label=2, 셀개수=2978
   환자ID=29-10016, Label=1, 셀개수=4854
   환자ID=29-10008, Label=1, 셀개수=1913
→ valid 환자 ID 및 라벨:
   총 개수: 21
   환자ID=Sample1162-EO2, Label=0, 셀개수=1510
   환자ID=29-10013, Label=1, 셀개수=3706
   환자ID=31-10210, Label=1, 셀개수=3510
   환자ID=Sample1153-EO1, Label=0, 셀개수=911
   환자ID=34-10184, Label=2, 셀개수=2699
   환자ID=PRE062-1, Label=0, 셀개수=907
   환자ID=Sample1157-EO2, Label=0, 셀개수=1395
   환자ID=30-11051, Label=2, 셀개수=2454
   환자ID=31-10035, Label=1, 셀개수=2974
   환자ID=30-10123, Label=2, 셀개수=1273
   환자ID=Sample1158-EO1, Label=0, 셀개수=574
   환자ID=27-10112, Label=1, 셀개수=1470
   환자ID=29-10406, Label=1, 셀개수=3484
   환자ID=Sample1153-EO3, Label=0, 셀개수=1516
   환자ID=PRE038, Label=0, 셀개수=2666
   환자ID=PRE027, Label=0, 셀개수=2078
   환자ID=165-9, Label=0, 셀개수=2926
   환자ID=29-10012, Label=1, 셀개수=6245
   환자ID=27-10071, Label=1, 셀개수=1478
   환자ID=29-10006, Label=1, 셀개수=11461
   환자ID=Sample1157-EO1, Label=0, 셀개수=1152
→ test 환자 ID 및 라벨:
   총 개수: 15
   환자ID=163-2, Label=0, 셀개수=2535
   환자ID=163-3, Label=0, 셀개수=1335
   환자ID=164-6, Label=0, 셀개수=3038
   환자ID=28-10051, Label=1, 셀개수=300
   환자ID=28-12490, Label=1, 셀개수=5973
   환자ID=28-12518, Label=1, 셀개수=1215
   환자ID=29-10380, Label=1, 셀개수=4799
   환자ID=29-10398, Label=1, 셀개수=3993
   환자ID=29-10400, Label=1, 셀개수=2684
   환자ID=30-10034, Label=2, 셀개수=1240
   환자ID=30-10929, Label=2, 셀개수=5812
   환자ID=31-10013, Label=1, 셀개수=3161
   환자ID=32-10034, Label=2, 셀개수=1555
   환자ID=Sample1153-EO2, Label=0, 셀개수=916
   환자ID=Sample1157-EO3, Label=0, 셀개수=807
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['T_cells', 'T_cells', 'Fibroblasts', 'T_cells', 'T_cells', 'B_cell', 'Macrophage', 'Pre-B_cell_CD34-', 'NK_cell', 'B_cell']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
전체 데이터 길이 225177
전체 cell type 길이 0                  T_cells
1                  T_cells
2              Fibroblasts
3                  T_cells
4                  T_cells
                ...       
225172    Epithelial_cells
225173    Epithelial_cells
225174    Epithelial_cells
225175             T_cells
225176    Epithelial_cells
Length: 225177, dtype: string
cell type의 NaN 개수 체크 0
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:10,  9.57it/s]  2%|▏         | 2/100 [00:00<00:10,  9.70it/s]  4%|▍         | 4/100 [00:00<00:09, 10.16it/s]  6%|▌         | 6/100 [00:00<00:09,  9.92it/s]  8%|▊         | 8/100 [00:00<00:09,  9.98it/s]  9%|▉         | 9/100 [00:00<00:09,  9.84it/s] 10%|█         | 10/100 [00:01<00:09,  9.82it/s] 11%|█         | 11/100 [00:01<00:09,  9.75it/s] 12%|█▏        | 12/100 [00:01<00:11,  7.72it/s] 14%|█▍        | 14/100 [00:01<00:09,  8.64it/s] 15%|█▌        | 15/100 [00:01<00:09,  8.74it/s] 16%|█▌        | 16/100 [00:01<00:09,  8.83it/s] 17%|█▋        | 17/100 [00:01<00:09,  9.03it/s] 18%|█▊        | 18/100 [00:01<00:08,  9.16it/s] 19%|█▉        | 19/100 [00:02<00:08,  9.18it/s] 20%|██        | 20/100 [00:02<00:09,  8.15it/s] 21%|██        | 21/100 [00:02<00:09,  8.47it/s] 23%|██▎       | 23/100 [00:02<00:08,  9.09it/s] 24%|██▍       | 24/100 [00:02<00:08,  9.00it/s] 25%|██▌       | 25/100 [00:02<00:08,  8.82it/s] 26%|██▌       | 26/100 [00:02<00:08,  8.75it/s] 27%|██▋       | 27/100 [00:03<00:08,  8.33it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.48it/s] 29%|██▉       | 29/100 [00:03<00:08,  8.70it/s] 30%|███       | 30/100 [00:03<00:07,  8.80it/s] 31%|███       | 31/100 [00:03<00:08,  8.43it/s] 32%|███▏      | 32/100 [00:03<00:07,  8.71it/s] 33%|███▎      | 33/100 [00:03<00:07,  8.68it/s] 34%|███▍      | 34/100 [00:03<00:07,  8.60it/s] 35%|███▌      | 35/100 [00:03<00:07,  8.76it/s] 36%|███▌      | 36/100 [00:04<00:07,  8.74it/s] 37%|███▋      | 37/100 [00:04<00:07,  8.66it/s] 38%|███▊      | 38/100 [00:04<00:07,  8.70it/s] 39%|███▉      | 39/100 [00:04<00:06,  8.75it/s] 40%|████      | 40/100 [00:04<00:06,  8.90it/s] 41%|████      | 41/100 [00:04<00:08,  6.90it/s] 42%|████▏     | 42/100 [00:04<00:07,  7.43it/s] 43%|████▎     | 43/100 [00:04<00:07,  7.73it/s] 44%|████▍     | 44/100 [00:05<00:07,  7.96it/s] 45%|████▌     | 45/100 [00:05<00:06,  8.32it/s] 46%|████▌     | 46/100 [00:05<00:06,  8.45it/s] 47%|████▋     | 47/100 [00:05<00:06,  8.62it/s] 48%|████▊     | 48/100 [00:05<00:05,  8.86it/s] 49%|████▉     | 49/100 [00:05<00:05,  8.80it/s] 50%|█████     | 50/100 [00:05<00:05,  8.73it/s] 51%|█████     | 51/100 [00:05<00:05,  8.85it/s] 52%|█████▏    | 52/100 [00:05<00:05,  8.81it/s] 53%|█████▎    | 53/100 [00:06<00:06,  7.72it/s] 54%|█████▍    | 54/100 [00:06<00:05,  7.92it/s] 55%|█████▌    | 55/100 [00:06<00:05,  8.21it/s] 56%|█████▌    | 56/100 [00:06<00:05,  8.44it/s] 57%|█████▋    | 57/100 [00:06<00:05,  8.52it/s] 58%|█████▊    | 58/100 [00:06<00:04,  8.56it/s] 59%|█████▉    | 59/100 [00:06<00:04,  8.79it/s] 60%|██████    | 60/100 [00:06<00:04,  8.75it/s] 61%|██████    | 61/100 [00:07<00:04,  8.61it/s] 62%|██████▏   | 62/100 [00:07<00:04,  8.44it/s] 63%|██████▎   | 63/100 [00:07<00:04,  8.43it/s] 64%|██████▍   | 64/100 [00:07<00:04,  8.35it/s] 65%|██████▌   | 65/100 [00:07<00:04,  8.55it/s] 66%|██████▌   | 66/100 [00:07<00:03,  8.59it/s] 67%|██████▋   | 67/100 [00:07<00:03,  8.66it/s] 68%|██████▊   | 68/100 [00:07<00:03,  8.68it/s] 69%|██████▉   | 69/100 [00:07<00:03,  8.63it/s] 70%|███████   | 70/100 [00:08<00:03,  8.57it/s] 71%|███████   | 71/100 [00:08<00:03,  8.56it/s] 72%|███████▏  | 72/100 [00:08<00:03,  8.49it/s] 73%|███████▎  | 73/100 [00:08<00:03,  7.98it/s] 74%|███████▍  | 74/100 [00:08<00:03,  7.38it/s] 75%|███████▌  | 75/100 [00:08<00:03,  7.53it/s] 76%|███████▌  | 76/100 [00:08<00:03,  7.13it/s] 77%|███████▋  | 77/100 [00:09<00:03,  7.43it/s] 78%|███████▊  | 78/100 [00:09<00:02,  7.75it/s] 79%|███████▉  | 79/100 [00:09<00:02,  8.00it/s] 80%|████████  | 80/100 [00:09<00:02,  8.08it/s] 81%|████████  | 81/100 [00:09<00:02,  8.12it/s] 82%|████████▏ | 82/100 [00:09<00:02,  8.14it/s] 83%|████████▎ | 83/100 [00:09<00:02,  6.69it/s] 84%|████████▍ | 84/100 [00:09<00:02,  7.12it/s] 85%|████████▌ | 85/100 [00:10<00:02,  7.43it/s] 86%|████████▌ | 86/100 [00:10<00:01,  7.52it/s] 87%|████████▋ | 87/100 [00:10<00:01,  7.70it/s] 88%|████████▊ | 88/100 [00:10<00:01,  7.70it/s] 89%|████████▉ | 89/100 [00:10<00:01,  7.78it/s] 90%|█████████ | 90/100 [00:10<00:01,  7.92it/s] 91%|█████████ | 91/100 [00:10<00:01,  8.05it/s] 92%|█████████▏| 92/100 [00:10<00:00,  8.17it/s] 93%|█████████▎| 93/100 [00:11<00:00,  8.05it/s] 94%|█████████▍| 94/100 [00:11<00:00,  8.14it/s] 95%|█████████▌| 95/100 [00:11<00:00,  8.09it/s] 96%|█████████▌| 96/100 [00:11<00:00,  8.11it/s] 97%|█████████▋| 97/100 [00:11<00:00,  8.15it/s] 98%|█████████▊| 98/100 [00:11<00:00,  8.06it/s] 99%|█████████▉| 99/100 [00:11<00:00,  8.18it/s]100%|██████████| 100/100 [00:11<00:00,  8.10it/s]100%|██████████| 100/100 [00:11<00:00,  8.39it/s]
[I 2025-08-31 10:50:21,775] A new study created in memory with name: no-name-2d9b222f-e705-4fb8-91aa-68ba2f1ce821
👉 train samples(학습 샘플(bag))=141, batch_size=8 -> steps(샘플수/batch크기)=18
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 24.81 MB
Memory Reserved: 36.00 MB
cuda
Epoch 1, Train Loss 1.262511, Valid_loss 1.090534
Epoch 2, Train Loss 1.212768, Valid_loss 1.072639
Epoch 3, Train Loss 1.142407, Valid_loss 0.994178
Epoch 4, Train Loss 1.122214, Valid_loss 0.944529
Epoch 5, Train Loss 1.050629, Valid_loss 0.858341
Epoch 6, Train Loss 1.012037, Valid_loss 0.792828
Epoch 7, Train Loss 0.958782, Valid_loss 0.784950
Epoch 8, Train Loss 0.924147, Valid_loss 0.759863
Epoch 9, Train Loss 0.873809, Valid_loss 0.761518
Epoch 10, Train Loss 0.855099, Valid_loss 0.672437
Epoch 11, Train Loss 0.843940, Valid_loss 0.826267
Epoch 12, Train Loss 0.831500, Valid_loss 0.658460
Epoch 13, Train Loss 0.811661, Valid_loss 0.700058
Epoch 14, Train Loss 0.795053, Valid_loss 0.696412
Epoch 15, Train Loss 0.768180, Valid_loss 0.695540
Epoch 16, Train Loss 0.758919, Valid_loss 0.807571
Epoch 17, Train Loss 0.739167, Valid_loss 0.636918
Epoch 18, Train Loss 0.679006, Valid_loss 0.625561
Epoch 19, Train Loss 0.802751, Valid_loss 0.629153
Epoch 20, Train Loss 0.752918, Valid_loss 0.746025
Epoch 21, Train Loss 0.668110, Valid_loss 0.609202
Epoch 22, Train Loss 0.756486, Valid_loss 0.632218
Epoch 23, Train Loss 0.629829, Valid_loss 0.594605
Epoch 24, Train Loss 0.727490, Valid_loss 0.629563
Epoch 25, Train Loss 0.742095, Valid_loss 0.654515
Epoch 26, Train Loss 0.676712, Valid_loss 0.572236
Epoch 27, Train Loss 0.708991, Valid_loss 0.695848
Epoch 28, Train Loss 0.614773, Valid_loss 0.553280
Epoch 29, Train Loss 0.717771, Valid_loss 0.657418
Epoch 30, Train Loss 0.662553, Valid_loss 0.535471
Epoch 31, Train Loss 0.735420, Valid_loss 0.718703
Epoch 32, Train Loss 0.701974, Valid_loss 0.587391
Epoch 33, Train Loss 0.673112, Valid_loss 0.560611
Epoch 34, Train Loss 0.660521, Valid_loss 0.568387
Epoch 35, Train Loss 0.691694, Valid_loss 0.879030
Epoch 36, Train Loss 0.698182, Valid_loss 0.520929
Epoch 37, Train Loss 0.855003, Valid_loss 0.665453
Epoch 38, Train Loss 0.613538, Valid_loss 0.547024
Epoch 39, Train Loss 0.674727, Valid_loss 0.622532
Epoch 40, Train Loss 0.584298, Valid_loss 0.664945
Epoch 41, Train Loss 0.643314, Valid_loss 0.543928
Epoch 42, Train Loss 0.695300, Valid_loss 0.540936
Epoch 43, Train Loss 0.685195, Valid_loss 0.538059
Epoch 44, Train Loss 0.605004, Valid_loss 0.546877
Epoch 45, Train Loss 0.588785, Valid_loss 0.675354
Epoch 46, Train Loss 0.640934, Valid_loss 0.517456
Epoch 47, Train Loss 0.578806, Valid_loss 0.638664
Epoch 48, Train Loss 0.632198, Valid_loss 0.542823
Epoch 49, Train Loss 0.637521, Valid_loss 0.705457
Epoch 50, Train Loss 0.553351, Valid_loss 0.529592
Epoch 51, Train Loss 0.582333, Valid_loss 0.538135
Epoch 52, Train Loss 0.585512, Valid_loss 0.536876
Epoch 53, Train Loss 0.619895, Valid_loss 0.541231
Epoch 54, Train Loss 0.591195, Valid_loss 0.505063
Epoch 55, Train Loss 0.598055, Valid_loss 0.540640
Epoch 56, Train Loss 0.528843, Valid_loss 0.564969
[I 2025-08-31 10:59:40,056] Trial 0 finished with value: 0.5050627177669889 and parameters: {'learning_rate': 0.001, 'epochs': 100, 'heads': 4, 'dropout': 0.7, 'weight_decay': 0.0001, 'emb_dim': 8, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.5050627177669889.
👉 train samples(학습 샘플(bag))=141, batch_size=8 -> steps(샘플수/batch크기)=18
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 26.13 MB
Memory Reserved: 36.00 MB
cuda
Epoch 1, Train Loss 0.967789, Valid_loss 0.994399
Epoch 2, Train Loss 0.960463, Valid_loss 0.966327
Epoch 3, Train Loss 0.933268, Valid_loss 0.902879
Epoch 4, Train Loss 0.825527, Valid_loss 0.754495
Epoch 5, Train Loss 0.749432, Valid_loss 0.664611
Epoch 6, Train Loss 0.719803, Valid_loss 0.790491
Epoch 7, Train Loss 0.685822, Valid_loss 0.698176
Epoch 8, Train Loss 0.646961, Valid_loss 0.634809
Epoch 9, Train Loss 0.642594, Valid_loss 0.670421
Epoch 10, Train Loss 0.602907, Valid_loss 0.718968
Epoch 11, Train Loss 0.532891, Valid_loss 0.644297
Epoch 12, Train Loss 0.520278, Valid_loss 0.674848
Epoch 13, Train Loss 0.497702, Valid_loss 0.567502
Epoch 14, Train Loss 0.527115, Valid_loss 0.626871
Epoch 15, Train Loss 0.501630, Valid_loss 0.579815
Epoch 16, Train Loss 0.540836, Valid_loss 0.567684
Epoch 17, Train Loss 0.498691, Valid_loss 0.664857
Epoch 18, Train Loss 0.455270, Valid_loss 0.754769
Epoch 19, Train Loss 0.511089, Valid_loss 0.577320
Epoch 20, Train Loss 0.462056, Valid_loss 0.509561
Epoch 21, Train Loss 0.432412, Valid_loss 0.591418
Epoch 22, Train Loss 0.428187, Valid_loss 0.535447
Epoch 23, Train Loss 0.451625, Valid_loss 0.564015
Epoch 24, Train Loss 0.447107, Valid_loss 0.622987
Epoch 25, Train Loss 0.412873, Valid_loss 0.560290
Epoch 26, Train Loss 0.397174, Valid_loss 0.525362
Epoch 27, Train Loss 0.362921, Valid_loss 0.588196
Epoch 28, Train Loss 0.404379, Valid_loss 0.666826
Epoch 29, Train Loss 0.405679, Valid_loss 0.501035
Epoch 30, Train Loss 0.435430, Valid_loss 0.852471
Epoch 31, Train Loss 0.466538, Valid_loss 0.507570
Epoch 32, Train Loss 0.418551, Valid_loss 0.524998
Epoch 33, Train Loss 0.366561, Valid_loss 0.498080
Epoch 34, Train Loss 0.392741, Valid_loss 0.773632
Epoch 35, Train Loss 0.370002, Valid_loss 0.543376
Epoch 36, Train Loss 0.358304, Valid_loss 0.523417
Epoch 37, Train Loss 0.370390, Valid_loss 0.611749
Epoch 38, Train Loss 0.321102, Valid_loss 0.584439
Epoch 39, Train Loss 0.306141, Valid_loss 0.579669
Epoch 40, Train Loss 0.308395, Valid_loss 0.633155
Epoch 41, Train Loss 0.327443, Valid_loss 0.575469
Epoch 42, Train Loss 0.345168, Valid_loss 0.463956
Epoch 43, Train Loss 0.284750, Valid_loss 0.608916
Epoch 44, Train Loss 0.368998, Valid_loss 0.530478
Epoch 45, Train Loss 0.327000, Valid_loss 0.558146
Epoch 46, Train Loss 0.291481, Valid_loss 0.581032
Epoch 47, Train Loss 0.261953, Valid_loss 0.541654
Epoch 48, Train Loss 0.296367, Valid_loss 0.609159
Epoch 49, Train Loss 0.254176, Valid_loss 0.571077
Epoch 50, Train Loss 0.347383, Valid_loss 0.614628
Epoch 51, Train Loss 0.309805, Valid_loss 0.491322
Epoch 52, Train Loss 0.278754, Valid_loss 0.583683
Epoch 53, Train Loss 0.298893, Valid_loss 0.538259
Epoch 54, Train Loss 0.264009, Valid_loss 0.546347
Epoch 55, Train Loss 0.278166, Valid_loss 0.575751
[I 2025-08-31 11:08:50,576] Trial 1 finished with value: 0.4639556205698422 and parameters: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 4, 'dropout': 0.5, 'weight_decay': 0.0001, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 1 with value: 0.4639556205698422.
👉 train samples(학습 샘플(bag))=141, batch_size=8 -> steps(샘플수/batch크기)=18
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 27.97 MB
Memory Reserved: 36.00 MB
cuda
Epoch 1, Train Loss 1.063013, Valid_loss 1.157101
Epoch 2, Train Loss 0.961403, Valid_loss 1.084847
Epoch 3, Train Loss 0.963221, Valid_loss 1.035803
Epoch 4, Train Loss 0.945898, Valid_loss 1.053550
Epoch 5, Train Loss 0.948490, Valid_loss 1.093728
Epoch 6, Train Loss 0.959908, Valid_loss 1.029292
Epoch 7, Train Loss 0.956058, Valid_loss 1.067534
Epoch 8, Train Loss 0.959634, Valid_loss 1.051788
Epoch 9, Train Loss 0.953869, Valid_loss 1.027671
Epoch 10, Train Loss 0.951969, Valid_loss 1.007456
Epoch 11, Train Loss 0.907256, Valid_loss 1.085178
Epoch 12, Train Loss 0.958301, Valid_loss 1.028220
Epoch 13, Train Loss 0.933922, Valid_loss 0.923943
Epoch 14, Train Loss 0.836030, Valid_loss 0.712751
Epoch 15, Train Loss 0.973727, Valid_loss 1.118183
Epoch 16, Train Loss 0.966190, Valid_loss 1.076824
Epoch 17, Train Loss 0.962222, Valid_loss 1.025543
Epoch 18, Train Loss 0.937274, Valid_loss 1.042220
Epoch 19, Train Loss 0.935271, Valid_loss 1.020320
Epoch 20, Train Loss 0.935705, Valid_loss 1.022890
Epoch 21, Train Loss 0.947897, Valid_loss 1.025994
Epoch 22, Train Loss 0.952368, Valid_loss 1.034200
Epoch 23, Train Loss 0.926222, Valid_loss 1.040566
Epoch 24, Train Loss 0.942579, Valid_loss 1.036991
Epoch 25, Train Loss 0.935353, Valid_loss 1.018810
Epoch 26, Train Loss 0.956486, Valid_loss 1.016742
Epoch 27, Train Loss 0.943026, Valid_loss 1.036107
Epoch 28, Train Loss 0.938473, Valid_loss 1.025663
Epoch 29, Train Loss 0.943647, Valid_loss 1.023455
Epoch 30, Train Loss 0.947232, Valid_loss 1.033031
Epoch 31, Train Loss 0.944940, Valid_loss 1.024669
Epoch 32, Train Loss 0.928946, Valid_loss 1.030891
Epoch 33, Train Loss 0.947662, Valid_loss 1.026821
Epoch 34, Train Loss 0.930587, Valid_loss 1.039692
Epoch 35, Train Loss 0.934765, Valid_loss 1.037951
Epoch 36, Train Loss 0.936368, Valid_loss 1.039922
Epoch 37, Train Loss 0.923376, Valid_loss 1.048325
Epoch 38, Train Loss 0.960865, Valid_loss 1.023913
Epoch 39, Train Loss 0.943748, Valid_loss 1.027930
Epoch 40, Train Loss 0.943614, Valid_loss 1.025234
Epoch 41, Train Loss 0.953075, Valid_loss 1.045526
Epoch 42, Train Loss 0.943900, Valid_loss 1.028110
Epoch 43, Train Loss 0.939396, Valid_loss 1.028090
Epoch 44, Train Loss 0.934555, Valid_loss 1.027896
Epoch 45, Train Loss 0.940691, Valid_loss 1.034552
Epoch 46, Train Loss 0.941914, Valid_loss 1.027038
Epoch 47, Train Loss 0.933553, Valid_loss 1.029887
Epoch 48, Train Loss 0.935738, Valid_loss 1.022578
Epoch 49, Train Loss 0.943461, Valid_loss 1.042272
Epoch 50, Train Loss 0.937866, Valid_loss 1.032412
Epoch 51, Train Loss 0.930292, Valid_loss 1.030912
Epoch 52, Train Loss 0.935367, Valid_loss 1.029663
Epoch 53, Train Loss 0.937083, Valid_loss 1.034369
Epoch 54, Train Loss 0.936966, Valid_loss 1.035512
[I 2025-08-31 11:15:21,479] Trial 2 finished with value: 0.7127509642215002 and parameters: {'learning_rate': 0.01, 'epochs': 100, 'heads': 2, 'dropout': 0.3, 'weight_decay': 0.01, 'emb_dim': 64, 'augment_num': 100, 'pca': False}. Best is trial 1 with value: 0.4639556205698422.
선택된 trial params: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 4, 'dropout': 0.5, 'weight_decay': 0.0001, 'emb_dim': 32, 'augment_num': 100, 'pca': False}
👉 train samples(학습 샘플(bag))=141, batch_size=8 -> steps(샘플수/batch크기)=18
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=15, batch_size=1 -> steps=15
Memory Allocated: 26.13 MB
Memory Reserved: 36.00 MB
cuda
Epoch 1, Train Loss 1.103057, Valid_loss 0.994465
Epoch 2, Train Loss 0.992686, Valid_loss 0.987792
Epoch 3, Train Loss 0.931980, Valid_loss 0.956522
Epoch 4, Train Loss 0.890729, Valid_loss 0.878290
Epoch 5, Train Loss 0.795032, Valid_loss 0.757920
Epoch 6, Train Loss 0.747354, Valid_loss 0.682332
Epoch 7, Train Loss 0.739521, Valid_loss 0.718127
Epoch 8, Train Loss 0.664491, Valid_loss 0.627703
Epoch 9, Train Loss 0.605684, Valid_loss 0.600225
Epoch 10, Train Loss 0.619607, Valid_loss 0.587213
Epoch 11, Train Loss 0.608724, Valid_loss 0.540733
Epoch 12, Train Loss 0.577035, Valid_loss 0.566045
Epoch 13, Train Loss 0.571584, Valid_loss 0.598099
Epoch 14, Train Loss 0.584826, Valid_loss 0.553626
Epoch 15, Train Loss 0.521137, Valid_loss 0.595908
Epoch 16, Train Loss 0.527864, Valid_loss 0.537680
Epoch 17, Train Loss 0.508515, Valid_loss 0.557797
Epoch 18, Train Loss 0.521516, Valid_loss 0.574486
Epoch 19, Train Loss 0.499841, Valid_loss 0.518175
Epoch 20, Train Loss 0.499216, Valid_loss 0.605294
Epoch 21, Train Loss 0.529244, Valid_loss 0.493993
Epoch 22, Train Loss 0.510554, Valid_loss 0.519415
Epoch 23, Train Loss 0.527215, Valid_loss 0.529667
Epoch 24, Train Loss 0.448307, Valid_loss 0.505341
Epoch 25, Train Loss 0.483982, Valid_loss 0.563792
Epoch 26, Train Loss 0.451302, Valid_loss 0.489012
Epoch 27, Train Loss 0.463069, Valid_loss 0.538906
Epoch 28, Train Loss 0.470328, Valid_loss 0.599208
Epoch 29, Train Loss 0.481682, Valid_loss 0.482199
Epoch 30, Train Loss 0.442834, Valid_loss 0.578288
Epoch 31, Train Loss 0.435092, Valid_loss 0.567988
Epoch 32, Train Loss 0.433904, Valid_loss 0.476365
Epoch 33, Train Loss 0.405219, Valid_loss 0.503946
Epoch 34, Train Loss 0.403165, Valid_loss 0.485770
Epoch 35, Train Loss 0.388317, Valid_loss 0.506041
Epoch 36, Train Loss 0.390014, Valid_loss 0.644877
Epoch 37, Train Loss 0.402659, Valid_loss 0.462695
Epoch 38, Train Loss 0.425525, Valid_loss 0.522111
Epoch 39, Train Loss 0.404152, Valid_loss 0.463534
Epoch 40, Train Loss 0.374163, Valid_loss 0.676663
Epoch 41, Train Loss 0.400075, Valid_loss 0.541082
Epoch 42, Train Loss 0.363669, Valid_loss 0.515993
Epoch 43, Train Loss 0.384076, Valid_loss 0.544329
Epoch 44, Train Loss 0.374404, Valid_loss 0.700911
Epoch 45, Train Loss 0.373654, Valid_loss 0.518733
Epoch 46, Train Loss 0.353146, Valid_loss 0.578257
Epoch 47, Train Loss 0.332561, Valid_loss 0.516733
Epoch 48, Train Loss 0.327816, Valid_loss 0.549672
Epoch 49, Train Loss 0.308158, Valid_loss 0.589218
Epoch 50, Train Loss 0.361711, Valid_loss 0.570401
Epoch 51, Train Loss 0.296873, Valid_loss 0.501971
Epoch 52, Train Loss 0.364301, Valid_loss 0.527568
Epoch 53, Train Loss 0.290401, Valid_loss 0.504792
Epoch 54, Train Loss 0.316479, Valid_loss 0.508296
Epoch 55, Train Loss 0.284012, Valid_loss 0.592689
환자ID=163-2 -- true: [[0]] -- pred: tensor([[ 2.2136, -0.7563, -1.0682]], device='cuda:0')
환자ID=163-3 -- true: [[0]] -- pred: tensor([[-0.1691,  1.8282, -0.8024]], device='cuda:0')
환자ID=164-6 -- true: [[0]] -- pred: tensor([[ 2.1499, -0.6237, -1.2763]], device='cuda:0')
환자ID=28-10051 -- true: [[1]] -- pred: tensor([[-0.0374,  0.6956, -0.5196]], device='cuda:0')
환자ID=28-12490 -- true: [[1]] -- pred: tensor([[-0.5766,  1.6337, -0.6627]], device='cuda:0')
환자ID=28-12518 -- true: [[1]] -- pred: tensor([[-0.3685,  1.7497, -0.7891]], device='cuda:0')
환자ID=29-10380 -- true: [[1]] -- pred: tensor([[-0.5423,  1.6254, -0.5142]], device='cuda:0')
환자ID=29-10398 -- true: [[1]] -- pred: tensor([[-0.9499,  1.1073,  0.0180]], device='cuda:0')
환자ID=29-10400 -- true: [[1]] -- pred: tensor([[-0.3749,  1.5769, -0.6623]], device='cuda:0')
환자ID=30-10034 -- true: [[2]] -- pred: tensor([[ 0.6611,  0.3734, -0.8825]], device='cuda:0')
환자ID=30-10929 -- true: [[2]] -- pred: tensor([[-1.0204,  0.8966,  0.2069]], device='cuda:0')
환자ID=31-10013 -- true: [[1]] -- pred: tensor([[-0.3285,  0.9720, -0.3639]], device='cuda:0')
환자ID=32-10034 -- true: [[2]] -- pred: tensor([[-0.8095,  1.2649, -0.1403]], device='cuda:0')
환자ID=Sample1153-EO2 -- true: [[0]] -- pred: tensor([[ 2.1666, -0.6714, -1.2090]], device='cuda:0')
환자ID=Sample1157-EO3 -- true: [[0]] -- pred: tensor([[ 2.0430, -0.4384, -1.3526]], device='cuda:0')
Best performance: Epoch 37, Loss 0.402659, Test ACC 0.733333, Test AUC 0.882540, Test Recall 0.600000, Test Precision 0.500000
Confusion Matrix:
 [[4 1 0]
 [0 7 0]
 [1 2 0]]
✅ Total valid splits used: 4
🔁 Repeat 3, Fold 4
cell type :  S2008000605HRT_AAACCCAGTGCACATT-1     Epithelial_cells
S2008000605HRT_AAACCCAGTGCCTACG-1     Epithelial_cells
S2008000605HRT_AAAGAACGTAGAGACC-1            Astrocyte
S2008000605HRT_AAAGAACGTCGGAACA-1     Epithelial_cells
S2008000605HRT_AAAGAACGTTAACAGA-1     Epithelial_cells
                                           ...        
Sample1162EO2_TTTGGAGAGCAGGCAT-1      Epithelial_cells
Sample1162EO2_TTTGGAGAGTCGCGAA-1     Endothelial_cells
Sample1162EO2_TTTGGAGAGTGCTCGC-1           Hepatocytes
Sample1162EO2_TTTGGAGGTGATACTC-1      Epithelial_cells
Sample1162EO2_TTTGGTTCAGTAGAAT-1      Epithelial_cells
Name: singler_annotation, Length: 169552, dtype: string
cell type annotation :  S2008000605HRT_AAACCCAGTGCACATT-1     Epithelial_cells
S2008000605HRT_AAACCCAGTGCCTACG-1     Epithelial_cells
S2008000605HRT_AAAGAACGTAGAGACC-1            Astrocyte
S2008000605HRT_AAAGAACGTCGGAACA-1     Epithelial_cells
S2008000605HRT_AAAGAACGTTAACAGA-1     Epithelial_cells
                                           ...        
Sample1162EO2_TTTGGAGAGCAGGCAT-1      Epithelial_cells
Sample1162EO2_TTTGGAGAGTCGCGAA-1     Endothelial_cells
Sample1162EO2_TTTGGAGAGTGCTCGC-1           Hepatocytes
Sample1162EO2_TTTGGAGGTGATACTC-1      Epithelial_cells
Sample1162EO2_TTTGGTTCAGTAGAAT-1      Epithelial_cells
Name: singler_annotation, Length: 169552, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Epithelial_cells', 'Astrocyte', 'MSC', 'Keratinocytes', 'Neurons', 'Endothelial_cells', 'Fibroblasts', 'Tissue_stem_cells', 'Smooth_muscle_cells', 'T_cells', 'Neuroepithelial_cell', 'NK_cell', 'Chondrocytes', 'Osteoblasts', 'Monocyte', 'Hepatocytes', 'Macrophage', 'CMP', 'Embryonic_stem_cells', 'DC', 'BM & Prog.', 'MEP', 'Neutrophils', 'Pro-Myelocyte', 'iPS_cells', 'Pre-B_cell_CD34-', 'HSC_-G-CSF', 'B_cell', 'GMP', 'HSC_CD34+', 'Platelets', 'Pro-B_cell_CD34+', 'Myelocyte', 'BM', 'Unknown', 'Erythroblast', 'Gametocytes']
라벨별 그룹 개수 {0: 21, 1: 30, 2: 11}
cell type :  S2008006722HRT_AAACGCTTCGGCTCTT-1       Tissue_stem_cells
S2008006722HRT_AAAGAACGTACTCCCT-1       Endothelial_cells
S2008006722HRT_AAAGAACGTATGTCAC-1               Astrocyte
S2008006722HRT_AAAGGATTCATCGCCT-1    Embryonic_stem_cells
S2008006722HRT_AAAGGGCTCGTCGCTT-1        Epithelial_cells
                                             ...         
Sample1162EO1_TTTCACAAGGGCAGAG-1                iPS_cells
Sample1162EO1_TTTCCTCAGCGTGCCT-1              Hepatocytes
Sample1162EO1_TTTCCTCAGTACTGTC-1         Epithelial_cells
Sample1162EO1_TTTGGTTTCCACATAG-1              Hepatocytes
Sample1162EO1_TTTGTTGCACACGCCA-1         Epithelial_cells
Name: singler_annotation, Length: 55625, dtype: string
cell type annotation :  S2008006722HRT_AAACGCTTCGGCTCTT-1       Tissue_stem_cells
S2008006722HRT_AAAGAACGTACTCCCT-1       Endothelial_cells
S2008006722HRT_AAAGAACGTATGTCAC-1               Astrocyte
S2008006722HRT_AAAGGATTCATCGCCT-1    Embryonic_stem_cells
S2008006722HRT_AAAGGGCTCGTCGCTT-1        Epithelial_cells
                                             ...         
Sample1162EO1_TTTCACAAGGGCAGAG-1                iPS_cells
Sample1162EO1_TTTCCTCAGCGTGCCT-1              Hepatocytes
Sample1162EO1_TTTCCTCAGTACTGTC-1         Epithelial_cells
Sample1162EO1_TTTGGTTTCCACATAG-1              Hepatocytes
Sample1162EO1_TTTGTTGCACACGCCA-1         Epithelial_cells
Name: singler_annotation, Length: 55625, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Tissue_stem_cells', 'Endothelial_cells', 'Astrocyte', 'Embryonic_stem_cells', 'Epithelial_cells', 'Hepatocytes', 'Smooth_muscle_cells', 'Neurons', 'Fibroblasts', 'NK_cell', 'Keratinocytes', 'Neuroepithelial_cell', 'MEP', 'Pre-B_cell_CD34-', 'Monocyte', 'Pro-Myelocyte', 'MSC', 'CMP', 'BM & Prog.', 'BM', 'Macrophage', 'Chondrocytes', 'iPS_cells', 'T_cells', 'HSC_-G-CSF', 'Erythroblast', 'Osteoblasts', 'DC', 'GMP', 'Pro-B_cell_CD34+', 'B_cell', 'Neutrophils', 'HSC_CD34+', 'Platelets', 'Myelocyte', 'Unknown', 'Gametocytes']
라벨별 그룹 개수 {0: 5, 1: 7, 2: 3}
🔍 Split #5
  → train_p_index 환자 수 (환자 단위로 묶인 index list): 62
  → test_p_index 환자 수  (환자 단위로 묶인 index list): 15
  → train 환자 ID: ['163-2', '163-3', '163-4', '163-5', '164-10', '164-6', '165-9', '27-10039', '27-10041', '27-10112', '28-10051', '28-11515', '28-12263', '28-12381', '28-12490', '28-12518', '29-10008', '29-10010', '29-10011', '29-10016', '29-10280', '29-10380', '29-10386', '29-10398', '29-10400', '29-10404', '29-10406', '29-10410', '30-10018', '30-10034', '30-10123', '30-10125', '30-10929', '30-11051', '31-10000', '31-10001', '31-10013', '31-10035', '31-10040', '31-10042', '31-10078', '31-10210', '31-10236', '32-10003', '32-10034', '33-10005', '34-10184', '34-10187', 'PRE018-1', 'PRE027', 'PRE055-1', 'PRE062-1', 'PRE98sc', 'Sample1153-EO1', 'Sample1153-EO2', 'Sample1153-EO3', 'Sample1157-EO1', 'Sample1157-EO3', 'Sample1158-EO1', 'Sample1158-EO2', 'Sample1158-EO3', 'Sample1162-EO2']
  → test  환자 ID: ['164-3', '27-10053', '27-10071', '27-10119', '29-10006', '29-10012', '29-10013', '31-10154', '32-10074', '33-10006', '34-10050', 'PRE019', 'PRE038', 'Sample1157-EO2', 'Sample1162-EO1']
  → train 환자 ID 및 라벨:
    ID: 163-2, Label: 0
    ID: 163-3, Label: 0
    ID: 163-4, Label: 0
    ID: 163-5, Label: 0
    ID: 164-10, Label: 0
    ID: 164-6, Label: 0
    ID: 165-9, Label: 0
    ID: 27-10039, Label: 1
    ID: 27-10041, Label: 1
    ID: 27-10112, Label: 1
    ID: 28-10051, Label: 1
    ID: 28-11515, Label: 1
    ID: 28-12263, Label: 1
    ID: 28-12381, Label: 1
    ID: 28-12490, Label: 1
    ID: 28-12518, Label: 1
    ID: 29-10008, Label: 1
    ID: 29-10010, Label: 1
    ID: 29-10011, Label: 1
    ID: 29-10016, Label: 1
    ID: 29-10280, Label: 1
    ID: 29-10380, Label: 1
    ID: 29-10386, Label: 1
    ID: 29-10398, Label: 1
    ID: 29-10400, Label: 1
    ID: 29-10404, Label: 1
    ID: 29-10406, Label: 1
    ID: 29-10410, Label: 1
    ID: 30-10018, Label: 2
    ID: 30-10034, Label: 2
    ID: 30-10123, Label: 2
    ID: 30-10125, Label: 2
    ID: 30-10929, Label: 2
    ID: 30-11051, Label: 2
    ID: 31-10000, Label: 1
    ID: 31-10001, Label: 1
    ID: 31-10013, Label: 1
    ID: 31-10035, Label: 1
    ID: 31-10040, Label: 1
    ID: 31-10042, Label: 1
    ID: 31-10078, Label: 1
    ID: 31-10210, Label: 1
    ID: 31-10236, Label: 1
    ID: 32-10003, Label: 2
    ID: 32-10034, Label: 2
    ID: 33-10005, Label: 2
    ID: 34-10184, Label: 2
    ID: 34-10187, Label: 2
    ID: PRE018-1, Label: 0
    ID: PRE027, Label: 0
    ID: PRE055-1, Label: 0
    ID: PRE062-1, Label: 0
    ID: PRE98sc, Label: 0
    ID: Sample1153-EO1, Label: 0
    ID: Sample1153-EO2, Label: 0
    ID: Sample1153-EO3, Label: 0
    ID: Sample1157-EO1, Label: 0
    ID: Sample1157-EO3, Label: 0
    ID: Sample1158-EO1, Label: 0
    ID: Sample1158-EO2, Label: 0
    ID: Sample1158-EO3, Label: 0
    ID: Sample1162-EO2, Label: 0
  → test 환자 ID 및 라벨:
    ID: 164-3, Label: 0
    ID: 27-10053, Label: 1
    ID: 27-10071, Label: 1
    ID: 27-10119, Label: 1
    ID: 29-10006, Label: 1
    ID: 29-10012, Label: 1
    ID: 29-10013, Label: 1
    ID: 31-10154, Label: 1
    ID: 32-10074, Label: 2
    ID: 33-10006, Label: 2
    ID: 34-10050, Label: 2
    ID: PRE019, Label: 0
    ID: PRE038, Label: 0
    ID: Sample1157-EO2, Label: 0
    ID: Sample1162-EO1, Label: 0
전체 데이터 index 길이 77
label_stat (train 환자 라벨 목록) 갯수 62
train_data에서 환자 단위로, train과 validation 나누기
기존 train_p_index 62
기존 (train) label_stat 62
train-vali 분할 후! 
train y 의 classes : {0, 1, 2} valid y 의 classes : {0, 1, 2} label_stat 의 classes : {0, 1, 2}
train_p_index_ 41
valid_p_index 21
test_p_index 15
→ train 환자 ID 및 라벨:
   총 개수: 41
   환자ID=29-10380, Label=1, 셀개수=4799
   환자ID=31-10040, Label=1, 셀개수=4543
   환자ID=34-10184, Label=2, 셀개수=2699
   환자ID=31-10210, Label=1, 셀개수=3510
   환자ID=Sample1158-EO1, Label=0, 셀개수=574
   환자ID=163-5, Label=0, 셀개수=1210
   환자ID=29-10010, Label=1, 셀개수=5305
   환자ID=PRE055-1, Label=0, 셀개수=597
   환자ID=30-11051, Label=2, 셀개수=2454
   환자ID=30-10125, Label=2, 셀개수=3798
   환자ID=163-3, Label=0, 셀개수=1335
   환자ID=28-11515, Label=1, 셀개수=930
   환자ID=165-9, Label=0, 셀개수=2926
   환자ID=27-10039, Label=1, 셀개수=4638
   환자ID=163-2, Label=0, 셀개수=2535
   환자ID=30-10018, Label=2, 셀개수=5170
   환자ID=31-10001, Label=1, 셀개수=1133
   환자ID=30-10123, Label=2, 셀개수=1273
   환자ID=Sample1158-EO2, Label=0, 셀개수=1427
   환자ID=29-10398, Label=1, 셀개수=3993
   환자ID=31-10000, Label=1, 셀개수=8870
   환자ID=163-4, Label=0, 셀개수=1339
   환자ID=31-10078, Label=1, 셀개수=2827
   환자ID=PRE98sc, Label=0, 셀개수=1568
   환자ID=29-10406, Label=1, 셀개수=3484
   환자ID=28-12381, Label=1, 셀개수=1099
   환자ID=Sample1158-EO3, Label=0, 셀개수=1096
   환자ID=31-10013, Label=1, 셀개수=3161
   환자ID=34-10187, Label=2, 셀개수=3739
   환자ID=28-10051, Label=1, 셀개수=300
   환자ID=29-10008, Label=1, 셀개수=1913
   환자ID=28-12263, Label=1, 셀개수=7527
   환자ID=164-6, Label=0, 셀개수=3038
   환자ID=29-10404, Label=1, 셀개수=3988
   환자ID=33-10005, Label=2, 셀개수=8904
   환자ID=29-10386, Label=1, 셀개수=802
   환자ID=32-10003, Label=2, 셀개수=2978
   환자ID=31-10236, Label=1, 셀개수=3458
   환자ID=31-10042, Label=1, 셀개수=1222
   환자ID=29-10280, Label=1, 셀개수=2375
   환자ID=28-12518, Label=1, 셀개수=1215
→ valid 환자 ID 및 라벨:
   총 개수: 21
   환자ID=Sample1162-EO2, Label=0, 셀개수=1510
   환자ID=29-10016, Label=1, 셀개수=4854
   환자ID=31-10035, Label=1, 셀개수=2974
   환자ID=Sample1153-EO1, Label=0, 셀개수=911
   환자ID=32-10034, Label=2, 셀개수=1555
   환자ID=PRE062-1, Label=0, 셀개수=907
   환자ID=Sample1157-EO1, Label=0, 셀개수=1152
   환자ID=30-10034, Label=2, 셀개수=1240
   환자ID=30-10929, Label=2, 셀개수=5812
   환자ID=29-10410, Label=1, 셀개수=2834
   환자ID=Sample1157-EO3, Label=0, 셀개수=807
   환자ID=27-10112, Label=1, 셀개수=1470
   환자ID=29-10400, Label=1, 셀개수=2684
   환자ID=Sample1153-EO2, Label=0, 셀개수=916
   환자ID=PRE027, Label=0, 셀개수=2078
   환자ID=PRE018-1, Label=0, 셀개수=1349
   환자ID=164-10, Label=0, 셀개수=4041
   환자ID=29-10011, Label=1, 셀개수=3072
   환자ID=27-10041, Label=1, 셀개수=2145
   환자ID=28-12490, Label=1, 셀개수=5973
   환자ID=Sample1153-EO3, Label=0, 셀개수=1516
→ test 환자 ID 및 라벨:
   총 개수: 15
   환자ID=164-3, Label=0, 셀개수=1639
   환자ID=27-10053, Label=1, 셀개수=728
   환자ID=27-10071, Label=1, 셀개수=1478
   환자ID=27-10119, Label=1, 셀개수=3346
   환자ID=29-10006, Label=1, 셀개수=11461
   환자ID=29-10012, Label=1, 셀개수=6245
   환자ID=29-10013, Label=1, 셀개수=3706
   환자ID=31-10154, Label=1, 셀개수=6568
   환자ID=32-10074, Label=2, 셀개수=6304
   환자ID=33-10006, Label=2, 셀개수=457
   환자ID=34-10050, Label=2, 셀개수=4784
   환자ID=PRE019, Label=0, 셀개수=3795
   환자ID=PRE038, Label=0, 셀개수=2666
   환자ID=Sample1157-EO2, Label=0, 셀개수=1395
   환자ID=Sample1162-EO1, Label=0, 셀개수=1053
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Epithelial_cells', 'Epithelial_cells', 'Astrocyte', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'MSC', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
전체 데이터 길이 225177
전체 cell type 길이 0         Epithelial_cells
1         Epithelial_cells
2                Astrocyte
3         Epithelial_cells
4         Epithelial_cells
                ...       
225172           iPS_cells
225173         Hepatocytes
225174    Epithelial_cells
225175         Hepatocytes
225176    Epithelial_cells
Length: 225177, dtype: string
cell type의 NaN 개수 체크 0
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:11,  8.87it/s]  3%|▎         | 3/100 [00:00<00:09,  9.81it/s]  4%|▍         | 4/100 [00:00<00:09,  9.78it/s]  6%|▌         | 6/100 [00:00<00:09,  9.74it/s]  7%|▋         | 7/100 [00:00<00:12,  7.21it/s]  8%|▊         | 8/100 [00:00<00:11,  7.74it/s]  9%|▉         | 9/100 [00:01<00:11,  8.02it/s] 10%|█         | 10/100 [00:01<00:10,  8.38it/s] 11%|█         | 11/100 [00:01<00:10,  8.58it/s] 12%|█▏        | 12/100 [00:01<00:10,  8.70it/s] 13%|█▎        | 13/100 [00:01<00:09,  8.74it/s] 14%|█▍        | 14/100 [00:01<00:09,  8.83it/s] 15%|█▌        | 15/100 [00:01<00:09,  8.58it/s] 16%|█▌        | 16/100 [00:01<00:09,  8.61it/s] 17%|█▋        | 17/100 [00:01<00:09,  8.51it/s] 18%|█▊        | 18/100 [00:02<00:09,  8.60it/s] 19%|█▉        | 19/100 [00:02<00:09,  8.75it/s] 20%|██        | 20/100 [00:02<00:09,  8.89it/s] 21%|██        | 21/100 [00:02<00:09,  8.42it/s] 23%|██▎       | 23/100 [00:02<00:08,  8.98it/s] 24%|██▍       | 24/100 [00:02<00:08,  9.10it/s] 25%|██▌       | 25/100 [00:02<00:08,  9.13it/s] 26%|██▌       | 26/100 [00:02<00:08,  9.23it/s] 27%|██▋       | 27/100 [00:03<00:07,  9.18it/s] 28%|██▊       | 28/100 [00:03<00:07,  9.18it/s] 29%|██▉       | 29/100 [00:03<00:07,  9.38it/s] 30%|███       | 30/100 [00:03<00:08,  8.30it/s] 31%|███       | 31/100 [00:03<00:08,  8.35it/s] 32%|███▏      | 32/100 [00:03<00:08,  8.35it/s] 33%|███▎      | 33/100 [00:03<00:07,  8.42it/s] 34%|███▍      | 34/100 [00:03<00:07,  8.46it/s] 35%|███▌      | 35/100 [00:04<00:07,  8.57it/s] 36%|███▌      | 36/100 [00:04<00:07,  8.68it/s] 37%|███▋      | 37/100 [00:04<00:07,  8.67it/s] 38%|███▊      | 38/100 [00:04<00:07,  8.80it/s] 39%|███▉      | 39/100 [00:04<00:06,  8.87it/s] 40%|████      | 40/100 [00:04<00:06,  8.99it/s] 41%|████      | 41/100 [00:04<00:06,  9.06it/s] 42%|████▏     | 42/100 [00:04<00:06,  8.99it/s] 43%|████▎     | 43/100 [00:04<00:06,  8.95it/s] 44%|████▍     | 44/100 [00:05<00:06,  8.60it/s] 45%|████▌     | 45/100 [00:05<00:06,  8.88it/s] 46%|████▌     | 46/100 [00:05<00:06,  8.72it/s] 47%|████▋     | 47/100 [00:05<00:06,  8.61it/s] 48%|████▊     | 48/100 [00:05<00:06,  8.58it/s] 49%|████▉     | 49/100 [00:05<00:05,  8.79it/s] 50%|█████     | 50/100 [00:05<00:05,  8.65it/s] 51%|█████     | 51/100 [00:05<00:05,  8.54it/s] 52%|█████▏    | 52/100 [00:05<00:05,  8.43it/s] 53%|█████▎    | 53/100 [00:06<00:05,  8.50it/s] 54%|█████▍    | 54/100 [00:06<00:05,  8.54it/s] 55%|█████▌    | 55/100 [00:06<00:05,  8.54it/s] 56%|█████▌    | 56/100 [00:06<00:05,  8.61it/s] 57%|█████▋    | 57/100 [00:06<00:04,  8.73it/s] 58%|█████▊    | 58/100 [00:06<00:04,  8.74it/s] 59%|█████▉    | 59/100 [00:06<00:04,  8.59it/s] 60%|██████    | 60/100 [00:06<00:04,  8.56it/s] 61%|██████    | 61/100 [00:07<00:04,  8.59it/s] 62%|██████▏   | 62/100 [00:07<00:04,  8.60it/s] 63%|██████▎   | 63/100 [00:07<00:04,  8.56it/s] 64%|██████▍   | 64/100 [00:07<00:04,  8.71it/s] 65%|██████▌   | 65/100 [00:07<00:04,  8.71it/s] 66%|██████▌   | 66/100 [00:07<00:04,  8.48it/s] 67%|██████▋   | 67/100 [00:07<00:03,  8.38it/s] 68%|██████▊   | 68/100 [00:07<00:03,  8.28it/s] 69%|██████▉   | 69/100 [00:07<00:03,  8.30it/s] 70%|███████   | 70/100 [00:08<00:03,  8.38it/s] 71%|███████   | 71/100 [00:08<00:03,  8.40it/s] 72%|███████▏  | 72/100 [00:08<00:03,  8.38it/s] 73%|███████▎  | 73/100 [00:08<00:03,  8.33it/s] 74%|███████▍  | 74/100 [00:08<00:03,  8.41it/s] 75%|███████▌  | 75/100 [00:08<00:03,  8.17it/s] 76%|███████▌  | 76/100 [00:08<00:02,  8.23it/s] 77%|███████▋  | 77/100 [00:08<00:02,  7.90it/s] 78%|███████▊  | 78/100 [00:09<00:02,  8.03it/s] 79%|███████▉  | 79/100 [00:09<00:02,  8.22it/s] 80%|████████  | 80/100 [00:09<00:02,  8.46it/s] 81%|████████  | 81/100 [00:09<00:02,  8.38it/s] 82%|████████▏ | 82/100 [00:09<00:02,  6.61it/s] 83%|████████▎ | 83/100 [00:09<00:02,  7.07it/s] 84%|████████▍ | 84/100 [00:09<00:02,  7.29it/s] 85%|████████▌ | 85/100 [00:10<00:01,  7.53it/s] 86%|████████▌ | 86/100 [00:10<00:01,  7.57it/s] 87%|████████▋ | 87/100 [00:10<00:01,  7.75it/s] 88%|████████▊ | 88/100 [00:10<00:01,  7.85it/s] 89%|████████▉ | 89/100 [00:10<00:01,  7.44it/s] 90%|█████████ | 90/100 [00:10<00:01,  7.63it/s] 91%|█████████ | 91/100 [00:10<00:01,  7.78it/s] 92%|█████████▏| 92/100 [00:10<00:01,  7.87it/s] 93%|█████████▎| 93/100 [00:11<00:00,  7.55it/s] 94%|█████████▍| 94/100 [00:11<00:00,  7.75it/s] 95%|█████████▌| 95/100 [00:11<00:00,  7.67it/s] 96%|█████████▌| 96/100 [00:11<00:00,  7.83it/s] 97%|█████████▋| 97/100 [00:11<00:00,  7.90it/s] 98%|█████████▊| 98/100 [00:11<00:00,  7.84it/s] 99%|█████████▉| 99/100 [00:11<00:00,  7.77it/s]100%|██████████| 100/100 [00:12<00:00,  6.72it/s]100%|██████████| 100/100 [00:12<00:00,  8.32it/s]
[I 2025-08-31 11:24:50,026] A new study created in memory with name: no-name-665de3ce-d68c-468b-bb83-c649a2ef7ebc
👉 train samples(학습 샘플(bag))=141, batch_size=8 -> steps(샘플수/batch크기)=18
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 26.13 MB
Memory Reserved: 36.00 MB
cuda
Epoch 1, Train Loss 0.943369, Valid_loss 1.066870
Epoch 2, Train Loss 0.950114, Valid_loss 1.006754
Epoch 3, Train Loss 0.886119, Valid_loss 0.952392
Epoch 4, Train Loss 0.823792, Valid_loss 0.636733
Epoch 5, Train Loss 0.688723, Valid_loss 0.526125
Epoch 6, Train Loss 0.734827, Valid_loss 0.876756
Epoch 7, Train Loss 0.682901, Valid_loss 0.539442
Epoch 8, Train Loss 0.599843, Valid_loss 0.517561
Epoch 9, Train Loss 0.475651, Valid_loss 0.537314
Epoch 10, Train Loss 0.620336, Valid_loss 0.458803
Epoch 11, Train Loss 0.459219, Valid_loss 0.563173
Epoch 12, Train Loss 0.483493, Valid_loss 0.541111
Epoch 13, Train Loss 0.511541, Valid_loss 0.490772
Epoch 14, Train Loss 0.515161, Valid_loss 0.601697
Epoch 15, Train Loss 0.454860, Valid_loss 0.422000
Epoch 16, Train Loss 0.423067, Valid_loss 0.496129
Epoch 17, Train Loss 0.426602, Valid_loss 0.754254
Epoch 18, Train Loss 0.422211, Valid_loss 0.490577
Epoch 19, Train Loss 0.399437, Valid_loss 0.411817
Epoch 20, Train Loss 0.339842, Valid_loss 0.477235
Epoch 21, Train Loss 0.356888, Valid_loss 0.490968
Epoch 22, Train Loss 0.374437, Valid_loss 0.547991
Epoch 23, Train Loss 0.313484, Valid_loss 0.562886
Epoch 24, Train Loss 0.270792, Valid_loss 0.599262
Epoch 25, Train Loss 0.331758, Valid_loss 0.682037
Epoch 26, Train Loss 0.255569, Valid_loss 0.716629
Epoch 27, Train Loss 0.290083, Valid_loss 0.582300
Epoch 28, Train Loss 0.244078, Valid_loss 0.469181
Epoch 29, Train Loss 0.243246, Valid_loss 0.609766
Epoch 30, Train Loss 0.420019, Valid_loss 0.560917
Epoch 31, Train Loss 0.279925, Valid_loss 0.699637
Epoch 32, Train Loss 0.199428, Valid_loss 0.568219
Epoch 33, Train Loss 0.206507, Valid_loss 0.632984
Epoch 34, Train Loss 0.236578, Valid_loss 0.716437
Epoch 35, Train Loss 0.212035, Valid_loss 0.674381
Epoch 36, Train Loss 0.191162, Valid_loss 0.741220
Epoch 37, Train Loss 0.198923, Valid_loss 0.640823
Epoch 38, Train Loss 0.254124, Valid_loss 0.571106
Epoch 39, Train Loss 0.150697, Valid_loss 0.658411
Epoch 40, Train Loss 0.170458, Valid_loss 0.768936
Epoch 41, Train Loss 0.163321, Valid_loss 0.737149
Epoch 42, Train Loss 0.143372, Valid_loss 0.704559
Epoch 43, Train Loss 0.159496, Valid_loss 0.817818
Epoch 44, Train Loss 0.233732, Valid_loss 0.955437
Epoch 45, Train Loss 0.189040, Valid_loss 0.757433
Epoch 46, Train Loss 0.150665, Valid_loss 0.713152
Epoch 47, Train Loss 0.201787, Valid_loss 0.728274
Epoch 48, Train Loss 0.225027, Valid_loss 0.707529
Epoch 49, Train Loss 0.162251, Valid_loss 0.710597
Epoch 50, Train Loss 0.193219, Valid_loss 0.705087
Epoch 51, Train Loss 0.183399, Valid_loss 1.013088
Epoch 52, Train Loss 0.130556, Valid_loss 0.737459
Epoch 53, Train Loss 0.161177, Valid_loss 0.982597
Epoch 54, Train Loss 0.129525, Valid_loss 0.724519
Epoch 55, Train Loss 0.117051, Valid_loss 0.898411
Epoch 56, Train Loss 0.121342, Valid_loss 0.764514
Epoch 57, Train Loss 0.121056, Valid_loss 0.725480
Epoch 58, Train Loss 0.129876, Valid_loss 0.777279
Epoch 59, Train Loss 0.172782, Valid_loss 0.832138
[I 2025-08-31 11:31:50,891] Trial 0 finished with value: 0.41181700995990206 and parameters: {'learning_rate': 0.001, 'epochs': 100, 'heads': 2, 'dropout': 0.5, 'weight_decay': 0.0001, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.41181700995990206.
👉 train samples(학습 샘플(bag))=141, batch_size=8 -> steps(샘플수/batch크기)=18
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 24.81 MB
Memory Reserved: 36.00 MB
cuda
Epoch 1, Train Loss 1.072911, Valid_loss 1.020487
Epoch 2, Train Loss 1.008095, Valid_loss 1.020821
Epoch 3, Train Loss 0.987675, Valid_loss 1.021315
Epoch 4, Train Loss 0.971511, Valid_loss 1.024546
Epoch 5, Train Loss 0.936758, Valid_loss 1.021839
Epoch 6, Train Loss 0.959697, Valid_loss 1.007182
Epoch 7, Train Loss 0.913681, Valid_loss 0.958890
Epoch 8, Train Loss 0.856638, Valid_loss 0.856027
Epoch 9, Train Loss 0.823532, Valid_loss 0.788924
Epoch 10, Train Loss 0.846323, Valid_loss 0.938379
Epoch 11, Train Loss 0.893101, Valid_loss 0.734693
Epoch 12, Train Loss 0.799929, Valid_loss 0.719058
Epoch 13, Train Loss 0.713815, Valid_loss 0.687472
Epoch 14, Train Loss 0.743959, Valid_loss 0.649902
Epoch 15, Train Loss 0.697894, Valid_loss 0.593163
Epoch 16, Train Loss 0.622866, Valid_loss 0.623866
Epoch 17, Train Loss 0.588761, Valid_loss 0.562423
Epoch 18, Train Loss 0.598100, Valid_loss 0.627484
Epoch 19, Train Loss 0.607171, Valid_loss 0.579479
Epoch 20, Train Loss 0.552672, Valid_loss 0.797165
Epoch 21, Train Loss 0.519335, Valid_loss 0.555517
Epoch 22, Train Loss 0.538931, Valid_loss 0.647230
Epoch 23, Train Loss 0.513800, Valid_loss 0.507856
Epoch 24, Train Loss 0.536372, Valid_loss 0.485250
Epoch 25, Train Loss 0.509976, Valid_loss 0.446446
Epoch 26, Train Loss 0.481945, Valid_loss 0.471022
Epoch 27, Train Loss 0.479016, Valid_loss 0.500626
Epoch 28, Train Loss 0.459597, Valid_loss 0.491584
Epoch 29, Train Loss 0.466321, Valid_loss 0.431974
Epoch 30, Train Loss 0.456946, Valid_loss 0.590016
Epoch 31, Train Loss 0.436055, Valid_loss 0.517149
Epoch 32, Train Loss 0.406615, Valid_loss 0.541103
Epoch 33, Train Loss 0.439831, Valid_loss 0.520150
Epoch 34, Train Loss 0.416934, Valid_loss 0.449329
Epoch 35, Train Loss 0.433312, Valid_loss 0.450902
Epoch 36, Train Loss 0.368131, Valid_loss 0.459165
Epoch 37, Train Loss 0.423344, Valid_loss 0.406758
Epoch 38, Train Loss 0.499465, Valid_loss 0.483785
Epoch 39, Train Loss 0.455815, Valid_loss 0.718662
Epoch 40, Train Loss 0.390009, Valid_loss 0.607796
Epoch 41, Train Loss 0.406466, Valid_loss 0.461811
Epoch 42, Train Loss 0.365488, Valid_loss 0.467821
Epoch 43, Train Loss 0.390950, Valid_loss 0.475443
Epoch 44, Train Loss 0.334130, Valid_loss 0.432119
Epoch 45, Train Loss 0.368500, Valid_loss 0.475475
Epoch 46, Train Loss 0.282807, Valid_loss 0.488557
Epoch 47, Train Loss 0.343279, Valid_loss 0.803897
Epoch 48, Train Loss 0.394411, Valid_loss 0.688660
Epoch 49, Train Loss 0.318054, Valid_loss 0.521771
Epoch 50, Train Loss 0.319850, Valid_loss 0.633615
Epoch 51, Train Loss 0.297137, Valid_loss 0.560319
Epoch 52, Train Loss 0.277031, Valid_loss 0.533122
Epoch 53, Train Loss 0.302932, Valid_loss 0.611915
Epoch 54, Train Loss 0.289249, Valid_loss 0.618774
[I 2025-08-31 11:38:16,766] Trial 1 finished with value: 0.4067582067634378 and parameters: {'learning_rate': 0.001, 'epochs': 100, 'heads': 2, 'dropout': 0.3, 'weight_decay': 0.0001, 'emb_dim': 8, 'augment_num': 100, 'pca': False}. Best is trial 1 with value: 0.4067582067634378.
👉 train samples(학습 샘플(bag))=141, batch_size=8 -> steps(샘플수/batch크기)=18
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 26.13 MB
Memory Reserved: 36.00 MB
cuda
Epoch 1, Train Loss 1.045189, Valid_loss 1.019003
Epoch 2, Train Loss 0.914262, Valid_loss 0.961334
Epoch 3, Train Loss 0.902712, Valid_loss 0.889056
Epoch 4, Train Loss 0.869209, Valid_loss 0.831688
Epoch 5, Train Loss 0.792299, Valid_loss 0.837350
Epoch 6, Train Loss 0.827781, Valid_loss 0.705259
Epoch 7, Train Loss 0.703020, Valid_loss 0.687380
Epoch 8, Train Loss 0.695629, Valid_loss 0.748253
Epoch 9, Train Loss 0.699479, Valid_loss 0.633265
Epoch 10, Train Loss 0.644350, Valid_loss 0.568473
Epoch 11, Train Loss 0.640560, Valid_loss 0.544950
Epoch 12, Train Loss 0.596439, Valid_loss 0.545049
Epoch 13, Train Loss 0.589534, Valid_loss 0.603003
Epoch 14, Train Loss 0.553009, Valid_loss 0.505849
Epoch 15, Train Loss 0.598551, Valid_loss 0.594290
Epoch 16, Train Loss 0.592628, Valid_loss 0.552199
Epoch 17, Train Loss 0.633866, Valid_loss 0.508475
Epoch 18, Train Loss 0.529807, Valid_loss 0.475102
Epoch 19, Train Loss 0.556903, Valid_loss 0.621014
Epoch 20, Train Loss 0.500216, Valid_loss 0.487103
Epoch 21, Train Loss 0.458239, Valid_loss 0.472310
Epoch 22, Train Loss 0.533725, Valid_loss 0.478119
Epoch 23, Train Loss 0.495815, Valid_loss 0.486205
Epoch 24, Train Loss 0.482254, Valid_loss 0.609161
Epoch 25, Train Loss 0.537457, Valid_loss 0.449942
Epoch 26, Train Loss 0.507292, Valid_loss 0.528205
Epoch 27, Train Loss 0.458797, Valid_loss 0.581541
Epoch 28, Train Loss 0.446883, Valid_loss 0.489347
Epoch 29, Train Loss 0.456726, Valid_loss 0.474244
Epoch 30, Train Loss 0.493420, Valid_loss 0.483298
Epoch 31, Train Loss 0.471545, Valid_loss 0.430053
Epoch 32, Train Loss 0.460997, Valid_loss 0.483487
Epoch 33, Train Loss 0.443803, Valid_loss 0.409805
Epoch 34, Train Loss 0.436174, Valid_loss 0.586513
Epoch 35, Train Loss 0.434482, Valid_loss 0.446731
Epoch 36, Train Loss 0.438232, Valid_loss 0.553267
Epoch 37, Train Loss 0.384213, Valid_loss 0.402035
Epoch 38, Train Loss 0.412969, Valid_loss 0.532101
Epoch 39, Train Loss 0.455642, Valid_loss 0.503378
Epoch 40, Train Loss 0.435341, Valid_loss 0.472179
Epoch 41, Train Loss 0.396369, Valid_loss 0.454432
Epoch 42, Train Loss 0.382461, Valid_loss 0.490497
Epoch 43, Train Loss 0.403788, Valid_loss 0.528978
Epoch 44, Train Loss 0.419877, Valid_loss 0.624626
Epoch 45, Train Loss 0.401513, Valid_loss 0.439684
Epoch 46, Train Loss 0.370316, Valid_loss 0.526816
Epoch 47, Train Loss 0.363222, Valid_loss 0.497480
Epoch 48, Train Loss 0.411248, Valid_loss 0.480577
Epoch 49, Train Loss 0.371179, Valid_loss 0.441285
Epoch 50, Train Loss 0.352445, Valid_loss 0.651241
Epoch 51, Train Loss 0.352229, Valid_loss 0.396444
Epoch 52, Train Loss 0.386430, Valid_loss 0.466990
Epoch 53, Train Loss 0.330641, Valid_loss 0.478211
[I 2025-08-31 11:43:56,572] Trial 2 finished with value: 0.39644418266557513 and parameters: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 1, 'dropout': 0.5, 'weight_decay': 0.001, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 2 with value: 0.39644418266557513.
선택된 trial params: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 1, 'dropout': 0.5, 'weight_decay': 0.001, 'emb_dim': 32, 'augment_num': 100, 'pca': False}
👉 train samples(학습 샘플(bag))=141, batch_size=8 -> steps(샘플수/batch크기)=18
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=15, batch_size=1 -> steps=15
Memory Allocated: 26.13 MB
Memory Reserved: 36.00 MB
cuda
Epoch 1, Train Loss 1.125444, Valid_loss 1.080331
Epoch 2, Train Loss 0.921227, Valid_loss 1.004884
Epoch 3, Train Loss 0.923474, Valid_loss 0.996052
Epoch 4, Train Loss 0.827025, Valid_loss 0.932062
Epoch 5, Train Loss 0.816784, Valid_loss 0.826462
Epoch 6, Train Loss 0.749215, Valid_loss 0.751911
Epoch 7, Train Loss 0.735532, Valid_loss 0.714587
Epoch 8, Train Loss 0.729179, Valid_loss 0.685741
Epoch 9, Train Loss 0.723625, Valid_loss 0.633287
Epoch 10, Train Loss 0.692107, Valid_loss 0.634862
Epoch 11, Train Loss 0.596369, Valid_loss 0.643665
Epoch 12, Train Loss 0.593761, Valid_loss 0.614972
Epoch 13, Train Loss 0.591353, Valid_loss 0.585724
Epoch 14, Train Loss 0.540500, Valid_loss 0.575100
Epoch 15, Train Loss 0.535003, Valid_loss 0.604409
Epoch 16, Train Loss 0.562552, Valid_loss 0.576053
Epoch 17, Train Loss 0.544572, Valid_loss 0.559700
Epoch 18, Train Loss 0.493456, Valid_loss 0.544813
Epoch 19, Train Loss 0.536219, Valid_loss 0.715153
Epoch 20, Train Loss 0.509139, Valid_loss 0.605524
Epoch 21, Train Loss 0.498967, Valid_loss 0.536027
Epoch 22, Train Loss 0.461044, Valid_loss 0.567708
Epoch 23, Train Loss 0.487603, Valid_loss 0.557377
Epoch 24, Train Loss 0.484068, Valid_loss 0.597700
Epoch 25, Train Loss 0.456472, Valid_loss 0.562669
Epoch 26, Train Loss 0.473108, Valid_loss 0.502129
Epoch 27, Train Loss 0.396163, Valid_loss 0.563699
Epoch 28, Train Loss 0.406870, Valid_loss 0.520694
Epoch 29, Train Loss 0.415405, Valid_loss 0.571026
Epoch 30, Train Loss 0.389019, Valid_loss 0.536000
Epoch 31, Train Loss 0.444907, Valid_loss 0.555612
Epoch 32, Train Loss 0.354505, Valid_loss 0.512698
Epoch 33, Train Loss 0.398059, Valid_loss 0.501700
Epoch 34, Train Loss 0.423620, Valid_loss 0.574249
Epoch 35, Train Loss 0.428865, Valid_loss 0.528824
Epoch 36, Train Loss 0.406652, Valid_loss 0.512427
Epoch 37, Train Loss 0.411049, Valid_loss 0.511001
Epoch 38, Train Loss 0.394314, Valid_loss 0.554187
Epoch 39, Train Loss 0.358615, Valid_loss 0.563093
Epoch 40, Train Loss 0.405085, Valid_loss 0.492745
Epoch 41, Train Loss 0.358635, Valid_loss 0.562857
Epoch 42, Train Loss 0.387851, Valid_loss 0.512457
Epoch 43, Train Loss 0.329726, Valid_loss 0.525201
Epoch 44, Train Loss 0.358526, Valid_loss 0.612464
Epoch 45, Train Loss 0.359131, Valid_loss 0.492612
Epoch 46, Train Loss 0.367669, Valid_loss 0.605563
Epoch 47, Train Loss 0.298607, Valid_loss 0.529674
Epoch 48, Train Loss 0.328529, Valid_loss 0.574984
Epoch 49, Train Loss 0.430151, Valid_loss 0.484489
Epoch 50, Train Loss 0.410983, Valid_loss 0.567273
Epoch 51, Train Loss 0.307240, Valid_loss 0.548023
Epoch 52, Train Loss 0.325167, Valid_loss 0.502449
Epoch 53, Train Loss 0.375301, Valid_loss 0.542782
Epoch 54, Train Loss 0.314471, Valid_loss 0.545173
환자ID=164-3 -- true: [[0]] -- pred: tensor([[ 1.7836,  0.0466, -0.8243]], device='cuda:0')
환자ID=27-10053 -- true: [[1]] -- pred: tensor([[-1.2309,  2.1136, -1.0846]], device='cuda:0')
환자ID=27-10071 -- true: [[1]] -- pred: tensor([[-1.3346,  2.0921, -1.0290]], device='cuda:0')
환자ID=27-10119 -- true: [[1]] -- pred: tensor([[-1.1667,  2.0885, -1.1353]], device='cuda:0')
환자ID=29-10006 -- true: [[1]] -- pred: tensor([[-1.0408,  0.9739,  0.0063]], device='cuda:0')
환자ID=29-10012 -- true: [[1]] -- pred: tensor([[-0.9970,  2.0293, -1.0033]], device='cuda:0')
환자ID=29-10013 -- true: [[1]] -- pred: tensor([[-0.0686,  1.3821, -0.8940]], device='cuda:0')
환자ID=31-10154 -- true: [[1]] -- pred: tensor([[-1.2142,  1.6860, -0.6679]], device='cuda:0')
환자ID=32-10074 -- true: [[2]] -- pred: tensor([[-1.3992,  0.4330,  0.3262]], device='cuda:0')
환자ID=33-10006 -- true: [[2]] -- pred: tensor([[-1.4493,  1.0359, -0.0211]], device='cuda:0')
환자ID=34-10050 -- true: [[2]] -- pred: tensor([[-1.2825,  0.4341,  0.3390]], device='cuda:0')
환자ID=PRE019 -- true: [[0]] -- pred: tensor([[ 2.0302, -0.1143, -0.7802]], device='cuda:0')
환자ID=PRE038 -- true: [[0]] -- pred: tensor([[ 2.0804, -0.1487, -0.6637]], device='cuda:0')
환자ID=Sample1157-EO2 -- true: [[0]] -- pred: tensor([[ 1.8382, -0.1123, -0.6879]], device='cuda:0')
환자ID=Sample1162-EO1 -- true: [[0]] -- pred: tensor([[ 1.8813, -0.0615, -0.8417]], device='cuda:0')
Best performance: Epoch 49, Loss 0.430151, Test ACC 0.800000, Test AUC 0.984127, Test Recall 0.666667, Test Precision 0.566667
Confusion Matrix:
 [[5 0 0]
 [0 7 0]
 [0 3 0]]
✅ Total valid splits used: 5

📌 Repeat 3: 평균 AUC = 0.9346, 표준편차 = 0.0383
Test ACC 평균 0.777500, Test Recall 평균 0.626667, Test Precision 평균 0.557576
fold_aucs = [0.96875, 0.9027777777777778, 0.934920634920635, 0.8825396825396826, 0.9841269841269842]
NaN 개수: 0 / 전체 5개

🔁 Repeat 4, Fold 0
cell type :  S2008000605HRT_AAACCCAGTGCACATT-1     Epithelial_cells
S2008000605HRT_AAACCCAGTGCCTACG-1     Epithelial_cells
S2008000605HRT_AAAGAACGTAGAGACC-1            Astrocyte
S2008000605HRT_AAAGAACGTCGGAACA-1     Epithelial_cells
S2008000605HRT_AAAGAACGTTAACAGA-1     Epithelial_cells
                                           ...        
Sample1162EO2_TTTGGAGAGCAGGCAT-1      Epithelial_cells
Sample1162EO2_TTTGGAGAGTCGCGAA-1     Endothelial_cells
Sample1162EO2_TTTGGAGAGTGCTCGC-1           Hepatocytes
Sample1162EO2_TTTGGAGGTGATACTC-1      Epithelial_cells
Sample1162EO2_TTTGGTTCAGTAGAAT-1      Epithelial_cells
Name: singler_annotation, Length: 183957, dtype: string
cell type annotation :  S2008000605HRT_AAACCCAGTGCACATT-1     Epithelial_cells
S2008000605HRT_AAACCCAGTGCCTACG-1     Epithelial_cells
S2008000605HRT_AAAGAACGTAGAGACC-1            Astrocyte
S2008000605HRT_AAAGAACGTCGGAACA-1     Epithelial_cells
S2008000605HRT_AAAGAACGTTAACAGA-1     Epithelial_cells
                                           ...        
Sample1162EO2_TTTGGAGAGCAGGCAT-1      Epithelial_cells
Sample1162EO2_TTTGGAGAGTCGCGAA-1     Endothelial_cells
Sample1162EO2_TTTGGAGAGTGCTCGC-1           Hepatocytes
Sample1162EO2_TTTGGAGGTGATACTC-1      Epithelial_cells
Sample1162EO2_TTTGGTTCAGTAGAAT-1      Epithelial_cells
Name: singler_annotation, Length: 183957, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Epithelial_cells', 'Astrocyte', 'MSC', 'Keratinocytes', 'Neurons', 'Endothelial_cells', 'Fibroblasts', 'Tissue_stem_cells', 'Smooth_muscle_cells', 'T_cells', 'Neuroepithelial_cell', 'NK_cell', 'Chondrocytes', 'Osteoblasts', 'Monocyte', 'Hepatocytes', 'Macrophage', 'CMP', 'Embryonic_stem_cells', 'DC', 'BM & Prog.', 'MEP', 'Neutrophils', 'Pro-Myelocyte', 'iPS_cells', 'Pre-B_cell_CD34-', 'HSC_-G-CSF', 'B_cell', 'GMP', 'HSC_CD34+', 'Platelets', 'Pro-B_cell_CD34+', 'Myelocyte', 'BM', 'Unknown', 'Erythroblast', 'Gametocytes']
라벨별 그룹 개수 {0: 20, 1: 29, 2: 12}
cell type :  S2008006722HRT_AAACGCTTCGGCTCTT-1       Tissue_stem_cells
S2008006722HRT_AAAGAACGTACTCCCT-1       Endothelial_cells
S2008006722HRT_AAAGAACGTATGTCAC-1               Astrocyte
S2008006722HRT_AAAGGATTCATCGCCT-1    Embryonic_stem_cells
S2008006722HRT_AAAGGGCTCGTCGCTT-1        Epithelial_cells
                                             ...         
Sample1158EO3_TTTGACTGTACTGAGG-1        Endothelial_cells
Sample1158EO3_TTTGACTTCGTGGACC-1                  Neurons
Sample1158EO3_TTTGATCGTGTCCCTT-1         Epithelial_cells
Sample1158EO3_TTTGGAGTCATGTCTT-1         Epithelial_cells
Sample1158EO3_TTTGGTTTCGCGTGAC-1              Hepatocytes
Name: singler_annotation, Length: 41220, dtype: string
cell type annotation :  S2008006722HRT_AAACGCTTCGGCTCTT-1       Tissue_stem_cells
S2008006722HRT_AAAGAACGTACTCCCT-1       Endothelial_cells
S2008006722HRT_AAAGAACGTATGTCAC-1               Astrocyte
S2008006722HRT_AAAGGATTCATCGCCT-1    Embryonic_stem_cells
S2008006722HRT_AAAGGGCTCGTCGCTT-1        Epithelial_cells
                                             ...         
Sample1158EO3_TTTGACTGTACTGAGG-1        Endothelial_cells
Sample1158EO3_TTTGACTTCGTGGACC-1                  Neurons
Sample1158EO3_TTTGATCGTGTCCCTT-1         Epithelial_cells
Sample1158EO3_TTTGGAGTCATGTCTT-1         Epithelial_cells
Sample1158EO3_TTTGGTTTCGCGTGAC-1              Hepatocytes
Name: singler_annotation, Length: 41220, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Tissue_stem_cells', 'Endothelial_cells', 'Astrocyte', 'Embryonic_stem_cells', 'Epithelial_cells', 'Hepatocytes', 'Smooth_muscle_cells', 'Neurons', 'Fibroblasts', 'NK_cell', 'Keratinocytes', 'Neuroepithelial_cell', 'MEP', 'Pre-B_cell_CD34-', 'Monocyte', 'Pro-Myelocyte', 'MSC', 'CMP', 'BM & Prog.', 'BM', 'Macrophage', 'Chondrocytes', 'iPS_cells', 'T_cells', 'HSC_-G-CSF', 'Erythroblast', 'Osteoblasts', 'DC', 'GMP', 'Pro-B_cell_CD34+', 'Neutrophils', 'B_cell', 'HSC_CD34+', 'Myelocyte', 'Platelets', 'Gametocytes', 'Unknown']
라벨별 그룹 개수 {0: 6, 1: 8, 2: 2}
🔍 Split #1
  → train_p_index 환자 수 (환자 단위로 묶인 index list): 61
  → test_p_index 환자 수  (환자 단위로 묶인 index list): 16
  → train 환자 ID: ['163-2', '163-3', '163-4', '164-10', '164-6', '165-9', '27-10039', '27-10053', '27-10071', '27-10112', '27-10119', '28-10051', '28-11515', '28-12381', '28-12490', '28-12518', '29-10006', '29-10008', '29-10010', '29-10012', '29-10013', '29-10016', '29-10380', '29-10398', '29-10400', '29-10404', '29-10406', '29-10410', '30-10018', '30-10034', '30-10125', '30-10929', '30-11051', '31-10000', '31-10035', '31-10040', '31-10078', '31-10154', '31-10210', '31-10236', '32-10003', '32-10034', '32-10074', '33-10006', '34-10050', '34-10184', '34-10187', 'PRE018-1', 'PRE019', 'PRE027', 'PRE055-1', 'PRE062-1', 'Sample1153-EO1', 'Sample1153-EO2', 'Sample1153-EO3', 'Sample1157-EO1', 'Sample1157-EO2', 'Sample1157-EO3', 'Sample1158-EO1', 'Sample1162-EO1', 'Sample1162-EO2']
  → test  환자 ID: ['163-5', '164-3', '27-10041', '28-12263', '29-10011', '29-10280', '29-10386', '30-10123', '31-10001', '31-10013', '31-10042', '33-10005', 'PRE038', 'PRE98sc', 'Sample1158-EO2', 'Sample1158-EO3']
  → train 환자 ID 및 라벨:
    ID: 163-2, Label: 0
    ID: 163-3, Label: 0
    ID: 163-4, Label: 0
    ID: 164-10, Label: 0
    ID: 164-6, Label: 0
    ID: 165-9, Label: 0
    ID: 27-10039, Label: 1
    ID: 27-10053, Label: 1
    ID: 27-10071, Label: 1
    ID: 27-10112, Label: 1
    ID: 27-10119, Label: 1
    ID: 28-10051, Label: 1
    ID: 28-11515, Label: 1
    ID: 28-12381, Label: 1
    ID: 28-12490, Label: 1
    ID: 28-12518, Label: 1
    ID: 29-10006, Label: 1
    ID: 29-10008, Label: 1
    ID: 29-10010, Label: 1
    ID: 29-10012, Label: 1
    ID: 29-10013, Label: 1
    ID: 29-10016, Label: 1
    ID: 29-10380, Label: 1
    ID: 29-10398, Label: 1
    ID: 29-10400, Label: 1
    ID: 29-10404, Label: 1
    ID: 29-10406, Label: 1
    ID: 29-10410, Label: 1
    ID: 30-10018, Label: 2
    ID: 30-10034, Label: 2
    ID: 30-10125, Label: 2
    ID: 30-10929, Label: 2
    ID: 30-11051, Label: 2
    ID: 31-10000, Label: 1
    ID: 31-10035, Label: 1
    ID: 31-10040, Label: 1
    ID: 31-10078, Label: 1
    ID: 31-10154, Label: 1
    ID: 31-10210, Label: 1
    ID: 31-10236, Label: 1
    ID: 32-10003, Label: 2
    ID: 32-10034, Label: 2
    ID: 32-10074, Label: 2
    ID: 33-10006, Label: 2
    ID: 34-10050, Label: 2
    ID: 34-10184, Label: 2
    ID: 34-10187, Label: 2
    ID: PRE018-1, Label: 0
    ID: PRE019, Label: 0
    ID: PRE027, Label: 0
    ID: PRE055-1, Label: 0
    ID: PRE062-1, Label: 0
    ID: Sample1153-EO1, Label: 0
    ID: Sample1153-EO2, Label: 0
    ID: Sample1153-EO3, Label: 0
    ID: Sample1157-EO1, Label: 0
    ID: Sample1157-EO2, Label: 0
    ID: Sample1157-EO3, Label: 0
    ID: Sample1158-EO1, Label: 0
    ID: Sample1162-EO1, Label: 0
    ID: Sample1162-EO2, Label: 0
  → test 환자 ID 및 라벨:
    ID: 163-5, Label: 0
    ID: 164-3, Label: 0
    ID: 27-10041, Label: 1
    ID: 28-12263, Label: 1
    ID: 29-10011, Label: 1
    ID: 29-10280, Label: 1
    ID: 29-10386, Label: 1
    ID: 30-10123, Label: 2
    ID: 31-10001, Label: 1
    ID: 31-10013, Label: 1
    ID: 31-10042, Label: 1
    ID: 33-10005, Label: 2
    ID: PRE038, Label: 0
    ID: PRE98sc, Label: 0
    ID: Sample1158-EO2, Label: 0
    ID: Sample1158-EO3, Label: 0
전체 데이터 index 길이 77
label_stat (train 환자 라벨 목록) 갯수 61
train_data에서 환자 단위로, train과 validation 나누기
기존 train_p_index 61
기존 (train) label_stat 61
train-vali 분할 후! 
train y 의 classes : {0, 1, 2} valid y 의 classes : {0, 1, 2} label_stat 의 classes : {0, 1, 2}
train_p_index_ 40
valid_p_index 21
test_p_index 16
→ train 환자 ID 및 라벨:
   총 개수: 40
   환자ID=29-10016, Label=1, 셀개수=4854
   환자ID=31-10210, Label=1, 셀개수=3510
   환자ID=Sample1153-EO3, Label=0, 셀개수=1516
   환자ID=Sample1157-EO3, Label=0, 셀개수=807
   환자ID=32-10034, Label=2, 셀개수=1555
   환자ID=164-10, Label=0, 셀개수=4041
   환자ID=29-10008, Label=1, 셀개수=1913
   환자ID=PRE027, Label=0, 셀개수=2078
   환자ID=31-10000, Label=1, 셀개수=8870
   환자ID=30-10929, Label=2, 셀개수=5812
   환자ID=163-3, Label=0, 셀개수=1335
   환자ID=28-10051, Label=1, 셀개수=300
   환자ID=27-10039, Label=1, 셀개수=4638
   환자ID=27-10053, Label=1, 셀개수=728
   환자ID=163-2, Label=0, 셀개수=2535
   환자ID=30-10018, Label=2, 셀개수=5170
   환자ID=31-10040, Label=1, 셀개수=4543
   환자ID=30-10125, Label=2, 셀개수=3798
   환자ID=29-10398, Label=1, 셀개수=3993
   환자ID=31-10035, Label=1, 셀개수=2974
   환자ID=163-4, Label=0, 셀개수=1339
   환자ID=32-10003, Label=2, 셀개수=2978
   환자ID=PRE062-1, Label=0, 셀개수=907
   환자ID=29-10406, Label=1, 셀개수=3484
   환자ID=28-12381, Label=1, 셀개수=1099
   환자ID=Sample1162-EO1, Label=0, 셀개수=1053
   환자ID=31-10078, Label=1, 셀개수=2827
   환자ID=PRE018-1, Label=0, 셀개수=1349
   환자ID=27-10119, Label=1, 셀개수=3346
   환자ID=29-10006, Label=1, 셀개수=11461
   환자ID=28-11515, Label=1, 셀개수=930
   환자ID=165-9, Label=0, 셀개수=2926
   환자ID=29-10404, Label=1, 셀개수=3988
   환자ID=34-10184, Label=2, 셀개수=2699
   환자ID=29-10380, Label=1, 셀개수=4799
   환자ID=33-10006, Label=2, 셀개수=457
   환자ID=32-10074, Label=2, 셀개수=6304
   환자ID=31-10236, Label=1, 셀개수=3458
   환자ID=29-10013, Label=1, 셀개수=3706
   환자ID=28-12518, Label=1, 셀개수=1215
→ valid 환자 ID 및 라벨:
   총 개수: 21
   환자ID=Sample1162-EO2, Label=0, 셀개수=1510
   환자ID=29-10012, Label=1, 셀개수=6245
   환자ID=31-10154, Label=1, 셀개수=6568
   환자ID=Sample1153-EO1, Label=0, 셀개수=911
   환자ID=Sample1157-EO2, Label=0, 셀개수=1395
   환자ID=PRE055-1, Label=0, 셀개수=597
   환자ID=Sample1157-EO1, Label=0, 셀개수=1152
   환자ID=30-10034, Label=2, 셀개수=1240
   환자ID=30-11051, Label=2, 셀개수=2454
   환자ID=29-10410, Label=1, 셀개수=2834
   환자ID=Sample1158-EO1, Label=0, 셀개수=574
   환자ID=27-10112, Label=1, 셀개수=1470
   환자ID=29-10400, Label=1, 셀개수=2684
   환자ID=Sample1153-EO2, Label=0, 셀개수=916
   환자ID=34-10187, Label=2, 셀개수=3739
   환자ID=PRE019, Label=0, 셀개수=3795
   환자ID=164-6, Label=0, 셀개수=3038
   환자ID=29-10010, Label=1, 셀개수=5305
   환자ID=27-10071, Label=1, 셀개수=1478
   환자ID=28-12490, Label=1, 셀개수=5973
   환자ID=34-10050, Label=2, 셀개수=4784
→ test 환자 ID 및 라벨:
   총 개수: 16
   환자ID=163-5, Label=0, 셀개수=1210
   환자ID=164-3, Label=0, 셀개수=1639
   환자ID=27-10041, Label=1, 셀개수=2145
   환자ID=28-12263, Label=1, 셀개수=7527
   환자ID=29-10011, Label=1, 셀개수=3072
   환자ID=29-10280, Label=1, 셀개수=2375
   환자ID=29-10386, Label=1, 셀개수=802
   환자ID=30-10123, Label=2, 셀개수=1273
   환자ID=31-10001, Label=1, 셀개수=1133
   환자ID=31-10013, Label=1, 셀개수=3161
   환자ID=31-10042, Label=1, 셀개수=1222
   환자ID=33-10005, Label=2, 셀개수=8904
   환자ID=PRE038, Label=0, 셀개수=2666
   환자ID=PRE98sc, Label=0, 셀개수=1568
   환자ID=Sample1158-EO2, Label=0, 셀개수=1427
   환자ID=Sample1158-EO3, Label=0, 셀개수=1096
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Epithelial_cells', 'Epithelial_cells', 'Astrocyte', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'MSC', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
전체 데이터 길이 225177
전체 cell type 길이 0          Epithelial_cells
1          Epithelial_cells
2                 Astrocyte
3          Epithelial_cells
4          Epithelial_cells
                ...        
225172    Endothelial_cells
225173              Neurons
225174     Epithelial_cells
225175     Epithelial_cells
225176          Hepatocytes
Length: 225177, dtype: string
cell type의 NaN 개수 체크 0
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:20,  4.94it/s]  3%|▎         | 3/100 [00:00<00:12,  8.05it/s]  5%|▌         | 5/100 [00:00<00:10,  9.11it/s]  6%|▌         | 6/100 [00:00<00:10,  9.19it/s]  7%|▋         | 7/100 [00:00<00:09,  9.30it/s]  8%|▊         | 8/100 [00:00<00:09,  9.36it/s] 10%|█         | 10/100 [00:01<00:09,  9.29it/s] 11%|█         | 11/100 [00:01<00:10,  8.61it/s] 12%|█▏        | 12/100 [00:01<00:10,  8.78it/s] 13%|█▎        | 13/100 [00:01<00:09,  8.97it/s] 14%|█▍        | 14/100 [00:01<00:09,  9.02it/s] 15%|█▌        | 15/100 [00:01<00:12,  6.95it/s] 16%|█▌        | 16/100 [00:01<00:11,  7.53it/s] 17%|█▋        | 17/100 [00:02<00:10,  8.00it/s] 18%|█▊        | 18/100 [00:02<00:09,  8.42it/s] 19%|█▉        | 19/100 [00:02<00:09,  8.67it/s] 20%|██        | 20/100 [00:02<00:08,  8.93it/s] 21%|██        | 21/100 [00:02<00:08,  8.92it/s] 22%|██▏       | 22/100 [00:02<00:08,  9.02it/s] 23%|██▎       | 23/100 [00:02<00:08,  9.13it/s] 24%|██▍       | 24/100 [00:02<00:08,  9.29it/s] 25%|██▌       | 25/100 [00:02<00:08,  9.33it/s] 26%|██▌       | 26/100 [00:02<00:07,  9.46it/s] 27%|██▋       | 27/100 [00:03<00:07,  9.43it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.62it/s] 29%|██▉       | 29/100 [00:03<00:08,  8.74it/s] 30%|███       | 30/100 [00:03<00:07,  8.88it/s] 31%|███       | 31/100 [00:03<00:07,  8.92it/s] 32%|███▏      | 32/100 [00:03<00:07,  8.99it/s] 33%|███▎      | 33/100 [00:03<00:08,  7.59it/s] 34%|███▍      | 34/100 [00:03<00:08,  7.96it/s] 35%|███▌      | 35/100 [00:04<00:07,  8.19it/s] 36%|███▌      | 36/100 [00:04<00:07,  8.31it/s] 37%|███▋      | 37/100 [00:04<00:07,  8.18it/s] 38%|███▊      | 38/100 [00:04<00:07,  8.29it/s] 39%|███▉      | 39/100 [00:04<00:07,  8.49it/s] 40%|████      | 40/100 [00:04<00:06,  8.58it/s] 41%|████      | 41/100 [00:04<00:06,  8.63it/s] 42%|████▏     | 42/100 [00:04<00:06,  8.70it/s] 43%|████▎     | 43/100 [00:05<00:07,  7.28it/s] 44%|████▍     | 44/100 [00:05<00:07,  7.67it/s] 45%|████▌     | 45/100 [00:05<00:06,  8.02it/s] 46%|████▌     | 46/100 [00:05<00:06,  8.30it/s] 47%|████▋     | 47/100 [00:05<00:06,  8.50it/s] 48%|████▊     | 48/100 [00:05<00:06,  8.58it/s] 49%|████▉     | 49/100 [00:05<00:05,  8.73it/s] 50%|█████     | 50/100 [00:05<00:05,  8.64it/s] 51%|█████     | 51/100 [00:05<00:05,  8.47it/s] 52%|█████▏    | 52/100 [00:06<00:05,  8.29it/s] 53%|█████▎    | 53/100 [00:06<00:05,  8.35it/s] 54%|█████▍    | 54/100 [00:06<00:05,  8.47it/s] 55%|█████▌    | 55/100 [00:06<00:05,  8.67it/s] 56%|█████▌    | 56/100 [00:06<00:05,  8.16it/s] 57%|█████▋    | 57/100 [00:06<00:05,  8.31it/s] 58%|█████▊    | 58/100 [00:06<00:05,  8.32it/s] 59%|█████▉    | 59/100 [00:06<00:04,  8.35it/s] 60%|██████    | 60/100 [00:07<00:05,  7.94it/s] 61%|██████    | 61/100 [00:07<00:04,  8.08it/s] 62%|██████▏   | 62/100 [00:07<00:04,  8.07it/s] 63%|██████▎   | 63/100 [00:07<00:04,  8.37it/s] 64%|██████▍   | 64/100 [00:07<00:04,  8.25it/s] 65%|██████▌   | 65/100 [00:07<00:04,  8.26it/s] 66%|██████▌   | 66/100 [00:07<00:04,  8.16it/s] 67%|██████▋   | 67/100 [00:07<00:04,  7.78it/s] 68%|██████▊   | 68/100 [00:08<00:03,  8.05it/s] 69%|██████▉   | 69/100 [00:08<00:03,  8.44it/s] 70%|███████   | 70/100 [00:08<00:03,  8.57it/s] 71%|███████   | 71/100 [00:08<00:03,  8.54it/s] 72%|███████▏  | 72/100 [00:08<00:03,  8.67it/s] 73%|███████▎  | 73/100 [00:08<00:03,  8.50it/s] 74%|███████▍  | 74/100 [00:08<00:03,  8.52it/s] 75%|███████▌  | 75/100 [00:08<00:02,  8.51it/s] 76%|███████▌  | 76/100 [00:08<00:02,  8.42it/s] 77%|███████▋  | 77/100 [00:09<00:02,  8.48it/s] 78%|███████▊  | 78/100 [00:09<00:02,  8.46it/s] 79%|███████▉  | 79/100 [00:09<00:02,  8.26it/s] 80%|████████  | 80/100 [00:09<00:02,  8.25it/s] 81%|████████  | 81/100 [00:09<00:02,  8.41it/s] 82%|████████▏ | 82/100 [00:09<00:02,  8.15it/s] 83%|████████▎ | 83/100 [00:09<00:02,  8.04it/s] 84%|████████▍ | 84/100 [00:09<00:01,  8.24it/s] 85%|████████▌ | 85/100 [00:10<00:01,  8.20it/s] 86%|████████▌ | 86/100 [00:10<00:01,  8.36it/s] 87%|████████▋ | 87/100 [00:10<00:01,  8.25it/s] 88%|████████▊ | 88/100 [00:10<00:01,  8.22it/s] 89%|████████▉ | 89/100 [00:10<00:01,  7.89it/s] 90%|█████████ | 90/100 [00:10<00:01,  7.93it/s] 91%|█████████ | 91/100 [00:10<00:01,  7.99it/s] 92%|█████████▏| 92/100 [00:10<00:00,  8.05it/s] 93%|█████████▎| 93/100 [00:11<00:00,  8.02it/s] 94%|█████████▍| 94/100 [00:11<00:00,  7.94it/s] 95%|█████████▌| 95/100 [00:11<00:00,  7.96it/s] 96%|█████████▌| 96/100 [00:11<00:00,  8.01it/s] 97%|█████████▋| 97/100 [00:11<00:00,  6.56it/s] 98%|█████████▊| 98/100 [00:11<00:00,  6.92it/s] 99%|█████████▉| 99/100 [00:11<00:00,  7.23it/s]100%|██████████| 100/100 [00:12<00:00,  7.55it/s]100%|██████████| 100/100 [00:12<00:00,  8.30it/s]
[I 2025-08-31 11:49:59,060] A new study created in memory with name: no-name-69006905-c305-472f-9357-ca2b66f8a2c2
👉 train samples(학습 샘플(bag))=140, batch_size=8 -> steps(샘플수/batch크기)=18
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 27.97 MB
Memory Reserved: 36.00 MB
cuda
Epoch 1, Train Loss 0.886530, Valid_loss 1.183989
Epoch 2, Train Loss 0.865559, Valid_loss 1.227025
Epoch 3, Train Loss 0.781384, Valid_loss 0.955786
Epoch 4, Train Loss 0.614654, Valid_loss 0.720210
Epoch 5, Train Loss 0.750840, Valid_loss 0.804539
Epoch 6, Train Loss 0.573331, Valid_loss 0.655394
Epoch 7, Train Loss 0.540937, Valid_loss 0.534365
Epoch 8, Train Loss 0.477678, Valid_loss 0.614297
Epoch 9, Train Loss 0.479173, Valid_loss 0.463719
Epoch 10, Train Loss 0.510609, Valid_loss 0.645498
Epoch 11, Train Loss 0.485855, Valid_loss 0.507366
Epoch 12, Train Loss 0.425002, Valid_loss 0.481502
Epoch 13, Train Loss 0.422985, Valid_loss 0.434719
Epoch 14, Train Loss 0.395295, Valid_loss 0.403956
Epoch 15, Train Loss 0.456305, Valid_loss 0.777127
Epoch 16, Train Loss 0.405541, Valid_loss 0.705519
Epoch 17, Train Loss 0.390057, Valid_loss 0.345323
Epoch 18, Train Loss 0.314146, Valid_loss 0.308616
Epoch 19, Train Loss 0.332822, Valid_loss 0.374377
Epoch 20, Train Loss 0.374760, Valid_loss 0.624191
Epoch 21, Train Loss 0.295319, Valid_loss 0.457865
Epoch 22, Train Loss 0.273157, Valid_loss 0.509042
Epoch 23, Train Loss 0.328190, Valid_loss 0.498381
Epoch 24, Train Loss 0.246794, Valid_loss 0.620620
Epoch 25, Train Loss 0.242540, Valid_loss 0.636317
Epoch 26, Train Loss 0.314533, Valid_loss 0.785392
Epoch 27, Train Loss 0.249536, Valid_loss 0.568042
Epoch 28, Train Loss 0.189158, Valid_loss 0.699909
Epoch 29, Train Loss 0.212773, Valid_loss 1.137798
Epoch 30, Train Loss 0.245521, Valid_loss 0.410231
Epoch 31, Train Loss 0.419512, Valid_loss 0.305637
Epoch 32, Train Loss 0.277960, Valid_loss 0.654437
Epoch 33, Train Loss 0.189432, Valid_loss 0.830832
Epoch 34, Train Loss 0.230115, Valid_loss 1.146164
Epoch 35, Train Loss 0.397404, Valid_loss 1.021269
Epoch 36, Train Loss 0.375899, Valid_loss 0.600428
Epoch 37, Train Loss 0.266699, Valid_loss 0.553720
Epoch 38, Train Loss 0.188658, Valid_loss 0.787064
Epoch 39, Train Loss 0.292115, Valid_loss 0.867233
Epoch 40, Train Loss 0.188693, Valid_loss 0.540438
Epoch 41, Train Loss 0.209608, Valid_loss 0.754811
Epoch 42, Train Loss 0.191136, Valid_loss 0.457360
Epoch 43, Train Loss 0.254263, Valid_loss 0.293577
Epoch 44, Train Loss 0.183824, Valid_loss 0.613508
Epoch 45, Train Loss 0.158063, Valid_loss 1.087651
Epoch 46, Train Loss 0.198182, Valid_loss 1.257516
Epoch 47, Train Loss 0.223860, Valid_loss 1.273017
Epoch 48, Train Loss 0.208156, Valid_loss 0.994949
Epoch 49, Train Loss 0.176608, Valid_loss 0.618204
Epoch 50, Train Loss 0.234083, Valid_loss 0.805101
Epoch 51, Train Loss 0.170577, Valid_loss 1.058945
Epoch 52, Train Loss 0.131832, Valid_loss 0.980261
Epoch 53, Train Loss 0.127010, Valid_loss 0.821327
Epoch 54, Train Loss 0.160606, Valid_loss 0.809492
Epoch 55, Train Loss 0.157076, Valid_loss 1.145775
Epoch 56, Train Loss 0.115091, Valid_loss 0.926137
Epoch 57, Train Loss 0.104621, Valid_loss 0.859534
Epoch 58, Train Loss 0.117420, Valid_loss 0.792091
Epoch 59, Train Loss 0.107956, Valid_loss 1.021611
Epoch 60, Train Loss 0.117157, Valid_loss 1.521326
[I 2025-08-31 11:59:59,415] Trial 0 finished with value: 0.2935774701292671 and parameters: {'learning_rate': 0.001, 'epochs': 100, 'heads': 2, 'dropout': 0.3, 'weight_decay': 0.001, 'emb_dim': 64, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.2935774701292671.
👉 train samples(학습 샘플(bag))=140, batch_size=8 -> steps(샘플수/batch크기)=18
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 26.13 MB
Memory Reserved: 36.00 MB
cuda
Epoch 1, Train Loss 0.889944, Valid_loss 1.203897
Epoch 2, Train Loss 0.894095, Valid_loss 1.286619
Epoch 3, Train Loss 0.832780, Valid_loss 1.227460
Epoch 4, Train Loss 0.827576, Valid_loss 1.202872
Epoch 5, Train Loss 0.897367, Valid_loss 1.144280
Epoch 6, Train Loss 0.817377, Valid_loss 1.146157
Epoch 7, Train Loss 0.779949, Valid_loss 0.998649
Epoch 8, Train Loss 0.763962, Valid_loss 0.844173
Epoch 9, Train Loss 0.651283, Valid_loss 0.773276
Epoch 10, Train Loss 0.624347, Valid_loss 0.745253
Epoch 11, Train Loss 0.676143, Valid_loss 0.754931
Epoch 12, Train Loss 0.605738, Valid_loss 0.672967
Epoch 13, Train Loss 0.561761, Valid_loss 0.571779
Epoch 14, Train Loss 0.660062, Valid_loss 0.857827
Epoch 15, Train Loss 0.578882, Valid_loss 0.516023
Epoch 16, Train Loss 0.548089, Valid_loss 0.710737
Epoch 17, Train Loss 0.516116, Valid_loss 0.548233
Epoch 18, Train Loss 0.503263, Valid_loss 0.465559
Epoch 19, Train Loss 0.472953, Valid_loss 0.706335
Epoch 20, Train Loss 0.439077, Valid_loss 0.446786
Epoch 21, Train Loss 0.496451, Valid_loss 0.632926
Epoch 22, Train Loss 0.430416, Valid_loss 0.533283
Epoch 23, Train Loss 0.574674, Valid_loss 0.712102
Epoch 24, Train Loss 0.441513, Valid_loss 0.579365
Epoch 25, Train Loss 0.483745, Valid_loss 0.654853
Epoch 26, Train Loss 0.469786, Valid_loss 0.642250
Epoch 27, Train Loss 0.488393, Valid_loss 0.630617
Epoch 28, Train Loss 0.491557, Valid_loss 0.799014
Epoch 29, Train Loss 0.465539, Valid_loss 0.704763
Epoch 30, Train Loss 0.389742, Valid_loss 0.425111
Epoch 31, Train Loss 0.409733, Valid_loss 0.488356
Epoch 32, Train Loss 0.396567, Valid_loss 0.498248
Epoch 33, Train Loss 0.419337, Valid_loss 0.411550
Epoch 34, Train Loss 0.408746, Valid_loss 0.707839
Epoch 35, Train Loss 0.521255, Valid_loss 0.646524
Epoch 36, Train Loss 0.358096, Valid_loss 0.448971
Epoch 37, Train Loss 0.316171, Valid_loss 0.695170
Epoch 38, Train Loss 0.330879, Valid_loss 0.690313
Epoch 39, Train Loss 0.363696, Valid_loss 0.413669
Epoch 40, Train Loss 0.376796, Valid_loss 0.623036
Epoch 41, Train Loss 0.327644, Valid_loss 0.496770
Epoch 42, Train Loss 0.337189, Valid_loss 0.512910
Epoch 43, Train Loss 0.414185, Valid_loss 0.658104
Epoch 44, Train Loss 0.334481, Valid_loss 0.432990
Epoch 45, Train Loss 0.341993, Valid_loss 0.375821
Epoch 46, Train Loss 0.315372, Valid_loss 0.676477
Epoch 47, Train Loss 0.291018, Valid_loss 0.756222
Epoch 48, Train Loss 0.252361, Valid_loss 0.511029
Epoch 49, Train Loss 0.275883, Valid_loss 0.757560
Epoch 50, Train Loss 0.257598, Valid_loss 0.486640
Epoch 51, Train Loss 0.271717, Valid_loss 0.604118
Epoch 52, Train Loss 0.317370, Valid_loss 0.850324
[I 2025-08-31 12:07:05,659] Trial 1 finished with value: 0.37582058193428175 and parameters: {'learning_rate': 0.001, 'epochs': 100, 'heads': 1, 'dropout': 0.5, 'weight_decay': 0.01, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.2935774701292671.
👉 train samples(학습 샘플(bag))=140, batch_size=8 -> steps(샘플수/batch크기)=18
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 26.13 MB
Memory Reserved: 36.00 MB
cuda
Epoch 1, Train Loss 1.016739, Valid_loss 1.220200
Epoch 2, Train Loss 0.879493, Valid_loss 1.249339
Epoch 3, Train Loss 0.875542, Valid_loss 1.253962
Epoch 4, Train Loss 0.874711, Valid_loss 1.197400
Epoch 5, Train Loss 0.874647, Valid_loss 1.163783
Epoch 6, Train Loss 0.840103, Valid_loss 1.200959
Epoch 7, Train Loss 0.880679, Valid_loss 1.224327
Epoch 8, Train Loss 0.869487, Valid_loss 1.135120
Epoch 9, Train Loss 0.810073, Valid_loss 1.186433
Epoch 10, Train Loss 0.807055, Valid_loss 1.030014
Epoch 11, Train Loss 0.771863, Valid_loss 0.875281
Epoch 12, Train Loss 0.767881, Valid_loss 0.813338
Epoch 13, Train Loss 0.743297, Valid_loss 0.740596
Epoch 14, Train Loss 0.711862, Valid_loss 0.725770
Epoch 15, Train Loss 0.682100, Valid_loss 0.951848
Epoch 16, Train Loss 0.793110, Valid_loss 0.742933
Epoch 17, Train Loss 0.626131, Valid_loss 0.692170
Epoch 18, Train Loss 0.633832, Valid_loss 0.825609
Epoch 19, Train Loss 0.676918, Valid_loss 0.704243
Epoch 20, Train Loss 0.580624, Valid_loss 0.664885
Epoch 21, Train Loss 0.547114, Valid_loss 0.772461
Epoch 22, Train Loss 0.649705, Valid_loss 0.786621
Epoch 23, Train Loss 0.628103, Valid_loss 0.640919
Epoch 24, Train Loss 0.559743, Valid_loss 0.654099
Epoch 25, Train Loss 0.598635, Valid_loss 0.698408
Epoch 26, Train Loss 0.555970, Valid_loss 0.653218
Epoch 27, Train Loss 0.548540, Valid_loss 0.539794
Epoch 28, Train Loss 0.583104, Valid_loss 0.558439
Epoch 29, Train Loss 0.563329, Valid_loss 0.573456
Epoch 30, Train Loss 0.475834, Valid_loss 0.785806
Epoch 31, Train Loss 0.644425, Valid_loss 0.563785
Epoch 32, Train Loss 0.681230, Valid_loss 0.745659
Epoch 33, Train Loss 0.603860, Valid_loss 0.586494
Epoch 34, Train Loss 0.621791, Valid_loss 0.569667
Epoch 35, Train Loss 0.561479, Valid_loss 0.695362
Epoch 36, Train Loss 0.455794, Valid_loss 0.534591
Epoch 37, Train Loss 0.615710, Valid_loss 0.543937
Epoch 38, Train Loss 0.535960, Valid_loss 0.775571
Epoch 39, Train Loss 0.503717, Valid_loss 0.606148
Epoch 40, Train Loss 0.544412, Valid_loss 0.555524
Epoch 41, Train Loss 0.573016, Valid_loss 0.602329
Epoch 42, Train Loss 0.521670, Valid_loss 0.680746
Epoch 43, Train Loss 0.478997, Valid_loss 0.995995
Epoch 44, Train Loss 0.667017, Valid_loss 0.589775
Epoch 45, Train Loss 0.612425, Valid_loss 0.623057
Epoch 46, Train Loss 0.538836, Valid_loss 0.633728
Epoch 47, Train Loss 0.532193, Valid_loss 0.638365
Epoch 48, Train Loss 0.572390, Valid_loss 1.009074
Epoch 49, Train Loss 0.485925, Valid_loss 0.510005
Epoch 50, Train Loss 0.514062, Valid_loss 0.661293
Epoch 51, Train Loss 0.475421, Valid_loss 0.586599
Epoch 52, Train Loss 0.478539, Valid_loss 0.566010
Epoch 53, Train Loss 0.461948, Valid_loss 0.661533
Epoch 54, Train Loss 0.447591, Valid_loss 0.659604
Epoch 55, Train Loss 0.426587, Valid_loss 0.544931
Epoch 56, Train Loss 0.434571, Valid_loss 0.584228
Epoch 57, Train Loss 0.461198, Valid_loss 0.477888
Epoch 58, Train Loss 0.484571, Valid_loss 0.660288
Epoch 59, Train Loss 0.461584, Valid_loss 0.543638
Epoch 60, Train Loss 0.402652, Valid_loss 0.511689
Epoch 61, Train Loss 0.442919, Valid_loss 0.613618
Epoch 62, Train Loss 0.451516, Valid_loss 0.586177
Epoch 63, Train Loss 0.400084, Valid_loss 0.523057
Epoch 64, Train Loss 0.410952, Valid_loss 0.719199
Epoch 65, Train Loss 0.432712, Valid_loss 0.600477
Epoch 66, Train Loss 0.372506, Valid_loss 0.462482
Epoch 67, Train Loss 0.421784, Valid_loss 0.710125
Epoch 68, Train Loss 0.410216, Valid_loss 0.654166
Epoch 69, Train Loss 0.363578, Valid_loss 0.586856
Epoch 70, Train Loss 0.401435, Valid_loss 0.616674
Epoch 71, Train Loss 0.362021, Valid_loss 0.704624
[I 2025-08-31 12:16:47,344] Trial 2 finished with value: 0.4624816184597356 and parameters: {'learning_rate': 0.001, 'epochs': 100, 'heads': 1, 'dropout': 0.7, 'weight_decay': 0.01, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.2935774701292671.
선택된 trial params: {'learning_rate': 0.001, 'epochs': 100, 'heads': 2, 'dropout': 0.3, 'weight_decay': 0.001, 'emb_dim': 64, 'augment_num': 100, 'pca': False}
👉 train samples(학습 샘플(bag))=140, batch_size=8 -> steps(샘플수/batch크기)=18
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=16, batch_size=1 -> steps=16
Memory Allocated: 27.97 MB
Memory Reserved: 36.00 MB
cuda
Epoch 1, Train Loss 0.914012, Valid_loss 1.343914
Epoch 2, Train Loss 0.881848, Valid_loss 1.171051
Epoch 3, Train Loss 0.873304, Valid_loss 1.214597
Epoch 4, Train Loss 0.845035, Valid_loss 1.153842
Epoch 5, Train Loss 0.869854, Valid_loss 1.145600
Epoch 6, Train Loss 0.777620, Valid_loss 0.897425
Epoch 7, Train Loss 0.773403, Valid_loss 0.928497
Epoch 8, Train Loss 0.605525, Valid_loss 0.717421
Epoch 9, Train Loss 0.563716, Valid_loss 0.594985
Epoch 10, Train Loss 0.516485, Valid_loss 0.630912
Epoch 11, Train Loss 0.522259, Valid_loss 0.609553
Epoch 12, Train Loss 0.536641, Valid_loss 0.658003
Epoch 13, Train Loss 0.545538, Valid_loss 0.511688
Epoch 14, Train Loss 0.499486, Valid_loss 0.502913
Epoch 15, Train Loss 0.499468, Valid_loss 0.552091
Epoch 16, Train Loss 0.386284, Valid_loss 0.464439
Epoch 17, Train Loss 0.467233, Valid_loss 0.643266
Epoch 18, Train Loss 0.333556, Valid_loss 0.506667
Epoch 19, Train Loss 0.483057, Valid_loss 0.655653
Epoch 20, Train Loss 0.367157, Valid_loss 0.963288
Epoch 21, Train Loss 0.418766, Valid_loss 0.578414
Epoch 22, Train Loss 0.291603, Valid_loss 0.445772
Epoch 23, Train Loss 0.279317, Valid_loss 0.439750
Epoch 24, Train Loss 0.399658, Valid_loss 0.610142
Epoch 25, Train Loss 0.419238, Valid_loss 0.661463
Epoch 26, Train Loss 0.320205, Valid_loss 0.631231
Epoch 27, Train Loss 0.273432, Valid_loss 0.459635
Epoch 28, Train Loss 0.291400, Valid_loss 0.495747
Epoch 29, Train Loss 0.242652, Valid_loss 0.740611
Epoch 30, Train Loss 0.223201, Valid_loss 0.509357
Epoch 31, Train Loss 0.371963, Valid_loss 0.674493
Epoch 32, Train Loss 0.391786, Valid_loss 0.721476
Epoch 33, Train Loss 0.247081, Valid_loss 0.628287
Epoch 34, Train Loss 0.221385, Valid_loss 0.508128
Epoch 35, Train Loss 0.224147, Valid_loss 0.684817
Epoch 36, Train Loss 0.166675, Valid_loss 0.559650
Epoch 37, Train Loss 0.283587, Valid_loss 0.823649
Epoch 38, Train Loss 0.248302, Valid_loss 0.692886
Epoch 39, Train Loss 0.180041, Valid_loss 0.755226
Epoch 40, Train Loss 0.216571, Valid_loss 0.915780
Epoch 41, Train Loss 0.165760, Valid_loss 1.050176
Epoch 42, Train Loss 0.194399, Valid_loss 0.951158
Epoch 43, Train Loss 0.143557, Valid_loss 0.442785
Epoch 44, Train Loss 0.358622, Valid_loss 0.546031
Epoch 45, Train Loss 0.219573, Valid_loss 0.408833
Epoch 46, Train Loss 0.307483, Valid_loss 0.960057
Epoch 47, Train Loss 0.207362, Valid_loss 0.718352
Epoch 48, Train Loss 0.170458, Valid_loss 0.843907
Epoch 49, Train Loss 0.148520, Valid_loss 0.745583
Epoch 50, Train Loss 0.146243, Valid_loss 1.006030
Epoch 51, Train Loss 0.118744, Valid_loss 0.996557
Epoch 52, Train Loss 0.129430, Valid_loss 0.884983
Epoch 53, Train Loss 0.116632, Valid_loss 0.959441
Epoch 54, Train Loss 0.100791, Valid_loss 1.100386
환자ID=163-5 -- true: [[0]] -- pred: tensor([[ 1.5878,  0.3575, -4.1178]], device='cuda:0')
환자ID=164-3 -- true: [[0]] -- pred: tensor([[ 2.5718, -0.7958, -4.4714]], device='cuda:0')
환자ID=27-10041 -- true: [[1]] -- pred: tensor([[-2.6627,  2.0111, -1.1503]], device='cuda:0')
환자ID=28-12263 -- true: [[1]] -- pred: tensor([[-3.0287,  1.5465, -0.4688]], device='cuda:0')
환자ID=29-10011 -- true: [[1]] -- pred: tensor([[-3.2968,  1.1877,  0.0649]], device='cuda:0')
환자ID=29-10280 -- true: [[1]] -- pred: tensor([[-2.3796,  1.8456, -1.1865]], device='cuda:0')
환자ID=29-10386 -- true: [[1]] -- pred: tensor([[-2.7091,  1.7861, -0.9178]], device='cuda:0')
환자ID=30-10123 -- true: [[2]] -- pred: tensor([[-3.3392,  0.9476,  0.3180]], device='cuda:0')
환자ID=31-10001 -- true: [[1]] -- pred: tensor([[-2.6445,  1.6298, -0.8068]], device='cuda:0')
환자ID=31-10013 -- true: [[1]] -- pred: tensor([[-2.7290,  2.0114, -1.1125]], device='cuda:0')
환자ID=31-10042 -- true: [[1]] -- pred: tensor([[-3.0539,  1.3905, -0.3018]], device='cuda:0')
환자ID=33-10005 -- true: [[2]] -- pred: tensor([[-2.5778,  1.7025, -0.8917]], device='cuda:0')
환자ID=PRE038 -- true: [[0]] -- pred: tensor([[ 3.0893, -1.5984, -4.2309]], device='cuda:0')
환자ID=PRE98sc -- true: [[0]] -- pred: tensor([[ 2.4408, -0.6235, -4.4918]], device='cuda:0')
환자ID=Sample1158-EO2 -- true: [[0]] -- pred: tensor([[ 3.2904, -2.0371, -4.0563]], device='cuda:0')
환자ID=Sample1158-EO3 -- true: [[0]] -- pred: tensor([[ 3.2096, -1.8331, -4.1415]], device='cuda:0')
Best performance: Epoch 45, Loss 0.219573, Test ACC 0.875000, Test AUC 0.916667, Test Recall 0.666667, Test Precision 0.600000
Confusion Matrix:
 [[6 0 0]
 [0 8 0]
 [0 2 0]]
✅ Total valid splits used: 1
🔁 Repeat 4, Fold 1
cell type :  S2008000605HRT_AAACCCAGTGCACATT-1     Epithelial_cells
S2008000605HRT_AAACCCAGTGCCTACG-1     Epithelial_cells
S2008000605HRT_AAAGAACGTAGAGACC-1            Astrocyte
S2008000605HRT_AAAGAACGTCGGAACA-1     Epithelial_cells
S2008000605HRT_AAAGAACGTTAACAGA-1     Epithelial_cells
                                           ...        
Sample1162EO2_TTTGGAGAGCAGGCAT-1      Epithelial_cells
Sample1162EO2_TTTGGAGAGTCGCGAA-1     Endothelial_cells
Sample1162EO2_TTTGGAGAGTGCTCGC-1           Hepatocytes
Sample1162EO2_TTTGGAGGTGATACTC-1      Epithelial_cells
Sample1162EO2_TTTGGTTCAGTAGAAT-1      Epithelial_cells
Name: singler_annotation, Length: 182434, dtype: string
cell type annotation :  S2008000605HRT_AAACCCAGTGCACATT-1     Epithelial_cells
S2008000605HRT_AAACCCAGTGCCTACG-1     Epithelial_cells
S2008000605HRT_AAAGAACGTAGAGACC-1            Astrocyte
S2008000605HRT_AAAGAACGTCGGAACA-1     Epithelial_cells
S2008000605HRT_AAAGAACGTTAACAGA-1     Epithelial_cells
                                           ...        
Sample1162EO2_TTTGGAGAGCAGGCAT-1      Epithelial_cells
Sample1162EO2_TTTGGAGAGTCGCGAA-1     Endothelial_cells
Sample1162EO2_TTTGGAGAGTGCTCGC-1           Hepatocytes
Sample1162EO2_TTTGGAGGTGATACTC-1      Epithelial_cells
Sample1162EO2_TTTGGTTCAGTAGAAT-1      Epithelial_cells
Name: singler_annotation, Length: 182434, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Epithelial_cells', 'Astrocyte', 'MSC', 'Keratinocytes', 'Neurons', 'Endothelial_cells', 'Fibroblasts', 'Tissue_stem_cells', 'Smooth_muscle_cells', 'T_cells', 'Neuroepithelial_cell', 'NK_cell', 'Chondrocytes', 'Osteoblasts', 'Monocyte', 'Hepatocytes', 'Macrophage', 'CMP', 'Embryonic_stem_cells', 'DC', 'BM & Prog.', 'MEP', 'Neutrophils', 'Pro-Myelocyte', 'iPS_cells', 'Pre-B_cell_CD34-', 'HSC_-G-CSF', 'B_cell', 'GMP', 'HSC_CD34+', 'Platelets', 'Pro-B_cell_CD34+', 'Myelocyte', 'BM', 'Erythroblast', 'Gametocytes', 'Unknown']
라벨별 그룹 개수 {0: 21, 1: 29, 2: 11}
cell type :  S2107011581HRT_AAACCCAGTTTCCAAG-1       Endothelial_cells
S2107011581HRT_AAACCCATCACTACTT-1       Endothelial_cells
S2107011581HRT_AAACGAAAGGGCCCTT-1     Smooth_muscle_cells
S2107011581HRT_AAACGAAAGTAGAATC-1             Hepatocytes
S2107011581HRT_AAACGAATCACTCGAA-1    Neuroepithelial_cell
                                             ...         
Sample1158EO1_TTTCCTCAGTGCTCGC-1        Endothelial_cells
Sample1158EO1_TTTCGATTCCATTTCA-1        Endothelial_cells
Sample1158EO1_TTTCGATTCTAGTTCT-1                 Monocyte
Sample1158EO1_TTTGATCAGGCAGGTT-1              Hepatocytes
Sample1158EO1_TTTGGTTGTCCAATCA-1                  Neurons
Name: singler_annotation, Length: 42743, dtype: string
cell type annotation :  S2107011581HRT_AAACCCAGTTTCCAAG-1       Endothelial_cells
S2107011581HRT_AAACCCATCACTACTT-1       Endothelial_cells
S2107011581HRT_AAACGAAAGGGCCCTT-1     Smooth_muscle_cells
S2107011581HRT_AAACGAAAGTAGAATC-1             Hepatocytes
S2107011581HRT_AAACGAATCACTCGAA-1    Neuroepithelial_cell
                                             ...         
Sample1158EO1_TTTCCTCAGTGCTCGC-1        Endothelial_cells
Sample1158EO1_TTTCGATTCCATTTCA-1        Endothelial_cells
Sample1158EO1_TTTCGATTCTAGTTCT-1                 Monocyte
Sample1158EO1_TTTGATCAGGCAGGTT-1              Hepatocytes
Sample1158EO1_TTTGGTTGTCCAATCA-1                  Neurons
Name: singler_annotation, Length: 42743, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Endothelial_cells', 'Smooth_muscle_cells', 'Hepatocytes', 'Neuroepithelial_cell', 'Neurons', 'Epithelial_cells', 'Fibroblasts', 'CMP', 'Astrocyte', 'NK_cell', 'T_cells', 'Pro-B_cell_CD34+', 'Monocyte', 'Embryonic_stem_cells', 'iPS_cells', 'DC', 'Keratinocytes', 'B_cell', 'Neutrophils', 'Unknown', 'GMP', 'Chondrocytes', 'BM & Prog.', 'Tissue_stem_cells', 'Pre-B_cell_CD34-', 'HSC_CD34+', 'Macrophage', 'HSC_-G-CSF', 'Platelets', 'Erythroblast', 'MEP', 'Osteoblasts', 'Gametocytes', 'MSC', 'BM', 'Pro-Myelocyte', 'Myelocyte']
라벨별 그룹 개수 {0: 5, 1: 8, 2: 3}
🔍 Split #2
  → train_p_index 환자 수 (환자 단위로 묶인 index list): 61
  → test_p_index 환자 수  (환자 단위로 묶인 index list): 16
  → train 환자 ID: ['163-2', '163-3', '163-4', '163-5', '164-10', '164-3', '165-9', '27-10041', '27-10053', '27-10071', '27-10112', '27-10119', '28-12263', '28-12381', '28-12518', '29-10006', '29-10008', '29-10010', '29-10011', '29-10012', '29-10013', '29-10016', '29-10280', '29-10386', '29-10398', '29-10400', '29-10404', '29-10406', '29-10410', '30-10018', '30-10123', '30-10125', '30-10929', '30-11051', '31-10000', '31-10001', '31-10013', '31-10035', '31-10042', '31-10154', '31-10210', '32-10034', '32-10074', '33-10005', '33-10006', '34-10050', '34-10187', 'PRE018-1', 'PRE019', 'PRE038', 'PRE055-1', 'PRE062-1', 'PRE98sc', 'Sample1153-EO1', 'Sample1153-EO2', 'Sample1157-EO2', 'Sample1157-EO3', 'Sample1158-EO2', 'Sample1158-EO3', 'Sample1162-EO1', 'Sample1162-EO2']
  → test  환자 ID: ['164-6', '27-10039', '28-10051', '28-11515', '28-12490', '29-10380', '30-10034', '31-10040', '31-10078', '31-10236', '32-10003', '34-10184', 'PRE027', 'Sample1153-EO3', 'Sample1157-EO1', 'Sample1158-EO1']
  → train 환자 ID 및 라벨:
    ID: 163-2, Label: 0
    ID: 163-3, Label: 0
    ID: 163-4, Label: 0
    ID: 163-5, Label: 0
    ID: 164-10, Label: 0
    ID: 164-3, Label: 0
    ID: 165-9, Label: 0
    ID: 27-10041, Label: 1
    ID: 27-10053, Label: 1
    ID: 27-10071, Label: 1
    ID: 27-10112, Label: 1
    ID: 27-10119, Label: 1
    ID: 28-12263, Label: 1
    ID: 28-12381, Label: 1
    ID: 28-12518, Label: 1
    ID: 29-10006, Label: 1
    ID: 29-10008, Label: 1
    ID: 29-10010, Label: 1
    ID: 29-10011, Label: 1
    ID: 29-10012, Label: 1
    ID: 29-10013, Label: 1
    ID: 29-10016, Label: 1
    ID: 29-10280, Label: 1
    ID: 29-10386, Label: 1
    ID: 29-10398, Label: 1
    ID: 29-10400, Label: 1
    ID: 29-10404, Label: 1
    ID: 29-10406, Label: 1
    ID: 29-10410, Label: 1
    ID: 30-10018, Label: 2
    ID: 30-10123, Label: 2
    ID: 30-10125, Label: 2
    ID: 30-10929, Label: 2
    ID: 30-11051, Label: 2
    ID: 31-10000, Label: 1
    ID: 31-10001, Label: 1
    ID: 31-10013, Label: 1
    ID: 31-10035, Label: 1
    ID: 31-10042, Label: 1
    ID: 31-10154, Label: 1
    ID: 31-10210, Label: 1
    ID: 32-10034, Label: 2
    ID: 32-10074, Label: 2
    ID: 33-10005, Label: 2
    ID: 33-10006, Label: 2
    ID: 34-10050, Label: 2
    ID: 34-10187, Label: 2
    ID: PRE018-1, Label: 0
    ID: PRE019, Label: 0
    ID: PRE038, Label: 0
    ID: PRE055-1, Label: 0
    ID: PRE062-1, Label: 0
    ID: PRE98sc, Label: 0
    ID: Sample1153-EO1, Label: 0
    ID: Sample1153-EO2, Label: 0
    ID: Sample1157-EO2, Label: 0
    ID: Sample1157-EO3, Label: 0
    ID: Sample1158-EO2, Label: 0
    ID: Sample1158-EO3, Label: 0
    ID: Sample1162-EO1, Label: 0
    ID: Sample1162-EO2, Label: 0
  → test 환자 ID 및 라벨:
    ID: 164-6, Label: 0
    ID: 27-10039, Label: 1
    ID: 28-10051, Label: 1
    ID: 28-11515, Label: 1
    ID: 28-12490, Label: 1
    ID: 29-10380, Label: 1
    ID: 30-10034, Label: 2
    ID: 31-10040, Label: 1
    ID: 31-10078, Label: 1
    ID: 31-10236, Label: 1
    ID: 32-10003, Label: 2
    ID: 34-10184, Label: 2
    ID: PRE027, Label: 0
    ID: Sample1153-EO3, Label: 0
    ID: Sample1157-EO1, Label: 0
    ID: Sample1158-EO1, Label: 0
전체 데이터 index 길이 77
label_stat (train 환자 라벨 목록) 갯수 61
train_data에서 환자 단위로, train과 validation 나누기
기존 train_p_index 61
기존 (train) label_stat 61
train-vali 분할 후! 
train y 의 classes : {0, 1, 2} valid y 의 classes : {0, 1, 2} label_stat 의 classes : {0, 1, 2}
train_p_index_ 40
valid_p_index 21
test_p_index 16
→ train 환자 ID 및 라벨:
   총 개수: 40
   환자ID=29-10016, Label=1, 셀개수=4854
   환자ID=31-10042, Label=1, 셀개수=1222
   환자ID=Sample1153-EO2, Label=0, 셀개수=916
   환자ID=Sample1158-EO2, Label=0, 셀개수=1427
   환자ID=32-10034, Label=2, 셀개수=1555
   환자ID=163-5, Label=0, 셀개수=1210
   환자ID=29-10010, Label=1, 셀개수=5305
   환자ID=PRE038, Label=0, 셀개수=2666
   환자ID=30-11051, Label=2, 셀개수=2454
   환자ID=30-10125, Label=2, 셀개수=3798
   환자ID=163-3, Label=0, 셀개수=1335
   환자ID=27-10119, Label=1, 셀개수=3346
   환자ID=165-9, Label=0, 셀개수=2926
   환자ID=27-10041, Label=1, 셀개수=2145
   환자ID=163-2, Label=0, 셀개수=2535
   환자ID=29-10410, Label=1, 셀개수=2834
   환자ID=31-10001, Label=1, 셀개수=1133
   환자ID=30-10123, Label=2, 셀개수=1273
   환자ID=29-10386, Label=1, 셀개수=802
   환자ID=31-10000, Label=1, 셀개수=8870
   환자ID=163-4, Label=0, 셀개수=1339
   환자ID=31-10210, Label=1, 셀개수=3510
   환자ID=PRE062-1, Label=0, 셀개수=907
   환자ID=29-10404, Label=1, 셀개수=3988
   환자ID=28-12381, Label=1, 셀개수=1099
   환자ID=Sample1162-EO1, Label=0, 셀개수=1053
   환자ID=31-10013, Label=1, 셀개수=3161
   환자ID=PRE018-1, Label=0, 셀개수=1349
   환자ID=27-10112, Label=1, 셀개수=1470
   환자ID=29-10008, Label=1, 셀개수=1913
   환자ID=28-12263, Label=1, 셀개수=7527
   환자ID=164-3, Label=0, 셀개수=1639
   환자ID=29-10400, Label=1, 셀개수=2684
   환자ID=34-10050, Label=2, 셀개수=4784
   환자ID=29-10280, Label=1, 셀개수=2375
   환자ID=33-10005, Label=2, 셀개수=8904
   환자ID=32-10074, Label=2, 셀개수=6304
   환자ID=31-10154, Label=1, 셀개수=6568
   환자ID=29-10013, Label=1, 셀개수=3706
   환자ID=29-10006, Label=1, 셀개수=11461
→ valid 환자 ID 및 라벨:
   총 개수: 21
   환자ID=Sample1162-EO2, Label=0, 셀개수=1510
   환자ID=29-10012, Label=1, 셀개수=6245
   환자ID=31-10035, Label=1, 셀개수=2974
   환자ID=PRE98sc, Label=0, 셀개수=1568
   환자ID=Sample1157-EO3, Label=0, 셀개수=807
   환자ID=PRE055-1, Label=0, 셀개수=597
   환자ID=Sample1157-EO2, Label=0, 셀개수=1395
   환자ID=30-10018, Label=2, 셀개수=5170
   환자ID=30-10929, Label=2, 셀개수=5812
   환자ID=29-10406, Label=1, 셀개수=3484
   환자ID=Sample1158-EO3, Label=0, 셀개수=1096
   환자ID=27-10071, Label=1, 셀개수=1478
   환자ID=29-10398, Label=1, 셀개수=3993
   환자ID=Sample1153-EO1, Label=0, 셀개수=911
   환자ID=34-10187, Label=2, 셀개수=3739
   환자ID=PRE019, Label=0, 셀개수=3795
   환자ID=164-10, Label=0, 셀개수=4041
   환자ID=29-10011, Label=1, 셀개수=3072
   환자ID=27-10053, Label=1, 셀개수=728
   환자ID=28-12518, Label=1, 셀개수=1215
   환자ID=33-10006, Label=2, 셀개수=457
→ test 환자 ID 및 라벨:
   총 개수: 16
   환자ID=164-6, Label=0, 셀개수=3038
   환자ID=27-10039, Label=1, 셀개수=4638
   환자ID=28-10051, Label=1, 셀개수=300
   환자ID=28-11515, Label=1, 셀개수=930
   환자ID=28-12490, Label=1, 셀개수=5973
   환자ID=29-10380, Label=1, 셀개수=4799
   환자ID=30-10034, Label=2, 셀개수=1240
   환자ID=31-10040, Label=1, 셀개수=4543
   환자ID=31-10078, Label=1, 셀개수=2827
   환자ID=31-10236, Label=1, 셀개수=3458
   환자ID=32-10003, Label=2, 셀개수=2978
   환자ID=34-10184, Label=2, 셀개수=2699
   환자ID=PRE027, Label=0, 셀개수=2078
   환자ID=Sample1153-EO3, Label=0, 셀개수=1516
   환자ID=Sample1157-EO1, Label=0, 셀개수=1152
   환자ID=Sample1158-EO1, Label=0, 셀개수=574
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Epithelial_cells', 'Epithelial_cells', 'Astrocyte', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'MSC', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
전체 데이터 길이 225177
전체 cell type 길이 0          Epithelial_cells
1          Epithelial_cells
2                 Astrocyte
3          Epithelial_cells
4          Epithelial_cells
                ...        
225172    Endothelial_cells
225173    Endothelial_cells
225174             Monocyte
225175          Hepatocytes
225176              Neurons
Length: 225177, dtype: string
cell type의 NaN 개수 체크 0
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  2%|▏         | 2/100 [00:00<00:09, 10.29it/s]  4%|▍         | 4/100 [00:00<00:10,  8.84it/s]  6%|▌         | 6/100 [00:00<00:10,  9.28it/s]  7%|▋         | 7/100 [00:00<00:09,  9.44it/s]  8%|▊         | 8/100 [00:00<00:09,  9.50it/s]  9%|▉         | 9/100 [00:00<00:09,  9.57it/s] 10%|█         | 10/100 [00:01<00:09,  9.66it/s] 11%|█         | 11/100 [00:01<00:10,  8.88it/s] 12%|█▏        | 12/100 [00:01<00:10,  8.21it/s] 13%|█▎        | 13/100 [00:01<00:10,  8.55it/s] 15%|█▌        | 15/100 [00:01<00:09,  9.32it/s] 16%|█▌        | 16/100 [00:01<00:09,  9.29it/s] 17%|█▋        | 17/100 [00:01<00:08,  9.34it/s] 18%|█▊        | 18/100 [00:01<00:09,  8.81it/s] 19%|█▉        | 19/100 [00:02<00:10,  7.55it/s] 20%|██        | 20/100 [00:02<00:09,  8.07it/s] 21%|██        | 21/100 [00:02<00:09,  8.40it/s] 22%|██▏       | 22/100 [00:02<00:09,  8.67it/s] 23%|██▎       | 23/100 [00:02<00:09,  8.40it/s] 24%|██▍       | 24/100 [00:02<00:08,  8.64it/s] 25%|██▌       | 25/100 [00:02<00:08,  8.81it/s] 26%|██▌       | 26/100 [00:03<00:10,  6.95it/s] 27%|██▋       | 27/100 [00:03<00:09,  7.61it/s] 29%|██▉       | 29/100 [00:03<00:08,  8.47it/s] 30%|███       | 30/100 [00:03<00:08,  8.57it/s] 31%|███       | 31/100 [00:03<00:07,  8.84it/s] 32%|███▏      | 32/100 [00:03<00:07,  8.98it/s] 33%|███▎      | 33/100 [00:03<00:07,  9.13it/s] 34%|███▍      | 34/100 [00:03<00:07,  9.12it/s] 35%|███▌      | 35/100 [00:03<00:06,  9.33it/s] 36%|███▌      | 36/100 [00:04<00:06,  9.37it/s] 37%|███▋      | 37/100 [00:04<00:07,  8.48it/s] 38%|███▊      | 38/100 [00:04<00:07,  8.50it/s] 39%|███▉      | 39/100 [00:04<00:08,  7.34it/s] 40%|████      | 40/100 [00:04<00:08,  7.32it/s] 41%|████      | 41/100 [00:04<00:07,  7.86it/s] 42%|████▏     | 42/100 [00:04<00:07,  8.04it/s] 43%|████▎     | 43/100 [00:04<00:06,  8.52it/s] 44%|████▍     | 44/100 [00:05<00:06,  8.76it/s] 45%|████▌     | 45/100 [00:05<00:06,  8.72it/s] 46%|████▌     | 46/100 [00:05<00:06,  8.77it/s] 47%|████▋     | 47/100 [00:05<00:06,  8.64it/s] 48%|████▊     | 48/100 [00:05<00:05,  8.91it/s] 49%|████▉     | 49/100 [00:05<00:05,  8.89it/s] 50%|█████     | 50/100 [00:05<00:05,  8.61it/s] 51%|█████     | 51/100 [00:05<00:06,  7.95it/s] 52%|█████▏    | 52/100 [00:06<00:06,  7.64it/s] 53%|█████▎    | 53/100 [00:06<00:05,  7.86it/s] 54%|█████▍    | 54/100 [00:06<00:05,  8.22it/s] 55%|█████▌    | 55/100 [00:06<00:05,  8.45it/s] 56%|█████▌    | 56/100 [00:06<00:05,  8.54it/s] 57%|█████▋    | 57/100 [00:06<00:05,  8.40it/s] 58%|█████▊    | 58/100 [00:06<00:04,  8.51it/s] 59%|█████▉    | 59/100 [00:06<00:05,  7.80it/s] 60%|██████    | 60/100 [00:07<00:04,  8.16it/s] 61%|██████    | 61/100 [00:07<00:04,  8.02it/s] 62%|██████▏   | 62/100 [00:07<00:04,  8.14it/s] 63%|██████▎   | 63/100 [00:07<00:04,  7.41it/s] 64%|██████▍   | 64/100 [00:07<00:04,  7.92it/s] 65%|██████▌   | 65/100 [00:07<00:04,  8.08it/s] 66%|██████▌   | 66/100 [00:07<00:05,  6.52it/s] 67%|██████▋   | 67/100 [00:08<00:05,  5.68it/s] 68%|██████▊   | 68/100 [00:08<00:05,  6.32it/s] 69%|██████▉   | 69/100 [00:08<00:04,  6.74it/s] 70%|███████   | 70/100 [00:08<00:04,  7.14it/s] 71%|███████   | 71/100 [00:08<00:04,  7.10it/s] 72%|███████▏  | 72/100 [00:08<00:03,  7.24it/s] 73%|███████▎  | 73/100 [00:08<00:03,  7.65it/s] 74%|███████▍  | 74/100 [00:08<00:03,  7.91it/s] 75%|███████▌  | 75/100 [00:09<00:03,  8.02it/s] 76%|███████▌  | 76/100 [00:09<00:02,  8.17it/s] 77%|███████▋  | 77/100 [00:09<00:03,  7.28it/s] 78%|███████▊  | 78/100 [00:09<00:02,  7.47it/s] 79%|███████▉  | 79/100 [00:09<00:02,  7.69it/s] 80%|████████  | 80/100 [00:09<00:02,  7.83it/s] 81%|████████  | 81/100 [00:09<00:02,  7.69it/s] 82%|████████▏ | 82/100 [00:10<00:02,  7.94it/s] 83%|████████▎ | 83/100 [00:10<00:02,  8.03it/s] 84%|████████▍ | 84/100 [00:10<00:01,  8.16it/s] 85%|████████▌ | 85/100 [00:10<00:01,  7.82it/s] 86%|████████▌ | 86/100 [00:10<00:01,  7.96it/s] 87%|████████▋ | 87/100 [00:10<00:01,  8.24it/s] 88%|████████▊ | 88/100 [00:10<00:01,  8.35it/s] 89%|████████▉ | 89/100 [00:10<00:01,  8.57it/s] 90%|█████████ | 90/100 [00:10<00:01,  8.44it/s] 91%|█████████ | 91/100 [00:11<00:01,  8.35it/s] 92%|█████████▏| 92/100 [00:11<00:00,  8.04it/s] 93%|█████████▎| 93/100 [00:11<00:00,  8.11it/s] 94%|█████████▍| 94/100 [00:11<00:00,  7.41it/s] 95%|█████████▌| 95/100 [00:11<00:00,  7.74it/s] 96%|█████████▌| 96/100 [00:11<00:00,  7.74it/s] 97%|█████████▋| 97/100 [00:11<00:00,  7.75it/s] 98%|█████████▊| 98/100 [00:12<00:00,  7.78it/s] 99%|█████████▉| 99/100 [00:12<00:00,  7.93it/s]100%|██████████| 100/100 [00:12<00:00,  8.04it/s]100%|██████████| 100/100 [00:12<00:00,  8.16it/s]
[I 2025-08-31 12:26:06,807] A new study created in memory with name: no-name-d1c1702d-54a7-42bc-8628-e4d64bcddb4d
👉 train samples(학습 샘플(bag))=140, batch_size=8 -> steps(샘플수/batch크기)=18
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 27.97 MB
Memory Reserved: 36.00 MB
cuda
CUDA OOM 발생 — 단계적 백오프 시작.
[OOM RETRY] batch_size 8 → 8 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=140, batch_size=8 -> steps(샘플수/batch크기)=18
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 9158.20 MB
Memory Reserved: 9166.00 MB
cuda
[OOM RETRY] batch_size=8에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 8 → 4 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=140, batch_size=4 -> steps(샘플수/batch크기)=35
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 1081.81 MB
Memory Reserved: 1112.00 MB
cuda
Epoch 1, Train Loss 0.910456, Valid_loss 1.119217
Epoch 2, Train Loss 0.835616, Valid_loss 1.038630
Epoch 3, Train Loss 0.766295, Valid_loss 0.904542
Epoch 4, Train Loss 0.632976, Valid_loss 0.708679
Epoch 5, Train Loss 0.583802, Valid_loss 0.571405
Epoch 6, Train Loss 0.517488, Valid_loss 0.552847
Epoch 7, Train Loss 0.433937, Valid_loss 0.560774
Epoch 8, Train Loss 0.397890, Valid_loss 0.580816
Epoch 9, Train Loss 0.371878, Valid_loss 0.436823
Epoch 10, Train Loss 0.423602, Valid_loss 0.424449
Epoch 11, Train Loss 0.361675, Valid_loss 0.460353
Epoch 12, Train Loss 0.316004, Valid_loss 0.678092
Epoch 13, Train Loss 0.332064, Valid_loss 0.513152
Epoch 14, Train Loss 0.310632, Valid_loss 0.505561
Epoch 15, Train Loss 0.345749, Valid_loss 0.741471
Epoch 16, Train Loss 0.272177, Valid_loss 0.573236
Epoch 17, Train Loss 0.260237, Valid_loss 0.414919
Epoch 18, Train Loss 0.241373, Valid_loss 0.393722
Epoch 19, Train Loss 0.234504, Valid_loss 0.457456
Epoch 20, Train Loss 0.215440, Valid_loss 0.532390
Epoch 21, Train Loss 0.214527, Valid_loss 0.488639
Epoch 22, Train Loss 0.254166, Valid_loss 0.847130
Epoch 23, Train Loss 0.303346, Valid_loss 0.507461
Epoch 24, Train Loss 0.206992, Valid_loss 0.357617
Epoch 25, Train Loss 0.205039, Valid_loss 0.453759
Epoch 26, Train Loss 0.173308, Valid_loss 0.472922
Epoch 27, Train Loss 0.162001, Valid_loss 0.514652
Epoch 28, Train Loss 0.162876, Valid_loss 0.406001
Epoch 29, Train Loss 0.166463, Valid_loss 0.482072
Epoch 30, Train Loss 0.144192, Valid_loss 0.529034
Epoch 31, Train Loss 0.149772, Valid_loss 0.442899
Epoch 32, Train Loss 0.154356, Valid_loss 0.292153
Epoch 33, Train Loss 0.151643, Valid_loss 0.559238
Epoch 34, Train Loss 0.234391, Valid_loss 0.698727
Epoch 35, Train Loss 0.174615, Valid_loss 0.351166
Epoch 36, Train Loss 0.140705, Valid_loss 0.460672
Epoch 37, Train Loss 0.138353, Valid_loss 0.484313
Epoch 38, Train Loss 0.124020, Valid_loss 0.390784
Epoch 39, Train Loss 0.119970, Valid_loss 0.475093
Epoch 40, Train Loss 0.131860, Valid_loss 0.390974
Epoch 41, Train Loss 0.136138, Valid_loss 0.374616
Epoch 42, Train Loss 0.120765, Valid_loss 0.430152
Epoch 43, Train Loss 0.111163, Valid_loss 0.443947
Epoch 44, Train Loss 0.157501, Valid_loss 0.412652
Epoch 45, Train Loss 0.144049, Valid_loss 0.719636
Epoch 46, Train Loss 0.167333, Valid_loss 0.570064
Epoch 47, Train Loss 0.125998, Valid_loss 0.376164
Epoch 48, Train Loss 0.108874, Valid_loss 0.382131
Epoch 49, Train Loss 0.114956, Valid_loss 0.419230
Epoch 50, Train Loss 0.103965, Valid_loss 0.370844
Epoch 51, Train Loss 0.097861, Valid_loss 0.470304
Epoch 52, Train Loss 0.096724, Valid_loss 0.447709
Epoch 53, Train Loss 0.101846, Valid_loss 0.414998
Epoch 54, Train Loss 0.106333, Valid_loss 0.433685
Epoch 55, Train Loss 0.093557, Valid_loss 0.527510
[I 2025-08-31 12:36:34,852] Trial 0 finished with value: 0.29215295187064577 and parameters: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 4, 'dropout': 0.0, 'weight_decay': 0.01, 'emb_dim': 64, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.29215295187064577.
👉 train samples(학습 샘플(bag))=140, batch_size=8 -> steps(샘플수/batch크기)=18
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 1079.97 MB
Memory Reserved: 1112.00 MB
cuda
Epoch 1, Train Loss 1.232166, Valid_loss 1.050194
Epoch 2, Train Loss 1.003769, Valid_loss 1.045231
Epoch 3, Train Loss 0.991953, Valid_loss 1.050689
Epoch 4, Train Loss 0.994587, Valid_loss 1.051311
Epoch 5, Train Loss 1.001516, Valid_loss 1.051714
Epoch 6, Train Loss 0.961744, Valid_loss 1.034774
Epoch 7, Train Loss 1.002516, Valid_loss 1.015522
Epoch 8, Train Loss 0.915311, Valid_loss 1.005956
Epoch 9, Train Loss 0.894951, Valid_loss 0.999548
Epoch 10, Train Loss 0.917250, Valid_loss 0.976462
Epoch 11, Train Loss 0.948432, Valid_loss 0.958011
Epoch 12, Train Loss 0.878600, Valid_loss 0.931971
Epoch 13, Train Loss 0.843460, Valid_loss 0.907926
Epoch 14, Train Loss 0.816776, Valid_loss 0.927275
Epoch 15, Train Loss 0.811675, Valid_loss 0.862589
Epoch 16, Train Loss 0.799928, Valid_loss 0.828614
Epoch 17, Train Loss 0.838281, Valid_loss 0.820839
Epoch 18, Train Loss 0.737967, Valid_loss 0.860027
Epoch 19, Train Loss 0.862476, Valid_loss 0.753590
Epoch 20, Train Loss 0.800837, Valid_loss 0.726431
Epoch 21, Train Loss 0.757314, Valid_loss 0.809239
Epoch 22, Train Loss 0.751259, Valid_loss 0.708319
Epoch 23, Train Loss 0.749008, Valid_loss 0.745612
Epoch 24, Train Loss 0.694781, Valid_loss 0.730824
Epoch 25, Train Loss 0.706537, Valid_loss 0.703874
Epoch 26, Train Loss 0.690634, Valid_loss 0.689009
Epoch 27, Train Loss 0.746365, Valid_loss 0.724936
Epoch 28, Train Loss 0.672751, Valid_loss 0.694688
Epoch 29, Train Loss 0.665773, Valid_loss 0.619796
Epoch 30, Train Loss 0.644703, Valid_loss 0.670485
Epoch 31, Train Loss 0.644615, Valid_loss 0.688433
Epoch 32, Train Loss 0.624987, Valid_loss 0.715842
Epoch 33, Train Loss 0.659960, Valid_loss 0.720144
Epoch 34, Train Loss 0.599121, Valid_loss 0.579366
Epoch 35, Train Loss 0.641355, Valid_loss 0.647633
Epoch 36, Train Loss 0.649209, Valid_loss 0.637397
Epoch 37, Train Loss 0.576119, Valid_loss 0.571471
Epoch 38, Train Loss 0.653309, Valid_loss 0.751296
Epoch 39, Train Loss 0.603557, Valid_loss 0.554973
Epoch 40, Train Loss 0.586810, Valid_loss 0.573043
Epoch 41, Train Loss 0.533470, Valid_loss 0.555509
Epoch 42, Train Loss 0.496312, Valid_loss 0.646262
Epoch 43, Train Loss 0.579402, Valid_loss 0.625533
Epoch 44, Train Loss 0.535369, Valid_loss 0.613605
Epoch 45, Train Loss 0.558907, Valid_loss 0.551008
Epoch 46, Train Loss 0.530936, Valid_loss 0.576406
Epoch 47, Train Loss 0.521658, Valid_loss 0.527635
Epoch 48, Train Loss 0.489859, Valid_loss 0.627821
Epoch 49, Train Loss 0.481101, Valid_loss 0.631863
Epoch 50, Train Loss 0.510852, Valid_loss 0.681322
Epoch 51, Train Loss 0.541188, Valid_loss 0.593203
Epoch 52, Train Loss 0.572762, Valid_loss 0.510066
Epoch 53, Train Loss 0.544892, Valid_loss 0.500208
Epoch 54, Train Loss 0.471077, Valid_loss 0.637521
Epoch 55, Train Loss 0.498418, Valid_loss 0.647007
[I 2025-08-31 12:44:05,658] Trial 1 finished with value: 0.5002075958819616 and parameters: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 1, 'dropout': 0.7, 'weight_decay': 0.0001, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.29215295187064577.
👉 train samples(학습 샘플(bag))=140, batch_size=8 -> steps(샘플수/batch크기)=18
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 1078.65 MB
Memory Reserved: 1112.00 MB
cuda
Epoch 1, Train Loss 1.200575, Valid_loss 1.266755
Epoch 2, Train Loss 1.128385, Valid_loss 1.196641
Epoch 3, Train Loss 1.058480, Valid_loss 1.107711
Epoch 4, Train Loss 0.952424, Valid_loss 0.954934
Epoch 5, Train Loss 0.860137, Valid_loss 0.867060
Epoch 6, Train Loss 0.838838, Valid_loss 0.715552
Epoch 7, Train Loss 0.686329, Valid_loss 0.678115
Epoch 8, Train Loss 0.719803, Valid_loss 0.786799
Epoch 9, Train Loss 0.718155, Valid_loss 0.716330
Epoch 10, Train Loss 0.670971, Valid_loss 0.679102
Epoch 11, Train Loss 0.690872, Valid_loss 0.793058
Epoch 12, Train Loss 0.595840, Valid_loss 0.810722
Epoch 13, Train Loss 0.614012, Valid_loss 0.916450
Epoch 14, Train Loss 0.571992, Valid_loss 0.691534
Epoch 15, Train Loss 0.607986, Valid_loss 0.720574
Epoch 16, Train Loss 0.659274, Valid_loss 0.582077
Epoch 17, Train Loss 0.613184, Valid_loss 0.649321
Epoch 18, Train Loss 0.647398, Valid_loss 0.776563
Epoch 19, Train Loss 0.805122, Valid_loss 0.721460
Epoch 20, Train Loss 0.607471, Valid_loss 0.563121
Epoch 21, Train Loss 0.497765, Valid_loss 0.642994
Epoch 22, Train Loss 0.575944, Valid_loss 0.559216
Epoch 23, Train Loss 0.607741, Valid_loss 0.557608
Epoch 24, Train Loss 0.483085, Valid_loss 0.552709
Epoch 25, Train Loss 0.462649, Valid_loss 0.544766
Epoch 26, Train Loss 0.506026, Valid_loss 0.535858
Epoch 27, Train Loss 0.482987, Valid_loss 0.564641
Epoch 28, Train Loss 0.492690, Valid_loss 0.508354
Epoch 29, Train Loss 0.540250, Valid_loss 0.506971
Epoch 30, Train Loss 0.474624, Valid_loss 0.567562
Epoch 31, Train Loss 0.462516, Valid_loss 0.623141
Epoch 32, Train Loss 0.431871, Valid_loss 0.657302
Epoch 33, Train Loss 0.451684, Valid_loss 0.497839
Epoch 34, Train Loss 0.406462, Valid_loss 0.462032
Epoch 35, Train Loss 0.433854, Valid_loss 0.515869
Epoch 36, Train Loss 0.489073, Valid_loss 0.485123
Epoch 37, Train Loss 0.365364, Valid_loss 0.449324
Epoch 38, Train Loss 0.368257, Valid_loss 0.560009
Epoch 39, Train Loss 0.393883, Valid_loss 0.811149
Epoch 40, Train Loss 0.376955, Valid_loss 0.467907
Epoch 41, Train Loss 0.323128, Valid_loss 0.438882
Epoch 42, Train Loss 0.312363, Valid_loss 0.457434
Epoch 43, Train Loss 0.290295, Valid_loss 0.536914
Epoch 44, Train Loss 0.309194, Valid_loss 0.392140
Epoch 45, Train Loss 0.277418, Valid_loss 0.428517
Epoch 46, Train Loss 0.278961, Valid_loss 0.417210
Epoch 47, Train Loss 0.284445, Valid_loss 0.486288
Epoch 48, Train Loss 0.286500, Valid_loss 0.443250
Epoch 49, Train Loss 0.288103, Valid_loss 0.413098
Epoch 50, Train Loss 0.276319, Valid_loss 0.361482
Epoch 51, Train Loss 0.277231, Valid_loss 0.436051
Epoch 52, Train Loss 0.234987, Valid_loss 0.344552
Epoch 53, Train Loss 0.265363, Valid_loss 0.519530
Epoch 54, Train Loss 0.260603, Valid_loss 0.393779
Epoch 55, Train Loss 0.235817, Valid_loss 0.432304
Epoch 56, Train Loss 0.245473, Valid_loss 0.355777
Epoch 57, Train Loss 0.246459, Valid_loss 0.349692
Epoch 58, Train Loss 0.231607, Valid_loss 0.447347
Epoch 59, Train Loss 0.207647, Valid_loss 0.503641
[I 2025-08-31 12:52:05,906] Trial 2 finished with value: 0.3445522939520223 and parameters: {'learning_rate': 0.001, 'epochs': 100, 'heads': 1, 'dropout': 0.3, 'weight_decay': 0.001, 'emb_dim': 8, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.29215295187064577.
선택된 trial params: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 4, 'dropout': 0.0, 'weight_decay': 0.01, 'emb_dim': 64, 'augment_num': 100, 'pca': False}
👉 train samples(학습 샘플(bag))=140, batch_size=8 -> steps(샘플수/batch크기)=18
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=16, batch_size=1 -> steps=16
Memory Allocated: 1081.81 MB
Memory Reserved: 1112.00 MB
cuda
CUDA OOM 발생 — 단계적 백오프 시작.
[OOM RETRY] batch_size 8 → 8 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=140, batch_size=8 -> steps(샘플수/batch크기)=18
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=16, batch_size=1 -> steps=16
Memory Allocated: 10211.88 MB
Memory Reserved: 10216.00 MB
cuda
[OOM RETRY] batch_size=8에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 8 → 4 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=140, batch_size=4 -> steps(샘플수/batch크기)=35
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=16, batch_size=1 -> steps=16
Memory Allocated: 2136.00 MB
Memory Reserved: 2162.00 MB
cuda
Epoch 1, Train Loss 0.909193, Valid_loss 1.039810
Epoch 2, Train Loss 0.800553, Valid_loss 0.953540
Epoch 3, Train Loss 0.710088, Valid_loss 0.735031
Epoch 4, Train Loss 0.613095, Valid_loss 0.569585
Epoch 5, Train Loss 0.533560, Valid_loss 0.589675
Epoch 6, Train Loss 0.486173, Valid_loss 0.572255
Epoch 7, Train Loss 0.447242, Valid_loss 0.488203
Epoch 8, Train Loss 0.454546, Valid_loss 0.510312
Epoch 9, Train Loss 0.385963, Valid_loss 0.518656
Epoch 10, Train Loss 0.403514, Valid_loss 0.511321
Epoch 11, Train Loss 0.359347, Valid_loss 0.517943
Epoch 12, Train Loss 0.344633, Valid_loss 0.473654
Epoch 13, Train Loss 0.394943, Valid_loss 0.487061
Epoch 14, Train Loss 0.304295, Valid_loss 0.476215
Epoch 15, Train Loss 0.272933, Valid_loss 0.492610
Epoch 16, Train Loss 0.327927, Valid_loss 0.539005
Epoch 17, Train Loss 0.260950, Valid_loss 0.491041
Epoch 18, Train Loss 0.253807, Valid_loss 0.495714
Epoch 19, Train Loss 0.221648, Valid_loss 0.530935
Epoch 20, Train Loss 0.209516, Valid_loss 0.609837
Epoch 21, Train Loss 0.221234, Valid_loss 0.536552
Epoch 22, Train Loss 0.201469, Valid_loss 0.474365
Epoch 23, Train Loss 0.190472, Valid_loss 0.550376
Epoch 24, Train Loss 0.200352, Valid_loss 0.428695
Epoch 25, Train Loss 0.184592, Valid_loss 0.360578
Epoch 26, Train Loss 0.240771, Valid_loss 0.303290
Epoch 27, Train Loss 0.342832, Valid_loss 0.598273
Epoch 28, Train Loss 0.188155, Valid_loss 0.450276
Epoch 29, Train Loss 0.163613, Valid_loss 0.435105
Epoch 30, Train Loss 0.170333, Valid_loss 0.488221
Epoch 31, Train Loss 0.188737, Valid_loss 0.339938
Epoch 32, Train Loss 0.148770, Valid_loss 0.450635
Epoch 33, Train Loss 0.144994, Valid_loss 0.637892
Epoch 34, Train Loss 0.156999, Valid_loss 0.419184
Epoch 35, Train Loss 0.224642, Valid_loss 0.273159
Epoch 36, Train Loss 0.377312, Valid_loss 0.548947
Epoch 37, Train Loss 0.180629, Valid_loss 0.505267
Epoch 38, Train Loss 0.150207, Valid_loss 0.398595
Epoch 39, Train Loss 0.143159, Valid_loss 0.333179
Epoch 40, Train Loss 0.169633, Valid_loss 0.606581
Epoch 41, Train Loss 0.144398, Valid_loss 0.405042
Epoch 42, Train Loss 0.132321, Valid_loss 0.560168
Epoch 43, Train Loss 0.138634, Valid_loss 0.411343
Epoch 44, Train Loss 0.137482, Valid_loss 0.523473
Epoch 45, Train Loss 0.144001, Valid_loss 0.650035
Epoch 46, Train Loss 0.123137, Valid_loss 0.691378
Epoch 47, Train Loss 0.146614, Valid_loss 0.284008
Epoch 48, Train Loss 0.173462, Valid_loss 0.282066
Epoch 49, Train Loss 0.219773, Valid_loss 0.615203
Epoch 50, Train Loss 0.126438, Valid_loss 0.505758
Epoch 51, Train Loss 0.115555, Valid_loss 0.413192
Epoch 52, Train Loss 0.113252, Valid_loss 0.372797
Epoch 53, Train Loss 0.106518, Valid_loss 0.482104
Epoch 54, Train Loss 0.105461, Valid_loss 0.463614
Epoch 55, Train Loss 0.104510, Valid_loss 0.455838
Epoch 56, Train Loss 0.101505, Valid_loss 0.408259
Epoch 57, Train Loss 0.099660, Valid_loss 0.503814
Epoch 58, Train Loss 0.099249, Valid_loss 0.497116
Epoch 59, Train Loss 0.101184, Valid_loss 0.437894
Epoch 60, Train Loss 0.096898, Valid_loss 0.422597
Epoch 61, Train Loss 0.100805, Valid_loss 0.408045
Epoch 62, Train Loss 0.106752, Valid_loss 0.462735
Epoch 63, Train Loss 0.094968, Valid_loss 0.476320
환자ID=164-6 -- true: [[0]] -- pred: tensor([[ 2.0863, -1.1838, -2.4802]], device='cuda:0')
환자ID=27-10039 -- true: [[1]] -- pred: tensor([[-1.9423,  1.5292,  0.3516]], device='cuda:0')
환자ID=28-10051 -- true: [[1]] -- pred: tensor([[ 1.2003e-05,  9.6665e-01, -1.8736e+00]], device='cuda:0')
환자ID=28-11515 -- true: [[1]] -- pred: tensor([[-0.2669,  1.5333, -1.6582]], device='cuda:0')
환자ID=28-12490 -- true: [[1]] -- pred: tensor([[-1.8579,  2.1145, -0.4394]], device='cuda:0')
환자ID=29-10380 -- true: [[1]] -- pred: tensor([[-1.8531,  1.8982, -0.1049]], device='cuda:0')
환자ID=30-10034 -- true: [[2]] -- pred: tensor([[-1.3955,  2.0853, -0.7299]], device='cuda:0')
환자ID=31-10040 -- true: [[1]] -- pred: tensor([[-1.6287,  1.9501, -0.3550]], device='cuda:0')
환자ID=31-10078 -- true: [[1]] -- pred: tensor([[-1.7270,  1.9873, -0.2427]], device='cuda:0')
환자ID=31-10236 -- true: [[1]] -- pred: tensor([[-1.8340,  1.9116, -0.1484]], device='cuda:0')
환자ID=32-10003 -- true: [[2]] -- pred: tensor([[-1.8692,  0.9903,  0.9415]], device='cuda:0')
환자ID=34-10184 -- true: [[2]] -- pred: tensor([[-1.9155,  2.0904, -0.3745]], device='cuda:0')
환자ID=PRE027 -- true: [[0]] -- pred: tensor([[ 2.2581, -1.3398, -2.5189]], device='cuda:0')
환자ID=Sample1153-EO3 -- true: [[0]] -- pred: tensor([[ 2.3559, -1.3333, -2.5711]], device='cuda:0')
환자ID=Sample1157-EO1 -- true: [[0]] -- pred: tensor([[ 2.2462, -1.3996, -2.5086]], device='cuda:0')
환자ID=Sample1158-EO1 -- true: [[0]] -- pred: tensor([[ 2.3438, -1.4184, -2.5198]], device='cuda:0')
Best performance: Epoch 35, Loss 0.224642, Test ACC 0.812500, Test AUC 0.819444, Test Recall 0.666667, Test Precision 0.575758
Confusion Matrix:
 [[5 0 0]
 [0 8 0]
 [0 3 0]]
✅ Total valid splits used: 2
🔁 Repeat 4, Fold 2
cell type :  S2008000605HRT_AAACCCAGTGCACATT-1    Epithelial_cells
S2008000605HRT_AAACCCAGTGCCTACG-1    Epithelial_cells
S2008000605HRT_AAAGAACGTAGAGACC-1           Astrocyte
S2008000605HRT_AAAGAACGTCGGAACA-1    Epithelial_cells
S2008000605HRT_AAAGAACGTTAACAGA-1    Epithelial_cells
                                           ...       
Sample1162EO1_TTTCACAAGGGCAGAG-1            iPS_cells
Sample1162EO1_TTTCCTCAGCGTGCCT-1          Hepatocytes
Sample1162EO1_TTTCCTCAGTACTGTC-1     Epithelial_cells
Sample1162EO1_TTTGGTTTCCACATAG-1          Hepatocytes
Sample1162EO1_TTTGTTGCACACGCCA-1     Epithelial_cells
Name: singler_annotation, Length: 160985, dtype: string
cell type annotation :  S2008000605HRT_AAACCCAGTGCACATT-1    Epithelial_cells
S2008000605HRT_AAACCCAGTGCCTACG-1    Epithelial_cells
S2008000605HRT_AAAGAACGTAGAGACC-1           Astrocyte
S2008000605HRT_AAAGAACGTCGGAACA-1    Epithelial_cells
S2008000605HRT_AAAGAACGTTAACAGA-1    Epithelial_cells
                                           ...       
Sample1162EO1_TTTCACAAGGGCAGAG-1            iPS_cells
Sample1162EO1_TTTCCTCAGCGTGCCT-1          Hepatocytes
Sample1162EO1_TTTCCTCAGTACTGTC-1     Epithelial_cells
Sample1162EO1_TTTGGTTTCCACATAG-1          Hepatocytes
Sample1162EO1_TTTGTTGCACACGCCA-1     Epithelial_cells
Name: singler_annotation, Length: 160985, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Epithelial_cells', 'Astrocyte', 'MSC', 'Keratinocytes', 'Neurons', 'Endothelial_cells', 'Fibroblasts', 'Tissue_stem_cells', 'Smooth_muscle_cells', 'T_cells', 'Neuroepithelial_cell', 'NK_cell', 'Chondrocytes', 'Osteoblasts', 'Monocyte', 'Hepatocytes', 'Macrophage', 'CMP', 'Embryonic_stem_cells', 'DC', 'BM & Prog.', 'MEP', 'Neutrophils', 'Pro-Myelocyte', 'iPS_cells', 'Pre-B_cell_CD34-', 'HSC_-G-CSF', 'B_cell', 'GMP', 'HSC_CD34+', 'Platelets', 'Pro-B_cell_CD34+', 'Myelocyte', 'BM', 'Erythroblast', 'Unknown', 'Gametocytes']
라벨별 그룹 개수 {0: 21, 1: 30, 2: 11}
cell type :  S2108005518HRT_AAACCCAAGCAAGTCG-1     Epithelial_cells
S2108005518HRT_AAACCCAGTAGCCAGA-1     Epithelial_cells
S2108005518HRT_AAACCCAGTCAAGCGA-1    Endothelial_cells
S2108005518HRT_AAACCCAGTTCCGCGA-1              T_cells
S2108005518HRT_AAACCCATCGCTATTT-1          Hepatocytes
                                           ...        
Sample1162EO2_TTTGGAGAGCAGGCAT-1      Epithelial_cells
Sample1162EO2_TTTGGAGAGTCGCGAA-1     Endothelial_cells
Sample1162EO2_TTTGGAGAGTGCTCGC-1           Hepatocytes
Sample1162EO2_TTTGGAGGTGATACTC-1      Epithelial_cells
Sample1162EO2_TTTGGTTCAGTAGAAT-1      Epithelial_cells
Name: singler_annotation, Length: 64192, dtype: string
cell type annotation :  S2108005518HRT_AAACCCAAGCAAGTCG-1     Epithelial_cells
S2108005518HRT_AAACCCAGTAGCCAGA-1     Epithelial_cells
S2108005518HRT_AAACCCAGTCAAGCGA-1    Endothelial_cells
S2108005518HRT_AAACCCAGTTCCGCGA-1              T_cells
S2108005518HRT_AAACCCATCGCTATTT-1          Hepatocytes
                                           ...        
Sample1162EO2_TTTGGAGAGCAGGCAT-1      Epithelial_cells
Sample1162EO2_TTTGGAGAGTCGCGAA-1     Endothelial_cells
Sample1162EO2_TTTGGAGAGTGCTCGC-1           Hepatocytes
Sample1162EO2_TTTGGAGGTGATACTC-1      Epithelial_cells
Sample1162EO2_TTTGGTTCAGTAGAAT-1      Epithelial_cells
Name: singler_annotation, Length: 64192, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Epithelial_cells', 'Endothelial_cells', 'T_cells', 'Hepatocytes', 'Astrocyte', 'Smooth_muscle_cells', 'GMP', 'Neuroepithelial_cell', 'Tissue_stem_cells', 'Embryonic_stem_cells', 'Fibroblasts', 'iPS_cells', 'Neurons', 'NK_cell', 'CMP', 'Macrophage', 'Chondrocytes', 'Keratinocytes', 'Osteoblasts', 'DC', 'MEP', 'Gametocytes', 'Platelets', 'HSC_CD34+', 'HSC_-G-CSF', 'Monocyte', 'MSC', 'BM & Prog.', 'Neutrophils', 'BM', 'Erythroblast', 'B_cell', 'Pre-B_cell_CD34-', 'Unknown', 'Pro-B_cell_CD34+', 'Pro-Myelocyte', 'Myelocyte']
라벨별 그룹 개수 {0: 5, 1: 7, 2: 3}
🔍 Split #3
  → train_p_index 환자 수 (환자 단위로 묶인 index list): 62
  → test_p_index 환자 수  (환자 단위로 묶인 index list): 15
  → train 환자 ID: ['163-2', '163-3', '163-4', '163-5', '164-3', '164-6', '27-10039', '27-10041', '27-10053', '27-10071', '27-10112', '27-10119', '28-10051', '28-11515', '28-12263', '28-12381', '28-12490', '29-10008', '29-10010', '29-10011', '29-10013', '29-10016', '29-10280', '29-10380', '29-10386', '29-10404', '29-10406', '30-10018', '30-10034', '30-10123', '30-10125', '30-11051', '31-10001', '31-10013', '31-10035', '31-10040', '31-10042', '31-10078', '31-10154', '31-10210', '31-10236', '32-10003', '32-10034', '33-10005', '33-10006', '34-10184', '34-10187', 'PRE018-1', 'PRE019', 'PRE027', 'PRE038', 'PRE062-1', 'PRE98sc', 'Sample1153-EO1', 'Sample1153-EO3', 'Sample1157-EO1', 'Sample1157-EO2', 'Sample1157-EO3', 'Sample1158-EO1', 'Sample1158-EO2', 'Sample1158-EO3', 'Sample1162-EO1']
  → test  환자 ID: ['164-10', '165-9', '28-12518', '29-10006', '29-10012', '29-10398', '29-10400', '29-10410', '30-10929', '31-10000', '32-10074', '34-10050', 'PRE055-1', 'Sample1153-EO2', 'Sample1162-EO2']
  → train 환자 ID 및 라벨:
    ID: 163-2, Label: 0
    ID: 163-3, Label: 0
    ID: 163-4, Label: 0
    ID: 163-5, Label: 0
    ID: 164-3, Label: 0
    ID: 164-6, Label: 0
    ID: 27-10039, Label: 1
    ID: 27-10041, Label: 1
    ID: 27-10053, Label: 1
    ID: 27-10071, Label: 1
    ID: 27-10112, Label: 1
    ID: 27-10119, Label: 1
    ID: 28-10051, Label: 1
    ID: 28-11515, Label: 1
    ID: 28-12263, Label: 1
    ID: 28-12381, Label: 1
    ID: 28-12490, Label: 1
    ID: 29-10008, Label: 1
    ID: 29-10010, Label: 1
    ID: 29-10011, Label: 1
    ID: 29-10013, Label: 1
    ID: 29-10016, Label: 1
    ID: 29-10280, Label: 1
    ID: 29-10380, Label: 1
    ID: 29-10386, Label: 1
    ID: 29-10404, Label: 1
    ID: 29-10406, Label: 1
    ID: 30-10018, Label: 2
    ID: 30-10034, Label: 2
    ID: 30-10123, Label: 2
    ID: 30-10125, Label: 2
    ID: 30-11051, Label: 2
    ID: 31-10001, Label: 1
    ID: 31-10013, Label: 1
    ID: 31-10035, Label: 1
    ID: 31-10040, Label: 1
    ID: 31-10042, Label: 1
    ID: 31-10078, Label: 1
    ID: 31-10154, Label: 1
    ID: 31-10210, Label: 1
    ID: 31-10236, Label: 1
    ID: 32-10003, Label: 2
    ID: 32-10034, Label: 2
    ID: 33-10005, Label: 2
    ID: 33-10006, Label: 2
    ID: 34-10184, Label: 2
    ID: 34-10187, Label: 2
    ID: PRE018-1, Label: 0
    ID: PRE019, Label: 0
    ID: PRE027, Label: 0
    ID: PRE038, Label: 0
    ID: PRE062-1, Label: 0
    ID: PRE98sc, Label: 0
    ID: Sample1153-EO1, Label: 0
    ID: Sample1153-EO3, Label: 0
    ID: Sample1157-EO1, Label: 0
    ID: Sample1157-EO2, Label: 0
    ID: Sample1157-EO3, Label: 0
    ID: Sample1158-EO1, Label: 0
    ID: Sample1158-EO2, Label: 0
    ID: Sample1158-EO3, Label: 0
    ID: Sample1162-EO1, Label: 0
  → test 환자 ID 및 라벨:
    ID: 164-10, Label: 0
    ID: 165-9, Label: 0
    ID: 28-12518, Label: 1
    ID: 29-10006, Label: 1
    ID: 29-10012, Label: 1
    ID: 29-10398, Label: 1
    ID: 29-10400, Label: 1
    ID: 29-10410, Label: 1
    ID: 30-10929, Label: 2
    ID: 31-10000, Label: 1
    ID: 32-10074, Label: 2
    ID: 34-10050, Label: 2
    ID: PRE055-1, Label: 0
    ID: Sample1153-EO2, Label: 0
    ID: Sample1162-EO2, Label: 0
전체 데이터 index 길이 77
label_stat (train 환자 라벨 목록) 갯수 62
train_data에서 환자 단위로, train과 validation 나누기
기존 train_p_index 62
기존 (train) label_stat 62
train-vali 분할 후! 
train y 의 classes : {0, 1, 2} valid y 의 classes : {0, 1, 2} label_stat 의 classes : {0, 1, 2}
train_p_index_ 41
valid_p_index 21
test_p_index 15
→ train 환자 ID 및 라벨:
   총 개수: 41
   환자ID=29-10016, Label=1, 셀개수=4854
   환자ID=31-10154, Label=1, 셀개수=6568
   환자ID=34-10187, Label=2, 셀개수=3739
   환자ID=32-10003, Label=2, 셀개수=2978
   환자ID=Sample1158-EO1, Label=0, 셀개수=574
   환자ID=163-5, Label=0, 셀개수=1210
   환자ID=29-10008, Label=1, 셀개수=1913
   환자ID=PRE038, Label=0, 셀개수=2666
   환자ID=31-10013, Label=1, 셀개수=3161
   환자ID=30-11051, Label=2, 셀개수=2454
   환자ID=163-3, Label=0, 셀개수=1335
   환자ID=27-10119, Label=1, 셀개수=3346
   환자ID=27-10039, Label=1, 셀개수=4638
   환자ID=27-10041, Label=1, 셀개수=2145
   환자ID=163-2, Label=0, 셀개수=2535
   환자ID=30-10034, Label=2, 셀개수=1240
   환자ID=31-10040, Label=1, 셀개수=4543
   환자ID=30-10125, Label=2, 셀개수=3798
   환자ID=Sample1158-EO2, Label=0, 셀개수=1427
   환자ID=29-10380, Label=1, 셀개수=4799
   환자ID=31-10035, Label=1, 셀개수=2974
   환자ID=163-4, Label=0, 셀개수=1339
   환자ID=31-10236, Label=1, 셀개수=3458
   환자ID=PRE98sc, Label=0, 셀개수=1568
   환자ID=29-10406, Label=1, 셀개수=3484
   환자ID=28-11515, Label=1, 셀개수=930
   환자ID=Sample1158-EO3, Label=0, 셀개수=1096
   환자ID=31-10042, Label=1, 셀개수=1222
   환자ID=PRE018-1, Label=0, 셀개수=1349
   환자ID=27-10112, Label=1, 셀개수=1470
   환자ID=28-12490, Label=1, 셀개수=5973
   환자ID=28-10051, Label=1, 셀개수=300
   환자ID=164-6, Label=0, 셀개수=3038
   환자ID=29-10404, Label=1, 셀개수=3988
   환자ID=34-10184, Label=2, 셀개수=2699
   환자ID=29-10280, Label=1, 셀개수=2375
   환자ID=33-10005, Label=2, 셀개수=8904
   환자ID=32-10034, Label=2, 셀개수=1555
   환자ID=31-10210, Label=1, 셀개수=3510
   환자ID=29-10013, Label=1, 셀개수=3706
   환자ID=28-12381, Label=1, 셀개수=1099
→ valid 환자 ID 및 라벨:
   총 개수: 21
   환자ID=Sample1162-EO1, Label=0, 셀개수=1053
   환자ID=29-10011, Label=1, 셀개수=3072
   환자ID=31-10078, Label=1, 셀개수=2827
   환자ID=Sample1153-EO1, Label=0, 셀개수=911
   환자ID=33-10006, Label=2, 셀개수=457
   환자ID=PRE062-1, Label=0, 셀개수=907
   환자ID=Sample1157-EO2, Label=0, 셀개수=1395
   환자ID=30-10123, Label=2, 셀개수=1273
   환자ID=31-10001, Label=1, 셀개수=1133
   환자ID=30-10018, Label=2, 셀개수=5170
   환자ID=Sample1157-EO3, Label=0, 셀개수=807
   환자ID=27-10071, Label=1, 셀개수=1478
   환자ID=29-10386, Label=1, 셀개수=802
   환자ID=Sample1153-EO3, Label=0, 셀개수=1516
   환자ID=PRE027, Label=0, 셀개수=2078
   환자ID=PRE019, Label=0, 셀개수=3795
   환자ID=164-3, Label=0, 셀개수=1639
   환자ID=29-10010, Label=1, 셀개수=5305
   환자ID=27-10053, Label=1, 셀개수=728
   환자ID=28-12263, Label=1, 셀개수=7527
   환자ID=Sample1157-EO1, Label=0, 셀개수=1152
→ test 환자 ID 및 라벨:
   총 개수: 15
   환자ID=164-10, Label=0, 셀개수=4041
   환자ID=165-9, Label=0, 셀개수=2926
   환자ID=28-12518, Label=1, 셀개수=1215
   환자ID=29-10006, Label=1, 셀개수=11461
   환자ID=29-10012, Label=1, 셀개수=6245
   환자ID=29-10398, Label=1, 셀개수=3993
   환자ID=29-10400, Label=1, 셀개수=2684
   환자ID=29-10410, Label=1, 셀개수=2834
   환자ID=30-10929, Label=2, 셀개수=5812
   환자ID=31-10000, Label=1, 셀개수=8870
   환자ID=32-10074, Label=2, 셀개수=6304
   환자ID=34-10050, Label=2, 셀개수=4784
   환자ID=PRE055-1, Label=0, 셀개수=597
   환자ID=Sample1153-EO2, Label=0, 셀개수=916
   환자ID=Sample1162-EO2, Label=0, 셀개수=1510
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Epithelial_cells', 'Epithelial_cells', 'Astrocyte', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'MSC', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
전체 데이터 길이 225177
전체 cell type 길이 0          Epithelial_cells
1          Epithelial_cells
2                 Astrocyte
3          Epithelial_cells
4          Epithelial_cells
                ...        
225172     Epithelial_cells
225173    Endothelial_cells
225174          Hepatocytes
225175     Epithelial_cells
225176     Epithelial_cells
Length: 225177, dtype: string
cell type의 NaN 개수 체크 0
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:10,  9.65it/s]  2%|▏         | 2/100 [00:00<00:10,  9.42it/s]  3%|▎         | 3/100 [00:00<00:10,  9.60it/s]  4%|▍         | 4/100 [00:00<00:09,  9.75it/s]  5%|▌         | 5/100 [00:00<00:09,  9.78it/s]  6%|▌         | 6/100 [00:00<00:09,  9.54it/s]  7%|▋         | 7/100 [00:00<00:10,  9.09it/s]  8%|▊         | 8/100 [00:00<00:09,  9.23it/s]  9%|▉         | 9/100 [00:00<00:09,  9.29it/s] 10%|█         | 10/100 [00:01<00:09,  9.40it/s] 11%|█         | 11/100 [00:01<00:09,  9.54it/s] 12%|█▏        | 12/100 [00:01<00:09,  9.37it/s] 13%|█▎        | 13/100 [00:01<00:09,  9.43it/s] 14%|█▍        | 14/100 [00:01<00:09,  9.49it/s] 15%|█▌        | 15/100 [00:01<00:08,  9.50it/s] 16%|█▌        | 16/100 [00:01<00:11,  7.44it/s] 17%|█▋        | 17/100 [00:01<00:10,  8.02it/s] 18%|█▊        | 18/100 [00:01<00:09,  8.41it/s] 19%|█▉        | 19/100 [00:02<00:09,  8.81it/s] 20%|██        | 20/100 [00:02<00:09,  8.75it/s] 21%|██        | 21/100 [00:02<00:09,  8.71it/s] 22%|██▏       | 22/100 [00:02<00:08,  8.70it/s] 23%|██▎       | 23/100 [00:02<00:08,  8.92it/s] 24%|██▍       | 24/100 [00:02<00:08,  8.91it/s] 25%|██▌       | 25/100 [00:02<00:08,  8.88it/s] 26%|██▌       | 26/100 [00:02<00:08,  8.89it/s] 27%|██▋       | 27/100 [00:03<00:08,  8.88it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.84it/s] 29%|██▉       | 29/100 [00:03<00:08,  8.81it/s] 30%|███       | 30/100 [00:03<00:08,  8.67it/s] 31%|███       | 31/100 [00:03<00:07,  8.73it/s] 32%|███▏      | 32/100 [00:03<00:07,  8.76it/s] 33%|███▎      | 33/100 [00:03<00:07,  8.89it/s] 34%|███▍      | 34/100 [00:03<00:07,  8.90it/s] 35%|███▌      | 35/100 [00:03<00:07,  9.11it/s] 36%|███▌      | 36/100 [00:04<00:07,  8.43it/s] 37%|███▋      | 37/100 [00:04<00:07,  8.53it/s] 38%|███▊      | 38/100 [00:04<00:07,  8.62it/s] 39%|███▉      | 39/100 [00:04<00:06,  8.81it/s] 40%|████      | 40/100 [00:04<00:06,  8.98it/s] 41%|████      | 41/100 [00:04<00:06,  8.98it/s] 42%|████▏     | 42/100 [00:04<00:06,  9.01it/s] 43%|████▎     | 43/100 [00:04<00:06,  8.81it/s] 44%|████▍     | 44/100 [00:04<00:06,  8.85it/s] 45%|████▌     | 45/100 [00:05<00:07,  7.15it/s] 46%|████▌     | 46/100 [00:05<00:07,  7.49it/s] 47%|████▋     | 47/100 [00:05<00:06,  7.79it/s] 48%|████▊     | 48/100 [00:05<00:06,  8.06it/s] 49%|████▉     | 49/100 [00:05<00:06,  8.27it/s] 50%|█████     | 50/100 [00:05<00:06,  8.33it/s] 51%|█████     | 51/100 [00:05<00:05,  8.56it/s] 52%|█████▏    | 52/100 [00:05<00:05,  8.61it/s] 53%|█████▎    | 53/100 [00:06<00:05,  8.05it/s] 54%|█████▍    | 54/100 [00:06<00:05,  8.53it/s] 55%|█████▌    | 55/100 [00:06<00:05,  8.53it/s] 56%|█████▌    | 56/100 [00:06<00:05,  8.50it/s] 57%|█████▋    | 57/100 [00:06<00:04,  8.64it/s] 58%|█████▊    | 58/100 [00:06<00:04,  8.55it/s] 59%|█████▉    | 59/100 [00:06<00:04,  8.60it/s] 60%|██████    | 60/100 [00:06<00:04,  8.62it/s] 61%|██████    | 61/100 [00:06<00:04,  8.57it/s] 62%|██████▏   | 62/100 [00:07<00:04,  7.92it/s] 63%|██████▎   | 63/100 [00:07<00:04,  7.98it/s] 64%|██████▍   | 64/100 [00:07<00:04,  8.37it/s] 65%|██████▌   | 65/100 [00:07<00:04,  8.41it/s] 66%|██████▌   | 66/100 [00:07<00:04,  8.41it/s] 67%|██████▋   | 67/100 [00:07<00:03,  8.38it/s] 68%|██████▊   | 68/100 [00:07<00:03,  8.36it/s] 69%|██████▉   | 69/100 [00:07<00:03,  8.53it/s] 70%|███████   | 70/100 [00:08<00:03,  8.69it/s] 71%|███████   | 71/100 [00:08<00:03,  8.62it/s] 72%|███████▏  | 72/100 [00:08<00:03,  8.57it/s] 73%|███████▎  | 73/100 [00:08<00:03,  8.75it/s] 74%|███████▍  | 74/100 [00:08<00:03,  8.66it/s] 75%|███████▌  | 75/100 [00:08<00:02,  8.67it/s] 76%|███████▌  | 76/100 [00:08<00:02,  8.47it/s] 77%|███████▋  | 77/100 [00:08<00:02,  8.37it/s] 78%|███████▊  | 78/100 [00:09<00:03,  7.15it/s] 79%|███████▉  | 79/100 [00:09<00:02,  7.40it/s] 80%|████████  | 80/100 [00:09<00:02,  7.91it/s] 81%|████████  | 81/100 [00:09<00:02,  7.90it/s] 82%|████████▏ | 82/100 [00:09<00:02,  7.83it/s] 83%|████████▎ | 83/100 [00:09<00:02,  8.05it/s] 84%|████████▍ | 84/100 [00:09<00:02,  7.92it/s] 85%|████████▌ | 85/100 [00:09<00:01,  7.92it/s] 86%|████████▌ | 86/100 [00:10<00:01,  8.01it/s] 87%|████████▋ | 87/100 [00:10<00:01,  7.75it/s] 88%|████████▊ | 88/100 [00:10<00:01,  7.98it/s] 89%|████████▉ | 89/100 [00:10<00:01,  8.04it/s] 90%|█████████ | 90/100 [00:10<00:01,  8.05it/s] 91%|█████████ | 91/100 [00:10<00:01,  8.11it/s] 92%|█████████▏| 92/100 [00:10<00:01,  5.70it/s] 93%|█████████▎| 93/100 [00:11<00:01,  6.08it/s] 94%|█████████▍| 94/100 [00:11<00:01,  5.88it/s] 95%|█████████▌| 95/100 [00:11<00:00,  6.31it/s] 96%|█████████▌| 96/100 [00:11<00:00,  6.18it/s] 97%|█████████▋| 97/100 [00:11<00:00,  6.56it/s] 98%|█████████▊| 98/100 [00:11<00:00,  6.87it/s] 99%|█████████▉| 99/100 [00:12<00:00,  7.12it/s]100%|██████████| 100/100 [00:12<00:00,  7.29it/s]100%|██████████| 100/100 [00:12<00:00,  8.24it/s]
[I 2025-08-31 13:04:26,427] A new study created in memory with name: no-name-bacdd0fb-26b4-4520-80d6-72742882d5a0
👉 train samples(학습 샘플(bag))=141, batch_size=8 -> steps(샘플수/batch크기)=18
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 26.13 MB
Memory Reserved: 36.00 MB
cuda
Epoch 1, Train Loss 0.903375, Valid_loss 1.048537
Epoch 2, Train Loss 0.842838, Valid_loss 1.017425
Epoch 3, Train Loss 0.784623, Valid_loss 0.854262
Epoch 4, Train Loss 0.724684, Valid_loss 0.758408
Epoch 5, Train Loss 0.664012, Valid_loss 0.698895
Epoch 6, Train Loss 0.609393, Valid_loss 0.601075
Epoch 7, Train Loss 0.567786, Valid_loss 0.649330
Epoch 8, Train Loss 0.542480, Valid_loss 0.533640
Epoch 9, Train Loss 0.519549, Valid_loss 0.557564
Epoch 10, Train Loss 0.472962, Valid_loss 0.554738
Epoch 11, Train Loss 0.486963, Valid_loss 0.517354
Epoch 12, Train Loss 0.462688, Valid_loss 0.462687
Epoch 13, Train Loss 0.410196, Valid_loss 0.503041
Epoch 14, Train Loss 0.410361, Valid_loss 0.662875
Epoch 15, Train Loss 0.446802, Valid_loss 0.533793
Epoch 16, Train Loss 0.384646, Valid_loss 0.472520
Epoch 17, Train Loss 0.359503, Valid_loss 0.563547
Epoch 18, Train Loss 0.389537, Valid_loss 0.584893
Epoch 19, Train Loss 0.424378, Valid_loss 0.473886
Epoch 20, Train Loss 0.353482, Valid_loss 0.490974
Epoch 21, Train Loss 0.317327, Valid_loss 0.443284
Epoch 22, Train Loss 0.329320, Valid_loss 0.488040
Epoch 23, Train Loss 0.328206, Valid_loss 0.403366
Epoch 24, Train Loss 0.311020, Valid_loss 0.358622
Epoch 25, Train Loss 0.294384, Valid_loss 0.464297
Epoch 26, Train Loss 0.300862, Valid_loss 0.385441
Epoch 27, Train Loss 0.301649, Valid_loss 0.345509
Epoch 28, Train Loss 0.278182, Valid_loss 0.459253
Epoch 29, Train Loss 0.305199, Valid_loss 0.374195
Epoch 30, Train Loss 0.268015, Valid_loss 0.380118
Epoch 31, Train Loss 0.260763, Valid_loss 0.375891
Epoch 32, Train Loss 0.256806, Valid_loss 0.371636
Epoch 33, Train Loss 0.270738, Valid_loss 0.324879
Epoch 34, Train Loss 0.247493, Valid_loss 0.363331
Epoch 35, Train Loss 0.237996, Valid_loss 0.404689
Epoch 36, Train Loss 0.255380, Valid_loss 0.351923
Epoch 37, Train Loss 0.258926, Valid_loss 0.410155
Epoch 38, Train Loss 0.223336, Valid_loss 0.338525
Epoch 39, Train Loss 0.218404, Valid_loss 0.351663
Epoch 40, Train Loss 0.222283, Valid_loss 0.340060
Epoch 41, Train Loss 0.224178, Valid_loss 0.409975
Epoch 42, Train Loss 0.216913, Valid_loss 0.339912
Epoch 43, Train Loss 0.209469, Valid_loss 0.332172
Epoch 44, Train Loss 0.215289, Valid_loss 0.352062
Epoch 45, Train Loss 0.214776, Valid_loss 0.320907
Epoch 46, Train Loss 0.212436, Valid_loss 0.431342
Epoch 47, Train Loss 0.211857, Valid_loss 0.303230
Epoch 48, Train Loss 0.204988, Valid_loss 0.329527
Epoch 49, Train Loss 0.227280, Valid_loss 0.380679
Epoch 50, Train Loss 0.202953, Valid_loss 0.365946
Epoch 51, Train Loss 0.220476, Valid_loss 0.352216
Epoch 52, Train Loss 0.178655, Valid_loss 0.319095
Epoch 53, Train Loss 0.179566, Valid_loss 0.346678
Epoch 54, Train Loss 0.175453, Valid_loss 0.373653
[I 2025-08-31 13:10:39,877] Trial 0 finished with value: 0.30323033105759395 and parameters: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 2, 'dropout': 0.0, 'weight_decay': 0.01, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.30323033105759395.
👉 train samples(학습 샘플(bag))=141, batch_size=8 -> steps(샘플수/batch크기)=18
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 27.97 MB
Memory Reserved: 36.00 MB
cuda
Epoch 1, Train Loss 0.956165, Valid_loss 1.189060
Epoch 2, Train Loss 0.898885, Valid_loss 1.156457
Epoch 3, Train Loss 0.902454, Valid_loss 1.064672
Epoch 4, Train Loss 0.911595, Valid_loss 1.075926
Epoch 5, Train Loss 0.900462, Valid_loss 1.159562
Epoch 6, Train Loss 0.896743, Valid_loss 1.156952
Epoch 7, Train Loss 0.870066, Valid_loss 1.081245
Epoch 8, Train Loss 0.880505, Valid_loss 1.122047
Epoch 9, Train Loss 0.869855, Valid_loss 1.127304
Epoch 10, Train Loss 0.884108, Valid_loss 1.055442
Epoch 11, Train Loss 0.888044, Valid_loss 1.119360
Epoch 12, Train Loss 0.874043, Valid_loss 1.117344
Epoch 13, Train Loss 0.885380, Valid_loss 1.132125
Epoch 14, Train Loss 0.875898, Valid_loss 1.124746
Epoch 15, Train Loss 0.877099, Valid_loss 1.108448
Epoch 16, Train Loss 0.884571, Valid_loss 1.129550
Epoch 17, Train Loss 0.884670, Valid_loss 1.095872
Epoch 18, Train Loss 0.886136, Valid_loss 1.092734
Epoch 19, Train Loss 0.877118, Valid_loss 1.082502
Epoch 20, Train Loss 0.876396, Valid_loss 1.150713
Epoch 21, Train Loss 0.887763, Valid_loss 1.184912
Epoch 22, Train Loss 0.882692, Valid_loss 1.138228
Epoch 23, Train Loss 0.878061, Valid_loss 1.138918
Epoch 24, Train Loss 0.875225, Valid_loss 1.124812
Epoch 25, Train Loss 0.871195, Valid_loss 1.143531
Epoch 26, Train Loss 0.874221, Valid_loss 1.139402
Epoch 27, Train Loss 0.874878, Valid_loss 1.044712
Epoch 28, Train Loss 0.924951, Valid_loss 1.098560
Epoch 29, Train Loss 0.880023, Valid_loss 1.099742
Epoch 30, Train Loss 0.879790, Valid_loss 1.093890
Epoch 31, Train Loss 0.865688, Valid_loss 1.121950
Epoch 32, Train Loss 0.884904, Valid_loss 1.104007
Epoch 33, Train Loss 0.862771, Valid_loss 1.133816
Epoch 34, Train Loss 0.874210, Valid_loss 1.077757
Epoch 35, Train Loss 0.879343, Valid_loss 1.116335
Epoch 36, Train Loss 0.870421, Valid_loss 1.143020
Epoch 37, Train Loss 0.865240, Valid_loss 1.032904
Epoch 38, Train Loss 0.886662, Valid_loss 1.116210
Epoch 39, Train Loss 0.900948, Valid_loss 1.071067
Epoch 40, Train Loss 0.877704, Valid_loss 1.091972
Epoch 41, Train Loss 0.896409, Valid_loss 1.111252
Epoch 42, Train Loss 0.875444, Valid_loss 1.101888
Epoch 43, Train Loss 0.860401, Valid_loss 1.158401
Epoch 44, Train Loss 0.880406, Valid_loss 1.172659
Epoch 45, Train Loss 0.865637, Valid_loss 1.113924
Epoch 46, Train Loss 0.868996, Valid_loss 1.172037
Epoch 47, Train Loss 0.867388, Valid_loss 1.177201
Epoch 48, Train Loss 0.871196, Valid_loss 1.162915
Epoch 49, Train Loss 0.867963, Valid_loss 1.141484
Epoch 50, Train Loss 0.862589, Valid_loss 1.133483
Epoch 51, Train Loss 0.854854, Valid_loss 1.169904
Epoch 52, Train Loss 0.856657, Valid_loss 1.172585
[I 2025-08-31 13:16:40,509] Trial 1 finished with value: 1.0329040544373649 and parameters: {'learning_rate': 0.01, 'epochs': 100, 'heads': 2, 'dropout': 0.0, 'weight_decay': 0.01, 'emb_dim': 64, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.30323033105759395.
👉 train samples(학습 샘플(bag))=141, batch_size=8 -> steps(샘플수/batch크기)=18
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 27.97 MB
Memory Reserved: 36.00 MB
cuda
Epoch 1, Train Loss 0.873949, Valid_loss 0.957454
Epoch 2, Train Loss 0.736180, Valid_loss 0.823471
Epoch 3, Train Loss 0.598627, Valid_loss 0.604779
Epoch 4, Train Loss 0.497603, Valid_loss 0.537503
Epoch 5, Train Loss 0.478569, Valid_loss 0.538682
Epoch 6, Train Loss 0.472272, Valid_loss 0.568534
Epoch 7, Train Loss 0.415661, Valid_loss 0.446091
Epoch 8, Train Loss 0.434417, Valid_loss 0.440700
Epoch 9, Train Loss 0.342025, Valid_loss 0.382232
Epoch 10, Train Loss 0.352863, Valid_loss 0.369044
Epoch 11, Train Loss 0.291908, Valid_loss 0.340666
Epoch 12, Train Loss 0.285800, Valid_loss 0.392876
Epoch 13, Train Loss 0.264249, Valid_loss 0.321641
Epoch 14, Train Loss 0.233978, Valid_loss 0.315657
Epoch 15, Train Loss 0.234789, Valid_loss 0.378744
Epoch 16, Train Loss 0.233214, Valid_loss 0.310667
Epoch 17, Train Loss 0.247140, Valid_loss 0.540403
Epoch 18, Train Loss 0.278652, Valid_loss 0.463554
Epoch 19, Train Loss 0.294327, Valid_loss 0.321670
Epoch 20, Train Loss 0.218964, Valid_loss 0.441795
Epoch 21, Train Loss 0.245210, Valid_loss 0.307414
Epoch 22, Train Loss 0.198393, Valid_loss 0.269568
Epoch 23, Train Loss 0.217019, Valid_loss 0.360676
Epoch 24, Train Loss 0.236879, Valid_loss 0.265356
Epoch 25, Train Loss 0.175413, Valid_loss 0.328159
Epoch 26, Train Loss 0.177052, Valid_loss 0.251822
Epoch 27, Train Loss 0.184791, Valid_loss 0.307076
Epoch 28, Train Loss 0.167337, Valid_loss 0.280539
Epoch 29, Train Loss 0.147533, Valid_loss 0.340271
Epoch 30, Train Loss 0.165748, Valid_loss 0.214493
Epoch 31, Train Loss 0.169934, Valid_loss 0.243594
Epoch 32, Train Loss 0.143557, Valid_loss 0.265657
Epoch 33, Train Loss 0.133825, Valid_loss 0.259066
Epoch 34, Train Loss 0.130014, Valid_loss 0.270773
Epoch 35, Train Loss 0.137005, Valid_loss 0.295408
Epoch 36, Train Loss 0.185565, Valid_loss 0.458617
Epoch 37, Train Loss 0.227756, Valid_loss 0.425207
Epoch 38, Train Loss 0.192293, Valid_loss 0.274903
Epoch 39, Train Loss 0.133337, Valid_loss 0.201820
Epoch 40, Train Loss 0.121103, Valid_loss 0.269315
Epoch 41, Train Loss 0.112017, Valid_loss 0.359334
Epoch 42, Train Loss 0.117247, Valid_loss 0.222135
Epoch 43, Train Loss 0.171742, Valid_loss 0.372419
Epoch 44, Train Loss 0.129113, Valid_loss 0.314246
Epoch 45, Train Loss 0.124270, Valid_loss 0.204397
Epoch 46, Train Loss 0.116564, Valid_loss 0.261833
Epoch 47, Train Loss 0.103392, Valid_loss 0.363993
Epoch 48, Train Loss 0.135813, Valid_loss 0.205638
Epoch 49, Train Loss 0.136049, Valid_loss 0.325262
Epoch 50, Train Loss 0.110955, Valid_loss 0.270889
Epoch 51, Train Loss 0.093870, Valid_loss 0.241141
Epoch 52, Train Loss 0.089758, Valid_loss 0.236013
Epoch 53, Train Loss 0.086344, Valid_loss 0.246313
Epoch 54, Train Loss 0.083632, Valid_loss 0.239978
Epoch 55, Train Loss 0.082853, Valid_loss 0.251789
Epoch 56, Train Loss 0.081433, Valid_loss 0.243838
Epoch 57, Train Loss 0.084770, Valid_loss 0.292963
Epoch 58, Train Loss 0.079891, Valid_loss 0.245393
Epoch 59, Train Loss 0.079180, Valid_loss 0.242346
Epoch 60, Train Loss 0.075828, Valid_loss 0.263006
Epoch 61, Train Loss 0.075084, Valid_loss 0.248518
Epoch 62, Train Loss 0.077034, Valid_loss 0.243182
Epoch 63, Train Loss 0.080491, Valid_loss 0.239148
Epoch 64, Train Loss 0.072076, Valid_loss 0.286860
Epoch 65, Train Loss 0.075748, Valid_loss 0.224878
Epoch 66, Train Loss 0.083294, Valid_loss 0.340480
Epoch 67, Train Loss 0.087713, Valid_loss 0.259435
Epoch 68, Train Loss 0.082805, Valid_loss 0.229510
Epoch 69, Train Loss 0.085611, Valid_loss 0.224040
Epoch 70, Train Loss 0.074181, Valid_loss 0.257103
Epoch 71, Train Loss 0.070208, Valid_loss 0.280738
[I 2025-08-31 13:24:08,180] Trial 2 finished with value: 0.20182015072731746 and parameters: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 1, 'dropout': 0.0, 'weight_decay': 0.0001, 'emb_dim': 64, 'augment_num': 100, 'pca': False}. Best is trial 2 with value: 0.20182015072731746.
선택된 trial params: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 1, 'dropout': 0.0, 'weight_decay': 0.0001, 'emb_dim': 64, 'augment_num': 100, 'pca': False}
👉 train samples(학습 샘플(bag))=141, batch_size=8 -> steps(샘플수/batch크기)=18
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=15, batch_size=1 -> steps=15
Memory Allocated: 27.97 MB
Memory Reserved: 36.00 MB
cuda
Epoch 1, Train Loss 0.894779, Valid_loss 1.040803
Epoch 2, Train Loss 0.820221, Valid_loss 0.964416
Epoch 3, Train Loss 0.732343, Valid_loss 0.817812
Epoch 4, Train Loss 0.598999, Valid_loss 0.622201
Epoch 5, Train Loss 0.534527, Valid_loss 0.584579
Epoch 6, Train Loss 0.451224, Valid_loss 0.546652
Epoch 7, Train Loss 0.454230, Valid_loss 0.472678
Epoch 8, Train Loss 0.390922, Valid_loss 0.421273
Epoch 9, Train Loss 0.354286, Valid_loss 0.496329
Epoch 10, Train Loss 0.314173, Valid_loss 0.481246
Epoch 11, Train Loss 0.362212, Valid_loss 0.485186
Epoch 12, Train Loss 0.312979, Valid_loss 0.383683
Epoch 13, Train Loss 0.301595, Valid_loss 0.435620
Epoch 14, Train Loss 0.298711, Valid_loss 0.475391
Epoch 15, Train Loss 0.283221, Valid_loss 0.347150
Epoch 16, Train Loss 0.240878, Valid_loss 0.353140
Epoch 17, Train Loss 0.265013, Valid_loss 0.315745
Epoch 18, Train Loss 0.235311, Valid_loss 0.378482
Epoch 19, Train Loss 0.258957, Valid_loss 0.329006
Epoch 20, Train Loss 0.215048, Valid_loss 0.314098
Epoch 21, Train Loss 0.208188, Valid_loss 0.329506
Epoch 22, Train Loss 0.192211, Valid_loss 0.352185
Epoch 23, Train Loss 0.182919, Valid_loss 0.351039
Epoch 24, Train Loss 0.206595, Valid_loss 0.340952
Epoch 25, Train Loss 0.204731, Valid_loss 0.286486
Epoch 26, Train Loss 0.291099, Valid_loss 0.337826
Epoch 27, Train Loss 0.206528, Valid_loss 0.322130
Epoch 28, Train Loss 0.195681, Valid_loss 0.249870
Epoch 29, Train Loss 0.191609, Valid_loss 0.298837
Epoch 30, Train Loss 0.227026, Valid_loss 0.295132
Epoch 31, Train Loss 0.224293, Valid_loss 0.257779
Epoch 32, Train Loss 0.162179, Valid_loss 0.255983
Epoch 33, Train Loss 0.159085, Valid_loss 0.266869
Epoch 34, Train Loss 0.156244, Valid_loss 0.276616
Epoch 35, Train Loss 0.149385, Valid_loss 0.264984
Epoch 36, Train Loss 0.151806, Valid_loss 0.248661
Epoch 37, Train Loss 0.148506, Valid_loss 0.284529
Epoch 38, Train Loss 0.135003, Valid_loss 0.355534
Epoch 39, Train Loss 0.131252, Valid_loss 0.235433
Epoch 40, Train Loss 0.140694, Valid_loss 0.291717
Epoch 41, Train Loss 0.139703, Valid_loss 0.385337
Epoch 42, Train Loss 0.160014, Valid_loss 0.264874
Epoch 43, Train Loss 0.134872, Valid_loss 0.248072
Epoch 44, Train Loss 0.115926, Valid_loss 0.254292
Epoch 45, Train Loss 0.118712, Valid_loss 0.304158
Epoch 46, Train Loss 0.144601, Valid_loss 0.261929
Epoch 47, Train Loss 0.117343, Valid_loss 0.224543
Epoch 48, Train Loss 0.185564, Valid_loss 0.237471
Epoch 49, Train Loss 0.150548, Valid_loss 0.419893
Epoch 50, Train Loss 0.176323, Valid_loss 0.418222
Epoch 51, Train Loss 0.156107, Valid_loss 0.283235
Epoch 52, Train Loss 0.107409, Valid_loss 0.268340
Epoch 53, Train Loss 0.102164, Valid_loss 0.280270
Epoch 54, Train Loss 0.096492, Valid_loss 0.295959
환자ID=164-10 -- true: [[0]] -- pred: tensor([[ 2.5158, -1.5642, -2.1234]], device='cuda:0')
환자ID=165-9 -- true: [[0]] -- pred: tensor([[ 2.6935, -1.7486, -2.0807]], device='cuda:0')
환자ID=28-12518 -- true: [[1]] -- pred: tensor([[-1.4287,  2.6845, -0.9556]], device='cuda:0')
환자ID=29-10006 -- true: [[1]] -- pred: tensor([[-1.8918,  1.1454,  0.4237]], device='cuda:0')
환자ID=29-10012 -- true: [[1]] -- pred: tensor([[ 0.4090,  1.1629, -1.7961]], device='cuda:0')
환자ID=29-10398 -- true: [[1]] -- pred: tensor([[-1.3800,  2.7065, -0.9065]], device='cuda:0')
환자ID=29-10400 -- true: [[1]] -- pred: tensor([[-1.2293,  2.7025, -1.1251]], device='cuda:0')
환자ID=29-10410 -- true: [[1]] -- pred: tensor([[-1.3578,  2.7300, -0.9646]], device='cuda:0')
환자ID=30-10929 -- true: [[2]] -- pred: tensor([[-1.9219,  1.0638,  0.6969]], device='cuda:0')
환자ID=31-10000 -- true: [[1]] -- pred: tensor([[ 1.0878,  0.6101, -1.7785]], device='cuda:0')
환자ID=32-10074 -- true: [[2]] -- pred: tensor([[-1.5551,  1.2529, -0.1029]], device='cuda:0')
환자ID=34-10050 -- true: [[2]] -- pred: tensor([[-1.7460,  0.0952,  0.9440]], device='cuda:0')
환자ID=PRE055-1 -- true: [[0]] -- pred: tensor([[ 2.7176, -2.0167, -1.9349]], device='cuda:0')
환자ID=Sample1153-EO2 -- true: [[0]] -- pred: tensor([[ 2.7279, -1.9657, -1.9182]], device='cuda:0')
환자ID=Sample1162-EO2 -- true: [[0]] -- pred: tensor([[ 2.7162, -1.8701, -2.0305]], device='cuda:0')
Best performance: Epoch 47, Loss 0.117343, Test ACC 0.800000, Test AUC 0.960317, Test Recall 0.730159, Test Precision 0.861111
Confusion Matrix:
 [[5 0 0]
 [1 6 0]
 [0 2 1]]
✅ Total valid splits used: 3
🔁 Repeat 4, Fold 3
cell type :  S2008000605HRT_AAACCCAGTGCACATT-1     Epithelial_cells
S2008000605HRT_AAACCCAGTGCCTACG-1     Epithelial_cells
S2008000605HRT_AAAGAACGTAGAGACC-1            Astrocyte
S2008000605HRT_AAAGAACGTCGGAACA-1     Epithelial_cells
S2008000605HRT_AAAGAACGTTAACAGA-1     Epithelial_cells
                                           ...        
Sample1162EO2_TTTGGAGAGCAGGCAT-1      Epithelial_cells
Sample1162EO2_TTTGGAGAGTCGCGAA-1     Endothelial_cells
Sample1162EO2_TTTGGAGAGTGCTCGC-1           Hepatocytes
Sample1162EO2_TTTGGAGGTGATACTC-1      Epithelial_cells
Sample1162EO2_TTTGGTTCAGTAGAAT-1      Epithelial_cells
Name: singler_annotation, Length: 185672, dtype: string
cell type annotation :  S2008000605HRT_AAACCCAGTGCACATT-1     Epithelial_cells
S2008000605HRT_AAACCCAGTGCCTACG-1     Epithelial_cells
S2008000605HRT_AAAGAACGTAGAGACC-1            Astrocyte
S2008000605HRT_AAAGAACGTCGGAACA-1     Epithelial_cells
S2008000605HRT_AAAGAACGTTAACAGA-1     Epithelial_cells
                                           ...        
Sample1162EO2_TTTGGAGAGCAGGCAT-1      Epithelial_cells
Sample1162EO2_TTTGGAGAGTCGCGAA-1     Endothelial_cells
Sample1162EO2_TTTGGAGAGTGCTCGC-1           Hepatocytes
Sample1162EO2_TTTGGAGGTGATACTC-1      Epithelial_cells
Sample1162EO2_TTTGGTTCAGTAGAAT-1      Epithelial_cells
Name: singler_annotation, Length: 185672, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Epithelial_cells', 'Astrocyte', 'MSC', 'Keratinocytes', 'Neurons', 'Endothelial_cells', 'Fibroblasts', 'Tissue_stem_cells', 'Smooth_muscle_cells', 'T_cells', 'Neuroepithelial_cell', 'NK_cell', 'Chondrocytes', 'Osteoblasts', 'Monocyte', 'Hepatocytes', 'Macrophage', 'CMP', 'Embryonic_stem_cells', 'DC', 'BM & Prog.', 'MEP', 'Neutrophils', 'Pro-Myelocyte', 'iPS_cells', 'Pre-B_cell_CD34-', 'HSC_-G-CSF', 'B_cell', 'BM', 'Platelets', 'GMP', 'HSC_CD34+', 'Pro-B_cell_CD34+', 'Erythroblast', 'Myelocyte', 'Unknown', 'Gametocytes']
라벨별 그룹 개수 {0: 21, 1: 30, 2: 11}
cell type :  S2008000628HRT_AAACCCAAGACGCTCC-1                   DC
S2008000628HRT_AAACCCAAGTAGCCAG-1              T_cells
S2008000628HRT_AAACCCAGTCCAGAAG-1              T_cells
S2008000628HRT_AAACCCAGTGTATCCA-1               B_cell
S2008000628HRT_AAACGAAAGCGTTAGG-1          Fibroblasts
                                           ...        
Sample1157EO2_TTTGGAGCATCGTGGC-1      Epithelial_cells
Sample1157EO2_TTTGGTTCAATGCAGG-1     Tissue_stem_cells
Sample1157EO2_TTTGGTTGTTTAGAGA-1               Neurons
Sample1157EO2_TTTGTTGAGGATATGT-1           Hepatocytes
Sample1157EO2_TTTGTTGAGTCCCTAA-1               Neurons
Name: singler_annotation, Length: 39505, dtype: string
cell type annotation :  S2008000628HRT_AAACCCAAGACGCTCC-1                   DC
S2008000628HRT_AAACCCAAGTAGCCAG-1              T_cells
S2008000628HRT_AAACCCAGTCCAGAAG-1              T_cells
S2008000628HRT_AAACCCAGTGTATCCA-1               B_cell
S2008000628HRT_AAACGAAAGCGTTAGG-1          Fibroblasts
                                           ...        
Sample1157EO2_TTTGGAGCATCGTGGC-1      Epithelial_cells
Sample1157EO2_TTTGGTTCAATGCAGG-1     Tissue_stem_cells
Sample1157EO2_TTTGGTTGTTTAGAGA-1               Neurons
Sample1157EO2_TTTGTTGAGGATATGT-1           Hepatocytes
Sample1157EO2_TTTGTTGAGTCCCTAA-1               Neurons
Name: singler_annotation, Length: 39505, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['DC', 'T_cells', 'B_cell', 'Fibroblasts', 'Macrophage', 'Monocyte', 'HSC_-G-CSF', 'Pre-B_cell_CD34-', 'Neutrophils', 'GMP', 'Smooth_muscle_cells', 'MSC', 'NK_cell', 'Epithelial_cells', 'iPS_cells', 'HSC_CD34+', 'Chondrocytes', 'Platelets', 'Pro-B_cell_CD34+', 'Myelocyte', 'Osteoblasts', 'BM', 'Pro-Myelocyte', 'Endothelial_cells', 'Tissue_stem_cells', 'CMP', 'Astrocyte', 'Embryonic_stem_cells', 'Hepatocytes', 'Neurons', 'Neuroepithelial_cell', 'Keratinocytes', 'MEP', 'Unknown', 'Erythroblast', 'BM & Prog.', 'Gametocytes']
라벨별 그룹 개수 {0: 5, 1: 7, 2: 3}
🔍 Split #4
  → train_p_index 환자 수 (환자 단위로 묶인 index list): 62
  → test_p_index 환자 수  (환자 단위로 묶인 index list): 15
  → train 환자 ID: ['163-3', '163-4', '163-5', '164-10', '164-3', '164-6', '165-9', '27-10039', '27-10041', '27-10112', '27-10119', '28-10051', '28-11515', '28-12263', '28-12381', '28-12490', '28-12518', '29-10006', '29-10011', '29-10012', '29-10013', '29-10280', '29-10380', '29-10386', '29-10398', '29-10400', '29-10406', '29-10410', '30-10018', '30-10034', '30-10123', '30-10125', '30-10929', '31-10000', '31-10001', '31-10013', '31-10035', '31-10040', '31-10042', '31-10078', '31-10154', '31-10236', '32-10003', '32-10074', '33-10005', '33-10006', '34-10050', '34-10184', 'PRE027', 'PRE038', 'PRE055-1', 'PRE98sc', 'Sample1153-EO1', 'Sample1153-EO2', 'Sample1153-EO3', 'Sample1157-EO1', 'Sample1157-EO3', 'Sample1158-EO1', 'Sample1158-EO2', 'Sample1158-EO3', 'Sample1162-EO1', 'Sample1162-EO2']
  → test  환자 ID: ['163-2', '27-10053', '27-10071', '29-10008', '29-10010', '29-10016', '29-10404', '30-11051', '31-10210', '32-10034', '34-10187', 'PRE018-1', 'PRE019', 'PRE062-1', 'Sample1157-EO2']
  → train 환자 ID 및 라벨:
    ID: 163-3, Label: 0
    ID: 163-4, Label: 0
    ID: 163-5, Label: 0
    ID: 164-10, Label: 0
    ID: 164-3, Label: 0
    ID: 164-6, Label: 0
    ID: 165-9, Label: 0
    ID: 27-10039, Label: 1
    ID: 27-10041, Label: 1
    ID: 27-10112, Label: 1
    ID: 27-10119, Label: 1
    ID: 28-10051, Label: 1
    ID: 28-11515, Label: 1
    ID: 28-12263, Label: 1
    ID: 28-12381, Label: 1
    ID: 28-12490, Label: 1
    ID: 28-12518, Label: 1
    ID: 29-10006, Label: 1
    ID: 29-10011, Label: 1
    ID: 29-10012, Label: 1
    ID: 29-10013, Label: 1
    ID: 29-10280, Label: 1
    ID: 29-10380, Label: 1
    ID: 29-10386, Label: 1
    ID: 29-10398, Label: 1
    ID: 29-10400, Label: 1
    ID: 29-10406, Label: 1
    ID: 29-10410, Label: 1
    ID: 30-10018, Label: 2
    ID: 30-10034, Label: 2
    ID: 30-10123, Label: 2
    ID: 30-10125, Label: 2
    ID: 30-10929, Label: 2
    ID: 31-10000, Label: 1
    ID: 31-10001, Label: 1
    ID: 31-10013, Label: 1
    ID: 31-10035, Label: 1
    ID: 31-10040, Label: 1
    ID: 31-10042, Label: 1
    ID: 31-10078, Label: 1
    ID: 31-10154, Label: 1
    ID: 31-10236, Label: 1
    ID: 32-10003, Label: 2
    ID: 32-10074, Label: 2
    ID: 33-10005, Label: 2
    ID: 33-10006, Label: 2
    ID: 34-10050, Label: 2
    ID: 34-10184, Label: 2
    ID: PRE027, Label: 0
    ID: PRE038, Label: 0
    ID: PRE055-1, Label: 0
    ID: PRE98sc, Label: 0
    ID: Sample1153-EO1, Label: 0
    ID: Sample1153-EO2, Label: 0
    ID: Sample1153-EO3, Label: 0
    ID: Sample1157-EO1, Label: 0
    ID: Sample1157-EO3, Label: 0
    ID: Sample1158-EO1, Label: 0
    ID: Sample1158-EO2, Label: 0
    ID: Sample1158-EO3, Label: 0
    ID: Sample1162-EO1, Label: 0
    ID: Sample1162-EO2, Label: 0
  → test 환자 ID 및 라벨:
    ID: 163-2, Label: 0
    ID: 27-10053, Label: 1
    ID: 27-10071, Label: 1
    ID: 29-10008, Label: 1
    ID: 29-10010, Label: 1
    ID: 29-10016, Label: 1
    ID: 29-10404, Label: 1
    ID: 30-11051, Label: 2
    ID: 31-10210, Label: 1
    ID: 32-10034, Label: 2
    ID: 34-10187, Label: 2
    ID: PRE018-1, Label: 0
    ID: PRE019, Label: 0
    ID: PRE062-1, Label: 0
    ID: Sample1157-EO2, Label: 0
전체 데이터 index 길이 77
label_stat (train 환자 라벨 목록) 갯수 62
train_data에서 환자 단위로, train과 validation 나누기
기존 train_p_index 62
기존 (train) label_stat 62
train-vali 분할 후! 
train y 의 classes : {0, 1, 2} valid y 의 classes : {0, 1, 2} label_stat 의 classes : {0, 1, 2}
train_p_index_ 41
valid_p_index 21
test_p_index 15
→ train 환자 ID 및 라벨:
   총 개수: 41
   환자ID=29-10280, Label=1, 셀개수=2375
   환자ID=31-10042, Label=1, 셀개수=1222
   환자ID=34-10050, Label=2, 셀개수=4784
   환자ID=31-10236, Label=1, 셀개수=3458
   환자ID=Sample1158-EO2, Label=0, 셀개수=1427
   환자ID=164-10, Label=0, 셀개수=4041
   환자ID=29-10006, Label=1, 셀개수=11461
   환자ID=PRE055-1, Label=0, 셀개수=597
   환자ID=31-10000, Label=1, 셀개수=8870
   환자ID=30-10125, Label=2, 셀개수=3798
   환자ID=163-4, Label=0, 셀개수=1339
   환자ID=28-10051, Label=1, 셀개수=300
   환자ID=165-9, Label=0, 셀개수=2926
   환자ID=27-10039, Label=1, 셀개수=4638
   환자ID=163-3, Label=0, 셀개수=1335
   환자ID=30-10018, Label=2, 셀개수=5170
   환자ID=31-10013, Label=1, 셀개수=3161
   환자ID=30-10123, Label=2, 셀개수=1273
   환자ID=Sample1158-EO3, Label=0, 셀개수=1096
   환자ID=29-10386, Label=1, 셀개수=802
   환자ID=31-10001, Label=1, 셀개수=1133
   환자ID=163-5, Label=0, 셀개수=1210
   환자ID=31-10154, Label=1, 셀개수=6568
   환자ID=Sample1153-EO1, Label=0, 셀개수=911
   환자ID=29-10406, Label=1, 셀개수=3484
   환자ID=28-12263, Label=1, 셀개수=7527
   환자ID=Sample1162-EO1, Label=0, 셀개수=1053
   환자ID=31-10035, Label=1, 셀개수=2974
   환자ID=34-10184, Label=2, 셀개수=2699
   환자ID=27-10119, Label=1, 셀개수=3346
   환자ID=28-12518, Label=1, 셀개수=1215
   환자ID=28-11515, Label=1, 셀개수=930
   환자ID=164-6, Label=0, 셀개수=3038
   환자ID=29-10400, Label=1, 셀개수=2684
   환자ID=33-10006, Label=2, 셀개수=457
   환자ID=29-10380, Label=1, 셀개수=4799
   환자ID=32-10074, Label=2, 셀개수=6304
   환자ID=32-10003, Label=2, 셀개수=2978
   환자ID=31-10078, Label=1, 셀개수=2827
   환자ID=29-10013, Label=1, 셀개수=3706
   환자ID=28-12490, Label=1, 셀개수=5973
→ valid 환자 ID 및 라벨:
   총 개수: 21
   환자ID=Sample1162-EO2, Label=0, 셀개수=1510
   환자ID=29-10012, Label=1, 셀개수=6245
   환자ID=31-10040, Label=1, 셀개수=4543
   환자ID=Sample1153-EO2, Label=0, 셀개수=916
   환자ID=33-10005, Label=2, 셀개수=8904
   환자ID=PRE98sc, Label=0, 셀개수=1568
   환자ID=Sample1157-EO3, Label=0, 셀개수=807
   환자ID=30-10034, Label=2, 셀개수=1240
   환자ID=30-10929, Label=2, 셀개수=5812
   환자ID=29-10410, Label=1, 셀개수=2834
   환자ID=Sample1158-EO1, Label=0, 셀개수=574
   환자ID=27-10112, Label=1, 셀개수=1470
   환자ID=29-10398, Label=1, 셀개수=3993
   환자ID=Sample1153-EO3, Label=0, 셀개수=1516
   환자ID=PRE038, Label=0, 셀개수=2666
   환자ID=PRE027, Label=0, 셀개수=2078
   환자ID=164-3, Label=0, 셀개수=1639
   환자ID=29-10011, Label=1, 셀개수=3072
   환자ID=27-10041, Label=1, 셀개수=2145
   환자ID=28-12381, Label=1, 셀개수=1099
   환자ID=Sample1157-EO1, Label=0, 셀개수=1152
→ test 환자 ID 및 라벨:
   총 개수: 15
   환자ID=163-2, Label=0, 셀개수=2535
   환자ID=27-10053, Label=1, 셀개수=728
   환자ID=27-10071, Label=1, 셀개수=1478
   환자ID=29-10008, Label=1, 셀개수=1913
   환자ID=29-10010, Label=1, 셀개수=5305
   환자ID=29-10016, Label=1, 셀개수=4854
   환자ID=29-10404, Label=1, 셀개수=3988
   환자ID=30-11051, Label=2, 셀개수=2454
   환자ID=31-10210, Label=1, 셀개수=3510
   환자ID=32-10034, Label=2, 셀개수=1555
   환자ID=34-10187, Label=2, 셀개수=3739
   환자ID=PRE018-1, Label=0, 셀개수=1349
   환자ID=PRE019, Label=0, 셀개수=3795
   환자ID=PRE062-1, Label=0, 셀개수=907
   환자ID=Sample1157-EO2, Label=0, 셀개수=1395
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Epithelial_cells', 'Epithelial_cells', 'Astrocyte', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'MSC', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
전체 데이터 길이 225177
전체 cell type 길이 0          Epithelial_cells
1          Epithelial_cells
2                 Astrocyte
3          Epithelial_cells
4          Epithelial_cells
                ...        
225172     Epithelial_cells
225173    Tissue_stem_cells
225174              Neurons
225175          Hepatocytes
225176              Neurons
Length: 225177, dtype: string
cell type의 NaN 개수 체크 0
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:10,  9.38it/s]  2%|▏         | 2/100 [00:00<00:10,  9.61it/s]  3%|▎         | 3/100 [00:00<00:09,  9.72it/s]  4%|▍         | 4/100 [00:00<00:10,  9.57it/s]  5%|▌         | 5/100 [00:00<00:10,  9.49it/s]  6%|▌         | 6/100 [00:00<00:09,  9.45it/s]  7%|▋         | 7/100 [00:00<00:09,  9.40it/s]  8%|▊         | 8/100 [00:00<00:09,  9.37it/s]  9%|▉         | 9/100 [00:00<00:09,  9.21it/s] 10%|█         | 10/100 [00:01<00:09,  9.04it/s] 11%|█         | 11/100 [00:01<00:09,  9.22it/s] 12%|█▏        | 12/100 [00:01<00:09,  9.25it/s] 13%|█▎        | 13/100 [00:01<00:09,  9.32it/s] 14%|█▍        | 14/100 [00:01<00:10,  7.84it/s] 15%|█▌        | 15/100 [00:01<00:11,  7.64it/s] 16%|█▌        | 16/100 [00:01<00:10,  7.76it/s] 17%|█▋        | 17/100 [00:01<00:10,  8.00it/s] 18%|█▊        | 18/100 [00:02<00:10,  8.16it/s] 19%|█▉        | 19/100 [00:02<00:09,  8.43it/s] 20%|██        | 20/100 [00:02<00:09,  8.82it/s] 22%|██▏       | 22/100 [00:02<00:08,  9.22it/s] 23%|██▎       | 23/100 [00:02<00:08,  9.28it/s] 24%|██▍       | 24/100 [00:02<00:08,  9.29it/s] 25%|██▌       | 25/100 [00:02<00:08,  9.24it/s] 26%|██▌       | 26/100 [00:02<00:07,  9.37it/s] 27%|██▋       | 27/100 [00:03<00:07,  9.18it/s] 28%|██▊       | 28/100 [00:03<00:07,  9.02it/s] 29%|██▉       | 29/100 [00:03<00:07,  9.24it/s] 30%|███       | 30/100 [00:03<00:07,  9.15it/s] 31%|███       | 31/100 [00:03<00:07,  9.02it/s] 32%|███▏      | 32/100 [00:03<00:10,  6.57it/s] 33%|███▎      | 33/100 [00:03<00:09,  7.12it/s] 34%|███▍      | 34/100 [00:03<00:08,  7.49it/s] 35%|███▌      | 35/100 [00:04<00:08,  7.87it/s] 36%|███▌      | 36/100 [00:04<00:07,  8.04it/s] 37%|███▋      | 37/100 [00:04<00:07,  8.24it/s] 38%|███▊      | 38/100 [00:04<00:07,  8.46it/s] 39%|███▉      | 39/100 [00:04<00:07,  8.58it/s] 40%|████      | 40/100 [00:04<00:06,  8.61it/s] 41%|████      | 41/100 [00:04<00:06,  8.64it/s] 42%|████▏     | 42/100 [00:04<00:06,  8.90it/s] 43%|████▎     | 43/100 [00:04<00:06,  8.69it/s] 44%|████▍     | 44/100 [00:05<00:06,  8.40it/s] 45%|████▌     | 45/100 [00:05<00:06,  8.38it/s] 46%|████▌     | 46/100 [00:05<00:06,  8.54it/s] 47%|████▋     | 47/100 [00:05<00:06,  8.68it/s] 48%|████▊     | 48/100 [00:05<00:06,  8.58it/s] 49%|████▉     | 49/100 [00:05<00:06,  8.34it/s] 50%|█████     | 50/100 [00:05<00:05,  8.44it/s] 51%|█████     | 51/100 [00:05<00:06,  8.13it/s] 52%|█████▏    | 52/100 [00:06<00:05,  8.29it/s] 53%|█████▎    | 53/100 [00:06<00:05,  8.38it/s] 54%|█████▍    | 54/100 [00:06<00:05,  8.52it/s] 55%|█████▌    | 55/100 [00:06<00:05,  8.62it/s] 56%|█████▌    | 56/100 [00:06<00:05,  8.64it/s] 57%|█████▋    | 57/100 [00:06<00:04,  8.60it/s] 58%|█████▊    | 58/100 [00:06<00:04,  8.60it/s] 59%|█████▉    | 59/100 [00:06<00:04,  8.64it/s] 60%|██████    | 60/100 [00:06<00:04,  8.57it/s] 61%|██████    | 61/100 [00:07<00:04,  8.43it/s] 62%|██████▏   | 62/100 [00:07<00:04,  8.37it/s] 63%|██████▎   | 63/100 [00:07<00:04,  8.35it/s] 64%|██████▍   | 64/100 [00:07<00:04,  8.14it/s] 65%|██████▌   | 65/100 [00:07<00:04,  8.07it/s] 66%|██████▌   | 66/100 [00:07<00:04,  7.24it/s] 67%|██████▋   | 67/100 [00:07<00:04,  7.48it/s] 68%|██████▊   | 68/100 [00:08<00:04,  7.72it/s] 69%|██████▉   | 69/100 [00:08<00:03,  8.00it/s] 70%|███████   | 70/100 [00:08<00:03,  7.90it/s] 71%|███████   | 71/100 [00:08<00:03,  7.96it/s] 72%|███████▏  | 72/100 [00:08<00:03,  8.20it/s] 73%|███████▎  | 73/100 [00:08<00:03,  8.29it/s] 74%|███████▍  | 74/100 [00:08<00:03,  8.18it/s] 75%|███████▌  | 75/100 [00:08<00:03,  6.55it/s] 76%|███████▌  | 76/100 [00:09<00:03,  6.98it/s] 77%|███████▋  | 77/100 [00:09<00:03,  7.37it/s] 78%|███████▊  | 78/100 [00:09<00:03,  5.73it/s] 79%|███████▉  | 79/100 [00:09<00:03,  6.16it/s] 80%|████████  | 80/100 [00:09<00:02,  6.70it/s] 81%|████████  | 81/100 [00:09<00:02,  7.04it/s] 82%|████████▏ | 82/100 [00:09<00:02,  7.38it/s] 83%|████████▎ | 83/100 [00:10<00:02,  7.56it/s] 84%|████████▍ | 84/100 [00:10<00:02,  7.96it/s] 85%|████████▌ | 85/100 [00:10<00:01,  8.04it/s] 86%|████████▌ | 86/100 [00:10<00:01,  7.85it/s] 87%|████████▋ | 87/100 [00:10<00:01,  8.02it/s] 88%|████████▊ | 88/100 [00:10<00:01,  7.05it/s] 89%|████████▉ | 89/100 [00:10<00:01,  7.28it/s] 90%|█████████ | 90/100 [00:11<00:01,  7.46it/s] 91%|█████████ | 91/100 [00:11<00:01,  7.41it/s] 92%|█████████▏| 92/100 [00:11<00:01,  7.48it/s] 93%|█████████▎| 93/100 [00:11<00:00,  7.71it/s] 94%|█████████▍| 94/100 [00:11<00:00,  7.73it/s] 95%|█████████▌| 95/100 [00:11<00:00,  7.74it/s] 96%|█████████▌| 96/100 [00:11<00:00,  7.64it/s] 97%|█████████▋| 97/100 [00:11<00:00,  7.77it/s] 98%|█████████▊| 98/100 [00:12<00:00,  7.79it/s] 99%|█████████▉| 99/100 [00:12<00:00,  7.71it/s]100%|██████████| 100/100 [00:12<00:00,  7.70it/s]100%|██████████| 100/100 [00:12<00:00,  8.13it/s]
[I 2025-08-31 13:30:06,599] A new study created in memory with name: no-name-e36cdceb-4559-4a6b-82eb-0090ba9c6821
👉 train samples(학습 샘플(bag))=141, batch_size=8 -> steps(샘플수/batch크기)=18
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 27.97 MB
Memory Reserved: 36.00 MB
cuda
Epoch 1, Train Loss 1.001262, Valid_loss 0.963438
Epoch 2, Train Loss 0.884444, Valid_loss 0.906900
Epoch 3, Train Loss 0.846440, Valid_loss 0.826343
Epoch 4, Train Loss 0.760779, Valid_loss 0.699639
Epoch 5, Train Loss 0.707273, Valid_loss 0.606475
Epoch 6, Train Loss 0.654330, Valid_loss 0.568707
Epoch 7, Train Loss 0.574713, Valid_loss 0.517759
Epoch 8, Train Loss 0.556045, Valid_loss 0.559652
Epoch 9, Train Loss 0.595418, Valid_loss 0.542936
Epoch 10, Train Loss 0.504712, Valid_loss 0.507202
Epoch 11, Train Loss 0.545793, Valid_loss 0.575486
Epoch 12, Train Loss 0.484461, Valid_loss 0.486786
Epoch 13, Train Loss 0.457178, Valid_loss 0.487467
Epoch 14, Train Loss 0.404795, Valid_loss 0.585595
Epoch 15, Train Loss 0.417941, Valid_loss 0.479862
Epoch 16, Train Loss 0.376984, Valid_loss 0.530956
Epoch 17, Train Loss 0.475254, Valid_loss 0.552803
Epoch 18, Train Loss 0.424308, Valid_loss 0.445371
Epoch 19, Train Loss 0.342619, Valid_loss 0.441767
Epoch 20, Train Loss 0.409070, Valid_loss 0.423541
Epoch 21, Train Loss 0.496874, Valid_loss 0.449873
Epoch 22, Train Loss 0.417001, Valid_loss 0.452416
Epoch 23, Train Loss 0.368516, Valid_loss 0.488766
Epoch 24, Train Loss 0.317084, Valid_loss 0.558182
Epoch 25, Train Loss 0.342218, Valid_loss 0.466166
Epoch 26, Train Loss 0.312698, Valid_loss 0.683573
Epoch 27, Train Loss 0.383861, Valid_loss 0.435559
Epoch 28, Train Loss 0.331803, Valid_loss 0.483329
Epoch 29, Train Loss 0.270134, Valid_loss 0.438650
Epoch 30, Train Loss 0.264963, Valid_loss 0.480718
Epoch 31, Train Loss 0.234819, Valid_loss 0.520807
Epoch 32, Train Loss 0.240342, Valid_loss 0.421983
Epoch 33, Train Loss 0.283975, Valid_loss 0.415248
Epoch 34, Train Loss 0.273153, Valid_loss 0.458634
Epoch 35, Train Loss 0.270573, Valid_loss 0.421056
Epoch 36, Train Loss 0.310512, Valid_loss 0.395835
Epoch 37, Train Loss 0.249882, Valid_loss 0.551240
Epoch 38, Train Loss 0.236603, Valid_loss 0.520982
Epoch 39, Train Loss 0.237556, Valid_loss 0.520865
Epoch 40, Train Loss 0.224785, Valid_loss 0.495171
Epoch 41, Train Loss 0.188665, Valid_loss 0.470723
Epoch 42, Train Loss 0.215210, Valid_loss 0.530629
Epoch 43, Train Loss 0.221713, Valid_loss 0.444295
Epoch 44, Train Loss 0.191384, Valid_loss 0.491266
Epoch 45, Train Loss 0.206545, Valid_loss 0.449331
Epoch 46, Train Loss 0.221857, Valid_loss 0.449080
Epoch 47, Train Loss 0.261731, Valid_loss 0.478300
Epoch 48, Train Loss 0.210805, Valid_loss 0.532775
Epoch 49, Train Loss 0.177368, Valid_loss 0.483696
Epoch 50, Train Loss 0.182841, Valid_loss 0.508818
Epoch 51, Train Loss 0.193050, Valid_loss 0.529571
Epoch 52, Train Loss 0.183942, Valid_loss 0.474610
Epoch 53, Train Loss 0.152081, Valid_loss 0.528481
Epoch 54, Train Loss 0.148134, Valid_loss 0.512244
Epoch 55, Train Loss 0.162432, Valid_loss 0.498152
Epoch 56, Train Loss 0.177053, Valid_loss 0.455532
Epoch 57, Train Loss 0.181054, Valid_loss 0.500972
Epoch 58, Train Loss 0.186394, Valid_loss 0.545479
[I 2025-08-31 13:38:06,550] Trial 0 finished with value: 0.39583532689582734 and parameters: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 1, 'dropout': 0.5, 'weight_decay': 0.001, 'emb_dim': 64, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.39583532689582734.
👉 train samples(학습 샘플(bag))=141, batch_size=8 -> steps(샘플수/batch크기)=18
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 26.13 MB
Memory Reserved: 36.00 MB
cuda
CUDA OOM 발생 — 단계적 백오프 시작.
[OOM RETRY] batch_size 8 → 8 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=141, batch_size=8 -> steps(샘플수/batch크기)=18
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 1077.98 MB
Memory Reserved: 1088.00 MB
cuda
[OOM RETRY] batch_size=8에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 8 → 4 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=141, batch_size=4 -> steps(샘플수/batch크기)=36
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 2129.83 MB
Memory Reserved: 2140.00 MB
cuda
Epoch 1, Train Loss 0.970738, Valid_loss 1.026064
Epoch 2, Train Loss 0.870498, Valid_loss 0.930665
Epoch 3, Train Loss 0.803450, Valid_loss 0.787585
Epoch 4, Train Loss 0.727916, Valid_loss 0.707653
Epoch 5, Train Loss 0.672555, Valid_loss 0.782486
Epoch 6, Train Loss 0.618194, Valid_loss 0.645386
Epoch 7, Train Loss 0.624679, Valid_loss 0.612375
Epoch 8, Train Loss 0.574026, Valid_loss 0.595682
Epoch 9, Train Loss 0.614669, Valid_loss 0.572415
Epoch 10, Train Loss 0.517751, Valid_loss 0.606573
Epoch 11, Train Loss 0.495817, Valid_loss 0.583505
Epoch 12, Train Loss 0.481848, Valid_loss 0.554184
Epoch 13, Train Loss 0.494027, Valid_loss 0.645702
Epoch 14, Train Loss 0.420434, Valid_loss 0.645075
Epoch 15, Train Loss 0.418071, Valid_loss 0.519977
Epoch 16, Train Loss 0.422167, Valid_loss 0.529348
Epoch 17, Train Loss 0.425664, Valid_loss 0.603314
Epoch 18, Train Loss 0.393542, Valid_loss 0.488430
Epoch 19, Train Loss 0.391511, Valid_loss 0.501485
Epoch 20, Train Loss 0.396285, Valid_loss 0.508457
Epoch 21, Train Loss 0.322917, Valid_loss 0.562181
Epoch 22, Train Loss 0.391803, Valid_loss 0.527878
Epoch 23, Train Loss 0.316981, Valid_loss 0.565305
Epoch 24, Train Loss 0.331204, Valid_loss 0.493075
Epoch 25, Train Loss 0.349843, Valid_loss 0.489972
Epoch 26, Train Loss 0.295685, Valid_loss 0.483294
Epoch 27, Train Loss 0.271338, Valid_loss 0.484043
Epoch 28, Train Loss 0.286872, Valid_loss 0.486732
Epoch 29, Train Loss 0.256132, Valid_loss 0.516321
Epoch 30, Train Loss 0.296854, Valid_loss 0.478308
Epoch 31, Train Loss 0.307257, Valid_loss 0.485621
Epoch 32, Train Loss 0.354913, Valid_loss 0.425738
Epoch 33, Train Loss 0.273022, Valid_loss 0.516154
Epoch 34, Train Loss 0.259127, Valid_loss 0.535658
Epoch 35, Train Loss 0.213833, Valid_loss 0.522023
Epoch 36, Train Loss 0.229749, Valid_loss 0.462515
Epoch 37, Train Loss 0.203264, Valid_loss 0.465370
Epoch 38, Train Loss 0.221769, Valid_loss 0.523324
Epoch 39, Train Loss 0.221022, Valid_loss 0.517760
Epoch 40, Train Loss 0.203725, Valid_loss 0.500446
Epoch 41, Train Loss 0.396486, Valid_loss 0.717467
Epoch 42, Train Loss 0.338210, Valid_loss 0.550111
Epoch 43, Train Loss 0.296494, Valid_loss 0.459292
Epoch 44, Train Loss 0.235211, Valid_loss 0.540411
Epoch 45, Train Loss 0.206058, Valid_loss 0.490502
Epoch 46, Train Loss 0.183487, Valid_loss 0.496952
Epoch 47, Train Loss 0.208881, Valid_loss 0.525000
Epoch 48, Train Loss 0.183387, Valid_loss 0.532901
Epoch 49, Train Loss 0.200584, Valid_loss 0.483364
Epoch 50, Train Loss 0.172972, Valid_loss 0.442323
Epoch 51, Train Loss 0.209379, Valid_loss 0.462258
Epoch 52, Train Loss 0.203720, Valid_loss 0.484474
[I 2025-08-31 13:49:05,155] Trial 1 finished with value: 0.42573789826461245 and parameters: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 4, 'dropout': 0.3, 'weight_decay': 0.0001, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.39583532689582734.
👉 train samples(학습 샘플(bag))=141, batch_size=8 -> steps(샘플수/batch크기)=18
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 1076.66 MB
Memory Reserved: 1088.00 MB
cuda
Epoch 1, Train Loss 1.084615, Valid_loss 1.001290
Epoch 2, Train Loss 1.027485, Valid_loss 1.016562
Epoch 3, Train Loss 1.034752, Valid_loss 1.013778
Epoch 4, Train Loss 1.013106, Valid_loss 1.007166
Epoch 5, Train Loss 0.996563, Valid_loss 0.997324
Epoch 6, Train Loss 0.970418, Valid_loss 0.999719
Epoch 7, Train Loss 0.943564, Valid_loss 1.001296
Epoch 8, Train Loss 0.961281, Valid_loss 1.000848
Epoch 9, Train Loss 0.966104, Valid_loss 0.994926
Epoch 10, Train Loss 0.944785, Valid_loss 0.995743
Epoch 11, Train Loss 0.926967, Valid_loss 1.005883
Epoch 12, Train Loss 0.957229, Valid_loss 0.999003
Epoch 13, Train Loss 0.925839, Valid_loss 0.985055
Epoch 14, Train Loss 0.949079, Valid_loss 0.979294
Epoch 15, Train Loss 0.932294, Valid_loss 0.978235
Epoch 16, Train Loss 0.954755, Valid_loss 0.973489
Epoch 17, Train Loss 0.912247, Valid_loss 0.973319
Epoch 18, Train Loss 0.911004, Valid_loss 0.966069
Epoch 19, Train Loss 0.888903, Valid_loss 0.969487
Epoch 20, Train Loss 0.919809, Valid_loss 0.978435
Epoch 21, Train Loss 0.939158, Valid_loss 0.953098
Epoch 22, Train Loss 0.908557, Valid_loss 0.963693
Epoch 23, Train Loss 0.919390, Valid_loss 0.959034
Epoch 24, Train Loss 0.893576, Valid_loss 0.969311
Epoch 25, Train Loss 0.873596, Valid_loss 0.962814
Epoch 26, Train Loss 0.866739, Valid_loss 0.953414
Epoch 27, Train Loss 0.870655, Valid_loss 0.948921
Epoch 28, Train Loss 0.890552, Valid_loss 0.945931
Epoch 29, Train Loss 0.848428, Valid_loss 0.942447
Epoch 30, Train Loss 0.821401, Valid_loss 0.907944
Epoch 31, Train Loss 0.830118, Valid_loss 0.937290
Epoch 32, Train Loss 0.809142, Valid_loss 0.908054
Epoch 33, Train Loss 0.850696, Valid_loss 0.918023
Epoch 34, Train Loss 0.813497, Valid_loss 0.888606
Epoch 35, Train Loss 0.811161, Valid_loss 0.893288
Epoch 36, Train Loss 0.836181, Valid_loss 0.880463
Epoch 37, Train Loss 0.797222, Valid_loss 0.868498
Epoch 38, Train Loss 0.810969, Valid_loss 0.869740
Epoch 39, Train Loss 0.826754, Valid_loss 0.865562
Epoch 40, Train Loss 0.767010, Valid_loss 0.838294
Epoch 41, Train Loss 0.791886, Valid_loss 0.833403
Epoch 42, Train Loss 0.811828, Valid_loss 0.843659
Epoch 43, Train Loss 0.811054, Valid_loss 0.823534
Epoch 44, Train Loss 0.826553, Valid_loss 0.839494
Epoch 45, Train Loss 0.795220, Valid_loss 0.822658
Epoch 46, Train Loss 0.783488, Valid_loss 0.820371
Epoch 47, Train Loss 0.770659, Valid_loss 0.803500
Epoch 48, Train Loss 0.806755, Valid_loss 0.816314
Epoch 49, Train Loss 0.740472, Valid_loss 0.829079
Epoch 50, Train Loss 0.761074, Valid_loss 0.823089
Epoch 51, Train Loss 0.744882, Valid_loss 0.784456
Epoch 52, Train Loss 0.724336, Valid_loss 0.762018
Epoch 53, Train Loss 0.744571, Valid_loss 0.791744
Epoch 54, Train Loss 0.740679, Valid_loss 0.783763
Epoch 55, Train Loss 0.748854, Valid_loss 0.775870
Epoch 56, Train Loss 0.733656, Valid_loss 0.774857
Epoch 57, Train Loss 0.721763, Valid_loss 0.769304
Epoch 58, Train Loss 0.698258, Valid_loss 0.758343
Epoch 59, Train Loss 0.690878, Valid_loss 0.742911
Epoch 60, Train Loss 0.722395, Valid_loss 0.757318
Epoch 61, Train Loss 0.769405, Valid_loss 0.760752
[I 2025-08-31 13:59:28,265] Trial 2 finished with value: 0.7429113544168926 and parameters: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 2, 'dropout': 0.5, 'weight_decay': 0.01, 'emb_dim': 8, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.39583532689582734.
선택된 trial params: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 1, 'dropout': 0.5, 'weight_decay': 0.001, 'emb_dim': 64, 'augment_num': 100, 'pca': False}
👉 train samples(학습 샘플(bag))=141, batch_size=8 -> steps(샘플수/batch크기)=18
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=15, batch_size=1 -> steps=15
Memory Allocated: 1079.82 MB
Memory Reserved: 1088.00 MB
cuda
Epoch 1, Train Loss 1.007073, Valid_loss 0.969792
Epoch 2, Train Loss 0.922574, Valid_loss 0.946722
Epoch 3, Train Loss 0.847364, Valid_loss 0.888820
Epoch 4, Train Loss 0.831088, Valid_loss 0.867124
Epoch 5, Train Loss 0.791655, Valid_loss 0.783870
Epoch 6, Train Loss 0.701113, Valid_loss 0.664026
Epoch 7, Train Loss 0.619280, Valid_loss 0.591685
Epoch 8, Train Loss 0.549549, Valid_loss 0.518880
Epoch 9, Train Loss 0.561620, Valid_loss 0.521217
Epoch 10, Train Loss 0.554242, Valid_loss 0.520583
Epoch 11, Train Loss 0.499851, Valid_loss 0.532156
Epoch 12, Train Loss 0.428057, Valid_loss 0.518555
Epoch 13, Train Loss 0.439173, Valid_loss 0.539589
Epoch 14, Train Loss 0.396324, Valid_loss 0.472117
Epoch 15, Train Loss 0.407713, Valid_loss 0.582442
Epoch 16, Train Loss 0.368918, Valid_loss 0.455037
Epoch 17, Train Loss 0.391273, Valid_loss 0.481229
Epoch 18, Train Loss 0.367096, Valid_loss 0.546244
Epoch 19, Train Loss 0.305144, Valid_loss 0.464368
Epoch 20, Train Loss 0.380288, Valid_loss 0.516497
Epoch 21, Train Loss 0.326831, Valid_loss 0.588084
Epoch 22, Train Loss 0.289616, Valid_loss 0.449798
Epoch 23, Train Loss 0.268732, Valid_loss 0.439433
Epoch 24, Train Loss 0.325504, Valid_loss 0.478953
Epoch 25, Train Loss 0.309046, Valid_loss 0.623001
Epoch 26, Train Loss 0.292164, Valid_loss 0.538014
Epoch 27, Train Loss 0.264178, Valid_loss 0.541343
Epoch 28, Train Loss 0.322725, Valid_loss 0.613164
Epoch 29, Train Loss 0.265381, Valid_loss 0.476093
Epoch 30, Train Loss 0.217138, Valid_loss 0.530311
Epoch 31, Train Loss 0.216875, Valid_loss 0.442616
Epoch 32, Train Loss 0.235068, Valid_loss 0.571164
Epoch 33, Train Loss 0.326309, Valid_loss 0.540446
Epoch 34, Train Loss 0.234859, Valid_loss 0.630932
Epoch 35, Train Loss 0.270630, Valid_loss 0.462936
Epoch 36, Train Loss 0.218301, Valid_loss 0.482297
Epoch 37, Train Loss 0.212488, Valid_loss 0.454028
Epoch 38, Train Loss 0.197989, Valid_loss 0.489252
Epoch 39, Train Loss 0.190066, Valid_loss 0.519840
Epoch 40, Train Loss 0.196874, Valid_loss 0.570625
Epoch 41, Train Loss 0.216021, Valid_loss 0.550854
Epoch 42, Train Loss 0.274169, Valid_loss 0.477505
Epoch 43, Train Loss 0.244165, Valid_loss 0.633276
Epoch 44, Train Loss 0.239749, Valid_loss 0.500814
Epoch 45, Train Loss 0.193731, Valid_loss 0.511729
Epoch 46, Train Loss 0.167993, Valid_loss 0.502930
Epoch 47, Train Loss 0.183987, Valid_loss 0.607449
Epoch 48, Train Loss 0.166180, Valid_loss 0.513581
Epoch 49, Train Loss 0.171372, Valid_loss 0.461125
Epoch 50, Train Loss 0.164307, Valid_loss 0.505956
Epoch 51, Train Loss 0.162794, Valid_loss 0.466432
Epoch 52, Train Loss 0.198979, Valid_loss 0.589522
Epoch 53, Train Loss 0.157549, Valid_loss 0.559310
Epoch 54, Train Loss 0.166184, Valid_loss 0.511885
Epoch 55, Train Loss 0.180459, Valid_loss 0.554724
Epoch 56, Train Loss 0.155635, Valid_loss 0.548248
Epoch 57, Train Loss 0.140090, Valid_loss 0.533176
Epoch 58, Train Loss 0.132819, Valid_loss 0.581711
Epoch 59, Train Loss 0.146541, Valid_loss 0.526275
Epoch 60, Train Loss 0.135623, Valid_loss 0.513769
Epoch 61, Train Loss 0.137368, Valid_loss 0.542271
Epoch 62, Train Loss 0.140492, Valid_loss 0.544785
환자ID=163-2 -- true: [[0]] -- pred: tensor([[ 2.2317, -1.2250, -1.4297]], device='cuda:0')
환자ID=27-10053 -- true: [[1]] -- pred: tensor([[-1.1141,  1.9186, -0.8073]], device='cuda:0')
환자ID=27-10071 -- true: [[1]] -- pred: tensor([[-1.2509,  1.5503, -0.1849]], device='cuda:0')
환자ID=29-10008 -- true: [[1]] -- pred: tensor([[-0.8403,  1.7248, -1.0350]], device='cuda:0')
환자ID=29-10010 -- true: [[1]] -- pred: tensor([[ 0.0078,  1.2812, -1.6279]], device='cuda:0')
환자ID=29-10016 -- true: [[1]] -- pred: tensor([[-0.3499,  1.6022, -1.5164]], device='cuda:0')
환자ID=29-10404 -- true: [[1]] -- pred: tensor([[-1.2210,  1.6842, -0.3883]], device='cuda:0')
환자ID=30-11051 -- true: [[2]] -- pred: tensor([[-1.1467,  1.3288, -0.1502]], device='cuda:0')
환자ID=31-10210 -- true: [[1]] -- pred: tensor([[-0.9597,  1.8544, -0.9790]], device='cuda:0')
환자ID=32-10034 -- true: [[2]] -- pred: tensor([[-0.9475,  1.3157, -0.2418]], device='cuda:0')
환자ID=34-10187 -- true: [[2]] -- pred: tensor([[-1.2141,  1.8896, -0.6335]], device='cuda:0')
환자ID=PRE018-1 -- true: [[0]] -- pred: tensor([[ 2.2934, -1.1755, -1.5018]], device='cuda:0')
환자ID=PRE019 -- true: [[0]] -- pred: tensor([[ 2.2628, -1.1353, -1.4968]], device='cuda:0')
환자ID=PRE062-1 -- true: [[0]] -- pred: tensor([[ 2.2711, -1.0944, -1.5213]], device='cuda:0')
환자ID=Sample1157-EO2 -- true: [[0]] -- pred: tensor([[ 2.1614, -0.8598, -1.6172]], device='cuda:0')
Best performance: Epoch 23, Loss 0.268732, Test ACC 0.800000, Test AUC 0.928571, Test Recall 0.666667, Test Precision 0.566667
Confusion Matrix:
 [[5 0 0]
 [0 7 0]
 [0 3 0]]
✅ Total valid splits used: 4
🔁 Repeat 4, Fold 4
cell type :  S2008000628HRT_AAACCCAAGACGCTCC-1                   DC
S2008000628HRT_AAACCCAAGTAGCCAG-1              T_cells
S2008000628HRT_AAACCCAGTCCAGAAG-1              T_cells
S2008000628HRT_AAACCCAGTGTATCCA-1               B_cell
S2008000628HRT_AAACGAAAGCGTTAGG-1          Fibroblasts
                                           ...        
Sample1162EO2_TTTGGAGAGCAGGCAT-1      Epithelial_cells
Sample1162EO2_TTTGGAGAGTCGCGAA-1     Endothelial_cells
Sample1162EO2_TTTGGAGAGTGCTCGC-1           Hepatocytes
Sample1162EO2_TTTGGAGGTGATACTC-1      Epithelial_cells
Sample1162EO2_TTTGGTTCAGTAGAAT-1      Epithelial_cells
Name: singler_annotation, Length: 187660, dtype: string
cell type annotation :  S2008000628HRT_AAACCCAAGACGCTCC-1                   DC
S2008000628HRT_AAACCCAAGTAGCCAG-1              T_cells
S2008000628HRT_AAACCCAGTCCAGAAG-1              T_cells
S2008000628HRT_AAACCCAGTGTATCCA-1               B_cell
S2008000628HRT_AAACGAAAGCGTTAGG-1          Fibroblasts
                                           ...        
Sample1162EO2_TTTGGAGAGCAGGCAT-1      Epithelial_cells
Sample1162EO2_TTTGGAGAGTCGCGAA-1     Endothelial_cells
Sample1162EO2_TTTGGAGAGTGCTCGC-1           Hepatocytes
Sample1162EO2_TTTGGAGGTGATACTC-1      Epithelial_cells
Sample1162EO2_TTTGGTTCAGTAGAAT-1      Epithelial_cells
Name: singler_annotation, Length: 187660, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['DC', 'T_cells', 'B_cell', 'Fibroblasts', 'Macrophage', 'Monocyte', 'HSC_-G-CSF', 'Pre-B_cell_CD34-', 'Neutrophils', 'GMP', 'Smooth_muscle_cells', 'MSC', 'NK_cell', 'Epithelial_cells', 'iPS_cells', 'HSC_CD34+', 'Chondrocytes', 'Platelets', 'Pro-B_cell_CD34+', 'Myelocyte', 'Osteoblasts', 'BM', 'Pro-Myelocyte', 'Endothelial_cells', 'Tissue_stem_cells', 'CMP', 'Astrocyte', 'Embryonic_stem_cells', 'Hepatocytes', 'Neurons', 'Keratinocytes', 'Neuroepithelial_cell', 'MEP', 'BM & Prog.', 'Erythroblast', 'Unknown', 'Gametocytes']
라벨별 그룹 개수 {0: 21, 1: 30, 2: 11}
cell type :  S2008000605HRT_AAACCCAGTGCACATT-1    Epithelial_cells
S2008000605HRT_AAACCCAGTGCCTACG-1    Epithelial_cells
S2008000605HRT_AAAGAACGTAGAGACC-1           Astrocyte
S2008000605HRT_AAAGAACGTCGGAACA-1    Epithelial_cells
S2008000605HRT_AAAGAACGTTAACAGA-1    Epithelial_cells
                                           ...       
Sample1162EO1_TTTCACAAGGGCAGAG-1            iPS_cells
Sample1162EO1_TTTCCTCAGCGTGCCT-1          Hepatocytes
Sample1162EO1_TTTCCTCAGTACTGTC-1     Epithelial_cells
Sample1162EO1_TTTGGTTTCCACATAG-1          Hepatocytes
Sample1162EO1_TTTGTTGCACACGCCA-1     Epithelial_cells
Name: singler_annotation, Length: 37517, dtype: string
cell type annotation :  S2008000605HRT_AAACCCAGTGCACATT-1    Epithelial_cells
S2008000605HRT_AAACCCAGTGCCTACG-1    Epithelial_cells
S2008000605HRT_AAAGAACGTAGAGACC-1           Astrocyte
S2008000605HRT_AAAGAACGTCGGAACA-1    Epithelial_cells
S2008000605HRT_AAAGAACGTTAACAGA-1    Epithelial_cells
                                           ...       
Sample1162EO1_TTTCACAAGGGCAGAG-1            iPS_cells
Sample1162EO1_TTTCCTCAGCGTGCCT-1          Hepatocytes
Sample1162EO1_TTTCCTCAGTACTGTC-1     Epithelial_cells
Sample1162EO1_TTTGGTTTCCACATAG-1          Hepatocytes
Sample1162EO1_TTTGTTGCACACGCCA-1     Epithelial_cells
Name: singler_annotation, Length: 37517, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Epithelial_cells', 'Astrocyte', 'MSC', 'Keratinocytes', 'Neurons', 'Endothelial_cells', 'Fibroblasts', 'Tissue_stem_cells', 'Smooth_muscle_cells', 'T_cells', 'Neuroepithelial_cell', 'NK_cell', 'Chondrocytes', 'Osteoblasts', 'Monocyte', 'Hepatocytes', 'Macrophage', 'CMP', 'Embryonic_stem_cells', 'DC', 'BM & Prog.', 'MEP', 'Neutrophils', 'Pro-Myelocyte', 'iPS_cells', 'Pre-B_cell_CD34-', 'HSC_-G-CSF', 'B_cell', 'BM', 'Platelets', 'GMP', 'HSC_CD34+', 'Pro-B_cell_CD34+', 'Unknown', 'Gametocytes', 'Myelocyte', 'Erythroblast']
라벨별 그룹 개수 {0: 5, 1: 7, 2: 3}
🔍 Split #5
  → train_p_index 환자 수 (환자 단위로 묶인 index list): 62
  → test_p_index 환자 수  (환자 단위로 묶인 index list): 15
  → train 환자 ID: ['163-2', '163-5', '164-10', '164-3', '164-6', '165-9', '27-10039', '27-10041', '27-10053', '27-10071', '28-10051', '28-11515', '28-12263', '28-12490', '28-12518', '29-10006', '29-10008', '29-10010', '29-10011', '29-10012', '29-10016', '29-10280', '29-10380', '29-10386', '29-10398', '29-10400', '29-10404', '29-10410', '30-10034', '30-10123', '30-10929', '30-11051', '31-10000', '31-10001', '31-10013', '31-10040', '31-10042', '31-10078', '31-10210', '31-10236', '32-10003', '32-10034', '32-10074', '33-10005', '34-10050', '34-10184', '34-10187', 'PRE018-1', 'PRE019', 'PRE027', 'PRE038', 'PRE055-1', 'PRE062-1', 'PRE98sc', 'Sample1153-EO2', 'Sample1153-EO3', 'Sample1157-EO1', 'Sample1157-EO2', 'Sample1158-EO1', 'Sample1158-EO2', 'Sample1158-EO3', 'Sample1162-EO2']
  → test  환자 ID: ['163-3', '163-4', '27-10112', '27-10119', '28-12381', '29-10013', '29-10406', '30-10018', '30-10125', '31-10035', '31-10154', '33-10006', 'Sample1153-EO1', 'Sample1157-EO3', 'Sample1162-EO1']
  → train 환자 ID 및 라벨:
    ID: 163-2, Label: 0
    ID: 163-5, Label: 0
    ID: 164-10, Label: 0
    ID: 164-3, Label: 0
    ID: 164-6, Label: 0
    ID: 165-9, Label: 0
    ID: 27-10039, Label: 1
    ID: 27-10041, Label: 1
    ID: 27-10053, Label: 1
    ID: 27-10071, Label: 1
    ID: 28-10051, Label: 1
    ID: 28-11515, Label: 1
    ID: 28-12263, Label: 1
    ID: 28-12490, Label: 1
    ID: 28-12518, Label: 1
    ID: 29-10006, Label: 1
    ID: 29-10008, Label: 1
    ID: 29-10010, Label: 1
    ID: 29-10011, Label: 1
    ID: 29-10012, Label: 1
    ID: 29-10016, Label: 1
    ID: 29-10280, Label: 1
    ID: 29-10380, Label: 1
    ID: 29-10386, Label: 1
    ID: 29-10398, Label: 1
    ID: 29-10400, Label: 1
    ID: 29-10404, Label: 1
    ID: 29-10410, Label: 1
    ID: 30-10034, Label: 2
    ID: 30-10123, Label: 2
    ID: 30-10929, Label: 2
    ID: 30-11051, Label: 2
    ID: 31-10000, Label: 1
    ID: 31-10001, Label: 1
    ID: 31-10013, Label: 1
    ID: 31-10040, Label: 1
    ID: 31-10042, Label: 1
    ID: 31-10078, Label: 1
    ID: 31-10210, Label: 1
    ID: 31-10236, Label: 1
    ID: 32-10003, Label: 2
    ID: 32-10034, Label: 2
    ID: 32-10074, Label: 2
    ID: 33-10005, Label: 2
    ID: 34-10050, Label: 2
    ID: 34-10184, Label: 2
    ID: 34-10187, Label: 2
    ID: PRE018-1, Label: 0
    ID: PRE019, Label: 0
    ID: PRE027, Label: 0
    ID: PRE038, Label: 0
    ID: PRE055-1, Label: 0
    ID: PRE062-1, Label: 0
    ID: PRE98sc, Label: 0
    ID: Sample1153-EO2, Label: 0
    ID: Sample1153-EO3, Label: 0
    ID: Sample1157-EO1, Label: 0
    ID: Sample1157-EO2, Label: 0
    ID: Sample1158-EO1, Label: 0
    ID: Sample1158-EO2, Label: 0
    ID: Sample1158-EO3, Label: 0
    ID: Sample1162-EO2, Label: 0
  → test 환자 ID 및 라벨:
    ID: 163-3, Label: 0
    ID: 163-4, Label: 0
    ID: 27-10112, Label: 1
    ID: 27-10119, Label: 1
    ID: 28-12381, Label: 1
    ID: 29-10013, Label: 1
    ID: 29-10406, Label: 1
    ID: 30-10018, Label: 2
    ID: 30-10125, Label: 2
    ID: 31-10035, Label: 1
    ID: 31-10154, Label: 1
    ID: 33-10006, Label: 2
    ID: Sample1153-EO1, Label: 0
    ID: Sample1157-EO3, Label: 0
    ID: Sample1162-EO1, Label: 0
전체 데이터 index 길이 77
label_stat (train 환자 라벨 목록) 갯수 62
train_data에서 환자 단위로, train과 validation 나누기
기존 train_p_index 62
기존 (train) label_stat 62
train-vali 분할 후! 
train y 의 classes : {0, 1, 2} valid y 의 classes : {0, 1, 2} label_stat 의 classes : {0, 1, 2}
train_p_index_ 41
valid_p_index 21
test_p_index 15
→ train 환자 ID 및 라벨:
   총 개수: 41
   환자ID=29-10280, Label=1, 셀개수=2375
   환자ID=31-10210, Label=1, 셀개수=3510
   환자ID=34-10187, Label=2, 셀개수=3739
   환자ID=32-10034, Label=2, 셀개수=1555
   환자ID=Sample1158-EO1, Label=0, 셀개수=574
   환자ID=164-3, Label=0, 셀개수=1639
   환자ID=29-10010, Label=1, 셀개수=5305
   환자ID=PRE038, Label=0, 셀개수=2666
   환자ID=31-10001, Label=1, 셀개수=1133
   환자ID=30-11051, Label=2, 셀개수=2454
   환자ID=163-5, Label=0, 셀개수=1210
   환자ID=28-11515, Label=1, 셀개수=930
   환자ID=27-10039, Label=1, 셀개수=4638
   환자ID=27-10041, Label=1, 셀개수=2145
   환자ID=163-2, Label=0, 셀개수=2535
   환자ID=30-10034, Label=2, 셀개수=1240
   환자ID=31-10040, Label=1, 셀개수=4543
   환자ID=30-10929, Label=2, 셀개수=5812
   환자ID=Sample1158-EO2, Label=0, 셀개수=1427
   환자ID=29-10386, Label=1, 셀개수=802
   환자ID=31-10013, Label=1, 셀개수=3161
   환자ID=164-10, Label=0, 셀개수=4041
   환자ID=32-10003, Label=2, 셀개수=2978
   환자ID=PRE062-1, Label=0, 셀개수=907
   환자ID=29-10404, Label=1, 셀개수=3988
   환자ID=28-12490, Label=1, 셀개수=5973
   환자ID=Sample1158-EO3, Label=0, 셀개수=1096
   환자ID=31-10042, Label=1, 셀개수=1222
   환자ID=PRE018-1, Label=0, 셀개수=1349
   환자ID=28-10051, Label=1, 셀개수=300
   환자ID=29-10008, Label=1, 셀개수=1913
   환자ID=28-12263, Label=1, 셀개수=7527
   환자ID=165-9, Label=0, 셀개수=2926
   환자ID=29-10400, Label=1, 셀개수=2684
   환자ID=34-10184, Label=2, 셀개수=2699
   환자ID=29-10380, Label=1, 셀개수=4799
   환자ID=33-10005, Label=2, 셀개수=8904
   환자ID=32-10074, Label=2, 셀개수=6304
   환자ID=31-10236, Label=1, 셀개수=3458
   환자ID=29-10016, Label=1, 셀개수=4854
   환자ID=29-10006, Label=1, 셀개수=11461
→ valid 환자 ID 및 라벨:
   총 개수: 21
   환자ID=Sample1162-EO2, Label=0, 셀개수=1510
   환자ID=29-10012, Label=1, 셀개수=6245
   환자ID=31-10078, Label=1, 셀개수=2827
   환자ID=PRE98sc, Label=0, 셀개수=1568
   환자ID=34-10050, Label=2, 셀개수=4784
   환자ID=PRE055-1, Label=0, 셀개수=597
   환자ID=Sample1157-EO1, Label=0, 셀개수=1152
   환자ID=30-10123, Label=2, 셀개수=1273
   환자ID=31-10000, Label=1, 셀개수=8870
   환자ID=29-10410, Label=1, 셀개수=2834
   환자ID=Sample1157-EO2, Label=0, 셀개수=1395
   환자ID=27-10071, Label=1, 셀개수=1478
   환자ID=29-10398, Label=1, 셀개수=3993
   환자ID=Sample1153-EO2, Label=0, 셀개수=916
   환자ID=PRE027, Label=0, 셀개수=2078
   환자ID=PRE019, Label=0, 셀개수=3795
   환자ID=164-6, Label=0, 셀개수=3038
   환자ID=29-10011, Label=1, 셀개수=3072
   환자ID=27-10053, Label=1, 셀개수=728
   환자ID=28-12518, Label=1, 셀개수=1215
   환자ID=Sample1153-EO3, Label=0, 셀개수=1516
→ test 환자 ID 및 라벨:
   총 개수: 15
   환자ID=163-3, Label=0, 셀개수=1335
   환자ID=163-4, Label=0, 셀개수=1339
   환자ID=27-10112, Label=1, 셀개수=1470
   환자ID=27-10119, Label=1, 셀개수=3346
   환자ID=28-12381, Label=1, 셀개수=1099
   환자ID=29-10013, Label=1, 셀개수=3706
   환자ID=29-10406, Label=1, 셀개수=3484
   환자ID=30-10018, Label=2, 셀개수=5170
   환자ID=30-10125, Label=2, 셀개수=3798
   환자ID=31-10035, Label=1, 셀개수=2974
   환자ID=31-10154, Label=1, 셀개수=6568
   환자ID=33-10006, Label=2, 셀개수=457
   환자ID=Sample1153-EO1, Label=0, 셀개수=911
   환자ID=Sample1157-EO3, Label=0, 셀개수=807
   환자ID=Sample1162-EO1, Label=0, 셀개수=1053
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['DC', 'T_cells', 'T_cells', 'B_cell', 'Fibroblasts', 'Macrophage', 'DC', 'Monocyte', 'T_cells', 'Fibroblasts']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
전체 데이터 길이 225177
전체 cell type 길이 0                       DC
1                  T_cells
2                  T_cells
3                   B_cell
4              Fibroblasts
                ...       
225172           iPS_cells
225173         Hepatocytes
225174    Epithelial_cells
225175         Hepatocytes
225176    Epithelial_cells
Length: 225177, dtype: string
cell type의 NaN 개수 체크 0
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:11,  8.69it/s]  2%|▏         | 2/100 [00:00<00:11,  8.50it/s]  3%|▎         | 3/100 [00:00<00:11,  8.66it/s]  4%|▍         | 4/100 [00:00<00:10,  9.14it/s]  5%|▌         | 5/100 [00:00<00:10,  9.10it/s]  6%|▌         | 6/100 [00:00<00:10,  9.03it/s]  7%|▋         | 7/100 [00:00<00:10,  8.89it/s]  8%|▊         | 8/100 [00:00<00:10,  8.95it/s]  9%|▉         | 9/100 [00:01<00:09,  9.13it/s] 10%|█         | 10/100 [00:01<00:09,  9.12it/s] 11%|█         | 11/100 [00:01<00:09,  9.10it/s] 12%|█▏        | 12/100 [00:01<00:09,  8.94it/s] 13%|█▎        | 13/100 [00:01<00:09,  9.03it/s] 14%|█▍        | 14/100 [00:01<00:09,  8.98it/s] 15%|█▌        | 15/100 [00:01<00:09,  8.97it/s] 16%|█▌        | 16/100 [00:01<00:09,  9.02it/s] 17%|█▋        | 17/100 [00:01<00:08,  9.24it/s] 18%|█▊        | 18/100 [00:01<00:08,  9.24it/s] 19%|█▉        | 19/100 [00:02<00:08,  9.24it/s] 20%|██        | 20/100 [00:02<00:08,  9.30it/s] 21%|██        | 21/100 [00:02<00:08,  9.39it/s] 22%|██▏       | 22/100 [00:02<00:08,  9.22it/s] 23%|██▎       | 23/100 [00:02<00:08,  9.17it/s] 24%|██▍       | 24/100 [00:02<00:08,  9.15it/s] 25%|██▌       | 25/100 [00:02<00:08,  8.95it/s] 26%|██▌       | 26/100 [00:02<00:08,  9.01it/s] 27%|██▋       | 27/100 [00:02<00:08,  8.99it/s] 28%|██▊       | 28/100 [00:03<00:07,  9.01it/s] 29%|██▉       | 29/100 [00:03<00:07,  9.14it/s] 30%|███       | 30/100 [00:03<00:07,  9.01it/s] 31%|███       | 31/100 [00:03<00:07,  8.80it/s] 32%|███▏      | 32/100 [00:03<00:07,  8.88it/s] 33%|███▎      | 33/100 [00:03<00:07,  8.89it/s] 34%|███▍      | 34/100 [00:03<00:07,  8.77it/s] 35%|███▌      | 35/100 [00:03<00:07,  9.06it/s] 36%|███▌      | 36/100 [00:04<00:07,  8.34it/s] 37%|███▋      | 37/100 [00:04<00:07,  8.46it/s] 38%|███▊      | 38/100 [00:04<00:07,  8.39it/s] 39%|███▉      | 39/100 [00:04<00:07,  8.39it/s] 40%|████      | 40/100 [00:04<00:07,  8.48it/s] 41%|████      | 41/100 [00:04<00:06,  8.45it/s] 42%|████▏     | 42/100 [00:04<00:06,  8.44it/s] 43%|████▎     | 43/100 [00:04<00:06,  8.54it/s] 44%|████▍     | 44/100 [00:04<00:06,  8.58it/s] 45%|████▌     | 45/100 [00:05<00:06,  8.20it/s] 46%|████▌     | 46/100 [00:05<00:06,  8.45it/s] 47%|████▋     | 47/100 [00:05<00:06,  8.42it/s] 48%|████▊     | 48/100 [00:05<00:06,  8.41it/s] 49%|████▉     | 49/100 [00:05<00:06,  8.42it/s] 50%|█████     | 50/100 [00:05<00:05,  8.34it/s] 51%|█████     | 51/100 [00:05<00:05,  8.35it/s] 52%|█████▏    | 52/100 [00:05<00:05,  8.36it/s] 53%|█████▎    | 53/100 [00:06<00:05,  8.37it/s] 54%|█████▍    | 54/100 [00:06<00:05,  8.41it/s] 55%|█████▌    | 55/100 [00:06<00:05,  8.35it/s] 56%|█████▌    | 56/100 [00:06<00:05,  8.31it/s] 57%|█████▋    | 57/100 [00:06<00:05,  8.38it/s] 58%|█████▊    | 58/100 [00:06<00:05,  8.32it/s] 59%|█████▉    | 59/100 [00:06<00:05,  7.26it/s] 60%|██████    | 60/100 [00:06<00:05,  7.49it/s] 61%|██████    | 61/100 [00:07<00:05,  7.70it/s] 62%|██████▏   | 62/100 [00:07<00:04,  7.74it/s] 63%|██████▎   | 63/100 [00:07<00:04,  7.76it/s] 64%|██████▍   | 64/100 [00:07<00:04,  7.95it/s] 65%|██████▌   | 65/100 [00:07<00:04,  8.16it/s] 66%|██████▌   | 66/100 [00:07<00:04,  8.22it/s] 67%|██████▋   | 67/100 [00:07<00:03,  8.25it/s] 68%|██████▊   | 68/100 [00:07<00:04,  7.98it/s] 69%|██████▉   | 69/100 [00:08<00:03,  7.93it/s] 70%|███████   | 70/100 [00:08<00:03,  8.02it/s] 71%|███████   | 71/100 [00:08<00:03,  8.09it/s] 72%|███████▏  | 72/100 [00:08<00:03,  7.31it/s] 73%|███████▎  | 73/100 [00:08<00:03,  7.42it/s] 74%|███████▍  | 74/100 [00:08<00:03,  7.68it/s] 75%|███████▌  | 75/100 [00:08<00:03,  7.71it/s] 76%|███████▌  | 76/100 [00:09<00:03,  6.73it/s] 77%|███████▋  | 77/100 [00:09<00:03,  7.16it/s] 78%|███████▊  | 78/100 [00:09<00:03,  7.29it/s] 79%|███████▉  | 79/100 [00:09<00:02,  7.55it/s] 80%|████████  | 80/100 [00:09<00:02,  7.67it/s] 81%|████████  | 81/100 [00:09<00:02,  7.85it/s] 82%|████████▏ | 82/100 [00:09<00:02,  8.00it/s] 83%|████████▎ | 83/100 [00:09<00:02,  7.90it/s] 84%|████████▍ | 84/100 [00:10<00:02,  7.89it/s] 85%|████████▌ | 85/100 [00:10<00:02,  5.16it/s] 86%|████████▌ | 86/100 [00:10<00:02,  5.77it/s] 87%|████████▋ | 87/100 [00:10<00:02,  6.20it/s] 88%|████████▊ | 88/100 [00:10<00:01,  6.53it/s] 89%|████████▉ | 89/100 [00:10<00:01,  6.91it/s] 90%|█████████ | 90/100 [00:11<00:01,  7.21it/s] 91%|█████████ | 91/100 [00:11<00:01,  7.37it/s] 92%|█████████▏| 92/100 [00:11<00:01,  7.51it/s] 93%|█████████▎| 93/100 [00:11<00:00,  7.63it/s] 94%|█████████▍| 94/100 [00:11<00:00,  7.77it/s] 95%|█████████▌| 95/100 [00:11<00:00,  7.82it/s] 96%|█████████▌| 96/100 [00:11<00:00,  7.89it/s] 97%|█████████▋| 97/100 [00:11<00:00,  7.77it/s] 98%|█████████▊| 98/100 [00:12<00:00,  7.70it/s] 99%|█████████▉| 99/100 [00:12<00:00,  7.75it/s]100%|██████████| 100/100 [00:12<00:00,  5.64it/s]100%|██████████| 100/100 [00:12<00:00,  8.03it/s]
[I 2025-08-31 14:08:20,253] A new study created in memory with name: no-name-3cd851ee-dda1-4a39-88d0-4b8b9733d4bd
👉 train samples(학습 샘플(bag))=141, batch_size=8 -> steps(샘플수/batch크기)=18
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 24.81 MB
Memory Reserved: 36.00 MB
cuda
CUDA OOM 발생 — 단계적 백오프 시작.
[OOM RETRY] batch_size 8 → 8 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=141, batch_size=8 -> steps(샘플수/batch크기)=18
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 1075.34 MB
Memory Reserved: 1086.00 MB
cuda
[OOM RETRY] batch_size=8에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 8 → 4 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=141, batch_size=4 -> steps(샘플수/batch크기)=36
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 2125.87 MB
Memory Reserved: 2136.00 MB
cuda
Epoch 1, Train Loss 0.985474, Valid_loss 1.017195
Epoch 2, Train Loss 1.006768, Valid_loss 0.968105
Epoch 3, Train Loss 1.031711, Valid_loss 0.917590
Epoch 4, Train Loss 0.937016, Valid_loss 0.854739
Epoch 5, Train Loss 0.919400, Valid_loss 0.788504
Epoch 6, Train Loss 0.910145, Valid_loss 0.737111
Epoch 7, Train Loss 0.917201, Valid_loss 0.689362
Epoch 8, Train Loss 0.828767, Valid_loss 0.784282
Epoch 9, Train Loss 0.912974, Valid_loss 0.656706
Epoch 10, Train Loss 0.793558, Valid_loss 0.618502
Epoch 11, Train Loss 0.817931, Valid_loss 0.592362
Epoch 12, Train Loss 0.798221, Valid_loss 0.580874
Epoch 13, Train Loss 0.818715, Valid_loss 0.787539
Epoch 14, Train Loss 0.759848, Valid_loss 0.544133
Epoch 15, Train Loss 0.755058, Valid_loss 0.530138
Epoch 16, Train Loss 0.707714, Valid_loss 0.851046
Epoch 17, Train Loss 0.796054, Valid_loss 0.539243
Epoch 18, Train Loss 0.796272, Valid_loss 0.520545
Epoch 19, Train Loss 0.902616, Valid_loss 0.529857
Epoch 20, Train Loss 0.787986, Valid_loss 0.522523
Epoch 21, Train Loss 0.752975, Valid_loss 0.561246
Epoch 22, Train Loss 0.897448, Valid_loss 0.509144
Epoch 23, Train Loss 0.766322, Valid_loss 0.505322
Epoch 24, Train Loss 0.782704, Valid_loss 0.516452
Epoch 25, Train Loss 0.679301, Valid_loss 0.486248
Epoch 26, Train Loss 0.795551, Valid_loss 0.482711
Epoch 27, Train Loss 0.699913, Valid_loss 0.472496
Epoch 28, Train Loss 0.720881, Valid_loss 0.469392
Epoch 29, Train Loss 0.711856, Valid_loss 0.491896
Epoch 30, Train Loss 0.657630, Valid_loss 0.551214
Epoch 31, Train Loss 0.711978, Valid_loss 0.434246
Epoch 32, Train Loss 0.719055, Valid_loss 0.430387
Epoch 33, Train Loss 0.757709, Valid_loss 0.692808
Epoch 34, Train Loss 0.712609, Valid_loss 0.440423
Epoch 35, Train Loss 0.804846, Valid_loss 0.522569
Epoch 36, Train Loss 0.869539, Valid_loss 0.921145
Epoch 37, Train Loss 0.721019, Valid_loss 0.446064
Epoch 38, Train Loss 0.766388, Valid_loss 0.461173
Epoch 39, Train Loss 0.658400, Valid_loss 0.484239
Epoch 40, Train Loss 0.817923, Valid_loss 0.508677
Epoch 41, Train Loss 0.680889, Valid_loss 0.513573
Epoch 42, Train Loss 0.634720, Valid_loss 0.560883
Epoch 43, Train Loss 0.724892, Valid_loss 0.573535
Epoch 44, Train Loss 0.686871, Valid_loss 0.429336
Epoch 45, Train Loss 0.697707, Valid_loss 0.425983
Epoch 46, Train Loss 0.684285, Valid_loss 0.460509
Epoch 47, Train Loss 0.645201, Valid_loss 0.408914
Epoch 48, Train Loss 0.716676, Valid_loss 0.490283
Epoch 49, Train Loss 0.756918, Valid_loss 0.612721
Epoch 50, Train Loss 0.603639, Valid_loss 0.409652
Epoch 51, Train Loss 0.628221, Valid_loss 0.404356
Epoch 52, Train Loss 0.662458, Valid_loss 0.419884
Epoch 53, Train Loss 0.601035, Valid_loss 0.398107
Epoch 54, Train Loss 0.595159, Valid_loss 0.466617
Epoch 55, Train Loss 0.651538, Valid_loss 0.500137
[I 2025-08-31 14:19:55,196] Trial 0 finished with value: 0.3981065870750518 and parameters: {'learning_rate': 0.001, 'epochs': 100, 'heads': 4, 'dropout': 0.5, 'weight_decay': 0.01, 'emb_dim': 8, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.3981065870750518.
👉 train samples(학습 샘플(bag))=141, batch_size=8 -> steps(샘플수/batch크기)=18
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 1078.50 MB
Memory Reserved: 1086.00 MB
cuda
Epoch 1, Train Loss 1.006609, Valid_loss 0.908616
Epoch 2, Train Loss 0.943583, Valid_loss 0.770631
Epoch 3, Train Loss 0.847815, Valid_loss 0.450243
Epoch 4, Train Loss 0.628157, Valid_loss 0.397345
Epoch 5, Train Loss 0.526671, Valid_loss 0.333409
Epoch 6, Train Loss 0.791274, Valid_loss 0.484875
Epoch 7, Train Loss 0.715587, Valid_loss 0.337745
Epoch 8, Train Loss 0.498871, Valid_loss 0.285836
Epoch 9, Train Loss 0.447762, Valid_loss 0.312608
Epoch 10, Train Loss 0.407471, Valid_loss 0.415909
Epoch 11, Train Loss 0.423685, Valid_loss 0.561609
Epoch 12, Train Loss 0.482022, Valid_loss 0.330832
Epoch 13, Train Loss 0.350553, Valid_loss 0.255309
Epoch 14, Train Loss 0.332424, Valid_loss 0.286815
Epoch 15, Train Loss 0.329749, Valid_loss 0.266890
Epoch 16, Train Loss 0.307968, Valid_loss 0.267303
Epoch 17, Train Loss 0.385328, Valid_loss 0.404160
Epoch 18, Train Loss 0.356348, Valid_loss 0.254494
Epoch 19, Train Loss 0.407850, Valid_loss 0.224302
Epoch 20, Train Loss 0.322983, Valid_loss 0.262384
Epoch 21, Train Loss 0.305930, Valid_loss 0.413975
Epoch 22, Train Loss 0.334240, Valid_loss 0.224979
Epoch 23, Train Loss 0.267038, Valid_loss 0.273955
Epoch 24, Train Loss 0.221547, Valid_loss 0.263177
Epoch 25, Train Loss 0.201784, Valid_loss 0.268944
Epoch 26, Train Loss 0.249992, Valid_loss 0.376347
Epoch 27, Train Loss 0.262885, Valid_loss 0.228945
Epoch 28, Train Loss 0.281359, Valid_loss 0.235987
Epoch 29, Train Loss 0.260708, Valid_loss 0.254042
Epoch 30, Train Loss 0.213637, Valid_loss 0.317319
Epoch 31, Train Loss 0.258562, Valid_loss 0.329030
Epoch 32, Train Loss 0.297592, Valid_loss 0.227254
Epoch 33, Train Loss 0.233153, Valid_loss 0.156824
Epoch 34, Train Loss 0.201873, Valid_loss 0.170690
Epoch 35, Train Loss 0.197056, Valid_loss 0.162306
Epoch 36, Train Loss 0.226190, Valid_loss 0.338447
Epoch 37, Train Loss 0.175549, Valid_loss 0.414542
Epoch 38, Train Loss 0.220068, Valid_loss 0.145437
Epoch 39, Train Loss 0.222825, Valid_loss 0.360011
Epoch 40, Train Loss 0.208467, Valid_loss 0.545676
Epoch 41, Train Loss 0.268357, Valid_loss 0.275729
Epoch 42, Train Loss 0.202862, Valid_loss 0.199855
Epoch 43, Train Loss 0.189238, Valid_loss 0.290777
Epoch 44, Train Loss 0.253061, Valid_loss 0.159641
Epoch 45, Train Loss 0.146881, Valid_loss 0.157957
Epoch 46, Train Loss 0.239281, Valid_loss 0.215513
Epoch 47, Train Loss 0.299880, Valid_loss 0.197074
Epoch 48, Train Loss 0.223043, Valid_loss 0.148097
Epoch 49, Train Loss 0.164118, Valid_loss 0.151342
Epoch 50, Train Loss 0.313318, Valid_loss 0.203256
Epoch 51, Train Loss 0.249512, Valid_loss 0.250134
Epoch 52, Train Loss 0.170568, Valid_loss 0.168616
Epoch 53, Train Loss 0.134106, Valid_loss 0.140923
Epoch 54, Train Loss 0.146356, Valid_loss 0.203068
Epoch 55, Train Loss 0.143266, Valid_loss 0.357927
[I 2025-08-31 14:29:21,940] Trial 1 finished with value: 0.1409234990354716 and parameters: {'learning_rate': 0.001, 'epochs': 100, 'heads': 2, 'dropout': 0.3, 'weight_decay': 0.0001, 'emb_dim': 64, 'augment_num': 100, 'pca': False}. Best is trial 1 with value: 0.1409234990354716.
👉 train samples(학습 샘플(bag))=141, batch_size=8 -> steps(샘플수/batch크기)=18
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 1075.34 MB
Memory Reserved: 1086.00 MB
cuda
Epoch 1, Train Loss 1.094259, Valid_loss 1.057021
Epoch 2, Train Loss 0.984012, Valid_loss 0.975036
Epoch 3, Train Loss 0.986630, Valid_loss 0.971945
Epoch 4, Train Loss 0.972484, Valid_loss 0.999371
Epoch 5, Train Loss 0.996079, Valid_loss 1.011219
Epoch 6, Train Loss 0.984714, Valid_loss 0.964040
Epoch 7, Train Loss 0.978956, Valid_loss 0.978835
Epoch 8, Train Loss 0.974388, Valid_loss 0.994797
Epoch 9, Train Loss 0.970261, Valid_loss 0.976204
Epoch 10, Train Loss 0.982028, Valid_loss 0.971869
Epoch 11, Train Loss 0.965204, Valid_loss 0.993826
Epoch 12, Train Loss 0.966052, Valid_loss 0.986193
Epoch 13, Train Loss 0.975192, Valid_loss 0.976619
Epoch 14, Train Loss 0.972151, Valid_loss 0.995211
Epoch 15, Train Loss 0.970844, Valid_loss 1.000029
Epoch 16, Train Loss 0.969704, Valid_loss 0.971420
Epoch 17, Train Loss 0.972466, Valid_loss 0.976476
Epoch 18, Train Loss 0.972098, Valid_loss 0.986715
Epoch 19, Train Loss 0.974217, Valid_loss 0.981106
Epoch 20, Train Loss 0.965475, Valid_loss 0.983085
Epoch 21, Train Loss 0.965388, Valid_loss 0.989928
Epoch 22, Train Loss 0.971541, Valid_loss 0.999282
Epoch 23, Train Loss 0.964026, Valid_loss 0.982016
Epoch 24, Train Loss 0.976598, Valid_loss 0.983219
Epoch 25, Train Loss 0.969135, Valid_loss 0.995350
Epoch 26, Train Loss 0.967553, Valid_loss 0.977874
Epoch 27, Train Loss 0.973181, Valid_loss 0.980131
Epoch 28, Train Loss 0.967816, Valid_loss 1.002624
Epoch 29, Train Loss 0.966504, Valid_loss 0.982683
Epoch 30, Train Loss 0.964414, Valid_loss 0.989964
Epoch 31, Train Loss 0.974318, Valid_loss 0.987016
Epoch 32, Train Loss 0.969569, Valid_loss 0.985819
Epoch 33, Train Loss 0.966102, Valid_loss 0.975089
Epoch 34, Train Loss 0.968871, Valid_loss 0.989438
Epoch 35, Train Loss 0.981641, Valid_loss 0.985149
Epoch 36, Train Loss 0.976880, Valid_loss 0.956281
Epoch 37, Train Loss 0.963697, Valid_loss 0.989130
Epoch 38, Train Loss 0.975918, Valid_loss 0.992818
Epoch 39, Train Loss 0.967630, Valid_loss 0.972040
Epoch 40, Train Loss 0.986272, Valid_loss 0.965190
Epoch 41, Train Loss 0.973736, Valid_loss 0.993714
Epoch 42, Train Loss 0.990387, Valid_loss 0.982617
Epoch 43, Train Loss 0.971411, Valid_loss 0.970195
Epoch 44, Train Loss 0.964292, Valid_loss 0.981953
Epoch 45, Train Loss 0.968636, Valid_loss 0.989562
Epoch 46, Train Loss 0.968191, Valid_loss 0.974176
Epoch 47, Train Loss 0.972078, Valid_loss 0.991952
Epoch 48, Train Loss 0.973362, Valid_loss 0.993058
Epoch 49, Train Loss 0.976324, Valid_loss 0.994257
Epoch 50, Train Loss 0.968109, Valid_loss 0.985417
Epoch 51, Train Loss 0.961163, Valid_loss 0.973946
Epoch 52, Train Loss 0.964531, Valid_loss 0.972996
Epoch 53, Train Loss 0.966682, Valid_loss 0.982721
Epoch 54, Train Loss 0.968675, Valid_loss 0.982646
Epoch 55, Train Loss 0.962601, Valid_loss 0.986805
Epoch 56, Train Loss 0.962145, Valid_loss 0.983650
Epoch 57, Train Loss 0.968822, Valid_loss 0.988044
Epoch 58, Train Loss 0.963873, Valid_loss 0.978747
Epoch 59, Train Loss 0.963830, Valid_loss 0.984485
Epoch 60, Train Loss 0.958744, Valid_loss 0.982951
Epoch 61, Train Loss 0.948908, Valid_loss 1.008504
Epoch 62, Train Loss 0.918659, Valid_loss 0.924702
Epoch 63, Train Loss 0.814962, Valid_loss 0.817099
Epoch 64, Train Loss 0.783480, Valid_loss 0.843726
Epoch 65, Train Loss 0.624839, Valid_loss 0.607582
Epoch 66, Train Loss 0.562268, Valid_loss 0.433776
Epoch 67, Train Loss 0.551742, Valid_loss 0.381509
Epoch 68, Train Loss 0.524426, Valid_loss 0.424996
Epoch 69, Train Loss 0.541185, Valid_loss 0.338307
Epoch 70, Train Loss 0.722195, Valid_loss 0.536606
Epoch 71, Train Loss 0.474377, Valid_loss 0.453592
Epoch 72, Train Loss 0.454543, Valid_loss 0.359248
Epoch 73, Train Loss 0.426219, Valid_loss 0.430904
Epoch 74, Train Loss 0.326088, Valid_loss 0.543609
[I 2025-08-31 14:41:21,222] Trial 2 finished with value: 0.3383071106814203 and parameters: {'learning_rate': 0.01, 'epochs': 100, 'heads': 2, 'dropout': 0.0, 'weight_decay': 0.0001, 'emb_dim': 8, 'augment_num': 100, 'pca': False}. Best is trial 1 with value: 0.1409234990354716.
선택된 trial params: {'learning_rate': 0.001, 'epochs': 100, 'heads': 2, 'dropout': 0.3, 'weight_decay': 0.0001, 'emb_dim': 64, 'augment_num': 100, 'pca': False}
👉 train samples(학습 샘플(bag))=141, batch_size=8 -> steps(샘플수/batch크기)=18
👉 valid samples=21, batch_size=1 -> steps=21
👉 test  samples=15, batch_size=1 -> steps=15
Memory Allocated: 1078.50 MB
Memory Reserved: 1086.00 MB
cuda
Epoch 1, Train Loss 1.029918, Valid_loss 0.933647
Epoch 2, Train Loss 0.990565, Valid_loss 0.986688
Epoch 3, Train Loss 1.012099, Valid_loss 0.886922
Epoch 4, Train Loss 0.943735, Valid_loss 0.735767
Epoch 5, Train Loss 0.725031, Valid_loss 0.429280
Epoch 6, Train Loss 0.753791, Valid_loss 0.379005
Epoch 7, Train Loss 0.829605, Valid_loss 0.478147
Epoch 8, Train Loss 0.672708, Valid_loss 0.436236
Epoch 9, Train Loss 0.605230, Valid_loss 0.337990
Epoch 10, Train Loss 0.544473, Valid_loss 0.296356
Epoch 11, Train Loss 0.632604, Valid_loss 0.339545
Epoch 12, Train Loss 0.712755, Valid_loss 0.315059
Epoch 13, Train Loss 0.527979, Valid_loss 0.287243
Epoch 14, Train Loss 0.533542, Valid_loss 0.324421
Epoch 15, Train Loss 0.514235, Valid_loss 0.249428
Epoch 16, Train Loss 0.473802, Valid_loss 0.257574
Epoch 17, Train Loss 0.500689, Valid_loss 0.261264
Epoch 18, Train Loss 0.420104, Valid_loss 0.202608
Epoch 19, Train Loss 0.356634, Valid_loss 0.281187
Epoch 20, Train Loss 0.383672, Valid_loss 0.220148
Epoch 21, Train Loss 0.324111, Valid_loss 0.223979
Epoch 22, Train Loss 0.304659, Valid_loss 0.284373
Epoch 23, Train Loss 0.253095, Valid_loss 0.190352
Epoch 24, Train Loss 0.268399, Valid_loss 0.243693
Epoch 25, Train Loss 0.284495, Valid_loss 0.170427
Epoch 26, Train Loss 0.297213, Valid_loss 0.195884
Epoch 27, Train Loss 0.269458, Valid_loss 0.154409
Epoch 28, Train Loss 0.237681, Valid_loss 0.183760
Epoch 29, Train Loss 0.376318, Valid_loss 0.364802
Epoch 30, Train Loss 0.436762, Valid_loss 0.147702
Epoch 31, Train Loss 0.325137, Valid_loss 0.207420
Epoch 32, Train Loss 0.254144, Valid_loss 0.182768
Epoch 33, Train Loss 0.260801, Valid_loss 0.321769
Epoch 34, Train Loss 0.226932, Valid_loss 0.462929
Epoch 35, Train Loss 0.335560, Valid_loss 0.216231
Epoch 36, Train Loss 0.264589, Valid_loss 0.152809
Epoch 37, Train Loss 0.239728, Valid_loss 0.125863
Epoch 38, Train Loss 0.247666, Valid_loss 0.198092
Epoch 39, Train Loss 0.283782, Valid_loss 0.160893
Epoch 40, Train Loss 0.255794, Valid_loss 0.207283
Epoch 41, Train Loss 0.211738, Valid_loss 0.251658
Epoch 42, Train Loss 0.220924, Valid_loss 0.169060
Epoch 43, Train Loss 0.252814, Valid_loss 0.280181
Epoch 44, Train Loss 0.209705, Valid_loss 0.216482
Epoch 45, Train Loss 0.188810, Valid_loss 0.311563
Epoch 46, Train Loss 0.195242, Valid_loss 0.175893
Epoch 47, Train Loss 0.236481, Valid_loss 0.250640
Epoch 48, Train Loss 0.264645, Valid_loss 0.206534
Epoch 49, Train Loss 0.272131, Valid_loss 0.186650
Epoch 50, Train Loss 0.206202, Valid_loss 0.238809
Epoch 51, Train Loss 0.150095, Valid_loss 0.159367
Epoch 52, Train Loss 0.176741, Valid_loss 0.162303
Epoch 53, Train Loss 0.145362, Valid_loss 0.146278
Epoch 54, Train Loss 0.147591, Valid_loss 0.223482
Epoch 55, Train Loss 0.161123, Valid_loss 0.129473
Epoch 56, Train Loss 0.143796, Valid_loss 0.160520
Epoch 57, Train Loss 0.134799, Valid_loss 0.135487
Epoch 58, Train Loss 0.134809, Valid_loss 0.137156
Epoch 59, Train Loss 0.150017, Valid_loss 0.180941
환자ID=163-3 -- true: [[0]] -- pred: tensor([[-2.0623,  2.4308, -0.9445]], device='cuda:0')
환자ID=163-4 -- true: [[0]] -- pred: tensor([[ 4.3228, -0.9239, -2.8272]], device='cuda:0')
환자ID=27-10112 -- true: [[1]] -- pred: tensor([[-1.3615,  2.8239, -1.7264]], device='cuda:0')
환자ID=27-10119 -- true: [[1]] -- pred: tensor([[-0.0449,  2.6189, -2.3807]], device='cuda:0')
환자ID=28-12381 -- true: [[1]] -- pred: tensor([[-1.5428,  2.8020, -1.5806]], device='cuda:0')
환자ID=29-10013 -- true: [[1]] -- pred: tensor([[-0.0162,  2.6121, -2.4060]], device='cuda:0')
환자ID=29-10406 -- true: [[1]] -- pred: tensor([[-0.2777,  2.7311, -2.2903]], device='cuda:0')
환자ID=30-10018 -- true: [[2]] -- pred: tensor([[-4.1007,  0.3355,  1.3689]], device='cuda:0')
환자ID=30-10125 -- true: [[2]] -- pred: tensor([[-4.1826,  0.0457,  1.5508]], device='cuda:0')
환자ID=31-10035 -- true: [[1]] -- pred: tensor([[ 0.5152,  2.4233, -2.5452]], device='cuda:0')
환자ID=31-10154 -- true: [[1]] -- pred: tensor([[-0.5794,  2.8082, -2.1657]], device='cuda:0')
환자ID=33-10006 -- true: [[2]] -- pred: tensor([[-4.1244,  0.2645,  1.3989]], device='cuda:0')
환자ID=Sample1153-EO1 -- true: [[0]] -- pred: tensor([[ 4.0741, -0.4825, -2.8965]], device='cuda:0')
환자ID=Sample1157-EO3 -- true: [[0]] -- pred: tensor([[ 3.9982, -0.3647, -2.9167]], device='cuda:0')
환자ID=Sample1162-EO1 -- true: [[0]] -- pred: tensor([[ 3.8274, -0.1712, -2.9288]], device='cuda:0')
Best performance: Epoch 37, Loss 0.239728, Test ACC 0.933333, Test AUC 0.947619, Test Recall 0.933333, Test Precision 0.958333
Confusion Matrix:
 [[4 1 0]
 [0 7 0]
 [0 0 3]]
✅ Total valid splits used: 5

📌 Repeat 4: 평균 AUC = 0.9145, 표준편차 = 0.0499
Test ACC 평균 0.844167, Test Recall 평균 0.732698, Test Precision 평균 0.712374
fold_aucs = [0.9166666666666666, 0.8194444444444445, 0.9603174603174603, 0.9285714285714285, 0.9476190476190477]
NaN 개수: 0 / 전체 5개


================ 전체 Repeat 요약 ================
Repeat 0: AUC 0.9358 ± 0.0535 | ACC 0.8167 | Recall 0.7089 | Precision 0.6435 | NaN 0/5
Repeat 1: AUC 0.8633 ± 0.0917 | ACC 0.7908 | Recall 0.6400 | Precision 0.5667 | NaN 0/5
Repeat 2: AUC 0.8029 ± 0.1158 | ACC 0.6750 | Recall 0.5238 | Precision 0.3978 | NaN 0/5
Repeat 3: AUC 0.9346 ± 0.0383 | ACC 0.7775 | Recall 0.6267 | Precision 0.5576 | NaN 0/5
Repeat 4: AUC 0.9145 ± 0.0499 | ACC 0.8442 | Recall 0.7327 | Precision 0.7124 | NaN 0/5

🏁 최종 결과 (각 Repeat의 AUC 평균의 평균): 0.8902 ± 0.0510
