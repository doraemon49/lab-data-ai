Namespace(seed=240, batch_size=1, learning_rate=0.003, weight_decay=0.0001, epochs=100, task='custom_cardio', emb_dim=128, h_dim=128, dropout=0.3, layers=1, heads=8, train_sample_cells=500, test_sample_cells=500, train_num_sample=20, test_num_sample=100, model='Transformer', dataset='/data/project/kim89/0805_data', inter_only=False, same_pheno=0, augment_num=100, alpha=1.0, repeat=5, all=1, min_size=6000, n_splits=5, pca=False, mix_type=1, norm_first=False, warmup=False, top_k=1, cell_type_annotation='singler_annotation')
🔁 Repeat 0, Fold 0
cell type :  CAACCAAAGACCCGCT-1-2                 Neurons
ACGGTTACATCGAACT-1-2                 Neurons
ACCCTCATCCGGCAGT-1-2                 Neurons
AACACACCACGGTCTG-1-2     Smooth_muscle_cells
AAACGCTTCACCGGGT-1-2                 Neurons
                                ...         
CGTCCATAGAATTTGG-1-78      Endothelial_cells
GCTTCACAGCGTTGTT-1-78            Hepatocytes
TCTCTGGCAGTCGCAC-1-78                Neurons
CAACAACCAGAGGCTA-1-78                Neurons
CATTGTTGTCGTACAT-1-78      Endothelial_cells
Name: singler_annotation, Length: 463212, dtype: string
cell type annotation :  CAACCAAAGACCCGCT-1-2                 Neurons
ACGGTTACATCGAACT-1-2                 Neurons
ACCCTCATCCGGCAGT-1-2                 Neurons
AACACACCACGGTCTG-1-2     Smooth_muscle_cells
AAACGCTTCACCGGGT-1-2                 Neurons
                                ...         
CGTCCATAGAATTTGG-1-78      Endothelial_cells
GCTTCACAGCGTTGTT-1-78            Hepatocytes
TCTCTGGCAGTCGCAC-1-78                Neurons
CAACAACCAGAGGCTA-1-78                Neurons
CATTGTTGTCGTACAT-1-78      Endothelial_cells
Name: singler_annotation, Length: 463212, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Neurons', 'Smooth_muscle_cells', 'Osteoblasts', 'Endothelial_cells', 'MSC', 'Astrocyte', 'Fibroblasts', 'Erythroblast', 'Neuroepithelial_cell', 'Platelets', 'iPS_cells', 'NK_cell', 'Embryonic_stem_cells', 'MEP', 'Gametocytes', 'Hepatocytes', 'Tissue_stem_cells', 'Monocyte', 'Macrophage', 'Neutrophils', 'Chondrocytes', 'HSC_-G-CSF', 'BM & Prog.', 'DC', 'Keratinocytes', 'T_cells', 'HSC_CD34+', 'CMP', 'B_cell', 'Myelocyte', 'Epithelial_cells', 'Unknown', 'Pro-Myelocyte', 'Pre-B_cell_CD34-', 'BM', 'GMP', 'Pro-B_cell_CD34+']
라벨별 그룹 개수 {2: 9, 1: 12, 0: 12}
cell type :  TTCTTCCGTTCAACGT-1-0                Astrocyte
CATCCACCATCTAACG-1-0      Smooth_muscle_cells
ACCCAAACAGCTAACT-1-0                  Neurons
AAGGAATCAACTGGTT-1-0     Neuroepithelial_cell
TACCCGTAGCGTGCTC-1-0                Astrocyte
                                 ...         
TTATTGCGTCGGTGTC-1-79       Endothelial_cells
GTCACGGGTTGTATGC-1-79       Endothelial_cells
GTCATGATCTTTCGAT-1-79       Endothelial_cells
GCGATCGTCAGAGTGG-1-79               Platelets
GCCCGAACAGAGAAAG-1-79       Endothelial_cells
Name: singler_annotation, Length: 129477, dtype: string
cell type annotation :  TTCTTCCGTTCAACGT-1-0                Astrocyte
CATCCACCATCTAACG-1-0      Smooth_muscle_cells
ACCCAAACAGCTAACT-1-0                  Neurons
AAGGAATCAACTGGTT-1-0     Neuroepithelial_cell
TACCCGTAGCGTGCTC-1-0                Astrocyte
                                 ...         
TTATTGCGTCGGTGTC-1-79       Endothelial_cells
GTCACGGGTTGTATGC-1-79       Endothelial_cells
GTCATGATCTTTCGAT-1-79       Endothelial_cells
GCGATCGTCAGAGTGG-1-79               Platelets
GCCCGAACAGAGAAAG-1-79       Endothelial_cells
Name: singler_annotation, Length: 129477, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Astrocyte', 'Smooth_muscle_cells', 'Neurons', 'Neuroepithelial_cell', 'Endothelial_cells', 'Osteoblasts', 'Platelets', 'Hepatocytes', 'Embryonic_stem_cells', 'MEP', 'Erythroblast', 'Fibroblasts', 'iPS_cells', 'MSC', 'Macrophage', 'Gametocytes', 'Chondrocytes', 'NK_cell', 'Neutrophils', 'HSC_CD34+', 'Monocyte', 'Tissue_stem_cells', 'DC', 'HSC_-G-CSF', 'T_cells', 'Epithelial_cells', 'Unknown', 'Pre-B_cell_CD34-', 'GMP', 'B_cell', 'Pro-Myelocyte', 'Keratinocytes', 'Myelocyte', 'BM', 'CMP', 'BM & Prog.', 'Pro-B_cell_CD34+']
라벨별 그룹 개수 {1: 3, 2: 2, 0: 4}
🔍 Split #1
  → train_p_index 환자 수 (환자 단위로 묶인 index list): 33
  → test_p_index 환자 수  (환자 단위로 묶인 index list): 9
  → train 환자 ID: ['P1290', 'P1300', 'P1304', 'P1358', 'P1371', 'P1425', 'P1430', 'P1462', 'P1479', 'P1504', 'P1508', 'P1510', 'P1515', 'P1516', 'P1539', 'P1540', 'P1547', 'P1549', 'P1558', 'P1582', 'P1600', 'P1602', 'P1606', 'P1610', 'P1617', 'P1630', 'P1631', 'P1678', 'P1685', 'P1707', 'P1718', 'P1722', 'P1735']
  → test  환자 ID: ['P1422', 'P1437', 'P1447', 'P1472', 'P1561', 'P1603', 'P1622', 'P1702', 'P1726']
  → train 환자 ID 및 라벨:
    ID: P1290, Label: 2
    ID: P1300, Label: 2
    ID: P1304, Label: 2
    ID: P1358, Label: 2
    ID: P1371, Label: 2
    ID: P1425, Label: 1
    ID: P1430, Label: 2
    ID: P1462, Label: 1
    ID: P1479, Label: 1
    ID: P1504, Label: 2
    ID: P1508, Label: 1
    ID: P1510, Label: 1
    ID: P1515, Label: 0
    ID: P1516, Label: 0
    ID: P1539, Label: 0
    ID: P1540, Label: 0
    ID: P1547, Label: 0
    ID: P1549, Label: 0
    ID: P1558, Label: 0
    ID: P1582, Label: 0
    ID: P1600, Label: 0
    ID: P1602, Label: 1
    ID: P1606, Label: 2
    ID: P1610, Label: 0
    ID: P1617, Label: 2
    ID: P1630, Label: 1
    ID: P1631, Label: 1
    ID: P1678, Label: 0
    ID: P1685, Label: 1
    ID: P1707, Label: 1
    ID: P1718, Label: 0
    ID: P1722, Label: 1
    ID: P1735, Label: 1
  → test 환자 ID 및 라벨:
    ID: P1422, Label: 1
    ID: P1437, Label: 2
    ID: P1447, Label: 1
    ID: P1472, Label: 2
    ID: P1561, Label: 0
    ID: P1603, Label: 0
    ID: P1622, Label: 0
    ID: P1702, Label: 0
    ID: P1726, Label: 1
전체 데이터 index 길이 42
label_stat (train 환자 라벨 목록) 갯수 33
train_data에서 환자 단위로, train과 validation 나누기
기존 train_p_index 33
기존 (train) label_stat 33
train-vali 분할 후! 
train y 의 classes : {0, 1, 2} valid y 의 classes : {0, 1, 2} label_stat 의 classes : {0, 1, 2}
train_p_index_ 22
valid_p_index 11
test_p_index 9
→ train 환자 ID 및 라벨:
   총 개수: 22
   환자ID=P1602, Label=1, 셀개수=16580
   환자ID=P1718, Label=0, 셀개수=9278
   환자ID=P1539, Label=0, 셀개수=11076
   환자ID=P1304, Label=2, 셀개수=19123
   환자ID=P1479, Label=1, 셀개수=19124
   환자ID=P1610, Label=0, 셀개수=13919
   환자ID=P1631, Label=1, 셀개수=13686
   환자ID=P1371, Label=2, 셀개수=16233
   환자ID=P1735, Label=1, 셀개수=12009
   환자ID=P1707, Label=1, 셀개수=9517
   환자ID=P1547, Label=0, 셀개수=8253
   환자ID=P1678, Label=0, 셀개수=10085
   환자ID=P1515, Label=0, 셀개수=14502
   환자ID=P1425, Label=1, 셀개수=15378
   환자ID=P1630, Label=1, 셀개수=17633
   환자ID=P1516, Label=0, 셀개수=9361
   환자ID=P1606, Label=2, 셀개수=8523
   환자ID=P1510, Label=1, 셀개수=10744
   환자ID=P1508, Label=1, 셀개수=20536
   환자ID=P1462, Label=1, 셀개수=21715
   환자ID=P1600, Label=0, 셀개수=14882
   환자ID=P1540, Label=0, 셀개수=11638
→ valid 환자 ID 및 라벨:
   총 개수: 11
   환자ID=P1300, Label=2, 셀개수=17318
   환자ID=P1430, Label=2, 셀개수=11131
   환자ID=P1549, Label=0, 셀개수=11709
   환자ID=P1504, Label=2, 셀개수=8133
   환자ID=P1290, Label=2, 셀개수=8357
   환자ID=P1582, Label=0, 셀개수=18855
   환자ID=P1722, Label=1, 셀개수=21432
   환자ID=P1558, Label=0, 셀개수=10469
   환자ID=P1685, Label=1, 셀개수=10043
   환자ID=P1358, Label=2, 셀개수=23984
   환자ID=P1617, Label=2, 셀개수=17986
→ test 환자 ID 및 라벨:
   총 개수: 9
   환자ID=P1422, Label=1, 셀개수=23315
   환자ID=P1437, Label=2, 셀개수=21695
   환자ID=P1447, Label=1, 셀개수=11151
   환자ID=P1472, Label=2, 셀개수=19513
   환자ID=P1561, Label=0, 셀개수=10016
   환자ID=P1603, Label=0, 셀개수=10638
   환자ID=P1622, Label=0, 셀개수=7210
   환자ID=P1702, Label=0, 셀개수=13550
   환자ID=P1726, Label=1, 셀개수=12389
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Neurons', 'Neurons', 'Neurons', 'Smooth_muscle_cells', 'Neurons', 'Neurons', 'Neurons', 'Neurons', 'Neurons', 'Osteoblasts']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
전체 데이터 길이 592689
전체 cell type 길이 0                     Neurons
1                     Neurons
2                     Neurons
3         Smooth_muscle_cells
4                     Neurons
                 ...         
592684      Endothelial_cells
592685      Endothelial_cells
592686      Endothelial_cells
592687              Platelets
592688      Endothelial_cells
Length: 592689, dtype: string
cell type의 NaN 개수 체크 0
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:14,  6.81it/s]  2%|▏         | 2/100 [00:00<00:13,  7.26it/s]  3%|▎         | 3/100 [00:00<00:13,  7.37it/s]  4%|▍         | 4/100 [00:00<00:12,  7.41it/s]  5%|▌         | 5/100 [00:00<00:12,  7.42it/s]  6%|▌         | 6/100 [00:00<00:12,  7.52it/s]  7%|▋         | 7/100 [00:00<00:12,  7.56it/s]  8%|▊         | 8/100 [00:01<00:12,  7.60it/s]  9%|▉         | 9/100 [00:01<00:12,  7.57it/s] 10%|█         | 10/100 [00:01<00:11,  7.64it/s] 11%|█         | 11/100 [00:01<00:11,  7.72it/s] 12%|█▏        | 12/100 [00:01<00:11,  7.79it/s] 13%|█▎        | 13/100 [00:01<00:11,  7.70it/s] 14%|█▍        | 14/100 [00:01<00:11,  7.53it/s] 15%|█▌        | 15/100 [00:01<00:11,  7.58it/s] 16%|█▌        | 16/100 [00:02<00:11,  7.61it/s] 17%|█▋        | 17/100 [00:02<00:11,  7.53it/s] 18%|█▊        | 18/100 [00:02<00:10,  7.48it/s] 19%|█▉        | 19/100 [00:02<00:10,  7.55it/s] 20%|██        | 20/100 [00:02<00:10,  7.56it/s] 21%|██        | 21/100 [00:02<00:10,  7.49it/s] 22%|██▏       | 22/100 [00:02<00:10,  7.54it/s] 23%|██▎       | 23/100 [00:03<00:10,  7.51it/s] 24%|██▍       | 24/100 [00:03<00:10,  7.46it/s] 25%|██▌       | 25/100 [00:03<00:10,  7.44it/s] 26%|██▌       | 26/100 [00:03<00:09,  7.47it/s] 27%|██▋       | 27/100 [00:03<00:09,  7.39it/s] 28%|██▊       | 28/100 [00:03<00:09,  7.46it/s] 29%|██▉       | 29/100 [00:03<00:09,  7.41it/s] 30%|███       | 30/100 [00:04<00:09,  7.33it/s] 31%|███       | 31/100 [00:04<00:09,  7.32it/s] 32%|███▏      | 32/100 [00:04<00:09,  7.37it/s] 33%|███▎      | 33/100 [00:04<00:09,  7.29it/s] 34%|███▍      | 34/100 [00:04<00:08,  7.40it/s] 35%|███▌      | 35/100 [00:04<00:08,  7.44it/s] 36%|███▌      | 36/100 [00:04<00:08,  7.31it/s] 37%|███▋      | 37/100 [00:04<00:08,  7.29it/s] 38%|███▊      | 38/100 [00:05<00:08,  7.31it/s] 39%|███▉      | 39/100 [00:05<00:08,  7.21it/s] 40%|████      | 40/100 [00:05<00:08,  7.24it/s] 41%|████      | 41/100 [00:05<00:08,  7.26it/s] 42%|████▏     | 42/100 [00:05<00:07,  7.28it/s] 43%|████▎     | 43/100 [00:05<00:07,  7.23it/s] 44%|████▍     | 44/100 [00:05<00:07,  7.19it/s] 45%|████▌     | 45/100 [00:06<00:07,  7.21it/s] 46%|████▌     | 46/100 [00:06<00:07,  7.25it/s] 47%|████▋     | 47/100 [00:06<00:07,  7.24it/s] 48%|████▊     | 48/100 [00:06<00:07,  7.26it/s] 49%|████▉     | 49/100 [00:06<00:06,  7.30it/s] 50%|█████     | 50/100 [00:06<00:06,  7.33it/s] 51%|█████     | 51/100 [00:06<00:06,  7.24it/s] 52%|█████▏    | 52/100 [00:07<00:06,  7.18it/s] 53%|█████▎    | 53/100 [00:07<00:06,  7.05it/s] 54%|█████▍    | 54/100 [00:07<00:06,  7.09it/s] 55%|█████▌    | 55/100 [00:07<00:06,  6.93it/s] 56%|█████▌    | 56/100 [00:07<00:06,  7.12it/s] 57%|█████▋    | 57/100 [00:07<00:06,  7.02it/s] 58%|█████▊    | 58/100 [00:07<00:05,  7.11it/s] 59%|█████▉    | 59/100 [00:08<00:05,  6.93it/s] 60%|██████    | 60/100 [00:08<00:05,  6.94it/s] 61%|██████    | 61/100 [00:08<00:05,  7.00it/s] 62%|██████▏   | 62/100 [00:08<00:05,  6.97it/s] 63%|██████▎   | 63/100 [00:08<00:05,  6.95it/s] 64%|██████▍   | 64/100 [00:08<00:05,  7.01it/s] 65%|██████▌   | 65/100 [00:08<00:05,  6.89it/s] 66%|██████▌   | 66/100 [00:09<00:04,  7.03it/s] 67%|██████▋   | 67/100 [00:09<00:04,  6.94it/s] 68%|██████▊   | 68/100 [00:09<00:04,  6.97it/s] 69%|██████▉   | 69/100 [00:09<00:04,  6.94it/s] 70%|███████   | 70/100 [00:09<00:04,  7.00it/s] 71%|███████   | 71/100 [00:09<00:04,  6.96it/s] 72%|███████▏  | 72/100 [00:09<00:04,  6.81it/s] 73%|███████▎  | 73/100 [00:10<00:03,  6.84it/s] 74%|███████▍  | 74/100 [00:10<00:03,  6.87it/s] 75%|███████▌  | 75/100 [00:10<00:03,  6.85it/s] 76%|███████▌  | 76/100 [00:10<00:03,  6.83it/s] 77%|███████▋  | 77/100 [00:10<00:03,  6.79it/s] 78%|███████▊  | 78/100 [00:10<00:03,  6.89it/s] 79%|███████▉  | 79/100 [00:10<00:03,  6.91it/s] 80%|████████  | 80/100 [00:11<00:02,  6.92it/s] 81%|████████  | 81/100 [00:11<00:02,  6.86it/s] 82%|████████▏ | 82/100 [00:11<00:02,  6.87it/s] 83%|████████▎ | 83/100 [00:11<00:02,  6.84it/s] 84%|████████▍ | 84/100 [00:11<00:02,  6.83it/s] 85%|████████▌ | 85/100 [00:11<00:02,  6.84it/s] 86%|████████▌ | 86/100 [00:11<00:02,  6.73it/s] 87%|████████▋ | 87/100 [00:12<00:01,  6.86it/s] 88%|████████▊ | 88/100 [00:12<00:01,  6.85it/s] 89%|████████▉ | 89/100 [00:12<00:01,  6.93it/s] 90%|█████████ | 90/100 [00:12<00:01,  7.10it/s] 91%|█████████ | 91/100 [00:12<00:01,  6.95it/s] 92%|█████████▏| 92/100 [00:12<00:01,  6.94it/s] 93%|█████████▎| 93/100 [00:12<00:01,  6.70it/s] 94%|█████████▍| 94/100 [00:13<00:00,  6.70it/s] 95%|█████████▌| 95/100 [00:13<00:00,  6.66it/s] 96%|█████████▌| 96/100 [00:13<00:00,  6.64it/s] 97%|█████████▋| 97/100 [00:13<00:00,  6.56it/s] 98%|█████████▊| 98/100 [00:13<00:00,  6.62it/s] 99%|█████████▉| 99/100 [00:13<00:00,  6.72it/s]100%|██████████| 100/100 [00:14<00:00,  6.72it/s]100%|██████████| 100/100 [00:14<00:00,  7.13it/s]
[I 2025-08-28 22:51:22,668] A new study created in memory with name: no-name-855cb0f7-a2af-43cd-989f-d7030183975a
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 3.60 MB
Memory Reserved: 22.00 MB
cuda
Epoch 1, Train Loss 1.028736, Valid_loss 2.569536
Epoch 2, Train Loss 0.981023, Valid_loss 2.205947
Epoch 3, Train Loss 0.918008, Valid_loss 1.875777
Epoch 4, Train Loss 0.920797, Valid_loss 2.013494
Epoch 5, Train Loss 0.858645, Valid_loss 1.840025
Epoch 6, Train Loss 0.928862, Valid_loss 1.844646
Epoch 7, Train Loss 0.828147, Valid_loss 2.219127
Epoch 8, Train Loss 0.858606, Valid_loss 1.969951
Epoch 9, Train Loss 0.805365, Valid_loss 2.269199
Epoch 10, Train Loss 0.821974, Valid_loss 2.125916
Epoch 11, Train Loss 0.828415, Valid_loss 1.802356
Epoch 12, Train Loss 0.815286, Valid_loss 1.898161
Epoch 13, Train Loss 0.814157, Valid_loss 2.188218
Epoch 14, Train Loss 0.822145, Valid_loss 1.874899
Epoch 15, Train Loss 0.802521, Valid_loss 2.032407
Epoch 16, Train Loss 0.810538, Valid_loss 1.951317
Epoch 17, Train Loss 0.814714, Valid_loss 1.913522
Epoch 18, Train Loss 0.809453, Valid_loss 1.952362
Epoch 19, Train Loss 0.809139, Valid_loss 1.979079
Epoch 20, Train Loss 0.809119, Valid_loss 2.013923
Epoch 21, Train Loss 0.806801, Valid_loss 2.037410
Epoch 22, Train Loss 0.807059, Valid_loss 2.026338
Epoch 23, Train Loss 0.813352, Valid_loss 2.140568
Epoch 24, Train Loss 0.807221, Valid_loss 2.018054
Epoch 25, Train Loss 0.808223, Valid_loss 2.048920
Epoch 26, Train Loss 0.952462, Valid_loss 2.147010
Epoch 27, Train Loss 0.842166, Valid_loss 1.975540
Epoch 28, Train Loss 0.815074, Valid_loss 2.001717
Epoch 29, Train Loss 0.813240, Valid_loss 1.975275
Epoch 30, Train Loss 0.807071, Valid_loss 1.977680
Epoch 31, Train Loss 0.829418, Valid_loss 2.063121
Epoch 32, Train Loss 0.869818, Valid_loss 2.051905
Epoch 33, Train Loss 0.811010, Valid_loss 2.117160
Epoch 34, Train Loss 0.808937, Valid_loss 1.998617
Epoch 35, Train Loss 0.809797, Valid_loss 2.021269
Epoch 36, Train Loss 0.806511, Valid_loss 2.006310
Epoch 37, Train Loss 0.806681, Valid_loss 2.011607
Epoch 38, Train Loss 0.807838, Valid_loss 2.057065
Epoch 39, Train Loss 0.808247, Valid_loss 2.037330
Epoch 40, Train Loss 0.807911, Valid_loss 2.036106
Epoch 41, Train Loss 0.805895, Valid_loss 2.029524
Epoch 42, Train Loss 0.805766, Valid_loss 2.034101
Epoch 43, Train Loss 0.804333, Valid_loss 2.056354
Epoch 44, Train Loss 0.806760, Valid_loss 2.027856
Epoch 45, Train Loss 0.810303, Valid_loss 2.112610
Epoch 46, Train Loss 0.896226, Valid_loss 2.572746
Epoch 47, Train Loss 1.062364, Valid_loss 2.106547
Epoch 48, Train Loss 0.814249, Valid_loss 2.017060
Epoch 49, Train Loss 0.805391, Valid_loss 2.027538
Epoch 50, Train Loss 0.806180, Valid_loss 2.031699
Epoch 51, Train Loss 0.805271, Valid_loss 2.034386
Epoch 52, Train Loss 0.803578, Valid_loss 2.033272
Epoch 53, Train Loss 0.804049, Valid_loss 2.025539
Epoch 54, Train Loss 0.805999, Valid_loss 2.041290
Epoch 55, Train Loss 0.804076, Valid_loss 2.043060
[I 2025-08-28 23:20:45,807] Trial 0 finished with value: 1.8023556958545337 and parameters: {'learning_rate': 0.01, 'epochs': 100, 'heads': 2, 'dropout': 0.7, 'weight_decay': 0.001, 'emb_dim': 64, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 1.8023556958545337.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 18.01 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.877904, Valid_loss 1.842615
Epoch 2, Train Loss 0.854041, Valid_loss 2.141745
Epoch 3, Train Loss 0.840465, Valid_loss 1.881536
Epoch 4, Train Loss 0.832068, Valid_loss 1.548430
Epoch 5, Train Loss 0.811796, Valid_loss 1.425997
Epoch 6, Train Loss 0.843231, Valid_loss 1.686233
Epoch 7, Train Loss 0.838974, Valid_loss 1.862198
Epoch 8, Train Loss 0.830908, Valid_loss 1.790966
Epoch 9, Train Loss 0.818265, Valid_loss 1.840252
Epoch 10, Train Loss 0.830420, Valid_loss 1.821894
Epoch 11, Train Loss 0.801048, Valid_loss 2.320203
Epoch 12, Train Loss 0.810631, Valid_loss 2.113407
Epoch 13, Train Loss 0.813069, Valid_loss 1.613566
Epoch 14, Train Loss 0.831025, Valid_loss 2.237854
Epoch 15, Train Loss 0.828279, Valid_loss 1.699343
Epoch 16, Train Loss 0.812894, Valid_loss 1.476158
Epoch 17, Train Loss 0.818068, Valid_loss 1.705648
Epoch 18, Train Loss 0.817865, Valid_loss 1.959272
Epoch 19, Train Loss 0.828582, Valid_loss 1.427503
Epoch 20, Train Loss 0.812991, Valid_loss 1.652589
Epoch 21, Train Loss 0.813567, Valid_loss 1.780381
Epoch 22, Train Loss 0.802354, Valid_loss 1.458315
Epoch 23, Train Loss 0.800610, Valid_loss 1.725273
Epoch 24, Train Loss 0.800552, Valid_loss 1.612253
Epoch 25, Train Loss 0.808128, Valid_loss 1.491785
Epoch 26, Train Loss 0.808471, Valid_loss 1.469335
Epoch 27, Train Loss 0.800875, Valid_loss 1.473361
Epoch 28, Train Loss 0.830609, Valid_loss 1.683606
Epoch 29, Train Loss 0.795006, Valid_loss 1.721960
Epoch 30, Train Loss 0.767312, Valid_loss 2.299410
Epoch 31, Train Loss 0.866957, Valid_loss 2.432905
Epoch 32, Train Loss 0.847988, Valid_loss 1.737930
Epoch 33, Train Loss 0.800932, Valid_loss 1.733390
Epoch 34, Train Loss 0.801218, Valid_loss 1.597226
Epoch 35, Train Loss 0.796702, Valid_loss 1.366971
Epoch 36, Train Loss 0.810722, Valid_loss 1.699988
Epoch 37, Train Loss 0.807161, Valid_loss 1.592920
Epoch 38, Train Loss 0.799911, Valid_loss 1.615333
Epoch 39, Train Loss 0.809708, Valid_loss 1.642252
Epoch 40, Train Loss 0.797122, Valid_loss 1.627686
Epoch 41, Train Loss 0.791469, Valid_loss 1.820069
Epoch 42, Train Loss 0.795262, Valid_loss 1.589510
Epoch 43, Train Loss 0.797347, Valid_loss 1.638324
Epoch 44, Train Loss 0.796123, Valid_loss 1.577861
Epoch 45, Train Loss 0.785448, Valid_loss 1.571583
Epoch 46, Train Loss 0.809619, Valid_loss 1.590065
Epoch 47, Train Loss 0.801830, Valid_loss 1.572934
Epoch 48, Train Loss 0.795915, Valid_loss 1.628856
Epoch 49, Train Loss 0.793049, Valid_loss 1.604597
Epoch 50, Train Loss 0.784409, Valid_loss 1.603990
Epoch 51, Train Loss 0.787259, Valid_loss 1.578869
Epoch 52, Train Loss 0.784359, Valid_loss 1.577496
Epoch 53, Train Loss 0.785630, Valid_loss 1.565225
Epoch 54, Train Loss 0.782236, Valid_loss 1.566628
Epoch 55, Train Loss 0.790409, Valid_loss 1.560688
Epoch 56, Train Loss 0.786406, Valid_loss 1.561070
Epoch 57, Train Loss 0.790193, Valid_loss 1.549732
Epoch 58, Train Loss 0.785289, Valid_loss 1.544907
Epoch 59, Train Loss 0.781406, Valid_loss 1.540959
Epoch 60, Train Loss 0.780603, Valid_loss 1.534118
Epoch 61, Train Loss 0.790091, Valid_loss 1.523988
Epoch 62, Train Loss 0.781351, Valid_loss 1.520209
Epoch 63, Train Loss 0.792219, Valid_loss 1.521339
Epoch 64, Train Loss 0.778505, Valid_loss 1.529403
[I 2025-08-28 23:42:03,897] Trial 1 finished with value: 1.3669712272557346 and parameters: {'learning_rate': 0.01, 'epochs': 100, 'heads': 1, 'dropout': 0.0, 'weight_decay': 0.0001, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 1 with value: 1.3669712272557346.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 16.69 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.916199, Valid_loss 1.787209
Epoch 2, Train Loss 0.827229, Valid_loss 2.014561
Epoch 3, Train Loss 0.853872, Valid_loss 1.874469
Epoch 4, Train Loss 0.809811, Valid_loss 2.106244
Epoch 5, Train Loss 0.824941, Valid_loss 1.910548
Epoch 6, Train Loss 0.833280, Valid_loss 1.812931
Epoch 7, Train Loss 0.818953, Valid_loss 1.844396
Epoch 8, Train Loss 0.826808, Valid_loss 1.733150
Epoch 9, Train Loss 0.818722, Valid_loss 1.832105
Epoch 10, Train Loss 0.819502, Valid_loss 1.813329
Epoch 11, Train Loss 0.812863, Valid_loss 1.859711
Epoch 12, Train Loss 0.802834, Valid_loss 2.076534
Epoch 13, Train Loss 0.817719, Valid_loss 1.906765
Epoch 14, Train Loss 0.811669, Valid_loss 1.895062
Epoch 15, Train Loss 0.806522, Valid_loss 1.927925
Epoch 16, Train Loss 0.807776, Valid_loss 1.933424
Epoch 17, Train Loss 0.811084, Valid_loss 1.939710
Epoch 18, Train Loss 0.811384, Valid_loss 1.948106
Epoch 19, Train Loss 0.806283, Valid_loss 1.999992
Epoch 20, Train Loss 0.808492, Valid_loss 1.963449
Epoch 21, Train Loss 0.806957, Valid_loss 2.001666
Epoch 22, Train Loss 0.805673, Valid_loss 2.006937
Epoch 23, Train Loss 0.806560, Valid_loss 2.016452
Epoch 24, Train Loss 0.805335, Valid_loss 2.029253
Epoch 25, Train Loss 0.808397, Valid_loss 2.073990
Epoch 26, Train Loss 0.807534, Valid_loss 2.047338
Epoch 27, Train Loss 0.805737, Valid_loss 2.044806
Epoch 28, Train Loss 0.804514, Valid_loss 2.045937
Epoch 29, Train Loss 0.806956, Valid_loss 2.048543
Epoch 30, Train Loss 0.804649, Valid_loss 2.034444
Epoch 31, Train Loss 0.806749, Valid_loss 2.041676
Epoch 32, Train Loss 0.808849, Valid_loss 2.043636
Epoch 33, Train Loss 0.807788, Valid_loss 2.050500
Epoch 34, Train Loss 0.806483, Valid_loss 2.119592
Epoch 35, Train Loss 0.809489, Valid_loss 2.036115
Epoch 36, Train Loss 0.806570, Valid_loss 2.066610
Epoch 37, Train Loss 0.808977, Valid_loss 2.033103
Epoch 38, Train Loss 0.806779, Valid_loss 2.067806
Epoch 39, Train Loss 0.807554, Valid_loss 2.033069
Epoch 40, Train Loss 0.806388, Valid_loss 2.038990
Epoch 41, Train Loss 0.805947, Valid_loss 2.063390
Epoch 42, Train Loss 0.809173, Valid_loss 2.055405
Epoch 43, Train Loss 0.806275, Valid_loss 2.043566
Epoch 44, Train Loss 0.806919, Valid_loss 2.063346
Epoch 45, Train Loss 0.806125, Valid_loss 2.060357
Epoch 46, Train Loss 0.805449, Valid_loss 2.057000
Epoch 47, Train Loss 0.806560, Valid_loss 2.030887
Epoch 48, Train Loss 0.804947, Valid_loss 2.046709
Epoch 49, Train Loss 0.806596, Valid_loss 2.040858
Epoch 50, Train Loss 0.806337, Valid_loss 2.046409
Epoch 51, Train Loss 0.804177, Valid_loss 2.050097
Epoch 52, Train Loss 0.806241, Valid_loss 2.050483
[I 2025-08-29 00:08:22,096] Trial 2 finished with value: 1.7331497398289768 and parameters: {'learning_rate': 0.01, 'epochs': 100, 'heads': 2, 'dropout': 0.5, 'weight_decay': 0.001, 'emb_dim': 8, 'augment_num': 100, 'pca': False}. Best is trial 1 with value: 1.3669712272557346.
선택된 trial params: {'learning_rate': 0.01, 'epochs': 100, 'heads': 1, 'dropout': 0.0, 'weight_decay': 0.0001, 'emb_dim': 32, 'augment_num': 100, 'pca': False}
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=9, batch_size=1 -> steps=9
Memory Allocated: 18.01 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.854331, Valid_loss 1.655727
Epoch 2, Train Loss 0.852093, Valid_loss 1.974660
Epoch 3, Train Loss 0.844011, Valid_loss 1.891076
Epoch 4, Train Loss 0.831326, Valid_loss 2.214344
Epoch 5, Train Loss 0.822607, Valid_loss 1.609975
Epoch 6, Train Loss 0.853735, Valid_loss 1.710517
Epoch 7, Train Loss 0.822236, Valid_loss 2.006331
Epoch 8, Train Loss 0.823632, Valid_loss 2.006649
Epoch 9, Train Loss 0.819242, Valid_loss 1.899292
Epoch 10, Train Loss 0.813984, Valid_loss 1.943574
Epoch 11, Train Loss 0.815103, Valid_loss 1.660530
Epoch 12, Train Loss 0.814606, Valid_loss 1.569702
Epoch 13, Train Loss 0.804657, Valid_loss 1.875366
Epoch 14, Train Loss 0.807425, Valid_loss 2.255774
Epoch 15, Train Loss 0.836342, Valid_loss 1.512432
Epoch 16, Train Loss 0.811710, Valid_loss 1.478571
Epoch 17, Train Loss 0.810991, Valid_loss 2.080610
Epoch 18, Train Loss 0.827181, Valid_loss 1.555169
Epoch 19, Train Loss 0.817863, Valid_loss 1.454333
Epoch 20, Train Loss 0.813926, Valid_loss 1.639070
Epoch 21, Train Loss 0.799292, Valid_loss 1.738572
Epoch 22, Train Loss 0.804141, Valid_loss 1.521005
Epoch 23, Train Loss 0.800168, Valid_loss 1.429952
Epoch 24, Train Loss 0.806460, Valid_loss 1.481584
Epoch 25, Train Loss 0.808137, Valid_loss 1.506964
Epoch 26, Train Loss 0.807852, Valid_loss 1.743135
Epoch 27, Train Loss 0.799301, Valid_loss 1.560906
Epoch 28, Train Loss 0.797906, Valid_loss 1.508308
Epoch 29, Train Loss 0.799059, Valid_loss 1.644662
Epoch 30, Train Loss 0.815672, Valid_loss 1.478418
Epoch 31, Train Loss 0.793909, Valid_loss 1.568791
Epoch 32, Train Loss 0.814558, Valid_loss 1.571704
Epoch 33, Train Loss 0.795784, Valid_loss 1.528181
Epoch 34, Train Loss 0.796125, Valid_loss 1.634428
Epoch 35, Train Loss 0.817032, Valid_loss 1.524947
Epoch 36, Train Loss 0.792387, Valid_loss 1.562817
Epoch 37, Train Loss 0.806033, Valid_loss 1.533046
Epoch 38, Train Loss 0.799620, Valid_loss 1.547670
Epoch 39, Train Loss 0.813435, Valid_loss 1.531653
Epoch 40, Train Loss 0.801491, Valid_loss 1.550966
Epoch 41, Train Loss 0.791476, Valid_loss 1.550828
Epoch 42, Train Loss 0.800650, Valid_loss 1.558208
Epoch 43, Train Loss 0.793831, Valid_loss 1.530720
Epoch 44, Train Loss 0.790569, Valid_loss 1.772159
Epoch 45, Train Loss 0.819558, Valid_loss 1.692620
Epoch 46, Train Loss 0.798780, Valid_loss 1.545740
Epoch 47, Train Loss 0.813145, Valid_loss 1.581544
Epoch 48, Train Loss 0.800288, Valid_loss 1.577747
Epoch 49, Train Loss 0.793542, Valid_loss 1.636492
Epoch 50, Train Loss 0.799132, Valid_loss 1.569440
Epoch 51, Train Loss 0.792670, Valid_loss 1.571905
Epoch 52, Train Loss 0.780155, Valid_loss 1.562502
Epoch 53, Train Loss 0.791877, Valid_loss 1.568858
Epoch 54, Train Loss 0.787681, Valid_loss 1.571482
환자ID=P1422 -- true: [[1]] -- pred: tensor([[ 0.1479, -0.0528, -1.0218]], device='cuda:0')
환자ID=P1437 -- true: [[2]] -- pred: tensor([[ 0.1479, -0.0528, -1.0217]], device='cuda:0')
환자ID=P1447 -- true: [[1]] -- pred: tensor([[ 0.1479, -0.0527, -1.0217]], device='cuda:0')
환자ID=P1472 -- true: [[2]] -- pred: tensor([[ 0.1479, -0.0528, -1.0217]], device='cuda:0')
환자ID=P1561 -- true: [[0]] -- pred: tensor([[ 0.1479, -0.0527, -1.0217]], device='cuda:0')
환자ID=P1603 -- true: [[0]] -- pred: tensor([[ 0.1479, -0.0528, -1.0217]], device='cuda:0')
환자ID=P1622 -- true: [[0]] -- pred: tensor([[ 0.1479, -0.0528, -1.0217]], device='cuda:0')
환자ID=P1702 -- true: [[0]] -- pred: tensor([[ 0.1479, -0.0528, -1.0218]], device='cuda:0')
환자ID=P1726 -- true: [[1]] -- pred: tensor([[ 0.1479, -0.0528, -1.0217]], device='cuda:0')
Best performance: Epoch 23, Loss 0.800168, Test ACC 0.444444, Test AUC 0.555556, Test Recall 0.333333, Test Precision 0.148148
Confusion Matrix:
 [[4 0 0]
 [3 0 0]
 [2 0 0]]
✅ Total valid splits used: 1
🔁 Repeat 0, Fold 1
cell type :  TTCTTCCGTTCAACGT-1-0                Astrocyte
CATCCACCATCTAACG-1-0      Smooth_muscle_cells
ACCCAAACAGCTAACT-1-0                  Neurons
AAGGAATCAACTGGTT-1-0     Neuroepithelial_cell
TACCCGTAGCGTGCTC-1-0                Astrocyte
                                 ...         
TTATTGCGTCGGTGTC-1-79       Endothelial_cells
GTCACGGGTTGTATGC-1-79       Endothelial_cells
GTCATGATCTTTCGAT-1-79       Endothelial_cells
GCGATCGTCAGAGTGG-1-79               Platelets
GCCCGAACAGAGAAAG-1-79       Endothelial_cells
Name: singler_annotation, Length: 459330, dtype: string
cell type annotation :  TTCTTCCGTTCAACGT-1-0                Astrocyte
CATCCACCATCTAACG-1-0      Smooth_muscle_cells
ACCCAAACAGCTAACT-1-0                  Neurons
AAGGAATCAACTGGTT-1-0     Neuroepithelial_cell
TACCCGTAGCGTGCTC-1-0                Astrocyte
                                 ...         
TTATTGCGTCGGTGTC-1-79       Endothelial_cells
GTCACGGGTTGTATGC-1-79       Endothelial_cells
GTCATGATCTTTCGAT-1-79       Endothelial_cells
GCGATCGTCAGAGTGG-1-79               Platelets
GCCCGAACAGAGAAAG-1-79       Endothelial_cells
Name: singler_annotation, Length: 459330, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Astrocyte', 'Smooth_muscle_cells', 'Neurons', 'Neuroepithelial_cell', 'Endothelial_cells', 'Osteoblasts', 'Platelets', 'Hepatocytes', 'Embryonic_stem_cells', 'MEP', 'Erythroblast', 'Fibroblasts', 'iPS_cells', 'MSC', 'Macrophage', 'Gametocytes', 'Chondrocytes', 'NK_cell', 'Neutrophils', 'HSC_CD34+', 'Monocyte', 'Tissue_stem_cells', 'DC', 'HSC_-G-CSF', 'T_cells', 'Epithelial_cells', 'Unknown', 'Pre-B_cell_CD34-', 'GMP', 'B_cell', 'Pro-Myelocyte', 'Keratinocytes', 'Myelocyte', 'BM', 'CMP', 'BM & Prog.', 'Pro-B_cell_CD34+']
라벨별 그룹 개수 {2: 8, 1: 12, 0: 13}
cell type :  CAACCAAAGACCCGCT-1-2                 Neurons
ACGGTTACATCGAACT-1-2                 Neurons
ACCCTCATCCGGCAGT-1-2                 Neurons
AACACACCACGGTCTG-1-2     Smooth_muscle_cells
AAACGCTTCACCGGGT-1-2                 Neurons
                                ...         
TCATTGTCATACAGGG-1-70      Endothelial_cells
TCGTGCTTCTTGCGCT-1-70      Endothelial_cells
GACCAATAGGTCGTCC-1-70      Endothelial_cells
GAAGGGTTCAGGTAAA-1-70      Endothelial_cells
GGGTAGAAGTAGTCTC-1-70      Endothelial_cells
Name: singler_annotation, Length: 133359, dtype: string
cell type annotation :  CAACCAAAGACCCGCT-1-2                 Neurons
ACGGTTACATCGAACT-1-2                 Neurons
ACCCTCATCCGGCAGT-1-2                 Neurons
AACACACCACGGTCTG-1-2     Smooth_muscle_cells
AAACGCTTCACCGGGT-1-2                 Neurons
                                ...         
TCATTGTCATACAGGG-1-70      Endothelial_cells
TCGTGCTTCTTGCGCT-1-70      Endothelial_cells
GACCAATAGGTCGTCC-1-70      Endothelial_cells
GAAGGGTTCAGGTAAA-1-70      Endothelial_cells
GGGTAGAAGTAGTCTC-1-70      Endothelial_cells
Name: singler_annotation, Length: 133359, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Neurons', 'Smooth_muscle_cells', 'Osteoblasts', 'Endothelial_cells', 'MSC', 'Astrocyte', 'Fibroblasts', 'Erythroblast', 'Neuroepithelial_cell', 'Platelets', 'iPS_cells', 'NK_cell', 'Embryonic_stem_cells', 'MEP', 'Gametocytes', 'Hepatocytes', 'Tissue_stem_cells', 'Monocyte', 'Macrophage', 'Neutrophils', 'Chondrocytes', 'HSC_-G-CSF', 'BM & Prog.', 'DC', 'Keratinocytes', 'T_cells', 'HSC_CD34+', 'CMP', 'B_cell', 'Myelocyte', 'Epithelial_cells', 'Unknown', 'Pro-Myelocyte', 'Pre-B_cell_CD34-', 'BM', 'GMP', 'Pro-B_cell_CD34+']
라벨별 그룹 개수 {2: 3, 1: 3, 0: 3}
🔍 Split #2
  → train_p_index 환자 수 (환자 단위로 묶인 index list): 33
  → test_p_index 환자 수  (환자 단위로 묶인 index list): 9
  → train 환자 ID: ['P1290', 'P1300', 'P1358', 'P1422', 'P1425', 'P1430', 'P1437', 'P1447', 'P1472', 'P1479', 'P1508', 'P1510', 'P1516', 'P1539', 'P1540', 'P1547', 'P1561', 'P1582', 'P1600', 'P1602', 'P1603', 'P1606', 'P1610', 'P1617', 'P1622', 'P1630', 'P1631', 'P1678', 'P1702', 'P1707', 'P1718', 'P1726', 'P1735']
  → test  환자 ID: ['P1304', 'P1371', 'P1462', 'P1504', 'P1515', 'P1549', 'P1558', 'P1685', 'P1722']
  → train 환자 ID 및 라벨:
    ID: P1290, Label: 2
    ID: P1300, Label: 2
    ID: P1358, Label: 2
    ID: P1422, Label: 1
    ID: P1425, Label: 1
    ID: P1430, Label: 2
    ID: P1437, Label: 2
    ID: P1447, Label: 1
    ID: P1472, Label: 2
    ID: P1479, Label: 1
    ID: P1508, Label: 1
    ID: P1510, Label: 1
    ID: P1516, Label: 0
    ID: P1539, Label: 0
    ID: P1540, Label: 0
    ID: P1547, Label: 0
    ID: P1561, Label: 0
    ID: P1582, Label: 0
    ID: P1600, Label: 0
    ID: P1602, Label: 1
    ID: P1603, Label: 0
    ID: P1606, Label: 2
    ID: P1610, Label: 0
    ID: P1617, Label: 2
    ID: P1622, Label: 0
    ID: P1630, Label: 1
    ID: P1631, Label: 1
    ID: P1678, Label: 0
    ID: P1702, Label: 0
    ID: P1707, Label: 1
    ID: P1718, Label: 0
    ID: P1726, Label: 1
    ID: P1735, Label: 1
  → test 환자 ID 및 라벨:
    ID: P1304, Label: 2
    ID: P1371, Label: 2
    ID: P1462, Label: 1
    ID: P1504, Label: 2
    ID: P1515, Label: 0
    ID: P1549, Label: 0
    ID: P1558, Label: 0
    ID: P1685, Label: 1
    ID: P1722, Label: 1
전체 데이터 index 길이 42
label_stat (train 환자 라벨 목록) 갯수 33
train_data에서 환자 단위로, train과 validation 나누기
기존 train_p_index 33
기존 (train) label_stat 33
train-vali 분할 후! 
train y 의 classes : {0, 1, 2} valid y 의 classes : {0, 1, 2} label_stat 의 classes : {0, 1, 2}
train_p_index_ 22
valid_p_index 11
test_p_index 9
→ train 환자 ID 및 라벨:
   총 개수: 22
   환자ID=P1606, Label=2, 셀개수=8523
   환자ID=P1718, Label=0, 셀개수=9278
   환자ID=P1540, Label=0, 셀개수=11638
   환자ID=P1358, Label=2, 셀개수=23984
   환자ID=P1472, Label=2, 셀개수=19513
   환자ID=P1617, Label=2, 셀개수=17986
   환자ID=P1631, Label=1, 셀개수=13686
   환자ID=P1425, Label=1, 셀개수=15378
   환자ID=P1735, Label=1, 셀개수=12009
   환자ID=P1707, Label=1, 셀개수=9517
   환자ID=P1561, Label=0, 셀개수=10016
   환자ID=P1678, Label=0, 셀개수=10085
   환자ID=P1516, Label=0, 셀개수=9361
   환자ID=P1430, Label=2, 셀개수=11131
   환자ID=P1630, Label=1, 셀개수=17633
   환자ID=P1539, Label=0, 셀개수=11076
   환자ID=P1610, Label=0, 셀개수=13919
   환자ID=P1510, Label=1, 셀개수=10744
   환자ID=P1508, Label=1, 셀개수=20536
   환자ID=P1447, Label=1, 셀개수=11151
   환자ID=P1603, Label=0, 셀개수=10638
   환자ID=P1547, Label=0, 셀개수=8253
→ valid 환자 ID 및 라벨:
   총 개수: 11
   환자ID=P1300, Label=2, 셀개수=17318
   환자ID=P1437, Label=2, 셀개수=21695
   환자ID=P1582, Label=0, 셀개수=18855
   환자ID=P1479, Label=1, 셀개수=19124
   환자ID=P1290, Label=2, 셀개수=8357
   환자ID=P1602, Label=1, 셀개수=16580
   환자ID=P1726, Label=1, 셀개수=12389
   환자ID=P1600, Label=0, 셀개수=14882
   환자ID=P1702, Label=0, 셀개수=13550
   환자ID=P1422, Label=1, 셀개수=23315
   환자ID=P1622, Label=0, 셀개수=7210
→ test 환자 ID 및 라벨:
   총 개수: 9
   환자ID=P1304, Label=2, 셀개수=19123
   환자ID=P1371, Label=2, 셀개수=16233
   환자ID=P1462, Label=1, 셀개수=21715
   환자ID=P1504, Label=2, 셀개수=8133
   환자ID=P1515, Label=0, 셀개수=14502
   환자ID=P1549, Label=0, 셀개수=11709
   환자ID=P1558, Label=0, 셀개수=10469
   환자ID=P1685, Label=1, 셀개수=10043
   환자ID=P1722, Label=1, 셀개수=21432
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Astrocyte', 'Smooth_muscle_cells', 'Neurons', 'Neuroepithelial_cell', 'Astrocyte', 'Endothelial_cells', 'Osteoblasts', 'Platelets', 'Neurons', 'Hepatocytes']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
전체 데이터 길이 592689
전체 cell type 길이 0                    Astrocyte
1          Smooth_muscle_cells
2                      Neurons
3         Neuroepithelial_cell
4                    Astrocyte
                  ...         
592684       Endothelial_cells
592685       Endothelial_cells
592686       Endothelial_cells
592687       Endothelial_cells
592688       Endothelial_cells
Length: 592689, dtype: string
cell type의 NaN 개수 체크 0
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:13,  7.20it/s]  2%|▏         | 2/100 [00:00<00:13,  7.36it/s]  3%|▎         | 3/100 [00:00<00:12,  7.64it/s]  4%|▍         | 4/100 [00:00<00:12,  7.42it/s]  5%|▌         | 5/100 [00:00<00:12,  7.47it/s]  6%|▌         | 6/100 [00:00<00:12,  7.49it/s]  7%|▋         | 7/100 [00:00<00:12,  7.43it/s]  8%|▊         | 8/100 [00:01<00:12,  7.43it/s]  9%|▉         | 9/100 [00:01<00:12,  7.39it/s] 10%|█         | 10/100 [00:01<00:11,  7.64it/s] 11%|█         | 11/100 [00:01<00:11,  7.68it/s] 12%|█▏        | 12/100 [00:01<00:11,  7.54it/s] 13%|█▎        | 13/100 [00:01<00:11,  7.44it/s] 14%|█▍        | 14/100 [00:01<00:11,  7.45it/s] 15%|█▌        | 15/100 [00:02<00:11,  7.54it/s] 16%|█▌        | 16/100 [00:02<00:11,  7.45it/s] 17%|█▋        | 17/100 [00:02<00:11,  7.46it/s] 18%|█▊        | 18/100 [00:02<00:11,  7.40it/s] 19%|█▉        | 19/100 [00:02<00:10,  7.55it/s] 20%|██        | 20/100 [00:02<00:10,  7.60it/s] 21%|██        | 21/100 [00:02<00:10,  7.65it/s] 22%|██▏       | 22/100 [00:02<00:10,  7.64it/s] 23%|██▎       | 23/100 [00:03<00:10,  7.53it/s] 24%|██▍       | 24/100 [00:03<00:10,  7.41it/s] 25%|██▌       | 25/100 [00:03<00:10,  7.22it/s] 26%|██▌       | 26/100 [00:03<00:10,  7.22it/s] 27%|██▋       | 27/100 [00:03<00:10,  7.22it/s] 28%|██▊       | 28/100 [00:03<00:09,  7.25it/s] 29%|██▉       | 29/100 [00:03<00:09,  7.23it/s] 30%|███       | 30/100 [00:04<00:09,  7.13it/s] 31%|███       | 31/100 [00:04<00:09,  7.08it/s] 32%|███▏      | 32/100 [00:04<00:09,  7.12it/s] 33%|███▎      | 33/100 [00:04<00:09,  7.13it/s] 34%|███▍      | 34/100 [00:04<00:09,  7.18it/s] 35%|███▌      | 35/100 [00:04<00:09,  7.17it/s] 36%|███▌      | 36/100 [00:04<00:08,  7.19it/s] 37%|███▋      | 37/100 [00:05<00:08,  7.25it/s] 38%|███▊      | 38/100 [00:05<00:08,  7.18it/s] 39%|███▉      | 39/100 [00:05<00:08,  7.11it/s] 40%|████      | 40/100 [00:05<00:08,  7.18it/s] 41%|████      | 41/100 [00:05<00:08,  7.26it/s] 42%|████▏     | 42/100 [00:05<00:08,  7.18it/s] 43%|████▎     | 43/100 [00:05<00:07,  7.22it/s] 44%|████▍     | 44/100 [00:06<00:07,  7.11it/s] 45%|████▌     | 45/100 [00:06<00:07,  7.08it/s] 46%|████▌     | 46/100 [00:06<00:07,  7.24it/s] 47%|████▋     | 47/100 [00:06<00:07,  7.16it/s] 48%|████▊     | 48/100 [00:06<00:07,  7.07it/s] 49%|████▉     | 49/100 [00:06<00:07,  7.04it/s] 50%|█████     | 50/100 [00:06<00:06,  7.18it/s] 51%|█████     | 51/100 [00:06<00:06,  7.08it/s] 52%|█████▏    | 52/100 [00:07<00:06,  7.05it/s] 53%|█████▎    | 53/100 [00:07<00:06,  6.94it/s] 54%|█████▍    | 54/100 [00:07<00:06,  6.98it/s] 55%|█████▌    | 55/100 [00:07<00:06,  7.00it/s] 56%|█████▌    | 56/100 [00:07<00:06,  6.99it/s] 57%|█████▋    | 57/100 [00:07<00:06,  7.00it/s] 58%|█████▊    | 58/100 [00:07<00:05,  7.13it/s] 59%|█████▉    | 59/100 [00:08<00:05,  7.13it/s] 60%|██████    | 60/100 [00:08<00:05,  7.05it/s] 61%|██████    | 61/100 [00:08<00:05,  6.96it/s] 62%|██████▏   | 62/100 [00:08<00:05,  6.92it/s] 63%|██████▎   | 63/100 [00:08<00:05,  6.95it/s] 64%|██████▍   | 64/100 [00:08<00:05,  6.95it/s] 65%|██████▌   | 65/100 [00:08<00:05,  6.92it/s] 66%|██████▌   | 66/100 [00:09<00:04,  6.91it/s] 67%|██████▋   | 67/100 [00:09<00:04,  6.86it/s] 68%|██████▊   | 68/100 [00:09<00:04,  6.87it/s] 69%|██████▉   | 69/100 [00:09<00:04,  6.80it/s] 70%|███████   | 70/100 [00:09<00:04,  6.82it/s] 71%|███████   | 71/100 [00:09<00:04,  6.84it/s] 72%|███████▏  | 72/100 [00:10<00:04,  6.71it/s] 73%|███████▎  | 73/100 [00:10<00:04,  6.75it/s] 74%|███████▍  | 74/100 [00:10<00:03,  6.70it/s] 75%|███████▌  | 75/100 [00:10<00:03,  6.85it/s] 76%|███████▌  | 76/100 [00:10<00:03,  6.73it/s] 77%|███████▋  | 77/100 [00:10<00:03,  6.80it/s] 78%|███████▊  | 78/100 [00:10<00:03,  6.85it/s] 79%|███████▉  | 79/100 [00:11<00:03,  6.89it/s] 80%|████████  | 80/100 [00:11<00:02,  6.82it/s] 81%|████████  | 81/100 [00:11<00:02,  6.76it/s] 82%|████████▏ | 82/100 [00:11<00:02,  6.74it/s] 83%|████████▎ | 83/100 [00:11<00:02,  6.67it/s] 84%|████████▍ | 84/100 [00:11<00:02,  6.78it/s] 85%|████████▌ | 85/100 [00:11<00:02,  6.96it/s] 86%|████████▌ | 86/100 [00:12<00:02,  6.74it/s] 87%|████████▋ | 87/100 [00:12<00:01,  6.63it/s] 88%|████████▊ | 88/100 [00:12<00:01,  6.80it/s] 89%|████████▉ | 89/100 [00:12<00:01,  6.60it/s] 90%|█████████ | 90/100 [00:12<00:01,  6.64it/s] 91%|█████████ | 91/100 [00:12<00:01,  6.75it/s] 92%|█████████▏| 92/100 [00:12<00:01,  6.76it/s] 93%|█████████▎| 93/100 [00:13<00:01,  6.57it/s] 94%|█████████▍| 94/100 [00:13<00:00,  6.51it/s] 95%|█████████▌| 95/100 [00:13<00:00,  6.42it/s] 96%|█████████▌| 96/100 [00:13<00:00,  6.42it/s] 97%|█████████▋| 97/100 [00:13<00:00,  6.47it/s] 98%|█████████▊| 98/100 [00:13<00:00,  6.62it/s] 99%|█████████▉| 99/100 [00:14<00:00,  6.54it/s]100%|██████████| 100/100 [00:14<00:00,  6.63it/s]100%|██████████| 100/100 [00:14<00:00,  7.03it/s]
[I 2025-08-29 00:27:10,249] A new study created in memory with name: no-name-18781fa9-16e5-489a-8ec3-a33954a411e1
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 19.85 MB
Memory Reserved: 42.00 MB
cuda
CUDA OOM 발생 — 단계적 백오프 시작.
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 17906.54 MB
Memory Reserved: 17924.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 349.96 MB
Memory Reserved: 388.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 17906.25 MB
Memory Reserved: 17932.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 350.37 MB
Memory Reserved: 388.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[I 2025-08-29 00:27:11,654] Trial 0 pruned. Pruned due to OOM after backoff
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 17906.81 MB
Memory Reserved: 17932.00 MB
cuda
Epoch 1, Train Loss 1.147084, Valid_loss 1.245056
Epoch 2, Train Loss 1.027231, Valid_loss 1.207889
Epoch 3, Train Loss 0.938490, Valid_loss 1.305902
Epoch 4, Train Loss 0.978570, Valid_loss 1.147927
Epoch 5, Train Loss 0.955695, Valid_loss 1.147874
Epoch 6, Train Loss 0.833044, Valid_loss 0.772004
Epoch 7, Train Loss 0.987798, Valid_loss 1.193564
Epoch 8, Train Loss 0.961340, Valid_loss 1.470932
Epoch 9, Train Loss 0.976630, Valid_loss 1.108209
Epoch 10, Train Loss 0.972697, Valid_loss 1.074670
Epoch 11, Train Loss 0.896386, Valid_loss 0.842068
Epoch 12, Train Loss 0.743490, Valid_loss 0.820937
Epoch 13, Train Loss 0.752667, Valid_loss 0.798302
Epoch 14, Train Loss 0.660993, Valid_loss 0.799588
Epoch 15, Train Loss 0.602231, Valid_loss 0.841819
Epoch 16, Train Loss 0.796979, Valid_loss 0.666609
Epoch 17, Train Loss 0.679023, Valid_loss 0.599785
Epoch 18, Train Loss 0.611089, Valid_loss 0.695500
Epoch 19, Train Loss 0.590156, Valid_loss 0.666647
Epoch 20, Train Loss 0.667803, Valid_loss 0.611716
Epoch 21, Train Loss 0.666329, Valid_loss 0.596316
Epoch 22, Train Loss 0.544612, Valid_loss 1.440926
Epoch 23, Train Loss 0.666632, Valid_loss 0.594663
Epoch 24, Train Loss 0.575234, Valid_loss 0.598892
Epoch 25, Train Loss 0.519888, Valid_loss 0.838335
Epoch 26, Train Loss 0.563636, Valid_loss 0.924204
Epoch 27, Train Loss 0.543427, Valid_loss 0.826049
Epoch 28, Train Loss 0.517178, Valid_loss 0.565500
Epoch 29, Train Loss 0.516713, Valid_loss 0.769444
Epoch 30, Train Loss 0.552310, Valid_loss 1.021142
Epoch 31, Train Loss 0.588506, Valid_loss 0.553926
Epoch 32, Train Loss 0.513033, Valid_loss 0.913114
Epoch 33, Train Loss 0.593479, Valid_loss 1.007405
Epoch 34, Train Loss 0.523726, Valid_loss 0.758700
Epoch 35, Train Loss 0.559547, Valid_loss 0.535583
Epoch 36, Train Loss 0.541597, Valid_loss 0.855925
Epoch 37, Train Loss 0.504114, Valid_loss 0.567668
Epoch 38, Train Loss 0.455951, Valid_loss 0.766141
Epoch 39, Train Loss 0.798096, Valid_loss 0.538656
Epoch 40, Train Loss 0.573806, Valid_loss 0.755397
Epoch 41, Train Loss 0.463846, Valid_loss 0.595820
Epoch 42, Train Loss 0.501840, Valid_loss 0.527840
Epoch 43, Train Loss 0.481097, Valid_loss 0.540474
Epoch 44, Train Loss 0.549925, Valid_loss 0.531127
Epoch 45, Train Loss 0.522836, Valid_loss 0.588167
Epoch 46, Train Loss 0.508695, Valid_loss 1.065219
Epoch 47, Train Loss 0.512931, Valid_loss 0.522569
Epoch 48, Train Loss 0.621261, Valid_loss 0.914305
Epoch 49, Train Loss 0.517882, Valid_loss 0.882369
Epoch 50, Train Loss 0.464889, Valid_loss 0.745415
Epoch 51, Train Loss 0.576102, Valid_loss 0.523880
Epoch 52, Train Loss 0.433491, Valid_loss 0.514091
Epoch 53, Train Loss 0.418142, Valid_loss 0.503635
Epoch 54, Train Loss 0.447550, Valid_loss 0.505657
Epoch 55, Train Loss 0.470057, Valid_loss 0.510054
[I 2025-08-29 00:59:32,647] Trial 1 finished with value: 0.5036352458833293 and parameters: {'learning_rate': 0.001, 'epochs': 100, 'heads': 2, 'dropout': 0.7, 'weight_decay': 0.01, 'emb_dim': 64, 'augment_num': 100, 'pca': False}. Best is trial 1 with value: 0.5036352458833293.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 19.85 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 1.129831, Valid_loss 1.239279
Epoch 2, Train Loss 1.036467, Valid_loss 1.143164
Epoch 3, Train Loss 0.922925, Valid_loss 1.145573
Epoch 4, Train Loss 0.912350, Valid_loss 1.138956
Epoch 5, Train Loss 0.754704, Valid_loss 1.015215
Epoch 6, Train Loss 0.699523, Valid_loss 0.840511
Epoch 7, Train Loss 0.645002, Valid_loss 0.774762
Epoch 8, Train Loss 0.564092, Valid_loss 0.632161
Epoch 9, Train Loss 0.703350, Valid_loss 0.691188
Epoch 10, Train Loss 0.592197, Valid_loss 0.674785
Epoch 11, Train Loss 0.625269, Valid_loss 0.746423
Epoch 12, Train Loss 0.538432, Valid_loss 0.647097
Epoch 13, Train Loss 0.581909, Valid_loss 0.843839
Epoch 14, Train Loss 0.527494, Valid_loss 0.775387
Epoch 15, Train Loss 0.517878, Valid_loss 0.559897
Epoch 16, Train Loss 0.527843, Valid_loss 0.670019
Epoch 17, Train Loss 0.527438, Valid_loss 0.708232
Epoch 18, Train Loss 0.426326, Valid_loss 0.593107
Epoch 19, Train Loss 0.459107, Valid_loss 0.948086
Epoch 20, Train Loss 0.456707, Valid_loss 0.597757
Epoch 21, Train Loss 0.409949, Valid_loss 0.593533
Epoch 22, Train Loss 0.511638, Valid_loss 0.502160
Epoch 23, Train Loss 0.466421, Valid_loss 0.788467
Epoch 24, Train Loss 0.460728, Valid_loss 0.643205
Epoch 25, Train Loss 0.468114, Valid_loss 0.667510
Epoch 26, Train Loss 0.392145, Valid_loss 0.507631
Epoch 27, Train Loss 0.446364, Valid_loss 0.639045
Epoch 28, Train Loss 0.369549, Valid_loss 0.707318
Epoch 29, Train Loss 0.355953, Valid_loss 0.625054
Epoch 30, Train Loss 0.384125, Valid_loss 0.463302
Epoch 31, Train Loss 0.321238, Valid_loss 0.462778
Epoch 32, Train Loss 0.399480, Valid_loss 0.452834
Epoch 33, Train Loss 0.366366, Valid_loss 0.508822
Epoch 34, Train Loss 0.449058, Valid_loss 0.802216
Epoch 35, Train Loss 0.331745, Valid_loss 0.520219
Epoch 36, Train Loss 0.291716, Valid_loss 0.568272
Epoch 37, Train Loss 0.302639, Valid_loss 0.411194
Epoch 38, Train Loss 0.296224, Valid_loss 1.411663
Epoch 39, Train Loss 0.335604, Valid_loss 0.460063
Epoch 40, Train Loss 0.354183, Valid_loss 0.539953
Epoch 41, Train Loss 0.319127, Valid_loss 0.705313
Epoch 42, Train Loss 0.308560, Valid_loss 0.418568
Epoch 43, Train Loss 0.320016, Valid_loss 0.381779
Epoch 44, Train Loss 0.259118, Valid_loss 0.443804
Epoch 45, Train Loss 0.348760, Valid_loss 0.563124
Epoch 46, Train Loss 0.304378, Valid_loss 0.717297
Epoch 47, Train Loss 0.272963, Valid_loss 0.621416
Epoch 48, Train Loss 0.343787, Valid_loss 0.299894
Epoch 49, Train Loss 0.337185, Valid_loss 0.470243
Epoch 50, Train Loss 0.271726, Valid_loss 0.299781
Epoch 51, Train Loss 0.242060, Valid_loss 0.488280
Epoch 52, Train Loss 0.235302, Valid_loss 0.357852
Epoch 53, Train Loss 0.224046, Valid_loss 0.521571
Epoch 54, Train Loss 0.271735, Valid_loss 0.341517
Epoch 55, Train Loss 0.206207, Valid_loss 0.544816
Epoch 56, Train Loss 0.261222, Valid_loss 0.573955
[I 2025-08-29 01:32:27,923] Trial 2 finished with value: 0.2997808851809664 and parameters: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 2, 'dropout': 0.7, 'weight_decay': 0.0001, 'emb_dim': 64, 'augment_num': 100, 'pca': False}. Best is trial 2 with value: 0.2997808851809664.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 19.85 MB
Memory Reserved: 42.00 MB
cuda
CUDA OOM 발생 — 단계적 백오프 시작.
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 17906.54 MB
Memory Reserved: 17924.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 349.96 MB
Memory Reserved: 388.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 17906.25 MB
Memory Reserved: 17932.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 350.37 MB
Memory Reserved: 388.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[I 2025-08-29 01:32:29,662] Trial 3 pruned. Pruned due to OOM after backoff
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 17904.00 MB
Memory Reserved: 17934.00 MB
cuda
CUDA OOM 발생 — 단계적 백오프 시작.
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 4711.81 MB
Memory Reserved: 4750.00 MB
cuda
Epoch 1, Train Loss 1.084297, Valid_loss 1.208286
Epoch 2, Train Loss 0.974964, Valid_loss 1.274628
Epoch 3, Train Loss 0.978681, Valid_loss 1.116633
Epoch 4, Train Loss 0.973887, Valid_loss 1.115212
Epoch 5, Train Loss 0.990101, Valid_loss 1.194380
Epoch 6, Train Loss 0.976042, Valid_loss 1.125106
Epoch 7, Train Loss 0.958534, Valid_loss 1.239605
Epoch 8, Train Loss 0.963545, Valid_loss 1.291956
Epoch 9, Train Loss 0.949195, Valid_loss 1.142132
Epoch 10, Train Loss 0.973293, Valid_loss 1.193564
Epoch 11, Train Loss 0.952335, Valid_loss 1.201464
Epoch 12, Train Loss 0.961191, Valid_loss 1.146293
Epoch 13, Train Loss 0.947068, Valid_loss 1.177267
Epoch 14, Train Loss 0.950548, Valid_loss 1.145119
Epoch 15, Train Loss 0.957867, Valid_loss 1.157123
Epoch 16, Train Loss 0.956197, Valid_loss 1.175056
Epoch 17, Train Loss 0.950084, Valid_loss 1.205725
Epoch 18, Train Loss 0.944658, Valid_loss 1.310429
Epoch 19, Train Loss 0.949543, Valid_loss 1.172950
Epoch 20, Train Loss 0.945243, Valid_loss 1.179272
Epoch 21, Train Loss 0.958620, Valid_loss 1.180658
Epoch 22, Train Loss 0.951523, Valid_loss 1.195419
Epoch 23, Train Loss 0.947106, Valid_loss 1.200097
Epoch 24, Train Loss 0.948114, Valid_loss 1.206561
Epoch 25, Train Loss 0.949870, Valid_loss 1.205277
Epoch 26, Train Loss 0.946756, Valid_loss 1.202043
Epoch 27, Train Loss 0.946896, Valid_loss 1.206888
Epoch 28, Train Loss 0.945604, Valid_loss 1.213228
Epoch 29, Train Loss 0.949112, Valid_loss 1.211339
Epoch 30, Train Loss 0.946029, Valid_loss 1.217022
Epoch 31, Train Loss 0.946383, Valid_loss 1.206145
Epoch 32, Train Loss 0.949993, Valid_loss 1.207149
Epoch 33, Train Loss 0.947079, Valid_loss 1.208530
Epoch 34, Train Loss 0.946646, Valid_loss 1.214967
Epoch 35, Train Loss 0.946166, Valid_loss 1.212239
Epoch 36, Train Loss 0.946892, Valid_loss 1.222158
Epoch 37, Train Loss 0.955170, Valid_loss 1.204385
Epoch 38, Train Loss 0.949009, Valid_loss 1.206790
Epoch 39, Train Loss 0.950143, Valid_loss 1.207203
Epoch 40, Train Loss 0.948808, Valid_loss 1.216558
Epoch 41, Train Loss 0.945721, Valid_loss 1.211984
Epoch 42, Train Loss 0.949088, Valid_loss 1.215184
Epoch 43, Train Loss 0.946776, Valid_loss 1.216575
Epoch 44, Train Loss 0.948453, Valid_loss 1.214451
Epoch 45, Train Loss 0.948413, Valid_loss 1.215686
Epoch 46, Train Loss 0.949730, Valid_loss 1.210978
Epoch 47, Train Loss 0.949240, Valid_loss 1.210219
Epoch 48, Train Loss 0.946954, Valid_loss 1.216739
Epoch 49, Train Loss 0.950088, Valid_loss 1.217198
Epoch 50, Train Loss 0.946518, Valid_loss 1.220761
Epoch 51, Train Loss 0.945546, Valid_loss 1.217203
Epoch 52, Train Loss 0.944403, Valid_loss 1.214428
Epoch 53, Train Loss 0.945610, Valid_loss 1.215106
Epoch 54, Train Loss 0.946567, Valid_loss 1.216333
[I 2025-08-29 02:16:12,105] Trial 4 finished with value: 1.1152121099558743 and parameters: {'learning_rate': 0.01, 'epochs': 100, 'heads': 2, 'dropout': 0.3, 'weight_decay': 0.001, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 2 with value: 0.2997808851809664.
선택된 trial params: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 2, 'dropout': 0.7, 'weight_decay': 0.0001, 'emb_dim': 64, 'augment_num': 100, 'pca': False}
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=9, batch_size=1 -> steps=9
Memory Allocated: 4713.65 MB
Memory Reserved: 4750.00 MB
cuda
Epoch 1, Train Loss 1.082589, Valid_loss 1.089459
Epoch 2, Train Loss 0.982311, Valid_loss 1.064459
Epoch 3, Train Loss 0.836450, Valid_loss 1.096890
Epoch 4, Train Loss 0.715382, Valid_loss 0.936350
Epoch 5, Train Loss 0.731350, Valid_loss 1.024156
Epoch 6, Train Loss 0.661340, Valid_loss 0.763891
Epoch 7, Train Loss 0.663323, Valid_loss 0.663697
Epoch 8, Train Loss 0.629920, Valid_loss 0.606818
Epoch 9, Train Loss 0.649576, Valid_loss 0.608632
Epoch 10, Train Loss 0.571272, Valid_loss 0.596022
Epoch 11, Train Loss 0.516568, Valid_loss 0.559894
Epoch 12, Train Loss 0.557411, Valid_loss 0.618623
Epoch 13, Train Loss 0.565685, Valid_loss 0.937100
Epoch 14, Train Loss 0.518671, Valid_loss 0.532077
Epoch 15, Train Loss 0.508019, Valid_loss 0.747195
Epoch 16, Train Loss 0.458085, Valid_loss 0.522892
Epoch 17, Train Loss 0.492948, Valid_loss 0.494157
Epoch 18, Train Loss 0.438271, Valid_loss 0.610391
Epoch 19, Train Loss 0.441691, Valid_loss 0.464598
Epoch 20, Train Loss 0.406951, Valid_loss 0.464469
Epoch 21, Train Loss 0.466747, Valid_loss 0.498046
Epoch 22, Train Loss 0.390182, Valid_loss 0.748363
Epoch 23, Train Loss 0.466763, Valid_loss 0.769924
Epoch 24, Train Loss 0.416742, Valid_loss 0.723950
Epoch 25, Train Loss 0.423961, Valid_loss 0.412249
Epoch 26, Train Loss 0.383038, Valid_loss 0.412320
Epoch 27, Train Loss 0.372629, Valid_loss 0.472024
Epoch 28, Train Loss 0.420732, Valid_loss 0.406868
Epoch 29, Train Loss 0.369157, Valid_loss 0.676999
Epoch 30, Train Loss 0.361898, Valid_loss 0.685934
Epoch 31, Train Loss 0.366299, Valid_loss 0.461788
Epoch 32, Train Loss 0.399395, Valid_loss 0.753011
Epoch 33, Train Loss 0.378444, Valid_loss 0.610457
Epoch 34, Train Loss 0.405097, Valid_loss 0.600080
Epoch 35, Train Loss 0.328508, Valid_loss 0.667307
Epoch 36, Train Loss 0.327935, Valid_loss 0.549392
Epoch 37, Train Loss 0.335256, Valid_loss 0.408543
Epoch 38, Train Loss 0.388472, Valid_loss 0.316050
Epoch 39, Train Loss 0.307518, Valid_loss 0.313459
Epoch 40, Train Loss 0.294738, Valid_loss 0.469787
Epoch 41, Train Loss 0.292030, Valid_loss 0.274977
Epoch 42, Train Loss 0.261348, Valid_loss 0.511736
Epoch 43, Train Loss 0.338274, Valid_loss 0.380191
Epoch 44, Train Loss 0.329743, Valid_loss 0.751545
Epoch 45, Train Loss 0.308834, Valid_loss 0.299769
Epoch 46, Train Loss 0.318205, Valid_loss 0.258388
Epoch 47, Train Loss 0.375074, Valid_loss 0.282075
Epoch 48, Train Loss 0.310888, Valid_loss 0.277902
Epoch 49, Train Loss 0.277879, Valid_loss 0.316597
Epoch 50, Train Loss 0.214720, Valid_loss 0.398636
Epoch 51, Train Loss 0.275688, Valid_loss 0.201707
Epoch 52, Train Loss 0.272580, Valid_loss 0.479903
Epoch 53, Train Loss 0.232858, Valid_loss 0.545318
환자ID=P1304 -- true: [[2]] -- pred: tensor([[-2.1030,  1.2147,  0.3317]], device='cuda:0')
환자ID=P1371 -- true: [[2]] -- pred: tensor([[-2.1514,  0.0219,  1.7135]], device='cuda:0')
환자ID=P1462 -- true: [[1]] -- pred: tensor([[-2.1402,  0.4106,  1.4424]], device='cuda:0')
환자ID=P1504 -- true: [[2]] -- pred: tensor([[-2.1842,  0.5099,  1.3275]], device='cuda:0')
환자ID=P1515 -- true: [[0]] -- pred: tensor([[ 3.4179, -1.2127, -2.6781]], device='cuda:0')
환자ID=P1549 -- true: [[0]] -- pred: tensor([[ 3.3922, -1.2010, -2.6463]], device='cuda:0')
환자ID=P1558 -- true: [[0]] -- pred: tensor([[ 3.4161, -1.2282, -2.6344]], device='cuda:0')
환자ID=P1685 -- true: [[1]] -- pred: tensor([[-0.7244,  1.6415, -1.8634]], device='cuda:0')
환자ID=P1722 -- true: [[1]] -- pred: tensor([[-1.9720,  1.3206,  0.1423]], device='cuda:0')
Best performance: Epoch 51, Loss 0.275688, Test ACC 0.777778, Test AUC 0.925926, Test Recall 0.777778, Test Precision 0.777778
Confusion Matrix:
 [[3 0 0]
 [0 2 1]
 [0 1 2]]
✅ Total valid splits used: 2
🔁 Repeat 0, Fold 2
cell type :  TTCTTCCGTTCAACGT-1-0                Astrocyte
CATCCACCATCTAACG-1-0      Smooth_muscle_cells
ACCCAAACAGCTAACT-1-0                  Neurons
AAGGAATCAACTGGTT-1-0     Neuroepithelial_cell
TACCCGTAGCGTGCTC-1-0                Astrocyte
                                 ...         
TTATTGCGTCGGTGTC-1-79       Endothelial_cells
GTCACGGGTTGTATGC-1-79       Endothelial_cells
GTCATGATCTTTCGAT-1-79       Endothelial_cells
GCGATCGTCAGAGTGG-1-79               Platelets
GCCCGAACAGAGAAAG-1-79       Endothelial_cells
Name: singler_annotation, Length: 494461, dtype: string
cell type annotation :  TTCTTCCGTTCAACGT-1-0                Astrocyte
CATCCACCATCTAACG-1-0      Smooth_muscle_cells
ACCCAAACAGCTAACT-1-0                  Neurons
AAGGAATCAACTGGTT-1-0     Neuroepithelial_cell
TACCCGTAGCGTGCTC-1-0                Astrocyte
                                 ...         
TTATTGCGTCGGTGTC-1-79       Endothelial_cells
GTCACGGGTTGTATGC-1-79       Endothelial_cells
GTCATGATCTTTCGAT-1-79       Endothelial_cells
GCGATCGTCAGAGTGG-1-79               Platelets
GCCCGAACAGAGAAAG-1-79       Endothelial_cells
Name: singler_annotation, Length: 494461, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Astrocyte', 'Smooth_muscle_cells', 'Neurons', 'Neuroepithelial_cell', 'Endothelial_cells', 'Osteoblasts', 'Platelets', 'Hepatocytes', 'Embryonic_stem_cells', 'MEP', 'Erythroblast', 'Fibroblasts', 'iPS_cells', 'MSC', 'Macrophage', 'Gametocytes', 'Chondrocytes', 'NK_cell', 'Neutrophils', 'HSC_CD34+', 'Monocyte', 'Tissue_stem_cells', 'DC', 'HSC_-G-CSF', 'T_cells', 'Epithelial_cells', 'Unknown', 'Pre-B_cell_CD34-', 'GMP', 'B_cell', 'Pro-Myelocyte', 'Keratinocytes', 'Myelocyte', 'BM', 'CMP', 'BM & Prog.', 'Pro-B_cell_CD34+']
라벨별 그룹 개수 {2: 9, 1: 12, 0: 13}
cell type :  AGTTCCCTCTAGCCTC-1-5               Neurons
CCTCAACTCCTCTGCA-1-5               Neurons
CCATCACGTCCGACGT-1-5               Neurons
GACCAATAGCTAATCC-1-5     Endothelial_cells
CACGGGTTCTTGGTCC-1-5           Fibroblasts
                               ...        
CGTCCATAGAATTTGG-1-78    Endothelial_cells
GCTTCACAGCGTTGTT-1-78          Hepatocytes
TCTCTGGCAGTCGCAC-1-78              Neurons
CAACAACCAGAGGCTA-1-78              Neurons
CATTGTTGTCGTACAT-1-78    Endothelial_cells
Name: singler_annotation, Length: 98228, dtype: string
cell type annotation :  AGTTCCCTCTAGCCTC-1-5               Neurons
CCTCAACTCCTCTGCA-1-5               Neurons
CCATCACGTCCGACGT-1-5               Neurons
GACCAATAGCTAATCC-1-5     Endothelial_cells
CACGGGTTCTTGGTCC-1-5           Fibroblasts
                               ...        
CGTCCATAGAATTTGG-1-78    Endothelial_cells
GCTTCACAGCGTTGTT-1-78          Hepatocytes
TCTCTGGCAGTCGCAC-1-78              Neurons
CAACAACCAGAGGCTA-1-78              Neurons
CATTGTTGTCGTACAT-1-78    Endothelial_cells
Name: singler_annotation, Length: 98228, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Neurons', 'Endothelial_cells', 'Fibroblasts', 'Smooth_muscle_cells', 'Platelets', 'Osteoblasts', 'Astrocyte', 'Erythroblast', 'Hepatocytes', 'NK_cell', 'iPS_cells', 'Neuroepithelial_cell', 'Macrophage', 'Embryonic_stem_cells', 'MSC', 'Gametocytes', 'Chondrocytes', 'Tissue_stem_cells', 'Monocyte', 'Neutrophils', 'DC', 'HSC_CD34+', 'Keratinocytes', 'HSC_-G-CSF', 'T_cells', 'Epithelial_cells', 'Unknown', 'Myelocyte', 'MEP', 'B_cell', 'BM', 'BM & Prog.', 'GMP', 'CMP', 'Pre-B_cell_CD34-', 'Pro-B_cell_CD34+', 'Pro-Myelocyte']
라벨별 그룹 개수 {2: 2, 1: 3, 0: 3}
🔍 Split #3
  → train_p_index 환자 수 (환자 단위로 묶인 index list): 34
  → test_p_index 환자 수  (환자 단위로 묶인 index list): 8
  → train 환자 ID: ['P1290', 'P1300', 'P1304', 'P1358', 'P1371', 'P1422', 'P1425', 'P1437', 'P1447', 'P1462', 'P1472', 'P1479', 'P1504', 'P1510', 'P1515', 'P1516', 'P1539', 'P1547', 'P1549', 'P1558', 'P1561', 'P1582', 'P1600', 'P1602', 'P1603', 'P1617', 'P1622', 'P1630', 'P1678', 'P1685', 'P1702', 'P1722', 'P1726', 'P1735']
  → test  환자 ID: ['P1430', 'P1508', 'P1540', 'P1606', 'P1610', 'P1631', 'P1707', 'P1718']
  → train 환자 ID 및 라벨:
    ID: P1290, Label: 2
    ID: P1300, Label: 2
    ID: P1304, Label: 2
    ID: P1358, Label: 2
    ID: P1371, Label: 2
    ID: P1422, Label: 1
    ID: P1425, Label: 1
    ID: P1437, Label: 2
    ID: P1447, Label: 1
    ID: P1462, Label: 1
    ID: P1472, Label: 2
    ID: P1479, Label: 1
    ID: P1504, Label: 2
    ID: P1510, Label: 1
    ID: P1515, Label: 0
    ID: P1516, Label: 0
    ID: P1539, Label: 0
    ID: P1547, Label: 0
    ID: P1549, Label: 0
    ID: P1558, Label: 0
    ID: P1561, Label: 0
    ID: P1582, Label: 0
    ID: P1600, Label: 0
    ID: P1602, Label: 1
    ID: P1603, Label: 0
    ID: P1617, Label: 2
    ID: P1622, Label: 0
    ID: P1630, Label: 1
    ID: P1678, Label: 0
    ID: P1685, Label: 1
    ID: P1702, Label: 0
    ID: P1722, Label: 1
    ID: P1726, Label: 1
    ID: P1735, Label: 1
  → test 환자 ID 및 라벨:
    ID: P1430, Label: 2
    ID: P1508, Label: 1
    ID: P1540, Label: 0
    ID: P1606, Label: 2
    ID: P1610, Label: 0
    ID: P1631, Label: 1
    ID: P1707, Label: 1
    ID: P1718, Label: 0
전체 데이터 index 길이 42
label_stat (train 환자 라벨 목록) 갯수 34
train_data에서 환자 단위로, train과 validation 나누기
기존 train_p_index 34
기존 (train) label_stat 34
train-vali 분할 후! 
train y 의 classes : {0, 1, 2} valid y 의 classes : {0, 1, 2} label_stat 의 classes : {0, 1, 2}
train_p_index_ 22
valid_p_index 12
test_p_index 8
→ train 환자 ID 및 라벨:
   총 개수: 22
   환자ID=P1722, Label=1, 셀개수=21432
   환자ID=P1515, Label=0, 셀개수=14502
   환자ID=P1304, Label=2, 셀개수=19123
   환자ID=P1447, Label=1, 셀개수=11151
   환자ID=P1602, Label=1, 셀개수=16580
   환자ID=P1630, Label=1, 셀개수=17633
   환자ID=P1371, Label=2, 셀개수=16233
   환자ID=P1735, Label=1, 셀개수=12009
   환자ID=P1702, Label=0, 셀개수=13550
   환자ID=P1539, Label=0, 셀개수=11076
   환자ID=P1678, Label=0, 셀개수=10085
   환자ID=P1504, Label=2, 셀개수=8133
   환자ID=P1422, Label=1, 셀개수=23315
   환자ID=P1622, Label=0, 셀개수=7210
   환자ID=P1617, Label=2, 셀개수=17986
   환자ID=P1510, Label=1, 셀개수=10744
   환자ID=P1600, Label=0, 셀개수=14882
   환자ID=P1479, Label=1, 셀개수=19124
   환자ID=P1472, Label=2, 셀개수=19513
   환자ID=P1437, Label=2, 셀개수=21695
   환자ID=P1561, Label=0, 셀개수=10016
   환자ID=P1516, Label=0, 셀개수=9361
→ valid 환자 ID 및 라벨:
   총 개수: 12
   환자ID=P1300, Label=2, 셀개수=17318
   환자ID=P1425, Label=1, 셀개수=15378
   환자ID=P1547, Label=0, 셀개수=8253
   환자ID=P1462, Label=1, 셀개수=21715
   환자ID=P1290, Label=2, 셀개수=8357
   환자ID=P1558, Label=0, 셀개수=10469
   환자ID=P1726, Label=1, 셀개수=12389
   환자ID=P1549, Label=0, 셀개수=11709
   환자ID=P1685, Label=1, 셀개수=10043
   환자ID=P1358, Label=2, 셀개수=23984
   환자ID=P1603, Label=0, 셀개수=10638
   환자ID=P1582, Label=0, 셀개수=18855
→ test 환자 ID 및 라벨:
   총 개수: 8
   환자ID=P1430, Label=2, 셀개수=11131
   환자ID=P1508, Label=1, 셀개수=20536
   환자ID=P1540, Label=0, 셀개수=11638
   환자ID=P1606, Label=2, 셀개수=8523
   환자ID=P1610, Label=0, 셀개수=13919
   환자ID=P1631, Label=1, 셀개수=13686
   환자ID=P1707, Label=1, 셀개수=9517
   환자ID=P1718, Label=0, 셀개수=9278
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Astrocyte', 'Smooth_muscle_cells', 'Neurons', 'Neuroepithelial_cell', 'Astrocyte', 'Endothelial_cells', 'Osteoblasts', 'Platelets', 'Neurons', 'Hepatocytes']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
전체 데이터 길이 592689
전체 cell type 길이 0                    Astrocyte
1          Smooth_muscle_cells
2                      Neurons
3         Neuroepithelial_cell
4                    Astrocyte
                  ...         
592684       Endothelial_cells
592685             Hepatocytes
592686                 Neurons
592687                 Neurons
592688       Endothelial_cells
Length: 592689, dtype: string
cell type의 NaN 개수 체크 0
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:13,  7.16it/s]  2%|▏         | 2/100 [00:00<00:13,  7.28it/s]  3%|▎         | 3/100 [00:00<00:13,  7.24it/s]  4%|▍         | 4/100 [00:00<00:13,  7.22it/s]  5%|▌         | 5/100 [00:00<00:12,  7.45it/s]  6%|▌         | 6/100 [00:00<00:12,  7.61it/s]  7%|▋         | 7/100 [00:00<00:12,  7.46it/s]  8%|▊         | 8/100 [00:01<00:12,  7.40it/s]  9%|▉         | 9/100 [00:01<00:12,  7.42it/s] 10%|█         | 10/100 [00:01<00:12,  7.41it/s] 11%|█         | 11/100 [00:01<00:12,  7.41it/s] 12%|█▏        | 12/100 [00:01<00:11,  7.41it/s] 13%|█▎        | 13/100 [00:01<00:11,  7.32it/s] 14%|█▍        | 14/100 [00:01<00:11,  7.33it/s] 15%|█▌        | 15/100 [00:02<00:11,  7.34it/s] 16%|█▌        | 16/100 [00:02<00:11,  7.43it/s] 17%|█▋        | 17/100 [00:02<00:11,  7.31it/s] 18%|█▊        | 18/100 [00:02<00:11,  7.18it/s] 19%|█▉        | 19/100 [00:02<00:11,  7.32it/s] 20%|██        | 20/100 [00:02<00:11,  7.25it/s] 21%|██        | 21/100 [00:02<00:10,  7.20it/s] 22%|██▏       | 22/100 [00:02<00:10,  7.38it/s] 23%|██▎       | 23/100 [00:03<00:10,  7.26it/s] 24%|██▍       | 24/100 [00:03<00:10,  7.13it/s] 25%|██▌       | 25/100 [00:03<00:10,  7.06it/s] 26%|██▌       | 26/100 [00:03<00:10,  7.07it/s] 27%|██▋       | 27/100 [00:03<00:10,  7.05it/s] 28%|██▊       | 28/100 [00:03<00:10,  7.01it/s] 29%|██▉       | 29/100 [00:03<00:10,  7.07it/s] 30%|███       | 30/100 [00:04<00:09,  7.02it/s] 31%|███       | 31/100 [00:04<00:09,  7.05it/s] 32%|███▏      | 32/100 [00:04<00:09,  7.07it/s] 33%|███▎      | 33/100 [00:04<00:09,  7.10it/s] 34%|███▍      | 34/100 [00:04<00:09,  7.08it/s] 35%|███▌      | 35/100 [00:04<00:09,  7.02it/s] 36%|███▌      | 36/100 [00:04<00:09,  7.04it/s] 37%|███▋      | 37/100 [00:05<00:08,  7.04it/s] 38%|███▊      | 38/100 [00:05<00:08,  7.03it/s] 39%|███▉      | 39/100 [00:05<00:08,  7.14it/s] 40%|████      | 40/100 [00:05<00:08,  7.12it/s] 41%|████      | 41/100 [00:05<00:08,  7.17it/s] 42%|████▏     | 42/100 [00:05<00:08,  7.12it/s] 43%|████▎     | 43/100 [00:05<00:08,  7.02it/s] 44%|████▍     | 44/100 [00:06<00:08,  6.92it/s] 45%|████▌     | 45/100 [00:06<00:07,  6.89it/s] 46%|████▌     | 46/100 [00:06<00:07,  6.87it/s] 47%|████▋     | 47/100 [00:06<00:07,  6.90it/s] 48%|████▊     | 48/100 [00:06<00:07,  6.97it/s] 49%|████▉     | 49/100 [00:06<00:07,  7.01it/s] 50%|█████     | 50/100 [00:06<00:07,  7.01it/s] 51%|█████     | 51/100 [00:07<00:07,  6.95it/s] 52%|█████▏    | 52/100 [00:07<00:07,  6.82it/s] 53%|█████▎    | 53/100 [00:07<00:06,  6.79it/s] 54%|█████▍    | 54/100 [00:07<00:06,  6.82it/s] 55%|█████▌    | 55/100 [00:07<00:06,  6.87it/s] 56%|█████▌    | 56/100 [00:07<00:06,  6.81it/s] 57%|█████▋    | 57/100 [00:08<00:06,  6.79it/s] 58%|█████▊    | 58/100 [00:08<00:06,  6.74it/s] 59%|█████▉    | 59/100 [00:08<00:06,  6.70it/s] 60%|██████    | 60/100 [00:08<00:05,  6.80it/s] 61%|██████    | 61/100 [00:08<00:05,  6.74it/s] 62%|██████▏   | 62/100 [00:08<00:05,  6.82it/s] 63%|██████▎   | 63/100 [00:08<00:05,  6.83it/s] 64%|██████▍   | 64/100 [00:09<00:05,  6.77it/s] 65%|██████▌   | 65/100 [00:09<00:05,  6.78it/s] 66%|██████▌   | 66/100 [00:09<00:05,  6.67it/s] 67%|██████▋   | 67/100 [00:09<00:04,  6.64it/s] 68%|██████▊   | 68/100 [00:09<00:04,  6.68it/s] 69%|██████▉   | 69/100 [00:09<00:04,  6.68it/s] 70%|███████   | 70/100 [00:09<00:04,  6.60it/s] 71%|███████   | 71/100 [00:10<00:04,  6.62it/s] 72%|███████▏  | 72/100 [00:10<00:04,  6.60it/s] 73%|███████▎  | 73/100 [00:10<00:04,  6.74it/s] 74%|███████▍  | 74/100 [00:10<00:03,  6.70it/s] 75%|███████▌  | 75/100 [00:10<00:03,  6.74it/s] 76%|███████▌  | 76/100 [00:10<00:03,  6.55it/s] 77%|███████▋  | 77/100 [00:11<00:03,  6.63it/s] 78%|███████▊  | 78/100 [00:11<00:03,  6.66it/s] 79%|███████▉  | 79/100 [00:11<00:03,  6.79it/s] 80%|████████  | 80/100 [00:11<00:03,  6.64it/s] 81%|████████  | 81/100 [00:11<00:02,  6.72it/s] 82%|████████▏ | 82/100 [00:11<00:02,  6.80it/s] 83%|████████▎ | 83/100 [00:11<00:02,  6.72it/s] 84%|████████▍ | 84/100 [00:12<00:02,  6.65it/s] 85%|████████▌ | 85/100 [00:12<00:02,  6.59it/s] 86%|████████▌ | 86/100 [00:12<00:02,  6.64it/s] 87%|████████▋ | 87/100 [00:12<00:01,  6.79it/s] 88%|████████▊ | 88/100 [00:12<00:01,  6.67it/s] 89%|████████▉ | 89/100 [00:12<00:01,  6.70it/s] 90%|█████████ | 90/100 [00:12<00:01,  6.73it/s] 91%|█████████ | 91/100 [00:13<00:01,  6.65it/s] 92%|█████████▏| 92/100 [00:13<00:01,  6.74it/s] 93%|█████████▎| 93/100 [00:13<00:01,  6.61it/s] 94%|█████████▍| 94/100 [00:13<00:00,  6.62it/s] 95%|█████████▌| 95/100 [00:13<00:00,  6.51it/s] 96%|█████████▌| 96/100 [00:13<00:00,  6.54it/s] 97%|█████████▋| 97/100 [00:14<00:00,  6.41it/s] 98%|█████████▊| 98/100 [00:14<00:00,  6.44it/s] 99%|█████████▉| 99/100 [00:14<00:00,  6.35it/s]100%|██████████| 100/100 [00:14<00:00,  6.41it/s]100%|██████████| 100/100 [00:14<00:00,  6.90it/s]
[I 2025-08-29 02:57:54,679] A new study created in memory with name: no-name-e28ba1a2-8607-4ec7-9f6e-0fd5893e7397
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 19.85 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.983233, Valid_loss 1.074809
Epoch 2, Train Loss 0.946865, Valid_loss 1.128474
Epoch 3, Train Loss 0.959901, Valid_loss 1.155557
Epoch 4, Train Loss 0.945929, Valid_loss 1.161340
Epoch 5, Train Loss 0.960079, Valid_loss 1.157156
Epoch 6, Train Loss 0.913646, Valid_loss 0.857264
Epoch 7, Train Loss 0.806163, Valid_loss 0.796663
Epoch 8, Train Loss 0.630897, Valid_loss 0.556370
Epoch 9, Train Loss 0.597000, Valid_loss 0.658922
Epoch 10, Train Loss 0.741885, Valid_loss 0.653710
Epoch 11, Train Loss 0.587485, Valid_loss 0.503864
Epoch 12, Train Loss 0.513504, Valid_loss 0.559033
Epoch 13, Train Loss 0.499089, Valid_loss 0.493830
Epoch 14, Train Loss 0.472026, Valid_loss 0.400739
Epoch 15, Train Loss 0.448105, Valid_loss 0.409196
Epoch 16, Train Loss 0.417482, Valid_loss 0.371147
Epoch 17, Train Loss 0.350319, Valid_loss 0.540960
Epoch 18, Train Loss 0.472294, Valid_loss 0.376802
Epoch 19, Train Loss 0.390364, Valid_loss 0.412699
Epoch 20, Train Loss 0.349723, Valid_loss 0.354070
Epoch 21, Train Loss 0.461066, Valid_loss 0.555541
Epoch 22, Train Loss 0.388096, Valid_loss 0.790314
Epoch 23, Train Loss 0.345411, Valid_loss 0.730011
Epoch 24, Train Loss 0.323247, Valid_loss 0.556281
Epoch 25, Train Loss 0.325210, Valid_loss 0.818299
Epoch 26, Train Loss 0.315402, Valid_loss 0.687020
Epoch 27, Train Loss 0.365660, Valid_loss 1.035570
Epoch 28, Train Loss 0.440168, Valid_loss 0.599243
Epoch 29, Train Loss 0.309195, Valid_loss 0.515657
Epoch 30, Train Loss 0.237683, Valid_loss 0.455994
Epoch 31, Train Loss 0.319181, Valid_loss 1.148050
Epoch 32, Train Loss 0.285127, Valid_loss 0.339647
Epoch 33, Train Loss 0.272995, Valid_loss 0.522535
Epoch 34, Train Loss 0.244103, Valid_loss 0.400837
Epoch 35, Train Loss 0.232698, Valid_loss 0.747326
Epoch 36, Train Loss 0.162351, Valid_loss 0.674445
Epoch 37, Train Loss 0.218648, Valid_loss 1.565105
Epoch 38, Train Loss 0.245695, Valid_loss 0.443316
Epoch 39, Train Loss 0.217212, Valid_loss 0.406767
Epoch 40, Train Loss 0.124951, Valid_loss 0.446325
Epoch 41, Train Loss 0.112537, Valid_loss 0.567237
Epoch 42, Train Loss 0.126574, Valid_loss 0.544144
Epoch 43, Train Loss 0.311101, Valid_loss 0.342216
Epoch 44, Train Loss 0.256840, Valid_loss 0.350217
Epoch 45, Train Loss 0.116287, Valid_loss 0.330934
Epoch 46, Train Loss 0.106724, Valid_loss 0.533316
Epoch 47, Train Loss 0.065458, Valid_loss 0.681904
Epoch 48, Train Loss 0.270156, Valid_loss 0.479916
Epoch 49, Train Loss 0.156106, Valid_loss 0.347914
Epoch 50, Train Loss 0.079101, Valid_loss 0.393158
Epoch 51, Train Loss 0.095016, Valid_loss 0.395679
Epoch 52, Train Loss 0.068788, Valid_loss 0.591695
[I 2025-08-29 03:17:06,641] Trial 0 finished with value: 0.330933866808967 and parameters: {'learning_rate': 0.001, 'epochs': 100, 'heads': 1, 'dropout': 0.0, 'weight_decay': 0.0001, 'emb_dim': 64, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.330933866808967.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 19.85 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 1.201191, Valid_loss 1.323570
Epoch 2, Train Loss 1.055732, Valid_loss 1.423496
Epoch 3, Train Loss 1.032897, Valid_loss 1.368701
Epoch 4, Train Loss 1.071401, Valid_loss 1.128718
Epoch 5, Train Loss 1.003317, Valid_loss 1.135285
Epoch 6, Train Loss 0.972221, Valid_loss 1.166244
Epoch 7, Train Loss 0.964543, Valid_loss 1.178653
Epoch 8, Train Loss 0.948048, Valid_loss 1.221981
Epoch 9, Train Loss 0.980204, Valid_loss 1.195701
Epoch 10, Train Loss 0.987406, Valid_loss 1.132922
Epoch 11, Train Loss 0.953272, Valid_loss 1.165942
Epoch 12, Train Loss 0.949676, Valid_loss 1.137789
Epoch 13, Train Loss 0.959819, Valid_loss 1.174630
Epoch 14, Train Loss 0.948572, Valid_loss 1.153606
Epoch 15, Train Loss 0.940079, Valid_loss 1.206089
Epoch 16, Train Loss 0.954084, Valid_loss 1.164808
Epoch 17, Train Loss 0.971694, Valid_loss 1.189841
Epoch 18, Train Loss 0.972560, Valid_loss 1.160735
Epoch 19, Train Loss 0.947784, Valid_loss 1.172081
Epoch 20, Train Loss 0.947915, Valid_loss 1.181353
Epoch 21, Train Loss 0.946927, Valid_loss 1.173150
Epoch 22, Train Loss 0.974797, Valid_loss 1.178706
Epoch 23, Train Loss 0.948277, Valid_loss 1.178179
Epoch 24, Train Loss 0.963792, Valid_loss 1.176947
Epoch 25, Train Loss 0.944839, Valid_loss 1.175192
Epoch 26, Train Loss 0.947784, Valid_loss 1.173270
Epoch 27, Train Loss 0.944862, Valid_loss 1.170324
Epoch 28, Train Loss 0.948026, Valid_loss 1.170493
Epoch 29, Train Loss 0.946712, Valid_loss 1.172958
Epoch 30, Train Loss 0.948763, Valid_loss 1.172168
Epoch 31, Train Loss 0.947469, Valid_loss 1.179747
Epoch 32, Train Loss 0.946761, Valid_loss 1.171234
Epoch 33, Train Loss 0.945477, Valid_loss 1.176352
Epoch 34, Train Loss 0.951373, Valid_loss 1.164885
Epoch 35, Train Loss 0.972810, Valid_loss 1.195377
Epoch 36, Train Loss 0.950540, Valid_loss 1.174613
Epoch 37, Train Loss 0.946134, Valid_loss 1.173795
Epoch 38, Train Loss 0.945787, Valid_loss 1.171628
Epoch 39, Train Loss 0.950062, Valid_loss 1.174884
Epoch 40, Train Loss 0.985173, Valid_loss 1.197244
Epoch 41, Train Loss 0.946568, Valid_loss 1.172503
Epoch 42, Train Loss 0.945062, Valid_loss 1.172737
Epoch 43, Train Loss 0.948962, Valid_loss 1.174084
Epoch 44, Train Loss 0.986702, Valid_loss 1.325312
Epoch 45, Train Loss 0.948643, Valid_loss 1.163829
Epoch 46, Train Loss 0.945185, Valid_loss 1.177923
Epoch 47, Train Loss 0.946028, Valid_loss 1.174471
Epoch 48, Train Loss 0.944776, Valid_loss 1.173688
Epoch 49, Train Loss 0.950537, Valid_loss 1.175768
Epoch 50, Train Loss 0.945643, Valid_loss 1.175527
Epoch 51, Train Loss 0.944243, Valid_loss 1.177339
Epoch 52, Train Loss 0.943464, Valid_loss 1.177851
[I 2025-08-29 03:37:31,395] Trial 1 finished with value: 1.1287179638942082 and parameters: {'learning_rate': 0.01, 'epochs': 100, 'heads': 1, 'dropout': 0.7, 'weight_decay': 0.01, 'emb_dim': 64, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.330933866808967.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 18.01 MB
Memory Reserved: 42.00 MB
cuda
CUDA OOM 발생 — 단계적 백오프 시작.
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 8600.90 MB
Memory Reserved: 8608.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 8601.36 MB
Memory Reserved: 8628.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 8600.95 MB
Memory Reserved: 8628.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 8601.36 MB
Memory Reserved: 8628.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[I 2025-08-29 03:37:32,785] Trial 2 pruned. Pruned due to OOM after backoff
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 19.85 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 1.010552, Valid_loss 1.553298
Epoch 2, Train Loss 1.012157, Valid_loss 1.350126
Epoch 3, Train Loss 0.987708, Valid_loss 1.088714
Epoch 4, Train Loss 0.989452, Valid_loss 1.116319
Epoch 5, Train Loss 0.967947, Valid_loss 1.267547
Epoch 6, Train Loss 0.968318, Valid_loss 1.148246
Epoch 7, Train Loss 0.983989, Valid_loss 1.158338
Epoch 8, Train Loss 0.958734, Valid_loss 1.187131
Epoch 9, Train Loss 0.957674, Valid_loss 1.132152
Epoch 10, Train Loss 0.953031, Valid_loss 1.134637
Epoch 11, Train Loss 0.948716, Valid_loss 1.282428
Epoch 12, Train Loss 0.956993, Valid_loss 1.148129
Epoch 13, Train Loss 0.939765, Valid_loss 1.118964
Epoch 14, Train Loss 0.952584, Valid_loss 1.114999
Epoch 15, Train Loss 0.958872, Valid_loss 1.123121
Epoch 16, Train Loss 0.945869, Valid_loss 1.136676
Epoch 17, Train Loss 0.943937, Valid_loss 1.121489
Epoch 18, Train Loss 0.947864, Valid_loss 1.132243
Epoch 19, Train Loss 0.942337, Valid_loss 1.181190
Epoch 20, Train Loss 0.955649, Valid_loss 1.161158
Epoch 21, Train Loss 0.943448, Valid_loss 1.123124
Epoch 22, Train Loss 0.937360, Valid_loss 1.134406
Epoch 23, Train Loss 0.936556, Valid_loss 1.176393
Epoch 24, Train Loss 0.934034, Valid_loss 1.119134
Epoch 25, Train Loss 0.941631, Valid_loss 1.125895
Epoch 26, Train Loss 0.976065, Valid_loss 1.128243
Epoch 27, Train Loss 0.940072, Valid_loss 1.160808
Epoch 28, Train Loss 0.955086, Valid_loss 1.137584
Epoch 29, Train Loss 0.948747, Valid_loss 1.149742
Epoch 30, Train Loss 0.950678, Valid_loss 1.131211
Epoch 31, Train Loss 0.941238, Valid_loss 1.140462
Epoch 32, Train Loss 0.937950, Valid_loss 1.134117
Epoch 33, Train Loss 0.939916, Valid_loss 1.134093
Epoch 34, Train Loss 0.945770, Valid_loss 1.132118
Epoch 35, Train Loss 0.938095, Valid_loss 1.139142
Epoch 36, Train Loss 0.938396, Valid_loss 1.125259
Epoch 37, Train Loss 0.947350, Valid_loss 1.145381
Epoch 38, Train Loss 0.940864, Valid_loss 1.121510
Epoch 39, Train Loss 0.942804, Valid_loss 1.119845
Epoch 40, Train Loss 0.955304, Valid_loss 1.125812
Epoch 41, Train Loss 0.939664, Valid_loss 1.113885
Epoch 42, Train Loss 0.940017, Valid_loss 1.117459
Epoch 43, Train Loss 0.941554, Valid_loss 1.115646
Epoch 44, Train Loss 0.941334, Valid_loss 1.111058
Epoch 45, Train Loss 0.935489, Valid_loss 1.108677
Epoch 46, Train Loss 0.942737, Valid_loss 1.114162
Epoch 47, Train Loss 0.935516, Valid_loss 1.103501
Epoch 48, Train Loss 0.931171, Valid_loss 1.466241
Epoch 49, Train Loss 0.960719, Valid_loss 1.124490
Epoch 50, Train Loss 0.946281, Valid_loss 1.113000
Epoch 51, Train Loss 0.927879, Valid_loss 1.113903
Epoch 52, Train Loss 0.926630, Valid_loss 1.113313
Epoch 53, Train Loss 0.929333, Valid_loss 1.108474
Epoch 54, Train Loss 0.923404, Valid_loss 1.110001
Epoch 55, Train Loss 0.924955, Valid_loss 1.108430
Epoch 56, Train Loss 0.924021, Valid_loss 1.107527
Epoch 57, Train Loss 0.922235, Valid_loss 1.103554
Epoch 58, Train Loss 0.921784, Valid_loss 1.105372
Epoch 59, Train Loss 0.919782, Valid_loss 1.122259
[I 2025-08-29 04:08:31,539] Trial 3 finished with value: 1.0887137403090794 and parameters: {'learning_rate': 0.01, 'epochs': 100, 'heads': 2, 'dropout': 0.0, 'weight_decay': 0.0001, 'emb_dim': 64, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.330933866808967.
선택된 trial params: {'learning_rate': 0.001, 'epochs': 100, 'heads': 1, 'dropout': 0.0, 'weight_decay': 0.0001, 'emb_dim': 64, 'augment_num': 100, 'pca': False}
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=8, batch_size=1 -> steps=8
Memory Allocated: 19.85 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 1.014012, Valid_loss 1.193530
Epoch 2, Train Loss 0.959441, Valid_loss 1.227129
Epoch 3, Train Loss 0.912380, Valid_loss 0.761700
Epoch 4, Train Loss 0.925257, Valid_loss 1.078032
Epoch 5, Train Loss 0.752358, Valid_loss 0.694671
Epoch 6, Train Loss 0.689267, Valid_loss 0.870824
Epoch 7, Train Loss 0.574094, Valid_loss 0.620745
Epoch 8, Train Loss 0.484621, Valid_loss 0.559630
Epoch 9, Train Loss 0.431504, Valid_loss 0.713422
Epoch 10, Train Loss 0.543338, Valid_loss 0.556336
Epoch 11, Train Loss 0.875441, Valid_loss 1.086008
Epoch 12, Train Loss 0.700801, Valid_loss 0.593889
Epoch 13, Train Loss 0.566086, Valid_loss 0.618210
Epoch 14, Train Loss 0.390261, Valid_loss 0.713060
Epoch 15, Train Loss 0.386246, Valid_loss 0.638486
Epoch 16, Train Loss 0.365439, Valid_loss 0.532586
Epoch 17, Train Loss 0.356322, Valid_loss 0.415510
Epoch 18, Train Loss 0.398595, Valid_loss 1.502493
Epoch 19, Train Loss 0.454271, Valid_loss 0.670555
Epoch 20, Train Loss 0.436568, Valid_loss 0.424261
Epoch 21, Train Loss 0.478440, Valid_loss 0.472412
Epoch 22, Train Loss 0.267314, Valid_loss 0.425400
Epoch 23, Train Loss 0.278806, Valid_loss 0.453865
Epoch 24, Train Loss 0.246704, Valid_loss 0.629218
Epoch 25, Train Loss 0.153624, Valid_loss 0.548806
Epoch 26, Train Loss 0.143254, Valid_loss 0.734438
Epoch 27, Train Loss 0.120106, Valid_loss 1.047365
Epoch 28, Train Loss 0.101360, Valid_loss 0.869358
Epoch 29, Train Loss 0.087334, Valid_loss 1.215014
Epoch 30, Train Loss 0.105631, Valid_loss 0.701075
Epoch 31, Train Loss 0.282539, Valid_loss 1.336071
Epoch 32, Train Loss 0.249629, Valid_loss 1.101666
Epoch 33, Train Loss 0.367269, Valid_loss 0.869939
Epoch 34, Train Loss 0.121654, Valid_loss 0.621983
Epoch 35, Train Loss 0.271432, Valid_loss 0.915847
Epoch 36, Train Loss 0.150847, Valid_loss 0.610946
Epoch 37, Train Loss 0.056307, Valid_loss 1.179034
Epoch 38, Train Loss 0.078600, Valid_loss 1.428807
Epoch 39, Train Loss 0.063722, Valid_loss 1.465242
Epoch 40, Train Loss 0.174915, Valid_loss 1.669344
Epoch 41, Train Loss 0.085217, Valid_loss 1.492708
Epoch 42, Train Loss 0.070178, Valid_loss 1.225054
Epoch 43, Train Loss 0.052050, Valid_loss 1.609588
Epoch 44, Train Loss 0.038139, Valid_loss 1.624227
Epoch 45, Train Loss 0.035182, Valid_loss 1.450162
Epoch 46, Train Loss 0.020440, Valid_loss 1.703330
Epoch 47, Train Loss 0.044372, Valid_loss 1.583807
Epoch 48, Train Loss 0.059539, Valid_loss 1.038253
Epoch 49, Train Loss 0.022332, Valid_loss 1.576574
Epoch 50, Train Loss 0.022463, Valid_loss 0.991541
Epoch 51, Train Loss 0.021468, Valid_loss 1.462294
Epoch 52, Train Loss 0.012097, Valid_loss 1.579767
환자ID=P1430 -- true: [[2]] -- pred: tensor([[-2.4087,  1.2314,  0.9139]], device='cuda:0')
환자ID=P1508 -- true: [[1]] -- pred: tensor([[-1.2140,  1.4397, -0.1605]], device='cuda:0')
환자ID=P1540 -- true: [[0]] -- pred: tensor([[ 3.7941, -0.7925, -2.8062]], device='cuda:0')
환자ID=P1606 -- true: [[2]] -- pred: tensor([[-1.2875,  1.3762, -0.0209]], device='cuda:0')
환자ID=P1610 -- true: [[0]] -- pred: tensor([[ 3.4752, -0.2943, -3.0954]], device='cuda:0')
환자ID=P1631 -- true: [[1]] -- pred: tensor([[-2.0681,  1.3170,  0.5918]], device='cuda:0')
환자ID=P1707 -- true: [[1]] -- pred: tensor([[-2.3605,  1.2090,  0.9103]], device='cuda:0')
환자ID=P1718 -- true: [[0]] -- pred: tensor([[ 3.7410, -0.5974, -2.9628]], device='cuda:0')
Best performance: Epoch 17, Loss 0.356322, Test ACC 0.750000, Test AUC 0.833333, Test Recall 0.666667, Test Precision 0.533333
Confusion Matrix:
 [[3 0 0]
 [0 3 0]
 [0 2 0]]
✅ Total valid splits used: 3
🔁 Repeat 0, Fold 3
cell type :  TTCTTCCGTTCAACGT-1-0                Astrocyte
CATCCACCATCTAACG-1-0      Smooth_muscle_cells
ACCCAAACAGCTAACT-1-0                  Neurons
AAGGAATCAACTGGTT-1-0     Neuroepithelial_cell
TACCCGTAGCGTGCTC-1-0                Astrocyte
                                 ...         
TTATTGCGTCGGTGTC-1-79       Endothelial_cells
GTCACGGGTTGTATGC-1-79       Endothelial_cells
GTCATGATCTTTCGAT-1-79       Endothelial_cells
GCGATCGTCAGAGTGG-1-79               Platelets
GCCCGAACAGAGAAAG-1-79       Endothelial_cells
Name: singler_annotation, Length: 481329, dtype: string
cell type annotation :  TTCTTCCGTTCAACGT-1-0                Astrocyte
CATCCACCATCTAACG-1-0      Smooth_muscle_cells
ACCCAAACAGCTAACT-1-0                  Neurons
AAGGAATCAACTGGTT-1-0     Neuroepithelial_cell
TACCCGTAGCGTGCTC-1-0                Astrocyte
                                 ...         
TTATTGCGTCGGTGTC-1-79       Endothelial_cells
GTCACGGGTTGTATGC-1-79       Endothelial_cells
GTCATGATCTTTCGAT-1-79       Endothelial_cells
GCGATCGTCAGAGTGG-1-79               Platelets
GCCCGAACAGAGAAAG-1-79       Endothelial_cells
Name: singler_annotation, Length: 481329, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Astrocyte', 'Smooth_muscle_cells', 'Neurons', 'Neuroepithelial_cell', 'Endothelial_cells', 'Osteoblasts', 'Platelets', 'Hepatocytes', 'Embryonic_stem_cells', 'MEP', 'Erythroblast', 'Fibroblasts', 'iPS_cells', 'MSC', 'Macrophage', 'Gametocytes', 'Chondrocytes', 'NK_cell', 'Neutrophils', 'HSC_CD34+', 'Monocyte', 'Tissue_stem_cells', 'DC', 'HSC_-G-CSF', 'T_cells', 'Epithelial_cells', 'Unknown', 'Pre-B_cell_CD34-', 'GMP', 'B_cell', 'Pro-Myelocyte', 'Keratinocytes', 'Myelocyte', 'BM', 'CMP', 'BM & Prog.', 'Pro-B_cell_CD34+']
라벨별 그룹 개수 {2: 9, 1: 12, 0: 13}
cell type :  CCCTTAGCACCTGATA-1-9                 Neurons
TGCAGTAAGTCTAGAA-1-9               Astrocyte
TGTCCCATCAGGACAG-1-9             Fibroblasts
CAGATTGTCCATTCAT-1-9             Fibroblasts
TCTATCACACGCTGAC-1-9       Endothelial_cells
                                ...         
AGAAGCGAGCGTCTGC-1-73      Endothelial_cells
TACTTCATCCCTTTGG-1-73                NK_cell
ATATCCTGTTAGCGGA-1-73      Endothelial_cells
TACTTACCAAAGCACG-1-73      Endothelial_cells
GTCAGCGCAACACTAC-1-73    Smooth_muscle_cells
Name: singler_annotation, Length: 111360, dtype: string
cell type annotation :  CCCTTAGCACCTGATA-1-9                 Neurons
TGCAGTAAGTCTAGAA-1-9               Astrocyte
TGTCCCATCAGGACAG-1-9             Fibroblasts
CAGATTGTCCATTCAT-1-9             Fibroblasts
TCTATCACACGCTGAC-1-9       Endothelial_cells
                                ...         
AGAAGCGAGCGTCTGC-1-73      Endothelial_cells
TACTTCATCCCTTTGG-1-73                NK_cell
ATATCCTGTTAGCGGA-1-73      Endothelial_cells
TACTTACCAAAGCACG-1-73      Endothelial_cells
GTCAGCGCAACACTAC-1-73    Smooth_muscle_cells
Name: singler_annotation, Length: 111360, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Neurons', 'Astrocyte', 'Fibroblasts', 'Endothelial_cells', 'Osteoblasts', 'Smooth_muscle_cells', 'Platelets', 'Neuroepithelial_cell', 'MSC', 'Erythroblast', 'Embryonic_stem_cells', 'Chondrocytes', 'Tissue_stem_cells', 'iPS_cells', 'Gametocytes', 'NK_cell', 'HSC_-G-CSF', 'Hepatocytes', 'Macrophage', 'Neutrophils', 'BM & Prog.', 'Monocyte', 'T_cells', 'HSC_CD34+', 'DC', 'MEP', 'B_cell', 'Myelocyte', 'Unknown', 'Pre-B_cell_CD34-', 'Epithelial_cells', 'BM', 'GMP', 'Pro-B_cell_CD34+', 'CMP', 'Keratinocytes', 'Pro-Myelocyte']
라벨별 그룹 개수 {2: 2, 1: 3, 0: 3}
🔍 Split #4
  → train_p_index 환자 수 (환자 단위로 묶인 index list): 34
  → test_p_index 환자 수  (환자 단위로 묶인 index list): 8
  → train 환자 ID: ['P1304', 'P1358', 'P1371', 'P1422', 'P1425', 'P1430', 'P1437', 'P1447', 'P1462', 'P1472', 'P1504', 'P1508', 'P1515', 'P1516', 'P1540', 'P1549', 'P1558', 'P1561', 'P1600', 'P1602', 'P1603', 'P1606', 'P1610', 'P1617', 'P1622', 'P1631', 'P1678', 'P1685', 'P1702', 'P1707', 'P1718', 'P1722', 'P1726', 'P1735']
  → test  환자 ID: ['P1290', 'P1300', 'P1479', 'P1510', 'P1539', 'P1547', 'P1582', 'P1630']
  → train 환자 ID 및 라벨:
    ID: P1304, Label: 2
    ID: P1358, Label: 2
    ID: P1371, Label: 2
    ID: P1422, Label: 1
    ID: P1425, Label: 1
    ID: P1430, Label: 2
    ID: P1437, Label: 2
    ID: P1447, Label: 1
    ID: P1462, Label: 1
    ID: P1472, Label: 2
    ID: P1504, Label: 2
    ID: P1508, Label: 1
    ID: P1515, Label: 0
    ID: P1516, Label: 0
    ID: P1540, Label: 0
    ID: P1549, Label: 0
    ID: P1558, Label: 0
    ID: P1561, Label: 0
    ID: P1600, Label: 0
    ID: P1602, Label: 1
    ID: P1603, Label: 0
    ID: P1606, Label: 2
    ID: P1610, Label: 0
    ID: P1617, Label: 2
    ID: P1622, Label: 0
    ID: P1631, Label: 1
    ID: P1678, Label: 0
    ID: P1685, Label: 1
    ID: P1702, Label: 0
    ID: P1707, Label: 1
    ID: P1718, Label: 0
    ID: P1722, Label: 1
    ID: P1726, Label: 1
    ID: P1735, Label: 1
  → test 환자 ID 및 라벨:
    ID: P1290, Label: 2
    ID: P1300, Label: 2
    ID: P1479, Label: 1
    ID: P1510, Label: 1
    ID: P1539, Label: 0
    ID: P1547, Label: 0
    ID: P1582, Label: 0
    ID: P1630, Label: 1
전체 데이터 index 길이 42
label_stat (train 환자 라벨 목록) 갯수 34
train_data에서 환자 단위로, train과 validation 나누기
기존 train_p_index 34
기존 (train) label_stat 34
train-vali 분할 후! 
train y 의 classes : {0, 1, 2} valid y 의 classes : {0, 1, 2} label_stat 의 classes : {0, 1, 2}
train_p_index_ 22
valid_p_index 12
test_p_index 8
→ train 환자 ID 및 라벨:
   총 개수: 22
   환자ID=P1722, Label=1, 셀개수=21432
   환자ID=P1540, Label=0, 셀개수=11638
   환자ID=P1371, Label=2, 셀개수=16233
   환자ID=P1462, Label=1, 셀개수=21715
   환자ID=P1617, Label=2, 셀개수=17986
   환자ID=P1685, Label=1, 셀개수=10043
   환자ID=P1425, Label=1, 셀개수=15378
   환자ID=P1735, Label=1, 셀개수=12009
   환자ID=P1718, Label=0, 셀개수=9278
   환자ID=P1558, Label=0, 셀개수=10469
   환자ID=P1702, Label=0, 셀개수=13550
   환자ID=P1515, Label=0, 셀개수=14502
   환자ID=P1430, Label=2, 셀개수=11131
   환자ID=P1678, Label=0, 셀개수=10085
   환자ID=P1631, Label=1, 셀개수=13686
   환자ID=P1516, Label=0, 셀개수=9361
   환자ID=P1610, Label=0, 셀개수=13919
   환자ID=P1508, Label=1, 셀개수=20536
   환자ID=P1504, Label=2, 셀개수=8133
   환자ID=P1447, Label=1, 셀개수=11151
   환자ID=P1603, Label=0, 셀개수=10638
   환자ID=P1549, Label=0, 셀개수=11709
→ valid 환자 ID 및 라벨:
   총 개수: 12
   환자ID=P1358, Label=2, 셀개수=23984
   환자ID=P1437, Label=2, 셀개수=21695
   환자ID=P1561, Label=0, 셀개수=10016
   환자ID=P1472, Label=2, 셀개수=19513
   환자ID=P1304, Label=2, 셀개수=19123
   환자ID=P1602, Label=1, 셀개수=16580
   환자ID=P1726, Label=1, 셀개수=12389
   환자ID=P1600, Label=0, 셀개수=14882
   환자ID=P1707, Label=1, 셀개수=9517
   환자ID=P1422, Label=1, 셀개수=23315
   환자ID=P1622, Label=0, 셀개수=7210
   환자ID=P1606, Label=2, 셀개수=8523
→ test 환자 ID 및 라벨:
   총 개수: 8
   환자ID=P1290, Label=2, 셀개수=8357
   환자ID=P1300, Label=2, 셀개수=17318
   환자ID=P1479, Label=1, 셀개수=19124
   환자ID=P1510, Label=1, 셀개수=10744
   환자ID=P1539, Label=0, 셀개수=11076
   환자ID=P1547, Label=0, 셀개수=8253
   환자ID=P1582, Label=0, 셀개수=18855
   환자ID=P1630, Label=1, 셀개수=17633
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Astrocyte', 'Smooth_muscle_cells', 'Neurons', 'Neuroepithelial_cell', 'Astrocyte', 'Endothelial_cells', 'Osteoblasts', 'Platelets', 'Neurons', 'Hepatocytes']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
전체 데이터 길이 592689
전체 cell type 길이 0                    Astrocyte
1          Smooth_muscle_cells
2                      Neurons
3         Neuroepithelial_cell
4                    Astrocyte
                  ...         
592684       Endothelial_cells
592685                 NK_cell
592686       Endothelial_cells
592687       Endothelial_cells
592688     Smooth_muscle_cells
Length: 592689, dtype: string
cell type의 NaN 개수 체크 0
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:13,  7.32it/s]  2%|▏         | 2/100 [00:00<00:13,  7.48it/s]  3%|▎         | 3/100 [00:00<00:12,  7.61it/s]  4%|▍         | 4/100 [00:00<00:12,  7.64it/s]  5%|▌         | 5/100 [00:00<00:12,  7.77it/s]  6%|▌         | 6/100 [00:00<00:11,  8.00it/s]  7%|▋         | 7/100 [00:00<00:11,  7.91it/s]  8%|▊         | 8/100 [00:01<00:11,  7.99it/s]  9%|▉         | 9/100 [00:01<00:11,  7.83it/s] 10%|█         | 10/100 [00:01<00:11,  7.87it/s] 11%|█         | 11/100 [00:01<00:11,  7.91it/s] 12%|█▏        | 12/100 [00:01<00:11,  7.82it/s] 13%|█▎        | 13/100 [00:01<00:11,  7.89it/s] 14%|█▍        | 14/100 [00:01<00:11,  7.67it/s] 15%|█▌        | 15/100 [00:01<00:11,  7.69it/s] 16%|█▌        | 16/100 [00:02<00:10,  7.79it/s] 17%|█▋        | 17/100 [00:02<00:10,  7.74it/s] 18%|█▊        | 18/100 [00:02<00:10,  7.70it/s] 19%|█▉        | 19/100 [00:02<00:10,  7.82it/s] 20%|██        | 20/100 [00:02<00:10,  7.56it/s] 21%|██        | 21/100 [00:02<00:10,  7.68it/s] 22%|██▏       | 22/100 [00:02<00:10,  7.67it/s] 23%|██▎       | 23/100 [00:02<00:09,  7.77it/s] 24%|██▍       | 24/100 [00:03<00:09,  7.82it/s] 25%|██▌       | 25/100 [00:03<00:09,  7.55it/s] 26%|██▌       | 26/100 [00:03<00:09,  7.53it/s] 27%|██▋       | 27/100 [00:03<00:09,  7.56it/s] 28%|██▊       | 28/100 [00:03<00:09,  7.61it/s] 29%|██▉       | 29/100 [00:03<00:09,  7.54it/s] 30%|███       | 30/100 [00:03<00:09,  7.44it/s] 31%|███       | 31/100 [00:04<00:09,  7.36it/s] 32%|███▏      | 32/100 [00:04<00:09,  7.36it/s] 33%|███▎      | 33/100 [00:04<00:09,  7.41it/s] 34%|███▍      | 34/100 [00:04<00:08,  7.38it/s] 35%|███▌      | 35/100 [00:04<00:08,  7.42it/s] 36%|███▌      | 36/100 [00:04<00:08,  7.29it/s] 37%|███▋      | 37/100 [00:04<00:08,  7.41it/s] 38%|███▊      | 38/100 [00:04<00:08,  7.38it/s] 39%|███▉      | 39/100 [00:05<00:08,  7.31it/s] 40%|████      | 40/100 [00:05<00:08,  7.30it/s] 41%|████      | 41/100 [00:05<00:07,  7.39it/s] 42%|████▏     | 42/100 [00:05<00:07,  7.46it/s] 43%|████▎     | 43/100 [00:05<00:07,  7.54it/s] 44%|████▍     | 44/100 [00:05<00:07,  7.32it/s] 45%|████▌     | 45/100 [00:05<00:07,  7.40it/s] 46%|████▌     | 46/100 [00:06<00:07,  7.27it/s] 47%|████▋     | 47/100 [00:06<00:07,  7.23it/s] 48%|████▊     | 48/100 [00:06<00:07,  7.34it/s] 49%|████▉     | 49/100 [00:06<00:06,  7.32it/s] 50%|█████     | 50/100 [00:06<00:06,  7.32it/s] 51%|█████     | 51/100 [00:06<00:06,  7.42it/s] 52%|█████▏    | 52/100 [00:06<00:06,  7.29it/s] 53%|█████▎    | 53/100 [00:07<00:06,  7.26it/s] 54%|█████▍    | 54/100 [00:07<00:06,  7.25it/s] 55%|█████▌    | 55/100 [00:07<00:06,  7.27it/s] 56%|█████▌    | 56/100 [00:07<00:06,  7.27it/s] 57%|█████▋    | 57/100 [00:07<00:05,  7.31it/s] 58%|█████▊    | 58/100 [00:07<00:05,  7.22it/s] 59%|█████▉    | 59/100 [00:07<00:05,  7.26it/s] 60%|██████    | 60/100 [00:08<00:05,  7.18it/s] 61%|██████    | 61/100 [00:08<00:05,  7.30it/s] 62%|██████▏   | 62/100 [00:08<00:05,  7.16it/s] 63%|██████▎   | 63/100 [00:08<00:05,  7.02it/s] 64%|██████▍   | 64/100 [00:08<00:05,  7.02it/s] 65%|██████▌   | 65/100 [00:08<00:05,  6.94it/s] 66%|██████▌   | 66/100 [00:08<00:04,  6.98it/s] 67%|██████▋   | 67/100 [00:09<00:04,  6.91it/s] 68%|██████▊   | 68/100 [00:09<00:04,  6.98it/s] 69%|██████▉   | 69/100 [00:09<00:04,  7.06it/s] 70%|███████   | 70/100 [00:09<00:04,  6.94it/s] 71%|███████   | 71/100 [00:09<00:04,  7.06it/s] 72%|███████▏  | 72/100 [00:09<00:03,  7.05it/s] 73%|███████▎  | 73/100 [00:09<00:03,  7.02it/s] 74%|███████▍  | 74/100 [00:09<00:03,  7.08it/s] 75%|███████▌  | 75/100 [00:10<00:03,  7.03it/s] 76%|███████▌  | 76/100 [00:10<00:03,  6.96it/s] 77%|███████▋  | 77/100 [00:10<00:03,  6.88it/s] 78%|███████▊  | 78/100 [00:10<00:03,  6.95it/s] 79%|███████▉  | 79/100 [00:10<00:03,  6.78it/s] 80%|████████  | 80/100 [00:10<00:02,  6.80it/s] 81%|████████  | 81/100 [00:11<00:02,  6.76it/s] 82%|████████▏ | 82/100 [00:11<00:02,  6.80it/s] 83%|████████▎ | 83/100 [00:11<00:02,  6.74it/s] 84%|████████▍ | 84/100 [00:11<00:02,  6.82it/s] 85%|████████▌ | 85/100 [00:11<00:02,  6.69it/s] 86%|████████▌ | 86/100 [00:11<00:02,  6.76it/s] 87%|████████▋ | 87/100 [00:11<00:01,  6.95it/s] 88%|████████▊ | 88/100 [00:12<00:01,  6.81it/s] 89%|████████▉ | 89/100 [00:12<00:01,  6.82it/s] 90%|█████████ | 90/100 [00:12<00:01,  6.83it/s] 91%|█████████ | 91/100 [00:12<00:01,  6.74it/s] 92%|█████████▏| 92/100 [00:12<00:01,  6.71it/s] 93%|█████████▎| 93/100 [00:12<00:01,  6.69it/s] 94%|█████████▍| 94/100 [00:12<00:00,  6.81it/s] 95%|█████████▌| 95/100 [00:13<00:00,  6.82it/s] 96%|█████████▌| 96/100 [00:13<00:00,  6.87it/s] 97%|█████████▋| 97/100 [00:13<00:00,  6.97it/s] 98%|█████████▊| 98/100 [00:13<00:00,  6.66it/s] 99%|█████████▉| 99/100 [00:13<00:00,  6.65it/s]100%|██████████| 100/100 [00:13<00:00,  6.51it/s]100%|██████████| 100/100 [00:13<00:00,  7.22it/s]
[I 2025-08-29 04:28:30,788] A new study created in memory with name: no-name-24ce03f7-3dcf-44ee-8522-ba8da119f633
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 16.69 MB
Memory Reserved: 42.00 MB
cuda
CUDA OOM 발생 — 단계적 백오프 시작.
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 7468.79 MB
Memory Reserved: 7490.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 14664.78 MB
Memory Reserved: 14686.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 7468.78 MB
Memory Reserved: 7490.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 14664.78 MB
Memory Reserved: 14686.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[I 2025-08-29 04:28:32,197] Trial 0 pruned. Pruned due to OOM after backoff
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 7473.07 MB
Memory Reserved: 7490.00 MB
cuda
Epoch 1, Train Loss 0.888892, Valid_loss 1.914120
Epoch 2, Train Loss 0.871276, Valid_loss 1.869063
Epoch 3, Train Loss 0.747494, Valid_loss 1.669518
Epoch 4, Train Loss 0.516113, Valid_loss 1.644561
Epoch 5, Train Loss 0.494735, Valid_loss 1.766821
Epoch 6, Train Loss 0.388522, Valid_loss 1.116635
Epoch 7, Train Loss 0.449143, Valid_loss 1.052294
Epoch 8, Train Loss 0.451798, Valid_loss 1.788380
Epoch 9, Train Loss 0.477285, Valid_loss 2.450789
Epoch 10, Train Loss 0.437606, Valid_loss 1.111631
Epoch 11, Train Loss 0.438586, Valid_loss 1.848621
Epoch 12, Train Loss 0.412740, Valid_loss 2.495371
Epoch 13, Train Loss 0.439831, Valid_loss 1.177411
Epoch 14, Train Loss 0.400383, Valid_loss 2.915156
Epoch 15, Train Loss 0.463035, Valid_loss 1.222405
Epoch 16, Train Loss 0.413115, Valid_loss 3.016652
Epoch 17, Train Loss 0.467705, Valid_loss 3.296678
Epoch 18, Train Loss 0.348095, Valid_loss 1.170690
Epoch 19, Train Loss 0.397955, Valid_loss 1.549513
Epoch 20, Train Loss 0.386307, Valid_loss 2.005875
Epoch 21, Train Loss 0.331898, Valid_loss 1.020076
Epoch 22, Train Loss 0.354645, Valid_loss 1.602616
Epoch 23, Train Loss 0.372139, Valid_loss 1.066229
Epoch 24, Train Loss 0.363826, Valid_loss 1.227610
Epoch 25, Train Loss 0.312463, Valid_loss 1.588214
Epoch 26, Train Loss 0.364901, Valid_loss 1.331640
Epoch 27, Train Loss 0.312200, Valid_loss 1.031868
Epoch 28, Train Loss 0.362446, Valid_loss 1.610281
Epoch 29, Train Loss 0.324007, Valid_loss 1.536630
Epoch 30, Train Loss 0.373795, Valid_loss 1.174869
Epoch 31, Train Loss 0.420080, Valid_loss 2.545428
Epoch 32, Train Loss 0.353835, Valid_loss 1.387951
Epoch 33, Train Loss 0.381603, Valid_loss 1.463033
Epoch 34, Train Loss 0.269220, Valid_loss 1.498951
Epoch 35, Train Loss 0.260718, Valid_loss 1.267058
Epoch 36, Train Loss 0.322310, Valid_loss 1.457354
Epoch 37, Train Loss 0.306445, Valid_loss 1.757052
Epoch 38, Train Loss 0.292403, Valid_loss 1.413643
Epoch 39, Train Loss 0.265204, Valid_loss 1.540981
Epoch 40, Train Loss 0.333389, Valid_loss 1.000048
Epoch 41, Train Loss 0.329118, Valid_loss 1.372196
Epoch 42, Train Loss 0.253102, Valid_loss 1.366968
Epoch 43, Train Loss 0.344620, Valid_loss 1.265259
Epoch 44, Train Loss 0.277000, Valid_loss 1.268411
Epoch 45, Train Loss 0.286042, Valid_loss 1.329491
Epoch 46, Train Loss 0.285045, Valid_loss 1.307161
Epoch 47, Train Loss 0.303636, Valid_loss 1.352563
Epoch 48, Train Loss 0.251397, Valid_loss 1.292509
Epoch 49, Train Loss 0.259318, Valid_loss 0.917666
Epoch 50, Train Loss 0.256714, Valid_loss 1.317639
Epoch 51, Train Loss 0.184813, Valid_loss 1.342663
Epoch 52, Train Loss 0.198453, Valid_loss 1.356439
[I 2025-08-29 04:49:07,385] Trial 1 finished with value: 0.9176657631372412 and parameters: {'learning_rate': 0.001, 'epochs': 100, 'heads': 1, 'dropout': 0.5, 'weight_decay': 0.001, 'emb_dim': 64, 'augment_num': 100, 'pca': False}. Best is trial 1 with value: 0.9176657631372412.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 18.01 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 1.049006, Valid_loss 1.317815
Epoch 2, Train Loss 0.905728, Valid_loss 1.323001
Epoch 3, Train Loss 0.847819, Valid_loss 1.312712
Epoch 4, Train Loss 0.774162, Valid_loss 1.113044
Epoch 5, Train Loss 0.805941, Valid_loss 1.270822
Epoch 6, Train Loss 0.733890, Valid_loss 1.150119
Epoch 7, Train Loss 0.676927, Valid_loss 1.022486
Epoch 8, Train Loss 0.723736, Valid_loss 1.364296
Epoch 9, Train Loss 0.680269, Valid_loss 1.011996
Epoch 10, Train Loss 0.629521, Valid_loss 1.202275
Epoch 11, Train Loss 0.593845, Valid_loss 0.996483
Epoch 12, Train Loss 0.545900, Valid_loss 1.021392
Epoch 13, Train Loss 0.557210, Valid_loss 1.193265
Epoch 14, Train Loss 0.504799, Valid_loss 1.004538
Epoch 15, Train Loss 0.567527, Valid_loss 0.971455
Epoch 16, Train Loss 0.559695, Valid_loss 0.855273
Epoch 17, Train Loss 0.556250, Valid_loss 0.955439
Epoch 18, Train Loss 0.530824, Valid_loss 1.138200
Epoch 19, Train Loss 0.485974, Valid_loss 0.876713
Epoch 20, Train Loss 0.462762, Valid_loss 0.814739
Epoch 21, Train Loss 0.456926, Valid_loss 0.918547
Epoch 22, Train Loss 0.461012, Valid_loss 1.100368
Epoch 23, Train Loss 0.462550, Valid_loss 1.142133
Epoch 24, Train Loss 0.500291, Valid_loss 0.947313
Epoch 25, Train Loss 0.494458, Valid_loss 0.862109
Epoch 26, Train Loss 0.435930, Valid_loss 1.053998
Epoch 27, Train Loss 0.431240, Valid_loss 1.018315
Epoch 28, Train Loss 0.431376, Valid_loss 1.086534
Epoch 29, Train Loss 0.452943, Valid_loss 0.890874
Epoch 30, Train Loss 0.433034, Valid_loss 0.909348
Epoch 31, Train Loss 0.406970, Valid_loss 0.918026
Epoch 32, Train Loss 0.433809, Valid_loss 0.930821
Epoch 33, Train Loss 0.431823, Valid_loss 1.233585
Epoch 34, Train Loss 0.402997, Valid_loss 1.099850
Epoch 35, Train Loss 0.489425, Valid_loss 1.073270
Epoch 36, Train Loss 0.389400, Valid_loss 1.604704
Epoch 37, Train Loss 0.367787, Valid_loss 1.578739
Epoch 38, Train Loss 0.451638, Valid_loss 1.050095
Epoch 39, Train Loss 0.367046, Valid_loss 1.273547
Epoch 40, Train Loss 0.395454, Valid_loss 0.918760
Epoch 41, Train Loss 0.415055, Valid_loss 0.992110
Epoch 42, Train Loss 0.444912, Valid_loss 0.989923
Epoch 43, Train Loss 0.413197, Valid_loss 1.950922
Epoch 44, Train Loss 0.427498, Valid_loss 1.020423
Epoch 45, Train Loss 0.407070, Valid_loss 1.011196
Epoch 46, Train Loss 0.379713, Valid_loss 1.203311
Epoch 47, Train Loss 0.347614, Valid_loss 1.121796
Epoch 48, Train Loss 0.385378, Valid_loss 1.133840
Epoch 49, Train Loss 0.330804, Valid_loss 1.525631
Epoch 50, Train Loss 0.387498, Valid_loss 0.910056
Epoch 51, Train Loss 0.376382, Valid_loss 1.197354
Epoch 52, Train Loss 0.317226, Valid_loss 1.275523
[I 2025-08-29 05:16:08,633] Trial 2 finished with value: 0.8147390509645144 and parameters: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 2, 'dropout': 0.7, 'weight_decay': 0.01, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 2 with value: 0.8147390509645144.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 18.01 MB
Memory Reserved: 42.00 MB
cuda
CUDA OOM 발생 — 단계적 백오프 시작.
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 7488.35 MB
Memory Reserved: 7510.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 14684.32 MB
Memory Reserved: 14726.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 7488.32 MB
Memory Reserved: 7510.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 14684.32 MB
Memory Reserved: 14726.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[I 2025-08-29 05:16:10,536] Trial 3 pruned. Pruned due to OOM after backoff
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 7487.00 MB
Memory Reserved: 7510.00 MB
cuda
CUDA OOM 발생 — 단계적 백오프 시작.
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 14664.90 MB
Memory Reserved: 14706.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 7469.39 MB
Memory Reserved: 7490.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 14664.78 MB
Memory Reserved: 14686.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 7469.45 MB
Memory Reserved: 7490.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[I 2025-08-29 05:16:12,079] Trial 4 pruned. Pruned due to OOM after backoff
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 14669.18 MB
Memory Reserved: 14686.00 MB
cuda
Epoch 1, Train Loss 0.904432, Valid_loss 1.706678
Epoch 2, Train Loss 0.746366, Valid_loss 1.501829
Epoch 3, Train Loss 0.631057, Valid_loss 1.438438
Epoch 4, Train Loss 0.608103, Valid_loss 1.490699
Epoch 5, Train Loss 0.552828, Valid_loss 1.764216
Epoch 6, Train Loss 0.520605, Valid_loss 1.249350
Epoch 7, Train Loss 0.514884, Valid_loss 1.474130
Epoch 8, Train Loss 0.455028, Valid_loss 1.042461
Epoch 9, Train Loss 0.472603, Valid_loss 1.052981
Epoch 10, Train Loss 0.492270, Valid_loss 1.100632
Epoch 11, Train Loss 0.403113, Valid_loss 1.267234
Epoch 12, Train Loss 0.337809, Valid_loss 1.169234
Epoch 13, Train Loss 0.426474, Valid_loss 1.248260
Epoch 14, Train Loss 0.346141, Valid_loss 0.938986
Epoch 15, Train Loss 0.370552, Valid_loss 1.290914
Epoch 16, Train Loss 0.366425, Valid_loss 0.910777
Epoch 17, Train Loss 0.358100, Valid_loss 1.005518
Epoch 18, Train Loss 0.337297, Valid_loss 0.768468
Epoch 19, Train Loss 0.312607, Valid_loss 1.440078
Epoch 20, Train Loss 0.325136, Valid_loss 1.421035
Epoch 21, Train Loss 0.324634, Valid_loss 1.466842
Epoch 22, Train Loss 0.382666, Valid_loss 0.983132
Epoch 23, Train Loss 0.320810, Valid_loss 0.745399
Epoch 24, Train Loss 0.332705, Valid_loss 1.031827
Epoch 25, Train Loss 0.251413, Valid_loss 0.820182
Epoch 26, Train Loss 0.281383, Valid_loss 1.647798
Epoch 27, Train Loss 0.287802, Valid_loss 1.420696
Epoch 28, Train Loss 0.314424, Valid_loss 1.078599
Epoch 29, Train Loss 0.271033, Valid_loss 1.347150
Epoch 30, Train Loss 0.340260, Valid_loss 1.133974
Epoch 31, Train Loss 0.277377, Valid_loss 1.049377
Epoch 32, Train Loss 0.394520, Valid_loss 1.094350
Epoch 33, Train Loss 0.253230, Valid_loss 1.104032
Epoch 34, Train Loss 0.300054, Valid_loss 0.958525
Epoch 35, Train Loss 0.215117, Valid_loss 1.589017
Epoch 36, Train Loss 0.277973, Valid_loss 1.337778
Epoch 37, Train Loss 0.254023, Valid_loss 1.460477
Epoch 38, Train Loss 0.205281, Valid_loss 0.851385
Epoch 39, Train Loss 0.214260, Valid_loss 2.346776
Epoch 40, Train Loss 0.283838, Valid_loss 0.808042
Epoch 41, Train Loss 0.261298, Valid_loss 1.143542
Epoch 42, Train Loss 0.226503, Valid_loss 0.786817
Epoch 43, Train Loss 0.240838, Valid_loss 0.788505
Epoch 44, Train Loss 0.229102, Valid_loss 1.074801
Epoch 45, Train Loss 0.295274, Valid_loss 0.627839
Epoch 46, Train Loss 0.290642, Valid_loss 1.105826
Epoch 47, Train Loss 0.274724, Valid_loss 1.014871
Epoch 48, Train Loss 0.196971, Valid_loss 1.022713
Epoch 49, Train Loss 0.278322, Valid_loss 1.044009
Epoch 50, Train Loss 0.297056, Valid_loss 1.020466
Epoch 51, Train Loss 0.225019, Valid_loss 0.731409
Epoch 52, Train Loss 0.228259, Valid_loss 0.961869
Epoch 53, Train Loss 0.185212, Valid_loss 0.803075
Epoch 54, Train Loss 0.172897, Valid_loss 0.785084
Epoch 55, Train Loss 0.190228, Valid_loss 0.870936
Epoch 56, Train Loss 0.174575, Valid_loss 0.972732
[I 2025-08-29 05:38:14,140] Trial 5 finished with value: 0.627839150528113 and parameters: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 1, 'dropout': 0.5, 'weight_decay': 0.01, 'emb_dim': 64, 'augment_num': 100, 'pca': False}. Best is trial 5 with value: 0.627839150528113.
선택된 trial params: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 1, 'dropout': 0.5, 'weight_decay': 0.01, 'emb_dim': 64, 'augment_num': 100, 'pca': False}
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=8, batch_size=1 -> steps=8
Memory Allocated: 19.85 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.933632, Valid_loss 1.437509
Epoch 2, Train Loss 0.756536, Valid_loss 1.199861
Epoch 3, Train Loss 0.653043, Valid_loss 1.134749
Epoch 4, Train Loss 0.485348, Valid_loss 1.252834
Epoch 5, Train Loss 0.500375, Valid_loss 1.043526
Epoch 6, Train Loss 0.477744, Valid_loss 1.007878
Epoch 7, Train Loss 0.536334, Valid_loss 1.015510
Epoch 8, Train Loss 0.467821, Valid_loss 1.095642
Epoch 9, Train Loss 0.432088, Valid_loss 1.019491
Epoch 10, Train Loss 0.455050, Valid_loss 1.003275
Epoch 11, Train Loss 0.483625, Valid_loss 1.327360
Epoch 12, Train Loss 0.429222, Valid_loss 1.183419
Epoch 13, Train Loss 0.363092, Valid_loss 0.944118
Epoch 14, Train Loss 0.350042, Valid_loss 0.886405
Epoch 15, Train Loss 0.352080, Valid_loss 1.545268
Epoch 16, Train Loss 0.422092, Valid_loss 1.644241
Epoch 17, Train Loss 0.357639, Valid_loss 1.434114
Epoch 18, Train Loss 0.339887, Valid_loss 0.874755
Epoch 19, Train Loss 0.351797, Valid_loss 0.956071
Epoch 20, Train Loss 0.324145, Valid_loss 1.009036
Epoch 21, Train Loss 0.327350, Valid_loss 0.883521
Epoch 22, Train Loss 0.320950, Valid_loss 0.953254
Epoch 23, Train Loss 0.361267, Valid_loss 0.899014
Epoch 24, Train Loss 0.331975, Valid_loss 0.861751
Epoch 25, Train Loss 0.307360, Valid_loss 1.118594
Epoch 26, Train Loss 0.314329, Valid_loss 0.833309
Epoch 27, Train Loss 0.328065, Valid_loss 1.166687
Epoch 28, Train Loss 0.329966, Valid_loss 1.035291
Epoch 29, Train Loss 0.290047, Valid_loss 1.029096
Epoch 30, Train Loss 0.267106, Valid_loss 1.036279
Epoch 31, Train Loss 0.289147, Valid_loss 0.730217
Epoch 32, Train Loss 0.320340, Valid_loss 0.891662
Epoch 33, Train Loss 0.242001, Valid_loss 0.694550
Epoch 34, Train Loss 0.361809, Valid_loss 1.124039
Epoch 35, Train Loss 0.243006, Valid_loss 1.135365
Epoch 36, Train Loss 0.264819, Valid_loss 1.192891
Epoch 37, Train Loss 0.284612, Valid_loss 0.816504
Epoch 38, Train Loss 0.258135, Valid_loss 0.744911
Epoch 39, Train Loss 0.222601, Valid_loss 0.970574
Epoch 40, Train Loss 0.261761, Valid_loss 0.810734
Epoch 41, Train Loss 0.255505, Valid_loss 1.024261
Epoch 42, Train Loss 0.240738, Valid_loss 1.075301
Epoch 43, Train Loss 0.345165, Valid_loss 1.260733
Epoch 44, Train Loss 0.219864, Valid_loss 0.849967
Epoch 45, Train Loss 0.259631, Valid_loss 0.752519
Epoch 46, Train Loss 0.260374, Valid_loss 0.836758
Epoch 47, Train Loss 0.233845, Valid_loss 0.595882
Epoch 48, Train Loss 0.274792, Valid_loss 0.938222
Epoch 49, Train Loss 0.246519, Valid_loss 0.746623
Epoch 50, Train Loss 0.265908, Valid_loss 0.595313
Epoch 51, Train Loss 0.193360, Valid_loss 0.961424
Epoch 52, Train Loss 0.225600, Valid_loss 0.747423
Epoch 53, Train Loss 0.191446, Valid_loss 0.983223
Epoch 54, Train Loss 0.190922, Valid_loss 0.798456
Epoch 55, Train Loss 0.191706, Valid_loss 0.859873
Epoch 56, Train Loss 0.202503, Valid_loss 0.756231
Epoch 57, Train Loss 0.202693, Valid_loss 0.775573
Epoch 58, Train Loss 0.181617, Valid_loss 0.706309
Epoch 59, Train Loss 0.181369, Valid_loss 0.699963
Epoch 60, Train Loss 0.168030, Valid_loss 0.707839
Epoch 61, Train Loss 0.169825, Valid_loss 0.673829
Epoch 62, Train Loss 0.142266, Valid_loss 0.779009
Epoch 63, Train Loss 0.164618, Valid_loss 0.914703
환자ID=P1290 -- true: [[2]] -- pred: tensor([[-2.0761,  0.4733,  0.2518]], device='cuda:0')
환자ID=P1300 -- true: [[2]] -- pred: tensor([[-1.9883,  0.5719,  0.0568]], device='cuda:0')
환자ID=P1479 -- true: [[1]] -- pred: tensor([[-1.7314,  1.2596, -0.5919]], device='cuda:0')
환자ID=P1510 -- true: [[1]] -- pred: tensor([[-1.6375,  0.5232, -0.2621]], device='cuda:0')
환자ID=P1539 -- true: [[0]] -- pred: tensor([[ 2.9263, -1.5395, -3.1072]], device='cuda:0')
환자ID=P1547 -- true: [[0]] -- pred: tensor([[ 2.4480, -1.2531, -2.9314]], device='cuda:0')
환자ID=P1582 -- true: [[0]] -- pred: tensor([[ 2.9531, -1.5611, -3.1127]], device='cuda:0')
환자ID=P1630 -- true: [[1]] -- pred: tensor([[-2.0667,  0.9174,  0.0485]], device='cuda:0')
Best performance: Epoch 50, Loss 0.265908, Test ACC 0.750000, Test AUC 1.000000, Test Recall 0.666667, Test Precision 0.533333
Confusion Matrix:
 [[3 0 0]
 [0 3 0]
 [0 2 0]]
✅ Total valid splits used: 4
🔁 Repeat 0, Fold 4
cell type :  TTCTTCCGTTCAACGT-1-0                Astrocyte
CATCCACCATCTAACG-1-0      Smooth_muscle_cells
ACCCAAACAGCTAACT-1-0                  Neurons
AAGGAATCAACTGGTT-1-0     Neuroepithelial_cell
TACCCGTAGCGTGCTC-1-0                Astrocyte
                                 ...         
TTATTGCGTCGGTGTC-1-79       Endothelial_cells
GTCACGGGTTGTATGC-1-79       Endothelial_cells
GTCATGATCTTTCGAT-1-79       Endothelial_cells
GCGATCGTCAGAGTGG-1-79               Platelets
GCCCGAACAGAGAAAG-1-79       Endothelial_cells
Name: singler_annotation, Length: 472424, dtype: string
cell type annotation :  TTCTTCCGTTCAACGT-1-0                Astrocyte
CATCCACCATCTAACG-1-0      Smooth_muscle_cells
ACCCAAACAGCTAACT-1-0                  Neurons
AAGGAATCAACTGGTT-1-0     Neuroepithelial_cell
TACCCGTAGCGTGCTC-1-0                Astrocyte
                                 ...         
TTATTGCGTCGGTGTC-1-79       Endothelial_cells
GTCACGGGTTGTATGC-1-79       Endothelial_cells
GTCATGATCTTTCGAT-1-79       Endothelial_cells
GCGATCGTCAGAGTGG-1-79               Platelets
GCCCGAACAGAGAAAG-1-79       Endothelial_cells
Name: singler_annotation, Length: 472424, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Astrocyte', 'Smooth_muscle_cells', 'Neurons', 'Neuroepithelial_cell', 'Endothelial_cells', 'Osteoblasts', 'Platelets', 'Hepatocytes', 'Embryonic_stem_cells', 'MEP', 'Erythroblast', 'Fibroblasts', 'iPS_cells', 'MSC', 'Macrophage', 'Gametocytes', 'Chondrocytes', 'NK_cell', 'Neutrophils', 'HSC_CD34+', 'Monocyte', 'Tissue_stem_cells', 'DC', 'HSC_-G-CSF', 'T_cells', 'Epithelial_cells', 'Unknown', 'Pre-B_cell_CD34-', 'GMP', 'B_cell', 'Pro-Myelocyte', 'Keratinocytes', 'Myelocyte', 'BM', 'CMP', 'BM & Prog.', 'Pro-B_cell_CD34+']
라벨별 그룹 개수 {2: 9, 1: 12, 0: 13}
cell type :  CACACAACAATCGTCA-1-7       Endothelial_cells
TGCGATATCGTAGTCA-1-7                 Neurons
ATTCACTAGTTAGAAC-1-7                 Neurons
CGAAGTTGTGGTCAAG-1-7                 Neurons
AAACCCAGTGAACCGA-1-7     Smooth_muscle_cells
                                ...         
GTTCTATTCCTTCTAA-1-77      Endothelial_cells
GAGTCATTCATGGATC-1-77      Endothelial_cells
GGTGTTACAAGACAAT-1-77    Smooth_muscle_cells
AGCGTCGTCCTCACTG-1-77            Neutrophils
GTGCTGGCATGATAGA-1-77      Endothelial_cells
Name: singler_annotation, Length: 120265, dtype: string
cell type annotation :  CACACAACAATCGTCA-1-7       Endothelial_cells
TGCGATATCGTAGTCA-1-7                 Neurons
ATTCACTAGTTAGAAC-1-7                 Neurons
CGAAGTTGTGGTCAAG-1-7                 Neurons
AAACCCAGTGAACCGA-1-7     Smooth_muscle_cells
                                ...         
GTTCTATTCCTTCTAA-1-77      Endothelial_cells
GAGTCATTCATGGATC-1-77      Endothelial_cells
GGTGTTACAAGACAAT-1-77    Smooth_muscle_cells
AGCGTCGTCCTCACTG-1-77            Neutrophils
GTGCTGGCATGATAGA-1-77      Endothelial_cells
Name: singler_annotation, Length: 120265, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Endothelial_cells', 'Neurons', 'Smooth_muscle_cells', 'iPS_cells', 'Astrocyte', 'Neuroepithelial_cell', 'Fibroblasts', 'Platelets', 'Osteoblasts', 'Erythroblast', 'Hepatocytes', 'Gametocytes', 'Chondrocytes', 'Embryonic_stem_cells', 'MSC', 'HSC_CD34+', 'Tissue_stem_cells', 'NK_cell', 'Keratinocytes', 'Neutrophils', 'Epithelial_cells', 'Myelocyte', 'Macrophage', 'Monocyte', 'Unknown', 'T_cells', 'HSC_-G-CSF', 'B_cell', 'DC', 'Pro-Myelocyte', 'GMP', 'BM', 'CMP', 'MEP', 'Pre-B_cell_CD34-', 'Pro-B_cell_CD34+', 'BM & Prog.']
라벨별 그룹 개수 {2: 2, 1: 3, 0: 3}
🔍 Split #5
  → train_p_index 환자 수 (환자 단위로 묶인 index list): 34
  → test_p_index 환자 수  (환자 단위로 묶인 index list): 8
  → train 환자 ID: ['P1290', 'P1300', 'P1304', 'P1371', 'P1422', 'P1430', 'P1437', 'P1447', 'P1462', 'P1472', 'P1479', 'P1504', 'P1508', 'P1510', 'P1515', 'P1539', 'P1540', 'P1547', 'P1549', 'P1558', 'P1561', 'P1582', 'P1603', 'P1606', 'P1610', 'P1622', 'P1630', 'P1631', 'P1685', 'P1702', 'P1707', 'P1718', 'P1722', 'P1726']
  → test  환자 ID: ['P1358', 'P1425', 'P1516', 'P1600', 'P1602', 'P1617', 'P1678', 'P1735']
  → train 환자 ID 및 라벨:
    ID: P1290, Label: 2
    ID: P1300, Label: 2
    ID: P1304, Label: 2
    ID: P1371, Label: 2
    ID: P1422, Label: 1
    ID: P1430, Label: 2
    ID: P1437, Label: 2
    ID: P1447, Label: 1
    ID: P1462, Label: 1
    ID: P1472, Label: 2
    ID: P1479, Label: 1
    ID: P1504, Label: 2
    ID: P1508, Label: 1
    ID: P1510, Label: 1
    ID: P1515, Label: 0
    ID: P1539, Label: 0
    ID: P1540, Label: 0
    ID: P1547, Label: 0
    ID: P1549, Label: 0
    ID: P1558, Label: 0
    ID: P1561, Label: 0
    ID: P1582, Label: 0
    ID: P1603, Label: 0
    ID: P1606, Label: 2
    ID: P1610, Label: 0
    ID: P1622, Label: 0
    ID: P1630, Label: 1
    ID: P1631, Label: 1
    ID: P1685, Label: 1
    ID: P1702, Label: 0
    ID: P1707, Label: 1
    ID: P1718, Label: 0
    ID: P1722, Label: 1
    ID: P1726, Label: 1
  → test 환자 ID 및 라벨:
    ID: P1358, Label: 2
    ID: P1425, Label: 1
    ID: P1516, Label: 0
    ID: P1600, Label: 0
    ID: P1602, Label: 1
    ID: P1617, Label: 2
    ID: P1678, Label: 0
    ID: P1735, Label: 1
전체 데이터 index 길이 42
label_stat (train 환자 라벨 목록) 갯수 34
train_data에서 환자 단위로, train과 validation 나누기
기존 train_p_index 34
기존 (train) label_stat 34
train-vali 분할 후! 
train y 의 classes : {0, 1, 2} valid y 의 classes : {0, 1, 2} label_stat 의 classes : {0, 1, 2}
train_p_index_ 22
valid_p_index 12
test_p_index 8
→ train 환자 ID 및 라벨:
   총 개수: 22
   환자ID=P1718, Label=0, 셀개수=9278
   환자ID=P1515, Label=0, 셀개수=14502
   환자ID=P1304, Label=2, 셀개수=19123
   환자ID=P1462, Label=1, 셀개수=21715
   환자ID=P1606, Label=2, 셀개수=8523
   환자ID=P1631, Label=1, 셀개수=13686
   환자ID=P1422, Label=1, 셀개수=23315
   환자ID=P1726, Label=1, 셀개수=12389
   환자ID=P1707, Label=1, 셀개수=9517
   환자ID=P1540, Label=0, 셀개수=11638
   환자ID=P1685, Label=1, 셀개수=10043
   환자ID=P1508, Label=1, 셀개수=20536
   환자ID=P1430, Label=2, 셀개수=11131
   환자ID=P1630, Label=1, 셀개수=17633
   환자ID=P1622, Label=0, 셀개수=7210
   환자ID=P1510, Label=1, 셀개수=10744
   환자ID=P1603, Label=0, 셀개수=10638
   환자ID=P1504, Label=2, 셀개수=8133
   환자ID=P1479, Label=1, 셀개수=19124
   환자ID=P1447, Label=1, 셀개수=11151
   환자ID=P1561, Label=0, 셀개수=10016
   환자ID=P1539, Label=0, 셀개수=11076
→ valid 환자 ID 및 라벨:
   총 개수: 12
   환자ID=P1300, Label=2, 셀개수=17318
   환자ID=P1437, Label=2, 셀개수=21695
   환자ID=P1547, Label=0, 셀개수=8253
   환자ID=P1472, Label=2, 셀개수=19513
   환자ID=P1290, Label=2, 셀개수=8357
   환자ID=P1558, Label=0, 셀개수=10469
   환자ID=P1722, Label=1, 셀개수=21432
   환자ID=P1549, Label=0, 셀개수=11709
   환자ID=P1702, Label=0, 셀개수=13550
   환자ID=P1371, Label=2, 셀개수=16233
   환자ID=P1610, Label=0, 셀개수=13919
   환자ID=P1582, Label=0, 셀개수=18855
→ test 환자 ID 및 라벨:
   총 개수: 8
   환자ID=P1358, Label=2, 셀개수=23984
   환자ID=P1425, Label=1, 셀개수=15378
   환자ID=P1516, Label=0, 셀개수=9361
   환자ID=P1600, Label=0, 셀개수=14882
   환자ID=P1602, Label=1, 셀개수=16580
   환자ID=P1617, Label=2, 셀개수=17986
   환자ID=P1678, Label=0, 셀개수=10085
   환자ID=P1735, Label=1, 셀개수=12009
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Astrocyte', 'Smooth_muscle_cells', 'Neurons', 'Neuroepithelial_cell', 'Astrocyte', 'Endothelial_cells', 'Osteoblasts', 'Platelets', 'Neurons', 'Hepatocytes']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
전체 데이터 길이 592689
전체 cell type 길이 0                    Astrocyte
1          Smooth_muscle_cells
2                      Neurons
3         Neuroepithelial_cell
4                    Astrocyte
                  ...         
592684       Endothelial_cells
592685       Endothelial_cells
592686     Smooth_muscle_cells
592687             Neutrophils
592688       Endothelial_cells
Length: 592689, dtype: string
cell type의 NaN 개수 체크 0
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:12,  7.73it/s]  2%|▏         | 2/100 [00:00<00:12,  7.83it/s]  3%|▎         | 3/100 [00:00<00:12,  8.05it/s]  4%|▍         | 4/100 [00:00<00:12,  7.83it/s]  5%|▌         | 5/100 [00:00<00:12,  7.87it/s]  6%|▌         | 6/100 [00:00<00:11,  8.02it/s]  7%|▋         | 7/100 [00:00<00:11,  8.05it/s]  8%|▊         | 8/100 [00:01<00:11,  8.00it/s]  9%|▉         | 9/100 [00:01<00:11,  7.85it/s] 10%|█         | 10/100 [00:01<00:11,  7.88it/s] 11%|█         | 11/100 [00:01<00:11,  7.92it/s] 12%|█▏        | 12/100 [00:01<00:11,  7.98it/s] 13%|█▎        | 13/100 [00:01<00:11,  7.86it/s] 14%|█▍        | 14/100 [00:01<00:10,  7.98it/s] 15%|█▌        | 15/100 [00:01<00:10,  7.95it/s] 16%|█▌        | 16/100 [00:02<00:10,  7.66it/s] 17%|█▋        | 17/100 [00:02<00:10,  7.60it/s] 18%|█▊        | 18/100 [00:02<00:10,  7.60it/s] 19%|█▉        | 19/100 [00:02<00:10,  7.57it/s] 20%|██        | 20/100 [00:02<00:10,  7.57it/s] 21%|██        | 21/100 [00:02<00:10,  7.50it/s] 22%|██▏       | 22/100 [00:02<00:10,  7.48it/s] 23%|██▎       | 23/100 [00:02<00:10,  7.45it/s] 24%|██▍       | 24/100 [00:03<00:10,  7.48it/s] 25%|██▌       | 25/100 [00:03<00:10,  7.44it/s] 26%|██▌       | 26/100 [00:03<00:10,  7.38it/s] 27%|██▋       | 27/100 [00:03<00:09,  7.52it/s] 28%|██▊       | 28/100 [00:03<00:09,  7.51it/s] 29%|██▉       | 29/100 [00:03<00:09,  7.60it/s] 30%|███       | 30/100 [00:03<00:09,  7.61it/s] 31%|███       | 31/100 [00:04<00:09,  7.51it/s] 32%|███▏      | 32/100 [00:04<00:08,  7.66it/s] 33%|███▎      | 33/100 [00:04<00:08,  7.48it/s] 34%|███▍      | 34/100 [00:04<00:08,  7.46it/s] 35%|███▌      | 35/100 [00:04<00:08,  7.59it/s] 36%|███▌      | 36/100 [00:04<00:08,  7.63it/s] 37%|███▋      | 37/100 [00:04<00:08,  7.60it/s] 38%|███▊      | 38/100 [00:04<00:08,  7.40it/s] 39%|███▉      | 39/100 [00:05<00:08,  7.40it/s] 40%|████      | 40/100 [00:05<00:08,  7.23it/s] 41%|████      | 41/100 [00:05<00:08,  7.24it/s] 42%|████▏     | 42/100 [00:05<00:08,  7.24it/s] 43%|████▎     | 43/100 [00:05<00:07,  7.37it/s] 44%|████▍     | 44/100 [00:05<00:07,  7.53it/s] 45%|████▌     | 45/100 [00:05<00:07,  7.53it/s] 46%|████▌     | 46/100 [00:06<00:07,  7.59it/s] 47%|████▋     | 47/100 [00:06<00:06,  7.64it/s] 48%|████▊     | 48/100 [00:06<00:06,  7.45it/s] 49%|████▉     | 49/100 [00:06<00:06,  7.33it/s] 50%|█████     | 50/100 [00:06<00:06,  7.34it/s] 51%|█████     | 51/100 [00:06<00:06,  7.43it/s] 52%|█████▏    | 52/100 [00:06<00:06,  7.43it/s] 53%|█████▎    | 53/100 [00:06<00:06,  7.31it/s] 54%|█████▍    | 54/100 [00:07<00:06,  7.34it/s] 55%|█████▌    | 55/100 [00:07<00:06,  7.25it/s] 56%|█████▌    | 56/100 [00:07<00:06,  7.31it/s] 57%|█████▋    | 57/100 [00:07<00:05,  7.32it/s] 58%|█████▊    | 58/100 [00:07<00:05,  7.31it/s] 59%|█████▉    | 59/100 [00:07<00:05,  7.34it/s] 60%|██████    | 60/100 [00:07<00:05,  7.17it/s] 61%|██████    | 61/100 [00:08<00:05,  7.18it/s] 62%|██████▏   | 62/100 [00:08<00:05,  7.23it/s] 63%|██████▎   | 63/100 [00:08<00:05,  7.37it/s] 64%|██████▍   | 64/100 [00:08<00:04,  7.32it/s] 65%|██████▌   | 65/100 [00:08<00:04,  7.18it/s] 66%|██████▌   | 66/100 [00:08<00:04,  7.20it/s] 67%|██████▋   | 67/100 [00:08<00:04,  7.02it/s] 68%|██████▊   | 68/100 [00:09<00:04,  7.07it/s] 69%|██████▉   | 69/100 [00:09<00:04,  6.98it/s] 70%|███████   | 70/100 [00:09<00:04,  7.04it/s] 71%|███████   | 71/100 [00:09<00:04,  7.04it/s] 72%|███████▏  | 72/100 [00:09<00:03,  7.11it/s] 73%|███████▎  | 73/100 [00:09<00:03,  6.96it/s] 74%|███████▍  | 74/100 [00:09<00:03,  7.04it/s] 75%|███████▌  | 75/100 [00:10<00:03,  6.99it/s] 76%|███████▌  | 76/100 [00:10<00:03,  7.01it/s] 77%|███████▋  | 77/100 [00:10<00:03,  6.95it/s] 78%|███████▊  | 78/100 [00:10<00:03,  7.02it/s] 79%|███████▉  | 79/100 [00:10<00:03,  6.98it/s] 80%|████████  | 80/100 [00:10<00:02,  6.97it/s] 81%|████████  | 81/100 [00:10<00:02,  6.95it/s] 82%|████████▏ | 82/100 [00:11<00:02,  7.05it/s] 83%|████████▎ | 83/100 [00:11<00:02,  7.09it/s] 84%|████████▍ | 84/100 [00:11<00:02,  7.07it/s] 85%|████████▌ | 85/100 [00:11<00:02,  6.90it/s] 86%|████████▌ | 86/100 [00:11<00:02,  6.93it/s] 87%|████████▋ | 87/100 [00:11<00:01,  6.72it/s] 88%|████████▊ | 88/100 [00:11<00:01,  6.85it/s] 89%|████████▉ | 89/100 [00:12<00:01,  6.78it/s] 90%|█████████ | 90/100 [00:12<00:01,  6.74it/s] 91%|█████████ | 91/100 [00:12<00:01,  6.69it/s] 92%|█████████▏| 92/100 [00:12<00:01,  6.79it/s] 93%|█████████▎| 93/100 [00:12<00:01,  6.92it/s] 94%|█████████▍| 94/100 [00:12<00:00,  6.76it/s] 95%|█████████▌| 95/100 [00:12<00:00,  6.75it/s] 96%|█████████▌| 96/100 [00:13<00:00,  6.70it/s] 97%|█████████▋| 97/100 [00:13<00:00,  6.81it/s] 98%|█████████▊| 98/100 [00:13<00:00,  6.90it/s] 99%|█████████▉| 99/100 [00:13<00:00,  7.03it/s]100%|██████████| 100/100 [00:13<00:00,  6.90it/s]100%|██████████| 100/100 [00:13<00:00,  7.29it/s]
[I 2025-08-29 06:03:45,587] A new study created in memory with name: no-name-bc693e61-ef46-47a7-8e09-014ac4fa377a
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 19.85 MB
Memory Reserved: 42.00 MB
cuda
CUDA OOM 발생 — 단계적 백오프 시작.
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 16934.53 MB
Memory Reserved: 16952.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 341.79 MB
Memory Reserved: 380.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 16933.90 MB
Memory Reserved: 16960.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 342.12 MB
Memory Reserved: 380.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[I 2025-08-29 06:03:46,935] Trial 0 pruned. Pruned due to OOM after backoff
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 16930.11 MB
Memory Reserved: 16960.00 MB
cuda
Epoch 1, Train Loss 1.109063, Valid_loss 1.113545
Epoch 2, Train Loss 1.003410, Valid_loss 1.167176
Epoch 3, Train Loss 0.910753, Valid_loss 1.271311
Epoch 4, Train Loss 0.903191, Valid_loss 1.318382
Epoch 5, Train Loss 0.898306, Valid_loss 1.389915
Epoch 6, Train Loss 0.899372, Valid_loss 1.354312
Epoch 7, Train Loss 0.897716, Valid_loss 1.311120
Epoch 8, Train Loss 0.841599, Valid_loss 1.039951
Epoch 9, Train Loss 0.977293, Valid_loss 1.573280
Epoch 10, Train Loss 0.897642, Valid_loss 1.544806
Epoch 11, Train Loss 0.901016, Valid_loss 1.523036
Epoch 12, Train Loss 0.864609, Valid_loss 1.521620
Epoch 13, Train Loss 0.822101, Valid_loss 1.535504
Epoch 14, Train Loss 0.805346, Valid_loss 1.500360
Epoch 15, Train Loss 0.806927, Valid_loss 1.349523
Epoch 16, Train Loss 0.805481, Valid_loss 1.373533
Epoch 17, Train Loss 0.782197, Valid_loss 1.351170
Epoch 18, Train Loss 0.767641, Valid_loss 1.295841
Epoch 19, Train Loss 0.743906, Valid_loss 1.350907
Epoch 20, Train Loss 0.706676, Valid_loss 1.324594
Epoch 21, Train Loss 0.748658, Valid_loss 1.333011
Epoch 22, Train Loss 0.727737, Valid_loss 1.356618
Epoch 23, Train Loss 0.671699, Valid_loss 1.302494
Epoch 24, Train Loss 0.709779, Valid_loss 1.668517
Epoch 25, Train Loss 1.020103, Valid_loss 1.508869
Epoch 26, Train Loss 0.890395, Valid_loss 1.508944
Epoch 27, Train Loss 0.874348, Valid_loss 1.532334
Epoch 28, Train Loss 0.874797, Valid_loss 1.489307
Epoch 29, Train Loss 0.850904, Valid_loss 1.524091
Epoch 30, Train Loss 0.845775, Valid_loss 1.538145
Epoch 31, Train Loss 0.879881, Valid_loss 1.515296
Epoch 32, Train Loss 0.847716, Valid_loss 1.536454
Epoch 33, Train Loss 0.838179, Valid_loss 1.570629
Epoch 34, Train Loss 0.859708, Valid_loss 1.589745
Epoch 35, Train Loss 0.831240, Valid_loss 1.589226
Epoch 36, Train Loss 0.856464, Valid_loss 1.576686
Epoch 37, Train Loss 0.837439, Valid_loss 1.604972
Epoch 38, Train Loss 0.838142, Valid_loss 1.602680
Epoch 39, Train Loss 0.829730, Valid_loss 1.631156
Epoch 40, Train Loss 0.734766, Valid_loss 1.666799
Epoch 41, Train Loss 0.864025, Valid_loss 1.633192
Epoch 42, Train Loss 0.839394, Valid_loss 1.422696
Epoch 43, Train Loss 0.754384, Valid_loss 1.519190
Epoch 44, Train Loss 0.730416, Valid_loss 1.515976
Epoch 45, Train Loss 0.735923, Valid_loss 1.437498
Epoch 46, Train Loss 0.740717, Valid_loss 1.448410
Epoch 47, Train Loss 0.711027, Valid_loss 1.420283
Epoch 48, Train Loss 0.684975, Valid_loss 1.420123
Epoch 49, Train Loss 0.721958, Valid_loss 1.304063
Epoch 50, Train Loss 0.703980, Valid_loss 1.284589
Epoch 51, Train Loss 0.632592, Valid_loss 1.284025
Epoch 52, Train Loss 0.572265, Valid_loss 1.265205
Epoch 53, Train Loss 0.638371, Valid_loss 1.243310
Epoch 54, Train Loss 0.549098, Valid_loss 1.255931
Epoch 55, Train Loss 0.530613, Valid_loss 1.284366
[I 2025-08-29 06:25:16,019] Trial 1 finished with value: 1.0399511406819026 and parameters: {'learning_rate': 0.001, 'epochs': 100, 'heads': 1, 'dropout': 0.7, 'weight_decay': 0.001, 'emb_dim': 8, 'augment_num': 100, 'pca': False}. Best is trial 1 with value: 1.0399511406819026.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 16.69 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.927474, Valid_loss 1.833515
Epoch 2, Train Loss 0.914318, Valid_loss 1.490796
Epoch 3, Train Loss 0.832551, Valid_loss 1.721230
Epoch 4, Train Loss 0.863850, Valid_loss 1.844493
Epoch 5, Train Loss 0.855293, Valid_loss 1.596251
Epoch 6, Train Loss 0.851389, Valid_loss 1.617800
Epoch 7, Train Loss 0.841554, Valid_loss 1.628203
Epoch 8, Train Loss 0.819507, Valid_loss 1.842065
Epoch 9, Train Loss 0.835510, Valid_loss 1.744671
Epoch 10, Train Loss 0.862987, Valid_loss 1.665652
Epoch 11, Train Loss 0.845462, Valid_loss 1.686567
Epoch 12, Train Loss 0.853324, Valid_loss 1.653354
Epoch 13, Train Loss 0.844615, Valid_loss 1.588198
Epoch 14, Train Loss 0.828692, Valid_loss 1.604405
Epoch 15, Train Loss 0.839687, Valid_loss 1.675414
Epoch 16, Train Loss 0.844108, Valid_loss 1.657563
Epoch 17, Train Loss 0.841330, Valid_loss 1.685227
Epoch 18, Train Loss 0.834877, Valid_loss 1.696557
Epoch 19, Train Loss 0.831750, Valid_loss 1.668980
Epoch 20, Train Loss 0.839530, Valid_loss 1.732033
Epoch 21, Train Loss 0.841971, Valid_loss 1.672580
Epoch 22, Train Loss 0.831727, Valid_loss 1.675023
Epoch 23, Train Loss 0.836098, Valid_loss 1.669458
Epoch 24, Train Loss 0.843153, Valid_loss 1.688829
Epoch 25, Train Loss 0.840525, Valid_loss 1.718485
Epoch 26, Train Loss 0.833037, Valid_loss 1.761149
Epoch 27, Train Loss 0.840667, Valid_loss 1.738763
Epoch 28, Train Loss 0.839753, Valid_loss 1.774116
Epoch 29, Train Loss 0.837750, Valid_loss 1.758205
Epoch 30, Train Loss 0.835764, Valid_loss 1.751703
Epoch 31, Train Loss 0.836954, Valid_loss 1.778494
Epoch 32, Train Loss 0.839064, Valid_loss 1.783063
Epoch 33, Train Loss 0.834972, Valid_loss 1.806101
Epoch 34, Train Loss 0.834680, Valid_loss 1.794422
Epoch 35, Train Loss 0.837519, Valid_loss 1.795427
Epoch 36, Train Loss 0.834909, Valid_loss 1.787342
Epoch 37, Train Loss 0.836410, Valid_loss 1.786402
Epoch 38, Train Loss 0.836092, Valid_loss 1.801008
Epoch 39, Train Loss 0.837467, Valid_loss 1.786527
Epoch 40, Train Loss 0.836456, Valid_loss 1.834650
Epoch 41, Train Loss 0.836568, Valid_loss 1.816029
Epoch 42, Train Loss 0.838229, Valid_loss 1.800349
Epoch 43, Train Loss 0.835566, Valid_loss 1.791388
Epoch 44, Train Loss 0.835300, Valid_loss 1.813291
Epoch 45, Train Loss 0.833997, Valid_loss 1.813565
Epoch 46, Train Loss 0.860374, Valid_loss 2.194323
Epoch 47, Train Loss 0.840358, Valid_loss 1.738899
Epoch 48, Train Loss 0.837307, Valid_loss 1.772816
Epoch 49, Train Loss 0.835405, Valid_loss 1.797271
Epoch 50, Train Loss 0.834789, Valid_loss 1.786788
Epoch 51, Train Loss 0.834329, Valid_loss 1.792037
Epoch 52, Train Loss 0.834906, Valid_loss 1.792813
[I 2025-08-29 06:54:45,785] Trial 2 finished with value: 1.4907964915037155 and parameters: {'learning_rate': 0.01, 'epochs': 100, 'heads': 2, 'dropout': 0.5, 'weight_decay': 0.0001, 'emb_dim': 8, 'augment_num': 100, 'pca': False}. Best is trial 1 with value: 1.0399511406819026.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 18.01 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.885212, Valid_loss 2.149441
Epoch 2, Train Loss 0.876267, Valid_loss 1.549535
Epoch 3, Train Loss 0.864093, Valid_loss 1.599688
Epoch 4, Train Loss 0.862768, Valid_loss 1.751453
Epoch 5, Train Loss 0.852818, Valid_loss 1.838179
Epoch 6, Train Loss 0.857608, Valid_loss 1.344847
Epoch 7, Train Loss 0.872081, Valid_loss 1.815466
Epoch 8, Train Loss 0.843241, Valid_loss 1.867946
Epoch 9, Train Loss 0.851028, Valid_loss 1.736423
Epoch 10, Train Loss 0.865823, Valid_loss 1.802698
Epoch 11, Train Loss 0.854663, Valid_loss 1.593806
Epoch 12, Train Loss 0.845629, Valid_loss 1.597614
Epoch 13, Train Loss 0.851132, Valid_loss 1.868463
Epoch 14, Train Loss 0.846560, Valid_loss 1.696448
Epoch 15, Train Loss 0.846150, Valid_loss 1.668540
Epoch 16, Train Loss 0.877948, Valid_loss 1.463974
Epoch 17, Train Loss 0.850597, Valid_loss 1.905281
Epoch 18, Train Loss 0.847755, Valid_loss 1.883340
Epoch 19, Train Loss 0.849178, Valid_loss 1.480491
Epoch 20, Train Loss 0.851976, Valid_loss 1.817401
Epoch 21, Train Loss 0.846083, Valid_loss 1.687211
Epoch 22, Train Loss 0.845341, Valid_loss 1.850170
Epoch 23, Train Loss 0.847390, Valid_loss 1.921578
Epoch 24, Train Loss 0.844670, Valid_loss 1.867080
Epoch 25, Train Loss 0.851713, Valid_loss 1.816872
Epoch 26, Train Loss 0.870830, Valid_loss 1.638796
Epoch 27, Train Loss 0.851606, Valid_loss 1.673570
Epoch 28, Train Loss 0.846273, Valid_loss 1.763448
Epoch 29, Train Loss 0.848472, Valid_loss 1.690844
Epoch 30, Train Loss 0.846740, Valid_loss 1.748412
Epoch 31, Train Loss 0.854442, Valid_loss 1.694693
Epoch 32, Train Loss 0.860575, Valid_loss 2.549054
Epoch 33, Train Loss 0.862159, Valid_loss 1.748911
Epoch 34, Train Loss 0.844155, Valid_loss 1.620970
Epoch 35, Train Loss 0.841483, Valid_loss 1.902128
Epoch 36, Train Loss 0.845074, Valid_loss 1.761352
Epoch 37, Train Loss 0.847067, Valid_loss 1.894408
Epoch 38, Train Loss 0.848603, Valid_loss 1.845769
Epoch 39, Train Loss 0.849959, Valid_loss 1.451180
Epoch 40, Train Loss 0.851430, Valid_loss 1.875949
Epoch 41, Train Loss 0.843568, Valid_loss 1.744560
Epoch 42, Train Loss 0.847364, Valid_loss 1.856438
Epoch 43, Train Loss 0.845951, Valid_loss 1.823458
Epoch 44, Train Loss 0.843238, Valid_loss 1.829595
Epoch 45, Train Loss 0.842488, Valid_loss 1.810866
Epoch 46, Train Loss 0.845296, Valid_loss 1.753735
Epoch 47, Train Loss 0.848415, Valid_loss 1.587550
Epoch 48, Train Loss 0.846704, Valid_loss 1.748990
Epoch 49, Train Loss 0.845765, Valid_loss 1.620805
Epoch 50, Train Loss 0.856604, Valid_loss 1.784944
Epoch 51, Train Loss 0.846230, Valid_loss 1.778399
Epoch 52, Train Loss 0.836835, Valid_loss 1.820540
Epoch 53, Train Loss 0.840241, Valid_loss 1.694374
Epoch 54, Train Loss 0.842703, Valid_loss 1.732740
Epoch 55, Train Loss 0.840954, Valid_loss 1.784412
[I 2025-08-29 07:15:04,273] Trial 3 finished with value: 1.3448468744754791 and parameters: {'learning_rate': 0.01, 'epochs': 100, 'heads': 1, 'dropout': 0.0, 'weight_decay': 0.01, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 1 with value: 1.0399511406819026.
선택된 trial params: {'learning_rate': 0.001, 'epochs': 100, 'heads': 1, 'dropout': 0.7, 'weight_decay': 0.001, 'emb_dim': 8, 'augment_num': 100, 'pca': False}
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=8, batch_size=1 -> steps=8
Memory Allocated: 16.69 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 1.126644, Valid_loss 1.178987
Epoch 2, Train Loss 0.987245, Valid_loss 1.244634
Epoch 3, Train Loss 0.991592, Valid_loss 1.255517
Epoch 4, Train Loss 0.885713, Valid_loss 1.307876
Epoch 5, Train Loss 0.886995, Valid_loss 1.387374
Epoch 6, Train Loss 0.870641, Valid_loss 1.374445
Epoch 7, Train Loss 0.816034, Valid_loss 1.454098
Epoch 8, Train Loss 0.803637, Valid_loss 1.368344
Epoch 9, Train Loss 0.903563, Valid_loss 1.263723
Epoch 10, Train Loss 0.775946, Valid_loss 1.518307
Epoch 11, Train Loss 0.742829, Valid_loss 1.441514
Epoch 12, Train Loss 0.745282, Valid_loss 1.267016
Epoch 13, Train Loss 0.726217, Valid_loss 1.362668
Epoch 14, Train Loss 0.700493, Valid_loss 1.392185
Epoch 15, Train Loss 0.664897, Valid_loss 1.324339
Epoch 16, Train Loss 0.611861, Valid_loss 1.429244
Epoch 17, Train Loss 1.013952, Valid_loss 1.658952
Epoch 18, Train Loss 0.812883, Valid_loss 1.195074
Epoch 19, Train Loss 0.745330, Valid_loss 1.202271
Epoch 20, Train Loss 0.589591, Valid_loss 1.168392
Epoch 21, Train Loss 0.741522, Valid_loss 1.266547
Epoch 22, Train Loss 0.645968, Valid_loss 1.356668
Epoch 23, Train Loss 0.698351, Valid_loss 1.344871
Epoch 24, Train Loss 0.611311, Valid_loss 1.268009
Epoch 25, Train Loss 0.619359, Valid_loss 1.209414
Epoch 26, Train Loss 0.630829, Valid_loss 1.562439
Epoch 27, Train Loss 0.596573, Valid_loss 1.443259
Epoch 28, Train Loss 0.609540, Valid_loss 1.662851
Epoch 29, Train Loss 0.607829, Valid_loss 1.233943
Epoch 30, Train Loss 0.599168, Valid_loss 1.290550
Epoch 31, Train Loss 0.618653, Valid_loss 1.347874
Epoch 32, Train Loss 0.615191, Valid_loss 1.428868
Epoch 33, Train Loss 0.607773, Valid_loss 1.469653
Epoch 34, Train Loss 0.548193, Valid_loss 1.216586
Epoch 35, Train Loss 0.693332, Valid_loss 1.127593
Epoch 36, Train Loss 0.631544, Valid_loss 1.142131
Epoch 37, Train Loss 0.541589, Valid_loss 1.348213
Epoch 38, Train Loss 0.532991, Valid_loss 1.155193
Epoch 39, Train Loss 0.466139, Valid_loss 1.203663
Epoch 40, Train Loss 0.508792, Valid_loss 1.169410
Epoch 41, Train Loss 0.676363, Valid_loss 1.175327
Epoch 42, Train Loss 0.601879, Valid_loss 1.419037
Epoch 43, Train Loss 0.568882, Valid_loss 1.156243
Epoch 44, Train Loss 0.497314, Valid_loss 1.302041
Epoch 45, Train Loss 0.592749, Valid_loss 1.209065
Epoch 46, Train Loss 0.532144, Valid_loss 1.256252
Epoch 47, Train Loss 0.492545, Valid_loss 1.423082
Epoch 48, Train Loss 0.448708, Valid_loss 2.150162
Epoch 49, Train Loss 0.513341, Valid_loss 1.244608
Epoch 50, Train Loss 0.543010, Valid_loss 1.671722
Epoch 51, Train Loss 0.507194, Valid_loss 1.641346
Epoch 52, Train Loss 0.506267, Valid_loss 1.340414
Epoch 53, Train Loss 0.449802, Valid_loss 1.359294
Epoch 54, Train Loss 0.608305, Valid_loss 1.172775
Epoch 55, Train Loss 0.506481, Valid_loss 1.339875
Epoch 56, Train Loss 0.498194, Valid_loss 1.168868
Epoch 57, Train Loss 0.478074, Valid_loss 1.160391
Epoch 58, Train Loss 0.443098, Valid_loss 1.164118
Epoch 59, Train Loss 0.422794, Valid_loss 1.171217
환자ID=P1358 -- true: [[2]] -- pred: tensor([[-0.4006,  1.0278, -1.0894]], device='cuda:0')
환자ID=P1425 -- true: [[1]] -- pred: tensor([[-0.3980,  1.0110, -1.0885]], device='cuda:0')
환자ID=P1516 -- true: [[0]] -- pred: tensor([[ 1.7278,  0.0722, -2.9784]], device='cuda:0')
환자ID=P1600 -- true: [[0]] -- pred: tensor([[ 1.7219,  0.0716, -2.9721]], device='cuda:0')
환자ID=P1602 -- true: [[1]] -- pred: tensor([[-0.4143,  1.0555, -1.1009]], device='cuda:0')
환자ID=P1617 -- true: [[2]] -- pred: tensor([[-0.3979,  1.0208, -1.0876]], device='cuda:0')
환자ID=P1678 -- true: [[0]] -- pred: tensor([[ 1.7206,  0.0710, -2.9710]], device='cuda:0')
환자ID=P1735 -- true: [[1]] -- pred: tensor([[-0.3957,  1.0126, -1.0870]], device='cuda:0')
Best performance: Epoch 35, Loss 0.693332, Test ACC 0.750000, Test AUC 0.777778, Test Recall 0.666667, Test Precision 0.533333
Confusion Matrix:
 [[3 0 0]
 [0 3 0]
 [0 2 0]]
✅ Total valid splits used: 5

📌 Repeat 0: 평균 AUC = 0.8185, 표준편차 = 0.1520
Test ACC 평균 0.694444, Test Recall 평균 0.622222, Test Precision 평균 0.505185
fold_aucs = [0.5555555555555556, 0.9259259259259259, 0.8333333333333334, 1.0, 0.7777777777777778]
NaN 개수: 0 / 전체 5개

🔁 Repeat 1, Fold 0
cell type :  ACAGCCGCAAGCGAGT-1-1                 Neurons
ATATCCTGTCCCTAAA-1-1       Endothelial_cells
CAATGACCAGTTGTCA-1-1                 Neurons
CTAGACACAAGGTTGG-1-1                 Neurons
ATCGTCCGTATTTCTC-1-1     Smooth_muscle_cells
                                ...         
TTATTGCGTCGGTGTC-1-79      Endothelial_cells
GTCACGGGTTGTATGC-1-79      Endothelial_cells
GTCATGATCTTTCGAT-1-79      Endothelial_cells
GCGATCGTCAGAGTGG-1-79              Platelets
GCCCGAACAGAGAAAG-1-79      Endothelial_cells
Name: singler_annotation, Length: 462466, dtype: string
cell type annotation :  ACAGCCGCAAGCGAGT-1-1                 Neurons
ATATCCTGTCCCTAAA-1-1       Endothelial_cells
CAATGACCAGTTGTCA-1-1                 Neurons
CTAGACACAAGGTTGG-1-1                 Neurons
ATCGTCCGTATTTCTC-1-1     Smooth_muscle_cells
                                ...         
TTATTGCGTCGGTGTC-1-79      Endothelial_cells
GTCACGGGTTGTATGC-1-79      Endothelial_cells
GTCATGATCTTTCGAT-1-79      Endothelial_cells
GCGATCGTCAGAGTGG-1-79              Platelets
GCCCGAACAGAGAAAG-1-79      Endothelial_cells
Name: singler_annotation, Length: 462466, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Neurons', 'Endothelial_cells', 'Smooth_muscle_cells', 'Neuroepithelial_cell', 'Astrocyte', 'Fibroblasts', 'Osteoblasts', 'Erythroblast', 'iPS_cells', 'Embryonic_stem_cells', 'Platelets', 'MSC', 'Hepatocytes', 'NK_cell', 'MEP', 'BM & Prog.', 'Gametocytes', 'Chondrocytes', 'HSC_CD34+', 'Tissue_stem_cells', 'Macrophage', 'Monocyte', 'Neutrophils', 'DC', 'HSC_-G-CSF', 'Unknown', 'Keratinocytes', 'B_cell', 'T_cells', 'Myelocyte', 'Epithelial_cells', 'GMP', 'BM', 'Pro-Myelocyte', 'Pro-B_cell_CD34+', 'CMP', 'Pre-B_cell_CD34-']
라벨별 그룹 개수 {2: 9, 1: 12, 0: 12}
cell type :  TTCTTCCGTTCAACGT-1-0                Astrocyte
CATCCACCATCTAACG-1-0      Smooth_muscle_cells
ACCCAAACAGCTAACT-1-0                  Neurons
AAGGAATCAACTGGTT-1-0     Neuroepithelial_cell
TACCCGTAGCGTGCTC-1-0                Astrocyte
                                 ...         
AAGTGAAGTGGCGTAA-1-71       Endothelial_cells
CTTTCAAGTTTCACAG-1-71            Chondrocytes
GGGTGAATCATCGACA-1-71               Platelets
CTGTGGGAGGAGGTTC-1-71             Neutrophils
TGTTCATTCTGGCCGA-1-71       Endothelial_cells
Name: singler_annotation, Length: 130223, dtype: string
cell type annotation :  TTCTTCCGTTCAACGT-1-0                Astrocyte
CATCCACCATCTAACG-1-0      Smooth_muscle_cells
ACCCAAACAGCTAACT-1-0                  Neurons
AAGGAATCAACTGGTT-1-0     Neuroepithelial_cell
TACCCGTAGCGTGCTC-1-0                Astrocyte
                                 ...         
AAGTGAAGTGGCGTAA-1-71       Endothelial_cells
CTTTCAAGTTTCACAG-1-71            Chondrocytes
GGGTGAATCATCGACA-1-71               Platelets
CTGTGGGAGGAGGTTC-1-71             Neutrophils
TGTTCATTCTGGCCGA-1-71       Endothelial_cells
Name: singler_annotation, Length: 130223, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Astrocyte', 'Smooth_muscle_cells', 'Neurons', 'Neuroepithelial_cell', 'Endothelial_cells', 'Osteoblasts', 'Platelets', 'Hepatocytes', 'Embryonic_stem_cells', 'MEP', 'Erythroblast', 'Fibroblasts', 'iPS_cells', 'MSC', 'Macrophage', 'Gametocytes', 'Chondrocytes', 'NK_cell', 'Neutrophils', 'HSC_CD34+', 'Monocyte', 'Tissue_stem_cells', 'DC', 'HSC_-G-CSF', 'T_cells', 'Epithelial_cells', 'Unknown', 'Pre-B_cell_CD34-', 'GMP', 'B_cell', 'Pro-Myelocyte', 'Keratinocytes', 'Myelocyte', 'BM', 'CMP', 'BM & Prog.', 'Pro-B_cell_CD34+']
라벨별 그룹 개수 {2: 2, 1: 3, 0: 4}
🔍 Split #1
  → train_p_index 환자 수 (환자 단위로 묶인 index list): 33
  → test_p_index 환자 수  (환자 단위로 묶인 index list): 9
  → train 환자 ID: ['P1290', 'P1300', 'P1358', 'P1371', 'P1422', 'P1425', 'P1430', 'P1447', 'P1462', 'P1472', 'P1479', 'P1504', 'P1515', 'P1516', 'P1539', 'P1540', 'P1547', 'P1549', 'P1558', 'P1561', 'P1582', 'P1600', 'P1602', 'P1603', 'P1606', 'P1617', 'P1631', 'P1685', 'P1702', 'P1707', 'P1722', 'P1726', 'P1735']
  → test  환자 ID: ['P1304', 'P1437', 'P1508', 'P1510', 'P1610', 'P1622', 'P1630', 'P1678', 'P1718']
  → train 환자 ID 및 라벨:
    ID: P1290, Label: 2
    ID: P1300, Label: 2
    ID: P1358, Label: 2
    ID: P1371, Label: 2
    ID: P1422, Label: 1
    ID: P1425, Label: 1
    ID: P1430, Label: 2
    ID: P1447, Label: 1
    ID: P1462, Label: 1
    ID: P1472, Label: 2
    ID: P1479, Label: 1
    ID: P1504, Label: 2
    ID: P1515, Label: 0
    ID: P1516, Label: 0
    ID: P1539, Label: 0
    ID: P1540, Label: 0
    ID: P1547, Label: 0
    ID: P1549, Label: 0
    ID: P1558, Label: 0
    ID: P1561, Label: 0
    ID: P1582, Label: 0
    ID: P1600, Label: 0
    ID: P1602, Label: 1
    ID: P1603, Label: 0
    ID: P1606, Label: 2
    ID: P1617, Label: 2
    ID: P1631, Label: 1
    ID: P1685, Label: 1
    ID: P1702, Label: 0
    ID: P1707, Label: 1
    ID: P1722, Label: 1
    ID: P1726, Label: 1
    ID: P1735, Label: 1
  → test 환자 ID 및 라벨:
    ID: P1304, Label: 2
    ID: P1437, Label: 2
    ID: P1508, Label: 1
    ID: P1510, Label: 1
    ID: P1610, Label: 0
    ID: P1622, Label: 0
    ID: P1630, Label: 1
    ID: P1678, Label: 0
    ID: P1718, Label: 0
전체 데이터 index 길이 42
label_stat (train 환자 라벨 목록) 갯수 33
train_data에서 환자 단위로, train과 validation 나누기
기존 train_p_index 33
기존 (train) label_stat 33
train-vali 분할 후! 
train y 의 classes : {0, 1, 2} valid y 의 classes : {0, 1, 2} label_stat 의 classes : {0, 1, 2}
train_p_index_ 22
valid_p_index 11
test_p_index 9
→ train 환자 ID 및 라벨:
   총 개수: 22
   환자ID=P1600, Label=0, 셀개수=14882
   환자ID=P1722, Label=1, 셀개수=21432
   환자ID=P1539, Label=0, 셀개수=11076
   환자ID=P1358, Label=2, 셀개수=23984
   환자ID=P1462, Label=1, 셀개수=21715
   환자ID=P1603, Label=0, 셀개수=10638
   환자ID=P1631, Label=1, 셀개수=13686
   환자ID=P1422, Label=1, 셀개수=23315
   환자ID=P1735, Label=1, 셀개수=12009
   환자ID=P1707, Label=1, 셀개수=9517
   환자ID=P1547, Label=0, 셀개수=8253
   환자ID=P1685, Label=1, 셀개수=10043
   환자ID=P1515, Label=0, 셀개수=14502
   환자ID=P1425, Label=1, 셀개수=15378
   환자ID=P1617, Label=2, 셀개수=17986
   환자ID=P1516, Label=0, 셀개수=9361
   환자ID=P1602, Label=1, 셀개수=16580
   환자ID=P1504, Label=2, 셀개수=8133
   환자ID=P1479, Label=1, 셀개수=19124
   환자ID=P1447, Label=1, 셀개수=11151
   환자ID=P1582, Label=0, 셀개수=18855
   환자ID=P1540, Label=0, 셀개수=11638
→ valid 환자 ID 및 라벨:
   총 개수: 11
   환자ID=P1300, Label=2, 셀개수=17318
   환자ID=P1430, Label=2, 셀개수=11131
   환자ID=P1549, Label=0, 셀개수=11709
   환자ID=P1472, Label=2, 셀개수=19513
   환자ID=P1290, Label=2, 셀개수=8357
   환자ID=P1561, Label=0, 셀개수=10016
   환자ID=P1726, Label=1, 셀개수=12389
   환자ID=P1558, Label=0, 셀개수=10469
   환자ID=P1702, Label=0, 셀개수=13550
   환자ID=P1371, Label=2, 셀개수=16233
   환자ID=P1606, Label=2, 셀개수=8523
→ test 환자 ID 및 라벨:
   총 개수: 9
   환자ID=P1304, Label=2, 셀개수=19123
   환자ID=P1437, Label=2, 셀개수=21695
   환자ID=P1508, Label=1, 셀개수=20536
   환자ID=P1510, Label=1, 셀개수=10744
   환자ID=P1610, Label=0, 셀개수=13919
   환자ID=P1622, Label=0, 셀개수=7210
   환자ID=P1630, Label=1, 셀개수=17633
   환자ID=P1678, Label=0, 셀개수=10085
   환자ID=P1718, Label=0, 셀개수=9278
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Neurons', 'Endothelial_cells', 'Neurons', 'Neurons', 'Smooth_muscle_cells', 'Smooth_muscle_cells', 'Neurons', 'Endothelial_cells', 'Neurons', 'Neurons']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
전체 데이터 길이 592689
전체 cell type 길이 0                     Neurons
1           Endothelial_cells
2                     Neurons
3                     Neurons
4         Smooth_muscle_cells
                 ...         
592684      Endothelial_cells
592685           Chondrocytes
592686              Platelets
592687            Neutrophils
592688      Endothelial_cells
Length: 592689, dtype: string
cell type의 NaN 개수 체크 0
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:13,  7.42it/s]  2%|▏         | 2/100 [00:00<00:12,  7.62it/s]  3%|▎         | 3/100 [00:00<00:12,  7.60it/s]  4%|▍         | 4/100 [00:00<00:12,  7.67it/s]  5%|▌         | 5/100 [00:00<00:12,  7.77it/s]  6%|▌         | 6/100 [00:00<00:12,  7.72it/s]  7%|▋         | 7/100 [00:00<00:12,  7.63it/s]  8%|▊         | 8/100 [00:01<00:11,  7.72it/s]  9%|▉         | 9/100 [00:01<00:11,  7.77it/s] 10%|█         | 10/100 [00:01<00:11,  7.77it/s] 11%|█         | 11/100 [00:01<00:11,  7.66it/s] 12%|█▏        | 12/100 [00:01<00:11,  7.69it/s] 13%|█▎        | 13/100 [00:01<00:11,  7.60it/s] 14%|█▍        | 14/100 [00:01<00:11,  7.44it/s] 15%|█▌        | 15/100 [00:01<00:11,  7.47it/s] 16%|█▌        | 16/100 [00:02<00:11,  7.46it/s] 17%|█▋        | 17/100 [00:02<00:10,  7.55it/s] 18%|█▊        | 18/100 [00:02<00:10,  7.46it/s] 19%|█▉        | 19/100 [00:02<00:10,  7.48it/s] 20%|██        | 20/100 [00:02<00:10,  7.59it/s] 21%|██        | 21/100 [00:02<00:10,  7.60it/s] 22%|██▏       | 22/100 [00:02<00:10,  7.60it/s] 23%|██▎       | 23/100 [00:03<00:10,  7.54it/s] 24%|██▍       | 24/100 [00:03<00:10,  7.55it/s] 25%|██▌       | 25/100 [00:03<00:09,  7.68it/s] 26%|██▌       | 26/100 [00:03<00:09,  7.42it/s] 27%|██▋       | 27/100 [00:03<00:09,  7.39it/s] 28%|██▊       | 28/100 [00:03<00:09,  7.38it/s] 29%|██▉       | 29/100 [00:03<00:09,  7.33it/s] 30%|███       | 30/100 [00:03<00:09,  7.36it/s] 31%|███       | 31/100 [00:04<00:09,  7.40it/s] 32%|███▏      | 32/100 [00:04<00:09,  7.45it/s] 33%|███▎      | 33/100 [00:04<00:09,  7.41it/s] 34%|███▍      | 34/100 [00:04<00:08,  7.36it/s] 35%|███▌      | 35/100 [00:04<00:08,  7.31it/s] 36%|███▌      | 36/100 [00:04<00:08,  7.23it/s] 37%|███▋      | 37/100 [00:04<00:08,  7.35it/s] 38%|███▊      | 38/100 [00:05<00:08,  7.44it/s] 39%|███▉      | 39/100 [00:05<00:08,  7.37it/s] 40%|████      | 40/100 [00:05<00:08,  7.34it/s] 41%|████      | 41/100 [00:05<00:08,  7.22it/s] 42%|████▏     | 42/100 [00:05<00:08,  7.07it/s] 43%|████▎     | 43/100 [00:05<00:08,  7.09it/s] 44%|████▍     | 44/100 [00:05<00:07,  7.26it/s] 45%|████▌     | 45/100 [00:06<00:07,  7.18it/s] 46%|████▌     | 46/100 [00:06<00:07,  7.19it/s] 47%|████▋     | 47/100 [00:06<00:07,  7.26it/s] 48%|████▊     | 48/100 [00:06<00:07,  7.20it/s] 49%|████▉     | 49/100 [00:06<00:07,  7.20it/s] 50%|█████     | 50/100 [00:06<00:06,  7.22it/s] 51%|█████     | 51/100 [00:06<00:06,  7.31it/s] 52%|█████▏    | 52/100 [00:07<00:06,  7.24it/s] 53%|█████▎    | 53/100 [00:07<00:06,  7.16it/s] 54%|█████▍    | 54/100 [00:07<00:06,  7.14it/s] 55%|█████▌    | 55/100 [00:07<00:06,  7.16it/s] 56%|█████▌    | 56/100 [00:07<00:06,  7.08it/s] 57%|█████▋    | 57/100 [00:07<00:06,  7.16it/s] 58%|█████▊    | 58/100 [00:07<00:06,  6.98it/s] 59%|█████▉    | 59/100 [00:07<00:05,  7.06it/s] 60%|██████    | 60/100 [00:08<00:05,  7.01it/s] 61%|██████    | 61/100 [00:08<00:05,  6.93it/s] 62%|██████▏   | 62/100 [00:08<00:05,  6.95it/s] 63%|██████▎   | 63/100 [00:08<00:05,  6.92it/s] 64%|██████▍   | 64/100 [00:08<00:05,  6.91it/s] 65%|██████▌   | 65/100 [00:08<00:05,  6.98it/s] 66%|██████▌   | 66/100 [00:09<00:04,  6.92it/s] 67%|██████▋   | 67/100 [00:09<00:04,  6.97it/s] 68%|██████▊   | 68/100 [00:09<00:04,  6.97it/s] 69%|██████▉   | 69/100 [00:09<00:04,  7.03it/s] 70%|███████   | 70/100 [00:09<00:04,  7.13it/s] 71%|███████   | 71/100 [00:09<00:04,  7.10it/s] 72%|███████▏  | 72/100 [00:09<00:03,  7.05it/s] 73%|███████▎  | 73/100 [00:10<00:03,  6.97it/s] 74%|███████▍  | 74/100 [00:10<00:03,  6.94it/s] 75%|███████▌  | 75/100 [00:10<00:03,  6.92it/s] 76%|███████▌  | 76/100 [00:10<00:03,  6.92it/s] 77%|███████▋  | 77/100 [00:10<00:03,  7.01it/s] 78%|███████▊  | 78/100 [00:10<00:03,  6.97it/s] 79%|███████▉  | 79/100 [00:10<00:03,  6.91it/s] 80%|████████  | 80/100 [00:11<00:02,  6.92it/s] 81%|████████  | 81/100 [00:11<00:02,  6.98it/s] 82%|████████▏ | 82/100 [00:11<00:02,  6.88it/s] 83%|████████▎ | 83/100 [00:11<00:02,  6.83it/s] 84%|████████▍ | 84/100 [00:11<00:02,  6.83it/s] 85%|████████▌ | 85/100 [00:11<00:02,  6.85it/s] 86%|████████▌ | 86/100 [00:11<00:02,  6.71it/s] 87%|████████▋ | 87/100 [00:12<00:01,  6.76it/s] 88%|████████▊ | 88/100 [00:12<00:01,  6.69it/s] 89%|████████▉ | 89/100 [00:12<00:01,  6.73it/s] 90%|█████████ | 90/100 [00:12<00:01,  6.67it/s] 91%|█████████ | 91/100 [00:12<00:01,  6.62it/s] 92%|█████████▏| 92/100 [00:12<00:01,  6.59it/s] 93%|█████████▎| 93/100 [00:12<00:01,  6.62it/s] 94%|█████████▍| 94/100 [00:13<00:00,  6.69it/s] 95%|█████████▌| 95/100 [00:13<00:00,  6.77it/s] 96%|█████████▌| 96/100 [00:13<00:00,  6.65it/s] 97%|█████████▋| 97/100 [00:13<00:00,  6.68it/s] 98%|█████████▊| 98/100 [00:13<00:00,  6.63it/s] 99%|█████████▉| 99/100 [00:13<00:00,  6.72it/s]100%|██████████| 100/100 [00:13<00:00,  6.74it/s]100%|██████████| 100/100 [00:13<00:00,  7.14it/s]
[I 2025-08-29 07:38:56,322] A new study created in memory with name: no-name-4f368382-b3fb-41fe-900d-bae8f7f3ed94
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 19.85 MB
Memory Reserved: 42.00 MB
cuda
CUDA OOM 발생 — 단계적 백오프 시작.
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 17906.54 MB
Memory Reserved: 17924.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 349.96 MB
Memory Reserved: 388.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 17906.25 MB
Memory Reserved: 17932.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 350.37 MB
Memory Reserved: 388.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[I 2025-08-29 07:38:57,742] Trial 0 pruned. Pruned due to OOM after backoff
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 17904.00 MB
Memory Reserved: 17934.00 MB
cuda
Epoch 1, Train Loss 0.930506, Valid_loss 1.389688
Epoch 2, Train Loss 0.832327, Valid_loss 1.335721
Epoch 3, Train Loss 0.683372, Valid_loss 1.146351
Epoch 4, Train Loss 0.640199, Valid_loss 1.313906
Epoch 5, Train Loss 0.558453, Valid_loss 1.023917
Epoch 6, Train Loss 0.537457, Valid_loss 0.905116
Epoch 7, Train Loss 0.560288, Valid_loss 0.999631
Epoch 8, Train Loss 0.572558, Valid_loss 0.849428
Epoch 9, Train Loss 0.476545, Valid_loss 0.994715
Epoch 10, Train Loss 0.462281, Valid_loss 0.886595
Epoch 11, Train Loss 0.407521, Valid_loss 0.830638
Epoch 12, Train Loss 0.411439, Valid_loss 0.870868
Epoch 13, Train Loss 0.503669, Valid_loss 0.930350
Epoch 14, Train Loss 0.451555, Valid_loss 0.896934
Epoch 15, Train Loss 0.432307, Valid_loss 1.020842
Epoch 16, Train Loss 0.408054, Valid_loss 1.040644
Epoch 17, Train Loss 0.369242, Valid_loss 0.833858
Epoch 18, Train Loss 0.397103, Valid_loss 1.067723
Epoch 19, Train Loss 0.364222, Valid_loss 0.965027
Epoch 20, Train Loss 0.401747, Valid_loss 0.968960
Epoch 21, Train Loss 0.370417, Valid_loss 1.161912
Epoch 22, Train Loss 0.337069, Valid_loss 1.019817
Epoch 23, Train Loss 0.327612, Valid_loss 0.857452
Epoch 24, Train Loss 0.393431, Valid_loss 1.053311
Epoch 25, Train Loss 0.346998, Valid_loss 0.844648
Epoch 26, Train Loss 0.324718, Valid_loss 0.977299
Epoch 27, Train Loss 0.348030, Valid_loss 0.816181
Epoch 28, Train Loss 0.366329, Valid_loss 0.930479
Epoch 29, Train Loss 0.321218, Valid_loss 1.131306
Epoch 30, Train Loss 0.392905, Valid_loss 0.812791
Epoch 31, Train Loss 0.327842, Valid_loss 1.160093
Epoch 32, Train Loss 0.332997, Valid_loss 0.951879
Epoch 33, Train Loss 0.289505, Valid_loss 1.001884
Epoch 34, Train Loss 0.269389, Valid_loss 1.026491
Epoch 35, Train Loss 0.263390, Valid_loss 0.836142
Epoch 36, Train Loss 0.272116, Valid_loss 0.944640
Epoch 37, Train Loss 0.258404, Valid_loss 0.761266
Epoch 38, Train Loss 0.286301, Valid_loss 1.162919
Epoch 39, Train Loss 0.266356, Valid_loss 0.872461
Epoch 40, Train Loss 0.247464, Valid_loss 1.143831
Epoch 41, Train Loss 0.236668, Valid_loss 0.920615
Epoch 42, Train Loss 0.313782, Valid_loss 0.940914
Epoch 43, Train Loss 0.230827, Valid_loss 1.133719
Epoch 44, Train Loss 0.221092, Valid_loss 1.049996
Epoch 45, Train Loss 0.232988, Valid_loss 1.123939
Epoch 46, Train Loss 0.214749, Valid_loss 0.917606
Epoch 47, Train Loss 0.252300, Valid_loss 0.775044
Epoch 48, Train Loss 0.263165, Valid_loss 0.883479
Epoch 49, Train Loss 0.232629, Valid_loss 0.834141
Epoch 50, Train Loss 0.242999, Valid_loss 0.873601
Epoch 51, Train Loss 0.213208, Valid_loss 0.899381
Epoch 52, Train Loss 0.256070, Valid_loss 0.882737
Epoch 53, Train Loss 0.201276, Valid_loss 0.875734
Epoch 54, Train Loss 0.192498, Valid_loss 0.755385
Epoch 55, Train Loss 0.179188, Valid_loss 0.897156
Epoch 56, Train Loss 0.181728, Valid_loss 0.828770
Epoch 57, Train Loss 0.217982, Valid_loss 0.844775
Epoch 58, Train Loss 0.206867, Valid_loss 0.935532
[I 2025-08-29 08:01:27,786] Trial 1 finished with value: 0.7553853729570453 and parameters: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 1, 'dropout': 0.5, 'weight_decay': 0.001, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 1 with value: 0.7553853729570453.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 16.69 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.967774, Valid_loss 1.385214
Epoch 2, Train Loss 0.868155, Valid_loss 1.332171
Epoch 3, Train Loss 0.711522, Valid_loss 1.186918
Epoch 4, Train Loss 0.569776, Valid_loss 1.240962
Epoch 5, Train Loss 0.545847, Valid_loss 1.306775
Epoch 6, Train Loss 0.493226, Valid_loss 1.197726
Epoch 7, Train Loss 0.493266, Valid_loss 1.289804
Epoch 8, Train Loss 0.422976, Valid_loss 1.272959
Epoch 9, Train Loss 0.376942, Valid_loss 1.248936
Epoch 10, Train Loss 0.394455, Valid_loss 1.189045
Epoch 11, Train Loss 0.380893, Valid_loss 1.175081
Epoch 12, Train Loss 0.441996, Valid_loss 1.142746
Epoch 13, Train Loss 0.356632, Valid_loss 1.262576
Epoch 14, Train Loss 0.304024, Valid_loss 1.170453
Epoch 15, Train Loss 0.288895, Valid_loss 1.277539
Epoch 16, Train Loss 0.304549, Valid_loss 1.193408
Epoch 17, Train Loss 0.338804, Valid_loss 1.071656
Epoch 18, Train Loss 0.233008, Valid_loss 1.088893
Epoch 19, Train Loss 0.338835, Valid_loss 1.151639
Epoch 20, Train Loss 0.254181, Valid_loss 1.106501
Epoch 21, Train Loss 0.300737, Valid_loss 1.143212
Epoch 22, Train Loss 0.262066, Valid_loss 1.371795
Epoch 23, Train Loss 0.282410, Valid_loss 1.144117
Epoch 24, Train Loss 0.214546, Valid_loss 1.235014
Epoch 25, Train Loss 0.218109, Valid_loss 1.123588
Epoch 26, Train Loss 0.257866, Valid_loss 1.056670
Epoch 27, Train Loss 0.443826, Valid_loss 1.118354
Epoch 28, Train Loss 0.241705, Valid_loss 1.117192
Epoch 29, Train Loss 0.235049, Valid_loss 1.159844
Epoch 30, Train Loss 0.296924, Valid_loss 1.170022
Epoch 31, Train Loss 0.222613, Valid_loss 1.265454
Epoch 32, Train Loss 0.193911, Valid_loss 1.141950
Epoch 33, Train Loss 0.212343, Valid_loss 1.412029
Epoch 34, Train Loss 0.199735, Valid_loss 1.200811
Epoch 35, Train Loss 0.257695, Valid_loss 1.224232
Epoch 36, Train Loss 0.187806, Valid_loss 1.248187
Epoch 37, Train Loss 0.221736, Valid_loss 1.442905
Epoch 38, Train Loss 0.213494, Valid_loss 1.443364
Epoch 39, Train Loss 0.211579, Valid_loss 1.156994
Epoch 40, Train Loss 0.255915, Valid_loss 1.314058
Epoch 41, Train Loss 0.180634, Valid_loss 1.510046
Epoch 42, Train Loss 0.196565, Valid_loss 1.208570
Epoch 43, Train Loss 0.131377, Valid_loss 1.292816
Epoch 44, Train Loss 0.174235, Valid_loss 1.247991
Epoch 45, Train Loss 0.160741, Valid_loss 1.342523
Epoch 46, Train Loss 0.170335, Valid_loss 1.350325
Epoch 47, Train Loss 0.204983, Valid_loss 1.335821
Epoch 48, Train Loss 0.183767, Valid_loss 1.540434
Epoch 49, Train Loss 0.198781, Valid_loss 1.220542
Epoch 50, Train Loss 0.181112, Valid_loss 1.202760
Epoch 51, Train Loss 0.184338, Valid_loss 1.205022
Epoch 52, Train Loss 0.207148, Valid_loss 1.200422
Epoch 53, Train Loss 0.154051, Valid_loss 2.287930
Epoch 54, Train Loss 0.296254, Valid_loss 1.181879
Epoch 55, Train Loss 0.186137, Valid_loss 1.184622
Epoch 56, Train Loss 0.193153, Valid_loss 1.244306
[I 2025-08-29 08:22:56,589] Trial 2 finished with value: 1.0566700042902746 and parameters: {'learning_rate': 0.001, 'epochs': 100, 'heads': 1, 'dropout': 0.3, 'weight_decay': 0.0001, 'emb_dim': 8, 'augment_num': 100, 'pca': False}. Best is trial 1 with value: 0.7553853729570453.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 18.01 MB
Memory Reserved: 42.00 MB
cuda
CUDA OOM 발생 — 단계적 백오프 시작.
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 9091.39 MB
Memory Reserved: 9098.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 9091.52 MB
Memory Reserved: 9118.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 9091.36 MB
Memory Reserved: 9098.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 9091.52 MB
Memory Reserved: 9118.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[I 2025-08-29 08:22:58,051] Trial 3 pruned. Pruned due to OOM after backoff
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 19.85 MB
Memory Reserved: 42.00 MB
cuda
CUDA OOM 발생 — 단계적 백오프 시작.
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 9113.95 MB
Memory Reserved: 9116.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 9113.97 MB
Memory Reserved: 9148.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 9113.85 MB
Memory Reserved: 9114.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 9113.97 MB
Memory Reserved: 9146.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[I 2025-08-29 08:22:59,395] Trial 4 pruned. Pruned due to OOM after backoff
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 19.85 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 1.015013, Valid_loss 2.062592
Epoch 2, Train Loss 0.916577, Valid_loss 2.106061
Epoch 3, Train Loss 0.895491, Valid_loss 2.303932
Epoch 4, Train Loss 0.680099, Valid_loss 1.297549
Epoch 5, Train Loss 0.528863, Valid_loss 1.463140
Epoch 6, Train Loss 0.668232, Valid_loss 1.563881
Epoch 7, Train Loss 0.624570, Valid_loss 2.630991
Epoch 8, Train Loss 0.968499, Valid_loss 1.911961
Epoch 9, Train Loss 0.808520, Valid_loss 1.923645
Epoch 10, Train Loss 0.678521, Valid_loss 1.728011
Epoch 11, Train Loss 0.598477, Valid_loss 1.856917
Epoch 12, Train Loss 0.519767, Valid_loss 1.781588
Epoch 13, Train Loss 0.442452, Valid_loss 1.544107
Epoch 14, Train Loss 0.446630, Valid_loss 1.550795
Epoch 15, Train Loss 0.324891, Valid_loss 1.667314
Epoch 16, Train Loss 0.510324, Valid_loss 1.372844
Epoch 17, Train Loss 0.363703, Valid_loss 1.411968
Epoch 18, Train Loss 0.327966, Valid_loss 1.408587
Epoch 19, Train Loss 0.353874, Valid_loss 1.414997
Epoch 20, Train Loss 0.362922, Valid_loss 1.314720
Epoch 21, Train Loss 0.334394, Valid_loss 1.322217
Epoch 22, Train Loss 0.311990, Valid_loss 1.415617
Epoch 23, Train Loss 0.270619, Valid_loss 1.472074
Epoch 24, Train Loss 0.429310, Valid_loss 1.227787
Epoch 25, Train Loss 0.301350, Valid_loss 1.196409
Epoch 26, Train Loss 0.330980, Valid_loss 1.166465
Epoch 27, Train Loss 0.313513, Valid_loss 1.262213
Epoch 28, Train Loss 0.246935, Valid_loss 1.296786
Epoch 29, Train Loss 0.293794, Valid_loss 1.163943
Epoch 30, Train Loss 0.297447, Valid_loss 1.201119
Epoch 31, Train Loss 0.230481, Valid_loss 1.204025
Epoch 32, Train Loss 0.293255, Valid_loss 1.143365
Epoch 33, Train Loss 0.386282, Valid_loss 1.102337
Epoch 34, Train Loss 0.250125, Valid_loss 1.048307
Epoch 35, Train Loss 0.287561, Valid_loss 1.076817
Epoch 36, Train Loss 0.318493, Valid_loss 0.959600
Epoch 37, Train Loss 0.325438, Valid_loss 0.971683
Epoch 38, Train Loss 0.190339, Valid_loss 1.003043
Epoch 39, Train Loss 0.402382, Valid_loss 0.991461
Epoch 40, Train Loss 0.331726, Valid_loss 0.987823
Epoch 41, Train Loss 0.232120, Valid_loss 1.051378
Epoch 42, Train Loss 0.278547, Valid_loss 0.971919
Epoch 43, Train Loss 0.268208, Valid_loss 0.754031
Epoch 44, Train Loss 0.291394, Valid_loss 1.119059
Epoch 45, Train Loss 0.394304, Valid_loss 1.115001
Epoch 46, Train Loss 0.313089, Valid_loss 1.044526
Epoch 47, Train Loss 0.235461, Valid_loss 1.024834
Epoch 48, Train Loss 0.246891, Valid_loss 0.885473
Epoch 49, Train Loss 0.247045, Valid_loss 0.753633
Epoch 50, Train Loss 0.232429, Valid_loss 0.690154
Epoch 51, Train Loss 0.255166, Valid_loss 0.735271
Epoch 52, Train Loss 0.300210, Valid_loss 0.730049
Epoch 53, Train Loss 0.256100, Valid_loss 0.688910
Epoch 54, Train Loss 0.217565, Valid_loss 0.670013
Epoch 55, Train Loss 0.211433, Valid_loss 0.619899
Epoch 56, Train Loss 0.216459, Valid_loss 0.647953
Epoch 57, Train Loss 0.201539, Valid_loss 0.583469
Epoch 58, Train Loss 0.217939, Valid_loss 0.660034
Epoch 59, Train Loss 0.163243, Valid_loss 0.639129
Epoch 60, Train Loss 0.173732, Valid_loss 0.687232
Epoch 61, Train Loss 0.173799, Valid_loss 0.645839
Epoch 62, Train Loss 0.221133, Valid_loss 0.628979
Epoch 63, Train Loss 0.138214, Valid_loss 0.638984
Epoch 64, Train Loss 0.192018, Valid_loss 0.569005
Epoch 65, Train Loss 0.194280, Valid_loss 0.638476
Epoch 66, Train Loss 0.174279, Valid_loss 0.555513
Epoch 67, Train Loss 0.145226, Valid_loss 0.611394
Epoch 68, Train Loss 0.181924, Valid_loss 0.565015
Epoch 69, Train Loss 0.209635, Valid_loss 0.550907
Epoch 70, Train Loss 0.128061, Valid_loss 0.547597
Epoch 71, Train Loss 0.132418, Valid_loss 0.568014
Epoch 72, Train Loss 0.140000, Valid_loss 0.542574
Epoch 73, Train Loss 0.197033, Valid_loss 0.556518
Epoch 74, Train Loss 0.102120, Valid_loss 0.532515
Epoch 75, Train Loss 0.172646, Valid_loss 0.514404
Epoch 76, Train Loss 0.138186, Valid_loss 0.478427
Epoch 77, Train Loss 0.161605, Valid_loss 0.461604
Epoch 78, Train Loss 0.131184, Valid_loss 0.444185
Epoch 79, Train Loss 0.106197, Valid_loss 0.441004
Epoch 80, Train Loss 0.122988, Valid_loss 0.441337
Epoch 81, Train Loss 0.122462, Valid_loss 0.460664
[I 2025-08-29 09:08:55,800] Trial 5 finished with value: 0.4410037448955832 and parameters: {'learning_rate': 0.001, 'epochs': 100, 'heads': 2, 'dropout': 0.7, 'weight_decay': 0.0001, 'emb_dim': 64, 'augment_num': 100, 'pca': False}. Best is trial 5 with value: 0.4410037448955832.
선택된 trial params: {'learning_rate': 0.001, 'epochs': 100, 'heads': 2, 'dropout': 0.7, 'weight_decay': 0.0001, 'emb_dim': 64, 'augment_num': 100, 'pca': False}
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=9, batch_size=1 -> steps=9
Memory Allocated: 19.85 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 1.033228, Valid_loss 1.719417
Epoch 2, Train Loss 0.887011, Valid_loss 2.064946
Epoch 3, Train Loss 0.923550, Valid_loss 1.928830
Epoch 4, Train Loss 0.884998, Valid_loss 1.934250
Epoch 5, Train Loss 0.873878, Valid_loss 1.866344
Epoch 6, Train Loss 0.802123, Valid_loss 1.927352
Epoch 7, Train Loss 0.617803, Valid_loss 1.080059
Epoch 8, Train Loss 0.534047, Valid_loss 1.413754
Epoch 9, Train Loss 0.541863, Valid_loss 1.591821
Epoch 10, Train Loss 0.445560, Valid_loss 1.373019
Epoch 11, Train Loss 0.372155, Valid_loss 1.482584
Epoch 12, Train Loss 0.443455, Valid_loss 1.397657
Epoch 13, Train Loss 0.424168, Valid_loss 1.342393
Epoch 14, Train Loss 0.354660, Valid_loss 1.360034
Epoch 15, Train Loss 0.511613, Valid_loss 1.154164
Epoch 16, Train Loss 0.493778, Valid_loss 1.298287
Epoch 17, Train Loss 0.409823, Valid_loss 1.264952
Epoch 18, Train Loss 0.312506, Valid_loss 1.441309
Epoch 19, Train Loss 0.388150, Valid_loss 1.351897
Epoch 20, Train Loss 0.400141, Valid_loss 1.275464
Epoch 21, Train Loss 0.371326, Valid_loss 1.389412
Epoch 22, Train Loss 0.391167, Valid_loss 1.386468
Epoch 23, Train Loss 0.385731, Valid_loss 1.186897
Epoch 24, Train Loss 0.343559, Valid_loss 1.301302
Epoch 25, Train Loss 0.327821, Valid_loss 1.258725
Epoch 26, Train Loss 0.346158, Valid_loss 1.273231
Epoch 27, Train Loss 0.404682, Valid_loss 1.669487
Epoch 28, Train Loss 0.342962, Valid_loss 1.146439
Epoch 29, Train Loss 0.308096, Valid_loss 1.253743
Epoch 30, Train Loss 0.365756, Valid_loss 1.284039
Epoch 31, Train Loss 0.323348, Valid_loss 1.300120
Epoch 32, Train Loss 0.341413, Valid_loss 1.341188
Epoch 33, Train Loss 0.315401, Valid_loss 1.204926
Epoch 34, Train Loss 0.349762, Valid_loss 1.050617
Epoch 35, Train Loss 0.324517, Valid_loss 1.087917
Epoch 36, Train Loss 0.358397, Valid_loss 0.998503
Epoch 37, Train Loss 0.356950, Valid_loss 1.074658
Epoch 38, Train Loss 0.368846, Valid_loss 1.074765
Epoch 39, Train Loss 0.302122, Valid_loss 1.070305
Epoch 40, Train Loss 0.303851, Valid_loss 0.924382
Epoch 41, Train Loss 0.285903, Valid_loss 0.998816
Epoch 42, Train Loss 0.315578, Valid_loss 0.914609
Epoch 43, Train Loss 0.335500, Valid_loss 0.957312
Epoch 44, Train Loss 0.320861, Valid_loss 1.141993
Epoch 45, Train Loss 0.330379, Valid_loss 1.074398
Epoch 46, Train Loss 0.278169, Valid_loss 1.015679
Epoch 47, Train Loss 0.259718, Valid_loss 0.984761
Epoch 48, Train Loss 0.300183, Valid_loss 0.800894
Epoch 49, Train Loss 0.296633, Valid_loss 0.882802
Epoch 50, Train Loss 0.297148, Valid_loss 0.918883
Epoch 51, Train Loss 0.274309, Valid_loss 0.899798
Epoch 52, Train Loss 0.323568, Valid_loss 0.945604
Epoch 53, Train Loss 0.289232, Valid_loss 1.020383
환자ID=P1304 -- true: [[2]] -- pred: tensor([[-2.0586,  0.5447, -0.2629]], device='cuda:0')
환자ID=P1437 -- true: [[2]] -- pred: tensor([[-2.0823,  0.5159, -0.2205]], device='cuda:0')
환자ID=P1508 -- true: [[1]] -- pred: tensor([[ 3.1249, -0.4421, -5.4151]], device='cuda:0')
환자ID=P1510 -- true: [[1]] -- pred: tensor([[-1.6917,  0.8653, -0.7985]], device='cuda:0')
환자ID=P1610 -- true: [[0]] -- pred: tensor([[ 6.2535, -3.4531, -7.2774]], device='cuda:0')
환자ID=P1622 -- true: [[0]] -- pred: tensor([[ 6.2522, -3.4665, -7.2652]], device='cuda:0')
환자ID=P1630 -- true: [[1]] -- pred: tensor([[-2.0928,  0.5034, -0.2030]], device='cuda:0')
환자ID=P1678 -- true: [[0]] -- pred: tensor([[ 6.1786, -3.5762, -7.1035]], device='cuda:0')
환자ID=P1718 -- true: [[0]] -- pred: tensor([[ 6.2177, -3.5415, -7.1770]], device='cuda:0')
Best performance: Epoch 48, Loss 0.300183, Test ACC 0.666667, Test AUC 0.833333, Test Recall 0.555556, Test Precision 0.433333
Confusion Matrix:
 [[4 0 0]
 [1 2 0]
 [0 2 0]]
✅ Total valid splits used: 1
🔁 Repeat 1, Fold 1
cell type :  TTCTTCCGTTCAACGT-1-0                Astrocyte
CATCCACCATCTAACG-1-0      Smooth_muscle_cells
ACCCAAACAGCTAACT-1-0                  Neurons
AAGGAATCAACTGGTT-1-0     Neuroepithelial_cell
TACCCGTAGCGTGCTC-1-0                Astrocyte
                                 ...         
TTATTGCGTCGGTGTC-1-79       Endothelial_cells
GTCACGGGTTGTATGC-1-79       Endothelial_cells
GTCATGATCTTTCGAT-1-79       Endothelial_cells
GCGATCGTCAGAGTGG-1-79               Platelets
GCCCGAACAGAGAAAG-1-79       Endothelial_cells
Name: singler_annotation, Length: 478386, dtype: string
cell type annotation :  TTCTTCCGTTCAACGT-1-0                Astrocyte
CATCCACCATCTAACG-1-0      Smooth_muscle_cells
ACCCAAACAGCTAACT-1-0                  Neurons
AAGGAATCAACTGGTT-1-0     Neuroepithelial_cell
TACCCGTAGCGTGCTC-1-0                Astrocyte
                                 ...         
TTATTGCGTCGGTGTC-1-79       Endothelial_cells
GTCACGGGTTGTATGC-1-79       Endothelial_cells
GTCATGATCTTTCGAT-1-79       Endothelial_cells
GCGATCGTCAGAGTGG-1-79               Platelets
GCCCGAACAGAGAAAG-1-79       Endothelial_cells
Name: singler_annotation, Length: 478386, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Astrocyte', 'Smooth_muscle_cells', 'Neurons', 'Neuroepithelial_cell', 'Endothelial_cells', 'Osteoblasts', 'Platelets', 'Hepatocytes', 'Embryonic_stem_cells', 'MEP', 'Erythroblast', 'Fibroblasts', 'iPS_cells', 'MSC', 'Macrophage', 'Gametocytes', 'Chondrocytes', 'NK_cell', 'Neutrophils', 'HSC_CD34+', 'Monocyte', 'Tissue_stem_cells', 'DC', 'HSC_-G-CSF', 'T_cells', 'Epithelial_cells', 'Unknown', 'Pre-B_cell_CD34-', 'GMP', 'B_cell', 'Pro-Myelocyte', 'Keratinocytes', 'Myelocyte', 'BM', 'CMP', 'BM & Prog.', 'Pro-B_cell_CD34+']
라벨별 그룹 개수 {2: 8, 1: 12, 0: 13}
cell type :  CAACCAAAGACCCGCT-1-2                 Neurons
ACGGTTACATCGAACT-1-2                 Neurons
ACCCTCATCCGGCAGT-1-2                 Neurons
AACACACCACGGTCTG-1-2     Smooth_muscle_cells
AAACGCTTCACCGGGT-1-2                 Neurons
                                ...         
AGAAGCGAGCGTCTGC-1-73      Endothelial_cells
TACTTCATCCCTTTGG-1-73                NK_cell
ATATCCTGTTAGCGGA-1-73      Endothelial_cells
TACTTACCAAAGCACG-1-73      Endothelial_cells
GTCAGCGCAACACTAC-1-73    Smooth_muscle_cells
Name: singler_annotation, Length: 114303, dtype: string
cell type annotation :  CAACCAAAGACCCGCT-1-2                 Neurons
ACGGTTACATCGAACT-1-2                 Neurons
ACCCTCATCCGGCAGT-1-2                 Neurons
AACACACCACGGTCTG-1-2     Smooth_muscle_cells
AAACGCTTCACCGGGT-1-2                 Neurons
                                ...         
AGAAGCGAGCGTCTGC-1-73      Endothelial_cells
TACTTCATCCCTTTGG-1-73                NK_cell
ATATCCTGTTAGCGGA-1-73      Endothelial_cells
TACTTACCAAAGCACG-1-73      Endothelial_cells
GTCAGCGCAACACTAC-1-73    Smooth_muscle_cells
Name: singler_annotation, Length: 114303, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Neurons', 'Smooth_muscle_cells', 'Osteoblasts', 'Endothelial_cells', 'MSC', 'Astrocyte', 'Fibroblasts', 'Erythroblast', 'Neuroepithelial_cell', 'Platelets', 'iPS_cells', 'NK_cell', 'Embryonic_stem_cells', 'MEP', 'Gametocytes', 'Hepatocytes', 'Tissue_stem_cells', 'Monocyte', 'Macrophage', 'Neutrophils', 'Chondrocytes', 'HSC_-G-CSF', 'BM & Prog.', 'DC', 'Keratinocytes', 'T_cells', 'HSC_CD34+', 'CMP', 'B_cell', 'Myelocyte', 'Epithelial_cells', 'Unknown', 'Pro-Myelocyte', 'Pre-B_cell_CD34-', 'BM', 'GMP', 'Pro-B_cell_CD34+']
라벨별 그룹 개수 {2: 3, 0: 3, 1: 3}
🔍 Split #2
  → train_p_index 환자 수 (환자 단위로 묶인 index list): 33
  → test_p_index 환자 수  (환자 단위로 묶인 index list): 9
  → train 환자 ID: ['P1300', 'P1304', 'P1358', 'P1422', 'P1425', 'P1437', 'P1447', 'P1462', 'P1472', 'P1479', 'P1504', 'P1508', 'P1510', 'P1515', 'P1540', 'P1547', 'P1549', 'P1558', 'P1561', 'P1582', 'P1600', 'P1602', 'P1606', 'P1610', 'P1617', 'P1622', 'P1630', 'P1678', 'P1685', 'P1702', 'P1707', 'P1718', 'P1735']
  → test  환자 ID: ['P1290', 'P1371', 'P1430', 'P1516', 'P1539', 'P1603', 'P1631', 'P1722', 'P1726']
  → train 환자 ID 및 라벨:
    ID: P1300, Label: 2
    ID: P1304, Label: 2
    ID: P1358, Label: 2
    ID: P1422, Label: 1
    ID: P1425, Label: 1
    ID: P1437, Label: 2
    ID: P1447, Label: 1
    ID: P1462, Label: 1
    ID: P1472, Label: 2
    ID: P1479, Label: 1
    ID: P1504, Label: 2
    ID: P1508, Label: 1
    ID: P1510, Label: 1
    ID: P1515, Label: 0
    ID: P1540, Label: 0
    ID: P1547, Label: 0
    ID: P1549, Label: 0
    ID: P1558, Label: 0
    ID: P1561, Label: 0
    ID: P1582, Label: 0
    ID: P1600, Label: 0
    ID: P1602, Label: 1
    ID: P1606, Label: 2
    ID: P1610, Label: 0
    ID: P1617, Label: 2
    ID: P1622, Label: 0
    ID: P1630, Label: 1
    ID: P1678, Label: 0
    ID: P1685, Label: 1
    ID: P1702, Label: 0
    ID: P1707, Label: 1
    ID: P1718, Label: 0
    ID: P1735, Label: 1
  → test 환자 ID 및 라벨:
    ID: P1290, Label: 2
    ID: P1371, Label: 2
    ID: P1430, Label: 2
    ID: P1516, Label: 0
    ID: P1539, Label: 0
    ID: P1603, Label: 0
    ID: P1631, Label: 1
    ID: P1722, Label: 1
    ID: P1726, Label: 1
전체 데이터 index 길이 42
label_stat (train 환자 라벨 목록) 갯수 33
train_data에서 환자 단위로, train과 validation 나누기
기존 train_p_index 33
기존 (train) label_stat 33
train-vali 분할 후! 
train y 의 classes : {0, 1, 2} valid y 의 classes : {0, 1, 2} label_stat 의 classes : {0, 1, 2}
train_p_index_ 22
valid_p_index 11
test_p_index 9
→ train 환자 ID 및 라벨:
   총 개수: 22
   환자ID=P1602, Label=1, 셀개수=16580
   환자ID=P1707, Label=1, 셀개수=9517
   환자ID=P1540, Label=0, 셀개수=11638
   환자ID=P1358, Label=2, 셀개수=23984
   환자ID=P1472, Label=2, 셀개수=19513
   환자ID=P1610, Label=0, 셀개수=13919
   환자ID=P1630, Label=1, 셀개수=17633
   환자ID=P1425, Label=1, 셀개수=15378
   환자ID=P1735, Label=1, 셀개수=12009
   환자ID=P1702, Label=0, 셀개수=13550
   환자ID=P1549, Label=0, 셀개수=11709
   환자ID=P1678, Label=0, 셀개수=10085
   환자ID=P1510, Label=1, 셀개수=10744
   환자ID=P1437, Label=2, 셀개수=21695
   환자ID=P1622, Label=0, 셀개수=7210
   환자ID=P1515, Label=0, 셀개수=14502
   환자ID=P1606, Label=2, 셀개수=8523
   환자ID=P1508, Label=1, 셀개수=20536
   환자ID=P1504, Label=2, 셀개수=8133
   환자ID=P1462, Label=1, 셀개수=21715
   환자ID=P1600, Label=0, 셀개수=14882
   환자ID=P1547, Label=0, 셀개수=8253
→ valid 환자 ID 및 라벨:
   총 개수: 11
   환자ID=P1304, Label=2, 셀개수=19123
   환자ID=P1447, Label=1, 셀개수=11151
   환자ID=P1558, Label=0, 셀개수=10469
   환자ID=P1479, Label=1, 셀개수=19124
   환자ID=P1300, Label=2, 셀개수=17318
   환자ID=P1582, Label=0, 셀개수=18855
   환자ID=P1718, Label=0, 셀개수=9278
   환자ID=P1561, Label=0, 셀개수=10016
   환자ID=P1685, Label=1, 셀개수=10043
   환자ID=P1422, Label=1, 셀개수=23315
   환자ID=P1617, Label=2, 셀개수=17986
→ test 환자 ID 및 라벨:
   총 개수: 9
   환자ID=P1290, Label=2, 셀개수=8357
   환자ID=P1371, Label=2, 셀개수=16233
   환자ID=P1430, Label=2, 셀개수=11131
   환자ID=P1516, Label=0, 셀개수=9361
   환자ID=P1539, Label=0, 셀개수=11076
   환자ID=P1603, Label=0, 셀개수=10638
   환자ID=P1631, Label=1, 셀개수=13686
   환자ID=P1722, Label=1, 셀개수=21432
   환자ID=P1726, Label=1, 셀개수=12389
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Astrocyte', 'Smooth_muscle_cells', 'Neurons', 'Neuroepithelial_cell', 'Astrocyte', 'Endothelial_cells', 'Osteoblasts', 'Platelets', 'Neurons', 'Hepatocytes']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
전체 데이터 길이 592689
전체 cell type 길이 0                    Astrocyte
1          Smooth_muscle_cells
2                      Neurons
3         Neuroepithelial_cell
4                    Astrocyte
                  ...         
592684       Endothelial_cells
592685                 NK_cell
592686       Endothelial_cells
592687       Endothelial_cells
592688     Smooth_muscle_cells
Length: 592689, dtype: string
cell type의 NaN 개수 체크 0
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:12,  8.04it/s]  2%|▏         | 2/100 [00:00<00:11,  8.19it/s]  3%|▎         | 3/100 [00:00<00:11,  8.23it/s]  4%|▍         | 4/100 [00:00<00:11,  8.17it/s]  5%|▌         | 5/100 [00:00<00:11,  8.30it/s]  6%|▌         | 6/100 [00:00<00:11,  8.31it/s]  7%|▋         | 7/100 [00:00<00:11,  8.18it/s]  8%|▊         | 8/100 [00:00<00:11,  8.09it/s]  9%|▉         | 9/100 [00:01<00:11,  8.19it/s] 10%|█         | 10/100 [00:01<00:11,  8.15it/s] 11%|█         | 11/100 [00:01<00:10,  8.11it/s] 12%|█▏        | 12/100 [00:01<00:10,  8.14it/s] 13%|█▎        | 13/100 [00:01<00:10,  8.13it/s] 14%|█▍        | 14/100 [00:01<00:10,  8.06it/s] 15%|█▌        | 15/100 [00:01<00:10,  8.26it/s] 16%|█▌        | 16/100 [00:01<00:10,  8.32it/s] 17%|█▋        | 17/100 [00:02<00:09,  8.39it/s] 18%|█▊        | 18/100 [00:02<00:09,  8.24it/s] 19%|█▉        | 19/100 [00:02<00:09,  8.13it/s] 20%|██        | 20/100 [00:02<00:09,  8.21it/s] 21%|██        | 21/100 [00:02<00:09,  8.36it/s] 22%|██▏       | 22/100 [00:02<00:09,  8.19it/s] 23%|██▎       | 23/100 [00:02<00:09,  8.21it/s] 24%|██▍       | 24/100 [00:02<00:09,  8.10it/s] 25%|██▌       | 25/100 [00:03<00:09,  8.19it/s] 26%|██▌       | 26/100 [00:03<00:09,  8.06it/s] 27%|██▋       | 27/100 [00:03<00:09,  8.00it/s] 28%|██▊       | 28/100 [00:03<00:09,  7.93it/s] 29%|██▉       | 29/100 [00:03<00:08,  7.92it/s] 30%|███       | 30/100 [00:03<00:08,  7.94it/s] 31%|███       | 31/100 [00:03<00:08,  7.98it/s] 32%|███▏      | 32/100 [00:03<00:08,  7.96it/s] 33%|███▎      | 33/100 [00:04<00:08,  7.93it/s] 34%|███▍      | 34/100 [00:04<00:08,  7.99it/s] 35%|███▌      | 35/100 [00:04<00:08,  7.90it/s] 36%|███▌      | 36/100 [00:04<00:08,  7.85it/s] 37%|███▋      | 37/100 [00:04<00:07,  7.94it/s] 38%|███▊      | 38/100 [00:04<00:07,  7.91it/s] 39%|███▉      | 39/100 [00:04<00:07,  8.00it/s] 40%|████      | 40/100 [00:04<00:07,  7.85it/s] 41%|████      | 41/100 [00:05<00:07,  7.72it/s] 42%|████▏     | 42/100 [00:05<00:07,  7.58it/s] 43%|████▎     | 43/100 [00:05<00:07,  7.67it/s] 44%|████▍     | 44/100 [00:05<00:07,  7.60it/s] 45%|████▌     | 45/100 [00:05<00:07,  7.72it/s] 46%|████▌     | 46/100 [00:05<00:07,  7.60it/s] 47%|████▋     | 47/100 [00:05<00:06,  7.69it/s] 48%|████▊     | 48/100 [00:06<00:06,  7.55it/s] 49%|████▉     | 49/100 [00:06<00:06,  7.61it/s] 50%|█████     | 50/100 [00:06<00:06,  7.50it/s] 51%|█████     | 51/100 [00:06<00:06,  7.47it/s] 52%|█████▏    | 52/100 [00:06<00:06,  7.60it/s] 53%|█████▎    | 53/100 [00:06<00:06,  7.59it/s] 54%|█████▍    | 54/100 [00:06<00:06,  7.53it/s] 55%|█████▌    | 55/100 [00:06<00:05,  7.56it/s] 56%|█████▌    | 56/100 [00:07<00:05,  7.56it/s] 57%|█████▋    | 57/100 [00:07<00:05,  7.54it/s] 58%|█████▊    | 58/100 [00:07<00:05,  7.49it/s] 59%|█████▉    | 59/100 [00:07<00:05,  7.41it/s] 60%|██████    | 60/100 [00:07<00:05,  7.38it/s] 61%|██████    | 61/100 [00:07<00:05,  7.54it/s] 62%|██████▏   | 62/100 [00:07<00:05,  7.53it/s] 63%|██████▎   | 63/100 [00:08<00:04,  7.47it/s] 64%|██████▍   | 64/100 [00:08<00:04,  7.41it/s] 65%|██████▌   | 65/100 [00:08<00:04,  7.34it/s] 66%|██████▌   | 66/100 [00:08<00:04,  7.35it/s] 67%|██████▋   | 67/100 [00:08<00:04,  7.27it/s] 68%|██████▊   | 68/100 [00:08<00:04,  7.28it/s] 69%|██████▉   | 69/100 [00:08<00:04,  7.42it/s] 70%|███████   | 70/100 [00:08<00:04,  7.32it/s] 71%|███████   | 71/100 [00:09<00:03,  7.40it/s] 72%|███████▏  | 72/100 [00:09<00:03,  7.24it/s] 73%|███████▎  | 73/100 [00:09<00:03,  7.30it/s] 74%|███████▍  | 74/100 [00:09<00:03,  7.15it/s] 75%|███████▌  | 75/100 [00:09<00:03,  7.17it/s] 76%|███████▌  | 76/100 [00:09<00:03,  7.18it/s] 77%|███████▋  | 77/100 [00:09<00:03,  7.31it/s] 78%|███████▊  | 78/100 [00:10<00:03,  7.13it/s] 79%|███████▉  | 79/100 [00:10<00:02,  7.20it/s] 80%|████████  | 80/100 [00:10<00:02,  7.18it/s] 81%|████████  | 81/100 [00:10<00:02,  7.29it/s] 82%|████████▏ | 82/100 [00:10<00:02,  7.31it/s] 83%|████████▎ | 83/100 [00:10<00:02,  7.07it/s] 84%|████████▍ | 84/100 [00:10<00:02,  7.02it/s] 85%|████████▌ | 85/100 [00:11<00:02,  6.97it/s] 86%|████████▌ | 86/100 [00:11<00:01,  7.00it/s] 87%|████████▋ | 87/100 [00:11<00:01,  6.93it/s] 88%|████████▊ | 88/100 [00:11<00:01,  7.02it/s] 89%|████████▉ | 89/100 [00:11<00:01,  6.98it/s] 90%|█████████ | 90/100 [00:11<00:01,  7.00it/s] 91%|█████████ | 91/100 [00:11<00:01,  6.90it/s] 92%|█████████▏| 92/100 [00:12<00:01,  6.90it/s] 93%|█████████▎| 93/100 [00:12<00:01,  6.87it/s] 94%|█████████▍| 94/100 [00:12<00:00,  6.92it/s] 95%|█████████▌| 95/100 [00:12<00:00,  6.87it/s] 96%|█████████▌| 96/100 [00:12<00:00,  6.91it/s] 97%|█████████▋| 97/100 [00:12<00:00,  6.88it/s] 98%|█████████▊| 98/100 [00:12<00:00,  6.93it/s] 99%|█████████▉| 99/100 [00:13<00:00,  6.88it/s]100%|██████████| 100/100 [00:13<00:00,  6.85it/s]100%|██████████| 100/100 [00:13<00:00,  7.55it/s]
[I 2025-08-29 09:39:43,691] A new study created in memory with name: no-name-801c0da4-7a5c-47bd-87a8-0d926c0ae5fb
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 16.69 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 1.101786, Valid_loss 1.155160
Epoch 2, Train Loss 0.977516, Valid_loss 1.170537
Epoch 3, Train Loss 0.887438, Valid_loss 0.890714
Epoch 4, Train Loss 0.786780, Valid_loss 0.948427
Epoch 5, Train Loss 0.703726, Valid_loss 0.696538
Epoch 6, Train Loss 0.686240, Valid_loss 0.656052
Epoch 7, Train Loss 0.593839, Valid_loss 0.632030
Epoch 8, Train Loss 0.605693, Valid_loss 0.882546
Epoch 9, Train Loss 0.525309, Valid_loss 0.525690
Epoch 10, Train Loss 0.488697, Valid_loss 0.614259
Epoch 11, Train Loss 0.519699, Valid_loss 0.484311
Epoch 12, Train Loss 0.489301, Valid_loss 0.589900
Epoch 13, Train Loss 0.434544, Valid_loss 0.442036
Epoch 14, Train Loss 0.372811, Valid_loss 0.391379
Epoch 15, Train Loss 0.429204, Valid_loss 0.656898
Epoch 16, Train Loss 0.416886, Valid_loss 0.382391
Epoch 17, Train Loss 0.456415, Valid_loss 0.410071
Epoch 18, Train Loss 0.334624, Valid_loss 0.594601
Epoch 19, Train Loss 0.338454, Valid_loss 0.489147
Epoch 20, Train Loss 0.330858, Valid_loss 0.298818
Epoch 21, Train Loss 0.294860, Valid_loss 0.886778
Epoch 22, Train Loss 0.288115, Valid_loss 0.358426
Epoch 23, Train Loss 0.298168, Valid_loss 0.371263
Epoch 24, Train Loss 0.306057, Valid_loss 0.876486
Epoch 25, Train Loss 0.248112, Valid_loss 0.923210
Epoch 26, Train Loss 0.354959, Valid_loss 0.453768
Epoch 27, Train Loss 0.243570, Valid_loss 0.608720
Epoch 28, Train Loss 0.241186, Valid_loss 0.466699
Epoch 29, Train Loss 0.252779, Valid_loss 0.676986
Epoch 30, Train Loss 0.251825, Valid_loss 0.653487
Epoch 31, Train Loss 0.191046, Valid_loss 0.755830
Epoch 32, Train Loss 0.231173, Valid_loss 0.937833
Epoch 33, Train Loss 0.183924, Valid_loss 0.625681
Epoch 34, Train Loss 0.233248, Valid_loss 0.280898
Epoch 35, Train Loss 0.249010, Valid_loss 0.562763
Epoch 36, Train Loss 0.186544, Valid_loss 0.624953
Epoch 37, Train Loss 0.212240, Valid_loss 0.609186
Epoch 38, Train Loss 0.173769, Valid_loss 0.780276
Epoch 39, Train Loss 0.199922, Valid_loss 0.573546
Epoch 40, Train Loss 0.197614, Valid_loss 0.248656
Epoch 41, Train Loss 0.172220, Valid_loss 0.564452
Epoch 42, Train Loss 0.152459, Valid_loss 0.210566
Epoch 43, Train Loss 0.248187, Valid_loss 0.778803
Epoch 44, Train Loss 0.177534, Valid_loss 0.555701
Epoch 45, Train Loss 0.160814, Valid_loss 0.270844
Epoch 46, Train Loss 0.166828, Valid_loss 0.761830
Epoch 47, Train Loss 0.163906, Valid_loss 0.645652
Epoch 48, Train Loss 0.216764, Valid_loss 1.012702
Epoch 49, Train Loss 0.166719, Valid_loss 0.555949
Epoch 50, Train Loss 0.099587, Valid_loss 0.714187
Epoch 51, Train Loss 0.099147, Valid_loss 0.490066
Epoch 52, Train Loss 0.107045, Valid_loss 0.705725
Epoch 53, Train Loss 0.102647, Valid_loss 0.659459
Epoch 54, Train Loss 0.068046, Valid_loss 0.431818
Epoch 55, Train Loss 0.066159, Valid_loss 0.585009
Epoch 56, Train Loss 0.047344, Valid_loss 0.420196
Epoch 57, Train Loss 0.056297, Valid_loss 0.499617
Epoch 58, Train Loss 0.055777, Valid_loss 0.731669
[I 2025-08-29 10:01:07,843] Trial 0 finished with value: 0.2105662663551894 and parameters: {'learning_rate': 0.001, 'epochs': 100, 'heads': 1, 'dropout': 0.0, 'weight_decay': 0.0001, 'emb_dim': 8, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.2105662663551894.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 19.85 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 1.138932, Valid_loss 1.445477
Epoch 2, Train Loss 1.098739, Valid_loss 1.254056
Epoch 3, Train Loss 1.008939, Valid_loss 1.224330
Epoch 4, Train Loss 1.011893, Valid_loss 1.331001
Epoch 5, Train Loss 1.009606, Valid_loss 1.185011
Epoch 6, Train Loss 0.997131, Valid_loss 1.275707
Epoch 7, Train Loss 0.962854, Valid_loss 1.198711
Epoch 8, Train Loss 0.958746, Valid_loss 1.187381
Epoch 9, Train Loss 0.968860, Valid_loss 1.233123
Epoch 10, Train Loss 0.953205, Valid_loss 1.224554
Epoch 11, Train Loss 0.961890, Valid_loss 1.163763
Epoch 12, Train Loss 0.945621, Valid_loss 1.205003
Epoch 13, Train Loss 0.937771, Valid_loss 1.200705
Epoch 14, Train Loss 0.929376, Valid_loss 1.212973
Epoch 15, Train Loss 0.927156, Valid_loss 1.242993
Epoch 16, Train Loss 0.930963, Valid_loss 1.253680
Epoch 17, Train Loss 0.927579, Valid_loss 1.373933
Epoch 18, Train Loss 0.954971, Valid_loss 1.227418
Epoch 19, Train Loss 0.927737, Valid_loss 1.240265
Epoch 20, Train Loss 0.926075, Valid_loss 1.233782
Epoch 21, Train Loss 0.926702, Valid_loss 1.243342
Epoch 22, Train Loss 0.928732, Valid_loss 1.233684
Epoch 23, Train Loss 0.927693, Valid_loss 1.302578
Epoch 24, Train Loss 0.933777, Valid_loss 1.220916
Epoch 25, Train Loss 0.925695, Valid_loss 1.224937
Epoch 26, Train Loss 0.929109, Valid_loss 1.231263
Epoch 27, Train Loss 0.928922, Valid_loss 1.231739
Epoch 28, Train Loss 0.929161, Valid_loss 1.237685
Epoch 29, Train Loss 1.035756, Valid_loss 1.232029
Epoch 30, Train Loss 0.940681, Valid_loss 1.218570
Epoch 31, Train Loss 0.930093, Valid_loss 1.229978
Epoch 32, Train Loss 0.927161, Valid_loss 1.226388
Epoch 33, Train Loss 0.926277, Valid_loss 1.234417
Epoch 34, Train Loss 0.927816, Valid_loss 1.237006
Epoch 35, Train Loss 0.929648, Valid_loss 1.236922
Epoch 36, Train Loss 0.929267, Valid_loss 1.240845
Epoch 37, Train Loss 0.927209, Valid_loss 1.230903
Epoch 38, Train Loss 0.928532, Valid_loss 1.233797
Epoch 39, Train Loss 0.928674, Valid_loss 1.241885
Epoch 40, Train Loss 0.929209, Valid_loss 1.246638
Epoch 41, Train Loss 0.925908, Valid_loss 1.230019
Epoch 42, Train Loss 0.927436, Valid_loss 1.229111
Epoch 43, Train Loss 0.989552, Valid_loss 1.236384
Epoch 44, Train Loss 0.946665, Valid_loss 1.215491
Epoch 45, Train Loss 0.928285, Valid_loss 1.238551
Epoch 46, Train Loss 0.927682, Valid_loss 1.230928
Epoch 47, Train Loss 0.929504, Valid_loss 1.231987
Epoch 48, Train Loss 0.927611, Valid_loss 1.239875
Epoch 49, Train Loss 0.928544, Valid_loss 1.234689
Epoch 50, Train Loss 0.929162, Valid_loss 1.231246
Epoch 51, Train Loss 0.926901, Valid_loss 1.234042
Epoch 52, Train Loss 0.926580, Valid_loss 1.233320
Epoch 53, Train Loss 0.925428, Valid_loss 1.231273
Epoch 54, Train Loss 0.925613, Valid_loss 1.236915
Epoch 55, Train Loss 0.924354, Valid_loss 1.237868
[I 2025-08-29 10:33:04,748] Trial 1 finished with value: 1.1637628891251304 and parameters: {'learning_rate': 0.01, 'epochs': 100, 'heads': 2, 'dropout': 0.7, 'weight_decay': 0.0001, 'emb_dim': 64, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.2105662663551894.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 18.01 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 1.069434, Valid_loss 1.106833
Epoch 2, Train Loss 0.999010, Valid_loss 1.125100
Epoch 3, Train Loss 0.913787, Valid_loss 1.087465
Epoch 4, Train Loss 0.865439, Valid_loss 0.881526
Epoch 5, Train Loss 0.692933, Valid_loss 0.683024
Epoch 6, Train Loss 0.698016, Valid_loss 0.683062
Epoch 7, Train Loss 0.681310, Valid_loss 1.444685
Epoch 8, Train Loss 0.889973, Valid_loss 0.730883
Epoch 9, Train Loss 0.675639, Valid_loss 0.781211
Epoch 10, Train Loss 0.650262, Valid_loss 0.660613
Epoch 11, Train Loss 0.709447, Valid_loss 0.665041
Epoch 12, Train Loss 0.620790, Valid_loss 0.667470
Epoch 13, Train Loss 0.634388, Valid_loss 0.842108
Epoch 14, Train Loss 0.577418, Valid_loss 0.691099
Epoch 15, Train Loss 0.568134, Valid_loss 0.618713
Epoch 16, Train Loss 0.687063, Valid_loss 0.762394
Epoch 17, Train Loss 0.690363, Valid_loss 0.673703
Epoch 18, Train Loss 0.581358, Valid_loss 0.714143
Epoch 19, Train Loss 0.633912, Valid_loss 0.624899
Epoch 20, Train Loss 0.556402, Valid_loss 0.596882
Epoch 21, Train Loss 0.641125, Valid_loss 0.620453
Epoch 22, Train Loss 0.542390, Valid_loss 0.690246
Epoch 23, Train Loss 0.598689, Valid_loss 0.600570
Epoch 24, Train Loss 0.522432, Valid_loss 0.605520
Epoch 25, Train Loss 0.509028, Valid_loss 0.775131
Epoch 26, Train Loss 0.522390, Valid_loss 0.551980
Epoch 27, Train Loss 0.535205, Valid_loss 0.557822
Epoch 28, Train Loss 0.530076, Valid_loss 0.597609
Epoch 29, Train Loss 0.617155, Valid_loss 0.570342
Epoch 30, Train Loss 0.597533, Valid_loss 0.578141
Epoch 31, Train Loss 0.535885, Valid_loss 0.534112
Epoch 32, Train Loss 0.595740, Valid_loss 0.576870
Epoch 33, Train Loss 0.606906, Valid_loss 0.535552
Epoch 34, Train Loss 0.453909, Valid_loss 0.529275
Epoch 35, Train Loss 0.429100, Valid_loss 1.291948
Epoch 36, Train Loss 0.500621, Valid_loss 0.645737
Epoch 37, Train Loss 0.418721, Valid_loss 0.698973
Epoch 38, Train Loss 0.584963, Valid_loss 1.566098
Epoch 39, Train Loss 0.437907, Valid_loss 2.104278
Epoch 40, Train Loss 0.418051, Valid_loss 0.767592
Epoch 41, Train Loss 0.488702, Valid_loss 1.290368
Epoch 42, Train Loss 0.532722, Valid_loss 1.581800
Epoch 43, Train Loss 0.378030, Valid_loss 3.170947
Epoch 44, Train Loss 0.556998, Valid_loss 0.565104
Epoch 45, Train Loss 0.419575, Valid_loss 1.129069
Epoch 46, Train Loss 0.660759, Valid_loss 0.834269
Epoch 47, Train Loss 0.524702, Valid_loss 0.491212
Epoch 48, Train Loss 0.547215, Valid_loss 1.321904
Epoch 49, Train Loss 0.438795, Valid_loss 0.478850
Epoch 50, Train Loss 0.425526, Valid_loss 0.822144
Epoch 51, Train Loss 0.461799, Valid_loss 1.046727
Epoch 52, Train Loss 0.385434, Valid_loss 2.171707
[I 2025-08-29 10:53:36,928] Trial 2 finished with value: 0.4788496674207801 and parameters: {'learning_rate': 0.001, 'epochs': 100, 'heads': 1, 'dropout': 0.7, 'weight_decay': 0.001, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.2105662663551894.
선택된 trial params: {'learning_rate': 0.001, 'epochs': 100, 'heads': 1, 'dropout': 0.0, 'weight_decay': 0.0001, 'emb_dim': 8, 'augment_num': 100, 'pca': False}
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=9, batch_size=1 -> steps=9
Memory Allocated: 16.69 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 1.075939, Valid_loss 1.126189
Epoch 2, Train Loss 0.965030, Valid_loss 1.128870
Epoch 3, Train Loss 0.878133, Valid_loss 1.001220
Epoch 4, Train Loss 0.759584, Valid_loss 0.789240
Epoch 5, Train Loss 0.645846, Valid_loss 0.695523
Epoch 6, Train Loss 0.658886, Valid_loss 0.658352
Epoch 7, Train Loss 0.547984, Valid_loss 0.627963
Epoch 8, Train Loss 0.557299, Valid_loss 0.608127
Epoch 9, Train Loss 0.544830, Valid_loss 0.672795
Epoch 10, Train Loss 0.497098, Valid_loss 0.556069
Epoch 11, Train Loss 0.494019, Valid_loss 0.547066
Epoch 12, Train Loss 0.472608, Valid_loss 0.540700
Epoch 13, Train Loss 0.462045, Valid_loss 0.486508
Epoch 14, Train Loss 0.407755, Valid_loss 0.446162
Epoch 15, Train Loss 0.390654, Valid_loss 0.605770
Epoch 16, Train Loss 0.376190, Valid_loss 0.597632
Epoch 17, Train Loss 0.356966, Valid_loss 0.389435
Epoch 18, Train Loss 0.315486, Valid_loss 0.359542
Epoch 19, Train Loss 0.255120, Valid_loss 0.448451
Epoch 20, Train Loss 0.259874, Valid_loss 0.767685
Epoch 21, Train Loss 0.176748, Valid_loss 0.394314
Epoch 22, Train Loss 0.166654, Valid_loss 0.322589
Epoch 23, Train Loss 0.105054, Valid_loss 0.414556
Epoch 24, Train Loss 0.090675, Valid_loss 0.650665
Epoch 25, Train Loss 0.045230, Valid_loss 0.629903
Epoch 26, Train Loss 0.032765, Valid_loss 0.614345
Epoch 27, Train Loss 0.026296, Valid_loss 0.643670
Epoch 28, Train Loss 0.021740, Valid_loss 0.655808
Epoch 29, Train Loss 0.018320, Valid_loss 0.685210
Epoch 30, Train Loss 0.015678, Valid_loss 0.706974
Epoch 31, Train Loss 0.013546, Valid_loss 0.731577
Epoch 32, Train Loss 0.011766, Valid_loss 0.742853
Epoch 33, Train Loss 0.010296, Valid_loss 0.767707
Epoch 34, Train Loss 0.009002, Valid_loss 0.775262
Epoch 35, Train Loss 0.007925, Valid_loss 0.789022
Epoch 36, Train Loss 0.007003, Valid_loss 0.807252
Epoch 37, Train Loss 0.006222, Valid_loss 0.827884
Epoch 38, Train Loss 0.005535, Valid_loss 0.849120
Epoch 39, Train Loss 0.004934, Valid_loss 0.856703
Epoch 40, Train Loss 0.004415, Valid_loss 0.875843
Epoch 41, Train Loss 0.003949, Valid_loss 0.893201
Epoch 42, Train Loss 0.003541, Valid_loss 0.907677
Epoch 43, Train Loss 0.003179, Valid_loss 0.925164
Epoch 44, Train Loss 0.002859, Valid_loss 0.940361
Epoch 45, Train Loss 0.002582, Valid_loss 0.964873
Epoch 46, Train Loss 0.002332, Valid_loss 0.974324
Epoch 47, Train Loss 0.002112, Valid_loss 0.994059
Epoch 48, Train Loss 0.001916, Valid_loss 1.012495
Epoch 49, Train Loss 0.001744, Valid_loss 1.024493
Epoch 50, Train Loss 0.001591, Valid_loss 1.031013
Epoch 51, Train Loss 0.001481, Valid_loss 1.046311
Epoch 52, Train Loss 0.001412, Valid_loss 1.058831
환자ID=P1290 -- true: [[2]] -- pred: tensor([[-2.0129,  1.3498, -0.6558]], device='cuda:0')
환자ID=P1371 -- true: [[2]] -- pred: tensor([[-2.9524,  0.3277,  1.3871]], device='cuda:0')
환자ID=P1430 -- true: [[2]] -- pred: tensor([[-2.1329,  1.5293, -0.2133]], device='cuda:0')
환자ID=P1516 -- true: [[0]] -- pred: tensor([[ 2.7102, -1.3996, -3.2041]], device='cuda:0')
환자ID=P1539 -- true: [[0]] -- pred: tensor([[ 2.6533, -1.4748, -2.7048]], device='cuda:0')
환자ID=P1603 -- true: [[0]] -- pred: tensor([[ 2.3669, -1.4484, -2.5565]], device='cuda:0')
환자ID=P1631 -- true: [[1]] -- pred: tensor([[-0.8900,  1.5510, -1.8813]], device='cuda:0')
환자ID=P1722 -- true: [[1]] -- pred: tensor([[-2.5337,  1.2696,  0.3916]], device='cuda:0')
환자ID=P1726 -- true: [[1]] -- pred: tensor([[-2.3997,  1.2416,  0.1426]], device='cuda:0')
Best performance: Epoch 22, Loss 0.166654, Test ACC 0.777778, Test AUC 0.851852, Test Recall 0.777778, Test Precision 0.866667
Confusion Matrix:
 [[3 0 0]
 [0 3 0]
 [0 2 1]]
✅ Total valid splits used: 2
🔁 Repeat 1, Fold 2
cell type :  TTCTTCCGTTCAACGT-1-0                Astrocyte
CATCCACCATCTAACG-1-0      Smooth_muscle_cells
ACCCAAACAGCTAACT-1-0                  Neurons
AAGGAATCAACTGGTT-1-0     Neuroepithelial_cell
TACCCGTAGCGTGCTC-1-0                Astrocyte
                                 ...         
TTATTGCGTCGGTGTC-1-79       Endothelial_cells
GTCACGGGTTGTATGC-1-79       Endothelial_cells
GTCATGATCTTTCGAT-1-79       Endothelial_cells
GCGATCGTCAGAGTGG-1-79               Platelets
GCCCGAACAGAGAAAG-1-79       Endothelial_cells
Name: singler_annotation, Length: 469605, dtype: string
cell type annotation :  TTCTTCCGTTCAACGT-1-0                Astrocyte
CATCCACCATCTAACG-1-0      Smooth_muscle_cells
ACCCAAACAGCTAACT-1-0                  Neurons
AAGGAATCAACTGGTT-1-0     Neuroepithelial_cell
TACCCGTAGCGTGCTC-1-0                Astrocyte
                                 ...         
TTATTGCGTCGGTGTC-1-79       Endothelial_cells
GTCACGGGTTGTATGC-1-79       Endothelial_cells
GTCATGATCTTTCGAT-1-79       Endothelial_cells
GCGATCGTCAGAGTGG-1-79               Platelets
GCCCGAACAGAGAAAG-1-79       Endothelial_cells
Name: singler_annotation, Length: 469605, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Astrocyte', 'Smooth_muscle_cells', 'Neurons', 'Neuroepithelial_cell', 'Endothelial_cells', 'Osteoblasts', 'Platelets', 'Hepatocytes', 'Embryonic_stem_cells', 'MEP', 'Erythroblast', 'Fibroblasts', 'iPS_cells', 'MSC', 'Macrophage', 'Gametocytes', 'Chondrocytes', 'NK_cell', 'Neutrophils', 'HSC_CD34+', 'Monocyte', 'Tissue_stem_cells', 'DC', 'HSC_-G-CSF', 'T_cells', 'Epithelial_cells', 'Unknown', 'Pre-B_cell_CD34-', 'GMP', 'B_cell', 'Pro-Myelocyte', 'Keratinocytes', 'Myelocyte', 'BM', 'CMP', 'BM & Prog.', 'Pro-B_cell_CD34+']
라벨별 그룹 개수 {2: 9, 1: 12, 0: 13}
cell type :  ACAGCCGCAAGCGAGT-1-1                 Neurons
ATATCCTGTCCCTAAA-1-1       Endothelial_cells
CAATGACCAGTTGTCA-1-1                 Neurons
CTAGACACAAGGTTGG-1-1                 Neurons
ATCGTCCGTATTTCTC-1-1     Smooth_muscle_cells
                                ...         
GTCTCACGTGTCATGT-1-67                NK_cell
CGCGTGAAGGGCAGAG-1-67              Astrocyte
GTCTGTCTCATTCTTG-1-67      Endothelial_cells
AGCCAGCGTCGCTTGG-1-67            Osteoblasts
CATCCACTCTACTGCC-1-67      Endothelial_cells
Name: singler_annotation, Length: 123084, dtype: string
cell type annotation :  ACAGCCGCAAGCGAGT-1-1                 Neurons
ATATCCTGTCCCTAAA-1-1       Endothelial_cells
CAATGACCAGTTGTCA-1-1                 Neurons
CTAGACACAAGGTTGG-1-1                 Neurons
ATCGTCCGTATTTCTC-1-1     Smooth_muscle_cells
                                ...         
GTCTCACGTGTCATGT-1-67                NK_cell
CGCGTGAAGGGCAGAG-1-67              Astrocyte
GTCTGTCTCATTCTTG-1-67      Endothelial_cells
AGCCAGCGTCGCTTGG-1-67            Osteoblasts
CATCCACTCTACTGCC-1-67      Endothelial_cells
Name: singler_annotation, Length: 123084, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Neurons', 'Endothelial_cells', 'Smooth_muscle_cells', 'Neuroepithelial_cell', 'Astrocyte', 'Fibroblasts', 'Osteoblasts', 'Erythroblast', 'iPS_cells', 'Embryonic_stem_cells', 'Platelets', 'MSC', 'Hepatocytes', 'NK_cell', 'MEP', 'BM & Prog.', 'Gametocytes', 'Chondrocytes', 'HSC_CD34+', 'Tissue_stem_cells', 'Macrophage', 'Monocyte', 'Neutrophils', 'DC', 'HSC_-G-CSF', 'Unknown', 'Keratinocytes', 'B_cell', 'T_cells', 'Myelocyte', 'Epithelial_cells', 'GMP', 'BM', 'Pro-Myelocyte', 'Pro-B_cell_CD34+', 'CMP', 'Pre-B_cell_CD34-']
라벨별 그룹 개수 {2: 2, 1: 3, 0: 3}
🔍 Split #3
  → train_p_index 환자 수 (환자 단위로 묶인 index list): 34
  → test_p_index 환자 수  (환자 단위로 묶인 index list): 8
  → train 환자 ID: ['P1290', 'P1304', 'P1358', 'P1371', 'P1425', 'P1430', 'P1437', 'P1462', 'P1472', 'P1508', 'P1510', 'P1515', 'P1516', 'P1539', 'P1547', 'P1549', 'P1558', 'P1561', 'P1600', 'P1602', 'P1603', 'P1606', 'P1610', 'P1617', 'P1622', 'P1630', 'P1631', 'P1678', 'P1685', 'P1707', 'P1718', 'P1722', 'P1726', 'P1735']
  → test  환자 ID: ['P1300', 'P1422', 'P1447', 'P1479', 'P1504', 'P1540', 'P1582', 'P1702']
  → train 환자 ID 및 라벨:
    ID: P1290, Label: 2
    ID: P1304, Label: 2
    ID: P1358, Label: 2
    ID: P1371, Label: 2
    ID: P1425, Label: 1
    ID: P1430, Label: 2
    ID: P1437, Label: 2
    ID: P1462, Label: 1
    ID: P1472, Label: 2
    ID: P1508, Label: 1
    ID: P1510, Label: 1
    ID: P1515, Label: 0
    ID: P1516, Label: 0
    ID: P1539, Label: 0
    ID: P1547, Label: 0
    ID: P1549, Label: 0
    ID: P1558, Label: 0
    ID: P1561, Label: 0
    ID: P1600, Label: 0
    ID: P1602, Label: 1
    ID: P1603, Label: 0
    ID: P1606, Label: 2
    ID: P1610, Label: 0
    ID: P1617, Label: 2
    ID: P1622, Label: 0
    ID: P1630, Label: 1
    ID: P1631, Label: 1
    ID: P1678, Label: 0
    ID: P1685, Label: 1
    ID: P1707, Label: 1
    ID: P1718, Label: 0
    ID: P1722, Label: 1
    ID: P1726, Label: 1
    ID: P1735, Label: 1
  → test 환자 ID 및 라벨:
    ID: P1300, Label: 2
    ID: P1422, Label: 1
    ID: P1447, Label: 1
    ID: P1479, Label: 1
    ID: P1504, Label: 2
    ID: P1540, Label: 0
    ID: P1582, Label: 0
    ID: P1702, Label: 0
전체 데이터 index 길이 42
label_stat (train 환자 라벨 목록) 갯수 34
train_data에서 환자 단위로, train과 validation 나누기
기존 train_p_index 34
기존 (train) label_stat 34
train-vali 분할 후! 
train y 의 classes : {0, 1, 2} valid y 의 classes : {0, 1, 2} label_stat 의 classes : {0, 1, 2}
train_p_index_ 22
valid_p_index 12
test_p_index 8
→ train 환자 ID 및 라벨:
   총 개수: 22
   환자ID=P1722, Label=1, 셀개수=21432
   환자ID=P1547, Label=0, 셀개수=8253
   환자ID=P1358, Label=2, 셀개수=23984
   환자ID=P1472, Label=2, 셀개수=19513
   환자ID=P1617, Label=2, 셀개수=17986
   환자ID=P1678, Label=0, 셀개수=10085
   환자ID=P1425, Label=1, 셀개수=15378
   환자ID=P1735, Label=1, 셀개수=12009
   환자ID=P1718, Label=0, 셀개수=9278
   환자ID=P1558, Label=0, 셀개수=10469
   환자ID=P1685, Label=1, 셀개수=10043
   환자ID=P1516, Label=0, 셀개수=9361
   환자ID=P1430, Label=2, 셀개수=11131
   환자ID=P1631, Label=1, 셀개수=13686
   환자ID=P1630, Label=1, 셀개수=17633
   환자ID=P1539, Label=0, 셀개수=11076
   환자ID=P1610, Label=0, 셀개수=13919
   환자ID=P1515, Label=0, 셀개수=14502
   환자ID=P1510, Label=1, 셀개수=10744
   환자ID=P1462, Label=1, 셀개수=21715
   환자ID=P1603, Label=0, 셀개수=10638
   환자ID=P1549, Label=0, 셀개수=11709
→ valid 환자 ID 및 라벨:
   총 개수: 12
   환자ID=P1304, Label=2, 셀개수=19123
   환자ID=P1437, Label=2, 셀개수=21695
   환자ID=P1561, Label=0, 셀개수=10016
   환자ID=P1508, Label=1, 셀개수=20536
   환자ID=P1290, Label=2, 셀개수=8357
   환자ID=P1602, Label=1, 셀개수=16580
   환자ID=P1726, Label=1, 셀개수=12389
   환자ID=P1600, Label=0, 셀개수=14882
   환자ID=P1707, Label=1, 셀개수=9517
   환자ID=P1371, Label=2, 셀개수=16233
   환자ID=P1622, Label=0, 셀개수=7210
   환자ID=P1606, Label=2, 셀개수=8523
→ test 환자 ID 및 라벨:
   총 개수: 8
   환자ID=P1300, Label=2, 셀개수=17318
   환자ID=P1422, Label=1, 셀개수=23315
   환자ID=P1447, Label=1, 셀개수=11151
   환자ID=P1479, Label=1, 셀개수=19124
   환자ID=P1504, Label=2, 셀개수=8133
   환자ID=P1540, Label=0, 셀개수=11638
   환자ID=P1582, Label=0, 셀개수=18855
   환자ID=P1702, Label=0, 셀개수=13550
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Astrocyte', 'Smooth_muscle_cells', 'Neurons', 'Neuroepithelial_cell', 'Astrocyte', 'Endothelial_cells', 'Osteoblasts', 'Platelets', 'Neurons', 'Hepatocytes']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
전체 데이터 길이 592689
전체 cell type 길이 0                    Astrocyte
1          Smooth_muscle_cells
2                      Neurons
3         Neuroepithelial_cell
4                    Astrocyte
                  ...         
592684                 NK_cell
592685               Astrocyte
592686       Endothelial_cells
592687             Osteoblasts
592688       Endothelial_cells
Length: 592689, dtype: string
cell type의 NaN 개수 체크 0
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:12,  8.09it/s]  2%|▏         | 2/100 [00:00<00:12,  8.04it/s]  3%|▎         | 3/100 [00:00<00:11,  8.19it/s]  4%|▍         | 4/100 [00:00<00:11,  8.26it/s]  5%|▌         | 5/100 [00:00<00:11,  8.23it/s]  6%|▌         | 6/100 [00:00<00:11,  8.17it/s]  7%|▋         | 7/100 [00:00<00:11,  8.05it/s]  8%|▊         | 8/100 [00:00<00:11,  7.96it/s]  9%|▉         | 9/100 [00:01<00:11,  7.94it/s] 10%|█         | 10/100 [00:01<00:11,  7.99it/s] 11%|█         | 11/100 [00:01<00:11,  8.02it/s] 12%|█▏        | 12/100 [00:01<00:10,  8.19it/s] 13%|█▎        | 13/100 [00:01<00:10,  8.26it/s] 14%|█▍        | 14/100 [00:01<00:10,  8.24it/s] 15%|█▌        | 15/100 [00:01<00:10,  8.37it/s] 16%|█▌        | 16/100 [00:01<00:10,  8.22it/s] 17%|█▋        | 17/100 [00:02<00:10,  8.22it/s] 18%|█▊        | 18/100 [00:02<00:10,  8.11it/s] 19%|█▉        | 19/100 [00:02<00:10,  8.03it/s] 20%|██        | 20/100 [00:02<00:10,  7.88it/s] 21%|██        | 21/100 [00:02<00:10,  7.81it/s] 22%|██▏       | 22/100 [00:02<00:09,  7.91it/s] 23%|██▎       | 23/100 [00:02<00:09,  7.97it/s] 24%|██▍       | 24/100 [00:02<00:09,  8.05it/s] 25%|██▌       | 25/100 [00:03<00:09,  7.97it/s] 26%|██▌       | 26/100 [00:03<00:09,  7.95it/s] 27%|██▋       | 27/100 [00:03<00:09,  7.92it/s] 28%|██▊       | 28/100 [00:03<00:09,  7.98it/s] 29%|██▉       | 29/100 [00:03<00:08,  8.02it/s] 30%|███       | 30/100 [00:03<00:08,  7.93it/s] 31%|███       | 31/100 [00:03<00:08,  7.81it/s] 32%|███▏      | 32/100 [00:03<00:08,  7.75it/s] 33%|███▎      | 33/100 [00:04<00:08,  7.77it/s] 34%|███▍      | 34/100 [00:04<00:08,  7.73it/s] 35%|███▌      | 35/100 [00:04<00:08,  7.68it/s] 36%|███▌      | 36/100 [00:04<00:08,  7.69it/s] 37%|███▋      | 37/100 [00:04<00:08,  7.67it/s] 38%|███▊      | 38/100 [00:04<00:08,  7.70it/s] 39%|███▉      | 39/100 [00:04<00:07,  7.63it/s] 40%|████      | 40/100 [00:05<00:07,  7.68it/s] 41%|████      | 41/100 [00:05<00:07,  7.69it/s] 42%|████▏     | 42/100 [00:05<00:07,  7.59it/s] 43%|████▎     | 43/100 [00:05<00:07,  7.60it/s] 44%|████▍     | 44/100 [00:05<00:07,  7.61it/s] 45%|████▌     | 45/100 [00:05<00:07,  7.59it/s] 46%|████▌     | 46/100 [00:05<00:07,  7.58it/s] 47%|████▋     | 47/100 [00:05<00:06,  7.59it/s] 48%|████▊     | 48/100 [00:06<00:06,  7.63it/s] 49%|████▉     | 49/100 [00:06<00:06,  7.56it/s] 50%|█████     | 50/100 [00:06<00:06,  7.53it/s] 51%|█████     | 51/100 [00:06<00:06,  7.64it/s] 52%|█████▏    | 52/100 [00:06<00:06,  7.57it/s] 53%|█████▎    | 53/100 [00:06<00:06,  7.45it/s] 54%|█████▍    | 54/100 [00:06<00:06,  7.49it/s] 55%|█████▌    | 55/100 [00:07<00:06,  7.49it/s] 56%|█████▌    | 56/100 [00:07<00:05,  7.48it/s] 57%|█████▋    | 57/100 [00:07<00:05,  7.47it/s] 58%|█████▊    | 58/100 [00:07<00:05,  7.46it/s] 59%|█████▉    | 59/100 [00:07<00:05,  7.41it/s] 60%|██████    | 60/100 [00:07<00:05,  7.38it/s] 61%|██████    | 61/100 [00:07<00:05,  7.31it/s] 62%|██████▏   | 62/100 [00:07<00:05,  7.35it/s] 63%|██████▎   | 63/100 [00:08<00:05,  7.34it/s] 64%|██████▍   | 64/100 [00:08<00:04,  7.26it/s] 65%|██████▌   | 65/100 [00:08<00:04,  7.26it/s] 66%|██████▌   | 66/100 [00:08<00:04,  7.29it/s] 67%|██████▋   | 67/100 [00:08<00:04,  7.29it/s] 68%|██████▊   | 68/100 [00:08<00:04,  7.25it/s] 69%|██████▉   | 69/100 [00:08<00:04,  7.29it/s] 70%|███████   | 70/100 [00:09<00:04,  7.25it/s] 71%|███████   | 71/100 [00:09<00:04,  7.22it/s] 72%|███████▏  | 72/100 [00:09<00:03,  7.31it/s] 73%|███████▎  | 73/100 [00:09<00:03,  7.32it/s] 74%|███████▍  | 74/100 [00:09<00:03,  7.22it/s] 75%|███████▌  | 75/100 [00:09<00:03,  7.21it/s] 76%|███████▌  | 76/100 [00:09<00:03,  7.22it/s] 77%|███████▋  | 77/100 [00:10<00:03,  7.23it/s] 78%|███████▊  | 78/100 [00:10<00:03,  7.13it/s] 79%|███████▉  | 79/100 [00:10<00:02,  7.23it/s] 80%|████████  | 80/100 [00:10<00:02,  7.17it/s] 81%|████████  | 81/100 [00:10<00:02,  7.28it/s] 82%|████████▏ | 82/100 [00:10<00:02,  7.20it/s] 83%|████████▎ | 83/100 [00:10<00:02,  7.05it/s] 84%|████████▍ | 84/100 [00:11<00:02,  7.01it/s] 85%|████████▌ | 85/100 [00:11<00:02,  6.98it/s] 86%|████████▌ | 86/100 [00:11<00:02,  6.90it/s] 87%|████████▋ | 87/100 [00:11<00:01,  6.89it/s] 88%|████████▊ | 88/100 [00:11<00:01,  6.80it/s] 89%|████████▉ | 89/100 [00:11<00:01,  6.80it/s] 90%|█████████ | 90/100 [00:11<00:01,  6.88it/s] 91%|█████████ | 91/100 [00:12<00:01,  6.97it/s] 92%|█████████▏| 92/100 [00:12<00:01,  6.95it/s] 93%|█████████▎| 93/100 [00:12<00:01,  6.95it/s] 94%|█████████▍| 94/100 [00:12<00:00,  6.95it/s] 95%|█████████▌| 95/100 [00:12<00:00,  6.83it/s] 96%|█████████▌| 96/100 [00:12<00:00,  6.90it/s] 97%|█████████▋| 97/100 [00:12<00:00,  7.02it/s] 98%|█████████▊| 98/100 [00:13<00:00,  7.06it/s] 99%|█████████▉| 99/100 [00:13<00:00,  6.98it/s]100%|██████████| 100/100 [00:13<00:00,  7.01it/s]100%|██████████| 100/100 [00:13<00:00,  7.49it/s]
[I 2025-08-29 11:13:39,546] A new study created in memory with name: no-name-f6bbd9e4-ca1a-4cfe-84e5-0793348c78ea
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 16.69 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 1.069818, Valid_loss 1.368637
Epoch 2, Train Loss 0.870369, Valid_loss 1.490676
Epoch 3, Train Loss 0.834179, Valid_loss 1.642037
Epoch 4, Train Loss 0.926898, Valid_loss 1.444786
Epoch 5, Train Loss 0.865492, Valid_loss 1.496796
Epoch 6, Train Loss 0.863833, Valid_loss 1.549025
Epoch 7, Train Loss 0.858216, Valid_loss 1.587235
Epoch 8, Train Loss 0.849685, Valid_loss 1.805272
Epoch 9, Train Loss 0.870714, Valid_loss 1.552962
Epoch 10, Train Loss 0.852083, Valid_loss 1.568283
Epoch 11, Train Loss 0.847792, Valid_loss 1.688935
Epoch 12, Train Loss 0.848572, Valid_loss 1.611721
Epoch 13, Train Loss 0.854240, Valid_loss 1.591747
Epoch 14, Train Loss 0.846045, Valid_loss 1.609456
Epoch 15, Train Loss 0.847753, Valid_loss 1.614058
Epoch 16, Train Loss 0.846708, Valid_loss 1.636316
Epoch 17, Train Loss 0.848084, Valid_loss 1.630381
Epoch 18, Train Loss 0.846613, Valid_loss 1.632585
Epoch 19, Train Loss 0.847558, Valid_loss 1.616521
Epoch 20, Train Loss 0.849062, Valid_loss 1.646492
Epoch 21, Train Loss 0.847427, Valid_loss 1.636844
Epoch 22, Train Loss 0.846065, Valid_loss 1.649118
Epoch 23, Train Loss 0.847911, Valid_loss 1.642036
Epoch 24, Train Loss 0.847835, Valid_loss 1.640503
Epoch 25, Train Loss 0.849930, Valid_loss 1.643035
Epoch 26, Train Loss 0.847191, Valid_loss 1.623579
Epoch 27, Train Loss 0.847864, Valid_loss 1.613146
Epoch 28, Train Loss 0.847626, Valid_loss 1.625970
Epoch 29, Train Loss 0.846481, Valid_loss 1.615470
Epoch 30, Train Loss 0.848255, Valid_loss 1.616540
Epoch 31, Train Loss 0.845750, Valid_loss 1.624436
Epoch 32, Train Loss 0.845816, Valid_loss 1.638819
Epoch 33, Train Loss 0.845086, Valid_loss 1.628014
Epoch 34, Train Loss 0.851394, Valid_loss 1.793679
Epoch 35, Train Loss 0.857269, Valid_loss 1.649859
Epoch 36, Train Loss 0.847623, Valid_loss 1.652190
Epoch 37, Train Loss 0.851483, Valid_loss 1.606970
Epoch 38, Train Loss 0.844984, Valid_loss 1.632023
Epoch 39, Train Loss 0.846297, Valid_loss 1.630844
Epoch 40, Train Loss 0.846743, Valid_loss 1.625874
Epoch 41, Train Loss 0.849305, Valid_loss 1.623732
Epoch 42, Train Loss 0.845898, Valid_loss 1.608002
Epoch 43, Train Loss 0.846241, Valid_loss 1.617138
Epoch 44, Train Loss 0.845832, Valid_loss 1.625587
Epoch 45, Train Loss 0.847757, Valid_loss 1.634008
Epoch 46, Train Loss 0.846666, Valid_loss 1.631983
Epoch 47, Train Loss 0.847905, Valid_loss 1.623748
Epoch 48, Train Loss 0.845870, Valid_loss 1.631568
Epoch 49, Train Loss 0.846662, Valid_loss 1.620438
Epoch 50, Train Loss 0.851559, Valid_loss 1.610601
Epoch 51, Train Loss 0.846027, Valid_loss 1.618678
Epoch 52, Train Loss 0.844602, Valid_loss 1.614044
Epoch 53, Train Loss 0.845646, Valid_loss 1.621816
Epoch 54, Train Loss 0.845718, Valid_loss 1.632498
[I 2025-08-29 11:34:50,980] Trial 0 finished with value: 1.368636777003606 and parameters: {'learning_rate': 0.01, 'epochs': 100, 'heads': 1, 'dropout': 0.7, 'weight_decay': 0.001, 'emb_dim': 8, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 1.368636777003606.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 18.01 MB
Memory Reserved: 42.00 MB
cuda
CUDA OOM 발생 — 단계적 백오프 시작.
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 9091.39 MB
Memory Reserved: 9098.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 9091.52 MB
Memory Reserved: 9118.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 9091.36 MB
Memory Reserved: 9098.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 9091.52 MB
Memory Reserved: 9118.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[I 2025-08-29 11:34:52,439] Trial 1 pruned. Pruned due to OOM after backoff
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 9093.60 MB
Memory Reserved: 9098.00 MB
cuda
Epoch 1, Train Loss 1.024295, Valid_loss 1.551993
Epoch 2, Train Loss 0.905954, Valid_loss 1.889097
Epoch 3, Train Loss 0.924032, Valid_loss 1.146041
Epoch 4, Train Loss 0.886093, Valid_loss 1.335729
Epoch 5, Train Loss 0.860069, Valid_loss 1.346497
Epoch 6, Train Loss 0.855837, Valid_loss 1.172530
Epoch 7, Train Loss 0.900457, Valid_loss 1.358361
Epoch 8, Train Loss 0.868801, Valid_loss 1.532411
Epoch 9, Train Loss 0.850589, Valid_loss 1.908620
Epoch 10, Train Loss 0.900253, Valid_loss 1.527770
Epoch 11, Train Loss 0.856817, Valid_loss 1.308471
Epoch 12, Train Loss 0.870856, Valid_loss 1.646640
Epoch 13, Train Loss 0.859843, Valid_loss 1.360953
Epoch 14, Train Loss 0.852127, Valid_loss 1.313495
Epoch 15, Train Loss 0.856679, Valid_loss 1.408587
Epoch 16, Train Loss 0.849272, Valid_loss 1.347551
Epoch 17, Train Loss 0.846232, Valid_loss 1.657493
Epoch 18, Train Loss 0.870752, Valid_loss 1.480230
Epoch 19, Train Loss 0.861616, Valid_loss 1.374428
Epoch 20, Train Loss 0.867272, Valid_loss 1.426694
Epoch 21, Train Loss 0.873615, Valid_loss 1.698545
Epoch 22, Train Loss 0.868336, Valid_loss 1.769635
Epoch 23, Train Loss 0.859453, Valid_loss 1.560402
Epoch 24, Train Loss 0.862821, Valid_loss 1.515894
Epoch 25, Train Loss 0.842845, Valid_loss 1.719100
Epoch 26, Train Loss 0.927848, Valid_loss 1.494112
Epoch 27, Train Loss 0.870602, Valid_loss 1.527833
Epoch 28, Train Loss 0.852287, Valid_loss 1.604791
Epoch 29, Train Loss 0.855795, Valid_loss 1.526513
Epoch 30, Train Loss 0.850905, Valid_loss 1.537564
Epoch 31, Train Loss 0.850756, Valid_loss 1.550775
Epoch 32, Train Loss 0.849377, Valid_loss 1.550556
Epoch 33, Train Loss 0.848513, Valid_loss 1.593231
Epoch 34, Train Loss 0.851873, Valid_loss 1.593886
Epoch 35, Train Loss 0.850733, Valid_loss 1.552489
Epoch 36, Train Loss 0.849611, Valid_loss 1.565176
Epoch 37, Train Loss 0.847967, Valid_loss 1.552512
Epoch 38, Train Loss 0.852341, Valid_loss 1.577550
Epoch 39, Train Loss 0.848760, Valid_loss 1.585138
Epoch 40, Train Loss 0.848378, Valid_loss 1.573701
Epoch 41, Train Loss 0.865582, Valid_loss 1.594118
Epoch 42, Train Loss 0.853201, Valid_loss 1.534798
Epoch 43, Train Loss 0.846805, Valid_loss 1.565327
Epoch 44, Train Loss 0.855431, Valid_loss 1.540485
Epoch 45, Train Loss 0.847962, Valid_loss 1.579304
Epoch 46, Train Loss 0.930965, Valid_loss 1.548320
Epoch 47, Train Loss 0.847916, Valid_loss 1.570843
Epoch 48, Train Loss 0.846098, Valid_loss 1.565461
Epoch 49, Train Loss 0.850158, Valid_loss 1.569861
Epoch 50, Train Loss 0.847810, Valid_loss 1.586892
Epoch 51, Train Loss 0.850282, Valid_loss 1.571907
Epoch 52, Train Loss 0.843027, Valid_loss 1.595096
Epoch 53, Train Loss 0.841979, Valid_loss 1.683194
[I 2025-08-29 11:55:54,415] Trial 2 finished with value: 1.1460405041774113 and parameters: {'learning_rate': 0.01, 'epochs': 100, 'heads': 1, 'dropout': 0.3, 'weight_decay': 0.01, 'emb_dim': 64, 'augment_num': 100, 'pca': False}. Best is trial 2 with value: 1.1460405041774113.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 19.85 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.906190, Valid_loss 1.685116
Epoch 2, Train Loss 0.864554, Valid_loss 1.580011
Epoch 3, Train Loss 0.774967, Valid_loss 1.255241
Epoch 4, Train Loss 0.688373, Valid_loss 1.161684
Epoch 5, Train Loss 0.623500, Valid_loss 1.427964
Epoch 6, Train Loss 0.642105, Valid_loss 1.315687
Epoch 7, Train Loss 0.570789, Valid_loss 0.901152
Epoch 8, Train Loss 0.584408, Valid_loss 0.863227
Epoch 9, Train Loss 0.521337, Valid_loss 1.498400
Epoch 10, Train Loss 0.537878, Valid_loss 0.823240
Epoch 11, Train Loss 0.490538, Valid_loss 1.542898
Epoch 12, Train Loss 0.505913, Valid_loss 1.588681
Epoch 13, Train Loss 0.783752, Valid_loss 2.069980
Epoch 14, Train Loss 0.577719, Valid_loss 0.722826
Epoch 15, Train Loss 0.523870, Valid_loss 0.899747
Epoch 16, Train Loss 0.428745, Valid_loss 0.960267
Epoch 17, Train Loss 0.451865, Valid_loss 1.793344
Epoch 18, Train Loss 0.436708, Valid_loss 1.385474
Epoch 19, Train Loss 0.392965, Valid_loss 2.124555
Epoch 20, Train Loss 0.481240, Valid_loss 0.784482
Epoch 21, Train Loss 0.523276, Valid_loss 2.194650
Epoch 22, Train Loss 0.394040, Valid_loss 0.932436
Epoch 23, Train Loss 0.422216, Valid_loss 0.673709
Epoch 24, Train Loss 0.401707, Valid_loss 1.736002
Epoch 25, Train Loss 0.392630, Valid_loss 0.913121
Epoch 26, Train Loss 0.440355, Valid_loss 1.354780
Epoch 27, Train Loss 0.458941, Valid_loss 1.725745
Epoch 28, Train Loss 0.400511, Valid_loss 0.647058
Epoch 29, Train Loss 0.385073, Valid_loss 0.727266
Epoch 30, Train Loss 0.375023, Valid_loss 1.263206
Epoch 31, Train Loss 0.408811, Valid_loss 0.602846
Epoch 32, Train Loss 0.448455, Valid_loss 1.370410
Epoch 33, Train Loss 0.374864, Valid_loss 0.602997
Epoch 34, Train Loss 0.484675, Valid_loss 0.875497
Epoch 35, Train Loss 0.335502, Valid_loss 1.177456
Epoch 36, Train Loss 0.373010, Valid_loss 0.579567
Epoch 37, Train Loss 0.446390, Valid_loss 1.004291
Epoch 38, Train Loss 0.377534, Valid_loss 1.233407
Epoch 39, Train Loss 0.373300, Valid_loss 0.917822
Epoch 40, Train Loss 0.476575, Valid_loss 0.668791
Epoch 41, Train Loss 0.385316, Valid_loss 0.942005
Epoch 42, Train Loss 0.298524, Valid_loss 1.388904
Epoch 43, Train Loss 0.339744, Valid_loss 1.225763
Epoch 44, Train Loss 0.357423, Valid_loss 1.322587
Epoch 45, Train Loss 0.356202, Valid_loss 0.918275
Epoch 46, Train Loss 0.421425, Valid_loss 1.182468
Epoch 47, Train Loss 0.278431, Valid_loss 1.328758
Epoch 48, Train Loss 0.379546, Valid_loss 0.587435
Epoch 49, Train Loss 0.375891, Valid_loss 0.597156
Epoch 50, Train Loss 0.361342, Valid_loss 1.877082
Epoch 51, Train Loss 0.368385, Valid_loss 1.377583
Epoch 52, Train Loss 0.274439, Valid_loss 1.366346
Epoch 53, Train Loss 0.255214, Valid_loss 1.367263
Epoch 54, Train Loss 0.260983, Valid_loss 1.443412
[I 2025-08-29 12:17:19,432] Trial 3 finished with value: 0.5795673363221189 and parameters: {'learning_rate': 0.001, 'epochs': 100, 'heads': 1, 'dropout': 0.5, 'weight_decay': 0.01, 'emb_dim': 64, 'augment_num': 100, 'pca': False}. Best is trial 3 with value: 0.5795673363221189.
선택된 trial params: {'learning_rate': 0.001, 'epochs': 100, 'heads': 1, 'dropout': 0.5, 'weight_decay': 0.01, 'emb_dim': 64, 'augment_num': 100, 'pca': False}
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=8, batch_size=1 -> steps=8
Memory Allocated: 19.85 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.951433, Valid_loss 1.557049
Epoch 2, Train Loss 0.953186, Valid_loss 1.704183
Epoch 3, Train Loss 0.852440, Valid_loss 1.475452
Epoch 4, Train Loss 0.890333, Valid_loss 1.716211
Epoch 5, Train Loss 0.883048, Valid_loss 1.624803
Epoch 6, Train Loss 0.737492, Valid_loss 1.017940
Epoch 7, Train Loss 0.642160, Valid_loss 1.396148
Epoch 8, Train Loss 0.554551, Valid_loss 0.919736
Epoch 9, Train Loss 0.582966, Valid_loss 1.189931
Epoch 10, Train Loss 0.620842, Valid_loss 1.205870
Epoch 11, Train Loss 0.496283, Valid_loss 1.591476
Epoch 12, Train Loss 0.540733, Valid_loss 1.095327
Epoch 13, Train Loss 0.483786, Valid_loss 1.885550
Epoch 14, Train Loss 0.507031, Valid_loss 1.239738
Epoch 15, Train Loss 0.486014, Valid_loss 1.349543
Epoch 16, Train Loss 0.464863, Valid_loss 1.173846
Epoch 17, Train Loss 0.506290, Valid_loss 1.021222
Epoch 18, Train Loss 0.545245, Valid_loss 0.996077
Epoch 19, Train Loss 0.435063, Valid_loss 1.073371
Epoch 20, Train Loss 0.475378, Valid_loss 1.069798
Epoch 21, Train Loss 0.467589, Valid_loss 0.858776
Epoch 22, Train Loss 0.481169, Valid_loss 1.209579
Epoch 23, Train Loss 0.395004, Valid_loss 1.041179
Epoch 24, Train Loss 0.532515, Valid_loss 1.040303
Epoch 25, Train Loss 0.397987, Valid_loss 1.303337
Epoch 26, Train Loss 0.443238, Valid_loss 1.013026
Epoch 27, Train Loss 0.389137, Valid_loss 1.759566
Epoch 28, Train Loss 0.447735, Valid_loss 0.853447
Epoch 29, Train Loss 0.427676, Valid_loss 1.194145
Epoch 30, Train Loss 0.400413, Valid_loss 1.524840
Epoch 31, Train Loss 0.422148, Valid_loss 2.073878
Epoch 32, Train Loss 0.372390, Valid_loss 1.135290
Epoch 33, Train Loss 0.443669, Valid_loss 1.114453
Epoch 34, Train Loss 0.385898, Valid_loss 1.264177
Epoch 35, Train Loss 0.332863, Valid_loss 1.608947
Epoch 36, Train Loss 0.382670, Valid_loss 0.953035
Epoch 37, Train Loss 0.389221, Valid_loss 1.205417
Epoch 38, Train Loss 0.363776, Valid_loss 1.012384
Epoch 39, Train Loss 0.434334, Valid_loss 1.038168
Epoch 40, Train Loss 0.457668, Valid_loss 0.862861
Epoch 41, Train Loss 0.617654, Valid_loss 0.885719
Epoch 42, Train Loss 0.417788, Valid_loss 1.093922
Epoch 43, Train Loss 0.386574, Valid_loss 1.077797
Epoch 44, Train Loss 0.403951, Valid_loss 0.985934
Epoch 45, Train Loss 0.350312, Valid_loss 1.239024
Epoch 46, Train Loss 0.352989, Valid_loss 1.159995
Epoch 47, Train Loss 0.401860, Valid_loss 0.814719
Epoch 48, Train Loss 0.367400, Valid_loss 1.158919
Epoch 49, Train Loss 0.452660, Valid_loss 0.984348
Epoch 50, Train Loss 0.369792, Valid_loss 0.729195
Epoch 51, Train Loss 0.319802, Valid_loss 1.118928
Epoch 52, Train Loss 0.319634, Valid_loss 1.262568
환자ID=P1300 -- true: [[2]] -- pred: tensor([[-1.2590,  0.7248,  0.0526]], device='cuda:0')
환자ID=P1422 -- true: [[1]] -- pred: tensor([[-1.2668,  0.7311,  0.0488]], device='cuda:0')
환자ID=P1447 -- true: [[1]] -- pred: tensor([[-1.2367,  0.6926,  0.0774]], device='cuda:0')
환자ID=P1479 -- true: [[1]] -- pred: tensor([[-1.2403,  0.6997,  0.0729]], device='cuda:0')
환자ID=P1504 -- true: [[2]] -- pred: tensor([[-1.2509,  0.7107,  0.0664]], device='cuda:0')
환자ID=P1540 -- true: [[0]] -- pred: tensor([[ 3.0904, -1.5873, -3.6879]], device='cuda:0')
환자ID=P1582 -- true: [[0]] -- pred: tensor([[ 3.1088, -1.5530, -3.7931]], device='cuda:0')
환자ID=P1702 -- true: [[0]] -- pred: tensor([[ 3.0900, -1.5925, -3.6764]], device='cuda:0')
Best performance: Epoch 50, Loss 0.369792, Test ACC 0.750000, Test AUC 0.777778, Test Recall 0.666667, Test Precision 0.533333
Confusion Matrix:
 [[3 0 0]
 [0 3 0]
 [0 2 0]]
✅ Total valid splits used: 3
🔁 Repeat 1, Fold 3
cell type :  TTCTTCCGTTCAACGT-1-0                Astrocyte
CATCCACCATCTAACG-1-0      Smooth_muscle_cells
ACCCAAACAGCTAACT-1-0                  Neurons
AAGGAATCAACTGGTT-1-0     Neuroepithelial_cell
TACCCGTAGCGTGCTC-1-0                Astrocyte
                                 ...         
CGTCCATAGAATTTGG-1-78       Endothelial_cells
GCTTCACAGCGTTGTT-1-78             Hepatocytes
TCTCTGGCAGTCGCAC-1-78                 Neurons
CAACAACCAGAGGCTA-1-78                 Neurons
CATTGTTGTCGTACAT-1-78       Endothelial_cells
Name: singler_annotation, Length: 482823, dtype: string
cell type annotation :  TTCTTCCGTTCAACGT-1-0                Astrocyte
CATCCACCATCTAACG-1-0      Smooth_muscle_cells
ACCCAAACAGCTAACT-1-0                  Neurons
AAGGAATCAACTGGTT-1-0     Neuroepithelial_cell
TACCCGTAGCGTGCTC-1-0                Astrocyte
                                 ...         
CGTCCATAGAATTTGG-1-78       Endothelial_cells
GCTTCACAGCGTTGTT-1-78             Hepatocytes
TCTCTGGCAGTCGCAC-1-78                 Neurons
CAACAACCAGAGGCTA-1-78                 Neurons
CATTGTTGTCGTACAT-1-78       Endothelial_cells
Name: singler_annotation, Length: 482823, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Astrocyte', 'Smooth_muscle_cells', 'Neurons', 'Neuroepithelial_cell', 'Endothelial_cells', 'Osteoblasts', 'Platelets', 'Hepatocytes', 'Embryonic_stem_cells', 'MEP', 'Erythroblast', 'Fibroblasts', 'iPS_cells', 'MSC', 'Macrophage', 'Gametocytes', 'Chondrocytes', 'NK_cell', 'Neutrophils', 'HSC_CD34+', 'Monocyte', 'Tissue_stem_cells', 'DC', 'HSC_-G-CSF', 'T_cells', 'Epithelial_cells', 'Unknown', 'Pre-B_cell_CD34-', 'GMP', 'B_cell', 'Pro-Myelocyte', 'Keratinocytes', 'Myelocyte', 'BM', 'CMP', 'BM & Prog.', 'Pro-B_cell_CD34+']
라벨별 그룹 개수 {2: 9, 1: 12, 0: 13}
cell type :  CACACAACAATCGTCA-1-7       Endothelial_cells
TGCGATATCGTAGTCA-1-7                 Neurons
ATTCACTAGTTAGAAC-1-7                 Neurons
CGAAGTTGTGGTCAAG-1-7                 Neurons
AAACCCAGTGAACCGA-1-7     Smooth_muscle_cells
                                ...         
TTATTGCGTCGGTGTC-1-79      Endothelial_cells
GTCACGGGTTGTATGC-1-79      Endothelial_cells
GTCATGATCTTTCGAT-1-79      Endothelial_cells
GCGATCGTCAGAGTGG-1-79              Platelets
GCCCGAACAGAGAAAG-1-79      Endothelial_cells
Name: singler_annotation, Length: 109866, dtype: string
cell type annotation :  CACACAACAATCGTCA-1-7       Endothelial_cells
TGCGATATCGTAGTCA-1-7                 Neurons
ATTCACTAGTTAGAAC-1-7                 Neurons
CGAAGTTGTGGTCAAG-1-7                 Neurons
AAACCCAGTGAACCGA-1-7     Smooth_muscle_cells
                                ...         
TTATTGCGTCGGTGTC-1-79      Endothelial_cells
GTCACGGGTTGTATGC-1-79      Endothelial_cells
GTCATGATCTTTCGAT-1-79      Endothelial_cells
GCGATCGTCAGAGTGG-1-79              Platelets
GCCCGAACAGAGAAAG-1-79      Endothelial_cells
Name: singler_annotation, Length: 109866, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Endothelial_cells', 'Neurons', 'Smooth_muscle_cells', 'iPS_cells', 'Astrocyte', 'Neuroepithelial_cell', 'Fibroblasts', 'Platelets', 'Osteoblasts', 'Erythroblast', 'Hepatocytes', 'Gametocytes', 'Chondrocytes', 'Embryonic_stem_cells', 'MSC', 'HSC_CD34+', 'Tissue_stem_cells', 'NK_cell', 'Keratinocytes', 'Neutrophils', 'Epithelial_cells', 'Myelocyte', 'Macrophage', 'Monocyte', 'Unknown', 'T_cells', 'HSC_-G-CSF', 'B_cell', 'DC', 'Pro-Myelocyte', 'GMP', 'BM', 'CMP', 'MEP', 'BM & Prog.', 'Pro-B_cell_CD34+', 'Pre-B_cell_CD34-']
라벨별 그룹 개수 {2: 2, 0: 3, 1: 3}
🔍 Split #4
  → train_p_index 환자 수 (환자 단위로 묶인 index list): 34
  → test_p_index 환자 수  (환자 단위로 묶인 index list): 8
  → train 환자 ID: ['P1290', 'P1300', 'P1304', 'P1358', 'P1371', 'P1422', 'P1425', 'P1430', 'P1437', 'P1447', 'P1462', 'P1479', 'P1504', 'P1508', 'P1510', 'P1516', 'P1539', 'P1540', 'P1547', 'P1558', 'P1582', 'P1600', 'P1603', 'P1606', 'P1610', 'P1622', 'P1630', 'P1631', 'P1678', 'P1702', 'P1718', 'P1722', 'P1726', 'P1735']
  → test  환자 ID: ['P1472', 'P1515', 'P1549', 'P1561', 'P1602', 'P1617', 'P1685', 'P1707']
  → train 환자 ID 및 라벨:
    ID: P1290, Label: 2
    ID: P1300, Label: 2
    ID: P1304, Label: 2
    ID: P1358, Label: 2
    ID: P1371, Label: 2
    ID: P1422, Label: 1
    ID: P1425, Label: 1
    ID: P1430, Label: 2
    ID: P1437, Label: 2
    ID: P1447, Label: 1
    ID: P1462, Label: 1
    ID: P1479, Label: 1
    ID: P1504, Label: 2
    ID: P1508, Label: 1
    ID: P1510, Label: 1
    ID: P1516, Label: 0
    ID: P1539, Label: 0
    ID: P1540, Label: 0
    ID: P1547, Label: 0
    ID: P1558, Label: 0
    ID: P1582, Label: 0
    ID: P1600, Label: 0
    ID: P1603, Label: 0
    ID: P1606, Label: 2
    ID: P1610, Label: 0
    ID: P1622, Label: 0
    ID: P1630, Label: 1
    ID: P1631, Label: 1
    ID: P1678, Label: 0
    ID: P1702, Label: 0
    ID: P1718, Label: 0
    ID: P1722, Label: 1
    ID: P1726, Label: 1
    ID: P1735, Label: 1
  → test 환자 ID 및 라벨:
    ID: P1472, Label: 2
    ID: P1515, Label: 0
    ID: P1549, Label: 0
    ID: P1561, Label: 0
    ID: P1602, Label: 1
    ID: P1617, Label: 2
    ID: P1685, Label: 1
    ID: P1707, Label: 1
전체 데이터 index 길이 42
label_stat (train 환자 라벨 목록) 갯수 34
train_data에서 환자 단위로, train과 validation 나누기
기존 train_p_index 34
기존 (train) label_stat 34
train-vali 분할 후! 
train y 의 classes : {0, 1, 2} valid y 의 classes : {0, 1, 2} label_stat 의 classes : {0, 1, 2}
train_p_index_ 22
valid_p_index 12
test_p_index 8
→ train 환자 ID 및 라벨:
   총 개수: 22
   환자ID=P1722, Label=1, 셀개수=21432
   환자ID=P1510, Label=1, 셀개수=10744
   환자ID=P1304, Label=2, 셀개수=19123
   환자ID=P1437, Label=2, 셀개수=21695
   환자ID=P1606, Label=2, 셀개수=8523
   환자ID=P1631, Label=1, 셀개수=13686
   환자ID=P1371, Label=2, 셀개수=16233
   환자ID=P1735, Label=1, 셀개수=12009
   환자ID=P1718, Label=0, 셀개수=9278
   환자ID=P1539, Label=0, 셀개수=11076
   환자ID=P1678, Label=0, 셀개수=10085
   환자ID=P1504, Label=2, 셀개수=8133
   환자ID=P1422, Label=1, 셀개수=23315
   환자ID=P1630, Label=1, 셀개수=17633
   환자ID=P1622, Label=0, 셀개수=7210
   환자ID=P1508, Label=1, 셀개수=20536
   환자ID=P1603, Label=0, 셀개수=10638
   환자ID=P1479, Label=1, 셀개수=19124
   환자ID=P1462, Label=1, 셀개수=21715
   환자ID=P1430, Label=2, 셀개수=11131
   환자ID=P1582, Label=0, 셀개수=18855
   환자ID=P1516, Label=0, 셀개수=9361
→ valid 환자 ID 및 라벨:
   총 개수: 12
   환자ID=P1300, Label=2, 셀개수=17318
   환자ID=P1425, Label=1, 셀개수=15378
   환자ID=P1540, Label=0, 셀개수=11638
   환자ID=P1447, Label=1, 셀개수=11151
   환자ID=P1290, Label=2, 셀개수=8357
   환자ID=P1558, Label=0, 셀개수=10469
   환자ID=P1726, Label=1, 셀개수=12389
   환자ID=P1547, Label=0, 셀개수=8253
   환자ID=P1702, Label=0, 셀개수=13550
   환자ID=P1358, Label=2, 셀개수=23984
   환자ID=P1610, Label=0, 셀개수=13919
   환자ID=P1600, Label=0, 셀개수=14882
→ test 환자 ID 및 라벨:
   총 개수: 8
   환자ID=P1472, Label=2, 셀개수=19513
   환자ID=P1515, Label=0, 셀개수=14502
   환자ID=P1549, Label=0, 셀개수=11709
   환자ID=P1561, Label=0, 셀개수=10016
   환자ID=P1602, Label=1, 셀개수=16580
   환자ID=P1617, Label=2, 셀개수=17986
   환자ID=P1685, Label=1, 셀개수=10043
   환자ID=P1707, Label=1, 셀개수=9517
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Astrocyte', 'Smooth_muscle_cells', 'Neurons', 'Neuroepithelial_cell', 'Astrocyte', 'Endothelial_cells', 'Osteoblasts', 'Platelets', 'Neurons', 'Hepatocytes']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
전체 데이터 길이 592689
전체 cell type 길이 0                    Astrocyte
1          Smooth_muscle_cells
2                      Neurons
3         Neuroepithelial_cell
4                    Astrocyte
                  ...         
592684       Endothelial_cells
592685       Endothelial_cells
592686       Endothelial_cells
592687               Platelets
592688       Endothelial_cells
Length: 592689, dtype: string
cell type의 NaN 개수 체크 0
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:15,  6.52it/s]  2%|▏         | 2/100 [00:00<00:13,  7.36it/s]  3%|▎         | 3/100 [00:00<00:12,  7.75it/s]  4%|▍         | 4/100 [00:00<00:12,  7.92it/s]  5%|▌         | 5/100 [00:00<00:11,  7.97it/s]  6%|▌         | 6/100 [00:00<00:11,  8.03it/s]  7%|▋         | 7/100 [00:00<00:11,  8.06it/s]  8%|▊         | 8/100 [00:01<00:11,  8.04it/s]  9%|▉         | 9/100 [00:01<00:11,  7.96it/s] 10%|█         | 10/100 [00:01<00:11,  8.07it/s] 11%|█         | 11/100 [00:01<00:11,  8.02it/s] 12%|█▏        | 12/100 [00:01<00:11,  7.92it/s] 13%|█▎        | 13/100 [00:01<00:11,  7.85it/s] 14%|█▍        | 14/100 [00:01<00:11,  7.82it/s] 15%|█▌        | 15/100 [00:01<00:10,  7.98it/s] 16%|█▌        | 16/100 [00:02<00:10,  7.93it/s] 17%|█▋        | 17/100 [00:02<00:10,  7.90it/s] 18%|█▊        | 18/100 [00:02<00:10,  7.96it/s] 19%|█▉        | 19/100 [00:02<00:10,  7.93it/s] 20%|██        | 20/100 [00:02<00:09,  8.04it/s] 21%|██        | 21/100 [00:02<00:09,  7.94it/s] 22%|██▏       | 22/100 [00:02<00:09,  7.86it/s] 23%|██▎       | 23/100 [00:02<00:09,  7.94it/s] 24%|██▍       | 24/100 [00:03<00:09,  7.94it/s] 25%|██▌       | 25/100 [00:03<00:09,  7.90it/s] 26%|██▌       | 26/100 [00:03<00:09,  7.91it/s] 27%|██▋       | 27/100 [00:03<00:09,  7.83it/s] 28%|██▊       | 28/100 [00:03<00:09,  7.92it/s] 29%|██▉       | 29/100 [00:03<00:08,  7.90it/s] 30%|███       | 30/100 [00:03<00:08,  7.85it/s] 31%|███       | 31/100 [00:03<00:08,  7.80it/s] 32%|███▏      | 32/100 [00:04<00:08,  7.79it/s] 33%|███▎      | 33/100 [00:04<00:08,  7.74it/s] 34%|███▍      | 34/100 [00:04<00:08,  7.74it/s] 35%|███▌      | 35/100 [00:04<00:08,  7.71it/s] 36%|███▌      | 36/100 [00:04<00:08,  7.73it/s] 37%|███▋      | 37/100 [00:04<00:08,  7.72it/s] 38%|███▊      | 38/100 [00:04<00:08,  7.71it/s] 39%|███▉      | 39/100 [00:04<00:07,  7.69it/s] 40%|████      | 40/100 [00:05<00:07,  7.55it/s] 41%|████      | 41/100 [00:05<00:07,  7.57it/s] 42%|████▏     | 42/100 [00:05<00:07,  7.64it/s] 43%|████▎     | 43/100 [00:05<00:07,  7.65it/s] 44%|████▍     | 44/100 [00:05<00:07,  7.61it/s] 45%|████▌     | 45/100 [00:05<00:07,  7.66it/s] 46%|████▌     | 46/100 [00:05<00:07,  7.64it/s] 47%|████▋     | 47/100 [00:06<00:07,  7.56it/s] 48%|████▊     | 48/100 [00:06<00:06,  7.68it/s] 49%|████▉     | 49/100 [00:06<00:06,  7.66it/s] 50%|█████     | 50/100 [00:06<00:06,  7.73it/s] 51%|█████     | 51/100 [00:06<00:06,  7.73it/s] 52%|█████▏    | 52/100 [00:06<00:06,  7.80it/s] 53%|█████▎    | 53/100 [00:06<00:06,  7.83it/s] 54%|█████▍    | 54/100 [00:06<00:05,  7.79it/s] 55%|█████▌    | 55/100 [00:07<00:05,  7.66it/s] 56%|█████▌    | 56/100 [00:07<00:05,  7.61it/s] 57%|█████▋    | 57/100 [00:07<00:05,  7.51it/s] 58%|█████▊    | 58/100 [00:07<00:05,  7.47it/s] 59%|█████▉    | 59/100 [00:07<00:05,  7.46it/s] 60%|██████    | 60/100 [00:07<00:05,  7.47it/s] 61%|██████    | 61/100 [00:07<00:05,  7.56it/s] 62%|██████▏   | 62/100 [00:07<00:05,  7.50it/s] 63%|██████▎   | 63/100 [00:08<00:04,  7.45it/s] 64%|██████▍   | 64/100 [00:08<00:04,  7.38it/s] 65%|██████▌   | 65/100 [00:08<00:04,  7.36it/s] 66%|██████▌   | 66/100 [00:08<00:04,  7.29it/s] 67%|██████▋   | 67/100 [00:08<00:04,  7.25it/s] 68%|██████▊   | 68/100 [00:08<00:04,  7.10it/s] 69%|██████▉   | 69/100 [00:08<00:04,  7.11it/s] 70%|███████   | 70/100 [00:09<00:04,  7.10it/s] 71%|███████   | 71/100 [00:09<00:04,  7.18it/s] 72%|███████▏  | 72/100 [00:09<00:03,  7.19it/s] 73%|███████▎  | 73/100 [00:09<00:03,  7.19it/s] 74%|███████▍  | 74/100 [00:09<00:03,  7.11it/s] 75%|███████▌  | 75/100 [00:09<00:03,  7.16it/s] 76%|███████▌  | 76/100 [00:09<00:03,  7.08it/s] 77%|███████▋  | 77/100 [00:10<00:03,  7.04it/s] 78%|███████▊  | 78/100 [00:10<00:03,  7.12it/s] 79%|███████▉  | 79/100 [00:10<00:02,  7.09it/s] 80%|████████  | 80/100 [00:10<00:02,  7.08it/s] 81%|████████  | 81/100 [00:10<00:02,  7.18it/s] 82%|████████▏ | 82/100 [00:10<00:02,  7.21it/s] 83%|████████▎ | 83/100 [00:10<00:02,  7.19it/s] 84%|████████▍ | 84/100 [00:11<00:02,  7.13it/s] 85%|████████▌ | 85/100 [00:11<00:02,  7.12it/s] 86%|████████▌ | 86/100 [00:11<00:01,  7.05it/s] 87%|████████▋ | 87/100 [00:11<00:01,  7.04it/s] 88%|████████▊ | 88/100 [00:11<00:01,  6.91it/s] 89%|████████▉ | 89/100 [00:11<00:01,  6.96it/s] 90%|█████████ | 90/100 [00:11<00:01,  6.97it/s] 91%|█████████ | 91/100 [00:12<00:01,  6.97it/s] 92%|█████████▏| 92/100 [00:12<00:01,  6.97it/s] 93%|█████████▎| 93/100 [00:12<00:01,  6.94it/s] 94%|█████████▍| 94/100 [00:12<00:00,  7.04it/s] 95%|█████████▌| 95/100 [00:12<00:00,  7.08it/s] 96%|█████████▌| 96/100 [00:12<00:00,  6.99it/s] 97%|█████████▋| 97/100 [00:12<00:00,  7.02it/s] 98%|█████████▊| 98/100 [00:13<00:00,  6.95it/s] 99%|█████████▉| 99/100 [00:13<00:00,  6.91it/s]100%|██████████| 100/100 [00:13<00:00,  6.92it/s]100%|██████████| 100/100 [00:13<00:00,  7.48it/s]
[I 2025-08-29 12:38:45,217] A new study created in memory with name: no-name-64d868e6-d494-49d9-ae76-a29980d665ad
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 19.85 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.880387, Valid_loss 0.864891
Epoch 2, Train Loss 0.685515, Valid_loss 0.649732
Epoch 3, Train Loss 0.507591, Valid_loss 0.643376
Epoch 4, Train Loss 0.547853, Valid_loss 0.471717
Epoch 5, Train Loss 0.488827, Valid_loss 0.578461
Epoch 6, Train Loss 0.458007, Valid_loss 0.514718
Epoch 7, Train Loss 0.459470, Valid_loss 0.517972
Epoch 8, Train Loss 0.437370, Valid_loss 0.476980
Epoch 9, Train Loss 0.479719, Valid_loss 0.652475
Epoch 10, Train Loss 0.426326, Valid_loss 0.542122
Epoch 11, Train Loss 0.398570, Valid_loss 0.539840
Epoch 12, Train Loss 0.378841, Valid_loss 0.729062
Epoch 13, Train Loss 0.341127, Valid_loss 0.543193
Epoch 14, Train Loss 0.354086, Valid_loss 0.424205
Epoch 15, Train Loss 0.331131, Valid_loss 0.511847
Epoch 16, Train Loss 0.369717, Valid_loss 0.603031
Epoch 17, Train Loss 0.347462, Valid_loss 0.572411
Epoch 18, Train Loss 0.318028, Valid_loss 0.461072
Epoch 19, Train Loss 0.294581, Valid_loss 0.420588
Epoch 20, Train Loss 0.336552, Valid_loss 0.817367
Epoch 21, Train Loss 0.281780, Valid_loss 0.440810
Epoch 22, Train Loss 0.263040, Valid_loss 0.582008
Epoch 23, Train Loss 0.301589, Valid_loss 0.494755
Epoch 24, Train Loss 0.264997, Valid_loss 0.572426
Epoch 25, Train Loss 0.281572, Valid_loss 0.330515
Epoch 26, Train Loss 0.323548, Valid_loss 0.375779
Epoch 27, Train Loss 0.256732, Valid_loss 0.467237
Epoch 28, Train Loss 0.267782, Valid_loss 0.808633
Epoch 29, Train Loss 0.282967, Valid_loss 0.406909
Epoch 30, Train Loss 0.292888, Valid_loss 0.295488
Epoch 31, Train Loss 0.254845, Valid_loss 0.302890
Epoch 32, Train Loss 0.256731, Valid_loss 0.507993
Epoch 33, Train Loss 0.262249, Valid_loss 0.387244
Epoch 34, Train Loss 0.255260, Valid_loss 0.513074
Epoch 35, Train Loss 0.229179, Valid_loss 0.354233
Epoch 36, Train Loss 0.273955, Valid_loss 0.584122
Epoch 37, Train Loss 0.215911, Valid_loss 0.364973
Epoch 38, Train Loss 0.246614, Valid_loss 0.405933
Epoch 39, Train Loss 0.205959, Valid_loss 0.607054
Epoch 40, Train Loss 0.240245, Valid_loss 0.390550
Epoch 41, Train Loss 0.262003, Valid_loss 0.506152
Epoch 42, Train Loss 0.199552, Valid_loss 0.410533
Epoch 43, Train Loss 0.267973, Valid_loss 0.547278
Epoch 44, Train Loss 0.249010, Valid_loss 0.334515
Epoch 45, Train Loss 0.210966, Valid_loss 0.390184
Epoch 46, Train Loss 0.227159, Valid_loss 0.376960
Epoch 47, Train Loss 0.211440, Valid_loss 0.452891
Epoch 48, Train Loss 0.208484, Valid_loss 0.719633
Epoch 49, Train Loss 0.214079, Valid_loss 0.465017
Epoch 50, Train Loss 0.174379, Valid_loss 0.435809
Epoch 51, Train Loss 0.160077, Valid_loss 0.433008
Epoch 52, Train Loss 0.173871, Valid_loss 0.484696
Epoch 53, Train Loss 0.175926, Valid_loss 0.451942
Epoch 54, Train Loss 0.153385, Valid_loss 0.437412
Epoch 55, Train Loss 0.157423, Valid_loss 0.402754
Epoch 56, Train Loss 0.155144, Valid_loss 0.468206
Epoch 57, Train Loss 0.153152, Valid_loss 0.473256
[I 2025-08-29 12:59:14,960] Trial 0 finished with value: 0.2954879261863728 and parameters: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 1, 'dropout': 0.0, 'weight_decay': 0.01, 'emb_dim': 64, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.2954879261863728.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 18.01 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 1.098751, Valid_loss 1.170320
Epoch 2, Train Loss 0.998282, Valid_loss 1.183968
Epoch 3, Train Loss 0.960920, Valid_loss 1.254234
Epoch 4, Train Loss 0.958049, Valid_loss 1.414763
Epoch 5, Train Loss 0.949766, Valid_loss 1.354982
Epoch 6, Train Loss 0.971922, Valid_loss 1.213733
Epoch 7, Train Loss 0.951533, Valid_loss 1.198749
Epoch 8, Train Loss 0.936014, Valid_loss 1.203675
Epoch 9, Train Loss 0.912128, Valid_loss 1.279396
Epoch 10, Train Loss 0.909869, Valid_loss 1.320561
Epoch 11, Train Loss 0.946168, Valid_loss 1.223798
Epoch 12, Train Loss 0.923388, Valid_loss 1.237902
Epoch 13, Train Loss 0.926791, Valid_loss 1.235107
Epoch 14, Train Loss 0.923281, Valid_loss 1.232828
Epoch 15, Train Loss 0.922959, Valid_loss 1.216035
Epoch 16, Train Loss 0.923119, Valid_loss 1.233580
Epoch 17, Train Loss 0.923745, Valid_loss 1.228467
Epoch 18, Train Loss 0.921358, Valid_loss 1.240239
Epoch 19, Train Loss 0.924693, Valid_loss 1.221096
Epoch 20, Train Loss 0.924211, Valid_loss 1.239048
Epoch 21, Train Loss 0.923005, Valid_loss 1.230476
Epoch 22, Train Loss 0.927353, Valid_loss 1.249856
Epoch 23, Train Loss 0.923485, Valid_loss 1.241269
Epoch 24, Train Loss 0.922328, Valid_loss 1.244959
Epoch 25, Train Loss 0.921875, Valid_loss 1.204013
Epoch 26, Train Loss 0.944432, Valid_loss 1.233088
Epoch 27, Train Loss 0.923178, Valid_loss 1.232475
Epoch 28, Train Loss 0.923797, Valid_loss 1.235601
Epoch 29, Train Loss 0.923370, Valid_loss 1.232261
Epoch 30, Train Loss 0.938993, Valid_loss 1.381631
Epoch 31, Train Loss 0.923615, Valid_loss 1.240460
Epoch 32, Train Loss 0.924060, Valid_loss 1.245796
Epoch 33, Train Loss 0.922012, Valid_loss 1.229042
Epoch 34, Train Loss 0.921782, Valid_loss 1.228242
Epoch 35, Train Loss 0.923275, Valid_loss 1.240611
Epoch 36, Train Loss 0.923629, Valid_loss 1.233953
Epoch 37, Train Loss 0.921555, Valid_loss 1.240107
Epoch 38, Train Loss 0.925801, Valid_loss 1.214065
Epoch 39, Train Loss 0.923735, Valid_loss 1.228663
Epoch 40, Train Loss 0.921817, Valid_loss 1.229665
Epoch 41, Train Loss 0.922391, Valid_loss 1.232619
Epoch 42, Train Loss 0.922947, Valid_loss 1.233774
Epoch 43, Train Loss 0.924037, Valid_loss 1.227845
Epoch 44, Train Loss 0.922753, Valid_loss 1.239490
Epoch 45, Train Loss 0.921378, Valid_loss 1.237131
Epoch 46, Train Loss 0.922054, Valid_loss 1.241568
Epoch 47, Train Loss 0.921252, Valid_loss 1.235069
Epoch 48, Train Loss 0.922037, Valid_loss 1.226390
Epoch 49, Train Loss 0.924774, Valid_loss 1.228883
Epoch 50, Train Loss 0.922281, Valid_loss 1.234283
Epoch 51, Train Loss 0.919668, Valid_loss 1.237167
Epoch 52, Train Loss 0.918835, Valid_loss 1.238823
[I 2025-08-29 13:18:59,569] Trial 1 finished with value: 1.1703200091918309 and parameters: {'learning_rate': 0.01, 'epochs': 100, 'heads': 1, 'dropout': 0.7, 'weight_decay': 0.01, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.2954879261863728.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 16.69 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.966232, Valid_loss 1.237165
Epoch 2, Train Loss 0.938252, Valid_loss 1.130748
Epoch 3, Train Loss 0.932954, Valid_loss 1.140008
Epoch 4, Train Loss 0.937641, Valid_loss 1.116870
Epoch 5, Train Loss 0.933403, Valid_loss 1.268419
Epoch 6, Train Loss 0.945115, Valid_loss 1.179593
Epoch 7, Train Loss 0.933638, Valid_loss 1.139415
Epoch 8, Train Loss 0.934172, Valid_loss 1.194184
Epoch 9, Train Loss 0.929102, Valid_loss 1.152423
Epoch 10, Train Loss 0.937274, Valid_loss 1.263209
Epoch 11, Train Loss 0.931957, Valid_loss 1.229972
Epoch 12, Train Loss 0.934893, Valid_loss 1.211887
Epoch 13, Train Loss 0.933165, Valid_loss 1.190117
Epoch 14, Train Loss 0.936716, Valid_loss 1.120712
Epoch 15, Train Loss 0.933307, Valid_loss 1.234720
Epoch 16, Train Loss 0.926082, Valid_loss 1.271630
Epoch 17, Train Loss 0.930585, Valid_loss 1.237390
Epoch 18, Train Loss 0.925432, Valid_loss 1.188477
Epoch 19, Train Loss 0.927969, Valid_loss 1.257606
Epoch 20, Train Loss 0.928274, Valid_loss 1.226192
Epoch 21, Train Loss 0.936163, Valid_loss 1.236644
Epoch 22, Train Loss 0.930826, Valid_loss 1.178101
Epoch 23, Train Loss 0.928225, Valid_loss 1.220466
Epoch 24, Train Loss 0.927005, Valid_loss 1.250695
Epoch 25, Train Loss 0.930406, Valid_loss 1.234809
Epoch 26, Train Loss 0.931034, Valid_loss 1.202275
Epoch 27, Train Loss 0.933627, Valid_loss 1.199766
Epoch 28, Train Loss 0.925759, Valid_loss 1.238401
Epoch 29, Train Loss 0.929970, Valid_loss 1.280082
Epoch 30, Train Loss 0.935639, Valid_loss 1.230805
Epoch 31, Train Loss 0.927271, Valid_loss 1.232975
Epoch 32, Train Loss 0.931697, Valid_loss 1.199087
Epoch 33, Train Loss 0.929898, Valid_loss 1.254278
Epoch 34, Train Loss 0.929128, Valid_loss 1.280627
Epoch 35, Train Loss 0.928642, Valid_loss 1.285860
Epoch 36, Train Loss 0.933276, Valid_loss 1.254713
Epoch 37, Train Loss 0.929798, Valid_loss 1.222039
Epoch 38, Train Loss 0.933767, Valid_loss 1.225828
Epoch 39, Train Loss 0.927542, Valid_loss 1.190515
Epoch 40, Train Loss 0.929627, Valid_loss 1.200174
Epoch 41, Train Loss 0.926469, Valid_loss 1.242241
Epoch 42, Train Loss 0.924804, Valid_loss 1.227103
Epoch 43, Train Loss 0.930421, Valid_loss 1.221015
Epoch 44, Train Loss 0.923809, Valid_loss 1.269102
Epoch 45, Train Loss 0.935835, Valid_loss 1.224616
Epoch 46, Train Loss 0.933161, Valid_loss 1.217469
Epoch 47, Train Loss 0.934473, Valid_loss 1.226607
Epoch 48, Train Loss 0.927038, Valid_loss 1.208468
Epoch 49, Train Loss 0.926755, Valid_loss 1.257289
Epoch 50, Train Loss 0.926614, Valid_loss 1.247529
Epoch 51, Train Loss 0.926720, Valid_loss 1.258993
Epoch 52, Train Loss 0.922423, Valid_loss 1.236376
Epoch 53, Train Loss 0.921102, Valid_loss 1.249772
Epoch 54, Train Loss 0.922745, Valid_loss 1.242096
Epoch 55, Train Loss 0.921824, Valid_loss 1.239563
Epoch 56, Train Loss 0.922030, Valid_loss 1.236203
Epoch 57, Train Loss 0.925689, Valid_loss 1.228993
Epoch 58, Train Loss 0.923979, Valid_loss 1.242334
Epoch 59, Train Loss 0.922227, Valid_loss 1.228037
Epoch 60, Train Loss 0.921370, Valid_loss 1.240216
Epoch 61, Train Loss 0.924192, Valid_loss 1.244276
[I 2025-08-29 13:40:39,443] Trial 2 finished with value: 1.1168704231580098 and parameters: {'learning_rate': 0.01, 'epochs': 100, 'heads': 1, 'dropout': 0.0, 'weight_decay': 0.01, 'emb_dim': 8, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.2954879261863728.
선택된 trial params: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 1, 'dropout': 0.0, 'weight_decay': 0.01, 'emb_dim': 64, 'augment_num': 100, 'pca': False}
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=8, batch_size=1 -> steps=8
Memory Allocated: 19.85 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.891843, Valid_loss 0.957449
Epoch 2, Train Loss 0.669496, Valid_loss 0.728052
Epoch 3, Train Loss 0.553398, Valid_loss 0.652286
Epoch 4, Train Loss 0.537806, Valid_loss 0.631354
Epoch 5, Train Loss 0.484655, Valid_loss 0.728233
Epoch 6, Train Loss 0.469579, Valid_loss 0.465678
Epoch 7, Train Loss 0.396336, Valid_loss 0.501211
Epoch 8, Train Loss 0.432820, Valid_loss 0.561974
Epoch 9, Train Loss 0.382298, Valid_loss 0.509961
Epoch 10, Train Loss 0.375354, Valid_loss 0.878254
Epoch 11, Train Loss 0.370584, Valid_loss 0.670425
Epoch 12, Train Loss 0.379453, Valid_loss 0.964399
Epoch 13, Train Loss 0.363574, Valid_loss 0.583982
Epoch 14, Train Loss 0.348614, Valid_loss 0.524574
Epoch 15, Train Loss 0.398774, Valid_loss 0.887839
Epoch 16, Train Loss 0.337041, Valid_loss 0.761564
Epoch 17, Train Loss 0.331069, Valid_loss 0.616306
Epoch 18, Train Loss 0.324427, Valid_loss 0.514227
Epoch 19, Train Loss 0.313018, Valid_loss 0.462499
Epoch 20, Train Loss 0.305348, Valid_loss 0.563850
Epoch 21, Train Loss 0.285982, Valid_loss 0.447971
Epoch 22, Train Loss 0.270814, Valid_loss 0.519800
Epoch 23, Train Loss 0.319597, Valid_loss 0.381875
Epoch 24, Train Loss 0.295658, Valid_loss 0.515534
Epoch 25, Train Loss 0.256327, Valid_loss 0.388639
Epoch 26, Train Loss 0.294276, Valid_loss 0.821777
Epoch 27, Train Loss 0.260101, Valid_loss 0.386502
Epoch 28, Train Loss 0.309645, Valid_loss 0.585273
Epoch 29, Train Loss 0.288352, Valid_loss 0.491248
Epoch 30, Train Loss 0.250657, Valid_loss 0.565468
Epoch 31, Train Loss 0.282694, Valid_loss 0.423565
Epoch 32, Train Loss 0.271408, Valid_loss 0.559462
Epoch 33, Train Loss 0.308005, Valid_loss 0.494933
Epoch 34, Train Loss 0.232048, Valid_loss 0.506736
Epoch 35, Train Loss 0.266273, Valid_loss 0.514514
Epoch 36, Train Loss 0.219608, Valid_loss 0.536187
Epoch 37, Train Loss 0.246030, Valid_loss 0.681096
Epoch 38, Train Loss 0.267498, Valid_loss 0.568264
Epoch 39, Train Loss 0.239576, Valid_loss 0.438154
Epoch 40, Train Loss 0.248512, Valid_loss 0.512181
Epoch 41, Train Loss 0.278453, Valid_loss 0.592794
Epoch 42, Train Loss 0.235778, Valid_loss 0.589010
Epoch 43, Train Loss 0.229229, Valid_loss 0.622424
Epoch 44, Train Loss 0.206286, Valid_loss 0.431819
Epoch 45, Train Loss 0.198140, Valid_loss 0.615424
Epoch 46, Train Loss 0.235838, Valid_loss 0.545978
Epoch 47, Train Loss 0.209956, Valid_loss 0.626680
Epoch 48, Train Loss 0.224052, Valid_loss 0.436249
Epoch 49, Train Loss 0.262339, Valid_loss 0.482027
Epoch 50, Train Loss 0.218953, Valid_loss 0.577597
Epoch 51, Train Loss 0.178971, Valid_loss 0.473029
Epoch 52, Train Loss 0.180526, Valid_loss 0.475905
Epoch 53, Train Loss 0.180573, Valid_loss 0.516865
환자ID=P1472 -- true: [[2]] -- pred: tensor([[-1.7806,  0.3582,  1.0964]], device='cuda:0')
환자ID=P1515 -- true: [[0]] -- pred: tensor([[ 2.8863, -1.0693, -1.9475]], device='cuda:0')
환자ID=P1549 -- true: [[0]] -- pred: tensor([[ 2.8391, -1.2017, -1.7934]], device='cuda:0')
환자ID=P1561 -- true: [[0]] -- pred: tensor([[ 2.8784, -1.1365, -1.8853]], device='cuda:0')
환자ID=P1602 -- true: [[1]] -- pred: tensor([[ 1.1365,  0.4768, -1.6184]], device='cuda:0')
환자ID=P1617 -- true: [[2]] -- pred: tensor([[-1.7995,  0.3557,  1.1212]], device='cuda:0')
환자ID=P1685 -- true: [[1]] -- pred: tensor([[-0.0185,  2.0696, -1.8338]], device='cuda:0')
환자ID=P1707 -- true: [[1]] -- pred: tensor([[-1.1496,  1.9183, -0.8306]], device='cuda:0')
Best performance: Epoch 23, Loss 0.319597, Test ACC 0.875000, Test AUC 1.000000, Test Recall 0.888889, Test Precision 0.916667
Confusion Matrix:
 [[3 0 0]
 [1 2 0]
 [0 0 2]]
✅ Total valid splits used: 4
🔁 Repeat 1, Fold 4
cell type :  TTCTTCCGTTCAACGT-1-0                Astrocyte
CATCCACCATCTAACG-1-0      Smooth_muscle_cells
ACCCAAACAGCTAACT-1-0                  Neurons
AAGGAATCAACTGGTT-1-0     Neuroepithelial_cell
TACCCGTAGCGTGCTC-1-0                Astrocyte
                                 ...         
TTATTGCGTCGGTGTC-1-79       Endothelial_cells
GTCACGGGTTGTATGC-1-79       Endothelial_cells
GTCATGATCTTTCGAT-1-79       Endothelial_cells
GCGATCGTCAGAGTGG-1-79               Platelets
GCCCGAACAGAGAAAG-1-79       Endothelial_cells
Name: singler_annotation, Length: 477476, dtype: string
cell type annotation :  TTCTTCCGTTCAACGT-1-0                Astrocyte
CATCCACCATCTAACG-1-0      Smooth_muscle_cells
ACCCAAACAGCTAACT-1-0                  Neurons
AAGGAATCAACTGGTT-1-0     Neuroepithelial_cell
TACCCGTAGCGTGCTC-1-0                Astrocyte
                                 ...         
TTATTGCGTCGGTGTC-1-79       Endothelial_cells
GTCACGGGTTGTATGC-1-79       Endothelial_cells
GTCATGATCTTTCGAT-1-79       Endothelial_cells
GCGATCGTCAGAGTGG-1-79               Platelets
GCCCGAACAGAGAAAG-1-79       Endothelial_cells
Name: singler_annotation, Length: 477476, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Astrocyte', 'Smooth_muscle_cells', 'Neurons', 'Neuroepithelial_cell', 'Endothelial_cells', 'Osteoblasts', 'Platelets', 'Hepatocytes', 'Embryonic_stem_cells', 'MEP', 'Erythroblast', 'Fibroblasts', 'iPS_cells', 'MSC', 'Macrophage', 'Gametocytes', 'Chondrocytes', 'NK_cell', 'Neutrophils', 'HSC_CD34+', 'Monocyte', 'Tissue_stem_cells', 'DC', 'HSC_-G-CSF', 'T_cells', 'Epithelial_cells', 'Unknown', 'Pre-B_cell_CD34-', 'GMP', 'B_cell', 'Pro-Myelocyte', 'Keratinocytes', 'Myelocyte', 'BM', 'CMP', 'BM & Prog.', 'Pro-B_cell_CD34+']
라벨별 그룹 개수 {2: 9, 1: 12, 0: 13}
cell type :  CTGCTCAAGGCATCAG-1-3             Osteoblasts
TCATACTAGACTTCCA-1-3     Smooth_muscle_cells
GAGCCTGGTCGAGATG-1-3            Erythroblast
CTTACCGCAGAACTCT-1-3             Osteoblasts
TTGACCCCATCTAACG-1-3     Smooth_muscle_cells
                                ...         
CGTCCATAGAATTTGG-1-78      Endothelial_cells
GCTTCACAGCGTTGTT-1-78            Hepatocytes
TCTCTGGCAGTCGCAC-1-78                Neurons
CAACAACCAGAGGCTA-1-78                Neurons
CATTGTTGTCGTACAT-1-78      Endothelial_cells
Name: singler_annotation, Length: 115213, dtype: string
cell type annotation :  CTGCTCAAGGCATCAG-1-3             Osteoblasts
TCATACTAGACTTCCA-1-3     Smooth_muscle_cells
GAGCCTGGTCGAGATG-1-3            Erythroblast
CTTACCGCAGAACTCT-1-3             Osteoblasts
TTGACCCCATCTAACG-1-3     Smooth_muscle_cells
                                ...         
CGTCCATAGAATTTGG-1-78      Endothelial_cells
GCTTCACAGCGTTGTT-1-78            Hepatocytes
TCTCTGGCAGTCGCAC-1-78                Neurons
CAACAACCAGAGGCTA-1-78                Neurons
CATTGTTGTCGTACAT-1-78      Endothelial_cells
Name: singler_annotation, Length: 115213, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Osteoblasts', 'Smooth_muscle_cells', 'Erythroblast', 'Endothelial_cells', 'Neurons', 'Astrocyte', 'Fibroblasts', 'NK_cell', 'Gametocytes', 'Neuroepithelial_cell', 'Platelets', 'Embryonic_stem_cells', 'iPS_cells', 'Hepatocytes', 'MSC', 'Chondrocytes', 'MEP', 'BM & Prog.', 'Macrophage', 'Monocyte', 'Neutrophils', 'DC', 'HSC_CD34+', 'HSC_-G-CSF', 'Tissue_stem_cells', 'Unknown', 'T_cells', 'Keratinocytes', 'Epithelial_cells', 'B_cell', 'Myelocyte', 'Pro-Myelocyte', 'BM', 'Pre-B_cell_CD34-', 'CMP', 'GMP', 'Pro-B_cell_CD34+']
라벨별 그룹 개수 {2: 2, 1: 3, 0: 3}
🔍 Split #5
  → train_p_index 환자 수 (환자 단위로 묶인 index list): 34
  → test_p_index 환자 수  (환자 단위로 묶인 index list): 8
  → train 환자 ID: ['P1290', 'P1300', 'P1304', 'P1371', 'P1422', 'P1430', 'P1437', 'P1447', 'P1472', 'P1479', 'P1504', 'P1508', 'P1510', 'P1515', 'P1516', 'P1539', 'P1540', 'P1549', 'P1561', 'P1582', 'P1602', 'P1603', 'P1610', 'P1617', 'P1622', 'P1630', 'P1631', 'P1678', 'P1685', 'P1702', 'P1707', 'P1718', 'P1722', 'P1726']
  → test  환자 ID: ['P1358', 'P1425', 'P1462', 'P1547', 'P1558', 'P1600', 'P1606', 'P1735']
  → train 환자 ID 및 라벨:
    ID: P1290, Label: 2
    ID: P1300, Label: 2
    ID: P1304, Label: 2
    ID: P1371, Label: 2
    ID: P1422, Label: 1
    ID: P1430, Label: 2
    ID: P1437, Label: 2
    ID: P1447, Label: 1
    ID: P1472, Label: 2
    ID: P1479, Label: 1
    ID: P1504, Label: 2
    ID: P1508, Label: 1
    ID: P1510, Label: 1
    ID: P1515, Label: 0
    ID: P1516, Label: 0
    ID: P1539, Label: 0
    ID: P1540, Label: 0
    ID: P1549, Label: 0
    ID: P1561, Label: 0
    ID: P1582, Label: 0
    ID: P1602, Label: 1
    ID: P1603, Label: 0
    ID: P1610, Label: 0
    ID: P1617, Label: 2
    ID: P1622, Label: 0
    ID: P1630, Label: 1
    ID: P1631, Label: 1
    ID: P1678, Label: 0
    ID: P1685, Label: 1
    ID: P1702, Label: 0
    ID: P1707, Label: 1
    ID: P1718, Label: 0
    ID: P1722, Label: 1
    ID: P1726, Label: 1
  → test 환자 ID 및 라벨:
    ID: P1358, Label: 2
    ID: P1425, Label: 1
    ID: P1462, Label: 1
    ID: P1547, Label: 0
    ID: P1558, Label: 0
    ID: P1600, Label: 0
    ID: P1606, Label: 2
    ID: P1735, Label: 1
전체 데이터 index 길이 42
label_stat (train 환자 라벨 목록) 갯수 34
train_data에서 환자 단위로, train과 validation 나누기
기존 train_p_index 34
기존 (train) label_stat 34
train-vali 분할 후! 
train y 의 classes : {0, 1, 2} valid y 의 classes : {0, 1, 2} label_stat 의 classes : {0, 1, 2}
train_p_index_ 22
valid_p_index 12
test_p_index 8
→ train 환자 ID 및 라벨:
   총 개수: 22
   환자ID=P1718, Label=0, 셀개수=9278
   환자ID=P1516, Label=0, 셀개수=9361
   환자ID=P1304, Label=2, 셀개수=19123
   환자ID=P1472, Label=2, 셀개수=19513
   환자ID=P1617, Label=2, 셀개수=17986
   환자ID=P1678, Label=0, 셀개수=10085
   환자ID=P1422, Label=1, 셀개수=23315
   환자ID=P1726, Label=1, 셀개수=12389
   환자ID=P1707, Label=1, 셀개수=9517
   환자ID=P1540, Label=0, 셀개수=11638
   환자ID=P1685, Label=1, 셀개수=10043
   환자ID=P1510, Label=1, 셀개수=10744
   환자ID=P1430, Label=2, 셀개수=11131
   환자ID=P1631, Label=1, 셀개수=13686
   환자ID=P1630, Label=1, 셀개수=17633
   환자ID=P1515, Label=0, 셀개수=14502
   환자ID=P1610, Label=0, 셀개수=13919
   환자ID=P1508, Label=1, 셀개수=20536
   환자ID=P1504, Label=2, 셀개수=8133
   환자ID=P1447, Label=1, 셀개수=11151
   환자ID=P1602, Label=1, 셀개수=16580
   환자ID=P1539, Label=0, 셀개수=11076
→ valid 환자 ID 및 라벨:
   총 개수: 12
   환자ID=P1300, Label=2, 셀개수=17318
   환자ID=P1437, Label=2, 셀개수=21695
   환자ID=P1549, Label=0, 셀개수=11709
   환자ID=P1479, Label=1, 셀개수=19124
   환자ID=P1290, Label=2, 셀개수=8357
   환자ID=P1582, Label=0, 셀개수=18855
   환자ID=P1722, Label=1, 셀개수=21432
   환자ID=P1561, Label=0, 셀개수=10016
   환자ID=P1702, Label=0, 셀개수=13550
   환자ID=P1371, Label=2, 셀개수=16233
   환자ID=P1622, Label=0, 셀개수=7210
   환자ID=P1603, Label=0, 셀개수=10638
→ test 환자 ID 및 라벨:
   총 개수: 8
   환자ID=P1358, Label=2, 셀개수=23984
   환자ID=P1425, Label=1, 셀개수=15378
   환자ID=P1462, Label=1, 셀개수=21715
   환자ID=P1547, Label=0, 셀개수=8253
   환자ID=P1558, Label=0, 셀개수=10469
   환자ID=P1600, Label=0, 셀개수=14882
   환자ID=P1606, Label=2, 셀개수=8523
   환자ID=P1735, Label=1, 셀개수=12009
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Astrocyte', 'Smooth_muscle_cells', 'Neurons', 'Neuroepithelial_cell', 'Astrocyte', 'Endothelial_cells', 'Osteoblasts', 'Platelets', 'Neurons', 'Hepatocytes']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
전체 데이터 길이 592689
전체 cell type 길이 0                    Astrocyte
1          Smooth_muscle_cells
2                      Neurons
3         Neuroepithelial_cell
4                    Astrocyte
                  ...         
592684       Endothelial_cells
592685             Hepatocytes
592686                 Neurons
592687                 Neurons
592688       Endothelial_cells
Length: 592689, dtype: string
cell type의 NaN 개수 체크 0
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:12,  8.02it/s]  2%|▏         | 2/100 [00:00<00:12,  8.10it/s]  3%|▎         | 3/100 [00:00<00:12,  8.05it/s]  4%|▍         | 4/100 [00:00<00:12,  7.90it/s]  5%|▌         | 5/100 [00:00<00:12,  7.84it/s]  6%|▌         | 6/100 [00:00<00:11,  7.99it/s]  7%|▋         | 7/100 [00:00<00:11,  8.00it/s]  8%|▊         | 8/100 [00:01<00:11,  8.00it/s]  9%|▉         | 9/100 [00:01<00:11,  7.95it/s] 10%|█         | 10/100 [00:01<00:11,  8.00it/s] 11%|█         | 11/100 [00:01<00:11,  7.93it/s] 12%|█▏        | 12/100 [00:01<00:11,  7.94it/s] 13%|█▎        | 13/100 [00:01<00:10,  7.96it/s] 14%|█▍        | 14/100 [00:01<00:10,  7.87it/s] 15%|█▌        | 15/100 [00:01<00:10,  8.00it/s] 16%|█▌        | 16/100 [00:02<00:10,  8.09it/s] 17%|█▋        | 17/100 [00:02<00:10,  8.15it/s] 18%|█▊        | 18/100 [00:02<00:10,  8.13it/s] 19%|█▉        | 19/100 [00:02<00:10,  8.06it/s] 20%|██        | 20/100 [00:02<00:09,  8.10it/s] 21%|██        | 21/100 [00:02<00:09,  8.00it/s] 22%|██▏       | 22/100 [00:02<00:09,  7.97it/s] 23%|██▎       | 23/100 [00:02<00:09,  8.18it/s] 24%|██▍       | 24/100 [00:02<00:09,  8.19it/s] 25%|██▌       | 25/100 [00:03<00:09,  8.08it/s] 26%|██▌       | 26/100 [00:03<00:09,  8.04it/s] 27%|██▋       | 27/100 [00:03<00:09,  8.06it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.06it/s] 29%|██▉       | 29/100 [00:03<00:08,  8.05it/s] 30%|███       | 30/100 [00:03<00:08,  8.03it/s] 31%|███       | 31/100 [00:03<00:08,  7.98it/s] 32%|███▏      | 32/100 [00:03<00:08,  7.96it/s] 33%|███▎      | 33/100 [00:04<00:08,  7.91it/s] 34%|███▍      | 34/100 [00:04<00:08,  7.93it/s] 35%|███▌      | 35/100 [00:04<00:08,  7.87it/s] 36%|███▌      | 36/100 [00:04<00:08,  7.88it/s] 37%|███▋      | 37/100 [00:04<00:07,  7.88it/s] 38%|███▊      | 38/100 [00:04<00:07,  7.89it/s] 39%|███▉      | 39/100 [00:04<00:07,  7.90it/s] 40%|████      | 40/100 [00:05<00:07,  7.83it/s] 41%|████      | 41/100 [00:05<00:07,  7.88it/s] 42%|████▏     | 42/100 [00:05<00:07,  7.85it/s] 43%|████▎     | 43/100 [00:05<00:07,  7.83it/s] 44%|████▍     | 44/100 [00:05<00:07,  7.76it/s] 45%|████▌     | 45/100 [00:05<00:07,  7.80it/s] 46%|████▌     | 46/100 [00:05<00:06,  7.72it/s] 47%|████▋     | 47/100 [00:05<00:06,  7.67it/s] 48%|████▊     | 48/100 [00:06<00:06,  7.61it/s] 49%|████▉     | 49/100 [00:06<00:06,  7.57it/s] 50%|█████     | 50/100 [00:06<00:06,  7.62it/s] 51%|█████     | 51/100 [00:06<00:06,  7.62it/s] 52%|█████▏    | 52/100 [00:06<00:06,  7.65it/s] 53%|█████▎    | 53/100 [00:06<00:06,  7.58it/s] 54%|█████▍    | 54/100 [00:06<00:06,  7.56it/s] 55%|█████▌    | 55/100 [00:06<00:05,  7.53it/s] 56%|█████▌    | 56/100 [00:07<00:05,  7.45it/s] 57%|█████▋    | 57/100 [00:07<00:05,  7.54it/s] 58%|█████▊    | 58/100 [00:07<00:05,  7.46it/s] 59%|█████▉    | 59/100 [00:07<00:05,  7.47it/s] 60%|██████    | 60/100 [00:07<00:05,  7.41it/s] 61%|██████    | 61/100 [00:07<00:05,  7.55it/s] 62%|██████▏   | 62/100 [00:07<00:05,  7.40it/s] 63%|██████▎   | 63/100 [00:08<00:05,  7.32it/s] 64%|██████▍   | 64/100 [00:08<00:04,  7.22it/s] 65%|██████▌   | 65/100 [00:08<00:05,  6.96it/s] 66%|██████▌   | 66/100 [00:08<00:04,  7.04it/s] 67%|██████▋   | 67/100 [00:08<00:04,  7.10it/s] 68%|██████▊   | 68/100 [00:08<00:04,  7.13it/s] 69%|██████▉   | 69/100 [00:08<00:04,  7.19it/s] 70%|███████   | 70/100 [00:09<00:04,  7.19it/s] 71%|███████   | 71/100 [00:09<00:04,  7.23it/s] 72%|███████▏  | 72/100 [00:09<00:03,  7.26it/s] 73%|███████▎  | 73/100 [00:09<00:03,  7.21it/s] 74%|███████▍  | 74/100 [00:09<00:03,  7.20it/s] 75%|███████▌  | 75/100 [00:09<00:03,  7.13it/s] 76%|███████▌  | 76/100 [00:09<00:03,  7.15it/s] 77%|███████▋  | 77/100 [00:10<00:03,  7.07it/s] 78%|███████▊  | 78/100 [00:10<00:03,  7.04it/s] 79%|███████▉  | 79/100 [00:10<00:02,  7.01it/s] 80%|████████  | 80/100 [00:10<00:02,  6.99it/s] 81%|████████  | 81/100 [00:10<00:02,  6.94it/s] 82%|████████▏ | 82/100 [00:10<00:02,  6.98it/s] 83%|████████▎ | 83/100 [00:10<00:02,  6.93it/s] 84%|████████▍ | 84/100 [00:11<00:02,  7.02it/s] 85%|████████▌ | 85/100 [00:11<00:02,  7.10it/s] 86%|████████▌ | 86/100 [00:11<00:01,  7.13it/s] 87%|████████▋ | 87/100 [00:11<00:01,  7.02it/s] 88%|████████▊ | 88/100 [00:11<00:01,  7.08it/s] 89%|████████▉ | 89/100 [00:11<00:01,  7.09it/s] 90%|█████████ | 90/100 [00:11<00:01,  6.98it/s] 91%|█████████ | 91/100 [00:12<00:01,  6.95it/s] 92%|█████████▏| 92/100 [00:12<00:01,  6.95it/s] 93%|█████████▎| 93/100 [00:12<00:01,  6.89it/s] 94%|█████████▍| 94/100 [00:12<00:00,  6.84it/s] 95%|█████████▌| 95/100 [00:12<00:00,  6.84it/s] 96%|█████████▌| 96/100 [00:12<00:00,  6.87it/s] 97%|█████████▋| 97/100 [00:12<00:00,  6.86it/s] 98%|█████████▊| 98/100 [00:13<00:00,  6.86it/s] 99%|█████████▉| 99/100 [00:13<00:00,  6.98it/s]100%|██████████| 100/100 [00:13<00:00,  7.02it/s]100%|██████████| 100/100 [00:13<00:00,  7.50it/s]
[I 2025-08-29 14:00:29,940] A new study created in memory with name: no-name-bb4f7df7-2d94-4d96-b71e-e09abb7be00b
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 18.01 MB
Memory Reserved: 42.00 MB
cuda
CUDA OOM 발생 — 단계적 백오프 시작.
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 16903.99 MB
Memory Reserved: 16924.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 312.97 MB
Memory Reserved: 352.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 16903.99 MB
Memory Reserved: 16924.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 312.55 MB
Memory Reserved: 352.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[I 2025-08-29 14:00:31,294] Trial 0 pruned. Pruned due to OOM after backoff
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 16903.99 MB
Memory Reserved: 16944.00 MB
cuda
Epoch 1, Train Loss 0.980351, Valid_loss 1.259454
Epoch 2, Train Loss 0.956433, Valid_loss 1.104131
Epoch 3, Train Loss 0.889149, Valid_loss 0.937155
Epoch 4, Train Loss 0.770791, Valid_loss 1.011823
Epoch 5, Train Loss 0.684807, Valid_loss 0.939560
Epoch 6, Train Loss 0.587757, Valid_loss 0.784106
Epoch 7, Train Loss 0.650231, Valid_loss 0.693937
Epoch 8, Train Loss 0.593653, Valid_loss 0.650317
Epoch 9, Train Loss 0.538873, Valid_loss 0.684179
Epoch 10, Train Loss 0.596116, Valid_loss 0.676454
Epoch 11, Train Loss 0.532118, Valid_loss 0.856066
Epoch 12, Train Loss 0.503160, Valid_loss 0.629394
Epoch 13, Train Loss 0.559749, Valid_loss 0.601248
Epoch 14, Train Loss 0.552401, Valid_loss 0.551657
Epoch 15, Train Loss 0.512755, Valid_loss 0.626386
Epoch 16, Train Loss 0.525935, Valid_loss 0.513922
Epoch 17, Train Loss 0.487476, Valid_loss 0.570028
Epoch 18, Train Loss 0.490607, Valid_loss 1.066167
Epoch 19, Train Loss 0.457561, Valid_loss 1.046598
Epoch 20, Train Loss 0.503578, Valid_loss 0.604967
Epoch 21, Train Loss 0.481541, Valid_loss 0.718370
Epoch 22, Train Loss 0.457228, Valid_loss 0.730932
Epoch 23, Train Loss 0.442292, Valid_loss 0.791696
Epoch 24, Train Loss 0.376008, Valid_loss 0.705877
Epoch 25, Train Loss 0.458170, Valid_loss 0.619327
Epoch 26, Train Loss 0.446876, Valid_loss 0.654496
Epoch 27, Train Loss 0.430431, Valid_loss 0.735661
Epoch 28, Train Loss 0.377816, Valid_loss 0.782073
Epoch 29, Train Loss 0.475276, Valid_loss 0.584686
Epoch 30, Train Loss 0.338098, Valid_loss 0.652908
Epoch 31, Train Loss 0.375395, Valid_loss 0.874407
Epoch 32, Train Loss 0.408781, Valid_loss 0.818093
Epoch 33, Train Loss 0.318457, Valid_loss 0.731516
Epoch 34, Train Loss 0.330047, Valid_loss 0.534686
Epoch 35, Train Loss 0.300973, Valid_loss 0.739656
Epoch 36, Train Loss 0.310885, Valid_loss 0.707853
Epoch 37, Train Loss 0.289872, Valid_loss 0.639212
Epoch 38, Train Loss 0.325069, Valid_loss 0.771316
Epoch 39, Train Loss 0.338342, Valid_loss 0.992700
Epoch 40, Train Loss 0.290994, Valid_loss 0.765510
Epoch 41, Train Loss 0.270592, Valid_loss 0.928299
Epoch 42, Train Loss 0.336064, Valid_loss 0.717277
Epoch 43, Train Loss 0.309799, Valid_loss 0.541997
Epoch 44, Train Loss 0.282875, Valid_loss 0.925407
Epoch 45, Train Loss 0.281608, Valid_loss 0.714918
Epoch 46, Train Loss 0.262371, Valid_loss 1.059509
Epoch 47, Train Loss 0.317801, Valid_loss 0.792521
Epoch 48, Train Loss 0.301812, Valid_loss 0.735333
Epoch 49, Train Loss 0.301762, Valid_loss 0.926305
Epoch 50, Train Loss 0.285429, Valid_loss 0.837002
Epoch 51, Train Loss 0.255910, Valid_loss 0.822130
Epoch 52, Train Loss 0.266581, Valid_loss 0.880689
Epoch 53, Train Loss 0.237235, Valid_loss 0.807262
Epoch 54, Train Loss 0.223494, Valid_loss 0.813884
Epoch 55, Train Loss 0.209651, Valid_loss 0.915552
[I 2025-08-29 14:31:36,262] Trial 1 finished with value: 0.5139220021665096 and parameters: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 2, 'dropout': 0.5, 'weight_decay': 0.0001, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 1 with value: 0.5139220021665096.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 16.69 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.954408, Valid_loss 1.415771
Epoch 2, Train Loss 0.941184, Valid_loss 1.518221
Epoch 3, Train Loss 0.944360, Valid_loss 1.399239
Epoch 4, Train Loss 0.948844, Valid_loss 1.290601
Epoch 5, Train Loss 0.935843, Valid_loss 1.311124
Epoch 6, Train Loss 0.931781, Valid_loss 1.303773
Epoch 7, Train Loss 0.938998, Valid_loss 1.271492
Epoch 8, Train Loss 0.935095, Valid_loss 1.414806
Epoch 9, Train Loss 0.933341, Valid_loss 1.238281
Epoch 10, Train Loss 0.929693, Valid_loss 1.231458
Epoch 11, Train Loss 0.933038, Valid_loss 1.425809
Epoch 12, Train Loss 0.941278, Valid_loss 1.435907
Epoch 13, Train Loss 0.933164, Valid_loss 1.214245
Epoch 14, Train Loss 0.940011, Valid_loss 1.301191
Epoch 15, Train Loss 0.934296, Valid_loss 1.243112
Epoch 16, Train Loss 0.924574, Valid_loss 1.437909
Epoch 17, Train Loss 0.935868, Valid_loss 1.235144
Epoch 18, Train Loss 0.932436, Valid_loss 1.206374
Epoch 19, Train Loss 0.955332, Valid_loss 1.269682
Epoch 20, Train Loss 0.941635, Valid_loss 1.302171
Epoch 21, Train Loss 0.936308, Valid_loss 1.313187
Epoch 22, Train Loss 0.933776, Valid_loss 1.361664
Epoch 23, Train Loss 0.936369, Valid_loss 1.329238
Epoch 24, Train Loss 0.935419, Valid_loss 1.345699
Epoch 25, Train Loss 0.933388, Valid_loss 1.324473
Epoch 26, Train Loss 0.924070, Valid_loss 1.470015
Epoch 27, Train Loss 0.940125, Valid_loss 1.355106
Epoch 28, Train Loss 0.934978, Valid_loss 1.361974
Epoch 29, Train Loss 0.933732, Valid_loss 1.337183
Epoch 30, Train Loss 0.933423, Valid_loss 1.367869
Epoch 31, Train Loss 0.933748, Valid_loss 1.348487
Epoch 32, Train Loss 0.934945, Valid_loss 1.319316
Epoch 33, Train Loss 0.933266, Valid_loss 1.360393
Epoch 34, Train Loss 0.930064, Valid_loss 1.355589
Epoch 35, Train Loss 0.935004, Valid_loss 1.370761
Epoch 36, Train Loss 0.932563, Valid_loss 1.374449
Epoch 37, Train Loss 0.936141, Valid_loss 1.358025
Epoch 38, Train Loss 0.935348, Valid_loss 1.372736
Epoch 39, Train Loss 0.932365, Valid_loss 1.340983
Epoch 40, Train Loss 0.932405, Valid_loss 1.336440
Epoch 41, Train Loss 0.932865, Valid_loss 1.323200
Epoch 42, Train Loss 0.931316, Valid_loss 1.327468
Epoch 43, Train Loss 0.932835, Valid_loss 1.334066
Epoch 44, Train Loss 0.929033, Valid_loss 1.330214
Epoch 45, Train Loss 0.931533, Valid_loss 1.343291
Epoch 46, Train Loss 0.932775, Valid_loss 1.357858
Epoch 47, Train Loss 0.931652, Valid_loss 1.343166
Epoch 48, Train Loss 0.930566, Valid_loss 1.341337
Epoch 49, Train Loss 0.931590, Valid_loss 1.336000
Epoch 50, Train Loss 0.930159, Valid_loss 1.361644
Epoch 51, Train Loss 0.928189, Valid_loss 1.358688
Epoch 52, Train Loss 0.929058, Valid_loss 1.348820
Epoch 53, Train Loss 0.927981, Valid_loss 1.346324
Epoch 54, Train Loss 0.927807, Valid_loss 1.354338
Epoch 55, Train Loss 0.927843, Valid_loss 1.346997
Epoch 56, Train Loss 0.929868, Valid_loss 1.359195
Epoch 57, Train Loss 0.928193, Valid_loss 1.350628
Epoch 58, Train Loss 0.928194, Valid_loss 1.356892
Epoch 59, Train Loss 0.927145, Valid_loss 1.358836
[I 2025-08-29 15:02:14,742] Trial 2 finished with value: 1.2063741286595662 and parameters: {'learning_rate': 0.01, 'epochs': 100, 'heads': 2, 'dropout': 0.0, 'weight_decay': 0.01, 'emb_dim': 8, 'augment_num': 100, 'pca': False}. Best is trial 1 with value: 0.5139220021665096.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 18.01 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 1.204133, Valid_loss 1.167024
Epoch 2, Train Loss 1.006065, Valid_loss 1.296729
Epoch 3, Train Loss 0.999748, Valid_loss 1.310612
Epoch 4, Train Loss 0.956601, Valid_loss 1.036401
Epoch 5, Train Loss 0.895901, Valid_loss 0.973430
Epoch 6, Train Loss 0.710075, Valid_loss 0.866912
Epoch 7, Train Loss 0.703193, Valid_loss 1.259246
Epoch 8, Train Loss 1.104130, Valid_loss 1.338745
Epoch 9, Train Loss 0.956937, Valid_loss 1.364543
Epoch 10, Train Loss 0.897520, Valid_loss 1.425180
Epoch 11, Train Loss 0.813956, Valid_loss 1.338495
Epoch 12, Train Loss 0.758785, Valid_loss 1.450677
Epoch 13, Train Loss 0.682634, Valid_loss 1.546062
Epoch 14, Train Loss 0.747585, Valid_loss 1.498297
Epoch 15, Train Loss 0.737694, Valid_loss 1.471106
Epoch 16, Train Loss 0.672766, Valid_loss 1.498330
Epoch 17, Train Loss 0.642928, Valid_loss 0.797480
Epoch 18, Train Loss 0.664618, Valid_loss 0.774840
Epoch 19, Train Loss 0.648586, Valid_loss 0.707197
Epoch 20, Train Loss 0.708726, Valid_loss 0.735515
Epoch 21, Train Loss 0.599842, Valid_loss 0.648898
Epoch 22, Train Loss 0.865827, Valid_loss 1.320364
Epoch 23, Train Loss 0.850110, Valid_loss 0.706722
Epoch 24, Train Loss 0.792196, Valid_loss 0.717790
Epoch 25, Train Loss 0.667475, Valid_loss 1.429707
Epoch 26, Train Loss 0.679465, Valid_loss 0.872218
Epoch 27, Train Loss 0.613745, Valid_loss 1.030070
Epoch 28, Train Loss 0.601279, Valid_loss 0.859861
Epoch 29, Train Loss 0.628569, Valid_loss 0.701659
Epoch 30, Train Loss 0.589946, Valid_loss 0.849087
Epoch 31, Train Loss 0.598898, Valid_loss 0.882481
Epoch 32, Train Loss 0.536126, Valid_loss 1.886680
Epoch 33, Train Loss 0.665513, Valid_loss 1.051768
Epoch 34, Train Loss 0.566165, Valid_loss 0.669757
Epoch 35, Train Loss 0.565544, Valid_loss 0.740619
Epoch 36, Train Loss 0.525257, Valid_loss 1.069835
Epoch 37, Train Loss 0.508081, Valid_loss 0.608647
Epoch 38, Train Loss 0.543937, Valid_loss 0.630731
Epoch 39, Train Loss 0.581201, Valid_loss 0.620595
Epoch 40, Train Loss 0.514292, Valid_loss 0.683399
Epoch 41, Train Loss 0.505073, Valid_loss 0.711170
Epoch 42, Train Loss 0.476317, Valid_loss 0.983314
Epoch 43, Train Loss 0.542001, Valid_loss 0.678199
Epoch 44, Train Loss 0.491667, Valid_loss 0.668899
Epoch 45, Train Loss 0.529874, Valid_loss 0.606358
Epoch 46, Train Loss 0.506767, Valid_loss 1.314929
Epoch 47, Train Loss 0.462720, Valid_loss 0.604088
Epoch 48, Train Loss 0.492214, Valid_loss 0.579686
Epoch 49, Train Loss 0.480703, Valid_loss 0.889889
Epoch 50, Train Loss 0.464553, Valid_loss 0.610063
Epoch 51, Train Loss 0.455581, Valid_loss 0.574897
Epoch 52, Train Loss 0.438104, Valid_loss 0.568732
Epoch 53, Train Loss 0.434997, Valid_loss 0.563304
Epoch 54, Train Loss 0.431005, Valid_loss 0.569535
Epoch 55, Train Loss 0.374670, Valid_loss 0.573824
[I 2025-08-29 15:23:35,472] Trial 3 finished with value: 0.5633040949469432 and parameters: {'learning_rate': 0.001, 'epochs': 100, 'heads': 1, 'dropout': 0.7, 'weight_decay': 0.001, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 1 with value: 0.5139220021665096.
선택된 trial params: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 2, 'dropout': 0.5, 'weight_decay': 0.0001, 'emb_dim': 32, 'augment_num': 100, 'pca': False}
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=8, batch_size=1 -> steps=8
Memory Allocated: 18.01 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.968693, Valid_loss 1.224679
Epoch 2, Train Loss 0.888378, Valid_loss 1.201860
Epoch 3, Train Loss 0.802753, Valid_loss 0.989242
Epoch 4, Train Loss 0.748574, Valid_loss 0.862770
Epoch 5, Train Loss 0.649750, Valid_loss 0.843153
Epoch 6, Train Loss 0.642015, Valid_loss 0.838144
Epoch 7, Train Loss 0.610771, Valid_loss 0.749297
Epoch 8, Train Loss 0.666597, Valid_loss 0.650012
Epoch 9, Train Loss 0.582650, Valid_loss 0.645618
Epoch 10, Train Loss 0.669182, Valid_loss 0.761021
Epoch 11, Train Loss 0.621512, Valid_loss 0.720094
Epoch 12, Train Loss 0.612539, Valid_loss 0.706809
Epoch 13, Train Loss 0.638231, Valid_loss 0.664606
Epoch 14, Train Loss 0.549848, Valid_loss 0.623443
Epoch 15, Train Loss 0.556625, Valid_loss 0.616540
Epoch 16, Train Loss 0.497248, Valid_loss 0.540612
Epoch 17, Train Loss 0.551084, Valid_loss 0.651785
Epoch 18, Train Loss 0.492381, Valid_loss 0.742411
Epoch 19, Train Loss 0.486016, Valid_loss 0.532683
Epoch 20, Train Loss 0.511223, Valid_loss 0.573461
Epoch 21, Train Loss 0.459673, Valid_loss 0.541029
Epoch 22, Train Loss 0.434538, Valid_loss 0.539690
Epoch 23, Train Loss 0.469157, Valid_loss 0.510178
Epoch 24, Train Loss 0.444700, Valid_loss 0.511930
Epoch 25, Train Loss 0.466226, Valid_loss 0.461864
Epoch 26, Train Loss 0.482518, Valid_loss 0.546544
Epoch 27, Train Loss 0.402582, Valid_loss 0.557090
Epoch 28, Train Loss 0.444571, Valid_loss 0.527937
Epoch 29, Train Loss 0.432964, Valid_loss 0.534065
Epoch 30, Train Loss 0.369588, Valid_loss 0.496926
Epoch 31, Train Loss 0.393087, Valid_loss 0.637450
Epoch 32, Train Loss 0.425478, Valid_loss 0.742089
Epoch 33, Train Loss 0.372289, Valid_loss 0.542197
Epoch 34, Train Loss 0.356011, Valid_loss 0.555239
Epoch 35, Train Loss 0.377951, Valid_loss 0.571911
Epoch 36, Train Loss 0.374772, Valid_loss 0.526382
Epoch 37, Train Loss 0.312359, Valid_loss 0.541188
Epoch 38, Train Loss 0.390116, Valid_loss 0.558947
Epoch 39, Train Loss 0.328901, Valid_loss 0.477597
Epoch 40, Train Loss 0.333583, Valid_loss 0.583984
Epoch 41, Train Loss 0.401652, Valid_loss 0.609829
Epoch 42, Train Loss 0.293256, Valid_loss 0.717691
Epoch 43, Train Loss 0.361577, Valid_loss 0.517975
Epoch 44, Train Loss 0.302768, Valid_loss 0.619707
Epoch 45, Train Loss 0.276294, Valid_loss 0.442048
Epoch 46, Train Loss 0.365770, Valid_loss 0.506852
Epoch 47, Train Loss 0.343604, Valid_loss 0.662967
Epoch 48, Train Loss 0.394252, Valid_loss 0.645604
Epoch 49, Train Loss 0.300630, Valid_loss 0.557382
Epoch 50, Train Loss 0.338057, Valid_loss 0.742104
Epoch 51, Train Loss 0.280683, Valid_loss 0.580536
Epoch 52, Train Loss 0.265681, Valid_loss 0.630938
Epoch 53, Train Loss 0.243823, Valid_loss 0.657087
환자ID=P1358 -- true: [[2]] -- pred: tensor([[-2.0835,  0.2785,  0.6488]], device='cuda:0')
환자ID=P1425 -- true: [[1]] -- pred: tensor([[-1.9744,  0.3150,  0.7217]], device='cuda:0')
환자ID=P1462 -- true: [[1]] -- pred: tensor([[-1.6821,  0.7439,  0.1104]], device='cuda:0')
환자ID=P1547 -- true: [[0]] -- pred: tensor([[ 2.1116, -1.4591, -2.4284]], device='cuda:0')
환자ID=P1558 -- true: [[0]] -- pred: tensor([[ 2.4588, -1.5969, -2.5188]], device='cuda:0')
환자ID=P1600 -- true: [[0]] -- pred: tensor([[ 2.3700, -1.4594, -2.5802]], device='cuda:0')
환자ID=P1606 -- true: [[2]] -- pred: tensor([[-2.0832,  0.2857,  0.6936]], device='cuda:0')
환자ID=P1735 -- true: [[1]] -- pred: tensor([[-2.0461,  0.4408,  0.5815]], device='cuda:0')
Best performance: Epoch 45, Loss 0.276294, Test ACC 0.750000, Test AUC 0.916667, Test Recall 0.777778, Test Precision 0.833333
Confusion Matrix:
 [[3 0 0]
 [0 1 2]
 [0 0 2]]
✅ Total valid splits used: 5

📌 Repeat 1: 평균 AUC = 0.8759, 표준편차 = 0.0763
Test ACC 평균 0.763889, Test Recall 평균 0.733333, Test Precision 평균 0.716667
fold_aucs = [0.8333333333333334, 0.8518518518518517, 0.7777777777777778, 1.0, 0.9166666666666666]
NaN 개수: 0 / 전체 5개

🔁 Repeat 2, Fold 0
cell type :  TTCTTCCGTTCAACGT-1-0                Astrocyte
CATCCACCATCTAACG-1-0      Smooth_muscle_cells
ACCCAAACAGCTAACT-1-0                  Neurons
AAGGAATCAACTGGTT-1-0     Neuroepithelial_cell
TACCCGTAGCGTGCTC-1-0                Astrocyte
                                 ...         
TTATTGCGTCGGTGTC-1-79       Endothelial_cells
GTCACGGGTTGTATGC-1-79       Endothelial_cells
GTCATGATCTTTCGAT-1-79       Endothelial_cells
GCGATCGTCAGAGTGG-1-79               Platelets
GCCCGAACAGAGAAAG-1-79       Endothelial_cells
Name: singler_annotation, Length: 464096, dtype: string
cell type annotation :  TTCTTCCGTTCAACGT-1-0                Astrocyte
CATCCACCATCTAACG-1-0      Smooth_muscle_cells
ACCCAAACAGCTAACT-1-0                  Neurons
AAGGAATCAACTGGTT-1-0     Neuroepithelial_cell
TACCCGTAGCGTGCTC-1-0                Astrocyte
                                 ...         
TTATTGCGTCGGTGTC-1-79       Endothelial_cells
GTCACGGGTTGTATGC-1-79       Endothelial_cells
GTCATGATCTTTCGAT-1-79       Endothelial_cells
GCGATCGTCAGAGTGG-1-79               Platelets
GCCCGAACAGAGAAAG-1-79       Endothelial_cells
Name: singler_annotation, Length: 464096, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Astrocyte', 'Smooth_muscle_cells', 'Neurons', 'Neuroepithelial_cell', 'Endothelial_cells', 'Osteoblasts', 'Platelets', 'Hepatocytes', 'Embryonic_stem_cells', 'MEP', 'Erythroblast', 'Fibroblasts', 'iPS_cells', 'MSC', 'Macrophage', 'Gametocytes', 'Chondrocytes', 'NK_cell', 'Neutrophils', 'HSC_CD34+', 'Monocyte', 'Tissue_stem_cells', 'DC', 'HSC_-G-CSF', 'T_cells', 'Epithelial_cells', 'Unknown', 'Pre-B_cell_CD34-', 'GMP', 'B_cell', 'Pro-Myelocyte', 'Keratinocytes', 'Myelocyte', 'BM', 'CMP', 'BM & Prog.', 'Pro-B_cell_CD34+']
라벨별 그룹 개수 {2: 9, 1: 12, 0: 12}
cell type :  CTCCCAAGTGGCACTC-1-6                 Neurons
CTGCCTAAGCCTCAAT-1-6                 Neurons
TCCTGCAAGGCTCTAT-1-6               Astrocyte
ACGTACAGTGGACCAA-1-6                 Neurons
TCCTCCCCAACATACC-1-6                 Neurons
                                ...         
GTTCTATTCCTTCTAA-1-77      Endothelial_cells
GAGTCATTCATGGATC-1-77      Endothelial_cells
GGTGTTACAAGACAAT-1-77    Smooth_muscle_cells
AGCGTCGTCCTCACTG-1-77            Neutrophils
GTGCTGGCATGATAGA-1-77      Endothelial_cells
Name: singler_annotation, Length: 128593, dtype: string
cell type annotation :  CTCCCAAGTGGCACTC-1-6                 Neurons
CTGCCTAAGCCTCAAT-1-6                 Neurons
TCCTGCAAGGCTCTAT-1-6               Astrocyte
ACGTACAGTGGACCAA-1-6                 Neurons
TCCTCCCCAACATACC-1-6                 Neurons
                                ...         
GTTCTATTCCTTCTAA-1-77      Endothelial_cells
GAGTCATTCATGGATC-1-77      Endothelial_cells
GGTGTTACAAGACAAT-1-77    Smooth_muscle_cells
AGCGTCGTCCTCACTG-1-77            Neutrophils
GTGCTGGCATGATAGA-1-77      Endothelial_cells
Name: singler_annotation, Length: 128593, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Neurons', 'Astrocyte', 'Platelets', 'Endothelial_cells', 'Erythroblast', 'Osteoblasts', 'Neuroepithelial_cell', 'Smooth_muscle_cells', 'NK_cell', 'MSC', 'Fibroblasts', 'Hepatocytes', 'iPS_cells', 'Chondrocytes', 'Macrophage', 'Tissue_stem_cells', 'Embryonic_stem_cells', 'MEP', 'Keratinocytes', 'Gametocytes', 'Unknown', 'Neutrophils', 'Monocyte', 'DC', 'Myelocyte', 'HSC_CD34+', 'T_cells', 'HSC_-G-CSF', 'Epithelial_cells', 'B_cell', 'BM', 'Pro-Myelocyte', 'GMP', 'CMP', 'BM & Prog.', 'Pre-B_cell_CD34-', 'Pro-B_cell_CD34+']
라벨별 그룹 개수 {2: 2, 1: 3, 0: 4}
🔍 Split #1
  → train_p_index 환자 수 (환자 단위로 묶인 index list): 33
  → test_p_index 환자 수  (환자 단위로 묶인 index list): 9
  → train 환자 ID: ['P1290', 'P1300', 'P1358', 'P1371', 'P1422', 'P1425', 'P1430', 'P1462', 'P1472', 'P1479', 'P1504', 'P1508', 'P1516', 'P1539', 'P1540', 'P1547', 'P1549', 'P1558', 'P1561', 'P1582', 'P1606', 'P1610', 'P1617', 'P1622', 'P1630', 'P1631', 'P1678', 'P1685', 'P1702', 'P1707', 'P1722', 'P1726', 'P1735']
  → test  환자 ID: ['P1304', 'P1437', 'P1447', 'P1510', 'P1515', 'P1600', 'P1602', 'P1603', 'P1718']
  → train 환자 ID 및 라벨:
    ID: P1290, Label: 2
    ID: P1300, Label: 2
    ID: P1358, Label: 2
    ID: P1371, Label: 2
    ID: P1422, Label: 1
    ID: P1425, Label: 1
    ID: P1430, Label: 2
    ID: P1462, Label: 1
    ID: P1472, Label: 2
    ID: P1479, Label: 1
    ID: P1504, Label: 2
    ID: P1508, Label: 1
    ID: P1516, Label: 0
    ID: P1539, Label: 0
    ID: P1540, Label: 0
    ID: P1547, Label: 0
    ID: P1549, Label: 0
    ID: P1558, Label: 0
    ID: P1561, Label: 0
    ID: P1582, Label: 0
    ID: P1606, Label: 2
    ID: P1610, Label: 0
    ID: P1617, Label: 2
    ID: P1622, Label: 0
    ID: P1630, Label: 1
    ID: P1631, Label: 1
    ID: P1678, Label: 0
    ID: P1685, Label: 1
    ID: P1702, Label: 0
    ID: P1707, Label: 1
    ID: P1722, Label: 1
    ID: P1726, Label: 1
    ID: P1735, Label: 1
  → test 환자 ID 및 라벨:
    ID: P1304, Label: 2
    ID: P1437, Label: 2
    ID: P1447, Label: 1
    ID: P1510, Label: 1
    ID: P1515, Label: 0
    ID: P1600, Label: 0
    ID: P1602, Label: 1
    ID: P1603, Label: 0
    ID: P1718, Label: 0
전체 데이터 index 길이 42
label_stat (train 환자 라벨 목록) 갯수 33
train_data에서 환자 단위로, train과 validation 나누기
기존 train_p_index 33
기존 (train) label_stat 33
train-vali 분할 후! 
train y 의 classes : {0, 1, 2} valid y 의 classes : {0, 1, 2} label_stat 의 classes : {0, 1, 2}
train_p_index_ 22
valid_p_index 11
test_p_index 9
→ train 환자 ID 및 라벨:
   총 개수: 22
   환자ID=P1610, Label=0, 셀개수=13919
   환자ID=P1722, Label=1, 셀개수=21432
   환자ID=P1540, Label=0, 셀개수=11638
   환자ID=P1358, Label=2, 셀개수=23984
   환자ID=P1472, Label=2, 셀개수=19513
   환자ID=P1622, Label=0, 셀개수=7210
   환자ID=P1678, Label=0, 셀개수=10085
   환자ID=P1422, Label=1, 셀개수=23315
   환자ID=P1735, Label=1, 셀개수=12009
   환자ID=P1707, Label=1, 셀개수=9517
   환자ID=P1549, Label=0, 셀개수=11709
   환자ID=P1685, Label=1, 셀개수=10043
   환자ID=P1516, Label=0, 셀개수=9361
   환자ID=P1425, Label=1, 셀개수=15378
   환자ID=P1631, Label=1, 셀개수=13686
   환자ID=P1539, Label=0, 셀개수=11076
   환자ID=P1617, Label=2, 셀개수=17986
   환자ID=P1508, Label=1, 셀개수=20536
   환자ID=P1504, Label=2, 셀개수=8133
   환자ID=P1462, Label=1, 셀개수=21715
   환자ID=P1606, Label=2, 셀개수=8523
   환자ID=P1547, Label=0, 셀개수=8253
→ valid 환자 ID 및 라벨:
   총 개수: 11
   환자ID=P1300, Label=2, 셀개수=17318
   환자ID=P1430, Label=2, 셀개수=11131
   환자ID=P1558, Label=0, 셀개수=10469
   환자ID=P1479, Label=1, 셀개수=19124
   환자ID=P1290, Label=2, 셀개수=8357
   환자ID=P1582, Label=0, 셀개수=18855
   환자ID=P1726, Label=1, 셀개수=12389
   환자ID=P1561, Label=0, 셀개수=10016
   환자ID=P1702, Label=0, 셀개수=13550
   환자ID=P1371, Label=2, 셀개수=16233
   환자ID=P1630, Label=1, 셀개수=17633
→ test 환자 ID 및 라벨:
   총 개수: 9
   환자ID=P1304, Label=2, 셀개수=19123
   환자ID=P1437, Label=2, 셀개수=21695
   환자ID=P1447, Label=1, 셀개수=11151
   환자ID=P1510, Label=1, 셀개수=10744
   환자ID=P1515, Label=0, 셀개수=14502
   환자ID=P1600, Label=0, 셀개수=14882
   환자ID=P1602, Label=1, 셀개수=16580
   환자ID=P1603, Label=0, 셀개수=10638
   환자ID=P1718, Label=0, 셀개수=9278
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Astrocyte', 'Smooth_muscle_cells', 'Neurons', 'Neuroepithelial_cell', 'Astrocyte', 'Endothelial_cells', 'Osteoblasts', 'Platelets', 'Neurons', 'Hepatocytes']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
전체 데이터 길이 592689
전체 cell type 길이 0                    Astrocyte
1          Smooth_muscle_cells
2                      Neurons
3         Neuroepithelial_cell
4                    Astrocyte
                  ...         
592684       Endothelial_cells
592685       Endothelial_cells
592686     Smooth_muscle_cells
592687             Neutrophils
592688       Endothelial_cells
Length: 592689, dtype: string
cell type의 NaN 개수 체크 0
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:12,  7.77it/s]  2%|▏         | 2/100 [00:00<00:12,  7.63it/s]  3%|▎         | 3/100 [00:00<00:12,  7.63it/s]  4%|▍         | 4/100 [00:00<00:12,  7.82it/s]  5%|▌         | 5/100 [00:00<00:12,  7.70it/s]  6%|▌         | 6/100 [00:00<00:12,  7.67it/s]  7%|▋         | 7/100 [00:00<00:12,  7.59it/s]  8%|▊         | 8/100 [00:01<00:11,  7.71it/s]  9%|▉         | 9/100 [00:01<00:11,  7.78it/s] 10%|█         | 10/100 [00:01<00:11,  7.68it/s] 11%|█         | 11/100 [00:01<00:11,  7.71it/s] 12%|█▏        | 12/100 [00:01<00:11,  7.62it/s] 13%|█▎        | 13/100 [00:01<00:11,  7.60it/s] 14%|█▍        | 14/100 [00:01<00:11,  7.52it/s] 15%|█▌        | 15/100 [00:01<00:11,  7.50it/s] 16%|█▌        | 16/100 [00:02<00:11,  7.58it/s] 17%|█▋        | 17/100 [00:02<00:10,  7.70it/s] 18%|█▊        | 18/100 [00:02<00:10,  7.59it/s] 19%|█▉        | 19/100 [00:02<00:10,  7.62it/s] 20%|██        | 20/100 [00:02<00:10,  7.54it/s] 21%|██        | 21/100 [00:02<00:10,  7.52it/s] 22%|██▏       | 22/100 [00:02<00:10,  7.50it/s] 23%|██▎       | 23/100 [00:03<00:09,  7.75it/s] 24%|██▍       | 24/100 [00:03<00:09,  7.67it/s] 25%|██▌       | 25/100 [00:03<00:09,  7.68it/s] 26%|██▌       | 26/100 [00:03<00:09,  7.52it/s] 27%|██▋       | 27/100 [00:03<00:09,  7.49it/s] 28%|██▊       | 28/100 [00:03<00:09,  7.42it/s] 29%|██▉       | 29/100 [00:03<00:09,  7.35it/s] 30%|███       | 30/100 [00:03<00:09,  7.34it/s] 31%|███       | 31/100 [00:04<00:09,  7.40it/s] 32%|███▏      | 32/100 [00:04<00:09,  7.41it/s] 33%|███▎      | 33/100 [00:04<00:09,  7.40it/s] 34%|███▍      | 34/100 [00:04<00:09,  7.32it/s] 35%|███▌      | 35/100 [00:04<00:08,  7.36it/s] 36%|███▌      | 36/100 [00:04<00:08,  7.36it/s] 37%|███▋      | 37/100 [00:04<00:08,  7.37it/s] 38%|███▊      | 38/100 [00:05<00:08,  7.34it/s] 39%|███▉      | 39/100 [00:05<00:08,  7.46it/s] 40%|████      | 40/100 [00:05<00:08,  7.32it/s] 41%|████      | 41/100 [00:05<00:08,  7.34it/s] 42%|████▏     | 42/100 [00:05<00:08,  7.22it/s] 43%|████▎     | 43/100 [00:05<00:07,  7.37it/s] 44%|████▍     | 44/100 [00:05<00:07,  7.47it/s] 45%|████▌     | 45/100 [00:05<00:07,  7.48it/s] 46%|████▌     | 46/100 [00:06<00:07,  7.27it/s] 47%|████▋     | 47/100 [00:06<00:07,  7.20it/s] 48%|████▊     | 48/100 [00:06<00:07,  7.16it/s] 49%|████▉     | 49/100 [00:06<00:07,  7.19it/s] 50%|█████     | 50/100 [00:06<00:07,  7.10it/s] 51%|█████     | 51/100 [00:06<00:06,  7.04it/s] 52%|█████▏    | 52/100 [00:06<00:06,  7.22it/s] 53%|█████▎    | 53/100 [00:07<00:06,  7.21it/s] 54%|█████▍    | 54/100 [00:07<00:06,  7.24it/s] 55%|█████▌    | 55/100 [00:07<00:06,  7.22it/s] 56%|█████▌    | 56/100 [00:07<00:06,  7.27it/s] 57%|█████▋    | 57/100 [00:07<00:05,  7.31it/s] 58%|█████▊    | 58/100 [00:07<00:05,  7.20it/s] 59%|█████▉    | 59/100 [00:07<00:05,  7.23it/s] 60%|██████    | 60/100 [00:08<00:05,  7.33it/s] 61%|██████    | 61/100 [00:08<00:05,  7.35it/s] 62%|██████▏   | 62/100 [00:08<00:05,  7.38it/s] 63%|██████▎   | 63/100 [00:08<00:05,  7.38it/s] 64%|██████▍   | 64/100 [00:08<00:04,  7.27it/s] 65%|██████▌   | 65/100 [00:08<00:04,  7.31it/s] 66%|██████▌   | 66/100 [00:08<00:04,  7.18it/s] 67%|██████▋   | 67/100 [00:09<00:04,  7.18it/s] 68%|██████▊   | 68/100 [00:09<00:04,  7.14it/s] 69%|██████▉   | 69/100 [00:09<00:04,  7.17it/s] 70%|███████   | 70/100 [00:09<00:04,  7.14it/s] 71%|███████   | 71/100 [00:09<00:04,  7.18it/s] 72%|███████▏  | 72/100 [00:09<00:03,  7.09it/s] 73%|███████▎  | 73/100 [00:09<00:03,  7.08it/s] 74%|███████▍  | 74/100 [00:10<00:03,  7.04it/s] 75%|███████▌  | 75/100 [00:10<00:03,  6.99it/s] 76%|███████▌  | 76/100 [00:10<00:03,  7.04it/s] 77%|███████▋  | 77/100 [00:10<00:03,  6.88it/s] 78%|███████▊  | 78/100 [00:10<00:03,  6.93it/s] 79%|███████▉  | 79/100 [00:10<00:03,  6.82it/s] 80%|████████  | 80/100 [00:10<00:02,  6.90it/s] 81%|████████  | 81/100 [00:11<00:02,  6.85it/s] 82%|████████▏ | 82/100 [00:11<00:02,  7.07it/s] 83%|████████▎ | 83/100 [00:11<00:02,  6.94it/s] 84%|████████▍ | 84/100 [00:11<00:02,  7.04it/s] 85%|████████▌ | 85/100 [00:11<00:02,  6.90it/s] 86%|████████▌ | 86/100 [00:11<00:02,  6.95it/s] 87%|████████▋ | 87/100 [00:11<00:01,  6.85it/s] 88%|████████▊ | 88/100 [00:12<00:01,  6.83it/s] 89%|████████▉ | 89/100 [00:12<00:01,  6.80it/s] 90%|█████████ | 90/100 [00:12<00:01,  6.97it/s] 91%|█████████ | 91/100 [00:12<00:01,  6.86it/s] 92%|█████████▏| 92/100 [00:12<00:01,  6.82it/s] 93%|█████████▎| 93/100 [00:12<00:01,  6.71it/s] 94%|█████████▍| 94/100 [00:12<00:00,  6.83it/s] 95%|█████████▌| 95/100 [00:13<00:00,  6.70it/s] 96%|█████████▌| 96/100 [00:13<00:00,  6.76it/s] 97%|█████████▋| 97/100 [00:13<00:00,  6.77it/s] 98%|█████████▊| 98/100 [00:13<00:00,  6.70it/s] 99%|█████████▉| 99/100 [00:13<00:00,  6.68it/s]100%|██████████| 100/100 [00:13<00:00,  6.74it/s]100%|██████████| 100/100 [00:13<00:00,  7.23it/s]
[I 2025-08-29 15:54:29,419] A new study created in memory with name: no-name-06924729-7ee1-4b6f-8d8b-b84c5c240d50
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 19.85 MB
Memory Reserved: 42.00 MB
cuda
CUDA OOM 발생 — 단계적 백오프 시작.
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 17906.54 MB
Memory Reserved: 17924.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 349.96 MB
Memory Reserved: 388.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 17906.25 MB
Memory Reserved: 17932.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 350.37 MB
Memory Reserved: 388.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[I 2025-08-29 15:54:30,831] Trial 0 pruned. Pruned due to OOM after backoff
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 17906.81 MB
Memory Reserved: 17932.00 MB
cuda
Epoch 1, Train Loss 1.115164, Valid_loss 1.312860
Epoch 2, Train Loss 1.006791, Valid_loss 1.585408
Epoch 3, Train Loss 0.992500, Valid_loss 1.147957
Epoch 4, Train Loss 1.011578, Valid_loss 1.516245
Epoch 5, Train Loss 0.986778, Valid_loss 1.259487
Epoch 6, Train Loss 0.978170, Valid_loss 1.393082
Epoch 7, Train Loss 0.979320, Valid_loss 1.220986
Epoch 8, Train Loss 0.989842, Valid_loss 1.185189
Epoch 9, Train Loss 0.979847, Valid_loss 1.308438
Epoch 10, Train Loss 0.957033, Valid_loss 1.331167
Epoch 11, Train Loss 0.978892, Valid_loss 1.305171
Epoch 12, Train Loss 0.963326, Valid_loss 1.412706
Epoch 13, Train Loss 0.967871, Valid_loss 1.308074
Epoch 14, Train Loss 0.966152, Valid_loss 1.287581
Epoch 15, Train Loss 0.961600, Valid_loss 1.304279
Epoch 16, Train Loss 0.972208, Valid_loss 1.359547
Epoch 17, Train Loss 0.958384, Valid_loss 1.304688
Epoch 18, Train Loss 0.962070, Valid_loss 1.344167
Epoch 19, Train Loss 0.958604, Valid_loss 1.325395
Epoch 20, Train Loss 0.954450, Valid_loss 1.339633
Epoch 21, Train Loss 0.964020, Valid_loss 1.375983
Epoch 22, Train Loss 0.956667, Valid_loss 1.356185
Epoch 23, Train Loss 0.955807, Valid_loss 1.330587
Epoch 24, Train Loss 0.957523, Valid_loss 1.343370
Epoch 25, Train Loss 0.956400, Valid_loss 1.343009
Epoch 26, Train Loss 0.954085, Valid_loss 1.349009
Epoch 27, Train Loss 0.957990, Valid_loss 1.335841
Epoch 28, Train Loss 0.958828, Valid_loss 1.355490
Epoch 29, Train Loss 0.955181, Valid_loss 1.352630
Epoch 30, Train Loss 0.954837, Valid_loss 1.342680
Epoch 31, Train Loss 0.956420, Valid_loss 1.334834
Epoch 32, Train Loss 0.956425, Valid_loss 1.353469
Epoch 33, Train Loss 0.955000, Valid_loss 1.332814
Epoch 34, Train Loss 0.953263, Valid_loss 1.345039
Epoch 35, Train Loss 0.955997, Valid_loss 1.346830
Epoch 36, Train Loss 0.956500, Valid_loss 1.346666
Epoch 37, Train Loss 0.955129, Valid_loss 1.348394
Epoch 38, Train Loss 0.955828, Valid_loss 1.352288
Epoch 39, Train Loss 0.953479, Valid_loss 1.356190
Epoch 40, Train Loss 0.956425, Valid_loss 1.346760
Epoch 41, Train Loss 0.956130, Valid_loss 1.342320
Epoch 42, Train Loss 0.954677, Valid_loss 1.355878
Epoch 43, Train Loss 0.954988, Valid_loss 1.346737
Epoch 44, Train Loss 0.955557, Valid_loss 1.343906
Epoch 45, Train Loss 0.957913, Valid_loss 1.340328
Epoch 46, Train Loss 0.954012, Valid_loss 1.345845
Epoch 47, Train Loss 0.957308, Valid_loss 1.285694
Epoch 48, Train Loss 0.960003, Valid_loss 1.340701
Epoch 49, Train Loss 0.955086, Valid_loss 1.363720
Epoch 50, Train Loss 0.955125, Valid_loss 1.342602
Epoch 51, Train Loss 0.953178, Valid_loss 1.350854
Epoch 52, Train Loss 0.953046, Valid_loss 1.344143
Epoch 53, Train Loss 0.952656, Valid_loss 1.346965
Epoch 54, Train Loss 0.953150, Valid_loss 1.350614
[I 2025-08-29 16:15:57,444] Trial 1 finished with value: 1.147957287051461 and parameters: {'learning_rate': 0.01, 'epochs': 100, 'heads': 1, 'dropout': 0.3, 'weight_decay': 0.0001, 'emb_dim': 64, 'augment_num': 100, 'pca': False}. Best is trial 1 with value: 1.147957287051461.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 16.69 MB
Memory Reserved: 42.00 MB
cuda
CUDA OOM 발생 — 단계적 백오프 시작.
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 17855.37 MB
Memory Reserved: 17874.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 299.37 MB
Memory Reserved: 320.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 17855.54 MB
Memory Reserved: 17876.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 299.37 MB
Memory Reserved: 320.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[I 2025-08-29 16:15:59,188] Trial 2 pruned. Pruned due to OOM after backoff
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 17855.54 MB
Memory Reserved: 17876.00 MB
cuda
CUDA OOM 발생 — 단계적 백오프 시작.
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 17855.37 MB
Memory Reserved: 17874.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 299.37 MB
Memory Reserved: 320.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 17855.54 MB
Memory Reserved: 17876.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 299.37 MB
Memory Reserved: 320.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[I 2025-08-29 16:16:00,567] Trial 3 pruned. Pruned due to OOM after backoff
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 17855.54 MB
Memory Reserved: 17876.00 MB
cuda
Epoch 1, Train Loss 1.392313, Valid_loss 1.086819
Epoch 2, Train Loss 1.375557, Valid_loss 1.083962
Epoch 3, Train Loss 1.280919, Valid_loss 1.082054
Epoch 4, Train Loss 1.306599, Valid_loss 1.065155
Epoch 5, Train Loss 1.224261, Valid_loss 1.061021
Epoch 6, Train Loss 1.134214, Valid_loss 1.034203
Epoch 7, Train Loss 1.272656, Valid_loss 1.026687
Epoch 8, Train Loss 1.118733, Valid_loss 0.991799
Epoch 9, Train Loss 1.165579, Valid_loss 0.984854
Epoch 10, Train Loss 1.142259, Valid_loss 0.963514
Epoch 11, Train Loss 1.082124, Valid_loss 0.911438
Epoch 12, Train Loss 1.083822, Valid_loss 0.906082
Epoch 13, Train Loss 1.061158, Valid_loss 0.890117
Epoch 14, Train Loss 1.080852, Valid_loss 0.934250
Epoch 15, Train Loss 1.033740, Valid_loss 0.891597
Epoch 16, Train Loss 1.008545, Valid_loss 0.888362
Epoch 17, Train Loss 0.997798, Valid_loss 0.880721
Epoch 18, Train Loss 0.970170, Valid_loss 0.880051
Epoch 19, Train Loss 0.955208, Valid_loss 0.873320
Epoch 20, Train Loss 0.980673, Valid_loss 0.868434
Epoch 21, Train Loss 0.939909, Valid_loss 0.867263
Epoch 22, Train Loss 0.934294, Valid_loss 0.863225
Epoch 23, Train Loss 0.963591, Valid_loss 0.862105
Epoch 24, Train Loss 0.901531, Valid_loss 0.864304
Epoch 25, Train Loss 0.884121, Valid_loss 0.855007
Epoch 26, Train Loss 0.900007, Valid_loss 0.850378
Epoch 27, Train Loss 0.882713, Valid_loss 0.850231
Epoch 28, Train Loss 0.805414, Valid_loss 0.839462
Epoch 29, Train Loss 0.876897, Valid_loss 0.841674
Epoch 30, Train Loss 0.866058, Valid_loss 0.843486
Epoch 31, Train Loss 0.871321, Valid_loss 0.834061
Epoch 32, Train Loss 0.855104, Valid_loss 0.842195
Epoch 33, Train Loss 0.792219, Valid_loss 0.835028
Epoch 34, Train Loss 0.838398, Valid_loss 0.846549
Epoch 35, Train Loss 0.815732, Valid_loss 0.835429
Epoch 36, Train Loss 0.862840, Valid_loss 0.840347
Epoch 37, Train Loss 0.783716, Valid_loss 0.838434
Epoch 38, Train Loss 0.764812, Valid_loss 0.832768
Epoch 39, Train Loss 0.837684, Valid_loss 0.834680
Epoch 40, Train Loss 0.833857, Valid_loss 0.832212
Epoch 41, Train Loss 0.792021, Valid_loss 0.826288
Epoch 42, Train Loss 0.821907, Valid_loss 0.828381
Epoch 43, Train Loss 0.809018, Valid_loss 0.841414
Epoch 44, Train Loss 0.729438, Valid_loss 0.827424
Epoch 45, Train Loss 0.853504, Valid_loss 0.825527
Epoch 46, Train Loss 0.797275, Valid_loss 0.827883
Epoch 47, Train Loss 0.762004, Valid_loss 0.828430
Epoch 48, Train Loss 0.814918, Valid_loss 0.828484
Epoch 49, Train Loss 0.737435, Valid_loss 0.823611
Epoch 50, Train Loss 0.778459, Valid_loss 0.822269
Epoch 51, Train Loss 0.750290, Valid_loss 0.827034
Epoch 52, Train Loss 0.687368, Valid_loss 0.819789
Epoch 53, Train Loss 0.804934, Valid_loss 0.820417
Epoch 54, Train Loss 0.699105, Valid_loss 0.817783
Epoch 55, Train Loss 0.831791, Valid_loss 0.829947
Epoch 56, Train Loss 0.767520, Valid_loss 0.816043
Epoch 57, Train Loss 0.780476, Valid_loss 0.823472
Epoch 58, Train Loss 0.748899, Valid_loss 0.814108
Epoch 59, Train Loss 0.774937, Valid_loss 0.812942
Epoch 60, Train Loss 0.804715, Valid_loss 0.820611
Epoch 61, Train Loss 0.704558, Valid_loss 0.810464
Epoch 62, Train Loss 0.733506, Valid_loss 0.809000
Epoch 63, Train Loss 0.781997, Valid_loss 0.816718
Epoch 64, Train Loss 0.746501, Valid_loss 0.832129
[I 2025-08-29 16:41:35,036] Trial 4 finished with value: 0.8090001182122664 and parameters: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 1, 'dropout': 0.7, 'weight_decay': 0.001, 'emb_dim': 8, 'augment_num': 100, 'pca': False}. Best is trial 4 with value: 0.8090001182122664.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 18.01 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.955744, Valid_loss 1.162430
Epoch 2, Train Loss 0.829385, Valid_loss 0.927147
Epoch 3, Train Loss 0.690768, Valid_loss 0.829196
Epoch 4, Train Loss 0.576572, Valid_loss 0.737365
Epoch 5, Train Loss 0.636817, Valid_loss 0.767910
Epoch 6, Train Loss 0.542202, Valid_loss 0.764367
Epoch 7, Train Loss 0.522453, Valid_loss 0.717981
Epoch 8, Train Loss 0.468675, Valid_loss 0.798469
Epoch 9, Train Loss 0.417731, Valid_loss 0.810162
Epoch 10, Train Loss 0.439524, Valid_loss 0.698493
Epoch 11, Train Loss 0.452261, Valid_loss 0.701060
Epoch 12, Train Loss 0.398241, Valid_loss 0.713903
Epoch 13, Train Loss 0.387816, Valid_loss 0.625476
Epoch 14, Train Loss 0.404269, Valid_loss 0.797698
Epoch 15, Train Loss 0.435517, Valid_loss 0.616088
Epoch 16, Train Loss 0.389726, Valid_loss 0.655699
Epoch 17, Train Loss 0.365047, Valid_loss 0.670548
Epoch 18, Train Loss 0.361989, Valid_loss 0.619310
Epoch 19, Train Loss 0.361900, Valid_loss 0.640114
Epoch 20, Train Loss 0.344712, Valid_loss 0.561096
Epoch 21, Train Loss 0.356208, Valid_loss 0.700124
Epoch 22, Train Loss 0.326491, Valid_loss 0.555508
Epoch 23, Train Loss 0.295069, Valid_loss 0.609742
Epoch 24, Train Loss 0.293018, Valid_loss 0.730432
Epoch 25, Train Loss 0.333910, Valid_loss 0.575223
Epoch 26, Train Loss 0.277895, Valid_loss 0.532178
Epoch 27, Train Loss 0.311783, Valid_loss 0.531829
Epoch 28, Train Loss 0.293694, Valid_loss 0.879274
Epoch 29, Train Loss 0.292231, Valid_loss 0.767724
Epoch 30, Train Loss 0.274804, Valid_loss 0.810244
Epoch 31, Train Loss 0.322089, Valid_loss 0.759050
Epoch 32, Train Loss 0.270803, Valid_loss 0.692214
Epoch 33, Train Loss 0.310434, Valid_loss 0.825419
Epoch 34, Train Loss 0.268321, Valid_loss 0.605177
Epoch 35, Train Loss 0.207320, Valid_loss 0.815700
Epoch 36, Train Loss 0.253526, Valid_loss 0.875840
Epoch 37, Train Loss 0.256701, Valid_loss 0.808984
Epoch 38, Train Loss 0.207881, Valid_loss 0.749217
Epoch 39, Train Loss 0.236068, Valid_loss 1.018109
Epoch 40, Train Loss 0.208137, Valid_loss 0.640897
Epoch 41, Train Loss 0.263271, Valid_loss 0.697003
Epoch 42, Train Loss 0.213029, Valid_loss 0.769355
Epoch 43, Train Loss 0.221460, Valid_loss 0.676078
Epoch 44, Train Loss 0.229526, Valid_loss 0.981730
Epoch 45, Train Loss 0.244416, Valid_loss 0.722147
Epoch 46, Train Loss 0.200966, Valid_loss 0.805988
Epoch 47, Train Loss 0.220603, Valid_loss 0.572501
Epoch 48, Train Loss 0.233955, Valid_loss 0.879511
Epoch 49, Train Loss 0.222221, Valid_loss 0.750487
Epoch 50, Train Loss 0.200108, Valid_loss 0.719578
Epoch 51, Train Loss 0.185301, Valid_loss 0.924749
Epoch 52, Train Loss 0.181810, Valid_loss 0.865332
Epoch 53, Train Loss 0.172095, Valid_loss 0.690921
Epoch 54, Train Loss 0.179216, Valid_loss 0.911675
Epoch 55, Train Loss 0.160169, Valid_loss 1.020242
[I 2025-08-29 17:13:34,261] Trial 5 finished with value: 0.5318289802155711 and parameters: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 2, 'dropout': 0.3, 'weight_decay': 0.001, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 5 with value: 0.5318289802155711.
선택된 trial params: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 2, 'dropout': 0.3, 'weight_decay': 0.001, 'emb_dim': 32, 'augment_num': 100, 'pca': False}
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=9, batch_size=1 -> steps=9
Memory Allocated: 18.01 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.916942, Valid_loss 0.920635
Epoch 2, Train Loss 0.730334, Valid_loss 0.841501
Epoch 3, Train Loss 0.603618, Valid_loss 0.680990
Epoch 4, Train Loss 0.555949, Valid_loss 0.678481
Epoch 5, Train Loss 0.538087, Valid_loss 0.785234
Epoch 6, Train Loss 0.494646, Valid_loss 0.718468
Epoch 7, Train Loss 0.483529, Valid_loss 0.618146
Epoch 8, Train Loss 0.457439, Valid_loss 0.643790
Epoch 9, Train Loss 0.445768, Valid_loss 0.726740
Epoch 10, Train Loss 0.428448, Valid_loss 0.667178
Epoch 11, Train Loss 0.415003, Valid_loss 0.610925
Epoch 12, Train Loss 0.435536, Valid_loss 0.845997
Epoch 13, Train Loss 0.437605, Valid_loss 0.604147
Epoch 14, Train Loss 0.369816, Valid_loss 0.747092
Epoch 15, Train Loss 0.410203, Valid_loss 0.560706
Epoch 16, Train Loss 0.345060, Valid_loss 0.644760
Epoch 17, Train Loss 0.365534, Valid_loss 0.779609
Epoch 18, Train Loss 0.369222, Valid_loss 0.630372
Epoch 19, Train Loss 0.326616, Valid_loss 0.685678
Epoch 20, Train Loss 0.324654, Valid_loss 0.942324
Epoch 21, Train Loss 0.361602, Valid_loss 0.709122
Epoch 22, Train Loss 0.322912, Valid_loss 0.697269
Epoch 23, Train Loss 0.308542, Valid_loss 0.558481
Epoch 24, Train Loss 0.313004, Valid_loss 0.566308
Epoch 25, Train Loss 0.276362, Valid_loss 0.548302
Epoch 26, Train Loss 0.286749, Valid_loss 0.632650
Epoch 27, Train Loss 0.294236, Valid_loss 0.817127
Epoch 28, Train Loss 0.297501, Valid_loss 0.571608
Epoch 29, Train Loss 0.258440, Valid_loss 0.872364
Epoch 30, Train Loss 0.262668, Valid_loss 0.776912
Epoch 31, Train Loss 0.261872, Valid_loss 0.913754
Epoch 32, Train Loss 0.343225, Valid_loss 0.736566
Epoch 33, Train Loss 0.256499, Valid_loss 0.862108
Epoch 34, Train Loss 0.258355, Valid_loss 0.576219
Epoch 35, Train Loss 0.269847, Valid_loss 0.584232
Epoch 36, Train Loss 0.233736, Valid_loss 0.733292
Epoch 37, Train Loss 0.257633, Valid_loss 0.843804
Epoch 38, Train Loss 0.231045, Valid_loss 1.299095
Epoch 39, Train Loss 0.323813, Valid_loss 0.542515
Epoch 40, Train Loss 0.250371, Valid_loss 0.629760
Epoch 41, Train Loss 0.220823, Valid_loss 0.680177
Epoch 42, Train Loss 0.192401, Valid_loss 0.980201
Epoch 43, Train Loss 0.213201, Valid_loss 0.846099
Epoch 44, Train Loss 0.183321, Valid_loss 1.089373
Epoch 45, Train Loss 0.214620, Valid_loss 0.634017
Epoch 46, Train Loss 0.181965, Valid_loss 0.937466
Epoch 47, Train Loss 0.177330, Valid_loss 0.668486
Epoch 48, Train Loss 0.196429, Valid_loss 1.113510
Epoch 49, Train Loss 0.199662, Valid_loss 0.954304
Epoch 50, Train Loss 0.182095, Valid_loss 0.800308
Epoch 51, Train Loss 0.158442, Valid_loss 1.054433
Epoch 52, Train Loss 0.189719, Valid_loss 0.776573
Epoch 53, Train Loss 0.179637, Valid_loss 0.748010
Epoch 54, Train Loss 0.162877, Valid_loss 0.829114
Epoch 55, Train Loss 0.162338, Valid_loss 0.945536
환자ID=P1304 -- true: [[2]] -- pred: tensor([[-2.1874,  0.7564,  0.1738]], device='cuda:0')
환자ID=P1437 -- true: [[2]] -- pred: tensor([[-2.3021,  0.1412,  0.7060]], device='cuda:0')
환자ID=P1447 -- true: [[1]] -- pred: tensor([[-2.0128,  1.2743, -0.4270]], device='cuda:0')
환자ID=P1510 -- true: [[1]] -- pred: tensor([[-1.7114,  0.8321, -0.4298]], device='cuda:0')
환자ID=P1515 -- true: [[0]] -- pred: tensor([[ 2.3096, -1.4130, -2.5113]], device='cuda:0')
환자ID=P1600 -- true: [[0]] -- pred: tensor([[ 2.0891, -1.2481, -2.5632]], device='cuda:0')
환자ID=P1602 -- true: [[1]] -- pred: tensor([[-1.1393,  0.6487, -1.0199]], device='cuda:0')
환자ID=P1603 -- true: [[0]] -- pred: tensor([[ 1.7629, -1.2084, -2.2932]], device='cuda:0')
환자ID=P1718 -- true: [[0]] -- pred: tensor([[ 1.6343, -1.1255, -2.2627]], device='cuda:0')
Best performance: Epoch 39, Loss 0.323813, Test ACC 0.888889, Test AUC 1.000000, Test Recall 0.833333, Test Precision 0.916667
Confusion Matrix:
 [[4 0 0]
 [0 3 0]
 [0 1 1]]
✅ Total valid splits used: 1
🔁 Repeat 2, Fold 1
cell type :  TTCTTCCGTTCAACGT-1-0                Astrocyte
CATCCACCATCTAACG-1-0      Smooth_muscle_cells
ACCCAAACAGCTAACT-1-0                  Neurons
AAGGAATCAACTGGTT-1-0     Neuroepithelial_cell
TACCCGTAGCGTGCTC-1-0                Astrocyte
                                 ...         
TTATTGCGTCGGTGTC-1-79       Endothelial_cells
GTCACGGGTTGTATGC-1-79       Endothelial_cells
GTCATGATCTTTCGAT-1-79       Endothelial_cells
GCGATCGTCAGAGTGG-1-79               Platelets
GCCCGAACAGAGAAAG-1-79       Endothelial_cells
Name: singler_annotation, Length: 473950, dtype: string
cell type annotation :  TTCTTCCGTTCAACGT-1-0                Astrocyte
CATCCACCATCTAACG-1-0      Smooth_muscle_cells
ACCCAAACAGCTAACT-1-0                  Neurons
AAGGAATCAACTGGTT-1-0     Neuroepithelial_cell
TACCCGTAGCGTGCTC-1-0                Astrocyte
                                 ...         
TTATTGCGTCGGTGTC-1-79       Endothelial_cells
GTCACGGGTTGTATGC-1-79       Endothelial_cells
GTCATGATCTTTCGAT-1-79       Endothelial_cells
GCGATCGTCAGAGTGG-1-79               Platelets
GCCCGAACAGAGAAAG-1-79       Endothelial_cells
Name: singler_annotation, Length: 473950, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Astrocyte', 'Smooth_muscle_cells', 'Neurons', 'Neuroepithelial_cell', 'Endothelial_cells', 'Osteoblasts', 'Platelets', 'Hepatocytes', 'Embryonic_stem_cells', 'MEP', 'Erythroblast', 'Fibroblasts', 'iPS_cells', 'MSC', 'Macrophage', 'Gametocytes', 'Chondrocytes', 'NK_cell', 'Neutrophils', 'HSC_CD34+', 'Monocyte', 'Tissue_stem_cells', 'DC', 'HSC_-G-CSF', 'T_cells', 'Epithelial_cells', 'Unknown', 'Pre-B_cell_CD34-', 'GMP', 'B_cell', 'Pro-Myelocyte', 'Keratinocytes', 'Myelocyte', 'BM', 'CMP', 'BM & Prog.', 'Pro-B_cell_CD34+']
라벨별 그룹 개수 {2: 8, 1: 12, 0: 13}
cell type :  AACCTGAGTGTACATC-1-4     Smooth_muscle_cells
CTCCAACTCCGAGATT-1-4                 Neurons
CATCGTCCACCCGTAG-1-4       Endothelial_cells
AAAGGGCCACTAGTAC-1-4       Endothelial_cells
ATTTCTGGTGAATGAT-1-4             Osteoblasts
                                ...         
CGTCCATAGAATTTGG-1-78      Endothelial_cells
GCTTCACAGCGTTGTT-1-78            Hepatocytes
TCTCTGGCAGTCGCAC-1-78                Neurons
CAACAACCAGAGGCTA-1-78                Neurons
CATTGTTGTCGTACAT-1-78      Endothelial_cells
Name: singler_annotation, Length: 118739, dtype: string
cell type annotation :  AACCTGAGTGTACATC-1-4     Smooth_muscle_cells
CTCCAACTCCGAGATT-1-4                 Neurons
CATCGTCCACCCGTAG-1-4       Endothelial_cells
AAAGGGCCACTAGTAC-1-4       Endothelial_cells
ATTTCTGGTGAATGAT-1-4             Osteoblasts
                                ...         
CGTCCATAGAATTTGG-1-78      Endothelial_cells
GCTTCACAGCGTTGTT-1-78            Hepatocytes
TCTCTGGCAGTCGCAC-1-78                Neurons
CAACAACCAGAGGCTA-1-78                Neurons
CATTGTTGTCGTACAT-1-78      Endothelial_cells
Name: singler_annotation, Length: 118739, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Smooth_muscle_cells', 'Neurons', 'Endothelial_cells', 'Osteoblasts', 'Erythroblast', 'Hepatocytes', 'Astrocyte', 'Platelets', 'Neuroepithelial_cell', 'NK_cell', 'Fibroblasts', 'iPS_cells', 'Embryonic_stem_cells', 'Chondrocytes', 'Macrophage', 'Gametocytes', 'MEP', 'HSC_CD34+', 'Neutrophils', 'Monocyte', 'MSC', 'DC', 'Tissue_stem_cells', 'HSC_-G-CSF', 'T_cells', 'Keratinocytes', 'Unknown', 'Epithelial_cells', 'Myelocyte', 'B_cell', 'BM', 'GMP', 'Pre-B_cell_CD34-', 'Pro-B_cell_CD34+', 'Pro-Myelocyte', 'CMP', 'BM & Prog.']
라벨별 그룹 개수 {2: 3, 1: 3, 0: 3}
🔍 Split #2
  → train_p_index 환자 수 (환자 단위로 묶인 index list): 33
  → test_p_index 환자 수  (환자 단위로 묶인 index list): 9
  → train 환자 ID: ['P1290', 'P1300', 'P1304', 'P1371', 'P1422', 'P1425', 'P1430', 'P1437', 'P1447', 'P1462', 'P1472', 'P1479', 'P1510', 'P1515', 'P1516', 'P1539', 'P1547', 'P1549', 'P1561', 'P1582', 'P1600', 'P1602', 'P1603', 'P1610', 'P1617', 'P1622', 'P1630', 'P1631', 'P1678', 'P1685', 'P1718', 'P1722', 'P1735']
  → test  환자 ID: ['P1358', 'P1504', 'P1508', 'P1540', 'P1558', 'P1606', 'P1702', 'P1707', 'P1726']
  → train 환자 ID 및 라벨:
    ID: P1290, Label: 2
    ID: P1300, Label: 2
    ID: P1304, Label: 2
    ID: P1371, Label: 2
    ID: P1422, Label: 1
    ID: P1425, Label: 1
    ID: P1430, Label: 2
    ID: P1437, Label: 2
    ID: P1447, Label: 1
    ID: P1462, Label: 1
    ID: P1472, Label: 2
    ID: P1479, Label: 1
    ID: P1510, Label: 1
    ID: P1515, Label: 0
    ID: P1516, Label: 0
    ID: P1539, Label: 0
    ID: P1547, Label: 0
    ID: P1549, Label: 0
    ID: P1561, Label: 0
    ID: P1582, Label: 0
    ID: P1600, Label: 0
    ID: P1602, Label: 1
    ID: P1603, Label: 0
    ID: P1610, Label: 0
    ID: P1617, Label: 2
    ID: P1622, Label: 0
    ID: P1630, Label: 1
    ID: P1631, Label: 1
    ID: P1678, Label: 0
    ID: P1685, Label: 1
    ID: P1718, Label: 0
    ID: P1722, Label: 1
    ID: P1735, Label: 1
  → test 환자 ID 및 라벨:
    ID: P1358, Label: 2
    ID: P1504, Label: 2
    ID: P1508, Label: 1
    ID: P1540, Label: 0
    ID: P1558, Label: 0
    ID: P1606, Label: 2
    ID: P1702, Label: 0
    ID: P1707, Label: 1
    ID: P1726, Label: 1
전체 데이터 index 길이 42
label_stat (train 환자 라벨 목록) 갯수 33
train_data에서 환자 단위로, train과 validation 나누기
기존 train_p_index 33
기존 (train) label_stat 33
train-vali 분할 후! 
train y 의 classes : {0, 1, 2} valid y 의 classes : {0, 1, 2} label_stat 의 classes : {0, 1, 2}
train_p_index_ 22
valid_p_index 11
test_p_index 9
→ train 환자 ID 및 라벨:
   총 개수: 22
   환자ID=P1602, Label=1, 셀개수=16580
   환자ID=P1718, Label=0, 셀개수=9278
   환자ID=P1516, Label=0, 셀개수=9361
   환자ID=P1304, Label=2, 셀개수=19123
   환자ID=P1447, Label=1, 셀개수=11151
   환자ID=P1610, Label=0, 셀개수=13919
   환자ID=P1630, Label=1, 셀개수=17633
   환자ID=P1422, Label=1, 셀개수=23315
   환자ID=P1735, Label=1, 셀개수=12009
   환자ID=P1685, Label=1, 셀개수=10043
   환자ID=P1547, Label=0, 셀개수=8253
   환자ID=P1631, Label=1, 셀개수=13686
   환자ID=P1510, Label=1, 셀개수=10744
   환자ID=P1425, Label=1, 셀개수=15378
   환자ID=P1622, Label=0, 셀개수=7210
   환자ID=P1515, Label=0, 셀개수=14502
   환자ID=P1603, Label=0, 셀개수=10638
   환자ID=P1479, Label=1, 셀개수=19124
   환자ID=P1472, Label=2, 셀개수=19513
   환자ID=P1437, Label=2, 셀개수=21695
   환자ID=P1600, Label=0, 셀개수=14882
   환자ID=P1539, Label=0, 셀개수=11076
→ valid 환자 ID 및 라벨:
   총 개수: 11
   환자ID=P1300, Label=2, 셀개수=17318
   환자ID=P1430, Label=2, 셀개수=11131
   환자ID=P1549, Label=0, 셀개수=11709
   환자ID=P1462, Label=1, 셀개수=21715
   환자ID=P1290, Label=2, 셀개수=8357
   환자ID=P1582, Label=0, 셀개수=18855
   환자ID=P1722, Label=1, 셀개수=21432
   환자ID=P1561, Label=0, 셀개수=10016
   환자ID=P1678, Label=0, 셀개수=10085
   환자ID=P1371, Label=2, 셀개수=16233
   환자ID=P1617, Label=2, 셀개수=17986
→ test 환자 ID 및 라벨:
   총 개수: 9
   환자ID=P1358, Label=2, 셀개수=23984
   환자ID=P1504, Label=2, 셀개수=8133
   환자ID=P1508, Label=1, 셀개수=20536
   환자ID=P1540, Label=0, 셀개수=11638
   환자ID=P1558, Label=0, 셀개수=10469
   환자ID=P1606, Label=2, 셀개수=8523
   환자ID=P1702, Label=0, 셀개수=13550
   환자ID=P1707, Label=1, 셀개수=9517
   환자ID=P1726, Label=1, 셀개수=12389
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Astrocyte', 'Smooth_muscle_cells', 'Neurons', 'Neuroepithelial_cell', 'Astrocyte', 'Endothelial_cells', 'Osteoblasts', 'Platelets', 'Neurons', 'Hepatocytes']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
전체 데이터 길이 592689
전체 cell type 길이 0                    Astrocyte
1          Smooth_muscle_cells
2                      Neurons
3         Neuroepithelial_cell
4                    Astrocyte
                  ...         
592684       Endothelial_cells
592685             Hepatocytes
592686                 Neurons
592687                 Neurons
592688       Endothelial_cells
Length: 592689, dtype: string
cell type의 NaN 개수 체크 0
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:12,  7.77it/s]  2%|▏         | 2/100 [00:00<00:12,  7.99it/s]  3%|▎         | 3/100 [00:00<00:11,  8.17it/s]  4%|▍         | 4/100 [00:00<00:11,  8.04it/s]  5%|▌         | 5/100 [00:00<00:11,  8.01it/s]  6%|▌         | 6/100 [00:00<00:11,  7.96it/s]  7%|▋         | 7/100 [00:00<00:12,  7.74it/s]  8%|▊         | 8/100 [00:01<00:12,  7.61it/s]  9%|▉         | 9/100 [00:01<00:12,  7.47it/s] 10%|█         | 10/100 [00:01<00:12,  7.47it/s] 11%|█         | 11/100 [00:01<00:11,  7.60it/s] 12%|█▏        | 12/100 [00:01<00:11,  7.44it/s] 13%|█▎        | 13/100 [00:01<00:11,  7.40it/s] 14%|█▍        | 14/100 [00:01<00:11,  7.43it/s] 15%|█▌        | 15/100 [00:01<00:11,  7.48it/s] 16%|█▌        | 16/100 [00:02<00:11,  7.53it/s] 17%|█▋        | 17/100 [00:02<00:10,  7.58it/s] 18%|█▊        | 18/100 [00:02<00:10,  7.75it/s] 19%|█▉        | 19/100 [00:02<00:10,  7.80it/s] 20%|██        | 20/100 [00:02<00:10,  7.85it/s] 21%|██        | 21/100 [00:02<00:10,  7.70it/s] 22%|██▏       | 22/100 [00:02<00:10,  7.76it/s] 23%|██▎       | 23/100 [00:02<00:10,  7.69it/s] 24%|██▍       | 24/100 [00:03<00:09,  7.68it/s] 25%|██▌       | 25/100 [00:03<00:09,  7.65it/s] 26%|██▌       | 26/100 [00:03<00:09,  7.64it/s] 27%|██▋       | 27/100 [00:03<00:09,  7.55it/s] 28%|██▊       | 28/100 [00:03<00:09,  7.59it/s] 29%|██▉       | 29/100 [00:03<00:09,  7.50it/s] 30%|███       | 30/100 [00:03<00:09,  7.35it/s] 31%|███       | 31/100 [00:04<00:09,  7.27it/s] 32%|███▏      | 32/100 [00:04<00:09,  7.31it/s] 33%|███▎      | 33/100 [00:04<00:09,  7.34it/s] 34%|███▍      | 34/100 [00:04<00:08,  7.42it/s] 35%|███▌      | 35/100 [00:04<00:09,  7.22it/s] 36%|███▌      | 36/100 [00:04<00:08,  7.26it/s] 37%|███▋      | 37/100 [00:04<00:08,  7.21it/s] 38%|███▊      | 38/100 [00:05<00:08,  7.22it/s] 39%|███▉      | 39/100 [00:05<00:08,  7.30it/s] 40%|████      | 40/100 [00:05<00:08,  7.33it/s] 41%|████      | 41/100 [00:05<00:07,  7.38it/s] 42%|████▏     | 42/100 [00:05<00:07,  7.52it/s] 43%|████▎     | 43/100 [00:05<00:07,  7.54it/s] 44%|████▍     | 44/100 [00:05<00:07,  7.54it/s] 45%|████▌     | 45/100 [00:05<00:07,  7.33it/s] 46%|████▌     | 46/100 [00:06<00:07,  7.25it/s] 47%|████▋     | 47/100 [00:06<00:07,  7.22it/s] 48%|████▊     | 48/100 [00:06<00:07,  7.19it/s] 49%|████▉     | 49/100 [00:06<00:07,  7.25it/s] 50%|█████     | 50/100 [00:06<00:07,  7.11it/s] 51%|█████     | 51/100 [00:06<00:06,  7.17it/s] 52%|█████▏    | 52/100 [00:06<00:06,  7.15it/s] 53%|█████▎    | 53/100 [00:07<00:06,  7.14it/s] 54%|█████▍    | 54/100 [00:07<00:06,  7.04it/s] 55%|█████▌    | 55/100 [00:07<00:06,  7.08it/s] 56%|█████▌    | 56/100 [00:07<00:06,  7.13it/s] 57%|█████▋    | 57/100 [00:07<00:06,  7.12it/s] 58%|█████▊    | 58/100 [00:07<00:05,  7.18it/s] 59%|█████▉    | 59/100 [00:07<00:05,  7.12it/s] 60%|██████    | 60/100 [00:08<00:05,  6.98it/s] 61%|██████    | 61/100 [00:08<00:05,  6.95it/s] 62%|██████▏   | 62/100 [00:08<00:05,  7.04it/s] 63%|██████▎   | 63/100 [00:08<00:05,  7.00it/s] 64%|██████▍   | 64/100 [00:08<00:05,  7.04it/s] 65%|██████▌   | 65/100 [00:08<00:05,  6.98it/s] 66%|██████▌   | 66/100 [00:08<00:04,  6.87it/s] 67%|██████▋   | 67/100 [00:09<00:04,  6.73it/s] 68%|██████▊   | 68/100 [00:09<00:04,  6.83it/s] 69%|██████▉   | 69/100 [00:09<00:04,  6.85it/s] 70%|███████   | 70/100 [00:09<00:04,  6.74it/s] 71%|███████   | 71/100 [00:09<00:04,  6.76it/s] 72%|███████▏  | 72/100 [00:09<00:04,  6.81it/s] 73%|███████▎  | 73/100 [00:09<00:03,  6.77it/s] 74%|███████▍  | 74/100 [00:10<00:03,  6.77it/s] 75%|███████▌  | 75/100 [00:10<00:03,  6.78it/s] 76%|███████▌  | 76/100 [00:10<00:03,  6.61it/s] 77%|███████▋  | 77/100 [00:10<00:03,  6.59it/s] 78%|███████▊  | 78/100 [00:10<00:03,  6.60it/s] 79%|███████▉  | 79/100 [00:10<00:03,  6.76it/s] 80%|████████  | 80/100 [00:11<00:02,  6.73it/s] 81%|████████  | 81/100 [00:11<00:02,  6.57it/s] 82%|████████▏ | 82/100 [00:11<00:02,  6.60it/s] 83%|████████▎ | 83/100 [00:11<00:02,  6.55it/s] 84%|████████▍ | 84/100 [00:11<00:02,  6.45it/s] 85%|████████▌ | 85/100 [00:11<00:02,  6.43it/s] 86%|████████▌ | 86/100 [00:11<00:02,  6.46it/s] 87%|████████▋ | 87/100 [00:12<00:02,  6.37it/s] 88%|████████▊ | 88/100 [00:12<00:01,  6.42it/s] 89%|████████▉ | 89/100 [00:12<00:01,  6.43it/s] 90%|█████████ | 90/100 [00:12<00:01,  6.45it/s] 91%|█████████ | 91/100 [00:12<00:01,  6.34it/s] 92%|█████████▏| 92/100 [00:12<00:01,  6.38it/s] 93%|█████████▎| 93/100 [00:13<00:01,  6.45it/s] 94%|█████████▍| 94/100 [00:13<00:00,  6.41it/s] 95%|█████████▌| 95/100 [00:13<00:00,  6.39it/s] 96%|█████████▌| 96/100 [00:13<00:00,  6.39it/s] 97%|█████████▋| 97/100 [00:13<00:00,  6.32it/s] 98%|█████████▊| 98/100 [00:13<00:00,  6.41it/s] 99%|█████████▉| 99/100 [00:14<00:00,  6.44it/s]100%|██████████| 100/100 [00:14<00:00,  6.43it/s]100%|██████████| 100/100 [00:14<00:00,  7.06it/s]
[I 2025-08-29 17:46:36,310] A new study created in memory with name: no-name-41e9e6c0-fab8-4ab3-a167-0883b14e512b
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 18.01 MB
Memory Reserved: 42.00 MB
cuda
CUDA OOM 발생 — 단계적 백오프 시작.
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 16903.99 MB
Memory Reserved: 16924.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 312.97 MB
Memory Reserved: 352.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 16903.99 MB
Memory Reserved: 16924.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 312.55 MB
Memory Reserved: 352.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[I 2025-08-29 17:46:37,908] Trial 0 pruned. Pruned due to OOM after backoff
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 16902.66 MB
Memory Reserved: 16944.00 MB
cuda
Epoch 1, Train Loss 0.886056, Valid_loss 1.411291
Epoch 2, Train Loss 0.818906, Valid_loss 1.403186
Epoch 3, Train Loss 0.773843, Valid_loss 1.374808
Epoch 4, Train Loss 0.696087, Valid_loss 1.074549
Epoch 5, Train Loss 0.503583, Valid_loss 1.025393
Epoch 6, Train Loss 0.365007, Valid_loss 1.048875
Epoch 7, Train Loss 0.388303, Valid_loss 0.977054
Epoch 8, Train Loss 0.305473, Valid_loss 0.959763
Epoch 9, Train Loss 0.332710, Valid_loss 1.000476
Epoch 10, Train Loss 0.280004, Valid_loss 1.041908
Epoch 11, Train Loss 0.254394, Valid_loss 0.899052
Epoch 12, Train Loss 0.273369, Valid_loss 0.916549
Epoch 13, Train Loss 0.235234, Valid_loss 0.889715
Epoch 14, Train Loss 0.248329, Valid_loss 1.032502
Epoch 15, Train Loss 0.198139, Valid_loss 0.863823
Epoch 16, Train Loss 0.189456, Valid_loss 0.842962
Epoch 17, Train Loss 0.222397, Valid_loss 0.895740
Epoch 18, Train Loss 0.217695, Valid_loss 0.810292
Epoch 19, Train Loss 0.192390, Valid_loss 0.812814
Epoch 20, Train Loss 0.190061, Valid_loss 1.051231
Epoch 21, Train Loss 0.158967, Valid_loss 0.773833
Epoch 22, Train Loss 0.188373, Valid_loss 0.805774
Epoch 23, Train Loss 0.128325, Valid_loss 0.741493
Epoch 24, Train Loss 0.152134, Valid_loss 0.866489
Epoch 25, Train Loss 0.153005, Valid_loss 0.760827
Epoch 26, Train Loss 0.134877, Valid_loss 0.677649
Epoch 27, Train Loss 0.127450, Valid_loss 1.027855
Epoch 28, Train Loss 0.200801, Valid_loss 0.651287
Epoch 29, Train Loss 0.124654, Valid_loss 0.628825
Epoch 30, Train Loss 0.100124, Valid_loss 0.852794
Epoch 31, Train Loss 0.316582, Valid_loss 0.947339
Epoch 32, Train Loss 0.100673, Valid_loss 0.730918
Epoch 33, Train Loss 0.153633, Valid_loss 1.177764
Epoch 34, Train Loss 0.128477, Valid_loss 0.549883
Epoch 35, Train Loss 0.125517, Valid_loss 0.699226
Epoch 36, Train Loss 0.167264, Valid_loss 0.824752
Epoch 37, Train Loss 0.088272, Valid_loss 0.844482
Epoch 38, Train Loss 0.070335, Valid_loss 0.669124
Epoch 39, Train Loss 0.099773, Valid_loss 1.213678
Epoch 40, Train Loss 0.081957, Valid_loss 1.049810
Epoch 41, Train Loss 0.103997, Valid_loss 0.598649
Epoch 42, Train Loss 0.109644, Valid_loss 0.972086
Epoch 43, Train Loss 0.053193, Valid_loss 0.815606
Epoch 44, Train Loss 0.041720, Valid_loss 0.904738
Epoch 45, Train Loss 0.071041, Valid_loss 1.695690
Epoch 46, Train Loss 0.048833, Valid_loss 0.459324
Epoch 47, Train Loss 0.167186, Valid_loss 1.036977
Epoch 48, Train Loss 0.082342, Valid_loss 1.144256
Epoch 49, Train Loss 0.039340, Valid_loss 0.411688
Epoch 50, Train Loss 0.042193, Valid_loss 0.417417
Epoch 51, Train Loss 0.027572, Valid_loss 0.728526
Epoch 52, Train Loss 0.026931, Valid_loss 0.662971
Epoch 53, Train Loss 0.022431, Valid_loss 0.643072
Epoch 54, Train Loss 0.020595, Valid_loss 0.856057
Epoch 55, Train Loss 0.019693, Valid_loss 0.672267
Epoch 56, Train Loss 0.018017, Valid_loss 0.851889
Epoch 57, Train Loss 0.017121, Valid_loss 0.834869
Epoch 58, Train Loss 0.017364, Valid_loss 0.740687
Epoch 59, Train Loss 0.017675, Valid_loss 0.888284
Epoch 60, Train Loss 0.020510, Valid_loss 0.873815
Epoch 61, Train Loss 0.058387, Valid_loss 1.174835
Epoch 62, Train Loss 0.045123, Valid_loss 0.725580
Epoch 63, Train Loss 0.016102, Valid_loss 0.774187
Epoch 64, Train Loss 0.015422, Valid_loss 0.606717
Epoch 65, Train Loss 0.013577, Valid_loss 0.898971
Epoch 66, Train Loss 0.013716, Valid_loss 0.645585
Epoch 67, Train Loss 0.012167, Valid_loss 0.837401
Epoch 68, Train Loss 0.011054, Valid_loss 0.855765
[I 2025-08-29 18:22:28,775] Trial 1 finished with value: 0.4116879583505744 and parameters: {'learning_rate': 0.001, 'epochs': 100, 'heads': 2, 'dropout': 0.0, 'weight_decay': 0.0001, 'emb_dim': 8, 'augment_num': 100, 'pca': False}. Best is trial 1 with value: 0.4116879583505744.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 16.69 MB
Memory Reserved: 42.00 MB
cuda
CUDA OOM 발생 — 단계적 백오프 시작.
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 16883.20 MB
Memory Reserved: 16902.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 291.20 MB
Memory Reserved: 312.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 16883.69 MB
Memory Reserved: 16904.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 291.20 MB
Memory Reserved: 312.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[I 2025-08-29 18:22:30,620] Trial 2 pruned. Pruned due to OOM after backoff
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 16883.69 MB
Memory Reserved: 16904.00 MB
cuda
CUDA OOM 발생 — 단계적 백오프 시작.
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 4439.20 MB
Memory Reserved: 4460.00 MB
cuda
Epoch 1, Train Loss 0.941264, Valid_loss 1.416850
Epoch 2, Train Loss 0.860249, Valid_loss 1.545839
Epoch 3, Train Loss 0.865266, Valid_loss 1.550860
Epoch 4, Train Loss 0.777042, Valid_loss 1.473163
Epoch 5, Train Loss 0.762874, Valid_loss 1.543522
Epoch 6, Train Loss 0.705833, Valid_loss 1.586670
Epoch 7, Train Loss 0.709116, Valid_loss 1.625306
Epoch 8, Train Loss 0.718906, Valid_loss 1.650332
Epoch 9, Train Loss 0.619379, Valid_loss 1.714764
Epoch 10, Train Loss 0.602173, Valid_loss 1.763520
Epoch 11, Train Loss 0.581894, Valid_loss 1.773614
Epoch 12, Train Loss 0.597879, Valid_loss 1.750008
Epoch 13, Train Loss 0.611526, Valid_loss 1.698201
Epoch 14, Train Loss 0.550501, Valid_loss 1.695334
Epoch 15, Train Loss 0.514327, Valid_loss 1.815454
Epoch 16, Train Loss 0.587819, Valid_loss 1.801324
Epoch 17, Train Loss 0.553316, Valid_loss 1.836665
Epoch 18, Train Loss 0.599259, Valid_loss 1.788563
Epoch 19, Train Loss 0.565754, Valid_loss 1.791956
Epoch 20, Train Loss 0.528770, Valid_loss 1.821201
Epoch 21, Train Loss 0.481475, Valid_loss 1.850181
Epoch 22, Train Loss 0.473320, Valid_loss 1.780392
Epoch 23, Train Loss 0.523080, Valid_loss 1.301141
Epoch 24, Train Loss 0.521106, Valid_loss 1.303394
Epoch 25, Train Loss 0.470767, Valid_loss 1.304779
Epoch 26, Train Loss 0.430330, Valid_loss 1.299275
Epoch 27, Train Loss 0.596086, Valid_loss 1.312401
Epoch 28, Train Loss 0.519530, Valid_loss 1.314649
Epoch 29, Train Loss 0.461814, Valid_loss 1.307802
Epoch 30, Train Loss 0.431471, Valid_loss 1.304500
Epoch 31, Train Loss 0.401967, Valid_loss 1.321455
Epoch 32, Train Loss 0.476303, Valid_loss 1.318748
Epoch 33, Train Loss 0.453978, Valid_loss 1.311138
Epoch 34, Train Loss 0.482692, Valid_loss 1.305502
Epoch 35, Train Loss 0.486275, Valid_loss 1.320543
Epoch 36, Train Loss 0.488578, Valid_loss 1.294465
Epoch 37, Train Loss 0.517625, Valid_loss 1.299918
Epoch 38, Train Loss 0.500844, Valid_loss 1.299945
Epoch 39, Train Loss 0.424144, Valid_loss 1.322659
Epoch 40, Train Loss 0.451484, Valid_loss 1.345744
Epoch 41, Train Loss 0.447639, Valid_loss 1.361371
Epoch 42, Train Loss 0.451057, Valid_loss 1.333726
Epoch 43, Train Loss 0.378460, Valid_loss 1.357879
Epoch 44, Train Loss 0.407712, Valid_loss 1.390054
Epoch 45, Train Loss 0.486200, Valid_loss 1.344564
Epoch 46, Train Loss 0.583354, Valid_loss 1.344188
Epoch 47, Train Loss 0.508593, Valid_loss 1.316337
Epoch 48, Train Loss 0.422606, Valid_loss 1.345654
Epoch 49, Train Loss 0.453584, Valid_loss 1.341480
Epoch 50, Train Loss 0.411515, Valid_loss 1.366382
Epoch 51, Train Loss 0.410913, Valid_loss 1.375122
Epoch 52, Train Loss 0.431188, Valid_loss 1.377895
[I 2025-08-29 18:42:59,053] Trial 3 finished with value: 1.2944652854718945 and parameters: {'learning_rate': 0.001, 'epochs': 100, 'heads': 1, 'dropout': 0.7, 'weight_decay': 0.001, 'emb_dim': 8, 'augment_num': 100, 'pca': False}. Best is trial 1 with value: 0.4116879583505744.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 4439.20 MB
Memory Reserved: 4460.00 MB
cuda
Epoch 1, Train Loss 0.944876, Valid_loss 1.057053
Epoch 2, Train Loss 0.845705, Valid_loss 0.985578
Epoch 3, Train Loss 0.805071, Valid_loss 0.967887
Epoch 4, Train Loss 0.807609, Valid_loss 0.955519
Epoch 5, Train Loss 0.743023, Valid_loss 0.947634
Epoch 6, Train Loss 0.730860, Valid_loss 0.974658
Epoch 7, Train Loss 0.786704, Valid_loss 0.947173
Epoch 8, Train Loss 0.628864, Valid_loss 0.865162
Epoch 9, Train Loss 0.627382, Valid_loss 0.918827
Epoch 10, Train Loss 0.618028, Valid_loss 0.835658
Epoch 11, Train Loss 0.659392, Valid_loss 1.010187
Epoch 12, Train Loss 0.591369, Valid_loss 0.834616
Epoch 13, Train Loss 0.625156, Valid_loss 0.877948
Epoch 14, Train Loss 0.545766, Valid_loss 0.822893
Epoch 15, Train Loss 0.593727, Valid_loss 0.884392
Epoch 16, Train Loss 0.530078, Valid_loss 0.857311
Epoch 17, Train Loss 0.570657, Valid_loss 0.900225
Epoch 18, Train Loss 0.492879, Valid_loss 0.841725
Epoch 19, Train Loss 0.560654, Valid_loss 0.876083
Epoch 20, Train Loss 0.442092, Valid_loss 0.858694
Epoch 21, Train Loss 0.472866, Valid_loss 0.822861
Epoch 22, Train Loss 0.490486, Valid_loss 0.813739
Epoch 23, Train Loss 0.508558, Valid_loss 0.839271
Epoch 24, Train Loss 0.468841, Valid_loss 0.820503
Epoch 25, Train Loss 0.440665, Valid_loss 0.881074
Epoch 26, Train Loss 0.437620, Valid_loss 0.923673
Epoch 27, Train Loss 0.431593, Valid_loss 0.902855
Epoch 28, Train Loss 0.477960, Valid_loss 0.840849
Epoch 29, Train Loss 0.470102, Valid_loss 0.815848
Epoch 30, Train Loss 0.410934, Valid_loss 0.832337
Epoch 31, Train Loss 0.434685, Valid_loss 0.827101
Epoch 32, Train Loss 0.373123, Valid_loss 0.961209
Epoch 33, Train Loss 0.463013, Valid_loss 0.820664
Epoch 34, Train Loss 0.441907, Valid_loss 0.793973
Epoch 35, Train Loss 0.350790, Valid_loss 0.791518
Epoch 36, Train Loss 0.397497, Valid_loss 0.861246
Epoch 37, Train Loss 0.336156, Valid_loss 0.841482
Epoch 38, Train Loss 0.315149, Valid_loss 0.849685
Epoch 39, Train Loss 0.368783, Valid_loss 0.841390
Epoch 40, Train Loss 0.340034, Valid_loss 0.821440
Epoch 41, Train Loss 0.360017, Valid_loss 0.840023
Epoch 42, Train Loss 0.364436, Valid_loss 0.801840
Epoch 43, Train Loss 0.361628, Valid_loss 0.868789
Epoch 44, Train Loss 0.310206, Valid_loss 0.815778
Epoch 45, Train Loss 0.312474, Valid_loss 0.791511
Epoch 46, Train Loss 0.282882, Valid_loss 0.810010
Epoch 47, Train Loss 0.319881, Valid_loss 0.897884
Epoch 48, Train Loss 0.381749, Valid_loss 0.815587
Epoch 49, Train Loss 0.364243, Valid_loss 0.829498
Epoch 50, Train Loss 0.299057, Valid_loss 0.849576
Epoch 51, Train Loss 0.377203, Valid_loss 0.799911
Epoch 52, Train Loss 0.273328, Valid_loss 0.774509
Epoch 53, Train Loss 0.251854, Valid_loss 0.795852
Epoch 54, Train Loss 0.284659, Valid_loss 0.778392
Epoch 55, Train Loss 0.264036, Valid_loss 0.787748
Epoch 56, Train Loss 0.263890, Valid_loss 0.757240
Epoch 57, Train Loss 0.272795, Valid_loss 0.761784
Epoch 58, Train Loss 0.228338, Valid_loss 0.756361
Epoch 59, Train Loss 0.260035, Valid_loss 0.766075
Epoch 60, Train Loss 0.310848, Valid_loss 0.770766
[I 2025-08-29 19:06:24,741] Trial 4 finished with value: 0.7563613172281872 and parameters: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 1, 'dropout': 0.3, 'weight_decay': 0.001, 'emb_dim': 8, 'augment_num': 100, 'pca': False}. Best is trial 1 with value: 0.4116879583505744.
선택된 trial params: {'learning_rate': 0.001, 'epochs': 100, 'heads': 2, 'dropout': 0.0, 'weight_decay': 0.0001, 'emb_dim': 8, 'augment_num': 100, 'pca': False}
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=9, batch_size=1 -> steps=9
Memory Allocated: 16.69 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.922431, Valid_loss 1.189015
Epoch 2, Train Loss 0.648273, Valid_loss 1.096388
Epoch 3, Train Loss 0.426676, Valid_loss 1.019842
Epoch 4, Train Loss 0.352120, Valid_loss 1.039084
Epoch 5, Train Loss 0.343043, Valid_loss 1.052892
Epoch 6, Train Loss 0.307937, Valid_loss 1.042151
Epoch 7, Train Loss 0.269717, Valid_loss 0.901873
Epoch 8, Train Loss 0.253501, Valid_loss 0.874619
Epoch 9, Train Loss 0.240122, Valid_loss 0.990655
Epoch 10, Train Loss 0.241055, Valid_loss 1.043991
Epoch 11, Train Loss 0.480404, Valid_loss 0.787022
Epoch 12, Train Loss 0.224316, Valid_loss 0.709023
Epoch 13, Train Loss 0.255376, Valid_loss 0.770975
Epoch 14, Train Loss 0.241635, Valid_loss 0.810993
Epoch 15, Train Loss 0.199005, Valid_loss 0.745639
Epoch 16, Train Loss 0.184250, Valid_loss 0.700273
Epoch 17, Train Loss 0.166563, Valid_loss 0.713191
Epoch 18, Train Loss 0.132410, Valid_loss 0.618923
Epoch 19, Train Loss 0.144937, Valid_loss 0.691093
Epoch 20, Train Loss 0.166054, Valid_loss 0.616240
Epoch 21, Train Loss 0.133731, Valid_loss 0.635625
Epoch 22, Train Loss 0.139505, Valid_loss 0.673976
Epoch 23, Train Loss 0.101011, Valid_loss 0.613047
Epoch 24, Train Loss 0.152823, Valid_loss 0.866561
Epoch 25, Train Loss 0.150983, Valid_loss 0.634091
Epoch 26, Train Loss 0.088806, Valid_loss 0.670468
Epoch 27, Train Loss 0.076130, Valid_loss 0.635642
Epoch 28, Train Loss 0.087845, Valid_loss 0.641810
Epoch 29, Train Loss 0.075699, Valid_loss 0.627673
Epoch 30, Train Loss 0.066744, Valid_loss 0.711248
Epoch 31, Train Loss 0.062988, Valid_loss 0.623823
Epoch 32, Train Loss 0.060875, Valid_loss 0.625666
Epoch 33, Train Loss 0.058577, Valid_loss 0.623735
Epoch 34, Train Loss 0.054430, Valid_loss 0.656622
Epoch 35, Train Loss 0.056416, Valid_loss 0.660718
Epoch 36, Train Loss 0.050220, Valid_loss 0.663664
Epoch 37, Train Loss 0.047199, Valid_loss 0.741990
Epoch 38, Train Loss 0.042930, Valid_loss 1.000032
Epoch 39, Train Loss 0.040062, Valid_loss 0.829848
Epoch 40, Train Loss 0.040273, Valid_loss 0.962386
Epoch 41, Train Loss 0.103546, Valid_loss 0.914333
Epoch 42, Train Loss 0.126256, Valid_loss 0.849300
Epoch 43, Train Loss 0.047664, Valid_loss 1.234790
Epoch 44, Train Loss 0.140093, Valid_loss 0.895181
Epoch 45, Train Loss 0.047988, Valid_loss 0.913717
Epoch 46, Train Loss 0.032724, Valid_loss 1.119523
Epoch 47, Train Loss 0.030171, Valid_loss 0.996172
Epoch 48, Train Loss 0.033862, Valid_loss 1.526244
Epoch 49, Train Loss 0.031594, Valid_loss 0.900006
Epoch 50, Train Loss 0.029685, Valid_loss 1.046406
Epoch 51, Train Loss 0.021962, Valid_loss 1.070284
Epoch 52, Train Loss 0.021085, Valid_loss 1.214271
환자ID=P1358 -- true: [[2]] -- pred: tensor([[-2.6639,  0.3236, -0.3006]], device='cuda:0')
환자ID=P1504 -- true: [[2]] -- pred: tensor([[-3.1912,  1.0018,  0.0806]], device='cuda:0')
환자ID=P1508 -- true: [[1]] -- pred: tensor([[-2.9614,  0.5429,  0.0717]], device='cuda:0')
환자ID=P1540 -- true: [[0]] -- pred: tensor([[ 2.3134, -2.0442, -4.1242]], device='cuda:0')
환자ID=P1558 -- true: [[0]] -- pred: tensor([[ 2.3551, -2.0582, -4.1360]], device='cuda:0')
환자ID=P1606 -- true: [[2]] -- pred: tensor([[ 0.3664, -1.3060, -3.0271]], device='cuda:0')
환자ID=P1702 -- true: [[0]] -- pred: tensor([[ 2.3291, -2.0516, -4.1250]], device='cuda:0')
환자ID=P1707 -- true: [[1]] -- pred: tensor([[-3.2434,  0.9968,  0.0980]], device='cuda:0')
환자ID=P1726 -- true: [[1]] -- pred: tensor([[-3.2589,  0.9120,  0.1951]], device='cuda:0')
Best performance: Epoch 23, Loss 0.101011, Test ACC 0.666667, Test AUC 0.796296, Test Recall 0.666667, Test Precision 0.450000
Confusion Matrix:
 [[3 0 0]
 [0 3 0]
 [1 2 0]]
✅ Total valid splits used: 2
🔁 Repeat 2, Fold 2
cell type :  TTCTTCCGTTCAACGT-1-0                Astrocyte
CATCCACCATCTAACG-1-0      Smooth_muscle_cells
ACCCAAACAGCTAACT-1-0                  Neurons
AAGGAATCAACTGGTT-1-0     Neuroepithelial_cell
TACCCGTAGCGTGCTC-1-0                Astrocyte
                                 ...         
TTATTGCGTCGGTGTC-1-79       Endothelial_cells
GTCACGGGTTGTATGC-1-79       Endothelial_cells
GTCATGATCTTTCGAT-1-79       Endothelial_cells
GCGATCGTCAGAGTGG-1-79               Platelets
GCCCGAACAGAGAAAG-1-79       Endothelial_cells
Name: singler_annotation, Length: 480471, dtype: string
cell type annotation :  TTCTTCCGTTCAACGT-1-0                Astrocyte
CATCCACCATCTAACG-1-0      Smooth_muscle_cells
ACCCAAACAGCTAACT-1-0                  Neurons
AAGGAATCAACTGGTT-1-0     Neuroepithelial_cell
TACCCGTAGCGTGCTC-1-0                Astrocyte
                                 ...         
TTATTGCGTCGGTGTC-1-79       Endothelial_cells
GTCACGGGTTGTATGC-1-79       Endothelial_cells
GTCATGATCTTTCGAT-1-79       Endothelial_cells
GCGATCGTCAGAGTGG-1-79               Platelets
GCCCGAACAGAGAAAG-1-79       Endothelial_cells
Name: singler_annotation, Length: 480471, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Astrocyte', 'Smooth_muscle_cells', 'Neurons', 'Neuroepithelial_cell', 'Endothelial_cells', 'Osteoblasts', 'Platelets', 'Hepatocytes', 'Embryonic_stem_cells', 'MEP', 'Erythroblast', 'Fibroblasts', 'iPS_cells', 'MSC', 'Macrophage', 'Gametocytes', 'Chondrocytes', 'NK_cell', 'Neutrophils', 'HSC_CD34+', 'Monocyte', 'Tissue_stem_cells', 'DC', 'HSC_-G-CSF', 'T_cells', 'Epithelial_cells', 'Unknown', 'Pre-B_cell_CD34-', 'GMP', 'B_cell', 'Pro-Myelocyte', 'Keratinocytes', 'Myelocyte', 'BM', 'CMP', 'BM & Prog.', 'Pro-B_cell_CD34+']
라벨별 그룹 개수 {2: 9, 1: 12, 0: 13}
cell type :  CCCTTAGCACCTGATA-1-9               Neurons
TGCAGTAAGTCTAGAA-1-9             Astrocyte
TGTCCCATCAGGACAG-1-9           Fibroblasts
CAGATTGTCCATTCAT-1-9           Fibroblasts
TCTATCACACGCTGAC-1-9     Endothelial_cells
                               ...        
CTACTATGTACGAGCA-1-75    Endothelial_cells
GTCGCGAGTCGTGGTC-1-75    Endothelial_cells
CTGTCGTGTCATCCGG-1-75    Endothelial_cells
CTTTCGGAGACCGCCT-1-75    Endothelial_cells
GTCGTTCAGGCACTAG-1-75    Endothelial_cells
Name: singler_annotation, Length: 112218, dtype: string
cell type annotation :  CCCTTAGCACCTGATA-1-9               Neurons
TGCAGTAAGTCTAGAA-1-9             Astrocyte
TGTCCCATCAGGACAG-1-9           Fibroblasts
CAGATTGTCCATTCAT-1-9           Fibroblasts
TCTATCACACGCTGAC-1-9     Endothelial_cells
                               ...        
CTACTATGTACGAGCA-1-75    Endothelial_cells
GTCGCGAGTCGTGGTC-1-75    Endothelial_cells
CTGTCGTGTCATCCGG-1-75    Endothelial_cells
CTTTCGGAGACCGCCT-1-75    Endothelial_cells
GTCGTTCAGGCACTAG-1-75    Endothelial_cells
Name: singler_annotation, Length: 112218, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Neurons', 'Astrocyte', 'Fibroblasts', 'Endothelial_cells', 'Osteoblasts', 'Smooth_muscle_cells', 'Platelets', 'Neuroepithelial_cell', 'MSC', 'Erythroblast', 'Embryonic_stem_cells', 'Chondrocytes', 'Tissue_stem_cells', 'iPS_cells', 'Gametocytes', 'NK_cell', 'HSC_-G-CSF', 'Hepatocytes', 'Macrophage', 'Neutrophils', 'BM & Prog.', 'Monocyte', 'T_cells', 'HSC_CD34+', 'DC', 'MEP', 'B_cell', 'Myelocyte', 'Unknown', 'Pre-B_cell_CD34-', 'Epithelial_cells', 'BM', 'GMP', 'Pro-B_cell_CD34+', 'CMP', 'Keratinocytes', 'Pro-Myelocyte']
라벨별 그룹 개수 {2: 2, 1: 3, 0: 3}
🔍 Split #3
  → train_p_index 환자 수 (환자 단위로 묶인 index list): 34
  → test_p_index 환자 수  (환자 단위로 묶인 index list): 8
  → train 환자 ID: ['P1290', 'P1304', 'P1358', 'P1371', 'P1422', 'P1430', 'P1437', 'P1447', 'P1462', 'P1479', 'P1504', 'P1508', 'P1510', 'P1515', 'P1540', 'P1549', 'P1558', 'P1561', 'P1582', 'P1600', 'P1602', 'P1603', 'P1606', 'P1610', 'P1617', 'P1622', 'P1678', 'P1685', 'P1702', 'P1707', 'P1718', 'P1722', 'P1726', 'P1735']
  → test  환자 ID: ['P1300', 'P1425', 'P1472', 'P1516', 'P1539', 'P1547', 'P1630', 'P1631']
  → train 환자 ID 및 라벨:
    ID: P1290, Label: 2
    ID: P1304, Label: 2
    ID: P1358, Label: 2
    ID: P1371, Label: 2
    ID: P1422, Label: 1
    ID: P1430, Label: 2
    ID: P1437, Label: 2
    ID: P1447, Label: 1
    ID: P1462, Label: 1
    ID: P1479, Label: 1
    ID: P1504, Label: 2
    ID: P1508, Label: 1
    ID: P1510, Label: 1
    ID: P1515, Label: 0
    ID: P1540, Label: 0
    ID: P1549, Label: 0
    ID: P1558, Label: 0
    ID: P1561, Label: 0
    ID: P1582, Label: 0
    ID: P1600, Label: 0
    ID: P1602, Label: 1
    ID: P1603, Label: 0
    ID: P1606, Label: 2
    ID: P1610, Label: 0
    ID: P1617, Label: 2
    ID: P1622, Label: 0
    ID: P1678, Label: 0
    ID: P1685, Label: 1
    ID: P1702, Label: 0
    ID: P1707, Label: 1
    ID: P1718, Label: 0
    ID: P1722, Label: 1
    ID: P1726, Label: 1
    ID: P1735, Label: 1
  → test 환자 ID 및 라벨:
    ID: P1300, Label: 2
    ID: P1425, Label: 1
    ID: P1472, Label: 2
    ID: P1516, Label: 0
    ID: P1539, Label: 0
    ID: P1547, Label: 0
    ID: P1630, Label: 1
    ID: P1631, Label: 1
전체 데이터 index 길이 42
label_stat (train 환자 라벨 목록) 갯수 34
train_data에서 환자 단위로, train과 validation 나누기
기존 train_p_index 34
기존 (train) label_stat 34
train-vali 분할 후! 
train y 의 classes : {0, 1, 2} valid y 의 classes : {0, 1, 2} label_stat 의 classes : {0, 1, 2}
train_p_index_ 22
valid_p_index 12
test_p_index 8
→ train 환자 ID 및 라벨:
   총 개수: 22
   환자ID=P1722, Label=1, 셀개수=21432
   환자ID=P1540, Label=0, 셀개수=11638
   환자ID=P1358, Label=2, 셀개수=23984
   환자ID=P1462, Label=1, 셀개수=21715
   환자ID=P1610, Label=0, 셀개수=13919
   환자ID=P1685, Label=1, 셀개수=10043
   환자ID=P1422, Label=1, 셀개수=23315
   환자ID=P1735, Label=1, 셀개수=12009
   환자ID=P1718, Label=0, 셀개수=9278
   환자ID=P1558, Label=0, 셀개수=10469
   환자ID=P1702, Label=0, 셀개수=13550
   환자ID=P1510, Label=1, 셀개수=10744
   환자ID=P1430, Label=2, 셀개수=11131
   환자ID=P1678, Label=0, 셀개수=10085
   환자ID=P1622, Label=0, 셀개수=7210
   환자ID=P1515, Label=0, 셀개수=14502
   환자ID=P1606, Label=2, 셀개수=8523
   환자ID=P1508, Label=1, 셀개수=20536
   환자ID=P1504, Label=2, 셀개수=8133
   환자ID=P1447, Label=1, 셀개수=11151
   환자ID=P1602, Label=1, 셀개수=16580
   환자ID=P1549, Label=0, 셀개수=11709
→ valid 환자 ID 및 라벨:
   총 개수: 12
   환자ID=P1304, Label=2, 셀개수=19123
   환자ID=P1437, Label=2, 셀개수=21695
   환자ID=P1561, Label=0, 셀개수=10016
   환자ID=P1479, Label=1, 셀개수=19124
   환자ID=P1290, Label=2, 셀개수=8357
   환자ID=P1600, Label=0, 셀개수=14882
   환자ID=P1726, Label=1, 셀개수=12389
   환자ID=P1582, Label=0, 셀개수=18855
   환자ID=P1707, Label=1, 셀개수=9517
   환자ID=P1371, Label=2, 셀개수=16233
   환자ID=P1617, Label=2, 셀개수=17986
   환자ID=P1603, Label=0, 셀개수=10638
→ test 환자 ID 및 라벨:
   총 개수: 8
   환자ID=P1300, Label=2, 셀개수=17318
   환자ID=P1425, Label=1, 셀개수=15378
   환자ID=P1472, Label=2, 셀개수=19513
   환자ID=P1516, Label=0, 셀개수=9361
   환자ID=P1539, Label=0, 셀개수=11076
   환자ID=P1547, Label=0, 셀개수=8253
   환자ID=P1630, Label=1, 셀개수=17633
   환자ID=P1631, Label=1, 셀개수=13686
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Astrocyte', 'Smooth_muscle_cells', 'Neurons', 'Neuroepithelial_cell', 'Astrocyte', 'Endothelial_cells', 'Osteoblasts', 'Platelets', 'Neurons', 'Hepatocytes']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
전체 데이터 길이 592689
전체 cell type 길이 0                    Astrocyte
1          Smooth_muscle_cells
2                      Neurons
3         Neuroepithelial_cell
4                    Astrocyte
                  ...         
592684       Endothelial_cells
592685       Endothelial_cells
592686       Endothelial_cells
592687       Endothelial_cells
592688       Endothelial_cells
Length: 592689, dtype: string
cell type의 NaN 개수 체크 0
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:13,  7.36it/s]  2%|▏         | 2/100 [00:00<00:12,  7.89it/s]  3%|▎         | 3/100 [00:00<00:12,  7.98it/s]  4%|▍         | 4/100 [00:00<00:12,  7.89it/s]  5%|▌         | 5/100 [00:00<00:11,  7.99it/s]  6%|▌         | 6/100 [00:00<00:11,  8.04it/s]  7%|▋         | 7/100 [00:00<00:11,  7.96it/s]  8%|▊         | 8/100 [00:01<00:11,  8.05it/s]  9%|▉         | 9/100 [00:01<00:11,  7.84it/s] 10%|█         | 10/100 [00:01<00:11,  7.71it/s] 11%|█         | 11/100 [00:01<00:11,  7.63it/s] 12%|█▏        | 12/100 [00:01<00:11,  7.69it/s] 13%|█▎        | 13/100 [00:01<00:11,  7.55it/s] 14%|█▍        | 14/100 [00:01<00:11,  7.48it/s] 15%|█▌        | 15/100 [00:01<00:11,  7.34it/s] 16%|█▌        | 16/100 [00:02<00:11,  7.46it/s] 17%|█▋        | 17/100 [00:02<00:11,  7.31it/s] 18%|█▊        | 18/100 [00:02<00:11,  7.26it/s] 19%|█▉        | 19/100 [00:02<00:11,  7.28it/s] 20%|██        | 20/100 [00:02<00:10,  7.35it/s] 21%|██        | 21/100 [00:02<00:10,  7.42it/s] 22%|██▏       | 22/100 [00:02<00:10,  7.39it/s] 23%|██▎       | 23/100 [00:03<00:10,  7.41it/s] 24%|██▍       | 24/100 [00:03<00:10,  7.38it/s] 25%|██▌       | 25/100 [00:03<00:10,  7.28it/s] 26%|██▌       | 26/100 [00:03<00:10,  7.31it/s] 27%|██▋       | 27/100 [00:03<00:10,  7.30it/s] 28%|██▊       | 28/100 [00:03<00:09,  7.32it/s] 29%|██▉       | 29/100 [00:03<00:09,  7.23it/s] 30%|███       | 30/100 [00:04<00:09,  7.07it/s] 31%|███       | 31/100 [00:04<00:09,  7.19it/s] 32%|███▏      | 32/100 [00:04<00:09,  7.16it/s] 33%|███▎      | 33/100 [00:04<00:09,  7.18it/s] 34%|███▍      | 34/100 [00:04<00:09,  7.31it/s] 35%|███▌      | 35/100 [00:04<00:09,  7.18it/s] 36%|███▌      | 36/100 [00:04<00:08,  7.13it/s] 37%|███▋      | 37/100 [00:04<00:08,  7.06it/s] 38%|███▊      | 38/100 [00:05<00:08,  7.08it/s] 39%|███▉      | 39/100 [00:05<00:08,  7.18it/s] 40%|████      | 40/100 [00:05<00:08,  7.36it/s] 41%|████      | 41/100 [00:05<00:08,  7.24it/s] 42%|████▏     | 42/100 [00:05<00:07,  7.36it/s] 43%|████▎     | 43/100 [00:05<00:07,  7.49it/s] 44%|████▍     | 44/100 [00:05<00:07,  7.25it/s] 45%|████▌     | 45/100 [00:06<00:07,  7.23it/s] 46%|████▌     | 46/100 [00:06<00:07,  7.34it/s] 47%|████▋     | 47/100 [00:06<00:07,  7.23it/s] 48%|████▊     | 48/100 [00:06<00:07,  7.21it/s] 49%|████▉     | 49/100 [00:06<00:07,  7.11it/s] 50%|█████     | 50/100 [00:06<00:06,  7.20it/s] 51%|█████     | 51/100 [00:06<00:06,  7.24it/s] 52%|█████▏    | 52/100 [00:07<00:06,  7.19it/s] 53%|█████▎    | 53/100 [00:07<00:06,  7.09it/s] 54%|█████▍    | 54/100 [00:07<00:06,  7.10it/s] 55%|█████▌    | 55/100 [00:07<00:06,  7.20it/s] 56%|█████▌    | 56/100 [00:07<00:06,  7.17it/s] 57%|█████▋    | 57/100 [00:07<00:06,  7.15it/s] 58%|█████▊    | 58/100 [00:07<00:05,  7.12it/s] 59%|█████▉    | 59/100 [00:08<00:05,  7.09it/s] 60%|██████    | 60/100 [00:08<00:05,  7.08it/s] 61%|██████    | 61/100 [00:08<00:05,  7.05it/s] 62%|██████▏   | 62/100 [00:08<00:05,  7.13it/s] 63%|██████▎   | 63/100 [00:08<00:05,  7.14it/s] 64%|██████▍   | 64/100 [00:08<00:05,  7.00it/s] 65%|██████▌   | 65/100 [00:08<00:05,  6.99it/s] 66%|██████▌   | 66/100 [00:09<00:04,  6.93it/s] 67%|██████▋   | 67/100 [00:09<00:04,  6.86it/s] 68%|██████▊   | 68/100 [00:09<00:04,  6.71it/s] 69%|██████▉   | 69/100 [00:09<00:04,  6.81it/s] 70%|███████   | 70/100 [00:09<00:04,  6.98it/s] 71%|███████   | 71/100 [00:09<00:04,  7.02it/s] 72%|███████▏  | 72/100 [00:09<00:03,  7.01it/s] 73%|███████▎  | 73/100 [00:10<00:03,  6.94it/s] 74%|███████▍  | 74/100 [00:10<00:03,  6.95it/s] 75%|███████▌  | 75/100 [00:10<00:03,  6.97it/s] 76%|███████▌  | 76/100 [00:10<00:03,  6.91it/s] 77%|███████▋  | 77/100 [00:10<00:03,  6.97it/s] 78%|███████▊  | 78/100 [00:10<00:03,  6.97it/s] 79%|███████▉  | 79/100 [00:10<00:03,  6.96it/s] 80%|████████  | 80/100 [00:11<00:02,  6.95it/s] 81%|████████  | 81/100 [00:11<00:02,  6.89it/s] 82%|████████▏ | 82/100 [00:11<00:02,  6.80it/s] 83%|████████▎ | 83/100 [00:11<00:02,  6.66it/s] 84%|████████▍ | 84/100 [00:11<00:02,  6.66it/s] 85%|████████▌ | 85/100 [00:11<00:02,  6.63it/s] 86%|████████▌ | 86/100 [00:11<00:02,  6.66it/s] 87%|████████▋ | 87/100 [00:12<00:01,  6.60it/s] 88%|████████▊ | 88/100 [00:12<00:01,  6.55it/s] 89%|████████▉ | 89/100 [00:12<00:01,  6.57it/s] 90%|█████████ | 90/100 [00:12<00:01,  6.65it/s] 91%|█████████ | 91/100 [00:12<00:01,  6.61it/s] 92%|█████████▏| 92/100 [00:12<00:01,  6.70it/s] 93%|█████████▎| 93/100 [00:13<00:01,  6.65it/s] 94%|█████████▍| 94/100 [00:13<00:00,  6.73it/s] 95%|█████████▌| 95/100 [00:13<00:00,  6.75it/s] 96%|█████████▌| 96/100 [00:13<00:00,  6.83it/s] 97%|█████████▋| 97/100 [00:13<00:00,  6.82it/s] 98%|█████████▊| 98/100 [00:13<00:00,  6.64it/s] 99%|█████████▉| 99/100 [00:13<00:00,  6.50it/s]100%|██████████| 100/100 [00:14<00:00,  6.45it/s]100%|██████████| 100/100 [00:14<00:00,  7.10it/s]
[I 2025-08-29 19:34:33,376] A new study created in memory with name: no-name-edf4648e-a49b-4fbc-baa8-4b3885801dfc
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 16.69 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.971349, Valid_loss 1.321874
Epoch 2, Train Loss 0.959520, Valid_loss 1.388646
Epoch 3, Train Loss 0.984279, Valid_loss 1.382879
Epoch 4, Train Loss 0.966968, Valid_loss 1.362472
Epoch 5, Train Loss 0.964417, Valid_loss 1.343614
Epoch 6, Train Loss 0.879858, Valid_loss 1.442479
Epoch 7, Train Loss 0.928091, Valid_loss 1.403591
Epoch 8, Train Loss 0.916250, Valid_loss 1.414093
Epoch 9, Train Loss 0.902462, Valid_loss 1.441340
Epoch 10, Train Loss 0.911500, Valid_loss 1.385925
Epoch 11, Train Loss 0.877546, Valid_loss 1.417685
Epoch 12, Train Loss 0.913071, Valid_loss 1.419872
Epoch 13, Train Loss 0.922308, Valid_loss 1.435485
Epoch 14, Train Loss 0.897587, Valid_loss 1.450264
Epoch 15, Train Loss 0.900954, Valid_loss 1.466104
Epoch 16, Train Loss 0.916154, Valid_loss 1.445747
Epoch 17, Train Loss 0.897895, Valid_loss 1.436623
Epoch 18, Train Loss 0.892948, Valid_loss 1.448366
Epoch 19, Train Loss 0.884794, Valid_loss 1.563418
Epoch 20, Train Loss 0.879160, Valid_loss 1.470552
Epoch 21, Train Loss 0.882260, Valid_loss 1.529869
Epoch 22, Train Loss 0.911034, Valid_loss 1.554680
Epoch 23, Train Loss 0.914851, Valid_loss 1.467557
Epoch 24, Train Loss 0.910452, Valid_loss 1.453456
Epoch 25, Train Loss 0.891672, Valid_loss 1.461691
Epoch 26, Train Loss 0.847788, Valid_loss 1.481907
Epoch 27, Train Loss 0.893069, Valid_loss 1.470715
Epoch 28, Train Loss 0.874326, Valid_loss 1.497806
Epoch 29, Train Loss 0.883614, Valid_loss 1.517995
Epoch 30, Train Loss 0.892160, Valid_loss 1.449535
Epoch 31, Train Loss 0.903829, Valid_loss 1.505840
Epoch 32, Train Loss 0.910248, Valid_loss 1.434391
Epoch 33, Train Loss 0.870018, Valid_loss 1.438278
Epoch 34, Train Loss 0.908221, Valid_loss 1.432750
Epoch 35, Train Loss 0.885093, Valid_loss 1.430128
Epoch 36, Train Loss 0.877688, Valid_loss 1.450952
Epoch 37, Train Loss 0.884821, Valid_loss 1.531445
Epoch 38, Train Loss 0.863047, Valid_loss 1.487857
Epoch 39, Train Loss 0.875813, Valid_loss 1.468218
Epoch 40, Train Loss 0.893839, Valid_loss 1.457178
Epoch 41, Train Loss 0.892715, Valid_loss 1.458237
Epoch 42, Train Loss 0.876872, Valid_loss 1.466456
Epoch 43, Train Loss 0.885905, Valid_loss 1.474107
Epoch 44, Train Loss 0.871323, Valid_loss 1.488056
Epoch 45, Train Loss 0.885194, Valid_loss 1.464795
Epoch 46, Train Loss 0.886108, Valid_loss 1.458788
Epoch 47, Train Loss 0.876203, Valid_loss 1.476513
Epoch 48, Train Loss 0.883898, Valid_loss 1.461541
Epoch 49, Train Loss 0.884856, Valid_loss 1.453866
Epoch 50, Train Loss 0.881346, Valid_loss 1.457441
Epoch 51, Train Loss 0.877443, Valid_loss 1.459022
Epoch 52, Train Loss 0.875970, Valid_loss 1.462040
[I 2025-08-29 19:55:44,400] Trial 0 finished with value: 1.3218742907047272 and parameters: {'learning_rate': 0.001, 'epochs': 100, 'heads': 1, 'dropout': 0.7, 'weight_decay': 0.01, 'emb_dim': 8, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 1.3218742907047272.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 18.01 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.985691, Valid_loss 1.519479
Epoch 2, Train Loss 0.925174, Valid_loss 1.435750
Epoch 3, Train Loss 0.802547, Valid_loss 1.131232
Epoch 4, Train Loss 0.855354, Valid_loss 1.322607
Epoch 5, Train Loss 0.770803, Valid_loss 1.340912
Epoch 6, Train Loss 0.519672, Valid_loss 1.118173
Epoch 7, Train Loss 0.528401, Valid_loss 1.167522
Epoch 8, Train Loss 0.515039, Valid_loss 0.929277
Epoch 9, Train Loss 0.444076, Valid_loss 0.878530
Epoch 10, Train Loss 0.620853, Valid_loss 0.931383
Epoch 11, Train Loss 0.443296, Valid_loss 0.906526
Epoch 12, Train Loss 0.541165, Valid_loss 0.942324
Epoch 13, Train Loss 0.343751, Valid_loss 1.381352
Epoch 14, Train Loss 0.831338, Valid_loss 1.356110
Epoch 15, Train Loss 0.924733, Valid_loss 1.415007
Epoch 16, Train Loss 0.615494, Valid_loss 0.990297
Epoch 17, Train Loss 0.471385, Valid_loss 1.053798
Epoch 18, Train Loss 0.602828, Valid_loss 1.435216
Epoch 19, Train Loss 0.559797, Valid_loss 0.965317
Epoch 20, Train Loss 0.396293, Valid_loss 1.019274
Epoch 21, Train Loss 0.437135, Valid_loss 1.022423
Epoch 22, Train Loss 0.338320, Valid_loss 0.962446
Epoch 23, Train Loss 0.325424, Valid_loss 0.904164
Epoch 24, Train Loss 0.264028, Valid_loss 1.338113
Epoch 25, Train Loss 0.371726, Valid_loss 0.917606
Epoch 26, Train Loss 0.446787, Valid_loss 0.954121
Epoch 27, Train Loss 0.325978, Valid_loss 0.975586
Epoch 28, Train Loss 0.380116, Valid_loss 0.899688
Epoch 29, Train Loss 0.309191, Valid_loss 1.017235
Epoch 30, Train Loss 0.435236, Valid_loss 0.876592
Epoch 31, Train Loss 0.342226, Valid_loss 0.828083
Epoch 32, Train Loss 0.247003, Valid_loss 0.862481
Epoch 33, Train Loss 0.295854, Valid_loss 0.848215
Epoch 34, Train Loss 0.220586, Valid_loss 0.991824
Epoch 35, Train Loss 0.313126, Valid_loss 0.771462
Epoch 36, Train Loss 0.390467, Valid_loss 0.787729
Epoch 37, Train Loss 0.300552, Valid_loss 0.848677
Epoch 38, Train Loss 0.250800, Valid_loss 0.777306
Epoch 39, Train Loss 0.248694, Valid_loss 0.784654
Epoch 40, Train Loss 0.245816, Valid_loss 0.779174
Epoch 41, Train Loss 0.259169, Valid_loss 0.829370
Epoch 42, Train Loss 0.206564, Valid_loss 0.749199
Epoch 43, Train Loss 0.233416, Valid_loss 0.885751
Epoch 44, Train Loss 0.213008, Valid_loss 0.769805
Epoch 45, Train Loss 0.172374, Valid_loss 0.750118
Epoch 46, Train Loss 0.222434, Valid_loss 0.640438
Epoch 47, Train Loss 0.326087, Valid_loss 0.676171
Epoch 48, Train Loss 0.235910, Valid_loss 0.675552
Epoch 49, Train Loss 0.219897, Valid_loss 0.939250
Epoch 50, Train Loss 0.166185, Valid_loss 0.600973
Epoch 51, Train Loss 0.157328, Valid_loss 0.627034
Epoch 52, Train Loss 0.145764, Valid_loss 0.628278
[I 2025-08-29 20:26:36,320] Trial 1 finished with value: 0.6009728266738724 and parameters: {'learning_rate': 0.001, 'epochs': 100, 'heads': 2, 'dropout': 0.5, 'weight_decay': 0.0001, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 1 with value: 0.6009728266738724.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 19.85 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.870099, Valid_loss 1.296441
Epoch 2, Train Loss 0.573261, Valid_loss 1.135625
Epoch 3, Train Loss 0.540117, Valid_loss 1.474011
Epoch 4, Train Loss 0.428706, Valid_loss 1.237462
Epoch 5, Train Loss 0.404142, Valid_loss 1.039121
Epoch 6, Train Loss 0.376318, Valid_loss 1.059535
Epoch 7, Train Loss 0.406675, Valid_loss 1.440573
Epoch 8, Train Loss 0.353972, Valid_loss 1.080968
Epoch 9, Train Loss 0.334562, Valid_loss 1.101998
Epoch 10, Train Loss 0.309823, Valid_loss 0.875313
Epoch 11, Train Loss 0.311007, Valid_loss 1.111624
Epoch 12, Train Loss 0.318474, Valid_loss 1.211161
Epoch 13, Train Loss 0.375578, Valid_loss 0.976680
Epoch 14, Train Loss 0.271328, Valid_loss 1.153686
Epoch 15, Train Loss 0.263056, Valid_loss 1.273236
Epoch 16, Train Loss 0.271072, Valid_loss 0.758315
Epoch 17, Train Loss 0.281494, Valid_loss 0.830860
Epoch 18, Train Loss 0.278996, Valid_loss 1.380597
Epoch 19, Train Loss 0.259736, Valid_loss 0.891054
Epoch 20, Train Loss 0.284382, Valid_loss 0.705362
Epoch 21, Train Loss 0.247617, Valid_loss 0.975113
Epoch 22, Train Loss 0.232752, Valid_loss 1.501798
Epoch 23, Train Loss 0.259435, Valid_loss 1.071405
Epoch 24, Train Loss 0.233062, Valid_loss 1.123318
Epoch 25, Train Loss 0.235929, Valid_loss 0.804401
Epoch 26, Train Loss 0.226051, Valid_loss 0.734043
Epoch 27, Train Loss 0.216072, Valid_loss 1.236109
Epoch 28, Train Loss 0.210572, Valid_loss 0.896888
Epoch 29, Train Loss 0.231501, Valid_loss 1.256325
Epoch 30, Train Loss 0.294394, Valid_loss 0.973598
Epoch 31, Train Loss 0.190432, Valid_loss 0.829777
Epoch 32, Train Loss 0.253591, Valid_loss 0.856935
Epoch 33, Train Loss 0.183134, Valid_loss 0.838041
Epoch 34, Train Loss 0.185412, Valid_loss 0.813539
Epoch 35, Train Loss 0.232883, Valid_loss 1.295193
Epoch 36, Train Loss 0.177734, Valid_loss 1.266540
Epoch 37, Train Loss 0.184613, Valid_loss 1.395030
Epoch 38, Train Loss 0.194531, Valid_loss 0.908125
Epoch 39, Train Loss 0.184215, Valid_loss 0.503181
Epoch 40, Train Loss 0.196989, Valid_loss 0.993150
Epoch 41, Train Loss 0.228673, Valid_loss 1.045571
Epoch 42, Train Loss 0.151372, Valid_loss 1.029003
Epoch 43, Train Loss 0.198607, Valid_loss 1.329037
Epoch 44, Train Loss 0.222573, Valid_loss 0.670739
Epoch 45, Train Loss 0.137420, Valid_loss 0.852684
Epoch 46, Train Loss 0.249126, Valid_loss 0.903596
Epoch 47, Train Loss 0.207060, Valid_loss 0.888724
Epoch 48, Train Loss 0.159829, Valid_loss 0.628041
Epoch 49, Train Loss 0.128819, Valid_loss 1.182773
Epoch 50, Train Loss 0.243755, Valid_loss 0.631360
Epoch 51, Train Loss 0.145333, Valid_loss 0.675465
Epoch 52, Train Loss 0.145222, Valid_loss 0.953960
[I 2025-08-29 20:55:07,125] Trial 2 finished with value: 0.5031812251545489 and parameters: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 2, 'dropout': 0.0, 'weight_decay': 0.01, 'emb_dim': 64, 'augment_num': 100, 'pca': False}. Best is trial 2 with value: 0.5031812251545489.
선택된 trial params: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 2, 'dropout': 0.0, 'weight_decay': 0.01, 'emb_dim': 64, 'augment_num': 100, 'pca': False}
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=8, batch_size=1 -> steps=8
Memory Allocated: 19.85 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.888139, Valid_loss 1.431587
Epoch 2, Train Loss 0.609844, Valid_loss 0.827939
Epoch 3, Train Loss 0.453971, Valid_loss 1.178420
Epoch 4, Train Loss 0.437734, Valid_loss 0.861426
Epoch 5, Train Loss 0.371242, Valid_loss 0.936077
Epoch 6, Train Loss 0.378643, Valid_loss 0.784087
Epoch 7, Train Loss 0.387677, Valid_loss 0.892818
Epoch 8, Train Loss 0.331975, Valid_loss 1.108283
Epoch 9, Train Loss 0.305479, Valid_loss 1.448528
Epoch 10, Train Loss 0.444775, Valid_loss 1.086202
Epoch 11, Train Loss 0.304471, Valid_loss 0.773429
Epoch 12, Train Loss 0.335735, Valid_loss 1.219751
Epoch 13, Train Loss 0.234203, Valid_loss 0.729205
Epoch 14, Train Loss 0.329217, Valid_loss 0.873201
Epoch 15, Train Loss 0.258826, Valid_loss 0.828106
Epoch 16, Train Loss 0.247912, Valid_loss 0.851815
Epoch 17, Train Loss 0.255606, Valid_loss 0.690446
Epoch 18, Train Loss 0.228843, Valid_loss 0.693047
Epoch 19, Train Loss 0.294891, Valid_loss 1.313241
Epoch 20, Train Loss 0.264531, Valid_loss 0.908826
Epoch 21, Train Loss 0.220951, Valid_loss 0.878711
Epoch 22, Train Loss 0.225227, Valid_loss 0.709703
Epoch 23, Train Loss 0.244454, Valid_loss 1.229756
Epoch 24, Train Loss 0.221475, Valid_loss 0.947428
Epoch 25, Train Loss 0.211653, Valid_loss 0.695963
Epoch 26, Train Loss 0.214404, Valid_loss 1.021370
Epoch 27, Train Loss 0.240496, Valid_loss 0.800392
Epoch 28, Train Loss 0.195345, Valid_loss 1.037116
Epoch 29, Train Loss 0.291799, Valid_loss 0.684522
Epoch 30, Train Loss 0.199841, Valid_loss 0.655644
Epoch 31, Train Loss 0.183308, Valid_loss 0.694926
Epoch 32, Train Loss 0.215908, Valid_loss 0.984151
Epoch 33, Train Loss 0.172067, Valid_loss 0.708998
Epoch 34, Train Loss 0.192235, Valid_loss 0.752166
Epoch 35, Train Loss 0.197495, Valid_loss 0.819977
Epoch 36, Train Loss 0.175860, Valid_loss 0.677874
Epoch 37, Train Loss 0.165188, Valid_loss 0.856122
Epoch 38, Train Loss 0.198955, Valid_loss 0.768586
Epoch 39, Train Loss 0.166057, Valid_loss 0.745575
Epoch 40, Train Loss 0.185153, Valid_loss 0.748464
Epoch 41, Train Loss 0.238477, Valid_loss 0.508617
Epoch 42, Train Loss 0.150624, Valid_loss 0.746247
Epoch 43, Train Loss 0.170675, Valid_loss 0.626178
Epoch 44, Train Loss 0.184471, Valid_loss 0.563305
Epoch 45, Train Loss 0.166673, Valid_loss 0.607004
Epoch 46, Train Loss 0.227508, Valid_loss 0.615084
Epoch 47, Train Loss 0.145122, Valid_loss 0.782648
Epoch 48, Train Loss 0.171678, Valid_loss 0.591738
Epoch 49, Train Loss 0.175606, Valid_loss 0.677166
Epoch 50, Train Loss 0.154876, Valid_loss 0.646906
Epoch 51, Train Loss 0.133150, Valid_loss 0.607636
Epoch 52, Train Loss 0.135024, Valid_loss 0.583394
Epoch 53, Train Loss 0.115859, Valid_loss 0.569739
Epoch 54, Train Loss 0.119545, Valid_loss 0.551204
Epoch 55, Train Loss 0.130295, Valid_loss 0.709617
Epoch 56, Train Loss 0.134021, Valid_loss 0.569272
Epoch 57, Train Loss 0.123961, Valid_loss 0.766617
Epoch 58, Train Loss 0.111640, Valid_loss 0.462266
Epoch 59, Train Loss 0.124600, Valid_loss 0.727786
Epoch 60, Train Loss 0.122750, Valid_loss 0.568116
Epoch 61, Train Loss 0.147479, Valid_loss 0.640317
Epoch 62, Train Loss 0.114650, Valid_loss 0.727250
환자ID=P1300 -- true: [[2]] -- pred: tensor([[-2.1367,  1.3481,  0.6400]], device='cuda:0')
환자ID=P1425 -- true: [[1]] -- pred: tensor([[-2.0641,  0.9985,  1.0191]], device='cuda:0')
환자ID=P1472 -- true: [[2]] -- pred: tensor([[-2.1510,  0.9976,  1.1723]], device='cuda:0')
환자ID=P1516 -- true: [[0]] -- pred: tensor([[ 3.0277, -1.6958, -3.4288]], device='cuda:0')
환자ID=P1539 -- true: [[0]] -- pred: tensor([[ 3.1376, -1.9223, -3.3352]], device='cuda:0')
환자ID=P1547 -- true: [[0]] -- pred: tensor([[ 2.9713, -1.7027, -3.2999]], device='cuda:0')
환자ID=P1630 -- true: [[1]] -- pred: tensor([[-2.1546,  1.2391,  0.7715]], device='cuda:0')
환자ID=P1631 -- true: [[1]] -- pred: tensor([[-2.0810,  1.6440,  0.2219]], device='cuda:0')
Best performance: Epoch 58, Loss 0.111640, Test ACC 0.750000, Test AUC 0.888889, Test Recall 0.722222, Test Precision 0.722222
Confusion Matrix:
 [[3 0 0]
 [0 2 1]
 [0 1 1]]
✅ Total valid splits used: 3
🔁 Repeat 2, Fold 3
cell type :  CTGCTCAAGGCATCAG-1-3             Osteoblasts
TCATACTAGACTTCCA-1-3     Smooth_muscle_cells
GAGCCTGGTCGAGATG-1-3            Erythroblast
CTTACCGCAGAACTCT-1-3             Osteoblasts
TTGACCCCATCTAACG-1-3     Smooth_muscle_cells
                                ...         
TTATTGCGTCGGTGTC-1-79      Endothelial_cells
GTCACGGGTTGTATGC-1-79      Endothelial_cells
GTCATGATCTTTCGAT-1-79      Endothelial_cells
GCGATCGTCAGAGTGG-1-79              Platelets
GCCCGAACAGAGAAAG-1-79      Endothelial_cells
Name: singler_annotation, Length: 465304, dtype: string
cell type annotation :  CTGCTCAAGGCATCAG-1-3             Osteoblasts
TCATACTAGACTTCCA-1-3     Smooth_muscle_cells
GAGCCTGGTCGAGATG-1-3            Erythroblast
CTTACCGCAGAACTCT-1-3             Osteoblasts
TTGACCCCATCTAACG-1-3     Smooth_muscle_cells
                                ...         
TTATTGCGTCGGTGTC-1-79      Endothelial_cells
GTCACGGGTTGTATGC-1-79      Endothelial_cells
GTCATGATCTTTCGAT-1-79      Endothelial_cells
GCGATCGTCAGAGTGG-1-79              Platelets
GCCCGAACAGAGAAAG-1-79      Endothelial_cells
Name: singler_annotation, Length: 465304, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Osteoblasts', 'Smooth_muscle_cells', 'Erythroblast', 'Endothelial_cells', 'Neurons', 'Astrocyte', 'Fibroblasts', 'NK_cell', 'Gametocytes', 'Neuroepithelial_cell', 'Platelets', 'Embryonic_stem_cells', 'iPS_cells', 'Hepatocytes', 'MSC', 'Chondrocytes', 'MEP', 'BM & Prog.', 'Macrophage', 'Monocyte', 'Neutrophils', 'DC', 'HSC_CD34+', 'HSC_-G-CSF', 'Tissue_stem_cells', 'Unknown', 'T_cells', 'Keratinocytes', 'Epithelial_cells', 'B_cell', 'Myelocyte', 'Pro-Myelocyte', 'BM', 'Pre-B_cell_CD34-', 'GMP', 'CMP', 'Pro-B_cell_CD34+']
라벨별 그룹 개수 {2: 9, 1: 12, 0: 13}
cell type :  TTCTTCCGTTCAACGT-1-0                Astrocyte
CATCCACCATCTAACG-1-0      Smooth_muscle_cells
ACCCAAACAGCTAACT-1-0                  Neurons
AAGGAATCAACTGGTT-1-0     Neuroepithelial_cell
TACCCGTAGCGTGCTC-1-0                Astrocyte
                                 ...         
TTCCTTCCAGGTTTAC-1-64       Endothelial_cells
GGGTCACAGTCTAGAA-1-64       Endothelial_cells
GTTCCGTGTACAAGTA-1-64                 Unknown
TTCTTCCGTGTGTCGC-1-64       Endothelial_cells
TGTTGGACAGAGACTG-1-64       Endothelial_cells
Name: singler_annotation, Length: 127385, dtype: string
cell type annotation :  TTCTTCCGTTCAACGT-1-0                Astrocyte
CATCCACCATCTAACG-1-0      Smooth_muscle_cells
ACCCAAACAGCTAACT-1-0                  Neurons
AAGGAATCAACTGGTT-1-0     Neuroepithelial_cell
TACCCGTAGCGTGCTC-1-0                Astrocyte
                                 ...         
TTCCTTCCAGGTTTAC-1-64       Endothelial_cells
GGGTCACAGTCTAGAA-1-64       Endothelial_cells
GTTCCGTGTACAAGTA-1-64                 Unknown
TTCTTCCGTGTGTCGC-1-64       Endothelial_cells
TGTTGGACAGAGACTG-1-64       Endothelial_cells
Name: singler_annotation, Length: 127385, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Astrocyte', 'Smooth_muscle_cells', 'Neurons', 'Neuroepithelial_cell', 'Endothelial_cells', 'Osteoblasts', 'Platelets', 'Hepatocytes', 'Embryonic_stem_cells', 'MEP', 'Erythroblast', 'Fibroblasts', 'iPS_cells', 'MSC', 'Macrophage', 'Gametocytes', 'Chondrocytes', 'NK_cell', 'Neutrophils', 'HSC_CD34+', 'Monocyte', 'Tissue_stem_cells', 'DC', 'HSC_-G-CSF', 'T_cells', 'Epithelial_cells', 'Unknown', 'Pre-B_cell_CD34-', 'GMP', 'B_cell', 'Pro-Myelocyte', 'Keratinocytes', 'Myelocyte', 'BM', 'CMP', 'BM & Prog.', 'Pro-B_cell_CD34+']
라벨별 그룹 개수 {2: 2, 1: 3, 0: 3}
🔍 Split #4
  → train_p_index 환자 수 (환자 단위로 묶인 index list): 34
  → test_p_index 환자 수  (환자 단위로 묶인 index list): 8
  → train 환자 ID: ['P1290', 'P1300', 'P1304', 'P1358', 'P1425', 'P1437', 'P1447', 'P1462', 'P1472', 'P1504', 'P1508', 'P1510', 'P1515', 'P1516', 'P1539', 'P1540', 'P1547', 'P1549', 'P1558', 'P1561', 'P1600', 'P1602', 'P1603', 'P1606', 'P1610', 'P1617', 'P1630', 'P1631', 'P1685', 'P1702', 'P1707', 'P1718', 'P1726', 'P1735']
  → test  환자 ID: ['P1371', 'P1422', 'P1430', 'P1479', 'P1582', 'P1622', 'P1678', 'P1722']
  → train 환자 ID 및 라벨:
    ID: P1290, Label: 2
    ID: P1300, Label: 2
    ID: P1304, Label: 2
    ID: P1358, Label: 2
    ID: P1425, Label: 1
    ID: P1437, Label: 2
    ID: P1447, Label: 1
    ID: P1462, Label: 1
    ID: P1472, Label: 2
    ID: P1504, Label: 2
    ID: P1508, Label: 1
    ID: P1510, Label: 1
    ID: P1515, Label: 0
    ID: P1516, Label: 0
    ID: P1539, Label: 0
    ID: P1540, Label: 0
    ID: P1547, Label: 0
    ID: P1549, Label: 0
    ID: P1558, Label: 0
    ID: P1561, Label: 0
    ID: P1600, Label: 0
    ID: P1602, Label: 1
    ID: P1603, Label: 0
    ID: P1606, Label: 2
    ID: P1610, Label: 0
    ID: P1617, Label: 2
    ID: P1630, Label: 1
    ID: P1631, Label: 1
    ID: P1685, Label: 1
    ID: P1702, Label: 0
    ID: P1707, Label: 1
    ID: P1718, Label: 0
    ID: P1726, Label: 1
    ID: P1735, Label: 1
  → test 환자 ID 및 라벨:
    ID: P1371, Label: 2
    ID: P1422, Label: 1
    ID: P1430, Label: 2
    ID: P1479, Label: 1
    ID: P1582, Label: 0
    ID: P1622, Label: 0
    ID: P1678, Label: 0
    ID: P1722, Label: 1
전체 데이터 index 길이 42
label_stat (train 환자 라벨 목록) 갯수 34
train_data에서 환자 단위로, train과 validation 나누기
기존 train_p_index 34
기존 (train) label_stat 34
train-vali 분할 후! 
train y 의 classes : {0, 1, 2} valid y 의 classes : {0, 1, 2} label_stat 의 classes : {0, 1, 2}
train_p_index_ 22
valid_p_index 12
test_p_index 8
→ train 환자 ID 및 라벨:
   총 개수: 22
   환자ID=P1718, Label=0, 셀개수=9278
   환자ID=P1539, Label=0, 셀개수=11076
   환자ID=P1304, Label=2, 셀개수=19123
   환자ID=P1472, Label=2, 셀개수=19513
   환자ID=P1606, Label=2, 셀개수=8523
   환자ID=P1631, Label=1, 셀개수=13686
   환자ID=P1425, Label=1, 셀개수=15378
   환자ID=P1735, Label=1, 셀개수=12009
   환자ID=P1707, Label=1, 셀개수=9517
   환자ID=P1547, Label=0, 셀개수=8253
   환자ID=P1685, Label=1, 셀개수=10043
   환자ID=P1515, Label=0, 셀개수=14502
   환자ID=P1437, Label=2, 셀개수=21695
   환자ID=P1630, Label=1, 셀개수=17633
   환자ID=P1617, Label=2, 셀개수=17986
   환자ID=P1516, Label=0, 셀개수=9361
   환자ID=P1603, Label=0, 셀개수=10638
   환자ID=P1510, Label=1, 셀개수=10744
   환자ID=P1508, Label=1, 셀개수=20536
   환자ID=P1462, Label=1, 셀개수=21715
   환자ID=P1600, Label=0, 셀개수=14882
   환자ID=P1540, Label=0, 셀개수=11638
→ valid 환자 ID 및 라벨:
   총 개수: 12
   환자ID=P1300, Label=2, 셀개수=17318
   환자ID=P1447, Label=1, 셀개수=11151
   환자ID=P1549, Label=0, 셀개수=11709
   환자ID=P1504, Label=2, 셀개수=8133
   환자ID=P1290, Label=2, 셀개수=8357
   환자ID=P1561, Label=0, 셀개수=10016
   환자ID=P1726, Label=1, 셀개수=12389
   환자ID=P1558, Label=0, 셀개수=10469
   환자ID=P1702, Label=0, 셀개수=13550
   환자ID=P1358, Label=2, 셀개수=23984
   환자ID=P1610, Label=0, 셀개수=13919
   환자ID=P1602, Label=1, 셀개수=16580
→ test 환자 ID 및 라벨:
   총 개수: 8
   환자ID=P1371, Label=2, 셀개수=16233
   환자ID=P1422, Label=1, 셀개수=23315
   환자ID=P1430, Label=2, 셀개수=11131
   환자ID=P1479, Label=1, 셀개수=19124
   환자ID=P1582, Label=0, 셀개수=18855
   환자ID=P1622, Label=0, 셀개수=7210
   환자ID=P1678, Label=0, 셀개수=10085
   환자ID=P1722, Label=1, 셀개수=21432
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Osteoblasts', 'Smooth_muscle_cells', 'Erythroblast', 'Osteoblasts', 'Smooth_muscle_cells', 'Endothelial_cells', 'Smooth_muscle_cells', 'Neurons', 'Neurons', 'Smooth_muscle_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
전체 데이터 길이 592689
전체 cell type 길이 0                 Osteoblasts
1         Smooth_muscle_cells
2                Erythroblast
3                 Osteoblasts
4         Smooth_muscle_cells
                 ...         
592684      Endothelial_cells
592685      Endothelial_cells
592686                Unknown
592687      Endothelial_cells
592688      Endothelial_cells
Length: 592689, dtype: string
cell type의 NaN 개수 체크 0
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:12,  7.87it/s]  2%|▏         | 2/100 [00:00<00:12,  7.83it/s]  3%|▎         | 3/100 [00:00<00:12,  7.49it/s]  4%|▍         | 4/100 [00:00<00:12,  7.55it/s]  5%|▌         | 5/100 [00:00<00:12,  7.42it/s]  6%|▌         | 6/100 [00:00<00:12,  7.50it/s]  7%|▋         | 7/100 [00:00<00:12,  7.54it/s]  8%|▊         | 8/100 [00:01<00:12,  7.46it/s]  9%|▉         | 9/100 [00:01<00:12,  7.49it/s] 10%|█         | 10/100 [00:01<00:11,  7.65it/s] 11%|█         | 11/100 [00:01<00:11,  7.73it/s] 12%|█▏        | 12/100 [00:01<00:11,  7.64it/s] 13%|█▎        | 13/100 [00:01<00:11,  7.67it/s] 14%|█▍        | 14/100 [00:01<00:11,  7.67it/s] 15%|█▌        | 15/100 [00:01<00:11,  7.62it/s] 16%|█▌        | 16/100 [00:02<00:11,  7.52it/s] 17%|█▋        | 17/100 [00:02<00:11,  7.41it/s] 18%|█▊        | 18/100 [00:02<00:11,  7.42it/s] 19%|█▉        | 19/100 [00:02<00:11,  7.33it/s] 20%|██        | 20/100 [00:02<00:10,  7.53it/s] 21%|██        | 21/100 [00:02<00:10,  7.36it/s] 22%|██▏       | 22/100 [00:02<00:10,  7.41it/s] 23%|██▎       | 23/100 [00:03<00:10,  7.56it/s] 24%|██▍       | 24/100 [00:03<00:10,  7.44it/s] 25%|██▌       | 25/100 [00:03<00:10,  7.37it/s] 26%|██▌       | 26/100 [00:03<00:09,  7.41it/s] 27%|██▋       | 27/100 [00:03<00:09,  7.37it/s] 28%|██▊       | 28/100 [00:03<00:09,  7.35it/s] 29%|██▉       | 29/100 [00:03<00:09,  7.33it/s] 30%|███       | 30/100 [00:04<00:09,  7.29it/s] 31%|███       | 31/100 [00:04<00:09,  7.17it/s] 32%|███▏      | 32/100 [00:04<00:09,  7.11it/s] 33%|███▎      | 33/100 [00:04<00:09,  7.27it/s] 34%|███▍      | 34/100 [00:04<00:09,  7.24it/s] 35%|███▌      | 35/100 [00:04<00:09,  7.16it/s] 36%|███▌      | 36/100 [00:04<00:08,  7.28it/s] 37%|███▋      | 37/100 [00:04<00:08,  7.22it/s] 38%|███▊      | 38/100 [00:05<00:08,  7.14it/s] 39%|███▉      | 39/100 [00:05<00:08,  7.17it/s] 40%|████      | 40/100 [00:05<00:08,  7.18it/s] 41%|████      | 41/100 [00:05<00:08,  7.34it/s] 42%|████▏     | 42/100 [00:05<00:07,  7.36it/s] 43%|████▎     | 43/100 [00:05<00:07,  7.41it/s] 44%|████▍     | 44/100 [00:05<00:07,  7.51it/s] 45%|████▌     | 45/100 [00:06<00:07,  7.34it/s] 46%|████▌     | 46/100 [00:06<00:07,  7.16it/s] 47%|████▋     | 47/100 [00:06<00:07,  7.05it/s] 48%|████▊     | 48/100 [00:06<00:07,  6.95it/s] 49%|████▉     | 49/100 [00:06<00:07,  6.88it/s] 50%|█████     | 50/100 [00:06<00:07,  6.78it/s] 51%|█████     | 51/100 [00:06<00:07,  6.79it/s] 52%|█████▏    | 52/100 [00:07<00:06,  6.86it/s] 53%|█████▎    | 53/100 [00:07<00:06,  6.88it/s] 54%|█████▍    | 54/100 [00:07<00:06,  6.98it/s] 55%|█████▌    | 55/100 [00:07<00:06,  6.98it/s] 56%|█████▌    | 56/100 [00:07<00:06,  6.94it/s] 57%|█████▋    | 57/100 [00:07<00:06,  7.04it/s] 58%|█████▊    | 58/100 [00:07<00:06,  7.00it/s] 59%|█████▉    | 59/100 [00:08<00:05,  7.10it/s] 60%|██████    | 60/100 [00:08<00:05,  6.96it/s] 61%|██████    | 61/100 [00:08<00:05,  6.94it/s] 62%|██████▏   | 62/100 [00:08<00:05,  6.76it/s] 63%|██████▎   | 63/100 [00:08<00:05,  6.72it/s] 64%|██████▍   | 64/100 [00:08<00:05,  6.73it/s] 65%|██████▌   | 65/100 [00:09<00:05,  6.68it/s] 66%|██████▌   | 66/100 [00:09<00:05,  6.58it/s] 67%|██████▋   | 67/100 [00:09<00:04,  6.64it/s] 68%|██████▊   | 68/100 [00:09<00:04,  6.58it/s] 69%|██████▉   | 69/100 [00:09<00:04,  6.69it/s] 70%|███████   | 70/100 [00:09<00:04,  6.60it/s] 71%|███████   | 71/100 [00:09<00:04,  6.60it/s] 72%|███████▏  | 72/100 [00:10<00:04,  6.49it/s] 73%|███████▎  | 73/100 [00:10<00:04,  6.52it/s] 74%|███████▍  | 74/100 [00:10<00:03,  6.61it/s] 75%|███████▌  | 75/100 [00:10<00:03,  6.70it/s] 76%|███████▌  | 76/100 [00:10<00:03,  6.59it/s] 77%|███████▋  | 77/100 [00:10<00:03,  6.58it/s] 78%|███████▊  | 78/100 [00:10<00:03,  6.59it/s] 79%|███████▉  | 79/100 [00:11<00:03,  6.70it/s] 80%|████████  | 80/100 [00:11<00:03,  6.66it/s] 81%|████████  | 81/100 [00:11<00:02,  6.62it/s] 82%|████████▏ | 82/100 [00:11<00:02,  6.56it/s] 83%|████████▎ | 83/100 [00:11<00:02,  6.47it/s] 84%|████████▍ | 84/100 [00:11<00:02,  6.47it/s] 85%|████████▌ | 85/100 [00:12<00:02,  6.28it/s] 86%|████████▌ | 86/100 [00:12<00:02,  6.28it/s] 87%|████████▋ | 87/100 [00:12<00:02,  6.19it/s] 88%|████████▊ | 88/100 [00:12<00:01,  6.33it/s] 89%|████████▉ | 89/100 [00:12<00:01,  6.33it/s] 90%|█████████ | 90/100 [00:12<00:01,  6.35it/s] 91%|█████████ | 91/100 [00:13<00:01,  6.48it/s] 92%|█████████▏| 92/100 [00:13<00:01,  6.49it/s] 93%|█████████▎| 93/100 [00:13<00:01,  6.55it/s] 94%|█████████▍| 94/100 [00:13<00:00,  6.60it/s] 95%|█████████▌| 95/100 [00:13<00:00,  6.51it/s] 96%|█████████▌| 96/100 [00:13<00:00,  6.39it/s] 97%|█████████▋| 97/100 [00:13<00:00,  6.43it/s] 98%|█████████▊| 98/100 [00:14<00:00,  6.40it/s] 99%|█████████▉| 99/100 [00:14<00:00,  6.52it/s]100%|██████████| 100/100 [00:14<00:00,  6.34it/s]100%|██████████| 100/100 [00:14<00:00,  6.94it/s]
[I 2025-08-29 21:29:53,536] A new study created in memory with name: no-name-f0351dd0-0c9e-4f6e-8c6d-9431a3ce60d5
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 16.69 MB
Memory Reserved: 42.00 MB
cuda
CUDA OOM 발생 — 단계적 백오프 시작.
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 7468.79 MB
Memory Reserved: 7490.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 14664.78 MB
Memory Reserved: 14686.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 7468.78 MB
Memory Reserved: 7490.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 14664.78 MB
Memory Reserved: 14686.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[I 2025-08-29 21:29:54,992] Trial 0 pruned. Pruned due to OOM after backoff
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 7473.07 MB
Memory Reserved: 7490.00 MB
cuda
Epoch 1, Train Loss 0.932517, Valid_loss 1.542871
Epoch 2, Train Loss 0.923390, Valid_loss 1.394790
Epoch 3, Train Loss 0.921267, Valid_loss 1.352108
Epoch 4, Train Loss 0.934639, Valid_loss 1.476801
Epoch 5, Train Loss 0.925327, Valid_loss 1.329596
Epoch 6, Train Loss 0.913017, Valid_loss 0.967195
Epoch 7, Train Loss 0.835082, Valid_loss 1.002507
Epoch 8, Train Loss 0.690325, Valid_loss 1.047211
Epoch 9, Train Loss 0.638439, Valid_loss 0.982027
Epoch 10, Train Loss 0.634371, Valid_loss 0.794057
Epoch 11, Train Loss 0.551329, Valid_loss 0.904284
Epoch 12, Train Loss 0.573602, Valid_loss 0.934530
Epoch 13, Train Loss 0.582369, Valid_loss 0.948407
Epoch 14, Train Loss 0.494080, Valid_loss 0.993054
Epoch 15, Train Loss 0.447751, Valid_loss 0.926396
Epoch 16, Train Loss 0.573327, Valid_loss 1.039848
Epoch 17, Train Loss 0.519202, Valid_loss 0.965274
Epoch 18, Train Loss 0.518089, Valid_loss 1.243563
Epoch 19, Train Loss 0.511624, Valid_loss 0.928784
Epoch 20, Train Loss 0.465193, Valid_loss 0.757527
Epoch 21, Train Loss 0.454792, Valid_loss 0.880557
Epoch 22, Train Loss 0.520687, Valid_loss 0.752985
Epoch 23, Train Loss 0.431007, Valid_loss 0.827843
Epoch 24, Train Loss 0.412611, Valid_loss 0.671267
Epoch 25, Train Loss 0.420643, Valid_loss 0.757733
Epoch 26, Train Loss 0.426606, Valid_loss 0.763581
Epoch 27, Train Loss 0.418835, Valid_loss 0.602204
Epoch 28, Train Loss 0.454025, Valid_loss 0.870730
Epoch 29, Train Loss 0.400124, Valid_loss 0.560821
Epoch 30, Train Loss 0.380074, Valid_loss 0.734734
Epoch 31, Train Loss 0.561207, Valid_loss 1.099930
Epoch 32, Train Loss 0.511614, Valid_loss 0.570997
Epoch 33, Train Loss 0.442689, Valid_loss 0.615923
Epoch 34, Train Loss 0.411372, Valid_loss 0.682167
Epoch 35, Train Loss 0.395265, Valid_loss 0.559591
Epoch 36, Train Loss 0.371268, Valid_loss 0.826810
Epoch 37, Train Loss 0.343072, Valid_loss 0.489196
Epoch 38, Train Loss 0.391547, Valid_loss 0.667928
Epoch 39, Train Loss 0.376498, Valid_loss 0.513044
Epoch 40, Train Loss 0.314893, Valid_loss 0.690212
Epoch 41, Train Loss 0.422391, Valid_loss 0.456200
Epoch 42, Train Loss 0.396316, Valid_loss 0.771501
Epoch 43, Train Loss 0.350705, Valid_loss 0.752397
Epoch 44, Train Loss 0.347038, Valid_loss 0.675706
Epoch 45, Train Loss 0.413790, Valid_loss 0.440395
Epoch 46, Train Loss 0.363395, Valid_loss 0.505184
Epoch 47, Train Loss 0.370986, Valid_loss 0.494154
Epoch 48, Train Loss 0.351623, Valid_loss 0.777712
Epoch 49, Train Loss 0.357711, Valid_loss 0.661918
Epoch 50, Train Loss 0.405715, Valid_loss 0.619753
Epoch 51, Train Loss 0.327379, Valid_loss 0.632275
Epoch 52, Train Loss 0.276560, Valid_loss 0.588395
Epoch 53, Train Loss 0.270417, Valid_loss 0.784052
Epoch 54, Train Loss 0.277330, Valid_loss 0.488663
Epoch 55, Train Loss 0.233469, Valid_loss 0.610226
Epoch 56, Train Loss 0.260799, Valid_loss 0.458006
Epoch 57, Train Loss 0.240333, Valid_loss 0.699782
Epoch 58, Train Loss 0.306177, Valid_loss 0.522459
Epoch 59, Train Loss 0.257898, Valid_loss 0.538367
Epoch 60, Train Loss 0.331586, Valid_loss 0.669588
[I 2025-08-29 21:53:03,128] Trial 1 finished with value: 0.44039492572968203 and parameters: {'learning_rate': 0.001, 'epochs': 100, 'heads': 1, 'dropout': 0.5, 'weight_decay': 0.01, 'emb_dim': 64, 'augment_num': 100, 'pca': False}. Best is trial 1 with value: 0.44039492572968203.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 19.85 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 1.032185, Valid_loss 1.429012
Epoch 2, Train Loss 1.014237, Valid_loss 1.347724
Epoch 3, Train Loss 0.952711, Valid_loss 1.406007
Epoch 4, Train Loss 0.932116, Valid_loss 1.360418
Epoch 5, Train Loss 0.920379, Valid_loss 1.279427
Epoch 6, Train Loss 0.965468, Valid_loss 1.281163
Epoch 7, Train Loss 0.791709, Valid_loss 1.157810
Epoch 8, Train Loss 0.993106, Valid_loss 1.460799
Epoch 9, Train Loss 0.881069, Valid_loss 1.293470
Epoch 10, Train Loss 0.876840, Valid_loss 1.405852
Epoch 11, Train Loss 0.787294, Valid_loss 1.006301
Epoch 12, Train Loss 0.649587, Valid_loss 0.955313
Epoch 13, Train Loss 0.672509, Valid_loss 0.957458
Epoch 14, Train Loss 0.616668, Valid_loss 1.023019
Epoch 15, Train Loss 0.588555, Valid_loss 0.968272
Epoch 16, Train Loss 0.683058, Valid_loss 0.890883
Epoch 17, Train Loss 0.598703, Valid_loss 0.698463
Epoch 18, Train Loss 0.570170, Valid_loss 0.719651
Epoch 19, Train Loss 0.496503, Valid_loss 0.654021
Epoch 20, Train Loss 0.539015, Valid_loss 0.680106
Epoch 21, Train Loss 0.555171, Valid_loss 0.810155
Epoch 22, Train Loss 0.521756, Valid_loss 0.844319
Epoch 23, Train Loss 0.459605, Valid_loss 0.797322
Epoch 24, Train Loss 0.563045, Valid_loss 0.635740
Epoch 25, Train Loss 0.499863, Valid_loss 0.770786
Epoch 26, Train Loss 0.486489, Valid_loss 0.722075
Epoch 27, Train Loss 0.549042, Valid_loss 0.751346
Epoch 28, Train Loss 0.450446, Valid_loss 0.564741
Epoch 29, Train Loss 0.468991, Valid_loss 0.579444
Epoch 30, Train Loss 0.432550, Valid_loss 0.646583
Epoch 31, Train Loss 0.461290, Valid_loss 0.546778
Epoch 32, Train Loss 0.557562, Valid_loss 0.672838
Epoch 33, Train Loss 0.464430, Valid_loss 0.503032
Epoch 34, Train Loss 0.489711, Valid_loss 0.477599
Epoch 35, Train Loss 0.485858, Valid_loss 1.053945
Epoch 36, Train Loss 0.445774, Valid_loss 0.483569
Epoch 37, Train Loss 0.377709, Valid_loss 0.450206
Epoch 38, Train Loss 0.506290, Valid_loss 0.583598
Epoch 39, Train Loss 0.399964, Valid_loss 0.530469
Epoch 40, Train Loss 0.378761, Valid_loss 0.430820
Epoch 41, Train Loss 0.380110, Valid_loss 0.793117
Epoch 42, Train Loss 0.370853, Valid_loss 0.441733
Epoch 43, Train Loss 0.347518, Valid_loss 0.868603
Epoch 44, Train Loss 0.276302, Valid_loss 0.466628
Epoch 45, Train Loss 0.424110, Valid_loss 0.412522
Epoch 46, Train Loss 0.334524, Valid_loss 0.389782
Epoch 47, Train Loss 0.382267, Valid_loss 0.752428
Epoch 48, Train Loss 0.417662, Valid_loss 0.409127
Epoch 49, Train Loss 0.344561, Valid_loss 0.362706
Epoch 50, Train Loss 0.302321, Valid_loss 0.371937
Epoch 51, Train Loss 0.271172, Valid_loss 0.677410
Epoch 52, Train Loss 0.275099, Valid_loss 0.349421
Epoch 53, Train Loss 0.224957, Valid_loss 0.701713
Epoch 54, Train Loss 0.268121, Valid_loss 0.601226
Epoch 55, Train Loss 0.236477, Valid_loss 0.491160
Epoch 56, Train Loss 0.316167, Valid_loss 0.861002
Epoch 57, Train Loss 0.248281, Valid_loss 0.853350
Epoch 58, Train Loss 0.217451, Valid_loss 0.339946
Epoch 59, Train Loss 0.236020, Valid_loss 1.005441
Epoch 60, Train Loss 0.227485, Valid_loss 0.940529
Epoch 61, Train Loss 0.224086, Valid_loss 0.783079
Epoch 62, Train Loss 0.251809, Valid_loss 0.863205
Epoch 63, Train Loss 0.238330, Valid_loss 0.900954
[I 2025-08-29 22:26:28,388] Trial 2 finished with value: 0.33994595080245443 and parameters: {'learning_rate': 0.001, 'epochs': 100, 'heads': 2, 'dropout': 0.7, 'weight_decay': 0.001, 'emb_dim': 64, 'augment_num': 100, 'pca': False}. Best is trial 2 with value: 0.33994595080245443.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 19.85 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.962292, Valid_loss 1.402512
Epoch 2, Train Loss 0.886408, Valid_loss 1.309018
Epoch 3, Train Loss 0.731791, Valid_loss 1.082328
Epoch 4, Train Loss 0.593154, Valid_loss 1.604501
Epoch 5, Train Loss 0.555163, Valid_loss 0.831185
Epoch 6, Train Loss 0.618385, Valid_loss 0.893837
Epoch 7, Train Loss 0.505956, Valid_loss 1.115655
Epoch 8, Train Loss 0.533050, Valid_loss 1.283902
Epoch 9, Train Loss 0.495524, Valid_loss 0.761778
Epoch 10, Train Loss 0.457754, Valid_loss 0.917764
Epoch 11, Train Loss 0.444480, Valid_loss 1.222630
Epoch 12, Train Loss 0.439900, Valid_loss 0.857545
Epoch 13, Train Loss 0.409474, Valid_loss 0.963479
Epoch 14, Train Loss 0.364895, Valid_loss 0.744011
Epoch 15, Train Loss 0.396729, Valid_loss 1.067211
Epoch 16, Train Loss 0.367650, Valid_loss 0.708680
Epoch 17, Train Loss 0.330362, Valid_loss 1.350778
Epoch 18, Train Loss 0.312225, Valid_loss 1.113711
Epoch 19, Train Loss 0.278905, Valid_loss 0.848076
Epoch 20, Train Loss 0.281873, Valid_loss 1.471316
Epoch 21, Train Loss 0.252320, Valid_loss 1.701783
Epoch 22, Train Loss 0.209085, Valid_loss 1.058445
Epoch 23, Train Loss 0.171765, Valid_loss 1.070451
Epoch 24, Train Loss 0.250401, Valid_loss 0.410013
Epoch 25, Train Loss 0.385279, Valid_loss 0.630335
Epoch 26, Train Loss 0.226018, Valid_loss 0.606068
Epoch 27, Train Loss 0.172572, Valid_loss 1.229761
Epoch 28, Train Loss 0.108712, Valid_loss 2.242453
Epoch 29, Train Loss 0.102118, Valid_loss 1.863238
Epoch 30, Train Loss 0.276795, Valid_loss 0.881995
Epoch 31, Train Loss 0.244112, Valid_loss 0.557357
Epoch 32, Train Loss 0.225530, Valid_loss 0.517275
Epoch 33, Train Loss 0.154641, Valid_loss 0.686568
Epoch 34, Train Loss 0.082624, Valid_loss 0.752783
Epoch 35, Train Loss 0.323037, Valid_loss 0.637231
Epoch 36, Train Loss 0.181229, Valid_loss 0.501209
Epoch 37, Train Loss 0.066591, Valid_loss 0.829163
Epoch 38, Train Loss 0.136721, Valid_loss 0.649764
Epoch 39, Train Loss 0.108825, Valid_loss 1.063148
Epoch 40, Train Loss 0.374055, Valid_loss 1.066647
Epoch 41, Train Loss 0.096397, Valid_loss 0.996919
Epoch 42, Train Loss 0.143326, Valid_loss 0.709569
Epoch 43, Train Loss 0.091920, Valid_loss 0.633768
Epoch 44, Train Loss 0.065939, Valid_loss 0.523801
Epoch 45, Train Loss 0.077850, Valid_loss 0.810961
Epoch 46, Train Loss 0.053694, Valid_loss 0.940868
Epoch 47, Train Loss 0.030281, Valid_loss 0.563691
Epoch 48, Train Loss 0.075959, Valid_loss 0.788371
Epoch 49, Train Loss 0.066611, Valid_loss 1.004787
Epoch 50, Train Loss 0.045790, Valid_loss 0.685579
Epoch 51, Train Loss 0.072523, Valid_loss 0.529493
Epoch 52, Train Loss 0.037844, Valid_loss 0.575084
Epoch 53, Train Loss 0.027718, Valid_loss 0.760220
[I 2025-08-29 22:45:57,107] Trial 3 finished with value: 0.41001290511727956 and parameters: {'learning_rate': 0.001, 'epochs': 100, 'heads': 1, 'dropout': 0.0, 'weight_decay': 0.001, 'emb_dim': 64, 'augment_num': 100, 'pca': False}. Best is trial 2 with value: 0.33994595080245443.
선택된 trial params: {'learning_rate': 0.001, 'epochs': 100, 'heads': 2, 'dropout': 0.7, 'weight_decay': 0.001, 'emb_dim': 64, 'augment_num': 100, 'pca': False}
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=8, batch_size=1 -> steps=8
Memory Allocated: 19.85 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 1.058989, Valid_loss 1.458641
Epoch 2, Train Loss 0.994338, Valid_loss 1.296685
Epoch 3, Train Loss 0.937905, Valid_loss 1.360390
Epoch 4, Train Loss 0.818712, Valid_loss 1.160878
Epoch 5, Train Loss 0.688854, Valid_loss 0.987734
Epoch 6, Train Loss 0.635272, Valid_loss 1.023975
Epoch 7, Train Loss 0.599728, Valid_loss 0.921245
Epoch 8, Train Loss 0.746751, Valid_loss 0.840355
Epoch 9, Train Loss 0.594630, Valid_loss 1.083729
Epoch 10, Train Loss 0.555092, Valid_loss 0.842935
Epoch 11, Train Loss 0.599157, Valid_loss 0.829689
Epoch 12, Train Loss 0.561971, Valid_loss 1.006854
Epoch 13, Train Loss 0.542239, Valid_loss 0.869800
Epoch 14, Train Loss 0.533374, Valid_loss 0.755835
Epoch 15, Train Loss 0.543715, Valid_loss 0.729001
Epoch 16, Train Loss 0.530536, Valid_loss 0.666307
Epoch 17, Train Loss 0.563573, Valid_loss 0.647174
Epoch 18, Train Loss 0.497260, Valid_loss 0.649959
Epoch 19, Train Loss 0.496131, Valid_loss 0.651824
Epoch 20, Train Loss 0.504857, Valid_loss 0.670806
Epoch 21, Train Loss 0.478983, Valid_loss 0.623034
Epoch 22, Train Loss 0.482480, Valid_loss 0.613740
Epoch 23, Train Loss 0.462467, Valid_loss 0.716841
Epoch 24, Train Loss 0.418157, Valid_loss 0.607679
Epoch 25, Train Loss 0.445124, Valid_loss 0.697368
Epoch 26, Train Loss 0.425910, Valid_loss 0.661567
Epoch 27, Train Loss 0.400477, Valid_loss 0.649696
Epoch 28, Train Loss 0.389617, Valid_loss 0.569364
Epoch 29, Train Loss 0.469383, Valid_loss 0.512273
Epoch 30, Train Loss 0.499510, Valid_loss 0.548961
Epoch 31, Train Loss 0.384163, Valid_loss 0.703311
Epoch 32, Train Loss 0.299025, Valid_loss 0.564545
Epoch 33, Train Loss 0.482010, Valid_loss 0.698485
Epoch 34, Train Loss 0.373564, Valid_loss 0.500485
Epoch 35, Train Loss 0.442507, Valid_loss 0.509504
Epoch 36, Train Loss 0.375626, Valid_loss 0.506735
Epoch 37, Train Loss 0.404471, Valid_loss 0.534212
Epoch 38, Train Loss 0.364959, Valid_loss 0.507360
Epoch 39, Train Loss 0.370755, Valid_loss 0.497073
Epoch 40, Train Loss 0.401479, Valid_loss 0.475897
Epoch 41, Train Loss 0.316504, Valid_loss 0.454263
Epoch 42, Train Loss 0.333822, Valid_loss 0.473979
Epoch 43, Train Loss 0.285478, Valid_loss 0.440798
Epoch 44, Train Loss 0.376886, Valid_loss 0.712725
Epoch 45, Train Loss 0.336143, Valid_loss 0.381783
Epoch 46, Train Loss 0.404019, Valid_loss 0.604452
Epoch 47, Train Loss 0.327735, Valid_loss 0.929626
Epoch 48, Train Loss 0.284720, Valid_loss 0.391065
Epoch 49, Train Loss 0.374649, Valid_loss 0.365072
Epoch 50, Train Loss 0.317600, Valid_loss 0.389421
Epoch 51, Train Loss 0.317792, Valid_loss 0.434558
Epoch 52, Train Loss 0.266261, Valid_loss 0.421498
Epoch 53, Train Loss 0.253662, Valid_loss 0.399985
Epoch 54, Train Loss 0.193139, Valid_loss 0.376149
Epoch 55, Train Loss 0.192127, Valid_loss 0.389637
Epoch 56, Train Loss 0.255126, Valid_loss 0.402243
환자ID=P1371 -- true: [[2]] -- pred: tensor([[-3.9008,  1.1625,  0.8473]], device='cuda:0')
환자ID=P1422 -- true: [[1]] -- pred: tensor([[ 1.3718,  0.4927, -4.8529]], device='cuda:0')
환자ID=P1430 -- true: [[2]] -- pred: tensor([[-3.8532,  1.1659,  0.7794]], device='cuda:0')
환자ID=P1479 -- true: [[1]] -- pred: tensor([[ 4.1261, -1.9797, -6.6299]], device='cuda:0')
환자ID=P1582 -- true: [[0]] -- pred: tensor([[ 4.0521, -2.1790, -6.4809]], device='cuda:0')
환자ID=P1622 -- true: [[0]] -- pred: tensor([[ 4.1207, -1.9489, -6.7153]], device='cuda:0')
환자ID=P1678 -- true: [[0]] -- pred: tensor([[ 4.0934, -2.1803, -6.4667]], device='cuda:0')
환자ID=P1722 -- true: [[1]] -- pred: tensor([[ 2.2988,  0.0067, -5.5495]], device='cuda:0')
Best performance: Epoch 49, Loss 0.374649, Test ACC 0.375000, Test AUC 0.796296, Test Recall 0.333333, Test Precision 0.166667
Confusion Matrix:
 [[3 0 0]
 [3 0 0]
 [0 2 0]]
✅ Total valid splits used: 4
🔁 Repeat 2, Fold 4
cell type :  TTCTTCCGTTCAACGT-1-0                Astrocyte
CATCCACCATCTAACG-1-0      Smooth_muscle_cells
ACCCAAACAGCTAACT-1-0                  Neurons
AAGGAATCAACTGGTT-1-0     Neuroepithelial_cell
TACCCGTAGCGTGCTC-1-0                Astrocyte
                                 ...         
CGTCCATAGAATTTGG-1-78       Endothelial_cells
GCTTCACAGCGTTGTT-1-78             Hepatocytes
TCTCTGGCAGTCGCAC-1-78                 Neurons
CAACAACCAGAGGCTA-1-78                 Neurons
CATTGTTGTCGTACAT-1-78       Endothelial_cells
Name: singler_annotation, Length: 486935, dtype: string
cell type annotation :  TTCTTCCGTTCAACGT-1-0                Astrocyte
CATCCACCATCTAACG-1-0      Smooth_muscle_cells
ACCCAAACAGCTAACT-1-0                  Neurons
AAGGAATCAACTGGTT-1-0     Neuroepithelial_cell
TACCCGTAGCGTGCTC-1-0                Astrocyte
                                 ...         
CGTCCATAGAATTTGG-1-78       Endothelial_cells
GCTTCACAGCGTTGTT-1-78             Hepatocytes
TCTCTGGCAGTCGCAC-1-78                 Neurons
CAACAACCAGAGGCTA-1-78                 Neurons
CATTGTTGTCGTACAT-1-78       Endothelial_cells
Name: singler_annotation, Length: 486935, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Astrocyte', 'Smooth_muscle_cells', 'Neurons', 'Neuroepithelial_cell', 'Endothelial_cells', 'Osteoblasts', 'Platelets', 'Hepatocytes', 'Embryonic_stem_cells', 'MEP', 'Erythroblast', 'Fibroblasts', 'iPS_cells', 'MSC', 'Macrophage', 'Gametocytes', 'Chondrocytes', 'NK_cell', 'Neutrophils', 'HSC_CD34+', 'Monocyte', 'Tissue_stem_cells', 'DC', 'HSC_-G-CSF', 'T_cells', 'Epithelial_cells', 'Unknown', 'Pre-B_cell_CD34-', 'GMP', 'B_cell', 'Pro-Myelocyte', 'Keratinocytes', 'Myelocyte', 'BM', 'CMP', 'BM & Prog.', 'Pro-B_cell_CD34+']
라벨별 그룹 개수 {2: 9, 1: 12, 0: 13}
cell type :  CTGCTCAAGGCATCAG-1-3             Osteoblasts
TCATACTAGACTTCCA-1-3     Smooth_muscle_cells
GAGCCTGGTCGAGATG-1-3            Erythroblast
CTTACCGCAGAACTCT-1-3             Osteoblasts
TTGACCCCATCTAACG-1-3     Smooth_muscle_cells
                                ...         
TTATTGCGTCGGTGTC-1-79      Endothelial_cells
GTCACGGGTTGTATGC-1-79      Endothelial_cells
GTCATGATCTTTCGAT-1-79      Endothelial_cells
GCGATCGTCAGAGTGG-1-79              Platelets
GCCCGAACAGAGAAAG-1-79      Endothelial_cells
Name: singler_annotation, Length: 105754, dtype: string
cell type annotation :  CTGCTCAAGGCATCAG-1-3             Osteoblasts
TCATACTAGACTTCCA-1-3     Smooth_muscle_cells
GAGCCTGGTCGAGATG-1-3            Erythroblast
CTTACCGCAGAACTCT-1-3             Osteoblasts
TTGACCCCATCTAACG-1-3     Smooth_muscle_cells
                                ...         
TTATTGCGTCGGTGTC-1-79      Endothelial_cells
GTCACGGGTTGTATGC-1-79      Endothelial_cells
GTCATGATCTTTCGAT-1-79      Endothelial_cells
GCGATCGTCAGAGTGG-1-79              Platelets
GCCCGAACAGAGAAAG-1-79      Endothelial_cells
Name: singler_annotation, Length: 105754, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Osteoblasts', 'Smooth_muscle_cells', 'Erythroblast', 'Endothelial_cells', 'Neurons', 'Astrocyte', 'Fibroblasts', 'NK_cell', 'Gametocytes', 'Neuroepithelial_cell', 'Platelets', 'Embryonic_stem_cells', 'iPS_cells', 'Hepatocytes', 'MSC', 'Chondrocytes', 'MEP', 'BM & Prog.', 'Macrophage', 'Monocyte', 'Neutrophils', 'DC', 'HSC_CD34+', 'HSC_-G-CSF', 'Tissue_stem_cells', 'Unknown', 'T_cells', 'Keratinocytes', 'Epithelial_cells', 'B_cell', 'Myelocyte', 'Pro-Myelocyte', 'BM', 'Pre-B_cell_CD34-', 'GMP', 'CMP', 'Pro-B_cell_CD34+']
라벨별 그룹 개수 {2: 2, 1: 3, 0: 3}
🔍 Split #5
  → train_p_index 환자 수 (환자 단위로 묶인 index list): 34
  → test_p_index 환자 수  (환자 단위로 묶인 index list): 8
  → train 환자 ID: ['P1300', 'P1304', 'P1358', 'P1371', 'P1422', 'P1425', 'P1430', 'P1437', 'P1447', 'P1472', 'P1479', 'P1504', 'P1508', 'P1510', 'P1515', 'P1516', 'P1539', 'P1540', 'P1547', 'P1558', 'P1582', 'P1600', 'P1602', 'P1603', 'P1606', 'P1622', 'P1630', 'P1631', 'P1678', 'P1702', 'P1707', 'P1718', 'P1722', 'P1726']
  → test  환자 ID: ['P1290', 'P1462', 'P1549', 'P1561', 'P1610', 'P1617', 'P1685', 'P1735']
  → train 환자 ID 및 라벨:
    ID: P1300, Label: 2
    ID: P1304, Label: 2
    ID: P1358, Label: 2
    ID: P1371, Label: 2
    ID: P1422, Label: 1
    ID: P1425, Label: 1
    ID: P1430, Label: 2
    ID: P1437, Label: 2
    ID: P1447, Label: 1
    ID: P1472, Label: 2
    ID: P1479, Label: 1
    ID: P1504, Label: 2
    ID: P1508, Label: 1
    ID: P1510, Label: 1
    ID: P1515, Label: 0
    ID: P1516, Label: 0
    ID: P1539, Label: 0
    ID: P1540, Label: 0
    ID: P1547, Label: 0
    ID: P1558, Label: 0
    ID: P1582, Label: 0
    ID: P1600, Label: 0
    ID: P1602, Label: 1
    ID: P1603, Label: 0
    ID: P1606, Label: 2
    ID: P1622, Label: 0
    ID: P1630, Label: 1
    ID: P1631, Label: 1
    ID: P1678, Label: 0
    ID: P1702, Label: 0
    ID: P1707, Label: 1
    ID: P1718, Label: 0
    ID: P1722, Label: 1
    ID: P1726, Label: 1
  → test 환자 ID 및 라벨:
    ID: P1290, Label: 2
    ID: P1462, Label: 1
    ID: P1549, Label: 0
    ID: P1561, Label: 0
    ID: P1610, Label: 0
    ID: P1617, Label: 2
    ID: P1685, Label: 1
    ID: P1735, Label: 1
전체 데이터 index 길이 42
label_stat (train 환자 라벨 목록) 갯수 34
train_data에서 환자 단위로, train과 validation 나누기
기존 train_p_index 34
기존 (train) label_stat 34
train-vali 분할 후! 
train y 의 classes : {0, 1, 2} valid y 의 classes : {0, 1, 2} label_stat 의 classes : {0, 1, 2}
train_p_index_ 22
valid_p_index 12
test_p_index 8
→ train 환자 ID 및 라벨:
   총 개수: 22
   환자ID=P1718, Label=0, 셀개수=9278
   환자ID=P1515, Label=0, 셀개수=14502
   환자ID=P1358, Label=2, 셀개수=23984
   환자ID=P1447, Label=1, 셀개수=11151
   환자ID=P1603, Label=0, 셀개수=10638
   환자ID=P1631, Label=1, 셀개수=13686
   환자ID=P1422, Label=1, 셀개수=23315
   환자ID=P1726, Label=1, 셀개수=12389
   환자ID=P1707, Label=1, 셀개수=9517
   환자ID=P1539, Label=0, 셀개수=11076
   환자ID=P1678, Label=0, 셀개수=10085
   환자ID=P1508, Label=1, 셀개수=20536
   환자ID=P1425, Label=1, 셀개수=15378
   환자ID=P1630, Label=1, 셀개수=17633
   환자ID=P1622, Label=0, 셀개수=7210
   환자ID=P1510, Label=1, 셀개수=10744
   환자ID=P1602, Label=1, 셀개수=16580
   환자ID=P1504, Label=2, 셀개수=8133
   환자ID=P1479, Label=1, 셀개수=19124
   환자ID=P1437, Label=2, 셀개수=21695
   환자ID=P1582, Label=0, 셀개수=18855
   환자ID=P1516, Label=0, 셀개수=9361
→ valid 환자 ID 및 라벨:
   총 개수: 12
   환자ID=P1304, Label=2, 셀개수=19123
   환자ID=P1430, Label=2, 셀개수=11131
   환자ID=P1540, Label=0, 셀개수=11638
   환자ID=P1472, Label=2, 셀개수=19513
   환자ID=P1300, Label=2, 셀개수=17318
   환자ID=P1558, Label=0, 셀개수=10469
   환자ID=P1722, Label=1, 셀개수=21432
   환자ID=P1547, Label=0, 셀개수=8253
   환자ID=P1702, Label=0, 셀개수=13550
   환자ID=P1371, Label=2, 셀개수=16233
   환자ID=P1606, Label=2, 셀개수=8523
   환자ID=P1600, Label=0, 셀개수=14882
→ test 환자 ID 및 라벨:
   총 개수: 8
   환자ID=P1290, Label=2, 셀개수=8357
   환자ID=P1462, Label=1, 셀개수=21715
   환자ID=P1549, Label=0, 셀개수=11709
   환자ID=P1561, Label=0, 셀개수=10016
   환자ID=P1610, Label=0, 셀개수=13919
   환자ID=P1617, Label=2, 셀개수=17986
   환자ID=P1685, Label=1, 셀개수=10043
   환자ID=P1735, Label=1, 셀개수=12009
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Astrocyte', 'Smooth_muscle_cells', 'Neurons', 'Neuroepithelial_cell', 'Astrocyte', 'Endothelial_cells', 'Osteoblasts', 'Platelets', 'Neurons', 'Hepatocytes']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
전체 데이터 길이 592689
전체 cell type 길이 0                    Astrocyte
1          Smooth_muscle_cells
2                      Neurons
3         Neuroepithelial_cell
4                    Astrocyte
                  ...         
592684       Endothelial_cells
592685       Endothelial_cells
592686       Endothelial_cells
592687               Platelets
592688       Endothelial_cells
Length: 592689, dtype: string
cell type의 NaN 개수 체크 0
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:12,  7.78it/s]  2%|▏         | 2/100 [00:00<00:12,  7.96it/s]  3%|▎         | 3/100 [00:00<00:12,  7.86it/s]  4%|▍         | 4/100 [00:00<00:12,  7.76it/s]  5%|▌         | 5/100 [00:00<00:12,  7.68it/s]  6%|▌         | 6/100 [00:00<00:12,  7.69it/s]  7%|▋         | 7/100 [00:00<00:11,  7.80it/s]  8%|▊         | 8/100 [00:01<00:11,  7.76it/s]  9%|▉         | 9/100 [00:01<00:11,  7.83it/s] 10%|█         | 10/100 [00:01<00:11,  7.95it/s] 11%|█         | 11/100 [00:01<00:11,  7.81it/s] 12%|█▏        | 12/100 [00:01<00:11,  7.76it/s] 13%|█▎        | 13/100 [00:01<00:11,  7.78it/s] 14%|█▍        | 14/100 [00:01<00:11,  7.67it/s] 15%|█▌        | 15/100 [00:01<00:11,  7.68it/s] 16%|█▌        | 16/100 [00:02<00:10,  7.72it/s] 17%|█▋        | 17/100 [00:02<00:10,  7.72it/s] 18%|█▊        | 18/100 [00:02<00:10,  7.71it/s] 19%|█▉        | 19/100 [00:02<00:10,  7.66it/s] 20%|██        | 20/100 [00:02<00:10,  7.57it/s] 21%|██        | 21/100 [00:02<00:10,  7.57it/s] 22%|██▏       | 22/100 [00:02<00:10,  7.49it/s] 23%|██▎       | 23/100 [00:02<00:10,  7.49it/s] 24%|██▍       | 24/100 [00:03<00:10,  7.54it/s] 25%|██▌       | 25/100 [00:03<00:09,  7.53it/s] 26%|██▌       | 26/100 [00:03<00:09,  7.49it/s] 27%|██▋       | 27/100 [00:03<00:09,  7.40it/s] 28%|██▊       | 28/100 [00:03<00:09,  7.40it/s] 29%|██▉       | 29/100 [00:03<00:09,  7.38it/s] 30%|███       | 30/100 [00:03<00:09,  7.37it/s] 31%|███       | 31/100 [00:04<00:09,  7.34it/s] 32%|███▏      | 32/100 [00:04<00:09,  7.36it/s] 33%|███▎      | 33/100 [00:04<00:09,  7.36it/s] 34%|███▍      | 34/100 [00:04<00:08,  7.42it/s] 35%|███▌      | 35/100 [00:04<00:08,  7.42it/s] 36%|███▌      | 36/100 [00:04<00:08,  7.43it/s] 37%|███▋      | 37/100 [00:04<00:08,  7.37it/s] 38%|███▊      | 38/100 [00:05<00:08,  7.39it/s] 39%|███▉      | 39/100 [00:05<00:08,  7.39it/s] 40%|████      | 40/100 [00:05<00:08,  7.37it/s] 41%|████      | 41/100 [00:05<00:07,  7.39it/s] 42%|████▏     | 42/100 [00:05<00:07,  7.38it/s] 43%|████▎     | 43/100 [00:05<00:07,  7.30it/s] 44%|████▍     | 44/100 [00:05<00:07,  7.37it/s] 45%|████▌     | 45/100 [00:05<00:07,  7.41it/s] 46%|████▌     | 46/100 [00:06<00:07,  7.25it/s] 47%|████▋     | 47/100 [00:06<00:07,  7.21it/s] 48%|████▊     | 48/100 [00:06<00:07,  7.30it/s] 49%|████▉     | 49/100 [00:06<00:06,  7.31it/s] 50%|█████     | 50/100 [00:06<00:06,  7.29it/s] 51%|█████     | 51/100 [00:06<00:06,  7.24it/s] 52%|█████▏    | 52/100 [00:06<00:06,  7.35it/s] 53%|█████▎    | 53/100 [00:07<00:06,  7.32it/s] 54%|█████▍    | 54/100 [00:07<00:06,  7.29it/s] 55%|█████▌    | 55/100 [00:07<00:06,  7.35it/s] 56%|█████▌    | 56/100 [00:07<00:05,  7.33it/s] 57%|█████▋    | 57/100 [00:07<00:05,  7.25it/s] 58%|█████▊    | 58/100 [00:07<00:05,  7.24it/s] 59%|█████▉    | 59/100 [00:07<00:05,  7.20it/s] 60%|██████    | 60/100 [00:08<00:05,  7.25it/s] 61%|██████    | 61/100 [00:08<00:05,  7.22it/s] 62%|██████▏   | 62/100 [00:08<00:05,  7.17it/s] 63%|██████▎   | 63/100 [00:08<00:05,  7.09it/s] 64%|██████▍   | 64/100 [00:08<00:05,  7.14it/s] 65%|██████▌   | 65/100 [00:08<00:04,  7.17it/s] 66%|██████▌   | 66/100 [00:08<00:04,  7.01it/s] 67%|██████▋   | 67/100 [00:09<00:04,  6.97it/s] 68%|██████▊   | 68/100 [00:09<00:04,  6.93it/s] 69%|██████▉   | 69/100 [00:09<00:04,  7.05it/s] 70%|███████   | 70/100 [00:09<00:04,  7.01it/s] 71%|███████   | 71/100 [00:09<00:04,  6.97it/s] 72%|███████▏  | 72/100 [00:09<00:04,  6.92it/s] 73%|███████▎  | 73/100 [00:09<00:03,  6.88it/s] 74%|███████▍  | 74/100 [00:10<00:03,  6.88it/s] 75%|███████▌  | 75/100 [00:10<00:03,  6.90it/s] 76%|███████▌  | 76/100 [00:10<00:03,  6.90it/s] 77%|███████▋  | 77/100 [00:10<00:03,  6.92it/s] 78%|███████▊  | 78/100 [00:10<00:03,  6.89it/s] 79%|███████▉  | 79/100 [00:10<00:03,  6.92it/s] 80%|████████  | 80/100 [00:10<00:02,  6.89it/s] 81%|████████  | 81/100 [00:11<00:02,  6.93it/s] 82%|████████▏ | 82/100 [00:11<00:02,  6.97it/s] 83%|████████▎ | 83/100 [00:11<00:02,  6.95it/s] 84%|████████▍ | 84/100 [00:11<00:02,  6.81it/s] 85%|████████▌ | 85/100 [00:11<00:02,  6.86it/s] 86%|████████▌ | 86/100 [00:11<00:02,  6.79it/s] 87%|████████▋ | 87/100 [00:11<00:01,  6.81it/s] 88%|████████▊ | 88/100 [00:12<00:01,  6.80it/s] 89%|████████▉ | 89/100 [00:12<00:01,  6.77it/s] 90%|█████████ | 90/100 [00:12<00:01,  6.76it/s] 91%|█████████ | 91/100 [00:12<00:01,  6.83it/s] 92%|█████████▏| 92/100 [00:12<00:01,  6.82it/s] 93%|█████████▎| 93/100 [00:12<00:01,  6.85it/s] 94%|█████████▍| 94/100 [00:12<00:00,  6.86it/s] 95%|█████████▌| 95/100 [00:13<00:00,  6.68it/s] 96%|█████████▌| 96/100 [00:13<00:00,  6.69it/s] 97%|█████████▋| 97/100 [00:13<00:00,  6.67it/s] 98%|█████████▊| 98/100 [00:13<00:00,  6.70it/s] 99%|█████████▉| 99/100 [00:13<00:00,  6.69it/s]100%|██████████| 100/100 [00:13<00:00,  6.65it/s]100%|██████████| 100/100 [00:13<00:00,  7.21it/s]
[I 2025-08-29 23:16:27,796] A new study created in memory with name: no-name-e543d15b-5800-46cf-8906-2e8c6ce3511b
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 18.01 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 1.142119, Valid_loss 1.233635
Epoch 2, Train Loss 0.998616, Valid_loss 1.336829
Epoch 3, Train Loss 0.989727, Valid_loss 1.234770
Epoch 4, Train Loss 0.854226, Valid_loss 1.178532
Epoch 5, Train Loss 0.806180, Valid_loss 1.102914
Epoch 6, Train Loss 0.764990, Valid_loss 1.017394
Epoch 7, Train Loss 0.763994, Valid_loss 1.057292
Epoch 8, Train Loss 0.659133, Valid_loss 1.045805
Epoch 9, Train Loss 0.621197, Valid_loss 1.004409
Epoch 10, Train Loss 0.648847, Valid_loss 1.066437
Epoch 11, Train Loss 0.613255, Valid_loss 1.032196
Epoch 12, Train Loss 0.650492, Valid_loss 0.974424
Epoch 13, Train Loss 0.524046, Valid_loss 0.955291
Epoch 14, Train Loss 0.548702, Valid_loss 1.002736
Epoch 15, Train Loss 0.611431, Valid_loss 0.990722
Epoch 16, Train Loss 0.648968, Valid_loss 1.001157
Epoch 17, Train Loss 0.554630, Valid_loss 1.022820
Epoch 18, Train Loss 0.551584, Valid_loss 0.998779
Epoch 19, Train Loss 0.560293, Valid_loss 1.027142
Epoch 20, Train Loss 0.586534, Valid_loss 0.995639
Epoch 21, Train Loss 0.571851, Valid_loss 1.098161
Epoch 22, Train Loss 0.528077, Valid_loss 1.055402
Epoch 23, Train Loss 0.505505, Valid_loss 0.980064
Epoch 24, Train Loss 0.528808, Valid_loss 1.023407
Epoch 25, Train Loss 0.450782, Valid_loss 0.960170
Epoch 26, Train Loss 0.500518, Valid_loss 0.947698
Epoch 27, Train Loss 0.499800, Valid_loss 1.013204
Epoch 28, Train Loss 0.475727, Valid_loss 0.999314
Epoch 29, Train Loss 0.502803, Valid_loss 1.015482
Epoch 30, Train Loss 0.463762, Valid_loss 0.987782
Epoch 31, Train Loss 0.508644, Valid_loss 0.982764
Epoch 32, Train Loss 0.485861, Valid_loss 1.053522
Epoch 33, Train Loss 0.416793, Valid_loss 0.996580
Epoch 34, Train Loss 0.472186, Valid_loss 1.008961
Epoch 35, Train Loss 0.456679, Valid_loss 0.945750
Epoch 36, Train Loss 0.474582, Valid_loss 0.926585
Epoch 37, Train Loss 0.449559, Valid_loss 0.993778
Epoch 38, Train Loss 0.516033, Valid_loss 1.016460
Epoch 39, Train Loss 0.494638, Valid_loss 1.005952
Epoch 40, Train Loss 0.412833, Valid_loss 0.959469
Epoch 41, Train Loss 0.432114, Valid_loss 0.972129
Epoch 42, Train Loss 0.439892, Valid_loss 0.986705
Epoch 43, Train Loss 0.449382, Valid_loss 1.027435
Epoch 44, Train Loss 0.487194, Valid_loss 1.016368
Epoch 45, Train Loss 0.390798, Valid_loss 0.944981
Epoch 46, Train Loss 0.372616, Valid_loss 0.998543
Epoch 47, Train Loss 0.387200, Valid_loss 1.006600
Epoch 48, Train Loss 0.363441, Valid_loss 0.970723
Epoch 49, Train Loss 0.376114, Valid_loss 1.042275
Epoch 50, Train Loss 0.295074, Valid_loss 1.171519
Epoch 51, Train Loss 0.458692, Valid_loss 1.085546
Epoch 52, Train Loss 0.360606, Valid_loss 1.067539
Epoch 53, Train Loss 0.341191, Valid_loss 1.073289
Epoch 54, Train Loss 0.347706, Valid_loss 0.986884
Epoch 55, Train Loss 0.334201, Valid_loss 0.941658
Epoch 56, Train Loss 0.344105, Valid_loss 0.943082
Epoch 57, Train Loss 0.330105, Valid_loss 1.020124
[I 2025-08-29 23:49:59,133] Trial 0 finished with value: 0.9265850353986025 and parameters: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 2, 'dropout': 0.7, 'weight_decay': 0.0001, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.9265850353986025.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 16.69 MB
Memory Reserved: 42.00 MB
cuda
CUDA OOM 발생 — 단계적 백오프 시작.
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 17855.37 MB
Memory Reserved: 17874.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 299.37 MB
Memory Reserved: 320.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 17855.54 MB
Memory Reserved: 17876.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 299.37 MB
Memory Reserved: 320.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[I 2025-08-29 23:50:00,938] Trial 1 pruned. Pruned due to OOM after backoff
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 17856.86 MB
Memory Reserved: 17876.00 MB
cuda
Epoch 1, Train Loss 0.987622, Valid_loss 1.776852
Epoch 2, Train Loss 0.924608, Valid_loss 1.785486
Epoch 3, Train Loss 0.830408, Valid_loss 1.654854
Epoch 4, Train Loss 0.720404, Valid_loss 1.496793
Epoch 5, Train Loss 0.673135, Valid_loss 1.561599
Epoch 6, Train Loss 0.633202, Valid_loss 1.528113
Epoch 7, Train Loss 0.509910, Valid_loss 1.550473
Epoch 8, Train Loss 0.539075, Valid_loss 1.528162
Epoch 9, Train Loss 0.566817, Valid_loss 1.530283
Epoch 10, Train Loss 0.594385, Valid_loss 1.483660
Epoch 11, Train Loss 0.466922, Valid_loss 1.532826
Epoch 12, Train Loss 0.499802, Valid_loss 1.546042
Epoch 13, Train Loss 0.529011, Valid_loss 1.504410
Epoch 14, Train Loss 0.469480, Valid_loss 1.439944
Epoch 15, Train Loss 0.425073, Valid_loss 1.432356
Epoch 16, Train Loss 0.446427, Valid_loss 1.460624
Epoch 17, Train Loss 0.392103, Valid_loss 1.380115
Epoch 18, Train Loss 0.401044, Valid_loss 1.559292
Epoch 19, Train Loss 0.381333, Valid_loss 1.282755
Epoch 20, Train Loss 0.393840, Valid_loss 1.287557
Epoch 21, Train Loss 0.455655, Valid_loss 1.274561
Epoch 22, Train Loss 0.443804, Valid_loss 1.439769
Epoch 23, Train Loss 0.405931, Valid_loss 2.879366
Epoch 24, Train Loss 0.283988, Valid_loss 1.538682
Epoch 25, Train Loss 0.301214, Valid_loss 1.127338
Epoch 26, Train Loss 0.354267, Valid_loss 1.265225
Epoch 27, Train Loss 0.291555, Valid_loss 1.227197
Epoch 28, Train Loss 0.260976, Valid_loss 1.270993
Epoch 29, Train Loss 0.249757, Valid_loss 1.182447
Epoch 30, Train Loss 0.258000, Valid_loss 1.173010
Epoch 31, Train Loss 0.302811, Valid_loss 1.121190
Epoch 32, Train Loss 0.376268, Valid_loss 1.124304
Epoch 33, Train Loss 0.259885, Valid_loss 1.786808
Epoch 34, Train Loss 0.284836, Valid_loss 0.958988
Epoch 35, Train Loss 0.279797, Valid_loss 1.108643
Epoch 36, Train Loss 0.198526, Valid_loss 1.169777
Epoch 37, Train Loss 0.294513, Valid_loss 1.315812
Epoch 38, Train Loss 0.200811, Valid_loss 1.071532
Epoch 39, Train Loss 0.276269, Valid_loss 1.168273
Epoch 40, Train Loss 0.183847, Valid_loss 1.209587
Epoch 41, Train Loss 0.168615, Valid_loss 1.268610
Epoch 42, Train Loss 0.266970, Valid_loss 0.987695
Epoch 43, Train Loss 0.178088, Valid_loss 1.060982
Epoch 44, Train Loss 0.198631, Valid_loss 1.493371
Epoch 45, Train Loss 0.230807, Valid_loss 2.224049
Epoch 46, Train Loss 0.130479, Valid_loss 2.359464
Epoch 47, Train Loss 0.308131, Valid_loss 1.174140
Epoch 48, Train Loss 0.188565, Valid_loss 0.824784
Epoch 49, Train Loss 0.223827, Valid_loss 0.875452
Epoch 50, Train Loss 0.186608, Valid_loss 1.017170
Epoch 51, Train Loss 0.186279, Valid_loss 0.823616
Epoch 52, Train Loss 0.139762, Valid_loss 0.933347
Epoch 53, Train Loss 0.143361, Valid_loss 0.877298
Epoch 54, Train Loss 0.130461, Valid_loss 0.851547
Epoch 55, Train Loss 0.122202, Valid_loss 0.800693
Epoch 56, Train Loss 0.112683, Valid_loss 1.736165
Epoch 57, Train Loss 0.152186, Valid_loss 0.753488
Epoch 58, Train Loss 0.120204, Valid_loss 0.991596
Epoch 59, Train Loss 0.116398, Valid_loss 0.876436
Epoch 60, Train Loss 0.115717, Valid_loss 0.669807
Epoch 61, Train Loss 0.118772, Valid_loss 0.749572
Epoch 62, Train Loss 0.094315, Valid_loss 0.518751
Epoch 63, Train Loss 0.220861, Valid_loss 0.634074
Epoch 64, Train Loss 0.168878, Valid_loss 1.650449
[I 2025-08-30 00:16:06,355] Trial 2 finished with value: 0.5187514137057102 and parameters: {'learning_rate': 0.001, 'epochs': 100, 'heads': 1, 'dropout': 0.5, 'weight_decay': 0.0001, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 2 with value: 0.5187514137057102.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 19.85 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.979946, Valid_loss 1.770134
Epoch 2, Train Loss 0.846877, Valid_loss 1.990935
Epoch 3, Train Loss 0.932432, Valid_loss 2.032393
Epoch 4, Train Loss 0.879238, Valid_loss 2.008516
Epoch 5, Train Loss 0.841717, Valid_loss 2.163629
Epoch 6, Train Loss 0.888236, Valid_loss 2.151105
Epoch 7, Train Loss 0.826809, Valid_loss 2.167597
Epoch 8, Train Loss 0.899640, Valid_loss 2.044959
Epoch 9, Train Loss 0.868886, Valid_loss 1.969348
Epoch 10, Train Loss 0.860768, Valid_loss 1.899172
Epoch 11, Train Loss 0.828096, Valid_loss 1.898216
Epoch 12, Train Loss 0.853569, Valid_loss 1.924801
Epoch 13, Train Loss 0.812454, Valid_loss 1.656605
Epoch 14, Train Loss 0.709178, Valid_loss 1.869498
Epoch 15, Train Loss 0.731907, Valid_loss 1.245289
Epoch 16, Train Loss 0.627981, Valid_loss 1.510466
Epoch 17, Train Loss 0.740482, Valid_loss 1.228766
Epoch 18, Train Loss 0.605877, Valid_loss 1.324200
Epoch 19, Train Loss 0.626919, Valid_loss 1.267495
Epoch 20, Train Loss 0.609356, Valid_loss 1.174148
Epoch 21, Train Loss 0.523311, Valid_loss 1.571727
Epoch 22, Train Loss 0.557808, Valid_loss 1.295117
Epoch 23, Train Loss 0.470825, Valid_loss 1.570068
Epoch 24, Train Loss 0.546767, Valid_loss 1.239154
Epoch 25, Train Loss 0.537169, Valid_loss 1.174541
Epoch 26, Train Loss 0.566284, Valid_loss 1.289675
Epoch 27, Train Loss 0.626592, Valid_loss 1.404991
Epoch 28, Train Loss 0.540268, Valid_loss 1.382073
Epoch 29, Train Loss 0.480094, Valid_loss 1.213168
Epoch 30, Train Loss 0.532479, Valid_loss 1.088353
Epoch 31, Train Loss 0.620495, Valid_loss 1.214347
Epoch 32, Train Loss 0.481320, Valid_loss 1.155908
Epoch 33, Train Loss 0.411975, Valid_loss 1.193719
Epoch 34, Train Loss 0.587154, Valid_loss 1.173568
Epoch 35, Train Loss 0.489333, Valid_loss 1.115374
Epoch 36, Train Loss 0.415617, Valid_loss 1.317936
Epoch 37, Train Loss 0.527610, Valid_loss 1.143764
Epoch 38, Train Loss 0.433477, Valid_loss 1.170983
Epoch 39, Train Loss 0.427802, Valid_loss 1.078698
Epoch 40, Train Loss 0.419467, Valid_loss 1.112516
Epoch 41, Train Loss 0.522443, Valid_loss 1.543095
Epoch 42, Train Loss 0.378033, Valid_loss 1.091049
Epoch 43, Train Loss 0.393508, Valid_loss 1.049423
Epoch 44, Train Loss 0.464175, Valid_loss 1.105354
Epoch 45, Train Loss 0.437465, Valid_loss 1.104404
Epoch 46, Train Loss 0.446653, Valid_loss 1.369557
Epoch 47, Train Loss 0.474953, Valid_loss 1.170880
Epoch 48, Train Loss 0.475921, Valid_loss 1.103923
Epoch 49, Train Loss 0.441925, Valid_loss 1.137153
Epoch 50, Train Loss 0.453282, Valid_loss 1.256184
Epoch 51, Train Loss 0.436215, Valid_loss 1.141063
Epoch 52, Train Loss 0.381425, Valid_loss 1.149767
Epoch 53, Train Loss 0.446936, Valid_loss 1.122492
Epoch 54, Train Loss 0.374934, Valid_loss 1.078285
Epoch 55, Train Loss 0.500372, Valid_loss 1.145262
Epoch 56, Train Loss 0.354750, Valid_loss 1.099278
Epoch 57, Train Loss 0.440165, Valid_loss 1.088985
Epoch 58, Train Loss 0.401058, Valid_loss 1.074266
Epoch 59, Train Loss 0.307156, Valid_loss 1.063470
Epoch 60, Train Loss 0.297153, Valid_loss 1.080327
Epoch 61, Train Loss 0.347902, Valid_loss 1.046351
Epoch 62, Train Loss 0.363817, Valid_loss 1.034883
Epoch 63, Train Loss 0.299454, Valid_loss 1.074839
Epoch 64, Train Loss 0.296963, Valid_loss 1.054397
Epoch 65, Train Loss 0.335665, Valid_loss 1.050422
Epoch 66, Train Loss 0.350205, Valid_loss 1.082589
Epoch 67, Train Loss 0.438809, Valid_loss 0.986878
Epoch 68, Train Loss 0.301181, Valid_loss 1.006074
Epoch 69, Train Loss 0.393165, Valid_loss 0.969344
Epoch 70, Train Loss 0.383002, Valid_loss 1.045028
Epoch 71, Train Loss 0.490663, Valid_loss 1.027256
Epoch 72, Train Loss 0.336128, Valid_loss 0.989478
Epoch 73, Train Loss 0.339881, Valid_loss 0.966670
Epoch 74, Train Loss 0.323541, Valid_loss 0.998954
Epoch 75, Train Loss 0.380681, Valid_loss 1.004052
[I 2025-08-30 01:00:23,653] Trial 3 finished with value: 0.9666700066300109 and parameters: {'learning_rate': 0.001, 'epochs': 100, 'heads': 2, 'dropout': 0.7, 'weight_decay': 0.01, 'emb_dim': 64, 'augment_num': 100, 'pca': False}. Best is trial 2 with value: 0.5187514137057102.
선택된 trial params: {'learning_rate': 0.001, 'epochs': 100, 'heads': 1, 'dropout': 0.5, 'weight_decay': 0.0001, 'emb_dim': 32, 'augment_num': 100, 'pca': False}
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=8, batch_size=1 -> steps=8
Memory Allocated: 18.01 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.846048, Valid_loss 2.013503
Epoch 2, Train Loss 0.862814, Valid_loss 2.156694
Epoch 3, Train Loss 0.870636, Valid_loss 2.028454
Epoch 4, Train Loss 0.708307, Valid_loss 1.853988
Epoch 5, Train Loss 0.875537, Valid_loss 1.980727
Epoch 6, Train Loss 0.822946, Valid_loss 1.717092
Epoch 7, Train Loss 0.812732, Valid_loss 1.869633
Epoch 8, Train Loss 0.649780, Valid_loss 1.498266
Epoch 9, Train Loss 0.617181, Valid_loss 1.440066
Epoch 10, Train Loss 0.524187, Valid_loss 1.489282
Epoch 11, Train Loss 0.463345, Valid_loss 1.230276
Epoch 12, Train Loss 0.491948, Valid_loss 1.304781
Epoch 13, Train Loss 0.437561, Valid_loss 1.240420
Epoch 14, Train Loss 0.377193, Valid_loss 1.367276
Epoch 15, Train Loss 0.440899, Valid_loss 1.232654
Epoch 16, Train Loss 0.458032, Valid_loss 1.272440
Epoch 17, Train Loss 0.413764, Valid_loss 1.257696
Epoch 18, Train Loss 0.356631, Valid_loss 1.223122
Epoch 19, Train Loss 0.369033, Valid_loss 1.268964
Epoch 20, Train Loss 0.324087, Valid_loss 1.125961
Epoch 21, Train Loss 0.408360, Valid_loss 1.062430
Epoch 22, Train Loss 0.333986, Valid_loss 1.422388
Epoch 23, Train Loss 0.356858, Valid_loss 1.448507
Epoch 24, Train Loss 0.317100, Valid_loss 1.463781
Epoch 25, Train Loss 0.305074, Valid_loss 1.286109
Epoch 26, Train Loss 0.261752, Valid_loss 1.176376
Epoch 27, Train Loss 0.271189, Valid_loss 1.147830
Epoch 28, Train Loss 0.313305, Valid_loss 1.070637
Epoch 29, Train Loss 0.231052, Valid_loss 1.171239
Epoch 30, Train Loss 0.211122, Valid_loss 1.162394
Epoch 31, Train Loss 0.245039, Valid_loss 1.149895
Epoch 32, Train Loss 0.185942, Valid_loss 1.068453
Epoch 33, Train Loss 0.208806, Valid_loss 0.938099
Epoch 34, Train Loss 0.209601, Valid_loss 1.132933
Epoch 35, Train Loss 0.246492, Valid_loss 1.073544
Epoch 36, Train Loss 0.198018, Valid_loss 1.026849
Epoch 37, Train Loss 0.236370, Valid_loss 0.980084
Epoch 38, Train Loss 0.202268, Valid_loss 1.013297
Epoch 39, Train Loss 0.223896, Valid_loss 0.930380
Epoch 40, Train Loss 0.285785, Valid_loss 1.082109
Epoch 41, Train Loss 0.219628, Valid_loss 1.064912
Epoch 42, Train Loss 0.219506, Valid_loss 1.045710
Epoch 43, Train Loss 0.189058, Valid_loss 1.074384
Epoch 44, Train Loss 0.181078, Valid_loss 1.078529
Epoch 45, Train Loss 0.240783, Valid_loss 0.899179
Epoch 46, Train Loss 0.183227, Valid_loss 0.911911
Epoch 47, Train Loss 0.263676, Valid_loss 0.787858
Epoch 48, Train Loss 0.224227, Valid_loss 0.972263
Epoch 49, Train Loss 0.224265, Valid_loss 0.787258
Epoch 50, Train Loss 0.248535, Valid_loss 0.783970
Epoch 51, Train Loss 0.191346, Valid_loss 0.808744
Epoch 52, Train Loss 0.151262, Valid_loss 0.870058
환자ID=P1290 -- true: [[2]] -- pred: tensor([[-3.1950,  1.3783,  0.0042]], device='cuda:0')
환자ID=P1462 -- true: [[1]] -- pred: tensor([[-3.1634,  1.2545,  0.0773]], device='cuda:0')
환자ID=P1549 -- true: [[0]] -- pred: tensor([[ 4.4011, -2.4282, -8.3865]], device='cuda:0')
환자ID=P1561 -- true: [[0]] -- pred: tensor([[ 4.3917, -2.4392, -8.3828]], device='cuda:0')
환자ID=P1610 -- true: [[0]] -- pred: tensor([[ 4.2465, -2.1276, -8.1918]], device='cuda:0')
환자ID=P1617 -- true: [[2]] -- pred: tensor([[-3.1568,  1.2591,  0.0759]], device='cuda:0')
환자ID=P1685 -- true: [[1]] -- pred: tensor([[-3.1859,  1.3537,  0.0216]], device='cuda:0')
환자ID=P1735 -- true: [[1]] -- pred: tensor([[-3.2031,  1.2431,  0.0885]], device='cuda:0')
Best performance: Epoch 50, Loss 0.248535, Test ACC 0.750000, Test AUC 0.722222, Test Recall 0.666667, Test Precision 0.533333
Confusion Matrix:
 [[3 0 0]
 [0 3 0]
 [0 2 0]]
✅ Total valid splits used: 5

📌 Repeat 2: 평균 AUC = 0.8407, 표준편차 = 0.0956
Test ACC 평균 0.686111, Test Recall 평균 0.644444, Test Precision 평균 0.557778
fold_aucs = [1.0, 0.7962962962962963, 0.888888888888889, 0.7962962962962963, 0.7222222222222222]
NaN 개수: 0 / 전체 5개

🔁 Repeat 3, Fold 0
cell type :  TTCTTCCGTTCAACGT-1-0                Astrocyte
CATCCACCATCTAACG-1-0      Smooth_muscle_cells
ACCCAAACAGCTAACT-1-0                  Neurons
AAGGAATCAACTGGTT-1-0     Neuroepithelial_cell
TACCCGTAGCGTGCTC-1-0                Astrocyte
                                 ...         
TTATTGCGTCGGTGTC-1-79       Endothelial_cells
GTCACGGGTTGTATGC-1-79       Endothelial_cells
GTCATGATCTTTCGAT-1-79       Endothelial_cells
GCGATCGTCAGAGTGG-1-79               Platelets
GCCCGAACAGAGAAAG-1-79       Endothelial_cells
Name: singler_annotation, Length: 454224, dtype: string
cell type annotation :  TTCTTCCGTTCAACGT-1-0                Astrocyte
CATCCACCATCTAACG-1-0      Smooth_muscle_cells
ACCCAAACAGCTAACT-1-0                  Neurons
AAGGAATCAACTGGTT-1-0     Neuroepithelial_cell
TACCCGTAGCGTGCTC-1-0                Astrocyte
                                 ...         
TTATTGCGTCGGTGTC-1-79       Endothelial_cells
GTCACGGGTTGTATGC-1-79       Endothelial_cells
GTCATGATCTTTCGAT-1-79       Endothelial_cells
GCGATCGTCAGAGTGG-1-79               Platelets
GCCCGAACAGAGAAAG-1-79       Endothelial_cells
Name: singler_annotation, Length: 454224, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Astrocyte', 'Smooth_muscle_cells', 'Neurons', 'Neuroepithelial_cell', 'Endothelial_cells', 'Osteoblasts', 'Platelets', 'Hepatocytes', 'Embryonic_stem_cells', 'MEP', 'Erythroblast', 'Fibroblasts', 'iPS_cells', 'MSC', 'Macrophage', 'Gametocytes', 'Chondrocytes', 'NK_cell', 'Neutrophils', 'HSC_CD34+', 'Monocyte', 'Tissue_stem_cells', 'DC', 'HSC_-G-CSF', 'T_cells', 'Epithelial_cells', 'Unknown', 'Pre-B_cell_CD34-', 'GMP', 'B_cell', 'Pro-Myelocyte', 'Keratinocytes', 'Myelocyte', 'BM', 'CMP', 'BM & Prog.', 'Pro-B_cell_CD34+']
라벨별 그룹 개수 {2: 9, 1: 12, 0: 12}
cell type :  CTCCCAAGTGGCACTC-1-6               Neurons
CTGCCTAAGCCTCAAT-1-6               Neurons
TCCTGCAAGGCTCTAT-1-6             Astrocyte
ACGTACAGTGGACCAA-1-6               Neurons
TCCTCCCCAACATACC-1-6               Neurons
                               ...        
GTGTCCTCACCCTTGT-1-74    Endothelial_cells
TATTGCTGTGACACGA-1-74         Chondrocytes
TCGTGCTTCGAAGGAC-1-74    Endothelial_cells
TGTGTGAAGGTAACTA-1-74          Osteoblasts
GTCGTAACACACCTTC-1-74          Fibroblasts
Name: singler_annotation, Length: 138465, dtype: string
cell type annotation :  CTCCCAAGTGGCACTC-1-6               Neurons
CTGCCTAAGCCTCAAT-1-6               Neurons
TCCTGCAAGGCTCTAT-1-6             Astrocyte
ACGTACAGTGGACCAA-1-6               Neurons
TCCTCCCCAACATACC-1-6               Neurons
                               ...        
GTGTCCTCACCCTTGT-1-74    Endothelial_cells
TATTGCTGTGACACGA-1-74         Chondrocytes
TCGTGCTTCGAAGGAC-1-74    Endothelial_cells
TGTGTGAAGGTAACTA-1-74          Osteoblasts
GTCGTAACACACCTTC-1-74          Fibroblasts
Name: singler_annotation, Length: 138465, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Neurons', 'Astrocyte', 'Platelets', 'Endothelial_cells', 'Erythroblast', 'Osteoblasts', 'Neuroepithelial_cell', 'Smooth_muscle_cells', 'NK_cell', 'MSC', 'Fibroblasts', 'Hepatocytes', 'iPS_cells', 'Chondrocytes', 'Macrophage', 'Tissue_stem_cells', 'Embryonic_stem_cells', 'MEP', 'Keratinocytes', 'Gametocytes', 'Unknown', 'Neutrophils', 'Monocyte', 'DC', 'Myelocyte', 'HSC_CD34+', 'T_cells', 'HSC_-G-CSF', 'Epithelial_cells', 'B_cell', 'BM', 'BM & Prog.', 'GMP', 'CMP', 'Pre-B_cell_CD34-', 'Pro-Myelocyte', 'Pro-B_cell_CD34+']
라벨별 그룹 개수 {2: 2, 1: 3, 0: 4}
🔍 Split #1
  → train_p_index 환자 수 (환자 단위로 묶인 index list): 33
  → test_p_index 환자 수  (환자 단위로 묶인 index list): 9
  → train 환자 ID: ['P1290', 'P1300', 'P1304', 'P1371', 'P1422', 'P1430', 'P1437', 'P1447', 'P1462', 'P1472', 'P1504', 'P1508', 'P1516', 'P1539', 'P1540', 'P1547', 'P1549', 'P1558', 'P1561', 'P1582', 'P1600', 'P1602', 'P1603', 'P1606', 'P1622', 'P1630', 'P1631', 'P1678', 'P1685', 'P1707', 'P1722', 'P1726', 'P1735']
  → test  환자 ID: ['P1358', 'P1425', 'P1479', 'P1510', 'P1515', 'P1610', 'P1617', 'P1702', 'P1718']
  → train 환자 ID 및 라벨:
    ID: P1290, Label: 2
    ID: P1300, Label: 2
    ID: P1304, Label: 2
    ID: P1371, Label: 2
    ID: P1422, Label: 1
    ID: P1430, Label: 2
    ID: P1437, Label: 2
    ID: P1447, Label: 1
    ID: P1462, Label: 1
    ID: P1472, Label: 2
    ID: P1504, Label: 2
    ID: P1508, Label: 1
    ID: P1516, Label: 0
    ID: P1539, Label: 0
    ID: P1540, Label: 0
    ID: P1547, Label: 0
    ID: P1549, Label: 0
    ID: P1558, Label: 0
    ID: P1561, Label: 0
    ID: P1582, Label: 0
    ID: P1600, Label: 0
    ID: P1602, Label: 1
    ID: P1603, Label: 0
    ID: P1606, Label: 2
    ID: P1622, Label: 0
    ID: P1630, Label: 1
    ID: P1631, Label: 1
    ID: P1678, Label: 0
    ID: P1685, Label: 1
    ID: P1707, Label: 1
    ID: P1722, Label: 1
    ID: P1726, Label: 1
    ID: P1735, Label: 1
  → test 환자 ID 및 라벨:
    ID: P1358, Label: 2
    ID: P1425, Label: 1
    ID: P1479, Label: 1
    ID: P1510, Label: 1
    ID: P1515, Label: 0
    ID: P1610, Label: 0
    ID: P1617, Label: 2
    ID: P1702, Label: 0
    ID: P1718, Label: 0
전체 데이터 index 길이 42
label_stat (train 환자 라벨 목록) 갯수 33
train_data에서 환자 단위로, train과 validation 나누기
기존 train_p_index 33
기존 (train) label_stat 33
train-vali 분할 후! 
train y 의 classes : {0, 1, 2} valid y 의 classes : {0, 1, 2} label_stat 의 classes : {0, 1, 2}
train_p_index_ 22
valid_p_index 11
test_p_index 9
→ train 환자 ID 및 라벨:
   총 개수: 22
   환자ID=P1602, Label=1, 셀개수=16580
   환자ID=P1722, Label=1, 셀개수=21432
   환자ID=P1540, Label=0, 셀개수=11638
   환자ID=P1304, Label=2, 셀개수=19123
   환자ID=P1462, Label=1, 셀개수=21715
   환자ID=P1606, Label=2, 셀개수=8523
   환자ID=P1631, Label=1, 셀개수=13686
   환자ID=P1422, Label=1, 셀개수=23315
   환자ID=P1735, Label=1, 셀개수=12009
   환자ID=P1707, Label=1, 셀개수=9517
   환자ID=P1549, Label=0, 셀개수=11709
   환자ID=P1678, Label=0, 셀개수=10085
   환자ID=P1516, Label=0, 셀개수=9361
   환자ID=P1430, Label=2, 셀개수=11131
   환자ID=P1630, Label=1, 셀개수=17633
   환자ID=P1539, Label=0, 셀개수=11076
   환자ID=P1603, Label=0, 셀개수=10638
   환자ID=P1508, Label=1, 셀개수=20536
   환자ID=P1504, Label=2, 셀개수=8133
   환자ID=P1447, Label=1, 셀개수=11151
   환자ID=P1600, Label=0, 셀개수=14882
   환자ID=P1547, Label=0, 셀개수=8253
→ valid 환자 ID 및 라벨:
   총 개수: 11
   환자ID=P1300, Label=2, 셀개수=17318
   환자ID=P1437, Label=2, 셀개수=21695
   환자ID=P1558, Label=0, 셀개수=10469
   환자ID=P1472, Label=2, 셀개수=19513
   환자ID=P1290, Label=2, 셀개수=8357
   환자ID=P1582, Label=0, 셀개수=18855
   환자ID=P1726, Label=1, 셀개수=12389
   환자ID=P1561, Label=0, 셀개수=10016
   환자ID=P1685, Label=1, 셀개수=10043
   환자ID=P1371, Label=2, 셀개수=16233
   환자ID=P1622, Label=0, 셀개수=7210
→ test 환자 ID 및 라벨:
   총 개수: 9
   환자ID=P1358, Label=2, 셀개수=23984
   환자ID=P1425, Label=1, 셀개수=15378
   환자ID=P1479, Label=1, 셀개수=19124
   환자ID=P1510, Label=1, 셀개수=10744
   환자ID=P1515, Label=0, 셀개수=14502
   환자ID=P1610, Label=0, 셀개수=13919
   환자ID=P1617, Label=2, 셀개수=17986
   환자ID=P1702, Label=0, 셀개수=13550
   환자ID=P1718, Label=0, 셀개수=9278
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Astrocyte', 'Smooth_muscle_cells', 'Neurons', 'Neuroepithelial_cell', 'Astrocyte', 'Endothelial_cells', 'Osteoblasts', 'Platelets', 'Neurons', 'Hepatocytes']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
전체 데이터 길이 592689
전체 cell type 길이 0                    Astrocyte
1          Smooth_muscle_cells
2                      Neurons
3         Neuroepithelial_cell
4                    Astrocyte
                  ...         
592684       Endothelial_cells
592685            Chondrocytes
592686       Endothelial_cells
592687             Osteoblasts
592688             Fibroblasts
Length: 592689, dtype: string
cell type의 NaN 개수 체크 0
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:13,  7.37it/s]  2%|▏         | 2/100 [00:00<00:12,  7.65it/s]  3%|▎         | 3/100 [00:00<00:12,  7.63it/s]  4%|▍         | 4/100 [00:00<00:12,  7.63it/s]  5%|▌         | 5/100 [00:00<00:12,  7.57it/s]  6%|▌         | 6/100 [00:00<00:12,  7.53it/s]  7%|▋         | 7/100 [00:00<00:12,  7.41it/s]  8%|▊         | 8/100 [00:01<00:12,  7.47it/s]  9%|▉         | 9/100 [00:01<00:12,  7.45it/s] 10%|█         | 10/100 [00:01<00:11,  7.55it/s] 11%|█         | 11/100 [00:01<00:11,  7.48it/s] 12%|█▏        | 12/100 [00:01<00:11,  7.49it/s] 13%|█▎        | 13/100 [00:01<00:11,  7.32it/s] 14%|█▍        | 14/100 [00:01<00:11,  7.31it/s] 15%|█▌        | 15/100 [00:02<00:11,  7.26it/s] 16%|█▌        | 16/100 [00:02<00:11,  7.25it/s] 17%|█▋        | 17/100 [00:02<00:11,  7.33it/s] 18%|█▊        | 18/100 [00:02<00:11,  7.33it/s] 19%|█▉        | 19/100 [00:02<00:11,  7.34it/s] 20%|██        | 20/100 [00:02<00:10,  7.32it/s] 21%|██        | 21/100 [00:02<00:10,  7.20it/s] 22%|██▏       | 22/100 [00:02<00:10,  7.18it/s] 23%|██▎       | 23/100 [00:03<00:10,  7.11it/s] 24%|██▍       | 24/100 [00:03<00:10,  7.07it/s] 25%|██▌       | 25/100 [00:03<00:10,  7.12it/s] 26%|██▌       | 26/100 [00:03<00:10,  7.10it/s] 27%|██▋       | 27/100 [00:03<00:10,  7.11it/s] 28%|██▊       | 28/100 [00:03<00:09,  7.23it/s] 29%|██▉       | 29/100 [00:03<00:09,  7.27it/s] 30%|███       | 30/100 [00:04<00:09,  7.24it/s] 31%|███       | 31/100 [00:04<00:09,  7.21it/s] 32%|███▏      | 32/100 [00:04<00:09,  7.23it/s] 33%|███▎      | 33/100 [00:04<00:09,  7.25it/s] 34%|███▍      | 34/100 [00:04<00:09,  7.21it/s] 35%|███▌      | 35/100 [00:04<00:08,  7.24it/s] 36%|███▌      | 36/100 [00:04<00:08,  7.11it/s] 37%|███▋      | 37/100 [00:05<00:08,  7.09it/s] 38%|███▊      | 38/100 [00:05<00:08,  7.06it/s] 39%|███▉      | 39/100 [00:05<00:08,  7.06it/s] 40%|████      | 40/100 [00:05<00:08,  7.04it/s] 41%|████      | 41/100 [00:05<00:08,  7.00it/s] 42%|████▏     | 42/100 [00:05<00:08,  7.24it/s] 43%|████▎     | 43/100 [00:05<00:07,  7.24it/s] 44%|████▍     | 44/100 [00:06<00:07,  7.25it/s] 45%|████▌     | 45/100 [00:06<00:07,  7.17it/s] 46%|████▌     | 46/100 [00:06<00:07,  7.24it/s] 47%|████▋     | 47/100 [00:06<00:07,  7.20it/s] 48%|████▊     | 48/100 [00:06<00:07,  7.11it/s] 49%|████▉     | 49/100 [00:06<00:07,  7.18it/s] 50%|█████     | 50/100 [00:06<00:06,  7.22it/s] 51%|█████     | 51/100 [00:07<00:06,  7.37it/s] 52%|█████▏    | 52/100 [00:07<00:06,  7.32it/s] 53%|█████▎    | 53/100 [00:07<00:06,  7.41it/s] 54%|█████▍    | 54/100 [00:07<00:06,  7.36it/s] 55%|█████▌    | 55/100 [00:07<00:06,  7.31it/s] 56%|█████▌    | 56/100 [00:07<00:06,  7.32it/s] 57%|█████▋    | 57/100 [00:07<00:06,  7.15it/s] 58%|█████▊    | 58/100 [00:07<00:05,  7.14it/s] 59%|█████▉    | 59/100 [00:08<00:05,  7.17it/s] 60%|██████    | 60/100 [00:08<00:05,  7.17it/s] 61%|██████    | 61/100 [00:08<00:05,  7.14it/s] 62%|██████▏   | 62/100 [00:08<00:05,  7.14it/s] 63%|██████▎   | 63/100 [00:08<00:05,  7.25it/s] 64%|██████▍   | 64/100 [00:08<00:05,  7.07it/s] 65%|██████▌   | 65/100 [00:08<00:05,  6.99it/s] 66%|██████▌   | 66/100 [00:09<00:04,  7.01it/s] 67%|██████▋   | 67/100 [00:09<00:04,  7.06it/s] 68%|██████▊   | 68/100 [00:09<00:04,  6.97it/s] 69%|██████▉   | 69/100 [00:09<00:04,  7.12it/s] 70%|███████   | 70/100 [00:09<00:04,  6.91it/s] 71%|███████   | 71/100 [00:09<00:04,  6.91it/s] 72%|███████▏  | 72/100 [00:09<00:04,  6.98it/s] 73%|███████▎  | 73/100 [00:10<00:03,  6.95it/s] 74%|███████▍  | 74/100 [00:10<00:03,  6.83it/s] 75%|███████▌  | 75/100 [00:10<00:03,  6.89it/s] 76%|███████▌  | 76/100 [00:10<00:03,  6.73it/s] 77%|███████▋  | 77/100 [00:10<00:03,  6.81it/s] 78%|███████▊  | 78/100 [00:10<00:03,  6.71it/s] 79%|███████▉  | 79/100 [00:11<00:03,  6.78it/s] 80%|████████  | 80/100 [00:11<00:02,  6.76it/s] 81%|████████  | 81/100 [00:11<00:02,  6.78it/s] 82%|████████▏ | 82/100 [00:11<00:02,  6.64it/s] 83%|████████▎ | 83/100 [00:11<00:02,  6.72it/s] 84%|████████▍ | 84/100 [00:11<00:02,  6.77it/s] 85%|████████▌ | 85/100 [00:11<00:02,  6.61it/s] 86%|████████▌ | 86/100 [00:12<00:02,  6.66it/s] 87%|████████▋ | 87/100 [00:12<00:01,  6.56it/s] 88%|████████▊ | 88/100 [00:12<00:01,  6.57it/s] 89%|████████▉ | 89/100 [00:12<00:01,  6.54it/s] 90%|█████████ | 90/100 [00:12<00:01,  6.66it/s] 91%|█████████ | 91/100 [00:12<00:01,  6.66it/s] 92%|█████████▏| 92/100 [00:12<00:01,  6.72it/s] 93%|█████████▎| 93/100 [00:13<00:01,  6.56it/s] 94%|█████████▍| 94/100 [00:13<00:00,  6.73it/s] 95%|█████████▌| 95/100 [00:13<00:00,  6.66it/s] 96%|█████████▌| 96/100 [00:13<00:00,  6.72it/s] 97%|█████████▋| 97/100 [00:13<00:00,  6.78it/s] 98%|█████████▊| 98/100 [00:13<00:00,  6.57it/s] 99%|█████████▉| 99/100 [00:14<00:00,  6.62it/s]100%|██████████| 100/100 [00:14<00:00,  6.48it/s]100%|██████████| 100/100 [00:14<00:00,  7.05it/s]
[I 2025-08-30 01:22:12,252] A new study created in memory with name: no-name-11a489dd-1ebc-493c-8fb3-fa9659617a5c
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 18.01 MB
Memory Reserved: 42.00 MB
cuda
CUDA OOM 발생 — 단계적 백오프 시작.
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 16903.99 MB
Memory Reserved: 16924.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 312.97 MB
Memory Reserved: 352.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 16903.99 MB
Memory Reserved: 16924.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 312.55 MB
Memory Reserved: 352.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[I 2025-08-30 01:22:13,631] Trial 0 pruned. Pruned due to OOM after backoff
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 16902.66 MB
Memory Reserved: 16944.00 MB
cuda
CUDA OOM 발생 — 단계적 백오프 시작.
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 16883.20 MB
Memory Reserved: 16904.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 291.20 MB
Memory Reserved: 312.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 16883.69 MB
Memory Reserved: 16904.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 291.20 MB
Memory Reserved: 312.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[I 2025-08-30 01:22:14,988] Trial 1 pruned. Pruned due to OOM after backoff
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 16886.85 MB
Memory Reserved: 16904.00 MB
cuda
Epoch 1, Train Loss 0.910510, Valid_loss 2.187892
Epoch 2, Train Loss 0.865005, Valid_loss 1.779311
Epoch 3, Train Loss 0.885646, Valid_loss 1.515632
Epoch 4, Train Loss 0.840669, Valid_loss 2.124115
Epoch 5, Train Loss 0.858545, Valid_loss 1.563620
Epoch 6, Train Loss 0.825989, Valid_loss 1.591664
Epoch 7, Train Loss 0.812083, Valid_loss 1.361773
Epoch 8, Train Loss 0.819713, Valid_loss 1.710072
Epoch 9, Train Loss 0.816672, Valid_loss 1.909234
Epoch 10, Train Loss 0.807690, Valid_loss 1.822835
Epoch 11, Train Loss 0.844820, Valid_loss 2.617782
Epoch 12, Train Loss 0.836696, Valid_loss 1.634725
Epoch 13, Train Loss 0.833656, Valid_loss 1.556843
Epoch 14, Train Loss 0.826324, Valid_loss 1.555483
Epoch 15, Train Loss 0.818806, Valid_loss 1.532281
Epoch 16, Train Loss 0.834498, Valid_loss 1.971467
Epoch 17, Train Loss 0.823575, Valid_loss 3.374948
Epoch 18, Train Loss 0.852256, Valid_loss 1.711709
Epoch 19, Train Loss 0.813229, Valid_loss 1.587638
Epoch 20, Train Loss 0.812363, Valid_loss 1.753039
Epoch 21, Train Loss 0.815652, Valid_loss 1.499477
Epoch 22, Train Loss 0.827868, Valid_loss 1.510262
Epoch 23, Train Loss 0.823684, Valid_loss 1.512690
Epoch 24, Train Loss 0.818619, Valid_loss 1.976483
Epoch 25, Train Loss 0.803637, Valid_loss 2.110809
Epoch 26, Train Loss 0.828271, Valid_loss 1.683394
Epoch 27, Train Loss 0.816102, Valid_loss 1.746382
Epoch 28, Train Loss 0.816860, Valid_loss 1.833344
Epoch 29, Train Loss 0.833666, Valid_loss 1.880665
Epoch 30, Train Loss 0.836579, Valid_loss 1.613018
Epoch 31, Train Loss 0.818302, Valid_loss 1.709540
Epoch 32, Train Loss 0.812094, Valid_loss 1.635133
Epoch 33, Train Loss 0.834598, Valid_loss 1.653921
Epoch 34, Train Loss 0.818786, Valid_loss 1.708116
Epoch 35, Train Loss 0.814208, Valid_loss 1.750222
Epoch 36, Train Loss 0.821676, Valid_loss 1.648749
Epoch 37, Train Loss 0.825427, Valid_loss 1.698960
Epoch 38, Train Loss 0.814581, Valid_loss 1.688163
Epoch 39, Train Loss 0.818080, Valid_loss 1.699479
Epoch 40, Train Loss 0.810545, Valid_loss 1.689499
Epoch 41, Train Loss 0.820568, Valid_loss 1.812617
Epoch 42, Train Loss 0.823637, Valid_loss 1.810316
Epoch 43, Train Loss 0.835986, Valid_loss 1.776237
Epoch 44, Train Loss 0.818749, Valid_loss 1.790317
Epoch 45, Train Loss 0.818351, Valid_loss 1.817763
Epoch 46, Train Loss 0.816669, Valid_loss 1.821519
Epoch 47, Train Loss 0.817564, Valid_loss 1.777414
Epoch 48, Train Loss 0.811430, Valid_loss 1.819603
Epoch 49, Train Loss 0.817395, Valid_loss 1.795203
Epoch 50, Train Loss 0.821909, Valid_loss 1.791044
Epoch 51, Train Loss 0.815928, Valid_loss 1.834879
Epoch 52, Train Loss 0.812794, Valid_loss 1.858906
[I 2025-08-30 01:40:57,399] Trial 2 finished with value: 1.3617725318128413 and parameters: {'learning_rate': 0.01, 'epochs': 100, 'heads': 1, 'dropout': 0.0, 'weight_decay': 0.001, 'emb_dim': 64, 'augment_num': 100, 'pca': False}. Best is trial 2 with value: 1.3617725318128413.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 16.69 MB
Memory Reserved: 42.00 MB
cuda
CUDA OOM 발생 — 단계적 백오프 시작.
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 8585.43 MB
Memory Reserved: 8606.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 8585.42 MB
Memory Reserved: 8608.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 8585.42 MB
Memory Reserved: 8606.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 8585.42 MB
Memory Reserved: 8608.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[I 2025-08-30 01:40:58,762] Trial 3 pruned. Pruned due to OOM after backoff
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 8585.42 MB
Memory Reserved: 8606.00 MB
cuda
Epoch 1, Train Loss 1.095108, Valid_loss 1.215411
Epoch 2, Train Loss 1.023824, Valid_loss 1.205778
Epoch 3, Train Loss 1.014767, Valid_loss 1.198745
Epoch 4, Train Loss 1.049930, Valid_loss 1.176375
Epoch 5, Train Loss 0.975020, Valid_loss 1.177140
Epoch 6, Train Loss 0.973014, Valid_loss 1.144084
Epoch 7, Train Loss 0.933066, Valid_loss 1.138394
Epoch 8, Train Loss 0.902179, Valid_loss 1.163279
Epoch 9, Train Loss 0.900410, Valid_loss 1.132554
Epoch 10, Train Loss 0.864686, Valid_loss 1.120924
Epoch 11, Train Loss 0.852416, Valid_loss 1.097095
Epoch 12, Train Loss 0.810577, Valid_loss 1.089997
Epoch 13, Train Loss 0.756220, Valid_loss 1.056115
Epoch 14, Train Loss 0.829766, Valid_loss 1.074404
Epoch 15, Train Loss 0.785439, Valid_loss 1.036006
Epoch 16, Train Loss 0.759972, Valid_loss 1.039867
Epoch 17, Train Loss 0.730864, Valid_loss 1.037334
Epoch 18, Train Loss 0.762908, Valid_loss 1.020761
Epoch 19, Train Loss 0.714567, Valid_loss 0.992025
Epoch 20, Train Loss 0.685215, Valid_loss 1.010385
Epoch 21, Train Loss 0.729749, Valid_loss 1.006809
Epoch 22, Train Loss 0.757079, Valid_loss 1.027655
Epoch 23, Train Loss 0.687917, Valid_loss 1.019901
Epoch 24, Train Loss 0.716856, Valid_loss 1.020191
Epoch 25, Train Loss 0.658432, Valid_loss 0.996976
Epoch 26, Train Loss 0.657730, Valid_loss 0.960308
Epoch 27, Train Loss 0.688960, Valid_loss 1.007463
Epoch 28, Train Loss 0.695183, Valid_loss 0.963892
Epoch 29, Train Loss 0.679869, Valid_loss 0.985176
Epoch 30, Train Loss 0.667692, Valid_loss 0.972089
Epoch 31, Train Loss 0.632121, Valid_loss 0.937960
Epoch 32, Train Loss 0.691658, Valid_loss 0.970921
Epoch 33, Train Loss 0.666795, Valid_loss 0.951178
Epoch 34, Train Loss 0.651693, Valid_loss 0.985896
Epoch 35, Train Loss 0.604421, Valid_loss 0.972708
Epoch 36, Train Loss 0.639368, Valid_loss 0.932135
Epoch 37, Train Loss 0.587061, Valid_loss 0.962719
Epoch 38, Train Loss 0.594117, Valid_loss 0.929156
Epoch 39, Train Loss 0.624677, Valid_loss 0.940681
Epoch 40, Train Loss 0.597282, Valid_loss 0.910567
Epoch 41, Train Loss 0.674293, Valid_loss 0.972092
Epoch 42, Train Loss 0.634312, Valid_loss 0.941984
Epoch 43, Train Loss 0.591846, Valid_loss 0.928113
Epoch 44, Train Loss 0.634991, Valid_loss 0.926833
Epoch 45, Train Loss 0.594714, Valid_loss 0.920246
Epoch 46, Train Loss 0.560985, Valid_loss 0.933761
Epoch 47, Train Loss 0.576859, Valid_loss 0.970938
Epoch 48, Train Loss 0.591351, Valid_loss 0.925227
Epoch 49, Train Loss 0.535917, Valid_loss 0.929021
Epoch 50, Train Loss 0.585691, Valid_loss 0.962919
Epoch 51, Train Loss 0.607166, Valid_loss 0.896257
Epoch 52, Train Loss 0.535965, Valid_loss 0.944205
Epoch 53, Train Loss 0.467402, Valid_loss 0.912764
Epoch 54, Train Loss 0.513392, Valid_loss 0.935344
Epoch 55, Train Loss 0.563427, Valid_loss 0.917386
Epoch 56, Train Loss 0.525580, Valid_loss 0.927080
Epoch 57, Train Loss 0.506441, Valid_loss 0.919237
Epoch 58, Train Loss 0.568401, Valid_loss 0.934613
Epoch 59, Train Loss 0.560350, Valid_loss 0.904645
Epoch 60, Train Loss 0.452466, Valid_loss 0.946846
Epoch 61, Train Loss 0.451224, Valid_loss 0.943498
Epoch 62, Train Loss 0.489618, Valid_loss 0.929375
Epoch 63, Train Loss 0.521117, Valid_loss 0.910097
Epoch 64, Train Loss 0.463057, Valid_loss 0.907469
Epoch 65, Train Loss 0.462632, Valid_loss 0.924081
Epoch 66, Train Loss 0.504752, Valid_loss 0.909815
Epoch 67, Train Loss 0.461588, Valid_loss 0.973675
Epoch 68, Train Loss 0.470232, Valid_loss 0.917795
Epoch 69, Train Loss 0.460333, Valid_loss 0.908444
Epoch 70, Train Loss 0.479435, Valid_loss 0.943356
Epoch 71, Train Loss 0.429098, Valid_loss 0.941277
Epoch 72, Train Loss 0.447564, Valid_loss 0.909114
Epoch 73, Train Loss 0.452839, Valid_loss 0.910939
Epoch 74, Train Loss 0.439344, Valid_loss 0.971015
[I 2025-08-30 02:22:04,368] Trial 4 finished with value: 0.8962572311813181 and parameters: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 2, 'dropout': 0.5, 'weight_decay': 0.001, 'emb_dim': 8, 'augment_num': 100, 'pca': False}. Best is trial 4 with value: 0.8962572311813181.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 19.85 MB
Memory Reserved: 42.00 MB
cuda
CUDA OOM 발생 — 단계적 백오프 시작.
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 16934.53 MB
Memory Reserved: 16952.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 341.79 MB
Memory Reserved: 380.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 16933.90 MB
Memory Reserved: 16960.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 342.12 MB
Memory Reserved: 380.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[I 2025-08-30 02:22:06,046] Trial 5 pruned. Pruned due to OOM after backoff
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 16931.43 MB
Memory Reserved: 16962.00 MB
cuda
CUDA OOM 발생 — 단계적 백오프 시작.
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 312.71 MB
Memory Reserved: 352.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 16904.06 MB
Memory Reserved: 16944.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 312.06 MB
Memory Reserved: 352.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 16904.48 MB
Memory Reserved: 16944.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[I 2025-08-30 02:22:07,337] Trial 6 pruned. Pruned due to OOM after backoff
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 18.01 MB
Memory Reserved: 42.00 MB
cuda
CUDA OOM 발생 — 단계적 백오프 시작.
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 16903.99 MB
Memory Reserved: 16924.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 312.97 MB
Memory Reserved: 352.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 16903.99 MB
Memory Reserved: 16924.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 312.55 MB
Memory Reserved: 352.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[I 2025-08-30 02:22:08,938] Trial 7 pruned. Pruned due to OOM after backoff
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 16903.99 MB
Memory Reserved: 16944.00 MB
cuda
CUDA OOM 발생 — 단계적 백오프 시작.
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 4460.55 MB
Memory Reserved: 4500.00 MB
cuda
Epoch 1, Train Loss 0.852312, Valid_loss 1.763659
Epoch 2, Train Loss 0.895328, Valid_loss 1.826237
Epoch 3, Train Loss 0.685317, Valid_loss 1.498646
Epoch 4, Train Loss 0.586497, Valid_loss 1.533869
Epoch 5, Train Loss 0.519194, Valid_loss 1.482688
Epoch 6, Train Loss 0.579593, Valid_loss 2.127922
Epoch 7, Train Loss 0.499278, Valid_loss 2.168091
Epoch 8, Train Loss 0.479643, Valid_loss 1.437349
Epoch 9, Train Loss 0.462863, Valid_loss 1.476691
Epoch 10, Train Loss 0.421422, Valid_loss 1.462546
Epoch 11, Train Loss 0.408348, Valid_loss 1.821339
Epoch 12, Train Loss 0.417503, Valid_loss 1.492657
Epoch 13, Train Loss 0.329679, Valid_loss 1.394273
Epoch 14, Train Loss 0.383904, Valid_loss 1.573097
Epoch 15, Train Loss 0.295381, Valid_loss 1.625048
Epoch 16, Train Loss 0.302367, Valid_loss 1.130489
Epoch 17, Train Loss 0.259679, Valid_loss 2.112297
Epoch 18, Train Loss 0.352596, Valid_loss 2.674599
Epoch 19, Train Loss 0.264603, Valid_loss 1.384677
Epoch 20, Train Loss 0.448848, Valid_loss 1.802909
Epoch 21, Train Loss 0.310106, Valid_loss 1.602077
Epoch 22, Train Loss 0.260259, Valid_loss 1.744562
Epoch 23, Train Loss 0.233830, Valid_loss 1.955775
Epoch 24, Train Loss 0.220505, Valid_loss 2.596959
Epoch 25, Train Loss 0.271921, Valid_loss 2.383265
Epoch 26, Train Loss 0.326431, Valid_loss 1.872300
Epoch 27, Train Loss 0.194206, Valid_loss 2.181875
Epoch 28, Train Loss 0.173113, Valid_loss 2.699921
Epoch 29, Train Loss 0.163241, Valid_loss 1.107563
Epoch 30, Train Loss 0.293354, Valid_loss 1.194238
Epoch 31, Train Loss 0.216462, Valid_loss 1.210858
Epoch 32, Train Loss 0.338006, Valid_loss 1.516549
Epoch 33, Train Loss 0.185794, Valid_loss 2.647951
Epoch 34, Train Loss 0.168381, Valid_loss 0.888780
Epoch 35, Train Loss 0.168543, Valid_loss 1.861914
Epoch 36, Train Loss 0.120986, Valid_loss 2.203737
Epoch 37, Train Loss 0.085551, Valid_loss 2.367677
Epoch 38, Train Loss 0.082684, Valid_loss 2.151407
Epoch 39, Train Loss 0.295241, Valid_loss 2.989718
Epoch 40, Train Loss 0.394165, Valid_loss 0.725111
Epoch 41, Train Loss 0.160789, Valid_loss 1.506318
Epoch 42, Train Loss 0.112908, Valid_loss 0.807123
Epoch 43, Train Loss 0.080235, Valid_loss 1.492903
Epoch 44, Train Loss 0.207932, Valid_loss 0.641257
Epoch 45, Train Loss 0.229948, Valid_loss 1.454049
Epoch 46, Train Loss 0.087059, Valid_loss 0.792942
Epoch 47, Train Loss 0.072559, Valid_loss 1.462025
Epoch 48, Train Loss 0.061786, Valid_loss 1.657228
Epoch 49, Train Loss 0.091040, Valid_loss 4.206244
Epoch 50, Train Loss 0.473564, Valid_loss 1.483824
Epoch 51, Train Loss 0.102641, Valid_loss 1.036478
Epoch 52, Train Loss 0.051753, Valid_loss 1.074663
Epoch 53, Train Loss 0.043736, Valid_loss 1.822292
[I 2025-08-30 02:51:43,697] Trial 8 finished with value: 0.6412570641312579 and parameters: {'learning_rate': 0.001, 'epochs': 100, 'heads': 2, 'dropout': 0.3, 'weight_decay': 0.0001, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 8 with value: 0.6412570641312579.
선택된 trial params: {'learning_rate': 0.001, 'epochs': 100, 'heads': 2, 'dropout': 0.3, 'weight_decay': 0.0001, 'emb_dim': 32, 'augment_num': 100, 'pca': False}
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=9, batch_size=1 -> steps=9
Memory Allocated: 4460.55 MB
Memory Reserved: 4500.00 MB
cuda
Epoch 1, Train Loss 0.865516, Valid_loss 1.682363
Epoch 2, Train Loss 0.736712, Valid_loss 1.404215
Epoch 3, Train Loss 0.549792, Valid_loss 1.206861
Epoch 4, Train Loss 0.505145, Valid_loss 1.415109
Epoch 5, Train Loss 0.491778, Valid_loss 1.987213
Epoch 6, Train Loss 0.408345, Valid_loss 1.193454
Epoch 7, Train Loss 0.650945, Valid_loss 1.339682
Epoch 8, Train Loss 0.457489, Valid_loss 1.160116
Epoch 9, Train Loss 0.421006, Valid_loss 2.262443
Epoch 10, Train Loss 0.509823, Valid_loss 1.538535
Epoch 11, Train Loss 0.414471, Valid_loss 1.439958
Epoch 12, Train Loss 0.392992, Valid_loss 1.342787
Epoch 13, Train Loss 0.341993, Valid_loss 1.400524
Epoch 14, Train Loss 0.323835, Valid_loss 1.622025
Epoch 15, Train Loss 0.294555, Valid_loss 1.131606
Epoch 16, Train Loss 0.327871, Valid_loss 2.106879
Epoch 17, Train Loss 0.397662, Valid_loss 1.109668
Epoch 18, Train Loss 0.369378, Valid_loss 1.242046
Epoch 19, Train Loss 0.520749, Valid_loss 1.927921
Epoch 20, Train Loss 0.292697, Valid_loss 1.570920
Epoch 21, Train Loss 0.338392, Valid_loss 1.551660
Epoch 22, Train Loss 0.270452, Valid_loss 1.397744
Epoch 23, Train Loss 0.307980, Valid_loss 1.815348
Epoch 24, Train Loss 0.426062, Valid_loss 2.475307
Epoch 25, Train Loss 0.308824, Valid_loss 1.346631
Epoch 26, Train Loss 0.266026, Valid_loss 1.129033
Epoch 27, Train Loss 0.260290, Valid_loss 1.333056
Epoch 28, Train Loss 0.258481, Valid_loss 1.139223
Epoch 29, Train Loss 0.219117, Valid_loss 0.787906
Epoch 30, Train Loss 0.237794, Valid_loss 1.350062
Epoch 31, Train Loss 0.200373, Valid_loss 1.171579
Epoch 32, Train Loss 0.208149, Valid_loss 0.761885
Epoch 33, Train Loss 0.175691, Valid_loss 1.165353
Epoch 34, Train Loss 0.254438, Valid_loss 0.927341
Epoch 35, Train Loss 0.176920, Valid_loss 1.335868
Epoch 36, Train Loss 0.125032, Valid_loss 0.877911
Epoch 37, Train Loss 0.101860, Valid_loss 0.969685
Epoch 38, Train Loss 0.304674, Valid_loss 1.471441
Epoch 39, Train Loss 0.352901, Valid_loss 2.053666
Epoch 40, Train Loss 0.261145, Valid_loss 0.839426
Epoch 41, Train Loss 0.129395, Valid_loss 1.160725
Epoch 42, Train Loss 0.126155, Valid_loss 1.146109
Epoch 43, Train Loss 0.120933, Valid_loss 0.986501
Epoch 44, Train Loss 0.212075, Valid_loss 0.763640
Epoch 45, Train Loss 0.259060, Valid_loss 1.110383
Epoch 46, Train Loss 0.124625, Valid_loss 0.543386
Epoch 47, Train Loss 0.112189, Valid_loss 1.269065
Epoch 48, Train Loss 0.150015, Valid_loss 1.765809
Epoch 49, Train Loss 0.174134, Valid_loss 1.382988
Epoch 50, Train Loss 0.103121, Valid_loss 1.424409
Epoch 51, Train Loss 0.091468, Valid_loss 1.510694
Epoch 52, Train Loss 0.077248, Valid_loss 1.555982
환자ID=P1358 -- true: [[2]] -- pred: tensor([[-3.8955,  1.0316,  0.4881]], device='cuda:0')
환자ID=P1425 -- true: [[1]] -- pred: tensor([[-3.9311,  1.0534,  0.4860]], device='cuda:0')
환자ID=P1479 -- true: [[1]] -- pred: tensor([[ 3.2368, -2.1783, -7.3866]], device='cuda:0')
환자ID=P1510 -- true: [[1]] -- pred: tensor([[-4.0467,  1.2161,  0.3258]], device='cuda:0')
환자ID=P1515 -- true: [[0]] -- pred: tensor([[ 4.8242, -3.4599, -7.8072]], device='cuda:0')
환자ID=P1610 -- true: [[0]] -- pred: tensor([[ 4.8222, -3.4394, -7.8434]], device='cuda:0')
환자ID=P1617 -- true: [[2]] -- pred: tensor([[-3.9138,  1.0510,  0.4764]], device='cuda:0')
환자ID=P1702 -- true: [[0]] -- pred: tensor([[ 4.8080, -3.4119, -7.8562]], device='cuda:0')
환자ID=P1718 -- true: [[0]] -- pred: tensor([[ 4.8197, -3.4301, -7.8611]], device='cuda:0')
Best performance: Epoch 46, Loss 0.124625, Test ACC 0.666667, Test AUC 0.888889, Test Recall 0.555556, Test Precision 0.433333
Confusion Matrix:
 [[4 0 0]
 [1 2 0]
 [0 2 0]]
✅ Total valid splits used: 1
🔁 Repeat 3, Fold 1
cell type :  TTCTTCCGTTCAACGT-1-0                Astrocyte
CATCCACCATCTAACG-1-0      Smooth_muscle_cells
ACCCAAACAGCTAACT-1-0                  Neurons
AAGGAATCAACTGGTT-1-0     Neuroepithelial_cell
TACCCGTAGCGTGCTC-1-0                Astrocyte
                                 ...         
TTATTGCGTCGGTGTC-1-79       Endothelial_cells
GTCACGGGTTGTATGC-1-79       Endothelial_cells
GTCATGATCTTTCGAT-1-79       Endothelial_cells
GCGATCGTCAGAGTGG-1-79               Platelets
GCCCGAACAGAGAAAG-1-79       Endothelial_cells
Name: singler_annotation, Length: 484018, dtype: string
cell type annotation :  TTCTTCCGTTCAACGT-1-0                Astrocyte
CATCCACCATCTAACG-1-0      Smooth_muscle_cells
ACCCAAACAGCTAACT-1-0                  Neurons
AAGGAATCAACTGGTT-1-0     Neuroepithelial_cell
TACCCGTAGCGTGCTC-1-0                Astrocyte
                                 ...         
TTATTGCGTCGGTGTC-1-79       Endothelial_cells
GTCACGGGTTGTATGC-1-79       Endothelial_cells
GTCATGATCTTTCGAT-1-79       Endothelial_cells
GCGATCGTCAGAGTGG-1-79               Platelets
GCCCGAACAGAGAAAG-1-79       Endothelial_cells
Name: singler_annotation, Length: 484018, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Astrocyte', 'Smooth_muscle_cells', 'Neurons', 'Neuroepithelial_cell', 'Endothelial_cells', 'Osteoblasts', 'Platelets', 'Hepatocytes', 'Embryonic_stem_cells', 'MEP', 'Erythroblast', 'Fibroblasts', 'iPS_cells', 'MSC', 'Macrophage', 'Gametocytes', 'Chondrocytes', 'NK_cell', 'Neutrophils', 'HSC_CD34+', 'Monocyte', 'Tissue_stem_cells', 'DC', 'HSC_-G-CSF', 'T_cells', 'Epithelial_cells', 'Unknown', 'Pre-B_cell_CD34-', 'GMP', 'B_cell', 'Pro-Myelocyte', 'Keratinocytes', 'Myelocyte', 'BM', 'CMP', 'BM & Prog.', 'Pro-B_cell_CD34+']
라벨별 그룹 개수 {2: 8, 1: 12, 0: 13}
cell type :  ACAGCCGCAAGCGAGT-1-1                 Neurons
ATATCCTGTCCCTAAA-1-1       Endothelial_cells
CAATGACCAGTTGTCA-1-1                 Neurons
CTAGACACAAGGTTGG-1-1                 Neurons
ATCGTCCGTATTTCTC-1-1     Smooth_muscle_cells
                                ...         
CGTCCATAGAATTTGG-1-78      Endothelial_cells
GCTTCACAGCGTTGTT-1-78            Hepatocytes
TCTCTGGCAGTCGCAC-1-78                Neurons
CAACAACCAGAGGCTA-1-78                Neurons
CATTGTTGTCGTACAT-1-78      Endothelial_cells
Name: singler_annotation, Length: 108671, dtype: string
cell type annotation :  ACAGCCGCAAGCGAGT-1-1                 Neurons
ATATCCTGTCCCTAAA-1-1       Endothelial_cells
CAATGACCAGTTGTCA-1-1                 Neurons
CTAGACACAAGGTTGG-1-1                 Neurons
ATCGTCCGTATTTCTC-1-1     Smooth_muscle_cells
                                ...         
CGTCCATAGAATTTGG-1-78      Endothelial_cells
GCTTCACAGCGTTGTT-1-78            Hepatocytes
TCTCTGGCAGTCGCAC-1-78                Neurons
CAACAACCAGAGGCTA-1-78                Neurons
CATTGTTGTCGTACAT-1-78      Endothelial_cells
Name: singler_annotation, Length: 108671, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Neurons', 'Endothelial_cells', 'Smooth_muscle_cells', 'Neuroepithelial_cell', 'Astrocyte', 'Fibroblasts', 'Osteoblasts', 'Erythroblast', 'iPS_cells', 'Embryonic_stem_cells', 'Platelets', 'MSC', 'Hepatocytes', 'NK_cell', 'MEP', 'BM & Prog.', 'Gametocytes', 'Chondrocytes', 'HSC_CD34+', 'Tissue_stem_cells', 'Macrophage', 'Monocyte', 'Neutrophils', 'DC', 'HSC_-G-CSF', 'Unknown', 'Keratinocytes', 'B_cell', 'T_cells', 'Myelocyte', 'Epithelial_cells', 'GMP', 'BM', 'Pro-Myelocyte', 'Pro-B_cell_CD34+', 'CMP', 'Pre-B_cell_CD34-']
라벨별 그룹 개수 {2: 3, 1: 3, 0: 3}
🔍 Split #2
  → train_p_index 환자 수 (환자 단위로 묶인 index list): 33
  → test_p_index 환자 수  (환자 단위로 묶인 index list): 9
  → train 환자 ID: ['P1304', 'P1358', 'P1371', 'P1425', 'P1430', 'P1437', 'P1447', 'P1462', 'P1472', 'P1479', 'P1504', 'P1508', 'P1510', 'P1515', 'P1539', 'P1549', 'P1558', 'P1561', 'P1582', 'P1600', 'P1602', 'P1603', 'P1610', 'P1617', 'P1622', 'P1630', 'P1631', 'P1678', 'P1685', 'P1702', 'P1718', 'P1722', 'P1735']
  → test  환자 ID: ['P1290', 'P1300', 'P1422', 'P1516', 'P1540', 'P1547', 'P1606', 'P1707', 'P1726']
  → train 환자 ID 및 라벨:
    ID: P1304, Label: 2
    ID: P1358, Label: 2
    ID: P1371, Label: 2
    ID: P1425, Label: 1
    ID: P1430, Label: 2
    ID: P1437, Label: 2
    ID: P1447, Label: 1
    ID: P1462, Label: 1
    ID: P1472, Label: 2
    ID: P1479, Label: 1
    ID: P1504, Label: 2
    ID: P1508, Label: 1
    ID: P1510, Label: 1
    ID: P1515, Label: 0
    ID: P1539, Label: 0
    ID: P1549, Label: 0
    ID: P1558, Label: 0
    ID: P1561, Label: 0
    ID: P1582, Label: 0
    ID: P1600, Label: 0
    ID: P1602, Label: 1
    ID: P1603, Label: 0
    ID: P1610, Label: 0
    ID: P1617, Label: 2
    ID: P1622, Label: 0
    ID: P1630, Label: 1
    ID: P1631, Label: 1
    ID: P1678, Label: 0
    ID: P1685, Label: 1
    ID: P1702, Label: 0
    ID: P1718, Label: 0
    ID: P1722, Label: 1
    ID: P1735, Label: 1
  → test 환자 ID 및 라벨:
    ID: P1290, Label: 2
    ID: P1300, Label: 2
    ID: P1422, Label: 1
    ID: P1516, Label: 0
    ID: P1540, Label: 0
    ID: P1547, Label: 0
    ID: P1606, Label: 2
    ID: P1707, Label: 1
    ID: P1726, Label: 1
전체 데이터 index 길이 42
label_stat (train 환자 라벨 목록) 갯수 33
train_data에서 환자 단위로, train과 validation 나누기
기존 train_p_index 33
기존 (train) label_stat 33
train-vali 분할 후! 
train y 의 classes : {0, 1, 2} valid y 의 classes : {0, 1, 2} label_stat 의 classes : {0, 1, 2}
train_p_index_ 22
valid_p_index 11
test_p_index 9
→ train 환자 ID 및 라벨:
   총 개수: 22
   환자ID=P1603, Label=0, 셀개수=10638
   환자ID=P1718, Label=0, 셀개수=9278
   환자ID=P1539, Label=0, 셀개수=11076
   환자ID=P1371, Label=2, 셀개수=16233
   환자ID=P1472, Label=2, 셀개수=19513
   환자ID=P1617, Label=2, 셀개수=17986
   환자ID=P1631, Label=1, 셀개수=13686
   환자ID=P1430, Label=2, 셀개수=11131
   환자ID=P1735, Label=1, 셀개수=12009
   환자ID=P1702, Label=0, 셀개수=13550
   환자ID=P1558, Label=0, 셀개수=10469
   환자ID=P1678, Label=0, 셀개수=10085
   환자ID=P1510, Label=1, 셀개수=10744
   환자ID=P1437, Label=2, 셀개수=21695
   환자ID=P1630, Label=1, 셀개수=17633
   환자ID=P1515, Label=0, 셀개수=14502
   환자ID=P1610, Label=0, 셀개수=13919
   환자ID=P1508, Label=1, 셀개수=20536
   환자ID=P1504, Label=2, 셀개수=8133
   환자ID=P1462, Label=1, 셀개수=21715
   환자ID=P1602, Label=1, 셀개수=16580
   환자ID=P1549, Label=0, 셀개수=11709
→ valid 환자 ID 및 라벨:
   총 개수: 11
   환자ID=P1358, Label=2, 셀개수=23984
   환자ID=P1447, Label=1, 셀개수=11151
   환자ID=P1561, Label=0, 셀개수=10016
   환자ID=P1479, Label=1, 셀개수=19124
   환자ID=P1304, Label=2, 셀개수=19123
   환자ID=P1600, Label=0, 셀개수=14882
   환자ID=P1722, Label=1, 셀개수=21432
   환자ID=P1582, Label=0, 셀개수=18855
   환자ID=P1685, Label=1, 셀개수=10043
   환자ID=P1425, Label=1, 셀개수=15378
   환자ID=P1622, Label=0, 셀개수=7210
→ test 환자 ID 및 라벨:
   총 개수: 9
   환자ID=P1290, Label=2, 셀개수=8357
   환자ID=P1300, Label=2, 셀개수=17318
   환자ID=P1422, Label=1, 셀개수=23315
   환자ID=P1516, Label=0, 셀개수=9361
   환자ID=P1540, Label=0, 셀개수=11638
   환자ID=P1547, Label=0, 셀개수=8253
   환자ID=P1606, Label=2, 셀개수=8523
   환자ID=P1707, Label=1, 셀개수=9517
   환자ID=P1726, Label=1, 셀개수=12389
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Astrocyte', 'Smooth_muscle_cells', 'Neurons', 'Neuroepithelial_cell', 'Astrocyte', 'Endothelial_cells', 'Osteoblasts', 'Platelets', 'Neurons', 'Hepatocytes']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
전체 데이터 길이 592689
전체 cell type 길이 0                    Astrocyte
1          Smooth_muscle_cells
2                      Neurons
3         Neuroepithelial_cell
4                    Astrocyte
                  ...         
592684       Endothelial_cells
592685             Hepatocytes
592686                 Neurons
592687                 Neurons
592688       Endothelial_cells
Length: 592689, dtype: string
cell type의 NaN 개수 체크 0
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:11,  8.48it/s]  2%|▏         | 2/100 [00:00<00:12,  8.16it/s]  3%|▎         | 3/100 [00:00<00:12,  8.04it/s]  4%|▍         | 4/100 [00:00<00:11,  8.25it/s]  5%|▌         | 5/100 [00:00<00:11,  8.37it/s]  6%|▌         | 6/100 [00:00<00:11,  8.20it/s]  7%|▋         | 7/100 [00:00<00:11,  8.08it/s]  8%|▊         | 8/100 [00:00<00:11,  8.11it/s]  9%|▉         | 9/100 [00:01<00:11,  8.24it/s] 10%|█         | 10/100 [00:01<00:11,  8.17it/s] 11%|█         | 11/100 [00:01<00:11,  8.06it/s] 12%|█▏        | 12/100 [00:01<00:10,  8.19it/s] 13%|█▎        | 13/100 [00:01<00:10,  8.22it/s] 14%|█▍        | 14/100 [00:01<00:10,  8.02it/s] 15%|█▌        | 15/100 [00:01<00:10,  8.00it/s] 16%|█▌        | 16/100 [00:01<00:10,  8.10it/s] 17%|█▋        | 17/100 [00:02<00:10,  7.95it/s] 18%|█▊        | 18/100 [00:02<00:10,  7.97it/s] 19%|█▉        | 19/100 [00:02<00:10,  8.02it/s] 20%|██        | 20/100 [00:02<00:09,  8.06it/s] 21%|██        | 21/100 [00:02<00:09,  8.06it/s] 22%|██▏       | 22/100 [00:02<00:09,  8.08it/s] 23%|██▎       | 23/100 [00:02<00:09,  7.96it/s] 24%|██▍       | 24/100 [00:02<00:09,  8.05it/s] 25%|██▌       | 25/100 [00:03<00:09,  7.98it/s] 26%|██▌       | 26/100 [00:03<00:09,  7.94it/s] 27%|██▋       | 27/100 [00:03<00:09,  8.10it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.09it/s] 29%|██▉       | 29/100 [00:03<00:08,  8.04it/s] 30%|███       | 30/100 [00:03<00:08,  8.09it/s] 31%|███       | 31/100 [00:03<00:08,  7.98it/s] 32%|███▏      | 32/100 [00:03<00:08,  7.99it/s] 33%|███▎      | 33/100 [00:04<00:08,  7.88it/s] 34%|███▍      | 34/100 [00:04<00:08,  7.94it/s] 35%|███▌      | 35/100 [00:04<00:08,  7.93it/s] 36%|███▌      | 36/100 [00:04<00:08,  7.87it/s] 37%|███▋      | 37/100 [00:04<00:08,  7.81it/s] 38%|███▊      | 38/100 [00:04<00:08,  7.63it/s] 39%|███▉      | 39/100 [00:04<00:07,  7.67it/s] 40%|████      | 40/100 [00:05<00:08,  7.47it/s] 41%|████      | 41/100 [00:05<00:07,  7.52it/s] 42%|████▏     | 42/100 [00:05<00:07,  7.54it/s] 43%|████▎     | 43/100 [00:05<00:07,  7.44it/s] 44%|████▍     | 44/100 [00:05<00:07,  7.43it/s] 45%|████▌     | 45/100 [00:05<00:07,  7.56it/s] 46%|████▌     | 46/100 [00:05<00:07,  7.45it/s] 47%|████▋     | 47/100 [00:05<00:07,  7.44it/s] 48%|████▊     | 48/100 [00:06<00:07,  7.41it/s] 49%|████▉     | 49/100 [00:06<00:06,  7.45it/s] 50%|█████     | 50/100 [00:06<00:06,  7.59it/s] 51%|█████     | 51/100 [00:06<00:06,  7.44it/s] 52%|█████▏    | 52/100 [00:06<00:06,  7.55it/s] 53%|█████▎    | 53/100 [00:06<00:06,  7.54it/s] 54%|█████▍    | 54/100 [00:06<00:06,  7.39it/s] 55%|█████▌    | 55/100 [00:07<00:06,  7.36it/s] 56%|█████▌    | 56/100 [00:07<00:05,  7.45it/s] 57%|█████▋    | 57/100 [00:07<00:05,  7.54it/s] 58%|█████▊    | 58/100 [00:07<00:05,  7.50it/s] 59%|█████▉    | 59/100 [00:07<00:05,  7.41it/s] 60%|██████    | 60/100 [00:07<00:05,  7.33it/s] 61%|██████    | 61/100 [00:07<00:05,  7.29it/s] 62%|██████▏   | 62/100 [00:07<00:05,  7.44it/s] 63%|██████▎   | 63/100 [00:08<00:04,  7.44it/s] 64%|██████▍   | 64/100 [00:08<00:04,  7.36it/s] 65%|██████▌   | 65/100 [00:08<00:04,  7.24it/s] 66%|██████▌   | 66/100 [00:08<00:04,  7.18it/s] 67%|██████▋   | 67/100 [00:08<00:04,  7.14it/s] 68%|██████▊   | 68/100 [00:08<00:04,  7.10it/s] 69%|██████▉   | 69/100 [00:08<00:04,  7.20it/s] 70%|███████   | 70/100 [00:09<00:04,  7.20it/s] 71%|███████   | 71/100 [00:09<00:03,  7.25it/s] 72%|███████▏  | 72/100 [00:09<00:03,  7.25it/s] 73%|███████▎  | 73/100 [00:09<00:03,  7.21it/s] 74%|███████▍  | 74/100 [00:09<00:03,  7.27it/s] 75%|███████▌  | 75/100 [00:09<00:03,  7.21it/s] 76%|███████▌  | 76/100 [00:09<00:03,  7.26it/s] 77%|███████▋  | 77/100 [00:10<00:03,  7.19it/s] 78%|███████▊  | 78/100 [00:10<00:03,  7.15it/s] 79%|███████▉  | 79/100 [00:10<00:02,  7.15it/s] 80%|████████  | 80/100 [00:10<00:02,  7.17it/s] 81%|████████  | 81/100 [00:10<00:02,  7.01it/s] 82%|████████▏ | 82/100 [00:10<00:02,  7.05it/s] 83%|████████▎ | 83/100 [00:10<00:02,  6.88it/s] 84%|████████▍ | 84/100 [00:11<00:02,  6.93it/s] 85%|████████▌ | 85/100 [00:11<00:02,  6.70it/s] 86%|████████▌ | 86/100 [00:11<00:02,  6.85it/s] 87%|████████▋ | 87/100 [00:11<00:01,  6.65it/s] 88%|████████▊ | 88/100 [00:11<00:01,  6.69it/s] 89%|████████▉ | 89/100 [00:11<00:01,  6.64it/s] 90%|█████████ | 90/100 [00:11<00:01,  6.70it/s] 91%|█████████ | 91/100 [00:12<00:01,  6.70it/s] 92%|█████████▏| 92/100 [00:12<00:01,  6.79it/s] 93%|█████████▎| 93/100 [00:12<00:01,  6.90it/s] 94%|█████████▍| 94/100 [00:12<00:00,  6.91it/s] 95%|█████████▌| 95/100 [00:12<00:00,  6.76it/s] 96%|█████████▌| 96/100 [00:12<00:00,  6.83it/s] 97%|█████████▋| 97/100 [00:12<00:00,  6.70it/s] 98%|█████████▊| 98/100 [00:13<00:00,  6.71it/s] 99%|█████████▉| 99/100 [00:13<00:00,  6.70it/s]100%|██████████| 100/100 [00:13<00:00,  6.81it/s]100%|██████████| 100/100 [00:13<00:00,  7.45it/s]
[I 2025-08-30 03:21:35,530] A new study created in memory with name: no-name-f45a92c0-d204-4e46-9858-d115e8574eee
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 16.69 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 1.108376, Valid_loss 1.038314
Epoch 2, Train Loss 1.004417, Valid_loss 1.047619
Epoch 3, Train Loss 0.984758, Valid_loss 1.054939
Epoch 4, Train Loss 0.981819, Valid_loss 1.068183
Epoch 5, Train Loss 0.964521, Valid_loss 1.085761
Epoch 6, Train Loss 0.961243, Valid_loss 1.069871
Epoch 7, Train Loss 0.962730, Valid_loss 1.068405
Epoch 8, Train Loss 0.956766, Valid_loss 1.077540
Epoch 9, Train Loss 0.956153, Valid_loss 1.080815
Epoch 10, Train Loss 0.956194, Valid_loss 1.084289
Epoch 11, Train Loss 0.958897, Valid_loss 1.078654
Epoch 12, Train Loss 0.956806, Valid_loss 1.071131
Epoch 13, Train Loss 0.959037, Valid_loss 1.077622
Epoch 14, Train Loss 0.955452, Valid_loss 1.082110
Epoch 15, Train Loss 0.955452, Valid_loss 1.076204
Epoch 16, Train Loss 0.953946, Valid_loss 1.089180
Epoch 17, Train Loss 0.954640, Valid_loss 1.081120
Epoch 18, Train Loss 0.957267, Valid_loss 1.073931
Epoch 19, Train Loss 0.956443, Valid_loss 1.077448
Epoch 20, Train Loss 0.956430, Valid_loss 1.081382
Epoch 21, Train Loss 0.954244, Valid_loss 1.076746
Epoch 22, Train Loss 0.956887, Valid_loss 1.077664
Epoch 23, Train Loss 0.955895, Valid_loss 1.078236
Epoch 24, Train Loss 0.953496, Valid_loss 1.081155
Epoch 25, Train Loss 0.955874, Valid_loss 1.075558
Epoch 26, Train Loss 0.956659, Valid_loss 1.075973
Epoch 27, Train Loss 0.955835, Valid_loss 1.078137
Epoch 28, Train Loss 0.954963, Valid_loss 1.082339
Epoch 29, Train Loss 0.954945, Valid_loss 1.079665
Epoch 30, Train Loss 0.954397, Valid_loss 1.077039
Epoch 31, Train Loss 0.957007, Valid_loss 1.070438
Epoch 32, Train Loss 0.953805, Valid_loss 1.079002
Epoch 33, Train Loss 0.956433, Valid_loss 1.084667
Epoch 34, Train Loss 0.957999, Valid_loss 1.091618
Epoch 35, Train Loss 0.955547, Valid_loss 1.082528
Epoch 36, Train Loss 0.956567, Valid_loss 1.077418
Epoch 37, Train Loss 0.955836, Valid_loss 1.088746
Epoch 38, Train Loss 0.955165, Valid_loss 1.079989
Epoch 39, Train Loss 0.954958, Valid_loss 1.083910
Epoch 40, Train Loss 0.958082, Valid_loss 1.077559
Epoch 41, Train Loss 0.954804, Valid_loss 1.082383
Epoch 42, Train Loss 0.958901, Valid_loss 1.088832
Epoch 43, Train Loss 0.954584, Valid_loss 1.079831
Epoch 44, Train Loss 0.957705, Valid_loss 1.085989
Epoch 45, Train Loss 0.953960, Valid_loss 1.088446
Epoch 46, Train Loss 0.956415, Valid_loss 1.085697
Epoch 47, Train Loss 0.953912, Valid_loss 1.086064
Epoch 48, Train Loss 0.956656, Valid_loss 1.077715
Epoch 49, Train Loss 0.956063, Valid_loss 1.078689
Epoch 50, Train Loss 0.955252, Valid_loss 1.081281
Epoch 51, Train Loss 0.953135, Valid_loss 1.082579
Epoch 52, Train Loss 0.953449, Valid_loss 1.079293
Epoch 53, Train Loss 0.952855, Valid_loss 1.084416
Epoch 54, Train Loss 0.954691, Valid_loss 1.082913
Epoch 55, Train Loss 0.952616, Valid_loss 1.080066
Epoch 56, Train Loss 0.954315, Valid_loss 1.083086
Epoch 57, Train Loss 0.953233, Valid_loss 1.082687
Epoch 58, Train Loss 0.952331, Valid_loss 1.085698
Epoch 59, Train Loss 0.953737, Valid_loss 1.080693
Epoch 60, Train Loss 0.952654, Valid_loss 1.082116
Epoch 61, Train Loss 0.955452, Valid_loss 1.081025
Epoch 62, Train Loss 0.953467, Valid_loss 1.079286
Epoch 63, Train Loss 0.952900, Valid_loss 1.074902
Epoch 64, Train Loss 0.952888, Valid_loss 1.076417
Epoch 65, Train Loss 0.952875, Valid_loss 1.078393
[I 2025-08-30 03:54:40,508] Trial 0 finished with value: 1.038314239545302 and parameters: {'learning_rate': 0.01, 'epochs': 100, 'heads': 2, 'dropout': 0.7, 'weight_decay': 0.01, 'emb_dim': 8, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 1.038314239545302.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 18.01 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 1.118833, Valid_loss 1.158446
Epoch 2, Train Loss 1.013887, Valid_loss 1.107374
Epoch 3, Train Loss 0.993230, Valid_loss 1.067043
Epoch 4, Train Loss 0.983174, Valid_loss 1.078829
Epoch 5, Train Loss 0.963848, Valid_loss 1.169443
Epoch 6, Train Loss 0.978607, Valid_loss 1.090393
Epoch 7, Train Loss 1.006894, Valid_loss 1.060978
Epoch 8, Train Loss 0.977726, Valid_loss 1.049719
Epoch 9, Train Loss 0.973246, Valid_loss 1.053381
Epoch 10, Train Loss 0.965450, Valid_loss 1.068948
Epoch 11, Train Loss 0.961345, Valid_loss 1.066657
Epoch 12, Train Loss 0.956132, Valid_loss 1.078558
Epoch 13, Train Loss 0.959898, Valid_loss 1.072655
Epoch 14, Train Loss 0.956199, Valid_loss 1.078765
Epoch 15, Train Loss 0.956639, Valid_loss 1.080205
Epoch 16, Train Loss 0.956289, Valid_loss 1.082680
Epoch 17, Train Loss 0.957420, Valid_loss 1.086087
Epoch 18, Train Loss 0.959330, Valid_loss 1.086001
Epoch 19, Train Loss 0.953623, Valid_loss 1.080098
Epoch 20, Train Loss 0.952900, Valid_loss 1.083686
Epoch 21, Train Loss 0.954895, Valid_loss 1.084750
Epoch 22, Train Loss 0.955493, Valid_loss 1.091609
Epoch 23, Train Loss 0.954147, Valid_loss 1.088320
Epoch 24, Train Loss 0.971114, Valid_loss 1.080824
Epoch 25, Train Loss 0.954482, Valid_loss 1.086579
Epoch 26, Train Loss 0.954932, Valid_loss 1.089828
Epoch 27, Train Loss 0.953449, Valid_loss 1.084205
Epoch 28, Train Loss 0.954670, Valid_loss 1.090515
Epoch 29, Train Loss 0.957240, Valid_loss 1.079876
Epoch 30, Train Loss 0.954497, Valid_loss 1.091047
Epoch 31, Train Loss 0.965300, Valid_loss 1.097363
Epoch 32, Train Loss 0.954935, Valid_loss 1.091691
Epoch 33, Train Loss 0.954871, Valid_loss 1.090479
Epoch 34, Train Loss 0.954836, Valid_loss 1.089492
Epoch 35, Train Loss 0.954101, Valid_loss 1.092781
Epoch 36, Train Loss 0.955225, Valid_loss 1.086799
Epoch 37, Train Loss 0.954413, Valid_loss 1.086354
Epoch 38, Train Loss 0.953744, Valid_loss 1.083771
Epoch 39, Train Loss 0.953396, Valid_loss 1.086096
Epoch 40, Train Loss 0.957757, Valid_loss 1.085219
Epoch 41, Train Loss 0.959291, Valid_loss 1.088887
Epoch 42, Train Loss 0.956205, Valid_loss 1.088660
Epoch 43, Train Loss 0.954427, Valid_loss 1.091129
Epoch 44, Train Loss 0.953891, Valid_loss 1.088276
Epoch 45, Train Loss 0.954245, Valid_loss 1.096489
Epoch 46, Train Loss 0.955153, Valid_loss 1.091726
Epoch 47, Train Loss 0.956481, Valid_loss 1.084102
Epoch 48, Train Loss 0.954321, Valid_loss 1.083868
Epoch 49, Train Loss 0.954208, Valid_loss 1.084960
Epoch 50, Train Loss 1.025390, Valid_loss 1.187476
Epoch 51, Train Loss 0.986875, Valid_loss 1.083261
Epoch 52, Train Loss 0.952969, Valid_loss 1.081559
Epoch 53, Train Loss 0.952860, Valid_loss 1.080914
Epoch 54, Train Loss 0.952926, Valid_loss 1.085978
Epoch 55, Train Loss 0.954138, Valid_loss 1.082787
Epoch 56, Train Loss 0.954260, Valid_loss 1.084279
Epoch 57, Train Loss 0.953230, Valid_loss 1.086108
[I 2025-08-30 04:23:53,379] Trial 1 finished with value: 1.0497191710905596 and parameters: {'learning_rate': 0.01, 'epochs': 100, 'heads': 2, 'dropout': 0.7, 'weight_decay': 0.0001, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 1.038314239545302.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 19.85 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 1.175504, Valid_loss 1.104574
Epoch 2, Train Loss 1.041481, Valid_loss 1.091560
Epoch 3, Train Loss 1.048142, Valid_loss 1.100706
Epoch 4, Train Loss 1.005080, Valid_loss 1.047576
Epoch 5, Train Loss 1.014262, Valid_loss 1.093041
Epoch 6, Train Loss 0.985020, Valid_loss 1.094143
Epoch 7, Train Loss 0.988158, Valid_loss 1.052051
Epoch 8, Train Loss 0.976842, Valid_loss 1.084757
Epoch 9, Train Loss 0.974782, Valid_loss 1.074424
Epoch 10, Train Loss 0.965989, Valid_loss 1.072950
Epoch 11, Train Loss 0.962146, Valid_loss 1.079501
Epoch 12, Train Loss 0.955955, Valid_loss 1.090658
Epoch 13, Train Loss 0.963648, Valid_loss 1.077955
Epoch 14, Train Loss 0.959374, Valid_loss 1.078351
Epoch 15, Train Loss 0.954164, Valid_loss 1.079349
Epoch 16, Train Loss 0.953895, Valid_loss 1.079552
Epoch 17, Train Loss 0.954154, Valid_loss 1.089512
Epoch 18, Train Loss 0.954136, Valid_loss 1.083092
Epoch 19, Train Loss 0.955272, Valid_loss 1.088716
Epoch 20, Train Loss 0.955740, Valid_loss 1.089058
Epoch 21, Train Loss 0.955423, Valid_loss 1.080356
Epoch 22, Train Loss 0.955014, Valid_loss 1.090293
Epoch 23, Train Loss 0.955296, Valid_loss 1.083562
Epoch 24, Train Loss 0.954867, Valid_loss 1.090088
Epoch 25, Train Loss 0.954799, Valid_loss 1.112452
Epoch 26, Train Loss 0.960875, Valid_loss 1.087266
Epoch 27, Train Loss 0.955756, Valid_loss 1.086522
Epoch 28, Train Loss 0.957567, Valid_loss 1.088702
Epoch 29, Train Loss 0.955334, Valid_loss 1.088484
Epoch 30, Train Loss 0.954606, Valid_loss 1.090014
Epoch 31, Train Loss 0.954874, Valid_loss 1.084470
Epoch 32, Train Loss 0.956428, Valid_loss 1.084944
Epoch 33, Train Loss 0.954774, Valid_loss 1.082659
Epoch 34, Train Loss 0.955282, Valid_loss 1.087488
Epoch 35, Train Loss 0.956309, Valid_loss 1.090474
Epoch 36, Train Loss 0.956151, Valid_loss 1.084245
Epoch 37, Train Loss 0.965116, Valid_loss 1.086829
Epoch 38, Train Loss 0.956685, Valid_loss 1.090416
Epoch 39, Train Loss 0.956549, Valid_loss 1.095769
Epoch 40, Train Loss 0.953787, Valid_loss 1.088517
Epoch 41, Train Loss 0.953740, Valid_loss 1.088377
Epoch 42, Train Loss 0.953844, Valid_loss 1.089479
Epoch 43, Train Loss 0.953834, Valid_loss 1.091131
Epoch 44, Train Loss 0.956379, Valid_loss 1.083622
Epoch 45, Train Loss 0.955431, Valid_loss 1.093335
Epoch 46, Train Loss 0.954771, Valid_loss 1.083608
Epoch 47, Train Loss 0.956714, Valid_loss 1.090455
Epoch 48, Train Loss 0.988669, Valid_loss 1.080934
Epoch 49, Train Loss 0.955375, Valid_loss 1.075180
Epoch 50, Train Loss 0.954046, Valid_loss 1.084321
Epoch 51, Train Loss 0.952663, Valid_loss 1.085057
Epoch 52, Train Loss 0.953117, Valid_loss 1.083989
Epoch 53, Train Loss 0.953614, Valid_loss 1.086976
Epoch 54, Train Loss 0.952205, Valid_loss 1.083483
Epoch 55, Train Loss 0.952321, Valid_loss 1.084913
Epoch 56, Train Loss 0.952546, Valid_loss 1.087351
[I 2025-08-30 04:54:00,316] Trial 2 finished with value: 1.0475761836225337 and parameters: {'learning_rate': 0.01, 'epochs': 100, 'heads': 2, 'dropout': 0.5, 'weight_decay': 0.001, 'emb_dim': 64, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 1.038314239545302.
선택된 trial params: {'learning_rate': 0.01, 'epochs': 100, 'heads': 2, 'dropout': 0.7, 'weight_decay': 0.01, 'emb_dim': 8, 'augment_num': 100, 'pca': False}
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=9, batch_size=1 -> steps=9
Memory Allocated: 16.69 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 1.190298, Valid_loss 1.037437
Epoch 2, Train Loss 1.021808, Valid_loss 1.063761
Epoch 3, Train Loss 0.964354, Valid_loss 1.093715
Epoch 4, Train Loss 0.950084, Valid_loss 1.103982
Epoch 5, Train Loss 0.990707, Valid_loss 1.064765
Epoch 6, Train Loss 0.966588, Valid_loss 1.062814
Epoch 7, Train Loss 0.962599, Valid_loss 1.074762
Epoch 8, Train Loss 0.955070, Valid_loss 1.070310
Epoch 9, Train Loss 0.953188, Valid_loss 1.090543
Epoch 10, Train Loss 0.955620, Valid_loss 1.073648
Epoch 11, Train Loss 0.956544, Valid_loss 1.086783
Epoch 12, Train Loss 0.952184, Valid_loss 1.077213
Epoch 13, Train Loss 0.952104, Valid_loss 1.080441
Epoch 14, Train Loss 0.964101, Valid_loss 1.069692
Epoch 15, Train Loss 0.961275, Valid_loss 1.080610
Epoch 16, Train Loss 0.954945, Valid_loss 1.080160
Epoch 17, Train Loss 0.957867, Valid_loss 1.076204
Epoch 18, Train Loss 0.956810, Valid_loss 1.086515
Epoch 19, Train Loss 0.957262, Valid_loss 1.088335
Epoch 20, Train Loss 0.953747, Valid_loss 1.083198
Epoch 21, Train Loss 0.957421, Valid_loss 1.085261
Epoch 22, Train Loss 0.956975, Valid_loss 1.086362
Epoch 23, Train Loss 0.955231, Valid_loss 1.088943
Epoch 24, Train Loss 0.954661, Valid_loss 1.075058
Epoch 25, Train Loss 0.956853, Valid_loss 1.081350
Epoch 26, Train Loss 0.955100, Valid_loss 1.068481
Epoch 27, Train Loss 0.955187, Valid_loss 1.076037
Epoch 28, Train Loss 0.957666, Valid_loss 1.083334
Epoch 29, Train Loss 0.956997, Valid_loss 1.078811
Epoch 30, Train Loss 0.956028, Valid_loss 1.082289
Epoch 31, Train Loss 0.957495, Valid_loss 1.081485
Epoch 32, Train Loss 0.954848, Valid_loss 1.084635
Epoch 33, Train Loss 0.955861, Valid_loss 1.079779
Epoch 34, Train Loss 0.955178, Valid_loss 1.077193
Epoch 35, Train Loss 0.954361, Valid_loss 1.080349
Epoch 36, Train Loss 0.970555, Valid_loss 1.081176
Epoch 37, Train Loss 0.955381, Valid_loss 1.077359
Epoch 38, Train Loss 0.957001, Valid_loss 1.075755
Epoch 39, Train Loss 0.957526, Valid_loss 1.083767
Epoch 40, Train Loss 0.953813, Valid_loss 1.081568
Epoch 41, Train Loss 0.954694, Valid_loss 1.078568
Epoch 42, Train Loss 0.954325, Valid_loss 1.089979
Epoch 43, Train Loss 0.955769, Valid_loss 1.076471
Epoch 44, Train Loss 0.955256, Valid_loss 1.077753
Epoch 45, Train Loss 0.953614, Valid_loss 1.078314
Epoch 46, Train Loss 0.954908, Valid_loss 1.075027
Epoch 47, Train Loss 0.954312, Valid_loss 1.084884
Epoch 48, Train Loss 0.954545, Valid_loss 1.080470
Epoch 49, Train Loss 0.955742, Valid_loss 1.081452
Epoch 50, Train Loss 0.954904, Valid_loss 1.079496
Epoch 51, Train Loss 0.953106, Valid_loss 1.082487
Epoch 52, Train Loss 0.952425, Valid_loss 1.082221
Epoch 53, Train Loss 0.954810, Valid_loss 1.081811
Epoch 54, Train Loss 0.953393, Valid_loss 1.078701
Epoch 55, Train Loss 0.954813, Valid_loss 1.082025
Epoch 56, Train Loss 0.952037, Valid_loss 1.078831
Epoch 57, Train Loss 0.953758, Valid_loss 1.079170
Epoch 58, Train Loss 0.952429, Valid_loss 1.082977
환자ID=P1290 -- true: [[2]] -- pred: tensor([[-0.1686, -0.0192, -0.7740]], device='cuda:0')
환자ID=P1300 -- true: [[2]] -- pred: tensor([[-0.1689, -0.0213, -0.7737]], device='cuda:0')
환자ID=P1422 -- true: [[1]] -- pred: tensor([[-0.1683, -0.0169, -0.7755]], device='cuda:0')
환자ID=P1516 -- true: [[0]] -- pred: tensor([[-0.1687, -0.0225, -0.7726]], device='cuda:0')
환자ID=P1540 -- true: [[0]] -- pred: tensor([[-0.1687, -0.0211, -0.7737]], device='cuda:0')
환자ID=P1547 -- true: [[0]] -- pred: tensor([[-0.1684, -0.0187, -0.7737]], device='cuda:0')
환자ID=P1606 -- true: [[2]] -- pred: tensor([[-0.1685, -0.0164, -0.7745]], device='cuda:0')
환자ID=P1707 -- true: [[1]] -- pred: tensor([[-0.1683, -0.0149, -0.7749]], device='cuda:0')
환자ID=P1726 -- true: [[1]] -- pred: tensor([[-0.1686, -0.0166, -0.7753]], device='cuda:0')
Best performance: Epoch 1, Loss 1.190298, Test ACC 0.333333, Test AUC 0.833333, Test Recall 0.333333, Test Precision 0.111111
Confusion Matrix:
 [[0 3 0]
 [0 3 0]
 [0 3 0]]
✅ Total valid splits used: 2
🔁 Repeat 3, Fold 2
cell type :  ACAGCCGCAAGCGAGT-1-1                 Neurons
ATATCCTGTCCCTAAA-1-1       Endothelial_cells
CAATGACCAGTTGTCA-1-1                 Neurons
CTAGACACAAGGTTGG-1-1                 Neurons
ATCGTCCGTATTTCTC-1-1     Smooth_muscle_cells
                                ...         
CGTCCATAGAATTTGG-1-78      Endothelial_cells
GCTTCACAGCGTTGTT-1-78            Hepatocytes
TCTCTGGCAGTCGCAC-1-78                Neurons
CAACAACCAGAGGCTA-1-78                Neurons
CATTGTTGTCGTACAT-1-78      Endothelial_cells
Name: singler_annotation, Length: 480853, dtype: string
cell type annotation :  ACAGCCGCAAGCGAGT-1-1                 Neurons
ATATCCTGTCCCTAAA-1-1       Endothelial_cells
CAATGACCAGTTGTCA-1-1                 Neurons
CTAGACACAAGGTTGG-1-1                 Neurons
ATCGTCCGTATTTCTC-1-1     Smooth_muscle_cells
                                ...         
CGTCCATAGAATTTGG-1-78      Endothelial_cells
GCTTCACAGCGTTGTT-1-78            Hepatocytes
TCTCTGGCAGTCGCAC-1-78                Neurons
CAACAACCAGAGGCTA-1-78                Neurons
CATTGTTGTCGTACAT-1-78      Endothelial_cells
Name: singler_annotation, Length: 480853, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Neurons', 'Endothelial_cells', 'Smooth_muscle_cells', 'Neuroepithelial_cell', 'Astrocyte', 'Fibroblasts', 'Osteoblasts', 'Erythroblast', 'iPS_cells', 'Embryonic_stem_cells', 'Platelets', 'MSC', 'Hepatocytes', 'NK_cell', 'MEP', 'BM & Prog.', 'Gametocytes', 'Chondrocytes', 'HSC_CD34+', 'Tissue_stem_cells', 'Macrophage', 'Monocyte', 'Neutrophils', 'DC', 'HSC_-G-CSF', 'Unknown', 'Keratinocytes', 'B_cell', 'T_cells', 'Myelocyte', 'Epithelial_cells', 'GMP', 'BM', 'Pro-Myelocyte', 'Pro-B_cell_CD34+', 'CMP', 'Pre-B_cell_CD34-']
라벨별 그룹 개수 {2: 9, 1: 12, 0: 13}
cell type :  TTCTTCCGTTCAACGT-1-0                Astrocyte
CATCCACCATCTAACG-1-0      Smooth_muscle_cells
ACCCAAACAGCTAACT-1-0                  Neurons
AAGGAATCAACTGGTT-1-0     Neuroepithelial_cell
TACCCGTAGCGTGCTC-1-0                Astrocyte
                                 ...         
TTATTGCGTCGGTGTC-1-79       Endothelial_cells
GTCACGGGTTGTATGC-1-79       Endothelial_cells
GTCATGATCTTTCGAT-1-79       Endothelial_cells
GCGATCGTCAGAGTGG-1-79               Platelets
GCCCGAACAGAGAAAG-1-79       Endothelial_cells
Name: singler_annotation, Length: 111836, dtype: string
cell type annotation :  TTCTTCCGTTCAACGT-1-0                Astrocyte
CATCCACCATCTAACG-1-0      Smooth_muscle_cells
ACCCAAACAGCTAACT-1-0                  Neurons
AAGGAATCAACTGGTT-1-0     Neuroepithelial_cell
TACCCGTAGCGTGCTC-1-0                Astrocyte
                                 ...         
TTATTGCGTCGGTGTC-1-79       Endothelial_cells
GTCACGGGTTGTATGC-1-79       Endothelial_cells
GTCATGATCTTTCGAT-1-79       Endothelial_cells
GCGATCGTCAGAGTGG-1-79               Platelets
GCCCGAACAGAGAAAG-1-79       Endothelial_cells
Name: singler_annotation, Length: 111836, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Astrocyte', 'Smooth_muscle_cells', 'Neurons', 'Neuroepithelial_cell', 'Endothelial_cells', 'Osteoblasts', 'Platelets', 'Hepatocytes', 'Embryonic_stem_cells', 'MEP', 'Erythroblast', 'Fibroblasts', 'iPS_cells', 'MSC', 'Macrophage', 'Gametocytes', 'Chondrocytes', 'NK_cell', 'Neutrophils', 'HSC_CD34+', 'Monocyte', 'Tissue_stem_cells', 'DC', 'HSC_-G-CSF', 'T_cells', 'Epithelial_cells', 'Unknown', 'Pre-B_cell_CD34-', 'GMP', 'B_cell', 'Pro-Myelocyte', 'Keratinocytes', 'Myelocyte', 'BM', 'CMP', 'BM & Prog.', 'Pro-B_cell_CD34+']
라벨별 그룹 개수 {2: 2, 1: 3, 0: 3}
🔍 Split #3
  → train_p_index 환자 수 (환자 단위로 묶인 index list): 34
  → test_p_index 환자 수  (환자 단위로 묶인 index list): 8
  → train 환자 ID: ['P1290', 'P1300', 'P1358', 'P1371', 'P1422', 'P1425', 'P1430', 'P1437', 'P1447', 'P1462', 'P1479', 'P1504', 'P1510', 'P1515', 'P1516', 'P1539', 'P1540', 'P1547', 'P1558', 'P1582', 'P1600', 'P1602', 'P1603', 'P1606', 'P1610', 'P1617', 'P1630', 'P1678', 'P1702', 'P1707', 'P1718', 'P1722', 'P1726', 'P1735']
  → test  환자 ID: ['P1304', 'P1472', 'P1508', 'P1549', 'P1561', 'P1622', 'P1631', 'P1685']
  → train 환자 ID 및 라벨:
    ID: P1290, Label: 2
    ID: P1300, Label: 2
    ID: P1358, Label: 2
    ID: P1371, Label: 2
    ID: P1422, Label: 1
    ID: P1425, Label: 1
    ID: P1430, Label: 2
    ID: P1437, Label: 2
    ID: P1447, Label: 1
    ID: P1462, Label: 1
    ID: P1479, Label: 1
    ID: P1504, Label: 2
    ID: P1510, Label: 1
    ID: P1515, Label: 0
    ID: P1516, Label: 0
    ID: P1539, Label: 0
    ID: P1540, Label: 0
    ID: P1547, Label: 0
    ID: P1558, Label: 0
    ID: P1582, Label: 0
    ID: P1600, Label: 0
    ID: P1602, Label: 1
    ID: P1603, Label: 0
    ID: P1606, Label: 2
    ID: P1610, Label: 0
    ID: P1617, Label: 2
    ID: P1630, Label: 1
    ID: P1678, Label: 0
    ID: P1702, Label: 0
    ID: P1707, Label: 1
    ID: P1718, Label: 0
    ID: P1722, Label: 1
    ID: P1726, Label: 1
    ID: P1735, Label: 1
  → test 환자 ID 및 라벨:
    ID: P1304, Label: 2
    ID: P1472, Label: 2
    ID: P1508, Label: 1
    ID: P1549, Label: 0
    ID: P1561, Label: 0
    ID: P1622, Label: 0
    ID: P1631, Label: 1
    ID: P1685, Label: 1
전체 데이터 index 길이 42
label_stat (train 환자 라벨 목록) 갯수 34
train_data에서 환자 단위로, train과 validation 나누기
기존 train_p_index 34
기존 (train) label_stat 34
train-vali 분할 후! 
train y 의 classes : {0, 1, 2} valid y 의 classes : {0, 1, 2} label_stat 의 classes : {0, 1, 2}
train_p_index_ 22
valid_p_index 12
test_p_index 8
→ train 환자 ID 및 라벨:
   총 개수: 22
   환자ID=P1722, Label=1, 셀개수=21432
   환자ID=P1516, Label=0, 셀개수=9361
   환자ID=P1358, Label=2, 셀개수=23984
   환자ID=P1447, Label=1, 셀개수=11151
   환자ID=P1606, Label=2, 셀개수=8523
   환자ID=P1678, Label=0, 셀개수=10085
   환자ID=P1422, Label=1, 셀개수=23315
   환자ID=P1735, Label=1, 셀개수=12009
   환자ID=P1718, Label=0, 셀개수=9278
   환자ID=P1540, Label=0, 셀개수=11638
   환자ID=P1702, Label=0, 셀개수=13550
   환자ID=P1510, Label=1, 셀개수=10744
   환자ID=P1425, Label=1, 셀개수=15378
   환자ID=P1630, Label=1, 셀개수=17633
   환자ID=P1617, Label=2, 셀개수=17986
   환자ID=P1515, Label=0, 셀개수=14502
   환자ID=P1603, Label=0, 셀개수=10638
   환자ID=P1504, Label=2, 셀개수=8133
   환자ID=P1479, Label=1, 셀개수=19124
   환자ID=P1437, Label=2, 셀개수=21695
   환자ID=P1600, Label=0, 셀개수=14882
   환자ID=P1539, Label=0, 셀개수=11076
→ valid 환자 ID 및 라벨:
   총 개수: 12
   환자ID=P1300, Label=2, 셀개수=17318
   환자ID=P1430, Label=2, 셀개수=11131
   환자ID=P1547, Label=0, 셀개수=8253
   환자ID=P1462, Label=1, 셀개수=21715
   환자ID=P1290, Label=2, 셀개수=8357
   환자ID=P1582, Label=0, 셀개수=18855
   환자ID=P1726, Label=1, 셀개수=12389
   환자ID=P1558, Label=0, 셀개수=10469
   환자ID=P1707, Label=1, 셀개수=9517
   환자ID=P1371, Label=2, 셀개수=16233
   환자ID=P1610, Label=0, 셀개수=13919
   환자ID=P1602, Label=1, 셀개수=16580
→ test 환자 ID 및 라벨:
   총 개수: 8
   환자ID=P1304, Label=2, 셀개수=19123
   환자ID=P1472, Label=2, 셀개수=19513
   환자ID=P1508, Label=1, 셀개수=20536
   환자ID=P1549, Label=0, 셀개수=11709
   환자ID=P1561, Label=0, 셀개수=10016
   환자ID=P1622, Label=0, 셀개수=7210
   환자ID=P1631, Label=1, 셀개수=13686
   환자ID=P1685, Label=1, 셀개수=10043
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Neurons', 'Endothelial_cells', 'Neurons', 'Neurons', 'Smooth_muscle_cells', 'Smooth_muscle_cells', 'Neurons', 'Endothelial_cells', 'Neurons', 'Neurons']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
전체 데이터 길이 592689
전체 cell type 길이 0                     Neurons
1           Endothelial_cells
2                     Neurons
3                     Neurons
4         Smooth_muscle_cells
                 ...         
592684      Endothelial_cells
592685      Endothelial_cells
592686      Endothelial_cells
592687              Platelets
592688      Endothelial_cells
Length: 592689, dtype: string
cell type의 NaN 개수 체크 0
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:12,  7.92it/s]  2%|▏         | 2/100 [00:00<00:12,  7.71it/s]  3%|▎         | 3/100 [00:00<00:12,  7.61it/s]  4%|▍         | 4/100 [00:00<00:12,  7.61it/s]  5%|▌         | 5/100 [00:00<00:12,  7.58it/s]  6%|▌         | 6/100 [00:00<00:12,  7.67it/s]  7%|▋         | 7/100 [00:00<00:12,  7.70it/s]  8%|▊         | 8/100 [00:01<00:11,  7.68it/s]  9%|▉         | 9/100 [00:01<00:11,  7.91it/s] 10%|█         | 10/100 [00:01<00:11,  7.76it/s] 11%|█         | 11/100 [00:01<00:11,  7.74it/s] 12%|█▏        | 12/100 [00:01<00:11,  7.58it/s] 13%|█▎        | 13/100 [00:01<00:11,  7.58it/s] 14%|█▍        | 14/100 [00:01<00:11,  7.64it/s] 15%|█▌        | 15/100 [00:01<00:11,  7.52it/s] 16%|█▌        | 16/100 [00:02<00:10,  7.76it/s] 17%|█▋        | 17/100 [00:02<00:10,  7.68it/s] 18%|█▊        | 18/100 [00:02<00:10,  7.73it/s] 19%|█▉        | 19/100 [00:02<00:10,  7.76it/s] 20%|██        | 20/100 [00:02<00:10,  7.65it/s] 21%|██        | 21/100 [00:02<00:10,  7.55it/s] 22%|██▏       | 22/100 [00:02<00:10,  7.46it/s] 23%|██▎       | 23/100 [00:03<00:10,  7.47it/s] 24%|██▍       | 24/100 [00:03<00:10,  7.38it/s] 25%|██▌       | 25/100 [00:03<00:10,  7.49it/s] 26%|██▌       | 26/100 [00:03<00:09,  7.49it/s] 27%|██▋       | 27/100 [00:03<00:09,  7.55it/s] 28%|██▊       | 28/100 [00:03<00:09,  7.47it/s] 29%|██▉       | 29/100 [00:03<00:09,  7.52it/s] 30%|███       | 30/100 [00:03<00:09,  7.41it/s] 31%|███       | 31/100 [00:04<00:09,  7.41it/s] 32%|███▏      | 32/100 [00:04<00:09,  7.37it/s] 33%|███▎      | 33/100 [00:04<00:09,  7.32it/s] 34%|███▍      | 34/100 [00:04<00:09,  7.24it/s] 35%|███▌      | 35/100 [00:04<00:08,  7.25it/s] 36%|███▌      | 36/100 [00:04<00:08,  7.30it/s] 37%|███▋      | 37/100 [00:04<00:08,  7.21it/s] 38%|███▊      | 38/100 [00:05<00:08,  7.29it/s] 39%|███▉      | 39/100 [00:05<00:08,  7.33it/s] 40%|████      | 40/100 [00:05<00:08,  7.33it/s] 41%|████      | 41/100 [00:05<00:08,  7.06it/s] 42%|████▏     | 42/100 [00:05<00:07,  7.26it/s] 43%|████▎     | 43/100 [00:05<00:07,  7.25it/s] 44%|████▍     | 44/100 [00:05<00:07,  7.19it/s] 45%|████▌     | 45/100 [00:06<00:07,  7.27it/s] 46%|████▌     | 46/100 [00:06<00:07,  7.29it/s] 47%|████▋     | 47/100 [00:06<00:07,  7.37it/s] 48%|████▊     | 48/100 [00:06<00:07,  7.39it/s] 49%|████▉     | 49/100 [00:06<00:06,  7.52it/s] 50%|█████     | 50/100 [00:06<00:06,  7.38it/s] 51%|█████     | 51/100 [00:06<00:06,  7.40it/s] 52%|█████▏    | 52/100 [00:06<00:06,  7.41it/s] 53%|█████▎    | 53/100 [00:07<00:06,  7.48it/s] 54%|█████▍    | 54/100 [00:07<00:06,  7.38it/s] 55%|█████▌    | 55/100 [00:07<00:06,  7.27it/s] 56%|█████▌    | 56/100 [00:07<00:06,  7.26it/s] 57%|█████▋    | 57/100 [00:07<00:06,  7.15it/s] 58%|█████▊    | 58/100 [00:07<00:05,  7.27it/s] 59%|█████▉    | 59/100 [00:07<00:05,  7.10it/s] 60%|██████    | 60/100 [00:08<00:05,  7.11it/s] 61%|██████    | 61/100 [00:08<00:05,  7.18it/s] 62%|██████▏   | 62/100 [00:08<00:05,  7.24it/s] 63%|██████▎   | 63/100 [00:08<00:05,  7.06it/s] 64%|██████▍   | 64/100 [00:08<00:05,  7.13it/s] 65%|██████▌   | 65/100 [00:08<00:05,  6.91it/s] 66%|██████▌   | 66/100 [00:08<00:04,  6.96it/s] 67%|██████▋   | 67/100 [00:09<00:04,  6.94it/s] 68%|██████▊   | 68/100 [00:09<00:04,  7.00it/s] 69%|██████▉   | 69/100 [00:09<00:04,  6.96it/s] 70%|███████   | 70/100 [00:09<00:04,  7.01it/s] 71%|███████   | 71/100 [00:09<00:04,  7.00it/s] 72%|███████▏  | 72/100 [00:09<00:03,  7.01it/s] 73%|███████▎  | 73/100 [00:09<00:03,  6.98it/s] 74%|███████▍  | 74/100 [00:10<00:03,  6.93it/s] 75%|███████▌  | 75/100 [00:10<00:03,  6.99it/s] 76%|███████▌  | 76/100 [00:10<00:03,  6.93it/s] 77%|███████▋  | 77/100 [00:10<00:03,  6.93it/s] 78%|███████▊  | 78/100 [00:10<00:03,  6.91it/s] 79%|███████▉  | 79/100 [00:10<00:03,  6.88it/s] 80%|████████  | 80/100 [00:10<00:02,  6.87it/s] 81%|████████  | 81/100 [00:11<00:02,  6.87it/s] 82%|████████▏ | 82/100 [00:11<00:02,  6.92it/s] 83%|████████▎ | 83/100 [00:11<00:02,  6.89it/s] 84%|████████▍ | 84/100 [00:11<00:02,  6.83it/s] 85%|████████▌ | 85/100 [00:11<00:02,  6.89it/s] 86%|████████▌ | 86/100 [00:11<00:02,  6.86it/s] 87%|████████▋ | 87/100 [00:11<00:01,  7.06it/s] 88%|████████▊ | 88/100 [00:12<00:01,  6.87it/s] 89%|████████▉ | 89/100 [00:12<00:01,  7.05it/s] 90%|█████████ | 90/100 [00:12<00:01,  6.85it/s] 91%|█████████ | 91/100 [00:12<00:01,  6.88it/s] 92%|█████████▏| 92/100 [00:12<00:01,  6.65it/s] 93%|█████████▎| 93/100 [00:12<00:01,  6.80it/s] 94%|█████████▍| 94/100 [00:12<00:00,  6.85it/s] 95%|█████████▌| 95/100 [00:13<00:00,  7.06it/s] 96%|█████████▌| 96/100 [00:13<00:00,  6.87it/s] 97%|█████████▋| 97/100 [00:13<00:00,  6.89it/s] 98%|█████████▊| 98/100 [00:13<00:00,  6.72it/s] 99%|█████████▉| 99/100 [00:13<00:00,  6.71it/s]100%|██████████| 100/100 [00:13<00:00,  6.82it/s]100%|██████████| 100/100 [00:13<00:00,  7.21it/s]
[I 2025-08-30 05:24:28,430] A new study created in memory with name: no-name-4fd0847c-23a1-4b0e-bdb3-a9a50867396f
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 19.85 MB
Memory Reserved: 42.00 MB
cuda
CUDA OOM 발생 — 단계적 백오프 시작.
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 17906.54 MB
Memory Reserved: 17924.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 349.96 MB
Memory Reserved: 388.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 17906.25 MB
Memory Reserved: 17932.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 350.37 MB
Memory Reserved: 388.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[I 2025-08-30 05:24:29,822] Trial 0 pruned. Pruned due to OOM after backoff
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 17904.00 MB
Memory Reserved: 17934.00 MB
cuda
CUDA OOM 발생 — 단계적 백오프 시작.
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 17876.68 MB
Memory Reserved: 17894.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 321.44 MB
Memory Reserved: 358.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 17876.68 MB
Memory Reserved: 17914.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 321.98 MB
Memory Reserved: 340.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[I 2025-08-30 05:24:31,213] Trial 1 pruned. Pruned due to OOM after backoff
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 17876.68 MB
Memory Reserved: 17916.00 MB
cuda
CUDA OOM 발생 — 단계적 백오프 시작.
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 9091.39 MB
Memory Reserved: 9098.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 9091.52 MB
Memory Reserved: 9118.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 9091.36 MB
Memory Reserved: 9098.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 9091.52 MB
Memory Reserved: 9118.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[I 2025-08-30 05:24:32,362] Trial 2 pruned. Pruned due to OOM after backoff
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 16.69 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.876059, Valid_loss 1.177520
Epoch 2, Train Loss 0.657623, Valid_loss 0.866223
Epoch 3, Train Loss 0.539778, Valid_loss 0.915406
Epoch 4, Train Loss 0.513668, Valid_loss 1.127295
Epoch 5, Train Loss 0.451517, Valid_loss 0.833434
Epoch 6, Train Loss 0.376907, Valid_loss 0.944243
Epoch 7, Train Loss 0.544169, Valid_loss 1.080238
Epoch 8, Train Loss 0.495236, Valid_loss 1.251442
Epoch 9, Train Loss 0.410193, Valid_loss 1.226931
Epoch 10, Train Loss 0.440069, Valid_loss 0.724550
Epoch 11, Train Loss 0.392531, Valid_loss 1.094741
Epoch 12, Train Loss 0.487585, Valid_loss 0.902562
Epoch 13, Train Loss 0.928431, Valid_loss 1.234681
Epoch 14, Train Loss 0.894237, Valid_loss 1.156704
Epoch 15, Train Loss 0.751549, Valid_loss 1.574348
Epoch 16, Train Loss 0.856634, Valid_loss 0.991326
Epoch 17, Train Loss 0.778432, Valid_loss 1.255729
Epoch 18, Train Loss 0.797784, Valid_loss 0.977306
Epoch 19, Train Loss 0.630320, Valid_loss 1.355512
Epoch 20, Train Loss 0.617126, Valid_loss 1.071091
Epoch 21, Train Loss 0.956736, Valid_loss 1.123175
Epoch 22, Train Loss 0.929890, Valid_loss 1.098311
Epoch 23, Train Loss 0.914349, Valid_loss 1.105763
Epoch 24, Train Loss 0.920611, Valid_loss 1.170462
Epoch 25, Train Loss 0.922446, Valid_loss 1.107221
Epoch 26, Train Loss 0.918236, Valid_loss 1.173590
Epoch 27, Train Loss 0.908296, Valid_loss 1.094025
Epoch 28, Train Loss 0.883495, Valid_loss 1.129377
Epoch 29, Train Loss 0.914138, Valid_loss 1.129270
Epoch 30, Train Loss 0.896687, Valid_loss 1.125512
Epoch 31, Train Loss 0.835980, Valid_loss 1.061757
Epoch 32, Train Loss 0.862877, Valid_loss 1.038890
Epoch 33, Train Loss 0.830981, Valid_loss 1.065371
Epoch 34, Train Loss 0.891445, Valid_loss 1.047370
Epoch 35, Train Loss 0.892046, Valid_loss 1.014910
Epoch 36, Train Loss 0.764979, Valid_loss 1.166605
Epoch 37, Train Loss 0.697797, Valid_loss 1.254938
Epoch 38, Train Loss 0.849346, Valid_loss 1.129275
Epoch 39, Train Loss 0.886643, Valid_loss 1.105083
Epoch 40, Train Loss 0.909275, Valid_loss 1.121823
Epoch 41, Train Loss 0.912965, Valid_loss 1.160896
Epoch 42, Train Loss 0.908240, Valid_loss 1.124878
Epoch 43, Train Loss 0.899970, Valid_loss 1.152747
Epoch 44, Train Loss 0.912284, Valid_loss 1.120243
Epoch 45, Train Loss 0.910418, Valid_loss 1.293410
Epoch 46, Train Loss 0.923392, Valid_loss 1.146423
Epoch 47, Train Loss 0.912228, Valid_loss 1.128857
Epoch 48, Train Loss 0.884017, Valid_loss 1.154016
Epoch 49, Train Loss 0.881774, Valid_loss 1.102751
Epoch 50, Train Loss 0.884206, Valid_loss 1.096249
Epoch 51, Train Loss 0.850760, Valid_loss 1.070055
Epoch 52, Train Loss 0.798626, Valid_loss 1.164512
Epoch 53, Train Loss 0.749995, Valid_loss 1.177205
[I 2025-08-30 05:52:43,907] Trial 3 finished with value: 0.7245498431536058 and parameters: {'learning_rate': 0.01, 'epochs': 100, 'heads': 2, 'dropout': 0.0, 'weight_decay': 0.0001, 'emb_dim': 8, 'augment_num': 100, 'pca': False}. Best is trial 3 with value: 0.7245498431536058.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 16.69 MB
Memory Reserved: 42.00 MB
cuda
CUDA OOM 발생 — 단계적 백오프 시작.
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 9075.55 MB
Memory Reserved: 9096.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 9075.54 MB
Memory Reserved: 9098.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 9075.54 MB
Memory Reserved: 9096.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 9075.54 MB
Memory Reserved: 9098.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[I 2025-08-30 05:52:45,315] Trial 4 pruned. Pruned due to OOM after backoff
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 9078.70 MB
Memory Reserved: 9098.00 MB
cuda
Epoch 1, Train Loss 0.945742, Valid_loss 1.289991
Epoch 2, Train Loss 0.702961, Valid_loss 2.180172
Epoch 3, Train Loss 0.940634, Valid_loss 0.985295
Epoch 4, Train Loss 0.612567, Valid_loss 1.609432
Epoch 5, Train Loss 0.477612, Valid_loss 0.661520
Epoch 6, Train Loss 0.453951, Valid_loss 0.698925
Epoch 7, Train Loss 0.447769, Valid_loss 0.673471
Epoch 8, Train Loss 0.412476, Valid_loss 0.691943
Epoch 9, Train Loss 0.379095, Valid_loss 0.679456
Epoch 10, Train Loss 0.321323, Valid_loss 1.374104
Epoch 11, Train Loss 0.355370, Valid_loss 0.806505
Epoch 12, Train Loss 0.296457, Valid_loss 0.556669
Epoch 13, Train Loss 0.332816, Valid_loss 0.889214
Epoch 14, Train Loss 0.231780, Valid_loss 0.807806
Epoch 15, Train Loss 0.195831, Valid_loss 1.416156
Epoch 16, Train Loss 0.152689, Valid_loss 1.161643
Epoch 17, Train Loss 0.152227, Valid_loss 1.156082
Epoch 18, Train Loss 0.326589, Valid_loss 1.891693
Epoch 19, Train Loss 0.209200, Valid_loss 1.654479
Epoch 20, Train Loss 0.124998, Valid_loss 1.434228
Epoch 21, Train Loss 0.156982, Valid_loss 2.557377
Epoch 22, Train Loss 0.054762, Valid_loss 2.210672
Epoch 23, Train Loss 0.060229, Valid_loss 2.744590
Epoch 24, Train Loss 0.068029, Valid_loss 1.839452
Epoch 25, Train Loss 0.062487, Valid_loss 1.585647
Epoch 26, Train Loss 0.043679, Valid_loss 2.833462
Epoch 27, Train Loss 0.043166, Valid_loss 1.984370
Epoch 28, Train Loss 0.050477, Valid_loss 1.959509
Epoch 29, Train Loss 0.034121, Valid_loss 1.611160
Epoch 30, Train Loss 0.030253, Valid_loss 2.226339
Epoch 31, Train Loss 0.096431, Valid_loss 1.892797
Epoch 32, Train Loss 0.103525, Valid_loss 2.298334
Epoch 33, Train Loss 0.282817, Valid_loss 1.904360
Epoch 34, Train Loss 0.076246, Valid_loss 1.893599
Epoch 35, Train Loss 0.064597, Valid_loss 2.427059
Epoch 36, Train Loss 0.046540, Valid_loss 4.018495
Epoch 37, Train Loss 0.243195, Valid_loss 1.584268
Epoch 38, Train Loss 0.044626, Valid_loss 2.738164
Epoch 39, Train Loss 0.096785, Valid_loss 2.138831
Epoch 40, Train Loss 0.036784, Valid_loss 2.433432
Epoch 41, Train Loss 0.082414, Valid_loss 3.137524
Epoch 42, Train Loss 0.042457, Valid_loss 2.708216
Epoch 43, Train Loss 0.043335, Valid_loss 2.613861
Epoch 44, Train Loss 0.019574, Valid_loss 2.784253
Epoch 45, Train Loss 0.029278, Valid_loss 2.596425
Epoch 46, Train Loss 0.026560, Valid_loss 2.699046
Epoch 47, Train Loss 0.052706, Valid_loss 2.046943
Epoch 48, Train Loss 0.023686, Valid_loss 2.494036
Epoch 49, Train Loss 0.054076, Valid_loss 2.425221
Epoch 50, Train Loss 0.051704, Valid_loss 2.280508
Epoch 51, Train Loss 0.021995, Valid_loss 2.361224
Epoch 52, Train Loss 0.021775, Valid_loss 2.289246
Epoch 53, Train Loss 0.022403, Valid_loss 2.012740
Epoch 54, Train Loss 0.018648, Valid_loss 2.753043
Epoch 55, Train Loss 0.025417, Valid_loss 3.000424
[I 2025-08-30 06:13:41,814] Trial 5 finished with value: 0.5566692522261292 and parameters: {'learning_rate': 0.001, 'epochs': 100, 'heads': 1, 'dropout': 0.0, 'weight_decay': 0.0001, 'emb_dim': 64, 'augment_num': 100, 'pca': False}. Best is trial 5 with value: 0.5566692522261292.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 19.85 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.916830, Valid_loss 1.313147
Epoch 2, Train Loss 0.719558, Valid_loss 1.200075
Epoch 3, Train Loss 0.569718, Valid_loss 0.976025
Epoch 4, Train Loss 0.494102, Valid_loss 1.108435
Epoch 5, Train Loss 0.506564, Valid_loss 0.772850
Epoch 6, Train Loss 0.404405, Valid_loss 1.396158
Epoch 7, Train Loss 0.405278, Valid_loss 0.686045
Epoch 8, Train Loss 0.350857, Valid_loss 0.975230
Epoch 9, Train Loss 0.359112, Valid_loss 1.179134
Epoch 10, Train Loss 0.370909, Valid_loss 1.249674
Epoch 11, Train Loss 0.283730, Valid_loss 0.805748
Epoch 12, Train Loss 0.266490, Valid_loss 0.964659
Epoch 13, Train Loss 0.314715, Valid_loss 0.822430
Epoch 14, Train Loss 0.331429, Valid_loss 0.927065
Epoch 15, Train Loss 0.294360, Valid_loss 0.690257
Epoch 16, Train Loss 0.253369, Valid_loss 0.692154
Epoch 17, Train Loss 0.284494, Valid_loss 0.975294
Epoch 18, Train Loss 0.237788, Valid_loss 1.158963
Epoch 19, Train Loss 0.235269, Valid_loss 1.237642
Epoch 20, Train Loss 0.231973, Valid_loss 1.058847
Epoch 21, Train Loss 0.234430, Valid_loss 1.110862
Epoch 22, Train Loss 0.222397, Valid_loss 1.371548
Epoch 23, Train Loss 0.216809, Valid_loss 1.097247
Epoch 24, Train Loss 0.249977, Valid_loss 0.913556
Epoch 25, Train Loss 0.220846, Valid_loss 0.904100
Epoch 26, Train Loss 0.211965, Valid_loss 1.219924
Epoch 27, Train Loss 0.188620, Valid_loss 1.131157
Epoch 28, Train Loss 0.234094, Valid_loss 0.924836
Epoch 29, Train Loss 0.212855, Valid_loss 1.383120
Epoch 30, Train Loss 0.179653, Valid_loss 0.824230
Epoch 31, Train Loss 0.155512, Valid_loss 1.041064
Epoch 32, Train Loss 0.140185, Valid_loss 1.220451
Epoch 33, Train Loss 0.176321, Valid_loss 1.804594
Epoch 34, Train Loss 0.242889, Valid_loss 1.116551
Epoch 35, Train Loss 0.188250, Valid_loss 1.250068
Epoch 36, Train Loss 0.148335, Valid_loss 1.080403
Epoch 37, Train Loss 0.160065, Valid_loss 1.386611
Epoch 38, Train Loss 0.136035, Valid_loss 1.601507
Epoch 39, Train Loss 0.166445, Valid_loss 2.570259
Epoch 40, Train Loss 0.276835, Valid_loss 0.997072
Epoch 41, Train Loss 0.133948, Valid_loss 0.826824
Epoch 42, Train Loss 0.119433, Valid_loss 1.085605
Epoch 43, Train Loss 0.139506, Valid_loss 0.925491
Epoch 44, Train Loss 0.145171, Valid_loss 1.011277
Epoch 45, Train Loss 0.180542, Valid_loss 0.930370
Epoch 46, Train Loss 0.114682, Valid_loss 1.487416
Epoch 47, Train Loss 0.167437, Valid_loss 1.196630
Epoch 48, Train Loss 0.148328, Valid_loss 0.908108
Epoch 49, Train Loss 0.155117, Valid_loss 1.024649
Epoch 50, Train Loss 0.120502, Valid_loss 0.981905
Epoch 51, Train Loss 0.193377, Valid_loss 1.181874
Epoch 52, Train Loss 0.097843, Valid_loss 1.482417
[I 2025-08-30 06:44:01,812] Trial 6 finished with value: 0.6860454597820839 and parameters: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 2, 'dropout': 0.3, 'weight_decay': 0.001, 'emb_dim': 64, 'augment_num': 100, 'pca': False}. Best is trial 5 with value: 0.5566692522261292.
선택된 trial params: {'learning_rate': 0.001, 'epochs': 100, 'heads': 1, 'dropout': 0.0, 'weight_decay': 0.0001, 'emb_dim': 64, 'augment_num': 100, 'pca': False}
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=8, batch_size=1 -> steps=8
Memory Allocated: 19.85 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.977305, Valid_loss 1.370540
Epoch 2, Train Loss 0.758996, Valid_loss 1.068207
Epoch 3, Train Loss 0.560931, Valid_loss 0.895172
Epoch 4, Train Loss 0.500298, Valid_loss 0.959409
Epoch 5, Train Loss 0.501537, Valid_loss 1.734341
Epoch 6, Train Loss 0.468831, Valid_loss 0.862038
Epoch 7, Train Loss 0.438456, Valid_loss 1.068252
Epoch 8, Train Loss 0.365007, Valid_loss 1.087447
Epoch 9, Train Loss 0.420440, Valid_loss 1.462701
Epoch 10, Train Loss 0.408733, Valid_loss 1.127202
Epoch 11, Train Loss 0.366398, Valid_loss 0.764933
Epoch 12, Train Loss 0.330225, Valid_loss 4.105430
Epoch 13, Train Loss 0.349408, Valid_loss 1.266322
Epoch 14, Train Loss 0.407987, Valid_loss 1.028087
Epoch 15, Train Loss 0.291337, Valid_loss 0.911965
Epoch 16, Train Loss 0.407701, Valid_loss 1.076820
Epoch 17, Train Loss 0.371355, Valid_loss 1.387856
Epoch 18, Train Loss 0.255989, Valid_loss 0.992361
Epoch 19, Train Loss 0.286668, Valid_loss 0.807285
Epoch 20, Train Loss 0.298643, Valid_loss 0.860833
Epoch 21, Train Loss 0.185876, Valid_loss 2.415044
Epoch 22, Train Loss 0.280671, Valid_loss 2.857214
Epoch 23, Train Loss 0.272184, Valid_loss 2.365463
Epoch 24, Train Loss 0.291864, Valid_loss 1.220624
Epoch 25, Train Loss 0.256456, Valid_loss 2.748796
Epoch 26, Train Loss 0.216889, Valid_loss 3.295640
Epoch 27, Train Loss 0.219280, Valid_loss 1.999649
Epoch 28, Train Loss 0.157695, Valid_loss 2.849192
Epoch 29, Train Loss 0.466028, Valid_loss 1.052168
Epoch 30, Train Loss 0.266715, Valid_loss 3.488605
Epoch 31, Train Loss 0.240485, Valid_loss 2.872525
Epoch 32, Train Loss 0.196869, Valid_loss 2.955645
Epoch 33, Train Loss 0.208114, Valid_loss 2.237553
Epoch 34, Train Loss 0.137848, Valid_loss 2.776567
Epoch 35, Train Loss 0.209003, Valid_loss 1.758674
Epoch 36, Train Loss 0.213957, Valid_loss 1.574262
Epoch 37, Train Loss 0.132280, Valid_loss 2.559501
Epoch 38, Train Loss 0.170580, Valid_loss 1.236834
Epoch 39, Train Loss 0.169151, Valid_loss 2.598310
Epoch 40, Train Loss 0.155649, Valid_loss 1.997502
Epoch 41, Train Loss 0.305944, Valid_loss 1.855265
Epoch 42, Train Loss 0.180791, Valid_loss 1.323540
Epoch 43, Train Loss 0.134045, Valid_loss 1.703145
Epoch 44, Train Loss 0.128871, Valid_loss 2.411975
Epoch 45, Train Loss 0.165370, Valid_loss 2.942990
Epoch 46, Train Loss 0.127850, Valid_loss 2.481413
Epoch 47, Train Loss 0.134564, Valid_loss 3.026748
Epoch 48, Train Loss 0.174681, Valid_loss 2.744186
Epoch 49, Train Loss 0.214386, Valid_loss 2.134105
Epoch 50, Train Loss 0.128099, Valid_loss 1.182061
Epoch 51, Train Loss 0.101037, Valid_loss 1.651679
Epoch 52, Train Loss 0.068207, Valid_loss 2.310445
환자ID=P1304 -- true: [[2]] -- pred: tensor([[-2.1247,  1.0534,  0.3762]], device='cuda:0')
환자ID=P1472 -- true: [[2]] -- pred: tensor([[-2.0656,  1.0804,  0.3249]], device='cuda:0')
환자ID=P1508 -- true: [[1]] -- pred: tensor([[-1.0191,  1.1809, -0.6004]], device='cuda:0')
환자ID=P1549 -- true: [[0]] -- pred: tensor([[ 3.7919, -2.3360, -4.9014]], device='cuda:0')
환자ID=P1561 -- true: [[0]] -- pred: tensor([[ 3.7968, -2.2824, -4.8862]], device='cuda:0')
환자ID=P1622 -- true: [[0]] -- pred: tensor([[ 3.5382, -1.5250, -4.2984]], device='cuda:0')
환자ID=P1631 -- true: [[1]] -- pred: tensor([[-1.8944,  1.1482,  0.1536]], device='cuda:0')
환자ID=P1685 -- true: [[1]] -- pred: tensor([[-2.0981,  1.0718,  0.3430]], device='cuda:0')
Best performance: Epoch 11, Loss 0.366398, Test ACC 0.750000, Test AUC 0.944444, Test Recall 0.666667, Test Precision 0.533333
Confusion Matrix:
 [[3 0 0]
 [0 3 0]
 [0 2 0]]
✅ Total valid splits used: 3
🔁 Repeat 3, Fold 3
cell type :  TTCTTCCGTTCAACGT-1-0                Astrocyte
CATCCACCATCTAACG-1-0      Smooth_muscle_cells
ACCCAAACAGCTAACT-1-0                  Neurons
AAGGAATCAACTGGTT-1-0     Neuroepithelial_cell
TACCCGTAGCGTGCTC-1-0                Astrocyte
                                 ...         
TTATTGCGTCGGTGTC-1-79       Endothelial_cells
GTCACGGGTTGTATGC-1-79       Endothelial_cells
GTCATGATCTTTCGAT-1-79       Endothelial_cells
GCGATCGTCAGAGTGG-1-79               Platelets
GCCCGAACAGAGAAAG-1-79       Endothelial_cells
Name: singler_annotation, Length: 482281, dtype: string
cell type annotation :  TTCTTCCGTTCAACGT-1-0                Astrocyte
CATCCACCATCTAACG-1-0      Smooth_muscle_cells
ACCCAAACAGCTAACT-1-0                  Neurons
AAGGAATCAACTGGTT-1-0     Neuroepithelial_cell
TACCCGTAGCGTGCTC-1-0                Astrocyte
                                 ...         
TTATTGCGTCGGTGTC-1-79       Endothelial_cells
GTCACGGGTTGTATGC-1-79       Endothelial_cells
GTCATGATCTTTCGAT-1-79       Endothelial_cells
GCGATCGTCAGAGTGG-1-79               Platelets
GCCCGAACAGAGAAAG-1-79       Endothelial_cells
Name: singler_annotation, Length: 482281, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Astrocyte', 'Smooth_muscle_cells', 'Neurons', 'Neuroepithelial_cell', 'Endothelial_cells', 'Osteoblasts', 'Platelets', 'Hepatocytes', 'Embryonic_stem_cells', 'MEP', 'Erythroblast', 'Fibroblasts', 'iPS_cells', 'MSC', 'Macrophage', 'Gametocytes', 'Chondrocytes', 'NK_cell', 'Neutrophils', 'HSC_CD34+', 'Monocyte', 'Tissue_stem_cells', 'DC', 'HSC_-G-CSF', 'T_cells', 'Epithelial_cells', 'Unknown', 'Pre-B_cell_CD34-', 'GMP', 'B_cell', 'Pro-Myelocyte', 'Keratinocytes', 'Myelocyte', 'BM', 'CMP', 'BM & Prog.', 'Pro-B_cell_CD34+']
라벨별 그룹 개수 {2: 9, 1: 12, 0: 13}
cell type :  CTGCTCAAGGCATCAG-1-3             Osteoblasts
TCATACTAGACTTCCA-1-3     Smooth_muscle_cells
GAGCCTGGTCGAGATG-1-3            Erythroblast
CTTACCGCAGAACTCT-1-3             Osteoblasts
TTGACCCCATCTAACG-1-3     Smooth_muscle_cells
                                ...         
GTTCTATTCCTTCTAA-1-77      Endothelial_cells
GAGTCATTCATGGATC-1-77      Endothelial_cells
GGTGTTACAAGACAAT-1-77    Smooth_muscle_cells
AGCGTCGTCCTCACTG-1-77            Neutrophils
GTGCTGGCATGATAGA-1-77      Endothelial_cells
Name: singler_annotation, Length: 110408, dtype: string
cell type annotation :  CTGCTCAAGGCATCAG-1-3             Osteoblasts
TCATACTAGACTTCCA-1-3     Smooth_muscle_cells
GAGCCTGGTCGAGATG-1-3            Erythroblast
CTTACCGCAGAACTCT-1-3             Osteoblasts
TTGACCCCATCTAACG-1-3     Smooth_muscle_cells
                                ...         
GTTCTATTCCTTCTAA-1-77      Endothelial_cells
GAGTCATTCATGGATC-1-77      Endothelial_cells
GGTGTTACAAGACAAT-1-77    Smooth_muscle_cells
AGCGTCGTCCTCACTG-1-77            Neutrophils
GTGCTGGCATGATAGA-1-77      Endothelial_cells
Name: singler_annotation, Length: 110408, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Osteoblasts', 'Smooth_muscle_cells', 'Erythroblast', 'Endothelial_cells', 'Neurons', 'Astrocyte', 'Fibroblasts', 'NK_cell', 'Gametocytes', 'Neuroepithelial_cell', 'Platelets', 'Embryonic_stem_cells', 'iPS_cells', 'Hepatocytes', 'MSC', 'Chondrocytes', 'MEP', 'BM & Prog.', 'Macrophage', 'Monocyte', 'Neutrophils', 'DC', 'HSC_CD34+', 'HSC_-G-CSF', 'Tissue_stem_cells', 'Unknown', 'T_cells', 'Keratinocytes', 'Epithelial_cells', 'B_cell', 'Myelocyte', 'Pro-Myelocyte', 'BM', 'Pre-B_cell_CD34-', 'GMP', 'CMP', 'Pro-B_cell_CD34+']
라벨별 그룹 개수 {2: 2, 1: 3, 0: 3}
🔍 Split #4
  → train_p_index 환자 수 (환자 단위로 묶인 index list): 34
  → test_p_index 환자 수  (환자 단위로 묶인 index list): 8
  → train 환자 ID: ['P1290', 'P1300', 'P1304', 'P1358', 'P1422', 'P1425', 'P1430', 'P1437', 'P1472', 'P1479', 'P1508', 'P1510', 'P1515', 'P1516', 'P1540', 'P1547', 'P1549', 'P1558', 'P1561', 'P1582', 'P1606', 'P1610', 'P1617', 'P1622', 'P1630', 'P1631', 'P1678', 'P1685', 'P1702', 'P1707', 'P1718', 'P1722', 'P1726', 'P1735']
  → test  환자 ID: ['P1371', 'P1447', 'P1462', 'P1504', 'P1539', 'P1600', 'P1602', 'P1603']
  → train 환자 ID 및 라벨:
    ID: P1290, Label: 2
    ID: P1300, Label: 2
    ID: P1304, Label: 2
    ID: P1358, Label: 2
    ID: P1422, Label: 1
    ID: P1425, Label: 1
    ID: P1430, Label: 2
    ID: P1437, Label: 2
    ID: P1472, Label: 2
    ID: P1479, Label: 1
    ID: P1508, Label: 1
    ID: P1510, Label: 1
    ID: P1515, Label: 0
    ID: P1516, Label: 0
    ID: P1540, Label: 0
    ID: P1547, Label: 0
    ID: P1549, Label: 0
    ID: P1558, Label: 0
    ID: P1561, Label: 0
    ID: P1582, Label: 0
    ID: P1606, Label: 2
    ID: P1610, Label: 0
    ID: P1617, Label: 2
    ID: P1622, Label: 0
    ID: P1630, Label: 1
    ID: P1631, Label: 1
    ID: P1678, Label: 0
    ID: P1685, Label: 1
    ID: P1702, Label: 0
    ID: P1707, Label: 1
    ID: P1718, Label: 0
    ID: P1722, Label: 1
    ID: P1726, Label: 1
    ID: P1735, Label: 1
  → test 환자 ID 및 라벨:
    ID: P1371, Label: 2
    ID: P1447, Label: 1
    ID: P1462, Label: 1
    ID: P1504, Label: 2
    ID: P1539, Label: 0
    ID: P1600, Label: 0
    ID: P1602, Label: 1
    ID: P1603, Label: 0
전체 데이터 index 길이 42
label_stat (train 환자 라벨 목록) 갯수 34
train_data에서 환자 단위로, train과 validation 나누기
기존 train_p_index 34
기존 (train) label_stat 34
train-vali 분할 후! 
train y 의 classes : {0, 1, 2} valid y 의 classes : {0, 1, 2} label_stat 의 classes : {0, 1, 2}
train_p_index_ 22
valid_p_index 12
test_p_index 8
→ train 환자 ID 및 라벨:
   총 개수: 22
   환자ID=P1722, Label=1, 셀개수=21432
   환자ID=P1540, Label=0, 셀개수=11638
   환자ID=P1304, Label=2, 셀개수=19123
   환자ID=P1472, Label=2, 셀개수=19513
   환자ID=P1622, Label=0, 셀개수=7210
   환자ID=P1685, Label=1, 셀개수=10043
   환자ID=P1422, Label=1, 셀개수=23315
   환자ID=P1735, Label=1, 셀개수=12009
   환자ID=P1718, Label=0, 셀개수=9278
   환자ID=P1549, Label=0, 셀개수=11709
   환자ID=P1702, Label=0, 셀개수=13550
   환자ID=P1515, Label=0, 셀개수=14502
   환자ID=P1425, Label=1, 셀개수=15378
   환자ID=P1678, Label=0, 셀개수=10085
   환자ID=P1631, Label=1, 셀개수=13686
   환자ID=P1516, Label=0, 셀개수=9361
   환자ID=P1617, Label=2, 셀개수=17986
   환자ID=P1510, Label=1, 셀개수=10744
   환자ID=P1508, Label=1, 셀개수=20536
   환자ID=P1437, Label=2, 셀개수=21695
   환자ID=P1606, Label=2, 셀개수=8523
   환자ID=P1547, Label=0, 셀개수=8253
→ valid 환자 ID 및 라벨:
   총 개수: 12
   환자ID=P1300, Label=2, 셀개수=17318
   환자ID=P1430, Label=2, 셀개수=11131
   환자ID=P1558, Label=0, 셀개수=10469
   환자ID=P1479, Label=1, 셀개수=19124
   환자ID=P1290, Label=2, 셀개수=8357
   환자ID=P1582, Label=0, 셀개수=18855
   환자ID=P1726, Label=1, 셀개수=12389
   환자ID=P1561, Label=0, 셀개수=10016
   환자ID=P1707, Label=1, 셀개수=9517
   환자ID=P1358, Label=2, 셀개수=23984
   환자ID=P1630, Label=1, 셀개수=17633
   환자ID=P1610, Label=0, 셀개수=13919
→ test 환자 ID 및 라벨:
   총 개수: 8
   환자ID=P1371, Label=2, 셀개수=16233
   환자ID=P1447, Label=1, 셀개수=11151
   환자ID=P1462, Label=1, 셀개수=21715
   환자ID=P1504, Label=2, 셀개수=8133
   환자ID=P1539, Label=0, 셀개수=11076
   환자ID=P1600, Label=0, 셀개수=14882
   환자ID=P1602, Label=1, 셀개수=16580
   환자ID=P1603, Label=0, 셀개수=10638
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Astrocyte', 'Smooth_muscle_cells', 'Neurons', 'Neuroepithelial_cell', 'Astrocyte', 'Endothelial_cells', 'Osteoblasts', 'Platelets', 'Neurons', 'Hepatocytes']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
전체 데이터 길이 592689
전체 cell type 길이 0                    Astrocyte
1          Smooth_muscle_cells
2                      Neurons
3         Neuroepithelial_cell
4                    Astrocyte
                  ...         
592684       Endothelial_cells
592685       Endothelial_cells
592686     Smooth_muscle_cells
592687             Neutrophils
592688       Endothelial_cells
Length: 592689, dtype: string
cell type의 NaN 개수 체크 0
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:12,  7.86it/s]  2%|▏         | 2/100 [00:00<00:11,  8.20it/s]  3%|▎         | 3/100 [00:00<00:11,  8.25it/s]  4%|▍         | 4/100 [00:00<00:11,  8.32it/s]  5%|▌         | 5/100 [00:00<00:11,  8.25it/s]  6%|▌         | 6/100 [00:00<00:11,  8.18it/s]  7%|▋         | 7/100 [00:00<00:11,  8.37it/s]  8%|▊         | 8/100 [00:00<00:11,  8.18it/s]  9%|▉         | 9/100 [00:01<00:11,  8.18it/s] 10%|█         | 10/100 [00:01<00:11,  8.12it/s] 11%|█         | 11/100 [00:01<00:10,  8.16it/s] 12%|█▏        | 12/100 [00:01<00:10,  8.15it/s] 13%|█▎        | 13/100 [00:01<00:10,  8.08it/s] 14%|█▍        | 14/100 [00:01<00:10,  8.06it/s] 15%|█▌        | 15/100 [00:01<00:10,  8.12it/s] 16%|█▌        | 16/100 [00:01<00:10,  8.02it/s] 17%|█▋        | 17/100 [00:02<00:10,  7.93it/s] 18%|█▊        | 18/100 [00:02<00:10,  8.00it/s] 19%|█▉        | 19/100 [00:02<00:10,  7.99it/s] 20%|██        | 20/100 [00:02<00:10,  7.97it/s] 21%|██        | 21/100 [00:02<00:09,  8.03it/s] 22%|██▏       | 22/100 [00:02<00:09,  7.92it/s] 23%|██▎       | 23/100 [00:02<00:09,  8.02it/s] 24%|██▍       | 24/100 [00:02<00:09,  8.02it/s] 25%|██▌       | 25/100 [00:03<00:09,  8.02it/s] 26%|██▌       | 26/100 [00:03<00:09,  7.87it/s] 27%|██▋       | 27/100 [00:03<00:09,  7.84it/s] 28%|██▊       | 28/100 [00:03<00:09,  7.83it/s] 29%|██▉       | 29/100 [00:03<00:09,  7.76it/s] 30%|███       | 30/100 [00:03<00:08,  7.78it/s] 31%|███       | 31/100 [00:03<00:08,  7.81it/s] 32%|███▏      | 32/100 [00:03<00:08,  7.99it/s] 33%|███▎      | 33/100 [00:04<00:08,  7.87it/s] 34%|███▍      | 34/100 [00:04<00:08,  7.72it/s] 35%|███▌      | 35/100 [00:04<00:08,  7.64it/s] 36%|███▌      | 36/100 [00:04<00:08,  7.70it/s] 37%|███▋      | 37/100 [00:04<00:08,  7.72it/s] 38%|███▊      | 38/100 [00:04<00:08,  7.67it/s] 39%|███▉      | 39/100 [00:04<00:07,  7.77it/s] 40%|████      | 40/100 [00:05<00:07,  7.64it/s] 41%|████      | 41/100 [00:05<00:07,  7.78it/s] 42%|████▏     | 42/100 [00:05<00:07,  7.60it/s] 43%|████▎     | 43/100 [00:05<00:07,  7.46it/s] 44%|████▍     | 44/100 [00:05<00:07,  7.43it/s] 45%|████▌     | 45/100 [00:05<00:07,  7.48it/s] 46%|████▌     | 46/100 [00:05<00:07,  7.69it/s] 47%|████▋     | 47/100 [00:05<00:06,  7.59it/s] 48%|████▊     | 48/100 [00:06<00:06,  7.54it/s] 49%|████▉     | 49/100 [00:06<00:06,  7.37it/s] 50%|█████     | 50/100 [00:06<00:06,  7.60it/s] 51%|█████     | 51/100 [00:06<00:06,  7.58it/s] 52%|█████▏    | 52/100 [00:06<00:06,  7.62it/s] 53%|█████▎    | 53/100 [00:06<00:06,  7.63it/s] 54%|█████▍    | 54/100 [00:06<00:06,  7.51it/s] 55%|█████▌    | 55/100 [00:07<00:06,  7.49it/s] 56%|█████▌    | 56/100 [00:07<00:05,  7.48it/s] 57%|█████▋    | 57/100 [00:07<00:05,  7.48it/s] 58%|█████▊    | 58/100 [00:07<00:05,  7.44it/s] 59%|█████▉    | 59/100 [00:07<00:05,  7.50it/s] 60%|██████    | 60/100 [00:07<00:05,  7.34it/s] 61%|██████    | 61/100 [00:07<00:05,  7.35it/s] 62%|██████▏   | 62/100 [00:07<00:05,  7.39it/s] 63%|██████▎   | 63/100 [00:08<00:04,  7.47it/s] 64%|██████▍   | 64/100 [00:08<00:04,  7.41it/s] 65%|██████▌   | 65/100 [00:08<00:04,  7.36it/s] 66%|██████▌   | 66/100 [00:08<00:04,  7.21it/s] 67%|██████▋   | 67/100 [00:08<00:04,  7.19it/s] 68%|██████▊   | 68/100 [00:08<00:04,  7.13it/s] 69%|██████▉   | 69/100 [00:08<00:04,  7.16it/s] 70%|███████   | 70/100 [00:09<00:04,  7.22it/s] 71%|███████   | 71/100 [00:09<00:04,  7.24it/s] 72%|███████▏  | 72/100 [00:09<00:03,  7.36it/s] 73%|███████▎  | 73/100 [00:09<00:03,  7.09it/s] 74%|███████▍  | 74/100 [00:09<00:03,  7.08it/s] 75%|███████▌  | 75/100 [00:09<00:03,  7.06it/s] 76%|███████▌  | 76/100 [00:09<00:03,  7.07it/s] 77%|███████▋  | 77/100 [00:10<00:03,  6.89it/s] 78%|███████▊  | 78/100 [00:10<00:03,  7.06it/s] 79%|███████▉  | 79/100 [00:10<00:02,  7.01it/s] 80%|████████  | 80/100 [00:10<00:02,  7.03it/s] 81%|████████  | 81/100 [00:10<00:02,  6.92it/s] 82%|████████▏ | 82/100 [00:10<00:02,  7.05it/s] 83%|████████▎ | 83/100 [00:10<00:02,  6.92it/s] 84%|████████▍ | 84/100 [00:11<00:02,  7.09it/s] 85%|████████▌ | 85/100 [00:11<00:02,  7.11it/s] 86%|████████▌ | 86/100 [00:11<00:01,  7.01it/s] 87%|████████▋ | 87/100 [00:11<00:01,  7.06it/s] 88%|████████▊ | 88/100 [00:11<00:01,  7.07it/s] 89%|████████▉ | 89/100 [00:11<00:01,  7.04it/s] 90%|█████████ | 90/100 [00:11<00:01,  6.99it/s] 91%|█████████ | 91/100 [00:12<00:01,  6.96it/s] 92%|█████████▏| 92/100 [00:12<00:01,  6.76it/s] 93%|█████████▎| 93/100 [00:12<00:01,  6.96it/s] 94%|█████████▍| 94/100 [00:12<00:00,  6.82it/s] 95%|█████████▌| 95/100 [00:12<00:00,  6.77it/s] 96%|█████████▌| 96/100 [00:12<00:00,  6.80it/s] 97%|█████████▋| 97/100 [00:12<00:00,  6.75it/s] 98%|█████████▊| 98/100 [00:13<00:00,  6.82it/s] 99%|█████████▉| 99/100 [00:13<00:00,  6.86it/s]100%|██████████| 100/100 [00:13<00:00,  6.76it/s]100%|██████████| 100/100 [00:13<00:00,  7.46it/s]
[I 2025-08-30 07:04:35,703] A new study created in memory with name: no-name-45ba0343-6c86-4320-914e-61b03a46ce88
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 19.85 MB
Memory Reserved: 42.00 MB
cuda
CUDA OOM 발생 — 단계적 백오프 시작.
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 16934.53 MB
Memory Reserved: 16952.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 341.79 MB
Memory Reserved: 380.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 16933.90 MB
Memory Reserved: 16960.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 342.12 MB
Memory Reserved: 380.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[I 2025-08-30 07:04:37,079] Trial 0 pruned. Pruned due to OOM after backoff
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 16930.11 MB
Memory Reserved: 16960.00 MB
cuda
Epoch 1, Train Loss 1.001107, Valid_loss 1.226309
Epoch 2, Train Loss 0.969894, Valid_loss 1.186143
Epoch 3, Train Loss 0.957113, Valid_loss 1.140449
Epoch 4, Train Loss 0.992315, Valid_loss 1.059750
Epoch 5, Train Loss 0.931031, Valid_loss 0.995789
Epoch 6, Train Loss 0.936967, Valid_loss 1.023502
Epoch 7, Train Loss 0.943906, Valid_loss 0.956367
Epoch 8, Train Loss 0.902815, Valid_loss 0.947903
Epoch 9, Train Loss 0.928542, Valid_loss 0.940750
Epoch 10, Train Loss 0.863150, Valid_loss 0.946290
Epoch 11, Train Loss 0.885687, Valid_loss 0.941962
Epoch 12, Train Loss 0.882919, Valid_loss 0.962601
Epoch 13, Train Loss 0.837679, Valid_loss 0.942861
Epoch 14, Train Loss 0.841709, Valid_loss 0.973754
Epoch 15, Train Loss 0.844169, Valid_loss 0.943190
Epoch 16, Train Loss 0.855916, Valid_loss 0.929987
Epoch 17, Train Loss 0.779358, Valid_loss 0.921454
Epoch 18, Train Loss 0.779450, Valid_loss 0.931315
Epoch 19, Train Loss 0.776249, Valid_loss 0.908800
Epoch 20, Train Loss 0.775875, Valid_loss 0.924500
Epoch 21, Train Loss 0.794745, Valid_loss 0.929562
Epoch 22, Train Loss 0.750961, Valid_loss 0.910319
Epoch 23, Train Loss 0.765224, Valid_loss 0.911232
Epoch 24, Train Loss 0.765752, Valid_loss 0.898779
Epoch 25, Train Loss 0.736121, Valid_loss 0.885522
Epoch 26, Train Loss 0.730684, Valid_loss 0.891027
Epoch 27, Train Loss 0.713062, Valid_loss 0.882912
Epoch 28, Train Loss 0.768683, Valid_loss 0.883844
Epoch 29, Train Loss 0.698020, Valid_loss 0.883460
Epoch 30, Train Loss 0.703683, Valid_loss 0.878981
Epoch 31, Train Loss 0.697580, Valid_loss 0.866413
Epoch 32, Train Loss 0.751504, Valid_loss 0.863009
Epoch 33, Train Loss 0.689842, Valid_loss 0.862943
Epoch 34, Train Loss 0.712782, Valid_loss 0.893036
Epoch 35, Train Loss 0.690119, Valid_loss 0.853090
Epoch 36, Train Loss 0.630091, Valid_loss 0.856641
Epoch 37, Train Loss 0.719847, Valid_loss 0.847616
Epoch 38, Train Loss 0.655430, Valid_loss 0.846250
Epoch 39, Train Loss 0.605106, Valid_loss 0.838981
Epoch 40, Train Loss 0.665581, Valid_loss 0.836749
Epoch 41, Train Loss 0.664608, Valid_loss 0.836719
Epoch 42, Train Loss 0.692085, Valid_loss 0.831610
Epoch 43, Train Loss 0.611601, Valid_loss 0.829227
Epoch 44, Train Loss 0.709566, Valid_loss 0.830833
Epoch 45, Train Loss 0.647991, Valid_loss 0.818033
Epoch 46, Train Loss 0.644284, Valid_loss 0.888228
Epoch 47, Train Loss 0.596620, Valid_loss 0.815374
Epoch 48, Train Loss 0.712054, Valid_loss 0.829128
Epoch 49, Train Loss 0.598436, Valid_loss 0.811792
Epoch 50, Train Loss 0.644300, Valid_loss 0.805984
Epoch 51, Train Loss 0.600690, Valid_loss 0.805133
Epoch 52, Train Loss 0.603074, Valid_loss 0.803192
Epoch 53, Train Loss 0.603500, Valid_loss 0.800325
Epoch 54, Train Loss 0.594116, Valid_loss 0.799367
Epoch 55, Train Loss 0.641451, Valid_loss 0.809201
Epoch 56, Train Loss 0.596254, Valid_loss 0.796947
Epoch 57, Train Loss 0.580829, Valid_loss 0.793825
Epoch 58, Train Loss 0.606754, Valid_loss 0.796505
Epoch 59, Train Loss 0.609919, Valid_loss 0.794396
Epoch 60, Train Loss 0.567962, Valid_loss 0.792536
Epoch 61, Train Loss 0.594821, Valid_loss 0.791702
Epoch 62, Train Loss 0.560775, Valid_loss 0.794058
Epoch 63, Train Loss 0.687133, Valid_loss 0.793172
Epoch 64, Train Loss 0.605696, Valid_loss 0.792652
Epoch 65, Train Loss 0.618456, Valid_loss 0.784870
Epoch 66, Train Loss 0.581941, Valid_loss 0.787989
Epoch 67, Train Loss 0.567334, Valid_loss 0.782286
Epoch 68, Train Loss 0.532972, Valid_loss 0.783069
Epoch 69, Train Loss 0.637386, Valid_loss 0.783577
[I 2025-08-30 07:43:48,643] Trial 1 finished with value: 0.7822862689693769 and parameters: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 2, 'dropout': 0.7, 'weight_decay': 0.0001, 'emb_dim': 8, 'augment_num': 100, 'pca': False}. Best is trial 1 with value: 0.7822862689693769.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 16.69 MB
Memory Reserved: 42.00 MB
cuda
CUDA OOM 발생 — 단계적 백오프 시작.
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 16883.20 MB
Memory Reserved: 16902.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 291.20 MB
Memory Reserved: 312.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 16883.69 MB
Memory Reserved: 16904.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 291.20 MB
Memory Reserved: 312.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[I 2025-08-30 07:43:50,306] Trial 2 pruned. Pruned due to OOM after backoff
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 16885.01 MB
Memory Reserved: 16904.00 MB
cuda
CUDA OOM 발생 — 단계적 백오프 시작.
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 312.70 MB
Memory Reserved: 334.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 16905.04 MB
Memory Reserved: 16946.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 311.99 MB
Memory Reserved: 334.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 16904.48 MB
Memory Reserved: 16946.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[I 2025-08-30 07:43:51,515] Trial 3 pruned. Pruned due to OOM after backoff
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 18.01 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.870273, Valid_loss 1.169592
Epoch 2, Train Loss 0.645087, Valid_loss 0.925767
Epoch 3, Train Loss 0.543542, Valid_loss 0.823406
Epoch 4, Train Loss 0.497277, Valid_loss 0.879283
Epoch 5, Train Loss 0.457122, Valid_loss 0.848546
Epoch 6, Train Loss 0.448422, Valid_loss 0.859271
Epoch 7, Train Loss 0.411641, Valid_loss 0.830324
Epoch 8, Train Loss 0.417873, Valid_loss 0.794892
Epoch 9, Train Loss 0.391549, Valid_loss 0.759801
Epoch 10, Train Loss 0.353602, Valid_loss 0.775134
Epoch 11, Train Loss 0.361482, Valid_loss 0.771467
Epoch 12, Train Loss 0.367226, Valid_loss 0.706569
Epoch 13, Train Loss 0.333345, Valid_loss 0.835073
Epoch 14, Train Loss 0.359231, Valid_loss 0.780549
Epoch 15, Train Loss 0.294063, Valid_loss 0.703795
Epoch 16, Train Loss 0.332094, Valid_loss 0.732176
Epoch 17, Train Loss 0.271284, Valid_loss 0.734522
Epoch 18, Train Loss 0.292271, Valid_loss 0.655151
Epoch 19, Train Loss 0.289045, Valid_loss 0.694723
Epoch 20, Train Loss 0.246309, Valid_loss 0.834253
Epoch 21, Train Loss 0.314480, Valid_loss 0.644289
Epoch 22, Train Loss 0.260324, Valid_loss 0.627423
Epoch 23, Train Loss 0.242445, Valid_loss 0.655200
Epoch 24, Train Loss 0.254888, Valid_loss 0.676972
Epoch 25, Train Loss 0.223928, Valid_loss 0.684760
Epoch 26, Train Loss 0.242054, Valid_loss 0.747814
Epoch 27, Train Loss 0.227286, Valid_loss 0.781718
Epoch 28, Train Loss 0.233167, Valid_loss 0.592249
Epoch 29, Train Loss 0.234238, Valid_loss 0.796212
Epoch 30, Train Loss 0.241223, Valid_loss 0.574221
Epoch 31, Train Loss 0.188871, Valid_loss 0.679027
Epoch 32, Train Loss 0.221060, Valid_loss 0.642697
Epoch 33, Train Loss 0.204712, Valid_loss 0.705079
Epoch 34, Train Loss 0.196747, Valid_loss 0.758133
Epoch 35, Train Loss 0.311875, Valid_loss 0.915364
Epoch 36, Train Loss 0.210674, Valid_loss 0.642536
Epoch 37, Train Loss 0.204847, Valid_loss 0.605543
Epoch 38, Train Loss 0.201370, Valid_loss 0.648605
Epoch 39, Train Loss 0.201169, Valid_loss 0.557651
Epoch 40, Train Loss 0.189676, Valid_loss 0.589898
Epoch 41, Train Loss 0.181027, Valid_loss 0.589723
Epoch 42, Train Loss 0.183327, Valid_loss 0.641220
Epoch 43, Train Loss 0.168696, Valid_loss 0.548709
Epoch 44, Train Loss 0.155367, Valid_loss 0.620768
Epoch 45, Train Loss 0.166473, Valid_loss 0.623878
Epoch 46, Train Loss 0.228336, Valid_loss 0.541651
Epoch 47, Train Loss 0.149133, Valid_loss 0.626324
Epoch 48, Train Loss 0.137164, Valid_loss 0.672875
Epoch 49, Train Loss 0.191827, Valid_loss 0.589442
Epoch 50, Train Loss 0.141796, Valid_loss 0.752139
Epoch 51, Train Loss 0.174728, Valid_loss 0.665130
Epoch 52, Train Loss 0.127230, Valid_loss 0.579817
Epoch 53, Train Loss 0.151301, Valid_loss 0.566145
Epoch 54, Train Loss 0.126375, Valid_loss 0.601062
Epoch 55, Train Loss 0.141533, Valid_loss 0.640816
[I 2025-08-30 08:04:14,741] Trial 4 finished with value: 0.5416511452446381 and parameters: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 1, 'dropout': 0.0, 'weight_decay': 0.01, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 4 with value: 0.5416511452446381.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 18.01 MB
Memory Reserved: 42.00 MB
cuda
CUDA OOM 발생 — 단계적 백오프 시작.
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 16903.99 MB
Memory Reserved: 16924.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 312.97 MB
Memory Reserved: 352.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 16903.99 MB
Memory Reserved: 16924.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 312.55 MB
Memory Reserved: 352.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[I 2025-08-30 08:04:16,442] Trial 5 pruned. Pruned due to OOM after backoff
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 16902.66 MB
Memory Reserved: 16944.00 MB
cuda
CUDA OOM 발생 — 단계적 백오프 시작.
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 4439.28 MB
Memory Reserved: 4500.00 MB
cuda
Epoch 1, Train Loss 0.948572, Valid_loss 1.429774
Epoch 2, Train Loss 0.915543, Valid_loss 1.215137
Epoch 3, Train Loss 0.876256, Valid_loss 1.208013
Epoch 4, Train Loss 0.874353, Valid_loss 1.129188
Epoch 5, Train Loss 0.859242, Valid_loss 1.190576
Epoch 6, Train Loss 0.868248, Valid_loss 1.230815
Epoch 7, Train Loss 0.872080, Valid_loss 1.261180
Epoch 8, Train Loss 0.850716, Valid_loss 1.113014
Epoch 9, Train Loss 0.857223, Valid_loss 1.148711
Epoch 10, Train Loss 0.833566, Valid_loss 1.129413
Epoch 11, Train Loss 0.831746, Valid_loss 1.126163
Epoch 12, Train Loss 0.822422, Valid_loss 1.415018
Epoch 13, Train Loss 0.833395, Valid_loss 1.207390
Epoch 14, Train Loss 0.824658, Valid_loss 1.170030
Epoch 15, Train Loss 0.821790, Valid_loss 1.166321
Epoch 16, Train Loss 0.858463, Valid_loss 1.144919
Epoch 17, Train Loss 0.843325, Valid_loss 1.115449
Epoch 18, Train Loss 0.829170, Valid_loss 1.394875
Epoch 19, Train Loss 0.836943, Valid_loss 1.125772
Epoch 20, Train Loss 0.856069, Valid_loss 1.106315
Epoch 21, Train Loss 0.840349, Valid_loss 1.167538
Epoch 22, Train Loss 0.823344, Valid_loss 1.146438
Epoch 23, Train Loss 0.837967, Valid_loss 1.142642
Epoch 24, Train Loss 0.799225, Valid_loss 1.151531
Epoch 25, Train Loss 0.847131, Valid_loss 1.148357
Epoch 26, Train Loss 0.818847, Valid_loss 1.133597
Epoch 27, Train Loss 0.812036, Valid_loss 1.149723
Epoch 28, Train Loss 0.811056, Valid_loss 1.178481
Epoch 29, Train Loss 0.824809, Valid_loss 1.421014
Epoch 30, Train Loss 0.822408, Valid_loss 1.219568
Epoch 31, Train Loss 0.811554, Valid_loss 1.177806
Epoch 32, Train Loss 0.810310, Valid_loss 1.258505
Epoch 33, Train Loss 0.812374, Valid_loss 1.397435
Epoch 34, Train Loss 0.852180, Valid_loss 1.208572
Epoch 35, Train Loss 0.804568, Valid_loss 1.379116
Epoch 36, Train Loss 0.834666, Valid_loss 1.157277
Epoch 37, Train Loss 0.847301, Valid_loss 1.148301
Epoch 38, Train Loss 0.817422, Valid_loss 1.190876
Epoch 39, Train Loss 0.827118, Valid_loss 1.206424
Epoch 40, Train Loss 0.864678, Valid_loss 1.430278
Epoch 41, Train Loss 0.851555, Valid_loss 1.361430
Epoch 42, Train Loss 0.855806, Valid_loss 1.163273
Epoch 43, Train Loss 0.828407, Valid_loss 1.349708
Epoch 44, Train Loss 0.847815, Valid_loss 1.190985
Epoch 45, Train Loss 0.835266, Valid_loss 1.216104
Epoch 46, Train Loss 0.838060, Valid_loss 1.171454
Epoch 47, Train Loss 0.825884, Valid_loss 1.174710
Epoch 48, Train Loss 0.798812, Valid_loss 1.173542
Epoch 49, Train Loss 0.840455, Valid_loss 1.208819
Epoch 50, Train Loss 0.829472, Valid_loss 1.241374
Epoch 51, Train Loss 0.804447, Valid_loss 1.308945
Epoch 52, Train Loss 0.801400, Valid_loss 1.229718
Epoch 53, Train Loss 0.815254, Valid_loss 1.229449
Epoch 54, Train Loss 0.838665, Valid_loss 1.192137
Epoch 55, Train Loss 0.786608, Valid_loss 1.210680
Epoch 56, Train Loss 0.816432, Valid_loss 1.277893
[I 2025-08-30 08:36:17,727] Trial 6 finished with value: 1.1063145250082016 and parameters: {'learning_rate': 0.01, 'epochs': 100, 'heads': 2, 'dropout': 0.3, 'weight_decay': 0.0001, 'emb_dim': 8, 'augment_num': 100, 'pca': False}. Best is trial 4 with value: 0.5416511452446381.
선택된 trial params: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 1, 'dropout': 0.0, 'weight_decay': 0.01, 'emb_dim': 32, 'augment_num': 100, 'pca': False}
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=8, batch_size=1 -> steps=8
Memory Allocated: 4440.60 MB
Memory Reserved: 4500.00 MB
cuda
Epoch 1, Train Loss 0.816045, Valid_loss 1.331686
Epoch 2, Train Loss 0.619996, Valid_loss 0.944758
Epoch 3, Train Loss 0.569701, Valid_loss 0.868697
Epoch 4, Train Loss 0.505176, Valid_loss 1.068433
Epoch 5, Train Loss 0.452137, Valid_loss 0.815514
Epoch 6, Train Loss 0.397296, Valid_loss 0.865262
Epoch 7, Train Loss 0.428632, Valid_loss 0.701525
Epoch 8, Train Loss 0.440636, Valid_loss 0.789642
Epoch 9, Train Loss 0.383601, Valid_loss 0.735128
Epoch 10, Train Loss 0.372580, Valid_loss 0.708039
Epoch 11, Train Loss 0.351886, Valid_loss 0.871744
Epoch 12, Train Loss 0.377530, Valid_loss 0.666206
Epoch 13, Train Loss 0.365226, Valid_loss 0.851260
Epoch 14, Train Loss 0.326359, Valid_loss 0.676034
Epoch 15, Train Loss 0.338632, Valid_loss 0.809229
Epoch 16, Train Loss 0.296416, Valid_loss 0.709475
Epoch 17, Train Loss 0.321484, Valid_loss 0.613030
Epoch 18, Train Loss 0.324796, Valid_loss 0.657329
Epoch 19, Train Loss 0.281001, Valid_loss 0.613713
Epoch 20, Train Loss 0.318156, Valid_loss 0.674585
Epoch 21, Train Loss 0.281975, Valid_loss 0.759153
Epoch 22, Train Loss 0.251473, Valid_loss 0.588073
Epoch 23, Train Loss 0.307265, Valid_loss 0.600968
Epoch 24, Train Loss 0.260010, Valid_loss 0.664456
Epoch 25, Train Loss 0.253735, Valid_loss 0.624958
Epoch 26, Train Loss 0.243294, Valid_loss 0.623140
Epoch 27, Train Loss 0.224985, Valid_loss 0.770362
Epoch 28, Train Loss 0.255963, Valid_loss 0.618407
Epoch 29, Train Loss 0.266941, Valid_loss 0.932814
Epoch 30, Train Loss 0.283905, Valid_loss 0.563903
Epoch 31, Train Loss 0.231835, Valid_loss 0.605247
Epoch 32, Train Loss 0.229069, Valid_loss 0.660717
Epoch 33, Train Loss 0.214034, Valid_loss 0.578712
Epoch 34, Train Loss 0.252382, Valid_loss 0.631614
Epoch 35, Train Loss 0.277971, Valid_loss 0.712700
Epoch 36, Train Loss 0.202170, Valid_loss 0.509834
Epoch 37, Train Loss 0.226082, Valid_loss 0.617035
Epoch 38, Train Loss 0.242053, Valid_loss 0.508363
Epoch 39, Train Loss 0.228680, Valid_loss 0.503820
Epoch 40, Train Loss 0.216878, Valid_loss 0.636734
Epoch 41, Train Loss 0.196575, Valid_loss 0.682735
Epoch 42, Train Loss 0.190220, Valid_loss 0.772812
Epoch 43, Train Loss 0.216274, Valid_loss 0.897822
Epoch 44, Train Loss 0.221134, Valid_loss 0.528194
Epoch 45, Train Loss 0.240044, Valid_loss 0.630280
Epoch 46, Train Loss 0.179971, Valid_loss 0.646408
Epoch 47, Train Loss 0.215848, Valid_loss 0.518239
Epoch 48, Train Loss 0.201214, Valid_loss 0.471728
Epoch 49, Train Loss 0.184430, Valid_loss 0.602613
Epoch 50, Train Loss 0.194598, Valid_loss 0.793284
Epoch 51, Train Loss 0.178862, Valid_loss 0.716312
Epoch 52, Train Loss 0.163371, Valid_loss 0.618661
Epoch 53, Train Loss 0.159401, Valid_loss 0.599836
Epoch 54, Train Loss 0.169223, Valid_loss 0.594920
Epoch 55, Train Loss 0.156443, Valid_loss 0.534888
Epoch 56, Train Loss 0.155669, Valid_loss 0.695760
Epoch 57, Train Loss 0.147850, Valid_loss 0.663810
Epoch 58, Train Loss 0.138285, Valid_loss 0.565353
Epoch 59, Train Loss 0.152363, Valid_loss 0.643677
Epoch 60, Train Loss 0.159831, Valid_loss 0.602495
Epoch 61, Train Loss 0.136268, Valid_loss 0.581473
Epoch 62, Train Loss 0.148202, Valid_loss 0.549128
Epoch 63, Train Loss 0.158896, Valid_loss 0.514329
Epoch 64, Train Loss 0.147646, Valid_loss 0.545908
Epoch 65, Train Loss 0.161105, Valid_loss 0.564317
환자ID=P1371 -- true: [[2]] -- pred: tensor([[-1.9308,  0.8085,  0.8454]], device='cuda:0')
환자ID=P1447 -- true: [[1]] -- pred: tensor([[-1.6712,  0.8532,  0.5099]], device='cuda:0')
환자ID=P1462 -- true: [[1]] -- pred: tensor([[-1.3226,  0.9448,  0.1746]], device='cuda:0')
환자ID=P1504 -- true: [[2]] -- pred: tensor([[-1.9400,  0.7632,  0.7789]], device='cuda:0')
환자ID=P1539 -- true: [[0]] -- pred: tensor([[ 2.8509, -1.3773, -1.9531]], device='cuda:0')
환자ID=P1600 -- true: [[0]] -- pred: tensor([[ 2.8878, -1.3365, -2.0986]], device='cuda:0')
환자ID=P1602 -- true: [[1]] -- pred: tensor([[ 0.5148,  0.2729, -0.8803]], device='cuda:0')
환자ID=P1603 -- true: [[0]] -- pred: tensor([[ 2.8758, -1.4092, -1.9681]], device='cuda:0')
Best performance: Epoch 48, Loss 0.201214, Test ACC 0.875000, Test AUC 0.944444, Test Recall 0.888889, Test Precision 0.916667
Confusion Matrix:
 [[3 0 0]
 [1 2 0]
 [0 0 2]]
✅ Total valid splits used: 4
🔁 Repeat 3, Fold 4
cell type :  TTCTTCCGTTCAACGT-1-0                Astrocyte
CATCCACCATCTAACG-1-0      Smooth_muscle_cells
ACCCAAACAGCTAACT-1-0                  Neurons
AAGGAATCAACTGGTT-1-0     Neuroepithelial_cell
TACCCGTAGCGTGCTC-1-0                Astrocyte
                                 ...         
TTATTGCGTCGGTGTC-1-79       Endothelial_cells
GTCACGGGTTGTATGC-1-79       Endothelial_cells
GTCATGATCTTTCGAT-1-79       Endothelial_cells
GCGATCGTCAGAGTGG-1-79               Platelets
GCCCGAACAGAGAAAG-1-79       Endothelial_cells
Name: singler_annotation, Length: 469380, dtype: string
cell type annotation :  TTCTTCCGTTCAACGT-1-0                Astrocyte
CATCCACCATCTAACG-1-0      Smooth_muscle_cells
ACCCAAACAGCTAACT-1-0                  Neurons
AAGGAATCAACTGGTT-1-0     Neuroepithelial_cell
TACCCGTAGCGTGCTC-1-0                Astrocyte
                                 ...         
TTATTGCGTCGGTGTC-1-79       Endothelial_cells
GTCACGGGTTGTATGC-1-79       Endothelial_cells
GTCATGATCTTTCGAT-1-79       Endothelial_cells
GCGATCGTCAGAGTGG-1-79               Platelets
GCCCGAACAGAGAAAG-1-79       Endothelial_cells
Name: singler_annotation, Length: 469380, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Astrocyte', 'Smooth_muscle_cells', 'Neurons', 'Neuroepithelial_cell', 'Endothelial_cells', 'Osteoblasts', 'Platelets', 'Hepatocytes', 'Embryonic_stem_cells', 'MEP', 'Erythroblast', 'Fibroblasts', 'iPS_cells', 'MSC', 'Macrophage', 'Gametocytes', 'Chondrocytes', 'NK_cell', 'Neutrophils', 'HSC_CD34+', 'Monocyte', 'Tissue_stem_cells', 'DC', 'HSC_-G-CSF', 'T_cells', 'Epithelial_cells', 'Unknown', 'Pre-B_cell_CD34-', 'GMP', 'B_cell', 'Pro-Myelocyte', 'Keratinocytes', 'Myelocyte', 'BM', 'CMP', 'BM & Prog.', 'Pro-B_cell_CD34+']
라벨별 그룹 개수 {2: 9, 1: 12, 0: 13}
cell type :  CAACCAAAGACCCGCT-1-2                 Neurons
ACGGTTACATCGAACT-1-2                 Neurons
ACCCTCATCCGGCAGT-1-2                 Neurons
AACACACCACGGTCTG-1-2     Smooth_muscle_cells
AAACGCTTCACCGGGT-1-2                 Neurons
                                ...         
TCATTGTGTGGATCGA-1-76      Endothelial_cells
TTCTAGTTCGTTCTAT-1-76      Endothelial_cells
GTAGTACCAGTTGTTG-1-76              Astrocyte
GCATCGGTCGCCGTGA-1-76      Endothelial_cells
TCGGGTGGTGAGAACC-1-76                Neurons
Name: singler_annotation, Length: 123309, dtype: string
cell type annotation :  CAACCAAAGACCCGCT-1-2                 Neurons
ACGGTTACATCGAACT-1-2                 Neurons
ACCCTCATCCGGCAGT-1-2                 Neurons
AACACACCACGGTCTG-1-2     Smooth_muscle_cells
AAACGCTTCACCGGGT-1-2                 Neurons
                                ...         
TCATTGTGTGGATCGA-1-76      Endothelial_cells
TTCTAGTTCGTTCTAT-1-76      Endothelial_cells
GTAGTACCAGTTGTTG-1-76              Astrocyte
GCATCGGTCGCCGTGA-1-76      Endothelial_cells
TCGGGTGGTGAGAACC-1-76                Neurons
Name: singler_annotation, Length: 123309, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Neurons', 'Smooth_muscle_cells', 'Osteoblasts', 'Endothelial_cells', 'MSC', 'Astrocyte', 'Fibroblasts', 'Erythroblast', 'Neuroepithelial_cell', 'Platelets', 'iPS_cells', 'NK_cell', 'Embryonic_stem_cells', 'MEP', 'Gametocytes', 'Hepatocytes', 'Tissue_stem_cells', 'Monocyte', 'Macrophage', 'Neutrophils', 'Chondrocytes', 'HSC_-G-CSF', 'BM & Prog.', 'DC', 'Keratinocytes', 'T_cells', 'HSC_CD34+', 'CMP', 'B_cell', 'Myelocyte', 'Epithelial_cells', 'Unknown', 'Pro-Myelocyte', 'Pre-B_cell_CD34-', 'BM', 'GMP', 'Pro-B_cell_CD34+']
라벨별 그룹 개수 {2: 2, 0: 3, 1: 3}
🔍 Split #5
  → train_p_index 환자 수 (환자 단위로 묶인 index list): 34
  → test_p_index 환자 수  (환자 단위로 묶인 index list): 8
  → train 환자 ID: ['P1290', 'P1300', 'P1304', 'P1358', 'P1371', 'P1422', 'P1425', 'P1447', 'P1462', 'P1472', 'P1479', 'P1504', 'P1508', 'P1510', 'P1515', 'P1516', 'P1539', 'P1540', 'P1547', 'P1549', 'P1561', 'P1600', 'P1602', 'P1603', 'P1606', 'P1610', 'P1617', 'P1622', 'P1631', 'P1685', 'P1702', 'P1707', 'P1718', 'P1726']
  → test  환자 ID: ['P1430', 'P1437', 'P1558', 'P1582', 'P1630', 'P1678', 'P1722', 'P1735']
  → train 환자 ID 및 라벨:
    ID: P1290, Label: 2
    ID: P1300, Label: 2
    ID: P1304, Label: 2
    ID: P1358, Label: 2
    ID: P1371, Label: 2
    ID: P1422, Label: 1
    ID: P1425, Label: 1
    ID: P1447, Label: 1
    ID: P1462, Label: 1
    ID: P1472, Label: 2
    ID: P1479, Label: 1
    ID: P1504, Label: 2
    ID: P1508, Label: 1
    ID: P1510, Label: 1
    ID: P1515, Label: 0
    ID: P1516, Label: 0
    ID: P1539, Label: 0
    ID: P1540, Label: 0
    ID: P1547, Label: 0
    ID: P1549, Label: 0
    ID: P1561, Label: 0
    ID: P1600, Label: 0
    ID: P1602, Label: 1
    ID: P1603, Label: 0
    ID: P1606, Label: 2
    ID: P1610, Label: 0
    ID: P1617, Label: 2
    ID: P1622, Label: 0
    ID: P1631, Label: 1
    ID: P1685, Label: 1
    ID: P1702, Label: 0
    ID: P1707, Label: 1
    ID: P1718, Label: 0
    ID: P1726, Label: 1
  → test 환자 ID 및 라벨:
    ID: P1430, Label: 2
    ID: P1437, Label: 2
    ID: P1558, Label: 0
    ID: P1582, Label: 0
    ID: P1630, Label: 1
    ID: P1678, Label: 0
    ID: P1722, Label: 1
    ID: P1735, Label: 1
전체 데이터 index 길이 42
label_stat (train 환자 라벨 목록) 갯수 34
train_data에서 환자 단위로, train과 validation 나누기
기존 train_p_index 34
기존 (train) label_stat 34
train-vali 분할 후! 
train y 의 classes : {0, 1, 2} valid y 의 classes : {0, 1, 2} label_stat 의 classes : {0, 1, 2}
train_p_index_ 22
valid_p_index 12
test_p_index 8
→ train 환자 ID 및 라벨:
   총 개수: 22
   환자ID=P1707, Label=1, 셀개수=9517
   환자ID=P1515, Label=0, 셀개수=14502
   환자ID=P1304, Label=2, 셀개수=19123
   환자ID=P1462, Label=1, 셀개수=21715
   환자ID=P1603, Label=0, 셀개수=10638
   환자ID=P1622, Label=0, 셀개수=7210
   환자ID=P1371, Label=2, 셀개수=16233
   환자ID=P1726, Label=1, 셀개수=12389
   환자ID=P1702, Label=0, 셀개수=13550
   환자ID=P1539, Label=0, 셀개수=11076
   환자ID=P1631, Label=1, 셀개수=13686
   환자ID=P1508, Label=1, 셀개수=20536
   환자ID=P1422, Label=1, 셀개수=23315
   환자ID=P1617, Label=2, 셀개수=17986
   환자ID=P1610, Label=0, 셀개수=13919
   환자ID=P1510, Label=1, 셀개수=10744
   환자ID=P1602, Label=1, 셀개수=16580
   환자ID=P1504, Label=2, 셀개수=8133
   환자ID=P1479, Label=1, 셀개수=19124
   환자ID=P1447, Label=1, 셀개수=11151
   환자ID=P1561, Label=0, 셀개수=10016
   환자ID=P1516, Label=0, 셀개수=9361
→ valid 환자 ID 및 라벨:
   총 개수: 12
   환자ID=P1300, Label=2, 셀개수=17318
   환자ID=P1425, Label=1, 셀개수=15378
   환자ID=P1540, Label=0, 셀개수=11638
   환자ID=P1472, Label=2, 셀개수=19513
   환자ID=P1290, Label=2, 셀개수=8357
   환자ID=P1549, Label=0, 셀개수=11709
   환자ID=P1718, Label=0, 셀개수=9278
   환자ID=P1547, Label=0, 셀개수=8253
   환자ID=P1685, Label=1, 셀개수=10043
   환자ID=P1358, Label=2, 셀개수=23984
   환자ID=P1606, Label=2, 셀개수=8523
   환자ID=P1600, Label=0, 셀개수=14882
→ test 환자 ID 및 라벨:
   총 개수: 8
   환자ID=P1430, Label=2, 셀개수=11131
   환자ID=P1437, Label=2, 셀개수=21695
   환자ID=P1558, Label=0, 셀개수=10469
   환자ID=P1582, Label=0, 셀개수=18855
   환자ID=P1630, Label=1, 셀개수=17633
   환자ID=P1678, Label=0, 셀개수=10085
   환자ID=P1722, Label=1, 셀개수=21432
   환자ID=P1735, Label=1, 셀개수=12009
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Astrocyte', 'Smooth_muscle_cells', 'Neurons', 'Neuroepithelial_cell', 'Astrocyte', 'Endothelial_cells', 'Osteoblasts', 'Platelets', 'Neurons', 'Hepatocytes']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
전체 데이터 길이 592689
전체 cell type 길이 0                    Astrocyte
1          Smooth_muscle_cells
2                      Neurons
3         Neuroepithelial_cell
4                    Astrocyte
                  ...         
592684       Endothelial_cells
592685       Endothelial_cells
592686               Astrocyte
592687       Endothelial_cells
592688                 Neurons
Length: 592689, dtype: string
cell type의 NaN 개수 체크 0
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:12,  7.70it/s]  2%|▏         | 2/100 [00:00<00:12,  7.61it/s]  3%|▎         | 3/100 [00:00<00:12,  7.88it/s]  4%|▍         | 4/100 [00:00<00:12,  7.87it/s]  5%|▌         | 5/100 [00:00<00:12,  7.91it/s]  6%|▌         | 6/100 [00:00<00:12,  7.80it/s]  7%|▋         | 7/100 [00:00<00:11,  7.77it/s]  8%|▊         | 8/100 [00:01<00:12,  7.62it/s]  9%|▉         | 9/100 [00:01<00:12,  7.54it/s] 10%|█         | 10/100 [00:01<00:12,  7.44it/s] 11%|█         | 11/100 [00:01<00:12,  7.36it/s] 12%|█▏        | 12/100 [00:01<00:11,  7.41it/s] 13%|█▎        | 13/100 [00:01<00:11,  7.44it/s] 14%|█▍        | 14/100 [00:01<00:11,  7.45it/s] 15%|█▌        | 15/100 [00:01<00:11,  7.31it/s] 16%|█▌        | 16/100 [00:02<00:11,  7.32it/s] 17%|█▋        | 17/100 [00:02<00:11,  7.45it/s] 18%|█▊        | 18/100 [00:02<00:10,  7.53it/s] 19%|█▉        | 19/100 [00:02<00:10,  7.49it/s] 20%|██        | 20/100 [00:02<00:10,  7.36it/s] 21%|██        | 21/100 [00:02<00:10,  7.31it/s] 22%|██▏       | 22/100 [00:02<00:10,  7.32it/s] 23%|██▎       | 23/100 [00:03<00:10,  7.31it/s] 24%|██▍       | 24/100 [00:03<00:10,  7.40it/s] 25%|██▌       | 25/100 [00:03<00:10,  7.35it/s] 26%|██▌       | 26/100 [00:03<00:10,  7.22it/s] 27%|██▋       | 27/100 [00:03<00:10,  7.20it/s] 28%|██▊       | 28/100 [00:03<00:10,  7.16it/s] 29%|██▉       | 29/100 [00:03<00:09,  7.33it/s] 30%|███       | 30/100 [00:04<00:09,  7.19it/s] 31%|███       | 31/100 [00:04<00:09,  7.15it/s] 32%|███▏      | 32/100 [00:04<00:09,  7.15it/s] 33%|███▎      | 33/100 [00:04<00:09,  7.26it/s] 34%|███▍      | 34/100 [00:04<00:09,  7.17it/s] 35%|███▌      | 35/100 [00:04<00:08,  7.27it/s] 36%|███▌      | 36/100 [00:04<00:08,  7.26it/s] 37%|███▋      | 37/100 [00:05<00:08,  7.12it/s] 38%|███▊      | 38/100 [00:05<00:08,  7.07it/s] 39%|███▉      | 39/100 [00:05<00:08,  7.14it/s] 40%|████      | 40/100 [00:05<00:08,  7.08it/s] 41%|████      | 41/100 [00:05<00:08,  7.05it/s] 42%|████▏     | 42/100 [00:05<00:08,  7.11it/s] 43%|████▎     | 43/100 [00:05<00:08,  7.06it/s] 44%|████▍     | 44/100 [00:06<00:07,  7.01it/s] 45%|████▌     | 45/100 [00:06<00:07,  6.97it/s] 46%|████▌     | 46/100 [00:06<00:07,  6.91it/s] 47%|████▋     | 47/100 [00:06<00:07,  6.96it/s] 48%|████▊     | 48/100 [00:06<00:07,  6.95it/s] 49%|████▉     | 49/100 [00:06<00:07,  7.07it/s] 50%|█████     | 50/100 [00:06<00:07,  7.03it/s] 51%|█████     | 51/100 [00:07<00:06,  7.03it/s] 52%|█████▏    | 52/100 [00:07<00:06,  7.08it/s] 53%|█████▎    | 53/100 [00:07<00:06,  7.19it/s] 54%|█████▍    | 54/100 [00:07<00:06,  7.10it/s] 55%|█████▌    | 55/100 [00:07<00:06,  7.00it/s] 56%|█████▌    | 56/100 [00:07<00:06,  7.03it/s] 57%|█████▋    | 57/100 [00:07<00:06,  7.01it/s] 58%|█████▊    | 58/100 [00:08<00:06,  6.99it/s] 59%|█████▉    | 59/100 [00:08<00:05,  6.89it/s] 60%|██████    | 60/100 [00:08<00:05,  6.87it/s] 61%|██████    | 61/100 [00:08<00:05,  6.89it/s] 62%|██████▏   | 62/100 [00:08<00:05,  6.93it/s] 63%|██████▎   | 63/100 [00:08<00:05,  6.96it/s] 64%|██████▍   | 64/100 [00:08<00:05,  6.89it/s] 65%|██████▌   | 65/100 [00:09<00:05,  6.98it/s] 66%|██████▌   | 66/100 [00:09<00:04,  6.95it/s] 67%|██████▋   | 67/100 [00:09<00:04,  6.93it/s] 68%|██████▊   | 68/100 [00:09<00:04,  6.94it/s] 69%|██████▉   | 69/100 [00:09<00:04,  6.99it/s] 70%|███████   | 70/100 [00:09<00:04,  6.98it/s] 71%|███████   | 71/100 [00:09<00:04,  7.00it/s] 72%|███████▏  | 72/100 [00:10<00:04,  6.97it/s] 73%|███████▎  | 73/100 [00:10<00:03,  7.04it/s] 74%|███████▍  | 74/100 [00:10<00:03,  7.03it/s] 75%|███████▌  | 75/100 [00:10<00:03,  6.95it/s] 76%|███████▌  | 76/100 [00:10<00:03,  6.99it/s] 77%|███████▋  | 77/100 [00:10<00:03,  6.98it/s] 78%|███████▊  | 78/100 [00:10<00:03,  6.98it/s] 79%|███████▉  | 79/100 [00:11<00:03,  6.94it/s] 80%|████████  | 80/100 [00:11<00:02,  6.88it/s] 81%|████████  | 81/100 [00:11<00:02,  6.82it/s] 82%|████████▏ | 82/100 [00:11<00:02,  6.90it/s] 83%|████████▎ | 83/100 [00:11<00:02,  6.76it/s] 84%|████████▍ | 84/100 [00:11<00:02,  6.76it/s] 85%|████████▌ | 85/100 [00:11<00:02,  6.81it/s] 86%|████████▌ | 86/100 [00:12<00:02,  6.84it/s] 87%|████████▋ | 87/100 [00:12<00:01,  6.72it/s] 88%|████████▊ | 88/100 [00:12<00:01,  6.71it/s] 89%|████████▉ | 89/100 [00:12<00:01,  6.63it/s] 90%|█████████ | 90/100 [00:12<00:01,  6.63it/s] 91%|█████████ | 91/100 [00:12<00:01,  6.81it/s] 92%|█████████▏| 92/100 [00:12<00:01,  6.70it/s] 93%|█████████▎| 93/100 [00:13<00:01,  6.68it/s] 94%|█████████▍| 94/100 [00:13<00:00,  6.81it/s] 95%|█████████▌| 95/100 [00:13<00:00,  6.85it/s] 96%|█████████▌| 96/100 [00:13<00:00,  6.81it/s] 97%|█████████▋| 97/100 [00:13<00:00,  6.71it/s] 98%|█████████▊| 98/100 [00:13<00:00,  6.73it/s] 99%|█████████▉| 99/100 [00:13<00:00,  6.74it/s]100%|██████████| 100/100 [00:14<00:00,  6.71it/s]100%|██████████| 100/100 [00:14<00:00,  7.07it/s]
[I 2025-08-30 09:01:22,401] A new study created in memory with name: no-name-4bbea2a9-dd32-4f4c-b298-96a9cc17ebc1
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 19.85 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.906925, Valid_loss 1.441126
Epoch 2, Train Loss 0.729316, Valid_loss 1.249462
Epoch 3, Train Loss 0.576407, Valid_loss 1.034684
Epoch 4, Train Loss 0.527637, Valid_loss 1.044010
Epoch 5, Train Loss 0.526527, Valid_loss 1.194160
Epoch 6, Train Loss 0.491856, Valid_loss 0.845701
Epoch 7, Train Loss 0.477788, Valid_loss 0.999312
Epoch 8, Train Loss 0.463377, Valid_loss 0.978795
Epoch 9, Train Loss 0.446043, Valid_loss 1.039872
Epoch 10, Train Loss 0.510456, Valid_loss 1.058017
Epoch 11, Train Loss 0.468983, Valid_loss 0.999545
Epoch 12, Train Loss 0.411698, Valid_loss 0.881348
Epoch 13, Train Loss 0.390264, Valid_loss 0.903181
Epoch 14, Train Loss 0.417525, Valid_loss 0.901672
Epoch 15, Train Loss 0.427754, Valid_loss 0.912069
Epoch 16, Train Loss 0.402837, Valid_loss 0.900793
Epoch 17, Train Loss 0.357646, Valid_loss 0.868401
Epoch 18, Train Loss 0.383836, Valid_loss 0.863923
Epoch 19, Train Loss 0.337101, Valid_loss 0.850060
Epoch 20, Train Loss 0.408212, Valid_loss 0.920334
Epoch 21, Train Loss 0.374904, Valid_loss 1.050136
Epoch 22, Train Loss 0.343101, Valid_loss 0.858896
Epoch 23, Train Loss 0.332081, Valid_loss 0.809324
Epoch 24, Train Loss 0.280130, Valid_loss 0.984316
Epoch 25, Train Loss 0.317928, Valid_loss 0.894876
Epoch 26, Train Loss 0.292950, Valid_loss 0.749021
Epoch 27, Train Loss 0.301820, Valid_loss 0.879685
Epoch 28, Train Loss 0.303154, Valid_loss 0.600000
Epoch 29, Train Loss 0.297706, Valid_loss 0.614536
Epoch 30, Train Loss 0.320453, Valid_loss 1.112318
Epoch 31, Train Loss 0.259396, Valid_loss 0.877733
Epoch 32, Train Loss 0.228332, Valid_loss 0.814231
Epoch 33, Train Loss 0.320412, Valid_loss 0.928367
Epoch 34, Train Loss 0.262694, Valid_loss 0.556019
Epoch 35, Train Loss 0.246037, Valid_loss 0.897524
Epoch 36, Train Loss 0.229874, Valid_loss 0.681567
Epoch 37, Train Loss 0.271896, Valid_loss 0.671453
Epoch 38, Train Loss 0.337141, Valid_loss 0.892608
Epoch 39, Train Loss 0.229408, Valid_loss 0.627205
Epoch 40, Train Loss 0.287280, Valid_loss 0.941554
Epoch 41, Train Loss 0.254574, Valid_loss 0.674857
Epoch 42, Train Loss 0.193992, Valid_loss 0.716618
Epoch 43, Train Loss 0.196135, Valid_loss 0.897547
Epoch 44, Train Loss 0.241252, Valid_loss 0.521688
Epoch 45, Train Loss 0.307602, Valid_loss 0.777827
Epoch 46, Train Loss 0.259629, Valid_loss 0.832671
Epoch 47, Train Loss 0.258976, Valid_loss 0.918458
Epoch 48, Train Loss 0.208734, Valid_loss 0.733334
Epoch 49, Train Loss 0.195559, Valid_loss 0.792234
Epoch 50, Train Loss 0.186783, Valid_loss 0.455064
Epoch 51, Train Loss 0.160232, Valid_loss 0.620545
Epoch 52, Train Loss 0.172432, Valid_loss 0.564520
Epoch 53, Train Loss 0.171742, Valid_loss 0.550584
Epoch 54, Train Loss 0.177460, Valid_loss 0.616801
Epoch 55, Train Loss 0.172186, Valid_loss 0.589719
Epoch 56, Train Loss 0.147858, Valid_loss 0.549808
Epoch 57, Train Loss 0.179279, Valid_loss 0.883910
Epoch 58, Train Loss 0.153911, Valid_loss 0.616833
Epoch 59, Train Loss 0.169144, Valid_loss 0.643976
Epoch 60, Train Loss 0.202649, Valid_loss 0.656539
[I 2025-08-30 09:24:41,758] Trial 0 finished with value: 0.4550641405706604 and parameters: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 1, 'dropout': 0.5, 'weight_decay': 0.01, 'emb_dim': 64, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.4550641405706604.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 16.69 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 1.070209, Valid_loss 1.386925
Epoch 2, Train Loss 0.923179, Valid_loss 1.374297
Epoch 3, Train Loss 0.972097, Valid_loss 1.345623
Epoch 4, Train Loss 0.875814, Valid_loss 1.335563
Epoch 5, Train Loss 0.857790, Valid_loss 1.334605
Epoch 6, Train Loss 0.812168, Valid_loss 1.108799
Epoch 7, Train Loss 0.788966, Valid_loss 1.280216
Epoch 8, Train Loss 0.750657, Valid_loss 1.193767
Epoch 9, Train Loss 0.703384, Valid_loss 1.138333
Epoch 10, Train Loss 0.689497, Valid_loss 1.118673
Epoch 11, Train Loss 0.727908, Valid_loss 1.068108
Epoch 12, Train Loss 0.715905, Valid_loss 1.123736
Epoch 13, Train Loss 0.631433, Valid_loss 1.090121
Epoch 14, Train Loss 0.676412, Valid_loss 1.087676
Epoch 15, Train Loss 0.645433, Valid_loss 1.187684
Epoch 16, Train Loss 0.609528, Valid_loss 1.138233
Epoch 17, Train Loss 0.653856, Valid_loss 1.114508
Epoch 18, Train Loss 0.689924, Valid_loss 1.184820
Epoch 19, Train Loss 0.623133, Valid_loss 1.138944
Epoch 20, Train Loss 0.623720, Valid_loss 1.159159
Epoch 21, Train Loss 0.618489, Valid_loss 1.166806
Epoch 22, Train Loss 0.577898, Valid_loss 1.162635
Epoch 23, Train Loss 0.589308, Valid_loss 1.119548
Epoch 24, Train Loss 0.633768, Valid_loss 1.177125
Epoch 25, Train Loss 0.602017, Valid_loss 1.151633
Epoch 26, Train Loss 0.615541, Valid_loss 1.135299
Epoch 27, Train Loss 0.519716, Valid_loss 1.145693
Epoch 28, Train Loss 0.576813, Valid_loss 1.165270
Epoch 29, Train Loss 0.653821, Valid_loss 1.125603
Epoch 30, Train Loss 0.594296, Valid_loss 1.132303
Epoch 31, Train Loss 0.480353, Valid_loss 1.425946
Epoch 32, Train Loss 0.527328, Valid_loss 1.110024
Epoch 33, Train Loss 0.473188, Valid_loss 1.109760
Epoch 34, Train Loss 0.572255, Valid_loss 1.116620
Epoch 35, Train Loss 0.543184, Valid_loss 1.097610
Epoch 36, Train Loss 0.527023, Valid_loss 1.105930
Epoch 37, Train Loss 0.560013, Valid_loss 1.137668
Epoch 38, Train Loss 0.573840, Valid_loss 1.086088
Epoch 39, Train Loss 0.611264, Valid_loss 1.080411
Epoch 40, Train Loss 0.606267, Valid_loss 1.096179
Epoch 41, Train Loss 0.527635, Valid_loss 1.108020
Epoch 42, Train Loss 0.527906, Valid_loss 1.136798
Epoch 43, Train Loss 0.520270, Valid_loss 1.156677
Epoch 44, Train Loss 0.554001, Valid_loss 1.146771
Epoch 45, Train Loss 0.449392, Valid_loss 1.113860
Epoch 46, Train Loss 0.473282, Valid_loss 1.113348
Epoch 47, Train Loss 0.544111, Valid_loss 1.069314
Epoch 48, Train Loss 0.522905, Valid_loss 1.081420
Epoch 49, Train Loss 0.513929, Valid_loss 1.098465
Epoch 50, Train Loss 0.455829, Valid_loss 1.098917
Epoch 51, Train Loss 0.577955, Valid_loss 1.097823
Epoch 52, Train Loss 0.507770, Valid_loss 1.091195
Epoch 53, Train Loss 0.506202, Valid_loss 1.090390
Epoch 54, Train Loss 0.519283, Valid_loss 1.085091
Epoch 55, Train Loss 0.531181, Valid_loss 1.092953
Epoch 56, Train Loss 0.499527, Valid_loss 1.080260
Epoch 57, Train Loss 0.511749, Valid_loss 1.084055
Epoch 58, Train Loss 0.427451, Valid_loss 1.128691
[I 2025-08-30 09:47:00,588] Trial 1 finished with value: 1.0681075031558673 and parameters: {'learning_rate': 0.001, 'epochs': 100, 'heads': 1, 'dropout': 0.7, 'weight_decay': 0.001, 'emb_dim': 8, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.4550641405706604.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 19.85 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.898721, Valid_loss 1.586182
Epoch 2, Train Loss 0.829654, Valid_loss 1.670581
Epoch 3, Train Loss 0.794130, Valid_loss 1.524155
Epoch 4, Train Loss 0.651033, Valid_loss 1.257093
Epoch 5, Train Loss 0.542399, Valid_loss 1.168864
Epoch 6, Train Loss 0.469062, Valid_loss 1.121714
Epoch 7, Train Loss 0.494157, Valid_loss 0.949296
Epoch 8, Train Loss 0.413084, Valid_loss 1.137849
Epoch 9, Train Loss 0.397580, Valid_loss 1.252769
Epoch 10, Train Loss 0.407783, Valid_loss 0.926708
Epoch 11, Train Loss 0.429612, Valid_loss 1.067580
Epoch 12, Train Loss 0.429955, Valid_loss 0.920964
Epoch 13, Train Loss 0.365950, Valid_loss 0.853935
Epoch 14, Train Loss 0.343233, Valid_loss 0.809204
Epoch 15, Train Loss 0.377887, Valid_loss 0.858657
Epoch 16, Train Loss 0.356737, Valid_loss 0.781007
Epoch 17, Train Loss 0.414154, Valid_loss 0.731115
Epoch 18, Train Loss 0.351963, Valid_loss 0.645979
Epoch 19, Train Loss 0.344568, Valid_loss 0.639751
Epoch 20, Train Loss 0.340527, Valid_loss 0.668967
Epoch 21, Train Loss 0.319724, Valid_loss 0.665917
Epoch 22, Train Loss 0.282046, Valid_loss 0.630782
Epoch 23, Train Loss 0.292829, Valid_loss 0.629939
Epoch 24, Train Loss 0.313162, Valid_loss 0.672820
Epoch 25, Train Loss 0.293942, Valid_loss 0.676272
Epoch 26, Train Loss 0.365087, Valid_loss 1.020858
Epoch 27, Train Loss 0.306852, Valid_loss 0.642893
Epoch 28, Train Loss 0.281309, Valid_loss 0.529564
Epoch 29, Train Loss 0.284158, Valid_loss 0.610231
Epoch 30, Train Loss 0.244212, Valid_loss 0.629154
Epoch 31, Train Loss 0.241810, Valid_loss 0.598168
Epoch 32, Train Loss 0.322527, Valid_loss 0.721712
Epoch 33, Train Loss 0.275394, Valid_loss 0.581269
Epoch 34, Train Loss 0.222143, Valid_loss 0.544802
Epoch 35, Train Loss 0.245457, Valid_loss 0.655253
Epoch 36, Train Loss 0.221695, Valid_loss 0.637397
Epoch 37, Train Loss 0.199743, Valid_loss 0.536443
Epoch 38, Train Loss 0.265582, Valid_loss 0.515720
Epoch 39, Train Loss 0.221267, Valid_loss 0.631872
Epoch 40, Train Loss 0.280972, Valid_loss 0.554423
Epoch 41, Train Loss 0.173579, Valid_loss 0.832738
Epoch 42, Train Loss 0.197088, Valid_loss 0.526860
Epoch 43, Train Loss 0.224930, Valid_loss 0.955607
Epoch 44, Train Loss 0.326021, Valid_loss 0.538254
Epoch 45, Train Loss 0.198221, Valid_loss 0.843368
Epoch 46, Train Loss 0.255422, Valid_loss 0.863644
Epoch 47, Train Loss 0.235036, Valid_loss 0.528317
Epoch 48, Train Loss 0.273273, Valid_loss 0.679776
Epoch 49, Train Loss 0.277261, Valid_loss 0.579185
Epoch 50, Train Loss 0.160605, Valid_loss 0.480999
Epoch 51, Train Loss 0.149604, Valid_loss 0.495133
Epoch 52, Train Loss 0.156711, Valid_loss 0.565941
[I 2025-08-30 10:06:01,712] Trial 2 finished with value: 0.48099873793156195 and parameters: {'learning_rate': 0.001, 'epochs': 100, 'heads': 1, 'dropout': 0.0, 'weight_decay': 0.01, 'emb_dim': 64, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.4550641405706604.
선택된 trial params: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 1, 'dropout': 0.5, 'weight_decay': 0.01, 'emb_dim': 64, 'augment_num': 100, 'pca': False}
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=8, batch_size=1 -> steps=8
Memory Allocated: 19.85 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.909214, Valid_loss 1.480135
Epoch 2, Train Loss 0.802784, Valid_loss 1.501929
Epoch 3, Train Loss 0.702165, Valid_loss 1.204287
Epoch 4, Train Loss 0.532268, Valid_loss 1.192549
Epoch 5, Train Loss 0.550310, Valid_loss 0.925121
Epoch 6, Train Loss 0.524361, Valid_loss 0.892871
Epoch 7, Train Loss 0.487630, Valid_loss 1.068352
Epoch 8, Train Loss 0.500523, Valid_loss 0.997879
Epoch 9, Train Loss 0.444619, Valid_loss 0.784386
Epoch 10, Train Loss 0.454017, Valid_loss 0.936261
Epoch 11, Train Loss 0.418141, Valid_loss 0.942152
Epoch 12, Train Loss 0.479356, Valid_loss 0.889981
Epoch 13, Train Loss 0.418667, Valid_loss 0.828562
Epoch 14, Train Loss 0.374849, Valid_loss 0.890604
Epoch 15, Train Loss 0.407165, Valid_loss 0.979460
Epoch 16, Train Loss 0.395551, Valid_loss 0.752588
Epoch 17, Train Loss 0.367269, Valid_loss 0.689020
Epoch 18, Train Loss 0.367420, Valid_loss 0.775164
Epoch 19, Train Loss 0.410364, Valid_loss 0.667805
Epoch 20, Train Loss 0.356701, Valid_loss 0.665932
Epoch 21, Train Loss 0.366659, Valid_loss 0.610553
Epoch 22, Train Loss 0.326164, Valid_loss 0.970300
Epoch 23, Train Loss 0.293777, Valid_loss 0.941558
Epoch 24, Train Loss 0.372608, Valid_loss 0.867624
Epoch 25, Train Loss 0.305359, Valid_loss 0.591807
Epoch 26, Train Loss 0.346853, Valid_loss 0.831405
Epoch 27, Train Loss 0.292690, Valid_loss 0.772741
Epoch 28, Train Loss 0.297759, Valid_loss 0.712869
Epoch 29, Train Loss 0.339447, Valid_loss 0.898100
Epoch 30, Train Loss 0.287235, Valid_loss 0.880592
Epoch 31, Train Loss 0.329686, Valid_loss 0.522980
Epoch 32, Train Loss 0.248114, Valid_loss 0.800098
Epoch 33, Train Loss 0.278288, Valid_loss 0.665820
Epoch 34, Train Loss 0.290414, Valid_loss 0.679210
Epoch 35, Train Loss 0.254039, Valid_loss 0.536609
Epoch 36, Train Loss 0.280801, Valid_loss 0.750883
Epoch 37, Train Loss 0.200838, Valid_loss 0.481811
Epoch 38, Train Loss 0.336610, Valid_loss 0.540196
Epoch 39, Train Loss 0.271889, Valid_loss 0.813801
Epoch 40, Train Loss 0.307159, Valid_loss 0.491905
Epoch 41, Train Loss 0.224975, Valid_loss 0.628720
Epoch 42, Train Loss 0.221651, Valid_loss 0.559503
Epoch 43, Train Loss 0.220792, Valid_loss 0.580424
Epoch 44, Train Loss 0.224297, Valid_loss 0.682365
Epoch 45, Train Loss 0.202642, Valid_loss 0.497547
Epoch 46, Train Loss 0.214059, Valid_loss 0.782740
Epoch 47, Train Loss 0.196951, Valid_loss 0.467685
Epoch 48, Train Loss 0.200002, Valid_loss 0.477782
Epoch 49, Train Loss 0.249541, Valid_loss 0.430714
Epoch 50, Train Loss 0.238628, Valid_loss 0.738908
Epoch 51, Train Loss 0.186025, Valid_loss 0.613078
Epoch 52, Train Loss 0.199343, Valid_loss 0.713421
Epoch 53, Train Loss 0.164258, Valid_loss 0.549371
Epoch 54, Train Loss 0.169845, Valid_loss 0.526750
Epoch 55, Train Loss 0.144431, Valid_loss 0.463138
Epoch 56, Train Loss 0.196952, Valid_loss 0.516203
Epoch 57, Train Loss 0.142503, Valid_loss 0.563461
환자ID=P1430 -- true: [[2]] -- pred: tensor([[-1.9321,  0.4230,  0.5299]], device='cuda:0')
환자ID=P1437 -- true: [[2]] -- pred: tensor([[-1.9555,  0.3939,  0.5728]], device='cuda:0')
환자ID=P1558 -- true: [[0]] -- pred: tensor([[ 2.9232, -1.6841, -2.9834]], device='cuda:0')
환자ID=P1582 -- true: [[0]] -- pred: tensor([[ 2.9527, -1.7617, -2.9474]], device='cuda:0')
환자ID=P1630 -- true: [[1]] -- pred: tensor([[-1.9022,  0.7100,  0.3427]], device='cuda:0')
환자ID=P1678 -- true: [[0]] -- pred: tensor([[ 2.9556, -1.7856, -2.9391]], device='cuda:0')
환자ID=P1722 -- true: [[1]] -- pred: tensor([[-1.9301,  0.6258,  0.4430]], device='cuda:0')
환자ID=P1735 -- true: [[1]] -- pred: tensor([[-1.9411,  0.4633,  0.4992]], device='cuda:0')
Best performance: Epoch 49, Loss 0.249541, Test ACC 0.875000, Test AUC 1.000000, Test Recall 0.888889, Test Precision 0.888889
Confusion Matrix:
 [[3 0 0]
 [0 2 1]
 [0 0 2]]
✅ Total valid splits used: 5

📌 Repeat 3: 평균 AUC = 0.9222, 표준편차 = 0.0567
Test ACC 평균 0.700000, Test Recall 평균 0.666667, Test Precision 평균 0.576667
fold_aucs = [0.888888888888889, 0.8333333333333334, 0.9444444444444443, 0.9444444444444443, 1.0]
NaN 개수: 0 / 전체 5개

🔁 Repeat 4, Fold 0
cell type :  TTCTTCCGTTCAACGT-1-0                Astrocyte
CATCCACCATCTAACG-1-0      Smooth_muscle_cells
ACCCAAACAGCTAACT-1-0                  Neurons
AAGGAATCAACTGGTT-1-0     Neuroepithelial_cell
TACCCGTAGCGTGCTC-1-0                Astrocyte
                                 ...         
TTATTGCGTCGGTGTC-1-79       Endothelial_cells
GTCACGGGTTGTATGC-1-79       Endothelial_cells
GTCATGATCTTTCGAT-1-79       Endothelial_cells
GCGATCGTCAGAGTGG-1-79               Platelets
GCCCGAACAGAGAAAG-1-79       Endothelial_cells
Name: singler_annotation, Length: 456589, dtype: string
cell type annotation :  TTCTTCCGTTCAACGT-1-0                Astrocyte
CATCCACCATCTAACG-1-0      Smooth_muscle_cells
ACCCAAACAGCTAACT-1-0                  Neurons
AAGGAATCAACTGGTT-1-0     Neuroepithelial_cell
TACCCGTAGCGTGCTC-1-0                Astrocyte
                                 ...         
TTATTGCGTCGGTGTC-1-79       Endothelial_cells
GTCACGGGTTGTATGC-1-79       Endothelial_cells
GTCATGATCTTTCGAT-1-79       Endothelial_cells
GCGATCGTCAGAGTGG-1-79               Platelets
GCCCGAACAGAGAAAG-1-79       Endothelial_cells
Name: singler_annotation, Length: 456589, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Astrocyte', 'Smooth_muscle_cells', 'Neurons', 'Neuroepithelial_cell', 'Endothelial_cells', 'Osteoblasts', 'Platelets', 'Hepatocytes', 'Embryonic_stem_cells', 'MEP', 'Erythroblast', 'Fibroblasts', 'iPS_cells', 'MSC', 'Macrophage', 'Gametocytes', 'Chondrocytes', 'NK_cell', 'Neutrophils', 'HSC_CD34+', 'Monocyte', 'Tissue_stem_cells', 'DC', 'HSC_-G-CSF', 'T_cells', 'Epithelial_cells', 'Unknown', 'Pre-B_cell_CD34-', 'GMP', 'B_cell', 'Pro-Myelocyte', 'Keratinocytes', 'Myelocyte', 'BM', 'CMP', 'BM & Prog.', 'Pro-B_cell_CD34+']
라벨별 그룹 개수 {2: 9, 1: 12, 0: 12}
cell type :  CTGCTCAAGGCATCAG-1-3             Osteoblasts
TCATACTAGACTTCCA-1-3     Smooth_muscle_cells
GAGCCTGGTCGAGATG-1-3            Erythroblast
CTTACCGCAGAACTCT-1-3             Osteoblasts
TTGACCCCATCTAACG-1-3     Smooth_muscle_cells
                                ...         
TCATTGTGTGGATCGA-1-76      Endothelial_cells
TTCTAGTTCGTTCTAT-1-76      Endothelial_cells
GTAGTACCAGTTGTTG-1-76              Astrocyte
GCATCGGTCGCCGTGA-1-76      Endothelial_cells
TCGGGTGGTGAGAACC-1-76                Neurons
Name: singler_annotation, Length: 136100, dtype: string
cell type annotation :  CTGCTCAAGGCATCAG-1-3             Osteoblasts
TCATACTAGACTTCCA-1-3     Smooth_muscle_cells
GAGCCTGGTCGAGATG-1-3            Erythroblast
CTTACCGCAGAACTCT-1-3             Osteoblasts
TTGACCCCATCTAACG-1-3     Smooth_muscle_cells
                                ...         
TCATTGTGTGGATCGA-1-76      Endothelial_cells
TTCTAGTTCGTTCTAT-1-76      Endothelial_cells
GTAGTACCAGTTGTTG-1-76              Astrocyte
GCATCGGTCGCCGTGA-1-76      Endothelial_cells
TCGGGTGGTGAGAACC-1-76                Neurons
Name: singler_annotation, Length: 136100, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Osteoblasts', 'Smooth_muscle_cells', 'Erythroblast', 'Endothelial_cells', 'Neurons', 'Astrocyte', 'Fibroblasts', 'NK_cell', 'Gametocytes', 'Neuroepithelial_cell', 'Platelets', 'Embryonic_stem_cells', 'iPS_cells', 'Hepatocytes', 'MSC', 'Chondrocytes', 'MEP', 'BM & Prog.', 'Macrophage', 'Monocyte', 'Neutrophils', 'DC', 'HSC_CD34+', 'HSC_-G-CSF', 'Tissue_stem_cells', 'Unknown', 'T_cells', 'Keratinocytes', 'Epithelial_cells', 'B_cell', 'Myelocyte', 'Pro-Myelocyte', 'BM', 'Pre-B_cell_CD34-', 'GMP', 'CMP', 'Pro-B_cell_CD34+']
라벨별 그룹 개수 {2: 2, 1: 3, 0: 4}
🔍 Split #1
  → train_p_index 환자 수 (환자 단위로 묶인 index list): 33
  → test_p_index 환자 수  (환자 단위로 묶인 index list): 9
  → train 환자 ID: ['P1290', 'P1300', 'P1358', 'P1371', 'P1422', 'P1425', 'P1430', 'P1437', 'P1447', 'P1472', 'P1479', 'P1504', 'P1508', 'P1510', 'P1515', 'P1516', 'P1539', 'P1540', 'P1547', 'P1549', 'P1561', 'P1600', 'P1603', 'P1606', 'P1610', 'P1622', 'P1630', 'P1631', 'P1685', 'P1702', 'P1707', 'P1722', 'P1726']
  → test  환자 ID: ['P1304', 'P1462', 'P1558', 'P1582', 'P1602', 'P1617', 'P1678', 'P1718', 'P1735']
  → train 환자 ID 및 라벨:
    ID: P1290, Label: 2
    ID: P1300, Label: 2
    ID: P1358, Label: 2
    ID: P1371, Label: 2
    ID: P1422, Label: 1
    ID: P1425, Label: 1
    ID: P1430, Label: 2
    ID: P1437, Label: 2
    ID: P1447, Label: 1
    ID: P1472, Label: 2
    ID: P1479, Label: 1
    ID: P1504, Label: 2
    ID: P1508, Label: 1
    ID: P1510, Label: 1
    ID: P1515, Label: 0
    ID: P1516, Label: 0
    ID: P1539, Label: 0
    ID: P1540, Label: 0
    ID: P1547, Label: 0
    ID: P1549, Label: 0
    ID: P1561, Label: 0
    ID: P1600, Label: 0
    ID: P1603, Label: 0
    ID: P1606, Label: 2
    ID: P1610, Label: 0
    ID: P1622, Label: 0
    ID: P1630, Label: 1
    ID: P1631, Label: 1
    ID: P1685, Label: 1
    ID: P1702, Label: 0
    ID: P1707, Label: 1
    ID: P1722, Label: 1
    ID: P1726, Label: 1
  → test 환자 ID 및 라벨:
    ID: P1304, Label: 2
    ID: P1462, Label: 1
    ID: P1558, Label: 0
    ID: P1582, Label: 0
    ID: P1602, Label: 1
    ID: P1617, Label: 2
    ID: P1678, Label: 0
    ID: P1718, Label: 0
    ID: P1735, Label: 1
전체 데이터 index 길이 42
label_stat (train 환자 라벨 목록) 갯수 33
train_data에서 환자 단위로, train과 validation 나누기
기존 train_p_index 33
기존 (train) label_stat 33
train-vali 분할 후! 
train y 의 classes : {0, 1, 2} valid y 의 classes : {0, 1, 2} label_stat 의 classes : {0, 1, 2}
train_p_index_ 22
valid_p_index 11
test_p_index 9
→ train 환자 ID 및 라벨:
   총 개수: 22
   환자ID=P1600, Label=0, 셀개수=14882
   환자ID=P1707, Label=1, 셀개수=9517
   환자ID=P1515, Label=0, 셀개수=14502
   환자ID=P1358, Label=2, 셀개수=23984
   환자ID=P1447, Label=1, 셀개수=11151
   환자ID=P1606, Label=2, 셀개수=8523
   환자ID=P1630, Label=1, 셀개수=17633
   환자ID=P1422, Label=1, 셀개수=23315
   환자ID=P1726, Label=1, 셀개수=12389
   환자ID=P1702, Label=0, 셀개수=13550
   환자ID=P1539, Label=0, 셀개수=11076
   환자ID=P1631, Label=1, 셀개수=13686
   환자ID=P1508, Label=1, 셀개수=20536
   환자ID=P1425, Label=1, 셀개수=15378
   환자ID=P1622, Label=0, 셀개수=7210
   환자ID=P1510, Label=1, 셀개수=10744
   환자ID=P1603, Label=0, 셀개수=10638
   환자ID=P1504, Label=2, 셀개수=8133
   환자ID=P1479, Label=1, 셀개수=19124
   환자ID=P1437, Label=2, 셀개수=21695
   환자ID=P1561, Label=0, 셀개수=10016
   환자ID=P1516, Label=0, 셀개수=9361
→ valid 환자 ID 및 라벨:
   총 개수: 11
   환자ID=P1300, Label=2, 셀개수=17318
   환자ID=P1430, Label=2, 셀개수=11131
   환자ID=P1540, Label=0, 셀개수=11638
   환자ID=P1472, Label=2, 셀개수=19513
   환자ID=P1290, Label=2, 셀개수=8357
   환자ID=P1549, Label=0, 셀개수=11709
   환자ID=P1722, Label=1, 셀개수=21432
   환자ID=P1547, Label=0, 셀개수=8253
   환자ID=P1685, Label=1, 셀개수=10043
   환자ID=P1371, Label=2, 셀개수=16233
   환자ID=P1610, Label=0, 셀개수=13919
→ test 환자 ID 및 라벨:
   총 개수: 9
   환자ID=P1304, Label=2, 셀개수=19123
   환자ID=P1462, Label=1, 셀개수=21715
   환자ID=P1558, Label=0, 셀개수=10469
   환자ID=P1582, Label=0, 셀개수=18855
   환자ID=P1602, Label=1, 셀개수=16580
   환자ID=P1617, Label=2, 셀개수=17986
   환자ID=P1678, Label=0, 셀개수=10085
   환자ID=P1718, Label=0, 셀개수=9278
   환자ID=P1735, Label=1, 셀개수=12009
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Astrocyte', 'Smooth_muscle_cells', 'Neurons', 'Neuroepithelial_cell', 'Astrocyte', 'Endothelial_cells', 'Osteoblasts', 'Platelets', 'Neurons', 'Hepatocytes']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
전체 데이터 길이 592689
전체 cell type 길이 0                    Astrocyte
1          Smooth_muscle_cells
2                      Neurons
3         Neuroepithelial_cell
4                    Astrocyte
                  ...         
592684       Endothelial_cells
592685       Endothelial_cells
592686               Astrocyte
592687       Endothelial_cells
592688                 Neurons
Length: 592689, dtype: string
cell type의 NaN 개수 체크 0
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:12,  8.04it/s]  2%|▏         | 2/100 [00:00<00:12,  8.10it/s]  3%|▎         | 3/100 [00:00<00:12,  8.03it/s]  4%|▍         | 4/100 [00:00<00:12,  7.98it/s]  5%|▌         | 5/100 [00:00<00:11,  7.99it/s]  6%|▌         | 6/100 [00:00<00:11,  8.09it/s]  7%|▋         | 7/100 [00:00<00:11,  8.02it/s]  8%|▊         | 8/100 [00:00<00:11,  8.06it/s]  9%|▉         | 9/100 [00:01<00:11,  7.94it/s] 10%|█         | 10/100 [00:01<00:11,  7.90it/s] 11%|█         | 11/100 [00:01<00:11,  8.02it/s] 12%|█▏        | 12/100 [00:01<00:10,  8.03it/s] 13%|█▎        | 13/100 [00:01<00:10,  7.99it/s] 14%|█▍        | 14/100 [00:01<00:10,  8.07it/s] 15%|█▌        | 15/100 [00:01<00:10,  7.99it/s] 16%|█▌        | 16/100 [00:01<00:10,  8.04it/s] 17%|█▋        | 17/100 [00:02<00:10,  7.94it/s] 18%|█▊        | 18/100 [00:02<00:10,  8.01it/s] 19%|█▉        | 19/100 [00:02<00:10,  7.92it/s] 20%|██        | 20/100 [00:02<00:10,  7.91it/s] 21%|██        | 21/100 [00:02<00:10,  7.84it/s] 22%|██▏       | 22/100 [00:02<00:09,  8.03it/s] 23%|██▎       | 23/100 [00:02<00:09,  8.02it/s] 24%|██▍       | 24/100 [00:03<00:09,  7.98it/s] 25%|██▌       | 25/100 [00:03<00:09,  7.86it/s] 26%|██▌       | 26/100 [00:03<00:09,  7.83it/s] 27%|██▋       | 27/100 [00:03<00:09,  7.85it/s] 28%|██▊       | 28/100 [00:03<00:09,  7.81it/s] 29%|██▉       | 29/100 [00:03<00:08,  7.91it/s] 30%|███       | 30/100 [00:03<00:09,  7.71it/s] 31%|███       | 31/100 [00:03<00:09,  7.65it/s] 32%|███▏      | 32/100 [00:04<00:08,  7.77it/s] 33%|███▎      | 33/100 [00:04<00:08,  7.70it/s] 34%|███▍      | 34/100 [00:04<00:08,  7.74it/s] 35%|███▌      | 35/100 [00:04<00:08,  7.67it/s] 36%|███▌      | 36/100 [00:04<00:08,  7.71it/s] 37%|███▋      | 37/100 [00:04<00:08,  7.69it/s] 38%|███▊      | 38/100 [00:04<00:08,  7.66it/s] 39%|███▉      | 39/100 [00:04<00:07,  7.67it/s] 40%|████      | 40/100 [00:05<00:07,  7.55it/s] 41%|████      | 41/100 [00:05<00:07,  7.60it/s] 42%|████▏     | 42/100 [00:05<00:07,  7.62it/s] 43%|████▎     | 43/100 [00:05<00:07,  7.76it/s] 44%|████▍     | 44/100 [00:05<00:07,  7.58it/s] 45%|████▌     | 45/100 [00:05<00:07,  7.55it/s] 46%|████▌     | 46/100 [00:05<00:07,  7.41it/s] 47%|████▋     | 47/100 [00:06<00:07,  7.50it/s] 48%|████▊     | 48/100 [00:06<00:06,  7.57it/s] 49%|████▉     | 49/100 [00:06<00:06,  7.38it/s] 50%|█████     | 50/100 [00:06<00:06,  7.36it/s] 51%|█████     | 51/100 [00:06<00:06,  7.41it/s] 52%|█████▏    | 52/100 [00:06<00:06,  7.40it/s] 53%|█████▎    | 53/100 [00:06<00:06,  7.24it/s] 54%|█████▍    | 54/100 [00:06<00:06,  7.24it/s] 55%|█████▌    | 55/100 [00:07<00:06,  7.20it/s] 56%|█████▌    | 56/100 [00:07<00:06,  7.27it/s] 57%|█████▋    | 57/100 [00:07<00:05,  7.17it/s] 58%|█████▊    | 58/100 [00:07<00:05,  7.29it/s] 59%|█████▉    | 59/100 [00:07<00:05,  7.35it/s] 60%|██████    | 60/100 [00:07<00:05,  7.22it/s] 61%|██████    | 61/100 [00:07<00:05,  7.26it/s] 62%|██████▏   | 62/100 [00:08<00:05,  7.37it/s] 63%|██████▎   | 63/100 [00:08<00:05,  7.37it/s] 64%|██████▍   | 64/100 [00:08<00:04,  7.25it/s] 65%|██████▌   | 65/100 [00:08<00:04,  7.40it/s] 66%|██████▌   | 66/100 [00:08<00:04,  7.27it/s] 67%|██████▋   | 67/100 [00:08<00:04,  7.31it/s] 68%|██████▊   | 68/100 [00:08<00:04,  7.31it/s] 69%|██████▉   | 69/100 [00:09<00:04,  7.22it/s] 70%|███████   | 70/100 [00:09<00:04,  7.19it/s] 71%|███████   | 71/100 [00:09<00:04,  7.19it/s] 72%|███████▏  | 72/100 [00:09<00:03,  7.20it/s] 73%|███████▎  | 73/100 [00:09<00:03,  7.14it/s] 74%|███████▍  | 74/100 [00:09<00:03,  7.10it/s] 75%|███████▌  | 75/100 [00:09<00:03,  7.04it/s] 76%|███████▌  | 76/100 [00:10<00:03,  7.18it/s] 77%|███████▋  | 77/100 [00:10<00:03,  7.15it/s] 78%|███████▊  | 78/100 [00:10<00:03,  7.20it/s] 79%|███████▉  | 79/100 [00:10<00:02,  7.20it/s] 80%|████████  | 80/100 [00:10<00:02,  7.22it/s] 81%|████████  | 81/100 [00:10<00:02,  7.19it/s] 82%|████████▏ | 82/100 [00:10<00:02,  7.24it/s] 83%|████████▎ | 83/100 [00:10<00:02,  7.06it/s] 84%|████████▍ | 84/100 [00:11<00:02,  7.10it/s] 85%|████████▌ | 85/100 [00:11<00:02,  7.19it/s] 86%|████████▌ | 86/100 [00:11<00:01,  7.10it/s] 87%|████████▋ | 87/100 [00:11<00:01,  7.14it/s] 88%|████████▊ | 88/100 [00:11<00:01,  7.08it/s] 89%|████████▉ | 89/100 [00:11<00:01,  7.15it/s] 90%|█████████ | 90/100 [00:11<00:01,  6.97it/s] 91%|█████████ | 91/100 [00:12<00:01,  6.94it/s] 92%|█████████▏| 92/100 [00:12<00:01,  6.91it/s] 93%|█████████▎| 93/100 [00:12<00:01,  6.90it/s] 94%|█████████▍| 94/100 [00:12<00:00,  6.87it/s] 95%|█████████▌| 95/100 [00:12<00:00,  6.90it/s] 96%|█████████▌| 96/100 [00:12<00:00,  6.86it/s] 97%|█████████▋| 97/100 [00:13<00:00,  6.71it/s] 98%|█████████▊| 98/100 [00:13<00:00,  6.75it/s] 99%|█████████▉| 99/100 [00:13<00:00,  6.68it/s]100%|██████████| 100/100 [00:13<00:00,  6.71it/s]100%|██████████| 100/100 [00:13<00:00,  7.43it/s]
[I 2025-08-30 10:29:04,308] A new study created in memory with name: no-name-5adc7e85-fc19-4e0c-b789-30b08cfb6b6e
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 18.01 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.979895, Valid_loss 1.292692
Epoch 2, Train Loss 0.818493, Valid_loss 1.103246
Epoch 3, Train Loss 0.645608, Valid_loss 0.955706
Epoch 4, Train Loss 0.571445, Valid_loss 1.009572
Epoch 5, Train Loss 0.557603, Valid_loss 0.786174
Epoch 6, Train Loss 0.483116, Valid_loss 0.967502
Epoch 7, Train Loss 0.438590, Valid_loss 0.855529
Epoch 8, Train Loss 0.454528, Valid_loss 1.055254
Epoch 9, Train Loss 0.420661, Valid_loss 0.950730
Epoch 10, Train Loss 0.395826, Valid_loss 0.873047
Epoch 11, Train Loss 0.317020, Valid_loss 0.887113
Epoch 12, Train Loss 0.352489, Valid_loss 0.830620
Epoch 13, Train Loss 0.337070, Valid_loss 0.932221
Epoch 14, Train Loss 0.298337, Valid_loss 0.801051
Epoch 15, Train Loss 0.323276, Valid_loss 0.928961
Epoch 16, Train Loss 0.327252, Valid_loss 1.278895
Epoch 17, Train Loss 0.290739, Valid_loss 0.851369
Epoch 18, Train Loss 0.290072, Valid_loss 0.789321
Epoch 19, Train Loss 0.261978, Valid_loss 0.861674
Epoch 20, Train Loss 0.312963, Valid_loss 1.098692
Epoch 21, Train Loss 0.252304, Valid_loss 0.898661
Epoch 22, Train Loss 0.286171, Valid_loss 1.040468
Epoch 23, Train Loss 0.270845, Valid_loss 1.014055
Epoch 24, Train Loss 0.232870, Valid_loss 1.027455
Epoch 25, Train Loss 0.208849, Valid_loss 1.357748
Epoch 26, Train Loss 0.228575, Valid_loss 1.165730
Epoch 27, Train Loss 0.216572, Valid_loss 1.046935
Epoch 28, Train Loss 0.222169, Valid_loss 1.277014
Epoch 29, Train Loss 0.178700, Valid_loss 0.786201
Epoch 30, Train Loss 0.214981, Valid_loss 1.175894
Epoch 31, Train Loss 0.190074, Valid_loss 0.830462
Epoch 32, Train Loss 0.196760, Valid_loss 1.270162
Epoch 33, Train Loss 0.216543, Valid_loss 1.164012
Epoch 34, Train Loss 0.180951, Valid_loss 0.881254
Epoch 35, Train Loss 0.159378, Valid_loss 1.150652
Epoch 36, Train Loss 0.179790, Valid_loss 0.931384
Epoch 37, Train Loss 0.159558, Valid_loss 1.395012
Epoch 38, Train Loss 0.125836, Valid_loss 1.185009
Epoch 39, Train Loss 0.114490, Valid_loss 0.971315
Epoch 40, Train Loss 0.117809, Valid_loss 1.022171
Epoch 41, Train Loss 0.174726, Valid_loss 0.958500
Epoch 42, Train Loss 0.117575, Valid_loss 0.916992
Epoch 43, Train Loss 0.100074, Valid_loss 1.495173
Epoch 44, Train Loss 0.114596, Valid_loss 0.720328
Epoch 45, Train Loss 0.307697, Valid_loss 0.731050
Epoch 46, Train Loss 0.133543, Valid_loss 0.870603
Epoch 47, Train Loss 0.091826, Valid_loss 1.147495
Epoch 48, Train Loss 0.125123, Valid_loss 0.841657
Epoch 49, Train Loss 0.162440, Valid_loss 1.804247
Epoch 50, Train Loss 0.119552, Valid_loss 1.649059
Epoch 51, Train Loss 0.080652, Valid_loss 1.569150
Epoch 52, Train Loss 0.072283, Valid_loss 1.429287
Epoch 53, Train Loss 0.066643, Valid_loss 1.282628
Epoch 54, Train Loss 0.061192, Valid_loss 1.460278
Epoch 55, Train Loss 0.062312, Valid_loss 1.280335
Epoch 56, Train Loss 0.058044, Valid_loss 1.297060
Epoch 57, Train Loss 0.054404, Valid_loss 1.384600
[I 2025-08-30 10:50:15,275] Trial 0 finished with value: 0.7203284518962557 and parameters: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 1, 'dropout': 0.0, 'weight_decay': 0.0001, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.7203284518962557.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 18.01 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 1.030606, Valid_loss 1.796279
Epoch 2, Train Loss 0.961492, Valid_loss 1.566694
Epoch 3, Train Loss 0.943237, Valid_loss 1.459153
Epoch 4, Train Loss 0.944465, Valid_loss 1.535989
Epoch 5, Train Loss 0.928378, Valid_loss 1.637579
Epoch 6, Train Loss 0.917333, Valid_loss 1.399566
Epoch 7, Train Loss 0.944581, Valid_loss 1.378750
Epoch 8, Train Loss 0.924692, Valid_loss 1.445308
Epoch 9, Train Loss 0.913914, Valid_loss 1.514895
Epoch 10, Train Loss 0.917295, Valid_loss 1.445340
Epoch 11, Train Loss 0.905055, Valid_loss 1.440312
Epoch 12, Train Loss 0.924366, Valid_loss 1.491558
Epoch 13, Train Loss 0.909713, Valid_loss 1.675611
Epoch 14, Train Loss 0.914665, Valid_loss 1.463870
Epoch 15, Train Loss 0.921231, Valid_loss 1.468568
Epoch 16, Train Loss 0.917107, Valid_loss 1.487627
Epoch 17, Train Loss 0.914730, Valid_loss 1.496760
Epoch 18, Train Loss 0.906678, Valid_loss 1.553259
Epoch 19, Train Loss 0.909511, Valid_loss 1.585462
Epoch 20, Train Loss 0.911385, Valid_loss 1.466922
Epoch 21, Train Loss 0.907080, Valid_loss 1.495772
Epoch 22, Train Loss 0.914272, Valid_loss 1.477125
Epoch 23, Train Loss 0.912789, Valid_loss 1.503520
Epoch 24, Train Loss 0.903799, Valid_loss 1.504170
Epoch 25, Train Loss 0.907532, Valid_loss 1.513182
Epoch 26, Train Loss 0.905258, Valid_loss 1.515875
Epoch 27, Train Loss 0.903939, Valid_loss 1.531065
Epoch 28, Train Loss 0.906397, Valid_loss 1.530762
Epoch 29, Train Loss 0.905724, Valid_loss 1.512805
Epoch 30, Train Loss 0.903684, Valid_loss 1.520200
Epoch 31, Train Loss 0.905041, Valid_loss 1.526993
Epoch 32, Train Loss 0.906913, Valid_loss 1.523037
Epoch 33, Train Loss 0.917436, Valid_loss 1.522619
Epoch 34, Train Loss 0.915645, Valid_loss 1.559361
Epoch 35, Train Loss 0.914419, Valid_loss 1.513012
Epoch 36, Train Loss 0.916000, Valid_loss 1.500972
Epoch 37, Train Loss 0.907524, Valid_loss 1.691760
Epoch 38, Train Loss 0.932981, Valid_loss 1.591348
Epoch 39, Train Loss 0.908716, Valid_loss 1.505451
Epoch 40, Train Loss 0.904517, Valid_loss 1.520032
Epoch 41, Train Loss 0.910258, Valid_loss 1.488854
Epoch 42, Train Loss 0.905060, Valid_loss 1.510461
Epoch 43, Train Loss 0.905629, Valid_loss 1.543055
Epoch 44, Train Loss 0.907022, Valid_loss 1.542742
Epoch 45, Train Loss 0.907333, Valid_loss 1.521769
Epoch 46, Train Loss 0.903712, Valid_loss 1.538803
Epoch 47, Train Loss 0.907238, Valid_loss 1.523977
Epoch 48, Train Loss 0.907358, Valid_loss 1.524811
Epoch 49, Train Loss 0.906786, Valid_loss 1.523048
Epoch 50, Train Loss 0.903835, Valid_loss 1.533954
Epoch 51, Train Loss 0.911001, Valid_loss 1.526004
Epoch 52, Train Loss 0.902182, Valid_loss 1.534969
Epoch 53, Train Loss 0.902505, Valid_loss 1.521171
Epoch 54, Train Loss 0.902260, Valid_loss 1.525704
Epoch 55, Train Loss 0.902201, Valid_loss 1.565507
[I 2025-08-30 11:11:58,253] Trial 1 finished with value: 1.37874958190051 and parameters: {'learning_rate': 0.01, 'epochs': 100, 'heads': 1, 'dropout': 0.5, 'weight_decay': 0.01, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.7203284518962557.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 19.85 MB
Memory Reserved: 42.00 MB
cuda
CUDA OOM 발생 — 단계적 백오프 시작.
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 17906.54 MB
Memory Reserved: 17924.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 349.96 MB
Memory Reserved: 388.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 17906.25 MB
Memory Reserved: 17932.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 350.37 MB
Memory Reserved: 388.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[I 2025-08-30 11:11:59,969] Trial 2 pruned. Pruned due to OOM after backoff
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 17904.00 MB
Memory Reserved: 17934.00 MB
cuda
Epoch 1, Train Loss 0.932274, Valid_loss 1.391494
Epoch 2, Train Loss 0.797021, Valid_loss 1.205135
Epoch 3, Train Loss 0.629003, Valid_loss 1.190451
Epoch 4, Train Loss 0.536075, Valid_loss 1.014773
Epoch 5, Train Loss 0.525266, Valid_loss 0.920209
Epoch 6, Train Loss 0.464096, Valid_loss 1.095684
Epoch 7, Train Loss 0.425893, Valid_loss 0.799951
Epoch 8, Train Loss 0.326209, Valid_loss 0.975278
Epoch 9, Train Loss 0.311881, Valid_loss 0.942449
Epoch 10, Train Loss 0.353206, Valid_loss 0.847772
Epoch 11, Train Loss 0.287374, Valid_loss 0.918265
Epoch 12, Train Loss 0.280273, Valid_loss 0.898741
Epoch 13, Train Loss 0.246404, Valid_loss 0.857288
Epoch 14, Train Loss 0.262818, Valid_loss 1.025683
Epoch 15, Train Loss 0.249515, Valid_loss 1.146847
Epoch 16, Train Loss 0.172936, Valid_loss 0.801566
Epoch 17, Train Loss 0.174600, Valid_loss 0.660337
Epoch 18, Train Loss 0.156846, Valid_loss 0.639451
Epoch 19, Train Loss 0.202272, Valid_loss 0.737863
Epoch 20, Train Loss 0.125331, Valid_loss 0.862010
Epoch 21, Train Loss 0.098016, Valid_loss 1.038666
Epoch 22, Train Loss 0.087257, Valid_loss 1.495796
Epoch 23, Train Loss 0.150357, Valid_loss 0.903736
Epoch 24, Train Loss 0.091309, Valid_loss 1.929954
Epoch 25, Train Loss 0.181882, Valid_loss 2.232165
Epoch 26, Train Loss 0.118194, Valid_loss 1.037860
Epoch 27, Train Loss 0.078470, Valid_loss 1.285728
Epoch 28, Train Loss 0.030780, Valid_loss 1.199177
Epoch 29, Train Loss 0.091206, Valid_loss 0.959864
Epoch 30, Train Loss 0.032122, Valid_loss 1.198479
Epoch 31, Train Loss 0.015506, Valid_loss 0.942284
Epoch 32, Train Loss 0.015462, Valid_loss 0.858831
Epoch 33, Train Loss 0.016886, Valid_loss 1.113169
Epoch 34, Train Loss 0.032636, Valid_loss 1.510138
Epoch 35, Train Loss 0.010200, Valid_loss 1.001906
Epoch 36, Train Loss 0.107502, Valid_loss 0.897124
Epoch 37, Train Loss 0.124012, Valid_loss 1.746464
Epoch 38, Train Loss 0.192760, Valid_loss 1.282509
Epoch 39, Train Loss 0.081518, Valid_loss 1.065338
Epoch 40, Train Loss 0.032003, Valid_loss 1.738690
Epoch 41, Train Loss 0.083407, Valid_loss 0.366404
Epoch 42, Train Loss 0.064896, Valid_loss 0.759420
Epoch 43, Train Loss 0.015737, Valid_loss 0.786019
Epoch 44, Train Loss 0.009182, Valid_loss 0.690620
Epoch 45, Train Loss 0.006927, Valid_loss 0.647947
Epoch 46, Train Loss 0.005606, Valid_loss 0.633366
Epoch 47, Train Loss 0.004746, Valid_loss 0.631924
Epoch 48, Train Loss 0.004122, Valid_loss 0.682974
Epoch 49, Train Loss 0.003685, Valid_loss 0.624493
Epoch 50, Train Loss 0.003020, Valid_loss 0.602514
Epoch 51, Train Loss 0.002766, Valid_loss 0.582795
Epoch 52, Train Loss 0.002512, Valid_loss 0.556858
Epoch 53, Train Loss 0.002357, Valid_loss 0.573781
Epoch 54, Train Loss 0.002210, Valid_loss 0.585486
[I 2025-08-30 11:32:01,172] Trial 3 finished with value: 0.36640423570166936 and parameters: {'learning_rate': 0.001, 'epochs': 100, 'heads': 1, 'dropout': 0.0, 'weight_decay': 0.0001, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 3 with value: 0.36640423570166936.
선택된 trial params: {'learning_rate': 0.001, 'epochs': 100, 'heads': 1, 'dropout': 0.0, 'weight_decay': 0.0001, 'emb_dim': 32, 'augment_num': 100, 'pca': False}
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=9, batch_size=1 -> steps=9
Memory Allocated: 18.01 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.931003, Valid_loss 1.355050
Epoch 2, Train Loss 0.848648, Valid_loss 1.047957
Epoch 3, Train Loss 0.879802, Valid_loss 0.892662
Epoch 4, Train Loss 0.602996, Valid_loss 0.978117
Epoch 5, Train Loss 0.583221, Valid_loss 0.728926
Epoch 6, Train Loss 0.426174, Valid_loss 0.927426
Epoch 7, Train Loss 0.371643, Valid_loss 0.820001
Epoch 8, Train Loss 0.422287, Valid_loss 0.730118
Epoch 9, Train Loss 0.325013, Valid_loss 0.586018
Epoch 10, Train Loss 0.320527, Valid_loss 0.466406
Epoch 11, Train Loss 0.284425, Valid_loss 0.761156
Epoch 12, Train Loss 0.324030, Valid_loss 0.582522
Epoch 13, Train Loss 0.371188, Valid_loss 0.408158
Epoch 14, Train Loss 0.297733, Valid_loss 0.800442
Epoch 15, Train Loss 0.224620, Valid_loss 0.757398
Epoch 16, Train Loss 0.201894, Valid_loss 1.460751
Epoch 17, Train Loss 0.277380, Valid_loss 0.775911
Epoch 18, Train Loss 0.184962, Valid_loss 0.959218
Epoch 19, Train Loss 0.210803, Valid_loss 1.227316
Epoch 20, Train Loss 0.176756, Valid_loss 0.564367
Epoch 21, Train Loss 0.375734, Valid_loss 0.414605
Epoch 22, Train Loss 0.226702, Valid_loss 1.836053
Epoch 23, Train Loss 0.223913, Valid_loss 0.589182
Epoch 24, Train Loss 0.163464, Valid_loss 1.046152
Epoch 25, Train Loss 0.139609, Valid_loss 0.587436
Epoch 26, Train Loss 0.131492, Valid_loss 1.309418
Epoch 27, Train Loss 0.161547, Valid_loss 0.517475
Epoch 28, Train Loss 0.084274, Valid_loss 0.951686
Epoch 29, Train Loss 0.065938, Valid_loss 0.814115
Epoch 30, Train Loss 0.213815, Valid_loss 0.669102
Epoch 31, Train Loss 0.185455, Valid_loss 1.154358
Epoch 32, Train Loss 0.106149, Valid_loss 0.640325
Epoch 33, Train Loss 0.146375, Valid_loss 0.932086
Epoch 34, Train Loss 0.098235, Valid_loss 0.904211
Epoch 35, Train Loss 0.108997, Valid_loss 0.961771
Epoch 36, Train Loss 0.048104, Valid_loss 1.251936
Epoch 37, Train Loss 0.073856, Valid_loss 0.616834
Epoch 38, Train Loss 0.046043, Valid_loss 1.709212
Epoch 39, Train Loss 0.150308, Valid_loss 0.743401
Epoch 40, Train Loss 0.071019, Valid_loss 0.775365
Epoch 41, Train Loss 0.128004, Valid_loss 0.974795
Epoch 42, Train Loss 0.028898, Valid_loss 0.839993
Epoch 43, Train Loss 0.033243, Valid_loss 1.284831
Epoch 44, Train Loss 0.026703, Valid_loss 1.219331
Epoch 45, Train Loss 0.097409, Valid_loss 2.504818
Epoch 46, Train Loss 0.316958, Valid_loss 1.283068
Epoch 47, Train Loss 0.109550, Valid_loss 0.891085
Epoch 48, Train Loss 0.115560, Valid_loss 1.092997
Epoch 49, Train Loss 0.067572, Valid_loss 0.635315
Epoch 50, Train Loss 0.084655, Valid_loss 1.986648
Epoch 51, Train Loss 0.052366, Valid_loss 0.972813
Epoch 52, Train Loss 0.020444, Valid_loss 0.873942
Epoch 53, Train Loss 0.020142, Valid_loss 1.108799
Epoch 54, Train Loss 0.019692, Valid_loss 0.887434
Epoch 55, Train Loss 0.012785, Valid_loss 0.980730
Epoch 56, Train Loss 0.010203, Valid_loss 0.947417
Epoch 57, Train Loss 0.009027, Valid_loss 0.953545
Epoch 58, Train Loss 0.008386, Valid_loss 0.909833
Epoch 59, Train Loss 0.006812, Valid_loss 0.997393
Epoch 60, Train Loss 0.006019, Valid_loss 0.917520
Epoch 61, Train Loss 0.005816, Valid_loss 0.945374
Epoch 62, Train Loss 0.004919, Valid_loss 0.974771
환자ID=P1304 -- true: [[2]] -- pred: tensor([[-2.2364,  1.4229,  0.3471]], device='cuda:0')
환자ID=P1462 -- true: [[1]] -- pred: tensor([[-2.2555,  1.3574,  0.4684]], device='cuda:0')
환자ID=P1558 -- true: [[0]] -- pred: tensor([[ 3.5142, -0.0586, -4.0728]], device='cuda:0')
환자ID=P1582 -- true: [[0]] -- pred: tensor([[ 3.4778, -0.0233, -4.0596]], device='cuda:0')
환자ID=P1602 -- true: [[1]] -- pred: tensor([[-0.2500,  2.0619, -1.4606]], device='cuda:0')
환자ID=P1617 -- true: [[2]] -- pred: tensor([[-2.7725,  0.3295,  1.1715]], device='cuda:0')
환자ID=P1678 -- true: [[0]] -- pred: tensor([[ 3.4929, -0.0438, -4.0569]], device='cuda:0')
환자ID=P1718 -- true: [[0]] -- pred: tensor([[ 3.3558,  0.1251, -4.0464]], device='cuda:0')
환자ID=P1735 -- true: [[1]] -- pred: tensor([[-2.7094,  0.5273,  1.0532]], device='cuda:0')
Best performance: Epoch 13, Loss 0.371188, Test ACC 0.777778, Test AUC 0.888889, Test Recall 0.722222, Test Precision 0.722222
Confusion Matrix:
 [[4 0 0]
 [0 2 1]
 [0 1 1]]
✅ Total valid splits used: 1
🔁 Repeat 4, Fold 1
cell type :  TTCTTCCGTTCAACGT-1-0                Astrocyte
CATCCACCATCTAACG-1-0      Smooth_muscle_cells
ACCCAAACAGCTAACT-1-0                  Neurons
AAGGAATCAACTGGTT-1-0     Neuroepithelial_cell
TACCCGTAGCGTGCTC-1-0                Astrocyte
                                 ...         
TTATTGCGTCGGTGTC-1-79       Endothelial_cells
GTCACGGGTTGTATGC-1-79       Endothelial_cells
GTCATGATCTTTCGAT-1-79       Endothelial_cells
GCGATCGTCAGAGTGG-1-79               Platelets
GCCCGAACAGAGAAAG-1-79       Endothelial_cells
Name: singler_annotation, Length: 456327, dtype: string
cell type annotation :  TTCTTCCGTTCAACGT-1-0                Astrocyte
CATCCACCATCTAACG-1-0      Smooth_muscle_cells
ACCCAAACAGCTAACT-1-0                  Neurons
AAGGAATCAACTGGTT-1-0     Neuroepithelial_cell
TACCCGTAGCGTGCTC-1-0                Astrocyte
                                 ...         
TTATTGCGTCGGTGTC-1-79       Endothelial_cells
GTCACGGGTTGTATGC-1-79       Endothelial_cells
GTCATGATCTTTCGAT-1-79       Endothelial_cells
GCGATCGTCAGAGTGG-1-79               Platelets
GCCCGAACAGAGAAAG-1-79       Endothelial_cells
Name: singler_annotation, Length: 456327, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Astrocyte', 'Smooth_muscle_cells', 'Neurons', 'Neuroepithelial_cell', 'Endothelial_cells', 'Osteoblasts', 'Platelets', 'Hepatocytes', 'Embryonic_stem_cells', 'MEP', 'Erythroblast', 'Fibroblasts', 'iPS_cells', 'MSC', 'Macrophage', 'Gametocytes', 'Chondrocytes', 'NK_cell', 'Neutrophils', 'HSC_CD34+', 'Monocyte', 'Tissue_stem_cells', 'DC', 'HSC_-G-CSF', 'T_cells', 'Epithelial_cells', 'Unknown', 'Pre-B_cell_CD34-', 'GMP', 'B_cell', 'Pro-Myelocyte', 'Keratinocytes', 'Myelocyte', 'BM', 'CMP', 'BM & Prog.', 'Pro-B_cell_CD34+']
라벨별 그룹 개수 {2: 8, 1: 12, 0: 13}
cell type :  ACAGCCGCAAGCGAGT-1-1                 Neurons
ATATCCTGTCCCTAAA-1-1       Endothelial_cells
CAATGACCAGTTGTCA-1-1                 Neurons
CTAGACACAAGGTTGG-1-1                 Neurons
ATCGTCCGTATTTCTC-1-1     Smooth_muscle_cells
                                ...         
TCGTGGGAGAGTCTTC-1-62      Endothelial_cells
GGTAGAGTCACCGCTT-1-62                     DC
GCACGGTGTCCAGCGT-1-62    Smooth_muscle_cells
TTGTTCAAGAGAGTGA-1-62    Smooth_muscle_cells
AGATCCATCGATTGGT-1-62      Endothelial_cells
Name: singler_annotation, Length: 136362, dtype: string
cell type annotation :  ACAGCCGCAAGCGAGT-1-1                 Neurons
ATATCCTGTCCCTAAA-1-1       Endothelial_cells
CAATGACCAGTTGTCA-1-1                 Neurons
CTAGACACAAGGTTGG-1-1                 Neurons
ATCGTCCGTATTTCTC-1-1     Smooth_muscle_cells
                                ...         
TCGTGGGAGAGTCTTC-1-62      Endothelial_cells
GGTAGAGTCACCGCTT-1-62                     DC
GCACGGTGTCCAGCGT-1-62    Smooth_muscle_cells
TTGTTCAAGAGAGTGA-1-62    Smooth_muscle_cells
AGATCCATCGATTGGT-1-62      Endothelial_cells
Name: singler_annotation, Length: 136362, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Neurons', 'Endothelial_cells', 'Smooth_muscle_cells', 'Neuroepithelial_cell', 'Astrocyte', 'Fibroblasts', 'Osteoblasts', 'Erythroblast', 'iPS_cells', 'Embryonic_stem_cells', 'Platelets', 'MSC', 'Hepatocytes', 'NK_cell', 'MEP', 'BM & Prog.', 'Gametocytes', 'Chondrocytes', 'HSC_CD34+', 'Tissue_stem_cells', 'Macrophage', 'Monocyte', 'Neutrophils', 'DC', 'HSC_-G-CSF', 'Unknown', 'Keratinocytes', 'B_cell', 'T_cells', 'Myelocyte', 'Epithelial_cells', 'GMP', 'BM', 'Pro-Myelocyte', 'Pro-B_cell_CD34+', 'CMP', 'Pre-B_cell_CD34-']
라벨별 그룹 개수 {2: 3, 1: 3, 0: 3}
🔍 Split #2
  → train_p_index 환자 수 (환자 단위로 묶인 index list): 33
  → test_p_index 환자 수  (환자 단위로 묶인 index list): 9
  → train 환자 ID: ['P1290', 'P1300', 'P1304', 'P1425', 'P1437', 'P1447', 'P1462', 'P1472', 'P1479', 'P1504', 'P1508', 'P1510', 'P1515', 'P1539', 'P1547', 'P1549', 'P1558', 'P1561', 'P1582', 'P1600', 'P1602', 'P1603', 'P1606', 'P1610', 'P1617', 'P1622', 'P1631', 'P1678', 'P1685', 'P1718', 'P1722', 'P1726', 'P1735']
  → test  환자 ID: ['P1358', 'P1371', 'P1422', 'P1430', 'P1516', 'P1540', 'P1630', 'P1702', 'P1707']
  → train 환자 ID 및 라벨:
    ID: P1290, Label: 2
    ID: P1300, Label: 2
    ID: P1304, Label: 2
    ID: P1425, Label: 1
    ID: P1437, Label: 2
    ID: P1447, Label: 1
    ID: P1462, Label: 1
    ID: P1472, Label: 2
    ID: P1479, Label: 1
    ID: P1504, Label: 2
    ID: P1508, Label: 1
    ID: P1510, Label: 1
    ID: P1515, Label: 0
    ID: P1539, Label: 0
    ID: P1547, Label: 0
    ID: P1549, Label: 0
    ID: P1558, Label: 0
    ID: P1561, Label: 0
    ID: P1582, Label: 0
    ID: P1600, Label: 0
    ID: P1602, Label: 1
    ID: P1603, Label: 0
    ID: P1606, Label: 2
    ID: P1610, Label: 0
    ID: P1617, Label: 2
    ID: P1622, Label: 0
    ID: P1631, Label: 1
    ID: P1678, Label: 0
    ID: P1685, Label: 1
    ID: P1718, Label: 0
    ID: P1722, Label: 1
    ID: P1726, Label: 1
    ID: P1735, Label: 1
  → test 환자 ID 및 라벨:
    ID: P1358, Label: 2
    ID: P1371, Label: 2
    ID: P1422, Label: 1
    ID: P1430, Label: 2
    ID: P1516, Label: 0
    ID: P1540, Label: 0
    ID: P1630, Label: 1
    ID: P1702, Label: 0
    ID: P1707, Label: 1
전체 데이터 index 길이 42
label_stat (train 환자 라벨 목록) 갯수 33
train_data에서 환자 단위로, train과 validation 나누기
기존 train_p_index 33
기존 (train) label_stat 33
train-vali 분할 후! 
train y 의 classes : {0, 1, 2} valid y 의 classes : {0, 1, 2} label_stat 의 classes : {0, 1, 2}
train_p_index_ 22
valid_p_index 11
test_p_index 9
→ train 환자 ID 및 라벨:
   총 개수: 22
   환자ID=P1603, Label=0, 셀개수=10638
   환자ID=P1722, Label=1, 셀개수=21432
   환자ID=P1547, Label=0, 셀개수=8253
   환자ID=P1304, Label=2, 셀개수=19123
   환자ID=P1479, Label=1, 셀개수=19124
   환자ID=P1610, Label=0, 셀개수=13919
   환자ID=P1631, Label=1, 셀개수=13686
   환자ID=P1437, Label=2, 셀개수=21695
   환자ID=P1735, Label=1, 셀개수=12009
   환자ID=P1718, Label=0, 셀개수=9278
   환자ID=P1558, Label=0, 셀개수=10469
   환자ID=P1678, Label=0, 셀개수=10085
   환자ID=P1515, Label=0, 셀개수=14502
   환자ID=P1447, Label=1, 셀개수=11151
   환자ID=P1622, Label=0, 셀개수=7210
   환자ID=P1539, Label=0, 셀개수=11076
   환자ID=P1606, Label=2, 셀개수=8523
   환자ID=P1510, Label=1, 셀개수=10744
   환자ID=P1508, Label=1, 셀개수=20536
   환자ID=P1472, Label=2, 셀개수=19513
   환자ID=P1602, Label=1, 셀개수=16580
   환자ID=P1549, Label=0, 셀개수=11709
→ valid 환자 ID 및 라벨:
   총 개수: 11
   환자ID=P1300, Label=2, 셀개수=17318
   환자ID=P1462, Label=1, 셀개수=21715
   환자ID=P1561, Label=0, 셀개수=10016
   환자ID=P1504, Label=2, 셀개수=8133
   환자ID=P1290, Label=2, 셀개수=8357
   환자ID=P1600, Label=0, 셀개수=14882
   환자ID=P1726, Label=1, 셀개수=12389
   환자ID=P1582, Label=0, 셀개수=18855
   환자ID=P1685, Label=1, 셀개수=10043
   환자ID=P1425, Label=1, 셀개수=15378
   환자ID=P1617, Label=2, 셀개수=17986
→ test 환자 ID 및 라벨:
   총 개수: 9
   환자ID=P1358, Label=2, 셀개수=23984
   환자ID=P1371, Label=2, 셀개수=16233
   환자ID=P1422, Label=1, 셀개수=23315
   환자ID=P1430, Label=2, 셀개수=11131
   환자ID=P1516, Label=0, 셀개수=9361
   환자ID=P1540, Label=0, 셀개수=11638
   환자ID=P1630, Label=1, 셀개수=17633
   환자ID=P1702, Label=0, 셀개수=13550
   환자ID=P1707, Label=1, 셀개수=9517
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Astrocyte', 'Smooth_muscle_cells', 'Neurons', 'Neuroepithelial_cell', 'Astrocyte', 'Endothelial_cells', 'Osteoblasts', 'Platelets', 'Neurons', 'Hepatocytes']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
전체 데이터 길이 592689
전체 cell type 길이 0                    Astrocyte
1          Smooth_muscle_cells
2                      Neurons
3         Neuroepithelial_cell
4                    Astrocyte
                  ...         
592684       Endothelial_cells
592685                      DC
592686     Smooth_muscle_cells
592687     Smooth_muscle_cells
592688       Endothelial_cells
Length: 592689, dtype: string
cell type의 NaN 개수 체크 0
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:12,  8.09it/s]  2%|▏         | 2/100 [00:00<00:11,  8.32it/s]  3%|▎         | 3/100 [00:00<00:11,  8.34it/s]  4%|▍         | 4/100 [00:00<00:11,  8.41it/s]  5%|▌         | 5/100 [00:00<00:11,  8.40it/s]  6%|▌         | 6/100 [00:00<00:11,  8.34it/s]  7%|▋         | 7/100 [00:00<00:11,  8.29it/s]  8%|▊         | 8/100 [00:00<00:11,  8.23it/s]  9%|▉         | 9/100 [00:01<00:11,  8.23it/s] 10%|█         | 10/100 [00:01<00:10,  8.27it/s] 11%|█         | 11/100 [00:01<00:10,  8.38it/s] 12%|█▏        | 12/100 [00:01<00:10,  8.21it/s] 13%|█▎        | 13/100 [00:01<00:10,  8.22it/s] 14%|█▍        | 14/100 [00:01<00:10,  8.36it/s] 15%|█▌        | 15/100 [00:01<00:10,  8.47it/s] 16%|█▌        | 16/100 [00:01<00:10,  8.28it/s] 17%|█▋        | 17/100 [00:02<00:10,  8.15it/s] 18%|█▊        | 18/100 [00:02<00:10,  8.11it/s] 19%|█▉        | 19/100 [00:02<00:09,  8.27it/s] 20%|██        | 20/100 [00:02<00:09,  8.12it/s] 21%|██        | 21/100 [00:02<00:09,  8.20it/s] 22%|██▏       | 22/100 [00:02<00:09,  8.22it/s] 23%|██▎       | 23/100 [00:02<00:09,  8.20it/s] 24%|██▍       | 24/100 [00:02<00:09,  8.01it/s] 25%|██▌       | 25/100 [00:03<00:09,  8.03it/s] 26%|██▌       | 26/100 [00:03<00:09,  8.08it/s] 27%|██▋       | 27/100 [00:03<00:08,  8.14it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.02it/s] 29%|██▉       | 29/100 [00:03<00:08,  8.03it/s] 30%|███       | 30/100 [00:03<00:08,  7.93it/s] 31%|███       | 31/100 [00:03<00:08,  8.14it/s] 32%|███▏      | 32/100 [00:03<00:08,  8.09it/s] 33%|███▎      | 33/100 [00:04<00:08,  8.00it/s] 34%|███▍      | 34/100 [00:04<00:08,  7.95it/s] 35%|███▌      | 35/100 [00:04<00:08,  7.99it/s] 36%|███▌      | 36/100 [00:04<00:08,  7.96it/s] 37%|███▋      | 37/100 [00:04<00:08,  7.86it/s] 38%|███▊      | 38/100 [00:04<00:07,  7.80it/s] 39%|███▉      | 39/100 [00:04<00:07,  7.86it/s] 40%|████      | 40/100 [00:04<00:07,  7.79it/s] 41%|████      | 41/100 [00:05<00:07,  7.66it/s] 42%|████▏     | 42/100 [00:05<00:07,  7.63it/s] 43%|████▎     | 43/100 [00:05<00:07,  7.70it/s] 44%|████▍     | 44/100 [00:05<00:07,  7.75it/s] 45%|████▌     | 45/100 [00:05<00:07,  7.65it/s] 46%|████▌     | 46/100 [00:05<00:06,  7.74it/s] 47%|████▋     | 47/100 [00:05<00:06,  7.70it/s] 48%|████▊     | 48/100 [00:05<00:06,  7.59it/s] 49%|████▉     | 49/100 [00:06<00:06,  7.63it/s] 50%|█████     | 50/100 [00:06<00:06,  7.53it/s] 51%|█████     | 51/100 [00:06<00:06,  7.55it/s] 52%|█████▏    | 52/100 [00:06<00:06,  7.49it/s] 53%|█████▎    | 53/100 [00:06<00:06,  7.48it/s] 54%|█████▍    | 54/100 [00:06<00:06,  7.51it/s] 55%|█████▌    | 55/100 [00:06<00:05,  7.52it/s] 56%|█████▌    | 56/100 [00:07<00:05,  7.52it/s] 57%|█████▋    | 57/100 [00:07<00:05,  7.48it/s] 58%|█████▊    | 58/100 [00:07<00:05,  7.58it/s] 59%|█████▉    | 59/100 [00:07<00:05,  7.65it/s] 60%|██████    | 60/100 [00:07<00:05,  7.57it/s] 61%|██████    | 61/100 [00:07<00:05,  7.58it/s] 62%|██████▏   | 62/100 [00:07<00:05,  7.57it/s] 63%|██████▎   | 63/100 [00:07<00:04,  7.54it/s] 64%|██████▍   | 64/100 [00:08<00:04,  7.54it/s] 65%|██████▌   | 65/100 [00:08<00:04,  7.58it/s] 66%|██████▌   | 66/100 [00:08<00:04,  7.44it/s] 67%|██████▋   | 67/100 [00:08<00:04,  7.50it/s] 68%|██████▊   | 68/100 [00:08<00:04,  7.57it/s] 69%|██████▉   | 69/100 [00:08<00:04,  7.43it/s] 70%|███████   | 70/100 [00:08<00:03,  7.51it/s] 71%|███████   | 71/100 [00:09<00:03,  7.34it/s] 72%|███████▏  | 72/100 [00:09<00:03,  7.19it/s] 73%|███████▎  | 73/100 [00:09<00:03,  7.29it/s] 74%|███████▍  | 74/100 [00:09<00:03,  7.20it/s] 75%|███████▌  | 75/100 [00:09<00:03,  7.18it/s] 76%|███████▌  | 76/100 [00:09<00:03,  7.24it/s] 77%|███████▋  | 77/100 [00:09<00:03,  7.22it/s] 78%|███████▊  | 78/100 [00:10<00:03,  7.22it/s] 79%|███████▉  | 79/100 [00:10<00:02,  7.19it/s] 80%|████████  | 80/100 [00:10<00:02,  7.32it/s] 81%|████████  | 81/100 [00:10<00:02,  7.19it/s] 82%|████████▏ | 82/100 [00:10<00:02,  7.16it/s] 83%|████████▎ | 83/100 [00:10<00:02,  7.14it/s] 84%|████████▍ | 84/100 [00:10<00:02,  7.13it/s] 85%|████████▌ | 85/100 [00:11<00:02,  7.06it/s] 86%|████████▌ | 86/100 [00:11<00:01,  7.12it/s] 87%|████████▋ | 87/100 [00:11<00:01,  7.02it/s] 88%|████████▊ | 88/100 [00:11<00:01,  6.98it/s] 89%|████████▉ | 89/100 [00:11<00:01,  6.94it/s] 90%|█████████ | 90/100 [00:11<00:01,  7.01it/s] 91%|█████████ | 91/100 [00:11<00:01,  6.98it/s] 92%|█████████▏| 92/100 [00:11<00:01,  7.14it/s] 93%|█████████▎| 93/100 [00:12<00:00,  7.18it/s] 94%|█████████▍| 94/100 [00:12<00:00,  7.05it/s] 95%|█████████▌| 95/100 [00:12<00:00,  7.08it/s] 96%|█████████▌| 96/100 [00:12<00:00,  7.11it/s] 97%|█████████▋| 97/100 [00:12<00:00,  6.59it/s] 98%|█████████▊| 98/100 [00:12<00:00,  5.73it/s] 99%|█████████▉| 99/100 [00:13<00:00,  6.05it/s]100%|██████████| 100/100 [00:13<00:00,  3.35it/s]100%|██████████| 100/100 [00:13<00:00,  7.29it/s]
[I 2025-08-30 11:55:49,351] A new study created in memory with name: no-name-daabd6c8-c276-41e3-b4cd-3874fd623f9d
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 16.69 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 1.155059, Valid_loss 1.075868
Epoch 2, Train Loss 1.183944, Valid_loss 1.185132
Epoch 3, Train Loss 1.007974, Valid_loss 1.054244
Epoch 4, Train Loss 1.038357, Valid_loss 0.910181
Epoch 5, Train Loss 1.012870, Valid_loss 0.908076
Epoch 6, Train Loss 0.912044, Valid_loss 0.881858
Epoch 7, Train Loss 0.838316, Valid_loss 1.194873
Epoch 8, Train Loss 0.834262, Valid_loss 0.926120
Epoch 9, Train Loss 0.912591, Valid_loss 0.936778
Epoch 10, Train Loss 0.872358, Valid_loss 0.877003
Epoch 11, Train Loss 0.882912, Valid_loss 0.883060
Epoch 12, Train Loss 0.801563, Valid_loss 0.878649
Epoch 13, Train Loss 0.786816, Valid_loss 0.881640
Epoch 14, Train Loss 0.749882, Valid_loss 0.906805
Epoch 15, Train Loss 0.774992, Valid_loss 0.899781
Epoch 16, Train Loss 0.774026, Valid_loss 0.892817
Epoch 17, Train Loss 0.827217, Valid_loss 0.866430
Epoch 18, Train Loss 0.691927, Valid_loss 0.853274
Epoch 19, Train Loss 0.631588, Valid_loss 0.901063
Epoch 20, Train Loss 0.749875, Valid_loss 0.867613
Epoch 21, Train Loss 0.693393, Valid_loss 0.850582
Epoch 22, Train Loss 0.754779, Valid_loss 0.867438
Epoch 23, Train Loss 0.710380, Valid_loss 1.036527
Epoch 24, Train Loss 0.695552, Valid_loss 0.839714
Epoch 25, Train Loss 0.715434, Valid_loss 0.846459
Epoch 26, Train Loss 0.673605, Valid_loss 0.830011
Epoch 27, Train Loss 0.631606, Valid_loss 1.026954
Epoch 28, Train Loss 0.670051, Valid_loss 0.884894
Epoch 29, Train Loss 0.663981, Valid_loss 0.852041
Epoch 30, Train Loss 0.731551, Valid_loss 0.866965
Epoch 31, Train Loss 0.604342, Valid_loss 0.827478
Epoch 32, Train Loss 0.691751, Valid_loss 0.849387
Epoch 33, Train Loss 0.610744, Valid_loss 0.831645
Epoch 34, Train Loss 0.679104, Valid_loss 0.849506
Epoch 35, Train Loss 0.622996, Valid_loss 0.836127
Epoch 36, Train Loss 0.620333, Valid_loss 0.896641
Epoch 37, Train Loss 0.640214, Valid_loss 0.844836
Epoch 38, Train Loss 0.668057, Valid_loss 0.834639
Epoch 39, Train Loss 0.674547, Valid_loss 0.850000
Epoch 40, Train Loss 0.575305, Valid_loss 0.856627
Epoch 41, Train Loss 0.562171, Valid_loss 1.257604
Epoch 42, Train Loss 0.610068, Valid_loss 0.814246
Epoch 43, Train Loss 0.586798, Valid_loss 0.810861
Epoch 44, Train Loss 0.601698, Valid_loss 0.810516
Epoch 45, Train Loss 0.623499, Valid_loss 0.811496
Epoch 46, Train Loss 0.640975, Valid_loss 0.812427
Epoch 47, Train Loss 0.639378, Valid_loss 0.816892
Epoch 48, Train Loss 0.557289, Valid_loss 0.893642
Epoch 49, Train Loss 0.663723, Valid_loss 0.820482
Epoch 50, Train Loss 0.587800, Valid_loss 0.829942
Epoch 51, Train Loss 0.596299, Valid_loss 0.847368
Epoch 52, Train Loss 0.493948, Valid_loss 0.830898
Epoch 53, Train Loss 0.577076, Valid_loss 0.876601
Epoch 54, Train Loss 0.544334, Valid_loss 0.817496
Epoch 55, Train Loss 0.541509, Valid_loss 0.848941
Epoch 56, Train Loss 0.510127, Valid_loss 0.813427
Epoch 57, Train Loss 0.536960, Valid_loss 0.818979
Epoch 58, Train Loss 0.520355, Valid_loss 0.855810
[I 2025-08-30 12:16:02,952] Trial 0 finished with value: 0.8105163520032709 and parameters: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 1, 'dropout': 0.7, 'weight_decay': 0.001, 'emb_dim': 8, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.8105163520032709.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 19.85 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.949345, Valid_loss 1.860041
Epoch 2, Train Loss 0.891442, Valid_loss 1.678208
Epoch 3, Train Loss 0.889254, Valid_loss 1.702771
Epoch 4, Train Loss 0.843275, Valid_loss 1.492482
Epoch 5, Train Loss 0.863227, Valid_loss 1.281655
Epoch 6, Train Loss 0.868168, Valid_loss 1.342343
Epoch 7, Train Loss 0.870768, Valid_loss 1.386133
Epoch 8, Train Loss 0.841047, Valid_loss 1.417548
Epoch 9, Train Loss 0.843334, Valid_loss 1.497289
Epoch 10, Train Loss 0.843707, Valid_loss 1.625711
Epoch 11, Train Loss 0.821208, Valid_loss 1.370133
Epoch 12, Train Loss 0.846295, Valid_loss 1.372621
Epoch 13, Train Loss 0.821206, Valid_loss 1.733177
Epoch 14, Train Loss 0.839884, Valid_loss 1.288548
Epoch 15, Train Loss 0.849512, Valid_loss 1.340252
Epoch 16, Train Loss 0.819335, Valid_loss 1.556696
Epoch 17, Train Loss 0.833639, Valid_loss 1.349352
Epoch 18, Train Loss 0.819112, Valid_loss 1.726117
Epoch 19, Train Loss 0.844864, Valid_loss 1.483405
Epoch 20, Train Loss 0.835762, Valid_loss 1.521981
Epoch 21, Train Loss 0.840997, Valid_loss 1.575638
Epoch 22, Train Loss 0.827478, Valid_loss 1.636300
Epoch 23, Train Loss 0.842031, Valid_loss 1.575250
Epoch 24, Train Loss 0.837248, Valid_loss 1.473238
Epoch 25, Train Loss 0.831887, Valid_loss 1.464346
Epoch 26, Train Loss 0.829738, Valid_loss 1.533596
Epoch 27, Train Loss 0.839939, Valid_loss 1.506325
Epoch 28, Train Loss 0.815078, Valid_loss 1.586992
Epoch 29, Train Loss 0.830408, Valid_loss 1.596252
Epoch 30, Train Loss 0.828076, Valid_loss 1.467174
Epoch 31, Train Loss 0.842665, Valid_loss 1.482993
Epoch 32, Train Loss 0.900164, Valid_loss 1.463208
Epoch 33, Train Loss 0.826989, Valid_loss 1.496029
Epoch 34, Train Loss 0.825834, Valid_loss 1.512488
Epoch 35, Train Loss 0.825883, Valid_loss 1.541477
Epoch 36, Train Loss 0.828216, Valid_loss 1.524024
Epoch 37, Train Loss 0.825489, Valid_loss 1.550003
Epoch 38, Train Loss 0.824687, Valid_loss 1.533127
Epoch 39, Train Loss 0.827921, Valid_loss 1.527988
Epoch 40, Train Loss 0.825633, Valid_loss 1.505983
Epoch 41, Train Loss 0.847396, Valid_loss 1.501461
Epoch 42, Train Loss 0.830150, Valid_loss 1.651510
Epoch 43, Train Loss 0.849083, Valid_loss 1.516995
Epoch 44, Train Loss 0.829784, Valid_loss 1.550785
Epoch 45, Train Loss 0.826416, Valid_loss 1.680596
Epoch 46, Train Loss 0.840835, Valid_loss 1.563320
Epoch 47, Train Loss 0.833198, Valid_loss 2.165438
Epoch 48, Train Loss 0.874977, Valid_loss 1.543871
Epoch 49, Train Loss 0.826164, Valid_loss 1.513768
Epoch 50, Train Loss 0.831541, Valid_loss 1.512542
Epoch 51, Train Loss 0.825958, Valid_loss 1.523671
Epoch 52, Train Loss 0.823748, Valid_loss 1.523453
Epoch 53, Train Loss 0.825319, Valid_loss 1.515076
Epoch 54, Train Loss 0.820705, Valid_loss 1.541720
Epoch 55, Train Loss 0.828153, Valid_loss 1.529514
Epoch 56, Train Loss 0.826314, Valid_loss 1.517340
Epoch 57, Train Loss 0.822751, Valid_loss 1.526128
Epoch 58, Train Loss 0.823167, Valid_loss 1.550341
[I 2025-08-30 12:47:24,000] Trial 1 finished with value: 1.2816546559333801 and parameters: {'learning_rate': 0.01, 'epochs': 100, 'heads': 2, 'dropout': 0.3, 'weight_decay': 0.01, 'emb_dim': 64, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.8105163520032709.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 19.85 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.956093, Valid_loss 1.525519
Epoch 2, Train Loss 0.884855, Valid_loss 1.369433
Epoch 3, Train Loss 0.885266, Valid_loss 1.269265
Epoch 4, Train Loss 0.866405, Valid_loss 1.239885
Epoch 5, Train Loss 0.861307, Valid_loss 1.542395
Epoch 6, Train Loss 0.845450, Valid_loss 1.492030
Epoch 7, Train Loss 0.831289, Valid_loss 1.413400
Epoch 8, Train Loss 0.857090, Valid_loss 1.447465
Epoch 9, Train Loss 0.861154, Valid_loss 1.617531
Epoch 10, Train Loss 0.833824, Valid_loss 1.417860
Epoch 11, Train Loss 0.841771, Valid_loss 1.402795
Epoch 12, Train Loss 0.825645, Valid_loss 1.401728
Epoch 13, Train Loss 0.840431, Valid_loss 1.442023
Epoch 14, Train Loss 0.814826, Valid_loss 1.254754
Epoch 15, Train Loss 0.814834, Valid_loss 1.822286
Epoch 16, Train Loss 0.852229, Valid_loss 1.349181
Epoch 17, Train Loss 0.827514, Valid_loss 1.333862
Epoch 18, Train Loss 0.849504, Valid_loss 1.295023
Epoch 19, Train Loss 0.822454, Valid_loss 1.420776
Epoch 20, Train Loss 0.846672, Valid_loss 1.344399
Epoch 21, Train Loss 0.813901, Valid_loss 1.411666
Epoch 22, Train Loss 0.839042, Valid_loss 1.652837
Epoch 23, Train Loss 0.834708, Valid_loss 1.645329
Epoch 24, Train Loss 0.842458, Valid_loss 1.369041
Epoch 25, Train Loss 0.839608, Valid_loss 1.509378
Epoch 26, Train Loss 0.830507, Valid_loss 1.396121
Epoch 27, Train Loss 0.829849, Valid_loss 1.747814
Epoch 28, Train Loss 0.833699, Valid_loss 1.621417
Epoch 29, Train Loss 0.804062, Valid_loss 1.747742
Epoch 30, Train Loss 0.830478, Valid_loss 1.537247
Epoch 31, Train Loss 0.838705, Valid_loss 1.860141
Epoch 32, Train Loss 0.800374, Valid_loss 1.837800
Epoch 33, Train Loss 0.853489, Valid_loss 1.675093
Epoch 34, Train Loss 0.835534, Valid_loss 1.453846
Epoch 35, Train Loss 0.859806, Valid_loss 1.787319
Epoch 36, Train Loss 0.822828, Valid_loss 1.544219
Epoch 37, Train Loss 0.864799, Valid_loss 1.472238
Epoch 38, Train Loss 0.846545, Valid_loss 1.545552
Epoch 39, Train Loss 0.839263, Valid_loss 2.115234
Epoch 40, Train Loss 0.878660, Valid_loss 1.563222
Epoch 41, Train Loss 0.830166, Valid_loss 1.522391
Epoch 42, Train Loss 0.827585, Valid_loss 1.557429
Epoch 43, Train Loss 0.836272, Valid_loss 1.535316
Epoch 44, Train Loss 0.831154, Valid_loss 1.527734
Epoch 45, Train Loss 0.830426, Valid_loss 1.487341
Epoch 46, Train Loss 0.827590, Valid_loss 1.522282
Epoch 47, Train Loss 0.832649, Valid_loss 1.601773
Epoch 48, Train Loss 0.866117, Valid_loss 1.506100
Epoch 49, Train Loss 0.833575, Valid_loss 1.532057
Epoch 50, Train Loss 0.820717, Valid_loss 1.487705
Epoch 51, Train Loss 0.826704, Valid_loss 1.508206
Epoch 52, Train Loss 0.824259, Valid_loss 1.497082
Epoch 53, Train Loss 0.820999, Valid_loss 1.559162
Epoch 54, Train Loss 0.829619, Valid_loss 1.560251
[I 2025-08-30 13:16:39,644] Trial 2 finished with value: 1.2398851242932407 and parameters: {'learning_rate': 0.01, 'epochs': 100, 'heads': 2, 'dropout': 0.3, 'weight_decay': 0.01, 'emb_dim': 64, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.8105163520032709.
선택된 trial params: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 1, 'dropout': 0.7, 'weight_decay': 0.001, 'emb_dim': 8, 'augment_num': 100, 'pca': False}
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=11, batch_size=1 -> steps=11
👉 test  samples=9, batch_size=1 -> steps=9
Memory Allocated: 16.69 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 1.293053, Valid_loss 1.215734
Epoch 2, Train Loss 1.214093, Valid_loss 1.240964
Epoch 3, Train Loss 1.209366, Valid_loss 1.246302
Epoch 4, Train Loss 1.182653, Valid_loss 1.255389
Epoch 5, Train Loss 1.184048, Valid_loss 1.243096
Epoch 6, Train Loss 1.098095, Valid_loss 1.243379
Epoch 7, Train Loss 1.071053, Valid_loss 1.261202
Epoch 8, Train Loss 1.089904, Valid_loss 1.269882
Epoch 9, Train Loss 1.026790, Valid_loss 1.313359
Epoch 10, Train Loss 1.057124, Valid_loss 1.324491
Epoch 11, Train Loss 1.069284, Valid_loss 1.303477
Epoch 12, Train Loss 1.069858, Valid_loss 1.323120
Epoch 13, Train Loss 1.041071, Valid_loss 1.327273
Epoch 14, Train Loss 0.996001, Valid_loss 1.306783
Epoch 15, Train Loss 0.968419, Valid_loss 1.332963
Epoch 16, Train Loss 0.947085, Valid_loss 1.312619
Epoch 17, Train Loss 0.994764, Valid_loss 1.317541
Epoch 18, Train Loss 0.926624, Valid_loss 1.318699
Epoch 19, Train Loss 0.906225, Valid_loss 1.304737
Epoch 20, Train Loss 0.970275, Valid_loss 1.258267
Epoch 21, Train Loss 0.909132, Valid_loss 1.261701
Epoch 22, Train Loss 0.964885, Valid_loss 1.250216
Epoch 23, Train Loss 0.891800, Valid_loss 1.251717
Epoch 24, Train Loss 0.895208, Valid_loss 1.265346
Epoch 25, Train Loss 0.862290, Valid_loss 1.151387
Epoch 26, Train Loss 0.921633, Valid_loss 1.212885
Epoch 27, Train Loss 0.888460, Valid_loss 1.177945
Epoch 28, Train Loss 0.884270, Valid_loss 1.151053
Epoch 29, Train Loss 0.874886, Valid_loss 1.190035
Epoch 30, Train Loss 0.827575, Valid_loss 1.136897
Epoch 31, Train Loss 0.811917, Valid_loss 1.066380
Epoch 32, Train Loss 0.845455, Valid_loss 1.092948
Epoch 33, Train Loss 0.819531, Valid_loss 1.081015
Epoch 34, Train Loss 0.826402, Valid_loss 1.062901
Epoch 35, Train Loss 0.846073, Valid_loss 1.071197
Epoch 36, Train Loss 0.806126, Valid_loss 0.972785
Epoch 37, Train Loss 0.780164, Valid_loss 0.926612
Epoch 38, Train Loss 0.772223, Valid_loss 0.996389
Epoch 39, Train Loss 0.790145, Valid_loss 1.025042
Epoch 40, Train Loss 0.798959, Valid_loss 0.942260
Epoch 41, Train Loss 0.770613, Valid_loss 0.975937
Epoch 42, Train Loss 0.794423, Valid_loss 0.906972
Epoch 43, Train Loss 0.715858, Valid_loss 0.974450
Epoch 44, Train Loss 0.744476, Valid_loss 0.986419
Epoch 45, Train Loss 0.759314, Valid_loss 0.989764
Epoch 46, Train Loss 0.697767, Valid_loss 0.938007
Epoch 47, Train Loss 0.799332, Valid_loss 0.980468
Epoch 48, Train Loss 0.804448, Valid_loss 0.964693
Epoch 49, Train Loss 0.764883, Valid_loss 1.004352
Epoch 50, Train Loss 0.699926, Valid_loss 0.861388
Epoch 51, Train Loss 0.753050, Valid_loss 0.926211
Epoch 52, Train Loss 0.739876, Valid_loss 0.917980
Epoch 53, Train Loss 0.722179, Valid_loss 0.918871
Epoch 54, Train Loss 0.722013, Valid_loss 1.034626
환자ID=P1358 -- true: [[2]] -- pred: tensor([[0.1087, 0.9497, 0.0813]], device='cuda:0')
환자ID=P1371 -- true: [[2]] -- pred: tensor([[ 0.2210,  0.9381, -0.1444]], device='cuda:0')
환자ID=P1422 -- true: [[1]] -- pred: tensor([[ 0.1766,  1.0171, -0.0926]], device='cuda:0')
환자ID=P1430 -- true: [[2]] -- pred: tensor([[ 0.1549,  1.0003, -0.0502]], device='cuda:0')
환자ID=P1516 -- true: [[0]] -- pred: tensor([[ 0.9256, -0.1052, -1.3618]], device='cuda:0')
환자ID=P1540 -- true: [[0]] -- pred: tensor([[ 0.9101, -0.1493, -1.3164]], device='cuda:0')
환자ID=P1630 -- true: [[1]] -- pred: tensor([[0.0660, 0.9255, 0.0955]], device='cuda:0')
환자ID=P1702 -- true: [[0]] -- pred: tensor([[ 0.9212, -0.1085, -1.3532]], device='cuda:0')
환자ID=P1707 -- true: [[1]] -- pred: tensor([[0.0854, 0.9232, 0.0433]], device='cuda:0')
Best performance: Epoch 50, Loss 0.699926, Test ACC 0.666667, Test AUC 0.796296, Test Recall 0.666667, Test Precision 0.500000
Confusion Matrix:
 [[3 0 0]
 [0 3 0]
 [0 3 0]]
✅ Total valid splits used: 2
🔁 Repeat 4, Fold 2
cell type :  TTCTTCCGTTCAACGT-1-0                Astrocyte
CATCCACCATCTAACG-1-0      Smooth_muscle_cells
ACCCAAACAGCTAACT-1-0                  Neurons
AAGGAATCAACTGGTT-1-0     Neuroepithelial_cell
TACCCGTAGCGTGCTC-1-0                Astrocyte
                                 ...         
CGTCCATAGAATTTGG-1-78       Endothelial_cells
GCTTCACAGCGTTGTT-1-78             Hepatocytes
TCTCTGGCAGTCGCAC-1-78                 Neurons
CAACAACCAGAGGCTA-1-78                 Neurons
CATTGTTGTCGTACAT-1-78       Endothelial_cells
Name: singler_annotation, Length: 474271, dtype: string
cell type annotation :  TTCTTCCGTTCAACGT-1-0                Astrocyte
CATCCACCATCTAACG-1-0      Smooth_muscle_cells
ACCCAAACAGCTAACT-1-0                  Neurons
AAGGAATCAACTGGTT-1-0     Neuroepithelial_cell
TACCCGTAGCGTGCTC-1-0                Astrocyte
                                 ...         
CGTCCATAGAATTTGG-1-78       Endothelial_cells
GCTTCACAGCGTTGTT-1-78             Hepatocytes
TCTCTGGCAGTCGCAC-1-78                 Neurons
CAACAACCAGAGGCTA-1-78                 Neurons
CATTGTTGTCGTACAT-1-78       Endothelial_cells
Name: singler_annotation, Length: 474271, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Astrocyte', 'Smooth_muscle_cells', 'Neurons', 'Neuroepithelial_cell', 'Endothelial_cells', 'Osteoblasts', 'Platelets', 'Hepatocytes', 'Embryonic_stem_cells', 'MEP', 'Erythroblast', 'Fibroblasts', 'iPS_cells', 'MSC', 'Macrophage', 'Gametocytes', 'Chondrocytes', 'NK_cell', 'Neutrophils', 'HSC_CD34+', 'Monocyte', 'Tissue_stem_cells', 'DC', 'HSC_-G-CSF', 'T_cells', 'Epithelial_cells', 'Unknown', 'Pre-B_cell_CD34-', 'GMP', 'B_cell', 'Pro-Myelocyte', 'Keratinocytes', 'Myelocyte', 'BM', 'CMP', 'BM & Prog.', 'Pro-B_cell_CD34+']
라벨별 그룹 개수 {2: 9, 1: 12, 0: 13}
cell type :  AGTTAGCCATGCCATA-1-11              iPS_cells
ACCACAATCTGTCTCG-1-11    Smooth_muscle_cells
CCGCAAGAGGAAGTGA-1-11                Neurons
ACAACCACAGCCTTCT-1-11            Osteoblasts
ACTCTCGCAGGAAGTC-1-11      Endothelial_cells
                                ...         
TTATTGCGTCGGTGTC-1-79      Endothelial_cells
GTCACGGGTTGTATGC-1-79      Endothelial_cells
GTCATGATCTTTCGAT-1-79      Endothelial_cells
GCGATCGTCAGAGTGG-1-79              Platelets
GCCCGAACAGAGAAAG-1-79      Endothelial_cells
Name: singler_annotation, Length: 118418, dtype: string
cell type annotation :  AGTTAGCCATGCCATA-1-11              iPS_cells
ACCACAATCTGTCTCG-1-11    Smooth_muscle_cells
CCGCAAGAGGAAGTGA-1-11                Neurons
ACAACCACAGCCTTCT-1-11            Osteoblasts
ACTCTCGCAGGAAGTC-1-11      Endothelial_cells
                                ...         
TTATTGCGTCGGTGTC-1-79      Endothelial_cells
GTCACGGGTTGTATGC-1-79      Endothelial_cells
GTCATGATCTTTCGAT-1-79      Endothelial_cells
GCGATCGTCAGAGTGG-1-79              Platelets
GCCCGAACAGAGAAAG-1-79      Endothelial_cells
Name: singler_annotation, Length: 118418, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['iPS_cells', 'Smooth_muscle_cells', 'Neurons', 'Osteoblasts', 'Endothelial_cells', 'Erythroblast', 'Neuroepithelial_cell', 'Platelets', 'Fibroblasts', 'Astrocyte', 'Embryonic_stem_cells', 'Hepatocytes', 'Chondrocytes', 'NK_cell', 'Tissue_stem_cells', 'MSC', 'Monocyte', 'Gametocytes', 'Macrophage', 'MEP', 'Neutrophils', 'DC', 'BM & Prog.', 'HSC_CD34+', 'Epithelial_cells', 'T_cells', 'HSC_-G-CSF', 'Keratinocytes', 'GMP', 'Unknown', 'CMP', 'Myelocyte', 'Pro-Myelocyte', 'B_cell', 'Pre-B_cell_CD34-', 'BM', 'Pro-B_cell_CD34+']
라벨별 그룹 개수 {1: 3, 2: 2, 0: 3}
🔍 Split #3
  → train_p_index 환자 수 (환자 단위로 묶인 index list): 34
  → test_p_index 환자 수  (환자 단위로 묶인 index list): 8
  → train 환자 ID: ['P1290', 'P1300', 'P1304', 'P1358', 'P1371', 'P1422', 'P1430', 'P1447', 'P1462', 'P1479', 'P1504', 'P1508', 'P1510', 'P1516', 'P1539', 'P1540', 'P1547', 'P1549', 'P1558', 'P1582', 'P1602', 'P1603', 'P1606', 'P1610', 'P1617', 'P1622', 'P1630', 'P1631', 'P1678', 'P1702', 'P1707', 'P1718', 'P1722', 'P1735']
  → test  환자 ID: ['P1425', 'P1437', 'P1472', 'P1515', 'P1561', 'P1600', 'P1685', 'P1726']
  → train 환자 ID 및 라벨:
    ID: P1290, Label: 2
    ID: P1300, Label: 2
    ID: P1304, Label: 2
    ID: P1358, Label: 2
    ID: P1371, Label: 2
    ID: P1422, Label: 1
    ID: P1430, Label: 2
    ID: P1447, Label: 1
    ID: P1462, Label: 1
    ID: P1479, Label: 1
    ID: P1504, Label: 2
    ID: P1508, Label: 1
    ID: P1510, Label: 1
    ID: P1516, Label: 0
    ID: P1539, Label: 0
    ID: P1540, Label: 0
    ID: P1547, Label: 0
    ID: P1549, Label: 0
    ID: P1558, Label: 0
    ID: P1582, Label: 0
    ID: P1602, Label: 1
    ID: P1603, Label: 0
    ID: P1606, Label: 2
    ID: P1610, Label: 0
    ID: P1617, Label: 2
    ID: P1622, Label: 0
    ID: P1630, Label: 1
    ID: P1631, Label: 1
    ID: P1678, Label: 0
    ID: P1702, Label: 0
    ID: P1707, Label: 1
    ID: P1718, Label: 0
    ID: P1722, Label: 1
    ID: P1735, Label: 1
  → test 환자 ID 및 라벨:
    ID: P1425, Label: 1
    ID: P1437, Label: 2
    ID: P1472, Label: 2
    ID: P1515, Label: 0
    ID: P1561, Label: 0
    ID: P1600, Label: 0
    ID: P1685, Label: 1
    ID: P1726, Label: 1
전체 데이터 index 길이 42
label_stat (train 환자 라벨 목록) 갯수 34
train_data에서 환자 단위로, train과 validation 나누기
기존 train_p_index 34
기존 (train) label_stat 34
train-vali 분할 후! 
train y 의 classes : {0, 1, 2} valid y 의 classes : {0, 1, 2} label_stat 의 classes : {0, 1, 2}
train_p_index_ 22
valid_p_index 12
test_p_index 8
→ train 환자 ID 및 라벨:
   총 개수: 22
   환자ID=P1718, Label=0, 셀개수=9278
   환자ID=P1539, Label=0, 셀개수=11076
   환자ID=P1304, Label=2, 셀개수=19123
   환자ID=P1462, Label=1, 셀개수=21715
   환자ID=P1610, Label=0, 셀개수=13919
   환자ID=P1631, Label=1, 셀개수=13686
   환자ID=P1371, Label=2, 셀개수=16233
   환자ID=P1735, Label=1, 셀개수=12009
   환자ID=P1707, Label=1, 셀개수=9517
   환자ID=P1547, Label=0, 셀개수=8253
   환자ID=P1678, Label=0, 셀개수=10085
   환자ID=P1510, Label=1, 셀개수=10744
   환자ID=P1422, Label=1, 셀개수=23315
   환자ID=P1630, Label=1, 셀개수=17633
   환자ID=P1622, Label=0, 셀개수=7210
   환자ID=P1516, Label=0, 셀개수=9361
   환자ID=P1606, Label=2, 셀개수=8523
   환자ID=P1508, Label=1, 셀개수=20536
   환자ID=P1504, Label=2, 셀개수=8133
   환자ID=P1447, Label=1, 셀개수=11151
   환자ID=P1602, Label=1, 셀개수=16580
   환자ID=P1540, Label=0, 셀개수=11638
→ valid 환자 ID 및 라벨:
   총 개수: 12
   환자ID=P1300, Label=2, 셀개수=17318
   환자ID=P1430, Label=2, 셀개수=11131
   환자ID=P1549, Label=0, 셀개수=11709
   환자ID=P1479, Label=1, 셀개수=19124
   환자ID=P1290, Label=2, 셀개수=8357
   환자ID=P1582, Label=0, 셀개수=18855
   환자ID=P1722, Label=1, 셀개수=21432
   환자ID=P1558, Label=0, 셀개수=10469
   환자ID=P1702, Label=0, 셀개수=13550
   환자ID=P1358, Label=2, 셀개수=23984
   환자ID=P1617, Label=2, 셀개수=17986
   환자ID=P1603, Label=0, 셀개수=10638
→ test 환자 ID 및 라벨:
   총 개수: 8
   환자ID=P1425, Label=1, 셀개수=15378
   환자ID=P1437, Label=2, 셀개수=21695
   환자ID=P1472, Label=2, 셀개수=19513
   환자ID=P1515, Label=0, 셀개수=14502
   환자ID=P1561, Label=0, 셀개수=10016
   환자ID=P1600, Label=0, 셀개수=14882
   환자ID=P1685, Label=1, 셀개수=10043
   환자ID=P1726, Label=1, 셀개수=12389
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Astrocyte', 'Smooth_muscle_cells', 'Neurons', 'Neuroepithelial_cell', 'Astrocyte', 'Endothelial_cells', 'Osteoblasts', 'Platelets', 'Neurons', 'Hepatocytes']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
전체 데이터 길이 592689
전체 cell type 길이 0                    Astrocyte
1          Smooth_muscle_cells
2                      Neurons
3         Neuroepithelial_cell
4                    Astrocyte
                  ...         
592684       Endothelial_cells
592685       Endothelial_cells
592686       Endothelial_cells
592687               Platelets
592688       Endothelial_cells
Length: 592689, dtype: string
cell type의 NaN 개수 체크 0
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:12,  7.91it/s]  2%|▏         | 2/100 [00:00<00:12,  8.00it/s]  3%|▎         | 3/100 [00:00<00:11,  8.09it/s]  4%|▍         | 4/100 [00:00<00:12,  7.93it/s]  5%|▌         | 5/100 [00:00<00:12,  7.89it/s]  6%|▌         | 6/100 [00:00<00:11,  7.86it/s]  7%|▋         | 7/100 [00:00<00:11,  8.06it/s]  8%|▊         | 8/100 [00:01<00:11,  7.86it/s]  9%|▉         | 9/100 [00:01<00:11,  7.89it/s] 10%|█         | 10/100 [00:01<00:11,  7.90it/s] 11%|█         | 11/100 [00:01<00:11,  7.95it/s] 12%|█▏        | 12/100 [00:01<00:11,  7.94it/s] 13%|█▎        | 13/100 [00:01<00:10,  8.03it/s] 14%|█▍        | 14/100 [00:01<00:10,  7.83it/s] 15%|█▌        | 15/100 [00:01<00:10,  7.83it/s] 16%|█▌        | 16/100 [00:02<00:10,  7.84it/s] 17%|█▋        | 17/100 [00:02<00:10,  7.89it/s] 18%|█▊        | 18/100 [00:02<00:10,  7.90it/s] 19%|█▉        | 19/100 [00:02<00:10,  7.92it/s] 20%|██        | 20/100 [00:02<00:10,  7.86it/s] 21%|██        | 21/100 [00:02<00:10,  7.88it/s] 22%|██▏       | 22/100 [00:02<00:10,  7.73it/s] 23%|██▎       | 23/100 [00:02<00:09,  7.81it/s] 24%|██▍       | 24/100 [00:03<00:09,  7.90it/s] 25%|██▌       | 25/100 [00:03<00:09,  7.81it/s] 26%|██▌       | 26/100 [00:03<00:09,  7.72it/s] 27%|██▋       | 27/100 [00:03<00:09,  7.87it/s] 28%|██▊       | 28/100 [00:03<00:09,  7.80it/s] 29%|██▉       | 29/100 [00:03<00:09,  7.73it/s] 30%|███       | 30/100 [00:03<00:09,  7.67it/s] 31%|███       | 31/100 [00:03<00:08,  7.72it/s] 32%|███▏      | 32/100 [00:04<00:08,  7.67it/s] 33%|███▎      | 33/100 [00:04<00:08,  7.62it/s] 34%|███▍      | 34/100 [00:04<00:08,  7.62it/s] 35%|███▌      | 35/100 [00:04<00:08,  7.54it/s] 36%|███▌      | 36/100 [00:04<00:08,  7.58it/s] 37%|███▋      | 37/100 [00:04<00:08,  7.60it/s] 38%|███▊      | 38/100 [00:04<00:08,  7.47it/s] 39%|███▉      | 39/100 [00:05<00:08,  7.51it/s] 40%|████      | 40/100 [00:05<00:08,  7.45it/s] 41%|████      | 41/100 [00:05<00:07,  7.46it/s] 42%|████▏     | 42/100 [00:05<00:07,  7.45it/s] 43%|████▎     | 43/100 [00:05<00:07,  7.47it/s] 44%|████▍     | 44/100 [00:05<00:07,  7.41it/s] 45%|████▌     | 45/100 [00:05<00:07,  7.53it/s] 46%|████▌     | 46/100 [00:05<00:07,  7.51it/s] 47%|████▋     | 47/100 [00:06<00:07,  7.43it/s] 48%|████▊     | 48/100 [00:06<00:06,  7.50it/s] 49%|████▉     | 49/100 [00:06<00:06,  7.51it/s] 50%|█████     | 50/100 [00:06<00:06,  7.54it/s] 51%|█████     | 51/100 [00:06<00:06,  7.56it/s] 52%|█████▏    | 52/100 [00:06<00:06,  7.57it/s] 53%|█████▎    | 53/100 [00:06<00:06,  7.60it/s] 54%|█████▍    | 54/100 [00:07<00:06,  7.63it/s] 55%|█████▌    | 55/100 [00:07<00:05,  7.58it/s] 56%|█████▌    | 56/100 [00:07<00:05,  7.70it/s] 57%|█████▋    | 57/100 [00:07<00:05,  7.55it/s] 58%|█████▊    | 58/100 [00:07<00:05,  7.50it/s] 59%|█████▉    | 59/100 [00:07<00:05,  7.46it/s] 60%|██████    | 60/100 [00:07<00:05,  7.53it/s] 61%|██████    | 61/100 [00:07<00:05,  7.41it/s] 62%|██████▏   | 62/100 [00:08<00:05,  7.36it/s] 63%|██████▎   | 63/100 [00:08<00:05,  7.38it/s] 64%|██████▍   | 64/100 [00:08<00:04,  7.42it/s] 65%|██████▌   | 65/100 [00:08<00:04,  7.29it/s] 66%|██████▌   | 66/100 [00:08<00:04,  7.29it/s] 67%|██████▋   | 67/100 [00:08<00:04,  7.18it/s] 68%|██████▊   | 68/100 [00:08<00:04,  7.17it/s] 69%|██████▉   | 69/100 [00:09<00:04,  7.24it/s] 70%|███████   | 70/100 [00:09<00:04,  7.12it/s] 71%|███████   | 71/100 [00:09<00:04,  7.19it/s] 72%|███████▏  | 72/100 [00:09<00:03,  7.17it/s] 73%|███████▎  | 73/100 [00:09<00:03,  7.11it/s] 74%|███████▍  | 74/100 [00:09<00:03,  7.06it/s] 75%|███████▌  | 75/100 [00:09<00:03,  6.97it/s] 76%|███████▌  | 76/100 [00:10<00:03,  6.93it/s] 77%|███████▋  | 77/100 [00:10<00:03,  6.85it/s] 78%|███████▊  | 78/100 [00:10<00:03,  6.90it/s] 79%|███████▉  | 79/100 [00:10<00:03,  6.81it/s] 80%|████████  | 80/100 [00:10<00:02,  6.80it/s] 81%|████████  | 81/100 [00:10<00:02,  6.84it/s] 82%|████████▏ | 82/100 [00:10<00:02,  6.92it/s] 83%|████████▎ | 83/100 [00:11<00:02,  6.86it/s] 84%|████████▍ | 84/100 [00:11<00:02,  6.85it/s] 85%|████████▌ | 85/100 [00:11<00:02,  6.78it/s] 86%|████████▌ | 86/100 [00:11<00:02,  6.75it/s] 87%|████████▋ | 87/100 [00:11<00:01,  6.67it/s] 88%|████████▊ | 88/100 [00:11<00:01,  6.88it/s] 89%|████████▉ | 89/100 [00:11<00:01,  6.89it/s] 90%|█████████ | 90/100 [00:12<00:01,  6.83it/s] 91%|█████████ | 91/100 [00:12<00:01,  6.73it/s] 92%|█████████▏| 92/100 [00:12<00:01,  6.80it/s] 93%|█████████▎| 93/100 [00:12<00:01,  6.84it/s] 94%|█████████▍| 94/100 [00:12<00:00,  6.78it/s] 95%|█████████▌| 95/100 [00:12<00:00,  6.76it/s] 96%|█████████▌| 96/100 [00:12<00:00,  6.80it/s] 97%|█████████▋| 97/100 [00:13<00:00,  6.87it/s] 98%|█████████▊| 98/100 [00:13<00:00,  6.81it/s] 99%|█████████▉| 99/100 [00:13<00:00,  6.86it/s]100%|██████████| 100/100 [00:13<00:00,  6.64it/s]100%|██████████| 100/100 [00:13<00:00,  7.36it/s]
[I 2025-08-30 13:36:08,561] A new study created in memory with name: no-name-b885b669-4a1c-48a1-b7f7-042d2143799d
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 18.01 MB
Memory Reserved: 42.00 MB
cuda
CUDA OOM 발생 — 단계적 백오프 시작.
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 16903.99 MB
Memory Reserved: 16924.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 312.97 MB
Memory Reserved: 352.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 16903.99 MB
Memory Reserved: 16924.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 312.55 MB
Memory Reserved: 352.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[I 2025-08-30 13:36:09,921] Trial 0 pruned. Pruned due to OOM after backoff
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 16903.99 MB
Memory Reserved: 16944.00 MB
cuda
Epoch 1, Train Loss 1.079681, Valid_loss 1.248853
Epoch 2, Train Loss 0.969922, Valid_loss 1.289233
Epoch 3, Train Loss 0.954464, Valid_loss 1.290664
Epoch 4, Train Loss 0.850155, Valid_loss 0.984935
Epoch 5, Train Loss 0.823680, Valid_loss 1.121233
Epoch 6, Train Loss 0.724661, Valid_loss 1.019200
Epoch 7, Train Loss 0.726061, Valid_loss 1.003818
Epoch 8, Train Loss 0.617287, Valid_loss 0.963471
Epoch 9, Train Loss 0.636351, Valid_loss 1.041209
Epoch 10, Train Loss 0.629044, Valid_loss 0.896840
Epoch 11, Train Loss 0.625323, Valid_loss 0.942044
Epoch 12, Train Loss 0.520257, Valid_loss 0.908821
Epoch 13, Train Loss 0.587928, Valid_loss 0.924552
Epoch 14, Train Loss 0.580034, Valid_loss 0.998492
Epoch 15, Train Loss 0.540607, Valid_loss 0.910393
Epoch 16, Train Loss 0.567877, Valid_loss 0.876390
Epoch 17, Train Loss 0.520781, Valid_loss 0.891813
Epoch 18, Train Loss 0.549734, Valid_loss 0.864349
Epoch 19, Train Loss 0.496682, Valid_loss 0.920266
Epoch 20, Train Loss 0.479897, Valid_loss 0.949290
Epoch 21, Train Loss 0.555168, Valid_loss 0.890108
Epoch 22, Train Loss 0.449397, Valid_loss 0.971830
Epoch 23, Train Loss 0.462781, Valid_loss 0.980079
Epoch 24, Train Loss 0.421256, Valid_loss 0.912224
Epoch 25, Train Loss 0.435913, Valid_loss 0.956554
Epoch 26, Train Loss 0.469808, Valid_loss 0.919683
Epoch 27, Train Loss 0.455896, Valid_loss 0.977836
Epoch 28, Train Loss 0.374641, Valid_loss 0.930837
Epoch 29, Train Loss 0.456900, Valid_loss 1.116894
Epoch 30, Train Loss 0.421661, Valid_loss 0.971669
Epoch 31, Train Loss 0.493114, Valid_loss 0.936768
Epoch 32, Train Loss 0.519083, Valid_loss 1.048406
Epoch 33, Train Loss 0.394740, Valid_loss 1.058344
Epoch 34, Train Loss 0.406407, Valid_loss 1.076377
Epoch 35, Train Loss 0.492969, Valid_loss 0.913876
Epoch 36, Train Loss 0.403737, Valid_loss 0.897776
Epoch 37, Train Loss 0.472473, Valid_loss 1.040349
Epoch 38, Train Loss 0.425742, Valid_loss 1.033998
Epoch 39, Train Loss 0.426628, Valid_loss 0.964175
Epoch 40, Train Loss 0.415502, Valid_loss 1.031413
Epoch 41, Train Loss 0.399031, Valid_loss 0.975809
Epoch 42, Train Loss 0.431878, Valid_loss 1.002677
Epoch 43, Train Loss 0.460394, Valid_loss 0.998772
Epoch 44, Train Loss 0.458074, Valid_loss 0.931161
Epoch 45, Train Loss 0.401174, Valid_loss 0.935715
Epoch 46, Train Loss 0.406739, Valid_loss 0.892058
Epoch 47, Train Loss 0.365103, Valid_loss 0.955831
Epoch 48, Train Loss 0.409378, Valid_loss 0.895465
Epoch 49, Train Loss 0.416188, Valid_loss 0.910891
Epoch 50, Train Loss 0.442900, Valid_loss 0.911822
Epoch 51, Train Loss 0.397960, Valid_loss 0.922027
Epoch 52, Train Loss 0.356066, Valid_loss 0.985109
[I 2025-08-30 14:06:03,100] Trial 1 finished with value: 0.864349290728569 and parameters: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 2, 'dropout': 0.7, 'weight_decay': 0.01, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 1 with value: 0.864349290728569.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 16.69 MB
Memory Reserved: 42.00 MB
cuda
CUDA OOM 발생 — 단계적 백오프 시작.
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 16883.20 MB
Memory Reserved: 16902.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 291.20 MB
Memory Reserved: 312.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 16883.69 MB
Memory Reserved: 16904.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 291.20 MB
Memory Reserved: 312.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[I 2025-08-30 14:06:04,749] Trial 2 pruned. Pruned due to OOM after backoff
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 16883.69 MB
Memory Reserved: 16904.00 MB
cuda
CUDA OOM 발생 — 단계적 백오프 시작.
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 16883.20 MB
Memory Reserved: 16904.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 291.20 MB
Memory Reserved: 312.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 16883.69 MB
Memory Reserved: 16904.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 291.20 MB
Memory Reserved: 312.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[I 2025-08-30 14:06:06,096] Trial 3 pruned. Pruned due to OOM after backoff
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 16885.01 MB
Memory Reserved: 16906.00 MB
cuda
Epoch 1, Train Loss 0.914246, Valid_loss 1.601256
Epoch 2, Train Loss 0.788711, Valid_loss 1.346832
Epoch 3, Train Loss 0.699164, Valid_loss 1.202056
Epoch 4, Train Loss 0.555931, Valid_loss 1.109197
Epoch 5, Train Loss 0.516657, Valid_loss 1.098317
Epoch 6, Train Loss 0.544257, Valid_loss 1.119315
Epoch 7, Train Loss 0.459983, Valid_loss 1.029526
Epoch 8, Train Loss 0.487817, Valid_loss 0.920929
Epoch 9, Train Loss 0.457518, Valid_loss 1.226642
Epoch 10, Train Loss 0.496390, Valid_loss 1.030017
Epoch 11, Train Loss 0.451476, Valid_loss 0.890869
Epoch 12, Train Loss 0.474299, Valid_loss 0.900430
Epoch 13, Train Loss 0.468842, Valid_loss 1.070591
Epoch 14, Train Loss 0.422776, Valid_loss 0.937914
Epoch 15, Train Loss 0.512331, Valid_loss 0.960700
Epoch 16, Train Loss 0.420995, Valid_loss 0.837391
Epoch 17, Train Loss 0.397527, Valid_loss 1.182090
Epoch 18, Train Loss 0.402383, Valid_loss 0.844282
Epoch 19, Train Loss 0.426081, Valid_loss 0.902751
Epoch 20, Train Loss 0.352463, Valid_loss 0.900532
Epoch 21, Train Loss 0.353936, Valid_loss 1.479090
Epoch 22, Train Loss 0.397321, Valid_loss 0.792428
Epoch 23, Train Loss 0.397699, Valid_loss 1.021517
Epoch 24, Train Loss 0.323100, Valid_loss 0.791487
Epoch 25, Train Loss 0.346629, Valid_loss 0.753787
Epoch 26, Train Loss 0.359511, Valid_loss 0.838227
Epoch 27, Train Loss 0.348703, Valid_loss 0.880553
Epoch 28, Train Loss 0.358052, Valid_loss 0.727534
Epoch 29, Train Loss 0.372355, Valid_loss 1.230491
Epoch 30, Train Loss 0.320744, Valid_loss 0.742365
Epoch 31, Train Loss 0.291416, Valid_loss 0.830584
Epoch 32, Train Loss 0.276638, Valid_loss 0.910716
Epoch 33, Train Loss 0.305739, Valid_loss 0.771913
Epoch 34, Train Loss 0.348537, Valid_loss 0.774415
Epoch 35, Train Loss 0.258018, Valid_loss 0.719083
Epoch 36, Train Loss 0.351576, Valid_loss 0.717494
Epoch 37, Train Loss 0.292024, Valid_loss 3.568049
Epoch 38, Train Loss 0.420396, Valid_loss 0.626567
Epoch 39, Train Loss 0.332115, Valid_loss 0.651342
Epoch 40, Train Loss 0.287504, Valid_loss 0.989820
Epoch 41, Train Loss 0.323882, Valid_loss 0.790850
Epoch 42, Train Loss 0.283225, Valid_loss 1.089406
Epoch 43, Train Loss 0.250418, Valid_loss 0.972931
Epoch 44, Train Loss 0.247124, Valid_loss 0.944555
Epoch 45, Train Loss 0.241692, Valid_loss 0.817061
Epoch 46, Train Loss 0.313964, Valid_loss 1.245804
Epoch 47, Train Loss 0.275201, Valid_loss 0.732653
Epoch 48, Train Loss 0.247726, Valid_loss 0.895518
Epoch 49, Train Loss 0.226703, Valid_loss 0.962873
Epoch 50, Train Loss 0.220824, Valid_loss 0.801828
Epoch 51, Train Loss 0.202441, Valid_loss 0.854678
Epoch 52, Train Loss 0.194014, Valid_loss 0.968184
[I 2025-08-30 14:25:48,640] Trial 4 finished with value: 0.6265668522876998 and parameters: {'learning_rate': 0.001, 'epochs': 100, 'heads': 1, 'dropout': 0.0, 'weight_decay': 0.01, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 4 with value: 0.6265668522876998.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 19.85 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.971231, Valid_loss 1.606147
Epoch 2, Train Loss 0.910957, Valid_loss 1.460549
Epoch 3, Train Loss 0.781493, Valid_loss 1.608422
Epoch 4, Train Loss 0.667581, Valid_loss 1.545533
Epoch 5, Train Loss 0.683269, Valid_loss 1.142117
Epoch 6, Train Loss 0.572990, Valid_loss 0.890812
Epoch 7, Train Loss 0.584738, Valid_loss 0.874616
Epoch 8, Train Loss 0.517396, Valid_loss 0.853283
Epoch 9, Train Loss 0.633656, Valid_loss 0.785200
Epoch 10, Train Loss 0.570778, Valid_loss 1.027701
Epoch 11, Train Loss 0.567153, Valid_loss 0.768313
Epoch 12, Train Loss 0.548456, Valid_loss 0.798380
Epoch 13, Train Loss 0.481167, Valid_loss 0.955399
Epoch 14, Train Loss 0.495748, Valid_loss 1.096133
Epoch 15, Train Loss 0.501740, Valid_loss 0.779369
Epoch 16, Train Loss 0.449292, Valid_loss 0.795026
Epoch 17, Train Loss 0.435365, Valid_loss 0.988927
Epoch 18, Train Loss 0.433627, Valid_loss 0.772004
Epoch 19, Train Loss 0.460356, Valid_loss 0.911629
Epoch 20, Train Loss 0.483834, Valid_loss 1.052368
Epoch 21, Train Loss 0.489042, Valid_loss 1.191024
Epoch 22, Train Loss 0.437359, Valid_loss 1.331620
Epoch 23, Train Loss 0.401334, Valid_loss 0.742780
Epoch 24, Train Loss 0.399763, Valid_loss 0.826190
Epoch 25, Train Loss 0.462938, Valid_loss 1.688093
Epoch 26, Train Loss 0.425634, Valid_loss 1.080080
Epoch 27, Train Loss 0.402645, Valid_loss 0.857545
Epoch 28, Train Loss 0.463290, Valid_loss 0.767302
Epoch 29, Train Loss 0.438924, Valid_loss 1.235757
Epoch 30, Train Loss 0.443783, Valid_loss 0.923224
Epoch 31, Train Loss 0.416455, Valid_loss 0.858655
Epoch 32, Train Loss 0.444746, Valid_loss 1.106686
Epoch 33, Train Loss 0.391593, Valid_loss 1.250282
Epoch 34, Train Loss 0.425192, Valid_loss 1.022749
Epoch 35, Train Loss 0.391554, Valid_loss 0.734554
Epoch 36, Train Loss 0.431668, Valid_loss 0.791185
Epoch 37, Train Loss 0.472040, Valid_loss 0.981893
Epoch 38, Train Loss 0.457970, Valid_loss 0.803423
Epoch 39, Train Loss 0.370583, Valid_loss 0.775456
Epoch 40, Train Loss 0.335792, Valid_loss 0.968993
Epoch 41, Train Loss 0.387188, Valid_loss 0.615835
Epoch 42, Train Loss 0.387071, Valid_loss 0.618204
Epoch 43, Train Loss 0.418517, Valid_loss 0.838398
Epoch 44, Train Loss 0.379730, Valid_loss 1.164313
Epoch 45, Train Loss 0.453945, Valid_loss 0.708991
Epoch 46, Train Loss 0.365724, Valid_loss 1.097267
Epoch 47, Train Loss 0.362585, Valid_loss 0.962690
Epoch 48, Train Loss 0.333633, Valid_loss 0.639159
Epoch 49, Train Loss 0.364911, Valid_loss 1.247045
Epoch 50, Train Loss 0.376009, Valid_loss 0.825657
Epoch 51, Train Loss 0.305717, Valid_loss 1.189232
Epoch 52, Train Loss 0.271279, Valid_loss 1.278581
[I 2025-08-30 14:46:46,458] Trial 5 finished with value: 0.6158345354100069 and parameters: {'learning_rate': 0.001, 'epochs': 100, 'heads': 1, 'dropout': 0.5, 'weight_decay': 0.01, 'emb_dim': 64, 'augment_num': 100, 'pca': False}. Best is trial 5 with value: 0.6158345354100069.
선택된 trial params: {'learning_rate': 0.001, 'epochs': 100, 'heads': 1, 'dropout': 0.5, 'weight_decay': 0.01, 'emb_dim': 64, 'augment_num': 100, 'pca': False}
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=8, batch_size=1 -> steps=8
Memory Allocated: 19.85 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.991877, Valid_loss 1.560799
Epoch 2, Train Loss 0.882256, Valid_loss 1.511458
Epoch 3, Train Loss 0.932119, Valid_loss 1.566775
Epoch 4, Train Loss 0.897823, Valid_loss 1.597940
Epoch 5, Train Loss 0.857819, Valid_loss 1.467941
Epoch 6, Train Loss 0.868159, Valid_loss 1.160633
Epoch 7, Train Loss 0.847557, Valid_loss 1.414229
Epoch 8, Train Loss 0.857232, Valid_loss 1.617319
Epoch 9, Train Loss 0.761298, Valid_loss 1.073710
Epoch 10, Train Loss 0.644008, Valid_loss 1.099862
Epoch 11, Train Loss 0.723505, Valid_loss 1.035571
Epoch 12, Train Loss 0.752147, Valid_loss 1.185280
Epoch 13, Train Loss 0.677651, Valid_loss 1.823102
Epoch 14, Train Loss 0.795991, Valid_loss 1.394480
Epoch 15, Train Loss 0.586906, Valid_loss 1.089892
Epoch 16, Train Loss 0.626522, Valid_loss 1.155535
Epoch 17, Train Loss 0.583776, Valid_loss 0.933351
Epoch 18, Train Loss 0.504654, Valid_loss 1.206657
Epoch 19, Train Loss 0.468653, Valid_loss 0.873116
Epoch 20, Train Loss 0.518943, Valid_loss 0.929205
Epoch 21, Train Loss 0.553326, Valid_loss 0.946452
Epoch 22, Train Loss 0.513423, Valid_loss 0.965361
Epoch 23, Train Loss 0.452484, Valid_loss 0.899250
Epoch 24, Train Loss 0.436633, Valid_loss 1.006071
Epoch 25, Train Loss 0.474466, Valid_loss 1.671598
Epoch 26, Train Loss 0.478950, Valid_loss 1.233977
Epoch 27, Train Loss 0.657714, Valid_loss 0.862542
Epoch 28, Train Loss 0.482862, Valid_loss 0.873299
Epoch 29, Train Loss 0.450261, Valid_loss 1.023378
Epoch 30, Train Loss 0.433617, Valid_loss 0.834589
Epoch 31, Train Loss 0.478155, Valid_loss 0.945501
Epoch 32, Train Loss 0.403660, Valid_loss 1.333711
Epoch 33, Train Loss 0.401663, Valid_loss 1.535240
Epoch 34, Train Loss 0.428847, Valid_loss 1.420072
Epoch 35, Train Loss 0.420065, Valid_loss 1.639828
Epoch 36, Train Loss 0.386126, Valid_loss 1.514626
Epoch 37, Train Loss 0.401572, Valid_loss 1.547755
Epoch 38, Train Loss 0.394998, Valid_loss 1.424305
Epoch 39, Train Loss 0.330377, Valid_loss 1.176556
Epoch 40, Train Loss 0.487368, Valid_loss 1.140991
Epoch 41, Train Loss 0.377218, Valid_loss 1.384262
Epoch 42, Train Loss 0.330415, Valid_loss 1.109633
Epoch 43, Train Loss 0.403802, Valid_loss 1.214197
Epoch 44, Train Loss 0.339488, Valid_loss 1.162956
Epoch 45, Train Loss 0.329020, Valid_loss 1.802101
Epoch 46, Train Loss 0.341289, Valid_loss 1.611550
Epoch 47, Train Loss 0.337169, Valid_loss 1.355753
Epoch 48, Train Loss 0.411273, Valid_loss 1.534922
Epoch 49, Train Loss 0.432331, Valid_loss 1.132545
Epoch 50, Train Loss 0.344450, Valid_loss 1.507974
Epoch 51, Train Loss 0.320401, Valid_loss 1.203184
Epoch 52, Train Loss 0.318707, Valid_loss 1.519950
Epoch 53, Train Loss 0.344263, Valid_loss 1.566348
환자ID=P1425 -- true: [[1]] -- pred: tensor([[-1.0850,  1.0645, -0.4434]], device='cuda:0')
환자ID=P1437 -- true: [[2]] -- pred: tensor([[-1.0863,  1.0682, -0.4611]], device='cuda:0')
환자ID=P1472 -- true: [[2]] -- pred: tensor([[-0.9199,  0.9685, -0.6993]], device='cuda:0')
환자ID=P1515 -- true: [[0]] -- pred: tensor([[ 2.5212, -1.0896, -3.2578]], device='cuda:0')
환자ID=P1561 -- true: [[0]] -- pred: tensor([[ 2.5239, -1.0911, -3.2579]], device='cuda:0')
환자ID=P1600 -- true: [[0]] -- pred: tensor([[ 2.5129, -1.0800, -3.2716]], device='cuda:0')
환자ID=P1685 -- true: [[1]] -- pred: tensor([[-1.0640,  1.0457, -0.5154]], device='cuda:0')
환자ID=P1726 -- true: [[1]] -- pred: tensor([[-1.0511,  1.0280, -0.5438]], device='cuda:0')
Best performance: Epoch 30, Loss 0.433617, Test ACC 0.750000, Test AUC 0.833333, Test Recall 0.666667, Test Precision 0.533333
Confusion Matrix:
 [[3 0 0]
 [0 3 0]
 [0 2 0]]
✅ Total valid splits used: 3
🔁 Repeat 4, Fold 3
cell type :  ACAGCCGCAAGCGAGT-1-1                 Neurons
ATATCCTGTCCCTAAA-1-1       Endothelial_cells
CAATGACCAGTTGTCA-1-1                 Neurons
CTAGACACAAGGTTGG-1-1                 Neurons
ATCGTCCGTATTTCTC-1-1     Smooth_muscle_cells
                                ...         
TTATTGCGTCGGTGTC-1-79      Endothelial_cells
GTCACGGGTTGTATGC-1-79      Endothelial_cells
GTCATGATCTTTCGAT-1-79      Endothelial_cells
GCGATCGTCAGAGTGG-1-79              Platelets
GCCCGAACAGAGAAAG-1-79      Endothelial_cells
Name: singler_annotation, Length: 487279, dtype: string
cell type annotation :  ACAGCCGCAAGCGAGT-1-1                 Neurons
ATATCCTGTCCCTAAA-1-1       Endothelial_cells
CAATGACCAGTTGTCA-1-1                 Neurons
CTAGACACAAGGTTGG-1-1                 Neurons
ATCGTCCGTATTTCTC-1-1     Smooth_muscle_cells
                                ...         
TTATTGCGTCGGTGTC-1-79      Endothelial_cells
GTCACGGGTTGTATGC-1-79      Endothelial_cells
GTCATGATCTTTCGAT-1-79      Endothelial_cells
GCGATCGTCAGAGTGG-1-79              Platelets
GCCCGAACAGAGAAAG-1-79      Endothelial_cells
Name: singler_annotation, Length: 487279, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Neurons', 'Endothelial_cells', 'Smooth_muscle_cells', 'Neuroepithelial_cell', 'Astrocyte', 'Fibroblasts', 'Osteoblasts', 'Erythroblast', 'iPS_cells', 'Embryonic_stem_cells', 'Platelets', 'MSC', 'Hepatocytes', 'NK_cell', 'MEP', 'BM & Prog.', 'Gametocytes', 'Chondrocytes', 'HSC_CD34+', 'Tissue_stem_cells', 'Macrophage', 'Monocyte', 'Neutrophils', 'DC', 'HSC_-G-CSF', 'Unknown', 'Keratinocytes', 'B_cell', 'T_cells', 'Myelocyte', 'Epithelial_cells', 'GMP', 'BM', 'Pro-Myelocyte', 'Pro-B_cell_CD34+', 'CMP', 'Pre-B_cell_CD34-']
라벨별 그룹 개수 {2: 9, 1: 12, 0: 13}
cell type :  TTCTTCCGTTCAACGT-1-0                Astrocyte
CATCCACCATCTAACG-1-0      Smooth_muscle_cells
ACCCAAACAGCTAACT-1-0                  Neurons
AAGGAATCAACTGGTT-1-0     Neuroepithelial_cell
TACCCGTAGCGTGCTC-1-0                Astrocyte
                                 ...         
AGAAGCGAGCGTCTGC-1-73       Endothelial_cells
TACTTCATCCCTTTGG-1-73                 NK_cell
ATATCCTGTTAGCGGA-1-73       Endothelial_cells
TACTTACCAAAGCACG-1-73       Endothelial_cells
GTCAGCGCAACACTAC-1-73     Smooth_muscle_cells
Name: singler_annotation, Length: 105410, dtype: string
cell type annotation :  TTCTTCCGTTCAACGT-1-0                Astrocyte
CATCCACCATCTAACG-1-0      Smooth_muscle_cells
ACCCAAACAGCTAACT-1-0                  Neurons
AAGGAATCAACTGGTT-1-0     Neuroepithelial_cell
TACCCGTAGCGTGCTC-1-0                Astrocyte
                                 ...         
AGAAGCGAGCGTCTGC-1-73       Endothelial_cells
TACTTCATCCCTTTGG-1-73                 NK_cell
ATATCCTGTTAGCGGA-1-73       Endothelial_cells
TACTTACCAAAGCACG-1-73       Endothelial_cells
GTCAGCGCAACACTAC-1-73     Smooth_muscle_cells
Name: singler_annotation, Length: 105410, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Astrocyte', 'Smooth_muscle_cells', 'Neurons', 'Neuroepithelial_cell', 'Endothelial_cells', 'Osteoblasts', 'Platelets', 'Hepatocytes', 'Embryonic_stem_cells', 'MEP', 'Erythroblast', 'Fibroblasts', 'iPS_cells', 'MSC', 'Macrophage', 'Gametocytes', 'Chondrocytes', 'NK_cell', 'Neutrophils', 'HSC_CD34+', 'Monocyte', 'Tissue_stem_cells', 'DC', 'HSC_-G-CSF', 'T_cells', 'Epithelial_cells', 'Unknown', 'Pre-B_cell_CD34-', 'GMP', 'B_cell', 'Pro-Myelocyte', 'Keratinocytes', 'Myelocyte', 'BM', 'CMP', 'BM & Prog.', 'Pro-B_cell_CD34+']
라벨별 그룹 개수 {2: 2, 1: 3, 0: 3}
🔍 Split #4
  → train_p_index 환자 수 (환자 단위로 묶인 index list): 34
  → test_p_index 환자 수  (환자 단위로 묶인 index list): 8
  → train 환자 ID: ['P1304', 'P1358', 'P1371', 'P1422', 'P1425', 'P1430', 'P1437', 'P1462', 'P1472', 'P1504', 'P1510', 'P1515', 'P1516', 'P1540', 'P1547', 'P1549', 'P1558', 'P1561', 'P1582', 'P1600', 'P1602', 'P1606', 'P1610', 'P1617', 'P1630', 'P1631', 'P1678', 'P1685', 'P1702', 'P1707', 'P1718', 'P1722', 'P1726', 'P1735']
  → test  환자 ID: ['P1290', 'P1300', 'P1447', 'P1479', 'P1508', 'P1539', 'P1603', 'P1622']
  → train 환자 ID 및 라벨:
    ID: P1304, Label: 2
    ID: P1358, Label: 2
    ID: P1371, Label: 2
    ID: P1422, Label: 1
    ID: P1425, Label: 1
    ID: P1430, Label: 2
    ID: P1437, Label: 2
    ID: P1462, Label: 1
    ID: P1472, Label: 2
    ID: P1504, Label: 2
    ID: P1510, Label: 1
    ID: P1515, Label: 0
    ID: P1516, Label: 0
    ID: P1540, Label: 0
    ID: P1547, Label: 0
    ID: P1549, Label: 0
    ID: P1558, Label: 0
    ID: P1561, Label: 0
    ID: P1582, Label: 0
    ID: P1600, Label: 0
    ID: P1602, Label: 1
    ID: P1606, Label: 2
    ID: P1610, Label: 0
    ID: P1617, Label: 2
    ID: P1630, Label: 1
    ID: P1631, Label: 1
    ID: P1678, Label: 0
    ID: P1685, Label: 1
    ID: P1702, Label: 0
    ID: P1707, Label: 1
    ID: P1718, Label: 0
    ID: P1722, Label: 1
    ID: P1726, Label: 1
    ID: P1735, Label: 1
  → test 환자 ID 및 라벨:
    ID: P1290, Label: 2
    ID: P1300, Label: 2
    ID: P1447, Label: 1
    ID: P1479, Label: 1
    ID: P1508, Label: 1
    ID: P1539, Label: 0
    ID: P1603, Label: 0
    ID: P1622, Label: 0
전체 데이터 index 길이 42
label_stat (train 환자 라벨 목록) 갯수 34
train_data에서 환자 단위로, train과 validation 나누기
기존 train_p_index 34
기존 (train) label_stat 34
train-vali 분할 후! 
train y 의 classes : {0, 1, 2} valid y 의 classes : {0, 1, 2} label_stat 의 classes : {0, 1, 2}
train_p_index_ 22
valid_p_index 12
test_p_index 8
→ train 환자 ID 및 라벨:
   총 개수: 22
   환자ID=P1722, Label=1, 셀개수=21432
   환자ID=P1547, Label=0, 셀개수=8253
   환자ID=P1371, Label=2, 셀개수=16233
   환자ID=P1472, Label=2, 셀개수=19513
   환자ID=P1617, Label=2, 셀개수=17986
   환자ID=P1685, Label=1, 셀개수=10043
   환자ID=P1425, Label=1, 셀개수=15378
   환자ID=P1735, Label=1, 셀개수=12009
   환자ID=P1718, Label=0, 셀개수=9278
   환자ID=P1558, Label=0, 셀개수=10469
   환자ID=P1702, Label=0, 셀개수=13550
   환자ID=P1516, Label=0, 셀개수=9361
   환자ID=P1430, Label=2, 셀개수=11131
   환자ID=P1678, Label=0, 셀개수=10085
   환자ID=P1631, Label=1, 셀개수=13686
   환자ID=P1540, Label=0, 셀개수=11638
   환자ID=P1610, Label=0, 셀개수=13919
   환자ID=P1515, Label=0, 셀개수=14502
   환자ID=P1510, Label=1, 셀개수=10744
   환자ID=P1462, Label=1, 셀개수=21715
   환자ID=P1602, Label=1, 셀개수=16580
   환자ID=P1549, Label=0, 셀개수=11709
→ valid 환자 ID 및 라벨:
   총 개수: 12
   환자ID=P1358, Label=2, 셀개수=23984
   환자ID=P1437, Label=2, 셀개수=21695
   환자ID=P1561, Label=0, 셀개수=10016
   환자ID=P1504, Label=2, 셀개수=8133
   환자ID=P1304, Label=2, 셀개수=19123
   환자ID=P1600, Label=0, 셀개수=14882
   환자ID=P1726, Label=1, 셀개수=12389
   환자ID=P1582, Label=0, 셀개수=18855
   환자ID=P1707, Label=1, 셀개수=9517
   환자ID=P1422, Label=1, 셀개수=23315
   환자ID=P1630, Label=1, 셀개수=17633
   환자ID=P1606, Label=2, 셀개수=8523
→ test 환자 ID 및 라벨:
   총 개수: 8
   환자ID=P1290, Label=2, 셀개수=8357
   환자ID=P1300, Label=2, 셀개수=17318
   환자ID=P1447, Label=1, 셀개수=11151
   환자ID=P1479, Label=1, 셀개수=19124
   환자ID=P1508, Label=1, 셀개수=20536
   환자ID=P1539, Label=0, 셀개수=11076
   환자ID=P1603, Label=0, 셀개수=10638
   환자ID=P1622, Label=0, 셀개수=7210
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Neurons', 'Endothelial_cells', 'Neurons', 'Neurons', 'Smooth_muscle_cells', 'Smooth_muscle_cells', 'Neurons', 'Endothelial_cells', 'Neurons', 'Neurons']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
전체 데이터 길이 592689
전체 cell type 길이 0                     Neurons
1           Endothelial_cells
2                     Neurons
3                     Neurons
4         Smooth_muscle_cells
                 ...         
592684      Endothelial_cells
592685                NK_cell
592686      Endothelial_cells
592687      Endothelial_cells
592688    Smooth_muscle_cells
Length: 592689, dtype: string
cell type의 NaN 개수 체크 0
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:17,  5.78it/s]  2%|▏         | 2/100 [00:00<00:13,  7.04it/s]  3%|▎         | 3/100 [00:00<00:12,  7.57it/s]  4%|▍         | 4/100 [00:00<00:13,  7.24it/s]  5%|▌         | 5/100 [00:01<00:40,  2.37it/s]  6%|▌         | 6/100 [00:01<00:30,  3.11it/s]  7%|▋         | 7/100 [00:01<00:23,  3.89it/s]  8%|▊         | 8/100 [00:01<00:19,  4.68it/s]  9%|▉         | 9/100 [00:01<00:17,  5.29it/s] 10%|█         | 10/100 [00:02<00:15,  5.74it/s] 11%|█         | 11/100 [00:02<00:14,  6.22it/s] 12%|█▏        | 12/100 [00:02<00:12,  6.79it/s] 13%|█▎        | 13/100 [00:02<00:12,  7.24it/s] 14%|█▍        | 14/100 [00:02<00:11,  7.37it/s] 15%|█▌        | 15/100 [00:02<00:11,  7.58it/s] 16%|█▌        | 16/100 [00:02<00:10,  7.70it/s] 17%|█▋        | 17/100 [00:03<00:10,  7.63it/s] 18%|█▊        | 18/100 [00:03<00:10,  7.69it/s] 19%|█▉        | 19/100 [00:03<00:10,  7.89it/s] 20%|██        | 20/100 [00:03<00:10,  7.88it/s] 21%|██        | 21/100 [00:03<00:10,  7.83it/s] 22%|██▏       | 22/100 [00:03<00:09,  7.97it/s] 23%|██▎       | 23/100 [00:03<00:09,  8.10it/s] 24%|██▍       | 24/100 [00:03<00:09,  7.99it/s] 25%|██▌       | 25/100 [00:04<00:28,  2.59it/s] 26%|██▌       | 26/100 [00:04<00:22,  3.25it/s] 27%|██▋       | 27/100 [00:05<00:18,  3.92it/s] 28%|██▊       | 28/100 [00:05<00:15,  4.64it/s] 29%|██▉       | 29/100 [00:05<00:14,  5.01it/s] 30%|███       | 30/100 [00:05<00:12,  5.60it/s] 31%|███       | 31/100 [00:05<00:11,  6.11it/s] 32%|███▏      | 32/100 [00:05<00:10,  6.57it/s] 33%|███▎      | 33/100 [00:05<00:09,  6.80it/s] 34%|███▍      | 34/100 [00:06<00:18,  3.50it/s] 35%|███▌      | 35/100 [00:07<00:25,  2.56it/s] 36%|███▌      | 36/100 [00:07<00:19,  3.22it/s] 37%|███▋      | 37/100 [00:07<00:24,  2.54it/s] 38%|███▊      | 38/100 [00:08<00:19,  3.15it/s] 39%|███▉      | 39/100 [00:08<00:25,  2.43it/s] 40%|████      | 40/100 [00:08<00:19,  3.06it/s] 41%|████      | 41/100 [00:09<00:30,  1.96it/s] 42%|████▏     | 42/100 [00:09<00:23,  2.51it/s] 43%|████▎     | 43/100 [00:10<00:18,  3.13it/s] 44%|████▍     | 44/100 [00:10<00:16,  3.31it/s] 45%|████▌     | 45/100 [00:10<00:13,  3.98it/s] 46%|████▌     | 46/100 [00:10<00:11,  4.64it/s] 47%|████▋     | 47/100 [00:10<00:10,  5.16it/s] 48%|████▊     | 48/100 [00:10<00:09,  5.68it/s] 49%|████▉     | 49/100 [00:10<00:08,  6.18it/s] 50%|█████     | 50/100 [00:11<00:07,  6.56it/s] 51%|█████     | 51/100 [00:11<00:07,  6.84it/s] 52%|█████▏    | 52/100 [00:11<00:06,  7.11it/s] 53%|█████▎    | 53/100 [00:11<00:06,  7.22it/s] 54%|█████▍    | 54/100 [00:11<00:06,  7.19it/s] 55%|█████▌    | 55/100 [00:11<00:06,  7.28it/s] 56%|█████▌    | 56/100 [00:11<00:06,  7.28it/s] 57%|█████▋    | 57/100 [00:12<00:05,  7.36it/s] 58%|█████▊    | 58/100 [00:12<00:05,  7.44it/s] 59%|█████▉    | 59/100 [00:12<00:06,  6.10it/s] 60%|██████    | 60/100 [00:12<00:06,  6.47it/s] 61%|██████    | 61/100 [00:12<00:05,  6.75it/s] 62%|██████▏   | 62/100 [00:12<00:05,  6.94it/s] 63%|██████▎   | 63/100 [00:13<00:07,  4.78it/s] 64%|██████▍   | 64/100 [00:13<00:07,  5.04it/s] 65%|██████▌   | 65/100 [00:13<00:09,  3.65it/s] 66%|██████▌   | 66/100 [00:13<00:08,  4.21it/s] 67%|██████▋   | 67/100 [00:14<00:06,  4.78it/s] 68%|██████▊   | 68/100 [00:14<00:06,  5.28it/s] 69%|██████▉   | 69/100 [00:14<00:05,  5.72it/s] 70%|███████   | 70/100 [00:14<00:04,  6.11it/s] 71%|███████   | 71/100 [00:14<00:06,  4.40it/s] 72%|███████▏  | 72/100 [00:14<00:05,  5.04it/s] 73%|███████▎  | 73/100 [00:15<00:04,  5.58it/s] 74%|███████▍  | 74/100 [00:16<00:12,  2.09it/s] 75%|███████▌  | 75/100 [00:16<00:09,  2.67it/s] 76%|███████▌  | 76/100 [00:16<00:07,  3.12it/s] 77%|███████▋  | 77/100 [00:16<00:06,  3.78it/s] 78%|███████▊  | 78/100 [00:16<00:05,  4.37it/s] 79%|███████▉  | 79/100 [00:17<00:04,  5.02it/s] 80%|████████  | 80/100 [00:17<00:03,  5.50it/s] 81%|████████  | 81/100 [00:17<00:03,  5.96it/s] 82%|████████▏ | 82/100 [00:17<00:02,  6.20it/s] 83%|████████▎ | 83/100 [00:17<00:02,  6.51it/s] 84%|████████▍ | 84/100 [00:17<00:02,  6.73it/s] 85%|████████▌ | 85/100 [00:18<00:06,  2.46it/s] 86%|████████▌ | 86/100 [00:18<00:04,  3.04it/s] 87%|████████▋ | 87/100 [00:19<00:03,  3.68it/s] 88%|████████▊ | 88/100 [00:19<00:02,  4.30it/s] 89%|████████▉ | 89/100 [00:19<00:02,  4.87it/s] 90%|█████████ | 90/100 [00:19<00:01,  5.40it/s] 91%|█████████ | 91/100 [00:19<00:01,  5.82it/s] 92%|█████████▏| 92/100 [00:19<00:01,  6.15it/s] 93%|█████████▎| 93/100 [00:20<00:02,  2.54it/s] 94%|█████████▍| 94/100 [00:20<00:01,  3.07it/s] 95%|█████████▌| 95/100 [00:20<00:01,  3.57it/s] 96%|█████████▌| 96/100 [00:21<00:00,  4.18it/s] 97%|█████████▋| 97/100 [00:21<00:00,  4.70it/s] 98%|█████████▊| 98/100 [00:21<00:00,  5.23it/s] 99%|█████████▉| 99/100 [00:21<00:00,  5.63it/s]100%|██████████| 100/100 [00:21<00:00,  6.02it/s]100%|██████████| 100/100 [00:21<00:00,  4.61it/s]
[I 2025-08-30 15:09:03,103] A new study created in memory with name: no-name-66a27dd7-f090-4f5a-ba02-635418f02d66
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 16.69 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.952763, Valid_loss 1.507565
Epoch 2, Train Loss 0.885806, Valid_loss 1.522519
Epoch 3, Train Loss 0.876230, Valid_loss 1.598226
Epoch 4, Train Loss 0.855357, Valid_loss 1.518153
Epoch 5, Train Loss 0.872727, Valid_loss 1.438560
Epoch 6, Train Loss 0.852396, Valid_loss 1.642333
Epoch 7, Train Loss 0.839925, Valid_loss 1.643122
Epoch 8, Train Loss 0.847488, Valid_loss 1.678065
Epoch 9, Train Loss 0.873476, Valid_loss 1.609036
Epoch 10, Train Loss 0.857283, Valid_loss 1.594524
Epoch 11, Train Loss 0.847305, Valid_loss 1.655756
Epoch 12, Train Loss 0.842231, Valid_loss 1.654477
Epoch 13, Train Loss 0.842743, Valid_loss 1.699002
Epoch 14, Train Loss 0.850188, Valid_loss 1.604511
Epoch 15, Train Loss 0.846336, Valid_loss 1.681485
Epoch 16, Train Loss 0.848457, Valid_loss 1.656662
Epoch 17, Train Loss 0.852758, Valid_loss 1.625364
Epoch 18, Train Loss 0.851654, Valid_loss 1.616368
Epoch 19, Train Loss 0.850926, Valid_loss 1.603022
Epoch 20, Train Loss 0.846332, Valid_loss 1.617750
Epoch 21, Train Loss 0.849130, Valid_loss 1.586377
Epoch 22, Train Loss 0.842664, Valid_loss 1.644989
Epoch 23, Train Loss 0.842125, Valid_loss 1.668812
Epoch 24, Train Loss 0.850272, Valid_loss 1.605664
Epoch 25, Train Loss 0.850811, Valid_loss 1.594046
Epoch 26, Train Loss 0.848523, Valid_loss 1.593231
Epoch 27, Train Loss 0.847483, Valid_loss 1.622151
Epoch 28, Train Loss 0.846171, Valid_loss 1.592749
Epoch 29, Train Loss 0.844202, Valid_loss 1.603100
Epoch 30, Train Loss 0.842245, Valid_loss 1.597848
Epoch 31, Train Loss 0.844619, Valid_loss 1.601958
Epoch 32, Train Loss 0.846190, Valid_loss 1.615786
Epoch 33, Train Loss 0.845651, Valid_loss 1.609709
Epoch 34, Train Loss 0.843720, Valid_loss 1.625505
Epoch 35, Train Loss 0.844310, Valid_loss 1.618308
Epoch 36, Train Loss 0.843222, Valid_loss 1.616831
Epoch 37, Train Loss 0.844918, Valid_loss 1.619526
Epoch 38, Train Loss 0.843210, Valid_loss 1.624792
Epoch 39, Train Loss 0.842128, Valid_loss 1.613096
Epoch 40, Train Loss 0.844037, Valid_loss 1.612291
Epoch 41, Train Loss 0.844434, Valid_loss 1.614836
Epoch 42, Train Loss 0.842260, Valid_loss 1.620614
Epoch 43, Train Loss 0.845729, Valid_loss 1.622636
Epoch 44, Train Loss 0.842696, Valid_loss 1.615328
Epoch 45, Train Loss 0.844588, Valid_loss 1.629607
Epoch 46, Train Loss 0.844664, Valid_loss 1.609817
Epoch 47, Train Loss 0.844301, Valid_loss 1.617944
Epoch 48, Train Loss 0.842057, Valid_loss 1.634598
Epoch 49, Train Loss 0.844326, Valid_loss 1.615262
Epoch 50, Train Loss 0.843819, Valid_loss 1.618730
Epoch 51, Train Loss 0.841830, Valid_loss 1.615237
Epoch 52, Train Loss 0.842167, Valid_loss 1.617118
Epoch 53, Train Loss 0.841748, Valid_loss 1.622934
[I 2025-08-30 15:28:30,341] Trial 0 finished with value: 1.4385603318611782 and parameters: {'learning_rate': 0.01, 'epochs': 100, 'heads': 1, 'dropout': 0.5, 'weight_decay': 0.01, 'emb_dim': 8, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 1.4385603318611782.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 19.85 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.873129, Valid_loss 1.668403
Epoch 2, Train Loss 0.831538, Valid_loss 1.413852
Epoch 3, Train Loss 0.869742, Valid_loss 1.705711
Epoch 4, Train Loss 0.763589, Valid_loss 1.850044
Epoch 5, Train Loss 0.855596, Valid_loss 1.697898
Epoch 6, Train Loss 0.753645, Valid_loss 1.254335
Epoch 7, Train Loss 0.656552, Valid_loss 1.164292
Epoch 8, Train Loss 0.866273, Valid_loss 1.415643
Epoch 9, Train Loss 0.589980, Valid_loss 1.093198
Epoch 10, Train Loss 0.511044, Valid_loss 0.806446
Epoch 11, Train Loss 0.456955, Valid_loss 0.867374
Epoch 12, Train Loss 0.410417, Valid_loss 0.901700
Epoch 13, Train Loss 0.425750, Valid_loss 0.787669
Epoch 14, Train Loss 0.503351, Valid_loss 0.804236
Epoch 15, Train Loss 0.418079, Valid_loss 0.862761
Epoch 16, Train Loss 0.385157, Valid_loss 0.723815
Epoch 17, Train Loss 0.473911, Valid_loss 0.831461
Epoch 18, Train Loss 0.388350, Valid_loss 0.747712
Epoch 19, Train Loss 0.338442, Valid_loss 0.878350
Epoch 20, Train Loss 0.431494, Valid_loss 0.749625
Epoch 21, Train Loss 0.395465, Valid_loss 0.645119
Epoch 22, Train Loss 0.404416, Valid_loss 0.758841
Epoch 23, Train Loss 0.303828, Valid_loss 0.652959
Epoch 24, Train Loss 0.326077, Valid_loss 0.637528
Epoch 25, Train Loss 0.340001, Valid_loss 0.600371
Epoch 26, Train Loss 0.248918, Valid_loss 0.572585
Epoch 27, Train Loss 0.349186, Valid_loss 0.616600
Epoch 28, Train Loss 0.386942, Valid_loss 0.576396
Epoch 29, Train Loss 0.338245, Valid_loss 0.651883
Epoch 30, Train Loss 0.334562, Valid_loss 0.606944
Epoch 31, Train Loss 0.321651, Valid_loss 0.650432
Epoch 32, Train Loss 0.313735, Valid_loss 0.590858
Epoch 33, Train Loss 0.282846, Valid_loss 0.528306
Epoch 34, Train Loss 0.347831, Valid_loss 0.525239
Epoch 35, Train Loss 0.313455, Valid_loss 0.545147
Epoch 36, Train Loss 0.287075, Valid_loss 0.531188
Epoch 37, Train Loss 0.311291, Valid_loss 0.527881
Epoch 38, Train Loss 0.322651, Valid_loss 0.620228
Epoch 39, Train Loss 0.303852, Valid_loss 0.742447
Epoch 40, Train Loss 0.290774, Valid_loss 1.059717
Epoch 41, Train Loss 0.312189, Valid_loss 0.678063
Epoch 42, Train Loss 0.520664, Valid_loss 4.471159
Epoch 43, Train Loss 0.508017, Valid_loss 3.111233
Epoch 44, Train Loss 0.451899, Valid_loss 1.818242
Epoch 45, Train Loss 0.349743, Valid_loss 1.661707
Epoch 46, Train Loss 0.372382, Valid_loss 1.625171
Epoch 47, Train Loss 0.350725, Valid_loss 1.224692
Epoch 48, Train Loss 0.317116, Valid_loss 1.478603
Epoch 49, Train Loss 0.398869, Valid_loss 1.649378
Epoch 50, Train Loss 0.323310, Valid_loss 1.162056
Epoch 51, Train Loss 0.243999, Valid_loss 1.360916
Epoch 52, Train Loss 0.228295, Valid_loss 1.438499
[I 2025-08-30 15:49:34,873] Trial 1 finished with value: 0.525238998796946 and parameters: {'learning_rate': 0.001, 'epochs': 100, 'heads': 1, 'dropout': 0.3, 'weight_decay': 0.0001, 'emb_dim': 64, 'augment_num': 100, 'pca': False}. Best is trial 1 with value: 0.525238998796946.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 18.01 MB
Memory Reserved: 42.00 MB
cuda
CUDA OOM 발생 — 단계적 백오프 시작.
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 7488.35 MB
Memory Reserved: 7510.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 14684.32 MB
Memory Reserved: 14726.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 7488.32 MB
Memory Reserved: 7510.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 14684.32 MB
Memory Reserved: 14726.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[I 2025-08-30 15:49:36,800] Trial 2 pruned. Pruned due to OOM after backoff
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 7490.25 MB
Memory Reserved: 7510.00 MB
cuda
CUDA OOM 발생 — 단계적 백오프 시작.
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 14710.76 MB
Memory Reserved: 14746.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 7514.85 MB
Memory Reserved: 7538.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 14710.85 MB
Memory Reserved: 14766.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[OOM RETRY] batch_size 1 → 1 낮춰서 다시 시도합니다.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 7514.85 MB
Memory Reserved: 7558.00 MB
cuda
[OOM RETRY] batch_size=1에서도 OOM. batch_size를 더 낮춰서 다시 시도합니다... (batch_size 1이었을 경우 중단합니다.)
[I 2025-08-30 15:49:38,204] Trial 3 pruned. Pruned due to OOM after backoff
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 14707.64 MB
Memory Reserved: 14754.00 MB
cuda
Epoch 1, Train Loss 0.903406, Valid_loss 1.463640
Epoch 2, Train Loss 0.873595, Valid_loss 1.517470
Epoch 3, Train Loss 0.844936, Valid_loss 1.434707
Epoch 4, Train Loss 0.857080, Valid_loss 1.301373
Epoch 5, Train Loss 0.830764, Valid_loss 1.589329
Epoch 6, Train Loss 0.824964, Valid_loss 1.116846
Epoch 7, Train Loss 0.847495, Valid_loss 1.706068
Epoch 8, Train Loss 0.846043, Valid_loss 1.127564
Epoch 9, Train Loss 0.823897, Valid_loss 1.174194
Epoch 10, Train Loss 0.833641, Valid_loss 1.159637
Epoch 11, Train Loss 0.844205, Valid_loss 1.480073
Epoch 12, Train Loss 0.843989, Valid_loss 1.196535
Epoch 13, Train Loss 0.824499, Valid_loss 1.108833
Epoch 14, Train Loss 0.835921, Valid_loss 1.229343
Epoch 15, Train Loss 0.825364, Valid_loss 1.219256
Epoch 16, Train Loss 0.826321, Valid_loss 1.209653
Epoch 17, Train Loss 0.825941, Valid_loss 1.194743
Epoch 18, Train Loss 0.823537, Valid_loss 1.208263
Epoch 19, Train Loss 0.823278, Valid_loss 1.206929
Epoch 20, Train Loss 0.816438, Valid_loss 1.198884
Epoch 21, Train Loss 0.825848, Valid_loss 1.228616
Epoch 22, Train Loss 0.842412, Valid_loss 1.191797
Epoch 23, Train Loss 0.813845, Valid_loss 1.184096
Epoch 24, Train Loss 0.813229, Valid_loss 1.168512
Epoch 25, Train Loss 0.819627, Valid_loss 1.164155
Epoch 26, Train Loss 0.820840, Valid_loss 1.166797
Epoch 27, Train Loss 0.814235, Valid_loss 1.176125
Epoch 28, Train Loss 0.814223, Valid_loss 1.178252
Epoch 29, Train Loss 0.808897, Valid_loss 1.203286
Epoch 30, Train Loss 0.828146, Valid_loss 1.528309
Epoch 31, Train Loss 0.834087, Valid_loss 1.165272
Epoch 32, Train Loss 0.809115, Valid_loss 1.174890
Epoch 33, Train Loss 0.823465, Valid_loss 1.178964
Epoch 34, Train Loss 0.813329, Valid_loss 1.175006
Epoch 35, Train Loss 0.815604, Valid_loss 1.156349
Epoch 36, Train Loss 0.819542, Valid_loss 1.171350
Epoch 37, Train Loss 0.804027, Valid_loss 1.163816
Epoch 38, Train Loss 0.813005, Valid_loss 1.167057
Epoch 39, Train Loss 0.804868, Valid_loss 1.162459
Epoch 40, Train Loss 0.821551, Valid_loss 1.154244
Epoch 41, Train Loss 0.817991, Valid_loss 1.141561
Epoch 42, Train Loss 0.815280, Valid_loss 1.144812
Epoch 43, Train Loss 0.811068, Valid_loss 1.143101
Epoch 44, Train Loss 0.813009, Valid_loss 1.143394
Epoch 45, Train Loss 0.816282, Valid_loss 1.136816
Epoch 46, Train Loss 0.817517, Valid_loss 1.139473
Epoch 47, Train Loss 0.818581, Valid_loss 1.138260
Epoch 48, Train Loss 0.806988, Valid_loss 1.142739
Epoch 49, Train Loss 0.821216, Valid_loss 1.138121
Epoch 50, Train Loss 0.815817, Valid_loss 1.135537
Epoch 51, Train Loss 0.801098, Valid_loss 1.132153
Epoch 52, Train Loss 0.810465, Valid_loss 1.135952
Epoch 53, Train Loss 0.807791, Valid_loss 1.131672
Epoch 54, Train Loss 0.807422, Valid_loss 1.128282
Epoch 55, Train Loss 0.802981, Valid_loss 1.129638
Epoch 56, Train Loss 0.803812, Valid_loss 1.125292
Epoch 57, Train Loss 0.803716, Valid_loss 1.124641
Epoch 58, Train Loss 0.808143, Valid_loss 1.125315
Epoch 59, Train Loss 0.806176, Valid_loss 1.119972
Epoch 60, Train Loss 0.802811, Valid_loss 1.117750
Epoch 61, Train Loss 0.800181, Valid_loss 1.119451
Epoch 62, Train Loss 0.805644, Valid_loss 1.117347
Epoch 63, Train Loss 0.801052, Valid_loss 1.113583
Epoch 64, Train Loss 0.806169, Valid_loss 1.110040
Epoch 65, Train Loss 0.804555, Valid_loss 1.109434
Epoch 66, Train Loss 0.805016, Valid_loss 1.109538
Epoch 67, Train Loss 0.799921, Valid_loss 1.108539
Epoch 68, Train Loss 0.805654, Valid_loss 1.107436
Epoch 69, Train Loss 0.802997, Valid_loss 1.106037
Epoch 70, Train Loss 0.801870, Valid_loss 1.107955
Epoch 71, Train Loss 0.801973, Valid_loss 1.103191
Epoch 72, Train Loss 0.802800, Valid_loss 1.101274
Epoch 73, Train Loss 0.800142, Valid_loss 1.100161
Epoch 74, Train Loss 0.799899, Valid_loss 1.100122
Epoch 75, Train Loss 0.801246, Valid_loss 1.099572
Epoch 76, Train Loss 0.803069, Valid_loss 1.097073
Epoch 77, Train Loss 0.803147, Valid_loss 1.096817
Epoch 78, Train Loss 0.798780, Valid_loss 1.098181
Epoch 79, Train Loss 0.804039, Valid_loss 1.094478
Epoch 80, Train Loss 0.800854, Valid_loss 1.092129
Epoch 81, Train Loss 0.807160, Valid_loss 1.091527
Epoch 82, Train Loss 0.801971, Valid_loss 1.092274
Epoch 83, Train Loss 0.803579, Valid_loss 1.090589
Epoch 84, Train Loss 0.802966, Valid_loss 1.090440
Epoch 85, Train Loss 0.805582, Valid_loss 1.090158
Epoch 86, Train Loss 0.806917, Valid_loss 1.090350
Epoch 87, Train Loss 0.806803, Valid_loss 1.089062
Epoch 88, Train Loss 0.802292, Valid_loss 1.090587
Epoch 89, Train Loss 0.800992, Valid_loss 1.090022
Epoch 90, Train Loss 0.802632, Valid_loss 1.092173
Epoch 91, Train Loss 0.800137, Valid_loss 1.088644
Epoch 92, Train Loss 0.801627, Valid_loss 1.088398
Epoch 93, Train Loss 0.795878, Valid_loss 1.088743
Epoch 94, Train Loss 0.807280, Valid_loss 1.088051
Epoch 95, Train Loss 0.797709, Valid_loss 1.087714
Epoch 96, Train Loss 0.791713, Valid_loss 1.086626
Epoch 97, Train Loss 0.803409, Valid_loss 1.084729
Epoch 98, Train Loss 0.798859, Valid_loss 1.170672
Epoch 99, Train Loss 0.804376, Valid_loss 1.085496
Epoch 100, Train Loss 0.805650, Valid_loss 1.086451
[I 2025-08-30 16:25:15,438] Trial 4 finished with value: 1.0847287972768147 and parameters: {'learning_rate': 0.01, 'epochs': 100, 'heads': 1, 'dropout': 0.0, 'weight_decay': 0.001, 'emb_dim': 8, 'augment_num': 100, 'pca': False}. Best is trial 1 with value: 0.525238998796946.
선택된 trial params: {'learning_rate': 0.001, 'epochs': 100, 'heads': 1, 'dropout': 0.3, 'weight_decay': 0.0001, 'emb_dim': 64, 'augment_num': 100, 'pca': False}
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=8, batch_size=1 -> steps=8
Memory Allocated: 19.85 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.918852, Valid_loss 1.674093
Epoch 2, Train Loss 0.862054, Valid_loss 1.764323
Epoch 3, Train Loss 0.876196, Valid_loss 1.705975
Epoch 4, Train Loss 0.830679, Valid_loss 1.394999
Epoch 5, Train Loss 0.677844, Valid_loss 1.030112
Epoch 6, Train Loss 0.656193, Valid_loss 1.321164
Epoch 7, Train Loss 0.746247, Valid_loss 2.043610
Epoch 8, Train Loss 0.902638, Valid_loss 1.752424
Epoch 9, Train Loss 0.856465, Valid_loss 1.624440
Epoch 10, Train Loss 0.840861, Valid_loss 1.706413
Epoch 11, Train Loss 0.858429, Valid_loss 1.463064
Epoch 12, Train Loss 0.851854, Valid_loss 1.430328
Epoch 13, Train Loss 0.700218, Valid_loss 2.125067
Epoch 14, Train Loss 0.593714, Valid_loss 1.044417
Epoch 15, Train Loss 0.478823, Valid_loss 0.859418
Epoch 16, Train Loss 0.495904, Valid_loss 0.906397
Epoch 17, Train Loss 0.498217, Valid_loss 0.918679
Epoch 18, Train Loss 0.465091, Valid_loss 0.935176
Epoch 19, Train Loss 0.374837, Valid_loss 0.865905
Epoch 20, Train Loss 0.346783, Valid_loss 0.882430
Epoch 21, Train Loss 0.475155, Valid_loss 0.781661
Epoch 22, Train Loss 0.414197, Valid_loss 0.795473
Epoch 23, Train Loss 0.370617, Valid_loss 0.924590
Epoch 24, Train Loss 0.407333, Valid_loss 0.895200
Epoch 25, Train Loss 0.374950, Valid_loss 0.786009
Epoch 26, Train Loss 0.389045, Valid_loss 0.795268
Epoch 27, Train Loss 0.343427, Valid_loss 0.715052
Epoch 28, Train Loss 0.350220, Valid_loss 0.659225
Epoch 29, Train Loss 0.356254, Valid_loss 1.033152
Epoch 30, Train Loss 0.398997, Valid_loss 0.610147
Epoch 31, Train Loss 0.305605, Valid_loss 0.880942
Epoch 32, Train Loss 0.240103, Valid_loss 0.608940
Epoch 33, Train Loss 0.343895, Valid_loss 0.645248
Epoch 34, Train Loss 0.201672, Valid_loss 0.636593
Epoch 35, Train Loss 0.254931, Valid_loss 0.689562
Epoch 36, Train Loss 0.234588, Valid_loss 0.611413
Epoch 37, Train Loss 0.294235, Valid_loss 0.679493
Epoch 38, Train Loss 0.209445, Valid_loss 0.525034
Epoch 39, Train Loss 0.190589, Valid_loss 0.526801
Epoch 40, Train Loss 0.138668, Valid_loss 0.595328
Epoch 41, Train Loss 0.231875, Valid_loss 0.751634
Epoch 42, Train Loss 0.177596, Valid_loss 0.575419
Epoch 43, Train Loss 0.208289, Valid_loss 0.869586
Epoch 44, Train Loss 0.198693, Valid_loss 0.734780
Epoch 45, Train Loss 0.386829, Valid_loss 0.959396
Epoch 46, Train Loss 0.191363, Valid_loss 1.699654
Epoch 47, Train Loss 0.141396, Valid_loss 0.813785
Epoch 48, Train Loss 0.152490, Valid_loss 0.822506
Epoch 49, Train Loss 0.136279, Valid_loss 0.710391
Epoch 50, Train Loss 0.166463, Valid_loss 0.729192
Epoch 51, Train Loss 0.097381, Valid_loss 0.827455
Epoch 52, Train Loss 0.100244, Valid_loss 0.818302
Epoch 53, Train Loss 0.159849, Valid_loss 0.667903
Epoch 54, Train Loss 0.090245, Valid_loss 0.517661
Epoch 55, Train Loss 0.095488, Valid_loss 0.730725
Epoch 56, Train Loss 0.093103, Valid_loss 0.708180
Epoch 57, Train Loss 0.109927, Valid_loss 0.605949
Epoch 58, Train Loss 0.055697, Valid_loss 0.640704
Epoch 59, Train Loss 0.033662, Valid_loss 0.650204
환자ID=P1290 -- true: [[2]] -- pred: tensor([[-5.4665,  1.4545,  1.6519]], device='cuda:0')
환자ID=P1300 -- true: [[2]] -- pred: tensor([[-5.4451,  1.4278,  1.7397]], device='cuda:0')
환자ID=P1447 -- true: [[1]] -- pred: tensor([[-4.6048,  2.0617, -0.7165]], device='cuda:0')
환자ID=P1479 -- true: [[1]] -- pred: tensor([[ 3.8257, -0.5195, -6.7665]], device='cuda:0')
환자ID=P1508 -- true: [[1]] -- pred: tensor([[-2.0639,  2.0648, -3.3635]], device='cuda:0')
환자ID=P1539 -- true: [[0]] -- pred: tensor([[ 5.4157, -1.8302, -6.9148]], device='cuda:0')
환자ID=P1603 -- true: [[0]] -- pred: tensor([[ 5.4333, -1.8671, -6.8978]], device='cuda:0')
환자ID=P1622 -- true: [[0]] -- pred: tensor([[ 5.0351, -1.3811, -7.0314]], device='cuda:0')
Best performance: Epoch 54, Loss 0.090245, Test ACC 0.875000, Test AUC 0.944444, Test Recall 0.888889, Test Precision 0.916667
Confusion Matrix:
 [[3 0 0]
 [1 2 0]
 [0 0 2]]
✅ Total valid splits used: 4
🔁 Repeat 4, Fold 4
cell type :  TTCTTCCGTTCAACGT-1-0                Astrocyte
CATCCACCATCTAACG-1-0      Smooth_muscle_cells
ACCCAAACAGCTAACT-1-0                  Neurons
AAGGAATCAACTGGTT-1-0     Neuroepithelial_cell
TACCCGTAGCGTGCTC-1-0                Astrocyte
                                 ...         
TTATTGCGTCGGTGTC-1-79       Endothelial_cells
GTCACGGGTTGTATGC-1-79       Endothelial_cells
GTCATGATCTTTCGAT-1-79       Endothelial_cells
GCGATCGTCAGAGTGG-1-79               Platelets
GCCCGAACAGAGAAAG-1-79       Endothelial_cells
Name: singler_annotation, Length: 496290, dtype: string
cell type annotation :  TTCTTCCGTTCAACGT-1-0                Astrocyte
CATCCACCATCTAACG-1-0      Smooth_muscle_cells
ACCCAAACAGCTAACT-1-0                  Neurons
AAGGAATCAACTGGTT-1-0     Neuroepithelial_cell
TACCCGTAGCGTGCTC-1-0                Astrocyte
                                 ...         
TTATTGCGTCGGTGTC-1-79       Endothelial_cells
GTCACGGGTTGTATGC-1-79       Endothelial_cells
GTCATGATCTTTCGAT-1-79       Endothelial_cells
GCGATCGTCAGAGTGG-1-79               Platelets
GCCCGAACAGAGAAAG-1-79       Endothelial_cells
Name: singler_annotation, Length: 496290, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Astrocyte', 'Smooth_muscle_cells', 'Neurons', 'Neuroepithelial_cell', 'Endothelial_cells', 'Osteoblasts', 'Platelets', 'Hepatocytes', 'Embryonic_stem_cells', 'MEP', 'Erythroblast', 'Fibroblasts', 'iPS_cells', 'MSC', 'Macrophage', 'Gametocytes', 'Chondrocytes', 'NK_cell', 'Neutrophils', 'HSC_CD34+', 'Monocyte', 'Tissue_stem_cells', 'DC', 'HSC_-G-CSF', 'T_cells', 'Epithelial_cells', 'Unknown', 'Pre-B_cell_CD34-', 'GMP', 'B_cell', 'Pro-Myelocyte', 'Keratinocytes', 'Myelocyte', 'BM', 'CMP', 'BM & Prog.', 'Pro-B_cell_CD34+']
라벨별 그룹 개수 {2: 9, 1: 12, 0: 13}
cell type :  CAACCAAAGACCCGCT-1-2                 Neurons
ACGGTTACATCGAACT-1-2                 Neurons
ACCCTCATCCGGCAGT-1-2                 Neurons
AACACACCACGGTCTG-1-2     Smooth_muscle_cells
AAACGCTTCACCGGGT-1-2                 Neurons
                                ...         
CGTCCATAGAATTTGG-1-78      Endothelial_cells
GCTTCACAGCGTTGTT-1-78            Hepatocytes
TCTCTGGCAGTCGCAC-1-78                Neurons
CAACAACCAGAGGCTA-1-78                Neurons
CATTGTTGTCGTACAT-1-78      Endothelial_cells
Name: singler_annotation, Length: 96399, dtype: string
cell type annotation :  CAACCAAAGACCCGCT-1-2                 Neurons
ACGGTTACATCGAACT-1-2                 Neurons
ACCCTCATCCGGCAGT-1-2                 Neurons
AACACACCACGGTCTG-1-2     Smooth_muscle_cells
AAACGCTTCACCGGGT-1-2                 Neurons
                                ...         
CGTCCATAGAATTTGG-1-78      Endothelial_cells
GCTTCACAGCGTTGTT-1-78            Hepatocytes
TCTCTGGCAGTCGCAC-1-78                Neurons
CAACAACCAGAGGCTA-1-78                Neurons
CATTGTTGTCGTACAT-1-78      Endothelial_cells
Name: singler_annotation, Length: 96399, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Neurons', 'Smooth_muscle_cells', 'Osteoblasts', 'Endothelial_cells', 'MSC', 'Astrocyte', 'Fibroblasts', 'Erythroblast', 'Neuroepithelial_cell', 'Platelets', 'iPS_cells', 'NK_cell', 'Embryonic_stem_cells', 'MEP', 'Gametocytes', 'Hepatocytes', 'Tissue_stem_cells', 'Monocyte', 'Macrophage', 'Neutrophils', 'Chondrocytes', 'HSC_-G-CSF', 'BM & Prog.', 'DC', 'Keratinocytes', 'T_cells', 'HSC_CD34+', 'CMP', 'B_cell', 'Myelocyte', 'Epithelial_cells', 'Unknown', 'Pro-Myelocyte', 'Pre-B_cell_CD34-', 'BM', 'GMP', 'Pro-B_cell_CD34+']
라벨별 그룹 개수 {2: 2, 1: 3, 0: 3}
🔍 Split #5
  → train_p_index 환자 수 (환자 단위로 묶인 index list): 34
  → test_p_index 환자 수  (환자 단위로 묶인 index list): 8
  → train 환자 ID: ['P1290', 'P1300', 'P1304', 'P1358', 'P1371', 'P1422', 'P1425', 'P1430', 'P1437', 'P1447', 'P1462', 'P1472', 'P1479', 'P1508', 'P1515', 'P1516', 'P1539', 'P1540', 'P1558', 'P1561', 'P1582', 'P1600', 'P1602', 'P1603', 'P1617', 'P1622', 'P1630', 'P1678', 'P1685', 'P1702', 'P1707', 'P1718', 'P1726', 'P1735']
  → test  환자 ID: ['P1504', 'P1510', 'P1547', 'P1549', 'P1606', 'P1610', 'P1631', 'P1722']
  → train 환자 ID 및 라벨:
    ID: P1290, Label: 2
    ID: P1300, Label: 2
    ID: P1304, Label: 2
    ID: P1358, Label: 2
    ID: P1371, Label: 2
    ID: P1422, Label: 1
    ID: P1425, Label: 1
    ID: P1430, Label: 2
    ID: P1437, Label: 2
    ID: P1447, Label: 1
    ID: P1462, Label: 1
    ID: P1472, Label: 2
    ID: P1479, Label: 1
    ID: P1508, Label: 1
    ID: P1515, Label: 0
    ID: P1516, Label: 0
    ID: P1539, Label: 0
    ID: P1540, Label: 0
    ID: P1558, Label: 0
    ID: P1561, Label: 0
    ID: P1582, Label: 0
    ID: P1600, Label: 0
    ID: P1602, Label: 1
    ID: P1603, Label: 0
    ID: P1617, Label: 2
    ID: P1622, Label: 0
    ID: P1630, Label: 1
    ID: P1678, Label: 0
    ID: P1685, Label: 1
    ID: P1702, Label: 0
    ID: P1707, Label: 1
    ID: P1718, Label: 0
    ID: P1726, Label: 1
    ID: P1735, Label: 1
  → test 환자 ID 및 라벨:
    ID: P1504, Label: 2
    ID: P1510, Label: 1
    ID: P1547, Label: 0
    ID: P1549, Label: 0
    ID: P1606, Label: 2
    ID: P1610, Label: 0
    ID: P1631, Label: 1
    ID: P1722, Label: 1
전체 데이터 index 길이 42
label_stat (train 환자 라벨 목록) 갯수 34
train_data에서 환자 단위로, train과 validation 나누기
기존 train_p_index 34
기존 (train) label_stat 34
train-vali 분할 후! 
train y 의 classes : {0, 1, 2} valid y 의 classes : {0, 1, 2} label_stat 의 classes : {0, 1, 2}
train_p_index_ 22
valid_p_index 12
test_p_index 8
→ train 환자 ID 및 라벨:
   총 개수: 22
   환자ID=P1718, Label=0, 셀개수=9278
   환자ID=P1515, Label=0, 셀개수=14502
   환자ID=P1304, Label=2, 셀개수=19123
   환자ID=P1437, Label=2, 셀개수=21695
   환자ID=P1603, Label=0, 셀개수=10638
   환자ID=P1678, Label=0, 셀개수=10085
   환자ID=P1371, Label=2, 셀개수=16233
   환자ID=P1735, Label=1, 셀개수=12009
   환자ID=P1707, Label=1, 셀개수=9517
   환자ID=P1539, Label=0, 셀개수=11076
   환자ID=P1685, Label=1, 셀개수=10043
   환자ID=P1479, Label=1, 셀개수=19124
   환자ID=P1422, Label=1, 셀개수=23315
   환자ID=P1630, Label=1, 셀개수=17633
   환자ID=P1622, Label=0, 셀개수=7210
   환자ID=P1508, Label=1, 셀개수=20536
   환자ID=P1602, Label=1, 셀개수=16580
   환자ID=P1472, Label=2, 셀개수=19513
   환자ID=P1462, Label=1, 셀개수=21715
   환자ID=P1430, Label=2, 셀개수=11131
   환자ID=P1582, Label=0, 셀개수=18855
   환자ID=P1516, Label=0, 셀개수=9361
→ valid 환자 ID 및 라벨:
   총 개수: 12
   환자ID=P1300, Label=2, 셀개수=17318
   환자ID=P1425, Label=1, 셀개수=15378
   환자ID=P1540, Label=0, 셀개수=11638
   환자ID=P1447, Label=1, 셀개수=11151
   환자ID=P1290, Label=2, 셀개수=8357
   환자ID=P1561, Label=0, 셀개수=10016
   환자ID=P1726, Label=1, 셀개수=12389
   환자ID=P1558, Label=0, 셀개수=10469
   환자ID=P1702, Label=0, 셀개수=13550
   환자ID=P1358, Label=2, 셀개수=23984
   환자ID=P1617, Label=2, 셀개수=17986
   환자ID=P1600, Label=0, 셀개수=14882
→ test 환자 ID 및 라벨:
   총 개수: 8
   환자ID=P1504, Label=2, 셀개수=8133
   환자ID=P1510, Label=1, 셀개수=10744
   환자ID=P1547, Label=0, 셀개수=8253
   환자ID=P1549, Label=0, 셀개수=11709
   환자ID=P1606, Label=2, 셀개수=8523
   환자ID=P1610, Label=0, 셀개수=13919
   환자ID=P1631, Label=1, 셀개수=13686
   환자ID=P1722, Label=1, 셀개수=21432
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Astrocyte', 'Smooth_muscle_cells', 'Neurons', 'Neuroepithelial_cell', 'Astrocyte', 'Endothelial_cells', 'Osteoblasts', 'Platelets', 'Neurons', 'Hepatocytes']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
전체 데이터 길이 592689
전체 cell type 길이 0                    Astrocyte
1          Smooth_muscle_cells
2                      Neurons
3         Neuroepithelial_cell
4                    Astrocyte
                  ...         
592684       Endothelial_cells
592685             Hepatocytes
592686                 Neurons
592687                 Neurons
592688       Endothelial_cells
Length: 592689, dtype: string
cell type의 NaN 개수 체크 0
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:13,  7.28it/s]  2%|▏         | 2/100 [00:00<00:13,  7.24it/s]  3%|▎         | 3/100 [00:00<00:13,  7.40it/s]  4%|▍         | 4/100 [00:00<00:12,  7.40it/s]  5%|▌         | 5/100 [00:00<00:12,  7.40it/s]  6%|▌         | 6/100 [00:00<00:12,  7.37it/s]  7%|▋         | 7/100 [00:00<00:12,  7.38it/s]  8%|▊         | 8/100 [00:01<00:12,  7.34it/s]  9%|▉         | 9/100 [00:01<00:12,  7.42it/s] 10%|█         | 10/100 [00:01<00:12,  7.37it/s] 11%|█         | 11/100 [00:01<00:12,  7.31it/s] 12%|█▏        | 12/100 [00:01<00:12,  7.18it/s] 13%|█▎        | 13/100 [00:01<00:12,  7.08it/s] 14%|█▍        | 14/100 [00:01<00:12,  7.16it/s] 15%|█▌        | 15/100 [00:02<00:11,  7.20it/s] 16%|█▌        | 16/100 [00:02<00:11,  7.16it/s] 17%|█▋        | 17/100 [00:02<00:11,  7.04it/s] 18%|█▊        | 18/100 [00:02<00:11,  7.05it/s] 19%|█▉        | 19/100 [00:02<00:11,  7.07it/s] 20%|██        | 20/100 [00:02<00:11,  7.12it/s] 21%|██        | 21/100 [00:02<00:11,  7.08it/s] 22%|██▏       | 22/100 [00:03<00:10,  7.12it/s] 23%|██▎       | 23/100 [00:03<00:10,  7.12it/s] 24%|██▍       | 24/100 [00:03<00:10,  7.27it/s] 25%|██▌       | 25/100 [00:03<00:10,  7.25it/s] 26%|██▌       | 26/100 [00:03<00:10,  7.26it/s] 27%|██▋       | 27/100 [00:03<00:10,  7.24it/s] 28%|██▊       | 28/100 [00:03<00:09,  7.32it/s] 29%|██▉       | 29/100 [00:04<00:09,  7.34it/s] 30%|███       | 30/100 [00:04<00:09,  7.51it/s] 31%|███       | 31/100 [00:04<00:09,  7.49it/s] 32%|███▏      | 32/100 [00:04<00:09,  7.42it/s] 33%|███▎      | 33/100 [00:04<00:09,  7.39it/s] 34%|███▍      | 34/100 [00:04<00:08,  7.44it/s] 35%|███▌      | 35/100 [00:04<00:08,  7.30it/s] 36%|███▌      | 36/100 [00:04<00:08,  7.29it/s] 37%|███▋      | 37/100 [00:05<00:08,  7.14it/s] 38%|███▊      | 38/100 [00:05<00:08,  7.19it/s] 39%|███▉      | 39/100 [00:05<00:08,  7.08it/s] 40%|████      | 40/100 [00:05<00:08,  7.24it/s] 41%|████      | 41/100 [00:05<00:08,  7.05it/s] 42%|████▏     | 42/100 [00:05<00:08,  7.01it/s] 43%|████▎     | 43/100 [00:05<00:08,  7.00it/s] 44%|████▍     | 44/100 [00:06<00:08,  6.96it/s] 45%|████▌     | 45/100 [00:06<00:07,  7.08it/s] 46%|████▌     | 46/100 [00:06<00:07,  7.19it/s] 47%|████▋     | 47/100 [00:06<00:07,  7.17it/s] 48%|████▊     | 48/100 [00:06<00:07,  7.10it/s] 49%|████▉     | 49/100 [00:06<00:07,  7.06it/s] 50%|█████     | 50/100 [00:06<00:06,  7.15it/s] 51%|█████     | 51/100 [00:07<00:06,  7.14it/s] 52%|█████▏    | 52/100 [00:07<00:06,  7.12it/s] 53%|█████▎    | 53/100 [00:07<00:06,  7.01it/s] 54%|█████▍    | 54/100 [00:07<00:06,  6.92it/s] 55%|█████▌    | 55/100 [00:07<00:06,  6.91it/s] 56%|█████▌    | 56/100 [00:07<00:06,  6.88it/s] 57%|█████▋    | 57/100 [00:07<00:06,  6.91it/s] 58%|█████▊    | 58/100 [00:08<00:06,  6.89it/s] 59%|█████▉    | 59/100 [00:08<00:05,  7.00it/s] 60%|██████    | 60/100 [00:08<00:05,  6.99it/s] 61%|██████    | 61/100 [00:08<00:05,  7.03it/s] 62%|██████▏   | 62/100 [00:08<00:05,  6.89it/s] 63%|██████▎   | 63/100 [00:08<00:05,  6.87it/s] 64%|██████▍   | 64/100 [00:08<00:05,  6.92it/s] 65%|██████▌   | 65/100 [00:09<00:05,  6.99it/s] 66%|██████▌   | 66/100 [00:09<00:04,  7.00it/s] 67%|██████▋   | 67/100 [00:09<00:04,  6.87it/s] 68%|██████▊   | 68/100 [00:09<00:04,  6.92it/s] 69%|██████▉   | 69/100 [00:09<00:04,  6.85it/s] 70%|███████   | 70/100 [00:09<00:04,  6.90it/s] 71%|███████   | 71/100 [00:09<00:04,  6.78it/s] 72%|███████▏  | 72/100 [00:10<00:04,  6.82it/s] 73%|███████▎  | 73/100 [00:10<00:04,  6.73it/s] 74%|███████▍  | 74/100 [00:10<00:03,  6.71it/s] 75%|███████▌  | 75/100 [00:10<00:03,  6.74it/s] 76%|███████▌  | 76/100 [00:10<00:03,  6.79it/s] 77%|███████▋  | 77/100 [00:10<00:03,  6.81it/s] 78%|███████▊  | 78/100 [00:11<00:03,  6.88it/s] 79%|███████▉  | 79/100 [00:11<00:03,  6.72it/s] 80%|████████  | 80/100 [00:11<00:02,  6.73it/s] 81%|████████  | 81/100 [00:11<00:02,  6.69it/s] 82%|████████▏ | 82/100 [00:11<00:02,  6.67it/s] 83%|████████▎ | 83/100 [00:11<00:02,  6.57it/s] 84%|████████▍ | 84/100 [00:11<00:02,  6.64it/s] 85%|████████▌ | 85/100 [00:12<00:02,  6.62it/s] 86%|████████▌ | 86/100 [00:12<00:02,  6.66it/s] 87%|████████▋ | 87/100 [00:12<00:01,  6.56it/s] 88%|████████▊ | 88/100 [00:12<00:01,  6.66it/s] 89%|████████▉ | 89/100 [00:12<00:01,  6.66it/s] 90%|█████████ | 90/100 [00:12<00:01,  6.63it/s] 91%|█████████ | 91/100 [00:12<00:01,  6.72it/s] 92%|█████████▏| 92/100 [00:13<00:01,  6.61it/s] 93%|█████████▎| 93/100 [00:13<00:01,  6.65it/s] 94%|█████████▍| 94/100 [00:13<00:00,  6.61it/s] 95%|█████████▌| 95/100 [00:13<00:00,  6.72it/s] 96%|█████████▌| 96/100 [00:13<00:00,  6.72it/s] 97%|█████████▋| 97/100 [00:13<00:00,  6.67it/s] 98%|█████████▊| 98/100 [00:14<00:00,  6.69it/s] 99%|█████████▉| 99/100 [00:14<00:00,  6.50it/s]100%|██████████| 100/100 [00:14<00:00,  6.39it/s]100%|██████████| 100/100 [00:14<00:00,  6.97it/s]
[I 2025-08-30 16:49:59,436] A new study created in memory with name: no-name-2609706f-5a79-463e-b404-de808ea0f1ca
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 18.01 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 1.024632, Valid_loss 1.181137
Epoch 2, Train Loss 0.934439, Valid_loss 1.133287
Epoch 3, Train Loss 0.859521, Valid_loss 1.049141
Epoch 4, Train Loss 0.777386, Valid_loss 0.989864
Epoch 5, Train Loss 0.764398, Valid_loss 0.890801
Epoch 6, Train Loss 0.673037, Valid_loss 0.897861
Epoch 7, Train Loss 0.723384, Valid_loss 0.849127
Epoch 8, Train Loss 0.608078, Valid_loss 0.850840
Epoch 9, Train Loss 0.582766, Valid_loss 0.806479
Epoch 10, Train Loss 0.577801, Valid_loss 0.815847
Epoch 11, Train Loss 0.618869, Valid_loss 0.827978
Epoch 12, Train Loss 0.597325, Valid_loss 0.823146
Epoch 13, Train Loss 0.539853, Valid_loss 0.802326
Epoch 14, Train Loss 0.571516, Valid_loss 0.761758
Epoch 15, Train Loss 0.580987, Valid_loss 0.897218
Epoch 16, Train Loss 0.525794, Valid_loss 0.769893
Epoch 17, Train Loss 0.547408, Valid_loss 0.722749
Epoch 18, Train Loss 0.531083, Valid_loss 0.737812
Epoch 19, Train Loss 0.512533, Valid_loss 0.941622
Epoch 20, Train Loss 0.484931, Valid_loss 0.729711
Epoch 21, Train Loss 0.547025, Valid_loss 0.714804
Epoch 22, Train Loss 0.504128, Valid_loss 0.840675
Epoch 23, Train Loss 0.502560, Valid_loss 0.721561
Epoch 24, Train Loss 0.474015, Valid_loss 0.747942
Epoch 25, Train Loss 0.459172, Valid_loss 0.704343
Epoch 26, Train Loss 0.423810, Valid_loss 0.703523
Epoch 27, Train Loss 0.401337, Valid_loss 0.708685
Epoch 28, Train Loss 0.487348, Valid_loss 0.709849
Epoch 29, Train Loss 0.405808, Valid_loss 0.684685
Epoch 30, Train Loss 0.481443, Valid_loss 0.689726
Epoch 31, Train Loss 0.494802, Valid_loss 0.704844
Epoch 32, Train Loss 0.448361, Valid_loss 0.699791
Epoch 33, Train Loss 0.465817, Valid_loss 0.693961
Epoch 34, Train Loss 0.422964, Valid_loss 0.720009
Epoch 35, Train Loss 0.412751, Valid_loss 0.682456
Epoch 36, Train Loss 0.465872, Valid_loss 0.670501
Epoch 37, Train Loss 0.560915, Valid_loss 0.716014
Epoch 38, Train Loss 0.400322, Valid_loss 0.706825
Epoch 39, Train Loss 0.438087, Valid_loss 0.743714
Epoch 40, Train Loss 0.391466, Valid_loss 0.797715
Epoch 41, Train Loss 0.446122, Valid_loss 0.681701
Epoch 42, Train Loss 0.416197, Valid_loss 0.644913
Epoch 43, Train Loss 0.399410, Valid_loss 0.729071
Epoch 44, Train Loss 0.434443, Valid_loss 0.689574
Epoch 45, Train Loss 0.370167, Valid_loss 0.665601
Epoch 46, Train Loss 0.398036, Valid_loss 0.692363
Epoch 47, Train Loss 0.351828, Valid_loss 0.722130
Epoch 48, Train Loss 0.413416, Valid_loss 0.688041
Epoch 49, Train Loss 0.414658, Valid_loss 0.697445
Epoch 50, Train Loss 0.460661, Valid_loss 0.764075
Epoch 51, Train Loss 0.406684, Valid_loss 0.685086
Epoch 52, Train Loss 0.374999, Valid_loss 0.722550
Epoch 53, Train Loss 0.378570, Valid_loss 0.717741
Epoch 54, Train Loss 0.358837, Valid_loss 0.719592
Epoch 55, Train Loss 0.365394, Valid_loss 0.687608
Epoch 56, Train Loss 0.346327, Valid_loss 0.687964
Epoch 57, Train Loss 0.355605, Valid_loss 0.715731
[I 2025-08-30 17:23:59,231] Trial 0 finished with value: 0.6449125713358322 and parameters: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 2, 'dropout': 0.7, 'weight_decay': 0.01, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.6449125713358322.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 19.85 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.922039, Valid_loss 1.283970
Epoch 2, Train Loss 0.648224, Valid_loss 0.922392
Epoch 3, Train Loss 0.542178, Valid_loss 0.720118
Epoch 4, Train Loss 0.469695, Valid_loss 0.841906
Epoch 5, Train Loss 0.501929, Valid_loss 0.822237
Epoch 6, Train Loss 0.458122, Valid_loss 0.800233
Epoch 7, Train Loss 0.411865, Valid_loss 0.721110
Epoch 8, Train Loss 0.380725, Valid_loss 0.770348
Epoch 9, Train Loss 0.410564, Valid_loss 0.696398
Epoch 10, Train Loss 0.356400, Valid_loss 0.711439
Epoch 11, Train Loss 0.361188, Valid_loss 0.686685
Epoch 12, Train Loss 0.312248, Valid_loss 0.660949
Epoch 13, Train Loss 0.289801, Valid_loss 0.690231
Epoch 14, Train Loss 0.274508, Valid_loss 0.648893
Epoch 15, Train Loss 0.337169, Valid_loss 0.576090
Epoch 16, Train Loss 0.284019, Valid_loss 0.479827
Epoch 17, Train Loss 0.298349, Valid_loss 0.572760
Epoch 18, Train Loss 0.315506, Valid_loss 0.664210
Epoch 19, Train Loss 0.303178, Valid_loss 0.710354
Epoch 20, Train Loss 0.278793, Valid_loss 0.679339
Epoch 21, Train Loss 0.241789, Valid_loss 0.574342
Epoch 22, Train Loss 0.243753, Valid_loss 0.591000
Epoch 23, Train Loss 0.197844, Valid_loss 0.924561
Epoch 24, Train Loss 0.220727, Valid_loss 0.706609
Epoch 25, Train Loss 0.303903, Valid_loss 1.083855
Epoch 26, Train Loss 0.217294, Valid_loss 0.780894
Epoch 27, Train Loss 0.190470, Valid_loss 0.629552
Epoch 28, Train Loss 0.255736, Valid_loss 0.683505
Epoch 29, Train Loss 0.209530, Valid_loss 0.686384
Epoch 30, Train Loss 0.200441, Valid_loss 0.619615
Epoch 31, Train Loss 0.170900, Valid_loss 0.661702
Epoch 32, Train Loss 0.187330, Valid_loss 0.554221
Epoch 33, Train Loss 0.166213, Valid_loss 0.644700
Epoch 34, Train Loss 0.187502, Valid_loss 0.777501
Epoch 35, Train Loss 0.212093, Valid_loss 0.649046
Epoch 36, Train Loss 0.154292, Valid_loss 0.459112
Epoch 37, Train Loss 0.244589, Valid_loss 0.858975
Epoch 38, Train Loss 0.190369, Valid_loss 0.481441
Epoch 39, Train Loss 0.159387, Valid_loss 0.759641
Epoch 40, Train Loss 0.179362, Valid_loss 0.712320
Epoch 41, Train Loss 0.333290, Valid_loss 0.626356
Epoch 42, Train Loss 0.191386, Valid_loss 0.822911
Epoch 43, Train Loss 0.279286, Valid_loss 0.660006
Epoch 44, Train Loss 0.171482, Valid_loss 0.863331
Epoch 45, Train Loss 0.152847, Valid_loss 0.586297
Epoch 46, Train Loss 0.153401, Valid_loss 0.711659
Epoch 47, Train Loss 0.129907, Valid_loss 0.753212
Epoch 48, Train Loss 0.182708, Valid_loss 0.779470
Epoch 49, Train Loss 0.168025, Valid_loss 0.660222
Epoch 50, Train Loss 0.169404, Valid_loss 0.741076
Epoch 51, Train Loss 0.135981, Valid_loss 0.792498
Epoch 52, Train Loss 0.154962, Valid_loss 0.758328
Epoch 53, Train Loss 0.132223, Valid_loss 0.739214
Epoch 54, Train Loss 0.123541, Valid_loss 0.723037
Epoch 55, Train Loss 0.132993, Valid_loss 0.776195
Epoch 56, Train Loss 0.137015, Valid_loss 0.683170
Epoch 57, Train Loss 0.129365, Valid_loss 0.788472
Epoch 58, Train Loss 0.119507, Valid_loss 0.766736
Epoch 59, Train Loss 0.121259, Valid_loss 0.798861
Epoch 60, Train Loss 0.120377, Valid_loss 0.685918
Epoch 61, Train Loss 0.114301, Valid_loss 0.785002
Epoch 62, Train Loss 0.116963, Valid_loss 0.755274
Epoch 63, Train Loss 0.131310, Valid_loss 0.751474
Epoch 64, Train Loss 0.132438, Valid_loss 0.901601
Epoch 65, Train Loss 0.099388, Valid_loss 0.892243
Epoch 66, Train Loss 0.105774, Valid_loss 0.888305
Epoch 67, Train Loss 0.108349, Valid_loss 0.868404
Epoch 68, Train Loss 0.113092, Valid_loss 0.805165
Epoch 69, Train Loss 0.114647, Valid_loss 0.791976
Epoch 70, Train Loss 0.106729, Valid_loss 0.797653
Epoch 71, Train Loss 0.090718, Valid_loss 0.824599
[I 2025-08-30 18:04:54,375] Trial 1 finished with value: 0.4591117612241457 and parameters: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 2, 'dropout': 0.3, 'weight_decay': 0.01, 'emb_dim': 64, 'augment_num': 100, 'pca': False}. Best is trial 1 with value: 0.4591117612241457.
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=0, batch_size=1 -> steps=0
Memory Allocated: 19.85 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 1.036964, Valid_loss 1.895969
Epoch 2, Train Loss 0.985675, Valid_loss 1.279263
Epoch 3, Train Loss 0.946837, Valid_loss 1.853979
Epoch 4, Train Loss 0.948078, Valid_loss 1.635880
Epoch 5, Train Loss 0.942929, Valid_loss 1.302888
Epoch 6, Train Loss 0.928738, Valid_loss 1.184979
Epoch 7, Train Loss 0.898959, Valid_loss 1.723332
Epoch 8, Train Loss 0.940096, Valid_loss 1.300827
Epoch 9, Train Loss 0.900620, Valid_loss 1.310928
Epoch 10, Train Loss 0.903152, Valid_loss 1.235108
Epoch 11, Train Loss 0.926665, Valid_loss 1.285488
Epoch 12, Train Loss 0.910920, Valid_loss 1.411115
Epoch 13, Train Loss 0.918223, Valid_loss 1.256797
Epoch 14, Train Loss 0.903618, Valid_loss 1.227341
Epoch 15, Train Loss 0.928880, Valid_loss 1.228137
Epoch 16, Train Loss 0.904904, Valid_loss 1.639961
Epoch 17, Train Loss 0.921690, Valid_loss 1.367448
Epoch 18, Train Loss 0.920280, Valid_loss 1.251226
Epoch 19, Train Loss 0.903724, Valid_loss 1.298903
Epoch 20, Train Loss 0.901280, Valid_loss 1.298158
Epoch 21, Train Loss 0.898953, Valid_loss 1.405336
Epoch 22, Train Loss 0.909464, Valid_loss 1.570662
Epoch 23, Train Loss 0.911468, Valid_loss 1.356935
Epoch 24, Train Loss 0.911866, Valid_loss 1.302346
Epoch 25, Train Loss 0.906991, Valid_loss 1.345056
Epoch 26, Train Loss 0.905577, Valid_loss 1.329275
Epoch 27, Train Loss 0.905779, Valid_loss 1.326562
Epoch 28, Train Loss 0.899557, Valid_loss 1.333936
Epoch 29, Train Loss 0.895901, Valid_loss 1.470942
Epoch 30, Train Loss 0.921144, Valid_loss 1.337574
Epoch 31, Train Loss 0.898343, Valid_loss 1.328501
Epoch 32, Train Loss 0.904937, Valid_loss 1.349649
Epoch 33, Train Loss 0.901321, Valid_loss 1.346414
Epoch 34, Train Loss 0.900890, Valid_loss 1.352096
Epoch 35, Train Loss 0.908407, Valid_loss 1.378975
Epoch 36, Train Loss 0.906449, Valid_loss 1.346647
Epoch 37, Train Loss 0.902546, Valid_loss 1.348442
Epoch 38, Train Loss 0.899461, Valid_loss 1.337284
Epoch 39, Train Loss 0.901887, Valid_loss 1.343591
Epoch 40, Train Loss 0.904714, Valid_loss 1.336518
Epoch 41, Train Loss 0.902240, Valid_loss 1.351920
Epoch 42, Train Loss 0.903303, Valid_loss 1.363013
Epoch 43, Train Loss 0.901516, Valid_loss 1.324212
Epoch 44, Train Loss 0.905771, Valid_loss 1.311640
Epoch 45, Train Loss 0.909302, Valid_loss 1.338390
Epoch 46, Train Loss 0.902157, Valid_loss 1.343868
Epoch 47, Train Loss 0.902316, Valid_loss 1.354526
Epoch 48, Train Loss 0.901750, Valid_loss 1.357406
Epoch 49, Train Loss 0.902105, Valid_loss 1.366437
Epoch 50, Train Loss 0.901151, Valid_loss 1.358458
Epoch 51, Train Loss 0.899462, Valid_loss 1.367165
Epoch 52, Train Loss 0.898887, Valid_loss 1.359864
Epoch 53, Train Loss 0.900249, Valid_loss 1.366034
Epoch 54, Train Loss 0.899075, Valid_loss 1.362800
Epoch 55, Train Loss 0.901001, Valid_loss 1.367862
Epoch 56, Train Loss 0.899443, Valid_loss 1.370385
[I 2025-08-30 18:37:01,627] Trial 2 finished with value: 1.1849787731965382 and parameters: {'learning_rate': 0.01, 'epochs': 100, 'heads': 2, 'dropout': 0.3, 'weight_decay': 0.0001, 'emb_dim': 64, 'augment_num': 100, 'pca': False}. Best is trial 1 with value: 0.4591117612241457.
선택된 trial params: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 2, 'dropout': 0.3, 'weight_decay': 0.01, 'emb_dim': 64, 'augment_num': 100, 'pca': False}
👉 train samples(학습 샘플(bag))=122, batch_size=1 -> steps(샘플수/batch크기)=122
👉 valid samples=12, batch_size=1 -> steps=12
👉 test  samples=8, batch_size=1 -> steps=8
Memory Allocated: 19.85 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.914171, Valid_loss 1.147618
Epoch 2, Train Loss 0.693371, Valid_loss 1.054142
Epoch 3, Train Loss 0.516217, Valid_loss 0.904677
Epoch 4, Train Loss 0.465357, Valid_loss 0.744695
Epoch 5, Train Loss 0.494899, Valid_loss 0.830391
Epoch 6, Train Loss 0.406753, Valid_loss 0.755044
Epoch 7, Train Loss 0.422329, Valid_loss 0.815180
Epoch 8, Train Loss 0.411363, Valid_loss 0.663877
Epoch 9, Train Loss 0.347865, Valid_loss 0.705289
Epoch 10, Train Loss 0.313097, Valid_loss 0.770891
Epoch 11, Train Loss 0.317967, Valid_loss 0.705842
Epoch 12, Train Loss 0.272698, Valid_loss 0.730623
Epoch 13, Train Loss 0.299873, Valid_loss 0.899567
Epoch 14, Train Loss 0.324340, Valid_loss 0.586420
Epoch 15, Train Loss 0.273073, Valid_loss 0.610345
Epoch 16, Train Loss 0.304906, Valid_loss 0.679730
Epoch 17, Train Loss 0.255747, Valid_loss 0.807207
Epoch 18, Train Loss 0.268766, Valid_loss 0.800435
Epoch 19, Train Loss 0.290130, Valid_loss 0.875029
Epoch 20, Train Loss 0.216230, Valid_loss 0.767748
Epoch 21, Train Loss 0.272917, Valid_loss 0.603210
Epoch 22, Train Loss 0.342685, Valid_loss 0.717608
Epoch 23, Train Loss 0.248398, Valid_loss 0.660216
Epoch 24, Train Loss 0.266797, Valid_loss 0.745282
Epoch 25, Train Loss 0.233562, Valid_loss 0.725041
Epoch 26, Train Loss 0.211199, Valid_loss 0.684010
Epoch 27, Train Loss 0.246598, Valid_loss 0.902867
Epoch 28, Train Loss 0.223328, Valid_loss 0.573775
Epoch 29, Train Loss 0.254304, Valid_loss 0.694510
Epoch 30, Train Loss 0.182968, Valid_loss 0.842979
Epoch 31, Train Loss 0.218004, Valid_loss 0.703038
Epoch 32, Train Loss 0.219074, Valid_loss 0.564560
Epoch 33, Train Loss 0.196907, Valid_loss 0.521311
Epoch 34, Train Loss 0.214529, Valid_loss 0.779220
Epoch 35, Train Loss 0.187180, Valid_loss 0.959137
Epoch 36, Train Loss 0.228902, Valid_loss 0.802841
Epoch 37, Train Loss 0.186051, Valid_loss 0.563595
Epoch 38, Train Loss 0.210261, Valid_loss 0.848003
Epoch 39, Train Loss 0.167435, Valid_loss 0.688588
Epoch 40, Train Loss 0.164594, Valid_loss 0.975374
Epoch 41, Train Loss 0.188377, Valid_loss 0.699643
Epoch 42, Train Loss 0.188420, Valid_loss 0.494557
Epoch 43, Train Loss 0.252373, Valid_loss 0.880226
Epoch 44, Train Loss 0.169082, Valid_loss 0.767603
Epoch 45, Train Loss 0.175432, Valid_loss 0.647033
Epoch 46, Train Loss 0.198521, Valid_loss 0.664815
Epoch 47, Train Loss 0.230863, Valid_loss 0.679475
Epoch 48, Train Loss 0.148057, Valid_loss 0.667139
Epoch 49, Train Loss 0.143129, Valid_loss 0.765119
Epoch 50, Train Loss 0.165581, Valid_loss 0.820214
Epoch 51, Train Loss 0.133335, Valid_loss 0.784219
Epoch 52, Train Loss 0.127242, Valid_loss 0.776668
Epoch 53, Train Loss 0.123810, Valid_loss 0.803910
Epoch 54, Train Loss 0.154736, Valid_loss 0.660340
Epoch 55, Train Loss 0.138269, Valid_loss 0.783276
Epoch 56, Train Loss 0.155542, Valid_loss 0.911785
환자ID=P1504 -- true: [[2]] -- pred: tensor([[-1.9618,  0.6672,  1.0786]], device='cuda:0')
환자ID=P1510 -- true: [[1]] -- pred: tensor([[-0.6933,  0.7710, -0.5474]], device='cuda:0')
환자ID=P1547 -- true: [[0]] -- pred: tensor([[ 3.0183, -2.0172, -2.9794]], device='cuda:0')
환자ID=P1549 -- true: [[0]] -- pred: tensor([[ 3.0621, -2.1675, -2.9433]], device='cuda:0')
환자ID=P1606 -- true: [[2]] -- pred: tensor([[-1.8534,  0.3262,  1.3115]], device='cuda:0')
환자ID=P1610 -- true: [[0]] -- pred: tensor([[ 3.0252, -2.0768, -2.9855]], device='cuda:0')
환자ID=P1631 -- true: [[1]] -- pred: tensor([[-1.7808,  1.6746, -0.1686]], device='cuda:0')
환자ID=P1722 -- true: [[1]] -- pred: tensor([[-1.8447,  1.1145,  0.4295]], device='cuda:0')
Best performance: Epoch 42, Loss 0.188420, Test ACC 1.000000, Test AUC 1.000000, Test Recall 1.000000, Test Precision 1.000000
Confusion Matrix:
 [[3 0 0]
 [0 3 0]
 [0 0 2]]
✅ Total valid splits used: 5

📌 Repeat 4: 평균 AUC = 0.8926, 표준편차 = 0.0735
Test ACC 평균 0.813889, Test Recall 평균 0.788889, Test Precision 평균 0.734444
fold_aucs = [0.888888888888889, 0.7962962962962963, 0.8333333333333334, 0.9444444444444443, 1.0]
NaN 개수: 0 / 전체 5개


================ 전체 Repeat 요약 ================
Repeat 0: AUC 0.8185 ± 0.1520 | ACC 0.6944 | Recall 0.6222 | Precision 0.5052 | NaN 0/5
Repeat 1: AUC 0.8759 ± 0.0763 | ACC 0.7639 | Recall 0.7333 | Precision 0.7167 | NaN 0/5
Repeat 2: AUC 0.8407 ± 0.0956 | ACC 0.6861 | Recall 0.6444 | Precision 0.5578 | NaN 0/5
Repeat 3: AUC 0.9222 ± 0.0567 | ACC 0.7000 | Recall 0.6667 | Precision 0.5767 | NaN 0/5
Repeat 4: AUC 0.8926 ± 0.0735 | ACC 0.8139 | Recall 0.7889 | Precision 0.7344 | NaN 0/5

🏁 최종 결과 (각 Repeat의 AUC 평균의 평균): 0.8700 ± 0.0368
