Namespace(seed=240, batch_size=16, learning_rate=0.003, weight_decay=0.0001, epochs=100, task='custom_covid', emb_dim=128, h_dim=128, dropout=0.3, layers=1, heads=8, train_sample_cells=500, test_sample_cells=500, train_num_sample=20, test_num_sample=100, model='Transformer', dataset='/data/project/kim89/0804_data', inter_only=False, same_pheno=0, augment_num=100, alpha=1.0, repeat=5, all=1, min_size=6000, n_splits=5, pca=False, mix_type=1, norm_first=False, warmup=False, top_k=1, cell_type_annotation='manual_annotation')
🔁 Repeat 0, Fold 0
cell type :  CATTAAGGATAT_COVID19_Participant13    Developing Ciliated Cells
GTAGAAGGGGGG_COVID19_Participant13    Developing Ciliated Cells
ATTAAGAGGTAG_COVID19_Participant13    Developing Ciliated Cells
AGATATGACAAG_COVID19_Participant13    Developing Ciliated Cells
CTTGTAACAAAT_COVID19_Participant13               Squamous Cells
                                                ...            
CAGGTTGGTATC_COVID19_Participant20              Secretory Cells
TATAGCTTGGTA_COVID19_Participant20              Secretory Cells
TTGTTAGACGGT_COVID19_Participant20                      T Cells
ATGGCTCAGGCT_COVID19_Participant20              Secretory Cells
ACATGATCCTTT_COVID19_Participant20              Secretory Cells
Name: manual_annotation, Length: 22137, dtype: string
cell type annotation :  CATTAAGGATAT_COVID19_Participant13    Developing Ciliated Cells
GTAGAAGGGGGG_COVID19_Participant13    Developing Ciliated Cells
ATTAAGAGGTAG_COVID19_Participant13    Developing Ciliated Cells
AGATATGACAAG_COVID19_Participant13    Developing Ciliated Cells
CTTGTAACAAAT_COVID19_Participant13               Squamous Cells
                                                ...            
CAGGTTGGTATC_COVID19_Participant20              Secretory Cells
TATAGCTTGGTA_COVID19_Participant20              Secretory Cells
TTGTTAGACGGT_COVID19_Participant20                      T Cells
ATGGCTCAGGCT_COVID19_Participant20              Secretory Cells
ACATGATCCTTT_COVID19_Participant20              Secretory Cells
Name: manual_annotation, Length: 22137, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Developing Ciliated Cells', 'Squamous Cells', 'Secretory Cells', 'Macrophages', 'B Cells', 'Ciliated Cells', 'T Cells', 'Dendritic Cells', 'Goblet Cells', 'Deuterosomal Cells', 'Basal Cells', 'Ionocytes', 'Mitotic Basal Cells', 'Developing Secretory and Goblet Cells', 'Plasmacytoid DCs', 'Enteroendocrine Cells', 'Erythroblasts', 'Mast Cells']
라벨별 그룹 개수 {1: 28, 0: 12}
cell type :  GTCGGGGGGTGG_Control_Participant7     Developing Ciliated Cells
CAAATCAATTAT_Control_Participant7     Developing Ciliated Cells
ATACAATTGACA_Control_Participant7     Developing Ciliated Cells
CTGTTAATGAGA_Control_Participant7     Developing Ciliated Cells
CTTCACATTATT_Control_Participant7     Developing Ciliated Cells
                                                ...            
GCAGGGAACTCC_COVID19_Participant30               Squamous Cells
CAGCACCGAGCC_COVID19_Participant30               Squamous Cells
GCCCCTTGTGAT_COVID19_Participant30               Squamous Cells
GTGTTGTGTGTC_COVID19_Participant30               Squamous Cells
TAACACTCACTT_COVID19_Participant30               Squamous Cells
Name: manual_annotation, Length: 4810, dtype: string
cell type annotation :  GTCGGGGGGTGG_Control_Participant7     Developing Ciliated Cells
CAAATCAATTAT_Control_Participant7     Developing Ciliated Cells
ATACAATTGACA_Control_Participant7     Developing Ciliated Cells
CTGTTAATGAGA_Control_Participant7     Developing Ciliated Cells
CTTCACATTATT_Control_Participant7     Developing Ciliated Cells
                                                ...            
GCAGGGAACTCC_COVID19_Participant30               Squamous Cells
CAGCACCGAGCC_COVID19_Participant30               Squamous Cells
GCCCCTTGTGAT_COVID19_Participant30               Squamous Cells
GTGTTGTGTGTC_COVID19_Participant30               Squamous Cells
TAACACTCACTT_COVID19_Participant30               Squamous Cells
Name: manual_annotation, Length: 4810, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Developing Ciliated Cells', 'Ciliated Cells', 'Secretory Cells', 'Squamous Cells', 'Goblet Cells', 'T Cells', 'Dendritic Cells', 'Basal Cells', 'Deuterosomal Cells', 'Mitotic Basal Cells', 'Ionocytes', 'Macrophages', 'Enteroendocrine Cells', 'B Cells', 'Developing Secretory and Goblet Cells', 'Plasmacytoid DCs']
라벨별 그룹 개수 {1: 7, 0: 3}
🔍 Split #1
  → train_p_index 환자 수 (환자 단위로 묶인 index list): 40
  → test_p_index 환자 수  (환자 단위로 묶인 index list): 10
  → train 환자 ID: ['COVID19_Participant10', 'COVID19_Participant12', 'COVID19_Participant13', 'COVID19_Participant14', 'COVID19_Participant15', 'COVID19_Participant17', 'COVID19_Participant19', 'COVID19_Participant2', 'COVID19_Participant20', 'COVID19_Participant21', 'COVID19_Participant22', 'COVID19_Participant23', 'COVID19_Participant26', 'COVID19_Participant27', 'COVID19_Participant29', 'COVID19_Participant3', 'COVID19_Participant31', 'COVID19_Participant32', 'COVID19_Participant35', 'COVID19_Participant36', 'COVID19_Participant37', 'COVID19_Participant38', 'COVID19_Participant4', 'COVID19_Participant40', 'COVID19_Participant5', 'COVID19_Participant6', 'COVID19_Participant7', 'COVID19_Participant9', 'Control_Participant1', 'Control_Participant10', 'Control_Participant11', 'Control_Participant12', 'Control_Participant13', 'Control_Participant15', 'Control_Participant2', 'Control_Participant3', 'Control_Participant4', 'Control_Participant5', 'Control_Participant6', 'Control_Participant8']
  → test  환자 ID: ['COVID19_Participant11', 'COVID19_Participant18', 'COVID19_Participant25', 'COVID19_Participant28', 'COVID19_Participant30', 'COVID19_Participant39', 'COVID19_Participant8', 'Control_Participant14', 'Control_Participant7', 'Control_Participant9']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant10, Label: 1
    ID: COVID19_Participant12, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant21, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant27, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant3, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant35, Label: 1
    ID: COVID19_Participant36, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant38, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: COVID19_Participant5, Label: 1
    ID: COVID19_Participant6, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: COVID19_Participant9, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant10, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant12, Label: 0
    ID: Control_Participant13, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant2, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant4, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant6, Label: 0
    ID: Control_Participant8, Label: 0
  → test 환자 ID 및 라벨:
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant18, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant30, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: Control_Participant14, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant9, Label: 0
전체 데이터 index 길이 50
label_stat (train 환자 라벨 목록) 갯수 40
train_data에서 환자 단위로, train과 validation 나누기
기존 train_p_index 40
기존 (train) label_stat 40
train-vali 분할 후! 
train y 의 classes : {0, 1} valid y 의 classes : {0, 1} label_stat 의 classes : {0, 1}
train_p_index_ 26
valid_p_index 14
test_p_index 10
→ train 환자 ID 및 라벨:
   총 개수: 26
   환자ID=Control_Participant10, Label=0, 셀개수=1645
   환자ID=Control_Participant15, Label=0, 셀개수=528
   환자ID=COVID19_Participant19, Label=1, 셀개수=816
   환자ID=COVID19_Participant38, Label=1, 셀개수=51
   환자ID=COVID19_Participant10, Label=1, 셀개수=18
   환자ID=Control_Participant4, Label=0, 셀개수=440
   환자ID=COVID19_Participant14, Label=1, 셀개수=382
   환자ID=COVID19_Participant2, Label=1, 셀개수=329
   환자ID=COVID19_Participant40, Label=1, 셀개수=381
   환자ID=COVID19_Participant13, Label=1, 셀개수=730
   환자ID=COVID19_Participant20, Label=1, 셀개수=2033
   환자ID=Control_Participant2, Label=0, 셀개수=41
   환자ID=COVID19_Participant27, Label=1, 셀개수=93
   환자ID=Control_Participant6, Label=0, 셀개수=131
   환자ID=Control_Participant5, Label=0, 셀개수=717
   환자ID=COVID19_Participant15, Label=1, 셀개수=1003
   환자ID=Control_Participant8, Label=0, 셀개수=393
   환자ID=Control_Participant11, Label=0, 셀개수=1164
   환자ID=COVID19_Participant22, Label=1, 셀개수=865
   환자ID=COVID19_Participant31, Label=1, 셀개수=410
   환자ID=COVID19_Participant26, Label=1, 셀개수=814
   환자ID=COVID19_Participant17, Label=1, 셀개수=843
   환자ID=COVID19_Participant6, Label=1, 셀개수=84
   환자ID=COVID19_Participant4, Label=1, 셀개수=1680
   환자ID=COVID19_Participant37, Label=1, 셀개수=668
   환자ID=COVID19_Participant3, Label=1, 셀개수=104
→ valid 환자 ID 및 라벨:
   총 개수: 14
   환자ID=Control_Participant13, Label=0, 셀개수=88
   환자ID=COVID19_Participant29, Label=1, 셀개수=573
   환자ID=COVID19_Participant35, Label=1, 셀개수=83
   환자ID=COVID19_Participant32, Label=1, 셀개수=1665
   환자ID=COVID19_Participant5, Label=1, 셀개수=89
   환자ID=COVID19_Participant21, Label=1, 셀개수=39
   환자ID=Control_Participant3, Label=0, 셀개수=1620
   환자ID=Control_Participant1, Label=0, 셀개수=414
   환자ID=COVID19_Participant9, Label=1, 셀개수=86
   환자ID=COVID19_Participant7, Label=1, 셀개수=409
   환자ID=Control_Participant12, Label=0, 셀개수=99
   환자ID=COVID19_Participant36, Label=1, 셀개수=200
   환자ID=COVID19_Participant12, Label=1, 셀개수=102
   환자ID=COVID19_Participant23, Label=1, 셀개수=307
→ test 환자 ID 및 라벨:
   총 개수: 10
   환자ID=COVID19_Participant11, Label=1, 셀개수=382
   환자ID=COVID19_Participant18, Label=1, 셀개수=227
   환자ID=COVID19_Participant25, Label=1, 셀개수=496
   환자ID=COVID19_Participant28, Label=1, 셀개수=1079
   환자ID=COVID19_Participant30, Label=1, 셀개수=116
   환자ID=COVID19_Participant39, Label=1, 셀개수=454
   환자ID=COVID19_Participant8, Label=1, 셀개수=462
   환자ID=Control_Participant14, Label=0, 셀개수=274
   환자ID=Control_Participant7, Label=0, 셀개수=762
   환자ID=Control_Participant9, Label=0, 셀개수=558
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Squamous Cells', 'Secretory Cells', 'Macrophages', 'Developing Ciliated Cells', 'B Cells', 'Ciliated Cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
전체 데이터 길이 26947
전체 cell type 길이 0        Developing Ciliated Cells
1        Developing Ciliated Cells
2        Developing Ciliated Cells
3        Developing Ciliated Cells
4                   Squamous Cells
                   ...            
26942               Squamous Cells
26943               Squamous Cells
26944               Squamous Cells
26945               Squamous Cells
26946               Squamous Cells
Length: 26947, dtype: string
cell type의 NaN 개수 체크 0
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:14,  6.97it/s]  2%|▏         | 2/100 [00:00<00:17,  5.46it/s]  3%|▎         | 3/100 [00:00<00:15,  6.25it/s]  4%|▍         | 4/100 [00:00<00:13,  7.13it/s]  5%|▌         | 5/100 [00:00<00:12,  7.75it/s]  6%|▌         | 6/100 [00:00<00:11,  8.17it/s]  7%|▋         | 7/100 [00:00<00:10,  8.48it/s]  8%|▊         | 8/100 [00:01<00:14,  6.53it/s]  9%|▉         | 9/100 [00:01<00:13,  6.80it/s] 10%|█         | 10/100 [00:01<00:12,  7.45it/s] 11%|█         | 11/100 [00:01<00:11,  7.99it/s] 12%|█▏        | 12/100 [00:01<00:15,  5.70it/s] 13%|█▎        | 13/100 [00:01<00:14,  6.12it/s] 14%|█▍        | 14/100 [00:02<00:17,  4.83it/s] 15%|█▌        | 15/100 [00:02<00:15,  5.59it/s] 16%|█▌        | 16/100 [00:02<00:14,  5.91it/s] 17%|█▋        | 17/100 [00:02<00:12,  6.56it/s] 18%|█▊        | 18/100 [00:02<00:11,  7.20it/s] 19%|█▉        | 19/100 [00:02<00:10,  7.45it/s] 20%|██        | 20/100 [00:02<00:10,  7.80it/s] 21%|██        | 21/100 [00:03<00:09,  8.13it/s] 23%|██▎       | 23/100 [00:03<00:09,  7.94it/s] 24%|██▍       | 24/100 [00:03<00:09,  8.34it/s] 26%|██▌       | 26/100 [00:03<00:08,  8.91it/s] 27%|██▋       | 27/100 [00:03<00:08,  8.74it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.42it/s] 29%|██▉       | 29/100 [00:03<00:08,  8.67it/s] 30%|███       | 30/100 [00:04<00:07,  8.84it/s] 31%|███       | 31/100 [00:04<00:08,  8.51it/s] 32%|███▏      | 32/100 [00:04<00:07,  8.72it/s] 33%|███▎      | 33/100 [00:04<00:07,  8.96it/s] 34%|███▍      | 34/100 [00:04<00:07,  8.88it/s] 36%|███▌      | 36/100 [00:04<00:06,  9.19it/s] 37%|███▋      | 37/100 [00:04<00:06,  9.19it/s] 38%|███▊      | 38/100 [00:05<00:07,  8.26it/s] 39%|███▉      | 39/100 [00:05<00:07,  8.50it/s] 40%|████      | 40/100 [00:05<00:07,  8.01it/s] 41%|████      | 41/100 [00:05<00:07,  8.38it/s] 43%|████▎     | 43/100 [00:05<00:06,  8.55it/s] 44%|████▍     | 44/100 [00:05<00:06,  8.29it/s] 45%|████▌     | 45/100 [00:05<00:07,  7.24it/s] 46%|████▌     | 46/100 [00:06<00:07,  7.54it/s] 47%|████▋     | 47/100 [00:06<00:07,  7.57it/s] 48%|████▊     | 48/100 [00:06<00:06,  7.85it/s] 49%|████▉     | 49/100 [00:06<00:10,  4.95it/s] 50%|█████     | 50/100 [00:06<00:09,  5.23it/s] 51%|█████     | 51/100 [00:07<00:11,  4.44it/s] 52%|█████▏    | 52/100 [00:07<00:09,  5.24it/s] 53%|█████▎    | 53/100 [00:07<00:10,  4.34it/s] 54%|█████▍    | 54/100 [00:07<00:08,  5.14it/s] 55%|█████▌    | 55/100 [00:07<00:07,  5.71it/s] 57%|█████▋    | 57/100 [00:08<00:06,  7.04it/s] 58%|█████▊    | 58/100 [00:08<00:05,  7.52it/s] 59%|█████▉    | 59/100 [00:08<00:05,  7.90it/s] 61%|██████    | 61/100 [00:08<00:05,  7.21it/s] 63%|██████▎   | 63/100 [00:08<00:04,  8.12it/s] 64%|██████▍   | 64/100 [00:08<00:04,  8.25it/s] 65%|██████▌   | 65/100 [00:09<00:05,  6.66it/s] 66%|██████▌   | 66/100 [00:09<00:05,  6.34it/s] 67%|██████▋   | 67/100 [00:09<00:04,  6.84it/s] 68%|██████▊   | 68/100 [00:09<00:04,  7.09it/s] 69%|██████▉   | 69/100 [00:09<00:05,  5.73it/s] 70%|███████   | 70/100 [00:10<00:07,  4.13it/s] 71%|███████   | 71/100 [00:10<00:06,  4.66it/s] 72%|███████▏  | 72/100 [00:10<00:05,  5.41it/s] 73%|███████▎  | 73/100 [00:10<00:04,  6.00it/s] 74%|███████▍  | 74/100 [00:10<00:03,  6.62it/s] 76%|███████▌  | 76/100 [00:10<00:03,  7.73it/s] 77%|███████▋  | 77/100 [00:11<00:02,  7.79it/s] 78%|███████▊  | 78/100 [00:11<00:02,  7.95it/s] 79%|███████▉  | 79/100 [00:11<00:02,  7.95it/s] 81%|████████  | 81/100 [00:11<00:02,  8.76it/s] 82%|████████▏ | 82/100 [00:11<00:02,  8.76it/s] 83%|████████▎ | 83/100 [00:11<00:01,  8.65it/s] 84%|████████▍ | 84/100 [00:11<00:01,  8.48it/s] 85%|████████▌ | 85/100 [00:11<00:01,  8.66it/s] 86%|████████▌ | 86/100 [00:12<00:01,  8.72it/s] 87%|████████▋ | 87/100 [00:12<00:01,  6.75it/s] 88%|████████▊ | 88/100 [00:12<00:01,  7.16it/s] 89%|████████▉ | 89/100 [00:12<00:01,  7.62it/s] 90%|█████████ | 90/100 [00:12<00:01,  7.23it/s] 91%|█████████ | 91/100 [00:12<00:01,  7.63it/s] 92%|█████████▏| 92/100 [00:12<00:01,  7.81it/s] 93%|█████████▎| 93/100 [00:13<00:00,  7.90it/s] 94%|█████████▍| 94/100 [00:13<00:00,  8.35it/s] 95%|█████████▌| 95/100 [00:13<00:00,  8.73it/s] 96%|█████████▌| 96/100 [00:13<00:00,  4.56it/s] 97%|█████████▋| 97/100 [00:13<00:00,  5.43it/s] 98%|█████████▊| 98/100 [00:13<00:00,  6.25it/s]100%|██████████| 100/100 [00:14<00:00,  7.15it/s]100%|██████████| 100/100 [00:14<00:00,  7.08it/s]
[I 2025-08-30 03:59:06,298] A new study created in memory with name: no-name-68e68845-f198-4e90-9bfa-aa351eea1618
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 3.60 MB
Memory Reserved: 22.00 MB
cuda
Epoch 1, Train Loss 0.586258, Valid_loss 0.568736
Epoch 2, Train Loss 0.459595, Valid_loss 0.516642
Epoch 3, Train Loss 0.346995, Valid_loss 0.549044
Epoch 4, Train Loss 0.308863, Valid_loss 0.546354
Epoch 5, Train Loss 0.299550, Valid_loss 0.498310
Epoch 6, Train Loss 0.281872, Valid_loss 0.485138
Epoch 7, Train Loss 0.271798, Valid_loss 0.465816
Epoch 8, Train Loss 0.266990, Valid_loss 0.477965
Epoch 9, Train Loss 0.256401, Valid_loss 0.490173
Epoch 10, Train Loss 0.256775, Valid_loss 0.564141
Epoch 11, Train Loss 0.288953, Valid_loss 0.529137
Epoch 12, Train Loss 0.257925, Valid_loss 0.477930
Epoch 13, Train Loss 0.243307, Valid_loss 0.473477
Epoch 14, Train Loss 0.232807, Valid_loss 0.504506
Epoch 15, Train Loss 0.232695, Valid_loss 0.492334
Epoch 16, Train Loss 0.227694, Valid_loss 0.504873
Epoch 17, Train Loss 0.220264, Valid_loss 0.517656
Epoch 18, Train Loss 0.222573, Valid_loss 0.510973
Epoch 19, Train Loss 0.220206, Valid_loss 0.558726
Epoch 20, Train Loss 0.214990, Valid_loss 0.520389
Epoch 21, Train Loss 0.219778, Valid_loss 0.524354
Epoch 22, Train Loss 0.212552, Valid_loss 0.556773
Epoch 23, Train Loss 0.212675, Valid_loss 0.539865
Epoch 24, Train Loss 0.209701, Valid_loss 0.645128
Epoch 25, Train Loss 0.210445, Valid_loss 0.607314
Epoch 26, Train Loss 0.203207, Valid_loss 0.555264
Epoch 27, Train Loss 0.209604, Valid_loss 0.612205
Epoch 28, Train Loss 0.216440, Valid_loss 0.568302
Epoch 29, Train Loss 0.209079, Valid_loss 0.684960
Epoch 30, Train Loss 0.204493, Valid_loss 0.557671
Epoch 31, Train Loss 0.198253, Valid_loss 0.625684
Epoch 32, Train Loss 0.196745, Valid_loss 0.649806
Epoch 33, Train Loss 0.201454, Valid_loss 0.585482
Epoch 34, Train Loss 0.196411, Valid_loss 0.614481
Epoch 35, Train Loss 0.198181, Valid_loss 0.594773
Epoch 36, Train Loss 0.192556, Valid_loss 0.632574
Epoch 37, Train Loss 0.195921, Valid_loss 0.665547
Epoch 38, Train Loss 0.198072, Valid_loss 0.637174
Epoch 39, Train Loss 0.204559, Valid_loss 0.531526
Epoch 40, Train Loss 0.210276, Valid_loss 0.558522
Epoch 41, Train Loss 0.199983, Valid_loss 0.663334
Epoch 42, Train Loss 0.199098, Valid_loss 0.669654
Epoch 43, Train Loss 0.195754, Valid_loss 0.573670
Epoch 44, Train Loss 0.190736, Valid_loss 0.696264
Epoch 45, Train Loss 0.190530, Valid_loss 0.612721
Epoch 46, Train Loss 0.194120, Valid_loss 0.726470
Epoch 47, Train Loss 0.189681, Valid_loss 0.633135
Epoch 48, Train Loss 0.192095, Valid_loss 0.569444
Epoch 49, Train Loss 0.196418, Valid_loss 0.618162
Epoch 50, Train Loss 0.188414, Valid_loss 0.694221
Epoch 51, Train Loss 0.185748, Valid_loss 0.773301
Epoch 52, Train Loss 0.190729, Valid_loss 0.714875
Epoch 53, Train Loss 0.185561, Valid_loss 0.784378
Epoch 54, Train Loss 0.187791, Valid_loss 0.816069
[I 2025-08-30 04:03:15,654] Trial 0 finished with value: 0.4658162992979799 and parameters: {'learning_rate': 0.001, 'epochs': 100, 'heads': 4, 'dropout': 0.0, 'weight_decay': 0.001, 'emb_dim': 64, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.4658162992979799.
👉 train samples(학습 샘플(bag))=126, batch_size=16 -> steps(샘플수/batch크기)=8
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 26.13 MB
Memory Reserved: 46.00 MB
cuda
Epoch 1, Train Loss 0.610749, Valid_loss 0.586171
Epoch 2, Train Loss 0.620710, Valid_loss 0.570729
Epoch 3, Train Loss 0.577095, Valid_loss 0.557957
Epoch 4, Train Loss 0.581453, Valid_loss 0.547963
Epoch 5, Train Loss 0.549875, Valid_loss 0.535654
Epoch 6, Train Loss 0.546467, Valid_loss 0.525177
Epoch 7, Train Loss 0.521963, Valid_loss 0.515683
Epoch 8, Train Loss 0.507638, Valid_loss 0.508035
Epoch 9, Train Loss 0.490225, Valid_loss 0.508627
Epoch 10, Train Loss 0.516729, Valid_loss 0.498677
Epoch 11, Train Loss 0.499985, Valid_loss 0.497922
Epoch 12, Train Loss 0.450532, Valid_loss 0.492703
Epoch 13, Train Loss 0.432858, Valid_loss 0.502417
Epoch 14, Train Loss 0.431624, Valid_loss 0.507195
Epoch 15, Train Loss 0.462538, Valid_loss 0.498215
Epoch 16, Train Loss 0.416139, Valid_loss 0.501947
Epoch 17, Train Loss 0.395917, Valid_loss 0.510693
Epoch 18, Train Loss 0.418170, Valid_loss 0.502703
Epoch 19, Train Loss 0.406446, Valid_loss 0.501884
Epoch 20, Train Loss 0.405314, Valid_loss 0.506756
Epoch 21, Train Loss 0.403274, Valid_loss 0.507021
Epoch 22, Train Loss 0.422826, Valid_loss 0.501125
Epoch 23, Train Loss 0.395426, Valid_loss 0.515039
Epoch 24, Train Loss 0.403520, Valid_loss 0.503914
Epoch 25, Train Loss 0.376263, Valid_loss 0.503907
Epoch 26, Train Loss 0.379520, Valid_loss 0.511527
Epoch 27, Train Loss 0.400868, Valid_loss 0.501255
Epoch 28, Train Loss 0.374770, Valid_loss 0.507782
Epoch 29, Train Loss 0.394367, Valid_loss 0.502569
Epoch 30, Train Loss 0.388079, Valid_loss 0.503241
Epoch 31, Train Loss 0.364501, Valid_loss 0.501922
Epoch 32, Train Loss 0.384500, Valid_loss 0.505189
Epoch 33, Train Loss 0.365628, Valid_loss 0.498007
Epoch 34, Train Loss 0.369564, Valid_loss 0.499972
Epoch 35, Train Loss 0.381543, Valid_loss 0.506080
Epoch 36, Train Loss 0.390437, Valid_loss 0.504988
Epoch 37, Train Loss 0.359709, Valid_loss 0.505833
Epoch 38, Train Loss 0.357089, Valid_loss 0.512114
Epoch 39, Train Loss 0.385076, Valid_loss 0.503608
Epoch 40, Train Loss 0.380826, Valid_loss 0.500830
Epoch 41, Train Loss 0.366485, Valid_loss 0.495244
Epoch 42, Train Loss 0.369743, Valid_loss 0.489994
Epoch 43, Train Loss 0.371729, Valid_loss 0.495533
Epoch 44, Train Loss 0.380372, Valid_loss 0.498386
Epoch 45, Train Loss 0.360007, Valid_loss 0.494903
Epoch 46, Train Loss 0.367935, Valid_loss 0.496625
Epoch 47, Train Loss 0.358633, Valid_loss 0.499307
Epoch 48, Train Loss 0.368009, Valid_loss 0.502466
Epoch 49, Train Loss 0.376422, Valid_loss 0.502826
Epoch 50, Train Loss 0.358717, Valid_loss 0.493218
Epoch 51, Train Loss 0.350370, Valid_loss 0.495714
Epoch 52, Train Loss 0.375285, Valid_loss 0.492946
Epoch 53, Train Loss 0.358750, Valid_loss 0.486741
Epoch 54, Train Loss 0.356784, Valid_loss 0.481778
Epoch 55, Train Loss 0.377005, Valid_loss 0.485077
Epoch 56, Train Loss 0.351539, Valid_loss 0.484803
Epoch 57, Train Loss 0.358393, Valid_loss 0.485648
Epoch 58, Train Loss 0.349860, Valid_loss 0.485801
[I 2025-08-30 04:08:49,948] Trial 1 finished with value: 0.48177796815122875 and parameters: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 4, 'dropout': 0.5, 'weight_decay': 0.01, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.4658162992979799.
👉 train samples(학습 샘플(bag))=126, batch_size=16 -> steps(샘플수/batch크기)=8
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 27.97 MB
Memory Reserved: 46.00 MB
cuda
Epoch 1, Train Loss 0.609249, Valid_loss 0.584024
Epoch 2, Train Loss 0.552451, Valid_loss 0.548574
Epoch 3, Train Loss 0.467728, Valid_loss 0.502818
Epoch 4, Train Loss 0.380150, Valid_loss 0.554396
Epoch 5, Train Loss 0.319498, Valid_loss 0.518358
Epoch 6, Train Loss 0.312804, Valid_loss 0.533429
Epoch 7, Train Loss 0.292889, Valid_loss 0.495289
Epoch 8, Train Loss 0.287208, Valid_loss 0.488618
Epoch 9, Train Loss 0.273195, Valid_loss 0.495221
Epoch 10, Train Loss 0.267797, Valid_loss 0.465100
Epoch 11, Train Loss 0.267759, Valid_loss 0.450213
Epoch 12, Train Loss 0.256695, Valid_loss 0.491149
Epoch 13, Train Loss 0.256110, Valid_loss 0.490960
Epoch 14, Train Loss 0.254635, Valid_loss 0.480367
Epoch 15, Train Loss 0.246791, Valid_loss 0.505487
Epoch 16, Train Loss 0.246631, Valid_loss 0.503092
Epoch 17, Train Loss 0.243033, Valid_loss 0.485945
Epoch 18, Train Loss 0.236171, Valid_loss 0.520315
Epoch 19, Train Loss 0.242063, Valid_loss 0.474409
Epoch 20, Train Loss 0.236613, Valid_loss 0.494117
Epoch 21, Train Loss 0.243088, Valid_loss 0.520281
Epoch 22, Train Loss 0.235751, Valid_loss 0.521192
Epoch 23, Train Loss 0.235162, Valid_loss 0.534373
Epoch 24, Train Loss 0.231278, Valid_loss 0.516729
Epoch 25, Train Loss 0.228250, Valid_loss 0.516670
Epoch 26, Train Loss 0.228578, Valid_loss 0.499147
Epoch 27, Train Loss 0.237347, Valid_loss 0.499572
Epoch 28, Train Loss 0.224410, Valid_loss 0.480403
Epoch 29, Train Loss 0.218403, Valid_loss 0.519412
Epoch 30, Train Loss 0.214167, Valid_loss 0.543821
Epoch 31, Train Loss 0.217528, Valid_loss 0.547113
Epoch 32, Train Loss 0.214113, Valid_loss 0.582096
Epoch 33, Train Loss 0.211734, Valid_loss 0.511010
Epoch 34, Train Loss 0.212657, Valid_loss 0.548467
Epoch 35, Train Loss 0.212754, Valid_loss 0.631472
Epoch 36, Train Loss 0.223554, Valid_loss 0.547971
Epoch 37, Train Loss 0.214420, Valid_loss 0.614786
Epoch 38, Train Loss 0.211922, Valid_loss 0.521021
Epoch 39, Train Loss 0.212185, Valid_loss 0.512850
Epoch 40, Train Loss 0.213481, Valid_loss 0.554769
Epoch 41, Train Loss 0.210227, Valid_loss 0.529393
Epoch 42, Train Loss 0.213124, Valid_loss 0.629639
Epoch 43, Train Loss 0.216412, Valid_loss 0.559379
Epoch 44, Train Loss 0.217245, Valid_loss 0.521622
Epoch 45, Train Loss 0.211199, Valid_loss 0.568357
Epoch 46, Train Loss 0.207627, Valid_loss 0.514943
Epoch 47, Train Loss 0.207123, Valid_loss 0.521760
Epoch 48, Train Loss 0.204946, Valid_loss 0.582290
Epoch 49, Train Loss 0.203044, Valid_loss 0.542827
Epoch 50, Train Loss 0.211923, Valid_loss 0.579977
Epoch 51, Train Loss 0.210881, Valid_loss 0.521407
Epoch 52, Train Loss 0.202207, Valid_loss 0.555170
Epoch 53, Train Loss 0.201973, Valid_loss 0.586091
[I 2025-08-30 04:12:22,947] Trial 2 finished with value: 0.4502129711742912 and parameters: {'learning_rate': 0.001, 'epochs': 100, 'heads': 2, 'dropout': 0.0, 'weight_decay': 0.01, 'emb_dim': 64, 'augment_num': 100, 'pca': False}. Best is trial 2 with value: 0.4502129711742912.
선택된 trial params: {'learning_rate': 0.001, 'epochs': 100, 'heads': 2, 'dropout': 0.0, 'weight_decay': 0.01, 'emb_dim': 64, 'augment_num': 100, 'pca': False}
👉 train samples(학습 샘플(bag))=126, batch_size=16 -> steps(샘플수/batch크기)=8
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=10, batch_size=1 -> steps=10
output_class :  1
Memory Allocated: 27.97 MB
Memory Reserved: 46.00 MB
cuda
Epoch 1, Train Loss 0.650318, Valid_loss 0.595105
Epoch 2, Train Loss 0.563429, Valid_loss 0.560411
Epoch 3, Train Loss 0.510778, Valid_loss 0.506543
Epoch 4, Train Loss 0.402365, Valid_loss 0.486552
Epoch 5, Train Loss 0.357159, Valid_loss 0.498742
Epoch 6, Train Loss 0.360409, Valid_loss 0.531019
Epoch 7, Train Loss 0.315484, Valid_loss 0.548820
Epoch 8, Train Loss 0.296701, Valid_loss 0.475794
Epoch 9, Train Loss 0.298845, Valid_loss 0.566203
Epoch 10, Train Loss 0.295472, Valid_loss 0.484699
Epoch 11, Train Loss 0.280245, Valid_loss 0.481240
Epoch 12, Train Loss 0.274375, Valid_loss 0.513537
Epoch 13, Train Loss 0.266246, Valid_loss 0.489262
Epoch 14, Train Loss 0.266443, Valid_loss 0.455206
Epoch 15, Train Loss 0.268933, Valid_loss 0.477800
Epoch 16, Train Loss 0.255397, Valid_loss 0.520893
Epoch 17, Train Loss 0.249575, Valid_loss 0.482872
Epoch 18, Train Loss 0.251221, Valid_loss 0.495443
Epoch 19, Train Loss 0.261295, Valid_loss 0.588839
Epoch 20, Train Loss 0.259533, Valid_loss 0.498097
Epoch 21, Train Loss 0.247461, Valid_loss 0.495224
Epoch 22, Train Loss 0.243895, Valid_loss 0.483069
Epoch 23, Train Loss 0.240767, Valid_loss 0.532935
Epoch 24, Train Loss 0.242466, Valid_loss 0.520344
Epoch 25, Train Loss 0.245701, Valid_loss 0.549532
Epoch 26, Train Loss 0.237434, Valid_loss 0.488231
Epoch 27, Train Loss 0.232861, Valid_loss 0.499247
Epoch 28, Train Loss 0.233816, Valid_loss 0.493190
Epoch 29, Train Loss 0.225771, Valid_loss 0.535645
Epoch 30, Train Loss 0.227041, Valid_loss 0.506203
Epoch 31, Train Loss 0.223130, Valid_loss 0.514176
Epoch 32, Train Loss 0.235196, Valid_loss 0.524900
Epoch 33, Train Loss 0.225698, Valid_loss 0.490445
Epoch 34, Train Loss 0.229143, Valid_loss 0.525702
Epoch 35, Train Loss 0.219196, Valid_loss 0.480664
Epoch 36, Train Loss 0.217463, Valid_loss 0.535888
Epoch 37, Train Loss 0.217273, Valid_loss 0.502969
Epoch 38, Train Loss 0.217327, Valid_loss 0.514721
Epoch 39, Train Loss 0.217565, Valid_loss 0.526336
Epoch 40, Train Loss 0.213177, Valid_loss 0.497235
Epoch 41, Train Loss 0.209169, Valid_loss 0.526390
Epoch 42, Train Loss 0.207588, Valid_loss 0.562619
Epoch 43, Train Loss 0.207153, Valid_loss 0.531640
Epoch 44, Train Loss 0.210892, Valid_loss 0.608460
Epoch 45, Train Loss 0.233441, Valid_loss 0.595057
Epoch 46, Train Loss 0.226041, Valid_loss 0.799474
Epoch 47, Train Loss 0.240859, Valid_loss 0.481664
Epoch 48, Train Loss 0.225243, Valid_loss 0.547847
Epoch 49, Train Loss 0.230267, Valid_loss 0.494513
Epoch 50, Train Loss 0.225993, Valid_loss 0.526497
Epoch 51, Train Loss 0.217237, Valid_loss 0.520720
Epoch 52, Train Loss 0.213958, Valid_loss 0.510381
Epoch 53, Train Loss 0.209383, Valid_loss 0.512389
Epoch 54, Train Loss 0.208514, Valid_loss 0.531098
환자ID=COVID19_Participant11 -- true: 1 -- pred: 1
환자ID=COVID19_Participant18 -- true: 1 -- pred: 1
환자ID=COVID19_Participant25 -- true: 1 -- pred: 1
환자ID=COVID19_Participant28 -- true: 1 -- pred: 1
환자ID=COVID19_Participant30 -- true: 1 -- pred: 1
환자ID=COVID19_Participant39 -- true: 1 -- pred: 1
환자ID=COVID19_Participant8 -- true: 1 -- pred: 1
환자ID=Control_Participant14 -- true: 0 -- pred: 0
환자ID=Control_Participant7 -- true: 0 -- pred: 0
환자ID=Control_Participant9 -- true: 0 -- pred: 0
Best performance: Epoch 14, Loss 0.266443, Test ACC 1.000000, Test AUC 1.000000, Test Recall 1.000000, Test Precision 1.000000
Confusion Matrix:
 [3 0 0 7]
✅ Total valid splits used: 1
🔁 Repeat 0, Fold 1
cell type :  GTCGGGGGGTGG_Control_Participant7     Developing Ciliated Cells
CAAATCAATTAT_Control_Participant7     Developing Ciliated Cells
ATACAATTGACA_Control_Participant7     Developing Ciliated Cells
CTGTTAATGAGA_Control_Participant7     Developing Ciliated Cells
CTTCACATTATT_Control_Participant7     Developing Ciliated Cells
                                                ...            
GCAGGGAACTCC_COVID19_Participant30               Squamous Cells
CAGCACCGAGCC_COVID19_Participant30               Squamous Cells
GCCCCTTGTGAT_COVID19_Participant30               Squamous Cells
GTGTTGTGTGTC_COVID19_Participant30               Squamous Cells
TAACACTCACTT_COVID19_Participant30               Squamous Cells
Name: manual_annotation, Length: 21138, dtype: string
cell type annotation :  GTCGGGGGGTGG_Control_Participant7     Developing Ciliated Cells
CAAATCAATTAT_Control_Participant7     Developing Ciliated Cells
ATACAATTGACA_Control_Participant7     Developing Ciliated Cells
CTGTTAATGAGA_Control_Participant7     Developing Ciliated Cells
CTTCACATTATT_Control_Participant7     Developing Ciliated Cells
                                                ...            
GCAGGGAACTCC_COVID19_Participant30               Squamous Cells
CAGCACCGAGCC_COVID19_Participant30               Squamous Cells
GCCCCTTGTGAT_COVID19_Participant30               Squamous Cells
GTGTTGTGTGTC_COVID19_Participant30               Squamous Cells
TAACACTCACTT_COVID19_Participant30               Squamous Cells
Name: manual_annotation, Length: 21138, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Developing Ciliated Cells', 'Ciliated Cells', 'Secretory Cells', 'Squamous Cells', 'Goblet Cells', 'T Cells', 'Dendritic Cells', 'Basal Cells', 'Deuterosomal Cells', 'Mitotic Basal Cells', 'Macrophages', 'B Cells', 'Ionocytes', 'Developing Secretory and Goblet Cells', 'Enteroendocrine Cells', 'Erythroblasts', 'Mast Cells', 'Plasmacytoid DCs']
라벨별 그룹 개수 {1: 28, 0: 12}
cell type :  TTGCGGTGACCA_COVID19_Participant31    Ciliated Cells
AGGCTCGAACTG_COVID19_Participant31    Ciliated Cells
TATCCGTATGTT_COVID19_Participant31      Goblet Cells
CAGACAGCGGCT_COVID19_Participant31       Basal Cells
CAAAGAGAACTA_COVID19_Participant31    Ciliated Cells
                                           ...      
CGCGCCCTAGAC_Control_Participant15      Goblet Cells
CGGACAGAATGG_Control_Participant15    Ciliated Cells
GTTTATTCATCA_Control_Participant15    Ciliated Cells
TTTTTGTACTAT_Control_Participant15    Ciliated Cells
CGATTGTAGATC_Control_Participant15    Ciliated Cells
Name: manual_annotation, Length: 5809, dtype: string
cell type annotation :  TTGCGGTGACCA_COVID19_Participant31    Ciliated Cells
AGGCTCGAACTG_COVID19_Participant31    Ciliated Cells
TATCCGTATGTT_COVID19_Participant31      Goblet Cells
CAGACAGCGGCT_COVID19_Participant31       Basal Cells
CAAAGAGAACTA_COVID19_Participant31    Ciliated Cells
                                           ...      
CGCGCCCTAGAC_Control_Participant15      Goblet Cells
CGGACAGAATGG_Control_Participant15    Ciliated Cells
GTTTATTCATCA_Control_Participant15    Ciliated Cells
TTTTTGTACTAT_Control_Participant15    Ciliated Cells
CGATTGTAGATC_Control_Participant15    Ciliated Cells
Name: manual_annotation, Length: 5809, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Ciliated Cells', 'Goblet Cells', 'Basal Cells', 'Developing Secretory and Goblet Cells', 'Macrophages', 'T Cells', 'Deuterosomal Cells', 'Mitotic Basal Cells', 'Developing Ciliated Cells', 'Secretory Cells', 'Squamous Cells', 'Plasmacytoid DCs', 'Ionocytes', 'Enteroendocrine Cells', 'Dendritic Cells', 'Erythroblasts', 'B Cells']
라벨별 그룹 개수 {1: 7, 0: 3}
🔍 Split #2
  → train_p_index 환자 수 (환자 단위로 묶인 index list): 40
  → test_p_index 환자 수  (환자 단위로 묶인 index list): 10
  → train 환자 ID: ['COVID19_Participant10', 'COVID19_Participant11', 'COVID19_Participant13', 'COVID19_Participant14', 'COVID19_Participant17', 'COVID19_Participant18', 'COVID19_Participant19', 'COVID19_Participant2', 'COVID19_Participant20', 'COVID19_Participant21', 'COVID19_Participant22', 'COVID19_Participant23', 'COVID19_Participant25', 'COVID19_Participant26', 'COVID19_Participant27', 'COVID19_Participant28', 'COVID19_Participant29', 'COVID19_Participant30', 'COVID19_Participant35', 'COVID19_Participant37', 'COVID19_Participant38', 'COVID19_Participant39', 'COVID19_Participant4', 'COVID19_Participant40', 'COVID19_Participant6', 'COVID19_Participant7', 'COVID19_Participant8', 'COVID19_Participant9', 'Control_Participant1', 'Control_Participant10', 'Control_Participant11', 'Control_Participant12', 'Control_Participant14', 'Control_Participant2', 'Control_Participant4', 'Control_Participant5', 'Control_Participant6', 'Control_Participant7', 'Control_Participant8', 'Control_Participant9']
  → test  환자 ID: ['COVID19_Participant12', 'COVID19_Participant15', 'COVID19_Participant3', 'COVID19_Participant31', 'COVID19_Participant32', 'COVID19_Participant36', 'COVID19_Participant5', 'Control_Participant13', 'Control_Participant15', 'Control_Participant3']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant10, Label: 1
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant18, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant21, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant27, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant30, Label: 1
    ID: COVID19_Participant35, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant38, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: COVID19_Participant6, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: COVID19_Participant9, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant10, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant12, Label: 0
    ID: Control_Participant14, Label: 0
    ID: Control_Participant2, Label: 0
    ID: Control_Participant4, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant6, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant8, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: COVID19_Participant12, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant3, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant36, Label: 1
    ID: COVID19_Participant5, Label: 1
    ID: Control_Participant13, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant3, Label: 0
전체 데이터 index 길이 50
label_stat (train 환자 라벨 목록) 갯수 40
train_data에서 환자 단위로, train과 validation 나누기
기존 train_p_index 40
기존 (train) label_stat 40
train-vali 분할 후! 
train y 의 classes : {0, 1} valid y 의 classes : {0, 1} label_stat 의 classes : {0, 1}
train_p_index_ 26
valid_p_index 14
test_p_index 10
→ train 환자 ID 및 라벨:
   총 개수: 26
   환자ID=Control_Participant10, Label=0, 셀개수=1645
   환자ID=Control_Participant2, Label=0, 셀개수=41
   환자ID=COVID19_Participant19, Label=1, 셀개수=816
   환자ID=COVID19_Participant39, Label=1, 셀개수=454
   환자ID=COVID19_Participant10, Label=1, 셀개수=18
   환자ID=Control_Participant6, Label=0, 셀개수=131
   환자ID=COVID19_Participant14, Label=1, 셀개수=382
   환자ID=COVID19_Participant2, Label=1, 셀개수=329
   환자ID=COVID19_Participant40, Label=1, 셀개수=381
   환자ID=COVID19_Participant13, Label=1, 셀개수=730
   환자ID=COVID19_Participant20, Label=1, 셀개수=2033
   환자ID=Control_Participant4, Label=0, 셀개수=440
   환자ID=COVID19_Participant26, Label=1, 셀개수=814
   환자ID=Control_Participant8, Label=0, 셀개수=393
   환자ID=Control_Participant7, Label=0, 셀개수=762
   환자ID=COVID19_Participant17, Label=1, 셀개수=843
   환자ID=Control_Participant9, Label=0, 셀개수=558
   환자ID=Control_Participant11, Label=0, 셀개수=1164
   환자ID=COVID19_Participant22, Label=1, 셀개수=865
   환자ID=COVID19_Participant29, Label=1, 셀개수=573
   환자ID=COVID19_Participant25, Label=1, 셀개수=496
   환자ID=COVID19_Participant18, Label=1, 셀개수=227
   환자ID=COVID19_Participant7, Label=1, 셀개수=409
   환자ID=COVID19_Participant4, Label=1, 셀개수=1680
   환자ID=COVID19_Participant38, Label=1, 셀개수=51
   환자ID=COVID19_Participant28, Label=1, 셀개수=1079
→ valid 환자 ID 및 라벨:
   총 개수: 14
   환자ID=Control_Participant14, Label=0, 셀개수=274
   환자ID=COVID19_Participant27, Label=1, 셀개수=93
   환자ID=COVID19_Participant35, Label=1, 셀개수=83
   환자ID=COVID19_Participant30, Label=1, 셀개수=116
   환자ID=COVID19_Participant6, Label=1, 셀개수=84
   환자ID=COVID19_Participant21, Label=1, 셀개수=39
   환자ID=Control_Participant5, Label=0, 셀개수=717
   환자ID=Control_Participant1, Label=0, 셀개수=414
   환자ID=COVID19_Participant9, Label=1, 셀개수=86
   환자ID=COVID19_Participant8, Label=1, 셀개수=462
   환자ID=Control_Participant12, Label=0, 셀개수=99
   환자ID=COVID19_Participant37, Label=1, 셀개수=668
   환자ID=COVID19_Participant11, Label=1, 셀개수=382
   환자ID=COVID19_Participant23, Label=1, 셀개수=307
→ test 환자 ID 및 라벨:
   총 개수: 10
   환자ID=COVID19_Participant12, Label=1, 셀개수=102
   환자ID=COVID19_Participant15, Label=1, 셀개수=1003
   환자ID=COVID19_Participant3, Label=1, 셀개수=104
   환자ID=COVID19_Participant31, Label=1, 셀개수=410
   환자ID=COVID19_Participant32, Label=1, 셀개수=1665
   환자ID=COVID19_Participant36, Label=1, 셀개수=200
   환자ID=COVID19_Participant5, Label=1, 셀개수=89
   환자ID=Control_Participant13, Label=0, 셀개수=88
   환자ID=Control_Participant15, Label=0, 셀개수=528
   환자ID=Control_Participant3, Label=0, 셀개수=1620
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Ciliated Cells', 'Developing Ciliated Cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
전체 데이터 길이 26947
전체 cell type 길이 0        Developing Ciliated Cells
1        Developing Ciliated Cells
2        Developing Ciliated Cells
3        Developing Ciliated Cells
4        Developing Ciliated Cells
                   ...            
26942                 Goblet Cells
26943               Ciliated Cells
26944               Ciliated Cells
26945               Ciliated Cells
26946               Ciliated Cells
Length: 26947, dtype: string
cell type의 NaN 개수 체크 0
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  2%|▏         | 2/100 [00:00<00:09, 10.84it/s]  4%|▍         | 4/100 [00:00<00:08, 10.70it/s]  6%|▌         | 6/100 [00:00<00:09, 10.02it/s]  8%|▊         | 8/100 [00:00<00:10,  8.95it/s]  9%|▉         | 9/100 [00:00<00:10,  9.03it/s] 11%|█         | 11/100 [00:01<00:09,  9.44it/s] 12%|█▏        | 12/100 [00:01<00:09,  8.92it/s] 14%|█▍        | 14/100 [00:01<00:09,  9.50it/s] 15%|█▌        | 15/100 [00:01<00:09,  8.90it/s] 16%|█▌        | 16/100 [00:01<00:09,  9.05it/s] 17%|█▋        | 17/100 [00:01<00:08,  9.27it/s] 18%|█▊        | 18/100 [00:01<00:09,  8.22it/s] 19%|█▉        | 19/100 [00:02<00:09,  8.43it/s] 20%|██        | 20/100 [00:02<00:11,  6.95it/s] 21%|██        | 21/100 [00:02<00:10,  7.61it/s] 22%|██▏       | 22/100 [00:02<00:09,  8.17it/s] 24%|██▍       | 24/100 [00:02<00:08,  8.81it/s] 26%|██▌       | 26/100 [00:02<00:07,  9.33it/s] 27%|██▋       | 27/100 [00:03<00:09,  7.33it/s] 29%|██▉       | 29/100 [00:03<00:08,  8.23it/s] 30%|███       | 30/100 [00:03<00:08,  8.17it/s] 31%|███       | 31/100 [00:03<00:08,  8.50it/s] 33%|███▎      | 33/100 [00:03<00:07,  9.19it/s] 34%|███▍      | 34/100 [00:03<00:07,  9.34it/s] 35%|███▌      | 35/100 [00:03<00:07,  9.03it/s] 37%|███▋      | 37/100 [00:04<00:08,  7.62it/s] 38%|███▊      | 38/100 [00:04<00:07,  8.00it/s] 39%|███▉      | 39/100 [00:04<00:07,  8.27it/s] 40%|████      | 40/100 [00:04<00:07,  8.32it/s] 41%|████      | 41/100 [00:04<00:06,  8.67it/s] 42%|████▏     | 42/100 [00:04<00:08,  6.53it/s] 43%|████▎     | 43/100 [00:05<00:08,  6.94it/s] 44%|████▍     | 44/100 [00:05<00:07,  7.49it/s] 45%|████▌     | 45/100 [00:05<00:06,  7.87it/s] 46%|████▌     | 46/100 [00:05<00:06,  8.37it/s] 47%|████▋     | 47/100 [00:05<00:11,  4.66it/s] 48%|████▊     | 48/100 [00:05<00:09,  5.35it/s] 49%|████▉     | 49/100 [00:06<00:10,  4.95it/s] 51%|█████     | 51/100 [00:06<00:07,  6.26it/s] 53%|█████▎    | 53/100 [00:06<00:06,  7.39it/s] 54%|█████▍    | 54/100 [00:06<00:07,  6.53it/s] 55%|█████▌    | 55/100 [00:07<00:06,  6.59it/s] 56%|█████▌    | 56/100 [00:07<00:06,  7.09it/s] 58%|█████▊    | 58/100 [00:07<00:05,  7.86it/s] 59%|█████▉    | 59/100 [00:07<00:05,  8.14it/s] 60%|██████    | 60/100 [00:07<00:04,  8.51it/s] 61%|██████    | 61/100 [00:07<00:04,  8.27it/s] 63%|██████▎   | 63/100 [00:07<00:04,  9.03it/s] 64%|██████▍   | 64/100 [00:07<00:03,  9.16it/s] 65%|██████▌   | 65/100 [00:08<00:04,  8.69it/s] 66%|██████▌   | 66/100 [00:08<00:03,  8.92it/s] 68%|██████▊   | 68/100 [00:08<00:03,  9.44it/s] 69%|██████▉   | 69/100 [00:08<00:03,  9.17it/s] 70%|███████   | 70/100 [00:08<00:03,  9.05it/s] 71%|███████   | 71/100 [00:08<00:03,  9.14it/s] 72%|███████▏  | 72/100 [00:08<00:03,  9.26it/s] 74%|███████▍  | 74/100 [00:09<00:02,  9.72it/s] 75%|███████▌  | 75/100 [00:09<00:02,  9.66it/s] 77%|███████▋  | 77/100 [00:09<00:02,  8.82it/s] 78%|███████▊  | 78/100 [00:09<00:02,  8.97it/s] 79%|███████▉  | 79/100 [00:09<00:02,  8.98it/s] 80%|████████  | 80/100 [00:09<00:02,  8.21it/s] 81%|████████  | 81/100 [00:09<00:02,  7.97it/s] 83%|████████▎ | 83/100 [00:10<00:01,  8.87it/s] 84%|████████▍ | 84/100 [00:10<00:01,  9.06it/s] 85%|████████▌ | 85/100 [00:10<00:02,  6.21it/s] 86%|████████▌ | 86/100 [00:10<00:02,  6.66it/s] 87%|████████▋ | 87/100 [00:10<00:01,  7.33it/s] 88%|████████▊ | 88/100 [00:10<00:01,  7.75it/s] 89%|████████▉ | 89/100 [00:10<00:01,  8.03it/s] 90%|█████████ | 90/100 [00:11<00:01,  7.91it/s] 91%|█████████ | 91/100 [00:11<00:01,  6.36it/s] 92%|█████████▏| 92/100 [00:11<00:01,  6.63it/s] 93%|█████████▎| 93/100 [00:11<00:01,  6.87it/s] 94%|█████████▍| 94/100 [00:11<00:00,  6.75it/s] 95%|█████████▌| 95/100 [00:11<00:00,  6.75it/s] 96%|█████████▌| 96/100 [00:11<00:00,  7.42it/s] 97%|█████████▋| 97/100 [00:12<00:00,  7.72it/s] 98%|█████████▊| 98/100 [00:12<00:00,  8.05it/s] 99%|█████████▉| 99/100 [00:12<00:00,  8.13it/s]100%|██████████| 100/100 [00:12<00:00,  8.09it/s]100%|██████████| 100/100 [00:12<00:00,  8.02it/s]
[I 2025-08-30 04:16:13,590] A new study created in memory with name: no-name-da4c977e-b8bd-458b-84bf-f2a6b5f69455
👉 train samples(학습 샘플(bag))=126, batch_size=16 -> steps(샘플수/batch크기)=8
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 26.13 MB
Memory Reserved: 46.00 MB
cuda
Epoch 1, Train Loss 0.680809, Valid_loss 0.638331
Epoch 2, Train Loss 0.641174, Valid_loss 0.596060
Epoch 3, Train Loss 0.633350, Valid_loss 0.600609
Epoch 4, Train Loss 0.649339, Valid_loss 0.595284
Epoch 5, Train Loss 0.638708, Valid_loss 0.593526
Epoch 6, Train Loss 0.580344, Valid_loss 0.551487
Epoch 7, Train Loss 0.454315, Valid_loss 0.493485
Epoch 8, Train Loss 0.356348, Valid_loss 0.388737
Epoch 9, Train Loss 0.290767, Valid_loss 0.279982
Epoch 10, Train Loss 0.248292, Valid_loss 0.246451
Epoch 11, Train Loss 0.234339, Valid_loss 0.304113
Epoch 12, Train Loss 0.220880, Valid_loss 0.264936
Epoch 13, Train Loss 0.232507, Valid_loss 0.309039
Epoch 14, Train Loss 0.220629, Valid_loss 0.287639
Epoch 15, Train Loss 0.197359, Valid_loss 0.306165
Epoch 16, Train Loss 0.204096, Valid_loss 0.265212
Epoch 17, Train Loss 0.220163, Valid_loss 0.273043
Epoch 18, Train Loss 0.202084, Valid_loss 0.276953
Epoch 19, Train Loss 0.203673, Valid_loss 0.297949
Epoch 20, Train Loss 0.199338, Valid_loss 0.421280
Epoch 21, Train Loss 0.231719, Valid_loss 0.352855
Epoch 22, Train Loss 0.214662, Valid_loss 0.282403
Epoch 23, Train Loss 0.230917, Valid_loss 0.317858
Epoch 24, Train Loss 0.227610, Valid_loss 0.451137
Epoch 25, Train Loss 0.242874, Valid_loss 0.331161
Epoch 26, Train Loss 0.207493, Valid_loss 0.372327
Epoch 27, Train Loss 0.200118, Valid_loss 0.381548
Epoch 28, Train Loss 0.183474, Valid_loss 0.399142
Epoch 29, Train Loss 0.183271, Valid_loss 0.423014
Epoch 30, Train Loss 0.191231, Valid_loss 0.402635
Epoch 31, Train Loss 0.179625, Valid_loss 0.395515
Epoch 32, Train Loss 0.186322, Valid_loss 0.427525
Epoch 33, Train Loss 0.178880, Valid_loss 0.398358
Epoch 34, Train Loss 0.181480, Valid_loss 0.328678
Epoch 35, Train Loss 0.169287, Valid_loss 0.341436
Epoch 36, Train Loss 0.163955, Valid_loss 0.325748
Epoch 37, Train Loss 0.170658, Valid_loss 0.422943
Epoch 38, Train Loss 0.191339, Valid_loss 0.293427
Epoch 39, Train Loss 0.200517, Valid_loss 0.275550
Epoch 40, Train Loss 0.181298, Valid_loss 0.356763
Epoch 41, Train Loss 0.190796, Valid_loss 0.243693
Epoch 42, Train Loss 0.176795, Valid_loss 0.243422
Epoch 43, Train Loss 0.162204, Valid_loss 0.235737
Epoch 44, Train Loss 0.166321, Valid_loss 0.243461
Epoch 45, Train Loss 0.171810, Valid_loss 0.277966
Epoch 46, Train Loss 0.179633, Valid_loss 0.397121
Epoch 47, Train Loss 0.187142, Valid_loss 0.285817
Epoch 48, Train Loss 0.185847, Valid_loss 0.360697
Epoch 49, Train Loss 0.174348, Valid_loss 0.406681
Epoch 50, Train Loss 0.166438, Valid_loss 0.314679
Epoch 51, Train Loss 0.168246, Valid_loss 0.301852
Epoch 52, Train Loss 0.169115, Valid_loss 0.305667
Epoch 53, Train Loss 0.164089, Valid_loss 0.301513
Epoch 54, Train Loss 0.159602, Valid_loss 0.291951
Epoch 55, Train Loss 0.162560, Valid_loss 0.316902
Epoch 56, Train Loss 0.158188, Valid_loss 0.237973
Epoch 57, Train Loss 0.155800, Valid_loss 0.303305
Epoch 58, Train Loss 0.157485, Valid_loss 0.296570
Epoch 59, Train Loss 0.156328, Valid_loss 0.306034
Epoch 60, Train Loss 0.153982, Valid_loss 0.302792
Epoch 61, Train Loss 0.165381, Valid_loss 0.255121
Epoch 62, Train Loss 0.158940, Valid_loss 0.279323
Epoch 63, Train Loss 0.161722, Valid_loss 0.242310
Epoch 64, Train Loss 0.158655, Valid_loss 0.282643
Epoch 65, Train Loss 0.151283, Valid_loss 0.258690
Epoch 66, Train Loss 0.157453, Valid_loss 0.258155
Epoch 67, Train Loss 0.155663, Valid_loss 0.328464
Epoch 68, Train Loss 0.156137, Valid_loss 0.269871
Epoch 69, Train Loss 0.155411, Valid_loss 0.255300
Epoch 70, Train Loss 0.155854, Valid_loss 0.267438
Epoch 71, Train Loss 0.155486, Valid_loss 0.231171
Epoch 72, Train Loss 0.160338, Valid_loss 0.293107
Epoch 73, Train Loss 0.153699, Valid_loss 0.250790
Epoch 74, Train Loss 0.159888, Valid_loss 0.325351
Epoch 75, Train Loss 0.152434, Valid_loss 0.252413
Epoch 76, Train Loss 0.154295, Valid_loss 0.243004
Epoch 77, Train Loss 0.148405, Valid_loss 0.306761
Epoch 78, Train Loss 0.149592, Valid_loss 0.242400
Epoch 79, Train Loss 0.154392, Valid_loss 0.288757
Epoch 80, Train Loss 0.155469, Valid_loss 0.315329
[I 2025-08-30 04:21:16,514] Trial 0 finished with value: 0.23117081873767478 and parameters: {'learning_rate': 0.01, 'epochs': 100, 'heads': 1, 'dropout': 0.3, 'weight_decay': 0.0001, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.23117081873767478.
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 27.97 MB
Memory Reserved: 46.00 MB
cuda
Epoch 1, Train Loss 0.680449, Valid_loss 0.584500
Epoch 2, Train Loss 0.654595, Valid_loss 0.560342
Epoch 3, Train Loss 0.583623, Valid_loss 0.433991
Epoch 4, Train Loss 0.422488, Valid_loss 0.360127
Epoch 5, Train Loss 0.357820, Valid_loss 0.335803
Epoch 6, Train Loss 0.310906, Valid_loss 0.317513
Epoch 7, Train Loss 0.322381, Valid_loss 0.423861
Epoch 8, Train Loss 0.328685, Valid_loss 0.456333
Epoch 9, Train Loss 0.287808, Valid_loss 0.310962
Epoch 10, Train Loss 0.296505, Valid_loss 0.286191
Epoch 11, Train Loss 0.292776, Valid_loss 0.338113
Epoch 12, Train Loss 0.285957, Valid_loss 0.278839
Epoch 13, Train Loss 0.267171, Valid_loss 0.257560
Epoch 14, Train Loss 0.277349, Valid_loss 0.275195
Epoch 15, Train Loss 0.295619, Valid_loss 0.514803
Epoch 16, Train Loss 0.346868, Valid_loss 0.276049
Epoch 17, Train Loss 0.259220, Valid_loss 0.283507
Epoch 18, Train Loss 0.268841, Valid_loss 0.264344
Epoch 19, Train Loss 0.271889, Valid_loss 0.252832
Epoch 20, Train Loss 0.249865, Valid_loss 0.270397
Epoch 21, Train Loss 0.223834, Valid_loss 0.255630
Epoch 22, Train Loss 0.251659, Valid_loss 0.267135
Epoch 23, Train Loss 0.241374, Valid_loss 0.257071
Epoch 24, Train Loss 0.250108, Valid_loss 0.262952
Epoch 25, Train Loss 0.235771, Valid_loss 0.279643
Epoch 26, Train Loss 0.236460, Valid_loss 0.233884
Epoch 27, Train Loss 0.216136, Valid_loss 0.249511
Epoch 28, Train Loss 0.232506, Valid_loss 0.252463
Epoch 29, Train Loss 0.237433, Valid_loss 0.263548
Epoch 30, Train Loss 0.242320, Valid_loss 0.284575
Epoch 31, Train Loss 0.235232, Valid_loss 0.283377
Epoch 32, Train Loss 0.268982, Valid_loss 0.284538
Epoch 33, Train Loss 0.246774, Valid_loss 0.290929
Epoch 34, Train Loss 0.264046, Valid_loss 0.277994
Epoch 35, Train Loss 0.253570, Valid_loss 0.272409
Epoch 36, Train Loss 0.244500, Valid_loss 0.269040
Epoch 37, Train Loss 0.237961, Valid_loss 0.251358
Epoch 38, Train Loss 0.244149, Valid_loss 0.242865
Epoch 39, Train Loss 0.228822, Valid_loss 0.252488
Epoch 40, Train Loss 0.252375, Valid_loss 0.279672
Epoch 41, Train Loss 0.265241, Valid_loss 0.310946
Epoch 42, Train Loss 0.227647, Valid_loss 0.264881
Epoch 43, Train Loss 0.248217, Valid_loss 0.262459
Epoch 44, Train Loss 0.242375, Valid_loss 0.295935
Epoch 45, Train Loss 0.234729, Valid_loss 0.245796
Epoch 46, Train Loss 0.247100, Valid_loss 0.309773
Epoch 47, Train Loss 0.225318, Valid_loss 0.256216
Epoch 48, Train Loss 0.235842, Valid_loss 0.254498
Epoch 49, Train Loss 0.240366, Valid_loss 0.272507
Epoch 50, Train Loss 0.228395, Valid_loss 0.260814
Epoch 51, Train Loss 0.232534, Valid_loss 0.258498
Epoch 52, Train Loss 0.234188, Valid_loss 0.253472
Epoch 53, Train Loss 0.230441, Valid_loss 0.247539
Epoch 54, Train Loss 0.226750, Valid_loss 0.243944
Epoch 55, Train Loss 0.230902, Valid_loss 0.244960
Epoch 56, Train Loss 0.217576, Valid_loss 0.238947
Epoch 57, Train Loss 0.222011, Valid_loss 0.276274
Epoch 58, Train Loss 0.221629, Valid_loss 0.232491
Epoch 59, Train Loss 0.232441, Valid_loss 0.251647
Epoch 60, Train Loss 0.229985, Valid_loss 0.239452
Epoch 61, Train Loss 0.220618, Valid_loss 0.232758
Epoch 62, Train Loss 0.225628, Valid_loss 0.302285
Epoch 63, Train Loss 0.231544, Valid_loss 0.230707
Epoch 64, Train Loss 0.208369, Valid_loss 0.272460
Epoch 65, Train Loss 0.208661, Valid_loss 0.271405
Epoch 66, Train Loss 0.219054, Valid_loss 0.249263
Epoch 67, Train Loss 0.237749, Valid_loss 0.236430
Epoch 68, Train Loss 0.208616, Valid_loss 0.217781
Epoch 69, Train Loss 0.213633, Valid_loss 0.255884
Epoch 70, Train Loss 0.232290, Valid_loss 0.228912
Epoch 71, Train Loss 0.239686, Valid_loss 0.226757
Epoch 72, Train Loss 0.207097, Valid_loss 0.239446
Epoch 73, Train Loss 0.234575, Valid_loss 0.249010
[I 2025-08-30 04:27:05,358] Trial 1 finished with value: 0.21778120140412024 and parameters: {'learning_rate': 0.001, 'epochs': 100, 'heads': 4, 'dropout': 0.7, 'weight_decay': 0.01, 'emb_dim': 64, 'augment_num': 100, 'pca': False}. Best is trial 1 with value: 0.21778120140412024.
👉 train samples(학습 샘플(bag))=126, batch_size=16 -> steps(샘플수/batch크기)=8
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 46.00 MB
cuda
Epoch 1, Train Loss 0.732186, Valid_loss 0.691169
Epoch 2, Train Loss 0.687900, Valid_loss 0.665376
Epoch 3, Train Loss 0.703400, Valid_loss 0.649907
Epoch 4, Train Loss 0.692094, Valid_loss 0.639299
Epoch 5, Train Loss 0.692170, Valid_loss 0.627464
Epoch 6, Train Loss 0.668504, Valid_loss 0.615477
Epoch 7, Train Loss 0.649367, Valid_loss 0.605903
Epoch 8, Train Loss 0.650830, Valid_loss 0.598946
Epoch 9, Train Loss 0.627320, Valid_loss 0.596125
Epoch 10, Train Loss 0.621861, Valid_loss 0.597123
Epoch 11, Train Loss 0.597344, Valid_loss 0.607695
Epoch 12, Train Loss 0.642385, Valid_loss 0.612618
Epoch 13, Train Loss 0.574921, Valid_loss 0.600297
Epoch 14, Train Loss 0.597646, Valid_loss 0.587733
Epoch 15, Train Loss 0.593162, Valid_loss 0.582959
Epoch 16, Train Loss 0.603741, Valid_loss 0.581937
Epoch 17, Train Loss 0.583607, Valid_loss 0.573788
Epoch 18, Train Loss 0.636054, Valid_loss 0.569907
Epoch 19, Train Loss 0.613134, Valid_loss 0.566449
Epoch 20, Train Loss 0.586688, Valid_loss 0.566655
Epoch 21, Train Loss 0.618931, Valid_loss 0.567172
Epoch 22, Train Loss 0.595707, Valid_loss 0.562892
Epoch 23, Train Loss 0.568963, Valid_loss 0.554439
Epoch 24, Train Loss 0.582794, Valid_loss 0.552120
Epoch 25, Train Loss 0.564654, Valid_loss 0.556557
Epoch 26, Train Loss 0.590823, Valid_loss 0.558638
Epoch 27, Train Loss 0.545801, Valid_loss 0.556491
Epoch 28, Train Loss 0.570510, Valid_loss 0.552284
Epoch 29, Train Loss 0.551358, Valid_loss 0.545250
Epoch 30, Train Loss 0.603018, Valid_loss 0.541636
Epoch 31, Train Loss 0.522406, Valid_loss 0.536731
Epoch 32, Train Loss 0.590323, Valid_loss 0.538746
Epoch 33, Train Loss 0.563271, Valid_loss 0.545971
Epoch 34, Train Loss 0.564958, Valid_loss 0.554635
Epoch 35, Train Loss 0.548485, Valid_loss 0.555760
Epoch 36, Train Loss 0.532232, Valid_loss 0.550150
Epoch 37, Train Loss 0.547729, Valid_loss 0.537824
Epoch 38, Train Loss 0.564412, Valid_loss 0.542025
Epoch 39, Train Loss 0.533056, Valid_loss 0.543283
Epoch 40, Train Loss 0.560782, Valid_loss 0.550422
Epoch 41, Train Loss 0.534155, Valid_loss 0.545883
Epoch 42, Train Loss 0.512505, Valid_loss 0.543243
Epoch 43, Train Loss 0.562001, Valid_loss 0.543081
Epoch 44, Train Loss 0.538793, Valid_loss 0.540060
Epoch 45, Train Loss 0.515802, Valid_loss 0.533683
Epoch 46, Train Loss 0.545735, Valid_loss 0.536293
Epoch 47, Train Loss 0.574503, Valid_loss 0.535397
Epoch 48, Train Loss 0.517773, Valid_loss 0.544001
Epoch 49, Train Loss 0.532379, Valid_loss 0.551413
Epoch 50, Train Loss 0.559081, Valid_loss 0.542325
Epoch 51, Train Loss 0.510823, Valid_loss 0.539346
Epoch 52, Train Loss 0.571387, Valid_loss 0.535009
Epoch 53, Train Loss 0.558973, Valid_loss 0.530235
Epoch 54, Train Loss 0.530962, Valid_loss 0.533935
Epoch 55, Train Loss 0.566050, Valid_loss 0.536516
[I 2025-08-30 04:30:50,063] Trial 2 finished with value: 0.5302352862698692 and parameters: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 2, 'dropout': 0.7, 'weight_decay': 0.01, 'emb_dim': 8, 'augment_num': 100, 'pca': False}. Best is trial 1 with value: 0.21778120140412024.
선택된 trial params: {'learning_rate': 0.001, 'epochs': 100, 'heads': 4, 'dropout': 0.7, 'weight_decay': 0.01, 'emb_dim': 64, 'augment_num': 100, 'pca': False}
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=10, batch_size=1 -> steps=10
output_class :  1
Memory Allocated: 27.97 MB
Memory Reserved: 46.00 MB
cuda
Epoch 1, Train Loss 0.681353, Valid_loss 0.539894
Epoch 2, Train Loss 0.559109, Valid_loss 0.383994
Epoch 3, Train Loss 0.364500, Valid_loss 0.362463
Epoch 4, Train Loss 0.318860, Valid_loss 0.339114
Epoch 5, Train Loss 0.309825, Valid_loss 0.411985
Epoch 6, Train Loss 0.329289, Valid_loss 0.336595
Epoch 7, Train Loss 0.282278, Valid_loss 0.359871
Epoch 8, Train Loss 0.270987, Valid_loss 0.376735
Epoch 9, Train Loss 0.247549, Valid_loss 0.466698
Epoch 10, Train Loss 0.302803, Valid_loss 0.453596
Epoch 11, Train Loss 0.289850, Valid_loss 0.463460
Epoch 12, Train Loss 0.273373, Valid_loss 0.398870
Epoch 13, Train Loss 0.293921, Valid_loss 0.501060
Epoch 14, Train Loss 0.271320, Valid_loss 0.376985
Epoch 15, Train Loss 0.265675, Valid_loss 0.290335
Epoch 16, Train Loss 0.251014, Valid_loss 0.282786
Epoch 17, Train Loss 0.242651, Valid_loss 0.292702
Epoch 18, Train Loss 0.260573, Valid_loss 0.299555
Epoch 19, Train Loss 0.246880, Valid_loss 0.326718
Epoch 20, Train Loss 0.243249, Valid_loss 0.326058
Epoch 21, Train Loss 0.251476, Valid_loss 0.359025
Epoch 22, Train Loss 0.246822, Valid_loss 0.292726
Epoch 23, Train Loss 0.232037, Valid_loss 0.246805
Epoch 24, Train Loss 0.251976, Valid_loss 0.246178
Epoch 25, Train Loss 0.229238, Valid_loss 0.251623
Epoch 26, Train Loss 0.257126, Valid_loss 0.343645
Epoch 27, Train Loss 0.236345, Valid_loss 0.431011
Epoch 28, Train Loss 0.242504, Valid_loss 0.413004
Epoch 29, Train Loss 0.274633, Valid_loss 0.355220
Epoch 30, Train Loss 0.248931, Valid_loss 0.250029
Epoch 31, Train Loss 0.264270, Valid_loss 0.245193
Epoch 32, Train Loss 0.226198, Valid_loss 0.300192
Epoch 33, Train Loss 0.225470, Valid_loss 0.254148
Epoch 34, Train Loss 0.245988, Valid_loss 0.370422
Epoch 35, Train Loss 0.258851, Valid_loss 0.257575
Epoch 36, Train Loss 0.235150, Valid_loss 0.267321
Epoch 37, Train Loss 0.242992, Valid_loss 0.252796
Epoch 38, Train Loss 0.223127, Valid_loss 0.319893
Epoch 39, Train Loss 0.219336, Valid_loss 0.234944
Epoch 40, Train Loss 0.246758, Valid_loss 0.259651
Epoch 41, Train Loss 0.252469, Valid_loss 0.273384
Epoch 42, Train Loss 0.237904, Valid_loss 0.269340
Epoch 43, Train Loss 0.250579, Valid_loss 0.305284
Epoch 44, Train Loss 0.230484, Valid_loss 0.255553
Epoch 45, Train Loss 0.225290, Valid_loss 0.332778
Epoch 46, Train Loss 0.221275, Valid_loss 0.225537
Epoch 47, Train Loss 0.230197, Valid_loss 0.246198
Epoch 48, Train Loss 0.232151, Valid_loss 0.256069
Epoch 49, Train Loss 0.258830, Valid_loss 0.252873
Epoch 50, Train Loss 0.284023, Valid_loss 0.245094
Epoch 51, Train Loss 0.233513, Valid_loss 0.257066
Epoch 52, Train Loss 0.214746, Valid_loss 0.242333
Epoch 53, Train Loss 0.231619, Valid_loss 0.309662
Epoch 54, Train Loss 0.237619, Valid_loss 0.243306
Epoch 55, Train Loss 0.232984, Valid_loss 0.247879
Epoch 56, Train Loss 0.223635, Valid_loss 0.319286
환자ID=COVID19_Participant12 -- true: 1 -- pred: 1
환자ID=COVID19_Participant15 -- true: 1 -- pred: 1
환자ID=COVID19_Participant3 -- true: 1 -- pred: 1
환자ID=COVID19_Participant31 -- true: 1 -- pred: 0
환자ID=COVID19_Participant32 -- true: 1 -- pred: 0
환자ID=COVID19_Participant36 -- true: 1 -- pred: 1
환자ID=COVID19_Participant5 -- true: 1 -- pred: 1
환자ID=Control_Participant13 -- true: 0 -- pred: 0
환자ID=Control_Participant15 -- true: 0 -- pred: 0
환자ID=Control_Participant3 -- true: 0 -- pred: 0
Best performance: Epoch 46, Loss 0.221275, Test ACC 0.800000, Test AUC 0.904762, Test Recall 0.714286, Test Precision 1.000000
Confusion Matrix:
 [3 0 2 5]
✅ Total valid splits used: 2
🔁 Repeat 0, Fold 2
cell type :  GTCGGGGGGTGG_Control_Participant7     Developing Ciliated Cells
CAAATCAATTAT_Control_Participant7     Developing Ciliated Cells
ATACAATTGACA_Control_Participant7     Developing Ciliated Cells
CTGTTAATGAGA_Control_Participant7     Developing Ciliated Cells
CTTCACATTATT_Control_Participant7     Developing Ciliated Cells
                                                ...            
GCAGGGAACTCC_COVID19_Participant30               Squamous Cells
CAGCACCGAGCC_COVID19_Participant30               Squamous Cells
GCCCCTTGTGAT_COVID19_Participant30               Squamous Cells
GTGTTGTGTGTC_COVID19_Participant30               Squamous Cells
TAACACTCACTT_COVID19_Participant30               Squamous Cells
Name: manual_annotation, Length: 22316, dtype: string
cell type annotation :  GTCGGGGGGTGG_Control_Participant7     Developing Ciliated Cells
CAAATCAATTAT_Control_Participant7     Developing Ciliated Cells
ATACAATTGACA_Control_Participant7     Developing Ciliated Cells
CTGTTAATGAGA_Control_Participant7     Developing Ciliated Cells
CTTCACATTATT_Control_Participant7     Developing Ciliated Cells
                                                ...            
GCAGGGAACTCC_COVID19_Participant30               Squamous Cells
CAGCACCGAGCC_COVID19_Participant30               Squamous Cells
GCCCCTTGTGAT_COVID19_Participant30               Squamous Cells
GTGTTGTGTGTC_COVID19_Participant30               Squamous Cells
TAACACTCACTT_COVID19_Participant30               Squamous Cells
Name: manual_annotation, Length: 22316, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Developing Ciliated Cells', 'Ciliated Cells', 'Secretory Cells', 'Squamous Cells', 'Goblet Cells', 'T Cells', 'Dendritic Cells', 'Basal Cells', 'Deuterosomal Cells', 'Mitotic Basal Cells', 'Macrophages', 'B Cells', 'Ionocytes', 'Developing Secretory and Goblet Cells', 'Plasmacytoid DCs', 'Enteroendocrine Cells', 'Erythroblasts', 'Mast Cells']
라벨별 그룹 개수 {1: 28, 0: 12}
cell type :  CGAACGGACTCC_Control_Participant12                           Squamous Cells
GTGTCCTGGGGT_Control_Participant12    Developing Secretory and Goblet Cells
ATTTGCCTGTCG_Control_Participant12                             Goblet Cells
TCTCTAAAGTGT_Control_Participant12                           Ciliated Cells
TAGAGACAACGA_Control_Participant12    Developing Secretory and Goblet Cells
                                                      ...                  
GCGCCCGTGTTA_COVID19_Participant27                             Goblet Cells
TTGATCCGTGGC_COVID19_Participant27                                  T Cells
CGCGACTACTCT_COVID19_Participant27                          Secretory Cells
AAACGCTTGTTA_COVID19_Participant27                           Ciliated Cells
CATTGGGGGAAA_COVID19_Participant27                          Secretory Cells
Name: manual_annotation, Length: 4631, dtype: string
cell type annotation :  CGAACGGACTCC_Control_Participant12                           Squamous Cells
GTGTCCTGGGGT_Control_Participant12    Developing Secretory and Goblet Cells
ATTTGCCTGTCG_Control_Participant12                             Goblet Cells
TCTCTAAAGTGT_Control_Participant12                           Ciliated Cells
TAGAGACAACGA_Control_Participant12    Developing Secretory and Goblet Cells
                                                      ...                  
GCGCCCGTGTTA_COVID19_Participant27                             Goblet Cells
TTGATCCGTGGC_COVID19_Participant27                                  T Cells
CGCGACTACTCT_COVID19_Participant27                          Secretory Cells
AAACGCTTGTTA_COVID19_Participant27                           Ciliated Cells
CATTGGGGGAAA_COVID19_Participant27                          Secretory Cells
Name: manual_annotation, Length: 4631, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Squamous Cells', 'Developing Secretory and Goblet Cells', 'Goblet Cells', 'Ciliated Cells', 'Basal Cells', 'Developing Ciliated Cells', 'T Cells', 'Ionocytes', 'Enteroendocrine Cells', 'Secretory Cells', 'Dendritic Cells', 'B Cells', 'Mitotic Basal Cells', 'Macrophages', 'Deuterosomal Cells', 'Mast Cells', 'Plasmacytoid DCs', 'Erythroblasts']
라벨별 그룹 개수 {1: 7, 0: 3}
🔍 Split #3
  → train_p_index 환자 수 (환자 단위로 묶인 index list): 40
  → test_p_index 환자 수  (환자 단위로 묶인 index list): 10
  → train 환자 ID: ['COVID19_Participant10', 'COVID19_Participant11', 'COVID19_Participant12', 'COVID19_Participant13', 'COVID19_Participant15', 'COVID19_Participant17', 'COVID19_Participant18', 'COVID19_Participant19', 'COVID19_Participant20', 'COVID19_Participant21', 'COVID19_Participant22', 'COVID19_Participant25', 'COVID19_Participant26', 'COVID19_Participant28', 'COVID19_Participant29', 'COVID19_Participant3', 'COVID19_Participant30', 'COVID19_Participant31', 'COVID19_Participant32', 'COVID19_Participant35', 'COVID19_Participant36', 'COVID19_Participant37', 'COVID19_Participant39', 'COVID19_Participant40', 'COVID19_Participant5', 'COVID19_Participant6', 'COVID19_Participant7', 'COVID19_Participant8', 'Control_Participant1', 'Control_Participant10', 'Control_Participant13', 'Control_Participant14', 'Control_Participant15', 'Control_Participant2', 'Control_Participant3', 'Control_Participant5', 'Control_Participant6', 'Control_Participant7', 'Control_Participant8', 'Control_Participant9']
  → test  환자 ID: ['COVID19_Participant14', 'COVID19_Participant2', 'COVID19_Participant23', 'COVID19_Participant27', 'COVID19_Participant38', 'COVID19_Participant4', 'COVID19_Participant9', 'Control_Participant11', 'Control_Participant12', 'Control_Participant4']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant10, Label: 1
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant12, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant18, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant21, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant3, Label: 1
    ID: COVID19_Participant30, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant35, Label: 1
    ID: COVID19_Participant36, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: COVID19_Participant5, Label: 1
    ID: COVID19_Participant6, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant10, Label: 0
    ID: Control_Participant13, Label: 0
    ID: Control_Participant14, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant2, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant6, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant8, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant27, Label: 1
    ID: COVID19_Participant38, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant9, Label: 1
    ID: Control_Participant11, Label: 0
    ID: Control_Participant12, Label: 0
    ID: Control_Participant4, Label: 0
전체 데이터 index 길이 50
label_stat (train 환자 라벨 목록) 갯수 40
train_data에서 환자 단위로, train과 validation 나누기
기존 train_p_index 40
기존 (train) label_stat 40
train-vali 분할 후! 
train y 의 classes : {0, 1} valid y 의 classes : {0, 1} label_stat 의 classes : {0, 1}
train_p_index_ 26
valid_p_index 14
test_p_index 10
→ train 환자 ID 및 라벨:
   총 개수: 26
   환자ID=Control_Participant10, Label=0, 셀개수=1645
   환자ID=Control_Participant2, Label=0, 셀개수=41
   환자ID=COVID19_Participant18, Label=1, 셀개수=227
   환자ID=COVID19_Participant37, Label=1, 셀개수=668
   환자ID=COVID19_Participant10, Label=1, 셀개수=18
   환자ID=Control_Participant6, Label=0, 셀개수=131
   환자ID=COVID19_Participant13, Label=1, 셀개수=730
   환자ID=COVID19_Participant19, Label=1, 셀개수=816
   환자ID=COVID19_Participant40, Label=1, 셀개수=381
   환자ID=COVID19_Participant12, Label=1, 셀개수=102
   환자ID=COVID19_Participant20, Label=1, 셀개수=2033
   환자ID=Control_Participant3, Label=0, 셀개수=1620
   환자ID=COVID19_Participant28, Label=1, 셀개수=1079
   환자ID=Control_Participant8, Label=0, 셀개수=393
   환자ID=Control_Participant7, Label=0, 셀개수=762
   환자ID=COVID19_Participant15, Label=1, 셀개수=1003
   환자ID=Control_Participant9, Label=0, 셀개수=558
   환자ID=Control_Participant13, Label=0, 셀개수=88
   환자ID=COVID19_Participant22, Label=1, 셀개수=865
   환자ID=COVID19_Participant30, Label=1, 셀개수=116
   환자ID=COVID19_Participant26, Label=1, 셀개수=814
   환자ID=COVID19_Participant17, Label=1, 셀개수=843
   환자ID=COVID19_Participant6, Label=1, 셀개수=84
   환자ID=COVID19_Participant39, Label=1, 셀개수=454
   환자ID=COVID19_Participant36, Label=1, 셀개수=200
   환자ID=COVID19_Participant3, Label=1, 셀개수=104
→ valid 환자 ID 및 라벨:
   총 개수: 14
   환자ID=Control_Participant15, Label=0, 셀개수=528
   환자ID=COVID19_Participant29, Label=1, 셀개수=573
   환자ID=COVID19_Participant32, Label=1, 셀개수=1665
   환자ID=COVID19_Participant31, Label=1, 셀개수=410
   환자ID=COVID19_Participant5, Label=1, 셀개수=89
   환자ID=COVID19_Participant21, Label=1, 셀개수=39
   환자ID=Control_Participant5, Label=0, 셀개수=717
   환자ID=Control_Participant1, Label=0, 셀개수=414
   환자ID=COVID19_Participant8, Label=1, 셀개수=462
   환자ID=COVID19_Participant7, Label=1, 셀개수=409
   환자ID=Control_Participant14, Label=0, 셀개수=274
   환자ID=COVID19_Participant35, Label=1, 셀개수=83
   환자ID=COVID19_Participant11, Label=1, 셀개수=382
   환자ID=COVID19_Participant25, Label=1, 셀개수=496
→ test 환자 ID 및 라벨:
   총 개수: 10
   환자ID=COVID19_Participant14, Label=1, 셀개수=382
   환자ID=COVID19_Participant2, Label=1, 셀개수=329
   환자ID=COVID19_Participant23, Label=1, 셀개수=307
   환자ID=COVID19_Participant27, Label=1, 셀개수=93
   환자ID=COVID19_Participant38, Label=1, 셀개수=51
   환자ID=COVID19_Participant4, Label=1, 셀개수=1680
   환자ID=COVID19_Participant9, Label=1, 셀개수=86
   환자ID=Control_Participant11, Label=0, 셀개수=1164
   환자ID=Control_Participant12, Label=0, 셀개수=99
   환자ID=Control_Participant4, Label=0, 셀개수=440
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Ciliated Cells', 'Developing Ciliated Cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
전체 데이터 길이 26947
전체 cell type 길이 0        Developing Ciliated Cells
1        Developing Ciliated Cells
2        Developing Ciliated Cells
3        Developing Ciliated Cells
4        Developing Ciliated Cells
                   ...            
26942                 Goblet Cells
26943                      T Cells
26944              Secretory Cells
26945               Ciliated Cells
26946              Secretory Cells
Length: 26947, dtype: string
cell type의 NaN 개수 체크 0
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:10,  9.26it/s]  2%|▏         | 2/100 [00:00<00:11,  8.75it/s]  3%|▎         | 3/100 [00:00<00:10,  8.95it/s]  4%|▍         | 4/100 [00:00<00:12,  7.44it/s]  5%|▌         | 5/100 [00:00<00:12,  7.84it/s]  6%|▌         | 6/100 [00:00<00:11,  7.90it/s]  8%|▊         | 8/100 [00:00<00:10,  8.73it/s]  9%|▉         | 9/100 [00:01<00:10,  8.98it/s] 10%|█         | 10/100 [00:01<00:10,  8.94it/s] 11%|█         | 11/100 [00:01<00:09,  9.20it/s] 12%|█▏        | 12/100 [00:01<00:09,  9.00it/s] 14%|█▍        | 14/100 [00:01<00:09,  9.28it/s] 15%|█▌        | 15/100 [00:01<00:10,  8.44it/s] 16%|█▌        | 16/100 [00:01<00:09,  8.75it/s] 17%|█▋        | 17/100 [00:01<00:09,  8.82it/s] 18%|█▊        | 18/100 [00:02<00:09,  8.99it/s] 19%|█▉        | 19/100 [00:02<00:08,  9.01it/s] 20%|██        | 20/100 [00:02<00:09,  8.59it/s] 21%|██        | 21/100 [00:02<00:08,  8.84it/s] 22%|██▏       | 22/100 [00:02<00:09,  8.57it/s] 23%|██▎       | 23/100 [00:02<00:08,  8.74it/s] 24%|██▍       | 24/100 [00:02<00:09,  8.22it/s] 25%|██▌       | 25/100 [00:02<00:08,  8.53it/s] 27%|██▋       | 27/100 [00:03<00:08,  8.92it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.77it/s] 29%|██▉       | 29/100 [00:03<00:08,  8.22it/s] 30%|███       | 30/100 [00:03<00:10,  6.94it/s] 31%|███       | 31/100 [00:03<00:09,  7.53it/s] 32%|███▏      | 32/100 [00:03<00:08,  7.83it/s] 33%|███▎      | 33/100 [00:03<00:09,  7.24it/s] 34%|███▍      | 34/100 [00:04<00:10,  6.05it/s] 35%|███▌      | 35/100 [00:04<00:09,  6.78it/s] 36%|███▌      | 36/100 [00:04<00:08,  7.38it/s] 38%|███▊      | 38/100 [00:04<00:08,  7.41it/s] 39%|███▉      | 39/100 [00:04<00:07,  7.90it/s] 40%|████      | 40/100 [00:04<00:07,  8.29it/s] 41%|████      | 41/100 [00:04<00:07,  8.38it/s] 42%|████▏     | 42/100 [00:05<00:06,  8.77it/s] 43%|████▎     | 43/100 [00:05<00:06,  9.00it/s] 44%|████▍     | 44/100 [00:05<00:06,  9.05it/s] 45%|████▌     | 45/100 [00:05<00:06,  9.06it/s] 46%|████▌     | 46/100 [00:05<00:06,  8.67it/s] 48%|████▊     | 48/100 [00:05<00:05,  8.93it/s] 49%|████▉     | 49/100 [00:05<00:05,  8.53it/s] 50%|█████     | 50/100 [00:06<00:05,  8.38it/s] 51%|█████     | 51/100 [00:06<00:05,  8.72it/s] 52%|█████▏    | 52/100 [00:06<00:06,  7.68it/s] 53%|█████▎    | 53/100 [00:06<00:05,  8.11it/s] 54%|█████▍    | 54/100 [00:06<00:07,  6.46it/s] 55%|█████▌    | 55/100 [00:06<00:06,  7.14it/s] 56%|█████▌    | 56/100 [00:06<00:05,  7.58it/s] 57%|█████▋    | 57/100 [00:06<00:05,  8.06it/s] 58%|█████▊    | 58/100 [00:07<00:05,  7.76it/s] 59%|█████▉    | 59/100 [00:07<00:05,  7.85it/s] 60%|██████    | 60/100 [00:07<00:04,  8.23it/s] 61%|██████    | 61/100 [00:07<00:05,  6.74it/s] 62%|██████▏   | 62/100 [00:07<00:05,  7.28it/s] 63%|██████▎   | 63/100 [00:07<00:05,  7.17it/s] 64%|██████▍   | 64/100 [00:07<00:05,  6.18it/s] 65%|██████▌   | 65/100 [00:08<00:05,  6.88it/s] 66%|██████▌   | 66/100 [00:08<00:06,  5.54it/s] 67%|██████▋   | 67/100 [00:08<00:05,  6.25it/s] 68%|██████▊   | 68/100 [00:08<00:04,  6.82it/s] 69%|██████▉   | 69/100 [00:08<00:04,  7.38it/s] 71%|███████   | 71/100 [00:08<00:04,  7.07it/s] 72%|███████▏  | 72/100 [00:09<00:03,  7.54it/s] 73%|███████▎  | 73/100 [00:09<00:05,  5.33it/s] 74%|███████▍  | 74/100 [00:09<00:04,  5.85it/s] 75%|███████▌  | 75/100 [00:09<00:04,  6.05it/s] 76%|███████▌  | 76/100 [00:09<00:03,  6.80it/s] 77%|███████▋  | 77/100 [00:09<00:03,  6.99it/s] 78%|███████▊  | 78/100 [00:10<00:03,  7.10it/s] 79%|███████▉  | 79/100 [00:10<00:02,  7.30it/s] 80%|████████  | 80/100 [00:10<00:02,  7.82it/s] 81%|████████  | 81/100 [00:10<00:02,  8.25it/s] 82%|████████▏ | 82/100 [00:10<00:02,  8.04it/s] 83%|████████▎ | 83/100 [00:10<00:01,  8.51it/s] 84%|████████▍ | 84/100 [00:10<00:02,  7.27it/s] 85%|████████▌ | 85/100 [00:11<00:02,  5.41it/s] 86%|████████▌ | 86/100 [00:11<00:02,  6.19it/s] 87%|████████▋ | 87/100 [00:11<00:01,  6.92it/s] 89%|████████▉ | 89/100 [00:11<00:01,  8.03it/s] 90%|█████████ | 90/100 [00:11<00:01,  7.35it/s] 91%|█████████ | 91/100 [00:11<00:01,  6.21it/s] 92%|█████████▏| 92/100 [00:12<00:01,  6.78it/s] 93%|█████████▎| 93/100 [00:12<00:00,  7.27it/s] 95%|█████████▌| 95/100 [00:12<00:00,  8.16it/s] 96%|█████████▌| 96/100 [00:12<00:00,  8.33it/s] 97%|█████████▋| 97/100 [00:12<00:00,  8.46it/s] 98%|█████████▊| 98/100 [00:12<00:00,  7.80it/s] 99%|█████████▉| 99/100 [00:12<00:00,  7.63it/s]100%|██████████| 100/100 [00:13<00:00,  7.36it/s]100%|██████████| 100/100 [00:13<00:00,  7.66it/s]
[I 2025-08-30 04:35:31,771] A new study created in memory with name: no-name-f2127f41-c0ba-468b-a7c7-65393a06b8ef
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 46.00 MB
cuda
Epoch 1, Train Loss 0.694818, Valid_loss 0.671846
Epoch 2, Train Loss 0.656487, Valid_loss 0.680958
Epoch 3, Train Loss 0.675518, Valid_loss 0.696638
Epoch 4, Train Loss 0.647874, Valid_loss 0.690230
Epoch 5, Train Loss 0.671889, Valid_loss 0.701406
Epoch 6, Train Loss 0.651599, Valid_loss 0.720920
Epoch 7, Train Loss 0.656610, Valid_loss 0.708655
Epoch 8, Train Loss 0.604892, Valid_loss 0.721683
Epoch 9, Train Loss 0.608396, Valid_loss 0.765937
Epoch 10, Train Loss 0.577702, Valid_loss 0.828412
Epoch 11, Train Loss 0.606286, Valid_loss 0.815567
Epoch 12, Train Loss 0.585864, Valid_loss 0.837084
Epoch 13, Train Loss 0.596557, Valid_loss 0.863147
Epoch 14, Train Loss 0.562194, Valid_loss 0.888690
Epoch 15, Train Loss 0.579536, Valid_loss 0.898652
Epoch 16, Train Loss 0.548690, Valid_loss 0.912172
Epoch 17, Train Loss 0.570592, Valid_loss 0.899630
Epoch 18, Train Loss 0.578106, Valid_loss 0.926482
Epoch 19, Train Loss 0.570987, Valid_loss 0.886352
Epoch 20, Train Loss 0.572135, Valid_loss 0.874041
Epoch 21, Train Loss 0.571599, Valid_loss 0.894829
Epoch 22, Train Loss 0.570731, Valid_loss 0.897073
Epoch 23, Train Loss 0.569018, Valid_loss 0.917551
Epoch 24, Train Loss 0.538915, Valid_loss 0.902423
Epoch 25, Train Loss 0.536225, Valid_loss 0.882717
Epoch 26, Train Loss 0.580123, Valid_loss 0.875109
Epoch 27, Train Loss 0.574635, Valid_loss 0.881305
Epoch 28, Train Loss 0.565439, Valid_loss 0.869003
Epoch 29, Train Loss 0.552928, Valid_loss 0.883551
Epoch 30, Train Loss 0.540799, Valid_loss 0.901659
Epoch 31, Train Loss 0.572720, Valid_loss 0.882440
Epoch 32, Train Loss 0.542217, Valid_loss 0.910335
Epoch 33, Train Loss 0.570548, Valid_loss 0.885988
Epoch 34, Train Loss 0.556212, Valid_loss 0.881523
Epoch 35, Train Loss 0.573749, Valid_loss 0.909401
Epoch 36, Train Loss 0.544150, Valid_loss 0.878918
Epoch 37, Train Loss 0.541347, Valid_loss 0.917640
Epoch 38, Train Loss 0.555797, Valid_loss 0.889301
Epoch 39, Train Loss 0.559115, Valid_loss 0.868484
Epoch 40, Train Loss 0.552978, Valid_loss 0.869053
Epoch 41, Train Loss 0.568774, Valid_loss 0.895160
Epoch 42, Train Loss 0.531987, Valid_loss 0.849941
Epoch 43, Train Loss 0.520215, Valid_loss 0.882933
Epoch 44, Train Loss 0.555005, Valid_loss 0.906605
Epoch 45, Train Loss 0.517654, Valid_loss 0.846499
Epoch 46, Train Loss 0.546436, Valid_loss 0.917172
Epoch 47, Train Loss 0.577382, Valid_loss 0.834843
Epoch 48, Train Loss 0.572106, Valid_loss 0.864673
Epoch 49, Train Loss 0.540369, Valid_loss 0.879441
Epoch 50, Train Loss 0.548606, Valid_loss 0.844407
Epoch 51, Train Loss 0.503237, Valid_loss 0.871463
Epoch 52, Train Loss 0.527475, Valid_loss 0.881642
[I 2025-08-30 04:39:36,942] Trial 0 finished with value: 0.671845657484872 and parameters: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 4, 'dropout': 0.7, 'weight_decay': 0.01, 'emb_dim': 8, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.671845657484872.
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 46.00 MB
cuda
Epoch 1, Train Loss 0.696391, Valid_loss 0.599929
Epoch 2, Train Loss 0.768361, Valid_loss 0.598715
Epoch 3, Train Loss 0.700525, Valid_loss 0.600242
Epoch 4, Train Loss 0.699937, Valid_loss 0.600184
Epoch 5, Train Loss 0.680241, Valid_loss 0.600730
Epoch 6, Train Loss 0.701005, Valid_loss 0.601614
Epoch 7, Train Loss 0.644295, Valid_loss 0.591716
Epoch 8, Train Loss 0.637481, Valid_loss 0.593394
Epoch 9, Train Loss 0.670532, Valid_loss 0.599149
Epoch 10, Train Loss 0.614026, Valid_loss 0.587348
Epoch 11, Train Loss 0.604937, Valid_loss 0.574227
Epoch 12, Train Loss 0.601665, Valid_loss 0.581200
Epoch 13, Train Loss 0.616887, Valid_loss 0.579039
Epoch 14, Train Loss 0.577981, Valid_loss 0.577064
Epoch 15, Train Loss 0.603177, Valid_loss 0.583359
Epoch 16, Train Loss 0.582520, Valid_loss 0.575954
Epoch 17, Train Loss 0.590164, Valid_loss 0.578600
Epoch 18, Train Loss 0.597279, Valid_loss 0.573885
Epoch 19, Train Loss 0.578608, Valid_loss 0.573994
Epoch 20, Train Loss 0.610042, Valid_loss 0.593302
Epoch 21, Train Loss 0.550674, Valid_loss 0.579365
Epoch 22, Train Loss 0.597217, Valid_loss 0.571016
Epoch 23, Train Loss 0.567592, Valid_loss 0.567712
Epoch 24, Train Loss 0.581587, Valid_loss 0.571566
Epoch 25, Train Loss 0.587131, Valid_loss 0.579275
Epoch 26, Train Loss 0.562108, Valid_loss 0.576694
Epoch 27, Train Loss 0.528704, Valid_loss 0.581528
Epoch 28, Train Loss 0.530362, Valid_loss 0.575985
Epoch 29, Train Loss 0.563756, Valid_loss 0.575447
Epoch 30, Train Loss 0.565068, Valid_loss 0.577453
Epoch 31, Train Loss 0.559165, Valid_loss 0.564914
Epoch 32, Train Loss 0.554295, Valid_loss 0.562828
Epoch 33, Train Loss 0.523807, Valid_loss 0.581943
Epoch 34, Train Loss 0.555041, Valid_loss 0.571596
Epoch 35, Train Loss 0.541506, Valid_loss 0.557938
Epoch 36, Train Loss 0.528900, Valid_loss 0.563964
Epoch 37, Train Loss 0.520835, Valid_loss 0.561462
Epoch 38, Train Loss 0.547435, Valid_loss 0.558905
Epoch 39, Train Loss 0.546162, Valid_loss 0.572051
Epoch 40, Train Loss 0.539156, Valid_loss 0.572283
Epoch 41, Train Loss 0.531018, Valid_loss 0.558989
Epoch 42, Train Loss 0.573159, Valid_loss 0.560480
Epoch 43, Train Loss 0.565330, Valid_loss 0.563830
Epoch 44, Train Loss 0.524488, Valid_loss 0.549517
Epoch 45, Train Loss 0.539211, Valid_loss 0.555342
Epoch 46, Train Loss 0.547844, Valid_loss 0.552379
Epoch 47, Train Loss 0.490558, Valid_loss 0.547906
Epoch 48, Train Loss 0.528021, Valid_loss 0.540740
Epoch 49, Train Loss 0.552227, Valid_loss 0.572250
Epoch 50, Train Loss 0.518129, Valid_loss 0.548432
Epoch 51, Train Loss 0.549210, Valid_loss 0.541855
Epoch 52, Train Loss 0.559818, Valid_loss 0.545357
Epoch 53, Train Loss 0.541020, Valid_loss 0.545571
[I 2025-08-30 04:42:57,898] Trial 1 finished with value: 0.5407399130719048 and parameters: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 1, 'dropout': 0.7, 'weight_decay': 0.001, 'emb_dim': 8, 'augment_num': 100, 'pca': False}. Best is trial 1 with value: 0.5407399130719048.
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 46.00 MB
cuda
Epoch 1, Train Loss 0.685011, Valid_loss 0.626818
Epoch 2, Train Loss 0.639934, Valid_loss 0.717913
Epoch 3, Train Loss 0.600284, Valid_loss 0.578309
Epoch 4, Train Loss 0.493366, Valid_loss 0.490819
Epoch 5, Train Loss 0.490372, Valid_loss 0.485138
Epoch 6, Train Loss 0.478283, Valid_loss 0.602806
Epoch 7, Train Loss 0.481262, Valid_loss 0.640786
Epoch 8, Train Loss 0.494225, Valid_loss 0.507432
Epoch 9, Train Loss 0.470720, Valid_loss 0.496324
Epoch 10, Train Loss 0.443853, Valid_loss 0.544199
Epoch 11, Train Loss 0.436104, Valid_loss 0.421032
Epoch 12, Train Loss 0.567092, Valid_loss 0.440312
Epoch 13, Train Loss 0.426211, Valid_loss 0.676365
Epoch 14, Train Loss 0.468861, Valid_loss 0.931511
Epoch 15, Train Loss 0.491857, Valid_loss 0.533021
Epoch 16, Train Loss 0.450323, Valid_loss 0.586359
Epoch 17, Train Loss 0.464643, Valid_loss 0.452739
Epoch 18, Train Loss 0.391868, Valid_loss 0.706923
Epoch 19, Train Loss 0.477009, Valid_loss 0.415720
Epoch 20, Train Loss 0.390795, Valid_loss 0.545102
Epoch 21, Train Loss 0.368719, Valid_loss 0.488099
Epoch 22, Train Loss 0.386127, Valid_loss 0.482364
Epoch 23, Train Loss 0.362797, Valid_loss 0.532302
Epoch 24, Train Loss 0.395248, Valid_loss 0.548920
Epoch 25, Train Loss 0.386784, Valid_loss 0.476665
Epoch 26, Train Loss 0.415861, Valid_loss 0.473399
Epoch 27, Train Loss 0.473582, Valid_loss 0.458692
Epoch 28, Train Loss 0.405195, Valid_loss 0.492812
Epoch 29, Train Loss 0.359650, Valid_loss 0.521004
Epoch 30, Train Loss 0.352244, Valid_loss 0.505458
Epoch 31, Train Loss 0.381355, Valid_loss 0.541988
Epoch 32, Train Loss 0.365990, Valid_loss 0.596348
Epoch 33, Train Loss 0.400832, Valid_loss 0.492432
Epoch 34, Train Loss 0.383503, Valid_loss 0.416983
Epoch 35, Train Loss 0.409474, Valid_loss 0.463871
Epoch 36, Train Loss 0.327463, Valid_loss 0.539358
Epoch 37, Train Loss 0.363840, Valid_loss 0.439269
Epoch 38, Train Loss 0.364583, Valid_loss 0.426999
Epoch 39, Train Loss 0.427159, Valid_loss 0.593653
Epoch 40, Train Loss 0.386972, Valid_loss 0.447157
Epoch 41, Train Loss 0.377891, Valid_loss 0.570602
Epoch 42, Train Loss 0.390530, Valid_loss 0.628422
Epoch 43, Train Loss 0.372961, Valid_loss 0.489152
Epoch 44, Train Loss 0.383304, Valid_loss 0.471791
Epoch 45, Train Loss 0.348303, Valid_loss 0.484421
Epoch 46, Train Loss 0.332917, Valid_loss 0.515018
Epoch 47, Train Loss 0.353619, Valid_loss 0.405568
Epoch 48, Train Loss 0.430582, Valid_loss 0.419917
Epoch 49, Train Loss 0.375600, Valid_loss 0.421313
Epoch 50, Train Loss 0.398481, Valid_loss 0.453195
Epoch 51, Train Loss 0.371977, Valid_loss 0.447541
Epoch 52, Train Loss 0.374034, Valid_loss 0.486891
Epoch 53, Train Loss 0.349525, Valid_loss 0.441461
Epoch 54, Train Loss 0.353139, Valid_loss 0.480224
Epoch 55, Train Loss 0.381709, Valid_loss 0.488118
[I 2025-08-30 04:46:26,457] Trial 2 finished with value: 0.40556780089225086 and parameters: {'learning_rate': 0.01, 'epochs': 100, 'heads': 1, 'dropout': 0.5, 'weight_decay': 0.01, 'emb_dim': 8, 'augment_num': 100, 'pca': False}. Best is trial 2 with value: 0.40556780089225086.
선택된 trial params: {'learning_rate': 0.01, 'epochs': 100, 'heads': 1, 'dropout': 0.5, 'weight_decay': 0.01, 'emb_dim': 8, 'augment_num': 100, 'pca': False}
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=10, batch_size=1 -> steps=10
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 46.00 MB
cuda
Epoch 1, Train Loss 0.728198, Valid_loss 0.614838
Epoch 2, Train Loss 0.596606, Valid_loss 0.610212
Epoch 3, Train Loss 0.586286, Valid_loss 0.746093
Epoch 4, Train Loss 0.503272, Valid_loss 0.573740
Epoch 5, Train Loss 0.509895, Valid_loss 0.680597
Epoch 6, Train Loss 0.508181, Valid_loss 0.468008
Epoch 7, Train Loss 0.466694, Valid_loss 0.546348
Epoch 8, Train Loss 0.417363, Valid_loss 0.849654
Epoch 9, Train Loss 0.451802, Valid_loss 0.727542
Epoch 10, Train Loss 0.455058, Valid_loss 0.464691
Epoch 11, Train Loss 0.447849, Valid_loss 0.510134
Epoch 12, Train Loss 0.438380, Valid_loss 0.537637
Epoch 13, Train Loss 0.393787, Valid_loss 0.447810
Epoch 14, Train Loss 0.510106, Valid_loss 0.494816
Epoch 15, Train Loss 0.465507, Valid_loss 0.531286
Epoch 16, Train Loss 0.591982, Valid_loss 0.594761
Epoch 17, Train Loss 0.461861, Valid_loss 0.559381
Epoch 18, Train Loss 0.449273, Valid_loss 0.473621
Epoch 19, Train Loss 0.388020, Valid_loss 0.476964
Epoch 20, Train Loss 0.402718, Valid_loss 0.480702
Epoch 21, Train Loss 0.406700, Valid_loss 0.643523
Epoch 22, Train Loss 0.372378, Valid_loss 0.456674
Epoch 23, Train Loss 0.391051, Valid_loss 0.432523
Epoch 24, Train Loss 0.419278, Valid_loss 0.454865
Epoch 25, Train Loss 0.435148, Valid_loss 0.767569
Epoch 26, Train Loss 0.404758, Valid_loss 0.539735
Epoch 27, Train Loss 0.399533, Valid_loss 0.540614
Epoch 28, Train Loss 0.383612, Valid_loss 0.461364
Epoch 29, Train Loss 0.348489, Valid_loss 0.504351
Epoch 30, Train Loss 0.362344, Valid_loss 0.385536
Epoch 31, Train Loss 0.358427, Valid_loss 0.513520
Epoch 32, Train Loss 0.398923, Valid_loss 0.616775
Epoch 33, Train Loss 0.347383, Valid_loss 0.456157
Epoch 34, Train Loss 0.427386, Valid_loss 0.427949
Epoch 35, Train Loss 0.385461, Valid_loss 0.521999
Epoch 36, Train Loss 0.334031, Valid_loss 0.442750
Epoch 37, Train Loss 0.391026, Valid_loss 0.581593
Epoch 38, Train Loss 0.328525, Valid_loss 0.534832
Epoch 39, Train Loss 0.376500, Valid_loss 0.434827
Epoch 40, Train Loss 0.341550, Valid_loss 0.691376
Epoch 41, Train Loss 0.361291, Valid_loss 0.661721
Epoch 42, Train Loss 0.366785, Valid_loss 0.486893
Epoch 43, Train Loss 0.389147, Valid_loss 0.522292
Epoch 44, Train Loss 0.352299, Valid_loss 0.544014
Epoch 45, Train Loss 0.398149, Valid_loss 0.483463
Epoch 46, Train Loss 0.342396, Valid_loss 0.511512
Epoch 47, Train Loss 0.365089, Valid_loss 0.586664
Epoch 48, Train Loss 0.351037, Valid_loss 0.576967
Epoch 49, Train Loss 0.390759, Valid_loss 0.505415
Epoch 50, Train Loss 0.386617, Valid_loss 0.504402
Epoch 51, Train Loss 0.349225, Valid_loss 0.591294
Epoch 52, Train Loss 0.375463, Valid_loss 0.654110
환자ID=COVID19_Participant14 -- true: 1 -- pred: 1
환자ID=COVID19_Participant2 -- true: 1 -- pred: 1
환자ID=COVID19_Participant23 -- true: 1 -- pred: 1
환자ID=COVID19_Participant27 -- true: 1 -- pred: 1
환자ID=COVID19_Participant38 -- true: 1 -- pred: 0
환자ID=COVID19_Participant4 -- true: 1 -- pred: 1
환자ID=COVID19_Participant9 -- true: 1 -- pred: 1
환자ID=Control_Participant11 -- true: 0 -- pred: 0
환자ID=Control_Participant12 -- true: 0 -- pred: 0
환자ID=Control_Participant4 -- true: 0 -- pred: 0
Best performance: Epoch 30, Loss 0.362344, Test ACC 0.900000, Test AUC 1.000000, Test Recall 0.857143, Test Precision 1.000000
Confusion Matrix:
 [3 0 1 6]
✅ Total valid splits used: 3
🔁 Repeat 0, Fold 3
cell type :  GTCGGGGGGTGG_Control_Participant7     Developing Ciliated Cells
CAAATCAATTAT_Control_Participant7     Developing Ciliated Cells
ATACAATTGACA_Control_Participant7     Developing Ciliated Cells
CTGTTAATGAGA_Control_Participant7     Developing Ciliated Cells
CTTCACATTATT_Control_Participant7     Developing Ciliated Cells
                                                ...            
GCAGGGAACTCC_COVID19_Participant30               Squamous Cells
CAGCACCGAGCC_COVID19_Participant30               Squamous Cells
GCCCCTTGTGAT_COVID19_Participant30               Squamous Cells
GTGTTGTGTGTC_COVID19_Participant30               Squamous Cells
TAACACTCACTT_COVID19_Participant30               Squamous Cells
Name: manual_annotation, Length: 21028, dtype: string
cell type annotation :  GTCGGGGGGTGG_Control_Participant7     Developing Ciliated Cells
CAAATCAATTAT_Control_Participant7     Developing Ciliated Cells
ATACAATTGACA_Control_Participant7     Developing Ciliated Cells
CTGTTAATGAGA_Control_Participant7     Developing Ciliated Cells
CTTCACATTATT_Control_Participant7     Developing Ciliated Cells
                                                ...            
GCAGGGAACTCC_COVID19_Participant30               Squamous Cells
CAGCACCGAGCC_COVID19_Participant30               Squamous Cells
GCCCCTTGTGAT_COVID19_Participant30               Squamous Cells
GTGTTGTGTGTC_COVID19_Participant30               Squamous Cells
TAACACTCACTT_COVID19_Participant30               Squamous Cells
Name: manual_annotation, Length: 21028, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Developing Ciliated Cells', 'Ciliated Cells', 'Secretory Cells', 'Squamous Cells', 'Goblet Cells', 'T Cells', 'Dendritic Cells', 'Basal Cells', 'Deuterosomal Cells', 'Mitotic Basal Cells', 'Macrophages', 'B Cells', 'Ionocytes', 'Developing Secretory and Goblet Cells', 'Plasmacytoid DCs', 'Enteroendocrine Cells', 'Erythroblasts', 'Mast Cells']
라벨별 그룹 개수 {1: 28, 0: 12}
cell type :  CGAATCAAGGCC_COVID19_Participant26    Secretory Cells
ACGCCCTTCAAC_COVID19_Participant26    Secretory Cells
ACCATATTGCTT_COVID19_Participant26     Ciliated Cells
AAACCTCCGGGA_COVID19_Participant26     Ciliated Cells
TACGCGCCGAAC_COVID19_Participant26     Ciliated Cells
                                           ...       
CAGGTTGGTATC_COVID19_Participant20    Secretory Cells
TATAGCTTGGTA_COVID19_Participant20    Secretory Cells
TTGTTAGACGGT_COVID19_Participant20            T Cells
ATGGCTCAGGCT_COVID19_Participant20    Secretory Cells
ACATGATCCTTT_COVID19_Participant20    Secretory Cells
Name: manual_annotation, Length: 5919, dtype: string
cell type annotation :  CGAATCAAGGCC_COVID19_Participant26    Secretory Cells
ACGCCCTTCAAC_COVID19_Participant26    Secretory Cells
ACCATATTGCTT_COVID19_Participant26     Ciliated Cells
AAACCTCCGGGA_COVID19_Participant26     Ciliated Cells
TACGCGCCGAAC_COVID19_Participant26     Ciliated Cells
                                           ...       
CAGGTTGGTATC_COVID19_Participant20    Secretory Cells
TATAGCTTGGTA_COVID19_Participant20    Secretory Cells
TTGTTAGACGGT_COVID19_Participant20            T Cells
ATGGCTCAGGCT_COVID19_Participant20    Secretory Cells
ACATGATCCTTT_COVID19_Participant20    Secretory Cells
Name: manual_annotation, Length: 5919, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Secretory Cells', 'Ciliated Cells', 'Squamous Cells', 'Goblet Cells', 'Macrophages', 'Basal Cells', 'Deuterosomal Cells', 'Developing Ciliated Cells', 'Ionocytes', 'Mitotic Basal Cells', 'Enteroendocrine Cells', 'Developing Secretory and Goblet Cells', 'T Cells', 'B Cells', 'Dendritic Cells', 'Erythroblasts', 'Mast Cells']
라벨별 그룹 개수 {1: 7, 0: 3}
🔍 Split #4
  → train_p_index 환자 수 (환자 단위로 묶인 index list): 40
  → test_p_index 환자 수  (환자 단위로 묶인 index list): 10
  → train 환자 ID: ['COVID19_Participant10', 'COVID19_Participant11', 'COVID19_Participant12', 'COVID19_Participant13', 'COVID19_Participant14', 'COVID19_Participant15', 'COVID19_Participant17', 'COVID19_Participant18', 'COVID19_Participant2', 'COVID19_Participant22', 'COVID19_Participant23', 'COVID19_Participant25', 'COVID19_Participant27', 'COVID19_Participant28', 'COVID19_Participant3', 'COVID19_Participant30', 'COVID19_Participant31', 'COVID19_Participant32', 'COVID19_Participant35', 'COVID19_Participant36', 'COVID19_Participant37', 'COVID19_Participant38', 'COVID19_Participant39', 'COVID19_Participant4', 'COVID19_Participant40', 'COVID19_Participant5', 'COVID19_Participant8', 'COVID19_Participant9', 'Control_Participant1', 'Control_Participant10', 'Control_Participant11', 'Control_Participant12', 'Control_Participant13', 'Control_Participant14', 'Control_Participant15', 'Control_Participant3', 'Control_Participant4', 'Control_Participant6', 'Control_Participant7', 'Control_Participant9']
  → test  환자 ID: ['COVID19_Participant19', 'COVID19_Participant20', 'COVID19_Participant21', 'COVID19_Participant26', 'COVID19_Participant29', 'COVID19_Participant6', 'COVID19_Participant7', 'Control_Participant2', 'Control_Participant5', 'Control_Participant8']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant10, Label: 1
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant12, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant18, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant27, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant3, Label: 1
    ID: COVID19_Participant30, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant35, Label: 1
    ID: COVID19_Participant36, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant38, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: COVID19_Participant5, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: COVID19_Participant9, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant10, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant12, Label: 0
    ID: Control_Participant13, Label: 0
    ID: Control_Participant14, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant4, Label: 0
    ID: Control_Participant6, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant21, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant6, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: Control_Participant2, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant8, Label: 0
전체 데이터 index 길이 50
label_stat (train 환자 라벨 목록) 갯수 40
train_data에서 환자 단위로, train과 validation 나누기
기존 train_p_index 40
기존 (train) label_stat 40
train-vali 분할 후! 
train y 의 classes : {0, 1} valid y 의 classes : {0, 1} label_stat 의 classes : {0, 1}
train_p_index_ 26
valid_p_index 14
test_p_index 10
→ train 환자 ID 및 라벨:
   총 개수: 26
   환자ID=Control_Participant10, Label=0, 셀개수=1645
   환자ID=Control_Participant14, Label=0, 셀개수=274
   환자ID=COVID19_Participant17, Label=1, 셀개수=843
   환자ID=COVID19_Participant38, Label=1, 셀개수=51
   환자ID=COVID19_Participant10, Label=1, 셀개수=18
   환자ID=Control_Participant4, Label=0, 셀개수=440
   환자ID=COVID19_Participant13, Label=1, 셀개수=730
   환자ID=COVID19_Participant18, Label=1, 셀개수=227
   환자ID=COVID19_Participant4, Label=1, 셀개수=1680
   환자ID=COVID19_Participant12, Label=1, 셀개수=102
   환자ID=COVID19_Participant2, Label=1, 셀개수=329
   환자ID=Control_Participant15, Label=0, 셀개수=528
   환자ID=COVID19_Participant28, Label=1, 셀개수=1079
   환자ID=Control_Participant7, Label=0, 셀개수=762
   환자ID=Control_Participant6, Label=0, 셀개수=131
   환자ID=COVID19_Participant14, Label=1, 셀개수=382
   환자ID=Control_Participant9, Label=0, 셀개수=558
   환자ID=Control_Participant11, Label=0, 셀개수=1164
   환자ID=COVID19_Participant23, Label=1, 셀개수=307
   환자ID=COVID19_Participant31, Label=1, 셀개수=410
   환자ID=COVID19_Participant27, Label=1, 셀개수=93
   환자ID=COVID19_Participant15, Label=1, 셀개수=1003
   환자ID=COVID19_Participant5, Label=1, 셀개수=89
   환자ID=COVID19_Participant39, Label=1, 셀개수=454
   환자ID=COVID19_Participant37, Label=1, 셀개수=668
   환자ID=COVID19_Participant30, Label=1, 셀개수=116
→ valid 환자 ID 및 라벨:
   총 개수: 14
   환자ID=Control_Participant13, Label=0, 셀개수=88
   환자ID=COVID19_Participant3, Label=1, 셀개수=104
   환자ID=COVID19_Participant35, Label=1, 셀개수=83
   환자ID=COVID19_Participant32, Label=1, 셀개수=1665
   환자ID=COVID19_Participant40, Label=1, 셀개수=381
   환자ID=COVID19_Participant22, Label=1, 셀개수=865
   환자ID=Control_Participant3, Label=0, 셀개수=1620
   환자ID=Control_Participant1, Label=0, 셀개수=414
   환자ID=COVID19_Participant9, Label=1, 셀개수=86
   환자ID=COVID19_Participant8, Label=1, 셀개수=462
   환자ID=Control_Participant12, Label=0, 셀개수=99
   환자ID=COVID19_Participant36, Label=1, 셀개수=200
   환자ID=COVID19_Participant11, Label=1, 셀개수=382
   환자ID=COVID19_Participant25, Label=1, 셀개수=496
→ test 환자 ID 및 라벨:
   총 개수: 10
   환자ID=COVID19_Participant19, Label=1, 셀개수=816
   환자ID=COVID19_Participant20, Label=1, 셀개수=2033
   환자ID=COVID19_Participant21, Label=1, 셀개수=39
   환자ID=COVID19_Participant26, Label=1, 셀개수=814
   환자ID=COVID19_Participant29, Label=1, 셀개수=573
   환자ID=COVID19_Participant6, Label=1, 셀개수=84
   환자ID=COVID19_Participant7, Label=1, 셀개수=409
   환자ID=Control_Participant2, Label=0, 셀개수=41
   환자ID=Control_Participant5, Label=0, 셀개수=717
   환자ID=Control_Participant8, Label=0, 셀개수=393
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Ciliated Cells', 'Developing Ciliated Cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
전체 데이터 길이 26947
전체 cell type 길이 0        Developing Ciliated Cells
1        Developing Ciliated Cells
2        Developing Ciliated Cells
3        Developing Ciliated Cells
4        Developing Ciliated Cells
                   ...            
26942              Secretory Cells
26943              Secretory Cells
26944                      T Cells
26945              Secretory Cells
26946              Secretory Cells
Length: 26947, dtype: string
cell type의 NaN 개수 체크 0
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:10,  9.49it/s]  3%|▎         | 3/100 [00:00<00:09, 10.23it/s]  5%|▌         | 5/100 [00:00<00:09, 10.42it/s]  7%|▋         | 7/100 [00:00<00:09,  9.96it/s]  8%|▊         | 8/100 [00:00<00:09,  9.87it/s] 10%|█         | 10/100 [00:01<00:11,  7.74it/s] 12%|█▏        | 12/100 [00:01<00:11,  7.79it/s] 14%|█▍        | 14/100 [00:01<00:09,  8.62it/s] 15%|█▌        | 15/100 [00:01<00:09,  8.83it/s] 16%|█▌        | 16/100 [00:01<00:09,  8.94it/s] 17%|█▋        | 17/100 [00:01<00:09,  8.56it/s] 18%|█▊        | 18/100 [00:02<00:10,  7.95it/s] 19%|█▉        | 19/100 [00:02<00:09,  8.26it/s] 20%|██        | 20/100 [00:02<00:09,  8.67it/s] 21%|██        | 21/100 [00:02<00:09,  8.76it/s] 23%|██▎       | 23/100 [00:02<00:08,  9.07it/s] 24%|██▍       | 24/100 [00:02<00:08,  9.16it/s] 26%|██▌       | 26/100 [00:02<00:07,  9.51it/s] 27%|██▋       | 27/100 [00:03<00:08,  8.86it/s] 28%|██▊       | 28/100 [00:03<00:07,  9.05it/s] 29%|██▉       | 29/100 [00:03<00:11,  6.20it/s] 30%|███       | 30/100 [00:03<00:10,  6.84it/s] 32%|███▏      | 32/100 [00:03<00:08,  7.98it/s] 33%|███▎      | 33/100 [00:03<00:09,  7.14it/s] 34%|███▍      | 34/100 [00:04<00:11,  5.52it/s] 35%|███▌      | 35/100 [00:04<00:11,  5.68it/s] 36%|███▌      | 36/100 [00:04<00:10,  6.33it/s] 37%|███▋      | 37/100 [00:04<00:09,  6.66it/s] 38%|███▊      | 38/100 [00:04<00:09,  6.57it/s] 40%|████      | 40/100 [00:05<00:07,  7.92it/s] 41%|████      | 41/100 [00:05<00:07,  8.18it/s] 43%|████▎     | 43/100 [00:05<00:06,  8.55it/s] 45%|████▌     | 45/100 [00:05<00:06,  8.15it/s] 46%|████▌     | 46/100 [00:05<00:06,  8.29it/s] 47%|████▋     | 47/100 [00:05<00:06,  8.25it/s] 48%|████▊     | 48/100 [00:06<00:07,  7.17it/s] 49%|████▉     | 49/100 [00:06<00:06,  7.59it/s] 50%|█████     | 50/100 [00:06<00:06,  8.08it/s] 51%|█████     | 51/100 [00:06<00:05,  8.53it/s] 53%|█████▎    | 53/100 [00:06<00:05,  9.20it/s] 54%|█████▍    | 54/100 [00:06<00:05,  8.75it/s] 55%|█████▌    | 55/100 [00:06<00:05,  8.91it/s] 56%|█████▌    | 56/100 [00:06<00:04,  8.97it/s] 58%|█████▊    | 58/100 [00:07<00:04,  9.20it/s] 59%|█████▉    | 59/100 [00:07<00:04,  9.07it/s] 61%|██████    | 61/100 [00:07<00:04,  9.45it/s] 62%|██████▏   | 62/100 [00:07<00:05,  7.47it/s] 63%|██████▎   | 63/100 [00:07<00:04,  7.72it/s] 64%|██████▍   | 64/100 [00:07<00:04,  8.07it/s] 65%|██████▌   | 65/100 [00:07<00:04,  8.19it/s] 66%|██████▌   | 66/100 [00:08<00:04,  8.27it/s] 68%|██████▊   | 68/100 [00:08<00:03,  8.77it/s] 69%|██████▉   | 69/100 [00:08<00:04,  7.60it/s] 70%|███████   | 70/100 [00:08<00:03,  7.91it/s] 71%|███████   | 71/100 [00:08<00:03,  8.07it/s] 72%|███████▏  | 72/100 [00:08<00:03,  8.01it/s] 74%|███████▍  | 74/100 [00:09<00:03,  8.49it/s] 75%|███████▌  | 75/100 [00:09<00:02,  8.74it/s] 76%|███████▌  | 76/100 [00:09<00:03,  7.85it/s] 77%|███████▋  | 77/100 [00:09<00:02,  8.03it/s] 78%|███████▊  | 78/100 [00:09<00:02,  8.11it/s] 79%|███████▉  | 79/100 [00:09<00:02,  8.50it/s] 80%|████████  | 80/100 [00:09<00:02,  7.42it/s] 81%|████████  | 81/100 [00:10<00:03,  6.16it/s] 82%|████████▏ | 82/100 [00:10<00:02,  6.48it/s] 83%|████████▎ | 83/100 [00:10<00:02,  7.09it/s] 84%|████████▍ | 84/100 [00:10<00:02,  7.09it/s] 86%|████████▌ | 86/100 [00:10<00:01,  7.68it/s] 87%|████████▋ | 87/100 [00:10<00:01,  8.09it/s] 88%|████████▊ | 88/100 [00:10<00:01,  8.37it/s] 89%|████████▉ | 89/100 [00:11<00:01,  7.93it/s] 90%|█████████ | 90/100 [00:11<00:01,  8.04it/s] 91%|█████████ | 91/100 [00:11<00:01,  7.09it/s] 92%|█████████▏| 92/100 [00:11<00:01,  7.72it/s] 93%|█████████▎| 93/100 [00:11<00:00,  7.61it/s] 94%|█████████▍| 94/100 [00:11<00:00,  7.54it/s] 95%|█████████▌| 95/100 [00:11<00:00,  8.06it/s] 96%|█████████▌| 96/100 [00:12<00:00,  6.31it/s] 97%|█████████▋| 97/100 [00:12<00:00,  6.40it/s] 98%|█████████▊| 98/100 [00:12<00:00,  6.82it/s] 99%|█████████▉| 99/100 [00:12<00:00,  6.68it/s]100%|██████████| 100/100 [00:12<00:00,  7.00it/s]100%|██████████| 100/100 [00:12<00:00,  7.91it/s]
[I 2025-08-30 04:49:57,308] A new study created in memory with name: no-name-11225b8a-bd15-424c-915f-9e09c47a4466
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 27.97 MB
Memory Reserved: 46.00 MB
cuda
Epoch 1, Train Loss 0.640103, Valid_loss 0.583871
Epoch 2, Train Loss 0.583585, Valid_loss 0.505836
Epoch 3, Train Loss 0.461705, Valid_loss 0.430573
Epoch 4, Train Loss 0.400322, Valid_loss 0.587125
Epoch 5, Train Loss 0.344291, Valid_loss 0.377917
Epoch 6, Train Loss 0.307273, Valid_loss 0.357829
Epoch 7, Train Loss 0.314076, Valid_loss 0.408045
Epoch 8, Train Loss 0.301441, Valid_loss 0.368942
Epoch 9, Train Loss 0.299504, Valid_loss 0.370877
Epoch 10, Train Loss 0.277645, Valid_loss 0.407104
Epoch 11, Train Loss 0.279163, Valid_loss 0.523015
Epoch 12, Train Loss 0.273286, Valid_loss 0.425691
Epoch 13, Train Loss 0.263300, Valid_loss 0.472091
Epoch 14, Train Loss 0.254735, Valid_loss 0.447654
Epoch 15, Train Loss 0.279470, Valid_loss 0.380117
Epoch 16, Train Loss 0.255478, Valid_loss 0.433902
Epoch 17, Train Loss 0.257428, Valid_loss 0.427091
Epoch 18, Train Loss 0.248797, Valid_loss 0.422345
Epoch 19, Train Loss 0.250069, Valid_loss 0.399845
Epoch 20, Train Loss 0.239415, Valid_loss 0.408962
Epoch 21, Train Loss 0.239947, Valid_loss 0.425843
Epoch 22, Train Loss 0.241809, Valid_loss 0.375313
Epoch 23, Train Loss 0.244723, Valid_loss 0.390269
Epoch 24, Train Loss 0.248298, Valid_loss 0.390911
Epoch 25, Train Loss 0.247809, Valid_loss 0.447405
Epoch 26, Train Loss 0.270888, Valid_loss 0.453587
Epoch 27, Train Loss 0.232318, Valid_loss 0.422445
Epoch 28, Train Loss 0.238335, Valid_loss 0.467242
Epoch 29, Train Loss 0.225922, Valid_loss 0.428715
Epoch 30, Train Loss 0.233386, Valid_loss 0.452674
Epoch 31, Train Loss 0.223692, Valid_loss 0.463561
Epoch 32, Train Loss 0.221336, Valid_loss 0.444379
Epoch 33, Train Loss 0.222830, Valid_loss 0.478386
Epoch 34, Train Loss 0.228463, Valid_loss 0.448846
Epoch 35, Train Loss 0.220039, Valid_loss 0.425992
Epoch 36, Train Loss 0.226999, Valid_loss 0.482673
Epoch 37, Train Loss 0.221666, Valid_loss 0.446682
Epoch 38, Train Loss 0.219204, Valid_loss 0.430543
Epoch 39, Train Loss 0.219394, Valid_loss 0.395115
Epoch 40, Train Loss 0.233876, Valid_loss 0.501154
Epoch 41, Train Loss 0.227590, Valid_loss 0.415084
Epoch 42, Train Loss 0.221216, Valid_loss 0.398389
Epoch 43, Train Loss 0.238186, Valid_loss 0.450017
Epoch 44, Train Loss 0.264262, Valid_loss 0.528415
Epoch 45, Train Loss 0.256658, Valid_loss 0.533650
Epoch 46, Train Loss 0.237950, Valid_loss 0.387399
Epoch 47, Train Loss 0.227835, Valid_loss 0.414786
Epoch 48, Train Loss 0.224053, Valid_loss 0.435528
Epoch 49, Train Loss 0.219614, Valid_loss 0.456356
Epoch 50, Train Loss 0.226682, Valid_loss 0.393030
Epoch 51, Train Loss 0.221039, Valid_loss 0.460934
Epoch 52, Train Loss 0.220808, Valid_loss 0.404586
Epoch 53, Train Loss 0.214042, Valid_loss 0.442374
Epoch 54, Train Loss 0.209795, Valid_loss 0.423102
Epoch 55, Train Loss 0.211998, Valid_loss 0.415733
Epoch 56, Train Loss 0.212690, Valid_loss 0.463173
Epoch 57, Train Loss 0.212567, Valid_loss 0.452789
Epoch 58, Train Loss 0.215696, Valid_loss 0.477182
Epoch 59, Train Loss 0.215567, Valid_loss 0.411274
Epoch 60, Train Loss 0.216118, Valid_loss 0.439284
Epoch 61, Train Loss 0.214070, Valid_loss 0.426096
Epoch 62, Train Loss 0.218326, Valid_loss 0.409109
Epoch 63, Train Loss 0.214672, Valid_loss 0.465901
Epoch 64, Train Loss 0.212724, Valid_loss 0.414674
Epoch 65, Train Loss 0.211687, Valid_loss 0.432873
Epoch 66, Train Loss 0.209526, Valid_loss 0.442527
[I 2025-08-30 04:54:30,812] Trial 0 finished with value: 0.3578290726457323 and parameters: {'learning_rate': 0.001, 'epochs': 100, 'heads': 2, 'dropout': 0.5, 'weight_decay': 0.0001, 'emb_dim': 64, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.3578290726457323.
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 46.00 MB
cuda
Epoch 1, Train Loss 0.699160, Valid_loss 0.611887
Epoch 2, Train Loss 0.625460, Valid_loss 0.598987
Epoch 3, Train Loss 0.611517, Valid_loss 0.598286
Epoch 4, Train Loss 0.613610, Valid_loss 0.598247
Epoch 5, Train Loss 0.609398, Valid_loss 0.598681
Epoch 6, Train Loss 0.611775, Valid_loss 0.598092
Epoch 7, Train Loss 0.612560, Valid_loss 0.597470
Epoch 8, Train Loss 0.609486, Valid_loss 0.592969
Epoch 9, Train Loss 0.570620, Valid_loss 0.633475
Epoch 10, Train Loss 0.567336, Valid_loss 0.497448
Epoch 11, Train Loss 0.498937, Valid_loss 0.471008
Epoch 12, Train Loss 0.434652, Valid_loss 0.456648
Epoch 13, Train Loss 0.353886, Valid_loss 0.513301
Epoch 14, Train Loss 0.311628, Valid_loss 0.573411
Epoch 15, Train Loss 0.315114, Valid_loss 0.356099
Epoch 16, Train Loss 0.281210, Valid_loss 0.417023
Epoch 17, Train Loss 0.298180, Valid_loss 0.384600
Epoch 18, Train Loss 0.272054, Valid_loss 0.423704
Epoch 19, Train Loss 0.264774, Valid_loss 0.492212
Epoch 20, Train Loss 0.278643, Valid_loss 0.432999
Epoch 21, Train Loss 0.254300, Valid_loss 0.378750
Epoch 22, Train Loss 0.248726, Valid_loss 0.405117
Epoch 23, Train Loss 0.239607, Valid_loss 0.453817
Epoch 24, Train Loss 0.238242, Valid_loss 0.380488
Epoch 25, Train Loss 0.240530, Valid_loss 0.399484
Epoch 26, Train Loss 0.237092, Valid_loss 0.416618
Epoch 27, Train Loss 0.234361, Valid_loss 0.395523
Epoch 28, Train Loss 0.230355, Valid_loss 0.421855
Epoch 29, Train Loss 0.231065, Valid_loss 0.404543
Epoch 30, Train Loss 0.228090, Valid_loss 0.401582
Epoch 31, Train Loss 0.223093, Valid_loss 0.485374
Epoch 32, Train Loss 0.229846, Valid_loss 0.414749
Epoch 33, Train Loss 0.219071, Valid_loss 0.423568
Epoch 34, Train Loss 0.226484, Valid_loss 0.427921
Epoch 35, Train Loss 0.262611, Valid_loss 0.575226
Epoch 36, Train Loss 0.292479, Valid_loss 0.500487
Epoch 37, Train Loss 0.233583, Valid_loss 0.462753
Epoch 38, Train Loss 0.229532, Valid_loss 0.461306
Epoch 39, Train Loss 0.224161, Valid_loss 0.419774
Epoch 40, Train Loss 0.225722, Valid_loss 0.420496
Epoch 41, Train Loss 0.230047, Valid_loss 0.436228
Epoch 42, Train Loss 0.222658, Valid_loss 0.414690
Epoch 43, Train Loss 0.232738, Valid_loss 0.416677
Epoch 44, Train Loss 0.248829, Valid_loss 0.447335
Epoch 45, Train Loss 0.236607, Valid_loss 0.433463
Epoch 46, Train Loss 0.228761, Valid_loss 0.437152
Epoch 47, Train Loss 0.237468, Valid_loss 0.487535
Epoch 48, Train Loss 0.225021, Valid_loss 0.441592
Epoch 49, Train Loss 0.218090, Valid_loss 0.439211
Epoch 50, Train Loss 0.219424, Valid_loss 0.423321
Epoch 51, Train Loss 0.217278, Valid_loss 0.463300
Epoch 52, Train Loss 0.220600, Valid_loss 0.466381
[I 2025-08-30 04:57:47,908] Trial 1 finished with value: 0.3560993767210415 and parameters: {'learning_rate': 0.01, 'epochs': 100, 'heads': 1, 'dropout': 0.0, 'weight_decay': 0.001, 'emb_dim': 8, 'augment_num': 100, 'pca': False}. Best is trial 1 with value: 0.3560993767210415.
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 26.13 MB
Memory Reserved: 46.00 MB
cuda
Epoch 1, Train Loss 0.633146, Valid_loss 0.566390
Epoch 2, Train Loss 0.568742, Valid_loss 0.498692
Epoch 3, Train Loss 0.450474, Valid_loss 0.414078
Epoch 4, Train Loss 0.423728, Valid_loss 0.359761
Epoch 5, Train Loss 0.455064, Valid_loss 0.465566
Epoch 6, Train Loss 0.394267, Valid_loss 0.598237
Epoch 7, Train Loss 0.388150, Valid_loss 0.369487
Epoch 8, Train Loss 0.397353, Valid_loss 0.480978
Epoch 9, Train Loss 0.384925, Valid_loss 0.512061
Epoch 10, Train Loss 0.334587, Valid_loss 0.491441
Epoch 11, Train Loss 0.329086, Valid_loss 0.437351
Epoch 12, Train Loss 0.350016, Valid_loss 0.388839
Epoch 13, Train Loss 0.321760, Valid_loss 0.429512
Epoch 14, Train Loss 0.310704, Valid_loss 0.437682
Epoch 15, Train Loss 0.307136, Valid_loss 0.416258
Epoch 16, Train Loss 0.293318, Valid_loss 0.385925
Epoch 17, Train Loss 0.288627, Valid_loss 0.387421
Epoch 18, Train Loss 0.282995, Valid_loss 0.429346
Epoch 19, Train Loss 0.279335, Valid_loss 0.424465
Epoch 20, Train Loss 0.275479, Valid_loss 0.428743
Epoch 21, Train Loss 0.289027, Valid_loss 0.434465
Epoch 22, Train Loss 0.291529, Valid_loss 0.593178
Epoch 23, Train Loss 0.295889, Valid_loss 0.405316
Epoch 24, Train Loss 0.283215, Valid_loss 0.438199
Epoch 25, Train Loss 0.276094, Valid_loss 0.535437
Epoch 26, Train Loss 0.283191, Valid_loss 0.410545
Epoch 27, Train Loss 0.255067, Valid_loss 0.458674
Epoch 28, Train Loss 0.269101, Valid_loss 0.439122
Epoch 29, Train Loss 0.266353, Valid_loss 0.406889
Epoch 30, Train Loss 0.254163, Valid_loss 0.431616
Epoch 31, Train Loss 0.259733, Valid_loss 0.430923
Epoch 32, Train Loss 0.268373, Valid_loss 0.505833
Epoch 33, Train Loss 0.258505, Valid_loss 0.406483
Epoch 34, Train Loss 0.271031, Valid_loss 0.413217
Epoch 35, Train Loss 0.255968, Valid_loss 0.428006
Epoch 36, Train Loss 0.258187, Valid_loss 0.460485
Epoch 37, Train Loss 0.249606, Valid_loss 0.438588
Epoch 38, Train Loss 0.264068, Valid_loss 0.495061
Epoch 39, Train Loss 0.257907, Valid_loss 0.470279
Epoch 40, Train Loss 0.240980, Valid_loss 0.461582
Epoch 41, Train Loss 0.240669, Valid_loss 0.483966
Epoch 42, Train Loss 0.237673, Valid_loss 0.465695
Epoch 43, Train Loss 0.239952, Valid_loss 0.471190
Epoch 44, Train Loss 0.242262, Valid_loss 0.454133
Epoch 45, Train Loss 0.248671, Valid_loss 0.456112
Epoch 46, Train Loss 0.251328, Valid_loss 0.434932
Epoch 47, Train Loss 0.244559, Valid_loss 0.433165
Epoch 48, Train Loss 0.249118, Valid_loss 0.435825
Epoch 49, Train Loss 0.240064, Valid_loss 0.511609
Epoch 50, Train Loss 0.233504, Valid_loss 0.444951
Epoch 51, Train Loss 0.236018, Valid_loss 0.451169
Epoch 52, Train Loss 0.230187, Valid_loss 0.445518
Epoch 53, Train Loss 0.237780, Valid_loss 0.462474
Epoch 54, Train Loss 0.241379, Valid_loss 0.463846
[I 2025-08-30 05:01:15,825] Trial 2 finished with value: 0.3597613828522818 and parameters: {'learning_rate': 0.001, 'epochs': 100, 'heads': 1, 'dropout': 0.5, 'weight_decay': 0.0001, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 1 with value: 0.3560993767210415.
선택된 trial params: {'learning_rate': 0.01, 'epochs': 100, 'heads': 1, 'dropout': 0.0, 'weight_decay': 0.001, 'emb_dim': 8, 'augment_num': 100, 'pca': False}
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=10, batch_size=1 -> steps=10
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 46.00 MB
cuda
Epoch 1, Train Loss 0.621991, Valid_loss 0.598578
Epoch 2, Train Loss 0.609708, Valid_loss 0.590974
Epoch 3, Train Loss 0.604579, Valid_loss 0.562654
Epoch 4, Train Loss 0.524662, Valid_loss 0.435034
Epoch 5, Train Loss 0.481822, Valid_loss 0.426280
Epoch 6, Train Loss 0.474074, Valid_loss 0.588995
Epoch 7, Train Loss 0.461821, Valid_loss 0.467851
Epoch 8, Train Loss 0.396554, Valid_loss 0.470518
Epoch 9, Train Loss 0.387803, Valid_loss 0.451487
Epoch 10, Train Loss 0.377753, Valid_loss 0.396517
Epoch 11, Train Loss 0.363443, Valid_loss 0.370585
Epoch 12, Train Loss 0.383705, Valid_loss 0.402874
Epoch 13, Train Loss 0.384792, Valid_loss 0.377880
Epoch 14, Train Loss 0.371066, Valid_loss 0.452560
Epoch 15, Train Loss 0.357424, Valid_loss 0.415103
Epoch 16, Train Loss 0.332055, Valid_loss 0.359841
Epoch 17, Train Loss 0.287343, Valid_loss 0.329776
Epoch 18, Train Loss 0.265440, Valid_loss 0.366995
Epoch 19, Train Loss 0.256014, Valid_loss 0.341046
Epoch 20, Train Loss 0.248099, Valid_loss 0.375500
Epoch 21, Train Loss 0.259227, Valid_loss 0.337576
Epoch 22, Train Loss 0.260903, Valid_loss 0.396177
Epoch 23, Train Loss 0.278223, Valid_loss 0.344784
Epoch 24, Train Loss 0.253640, Valid_loss 0.378432
Epoch 25, Train Loss 0.251816, Valid_loss 0.350741
Epoch 26, Train Loss 0.247428, Valid_loss 0.361945
Epoch 27, Train Loss 0.272819, Valid_loss 0.400278
Epoch 28, Train Loss 0.251513, Valid_loss 0.415348
Epoch 29, Train Loss 0.244501, Valid_loss 0.369006
Epoch 30, Train Loss 0.243507, Valid_loss 0.406001
Epoch 31, Train Loss 0.243334, Valid_loss 0.429086
Epoch 32, Train Loss 0.234848, Valid_loss 0.394809
Epoch 33, Train Loss 0.231760, Valid_loss 0.379410
Epoch 34, Train Loss 0.225736, Valid_loss 0.392179
Epoch 35, Train Loss 0.226565, Valid_loss 0.381952
Epoch 36, Train Loss 0.221925, Valid_loss 0.404123
Epoch 37, Train Loss 0.228419, Valid_loss 0.385280
Epoch 38, Train Loss 0.230671, Valid_loss 0.405420
Epoch 39, Train Loss 0.237913, Valid_loss 0.346554
Epoch 40, Train Loss 0.226206, Valid_loss 0.387023
Epoch 41, Train Loss 0.221585, Valid_loss 0.346505
Epoch 42, Train Loss 0.227520, Valid_loss 0.372732
Epoch 43, Train Loss 0.247036, Valid_loss 0.370653
Epoch 44, Train Loss 0.228387, Valid_loss 0.375083
Epoch 45, Train Loss 0.231687, Valid_loss 0.391722
Epoch 46, Train Loss 0.228494, Valid_loss 0.384012
Epoch 47, Train Loss 0.220180, Valid_loss 0.402193
Epoch 48, Train Loss 0.221255, Valid_loss 0.387655
Epoch 49, Train Loss 0.222974, Valid_loss 0.425721
Epoch 50, Train Loss 0.223238, Valid_loss 0.352952
Epoch 51, Train Loss 0.216947, Valid_loss 0.388764
Epoch 52, Train Loss 0.214262, Valid_loss 0.405445
환자ID=COVID19_Participant19 -- true: 1 -- pred: 1
환자ID=COVID19_Participant20 -- true: 1 -- pred: 1
환자ID=COVID19_Participant21 -- true: 1 -- pred: 1
환자ID=COVID19_Participant26 -- true: 1 -- pred: 1
환자ID=COVID19_Participant29 -- true: 1 -- pred: 1
환자ID=COVID19_Participant6 -- true: 1 -- pred: 1
환자ID=COVID19_Participant7 -- true: 1 -- pred: 1
환자ID=Control_Participant2 -- true: 0 -- pred: 0
환자ID=Control_Participant5 -- true: 0 -- pred: 0
환자ID=Control_Participant8 -- true: 0 -- pred: 0
Best performance: Epoch 17, Loss 0.287343, Test ACC 1.000000, Test AUC 1.000000, Test Recall 1.000000, Test Precision 1.000000
Confusion Matrix:
 [3 0 0 7]
✅ Total valid splits used: 4
🔁 Repeat 0, Fold 4
cell type :  GTCGGGGGGTGG_Control_Participant7     Developing Ciliated Cells
CAAATCAATTAT_Control_Participant7     Developing Ciliated Cells
ATACAATTGACA_Control_Participant7     Developing Ciliated Cells
CTGTTAATGAGA_Control_Participant7     Developing Ciliated Cells
CTTCACATTATT_Control_Participant7     Developing Ciliated Cells
                                                ...            
GCAGGGAACTCC_COVID19_Participant30               Squamous Cells
CAGCACCGAGCC_COVID19_Participant30               Squamous Cells
GCCCCTTGTGAT_COVID19_Participant30               Squamous Cells
GTGTTGTGTGTC_COVID19_Participant30               Squamous Cells
TAACACTCACTT_COVID19_Participant30               Squamous Cells
Name: manual_annotation, Length: 21169, dtype: string
cell type annotation :  GTCGGGGGGTGG_Control_Participant7     Developing Ciliated Cells
CAAATCAATTAT_Control_Participant7     Developing Ciliated Cells
ATACAATTGACA_Control_Participant7     Developing Ciliated Cells
CTGTTAATGAGA_Control_Participant7     Developing Ciliated Cells
CTTCACATTATT_Control_Participant7     Developing Ciliated Cells
                                                ...            
GCAGGGAACTCC_COVID19_Participant30               Squamous Cells
CAGCACCGAGCC_COVID19_Participant30               Squamous Cells
GCCCCTTGTGAT_COVID19_Participant30               Squamous Cells
GTGTTGTGTGTC_COVID19_Participant30               Squamous Cells
TAACACTCACTT_COVID19_Participant30               Squamous Cells
Name: manual_annotation, Length: 21169, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Developing Ciliated Cells', 'Ciliated Cells', 'Secretory Cells', 'Squamous Cells', 'Goblet Cells', 'T Cells', 'Dendritic Cells', 'Basal Cells', 'Deuterosomal Cells', 'Mitotic Basal Cells', 'Developing Secretory and Goblet Cells', 'Macrophages', 'Plasmacytoid DCs', 'Ionocytes', 'Enteroendocrine Cells', 'B Cells', 'Erythroblasts', 'Mast Cells']
라벨별 그룹 개수 {1: 28, 0: 12}
cell type :  CATTAAGGATAT_COVID19_Participant13    Developing Ciliated Cells
GTAGAAGGGGGG_COVID19_Participant13    Developing Ciliated Cells
ATTAAGAGGTAG_COVID19_Participant13    Developing Ciliated Cells
AGATATGACAAG_COVID19_Participant13    Developing Ciliated Cells
CTTGTAACAAAT_COVID19_Participant13               Squamous Cells
                                                ...            
GTGTCGCGCCTG_Control_Participant6                Ciliated Cells
TGGAATTATGAT_Control_Participant6                Ciliated Cells
TAGTCGAGACGT_Control_Participant6                Ciliated Cells
CTCCAGTGGCAC_Control_Participant6     Developing Ciliated Cells
GAATAGACGACA_Control_Participant6                Ciliated Cells
Name: manual_annotation, Length: 5778, dtype: string
cell type annotation :  CATTAAGGATAT_COVID19_Participant13    Developing Ciliated Cells
GTAGAAGGGGGG_COVID19_Participant13    Developing Ciliated Cells
ATTAAGAGGTAG_COVID19_Participant13    Developing Ciliated Cells
AGATATGACAAG_COVID19_Participant13    Developing Ciliated Cells
CTTGTAACAAAT_COVID19_Participant13               Squamous Cells
                                                ...            
GTGTCGCGCCTG_Control_Participant6                Ciliated Cells
TGGAATTATGAT_Control_Participant6                Ciliated Cells
TAGTCGAGACGT_Control_Participant6                Ciliated Cells
CTCCAGTGGCAC_Control_Participant6     Developing Ciliated Cells
GAATAGACGACA_Control_Participant6                Ciliated Cells
Name: manual_annotation, Length: 5778, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Developing Ciliated Cells', 'Squamous Cells', 'Secretory Cells', 'Macrophages', 'B Cells', 'Ciliated Cells', 'T Cells', 'Dendritic Cells', 'Goblet Cells', 'Deuterosomal Cells', 'Basal Cells', 'Ionocytes', 'Mitotic Basal Cells', 'Developing Secretory and Goblet Cells', 'Enteroendocrine Cells', 'Erythroblasts', 'Plasmacytoid DCs', 'Mast Cells']
라벨별 그룹 개수 {1: 7, 0: 3}
🔍 Split #5
  → train_p_index 환자 수 (환자 단위로 묶인 index list): 40
  → test_p_index 환자 수  (환자 단위로 묶인 index list): 10
  → train 환자 ID: ['COVID19_Participant11', 'COVID19_Participant12', 'COVID19_Participant14', 'COVID19_Participant15', 'COVID19_Participant18', 'COVID19_Participant19', 'COVID19_Participant2', 'COVID19_Participant20', 'COVID19_Participant21', 'COVID19_Participant23', 'COVID19_Participant25', 'COVID19_Participant26', 'COVID19_Participant27', 'COVID19_Participant28', 'COVID19_Participant29', 'COVID19_Participant3', 'COVID19_Participant30', 'COVID19_Participant31', 'COVID19_Participant32', 'COVID19_Participant36', 'COVID19_Participant38', 'COVID19_Participant39', 'COVID19_Participant4', 'COVID19_Participant5', 'COVID19_Participant6', 'COVID19_Participant7', 'COVID19_Participant8', 'COVID19_Participant9', 'Control_Participant11', 'Control_Participant12', 'Control_Participant13', 'Control_Participant14', 'Control_Participant15', 'Control_Participant2', 'Control_Participant3', 'Control_Participant4', 'Control_Participant5', 'Control_Participant7', 'Control_Participant8', 'Control_Participant9']
  → test  환자 ID: ['COVID19_Participant10', 'COVID19_Participant13', 'COVID19_Participant17', 'COVID19_Participant22', 'COVID19_Participant35', 'COVID19_Participant37', 'COVID19_Participant40', 'Control_Participant1', 'Control_Participant10', 'Control_Participant6']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant12, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant18, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant21, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant27, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant3, Label: 1
    ID: COVID19_Participant30, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant36, Label: 1
    ID: COVID19_Participant38, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant5, Label: 1
    ID: COVID19_Participant6, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: COVID19_Participant9, Label: 1
    ID: Control_Participant11, Label: 0
    ID: Control_Participant12, Label: 0
    ID: Control_Participant13, Label: 0
    ID: Control_Participant14, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant2, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant4, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant8, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: COVID19_Participant10, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant35, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant10, Label: 0
    ID: Control_Participant6, Label: 0
전체 데이터 index 길이 50
label_stat (train 환자 라벨 목록) 갯수 40
train_data에서 환자 단위로, train과 validation 나누기
기존 train_p_index 40
기존 (train) label_stat 40
train-vali 분할 후! 
train y 의 classes : {0, 1} valid y 의 classes : {0, 1} label_stat 의 classes : {0, 1}
train_p_index_ 26
valid_p_index 14
test_p_index 10
→ train 환자 ID 및 라벨:
   총 개수: 26
   환자ID=Control_Participant12, Label=0, 셀개수=99
   환자ID=Control_Participant2, Label=0, 셀개수=41
   환자ID=COVID19_Participant2, Label=1, 셀개수=329
   환자ID=COVID19_Participant39, Label=1, 셀개수=454
   환자ID=COVID19_Participant11, Label=1, 셀개수=382
   환자ID=Control_Participant5, Label=0, 셀개수=717
   환자ID=COVID19_Participant15, Label=1, 셀개수=1003
   환자ID=COVID19_Participant20, Label=1, 셀개수=2033
   환자ID=COVID19_Participant5, Label=1, 셀개수=89
   환자ID=COVID19_Participant14, Label=1, 셀개수=382
   환자ID=COVID19_Participant21, Label=1, 셀개수=39
   환자ID=Control_Participant3, Label=0, 셀개수=1620
   환자ID=COVID19_Participant28, Label=1, 셀개수=1079
   환자ID=Control_Participant8, Label=0, 셀개수=393
   환자ID=Control_Participant7, Label=0, 셀개수=762
   환자ID=COVID19_Participant18, Label=1, 셀개수=227
   환자ID=Control_Participant9, Label=0, 셀개수=558
   환자ID=Control_Participant13, Label=0, 셀개수=88
   환자ID=COVID19_Participant25, Label=1, 셀개수=496
   환자ID=COVID19_Participant30, Label=1, 셀개수=116
   환자ID=COVID19_Participant27, Label=1, 셀개수=93
   환자ID=COVID19_Participant19, Label=1, 셀개수=816
   환자ID=COVID19_Participant7, Label=1, 셀개수=409
   환자ID=COVID19_Participant4, Label=1, 셀개수=1680
   환자ID=COVID19_Participant38, Label=1, 셀개수=51
   환자ID=COVID19_Participant3, Label=1, 셀개수=104
→ valid 환자 ID 및 라벨:
   총 개수: 14
   환자ID=Control_Participant15, Label=0, 셀개수=528
   환자ID=COVID19_Participant29, Label=1, 셀개수=573
   환자ID=COVID19_Participant32, Label=1, 셀개수=1665
   환자ID=COVID19_Participant31, Label=1, 셀개수=410
   환자ID=COVID19_Participant6, Label=1, 셀개수=84
   환자ID=COVID19_Participant23, Label=1, 셀개수=307
   환자ID=Control_Participant4, Label=0, 셀개수=440
   환자ID=Control_Participant11, Label=0, 셀개수=1164
   환자ID=COVID19_Participant9, Label=1, 셀개수=86
   환자ID=COVID19_Participant8, Label=1, 셀개수=462
   환자ID=Control_Participant14, Label=0, 셀개수=274
   환자ID=COVID19_Participant36, Label=1, 셀개수=200
   환자ID=COVID19_Participant12, Label=1, 셀개수=102
   환자ID=COVID19_Participant26, Label=1, 셀개수=814
→ test 환자 ID 및 라벨:
   총 개수: 10
   환자ID=COVID19_Participant10, Label=1, 셀개수=18
   환자ID=COVID19_Participant13, Label=1, 셀개수=730
   환자ID=COVID19_Participant17, Label=1, 셀개수=843
   환자ID=COVID19_Participant22, Label=1, 셀개수=865
   환자ID=COVID19_Participant35, Label=1, 셀개수=83
   환자ID=COVID19_Participant37, Label=1, 셀개수=668
   환자ID=COVID19_Participant40, Label=1, 셀개수=381
   환자ID=Control_Participant1, Label=0, 셀개수=414
   환자ID=Control_Participant10, Label=0, 셀개수=1645
   환자ID=Control_Participant6, Label=0, 셀개수=131
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Ciliated Cells', 'Developing Ciliated Cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
전체 데이터 길이 26947
전체 cell type 길이 0        Developing Ciliated Cells
1        Developing Ciliated Cells
2        Developing Ciliated Cells
3        Developing Ciliated Cells
4        Developing Ciliated Cells
                   ...            
26942               Ciliated Cells
26943               Ciliated Cells
26944               Ciliated Cells
26945    Developing Ciliated Cells
26946               Ciliated Cells
Length: 26947, dtype: string
cell type의 NaN 개수 체크 0
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:11,  8.42it/s]  2%|▏         | 2/100 [00:00<00:11,  8.82it/s]  3%|▎         | 3/100 [00:00<00:10,  9.31it/s]  4%|▍         | 4/100 [00:00<00:19,  4.89it/s]  6%|▌         | 6/100 [00:00<00:13,  6.78it/s]  8%|▊         | 8/100 [00:01<00:11,  7.91it/s]  9%|▉         | 9/100 [00:01<00:11,  8.09it/s] 10%|█         | 10/100 [00:01<00:10,  8.44it/s] 11%|█         | 11/100 [00:01<00:11,  7.95it/s] 12%|█▏        | 12/100 [00:01<00:10,  8.08it/s] 13%|█▎        | 13/100 [00:01<00:10,  8.15it/s] 14%|█▍        | 14/100 [00:02<00:15,  5.44it/s] 16%|█▌        | 16/100 [00:02<00:12,  6.84it/s] 17%|█▋        | 17/100 [00:02<00:11,  7.11it/s] 18%|█▊        | 18/100 [00:02<00:11,  7.39it/s] 19%|█▉        | 19/100 [00:02<00:10,  7.50it/s] 21%|██        | 21/100 [00:02<00:09,  8.46it/s] 22%|██▏       | 22/100 [00:02<00:09,  8.52it/s] 23%|██▎       | 23/100 [00:03<00:09,  8.47it/s] 24%|██▍       | 24/100 [00:03<00:10,  7.02it/s] 25%|██▌       | 25/100 [00:03<00:10,  7.21it/s] 26%|██▌       | 26/100 [00:03<00:09,  7.75it/s] 27%|██▋       | 27/100 [00:03<00:08,  8.22it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.48it/s] 29%|██▉       | 29/100 [00:03<00:10,  6.77it/s] 31%|███       | 31/100 [00:04<00:08,  8.02it/s] 33%|███▎      | 33/100 [00:04<00:07,  8.64it/s] 34%|███▍      | 34/100 [00:04<00:08,  7.98it/s] 35%|███▌      | 35/100 [00:04<00:08,  8.04it/s] 36%|███▌      | 36/100 [00:04<00:07,  8.43it/s] 37%|███▋      | 37/100 [00:04<00:07,  8.69it/s] 39%|███▉      | 39/100 [00:04<00:06,  9.07it/s] 40%|████      | 40/100 [00:05<00:06,  9.13it/s] 42%|████▏     | 42/100 [00:05<00:06,  8.94it/s] 43%|████▎     | 43/100 [00:05<00:06,  9.13it/s] 44%|████▍     | 44/100 [00:05<00:06,  9.25it/s] 45%|████▌     | 45/100 [00:05<00:05,  9.20it/s] 46%|████▌     | 46/100 [00:05<00:05,  9.32it/s] 47%|████▋     | 47/100 [00:06<00:08,  6.62it/s] 48%|████▊     | 48/100 [00:06<00:07,  7.23it/s] 49%|████▉     | 49/100 [00:06<00:06,  7.59it/s] 50%|█████     | 50/100 [00:06<00:06,  8.11it/s] 51%|█████     | 51/100 [00:06<00:05,  8.34it/s] 52%|█████▏    | 52/100 [00:06<00:05,  8.37it/s] 53%|█████▎    | 53/100 [00:06<00:06,  7.45it/s] 54%|█████▍    | 54/100 [00:06<00:06,  7.18it/s] 55%|█████▌    | 55/100 [00:06<00:05,  7.63it/s] 57%|█████▋    | 57/100 [00:07<00:05,  8.60it/s] 58%|█████▊    | 58/100 [00:07<00:04,  8.55it/s] 59%|█████▉    | 59/100 [00:07<00:04,  8.84it/s] 60%|██████    | 60/100 [00:07<00:05,  7.18it/s] 61%|██████    | 61/100 [00:07<00:05,  7.42it/s] 62%|██████▏   | 62/100 [00:07<00:05,  7.17it/s] 64%|██████▍   | 64/100 [00:08<00:06,  5.97it/s] 65%|██████▌   | 65/100 [00:08<00:05,  6.39it/s] 66%|██████▌   | 66/100 [00:08<00:05,  6.67it/s] 67%|██████▋   | 67/100 [00:08<00:04,  7.24it/s] 68%|██████▊   | 68/100 [00:08<00:04,  7.00it/s] 69%|██████▉   | 69/100 [00:08<00:04,  7.34it/s] 70%|███████   | 70/100 [00:09<00:04,  6.26it/s] 71%|███████   | 71/100 [00:09<00:04,  6.77it/s] 73%|███████▎  | 73/100 [00:09<00:03,  8.12it/s] 74%|███████▍  | 74/100 [00:09<00:03,  6.59it/s] 76%|███████▌  | 76/100 [00:09<00:03,  7.77it/s] 77%|███████▋  | 77/100 [00:10<00:02,  7.95it/s] 78%|███████▊  | 78/100 [00:10<00:02,  8.22it/s] 79%|███████▉  | 79/100 [00:10<00:02,  8.38it/s] 80%|████████  | 80/100 [00:10<00:02,  8.50it/s] 81%|████████  | 81/100 [00:10<00:02,  8.20it/s] 82%|████████▏ | 82/100 [00:10<00:02,  8.61it/s] 84%|████████▍ | 84/100 [00:10<00:01,  9.24it/s] 85%|████████▌ | 85/100 [00:10<00:01,  9.36it/s] 86%|████████▌ | 86/100 [00:10<00:01,  9.28it/s] 87%|████████▋ | 87/100 [00:11<00:01,  8.92it/s] 88%|████████▊ | 88/100 [00:11<00:01,  8.88it/s] 89%|████████▉ | 89/100 [00:11<00:01,  8.96it/s] 91%|█████████ | 91/100 [00:11<00:01,  7.15it/s] 92%|█████████▏| 92/100 [00:11<00:01,  7.15it/s] 93%|█████████▎| 93/100 [00:11<00:00,  7.66it/s] 94%|█████████▍| 94/100 [00:12<00:00,  7.94it/s] 95%|█████████▌| 95/100 [00:12<00:00,  8.06it/s] 97%|█████████▋| 97/100 [00:12<00:00,  5.59it/s] 99%|█████████▉| 99/100 [00:12<00:00,  6.67it/s]100%|██████████| 100/100 [00:13<00:00,  6.67it/s]100%|██████████| 100/100 [00:13<00:00,  7.69it/s]
[I 2025-08-30 05:04:48,158] A new study created in memory with name: no-name-e8ef1b1c-f3a1-4ce2-8a96-3b18cf4c6bfd
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 26.13 MB
Memory Reserved: 46.00 MB
cuda
Epoch 1, Train Loss 0.553775, Valid_loss 0.421207
Epoch 2, Train Loss 0.365062, Valid_loss 0.377419
Epoch 3, Train Loss 0.375256, Valid_loss 0.395584
Epoch 4, Train Loss 0.333366, Valid_loss 0.269429
Epoch 5, Train Loss 0.370379, Valid_loss 0.357026
Epoch 6, Train Loss 0.343941, Valid_loss 0.379922
Epoch 7, Train Loss 0.325822, Valid_loss 0.547079
Epoch 8, Train Loss 0.316688, Valid_loss 0.386582
Epoch 9, Train Loss 0.302252, Valid_loss 0.310341
Epoch 10, Train Loss 0.307359, Valid_loss 0.251278
Epoch 11, Train Loss 0.304018, Valid_loss 0.317476
Epoch 12, Train Loss 0.292692, Valid_loss 0.333120
Epoch 13, Train Loss 0.272377, Valid_loss 0.383082
Epoch 14, Train Loss 0.308169, Valid_loss 0.243910
Epoch 15, Train Loss 0.336252, Valid_loss 0.265759
Epoch 16, Train Loss 0.315755, Valid_loss 0.326014
Epoch 17, Train Loss 0.286693, Valid_loss 0.454435
Epoch 18, Train Loss 0.276200, Valid_loss 0.263313
Epoch 19, Train Loss 0.295596, Valid_loss 0.317213
Epoch 20, Train Loss 0.304644, Valid_loss 0.331586
Epoch 21, Train Loss 0.303124, Valid_loss 0.508905
Epoch 22, Train Loss 0.305650, Valid_loss 0.267151
Epoch 23, Train Loss 0.302745, Valid_loss 0.493957
Epoch 24, Train Loss 0.297954, Valid_loss 0.466387
Epoch 25, Train Loss 0.298296, Valid_loss 0.281479
Epoch 26, Train Loss 0.260123, Valid_loss 0.355093
Epoch 27, Train Loss 0.253591, Valid_loss 0.320005
Epoch 28, Train Loss 0.269754, Valid_loss 0.281547
Epoch 29, Train Loss 0.265282, Valid_loss 0.311439
Epoch 30, Train Loss 0.244984, Valid_loss 0.342976
Epoch 31, Train Loss 0.277894, Valid_loss 0.255827
Epoch 32, Train Loss 0.286461, Valid_loss 0.398772
Epoch 33, Train Loss 0.256755, Valid_loss 0.278171
Epoch 34, Train Loss 0.269888, Valid_loss 0.310575
Epoch 35, Train Loss 0.283590, Valid_loss 0.288805
Epoch 36, Train Loss 0.261538, Valid_loss 0.265411
Epoch 37, Train Loss 0.263686, Valid_loss 0.302204
Epoch 38, Train Loss 0.236566, Valid_loss 0.319493
Epoch 39, Train Loss 0.230605, Valid_loss 0.288116
Epoch 40, Train Loss 0.237606, Valid_loss 0.318859
Epoch 41, Train Loss 0.256926, Valid_loss 0.397348
Epoch 42, Train Loss 0.252160, Valid_loss 0.229279
Epoch 43, Train Loss 0.266989, Valid_loss 0.340318
Epoch 44, Train Loss 0.251339, Valid_loss 0.334111
Epoch 45, Train Loss 0.235173, Valid_loss 0.262884
Epoch 46, Train Loss 0.233224, Valid_loss 0.468254
Epoch 47, Train Loss 0.319052, Valid_loss 0.367160
Epoch 48, Train Loss 0.314870, Valid_loss 0.271590
Epoch 49, Train Loss 0.299955, Valid_loss 0.419814
Epoch 50, Train Loss 0.266632, Valid_loss 0.365249
Epoch 51, Train Loss 0.256622, Valid_loss 0.390733
Epoch 52, Train Loss 0.250970, Valid_loss 0.245428
Epoch 53, Train Loss 0.238722, Valid_loss 0.323844
Epoch 54, Train Loss 0.232322, Valid_loss 0.300914
Epoch 55, Train Loss 0.225866, Valid_loss 0.274178
Epoch 56, Train Loss 0.224445, Valid_loss 0.298547
Epoch 57, Train Loss 0.219975, Valid_loss 0.333722
[I 2025-08-30 05:09:10,122] Trial 0 finished with value: 0.22927903171096528 and parameters: {'learning_rate': 0.01, 'epochs': 100, 'heads': 4, 'dropout': 0.0, 'weight_decay': 0.01, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.22927903171096528.
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 26.13 MB
Memory Reserved: 46.00 MB
cuda
Epoch 1, Train Loss 0.706888, Valid_loss 0.591534
Epoch 2, Train Loss 0.645576, Valid_loss 0.553925
Epoch 3, Train Loss 0.616727, Valid_loss 0.521876
Epoch 4, Train Loss 0.641456, Valid_loss 0.492748
Epoch 5, Train Loss 0.560910, Valid_loss 0.441402
Epoch 6, Train Loss 0.531945, Valid_loss 0.395755
Epoch 7, Train Loss 0.509362, Valid_loss 0.374167
Epoch 8, Train Loss 0.494996, Valid_loss 0.360460
Epoch 9, Train Loss 0.459286, Valid_loss 0.356615
Epoch 10, Train Loss 0.456390, Valid_loss 0.349689
Epoch 11, Train Loss 0.456562, Valid_loss 0.336261
Epoch 12, Train Loss 0.457867, Valid_loss 0.356534
Epoch 13, Train Loss 0.432213, Valid_loss 0.322753
Epoch 14, Train Loss 0.425497, Valid_loss 0.324251
Epoch 15, Train Loss 0.421800, Valid_loss 0.337365
Epoch 16, Train Loss 0.440738, Valid_loss 0.338415
Epoch 17, Train Loss 0.429094, Valid_loss 0.326314
Epoch 18, Train Loss 0.427214, Valid_loss 0.350459
Epoch 19, Train Loss 0.413944, Valid_loss 0.322510
Epoch 20, Train Loss 0.429224, Valid_loss 0.325365
Epoch 21, Train Loss 0.417142, Valid_loss 0.325335
Epoch 22, Train Loss 0.406628, Valid_loss 0.328929
Epoch 23, Train Loss 0.423334, Valid_loss 0.345514
Epoch 24, Train Loss 0.414389, Valid_loss 0.329599
Epoch 25, Train Loss 0.407992, Valid_loss 0.302327
Epoch 26, Train Loss 0.391791, Valid_loss 0.346267
Epoch 27, Train Loss 0.410880, Valid_loss 0.315265
Epoch 28, Train Loss 0.405096, Valid_loss 0.318462
Epoch 29, Train Loss 0.397419, Valid_loss 0.322482
Epoch 30, Train Loss 0.373197, Valid_loss 0.310124
Epoch 31, Train Loss 0.384539, Valid_loss 0.320797
Epoch 32, Train Loss 0.383041, Valid_loss 0.334437
Epoch 33, Train Loss 0.393893, Valid_loss 0.318610
Epoch 34, Train Loss 0.383037, Valid_loss 0.320061
Epoch 35, Train Loss 0.380792, Valid_loss 0.310576
Epoch 36, Train Loss 0.386638, Valid_loss 0.297827
Epoch 37, Train Loss 0.366856, Valid_loss 0.336743
Epoch 38, Train Loss 0.402149, Valid_loss 0.296875
Epoch 39, Train Loss 0.378239, Valid_loss 0.304610
Epoch 40, Train Loss 0.388601, Valid_loss 0.297568
Epoch 41, Train Loss 0.363242, Valid_loss 0.339958
Epoch 42, Train Loss 0.362210, Valid_loss 0.331089
Epoch 43, Train Loss 0.371967, Valid_loss 0.317383
Epoch 44, Train Loss 0.369499, Valid_loss 0.296875
Epoch 45, Train Loss 0.359254, Valid_loss 0.316663
Epoch 46, Train Loss 0.370928, Valid_loss 0.294520
Epoch 47, Train Loss 0.372665, Valid_loss 0.302528
Epoch 48, Train Loss 0.361438, Valid_loss 0.296469
Epoch 49, Train Loss 0.374735, Valid_loss 0.310745
Epoch 50, Train Loss 0.361256, Valid_loss 0.311003
Epoch 51, Train Loss 0.358554, Valid_loss 0.319224
Epoch 52, Train Loss 0.347895, Valid_loss 0.302769
Epoch 53, Train Loss 0.370955, Valid_loss 0.302914
Epoch 54, Train Loss 0.357408, Valid_loss 0.305335
[I 2025-08-30 05:12:53,424] Trial 1 finished with value: 0.2945204292024885 and parameters: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 2, 'dropout': 0.5, 'weight_decay': 0.01, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.22927903171096528.
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 46.00 MB
cuda
Epoch 1, Train Loss 0.697665, Valid_loss 0.649580
Epoch 2, Train Loss 0.691951, Valid_loss 0.637254
Epoch 3, Train Loss 0.670507, Valid_loss 0.599528
Epoch 4, Train Loss 0.624011, Valid_loss 0.609805
Epoch 5, Train Loss 0.592487, Valid_loss 0.552863
Epoch 6, Train Loss 0.573590, Valid_loss 0.598091
Epoch 7, Train Loss 0.575230, Valid_loss 0.541622
Epoch 8, Train Loss 0.573262, Valid_loss 0.515365
Epoch 9, Train Loss 0.518374, Valid_loss 0.517506
Epoch 10, Train Loss 0.546340, Valid_loss 0.487369
Epoch 11, Train Loss 0.542867, Valid_loss 0.497121
Epoch 12, Train Loss 0.535113, Valid_loss 0.468371
Epoch 13, Train Loss 0.500842, Valid_loss 0.475643
Epoch 14, Train Loss 0.503651, Valid_loss 0.421225
Epoch 15, Train Loss 0.535261, Valid_loss 0.493613
Epoch 16, Train Loss 0.484459, Valid_loss 0.455093
Epoch 17, Train Loss 0.505639, Valid_loss 0.445348
Epoch 18, Train Loss 0.436452, Valid_loss 0.436348
Epoch 19, Train Loss 0.455795, Valid_loss 0.449701
Epoch 20, Train Loss 0.486271, Valid_loss 0.397256
Epoch 21, Train Loss 0.497721, Valid_loss 0.432328
Epoch 22, Train Loss 0.435643, Valid_loss 0.431526
Epoch 23, Train Loss 0.435393, Valid_loss 0.404926
Epoch 24, Train Loss 0.454664, Valid_loss 0.391481
Epoch 25, Train Loss 0.455629, Valid_loss 0.430883
Epoch 26, Train Loss 0.443313, Valid_loss 0.380504
Epoch 27, Train Loss 0.501691, Valid_loss 0.372930
Epoch 28, Train Loss 0.445417, Valid_loss 0.414406
Epoch 29, Train Loss 0.427483, Valid_loss 0.412709
Epoch 30, Train Loss 0.438847, Valid_loss 0.348087
Epoch 31, Train Loss 0.429347, Valid_loss 0.397238
Epoch 32, Train Loss 0.378673, Valid_loss 0.305355
Epoch 33, Train Loss 0.428301, Valid_loss 0.366356
Epoch 34, Train Loss 0.413213, Valid_loss 0.360288
Epoch 35, Train Loss 0.378875, Valid_loss 0.306483
Epoch 36, Train Loss 0.412173, Valid_loss 0.323403
Epoch 37, Train Loss 0.382196, Valid_loss 0.373488
Epoch 38, Train Loss 0.405768, Valid_loss 0.337679
Epoch 39, Train Loss 0.386283, Valid_loss 0.341535
Epoch 40, Train Loss 0.394237, Valid_loss 0.321671
Epoch 41, Train Loss 0.418297, Valid_loss 0.389397
Epoch 42, Train Loss 0.396961, Valid_loss 0.303185
Epoch 43, Train Loss 0.367105, Valid_loss 0.303621
Epoch 44, Train Loss 0.394596, Valid_loss 0.298566
Epoch 45, Train Loss 0.367443, Valid_loss 0.294466
Epoch 46, Train Loss 0.335730, Valid_loss 0.308250
Epoch 47, Train Loss 0.316130, Valid_loss 0.297561
Epoch 48, Train Loss 0.352545, Valid_loss 0.333674
Epoch 49, Train Loss 0.341399, Valid_loss 0.345161
Epoch 50, Train Loss 0.343630, Valid_loss 0.327580
Epoch 51, Train Loss 0.337303, Valid_loss 0.295794
Epoch 52, Train Loss 0.348452, Valid_loss 0.380021
Epoch 53, Train Loss 0.370747, Valid_loss 0.318647
Epoch 54, Train Loss 0.371156, Valid_loss 0.347285
Epoch 55, Train Loss 0.336735, Valid_loss 0.293520
Epoch 56, Train Loss 0.304792, Valid_loss 0.354427
Epoch 57, Train Loss 0.320201, Valid_loss 0.332936
Epoch 58, Train Loss 0.326731, Valid_loss 0.301673
Epoch 59, Train Loss 0.293183, Valid_loss 0.368963
Epoch 60, Train Loss 0.366041, Valid_loss 0.278736
Epoch 61, Train Loss 0.346754, Valid_loss 0.307255
Epoch 62, Train Loss 0.354600, Valid_loss 0.340224
[I 2025-08-30 05:17:47,499] Trial 2 finished with value: 0.2787361725100449 and parameters: {'learning_rate': 0.001, 'epochs': 100, 'heads': 4, 'dropout': 0.5, 'weight_decay': 0.001, 'emb_dim': 8, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.22927903171096528.
선택된 trial params: {'learning_rate': 0.01, 'epochs': 100, 'heads': 4, 'dropout': 0.0, 'weight_decay': 0.01, 'emb_dim': 32, 'augment_num': 100, 'pca': False}
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=10, batch_size=1 -> steps=10
output_class :  1
Memory Allocated: 26.13 MB
Memory Reserved: 46.00 MB
cuda
Epoch 1, Train Loss 0.660697, Valid_loss 0.606126
Epoch 2, Train Loss 0.625443, Valid_loss 0.538282
Epoch 3, Train Loss 0.482860, Valid_loss 0.354379
Epoch 4, Train Loss 0.386145, Valid_loss 0.409440
Epoch 5, Train Loss 0.385204, Valid_loss 0.418178
Epoch 6, Train Loss 0.325641, Valid_loss 0.390979
Epoch 7, Train Loss 0.347636, Valid_loss 0.260982
Epoch 8, Train Loss 0.334071, Valid_loss 0.267542
Epoch 9, Train Loss 0.315246, Valid_loss 0.330556
Epoch 10, Train Loss 0.317592, Valid_loss 0.494978
Epoch 11, Train Loss 0.299389, Valid_loss 0.603940
Epoch 12, Train Loss 0.329701, Valid_loss 0.325656
Epoch 13, Train Loss 0.316819, Valid_loss 0.244155
Epoch 14, Train Loss 0.293599, Valid_loss 0.321870
Epoch 15, Train Loss 0.323343, Valid_loss 0.236478
Epoch 16, Train Loss 0.281322, Valid_loss 0.281361
Epoch 17, Train Loss 0.283092, Valid_loss 0.319672
Epoch 18, Train Loss 0.265233, Valid_loss 0.289633
Epoch 19, Train Loss 0.284464, Valid_loss 0.386513
Epoch 20, Train Loss 0.304616, Valid_loss 0.360493
Epoch 21, Train Loss 0.297094, Valid_loss 0.534971
Epoch 22, Train Loss 0.308932, Valid_loss 0.317338
Epoch 23, Train Loss 0.299541, Valid_loss 0.282041
Epoch 24, Train Loss 0.265940, Valid_loss 0.406848
Epoch 25, Train Loss 0.292565, Valid_loss 0.510338
Epoch 26, Train Loss 0.306010, Valid_loss 0.362714
Epoch 27, Train Loss 0.285258, Valid_loss 0.238903
Epoch 28, Train Loss 0.271031, Valid_loss 0.230251
Epoch 29, Train Loss 0.275476, Valid_loss 0.302990
Epoch 30, Train Loss 0.318767, Valid_loss 0.452287
Epoch 31, Train Loss 0.297195, Valid_loss 0.320018
Epoch 32, Train Loss 0.283010, Valid_loss 0.261309
Epoch 33, Train Loss 0.278613, Valid_loss 0.478962
Epoch 34, Train Loss 0.307651, Valid_loss 0.291284
Epoch 35, Train Loss 0.278201, Valid_loss 0.359332
Epoch 36, Train Loss 0.284195, Valid_loss 0.345437
Epoch 37, Train Loss 0.271078, Valid_loss 0.265830
Epoch 38, Train Loss 0.274416, Valid_loss 0.487773
Epoch 39, Train Loss 0.269262, Valid_loss 0.336459
Epoch 40, Train Loss 0.272770, Valid_loss 0.486227
Epoch 41, Train Loss 0.263048, Valid_loss 0.314820
Epoch 42, Train Loss 0.291496, Valid_loss 0.385405
Epoch 43, Train Loss 0.267554, Valid_loss 0.432054
Epoch 44, Train Loss 0.256701, Valid_loss 0.320838
Epoch 45, Train Loss 0.271496, Valid_loss 0.442054
Epoch 46, Train Loss 0.261910, Valid_loss 0.281489
Epoch 47, Train Loss 0.265636, Valid_loss 0.415704
Epoch 48, Train Loss 0.257858, Valid_loss 0.335880
Epoch 49, Train Loss 0.257976, Valid_loss 0.491647
Epoch 50, Train Loss 0.273212, Valid_loss 0.434970
Epoch 51, Train Loss 0.269940, Valid_loss 0.273500
Epoch 52, Train Loss 0.258297, Valid_loss 0.321967
Epoch 53, Train Loss 0.244395, Valid_loss 0.307588
Epoch 54, Train Loss 0.236400, Valid_loss 0.324236
Epoch 55, Train Loss 0.233770, Valid_loss 0.344486
환자ID=COVID19_Participant10 -- true: 1 -- pred: 0
환자ID=COVID19_Participant13 -- true: 1 -- pred: 1
환자ID=COVID19_Participant17 -- true: 1 -- pred: 1
환자ID=COVID19_Participant22 -- true: 1 -- pred: 1
환자ID=COVID19_Participant35 -- true: 1 -- pred: 0
환자ID=COVID19_Participant37 -- true: 1 -- pred: 1
환자ID=COVID19_Participant40 -- true: 1 -- pred: 1
환자ID=Control_Participant1 -- true: 0 -- pred: 0
환자ID=Control_Participant10 -- true: 0 -- pred: 0
환자ID=Control_Participant6 -- true: 0 -- pred: 0
Best performance: Epoch 28, Loss 0.271031, Test ACC 0.800000, Test AUC 0.857143, Test Recall 0.714286, Test Precision 1.000000
Confusion Matrix:
 [3 0 2 5]
✅ Total valid splits used: 5

📌 Repeat 0: 평균 AUC = 0.9524, 표준편차 = 0.0602
Test ACC 평균 0.900000, Test Recall 평균 0.857143, Test Precision 평균 1.000000
fold_aucs = [1.0, 0.9047619047619048, 1.0, 1.0, 0.8571428571428571]
NaN 개수: 0 / 전체 5개

🔁 Repeat 1, Fold 0
cell type :  GTCGGGGGGTGG_Control_Participant7     Developing Ciliated Cells
CAAATCAATTAT_Control_Participant7     Developing Ciliated Cells
ATACAATTGACA_Control_Participant7     Developing Ciliated Cells
CTGTTAATGAGA_Control_Participant7     Developing Ciliated Cells
CTTCACATTATT_Control_Participant7     Developing Ciliated Cells
                                                ...            
GCAGGGAACTCC_COVID19_Participant30               Squamous Cells
CAGCACCGAGCC_COVID19_Participant30               Squamous Cells
GCCCCTTGTGAT_COVID19_Participant30               Squamous Cells
GTGTTGTGTGTC_COVID19_Participant30               Squamous Cells
TAACACTCACTT_COVID19_Participant30               Squamous Cells
Name: manual_annotation, Length: 22840, dtype: string
cell type annotation :  GTCGGGGGGTGG_Control_Participant7     Developing Ciliated Cells
CAAATCAATTAT_Control_Participant7     Developing Ciliated Cells
ATACAATTGACA_Control_Participant7     Developing Ciliated Cells
CTGTTAATGAGA_Control_Participant7     Developing Ciliated Cells
CTTCACATTATT_Control_Participant7     Developing Ciliated Cells
                                                ...            
GCAGGGAACTCC_COVID19_Participant30               Squamous Cells
CAGCACCGAGCC_COVID19_Participant30               Squamous Cells
GCCCCTTGTGAT_COVID19_Participant30               Squamous Cells
GTGTTGTGTGTC_COVID19_Participant30               Squamous Cells
TAACACTCACTT_COVID19_Participant30               Squamous Cells
Name: manual_annotation, Length: 22840, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Developing Ciliated Cells', 'Ciliated Cells', 'Secretory Cells', 'Squamous Cells', 'Goblet Cells', 'T Cells', 'Dendritic Cells', 'Basal Cells', 'Deuterosomal Cells', 'Mitotic Basal Cells', 'Macrophages', 'B Cells', 'Ionocytes', 'Developing Secretory and Goblet Cells', 'Plasmacytoid DCs', 'Enteroendocrine Cells', 'Erythroblasts', 'Mast Cells']
라벨별 그룹 개수 {1: 28, 0: 12}
cell type :  AGAGTGCAAGGT_COVID19_Participant25         Ciliated Cells
TTCCTGGAACCT_COVID19_Participant25         Ciliated Cells
CGTTGCACGTAC_COVID19_Participant25         Ciliated Cells
ATCTCCGTGCGC_COVID19_Participant25         Ciliated Cells
CCCTCCCCAGAA_COVID19_Participant25         Ciliated Cells
                                             ...         
GGAAGAACCCAC_COVID19_Participant2            Goblet Cells
TGGCAACCGAAT_COVID19_Participant2     Mitotic Basal Cells
CGCAAGAGAGAA_COVID19_Participant2          Ciliated Cells
CGCTAAAACCCG_COVID19_Participant2          Ciliated Cells
GAGCGCGTCACA_COVID19_Participant2            Goblet Cells
Name: manual_annotation, Length: 4107, dtype: string
cell type annotation :  AGAGTGCAAGGT_COVID19_Participant25         Ciliated Cells
TTCCTGGAACCT_COVID19_Participant25         Ciliated Cells
CGTTGCACGTAC_COVID19_Participant25         Ciliated Cells
ATCTCCGTGCGC_COVID19_Participant25         Ciliated Cells
CCCTCCCCAGAA_COVID19_Participant25         Ciliated Cells
                                             ...         
GGAAGAACCCAC_COVID19_Participant2            Goblet Cells
TGGCAACCGAAT_COVID19_Participant2     Mitotic Basal Cells
CGCAAGAGAGAA_COVID19_Participant2          Ciliated Cells
CGCTAAAACCCG_COVID19_Participant2          Ciliated Cells
GAGCGCGTCACA_COVID19_Participant2            Goblet Cells
Name: manual_annotation, Length: 4107, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Ciliated Cells', 'Mitotic Basal Cells', 'Goblet Cells', 'Secretory Cells', 'Ionocytes', 'Macrophages', 'Developing Ciliated Cells', 'Squamous Cells', 'Enteroendocrine Cells', 'Basal Cells', 'T Cells', 'Deuterosomal Cells', 'Developing Secretory and Goblet Cells', 'B Cells', 'Dendritic Cells', 'Erythroblasts', 'Plasmacytoid DCs', 'Mast Cells']
라벨별 그룹 개수 {1: 7, 0: 3}
🔍 Split #1
  → train_p_index 환자 수 (환자 단위로 묶인 index list): 40
  → test_p_index 환자 수  (환자 단위로 묶인 index list): 10
  → train 환자 ID: ['COVID19_Participant10', 'COVID19_Participant12', 'COVID19_Participant13', 'COVID19_Participant14', 'COVID19_Participant15', 'COVID19_Participant17', 'COVID19_Participant18', 'COVID19_Participant19', 'COVID19_Participant20', 'COVID19_Participant21', 'COVID19_Participant22', 'COVID19_Participant26', 'COVID19_Participant27', 'COVID19_Participant28', 'COVID19_Participant29', 'COVID19_Participant3', 'COVID19_Participant30', 'COVID19_Participant31', 'COVID19_Participant32', 'COVID19_Participant35', 'COVID19_Participant38', 'COVID19_Participant39', 'COVID19_Participant4', 'COVID19_Participant40', 'COVID19_Participant5', 'COVID19_Participant6', 'COVID19_Participant8', 'COVID19_Participant9', 'Control_Participant1', 'Control_Participant10', 'Control_Participant11', 'Control_Participant12', 'Control_Participant13', 'Control_Participant14', 'Control_Participant15', 'Control_Participant3', 'Control_Participant4', 'Control_Participant6', 'Control_Participant7', 'Control_Participant8']
  → test  환자 ID: ['COVID19_Participant11', 'COVID19_Participant2', 'COVID19_Participant23', 'COVID19_Participant25', 'COVID19_Participant36', 'COVID19_Participant37', 'COVID19_Participant7', 'Control_Participant2', 'Control_Participant5', 'Control_Participant9']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant10, Label: 1
    ID: COVID19_Participant12, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant18, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant21, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant27, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant3, Label: 1
    ID: COVID19_Participant30, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant35, Label: 1
    ID: COVID19_Participant38, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: COVID19_Participant5, Label: 1
    ID: COVID19_Participant6, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: COVID19_Participant9, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant10, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant12, Label: 0
    ID: Control_Participant13, Label: 0
    ID: Control_Participant14, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant4, Label: 0
    ID: Control_Participant6, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant8, Label: 0
  → test 환자 ID 및 라벨:
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant36, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: Control_Participant2, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant9, Label: 0
전체 데이터 index 길이 50
label_stat (train 환자 라벨 목록) 갯수 40
train_data에서 환자 단위로, train과 validation 나누기
기존 train_p_index 40
기존 (train) label_stat 40
train-vali 분할 후! 
train y 의 classes : {0, 1} valid y 의 classes : {0, 1} label_stat 의 classes : {0, 1}
train_p_index_ 26
valid_p_index 14
test_p_index 10
→ train 환자 ID 및 라벨:
   총 개수: 26
   환자ID=Control_Participant10, Label=0, 셀개수=1645
   환자ID=Control_Participant14, Label=0, 셀개수=274
   환자ID=COVID19_Participant18, Label=1, 셀개수=227
   환자ID=COVID19_Participant39, Label=1, 셀개수=454
   환자ID=COVID19_Participant10, Label=1, 셀개수=18
   환자ID=Control_Participant4, Label=0, 셀개수=440
   환자ID=COVID19_Participant14, Label=1, 셀개수=382
   환자ID=COVID19_Participant19, Label=1, 셀개수=816
   환자ID=COVID19_Participant40, Label=1, 셀개수=381
   환자ID=COVID19_Participant13, Label=1, 셀개수=730
   환자ID=COVID19_Participant20, Label=1, 셀개수=2033
   환자ID=Control_Participant15, Label=0, 셀개수=528
   환자ID=COVID19_Participant28, Label=1, 셀개수=1079
   환자ID=Control_Participant7, Label=0, 셀개수=762
   환자ID=Control_Participant6, Label=0, 셀개수=131
   환자ID=COVID19_Participant15, Label=1, 셀개수=1003
   환자ID=Control_Participant8, Label=0, 셀개수=393
   환자ID=Control_Participant11, Label=0, 셀개수=1164
   환자ID=COVID19_Participant22, Label=1, 셀개수=865
   환자ID=COVID19_Participant30, Label=1, 셀개수=116
   환자ID=COVID19_Participant27, Label=1, 셀개수=93
   환자ID=COVID19_Participant17, Label=1, 셀개수=843
   환자ID=COVID19_Participant6, Label=1, 셀개수=84
   환자ID=COVID19_Participant4, Label=1, 셀개수=1680
   환자ID=COVID19_Participant38, Label=1, 셀개수=51
   환자ID=COVID19_Participant3, Label=1, 셀개수=104
→ valid 환자 ID 및 라벨:
   총 개수: 14
   환자ID=Control_Participant13, Label=0, 셀개수=88
   환자ID=COVID19_Participant29, Label=1, 셀개수=573
   환자ID=COVID19_Participant32, Label=1, 셀개수=1665
   환자ID=COVID19_Participant31, Label=1, 셀개수=410
   환자ID=COVID19_Participant5, Label=1, 셀개수=89
   환자ID=COVID19_Participant21, Label=1, 셀개수=39
   환자ID=Control_Participant3, Label=0, 셀개수=1620
   환자ID=Control_Participant1, Label=0, 셀개수=414
   환자ID=COVID19_Participant9, Label=1, 셀개수=86
   환자ID=COVID19_Participant8, Label=1, 셀개수=462
   환자ID=Control_Participant12, Label=0, 셀개수=99
   환자ID=COVID19_Participant35, Label=1, 셀개수=83
   환자ID=COVID19_Participant12, Label=1, 셀개수=102
   환자ID=COVID19_Participant26, Label=1, 셀개수=814
→ test 환자 ID 및 라벨:
   총 개수: 10
   환자ID=COVID19_Participant11, Label=1, 셀개수=382
   환자ID=COVID19_Participant2, Label=1, 셀개수=329
   환자ID=COVID19_Participant23, Label=1, 셀개수=307
   환자ID=COVID19_Participant25, Label=1, 셀개수=496
   환자ID=COVID19_Participant36, Label=1, 셀개수=200
   환자ID=COVID19_Participant37, Label=1, 셀개수=668
   환자ID=COVID19_Participant7, Label=1, 셀개수=409
   환자ID=Control_Participant2, Label=0, 셀개수=41
   환자ID=Control_Participant5, Label=0, 셀개수=717
   환자ID=Control_Participant9, Label=0, 셀개수=558
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Ciliated Cells', 'Developing Ciliated Cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
전체 데이터 길이 26947
전체 cell type 길이 0        Developing Ciliated Cells
1        Developing Ciliated Cells
2        Developing Ciliated Cells
3        Developing Ciliated Cells
4        Developing Ciliated Cells
                   ...            
26942                 Goblet Cells
26943          Mitotic Basal Cells
26944               Ciliated Cells
26945               Ciliated Cells
26946                 Goblet Cells
Length: 26947, dtype: string
cell type의 NaN 개수 체크 0
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:10,  9.05it/s]  3%|▎         | 3/100 [00:00<00:18,  5.16it/s]  4%|▍         | 4/100 [00:00<00:15,  6.14it/s]  5%|▌         | 5/100 [00:00<00:13,  6.91it/s]  6%|▌         | 6/100 [00:00<00:12,  7.38it/s]  7%|▋         | 7/100 [00:01<00:12,  7.74it/s]  9%|▉         | 9/100 [00:01<00:10,  8.39it/s] 10%|█         | 10/100 [00:01<00:10,  8.31it/s] 11%|█         | 11/100 [00:01<00:10,  8.14it/s] 12%|█▏        | 12/100 [00:01<00:13,  6.58it/s] 13%|█▎        | 13/100 [00:01<00:12,  6.75it/s] 14%|█▍        | 14/100 [00:01<00:12,  6.75it/s] 15%|█▌        | 15/100 [00:02<00:13,  6.52it/s] 16%|█▌        | 16/100 [00:02<00:11,  7.13it/s] 17%|█▋        | 17/100 [00:02<00:11,  7.23it/s] 18%|█▊        | 18/100 [00:02<00:11,  7.02it/s] 19%|█▉        | 19/100 [00:02<00:10,  7.40it/s] 20%|██        | 20/100 [00:02<00:10,  8.00it/s] 21%|██        | 21/100 [00:02<00:09,  8.38it/s] 22%|██▏       | 22/100 [00:02<00:08,  8.68it/s] 24%|██▍       | 24/100 [00:03<00:08,  8.95it/s] 25%|██▌       | 25/100 [00:03<00:08,  8.75it/s] 26%|██▌       | 26/100 [00:03<00:08,  8.99it/s] 27%|██▋       | 27/100 [00:03<00:08,  8.99it/s] 28%|██▊       | 28/100 [00:03<00:09,  7.92it/s] 29%|██▉       | 29/100 [00:03<00:12,  5.82it/s] 30%|███       | 30/100 [00:04<00:13,  5.32it/s] 31%|███       | 31/100 [00:04<00:16,  4.10it/s] 32%|███▏      | 32/100 [00:04<00:13,  4.93it/s] 33%|███▎      | 33/100 [00:04<00:11,  5.76it/s] 34%|███▍      | 34/100 [00:04<00:10,  6.54it/s] 36%|███▌      | 36/100 [00:05<00:08,  7.64it/s] 37%|███▋      | 37/100 [00:05<00:08,  7.72it/s] 38%|███▊      | 38/100 [00:05<00:09,  6.33it/s] 39%|███▉      | 39/100 [00:05<00:08,  6.98it/s] 41%|████      | 41/100 [00:05<00:07,  7.72it/s] 42%|████▏     | 42/100 [00:05<00:07,  8.09it/s] 43%|████▎     | 43/100 [00:06<00:06,  8.20it/s] 44%|████▍     | 44/100 [00:06<00:08,  6.74it/s] 45%|████▌     | 45/100 [00:06<00:09,  5.69it/s] 46%|████▌     | 46/100 [00:06<00:08,  6.25it/s] 47%|████▋     | 47/100 [00:06<00:07,  6.89it/s] 48%|████▊     | 48/100 [00:06<00:07,  7.15it/s] 50%|█████     | 50/100 [00:07<00:06,  7.84it/s] 51%|█████     | 51/100 [00:07<00:07,  6.52it/s] 52%|█████▏    | 52/100 [00:07<00:07,  6.48it/s] 53%|█████▎    | 53/100 [00:07<00:06,  6.92it/s] 54%|█████▍    | 54/100 [00:07<00:06,  7.45it/s] 55%|█████▌    | 55/100 [00:08<00:09,  4.67it/s] 56%|█████▌    | 56/100 [00:08<00:08,  4.91it/s] 57%|█████▋    | 57/100 [00:08<00:07,  5.69it/s] 58%|█████▊    | 58/100 [00:08<00:06,  6.34it/s] 59%|█████▉    | 59/100 [00:08<00:08,  5.09it/s] 60%|██████    | 60/100 [00:08<00:06,  5.80it/s] 61%|██████    | 61/100 [00:09<00:06,  6.43it/s] 62%|██████▏   | 62/100 [00:09<00:05,  7.00it/s] 63%|██████▎   | 63/100 [00:09<00:05,  6.84it/s] 64%|██████▍   | 64/100 [00:09<00:04,  7.29it/s] 65%|██████▌   | 65/100 [00:09<00:04,  7.62it/s] 66%|██████▌   | 66/100 [00:09<00:04,  7.49it/s] 67%|██████▋   | 67/100 [00:09<00:04,  7.91it/s] 68%|██████▊   | 68/100 [00:10<00:05,  6.34it/s] 69%|██████▉   | 69/100 [00:10<00:04,  6.85it/s] 70%|███████   | 70/100 [00:10<00:03,  7.53it/s] 71%|███████   | 71/100 [00:10<00:03,  8.12it/s] 72%|███████▏  | 72/100 [00:10<00:04,  6.54it/s] 73%|███████▎  | 73/100 [00:10<00:03,  6.81it/s] 74%|███████▍  | 74/100 [00:10<00:03,  7.14it/s] 75%|███████▌  | 75/100 [00:11<00:05,  4.70it/s] 76%|███████▌  | 76/100 [00:11<00:04,  5.03it/s] 77%|███████▋  | 77/100 [00:11<00:03,  5.84it/s] 78%|███████▊  | 78/100 [00:11<00:03,  6.51it/s] 79%|███████▉  | 79/100 [00:11<00:03,  6.63it/s] 81%|████████  | 81/100 [00:11<00:02,  7.71it/s] 82%|████████▏ | 82/100 [00:12<00:02,  7.92it/s] 83%|████████▎ | 83/100 [00:12<00:02,  8.16it/s] 84%|████████▍ | 84/100 [00:12<00:01,  8.36it/s] 85%|████████▌ | 85/100 [00:12<00:01,  8.59it/s] 86%|████████▌ | 86/100 [00:12<00:01,  8.72it/s] 87%|████████▋ | 87/100 [00:12<00:01,  7.38it/s] 88%|████████▊ | 88/100 [00:12<00:01,  7.41it/s] 89%|████████▉ | 89/100 [00:12<00:01,  7.93it/s] 90%|█████████ | 90/100 [00:13<00:01,  7.78it/s] 91%|█████████ | 91/100 [00:13<00:01,  8.17it/s] 92%|█████████▏| 92/100 [00:13<00:01,  7.36it/s] 93%|█████████▎| 93/100 [00:13<00:00,  7.28it/s] 94%|█████████▍| 94/100 [00:13<00:00,  6.99it/s] 95%|█████████▌| 95/100 [00:13<00:00,  7.52it/s] 96%|█████████▌| 96/100 [00:13<00:00,  7.09it/s] 97%|█████████▋| 97/100 [00:13<00:00,  7.70it/s] 98%|█████████▊| 98/100 [00:14<00:00,  7.92it/s] 99%|█████████▉| 99/100 [00:14<00:00,  8.30it/s]100%|██████████| 100/100 [00:14<00:00,  6.99it/s]
[I 2025-08-30 05:22:15,619] A new study created in memory with name: no-name-845f07de-0a43-4c16-ac48-3ee9639eee1c
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 27.97 MB
Memory Reserved: 46.00 MB
cuda
Epoch 1, Train Loss 0.702158, Valid_loss 0.603080
Epoch 2, Train Loss 0.580105, Valid_loss 0.593614
Epoch 3, Train Loss 0.472690, Valid_loss 0.736858
Epoch 4, Train Loss 0.384571, Valid_loss 0.934089
Epoch 5, Train Loss 0.353620, Valid_loss 0.694599
Epoch 6, Train Loss 0.348883, Valid_loss 0.767306
Epoch 7, Train Loss 0.327757, Valid_loss 0.542926
Epoch 8, Train Loss 0.316202, Valid_loss 0.778531
Epoch 9, Train Loss 0.330691, Valid_loss 0.501683
Epoch 10, Train Loss 0.307564, Valid_loss 0.599555
Epoch 11, Train Loss 0.306685, Valid_loss 0.631887
Epoch 12, Train Loss 0.279597, Valid_loss 0.660559
Epoch 13, Train Loss 0.267542, Valid_loss 0.635310
Epoch 14, Train Loss 0.261046, Valid_loss 0.570894
Epoch 15, Train Loss 0.259283, Valid_loss 0.676668
Epoch 16, Train Loss 0.259512, Valid_loss 0.664706
Epoch 17, Train Loss 0.266830, Valid_loss 0.689654
Epoch 18, Train Loss 0.269919, Valid_loss 0.740331
Epoch 19, Train Loss 0.256320, Valid_loss 0.598351
Epoch 20, Train Loss 0.243655, Valid_loss 0.658839
Epoch 21, Train Loss 0.238121, Valid_loss 0.542100
Epoch 22, Train Loss 0.237875, Valid_loss 0.758732
Epoch 23, Train Loss 0.233256, Valid_loss 0.698195
Epoch 24, Train Loss 0.243200, Valid_loss 0.639295
Epoch 25, Train Loss 0.225983, Valid_loss 0.659560
Epoch 26, Train Loss 0.230403, Valid_loss 0.638545
Epoch 27, Train Loss 0.226361, Valid_loss 0.696526
Epoch 28, Train Loss 0.236622, Valid_loss 0.981441
Epoch 29, Train Loss 0.240756, Valid_loss 0.751393
Epoch 30, Train Loss 0.232495, Valid_loss 0.751576
Epoch 31, Train Loss 0.227731, Valid_loss 0.587756
Epoch 32, Train Loss 0.236422, Valid_loss 0.668041
Epoch 33, Train Loss 0.228880, Valid_loss 0.970721
Epoch 34, Train Loss 0.216592, Valid_loss 0.753230
Epoch 35, Train Loss 0.215707, Valid_loss 0.734368
Epoch 36, Train Loss 0.220063, Valid_loss 0.637909
Epoch 37, Train Loss 0.211409, Valid_loss 0.835657
Epoch 38, Train Loss 0.207257, Valid_loss 0.676817
Epoch 39, Train Loss 0.210842, Valid_loss 0.669488
Epoch 40, Train Loss 0.223597, Valid_loss 0.711626
Epoch 41, Train Loss 0.220179, Valid_loss 0.811169
Epoch 42, Train Loss 0.216838, Valid_loss 0.801847
Epoch 43, Train Loss 0.215884, Valid_loss 0.923180
Epoch 44, Train Loss 0.210669, Valid_loss 0.678565
Epoch 45, Train Loss 0.207425, Valid_loss 0.627156
Epoch 46, Train Loss 0.216875, Valid_loss 0.774108
Epoch 47, Train Loss 0.218253, Valid_loss 0.629329
Epoch 48, Train Loss 0.208070, Valid_loss 0.915579
Epoch 49, Train Loss 0.204371, Valid_loss 0.792326
Epoch 50, Train Loss 0.211189, Valid_loss 0.596610
Epoch 51, Train Loss 0.209330, Valid_loss 0.917523
Epoch 52, Train Loss 0.205563, Valid_loss 0.631621
Epoch 53, Train Loss 0.210155, Valid_loss 0.793258
Epoch 54, Train Loss 0.205619, Valid_loss 0.743068
Epoch 55, Train Loss 0.203839, Valid_loss 0.810158
Epoch 56, Train Loss 0.203499, Valid_loss 0.741694
Epoch 57, Train Loss 0.203645, Valid_loss 0.943814
Epoch 58, Train Loss 0.204204, Valid_loss 0.715004
Epoch 59, Train Loss 0.199857, Valid_loss 0.789109
Epoch 60, Train Loss 0.209130, Valid_loss 0.742705
Epoch 61, Train Loss 0.207574, Valid_loss 0.881320
Epoch 62, Train Loss 0.204102, Valid_loss 0.710729
Epoch 63, Train Loss 0.202746, Valid_loss 0.757937
Epoch 64, Train Loss 0.200331, Valid_loss 0.686430
Epoch 65, Train Loss 0.212369, Valid_loss 0.635530
Epoch 66, Train Loss 0.208029, Valid_loss 0.743686
Epoch 67, Train Loss 0.206902, Valid_loss 0.803677
[I 2025-08-30 05:27:32,923] Trial 0 finished with value: 0.5016825938863414 and parameters: {'learning_rate': 0.001, 'epochs': 100, 'heads': 4, 'dropout': 0.5, 'weight_decay': 0.001, 'emb_dim': 64, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.5016825938863414.
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 27.97 MB
Memory Reserved: 46.00 MB
cuda
Epoch 1, Train Loss 0.679356, Valid_loss 0.586934
Epoch 2, Train Loss 0.531793, Valid_loss 0.533646
Epoch 3, Train Loss 0.420211, Valid_loss 0.464200
Epoch 4, Train Loss 0.378372, Valid_loss 0.411263
Epoch 5, Train Loss 0.345234, Valid_loss 0.648710
Epoch 6, Train Loss 0.327140, Valid_loss 0.566175
Epoch 7, Train Loss 0.308392, Valid_loss 0.534403
Epoch 8, Train Loss 0.320891, Valid_loss 0.576509
Epoch 9, Train Loss 0.293390, Valid_loss 0.481630
Epoch 10, Train Loss 0.279194, Valid_loss 0.654673
Epoch 11, Train Loss 0.293977, Valid_loss 0.712983
Epoch 12, Train Loss 0.288008, Valid_loss 0.725562
Epoch 13, Train Loss 0.287393, Valid_loss 0.730203
Epoch 14, Train Loss 0.281144, Valid_loss 0.575791
Epoch 15, Train Loss 0.279559, Valid_loss 0.855661
Epoch 16, Train Loss 0.299252, Valid_loss 0.646527
Epoch 17, Train Loss 0.268410, Valid_loss 0.584405
Epoch 18, Train Loss 0.280169, Valid_loss 0.719936
Epoch 19, Train Loss 0.269163, Valid_loss 0.561576
Epoch 20, Train Loss 0.265592, Valid_loss 0.511050
Epoch 21, Train Loss 0.265600, Valid_loss 0.638066
Epoch 22, Train Loss 0.253307, Valid_loss 0.525981
Epoch 23, Train Loss 0.258855, Valid_loss 0.416563
Epoch 24, Train Loss 0.257303, Valid_loss 0.446279
Epoch 25, Train Loss 0.259736, Valid_loss 0.472448
Epoch 26, Train Loss 0.264586, Valid_loss 0.517154
Epoch 27, Train Loss 0.249706, Valid_loss 0.539457
Epoch 28, Train Loss 0.252149, Valid_loss 0.492306
Epoch 29, Train Loss 0.248904, Valid_loss 0.566355
Epoch 30, Train Loss 0.244119, Valid_loss 0.457116
Epoch 31, Train Loss 0.287368, Valid_loss 0.667363
Epoch 32, Train Loss 0.247582, Valid_loss 0.628537
Epoch 33, Train Loss 0.243190, Valid_loss 0.554130
Epoch 34, Train Loss 0.244214, Valid_loss 0.517939
Epoch 35, Train Loss 0.254287, Valid_loss 0.368564
Epoch 36, Train Loss 0.249515, Valid_loss 0.675793
Epoch 37, Train Loss 0.251206, Valid_loss 0.583634
Epoch 38, Train Loss 0.251348, Valid_loss 0.694246
Epoch 39, Train Loss 0.242245, Valid_loss 0.480648
Epoch 40, Train Loss 0.249078, Valid_loss 0.548091
Epoch 41, Train Loss 0.246971, Valid_loss 0.542660
Epoch 42, Train Loss 0.236469, Valid_loss 0.583198
Epoch 43, Train Loss 0.240471, Valid_loss 0.567753
Epoch 44, Train Loss 0.237054, Valid_loss 0.413298
Epoch 45, Train Loss 0.241259, Valid_loss 0.576855
Epoch 46, Train Loss 0.246404, Valid_loss 0.563329
Epoch 47, Train Loss 0.237304, Valid_loss 0.427851
Epoch 48, Train Loss 0.248543, Valid_loss 0.635279
Epoch 49, Train Loss 0.250015, Valid_loss 0.641194
Epoch 50, Train Loss 0.244504, Valid_loss 0.615707
Epoch 51, Train Loss 0.236466, Valid_loss 0.530989
Epoch 52, Train Loss 0.245097, Valid_loss 0.680717
Epoch 53, Train Loss 0.240673, Valid_loss 0.528144
Epoch 54, Train Loss 0.235357, Valid_loss 0.575155
Epoch 55, Train Loss 0.253877, Valid_loss 0.661335
[I 2025-08-30 05:31:54,578] Trial 1 finished with value: 0.36856391307498726 and parameters: {'learning_rate': 0.001, 'epochs': 100, 'heads': 4, 'dropout': 0.5, 'weight_decay': 0.01, 'emb_dim': 64, 'augment_num': 100, 'pca': False}. Best is trial 1 with value: 0.36856391307498726.
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 27.97 MB
Memory Reserved: 46.00 MB
cuda
Epoch 1, Train Loss 0.597367, Valid_loss 0.537679
Epoch 2, Train Loss 0.408175, Valid_loss 0.506303
Epoch 3, Train Loss 0.354381, Valid_loss 0.452470
Epoch 4, Train Loss 0.360507, Valid_loss 0.678511
Epoch 5, Train Loss 0.326149, Valid_loss 0.497096
Epoch 6, Train Loss 0.299233, Valid_loss 0.505114
Epoch 7, Train Loss 0.291196, Valid_loss 0.623065
Epoch 8, Train Loss 0.277881, Valid_loss 0.470990
Epoch 9, Train Loss 0.274970, Valid_loss 0.616326
Epoch 10, Train Loss 0.264642, Valid_loss 0.607576
Epoch 11, Train Loss 0.251904, Valid_loss 0.589698
Epoch 12, Train Loss 0.269275, Valid_loss 0.538636
Epoch 13, Train Loss 0.313842, Valid_loss 0.834373
Epoch 14, Train Loss 0.276267, Valid_loss 0.617360
Epoch 15, Train Loss 0.259180, Valid_loss 0.658536
Epoch 16, Train Loss 0.254120, Valid_loss 0.641726
Epoch 17, Train Loss 0.250693, Valid_loss 0.614657
Epoch 18, Train Loss 0.255097, Valid_loss 0.672744
Epoch 19, Train Loss 0.247184, Valid_loss 0.598272
Epoch 20, Train Loss 0.249334, Valid_loss 0.472409
Epoch 21, Train Loss 0.297064, Valid_loss 0.776406
Epoch 22, Train Loss 0.269281, Valid_loss 0.526165
Epoch 23, Train Loss 0.259468, Valid_loss 0.530224
Epoch 24, Train Loss 0.262301, Valid_loss 0.518825
Epoch 25, Train Loss 0.248824, Valid_loss 0.558540
Epoch 26, Train Loss 0.248034, Valid_loss 0.704238
Epoch 27, Train Loss 0.250198, Valid_loss 0.695866
Epoch 28, Train Loss 0.256032, Valid_loss 0.542314
Epoch 29, Train Loss 0.238550, Valid_loss 0.556046
Epoch 30, Train Loss 0.235374, Valid_loss 0.590299
Epoch 31, Train Loss 0.238704, Valid_loss 0.522845
Epoch 32, Train Loss 0.245180, Valid_loss 0.525775
Epoch 33, Train Loss 0.250951, Valid_loss 0.483410
Epoch 34, Train Loss 0.256981, Valid_loss 0.581564
Epoch 35, Train Loss 0.256756, Valid_loss 0.643629
Epoch 36, Train Loss 0.246258, Valid_loss 0.617114
Epoch 37, Train Loss 0.237798, Valid_loss 0.493899
Epoch 38, Train Loss 0.233200, Valid_loss 0.604535
Epoch 39, Train Loss 0.230893, Valid_loss 0.505522
Epoch 40, Train Loss 0.231281, Valid_loss 0.674065
Epoch 41, Train Loss 0.256505, Valid_loss 0.527315
Epoch 42, Train Loss 0.236573, Valid_loss 0.666970
Epoch 43, Train Loss 0.242364, Valid_loss 0.551088
Epoch 44, Train Loss 0.236350, Valid_loss 0.607621
Epoch 45, Train Loss 0.226453, Valid_loss 0.498219
Epoch 46, Train Loss 0.243771, Valid_loss 0.550270
Epoch 47, Train Loss 0.230975, Valid_loss 0.635493
Epoch 48, Train Loss 0.230869, Valid_loss 0.834952
Epoch 49, Train Loss 0.232167, Valid_loss 0.696980
Epoch 50, Train Loss 0.246188, Valid_loss 0.622161
Epoch 51, Train Loss 0.234708, Valid_loss 0.526289
Epoch 52, Train Loss 0.222987, Valid_loss 0.737063
Epoch 53, Train Loss 0.224410, Valid_loss 0.608774
Epoch 54, Train Loss 0.214547, Valid_loss 0.575469
Epoch 55, Train Loss 0.221396, Valid_loss 0.663559
Epoch 56, Train Loss 0.214412, Valid_loss 0.745832
[I 2025-08-30 05:35:28,306] Trial 2 finished with value: 0.45247049416814533 and parameters: {'learning_rate': 0.001, 'epochs': 100, 'heads': 1, 'dropout': 0.3, 'weight_decay': 0.01, 'emb_dim': 64, 'augment_num': 100, 'pca': False}. Best is trial 1 with value: 0.36856391307498726.
선택된 trial params: {'learning_rate': 0.001, 'epochs': 100, 'heads': 4, 'dropout': 0.5, 'weight_decay': 0.01, 'emb_dim': 64, 'augment_num': 100, 'pca': False}
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=10, batch_size=1 -> steps=10
output_class :  1
Memory Allocated: 27.97 MB
Memory Reserved: 46.00 MB
cuda
Epoch 1, Train Loss 0.625823, Valid_loss 0.627972
Epoch 2, Train Loss 0.557662, Valid_loss 0.580087
Epoch 3, Train Loss 0.469662, Valid_loss 0.609521
Epoch 4, Train Loss 0.373505, Valid_loss 0.659712
Epoch 5, Train Loss 0.368419, Valid_loss 0.678902
Epoch 6, Train Loss 0.328802, Valid_loss 0.640012
Epoch 7, Train Loss 0.344126, Valid_loss 0.866875
Epoch 8, Train Loss 0.341289, Valid_loss 0.680850
Epoch 9, Train Loss 0.306380, Valid_loss 0.576790
Epoch 10, Train Loss 0.312019, Valid_loss 0.411517
Epoch 11, Train Loss 0.318780, Valid_loss 0.536862
Epoch 12, Train Loss 0.304987, Valid_loss 0.695322
Epoch 13, Train Loss 0.294176, Valid_loss 0.543151
Epoch 14, Train Loss 0.289857, Valid_loss 0.772537
Epoch 15, Train Loss 0.262586, Valid_loss 0.554332
Epoch 16, Train Loss 0.264057, Valid_loss 0.600623
Epoch 17, Train Loss 0.282149, Valid_loss 0.579821
Epoch 18, Train Loss 0.284939, Valid_loss 0.452900
Epoch 19, Train Loss 0.278590, Valid_loss 0.531294
Epoch 20, Train Loss 0.266448, Valid_loss 0.475116
Epoch 21, Train Loss 0.263042, Valid_loss 0.620041
Epoch 22, Train Loss 0.252224, Valid_loss 0.558520
Epoch 23, Train Loss 0.250064, Valid_loss 0.579855
Epoch 24, Train Loss 0.250586, Valid_loss 0.568893
Epoch 25, Train Loss 0.256342, Valid_loss 0.532986
Epoch 26, Train Loss 0.265516, Valid_loss 0.791517
Epoch 27, Train Loss 0.268264, Valid_loss 0.601451
Epoch 28, Train Loss 0.260176, Valid_loss 0.662228
Epoch 29, Train Loss 0.252657, Valid_loss 0.548117
Epoch 30, Train Loss 0.266404, Valid_loss 0.520751
Epoch 31, Train Loss 0.256495, Valid_loss 0.545270
Epoch 32, Train Loss 0.243572, Valid_loss 0.480968
Epoch 33, Train Loss 0.250275, Valid_loss 0.643683
Epoch 34, Train Loss 0.254501, Valid_loss 0.652711
Epoch 35, Train Loss 0.248388, Valid_loss 0.539130
Epoch 36, Train Loss 0.243815, Valid_loss 0.586700
Epoch 37, Train Loss 0.260154, Valid_loss 0.537924
Epoch 38, Train Loss 0.265265, Valid_loss 0.725460
Epoch 39, Train Loss 0.258232, Valid_loss 0.691160
Epoch 40, Train Loss 0.255025, Valid_loss 0.715081
Epoch 41, Train Loss 0.247406, Valid_loss 0.540013
Epoch 42, Train Loss 0.250261, Valid_loss 0.639058
Epoch 43, Train Loss 0.258447, Valid_loss 0.494948
Epoch 44, Train Loss 0.243083, Valid_loss 0.555899
Epoch 45, Train Loss 0.254852, Valid_loss 0.506656
Epoch 46, Train Loss 0.245612, Valid_loss 0.709573
Epoch 47, Train Loss 0.238650, Valid_loss 0.669089
Epoch 48, Train Loss 0.240180, Valid_loss 0.689485
Epoch 49, Train Loss 0.280953, Valid_loss 0.537217
Epoch 50, Train Loss 0.253939, Valid_loss 0.710365
Epoch 51, Train Loss 0.241386, Valid_loss 0.682571
Epoch 52, Train Loss 0.237869, Valid_loss 0.697892
Epoch 53, Train Loss 0.240794, Valid_loss 0.714783
환자ID=COVID19_Participant11 -- true: 1 -- pred: 1
환자ID=COVID19_Participant2 -- true: 1 -- pred: 1
환자ID=COVID19_Participant23 -- true: 1 -- pred: 1
환자ID=COVID19_Participant25 -- true: 1 -- pred: 1
환자ID=COVID19_Participant36 -- true: 1 -- pred: 1
환자ID=COVID19_Participant37 -- true: 1 -- pred: 1
환자ID=COVID19_Participant7 -- true: 1 -- pred: 1
환자ID=Control_Participant2 -- true: 0 -- pred: 0
환자ID=Control_Participant5 -- true: 0 -- pred: 0
환자ID=Control_Participant9 -- true: 0 -- pred: 0
Best performance: Epoch 10, Loss 0.312019, Test ACC 1.000000, Test AUC 1.000000, Test Recall 1.000000, Test Precision 1.000000
Confusion Matrix:
 [3 0 0 7]
✅ Total valid splits used: 1
🔁 Repeat 1, Fold 1
cell type :  CATTAAGGATAT_COVID19_Participant13    Developing Ciliated Cells
GTAGAAGGGGGG_COVID19_Participant13    Developing Ciliated Cells
ATTAAGAGGTAG_COVID19_Participant13    Developing Ciliated Cells
AGATATGACAAG_COVID19_Participant13    Developing Ciliated Cells
CTTGTAACAAAT_COVID19_Participant13               Squamous Cells
                                                ...            
GCAGGGAACTCC_COVID19_Participant30               Squamous Cells
CAGCACCGAGCC_COVID19_Participant30               Squamous Cells
GCCCCTTGTGAT_COVID19_Participant30               Squamous Cells
GTGTTGTGTGTC_COVID19_Participant30               Squamous Cells
TAACACTCACTT_COVID19_Participant30               Squamous Cells
Name: manual_annotation, Length: 20379, dtype: string
cell type annotation :  CATTAAGGATAT_COVID19_Participant13    Developing Ciliated Cells
GTAGAAGGGGGG_COVID19_Participant13    Developing Ciliated Cells
ATTAAGAGGTAG_COVID19_Participant13    Developing Ciliated Cells
AGATATGACAAG_COVID19_Participant13    Developing Ciliated Cells
CTTGTAACAAAT_COVID19_Participant13               Squamous Cells
                                                ...            
GCAGGGAACTCC_COVID19_Participant30               Squamous Cells
CAGCACCGAGCC_COVID19_Participant30               Squamous Cells
GCCCCTTGTGAT_COVID19_Participant30               Squamous Cells
GTGTTGTGTGTC_COVID19_Participant30               Squamous Cells
TAACACTCACTT_COVID19_Participant30               Squamous Cells
Name: manual_annotation, Length: 20379, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Developing Ciliated Cells', 'Squamous Cells', 'Secretory Cells', 'Macrophages', 'B Cells', 'Ciliated Cells', 'T Cells', 'Dendritic Cells', 'Goblet Cells', 'Deuterosomal Cells', 'Basal Cells', 'Ionocytes', 'Mitotic Basal Cells', 'Developing Secretory and Goblet Cells', 'Plasmacytoid DCs', 'Enteroendocrine Cells', 'Erythroblasts', 'Mast Cells']
라벨별 그룹 개수 {1: 28, 0: 12}
cell type :  GTCGGGGGGTGG_Control_Participant7     Developing Ciliated Cells
CAAATCAATTAT_Control_Participant7     Developing Ciliated Cells
ATACAATTGACA_Control_Participant7     Developing Ciliated Cells
CTGTTAATGAGA_Control_Participant7     Developing Ciliated Cells
CTTCACATTATT_Control_Participant7     Developing Ciliated Cells
                                                ...            
GCGCCCGTGTTA_COVID19_Participant27                 Goblet Cells
TTGATCCGTGGC_COVID19_Participant27                      T Cells
CGCGACTACTCT_COVID19_Participant27              Secretory Cells
AAACGCTTGTTA_COVID19_Participant27               Ciliated Cells
CATTGGGGGAAA_COVID19_Participant27              Secretory Cells
Name: manual_annotation, Length: 6568, dtype: string
cell type annotation :  GTCGGGGGGTGG_Control_Participant7     Developing Ciliated Cells
CAAATCAATTAT_Control_Participant7     Developing Ciliated Cells
ATACAATTGACA_Control_Participant7     Developing Ciliated Cells
CTGTTAATGAGA_Control_Participant7     Developing Ciliated Cells
CTTCACATTATT_Control_Participant7     Developing Ciliated Cells
                                                ...            
GCGCCCGTGTTA_COVID19_Participant27                 Goblet Cells
TTGATCCGTGGC_COVID19_Participant27                      T Cells
CGCGACTACTCT_COVID19_Participant27              Secretory Cells
AAACGCTTGTTA_COVID19_Participant27               Ciliated Cells
CATTGGGGGAAA_COVID19_Participant27              Secretory Cells
Name: manual_annotation, Length: 6568, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Developing Ciliated Cells', 'Ciliated Cells', 'Secretory Cells', 'Squamous Cells', 'Goblet Cells', 'T Cells', 'Dendritic Cells', 'Basal Cells', 'Deuterosomal Cells', 'Mitotic Basal Cells', 'Macrophages', 'Ionocytes', 'Enteroendocrine Cells', 'Developing Secretory and Goblet Cells', 'Erythroblasts', 'Mast Cells', 'B Cells']
라벨별 그룹 개수 {1: 7, 0: 3}
🔍 Split #2
  → train_p_index 환자 수 (환자 단위로 묶인 index list): 40
  → test_p_index 환자 수  (환자 단위로 묶인 index list): 10
  → train 환자 ID: ['COVID19_Participant10', 'COVID19_Participant11', 'COVID19_Participant12', 'COVID19_Participant13', 'COVID19_Participant14', 'COVID19_Participant15', 'COVID19_Participant18', 'COVID19_Participant2', 'COVID19_Participant20', 'COVID19_Participant21', 'COVID19_Participant23', 'COVID19_Participant25', 'COVID19_Participant28', 'COVID19_Participant3', 'COVID19_Participant30', 'COVID19_Participant31', 'COVID19_Participant32', 'COVID19_Participant35', 'COVID19_Participant36', 'COVID19_Participant37', 'COVID19_Participant39', 'COVID19_Participant4', 'COVID19_Participant40', 'COVID19_Participant5', 'COVID19_Participant6', 'COVID19_Participant7', 'COVID19_Participant8', 'COVID19_Participant9', 'Control_Participant1', 'Control_Participant10', 'Control_Participant11', 'Control_Participant12', 'Control_Participant13', 'Control_Participant14', 'Control_Participant15', 'Control_Participant2', 'Control_Participant4', 'Control_Participant5', 'Control_Participant8', 'Control_Participant9']
  → test  환자 ID: ['COVID19_Participant17', 'COVID19_Participant19', 'COVID19_Participant22', 'COVID19_Participant26', 'COVID19_Participant27', 'COVID19_Participant29', 'COVID19_Participant38', 'Control_Participant3', 'Control_Participant6', 'Control_Participant7']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant10, Label: 1
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant12, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant18, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant21, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant3, Label: 1
    ID: COVID19_Participant30, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant35, Label: 1
    ID: COVID19_Participant36, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: COVID19_Participant5, Label: 1
    ID: COVID19_Participant6, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: COVID19_Participant9, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant10, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant12, Label: 0
    ID: Control_Participant13, Label: 0
    ID: Control_Participant14, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant2, Label: 0
    ID: Control_Participant4, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant8, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant27, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant38, Label: 1
    ID: Control_Participant3, Label: 0
    ID: Control_Participant6, Label: 0
    ID: Control_Participant7, Label: 0
전체 데이터 index 길이 50
label_stat (train 환자 라벨 목록) 갯수 40
train_data에서 환자 단위로, train과 validation 나누기
기존 train_p_index 40
기존 (train) label_stat 40
train-vali 분할 후! 
train y 의 classes : {0, 1} valid y 의 classes : {0, 1} label_stat 의 classes : {0, 1}
train_p_index_ 26
valid_p_index 14
test_p_index 10
→ train 환자 ID 및 라벨:
   총 개수: 26
   환자ID=Control_Participant10, Label=0, 셀개수=1645
   환자ID=Control_Participant14, Label=0, 셀개수=274
   환자ID=COVID19_Participant18, Label=1, 셀개수=227
   환자ID=COVID19_Participant4, Label=1, 셀개수=1680
   환자ID=COVID19_Participant10, Label=1, 셀개수=18
   환자ID=Control_Participant4, Label=0, 셀개수=440
   환자ID=COVID19_Participant13, Label=1, 셀개수=730
   환자ID=COVID19_Participant2, Label=1, 셀개수=329
   환자ID=COVID19_Participant5, Label=1, 셀개수=89
   환자ID=COVID19_Participant12, Label=1, 셀개수=102
   환자ID=COVID19_Participant20, Label=1, 셀개수=2033
   환자ID=Control_Participant15, Label=0, 셀개수=528
   환자ID=COVID19_Participant3, Label=1, 셀개수=104
   환자ID=Control_Participant8, Label=0, 셀개수=393
   환자ID=Control_Participant5, Label=0, 셀개수=717
   환자ID=COVID19_Participant14, Label=1, 셀개수=382
   환자ID=Control_Participant9, Label=0, 셀개수=558
   환자ID=Control_Participant11, Label=0, 셀개수=1164
   환자ID=COVID19_Participant23, Label=1, 셀개수=307
   환자ID=COVID19_Participant32, Label=1, 셀개수=1665
   환자ID=COVID19_Participant28, Label=1, 셀개수=1079
   환자ID=COVID19_Participant15, Label=1, 셀개수=1003
   환자ID=COVID19_Participant7, Label=1, 셀개수=409
   환자ID=COVID19_Participant40, Label=1, 셀개수=381
   환자ID=COVID19_Participant39, Label=1, 셀개수=454
   환자ID=COVID19_Participant31, Label=1, 셀개수=410
→ valid 환자 ID 및 라벨:
   총 개수: 14
   환자ID=Control_Participant13, Label=0, 셀개수=88
   환자ID=COVID19_Participant30, Label=1, 셀개수=116
   환자ID=COVID19_Participant36, Label=1, 셀개수=200
   환자ID=COVID19_Participant35, Label=1, 셀개수=83
   환자ID=COVID19_Participant6, Label=1, 셀개수=84
   환자ID=COVID19_Participant21, Label=1, 셀개수=39
   환자ID=Control_Participant2, Label=0, 셀개수=41
   환자ID=Control_Participant1, Label=0, 셀개수=414
   환자ID=COVID19_Participant9, Label=1, 셀개수=86
   환자ID=COVID19_Participant8, Label=1, 셀개수=462
   환자ID=Control_Participant12, Label=0, 셀개수=99
   환자ID=COVID19_Participant37, Label=1, 셀개수=668
   환자ID=COVID19_Participant11, Label=1, 셀개수=382
   환자ID=COVID19_Participant25, Label=1, 셀개수=496
→ test 환자 ID 및 라벨:
   총 개수: 10
   환자ID=COVID19_Participant17, Label=1, 셀개수=843
   환자ID=COVID19_Participant19, Label=1, 셀개수=816
   환자ID=COVID19_Participant22, Label=1, 셀개수=865
   환자ID=COVID19_Participant26, Label=1, 셀개수=814
   환자ID=COVID19_Participant27, Label=1, 셀개수=93
   환자ID=COVID19_Participant29, Label=1, 셀개수=573
   환자ID=COVID19_Participant38, Label=1, 셀개수=51
   환자ID=Control_Participant3, Label=0, 셀개수=1620
   환자ID=Control_Participant6, Label=0, 셀개수=131
   환자ID=Control_Participant7, Label=0, 셀개수=762
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Squamous Cells', 'Secretory Cells', 'Macrophages', 'Developing Ciliated Cells', 'B Cells', 'Ciliated Cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
전체 데이터 길이 26947
전체 cell type 길이 0        Developing Ciliated Cells
1        Developing Ciliated Cells
2        Developing Ciliated Cells
3        Developing Ciliated Cells
4                   Squamous Cells
                   ...            
26942                 Goblet Cells
26943                      T Cells
26944              Secretory Cells
26945               Ciliated Cells
26946              Secretory Cells
Length: 26947, dtype: string
cell type의 NaN 개수 체크 0
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:19,  4.98it/s]  2%|▏         | 2/100 [00:00<00:14,  6.88it/s]  3%|▎         | 3/100 [00:00<00:14,  6.89it/s]  4%|▍         | 4/100 [00:00<00:17,  5.56it/s]  5%|▌         | 5/100 [00:00<00:14,  6.46it/s]  7%|▋         | 7/100 [00:00<00:11,  8.13it/s]  8%|▊         | 8/100 [00:01<00:12,  7.60it/s]  9%|▉         | 9/100 [00:01<00:11,  7.97it/s] 10%|█         | 10/100 [00:01<00:11,  8.08it/s] 11%|█         | 11/100 [00:01<00:10,  8.46it/s] 12%|█▏        | 12/100 [00:01<00:14,  6.27it/s] 13%|█▎        | 13/100 [00:01<00:14,  6.02it/s] 14%|█▍        | 14/100 [00:02<00:12,  6.75it/s] 15%|█▌        | 15/100 [00:02<00:11,  7.38it/s] 16%|█▌        | 16/100 [00:02<00:11,  7.09it/s] 17%|█▋        | 17/100 [00:02<00:10,  7.55it/s] 19%|█▉        | 19/100 [00:02<00:10,  7.89it/s] 20%|██        | 20/100 [00:02<00:10,  7.98it/s] 21%|██        | 21/100 [00:02<00:09,  8.32it/s] 23%|██▎       | 23/100 [00:03<00:13,  5.58it/s] 25%|██▌       | 25/100 [00:03<00:12,  5.98it/s] 26%|██▌       | 26/100 [00:03<00:11,  6.21it/s] 27%|██▋       | 27/100 [00:03<00:10,  6.70it/s] 28%|██▊       | 28/100 [00:04<00:09,  7.25it/s] 29%|██▉       | 29/100 [00:04<00:09,  7.52it/s] 31%|███       | 31/100 [00:04<00:08,  8.46it/s] 32%|███▏      | 32/100 [00:04<00:07,  8.56it/s] 33%|███▎      | 33/100 [00:04<00:08,  8.22it/s] 35%|███▌      | 35/100 [00:04<00:07,  8.87it/s] 36%|███▌      | 36/100 [00:04<00:07,  9.00it/s] 38%|███▊      | 38/100 [00:05<00:06,  9.29it/s] 39%|███▉      | 39/100 [00:05<00:07,  8.09it/s] 40%|████      | 40/100 [00:05<00:07,  8.32it/s] 41%|████      | 41/100 [00:05<00:08,  6.77it/s] 42%|████▏     | 42/100 [00:05<00:08,  6.73it/s] 44%|████▍     | 44/100 [00:05<00:07,  7.93it/s] 45%|████▌     | 45/100 [00:06<00:06,  8.16it/s] 46%|████▌     | 46/100 [00:06<00:06,  8.30it/s] 47%|████▋     | 47/100 [00:06<00:06,  8.08it/s] 48%|████▊     | 48/100 [00:06<00:06,  8.13it/s] 49%|████▉     | 49/100 [00:06<00:06,  8.40it/s] 50%|█████     | 50/100 [00:06<00:05,  8.61it/s] 51%|█████     | 51/100 [00:06<00:06,  8.05it/s] 52%|█████▏    | 52/100 [00:06<00:05,  8.41it/s] 53%|█████▎    | 53/100 [00:07<00:05,  8.27it/s] 54%|█████▍    | 54/100 [00:07<00:05,  8.54it/s] 55%|█████▌    | 55/100 [00:07<00:06,  6.95it/s] 56%|█████▌    | 56/100 [00:07<00:05,  7.64it/s] 57%|█████▋    | 57/100 [00:07<00:05,  7.24it/s] 58%|█████▊    | 58/100 [00:07<00:05,  7.13it/s] 59%|█████▉    | 59/100 [00:07<00:05,  7.59it/s] 60%|██████    | 60/100 [00:07<00:04,  8.05it/s] 61%|██████    | 61/100 [00:08<00:04,  8.50it/s] 62%|██████▏   | 62/100 [00:08<00:04,  8.81it/s] 63%|██████▎   | 63/100 [00:08<00:05,  6.74it/s] 64%|██████▍   | 64/100 [00:08<00:04,  7.22it/s] 65%|██████▌   | 65/100 [00:08<00:04,  7.71it/s] 66%|██████▌   | 66/100 [00:08<00:04,  8.23it/s] 67%|██████▋   | 67/100 [00:08<00:04,  7.63it/s] 68%|██████▊   | 68/100 [00:09<00:04,  6.78it/s] 69%|██████▉   | 69/100 [00:09<00:04,  7.30it/s] 70%|███████   | 70/100 [00:09<00:04,  7.35it/s] 71%|███████   | 71/100 [00:09<00:04,  6.97it/s] 72%|███████▏  | 72/100 [00:09<00:03,  7.47it/s] 73%|███████▎  | 73/100 [00:09<00:03,  7.37it/s] 75%|███████▌  | 75/100 [00:09<00:02,  8.40it/s] 76%|███████▌  | 76/100 [00:10<00:02,  8.20it/s] 77%|███████▋  | 77/100 [00:10<00:02,  8.47it/s] 78%|███████▊  | 78/100 [00:10<00:03,  6.75it/s] 79%|███████▉  | 79/100 [00:10<00:02,  7.38it/s] 80%|████████  | 80/100 [00:10<00:02,  7.81it/s] 81%|████████  | 81/100 [00:10<00:02,  8.16it/s] 82%|████████▏ | 82/100 [00:10<00:02,  7.94it/s] 83%|████████▎ | 83/100 [00:11<00:02,  6.78it/s] 84%|████████▍ | 84/100 [00:11<00:02,  7.38it/s] 85%|████████▌ | 85/100 [00:11<00:02,  6.31it/s] 86%|████████▌ | 86/100 [00:11<00:02,  6.96it/s] 87%|████████▋ | 87/100 [00:11<00:01,  7.29it/s] 88%|████████▊ | 88/100 [00:11<00:01,  6.31it/s] 89%|████████▉ | 89/100 [00:12<00:02,  4.93it/s] 90%|█████████ | 90/100 [00:12<00:01,  5.76it/s] 91%|█████████ | 91/100 [00:12<00:01,  6.52it/s] 92%|█████████▏| 92/100 [00:12<00:01,  7.25it/s] 93%|█████████▎| 93/100 [00:12<00:00,  7.83it/s] 94%|█████████▍| 94/100 [00:12<00:00,  8.15it/s] 95%|█████████▌| 95/100 [00:12<00:00,  8.47it/s] 96%|█████████▌| 96/100 [00:12<00:00,  8.36it/s] 97%|█████████▋| 97/100 [00:13<00:00,  7.66it/s] 98%|█████████▊| 98/100 [00:13<00:00,  7.55it/s] 99%|█████████▉| 99/100 [00:13<00:00,  7.86it/s]100%|██████████| 100/100 [00:13<00:00,  7.84it/s]100%|██████████| 100/100 [00:13<00:00,  7.46it/s]
[I 2025-08-30 05:39:55,103] A new study created in memory with name: no-name-06d6d183-5871-4ee4-9a4c-3468940b5fae
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 26.13 MB
Memory Reserved: 46.00 MB
cuda
Epoch 1, Train Loss 0.637406, Valid_loss 0.604064
Epoch 2, Train Loss 0.587004, Valid_loss 0.485265
Epoch 3, Train Loss 0.441501, Valid_loss 0.349352
Epoch 4, Train Loss 0.341646, Valid_loss 0.295932
Epoch 5, Train Loss 0.293085, Valid_loss 0.395030
Epoch 6, Train Loss 0.280062, Valid_loss 0.329078
Epoch 7, Train Loss 0.255497, Valid_loss 0.330821
Epoch 8, Train Loss 0.236210, Valid_loss 0.307440
Epoch 9, Train Loss 0.217976, Valid_loss 0.307855
Epoch 10, Train Loss 0.207912, Valid_loss 0.268568
Epoch 11, Train Loss 0.194153, Valid_loss 0.242468
Epoch 12, Train Loss 0.195275, Valid_loss 0.284043
Epoch 13, Train Loss 0.189577, Valid_loss 0.327309
Epoch 14, Train Loss 0.181283, Valid_loss 0.225694
Epoch 15, Train Loss 0.181696, Valid_loss 0.294024
Epoch 16, Train Loss 0.173208, Valid_loss 0.237131
Epoch 17, Train Loss 0.169520, Valid_loss 0.288164
Epoch 18, Train Loss 0.166150, Valid_loss 0.237901
Epoch 19, Train Loss 0.167688, Valid_loss 0.309790
Epoch 20, Train Loss 0.168727, Valid_loss 0.284271
Epoch 21, Train Loss 0.167658, Valid_loss 0.269132
Epoch 22, Train Loss 0.163709, Valid_loss 0.260428
Epoch 23, Train Loss 0.163435, Valid_loss 0.281319
Epoch 24, Train Loss 0.160455, Valid_loss 0.300710
Epoch 25, Train Loss 0.154668, Valid_loss 0.246333
Epoch 26, Train Loss 0.156875, Valid_loss 0.268169
Epoch 27, Train Loss 0.155763, Valid_loss 0.352712
Epoch 28, Train Loss 0.170086, Valid_loss 0.254189
Epoch 29, Train Loss 0.163198, Valid_loss 0.315052
Epoch 30, Train Loss 0.161100, Valid_loss 0.302995
Epoch 31, Train Loss 0.161150, Valid_loss 0.425053
Epoch 32, Train Loss 0.164041, Valid_loss 0.307692
Epoch 33, Train Loss 0.170350, Valid_loss 0.290151
Epoch 34, Train Loss 0.179186, Valid_loss 0.245738
Epoch 35, Train Loss 0.174572, Valid_loss 0.318777
Epoch 36, Train Loss 0.161780, Valid_loss 0.248886
Epoch 37, Train Loss 0.155422, Valid_loss 0.264877
Epoch 38, Train Loss 0.149745, Valid_loss 0.259687
Epoch 39, Train Loss 0.152845, Valid_loss 0.284937
Epoch 40, Train Loss 0.150303, Valid_loss 0.251286
Epoch 41, Train Loss 0.150571, Valid_loss 0.263055
Epoch 42, Train Loss 0.149019, Valid_loss 0.289138
Epoch 43, Train Loss 0.151647, Valid_loss 0.250604
Epoch 44, Train Loss 0.149942, Valid_loss 0.244195
Epoch 45, Train Loss 0.149130, Valid_loss 0.238916
Epoch 46, Train Loss 0.151545, Valid_loss 0.265280
Epoch 47, Train Loss 0.151515, Valid_loss 0.280166
Epoch 48, Train Loss 0.150317, Valid_loss 0.276764
Epoch 49, Train Loss 0.146012, Valid_loss 0.268320
Epoch 50, Train Loss 0.146513, Valid_loss 0.269471
Epoch 51, Train Loss 0.145102, Valid_loss 0.275576
Epoch 52, Train Loss 0.148803, Valid_loss 0.277084
[I 2025-08-30 05:43:52,532] Trial 0 finished with value: 0.22569431803588355 and parameters: {'learning_rate': 0.001, 'epochs': 100, 'heads': 4, 'dropout': 0.0, 'weight_decay': 0.0001, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.22569431803588355.
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 27.97 MB
Memory Reserved: 46.00 MB
cuda
Epoch 1, Train Loss 0.599274, Valid_loss 0.516888
Epoch 2, Train Loss 0.442212, Valid_loss 0.317279
Epoch 3, Train Loss 0.312885, Valid_loss 0.274263
Epoch 4, Train Loss 0.264461, Valid_loss 0.318348
Epoch 5, Train Loss 0.256871, Valid_loss 0.273910
Epoch 6, Train Loss 0.220914, Valid_loss 0.236953
Epoch 7, Train Loss 0.209738, Valid_loss 0.247295
Epoch 8, Train Loss 0.198127, Valid_loss 0.239154
Epoch 9, Train Loss 0.194436, Valid_loss 0.284689
Epoch 10, Train Loss 0.187199, Valid_loss 0.255756
Epoch 11, Train Loss 0.175001, Valid_loss 0.230877
Epoch 12, Train Loss 0.175588, Valid_loss 0.231306
Epoch 13, Train Loss 0.163590, Valid_loss 0.243128
Epoch 14, Train Loss 0.164186, Valid_loss 0.231054
Epoch 15, Train Loss 0.161139, Valid_loss 0.252047
Epoch 16, Train Loss 0.158456, Valid_loss 0.241155
Epoch 17, Train Loss 0.159780, Valid_loss 0.306937
Epoch 18, Train Loss 0.158323, Valid_loss 0.250894
Epoch 19, Train Loss 0.156890, Valid_loss 0.285485
Epoch 20, Train Loss 0.158071, Valid_loss 0.261809
Epoch 21, Train Loss 0.165186, Valid_loss 0.414136
Epoch 22, Train Loss 0.170064, Valid_loss 0.255661
Epoch 23, Train Loss 0.162034, Valid_loss 0.261292
Epoch 24, Train Loss 0.153227, Valid_loss 0.325114
Epoch 25, Train Loss 0.158517, Valid_loss 0.392080
Epoch 26, Train Loss 0.151576, Valid_loss 0.228672
Epoch 27, Train Loss 0.155823, Valid_loss 0.270812
Epoch 28, Train Loss 0.150747, Valid_loss 0.280994
Epoch 29, Train Loss 0.152389, Valid_loss 0.275086
Epoch 30, Train Loss 0.148937, Valid_loss 0.273814
Epoch 31, Train Loss 0.150142, Valid_loss 0.251055
Epoch 32, Train Loss 0.157600, Valid_loss 0.314887
Epoch 33, Train Loss 0.159588, Valid_loss 0.342267
Epoch 34, Train Loss 0.169683, Valid_loss 0.251827
Epoch 35, Train Loss 0.164337, Valid_loss 0.473272
Epoch 36, Train Loss 0.164556, Valid_loss 0.245040
Epoch 37, Train Loss 0.154572, Valid_loss 0.271368
Epoch 38, Train Loss 0.152779, Valid_loss 0.298833
Epoch 39, Train Loss 0.146760, Valid_loss 0.318685
Epoch 40, Train Loss 0.149737, Valid_loss 0.290023
Epoch 41, Train Loss 0.147131, Valid_loss 0.316115
Epoch 42, Train Loss 0.149161, Valid_loss 0.297000
Epoch 43, Train Loss 0.147744, Valid_loss 0.319591
Epoch 44, Train Loss 0.144811, Valid_loss 0.404398
Epoch 45, Train Loss 0.149999, Valid_loss 0.306824
Epoch 46, Train Loss 0.147619, Valid_loss 0.297364
Epoch 47, Train Loss 0.148510, Valid_loss 0.317549
Epoch 48, Train Loss 0.143566, Valid_loss 0.296194
Epoch 49, Train Loss 0.144389, Valid_loss 0.372289
Epoch 50, Train Loss 0.146893, Valid_loss 0.292982
Epoch 51, Train Loss 0.144351, Valid_loss 0.302351
Epoch 52, Train Loss 0.143850, Valid_loss 0.337979
[I 2025-08-30 05:47:51,299] Trial 1 finished with value: 0.22867227442163443 and parameters: {'learning_rate': 0.001, 'epochs': 100, 'heads': 4, 'dropout': 0.0, 'weight_decay': 0.0001, 'emb_dim': 64, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.22569431803588355.
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 46.00 MB
cuda
Epoch 1, Train Loss 0.661625, Valid_loss 0.626721
Epoch 2, Train Loss 0.645193, Valid_loss 0.617741
Epoch 3, Train Loss 0.631845, Valid_loss 0.611494
Epoch 4, Train Loss 0.636559, Valid_loss 0.608412
Epoch 5, Train Loss 0.627860, Valid_loss 0.604858
Epoch 6, Train Loss 0.621195, Valid_loss 0.601757
Epoch 7, Train Loss 0.624248, Valid_loss 0.597938
Epoch 8, Train Loss 0.623464, Valid_loss 0.592626
Epoch 9, Train Loss 0.604860, Valid_loss 0.589357
Epoch 10, Train Loss 0.597203, Valid_loss 0.582871
Epoch 11, Train Loss 0.596961, Valid_loss 0.576481
Epoch 12, Train Loss 0.602672, Valid_loss 0.573023
Epoch 13, Train Loss 0.593103, Valid_loss 0.566216
Epoch 14, Train Loss 0.571116, Valid_loss 0.554608
Epoch 15, Train Loss 0.558131, Valid_loss 0.549093
Epoch 16, Train Loss 0.547415, Valid_loss 0.533956
Epoch 17, Train Loss 0.534398, Valid_loss 0.526497
Epoch 18, Train Loss 0.525553, Valid_loss 0.518412
Epoch 19, Train Loss 0.524033, Valid_loss 0.496626
Epoch 20, Train Loss 0.523444, Valid_loss 0.505394
Epoch 21, Train Loss 0.513340, Valid_loss 0.507345
Epoch 22, Train Loss 0.521890, Valid_loss 0.503684
Epoch 23, Train Loss 0.520189, Valid_loss 0.482042
Epoch 24, Train Loss 0.506086, Valid_loss 0.489670
Epoch 25, Train Loss 0.497639, Valid_loss 0.485856
Epoch 26, Train Loss 0.475220, Valid_loss 0.486531
Epoch 27, Train Loss 0.500492, Valid_loss 0.489282
Epoch 28, Train Loss 0.489680, Valid_loss 0.473621
Epoch 29, Train Loss 0.501235, Valid_loss 0.474585
Epoch 30, Train Loss 0.473289, Valid_loss 0.487516
Epoch 31, Train Loss 0.486037, Valid_loss 0.463081
Epoch 32, Train Loss 0.468016, Valid_loss 0.487976
Epoch 33, Train Loss 0.478503, Valid_loss 0.442577
Epoch 34, Train Loss 0.501094, Valid_loss 0.494364
Epoch 35, Train Loss 0.471302, Valid_loss 0.474881
Epoch 36, Train Loss 0.477277, Valid_loss 0.451013
Epoch 37, Train Loss 0.483224, Valid_loss 0.455390
Epoch 38, Train Loss 0.483883, Valid_loss 0.449717
Epoch 39, Train Loss 0.465796, Valid_loss 0.455403
Epoch 40, Train Loss 0.475838, Valid_loss 0.460395
Epoch 41, Train Loss 0.468528, Valid_loss 0.476475
Epoch 42, Train Loss 0.440495, Valid_loss 0.448176
Epoch 43, Train Loss 0.451030, Valid_loss 0.430543
Epoch 44, Train Loss 0.470590, Valid_loss 0.546052
Epoch 45, Train Loss 0.475609, Valid_loss 0.417164
Epoch 46, Train Loss 0.438491, Valid_loss 0.469225
Epoch 47, Train Loss 0.466793, Valid_loss 0.437131
Epoch 48, Train Loss 0.453173, Valid_loss 0.459739
Epoch 49, Train Loss 0.461244, Valid_loss 0.434466
Epoch 50, Train Loss 0.463631, Valid_loss 0.432399
Epoch 51, Train Loss 0.442176, Valid_loss 0.452854
Epoch 52, Train Loss 0.439651, Valid_loss 0.422166
Epoch 53, Train Loss 0.455178, Valid_loss 0.427675
Epoch 54, Train Loss 0.441491, Valid_loss 0.443297
[I 2025-08-30 05:51:33,573] Trial 2 finished with value: 0.41716438106128145 and parameters: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 2, 'dropout': 0.3, 'weight_decay': 0.01, 'emb_dim': 8, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.22569431803588355.
선택된 trial params: {'learning_rate': 0.001, 'epochs': 100, 'heads': 4, 'dropout': 0.0, 'weight_decay': 0.0001, 'emb_dim': 32, 'augment_num': 100, 'pca': False}
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=10, batch_size=1 -> steps=10
output_class :  1
Memory Allocated: 26.13 MB
Memory Reserved: 46.00 MB
cuda
Epoch 1, Train Loss 0.599991, Valid_loss 0.492763
Epoch 2, Train Loss 0.447274, Valid_loss 0.336517
Epoch 3, Train Loss 0.364715, Valid_loss 0.330220
Epoch 4, Train Loss 0.328395, Valid_loss 0.308501
Epoch 5, Train Loss 0.301179, Valid_loss 0.272024
Epoch 6, Train Loss 0.273414, Valid_loss 0.278464
Epoch 7, Train Loss 0.252125, Valid_loss 0.265407
Epoch 8, Train Loss 0.236625, Valid_loss 0.258093
Epoch 9, Train Loss 0.225129, Valid_loss 0.245317
Epoch 10, Train Loss 0.217164, Valid_loss 0.232181
Epoch 11, Train Loss 0.208287, Valid_loss 0.324860
Epoch 12, Train Loss 0.200442, Valid_loss 0.340421
Epoch 13, Train Loss 0.199640, Valid_loss 0.296580
Epoch 14, Train Loss 0.184694, Valid_loss 0.233023
Epoch 15, Train Loss 0.190313, Valid_loss 0.261327
Epoch 16, Train Loss 0.177888, Valid_loss 0.266838
Epoch 17, Train Loss 0.179274, Valid_loss 0.279831
Epoch 18, Train Loss 0.178627, Valid_loss 0.290430
Epoch 19, Train Loss 0.174726, Valid_loss 0.272150
Epoch 20, Train Loss 0.171673, Valid_loss 0.275820
Epoch 21, Train Loss 0.166647, Valid_loss 0.244939
Epoch 22, Train Loss 0.164406, Valid_loss 0.259546
Epoch 23, Train Loss 0.173980, Valid_loss 0.267222
Epoch 24, Train Loss 0.165239, Valid_loss 0.318921
Epoch 25, Train Loss 0.162582, Valid_loss 0.278669
Epoch 26, Train Loss 0.159132, Valid_loss 0.306910
Epoch 27, Train Loss 0.161718, Valid_loss 0.315243
Epoch 28, Train Loss 0.157057, Valid_loss 0.309664
Epoch 29, Train Loss 0.156943, Valid_loss 0.276460
Epoch 30, Train Loss 0.154648, Valid_loss 0.294084
Epoch 31, Train Loss 0.152282, Valid_loss 0.318381
Epoch 32, Train Loss 0.154869, Valid_loss 0.337452
Epoch 33, Train Loss 0.154738, Valid_loss 0.363623
Epoch 34, Train Loss 0.151940, Valid_loss 0.341279
Epoch 35, Train Loss 0.151532, Valid_loss 0.326652
Epoch 36, Train Loss 0.149897, Valid_loss 0.350043
Epoch 37, Train Loss 0.151001, Valid_loss 0.361214
Epoch 38, Train Loss 0.154723, Valid_loss 0.300666
Epoch 39, Train Loss 0.156341, Valid_loss 0.418777
Epoch 40, Train Loss 0.159631, Valid_loss 0.314841
Epoch 41, Train Loss 0.151924, Valid_loss 0.320688
Epoch 42, Train Loss 0.152399, Valid_loss 0.323478
Epoch 43, Train Loss 0.151820, Valid_loss 0.324671
Epoch 44, Train Loss 0.150781, Valid_loss 0.319943
Epoch 45, Train Loss 0.150873, Valid_loss 0.345158
Epoch 46, Train Loss 0.152869, Valid_loss 0.345565
Epoch 47, Train Loss 0.149650, Valid_loss 0.324147
Epoch 48, Train Loss 0.147858, Valid_loss 0.318901
Epoch 49, Train Loss 0.148985, Valid_loss 0.389818
Epoch 50, Train Loss 0.148451, Valid_loss 0.322688
Epoch 51, Train Loss 0.148601, Valid_loss 0.328854
Epoch 52, Train Loss 0.146872, Valid_loss 0.334796
환자ID=COVID19_Participant17 -- true: 1 -- pred: 1
환자ID=COVID19_Participant19 -- true: 1 -- pred: 1
환자ID=COVID19_Participant22 -- true: 1 -- pred: 1
환자ID=COVID19_Participant26 -- true: 1 -- pred: 1
환자ID=COVID19_Participant27 -- true: 1 -- pred: 1
환자ID=COVID19_Participant29 -- true: 1 -- pred: 1
환자ID=COVID19_Participant38 -- true: 1 -- pred: 1
환자ID=Control_Participant3 -- true: 0 -- pred: 0
환자ID=Control_Participant6 -- true: 0 -- pred: 0
환자ID=Control_Participant7 -- true: 0 -- pred: 0
Best performance: Epoch 10, Loss 0.217164, Test ACC 1.000000, Test AUC 1.000000, Test Recall 1.000000, Test Precision 1.000000
Confusion Matrix:
 [3 0 0 7]
✅ Total valid splits used: 2
🔁 Repeat 1, Fold 2
cell type :  GTCGGGGGGTGG_Control_Participant7     Developing Ciliated Cells
CAAATCAATTAT_Control_Participant7     Developing Ciliated Cells
ATACAATTGACA_Control_Participant7     Developing Ciliated Cells
CTGTTAATGAGA_Control_Participant7     Developing Ciliated Cells
CTTCACATTATT_Control_Participant7     Developing Ciliated Cells
                                                ...            
ACCATATTCAGG_COVID19_Participant21    Developing Ciliated Cells
GCCCGTTTCACG_COVID19_Participant21              Secretory Cells
TATTATCTCTTA_COVID19_Participant21    Developing Ciliated Cells
TTCCGTTTGTCC_COVID19_Participant21                 Goblet Cells
TCGGGATTGGAT_COVID19_Participant21               Ciliated Cells
Name: manual_annotation, Length: 23113, dtype: string
cell type annotation :  GTCGGGGGGTGG_Control_Participant7     Developing Ciliated Cells
CAAATCAATTAT_Control_Participant7     Developing Ciliated Cells
ATACAATTGACA_Control_Participant7     Developing Ciliated Cells
CTGTTAATGAGA_Control_Participant7     Developing Ciliated Cells
CTTCACATTATT_Control_Participant7     Developing Ciliated Cells
                                                ...            
ACCATATTCAGG_COVID19_Participant21    Developing Ciliated Cells
GCCCGTTTCACG_COVID19_Participant21              Secretory Cells
TATTATCTCTTA_COVID19_Participant21    Developing Ciliated Cells
TTCCGTTTGTCC_COVID19_Participant21                 Goblet Cells
TCGGGATTGGAT_COVID19_Participant21               Ciliated Cells
Name: manual_annotation, Length: 23113, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Developing Ciliated Cells', 'Ciliated Cells', 'Secretory Cells', 'Squamous Cells', 'Goblet Cells', 'T Cells', 'Dendritic Cells', 'Basal Cells', 'Deuterosomal Cells', 'Mitotic Basal Cells', 'Macrophages', 'B Cells', 'Ionocytes', 'Developing Secretory and Goblet Cells', 'Plasmacytoid DCs', 'Enteroendocrine Cells', 'Erythroblasts', 'Mast Cells']
라벨별 그룹 개수 {1: 28, 0: 12}
cell type :  CGAACGGACTCC_Control_Participant12                           Squamous Cells
GTGTCCTGGGGT_Control_Participant12    Developing Secretory and Goblet Cells
ATTTGCCTGTCG_Control_Participant12                             Goblet Cells
TCTCTAAAGTGT_Control_Participant12                           Ciliated Cells
TAGAGACAACGA_Control_Participant12    Developing Secretory and Goblet Cells
                                                      ...                  
GCAGGGAACTCC_COVID19_Participant30                           Squamous Cells
CAGCACCGAGCC_COVID19_Participant30                           Squamous Cells
GCCCCTTGTGAT_COVID19_Participant30                           Squamous Cells
GTGTTGTGTGTC_COVID19_Participant30                           Squamous Cells
TAACACTCACTT_COVID19_Participant30                           Squamous Cells
Name: manual_annotation, Length: 3834, dtype: string
cell type annotation :  CGAACGGACTCC_Control_Participant12                           Squamous Cells
GTGTCCTGGGGT_Control_Participant12    Developing Secretory and Goblet Cells
ATTTGCCTGTCG_Control_Participant12                             Goblet Cells
TCTCTAAAGTGT_Control_Participant12                           Ciliated Cells
TAGAGACAACGA_Control_Participant12    Developing Secretory and Goblet Cells
                                                      ...                  
GCAGGGAACTCC_COVID19_Participant30                           Squamous Cells
CAGCACCGAGCC_COVID19_Participant30                           Squamous Cells
GCCCCTTGTGAT_COVID19_Participant30                           Squamous Cells
GTGTTGTGTGTC_COVID19_Participant30                           Squamous Cells
TAACACTCACTT_COVID19_Participant30                           Squamous Cells
Name: manual_annotation, Length: 3834, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Squamous Cells', 'Developing Secretory and Goblet Cells', 'Goblet Cells', 'Ciliated Cells', 'Basal Cells', 'Developing Ciliated Cells', 'T Cells', 'Enteroendocrine Cells', 'Deuterosomal Cells', 'Secretory Cells', 'Mitotic Basal Cells', 'Ionocytes', 'Dendritic Cells', 'B Cells', 'Macrophages']
라벨별 그룹 개수 {1: 7, 0: 3}
🔍 Split #3
  → train_p_index 환자 수 (환자 단위로 묶인 index list): 40
  → test_p_index 환자 수  (환자 단위로 묶인 index list): 10
  → train 환자 ID: ['COVID19_Participant10', 'COVID19_Participant11', 'COVID19_Participant13', 'COVID19_Participant15', 'COVID19_Participant17', 'COVID19_Participant18', 'COVID19_Participant19', 'COVID19_Participant2', 'COVID19_Participant21', 'COVID19_Participant22', 'COVID19_Participant23', 'COVID19_Participant25', 'COVID19_Participant26', 'COVID19_Participant27', 'COVID19_Participant28', 'COVID19_Participant29', 'COVID19_Participant31', 'COVID19_Participant32', 'COVID19_Participant35', 'COVID19_Participant36', 'COVID19_Participant37', 'COVID19_Participant38', 'COVID19_Participant39', 'COVID19_Participant4', 'COVID19_Participant6', 'COVID19_Participant7', 'COVID19_Participant8', 'COVID19_Participant9', 'Control_Participant1', 'Control_Participant10', 'Control_Participant11', 'Control_Participant14', 'Control_Participant15', 'Control_Participant2', 'Control_Participant3', 'Control_Participant5', 'Control_Participant6', 'Control_Participant7', 'Control_Participant8', 'Control_Participant9']
  → test  환자 ID: ['COVID19_Participant12', 'COVID19_Participant14', 'COVID19_Participant20', 'COVID19_Participant3', 'COVID19_Participant30', 'COVID19_Participant40', 'COVID19_Participant5', 'Control_Participant12', 'Control_Participant13', 'Control_Participant4']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant10, Label: 1
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant18, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant21, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant27, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant35, Label: 1
    ID: COVID19_Participant36, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant38, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant6, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: COVID19_Participant9, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant10, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant14, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant2, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant6, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant8, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: COVID19_Participant12, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant3, Label: 1
    ID: COVID19_Participant30, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: COVID19_Participant5, Label: 1
    ID: Control_Participant12, Label: 0
    ID: Control_Participant13, Label: 0
    ID: Control_Participant4, Label: 0
전체 데이터 index 길이 50
label_stat (train 환자 라벨 목록) 갯수 40
train_data에서 환자 단위로, train과 validation 나누기
기존 train_p_index 40
기존 (train) label_stat 40
train-vali 분할 후! 
train y 의 classes : {0, 1} valid y 의 classes : {0, 1} label_stat 의 classes : {0, 1}
train_p_index_ 26
valid_p_index 14
test_p_index 10
→ train 환자 ID 및 라벨:
   총 개수: 26
   환자ID=Control_Participant10, Label=0, 셀개수=1645
   환자ID=Control_Participant2, Label=0, 셀개수=41
   환자ID=COVID19_Participant19, Label=1, 셀개수=816
   환자ID=COVID19_Participant38, Label=1, 셀개수=51
   환자ID=COVID19_Participant10, Label=1, 셀개수=18
   환자ID=Control_Participant6, Label=0, 셀개수=131
   환자ID=COVID19_Participant15, Label=1, 셀개수=1003
   환자ID=COVID19_Participant2, Label=1, 셀개수=329
   환자ID=COVID19_Participant4, Label=1, 셀개수=1680
   환자ID=COVID19_Participant13, Label=1, 셀개수=730
   환자ID=COVID19_Participant21, Label=1, 셀개수=39
   환자ID=Control_Participant3, Label=0, 셀개수=1620
   환자ID=COVID19_Participant27, Label=1, 셀개수=93
   환자ID=Control_Participant8, Label=0, 셀개수=393
   환자ID=Control_Participant7, Label=0, 셀개수=762
   환자ID=COVID19_Participant17, Label=1, 셀개수=843
   환자ID=Control_Participant9, Label=0, 셀개수=558
   환자ID=Control_Participant11, Label=0, 셀개수=1164
   환자ID=COVID19_Participant23, Label=1, 셀개수=307
   환자ID=COVID19_Participant31, Label=1, 셀개수=410
   환자ID=COVID19_Participant26, Label=1, 셀개수=814
   환자ID=COVID19_Participant18, Label=1, 셀개수=227
   환자ID=COVID19_Participant7, Label=1, 셀개수=409
   환자ID=COVID19_Participant39, Label=1, 셀개수=454
   환자ID=COVID19_Participant37, Label=1, 셀개수=668
   환자ID=COVID19_Participant29, Label=1, 셀개수=573
→ valid 환자 ID 및 라벨:
   총 개수: 14
   환자ID=Control_Participant15, Label=0, 셀개수=528
   환자ID=COVID19_Participant28, Label=1, 셀개수=1079
   환자ID=COVID19_Participant35, Label=1, 셀개수=83
   환자ID=COVID19_Participant32, Label=1, 셀개수=1665
   환자ID=COVID19_Participant6, Label=1, 셀개수=84
   환자ID=COVID19_Participant22, Label=1, 셀개수=865
   환자ID=Control_Participant5, Label=0, 셀개수=717
   환자ID=Control_Participant1, Label=0, 셀개수=414
   환자ID=COVID19_Participant9, Label=1, 셀개수=86
   환자ID=COVID19_Participant8, Label=1, 셀개수=462
   환자ID=Control_Participant14, Label=0, 셀개수=274
   환자ID=COVID19_Participant36, Label=1, 셀개수=200
   환자ID=COVID19_Participant11, Label=1, 셀개수=382
   환자ID=COVID19_Participant25, Label=1, 셀개수=496
→ test 환자 ID 및 라벨:
   총 개수: 10
   환자ID=COVID19_Participant12, Label=1, 셀개수=102
   환자ID=COVID19_Participant14, Label=1, 셀개수=382
   환자ID=COVID19_Participant20, Label=1, 셀개수=2033
   환자ID=COVID19_Participant3, Label=1, 셀개수=104
   환자ID=COVID19_Participant30, Label=1, 셀개수=116
   환자ID=COVID19_Participant40, Label=1, 셀개수=381
   환자ID=COVID19_Participant5, Label=1, 셀개수=89
   환자ID=Control_Participant12, Label=0, 셀개수=99
   환자ID=Control_Participant13, Label=0, 셀개수=88
   환자ID=Control_Participant4, Label=0, 셀개수=440
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Ciliated Cells', 'Developing Ciliated Cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
전체 데이터 길이 26947
전체 cell type 길이 0        Developing Ciliated Cells
1        Developing Ciliated Cells
2        Developing Ciliated Cells
3        Developing Ciliated Cells
4        Developing Ciliated Cells
                   ...            
26942               Squamous Cells
26943               Squamous Cells
26944               Squamous Cells
26945               Squamous Cells
26946               Squamous Cells
Length: 26947, dtype: string
cell type의 NaN 개수 체크 0
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:12,  8.24it/s]  3%|▎         | 3/100 [00:00<00:09,  9.82it/s]  5%|▌         | 5/100 [00:00<00:09, 10.40it/s]  7%|▋         | 7/100 [00:00<00:08, 10.66it/s]  9%|▉         | 9/100 [00:01<00:11,  7.82it/s] 10%|█         | 10/100 [00:01<00:11,  8.15it/s] 12%|█▏        | 12/100 [00:01<00:09,  9.12it/s] 13%|█▎        | 13/100 [00:01<00:09,  9.17it/s] 15%|█▌        | 15/100 [00:01<00:08,  9.50it/s] 16%|█▌        | 16/100 [00:01<00:08,  9.44it/s] 17%|█▋        | 17/100 [00:01<00:09,  9.13it/s] 18%|█▊        | 18/100 [00:01<00:09,  8.75it/s] 19%|█▉        | 19/100 [00:02<00:09,  8.98it/s] 21%|██        | 21/100 [00:02<00:08,  8.94it/s] 22%|██▏       | 22/100 [00:02<00:13,  5.62it/s] 23%|██▎       | 23/100 [00:02<00:14,  5.23it/s] 24%|██▍       | 24/100 [00:03<00:12,  5.90it/s] 25%|██▌       | 25/100 [00:03<00:12,  6.01it/s] 26%|██▌       | 26/100 [00:03<00:11,  6.68it/s] 28%|██▊       | 28/100 [00:03<00:09,  7.88it/s] 29%|██▉       | 29/100 [00:03<00:09,  7.84it/s] 30%|███       | 30/100 [00:03<00:08,  8.04it/s] 31%|███       | 31/100 [00:03<00:08,  8.46it/s] 32%|███▏      | 32/100 [00:04<00:08,  7.75it/s] 33%|███▎      | 33/100 [00:04<00:08,  8.11it/s] 34%|███▍      | 34/100 [00:04<00:12,  5.12it/s] 36%|███▌      | 36/100 [00:04<00:09,  6.59it/s] 38%|███▊      | 38/100 [00:04<00:07,  7.77it/s] 39%|███▉      | 39/100 [00:05<00:09,  6.38it/s] 40%|████      | 40/100 [00:05<00:09,  6.64it/s] 41%|████      | 41/100 [00:05<00:09,  6.39it/s] 42%|████▏     | 42/100 [00:05<00:08,  7.04it/s] 43%|████▎     | 43/100 [00:05<00:08,  6.52it/s] 44%|████▍     | 44/100 [00:05<00:09,  6.17it/s] 45%|████▌     | 45/100 [00:06<00:08,  6.86it/s] 47%|████▋     | 47/100 [00:06<00:06,  8.03it/s] 48%|████▊     | 48/100 [00:06<00:06,  8.09it/s] 49%|████▉     | 49/100 [00:06<00:06,  8.48it/s] 50%|█████     | 50/100 [00:06<00:05,  8.53it/s] 51%|█████     | 51/100 [00:06<00:05,  8.55it/s] 52%|█████▏    | 52/100 [00:06<00:05,  8.86it/s] 53%|█████▎    | 53/100 [00:07<00:08,  5.68it/s] 54%|█████▍    | 54/100 [00:07<00:07,  6.41it/s] 55%|█████▌    | 55/100 [00:07<00:08,  5.55it/s] 56%|█████▌    | 56/100 [00:07<00:07,  6.04it/s] 57%|█████▋    | 57/100 [00:07<00:06,  6.60it/s] 58%|█████▊    | 58/100 [00:07<00:05,  7.32it/s] 59%|█████▉    | 59/100 [00:08<00:07,  5.15it/s] 60%|██████    | 60/100 [00:08<00:08,  4.97it/s] 61%|██████    | 61/100 [00:08<00:06,  5.69it/s] 62%|██████▏   | 62/100 [00:08<00:06,  6.30it/s] 63%|██████▎   | 63/100 [00:08<00:05,  6.98it/s] 64%|██████▍   | 64/100 [00:08<00:05,  6.46it/s] 65%|██████▌   | 65/100 [00:08<00:04,  7.22it/s] 66%|██████▌   | 66/100 [00:09<00:04,  7.70it/s] 68%|██████▊   | 68/100 [00:09<00:03,  8.16it/s] 69%|██████▉   | 69/100 [00:09<00:03,  8.02it/s] 70%|███████   | 70/100 [00:09<00:03,  8.01it/s] 71%|███████   | 71/100 [00:09<00:03,  8.26it/s] 72%|███████▏  | 72/100 [00:09<00:03,  8.15it/s] 73%|███████▎  | 73/100 [00:09<00:03,  8.16it/s] 74%|███████▍  | 74/100 [00:10<00:03,  8.36it/s] 75%|███████▌  | 75/100 [00:10<00:02,  8.73it/s] 76%|███████▌  | 76/100 [00:10<00:02,  9.05it/s] 78%|███████▊  | 78/100 [00:10<00:02,  9.27it/s] 79%|███████▉  | 79/100 [00:10<00:02,  9.37it/s] 80%|████████  | 80/100 [00:10<00:02,  9.35it/s] 81%|████████  | 81/100 [00:10<00:02,  6.66it/s] 82%|████████▏ | 82/100 [00:11<00:02,  7.30it/s] 83%|████████▎ | 83/100 [00:11<00:02,  7.84it/s] 84%|████████▍ | 84/100 [00:11<00:02,  7.91it/s] 85%|████████▌ | 85/100 [00:11<00:02,  6.14it/s] 86%|████████▌ | 86/100 [00:11<00:02,  5.84it/s] 88%|████████▊ | 88/100 [00:11<00:01,  7.18it/s] 89%|████████▉ | 89/100 [00:12<00:01,  7.33it/s] 90%|█████████ | 90/100 [00:12<00:01,  5.29it/s] 91%|█████████ | 91/100 [00:12<00:01,  5.96it/s] 92%|█████████▏| 92/100 [00:12<00:01,  6.26it/s] 93%|█████████▎| 93/100 [00:12<00:01,  6.98it/s] 94%|█████████▍| 94/100 [00:12<00:01,  5.68it/s] 95%|█████████▌| 95/100 [00:13<00:00,  6.37it/s] 96%|█████████▌| 96/100 [00:13<00:00,  6.46it/s] 97%|█████████▋| 97/100 [00:13<00:00,  6.63it/s] 98%|█████████▊| 98/100 [00:13<00:00,  6.35it/s] 99%|█████████▉| 99/100 [00:13<00:00,  6.96it/s]100%|██████████| 100/100 [00:13<00:00,  7.27it/s]
[I 2025-08-30 05:55:47,980] A new study created in memory with name: no-name-5324af6e-af11-44bf-b6e7-df2ba2394d68
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 26.13 MB
Memory Reserved: 46.00 MB
cuda
Epoch 1, Train Loss 0.615766, Valid_loss 0.561098
Epoch 2, Train Loss 0.588065, Valid_loss 0.546245
Epoch 3, Train Loss 0.592628, Valid_loss 0.521276
Epoch 4, Train Loss 0.573106, Valid_loss 0.511712
Epoch 5, Train Loss 0.520365, Valid_loss 0.481919
Epoch 6, Train Loss 0.500416, Valid_loss 0.473457
Epoch 7, Train Loss 0.478982, Valid_loss 0.457484
Epoch 8, Train Loss 0.492610, Valid_loss 0.487007
Epoch 9, Train Loss 0.461322, Valid_loss 0.461826
Epoch 10, Train Loss 0.427766, Valid_loss 0.487688
Epoch 11, Train Loss 0.445771, Valid_loss 0.492186
Epoch 12, Train Loss 0.409049, Valid_loss 0.452631
Epoch 13, Train Loss 0.427692, Valid_loss 0.487865
Epoch 14, Train Loss 0.427520, Valid_loss 0.487866
Epoch 15, Train Loss 0.411923, Valid_loss 0.503940
Epoch 16, Train Loss 0.452149, Valid_loss 0.476958
Epoch 17, Train Loss 0.423194, Valid_loss 0.471243
Epoch 18, Train Loss 0.419462, Valid_loss 0.536493
Epoch 19, Train Loss 0.413852, Valid_loss 0.483726
Epoch 20, Train Loss 0.396038, Valid_loss 0.465661
Epoch 21, Train Loss 0.410832, Valid_loss 0.508057
Epoch 22, Train Loss 0.380453, Valid_loss 0.463558
Epoch 23, Train Loss 0.382560, Valid_loss 0.520699
Epoch 24, Train Loss 0.381656, Valid_loss 0.498787
Epoch 25, Train Loss 0.400901, Valid_loss 0.430605
Epoch 26, Train Loss 0.357142, Valid_loss 0.492383
Epoch 27, Train Loss 0.396360, Valid_loss 0.466180
Epoch 28, Train Loss 0.391872, Valid_loss 0.466529
Epoch 29, Train Loss 0.392045, Valid_loss 0.516386
Epoch 30, Train Loss 0.391541, Valid_loss 0.489781
Epoch 31, Train Loss 0.378997, Valid_loss 0.527089
Epoch 32, Train Loss 0.383235, Valid_loss 0.515021
Epoch 33, Train Loss 0.384793, Valid_loss 0.493268
Epoch 34, Train Loss 0.388898, Valid_loss 0.466416
Epoch 35, Train Loss 0.391625, Valid_loss 0.526644
Epoch 36, Train Loss 0.353518, Valid_loss 0.442998
Epoch 37, Train Loss 0.384238, Valid_loss 0.547902
Epoch 38, Train Loss 0.369938, Valid_loss 0.479575
Epoch 39, Train Loss 0.382661, Valid_loss 0.449186
Epoch 40, Train Loss 0.351857, Valid_loss 0.492557
Epoch 41, Train Loss 0.352207, Valid_loss 0.448242
Epoch 42, Train Loss 0.352364, Valid_loss 0.451327
Epoch 43, Train Loss 0.358038, Valid_loss 0.456922
Epoch 44, Train Loss 0.383113, Valid_loss 0.445643
Epoch 45, Train Loss 0.391544, Valid_loss 0.555181
Epoch 46, Train Loss 0.354727, Valid_loss 0.456109
Epoch 47, Train Loss 0.349070, Valid_loss 0.540604
Epoch 48, Train Loss 0.367006, Valid_loss 0.449672
Epoch 49, Train Loss 0.402587, Valid_loss 0.415243
Epoch 50, Train Loss 0.340687, Valid_loss 0.545137
Epoch 51, Train Loss 0.351705, Valid_loss 0.528448
Epoch 52, Train Loss 0.377623, Valid_loss 0.462293
Epoch 53, Train Loss 0.351244, Valid_loss 0.462014
Epoch 54, Train Loss 0.337816, Valid_loss 0.456590
Epoch 55, Train Loss 0.358352, Valid_loss 0.457877
Epoch 56, Train Loss 0.350929, Valid_loss 0.479100
[I 2025-08-30 05:59:22,276] Trial 0 finished with value: 0.41524270975164007 and parameters: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 1, 'dropout': 0.7, 'weight_decay': 0.001, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.41524270975164007.
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 27.97 MB
Memory Reserved: 46.00 MB
cuda
Epoch 1, Train Loss 0.681469, Valid_loss 0.601035
Epoch 2, Train Loss 0.655606, Valid_loss 0.597412
Epoch 3, Train Loss 0.685451, Valid_loss 0.603336
Epoch 4, Train Loss 0.658562, Valid_loss 0.604568
Epoch 5, Train Loss 0.602688, Valid_loss 0.599162
Epoch 6, Train Loss 0.647999, Valid_loss 0.604448
Epoch 7, Train Loss 0.621192, Valid_loss 0.600235
Epoch 8, Train Loss 0.652226, Valid_loss 0.609224
Epoch 9, Train Loss 0.612967, Valid_loss 0.597506
Epoch 10, Train Loss 0.620310, Valid_loss 0.594779
Epoch 11, Train Loss 0.612953, Valid_loss 0.530994
Epoch 12, Train Loss 0.553323, Valid_loss 0.500472
Epoch 13, Train Loss 0.591922, Valid_loss 0.652618
Epoch 14, Train Loss 0.631499, Valid_loss 0.624102
Epoch 15, Train Loss 0.661842, Valid_loss 0.608297
Epoch 16, Train Loss 0.634968, Valid_loss 0.604698
Epoch 17, Train Loss 0.622007, Valid_loss 0.607593
Epoch 18, Train Loss 0.628074, Valid_loss 0.603526
Epoch 19, Train Loss 0.611115, Valid_loss 0.602191
Epoch 20, Train Loss 0.626568, Valid_loss 0.603138
Epoch 21, Train Loss 0.611735, Valid_loss 0.605353
Epoch 22, Train Loss 0.617361, Valid_loss 0.601722
Epoch 23, Train Loss 0.639494, Valid_loss 0.598659
Epoch 24, Train Loss 0.620751, Valid_loss 0.604396
Epoch 25, Train Loss 0.621511, Valid_loss 0.599522
Epoch 26, Train Loss 0.614983, Valid_loss 0.600339
Epoch 27, Train Loss 0.631522, Valid_loss 0.601506
Epoch 28, Train Loss 0.621304, Valid_loss 0.606227
Epoch 29, Train Loss 0.620167, Valid_loss 0.602616
Epoch 30, Train Loss 0.616035, Valid_loss 0.601594
Epoch 31, Train Loss 0.617212, Valid_loss 0.601420
Epoch 32, Train Loss 0.615134, Valid_loss 0.599985
Epoch 33, Train Loss 0.616308, Valid_loss 0.600245
Epoch 34, Train Loss 0.614454, Valid_loss 0.600080
Epoch 35, Train Loss 0.620927, Valid_loss 0.600156
Epoch 36, Train Loss 0.618856, Valid_loss 0.600199
Epoch 37, Train Loss 0.619413, Valid_loss 0.600725
Epoch 38, Train Loss 0.619885, Valid_loss 0.602153
Epoch 39, Train Loss 0.617526, Valid_loss 0.601517
Epoch 40, Train Loss 0.615024, Valid_loss 0.601113
Epoch 41, Train Loss 0.615238, Valid_loss 0.599965
Epoch 42, Train Loss 0.616975, Valid_loss 0.600491
Epoch 43, Train Loss 0.616931, Valid_loss 0.600076
Epoch 44, Train Loss 0.614518, Valid_loss 0.601139
Epoch 45, Train Loss 0.620334, Valid_loss 0.600703
Epoch 46, Train Loss 0.619752, Valid_loss 0.600538
Epoch 47, Train Loss 0.621160, Valid_loss 0.600097
Epoch 48, Train Loss 0.617273, Valid_loss 0.600581
Epoch 49, Train Loss 0.619135, Valid_loss 0.600144
Epoch 50, Train Loss 0.619091, Valid_loss 0.600414
Epoch 51, Train Loss 0.613603, Valid_loss 0.600529
Epoch 52, Train Loss 0.616812, Valid_loss 0.600560
[I 2025-08-30 06:02:42,205] Trial 1 finished with value: 0.5004719176462719 and parameters: {'learning_rate': 0.01, 'epochs': 100, 'heads': 1, 'dropout': 0.7, 'weight_decay': 0.01, 'emb_dim': 64, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.41524270975164007.
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 26.13 MB
Memory Reserved: 46.00 MB
cuda
Epoch 1, Train Loss 0.652872, Valid_loss 0.607366
Epoch 2, Train Loss 0.633711, Valid_loss 0.599882
Epoch 3, Train Loss 0.631332, Valid_loss 0.600020
Epoch 4, Train Loss 0.617743, Valid_loss 0.598271
Epoch 5, Train Loss 0.629624, Valid_loss 0.600958
Epoch 6, Train Loss 0.619075, Valid_loss 0.598760
Epoch 7, Train Loss 0.621763, Valid_loss 0.598232
Epoch 8, Train Loss 0.619607, Valid_loss 0.604487
Epoch 9, Train Loss 0.620203, Valid_loss 0.598133
Epoch 10, Train Loss 0.621839, Valid_loss 0.599146
Epoch 11, Train Loss 0.616655, Valid_loss 0.601679
Epoch 12, Train Loss 0.617943, Valid_loss 0.600470
Epoch 13, Train Loss 0.622186, Valid_loss 0.598845
Epoch 14, Train Loss 0.620915, Valid_loss 0.602011
Epoch 15, Train Loss 0.618519, Valid_loss 0.602271
Epoch 16, Train Loss 0.617778, Valid_loss 0.599896
Epoch 17, Train Loss 0.622406, Valid_loss 0.598351
Epoch 18, Train Loss 0.622120, Valid_loss 0.600797
Epoch 19, Train Loss 0.620021, Valid_loss 0.601526
Epoch 20, Train Loss 0.619842, Valid_loss 0.582135
Epoch 21, Train Loss 0.582868, Valid_loss 0.519423
Epoch 22, Train Loss 0.630373, Valid_loss 0.601879
Epoch 23, Train Loss 0.617549, Valid_loss 0.602455
Epoch 24, Train Loss 0.620063, Valid_loss 0.600771
Epoch 25, Train Loss 0.616742, Valid_loss 0.685741
Epoch 26, Train Loss 0.505284, Valid_loss 0.349828
Epoch 27, Train Loss 0.411325, Valid_loss 0.446517
Epoch 28, Train Loss 0.345022, Valid_loss 0.371651
Epoch 29, Train Loss 0.257451, Valid_loss 0.336976
Epoch 30, Train Loss 0.250825, Valid_loss 0.395161
Epoch 31, Train Loss 0.231299, Valid_loss 0.318643
Epoch 32, Train Loss 0.231947, Valid_loss 0.483778
Epoch 33, Train Loss 0.267808, Valid_loss 0.513316
Epoch 34, Train Loss 0.250627, Valid_loss 0.252704
Epoch 35, Train Loss 0.222470, Valid_loss 0.219282
Epoch 36, Train Loss 0.211851, Valid_loss 0.264270
Epoch 37, Train Loss 0.211295, Valid_loss 0.277561
Epoch 38, Train Loss 0.210459, Valid_loss 0.311696
Epoch 39, Train Loss 0.202217, Valid_loss 0.352913
Epoch 40, Train Loss 0.204371, Valid_loss 0.349923
Epoch 41, Train Loss 0.189690, Valid_loss 0.350487
Epoch 42, Train Loss 0.187868, Valid_loss 0.338178
Epoch 43, Train Loss 0.189880, Valid_loss 0.268738
Epoch 44, Train Loss 0.185082, Valid_loss 0.266071
Epoch 45, Train Loss 0.177152, Valid_loss 0.269306
Epoch 46, Train Loss 0.172408, Valid_loss 0.318075
Epoch 47, Train Loss 0.177589, Valid_loss 0.272883
Epoch 48, Train Loss 0.179965, Valid_loss 0.291509
Epoch 49, Train Loss 0.180861, Valid_loss 0.290041
Epoch 50, Train Loss 0.177303, Valid_loss 0.283338
Epoch 51, Train Loss 0.171301, Valid_loss 0.240451
Epoch 52, Train Loss 0.166056, Valid_loss 0.248816
Epoch 53, Train Loss 0.167416, Valid_loss 0.245397
Epoch 54, Train Loss 0.168087, Valid_loss 0.220528
Epoch 55, Train Loss 0.164353, Valid_loss 0.251026
Epoch 56, Train Loss 0.170148, Valid_loss 0.228177
Epoch 57, Train Loss 0.166441, Valid_loss 0.204108
Epoch 58, Train Loss 0.171782, Valid_loss 0.225297
Epoch 59, Train Loss 0.168992, Valid_loss 0.209993
Epoch 60, Train Loss 0.168178, Valid_loss 0.208031
Epoch 61, Train Loss 0.166858, Valid_loss 0.212646
Epoch 62, Train Loss 0.165850, Valid_loss 0.199239
Epoch 63, Train Loss 0.169824, Valid_loss 0.221947
Epoch 64, Train Loss 0.168186, Valid_loss 0.196152
Epoch 65, Train Loss 0.164962, Valid_loss 0.211763
Epoch 66, Train Loss 0.164242, Valid_loss 0.206484
Epoch 67, Train Loss 0.169957, Valid_loss 0.224759
Epoch 68, Train Loss 0.170089, Valid_loss 0.219779
Epoch 69, Train Loss 0.165257, Valid_loss 0.226841
Epoch 70, Train Loss 0.165266, Valid_loss 0.234709
[I 2025-08-30 06:08:02,240] Trial 2 finished with value: 0.19615239366040832 and parameters: {'learning_rate': 0.01, 'epochs': 100, 'heads': 4, 'dropout': 0.0, 'weight_decay': 0.0001, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 2 with value: 0.19615239366040832.
선택된 trial params: {'learning_rate': 0.01, 'epochs': 100, 'heads': 4, 'dropout': 0.0, 'weight_decay': 0.0001, 'emb_dim': 32, 'augment_num': 100, 'pca': False}
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=10, batch_size=1 -> steps=10
output_class :  1
Memory Allocated: 26.13 MB
Memory Reserved: 46.00 MB
cuda
Epoch 1, Train Loss 0.680364, Valid_loss 0.621489
Epoch 2, Train Loss 0.631428, Valid_loss 0.610011
Epoch 3, Train Loss 0.574544, Valid_loss 0.715196
Epoch 4, Train Loss 0.416746, Valid_loss 0.543137
Epoch 5, Train Loss 0.298445, Valid_loss 0.583139
Epoch 6, Train Loss 0.244323, Valid_loss 0.739430
Epoch 7, Train Loss 0.268460, Valid_loss 0.634959
Epoch 8, Train Loss 0.222919, Valid_loss 0.751291
Epoch 9, Train Loss 0.214631, Valid_loss 0.800744
Epoch 10, Train Loss 0.221838, Valid_loss 0.524167
Epoch 11, Train Loss 0.201578, Valid_loss 0.519002
Epoch 12, Train Loss 0.190752, Valid_loss 0.569324
Epoch 13, Train Loss 0.180944, Valid_loss 0.633045
Epoch 14, Train Loss 0.175147, Valid_loss 0.650643
Epoch 15, Train Loss 0.187192, Valid_loss 0.545020
Epoch 16, Train Loss 0.214556, Valid_loss 0.457554
Epoch 17, Train Loss 0.216727, Valid_loss 0.476869
Epoch 18, Train Loss 0.207791, Valid_loss 0.529192
Epoch 19, Train Loss 0.197873, Valid_loss 0.533381
Epoch 20, Train Loss 0.178826, Valid_loss 0.615318
Epoch 21, Train Loss 0.176656, Valid_loss 0.492430
Epoch 22, Train Loss 0.172845, Valid_loss 0.524755
Epoch 23, Train Loss 0.170942, Valid_loss 0.399380
Epoch 24, Train Loss 0.172456, Valid_loss 0.388394
Epoch 25, Train Loss 0.173464, Valid_loss 0.529688
Epoch 26, Train Loss 0.171782, Valid_loss 0.426138
Epoch 27, Train Loss 0.181576, Valid_loss 0.434032
Epoch 28, Train Loss 0.188430, Valid_loss 0.415348
Epoch 29, Train Loss 0.177393, Valid_loss 0.392958
Epoch 30, Train Loss 0.191813, Valid_loss 0.521459
Epoch 31, Train Loss 0.177587, Valid_loss 0.694114
Epoch 32, Train Loss 0.202509, Valid_loss 0.767560
Epoch 33, Train Loss 0.191661, Valid_loss 0.548158
Epoch 34, Train Loss 0.171533, Valid_loss 0.368001
Epoch 35, Train Loss 0.169459, Valid_loss 0.329360
Epoch 36, Train Loss 0.174500, Valid_loss 0.356342
Epoch 37, Train Loss 0.169735, Valid_loss 0.365068
Epoch 38, Train Loss 0.171474, Valid_loss 0.344482
Epoch 39, Train Loss 0.166120, Valid_loss 0.328557
Epoch 40, Train Loss 0.164765, Valid_loss 0.365411
Epoch 41, Train Loss 0.170352, Valid_loss 0.398851
Epoch 42, Train Loss 0.167636, Valid_loss 0.517938
Epoch 43, Train Loss 0.187761, Valid_loss 0.393037
Epoch 44, Train Loss 0.169826, Valid_loss 0.480327
Epoch 45, Train Loss 0.168441, Valid_loss 0.338044
Epoch 46, Train Loss 0.170649, Valid_loss 0.339604
Epoch 47, Train Loss 0.168708, Valid_loss 0.571050
Epoch 48, Train Loss 0.182073, Valid_loss 0.474125
Epoch 49, Train Loss 0.169195, Valid_loss 0.380577
Epoch 50, Train Loss 0.160912, Valid_loss 0.370443
Epoch 51, Train Loss 0.161192, Valid_loss 0.390124
Epoch 52, Train Loss 0.156846, Valid_loss 0.413399
환자ID=COVID19_Participant12 -- true: 1 -- pred: 1
환자ID=COVID19_Participant14 -- true: 1 -- pred: 1
환자ID=COVID19_Participant20 -- true: 1 -- pred: 1
환자ID=COVID19_Participant3 -- true: 1 -- pred: 1
환자ID=COVID19_Participant30 -- true: 1 -- pred: 1
환자ID=COVID19_Participant40 -- true: 1 -- pred: 1
환자ID=COVID19_Participant5 -- true: 1 -- pred: 0
환자ID=Control_Participant12 -- true: 0 -- pred: 0
환자ID=Control_Participant13 -- true: 0 -- pred: 1
환자ID=Control_Participant4 -- true: 0 -- pred: 0
Best performance: Epoch 39, Loss 0.166120, Test ACC 0.800000, Test AUC 0.952381, Test Recall 0.857143, Test Precision 0.857143
Confusion Matrix:
 [2 1 1 6]
✅ Total valid splits used: 3
🔁 Repeat 1, Fold 3
cell type :  GTCGGGGGGTGG_Control_Participant7     Developing Ciliated Cells
CAAATCAATTAT_Control_Participant7     Developing Ciliated Cells
ATACAATTGACA_Control_Participant7     Developing Ciliated Cells
CTGTTAATGAGA_Control_Participant7     Developing Ciliated Cells
CTTCACATTATT_Control_Participant7     Developing Ciliated Cells
                                                ...            
GCAGGGAACTCC_COVID19_Participant30               Squamous Cells
CAGCACCGAGCC_COVID19_Participant30               Squamous Cells
GCCCCTTGTGAT_COVID19_Participant30               Squamous Cells
GTGTTGTGTGTC_COVID19_Participant30               Squamous Cells
TAACACTCACTT_COVID19_Participant30               Squamous Cells
Name: manual_annotation, Length: 21089, dtype: string
cell type annotation :  GTCGGGGGGTGG_Control_Participant7     Developing Ciliated Cells
CAAATCAATTAT_Control_Participant7     Developing Ciliated Cells
ATACAATTGACA_Control_Participant7     Developing Ciliated Cells
CTGTTAATGAGA_Control_Participant7     Developing Ciliated Cells
CTTCACATTATT_Control_Participant7     Developing Ciliated Cells
                                                ...            
GCAGGGAACTCC_COVID19_Participant30               Squamous Cells
CAGCACCGAGCC_COVID19_Participant30               Squamous Cells
GCCCCTTGTGAT_COVID19_Participant30               Squamous Cells
GTGTTGTGTGTC_COVID19_Participant30               Squamous Cells
TAACACTCACTT_COVID19_Participant30               Squamous Cells
Name: manual_annotation, Length: 21089, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Developing Ciliated Cells', 'Ciliated Cells', 'Secretory Cells', 'Squamous Cells', 'Goblet Cells', 'T Cells', 'Dendritic Cells', 'Basal Cells', 'Deuterosomal Cells', 'Mitotic Basal Cells', 'Developing Secretory and Goblet Cells', 'Enteroendocrine Cells', 'Ionocytes', 'Macrophages', 'B Cells', 'Erythroblasts', 'Mast Cells', 'Plasmacytoid DCs']
라벨별 그룹 개수 {1: 28, 0: 12}
cell type :  CATTAAGGATAT_COVID19_Participant13    Developing Ciliated Cells
GTAGAAGGGGGG_COVID19_Participant13    Developing Ciliated Cells
ATTAAGAGGTAG_COVID19_Participant13    Developing Ciliated Cells
AGATATGACAAG_COVID19_Participant13    Developing Ciliated Cells
CTTGTAACAAAT_COVID19_Participant13               Squamous Cells
                                                ...            
CGCGCCCTAGAC_Control_Participant15                 Goblet Cells
CGGACAGAATGG_Control_Participant15               Ciliated Cells
GTTTATTCATCA_Control_Participant15               Ciliated Cells
TTTTTGTACTAT_Control_Participant15               Ciliated Cells
CGATTGTAGATC_Control_Participant15               Ciliated Cells
Name: manual_annotation, Length: 5858, dtype: string
cell type annotation :  CATTAAGGATAT_COVID19_Participant13    Developing Ciliated Cells
GTAGAAGGGGGG_COVID19_Participant13    Developing Ciliated Cells
ATTAAGAGGTAG_COVID19_Participant13    Developing Ciliated Cells
AGATATGACAAG_COVID19_Participant13    Developing Ciliated Cells
CTTGTAACAAAT_COVID19_Participant13               Squamous Cells
                                                ...            
CGCGCCCTAGAC_Control_Participant15                 Goblet Cells
CGGACAGAATGG_Control_Participant15               Ciliated Cells
GTTTATTCATCA_Control_Participant15               Ciliated Cells
TTTTTGTACTAT_Control_Participant15               Ciliated Cells
CGATTGTAGATC_Control_Participant15               Ciliated Cells
Name: manual_annotation, Length: 5858, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Developing Ciliated Cells', 'Squamous Cells', 'Secretory Cells', 'Macrophages', 'B Cells', 'Ciliated Cells', 'T Cells', 'Dendritic Cells', 'Goblet Cells', 'Deuterosomal Cells', 'Basal Cells', 'Ionocytes', 'Mitotic Basal Cells', 'Developing Secretory and Goblet Cells', 'Plasmacytoid DCs', 'Enteroendocrine Cells', 'Erythroblasts']
라벨별 그룹 개수 {1: 7, 0: 3}
🔍 Split #4
  → train_p_index 환자 수 (환자 단위로 묶인 index list): 40
  → test_p_index 환자 수  (환자 단위로 묶인 index list): 10
  → train 환자 ID: ['COVID19_Participant10', 'COVID19_Participant11', 'COVID19_Participant12', 'COVID19_Participant14', 'COVID19_Participant15', 'COVID19_Participant17', 'COVID19_Participant18', 'COVID19_Participant19', 'COVID19_Participant2', 'COVID19_Participant20', 'COVID19_Participant21', 'COVID19_Participant22', 'COVID19_Participant23', 'COVID19_Participant25', 'COVID19_Participant26', 'COVID19_Participant27', 'COVID19_Participant29', 'COVID19_Participant3', 'COVID19_Participant30', 'COVID19_Participant32', 'COVID19_Participant35', 'COVID19_Participant36', 'COVID19_Participant37', 'COVID19_Participant38', 'COVID19_Participant40', 'COVID19_Participant5', 'COVID19_Participant7', 'COVID19_Participant8', 'Control_Participant10', 'Control_Participant11', 'Control_Participant12', 'Control_Participant13', 'Control_Participant14', 'Control_Participant2', 'Control_Participant3', 'Control_Participant4', 'Control_Participant5', 'Control_Participant6', 'Control_Participant7', 'Control_Participant9']
  → test  환자 ID: ['COVID19_Participant13', 'COVID19_Participant28', 'COVID19_Participant31', 'COVID19_Participant39', 'COVID19_Participant4', 'COVID19_Participant6', 'COVID19_Participant9', 'Control_Participant1', 'Control_Participant15', 'Control_Participant8']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant10, Label: 1
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant12, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant18, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant21, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant27, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant3, Label: 1
    ID: COVID19_Participant30, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant35, Label: 1
    ID: COVID19_Participant36, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant38, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: COVID19_Participant5, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: Control_Participant10, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant12, Label: 0
    ID: Control_Participant13, Label: 0
    ID: Control_Participant14, Label: 0
    ID: Control_Participant2, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant4, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant6, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant6, Label: 1
    ID: COVID19_Participant9, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant8, Label: 0
전체 데이터 index 길이 50
label_stat (train 환자 라벨 목록) 갯수 40
train_data에서 환자 단위로, train과 validation 나누기
기존 train_p_index 40
기존 (train) label_stat 40
train-vali 분할 후! 
train y 의 classes : {0, 1} valid y 의 classes : {0, 1} label_stat 의 classes : {0, 1}
train_p_index_ 26
valid_p_index 14
test_p_index 10
→ train 환자 ID 및 라벨:
   총 개수: 26
   환자ID=Control_Participant11, Label=0, 셀개수=1164
   환자ID=Control_Participant2, Label=0, 셀개수=41
   환자ID=COVID19_Participant18, Label=1, 셀개수=227
   환자ID=COVID19_Participant36, Label=1, 셀개수=200
   환자ID=COVID19_Participant10, Label=1, 셀개수=18
   환자ID=Control_Participant5, Label=0, 셀개수=717
   환자ID=COVID19_Participant14, Label=1, 셀개수=382
   환자ID=COVID19_Participant19, Label=1, 셀개수=816
   환자ID=COVID19_Participant38, Label=1, 셀개수=51
   환자ID=COVID19_Participant12, Label=1, 셀개수=102
   환자ID=COVID19_Participant2, Label=1, 셀개수=329
   환자ID=Control_Participant3, Label=0, 셀개수=1620
   환자ID=COVID19_Participant25, Label=1, 셀개수=496
   환자ID=Control_Participant7, Label=0, 셀개수=762
   환자ID=Control_Participant6, Label=0, 셀개수=131
   환자ID=COVID19_Participant15, Label=1, 셀개수=1003
   환자ID=Control_Participant9, Label=0, 셀개수=558
   환자ID=Control_Participant12, Label=0, 셀개수=99
   환자ID=COVID19_Participant21, Label=1, 셀개수=39
   환자ID=COVID19_Participant29, Label=1, 셀개수=573
   환자ID=COVID19_Participant23, Label=1, 셀개수=307
   환자ID=COVID19_Participant17, Label=1, 셀개수=843
   환자ID=COVID19_Participant5, Label=1, 셀개수=89
   환자ID=COVID19_Participant37, Label=1, 셀개수=668
   환자ID=COVID19_Participant35, Label=1, 셀개수=83
   환자ID=COVID19_Participant27, Label=1, 셀개수=93
→ valid 환자 ID 및 라벨:
   총 개수: 14
   환자ID=Control_Participant14, Label=0, 셀개수=274
   환자ID=COVID19_Participant26, Label=1, 셀개수=814
   환자ID=COVID19_Participant30, Label=1, 셀개수=116
   환자ID=COVID19_Participant3, Label=1, 셀개수=104
   환자ID=COVID19_Participant40, Label=1, 셀개수=381
   환자ID=COVID19_Participant20, Label=1, 셀개수=2033
   환자ID=Control_Participant4, Label=0, 셀개수=440
   환자ID=Control_Participant10, Label=0, 셀개수=1645
   환자ID=COVID19_Participant8, Label=1, 셀개수=462
   환자ID=COVID19_Participant7, Label=1, 셀개수=409
   환자ID=Control_Participant13, Label=0, 셀개수=88
   환자ID=COVID19_Participant32, Label=1, 셀개수=1665
   환자ID=COVID19_Participant11, Label=1, 셀개수=382
   환자ID=COVID19_Participant22, Label=1, 셀개수=865
→ test 환자 ID 및 라벨:
   총 개수: 10
   환자ID=COVID19_Participant13, Label=1, 셀개수=730
   환자ID=COVID19_Participant28, Label=1, 셀개수=1079
   환자ID=COVID19_Participant31, Label=1, 셀개수=410
   환자ID=COVID19_Participant39, Label=1, 셀개수=454
   환자ID=COVID19_Participant4, Label=1, 셀개수=1680
   환자ID=COVID19_Participant6, Label=1, 셀개수=84
   환자ID=COVID19_Participant9, Label=1, 셀개수=86
   환자ID=Control_Participant1, Label=0, 셀개수=414
   환자ID=Control_Participant15, Label=0, 셀개수=528
   환자ID=Control_Participant8, Label=0, 셀개수=393
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Ciliated Cells', 'Developing Ciliated Cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
전체 데이터 길이 26947
전체 cell type 길이 0        Developing Ciliated Cells
1        Developing Ciliated Cells
2        Developing Ciliated Cells
3        Developing Ciliated Cells
4        Developing Ciliated Cells
                   ...            
26942                 Goblet Cells
26943               Ciliated Cells
26944               Ciliated Cells
26945               Ciliated Cells
26946               Ciliated Cells
Length: 26947, dtype: string
cell type의 NaN 개수 체크 0
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:17,  5.79it/s]  2%|▏         | 2/100 [00:00<00:17,  5.62it/s]  3%|▎         | 3/100 [00:00<00:14,  6.65it/s]  5%|▌         | 5/100 [00:00<00:20,  4.69it/s]  6%|▌         | 6/100 [00:01<00:18,  5.16it/s]  8%|▊         | 8/100 [00:01<00:13,  6.68it/s]  9%|▉         | 9/100 [00:01<00:15,  5.75it/s] 10%|█         | 10/100 [00:01<00:13,  6.44it/s] 11%|█         | 11/100 [00:01<00:12,  7.07it/s] 12%|█▏        | 12/100 [00:01<00:12,  6.78it/s] 13%|█▎        | 13/100 [00:02<00:11,  7.43it/s] 14%|█▍        | 14/100 [00:02<00:10,  7.98it/s] 15%|█▌        | 15/100 [00:02<00:10,  8.40it/s] 16%|█▌        | 16/100 [00:02<00:17,  4.71it/s] 17%|█▋        | 17/100 [00:02<00:15,  5.20it/s] 18%|█▊        | 18/100 [00:02<00:13,  5.99it/s] 19%|█▉        | 19/100 [00:03<00:12,  6.51it/s] 20%|██        | 20/100 [00:03<00:11,  7.00it/s] 22%|██▏       | 22/100 [00:03<00:09,  8.26it/s] 24%|██▍       | 24/100 [00:03<00:08,  8.92it/s] 25%|██▌       | 25/100 [00:03<00:08,  8.73it/s] 27%|██▋       | 27/100 [00:04<00:09,  7.76it/s] 28%|██▊       | 28/100 [00:04<00:08,  8.01it/s] 29%|██▉       | 29/100 [00:04<00:10,  6.87it/s] 30%|███       | 30/100 [00:04<00:10,  6.64it/s] 31%|███       | 31/100 [00:04<00:09,  7.05it/s] 32%|███▏      | 32/100 [00:04<00:09,  7.36it/s] 33%|███▎      | 33/100 [00:04<00:08,  7.78it/s] 34%|███▍      | 34/100 [00:04<00:08,  8.06it/s] 35%|███▌      | 35/100 [00:05<00:08,  8.08it/s] 36%|███▌      | 36/100 [00:05<00:07,  8.33it/s] 37%|███▋      | 37/100 [00:05<00:07,  8.67it/s] 38%|███▊      | 38/100 [00:05<00:07,  8.75it/s] 39%|███▉      | 39/100 [00:05<00:06,  8.93it/s] 40%|████      | 40/100 [00:05<00:06,  8.93it/s] 41%|████      | 41/100 [00:05<00:06,  9.11it/s] 42%|████▏     | 42/100 [00:05<00:06,  8.89it/s] 43%|████▎     | 43/100 [00:05<00:06,  8.99it/s] 44%|████▍     | 44/100 [00:06<00:06,  9.00it/s] 45%|████▌     | 45/100 [00:06<00:06,  8.65it/s] 46%|████▌     | 46/100 [00:06<00:06,  8.88it/s] 47%|████▋     | 47/100 [00:06<00:05,  9.09it/s] 48%|████▊     | 48/100 [00:06<00:07,  7.03it/s] 49%|████▉     | 49/100 [00:06<00:06,  7.57it/s] 51%|█████     | 51/100 [00:06<00:05,  8.32it/s] 52%|█████▏    | 52/100 [00:07<00:06,  7.46it/s] 53%|█████▎    | 53/100 [00:07<00:06,  7.81it/s] 54%|█████▍    | 54/100 [00:07<00:07,  6.55it/s] 55%|█████▌    | 55/100 [00:07<00:06,  7.09it/s] 56%|█████▌    | 56/100 [00:07<00:05,  7.52it/s] 57%|█████▋    | 57/100 [00:07<00:07,  6.05it/s] 58%|█████▊    | 58/100 [00:08<00:06,  6.81it/s] 60%|██████    | 60/100 [00:08<00:04,  8.02it/s] 61%|██████    | 61/100 [00:08<00:04,  8.10it/s] 62%|██████▏   | 62/100 [00:08<00:04,  8.34it/s] 63%|██████▎   | 63/100 [00:08<00:05,  7.37it/s] 64%|██████▍   | 64/100 [00:08<00:04,  7.90it/s] 65%|██████▌   | 65/100 [00:08<00:04,  8.14it/s] 66%|██████▌   | 66/100 [00:08<00:04,  8.33it/s] 67%|██████▋   | 67/100 [00:09<00:03,  8.41it/s] 68%|██████▊   | 68/100 [00:09<00:03,  8.57it/s] 69%|██████▉   | 69/100 [00:09<00:03,  8.90it/s] 70%|███████   | 70/100 [00:09<00:03,  8.55it/s] 71%|███████   | 71/100 [00:09<00:03,  8.79it/s] 72%|███████▏  | 72/100 [00:09<00:03,  8.70it/s] 73%|███████▎  | 73/100 [00:09<00:03,  8.86it/s] 74%|███████▍  | 74/100 [00:09<00:02,  8.84it/s] 75%|███████▌  | 75/100 [00:09<00:02,  8.98it/s] 76%|███████▌  | 76/100 [00:10<00:04,  5.98it/s] 77%|███████▋  | 77/100 [00:10<00:03,  6.15it/s] 78%|███████▊  | 78/100 [00:10<00:04,  5.21it/s] 79%|███████▉  | 79/100 [00:10<00:03,  5.95it/s] 80%|████████  | 80/100 [00:10<00:03,  6.59it/s] 81%|████████  | 81/100 [00:11<00:02,  7.13it/s] 82%|████████▏ | 82/100 [00:11<00:02,  7.75it/s] 83%|████████▎ | 83/100 [00:11<00:02,  7.46it/s] 84%|████████▍ | 84/100 [00:11<00:02,  7.86it/s] 85%|████████▌ | 85/100 [00:11<00:01,  7.64it/s] 86%|████████▌ | 86/100 [00:11<00:01,  8.20it/s] 88%|████████▊ | 88/100 [00:11<00:01,  8.76it/s] 89%|████████▉ | 89/100 [00:11<00:01,  8.76it/s] 90%|█████████ | 90/100 [00:12<00:01,  8.84it/s] 91%|█████████ | 91/100 [00:12<00:01,  7.43it/s] 92%|█████████▏| 92/100 [00:12<00:01,  7.76it/s] 93%|█████████▎| 93/100 [00:12<00:00,  8.08it/s] 94%|█████████▍| 94/100 [00:12<00:00,  8.11it/s] 95%|█████████▌| 95/100 [00:12<00:00,  8.07it/s] 96%|█████████▌| 96/100 [00:12<00:00,  8.37it/s] 97%|█████████▋| 97/100 [00:12<00:00,  8.40it/s] 98%|█████████▊| 98/100 [00:13<00:00,  8.52it/s] 99%|█████████▉| 99/100 [00:13<00:00,  8.55it/s]100%|██████████| 100/100 [00:13<00:00,  8.62it/s]100%|██████████| 100/100 [00:13<00:00,  7.53it/s]
[I 2025-08-30 06:12:14,950] A new study created in memory with name: no-name-ee0a84fe-a93b-4003-be22-1cc1ff64e9f9
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 27.97 MB
Memory Reserved: 46.00 MB
cuda
Epoch 1, Train Loss 0.680414, Valid_loss 0.599756
Epoch 2, Train Loss 0.706919, Valid_loss 0.598652
Epoch 3, Train Loss 0.654293, Valid_loss 0.632402
Epoch 4, Train Loss 0.639304, Valid_loss 0.598576
Epoch 5, Train Loss 0.648389, Valid_loss 0.599579
Epoch 6, Train Loss 0.645693, Valid_loss 0.601261
Epoch 7, Train Loss 0.657436, Valid_loss 0.611001
Epoch 8, Train Loss 0.633259, Valid_loss 0.603001
Epoch 9, Train Loss 0.633600, Valid_loss 0.607989
Epoch 10, Train Loss 0.635831, Valid_loss 0.604048
Epoch 11, Train Loss 0.618318, Valid_loss 0.598636
Epoch 12, Train Loss 0.641250, Valid_loss 0.597464
Epoch 13, Train Loss 0.619228, Valid_loss 0.607109
Epoch 14, Train Loss 0.628042, Valid_loss 0.581656
Epoch 15, Train Loss 0.588100, Valid_loss 0.644888
Epoch 16, Train Loss 0.573900, Valid_loss 0.515503
Epoch 17, Train Loss 0.613802, Valid_loss 0.522023
Epoch 18, Train Loss 0.567306, Valid_loss 0.668137
Epoch 19, Train Loss 0.578988, Valid_loss 0.697875
Epoch 20, Train Loss 0.443664, Valid_loss 0.778141
Epoch 21, Train Loss 0.407412, Valid_loss 0.869712
Epoch 22, Train Loss 0.531197, Valid_loss 0.826040
Epoch 23, Train Loss 0.517702, Valid_loss 0.709722
Epoch 24, Train Loss 0.532145, Valid_loss 0.742596
Epoch 25, Train Loss 0.368244, Valid_loss 0.843313
Epoch 26, Train Loss 0.432206, Valid_loss 0.898937
Epoch 27, Train Loss 0.424250, Valid_loss 0.927324
Epoch 28, Train Loss 0.431388, Valid_loss 0.866725
Epoch 29, Train Loss 0.404403, Valid_loss 0.841999
Epoch 30, Train Loss 0.424139, Valid_loss 0.867240
Epoch 31, Train Loss 0.397506, Valid_loss 0.892976
Epoch 32, Train Loss 0.391152, Valid_loss 0.852398
Epoch 33, Train Loss 0.504814, Valid_loss 0.755707
Epoch 34, Train Loss 0.398970, Valid_loss 1.058422
Epoch 35, Train Loss 0.428547, Valid_loss 1.093809
Epoch 36, Train Loss 0.442817, Valid_loss 1.064895
Epoch 37, Train Loss 0.412938, Valid_loss 1.085574
Epoch 38, Train Loss 0.350281, Valid_loss 1.034355
Epoch 39, Train Loss 0.418780, Valid_loss 0.658619
Epoch 40, Train Loss 0.341561, Valid_loss 0.568242
Epoch 41, Train Loss 0.367748, Valid_loss 0.720207
Epoch 42, Train Loss 0.344752, Valid_loss 0.661695
Epoch 43, Train Loss 0.396928, Valid_loss 1.175279
Epoch 44, Train Loss 0.336743, Valid_loss 1.006673
Epoch 45, Train Loss 0.376221, Valid_loss 0.990998
Epoch 46, Train Loss 0.351546, Valid_loss 0.929525
Epoch 47, Train Loss 0.366973, Valid_loss 0.637323
Epoch 48, Train Loss 0.357164, Valid_loss 0.642292
Epoch 49, Train Loss 0.296487, Valid_loss 0.628052
Epoch 50, Train Loss 0.336329, Valid_loss 0.854184
Epoch 51, Train Loss 0.275677, Valid_loss 0.816079
Epoch 52, Train Loss 0.350980, Valid_loss 0.950858
Epoch 53, Train Loss 0.323886, Valid_loss 1.474560
[I 2025-08-30 06:16:28,070] Trial 0 finished with value: 0.5155032340969358 and parameters: {'learning_rate': 0.01, 'epochs': 100, 'heads': 4, 'dropout': 0.7, 'weight_decay': 0.001, 'emb_dim': 64, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.5155032340969358.
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 46.00 MB
cuda
Epoch 1, Train Loss 0.670491, Valid_loss 0.566938
Epoch 2, Train Loss 0.617345, Valid_loss 0.525127
Epoch 3, Train Loss 0.570488, Valid_loss 0.470881
Epoch 4, Train Loss 0.514292, Valid_loss 0.427254
Epoch 5, Train Loss 0.502498, Valid_loss 0.429960
Epoch 6, Train Loss 0.488695, Valid_loss 0.411334
Epoch 7, Train Loss 0.459077, Valid_loss 0.439897
Epoch 8, Train Loss 0.524449, Valid_loss 0.398156
Epoch 9, Train Loss 0.492233, Valid_loss 0.508545
Epoch 10, Train Loss 0.490232, Valid_loss 0.364184
Epoch 11, Train Loss 0.465739, Valid_loss 0.401898
Epoch 12, Train Loss 0.462782, Valid_loss 0.383599
Epoch 13, Train Loss 0.487921, Valid_loss 0.433600
Epoch 14, Train Loss 0.478283, Valid_loss 0.369384
Epoch 15, Train Loss 0.478101, Valid_loss 0.436332
Epoch 16, Train Loss 0.462933, Valid_loss 0.347416
Epoch 17, Train Loss 0.434391, Valid_loss 0.373136
Epoch 18, Train Loss 0.429961, Valid_loss 0.357125
Epoch 19, Train Loss 0.439293, Valid_loss 0.339224
Epoch 20, Train Loss 0.417125, Valid_loss 0.338271
Epoch 21, Train Loss 0.468851, Valid_loss 0.334043
Epoch 22, Train Loss 0.399482, Valid_loss 0.388975
Epoch 23, Train Loss 0.447040, Valid_loss 0.334325
Epoch 24, Train Loss 0.424507, Valid_loss 0.341056
Epoch 25, Train Loss 0.394909, Valid_loss 0.339094
Epoch 26, Train Loss 0.417393, Valid_loss 0.356726
Epoch 27, Train Loss 0.467541, Valid_loss 0.430363
Epoch 28, Train Loss 0.426068, Valid_loss 0.321975
Epoch 29, Train Loss 0.392444, Valid_loss 0.344493
Epoch 30, Train Loss 0.443733, Valid_loss 0.359706
Epoch 31, Train Loss 0.418618, Valid_loss 0.413595
Epoch 32, Train Loss 0.396145, Valid_loss 0.325806
Epoch 33, Train Loss 0.424213, Valid_loss 0.372498
Epoch 34, Train Loss 0.442273, Valid_loss 0.353016
Epoch 35, Train Loss 0.387515, Valid_loss 0.289870
Epoch 36, Train Loss 0.417827, Valid_loss 0.305462
Epoch 37, Train Loss 0.359219, Valid_loss 0.300044
Epoch 38, Train Loss 0.395979, Valid_loss 0.297696
Epoch 39, Train Loss 0.375011, Valid_loss 0.270350
Epoch 40, Train Loss 0.367030, Valid_loss 0.361154
Epoch 41, Train Loss 0.333319, Valid_loss 0.315619
Epoch 42, Train Loss 0.353518, Valid_loss 0.310794
Epoch 43, Train Loss 0.371391, Valid_loss 0.268515
Epoch 44, Train Loss 0.371973, Valid_loss 0.301365
Epoch 45, Train Loss 0.357692, Valid_loss 0.366218
Epoch 46, Train Loss 0.396529, Valid_loss 0.306857
Epoch 47, Train Loss 0.333296, Valid_loss 0.312785
Epoch 48, Train Loss 0.329898, Valid_loss 0.257747
Epoch 49, Train Loss 0.352864, Valid_loss 0.367801
Epoch 50, Train Loss 0.339320, Valid_loss 0.278820
Epoch 51, Train Loss 0.342551, Valid_loss 0.266616
Epoch 52, Train Loss 0.327385, Valid_loss 0.268084
Epoch 53, Train Loss 0.330086, Valid_loss 0.312615
[I 2025-08-30 06:20:39,270] Trial 1 finished with value: 0.2577473797968456 and parameters: {'learning_rate': 0.001, 'epochs': 100, 'heads': 4, 'dropout': 0.5, 'weight_decay': 0.001, 'emb_dim': 8, 'augment_num': 100, 'pca': False}. Best is trial 1 with value: 0.2577473797968456.
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 26.13 MB
Memory Reserved: 46.00 MB
cuda
Epoch 1, Train Loss 0.667311, Valid_loss 0.579922
Epoch 2, Train Loss 0.583710, Valid_loss 0.480866
Epoch 3, Train Loss 0.451304, Valid_loss 0.382429
Epoch 4, Train Loss 0.398718, Valid_loss 0.353817
Epoch 5, Train Loss 0.373080, Valid_loss 0.284993
Epoch 6, Train Loss 0.348875, Valid_loss 0.404289
Epoch 7, Train Loss 0.380606, Valid_loss 0.396142
Epoch 8, Train Loss 0.319848, Valid_loss 0.352936
Epoch 9, Train Loss 0.304613, Valid_loss 0.291182
Epoch 10, Train Loss 0.306268, Valid_loss 0.289250
Epoch 11, Train Loss 0.305405, Valid_loss 0.410049
Epoch 12, Train Loss 0.290850, Valid_loss 0.436203
Epoch 13, Train Loss 0.302682, Valid_loss 0.326903
Epoch 14, Train Loss 0.306045, Valid_loss 0.280352
Epoch 15, Train Loss 0.261678, Valid_loss 0.306359
Epoch 16, Train Loss 0.289307, Valid_loss 0.298416
Epoch 17, Train Loss 0.257876, Valid_loss 0.263711
Epoch 18, Train Loss 0.268533, Valid_loss 0.331270
Epoch 19, Train Loss 0.248849, Valid_loss 0.339780
Epoch 20, Train Loss 0.249384, Valid_loss 0.309890
Epoch 21, Train Loss 0.255524, Valid_loss 0.297037
Epoch 22, Train Loss 0.266039, Valid_loss 0.257725
Epoch 23, Train Loss 0.261632, Valid_loss 0.223900
Epoch 24, Train Loss 0.240152, Valid_loss 0.242068
Epoch 25, Train Loss 0.240119, Valid_loss 0.290777
Epoch 26, Train Loss 0.233054, Valid_loss 0.244031
Epoch 27, Train Loss 0.244510, Valid_loss 0.377891
Epoch 28, Train Loss 0.244146, Valid_loss 0.293386
Epoch 29, Train Loss 0.233150, Valid_loss 0.269429
Epoch 30, Train Loss 0.231218, Valid_loss 0.252644
Epoch 31, Train Loss 0.218076, Valid_loss 0.293157
Epoch 32, Train Loss 0.213848, Valid_loss 0.427308
Epoch 33, Train Loss 0.233580, Valid_loss 0.216468
Epoch 34, Train Loss 0.223290, Valid_loss 0.230760
Epoch 35, Train Loss 0.213729, Valid_loss 0.261560
Epoch 36, Train Loss 0.224908, Valid_loss 0.226863
Epoch 37, Train Loss 0.215782, Valid_loss 0.280824
Epoch 38, Train Loss 0.194502, Valid_loss 0.246468
Epoch 39, Train Loss 0.211325, Valid_loss 0.233518
Epoch 40, Train Loss 0.201730, Valid_loss 0.260527
Epoch 41, Train Loss 0.194796, Valid_loss 0.244960
Epoch 42, Train Loss 0.202310, Valid_loss 0.233635
Epoch 43, Train Loss 0.218684, Valid_loss 0.319089
Epoch 44, Train Loss 0.211491, Valid_loss 0.264820
Epoch 45, Train Loss 0.198562, Valid_loss 0.288067
Epoch 46, Train Loss 0.194902, Valid_loss 0.253710
Epoch 47, Train Loss 0.195158, Valid_loss 0.314303
Epoch 48, Train Loss 0.197429, Valid_loss 0.293722
Epoch 49, Train Loss 0.198381, Valid_loss 0.260451
Epoch 50, Train Loss 0.198348, Valid_loss 0.223295
Epoch 51, Train Loss 0.192215, Valid_loss 0.244357
Epoch 52, Train Loss 0.182988, Valid_loss 0.256024
[I 2025-08-30 06:24:14,005] Trial 2 finished with value: 0.21646827905039703 and parameters: {'learning_rate': 0.001, 'epochs': 100, 'heads': 2, 'dropout': 0.5, 'weight_decay': 0.0001, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 2 with value: 0.21646827905039703.
선택된 trial params: {'learning_rate': 0.001, 'epochs': 100, 'heads': 2, 'dropout': 0.5, 'weight_decay': 0.0001, 'emb_dim': 32, 'augment_num': 100, 'pca': False}
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=10, batch_size=1 -> steps=10
output_class :  1
Memory Allocated: 26.13 MB
Memory Reserved: 46.00 MB
cuda
Epoch 1, Train Loss 0.683273, Valid_loss 0.562009
Epoch 2, Train Loss 0.588950, Valid_loss 0.461210
Epoch 3, Train Loss 0.481489, Valid_loss 0.407900
Epoch 4, Train Loss 0.420032, Valid_loss 0.326219
Epoch 5, Train Loss 0.363450, Valid_loss 0.322763
Epoch 6, Train Loss 0.349927, Valid_loss 0.344473
Epoch 7, Train Loss 0.350752, Valid_loss 0.263518
Epoch 8, Train Loss 0.329919, Valid_loss 0.258947
Epoch 9, Train Loss 0.327048, Valid_loss 0.300323
Epoch 10, Train Loss 0.337334, Valid_loss 0.292934
Epoch 11, Train Loss 0.313110, Valid_loss 0.318048
Epoch 12, Train Loss 0.306787, Valid_loss 0.297757
Epoch 13, Train Loss 0.298458, Valid_loss 0.265719
Epoch 14, Train Loss 0.307717, Valid_loss 0.352462
Epoch 15, Train Loss 0.290281, Valid_loss 0.318915
Epoch 16, Train Loss 0.296010, Valid_loss 0.270056
Epoch 17, Train Loss 0.287487, Valid_loss 0.296610
Epoch 18, Train Loss 0.292603, Valid_loss 0.306674
Epoch 19, Train Loss 0.291048, Valid_loss 0.392329
Epoch 20, Train Loss 0.298695, Valid_loss 0.263743
Epoch 21, Train Loss 0.265062, Valid_loss 0.289278
Epoch 22, Train Loss 0.266563, Valid_loss 0.363013
Epoch 23, Train Loss 0.295448, Valid_loss 0.327226
Epoch 24, Train Loss 0.283772, Valid_loss 0.271555
Epoch 25, Train Loss 0.242771, Valid_loss 0.263440
Epoch 26, Train Loss 0.263491, Valid_loss 0.296618
Epoch 27, Train Loss 0.259584, Valid_loss 0.416677
Epoch 28, Train Loss 0.253964, Valid_loss 0.290327
Epoch 29, Train Loss 0.251967, Valid_loss 0.286683
Epoch 30, Train Loss 0.263408, Valid_loss 0.268417
Epoch 31, Train Loss 0.235813, Valid_loss 0.307507
Epoch 32, Train Loss 0.264423, Valid_loss 0.275616
Epoch 33, Train Loss 0.240700, Valid_loss 0.303814
Epoch 34, Train Loss 0.252260, Valid_loss 0.215444
Epoch 35, Train Loss 0.237457, Valid_loss 0.345976
Epoch 36, Train Loss 0.247413, Valid_loss 0.241412
Epoch 37, Train Loss 0.223023, Valid_loss 0.318973
Epoch 38, Train Loss 0.212246, Valid_loss 0.263432
Epoch 39, Train Loss 0.220256, Valid_loss 0.257315
Epoch 40, Train Loss 0.245702, Valid_loss 0.397065
Epoch 41, Train Loss 0.238111, Valid_loss 0.294073
Epoch 42, Train Loss 0.231147, Valid_loss 0.278387
Epoch 43, Train Loss 0.218620, Valid_loss 0.276938
Epoch 44, Train Loss 0.218023, Valid_loss 0.283463
Epoch 45, Train Loss 0.207800, Valid_loss 0.251673
Epoch 46, Train Loss 0.225867, Valid_loss 0.265485
Epoch 47, Train Loss 0.226460, Valid_loss 0.255538
Epoch 48, Train Loss 0.208458, Valid_loss 0.232151
Epoch 49, Train Loss 0.195993, Valid_loss 0.244381
Epoch 50, Train Loss 0.221957, Valid_loss 0.253948
Epoch 51, Train Loss 0.209879, Valid_loss 0.277765
Epoch 52, Train Loss 0.197879, Valid_loss 0.239478
Epoch 53, Train Loss 0.205595, Valid_loss 0.260507
Epoch 54, Train Loss 0.203351, Valid_loss 0.265549
환자ID=COVID19_Participant13 -- true: 1 -- pred: 1
환자ID=COVID19_Participant28 -- true: 1 -- pred: 1
환자ID=COVID19_Participant31 -- true: 1 -- pred: 0
환자ID=COVID19_Participant39 -- true: 1 -- pred: 1
환자ID=COVID19_Participant4 -- true: 1 -- pred: 1
환자ID=COVID19_Participant6 -- true: 1 -- pred: 1
환자ID=COVID19_Participant9 -- true: 1 -- pred: 1
환자ID=Control_Participant1 -- true: 0 -- pred: 1
환자ID=Control_Participant15 -- true: 0 -- pred: 0
환자ID=Control_Participant8 -- true: 0 -- pred: 0
Best performance: Epoch 34, Loss 0.252260, Test ACC 0.800000, Test AUC 0.952381, Test Recall 0.857143, Test Precision 0.857143
Confusion Matrix:
 [2 1 1 6]
✅ Total valid splits used: 4
🔁 Repeat 1, Fold 4
cell type :  GTCGGGGGGTGG_Control_Participant7     Developing Ciliated Cells
CAAATCAATTAT_Control_Participant7     Developing Ciliated Cells
ATACAATTGACA_Control_Participant7     Developing Ciliated Cells
CTGTTAATGAGA_Control_Participant7     Developing Ciliated Cells
CTTCACATTATT_Control_Participant7     Developing Ciliated Cells
                                                ...            
GCAGGGAACTCC_COVID19_Participant30               Squamous Cells
CAGCACCGAGCC_COVID19_Participant30               Squamous Cells
GCCCCTTGTGAT_COVID19_Participant30               Squamous Cells
GTGTTGTGTGTC_COVID19_Participant30               Squamous Cells
TAACACTCACTT_COVID19_Participant30               Squamous Cells
Name: manual_annotation, Length: 20367, dtype: string
cell type annotation :  GTCGGGGGGTGG_Control_Participant7     Developing Ciliated Cells
CAAATCAATTAT_Control_Participant7     Developing Ciliated Cells
ATACAATTGACA_Control_Participant7     Developing Ciliated Cells
CTGTTAATGAGA_Control_Participant7     Developing Ciliated Cells
CTTCACATTATT_Control_Participant7     Developing Ciliated Cells
                                                ...            
GCAGGGAACTCC_COVID19_Participant30               Squamous Cells
CAGCACCGAGCC_COVID19_Participant30               Squamous Cells
GCCCCTTGTGAT_COVID19_Participant30               Squamous Cells
GTGTTGTGTGTC_COVID19_Participant30               Squamous Cells
TAACACTCACTT_COVID19_Participant30               Squamous Cells
Name: manual_annotation, Length: 20367, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Developing Ciliated Cells', 'Ciliated Cells', 'Secretory Cells', 'Squamous Cells', 'Goblet Cells', 'T Cells', 'Dendritic Cells', 'Basal Cells', 'Deuterosomal Cells', 'Mitotic Basal Cells', 'Macrophages', 'B Cells', 'Ionocytes', 'Developing Secretory and Goblet Cells', 'Plasmacytoid DCs', 'Enteroendocrine Cells', 'Erythroblasts', 'Mast Cells']
라벨별 그룹 개수 {1: 28, 0: 12}
cell type :  TGGGATTACAGG_COVID19_Participant10        Enteroendocrine Cells
AACCGTGGTCAT_COVID19_Participant10                 Goblet Cells
TAAGCCTGCGGA_COVID19_Participant10               Ciliated Cells
CTACCCAGACAC_COVID19_Participant10               Ciliated Cells
CGTCTACATCTT_COVID19_Participant10               Ciliated Cells
                                                ...            
ACCATATTCAGG_COVID19_Participant21    Developing Ciliated Cells
GCCCGTTTCACG_COVID19_Participant21              Secretory Cells
TATTATCTCTTA_COVID19_Participant21    Developing Ciliated Cells
TTCCGTTTGTCC_COVID19_Participant21                 Goblet Cells
TCGGGATTGGAT_COVID19_Participant21               Ciliated Cells
Name: manual_annotation, Length: 6580, dtype: string
cell type annotation :  TGGGATTACAGG_COVID19_Participant10        Enteroendocrine Cells
AACCGTGGTCAT_COVID19_Participant10                 Goblet Cells
TAAGCCTGCGGA_COVID19_Participant10               Ciliated Cells
CTACCCAGACAC_COVID19_Participant10               Ciliated Cells
CGTCTACATCTT_COVID19_Participant10               Ciliated Cells
                                                ...            
ACCATATTCAGG_COVID19_Participant21    Developing Ciliated Cells
GCCCGTTTCACG_COVID19_Participant21              Secretory Cells
TATTATCTCTTA_COVID19_Participant21    Developing Ciliated Cells
TTCCGTTTGTCC_COVID19_Participant21                 Goblet Cells
TCGGGATTGGAT_COVID19_Participant21               Ciliated Cells
Name: manual_annotation, Length: 6580, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Enteroendocrine Cells', 'Goblet Cells', 'Ciliated Cells', 'Secretory Cells', 'Squamous Cells', 'Deuterosomal Cells', 'Basal Cells', 'T Cells', 'Mitotic Basal Cells', 'Dendritic Cells', 'Developing Ciliated Cells', 'Ionocytes', 'Macrophages', 'Developing Secretory and Goblet Cells', 'Erythroblasts', 'Plasmacytoid DCs', 'B Cells']
라벨별 그룹 개수 {1: 7, 0: 3}
🔍 Split #5
  → train_p_index 환자 수 (환자 단위로 묶인 index list): 40
  → test_p_index 환자 수  (환자 단위로 묶인 index list): 10
  → train 환자 ID: ['COVID19_Participant11', 'COVID19_Participant12', 'COVID19_Participant13', 'COVID19_Participant14', 'COVID19_Participant17', 'COVID19_Participant19', 'COVID19_Participant2', 'COVID19_Participant20', 'COVID19_Participant22', 'COVID19_Participant23', 'COVID19_Participant25', 'COVID19_Participant26', 'COVID19_Participant27', 'COVID19_Participant28', 'COVID19_Participant29', 'COVID19_Participant3', 'COVID19_Participant30', 'COVID19_Participant31', 'COVID19_Participant36', 'COVID19_Participant37', 'COVID19_Participant38', 'COVID19_Participant39', 'COVID19_Participant4', 'COVID19_Participant40', 'COVID19_Participant5', 'COVID19_Participant6', 'COVID19_Participant7', 'COVID19_Participant9', 'Control_Participant1', 'Control_Participant12', 'Control_Participant13', 'Control_Participant15', 'Control_Participant2', 'Control_Participant3', 'Control_Participant4', 'Control_Participant5', 'Control_Participant6', 'Control_Participant7', 'Control_Participant8', 'Control_Participant9']
  → test  환자 ID: ['COVID19_Participant10', 'COVID19_Participant15', 'COVID19_Participant18', 'COVID19_Participant21', 'COVID19_Participant32', 'COVID19_Participant35', 'COVID19_Participant8', 'Control_Participant10', 'Control_Participant11', 'Control_Participant14']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant12, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant27, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant3, Label: 1
    ID: COVID19_Participant30, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant36, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant38, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: COVID19_Participant5, Label: 1
    ID: COVID19_Participant6, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: COVID19_Participant9, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant12, Label: 0
    ID: Control_Participant13, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant2, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant4, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant6, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant8, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: COVID19_Participant10, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant18, Label: 1
    ID: COVID19_Participant21, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant35, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: Control_Participant10, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant14, Label: 0
전체 데이터 index 길이 50
label_stat (train 환자 라벨 목록) 갯수 40
train_data에서 환자 단위로, train과 validation 나누기
기존 train_p_index 40
기존 (train) label_stat 40
train-vali 분할 후! 
train y 의 classes : {0, 1} valid y 의 classes : {0, 1} label_stat 의 classes : {0, 1}
train_p_index_ 26
valid_p_index 14
test_p_index 10
→ train 환자 ID 및 라벨:
   총 개수: 26
   환자ID=Control_Participant12, Label=0, 셀개수=99
   환자ID=Control_Participant3, Label=0, 셀개수=1620
   환자ID=COVID19_Participant2, Label=1, 셀개수=329
   환자ID=COVID19_Participant39, Label=1, 셀개수=454
   환자ID=COVID19_Participant11, Label=1, 셀개수=382
   환자ID=Control_Participant6, Label=0, 셀개수=131
   환자ID=COVID19_Participant14, Label=1, 셀개수=382
   환자ID=COVID19_Participant20, Label=1, 셀개수=2033
   환자ID=COVID19_Participant40, Label=1, 셀개수=381
   환자ID=COVID19_Participant13, Label=1, 셀개수=730
   환자ID=COVID19_Participant22, Label=1, 셀개수=865
   환자ID=Control_Participant4, Label=0, 셀개수=440
   환자ID=COVID19_Participant28, Label=1, 셀개수=1079
   환자ID=Control_Participant8, Label=0, 셀개수=393
   환자ID=Control_Participant7, Label=0, 셀개수=762
   환자ID=COVID19_Participant17, Label=1, 셀개수=843
   환자ID=Control_Participant9, Label=0, 셀개수=558
   환자ID=Control_Participant13, Label=0, 셀개수=88
   환자ID=COVID19_Participant25, Label=1, 셀개수=496
   환자ID=COVID19_Participant30, Label=1, 셀개수=116
   환자ID=COVID19_Participant27, Label=1, 셀개수=93
   환자ID=COVID19_Participant19, Label=1, 셀개수=816
   환자ID=COVID19_Participant6, Label=1, 셀개수=84
   환자ID=COVID19_Participant4, Label=1, 셀개수=1680
   환자ID=COVID19_Participant38, Label=1, 셀개수=51
   환자ID=COVID19_Participant3, Label=1, 셀개수=104
→ valid 환자 ID 및 라벨:
   총 개수: 14
   환자ID=Control_Participant2, Label=0, 셀개수=41
   환자ID=COVID19_Participant29, Label=1, 셀개수=573
   환자ID=COVID19_Participant36, Label=1, 셀개수=200
   환자ID=COVID19_Participant31, Label=1, 셀개수=410
   환자ID=COVID19_Participant5, Label=1, 셀개수=89
   환자ID=COVID19_Participant23, Label=1, 셀개수=307
   환자ID=Control_Participant5, Label=0, 셀개수=717
   환자ID=Control_Participant1, Label=0, 셀개수=414
   환자ID=COVID19_Participant9, Label=1, 셀개수=86
   환자ID=COVID19_Participant7, Label=1, 셀개수=409
   환자ID=Control_Participant15, Label=0, 셀개수=528
   환자ID=COVID19_Participant37, Label=1, 셀개수=668
   환자ID=COVID19_Participant12, Label=1, 셀개수=102
   환자ID=COVID19_Participant26, Label=1, 셀개수=814
→ test 환자 ID 및 라벨:
   총 개수: 10
   환자ID=COVID19_Participant10, Label=1, 셀개수=18
   환자ID=COVID19_Participant15, Label=1, 셀개수=1003
   환자ID=COVID19_Participant18, Label=1, 셀개수=227
   환자ID=COVID19_Participant21, Label=1, 셀개수=39
   환자ID=COVID19_Participant32, Label=1, 셀개수=1665
   환자ID=COVID19_Participant35, Label=1, 셀개수=83
   환자ID=COVID19_Participant8, Label=1, 셀개수=462
   환자ID=Control_Participant10, Label=0, 셀개수=1645
   환자ID=Control_Participant11, Label=0, 셀개수=1164
   환자ID=Control_Participant14, Label=0, 셀개수=274
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Ciliated Cells', 'Developing Ciliated Cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
전체 데이터 길이 26947
전체 cell type 길이 0        Developing Ciliated Cells
1        Developing Ciliated Cells
2        Developing Ciliated Cells
3        Developing Ciliated Cells
4        Developing Ciliated Cells
                   ...            
26942    Developing Ciliated Cells
26943              Secretory Cells
26944    Developing Ciliated Cells
26945                 Goblet Cells
26946               Ciliated Cells
Length: 26947, dtype: string
cell type의 NaN 개수 체크 0
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:11,  8.42it/s]  2%|▏         | 2/100 [00:00<00:13,  7.46it/s]  3%|▎         | 3/100 [00:00<00:11,  8.29it/s]  4%|▍         | 4/100 [00:00<00:11,  8.69it/s]  5%|▌         | 5/100 [00:00<00:14,  6.42it/s]  6%|▌         | 6/100 [00:00<00:13,  7.12it/s]  8%|▊         | 8/100 [00:01<00:10,  8.46it/s]  9%|▉         | 9/100 [00:01<00:10,  8.80it/s] 10%|█         | 10/100 [00:01<00:10,  8.71it/s] 11%|█         | 11/100 [00:01<00:11,  8.03it/s] 12%|█▏        | 12/100 [00:01<00:10,  8.26it/s] 13%|█▎        | 13/100 [00:01<00:10,  8.68it/s] 14%|█▍        | 14/100 [00:01<00:15,  5.53it/s] 15%|█▌        | 15/100 [00:02<00:13,  6.33it/s] 17%|█▋        | 17/100 [00:02<00:10,  7.94it/s] 18%|█▊        | 18/100 [00:02<00:10,  7.92it/s] 20%|██        | 20/100 [00:02<00:09,  8.40it/s] 21%|██        | 21/100 [00:02<00:11,  6.62it/s] 22%|██▏       | 22/100 [00:02<00:10,  7.20it/s] 23%|██▎       | 23/100 [00:03<00:09,  7.76it/s] 24%|██▍       | 24/100 [00:03<00:14,  5.32it/s] 25%|██▌       | 25/100 [00:03<00:15,  4.93it/s] 26%|██▌       | 26/100 [00:03<00:14,  5.21it/s] 27%|██▋       | 27/100 [00:03<00:13,  5.41it/s] 28%|██▊       | 28/100 [00:04<00:13,  5.35it/s] 29%|██▉       | 29/100 [00:04<00:11,  6.17it/s] 30%|███       | 30/100 [00:04<00:10,  6.67it/s] 31%|███       | 31/100 [00:04<00:11,  6.17it/s] 32%|███▏      | 32/100 [00:04<00:10,  6.79it/s] 33%|███▎      | 33/100 [00:04<00:09,  7.34it/s] 34%|███▍      | 34/100 [00:04<00:09,  7.10it/s] 35%|███▌      | 35/100 [00:05<00:08,  7.54it/s] 36%|███▌      | 36/100 [00:05<00:07,  8.13it/s] 37%|███▋      | 37/100 [00:05<00:10,  6.23it/s] 38%|███▊      | 38/100 [00:05<00:09,  6.88it/s] 40%|████      | 40/100 [00:05<00:07,  8.03it/s] 41%|████      | 41/100 [00:05<00:07,  7.87it/s] 43%|████▎     | 43/100 [00:06<00:06,  8.56it/s] 44%|████▍     | 44/100 [00:06<00:06,  8.83it/s] 45%|████▌     | 45/100 [00:06<00:08,  6.33it/s] 46%|████▌     | 46/100 [00:06<00:09,  5.88it/s] 47%|████▋     | 47/100 [00:06<00:08,  6.50it/s] 48%|████▊     | 48/100 [00:06<00:07,  7.15it/s] 49%|████▉     | 49/100 [00:06<00:06,  7.73it/s] 50%|█████     | 50/100 [00:07<00:06,  8.13it/s] 51%|█████     | 51/100 [00:07<00:05,  8.22it/s] 52%|█████▏    | 52/100 [00:07<00:06,  7.32it/s] 53%|█████▎    | 53/100 [00:07<00:06,  7.74it/s] 54%|█████▍    | 54/100 [00:07<00:05,  8.09it/s] 55%|█████▌    | 55/100 [00:07<00:05,  7.92it/s] 56%|█████▌    | 56/100 [00:07<00:05,  8.42it/s] 57%|█████▋    | 57/100 [00:07<00:04,  8.62it/s] 58%|█████▊    | 58/100 [00:08<00:05,  7.60it/s] 59%|█████▉    | 59/100 [00:08<00:05,  7.84it/s] 60%|██████    | 60/100 [00:08<00:07,  5.50it/s] 61%|██████    | 61/100 [00:08<00:06,  6.34it/s] 62%|██████▏   | 62/100 [00:08<00:05,  6.47it/s] 64%|██████▍   | 64/100 [00:08<00:04,  7.68it/s] 65%|██████▌   | 65/100 [00:09<00:04,  8.00it/s] 66%|██████▌   | 66/100 [00:09<00:04,  7.70it/s] 67%|██████▋   | 67/100 [00:09<00:04,  7.76it/s] 68%|██████▊   | 68/100 [00:09<00:03,  8.04it/s] 69%|██████▉   | 69/100 [00:09<00:03,  8.40it/s] 70%|███████   | 70/100 [00:09<00:03,  8.72it/s] 71%|███████   | 71/100 [00:09<00:03,  8.98it/s] 72%|███████▏  | 72/100 [00:09<00:03,  9.18it/s] 73%|███████▎  | 73/100 [00:09<00:03,  8.64it/s] 74%|███████▍  | 74/100 [00:10<00:02,  8.81it/s] 75%|███████▌  | 75/100 [00:10<00:02,  8.74it/s] 76%|███████▌  | 76/100 [00:10<00:02,  8.99it/s] 77%|███████▋  | 77/100 [00:10<00:02,  8.99it/s] 78%|███████▊  | 78/100 [00:10<00:02,  9.14it/s] 79%|███████▉  | 79/100 [00:10<00:02,  9.10it/s] 80%|████████  | 80/100 [00:10<00:02,  9.00it/s] 82%|████████▏ | 82/100 [00:10<00:01,  9.28it/s] 83%|████████▎ | 83/100 [00:11<00:01,  9.22it/s] 84%|████████▍ | 84/100 [00:11<00:01,  8.17it/s] 86%|████████▌ | 86/100 [00:11<00:01,  8.07it/s] 87%|████████▋ | 87/100 [00:11<00:01,  8.26it/s] 88%|████████▊ | 88/100 [00:11<00:01,  7.77it/s] 89%|████████▉ | 89/100 [00:11<00:01,  7.62it/s] 90%|█████████ | 90/100 [00:12<00:01,  7.79it/s] 91%|█████████ | 91/100 [00:12<00:01,  6.34it/s] 92%|█████████▏| 92/100 [00:12<00:01,  5.12it/s] 93%|█████████▎| 93/100 [00:12<00:01,  4.96it/s] 94%|█████████▍| 94/100 [00:12<00:01,  5.67it/s] 95%|█████████▌| 95/100 [00:13<00:00,  5.82it/s] 96%|█████████▌| 96/100 [00:13<00:00,  6.49it/s] 98%|█████████▊| 98/100 [00:13<00:00,  7.84it/s] 99%|█████████▉| 99/100 [00:13<00:00,  7.76it/s]100%|██████████| 100/100 [00:13<00:00,  7.99it/s]100%|██████████| 100/100 [00:13<00:00,  7.36it/s]
[I 2025-08-30 06:28:12,147] A new study created in memory with name: no-name-bd093735-c7c2-4ed4-9e7d-dd1e9f94c4f2
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 26.13 MB
Memory Reserved: 46.00 MB
cuda
Epoch 1, Train Loss 0.753776, Valid_loss 0.594551
Epoch 2, Train Loss 0.631996, Valid_loss 0.584087
Epoch 3, Train Loss 0.569662, Valid_loss 0.504366
Epoch 4, Train Loss 0.534421, Valid_loss 0.453089
Epoch 5, Train Loss 0.459023, Valid_loss 0.479485
Epoch 6, Train Loss 0.432343, Valid_loss 0.383861
Epoch 7, Train Loss 0.448198, Valid_loss 0.389609
Epoch 8, Train Loss 0.439237, Valid_loss 0.455954
Epoch 9, Train Loss 0.405557, Valid_loss 0.370790
Epoch 10, Train Loss 0.392807, Valid_loss 0.365464
Epoch 11, Train Loss 0.390636, Valid_loss 0.368813
Epoch 12, Train Loss 0.376900, Valid_loss 0.483184
Epoch 13, Train Loss 0.384284, Valid_loss 0.431093
Epoch 14, Train Loss 0.381866, Valid_loss 0.377192
Epoch 15, Train Loss 0.375510, Valid_loss 0.394719
Epoch 16, Train Loss 0.347883, Valid_loss 0.369585
Epoch 17, Train Loss 0.340453, Valid_loss 0.433355
Epoch 18, Train Loss 0.337304, Valid_loss 0.380272
Epoch 19, Train Loss 0.312848, Valid_loss 0.366387
Epoch 20, Train Loss 0.318952, Valid_loss 0.419621
Epoch 21, Train Loss 0.306840, Valid_loss 0.409814
Epoch 22, Train Loss 0.304437, Valid_loss 0.369360
Epoch 23, Train Loss 0.298069, Valid_loss 0.378694
Epoch 24, Train Loss 0.298263, Valid_loss 0.388732
Epoch 25, Train Loss 0.291905, Valid_loss 0.441208
Epoch 26, Train Loss 0.278842, Valid_loss 0.380943
Epoch 27, Train Loss 0.281197, Valid_loss 0.389622
Epoch 28, Train Loss 0.310650, Valid_loss 0.372503
Epoch 29, Train Loss 0.306855, Valid_loss 0.387482
Epoch 30, Train Loss 0.307344, Valid_loss 0.354808
Epoch 31, Train Loss 0.288579, Valid_loss 0.317650
Epoch 32, Train Loss 0.275470, Valid_loss 0.397575
Epoch 33, Train Loss 0.268023, Valid_loss 0.451020
Epoch 34, Train Loss 0.272604, Valid_loss 0.457746
Epoch 35, Train Loss 0.284330, Valid_loss 0.405360
Epoch 36, Train Loss 0.270459, Valid_loss 0.367243
Epoch 37, Train Loss 0.297175, Valid_loss 0.380483
Epoch 38, Train Loss 0.264342, Valid_loss 0.398336
Epoch 39, Train Loss 0.275931, Valid_loss 0.400801
Epoch 40, Train Loss 0.256005, Valid_loss 0.481077
Epoch 41, Train Loss 0.261019, Valid_loss 0.378887
Epoch 42, Train Loss 0.274612, Valid_loss 0.364076
Epoch 43, Train Loss 0.284572, Valid_loss 0.398555
Epoch 44, Train Loss 0.242372, Valid_loss 0.351711
Epoch 45, Train Loss 0.246631, Valid_loss 0.343726
Epoch 46, Train Loss 0.262873, Valid_loss 0.380969
Epoch 47, Train Loss 0.248196, Valid_loss 0.339033
Epoch 48, Train Loss 0.274500, Valid_loss 0.339518
Epoch 49, Train Loss 0.263072, Valid_loss 0.350008
Epoch 50, Train Loss 0.234798, Valid_loss 0.368106
Epoch 51, Train Loss 0.265921, Valid_loss 0.416143
Epoch 52, Train Loss 0.236452, Valid_loss 0.391639
Epoch 53, Train Loss 0.247811, Valid_loss 0.374291
Epoch 54, Train Loss 0.228793, Valid_loss 0.415188
Epoch 55, Train Loss 0.229735, Valid_loss 0.414386
Epoch 56, Train Loss 0.238830, Valid_loss 0.376292
Epoch 57, Train Loss 0.245918, Valid_loss 0.379541
Epoch 58, Train Loss 0.256108, Valid_loss 0.392542
[I 2025-08-30 06:32:08,849] Trial 0 finished with value: 0.31764980565224377 and parameters: {'learning_rate': 0.001, 'epochs': 100, 'heads': 2, 'dropout': 0.7, 'weight_decay': 0.001, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.31764980565224377.
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 26.13 MB
Memory Reserved: 46.00 MB
cuda
Epoch 1, Train Loss 0.614000, Valid_loss 0.585329
Epoch 2, Train Loss 0.579456, Valid_loss 0.570176
Epoch 3, Train Loss 0.555716, Valid_loss 0.543706
Epoch 4, Train Loss 0.531241, Valid_loss 0.509609
Epoch 5, Train Loss 0.469831, Valid_loss 0.484232
Epoch 6, Train Loss 0.433905, Valid_loss 0.458901
Epoch 7, Train Loss 0.421507, Valid_loss 0.447327
Epoch 8, Train Loss 0.419092, Valid_loss 0.436664
Epoch 9, Train Loss 0.392435, Valid_loss 0.429488
Epoch 10, Train Loss 0.392922, Valid_loss 0.413751
Epoch 11, Train Loss 0.384306, Valid_loss 0.388968
Epoch 12, Train Loss 0.384817, Valid_loss 0.380530
Epoch 13, Train Loss 0.379085, Valid_loss 0.392657
Epoch 14, Train Loss 0.375223, Valid_loss 0.372779
Epoch 15, Train Loss 0.374317, Valid_loss 0.396479
Epoch 16, Train Loss 0.365383, Valid_loss 0.371815
Epoch 17, Train Loss 0.361436, Valid_loss 0.377736
Epoch 18, Train Loss 0.371657, Valid_loss 0.361654
Epoch 19, Train Loss 0.358747, Valid_loss 0.369477
Epoch 20, Train Loss 0.353607, Valid_loss 0.407167
Epoch 21, Train Loss 0.356507, Valid_loss 0.360301
Epoch 22, Train Loss 0.343027, Valid_loss 0.357282
Epoch 23, Train Loss 0.345872, Valid_loss 0.362804
Epoch 24, Train Loss 0.357717, Valid_loss 0.368583
Epoch 25, Train Loss 0.350199, Valid_loss 0.353190
Epoch 26, Train Loss 0.343211, Valid_loss 0.373677
Epoch 27, Train Loss 0.344789, Valid_loss 0.350114
Epoch 28, Train Loss 0.340528, Valid_loss 0.357484
Epoch 29, Train Loss 0.340823, Valid_loss 0.366367
Epoch 30, Train Loss 0.330394, Valid_loss 0.354774
Epoch 31, Train Loss 0.342205, Valid_loss 0.374192
Epoch 32, Train Loss 0.332906, Valid_loss 0.360532
Epoch 33, Train Loss 0.323433, Valid_loss 0.362725
Epoch 34, Train Loss 0.334662, Valid_loss 0.390325
Epoch 35, Train Loss 0.345709, Valid_loss 0.353600
Epoch 36, Train Loss 0.340717, Valid_loss 0.358872
Epoch 37, Train Loss 0.324926, Valid_loss 0.366620
Epoch 38, Train Loss 0.326434, Valid_loss 0.352927
Epoch 39, Train Loss 0.326317, Valid_loss 0.361584
Epoch 40, Train Loss 0.333006, Valid_loss 0.387754
Epoch 41, Train Loss 0.317509, Valid_loss 0.352753
Epoch 42, Train Loss 0.318840, Valid_loss 0.356297
Epoch 43, Train Loss 0.319546, Valid_loss 0.374047
Epoch 44, Train Loss 0.326274, Valid_loss 0.351476
Epoch 45, Train Loss 0.318032, Valid_loss 0.352125
Epoch 46, Train Loss 0.320141, Valid_loss 0.356757
Epoch 47, Train Loss 0.322590, Valid_loss 0.359429
Epoch 48, Train Loss 0.313416, Valid_loss 0.413552
Epoch 49, Train Loss 0.313233, Valid_loss 0.373839
Epoch 50, Train Loss 0.322716, Valid_loss 0.373707
Epoch 51, Train Loss 0.316476, Valid_loss 0.373795
Epoch 52, Train Loss 0.317667, Valid_loss 0.383061
[I 2025-08-30 06:36:13,551] Trial 1 finished with value: 0.3501139458801065 and parameters: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 4, 'dropout': 0.3, 'weight_decay': 0.01, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.31764980565224377.
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 46.00 MB
cuda
Epoch 1, Train Loss 0.630344, Valid_loss 0.600360
Epoch 2, Train Loss 0.615740, Valid_loss 0.595758
Epoch 3, Train Loss 0.609459, Valid_loss 0.591620
Epoch 4, Train Loss 0.603388, Valid_loss 0.581310
Epoch 5, Train Loss 0.594660, Valid_loss 0.572593
Epoch 6, Train Loss 0.582323, Valid_loss 0.564972
Epoch 7, Train Loss 0.570003, Valid_loss 0.556334
Epoch 8, Train Loss 0.557533, Valid_loss 0.564533
Epoch 9, Train Loss 0.547402, Valid_loss 0.545566
Epoch 10, Train Loss 0.538013, Valid_loss 0.537656
Epoch 11, Train Loss 0.524818, Valid_loss 0.541545
Epoch 12, Train Loss 0.515149, Valid_loss 0.533771
Epoch 13, Train Loss 0.511186, Valid_loss 0.512485
Epoch 14, Train Loss 0.505127, Valid_loss 0.509398
Epoch 15, Train Loss 0.499625, Valid_loss 0.503086
Epoch 16, Train Loss 0.495498, Valid_loss 0.502042
Epoch 17, Train Loss 0.493178, Valid_loss 0.498736
Epoch 18, Train Loss 0.489865, Valid_loss 0.493295
Epoch 19, Train Loss 0.486925, Valid_loss 0.499607
Epoch 20, Train Loss 0.485704, Valid_loss 0.492469
Epoch 21, Train Loss 0.483222, Valid_loss 0.489529
Epoch 22, Train Loss 0.479048, Valid_loss 0.490259
Epoch 23, Train Loss 0.476628, Valid_loss 0.486952
Epoch 24, Train Loss 0.474363, Valid_loss 0.489261
Epoch 25, Train Loss 0.473576, Valid_loss 0.485168
Epoch 26, Train Loss 0.471674, Valid_loss 0.487761
Epoch 27, Train Loss 0.467521, Valid_loss 0.485716
Epoch 28, Train Loss 0.465854, Valid_loss 0.485201
Epoch 29, Train Loss 0.464363, Valid_loss 0.483322
Epoch 30, Train Loss 0.459556, Valid_loss 0.485924
Epoch 31, Train Loss 0.460405, Valid_loss 0.482549
Epoch 32, Train Loss 0.457703, Valid_loss 0.482774
Epoch 33, Train Loss 0.454096, Valid_loss 0.478625
Epoch 34, Train Loss 0.454701, Valid_loss 0.476710
Epoch 35, Train Loss 0.451234, Valid_loss 0.474783
Epoch 36, Train Loss 0.450043, Valid_loss 0.474929
Epoch 37, Train Loss 0.447324, Valid_loss 0.473899
Epoch 38, Train Loss 0.445669, Valid_loss 0.474394
Epoch 39, Train Loss 0.443238, Valid_loss 0.473140
Epoch 40, Train Loss 0.441133, Valid_loss 0.473329
Epoch 41, Train Loss 0.440154, Valid_loss 0.470731
Epoch 42, Train Loss 0.439899, Valid_loss 0.469926
Epoch 43, Train Loss 0.436940, Valid_loss 0.470006
Epoch 44, Train Loss 0.434845, Valid_loss 0.469051
Epoch 45, Train Loss 0.434318, Valid_loss 0.468885
Epoch 46, Train Loss 0.433623, Valid_loss 0.468759
Epoch 47, Train Loss 0.429336, Valid_loss 0.466662
Epoch 48, Train Loss 0.428492, Valid_loss 0.466196
Epoch 49, Train Loss 0.426881, Valid_loss 0.464660
Epoch 50, Train Loss 0.425284, Valid_loss 0.461999
Epoch 51, Train Loss 0.424578, Valid_loss 0.461812
Epoch 52, Train Loss 0.422623, Valid_loss 0.461704
Epoch 53, Train Loss 0.422528, Valid_loss 0.461147
Epoch 54, Train Loss 0.420852, Valid_loss 0.460262
Epoch 55, Train Loss 0.422057, Valid_loss 0.460267
Epoch 56, Train Loss 0.421226, Valid_loss 0.459611
Epoch 57, Train Loss 0.420839, Valid_loss 0.458796
Epoch 58, Train Loss 0.417058, Valid_loss 0.458078
Epoch 59, Train Loss 0.417907, Valid_loss 0.458582
Epoch 60, Train Loss 0.416018, Valid_loss 0.457201
Epoch 61, Train Loss 0.417752, Valid_loss 0.456887
Epoch 62, Train Loss 0.415058, Valid_loss 0.456691
Epoch 63, Train Loss 0.414542, Valid_loss 0.455720
Epoch 64, Train Loss 0.414825, Valid_loss 0.455591
Epoch 65, Train Loss 0.415020, Valid_loss 0.455046
Epoch 66, Train Loss 0.411427, Valid_loss 0.455485
Epoch 67, Train Loss 0.412080, Valid_loss 0.453801
Epoch 68, Train Loss 0.412681, Valid_loss 0.453946
Epoch 69, Train Loss 0.409812, Valid_loss 0.451576
Epoch 70, Train Loss 0.408979, Valid_loss 0.453183
Epoch 71, Train Loss 0.409026, Valid_loss 0.451824
Epoch 72, Train Loss 0.407065, Valid_loss 0.451415
Epoch 73, Train Loss 0.407902, Valid_loss 0.450542
Epoch 74, Train Loss 0.405009, Valid_loss 0.450049
Epoch 75, Train Loss 0.406428, Valid_loss 0.450142
Epoch 76, Train Loss 0.405358, Valid_loss 0.449723
Epoch 77, Train Loss 0.402873, Valid_loss 0.449960
Epoch 78, Train Loss 0.402562, Valid_loss 0.449096
Epoch 79, Train Loss 0.404094, Valid_loss 0.448260
Epoch 80, Train Loss 0.403105, Valid_loss 0.448385
Epoch 81, Train Loss 0.399509, Valid_loss 0.447620
Epoch 82, Train Loss 0.399913, Valid_loss 0.447017
Epoch 83, Train Loss 0.398807, Valid_loss 0.446436
Epoch 84, Train Loss 0.399411, Valid_loss 0.444711
Epoch 85, Train Loss 0.398256, Valid_loss 0.444666
Epoch 86, Train Loss 0.396358, Valid_loss 0.444021
Epoch 87, Train Loss 0.396794, Valid_loss 0.443730
Epoch 88, Train Loss 0.396135, Valid_loss 0.443509
Epoch 89, Train Loss 0.394677, Valid_loss 0.442824
Epoch 90, Train Loss 0.393681, Valid_loss 0.442605
Epoch 91, Train Loss 0.394481, Valid_loss 0.441715
Epoch 92, Train Loss 0.393610, Valid_loss 0.442216
Epoch 93, Train Loss 0.391688, Valid_loss 0.441962
Epoch 94, Train Loss 0.392305, Valid_loss 0.439685
Epoch 95, Train Loss 0.390281, Valid_loss 0.440383
Epoch 96, Train Loss 0.391525, Valid_loss 0.440207
Epoch 97, Train Loss 0.390291, Valid_loss 0.439639
Epoch 98, Train Loss 0.390053, Valid_loss 0.438086
Epoch 99, Train Loss 0.386436, Valid_loss 0.438791
Epoch 100, Train Loss 0.387527, Valid_loss 0.435810
[I 2025-08-30 06:42:52,145] Trial 2 finished with value: 0.435810495700155 and parameters: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 2, 'dropout': 0.0, 'weight_decay': 0.0001, 'emb_dim': 8, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.31764980565224377.
선택된 trial params: {'learning_rate': 0.001, 'epochs': 100, 'heads': 2, 'dropout': 0.7, 'weight_decay': 0.001, 'emb_dim': 32, 'augment_num': 100, 'pca': False}
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=10, batch_size=1 -> steps=10
output_class :  1
Memory Allocated: 26.13 MB
Memory Reserved: 46.00 MB
cuda
Epoch 1, Train Loss 0.719184, Valid_loss 0.591503
Epoch 2, Train Loss 0.664103, Valid_loss 0.587359
Epoch 3, Train Loss 0.603877, Valid_loss 0.577059
Epoch 4, Train Loss 0.586967, Valid_loss 0.494270
Epoch 5, Train Loss 0.531441, Valid_loss 0.449651
Epoch 6, Train Loss 0.473869, Valid_loss 0.393102
Epoch 7, Train Loss 0.446247, Valid_loss 0.378987
Epoch 8, Train Loss 0.431912, Valid_loss 0.366477
Epoch 9, Train Loss 0.424708, Valid_loss 0.401591
Epoch 10, Train Loss 0.427934, Valid_loss 0.405758
Epoch 11, Train Loss 0.365883, Valid_loss 0.361843
Epoch 12, Train Loss 0.392073, Valid_loss 0.365047
Epoch 13, Train Loss 0.383213, Valid_loss 0.406083
Epoch 14, Train Loss 0.376897, Valid_loss 0.364590
Epoch 15, Train Loss 0.385448, Valid_loss 0.440298
Epoch 16, Train Loss 0.347946, Valid_loss 0.369316
Epoch 17, Train Loss 0.321710, Valid_loss 0.360038
Epoch 18, Train Loss 0.346385, Valid_loss 0.370921
Epoch 19, Train Loss 0.347202, Valid_loss 0.364077
Epoch 20, Train Loss 0.317392, Valid_loss 0.350010
Epoch 21, Train Loss 0.320826, Valid_loss 0.331829
Epoch 22, Train Loss 0.319680, Valid_loss 0.357448
Epoch 23, Train Loss 0.346379, Valid_loss 0.505515
Epoch 24, Train Loss 0.354559, Valid_loss 0.394797
Epoch 25, Train Loss 0.305831, Valid_loss 0.388344
Epoch 26, Train Loss 0.327561, Valid_loss 0.319769
Epoch 27, Train Loss 0.336854, Valid_loss 0.316907
Epoch 28, Train Loss 0.286112, Valid_loss 0.339396
Epoch 29, Train Loss 0.320256, Valid_loss 0.341933
Epoch 30, Train Loss 0.294745, Valid_loss 0.420437
Epoch 31, Train Loss 0.292020, Valid_loss 0.318577
Epoch 32, Train Loss 0.289542, Valid_loss 0.310071
Epoch 33, Train Loss 0.292960, Valid_loss 0.389509
Epoch 34, Train Loss 0.263177, Valid_loss 0.346326
Epoch 35, Train Loss 0.277116, Valid_loss 0.327800
Epoch 36, Train Loss 0.280071, Valid_loss 0.430386
Epoch 37, Train Loss 0.285787, Valid_loss 0.357161
Epoch 38, Train Loss 0.275087, Valid_loss 0.357623
Epoch 39, Train Loss 0.251047, Valid_loss 0.369236
Epoch 40, Train Loss 0.270088, Valid_loss 0.362438
Epoch 41, Train Loss 0.269183, Valid_loss 0.380140
Epoch 42, Train Loss 0.254625, Valid_loss 0.384016
Epoch 43, Train Loss 0.276167, Valid_loss 0.386297
Epoch 44, Train Loss 0.272757, Valid_loss 0.350768
Epoch 45, Train Loss 0.256772, Valid_loss 0.430242
Epoch 46, Train Loss 0.236325, Valid_loss 0.440355
Epoch 47, Train Loss 0.279750, Valid_loss 0.367300
Epoch 48, Train Loss 0.263171, Valid_loss 0.345354
Epoch 49, Train Loss 0.252295, Valid_loss 0.372814
Epoch 50, Train Loss 0.255400, Valid_loss 0.346592
Epoch 51, Train Loss 0.265122, Valid_loss 0.329394
Epoch 52, Train Loss 0.258817, Valid_loss 0.312273
Epoch 53, Train Loss 0.250108, Valid_loss 0.319032
Epoch 54, Train Loss 0.243334, Valid_loss 0.365449
환자ID=COVID19_Participant10 -- true: 1 -- pred: 0
환자ID=COVID19_Participant15 -- true: 1 -- pred: 1
환자ID=COVID19_Participant18 -- true: 1 -- pred: 1
환자ID=COVID19_Participant21 -- true: 1 -- pred: 1
환자ID=COVID19_Participant32 -- true: 1 -- pred: 1
환자ID=COVID19_Participant35 -- true: 1 -- pred: 0
환자ID=COVID19_Participant8 -- true: 1 -- pred: 1
환자ID=Control_Participant10 -- true: 0 -- pred: 0
환자ID=Control_Participant11 -- true: 0 -- pred: 1
환자ID=Control_Participant14 -- true: 0 -- pred: 0
Best performance: Epoch 32, Loss 0.289542, Test ACC 0.700000, Test AUC 0.904762, Test Recall 0.714286, Test Precision 0.833333
Confusion Matrix:
 [2 1 2 5]
✅ Total valid splits used: 5

📌 Repeat 1: 평균 AUC = 0.9619, 표준편차 = 0.0356
Test ACC 평균 0.860000, Test Recall 평균 0.885714, Test Precision 평균 0.909524
fold_aucs = [1.0, 1.0, 0.9523809523809524, 0.9523809523809524, 0.9047619047619049]
NaN 개수: 0 / 전체 5개

🔁 Repeat 2, Fold 0
cell type :  GTCGGGGGGTGG_Control_Participant7     Developing Ciliated Cells
CAAATCAATTAT_Control_Participant7     Developing Ciliated Cells
ATACAATTGACA_Control_Participant7     Developing Ciliated Cells
CTGTTAATGAGA_Control_Participant7     Developing Ciliated Cells
CTTCACATTATT_Control_Participant7     Developing Ciliated Cells
                                                ...            
ACCATATTCAGG_COVID19_Participant21    Developing Ciliated Cells
GCCCGTTTCACG_COVID19_Participant21              Secretory Cells
TATTATCTCTTA_COVID19_Participant21    Developing Ciliated Cells
TTCCGTTTGTCC_COVID19_Participant21                 Goblet Cells
TCGGGATTGGAT_COVID19_Participant21               Ciliated Cells
Name: manual_annotation, Length: 20828, dtype: string
cell type annotation :  GTCGGGGGGTGG_Control_Participant7     Developing Ciliated Cells
CAAATCAATTAT_Control_Participant7     Developing Ciliated Cells
ATACAATTGACA_Control_Participant7     Developing Ciliated Cells
CTGTTAATGAGA_Control_Participant7     Developing Ciliated Cells
CTTCACATTATT_Control_Participant7     Developing Ciliated Cells
                                                ...            
ACCATATTCAGG_COVID19_Participant21    Developing Ciliated Cells
GCCCGTTTCACG_COVID19_Participant21              Secretory Cells
TATTATCTCTTA_COVID19_Participant21    Developing Ciliated Cells
TTCCGTTTGTCC_COVID19_Participant21                 Goblet Cells
TCGGGATTGGAT_COVID19_Participant21               Ciliated Cells
Name: manual_annotation, Length: 20828, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Developing Ciliated Cells', 'Ciliated Cells', 'Secretory Cells', 'Squamous Cells', 'Goblet Cells', 'T Cells', 'Dendritic Cells', 'Basal Cells', 'Deuterosomal Cells', 'Mitotic Basal Cells', 'Macrophages', 'B Cells', 'Ionocytes', 'Developing Secretory and Goblet Cells', 'Plasmacytoid DCs', 'Enteroendocrine Cells', 'Erythroblasts', 'Mast Cells']
라벨별 그룹 개수 {1: 28, 0: 12}
cell type :  TTCCCAAGATCC_COVID19_Participant7            Squamous Cells
TGGGATTACAGG_COVID19_Participant7     Enteroendocrine Cells
CACCTTCCCCTT_COVID19_Participant7            Ciliated Cells
CAATGCCCGCTA_COVID19_Participant7            Ciliated Cells
TTCTGAAAACAA_COVID19_Participant7            Ciliated Cells
                                              ...          
GCAGGGAACTCC_COVID19_Participant30           Squamous Cells
CAGCACCGAGCC_COVID19_Participant30           Squamous Cells
GCCCCTTGTGAT_COVID19_Participant30           Squamous Cells
GTGTTGTGTGTC_COVID19_Participant30           Squamous Cells
TAACACTCACTT_COVID19_Participant30           Squamous Cells
Name: manual_annotation, Length: 6119, dtype: string
cell type annotation :  TTCCCAAGATCC_COVID19_Participant7            Squamous Cells
TGGGATTACAGG_COVID19_Participant7     Enteroendocrine Cells
CACCTTCCCCTT_COVID19_Participant7            Ciliated Cells
CAATGCCCGCTA_COVID19_Participant7            Ciliated Cells
TTCTGAAAACAA_COVID19_Participant7            Ciliated Cells
                                              ...          
GCAGGGAACTCC_COVID19_Participant30           Squamous Cells
CAGCACCGAGCC_COVID19_Participant30           Squamous Cells
GCCCCTTGTGAT_COVID19_Participant30           Squamous Cells
GTGTTGTGTGTC_COVID19_Participant30           Squamous Cells
TAACACTCACTT_COVID19_Participant30           Squamous Cells
Name: manual_annotation, Length: 6119, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Squamous Cells', 'Enteroendocrine Cells', 'Ciliated Cells', 'Secretory Cells', 'Developing Ciliated Cells', 'Basal Cells', 'Goblet Cells', 'T Cells', 'Mitotic Basal Cells', 'Ionocytes', 'Deuterosomal Cells', 'Developing Secretory and Goblet Cells', 'B Cells', 'Dendritic Cells', 'Macrophages', 'Erythroblasts']
라벨별 그룹 개수 {1: 7, 0: 3}
🔍 Split #1
  → train_p_index 환자 수 (환자 단위로 묶인 index list): 40
  → test_p_index 환자 수  (환자 단위로 묶인 index list): 10
  → train 환자 ID: ['COVID19_Participant11', 'COVID19_Participant13', 'COVID19_Participant14', 'COVID19_Participant15', 'COVID19_Participant17', 'COVID19_Participant18', 'COVID19_Participant19', 'COVID19_Participant2', 'COVID19_Participant21', 'COVID19_Participant22', 'COVID19_Participant23', 'COVID19_Participant25', 'COVID19_Participant26', 'COVID19_Participant28', 'COVID19_Participant29', 'COVID19_Participant3', 'COVID19_Participant31', 'COVID19_Participant32', 'COVID19_Participant35', 'COVID19_Participant36', 'COVID19_Participant37', 'COVID19_Participant38', 'COVID19_Participant39', 'COVID19_Participant40', 'COVID19_Participant5', 'COVID19_Participant6', 'COVID19_Participant8', 'COVID19_Participant9', 'Control_Participant1', 'Control_Participant10', 'Control_Participant11', 'Control_Participant12', 'Control_Participant13', 'Control_Participant14', 'Control_Participant15', 'Control_Participant2', 'Control_Participant3', 'Control_Participant4', 'Control_Participant6', 'Control_Participant7']
  → test  환자 ID: ['COVID19_Participant10', 'COVID19_Participant12', 'COVID19_Participant20', 'COVID19_Participant27', 'COVID19_Participant30', 'COVID19_Participant4', 'COVID19_Participant7', 'Control_Participant5', 'Control_Participant8', 'Control_Participant9']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant18, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant21, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant3, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant35, Label: 1
    ID: COVID19_Participant36, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant38, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: COVID19_Participant5, Label: 1
    ID: COVID19_Participant6, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: COVID19_Participant9, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant10, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant12, Label: 0
    ID: Control_Participant13, Label: 0
    ID: Control_Participant14, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant2, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant4, Label: 0
    ID: Control_Participant6, Label: 0
    ID: Control_Participant7, Label: 0
  → test 환자 ID 및 라벨:
    ID: COVID19_Participant10, Label: 1
    ID: COVID19_Participant12, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant27, Label: 1
    ID: COVID19_Participant30, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: Control_Participant5, Label: 0
    ID: Control_Participant8, Label: 0
    ID: Control_Participant9, Label: 0
전체 데이터 index 길이 50
label_stat (train 환자 라벨 목록) 갯수 40
train_data에서 환자 단위로, train과 validation 나누기
기존 train_p_index 40
기존 (train) label_stat 40
train-vali 분할 후! 
train y 의 classes : {0, 1} valid y 의 classes : {0, 1} label_stat 의 classes : {0, 1}
train_p_index_ 26
valid_p_index 14
test_p_index 10
→ train 환자 ID 및 라벨:
   총 개수: 26
   환자ID=Control_Participant10, Label=0, 셀개수=1645
   환자ID=Control_Participant14, Label=0, 셀개수=274
   환자ID=COVID19_Participant19, Label=1, 셀개수=816
   환자ID=COVID19_Participant38, Label=1, 셀개수=51
   환자ID=COVID19_Participant11, Label=1, 셀개수=382
   환자ID=Control_Participant3, Label=0, 셀개수=1620
   환자ID=COVID19_Participant15, Label=1, 셀개수=1003
   환자ID=COVID19_Participant2, Label=1, 셀개수=329
   환자ID=COVID19_Participant40, Label=1, 셀개수=381
   환자ID=COVID19_Participant14, Label=1, 셀개수=382
   환자ID=COVID19_Participant21, Label=1, 셀개수=39
   환자ID=Control_Participant15, Label=0, 셀개수=528
   환자ID=COVID19_Participant28, Label=1, 셀개수=1079
   환자ID=Control_Participant6, Label=0, 셀개수=131
   환자ID=Control_Participant4, Label=0, 셀개수=440
   환자ID=COVID19_Participant17, Label=1, 셀개수=843
   환자ID=Control_Participant7, Label=0, 셀개수=762
   환자ID=Control_Participant11, Label=0, 셀개수=1164
   환자ID=COVID19_Participant23, Label=1, 셀개수=307
   환자ID=COVID19_Participant31, Label=1, 셀개수=410
   환자ID=COVID19_Participant26, Label=1, 셀개수=814
   환자ID=COVID19_Participant18, Label=1, 셀개수=227
   환자ID=COVID19_Participant6, Label=1, 셀개수=84
   환자ID=COVID19_Participant39, Label=1, 셀개수=454
   환자ID=COVID19_Participant37, Label=1, 셀개수=668
   환자ID=COVID19_Participant3, Label=1, 셀개수=104
→ valid 환자 ID 및 라벨:
   총 개수: 14
   환자ID=Control_Participant13, Label=0, 셀개수=88
   환자ID=COVID19_Participant29, Label=1, 셀개수=573
   환자ID=COVID19_Participant35, Label=1, 셀개수=83
   환자ID=COVID19_Participant32, Label=1, 셀개수=1665
   환자ID=COVID19_Participant5, Label=1, 셀개수=89
   환자ID=COVID19_Participant22, Label=1, 셀개수=865
   환자ID=Control_Participant2, Label=0, 셀개수=41
   환자ID=Control_Participant1, Label=0, 셀개수=414
   환자ID=COVID19_Participant9, Label=1, 셀개수=86
   환자ID=COVID19_Participant8, Label=1, 셀개수=462
   환자ID=Control_Participant12, Label=0, 셀개수=99
   환자ID=COVID19_Participant36, Label=1, 셀개수=200
   환자ID=COVID19_Participant13, Label=1, 셀개수=730
   환자ID=COVID19_Participant25, Label=1, 셀개수=496
→ test 환자 ID 및 라벨:
   총 개수: 10
   환자ID=COVID19_Participant10, Label=1, 셀개수=18
   환자ID=COVID19_Participant12, Label=1, 셀개수=102
   환자ID=COVID19_Participant20, Label=1, 셀개수=2033
   환자ID=COVID19_Participant27, Label=1, 셀개수=93
   환자ID=COVID19_Participant30, Label=1, 셀개수=116
   환자ID=COVID19_Participant4, Label=1, 셀개수=1680
   환자ID=COVID19_Participant7, Label=1, 셀개수=409
   환자ID=Control_Participant5, Label=0, 셀개수=717
   환자ID=Control_Participant8, Label=0, 셀개수=393
   환자ID=Control_Participant9, Label=0, 셀개수=558
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Ciliated Cells', 'Developing Ciliated Cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
전체 데이터 길이 26947
전체 cell type 길이 0        Developing Ciliated Cells
1        Developing Ciliated Cells
2        Developing Ciliated Cells
3        Developing Ciliated Cells
4        Developing Ciliated Cells
                   ...            
26942               Squamous Cells
26943               Squamous Cells
26944               Squamous Cells
26945               Squamous Cells
26946               Squamous Cells
Length: 26947, dtype: string
cell type의 NaN 개수 체크 0
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  2%|▏         | 2/100 [00:00<00:09,  9.89it/s]  4%|▍         | 4/100 [00:00<00:10,  8.91it/s]  5%|▌         | 5/100 [00:00<00:11,  8.57it/s]  6%|▌         | 6/100 [00:00<00:10,  8.71it/s]  7%|▋         | 7/100 [00:00<00:10,  8.97it/s]  9%|▉         | 9/100 [00:00<00:09,  9.29it/s] 10%|█         | 10/100 [00:01<00:11,  7.94it/s] 11%|█         | 11/100 [00:01<00:10,  8.23it/s] 12%|█▏        | 12/100 [00:01<00:10,  8.37it/s] 13%|█▎        | 13/100 [00:01<00:10,  8.58it/s] 14%|█▍        | 14/100 [00:01<00:09,  8.64it/s] 15%|█▌        | 15/100 [00:01<00:10,  8.45it/s] 17%|█▋        | 17/100 [00:02<00:14,  5.85it/s] 18%|█▊        | 18/100 [00:02<00:15,  5.39it/s] 19%|█▉        | 19/100 [00:02<00:13,  6.02it/s] 20%|██        | 20/100 [00:02<00:11,  6.67it/s] 21%|██        | 21/100 [00:02<00:10,  7.29it/s] 22%|██▏       | 22/100 [00:02<00:11,  6.92it/s] 23%|██▎       | 23/100 [00:03<00:10,  7.56it/s] 24%|██▍       | 24/100 [00:03<00:10,  7.33it/s] 25%|██▌       | 25/100 [00:03<00:11,  6.77it/s] 26%|██▌       | 26/100 [00:03<00:09,  7.41it/s] 27%|██▋       | 27/100 [00:03<00:09,  8.02it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.23it/s] 29%|██▉       | 29/100 [00:03<00:09,  7.63it/s] 31%|███       | 31/100 [00:04<00:07,  8.66it/s] 32%|███▏      | 32/100 [00:04<00:07,  8.83it/s] 33%|███▎      | 33/100 [00:04<00:07,  8.87it/s] 34%|███▍      | 34/100 [00:04<00:07,  8.41it/s] 36%|███▌      | 36/100 [00:04<00:07,  8.62it/s] 38%|███▊      | 38/100 [00:04<00:06,  8.87it/s] 39%|███▉      | 39/100 [00:04<00:07,  8.67it/s] 40%|████      | 40/100 [00:05<00:06,  8.93it/s] 41%|████      | 41/100 [00:05<00:06,  8.96it/s] 42%|████▏     | 42/100 [00:05<00:06,  9.02it/s] 43%|████▎     | 43/100 [00:05<00:06,  9.14it/s] 44%|████▍     | 44/100 [00:05<00:06,  8.64it/s] 45%|████▌     | 45/100 [00:05<00:06,  8.84it/s] 46%|████▌     | 46/100 [00:05<00:07,  6.96it/s] 47%|████▋     | 47/100 [00:05<00:07,  7.48it/s] 48%|████▊     | 48/100 [00:06<00:06,  8.06it/s] 49%|████▉     | 49/100 [00:06<00:06,  7.79it/s] 50%|█████     | 50/100 [00:06<00:06,  8.25it/s] 51%|█████     | 51/100 [00:06<00:05,  8.54it/s] 52%|█████▏    | 52/100 [00:06<00:05,  8.52it/s] 53%|█████▎    | 53/100 [00:06<00:05,  8.44it/s] 54%|█████▍    | 54/100 [00:06<00:05,  8.64it/s] 55%|█████▌    | 55/100 [00:06<00:05,  8.90it/s] 56%|█████▌    | 56/100 [00:06<00:05,  8.18it/s] 57%|█████▋    | 57/100 [00:07<00:05,  8.31it/s] 58%|█████▊    | 58/100 [00:07<00:04,  8.60it/s] 59%|█████▉    | 59/100 [00:07<00:05,  8.03it/s] 60%|██████    | 60/100 [00:07<00:05,  7.97it/s] 61%|██████    | 61/100 [00:07<00:05,  6.71it/s] 62%|██████▏   | 62/100 [00:07<00:05,  7.12it/s] 63%|██████▎   | 63/100 [00:07<00:04,  7.44it/s] 64%|██████▍   | 64/100 [00:08<00:04,  7.77it/s] 65%|██████▌   | 65/100 [00:08<00:04,  8.31it/s] 66%|██████▌   | 66/100 [00:08<00:04,  8.08it/s] 67%|██████▋   | 67/100 [00:08<00:04,  6.65it/s] 68%|██████▊   | 68/100 [00:08<00:07,  4.34it/s] 69%|██████▉   | 69/100 [00:09<00:06,  5.04it/s] 70%|███████   | 70/100 [00:09<00:05,  5.88it/s] 71%|███████   | 71/100 [00:09<00:04,  6.44it/s] 72%|███████▏  | 72/100 [00:09<00:03,  7.13it/s] 73%|███████▎  | 73/100 [00:09<00:03,  7.10it/s] 74%|███████▍  | 74/100 [00:09<00:03,  7.55it/s] 75%|███████▌  | 75/100 [00:09<00:03,  6.80it/s] 76%|███████▌  | 76/100 [00:09<00:03,  7.21it/s] 77%|███████▋  | 77/100 [00:10<00:02,  7.67it/s] 78%|███████▊  | 78/100 [00:10<00:03,  7.29it/s] 79%|███████▉  | 79/100 [00:10<00:02,  7.73it/s] 80%|████████  | 80/100 [00:10<00:02,  7.46it/s] 81%|████████  | 81/100 [00:10<00:02,  7.75it/s] 82%|████████▏ | 82/100 [00:10<00:02,  7.49it/s] 83%|████████▎ | 83/100 [00:10<00:02,  7.86it/s] 84%|████████▍ | 84/100 [00:10<00:01,  8.10it/s] 85%|████████▌ | 85/100 [00:11<00:01,  8.30it/s] 86%|████████▌ | 86/100 [00:11<00:01,  8.49it/s] 87%|████████▋ | 87/100 [00:11<00:01,  8.43it/s] 88%|████████▊ | 88/100 [00:11<00:01,  8.52it/s] 89%|████████▉ | 89/100 [00:11<00:01,  8.68it/s] 90%|█████████ | 90/100 [00:11<00:01,  8.53it/s] 91%|█████████ | 91/100 [00:11<00:01,  8.69it/s] 92%|█████████▏| 92/100 [00:11<00:01,  7.71it/s] 93%|█████████▎| 93/100 [00:12<00:01,  5.84it/s] 94%|█████████▍| 94/100 [00:12<00:01,  5.36it/s] 95%|█████████▌| 95/100 [00:12<00:00,  5.76it/s] 96%|█████████▌| 96/100 [00:12<00:00,  5.11it/s] 97%|█████████▋| 97/100 [00:12<00:00,  5.95it/s] 98%|█████████▊| 98/100 [00:12<00:00,  6.53it/s] 99%|█████████▉| 99/100 [00:13<00:00,  5.92it/s]100%|██████████| 100/100 [00:13<00:00,  5.40it/s]100%|██████████| 100/100 [00:13<00:00,  7.46it/s]
[I 2025-08-30 06:46:49,235] A new study created in memory with name: no-name-697d3d2b-9218-4615-9fd5-ef54e42d3ff0
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 27.97 MB
Memory Reserved: 46.00 MB
cuda
Epoch 1, Train Loss 0.651634, Valid_loss 0.543456
Epoch 2, Train Loss 0.543639, Valid_loss 0.506663
Epoch 3, Train Loss 0.480040, Valid_loss 0.492448
Epoch 4, Train Loss 0.422800, Valid_loss 0.452817
Epoch 5, Train Loss 0.386134, Valid_loss 0.437233
Epoch 6, Train Loss 0.358432, Valid_loss 0.458385
Epoch 7, Train Loss 0.343286, Valid_loss 0.469795
Epoch 8, Train Loss 0.343634, Valid_loss 0.464529
Epoch 9, Train Loss 0.324059, Valid_loss 0.426495
Epoch 10, Train Loss 0.305119, Valid_loss 0.463110
Epoch 11, Train Loss 0.304607, Valid_loss 0.483089
Epoch 12, Train Loss 0.305686, Valid_loss 0.493017
Epoch 13, Train Loss 0.298227, Valid_loss 0.466096
Epoch 14, Train Loss 0.289879, Valid_loss 0.467815
Epoch 15, Train Loss 0.294609, Valid_loss 0.493326
Epoch 16, Train Loss 0.292969, Valid_loss 0.457374
Epoch 17, Train Loss 0.286882, Valid_loss 0.495438
Epoch 18, Train Loss 0.272609, Valid_loss 0.517024
Epoch 19, Train Loss 0.275162, Valid_loss 0.458664
Epoch 20, Train Loss 0.268071, Valid_loss 0.520538
Epoch 21, Train Loss 0.248224, Valid_loss 0.468122
Epoch 22, Train Loss 0.256508, Valid_loss 0.456612
Epoch 23, Train Loss 0.265383, Valid_loss 0.515568
Epoch 24, Train Loss 0.258106, Valid_loss 0.459546
Epoch 25, Train Loss 0.267828, Valid_loss 0.463449
Epoch 26, Train Loss 0.261391, Valid_loss 0.448952
Epoch 27, Train Loss 0.258305, Valid_loss 0.444449
Epoch 28, Train Loss 0.243275, Valid_loss 0.435661
Epoch 29, Train Loss 0.249715, Valid_loss 0.436327
Epoch 30, Train Loss 0.252973, Valid_loss 0.449349
Epoch 31, Train Loss 0.237623, Valid_loss 0.452357
Epoch 32, Train Loss 0.246453, Valid_loss 0.470161
Epoch 33, Train Loss 0.238417, Valid_loss 0.468336
Epoch 34, Train Loss 0.239743, Valid_loss 0.462585
Epoch 35, Train Loss 0.241797, Valid_loss 0.450633
Epoch 36, Train Loss 0.243264, Valid_loss 0.431138
Epoch 37, Train Loss 0.250214, Valid_loss 0.438515
Epoch 38, Train Loss 0.233356, Valid_loss 0.454407
Epoch 39, Train Loss 0.224257, Valid_loss 0.465355
Epoch 40, Train Loss 0.238422, Valid_loss 0.413578
Epoch 41, Train Loss 0.229080, Valid_loss 0.438621
Epoch 42, Train Loss 0.239636, Valid_loss 0.467331
Epoch 43, Train Loss 0.223758, Valid_loss 0.401527
Epoch 44, Train Loss 0.234252, Valid_loss 0.524269
Epoch 45, Train Loss 0.235465, Valid_loss 0.404236
Epoch 46, Train Loss 0.226474, Valid_loss 0.448281
Epoch 47, Train Loss 0.225087, Valid_loss 0.436858
Epoch 48, Train Loss 0.221177, Valid_loss 0.442177
Epoch 49, Train Loss 0.235450, Valid_loss 0.443001
Epoch 50, Train Loss 0.227363, Valid_loss 0.438194
Epoch 51, Train Loss 0.228639, Valid_loss 0.434165
Epoch 52, Train Loss 0.217167, Valid_loss 0.428088
Epoch 53, Train Loss 0.222404, Valid_loss 0.417234
Epoch 54, Train Loss 0.219705, Valid_loss 0.453014
Epoch 55, Train Loss 0.220801, Valid_loss 0.428227
Epoch 56, Train Loss 0.215028, Valid_loss 0.462086
Epoch 57, Train Loss 0.215914, Valid_loss 0.431441
Epoch 58, Train Loss 0.222156, Valid_loss 0.447692
Epoch 59, Train Loss 0.216845, Valid_loss 0.434592
Epoch 60, Train Loss 0.231915, Valid_loss 0.438111
Epoch 61, Train Loss 0.216541, Valid_loss 0.428134
Epoch 62, Train Loss 0.212992, Valid_loss 0.442590
Epoch 63, Train Loss 0.204512, Valid_loss 0.433792
Epoch 64, Train Loss 0.220082, Valid_loss 0.438941
Epoch 65, Train Loss 0.211709, Valid_loss 0.437227
Epoch 66, Train Loss 0.221262, Valid_loss 0.426828
Epoch 67, Train Loss 0.218611, Valid_loss 0.438584
Epoch 68, Train Loss 0.222086, Valid_loss 0.417784
Epoch 69, Train Loss 0.215562, Valid_loss 0.426525
Epoch 70, Train Loss 0.218802, Valid_loss 0.424233
Epoch 71, Train Loss 0.213074, Valid_loss 0.420051
Epoch 72, Train Loss 0.213120, Valid_loss 0.418712
Epoch 73, Train Loss 0.219625, Valid_loss 0.460397
Epoch 74, Train Loss 0.220317, Valid_loss 0.436970
Epoch 75, Train Loss 0.222824, Valid_loss 0.440361
Epoch 76, Train Loss 0.217752, Valid_loss 0.446965
[I 2025-08-30 06:52:06,420] Trial 0 finished with value: 0.40152702826474396 and parameters: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 2, 'dropout': 0.5, 'weight_decay': 0.001, 'emb_dim': 64, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.40152702826474396.
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 27.97 MB
Memory Reserved: 46.00 MB
cuda
Epoch 1, Train Loss 0.617188, Valid_loss 0.568287
Epoch 2, Train Loss 0.551120, Valid_loss 0.515827
Epoch 3, Train Loss 0.467702, Valid_loss 0.472974
Epoch 4, Train Loss 0.381637, Valid_loss 0.477935
Epoch 5, Train Loss 0.342132, Valid_loss 0.537446
Epoch 6, Train Loss 0.341588, Valid_loss 0.492635
Epoch 7, Train Loss 0.317034, Valid_loss 0.495417
Epoch 8, Train Loss 0.306417, Valid_loss 0.488343
Epoch 9, Train Loss 0.301407, Valid_loss 0.479685
Epoch 10, Train Loss 0.303118, Valid_loss 0.486160
Epoch 11, Train Loss 0.290480, Valid_loss 0.511178
Epoch 12, Train Loss 0.274657, Valid_loss 0.494970
Epoch 13, Train Loss 0.285481, Valid_loss 0.480020
Epoch 14, Train Loss 0.282535, Valid_loss 0.499584
Epoch 15, Train Loss 0.263670, Valid_loss 0.519699
Epoch 16, Train Loss 0.277307, Valid_loss 0.476507
Epoch 17, Train Loss 0.255328, Valid_loss 0.499101
Epoch 18, Train Loss 0.267660, Valid_loss 0.499318
Epoch 19, Train Loss 0.268375, Valid_loss 0.486503
Epoch 20, Train Loss 0.254750, Valid_loss 0.488943
Epoch 21, Train Loss 0.259300, Valid_loss 0.517231
Epoch 22, Train Loss 0.258737, Valid_loss 0.483148
Epoch 23, Train Loss 0.254982, Valid_loss 0.481624
Epoch 24, Train Loss 0.252725, Valid_loss 0.510090
Epoch 25, Train Loss 0.243666, Valid_loss 0.504042
Epoch 26, Train Loss 0.247045, Valid_loss 0.471926
Epoch 27, Train Loss 0.243121, Valid_loss 0.473247
Epoch 28, Train Loss 0.243247, Valid_loss 0.504238
Epoch 29, Train Loss 0.248283, Valid_loss 0.471859
Epoch 30, Train Loss 0.235121, Valid_loss 0.490414
Epoch 31, Train Loss 0.239205, Valid_loss 0.493782
Epoch 32, Train Loss 0.250361, Valid_loss 0.469960
Epoch 33, Train Loss 0.251318, Valid_loss 0.477665
Epoch 34, Train Loss 0.243981, Valid_loss 0.474525
Epoch 35, Train Loss 0.233248, Valid_loss 0.490528
Epoch 36, Train Loss 0.229025, Valid_loss 0.487380
Epoch 37, Train Loss 0.235729, Valid_loss 0.456199
Epoch 38, Train Loss 0.240367, Valid_loss 0.475901
Epoch 39, Train Loss 0.231282, Valid_loss 0.455416
Epoch 40, Train Loss 0.231996, Valid_loss 0.479203
Epoch 41, Train Loss 0.237429, Valid_loss 0.457367
Epoch 42, Train Loss 0.231144, Valid_loss 0.488092
Epoch 43, Train Loss 0.223857, Valid_loss 0.493855
Epoch 44, Train Loss 0.223294, Valid_loss 0.444272
Epoch 45, Train Loss 0.228757, Valid_loss 0.511278
Epoch 46, Train Loss 0.239838, Valid_loss 0.520867
Epoch 47, Train Loss 0.226471, Valid_loss 0.442519
Epoch 48, Train Loss 0.222281, Valid_loss 0.464458
Epoch 49, Train Loss 0.227433, Valid_loss 0.456821
Epoch 50, Train Loss 0.228212, Valid_loss 0.451288
Epoch 51, Train Loss 0.228359, Valid_loss 0.459383
Epoch 52, Train Loss 0.213600, Valid_loss 0.446969
Epoch 53, Train Loss 0.217381, Valid_loss 0.454677
Epoch 54, Train Loss 0.222819, Valid_loss 0.445353
Epoch 55, Train Loss 0.224471, Valid_loss 0.462359
Epoch 56, Train Loss 0.216518, Valid_loss 0.457212
Epoch 57, Train Loss 0.217997, Valid_loss 0.452651
Epoch 58, Train Loss 0.218121, Valid_loss 0.475981
Epoch 59, Train Loss 0.223856, Valid_loss 0.436651
Epoch 60, Train Loss 0.221427, Valid_loss 0.493366
Epoch 61, Train Loss 0.214660, Valid_loss 0.451502
Epoch 62, Train Loss 0.216078, Valid_loss 0.462565
Epoch 63, Train Loss 0.222532, Valid_loss 0.452723
Epoch 64, Train Loss 0.212271, Valid_loss 0.479309
Epoch 65, Train Loss 0.211999, Valid_loss 0.439432
Epoch 66, Train Loss 0.211436, Valid_loss 0.435609
Epoch 67, Train Loss 0.218476, Valid_loss 0.466523
Epoch 68, Train Loss 0.216391, Valid_loss 0.446060
Epoch 69, Train Loss 0.209157, Valid_loss 0.481596
Epoch 70, Train Loss 0.219199, Valid_loss 0.444577
Epoch 71, Train Loss 0.214759, Valid_loss 0.453689
Epoch 72, Train Loss 0.213876, Valid_loss 0.465618
[I 2025-08-30 06:56:46,327] Trial 1 finished with value: 0.4356085692665407 and parameters: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 1, 'dropout': 0.3, 'weight_decay': 0.01, 'emb_dim': 64, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.40152702826474396.
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 46.00 MB
cuda
Epoch 1, Train Loss 0.732864, Valid_loss 0.694712
Epoch 2, Train Loss 0.714855, Valid_loss 0.659903
Epoch 3, Train Loss 0.675133, Valid_loss 0.648401
Epoch 4, Train Loss 0.672598, Valid_loss 0.650356
Epoch 5, Train Loss 0.649723, Valid_loss 0.643412
Epoch 6, Train Loss 0.611889, Valid_loss 0.627920
Epoch 7, Train Loss 0.610018, Valid_loss 0.591691
Epoch 8, Train Loss 0.598220, Valid_loss 0.731730
Epoch 9, Train Loss 0.614098, Valid_loss 0.627144
Epoch 10, Train Loss 0.577817, Valid_loss 0.650132
Epoch 11, Train Loss 0.597102, Valid_loss 0.618848
Epoch 12, Train Loss 0.558387, Valid_loss 0.652453
Epoch 13, Train Loss 0.591977, Valid_loss 0.606907
Epoch 14, Train Loss 0.557576, Valid_loss 0.651021
Epoch 15, Train Loss 0.596221, Valid_loss 0.561968
Epoch 16, Train Loss 0.559425, Valid_loss 0.518560
Epoch 17, Train Loss 0.534860, Valid_loss 0.638697
Epoch 18, Train Loss 0.534403, Valid_loss 0.571921
Epoch 19, Train Loss 0.528801, Valid_loss 0.568172
Epoch 20, Train Loss 0.544070, Valid_loss 0.536896
Epoch 21, Train Loss 0.523912, Valid_loss 0.534877
Epoch 22, Train Loss 0.550552, Valid_loss 0.561687
Epoch 23, Train Loss 0.459944, Valid_loss 0.504714
Epoch 24, Train Loss 0.550268, Valid_loss 0.573894
Epoch 25, Train Loss 0.489563, Valid_loss 0.481949
Epoch 26, Train Loss 0.526072, Valid_loss 0.646077
Epoch 27, Train Loss 0.524421, Valid_loss 0.477718
Epoch 28, Train Loss 0.487243, Valid_loss 0.507633
Epoch 29, Train Loss 0.517421, Valid_loss 0.510281
Epoch 30, Train Loss 0.491246, Valid_loss 0.473209
Epoch 31, Train Loss 0.477523, Valid_loss 0.543040
Epoch 32, Train Loss 0.497420, Valid_loss 0.492222
Epoch 33, Train Loss 0.469146, Valid_loss 0.477546
Epoch 34, Train Loss 0.538713, Valid_loss 0.517093
Epoch 35, Train Loss 0.503960, Valid_loss 0.465153
Epoch 36, Train Loss 0.404387, Valid_loss 0.485436
Epoch 37, Train Loss 0.501476, Valid_loss 0.448470
Epoch 38, Train Loss 0.512557, Valid_loss 0.444013
Epoch 39, Train Loss 0.487602, Valid_loss 0.438606
Epoch 40, Train Loss 0.477897, Valid_loss 0.458725
Epoch 41, Train Loss 0.495788, Valid_loss 0.467227
Epoch 42, Train Loss 0.401028, Valid_loss 0.456998
Epoch 43, Train Loss 0.457402, Valid_loss 0.459267
Epoch 44, Train Loss 0.457263, Valid_loss 0.464071
Epoch 45, Train Loss 0.435370, Valid_loss 0.461191
Epoch 46, Train Loss 0.449234, Valid_loss 0.450143
Epoch 47, Train Loss 0.424712, Valid_loss 0.451186
Epoch 48, Train Loss 0.427914, Valid_loss 0.428190
Epoch 49, Train Loss 0.457610, Valid_loss 0.461836
Epoch 50, Train Loss 0.453569, Valid_loss 0.423069
Epoch 51, Train Loss 0.450318, Valid_loss 0.449574
Epoch 52, Train Loss 0.462120, Valid_loss 0.461447
[I 2025-08-30 07:00:06,554] Trial 2 finished with value: 0.4230692248259272 and parameters: {'learning_rate': 0.001, 'epochs': 100, 'heads': 1, 'dropout': 0.7, 'weight_decay': 0.001, 'emb_dim': 8, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.40152702826474396.
선택된 trial params: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 2, 'dropout': 0.5, 'weight_decay': 0.001, 'emb_dim': 64, 'augment_num': 100, 'pca': False}
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=10, batch_size=1 -> steps=10
output_class :  1
Memory Allocated: 27.97 MB
Memory Reserved: 46.00 MB
cuda
Epoch 1, Train Loss 0.641248, Valid_loss 0.561836
Epoch 2, Train Loss 0.568822, Valid_loss 0.522620
Epoch 3, Train Loss 0.497917, Valid_loss 0.499760
Epoch 4, Train Loss 0.457007, Valid_loss 0.474716
Epoch 5, Train Loss 0.412140, Valid_loss 0.446259
Epoch 6, Train Loss 0.396375, Valid_loss 0.477833
Epoch 7, Train Loss 0.373836, Valid_loss 0.474223
Epoch 8, Train Loss 0.367016, Valid_loss 0.473067
Epoch 9, Train Loss 0.352422, Valid_loss 0.470826
Epoch 10, Train Loss 0.326877, Valid_loss 0.503895
Epoch 11, Train Loss 0.338139, Valid_loss 0.471812
Epoch 12, Train Loss 0.319506, Valid_loss 0.505797
Epoch 13, Train Loss 0.312094, Valid_loss 0.473709
Epoch 14, Train Loss 0.322528, Valid_loss 0.471679
Epoch 15, Train Loss 0.297144, Valid_loss 0.506493
Epoch 16, Train Loss 0.294141, Valid_loss 0.481698
Epoch 17, Train Loss 0.301291, Valid_loss 0.552435
Epoch 18, Train Loss 0.312463, Valid_loss 0.467783
Epoch 19, Train Loss 0.287217, Valid_loss 0.516918
Epoch 20, Train Loss 0.284492, Valid_loss 0.470190
Epoch 21, Train Loss 0.284461, Valid_loss 0.550951
Epoch 22, Train Loss 0.271609, Valid_loss 0.503973
Epoch 23, Train Loss 0.285371, Valid_loss 0.467086
Epoch 24, Train Loss 0.272781, Valid_loss 0.523902
Epoch 25, Train Loss 0.283207, Valid_loss 0.516745
Epoch 26, Train Loss 0.268807, Valid_loss 0.467322
Epoch 27, Train Loss 0.268169, Valid_loss 0.469696
Epoch 28, Train Loss 0.272428, Valid_loss 0.477795
Epoch 29, Train Loss 0.267898, Valid_loss 0.490106
Epoch 30, Train Loss 0.265667, Valid_loss 0.433784
Epoch 31, Train Loss 0.282373, Valid_loss 0.470841
Epoch 32, Train Loss 0.252849, Valid_loss 0.466701
Epoch 33, Train Loss 0.255379, Valid_loss 0.469650
Epoch 34, Train Loss 0.277756, Valid_loss 0.539457
Epoch 35, Train Loss 0.255371, Valid_loss 0.453971
Epoch 36, Train Loss 0.257379, Valid_loss 0.484260
Epoch 37, Train Loss 0.252884, Valid_loss 0.494436
Epoch 38, Train Loss 0.265959, Valid_loss 0.443276
Epoch 39, Train Loss 0.261085, Valid_loss 0.510002
Epoch 40, Train Loss 0.247494, Valid_loss 0.460125
Epoch 41, Train Loss 0.243954, Valid_loss 0.444139
Epoch 42, Train Loss 0.239840, Valid_loss 0.499571
Epoch 43, Train Loss 0.252427, Valid_loss 0.419557
Epoch 44, Train Loss 0.247201, Valid_loss 0.549910
Epoch 45, Train Loss 0.239755, Valid_loss 0.460042
Epoch 46, Train Loss 0.246270, Valid_loss 0.479020
Epoch 47, Train Loss 0.235007, Valid_loss 0.489303
Epoch 48, Train Loss 0.239379, Valid_loss 0.498386
Epoch 49, Train Loss 0.232152, Valid_loss 0.468666
Epoch 50, Train Loss 0.237039, Valid_loss 0.479488
Epoch 51, Train Loss 0.236814, Valid_loss 0.446144
Epoch 52, Train Loss 0.221103, Valid_loss 0.482680
Epoch 53, Train Loss 0.221719, Valid_loss 0.479842
Epoch 54, Train Loss 0.234494, Valid_loss 0.440307
Epoch 55, Train Loss 0.229783, Valid_loss 0.453846
Epoch 56, Train Loss 0.219039, Valid_loss 0.454861
환자ID=COVID19_Participant10 -- true: 1 -- pred: 0
환자ID=COVID19_Participant12 -- true: 1 -- pred: 1
환자ID=COVID19_Participant20 -- true: 1 -- pred: 1
환자ID=COVID19_Participant27 -- true: 1 -- pred: 1
환자ID=COVID19_Participant30 -- true: 1 -- pred: 1
환자ID=COVID19_Participant4 -- true: 1 -- pred: 1
환자ID=COVID19_Participant7 -- true: 1 -- pred: 1
환자ID=Control_Participant5 -- true: 0 -- pred: 0
환자ID=Control_Participant8 -- true: 0 -- pred: 1
환자ID=Control_Participant9 -- true: 0 -- pred: 0
Best performance: Epoch 43, Loss 0.252427, Test ACC 0.800000, Test AUC 0.952381, Test Recall 0.857143, Test Precision 0.857143
Confusion Matrix:
 [2 1 1 6]
✅ Total valid splits used: 1
🔁 Repeat 2, Fold 1
cell type :  GTCGGGGGGTGG_Control_Participant7     Developing Ciliated Cells
CAAATCAATTAT_Control_Participant7     Developing Ciliated Cells
ATACAATTGACA_Control_Participant7     Developing Ciliated Cells
CTGTTAATGAGA_Control_Participant7     Developing Ciliated Cells
CTTCACATTATT_Control_Participant7     Developing Ciliated Cells
                                                ...            
GCAGGGAACTCC_COVID19_Participant30               Squamous Cells
CAGCACCGAGCC_COVID19_Participant30               Squamous Cells
GCCCCTTGTGAT_COVID19_Participant30               Squamous Cells
GTGTTGTGTGTC_COVID19_Participant30               Squamous Cells
TAACACTCACTT_COVID19_Participant30               Squamous Cells
Name: manual_annotation, Length: 22203, dtype: string
cell type annotation :  GTCGGGGGGTGG_Control_Participant7     Developing Ciliated Cells
CAAATCAATTAT_Control_Participant7     Developing Ciliated Cells
ATACAATTGACA_Control_Participant7     Developing Ciliated Cells
CTGTTAATGAGA_Control_Participant7     Developing Ciliated Cells
CTTCACATTATT_Control_Participant7     Developing Ciliated Cells
                                                ...            
GCAGGGAACTCC_COVID19_Participant30               Squamous Cells
CAGCACCGAGCC_COVID19_Participant30               Squamous Cells
GCCCCTTGTGAT_COVID19_Participant30               Squamous Cells
GTGTTGTGTGTC_COVID19_Participant30               Squamous Cells
TAACACTCACTT_COVID19_Participant30               Squamous Cells
Name: manual_annotation, Length: 22203, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Developing Ciliated Cells', 'Ciliated Cells', 'Secretory Cells', 'Squamous Cells', 'Goblet Cells', 'T Cells', 'Dendritic Cells', 'Basal Cells', 'Deuterosomal Cells', 'Mitotic Basal Cells', 'Macrophages', 'B Cells', 'Ionocytes', 'Developing Secretory and Goblet Cells', 'Plasmacytoid DCs', 'Enteroendocrine Cells', 'Erythroblasts', 'Mast Cells']
라벨별 그룹 개수 {1: 28, 0: 12}
cell type :  CGAACGGACTCC_Control_Participant12                           Squamous Cells
GTGTCCTGGGGT_Control_Participant12    Developing Secretory and Goblet Cells
ATTTGCCTGTCG_Control_Participant12                             Goblet Cells
TCTCTAAAGTGT_Control_Participant12                           Ciliated Cells
TAGAGACAACGA_Control_Participant12    Developing Secretory and Goblet Cells
                                                      ...                  
TTTCTGCACTGC_COVID19_Participant23                          Secretory Cells
AACGAGTGTGCT_COVID19_Participant23                          Secretory Cells
AGCATCCCACTA_COVID19_Participant23                          Secretory Cells
CACAAACCTGAG_COVID19_Participant23                           Ciliated Cells
ATAGCGAGTAGG_COVID19_Participant23                           Ciliated Cells
Name: manual_annotation, Length: 4744, dtype: string
cell type annotation :  CGAACGGACTCC_Control_Participant12                           Squamous Cells
GTGTCCTGGGGT_Control_Participant12    Developing Secretory and Goblet Cells
ATTTGCCTGTCG_Control_Participant12                             Goblet Cells
TCTCTAAAGTGT_Control_Participant12                           Ciliated Cells
TAGAGACAACGA_Control_Participant12    Developing Secretory and Goblet Cells
                                                      ...                  
TTTCTGCACTGC_COVID19_Participant23                          Secretory Cells
AACGAGTGTGCT_COVID19_Participant23                          Secretory Cells
AGCATCCCACTA_COVID19_Participant23                          Secretory Cells
CACAAACCTGAG_COVID19_Participant23                           Ciliated Cells
ATAGCGAGTAGG_COVID19_Participant23                           Ciliated Cells
Name: manual_annotation, Length: 4744, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Squamous Cells', 'Developing Secretory and Goblet Cells', 'Goblet Cells', 'Ciliated Cells', 'Basal Cells', 'Developing Ciliated Cells', 'Secretory Cells', 'Macrophages', 'Deuterosomal Cells', 'Ionocytes', 'Mitotic Basal Cells', 'Enteroendocrine Cells', 'T Cells', 'Dendritic Cells', 'B Cells', 'Erythroblasts', 'Plasmacytoid DCs', 'Mast Cells']
라벨별 그룹 개수 {1: 7, 0: 3}
🔍 Split #2
  → train_p_index 환자 수 (환자 단위로 묶인 index list): 40
  → test_p_index 환자 수  (환자 단위로 묶인 index list): 10
  → train 환자 ID: ['COVID19_Participant10', 'COVID19_Participant11', 'COVID19_Participant12', 'COVID19_Participant13', 'COVID19_Participant14', 'COVID19_Participant15', 'COVID19_Participant17', 'COVID19_Participant18', 'COVID19_Participant19', 'COVID19_Participant2', 'COVID19_Participant20', 'COVID19_Participant21', 'COVID19_Participant22', 'COVID19_Participant25', 'COVID19_Participant27', 'COVID19_Participant28', 'COVID19_Participant29', 'COVID19_Participant3', 'COVID19_Participant30', 'COVID19_Participant31', 'COVID19_Participant32', 'COVID19_Participant39', 'COVID19_Participant4', 'COVID19_Participant40', 'COVID19_Participant5', 'COVID19_Participant6', 'COVID19_Participant7', 'COVID19_Participant9', 'Control_Participant1', 'Control_Participant10', 'Control_Participant11', 'Control_Participant13', 'Control_Participant14', 'Control_Participant15', 'Control_Participant2', 'Control_Participant5', 'Control_Participant6', 'Control_Participant7', 'Control_Participant8', 'Control_Participant9']
  → test  환자 ID: ['COVID19_Participant23', 'COVID19_Participant26', 'COVID19_Participant35', 'COVID19_Participant36', 'COVID19_Participant37', 'COVID19_Participant38', 'COVID19_Participant8', 'Control_Participant12', 'Control_Participant3', 'Control_Participant4']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant10, Label: 1
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant12, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant18, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant21, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant27, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant3, Label: 1
    ID: COVID19_Participant30, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: COVID19_Participant5, Label: 1
    ID: COVID19_Participant6, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: COVID19_Participant9, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant10, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant13, Label: 0
    ID: Control_Participant14, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant2, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant6, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant8, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant35, Label: 1
    ID: COVID19_Participant36, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant38, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: Control_Participant12, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant4, Label: 0
전체 데이터 index 길이 50
label_stat (train 환자 라벨 목록) 갯수 40
train_data에서 환자 단위로, train과 validation 나누기
기존 train_p_index 40
기존 (train) label_stat 40
train-vali 분할 후! 
train y 의 classes : {0, 1} valid y 의 classes : {0, 1} label_stat 의 classes : {0, 1}
train_p_index_ 26
valid_p_index 14
test_p_index 10
→ train 환자 ID 및 라벨:
   총 개수: 26
   환자ID=Control_Participant10, Label=0, 셀개수=1645
   환자ID=Control_Participant15, Label=0, 셀개수=528
   환자ID=COVID19_Participant17, Label=1, 셀개수=843
   환자ID=COVID19_Participant39, Label=1, 셀개수=454
   환자ID=COVID19_Participant10, Label=1, 셀개수=18
   환자ID=Control_Participant6, Label=0, 셀개수=131
   환자ID=COVID19_Participant13, Label=1, 셀개수=730
   환자ID=COVID19_Participant18, Label=1, 셀개수=227
   환자ID=COVID19_Participant40, Label=1, 셀개수=381
   환자ID=COVID19_Participant12, Label=1, 셀개수=102
   환자ID=COVID19_Participant19, Label=1, 셀개수=816
   환자ID=Control_Participant2, Label=0, 셀개수=41
   환자ID=COVID19_Participant25, Label=1, 셀개수=496
   환자ID=Control_Participant8, Label=0, 셀개수=393
   환자ID=Control_Participant7, Label=0, 셀개수=762
   환자ID=COVID19_Participant14, Label=1, 셀개수=382
   환자ID=Control_Participant9, Label=0, 셀개수=558
   환자ID=Control_Participant11, Label=0, 셀개수=1164
   환자ID=COVID19_Participant20, Label=1, 셀개수=2033
   환자ID=COVID19_Participant29, Label=1, 셀개수=573
   환자ID=COVID19_Participant22, Label=1, 셀개수=865
   환자ID=COVID19_Participant15, Label=1, 셀개수=1003
   환자ID=COVID19_Participant6, Label=1, 셀개수=84
   환자ID=COVID19_Participant4, Label=1, 셀개수=1680
   환자ID=COVID19_Participant32, Label=1, 셀개수=1665
   환자ID=COVID19_Participant28, Label=1, 셀개수=1079
→ valid 환자 ID 및 라벨:
   총 개수: 14
   환자ID=Control_Participant14, Label=0, 셀개수=274
   환자ID=COVID19_Participant27, Label=1, 셀개수=93
   환자ID=COVID19_Participant30, Label=1, 셀개수=116
   환자ID=COVID19_Participant3, Label=1, 셀개수=104
   환자ID=COVID19_Participant5, Label=1, 셀개수=89
   환자ID=COVID19_Participant2, Label=1, 셀개수=329
   환자ID=Control_Participant5, Label=0, 셀개수=717
   환자ID=Control_Participant1, Label=0, 셀개수=414
   환자ID=COVID19_Participant9, Label=1, 셀개수=86
   환자ID=COVID19_Participant7, Label=1, 셀개수=409
   환자ID=Control_Participant13, Label=0, 셀개수=88
   환자ID=COVID19_Participant31, Label=1, 셀개수=410
   환자ID=COVID19_Participant11, Label=1, 셀개수=382
   환자ID=COVID19_Participant21, Label=1, 셀개수=39
→ test 환자 ID 및 라벨:
   총 개수: 10
   환자ID=COVID19_Participant23, Label=1, 셀개수=307
   환자ID=COVID19_Participant26, Label=1, 셀개수=814
   환자ID=COVID19_Participant35, Label=1, 셀개수=83
   환자ID=COVID19_Participant36, Label=1, 셀개수=200
   환자ID=COVID19_Participant37, Label=1, 셀개수=668
   환자ID=COVID19_Participant38, Label=1, 셀개수=51
   환자ID=COVID19_Participant8, Label=1, 셀개수=462
   환자ID=Control_Participant12, Label=0, 셀개수=99
   환자ID=Control_Participant3, Label=0, 셀개수=1620
   환자ID=Control_Participant4, Label=0, 셀개수=440
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Ciliated Cells', 'Developing Ciliated Cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
전체 데이터 길이 26947
전체 cell type 길이 0        Developing Ciliated Cells
1        Developing Ciliated Cells
2        Developing Ciliated Cells
3        Developing Ciliated Cells
4        Developing Ciliated Cells
                   ...            
26942              Secretory Cells
26943              Secretory Cells
26944              Secretory Cells
26945               Ciliated Cells
26946               Ciliated Cells
Length: 26947, dtype: string
cell type의 NaN 개수 체크 0
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:13,  7.40it/s]  2%|▏         | 2/100 [00:00<00:18,  5.28it/s]  4%|▍         | 4/100 [00:00<00:12,  7.67it/s]  6%|▌         | 6/100 [00:01<00:16,  5.72it/s]  7%|▋         | 7/100 [00:01<00:19,  4.82it/s]  8%|▊         | 8/100 [00:01<00:16,  5.59it/s] 10%|█         | 10/100 [00:01<00:13,  6.88it/s] 11%|█         | 11/100 [00:01<00:12,  7.00it/s] 13%|█▎        | 13/100 [00:01<00:11,  7.82it/s] 14%|█▍        | 14/100 [00:02<00:11,  7.79it/s] 15%|█▌        | 15/100 [00:02<00:14,  5.88it/s] 17%|█▋        | 17/100 [00:02<00:12,  6.82it/s] 18%|█▊        | 18/100 [00:02<00:11,  7.33it/s] 19%|█▉        | 19/100 [00:02<00:10,  7.57it/s] 20%|██        | 20/100 [00:02<00:10,  7.62it/s] 21%|██        | 21/100 [00:03<00:09,  8.04it/s] 22%|██▏       | 22/100 [00:03<00:09,  7.87it/s] 23%|██▎       | 23/100 [00:03<00:09,  8.02it/s] 24%|██▍       | 24/100 [00:03<00:10,  7.54it/s] 26%|██▌       | 26/100 [00:03<00:08,  8.48it/s] 27%|██▋       | 27/100 [00:03<00:09,  7.56it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.06it/s] 29%|██▉       | 29/100 [00:04<00:08,  8.24it/s] 30%|███       | 30/100 [00:04<00:10,  6.86it/s] 31%|███       | 31/100 [00:04<00:13,  5.17it/s] 32%|███▏      | 32/100 [00:04<00:11,  5.93it/s] 33%|███▎      | 33/100 [00:04<00:10,  6.59it/s] 34%|███▍      | 34/100 [00:04<00:09,  7.23it/s] 35%|███▌      | 35/100 [00:05<00:08,  7.65it/s] 36%|███▌      | 36/100 [00:05<00:07,  8.18it/s] 37%|███▋      | 37/100 [00:05<00:07,  8.56it/s] 39%|███▉      | 39/100 [00:05<00:06,  8.98it/s] 41%|████      | 41/100 [00:05<00:06,  9.11it/s] 42%|████▏     | 42/100 [00:05<00:07,  8.15it/s] 43%|████▎     | 43/100 [00:05<00:06,  8.45it/s] 44%|████▍     | 44/100 [00:06<00:06,  8.68it/s] 45%|████▌     | 45/100 [00:06<00:06,  8.94it/s] 46%|████▌     | 46/100 [00:06<00:06,  8.87it/s] 47%|████▋     | 47/100 [00:06<00:06,  8.28it/s] 48%|████▊     | 48/100 [00:06<00:06,  7.96it/s] 49%|████▉     | 49/100 [00:06<00:06,  8.43it/s] 50%|█████     | 50/100 [00:06<00:06,  7.83it/s] 51%|█████     | 51/100 [00:06<00:05,  8.29it/s] 52%|█████▏    | 52/100 [00:07<00:06,  7.92it/s] 53%|█████▎    | 53/100 [00:07<00:05,  7.98it/s] 55%|█████▌    | 55/100 [00:07<00:05,  8.58it/s] 57%|█████▋    | 57/100 [00:07<00:05,  8.37it/s] 58%|█████▊    | 58/100 [00:07<00:05,  7.83it/s] 59%|█████▉    | 59/100 [00:07<00:05,  7.17it/s] 60%|██████    | 60/100 [00:08<00:05,  7.71it/s] 61%|██████    | 61/100 [00:08<00:05,  7.31it/s] 62%|██████▏   | 62/100 [00:08<00:04,  7.66it/s] 63%|██████▎   | 63/100 [00:08<00:04,  7.91it/s] 64%|██████▍   | 64/100 [00:08<00:04,  8.00it/s] 65%|██████▌   | 65/100 [00:08<00:04,  8.47it/s] 66%|██████▌   | 66/100 [00:08<00:04,  8.47it/s] 67%|██████▋   | 67/100 [00:08<00:03,  8.71it/s] 68%|██████▊   | 68/100 [00:08<00:03,  9.00it/s] 69%|██████▉   | 69/100 [00:09<00:04,  7.15it/s] 70%|███████   | 70/100 [00:09<00:03,  7.81it/s] 71%|███████   | 71/100 [00:09<00:04,  6.33it/s] 72%|███████▏  | 72/100 [00:09<00:03,  7.02it/s] 74%|███████▍  | 74/100 [00:09<00:03,  7.84it/s] 75%|███████▌  | 75/100 [00:09<00:03,  7.92it/s] 77%|███████▋  | 77/100 [00:10<00:02,  8.23it/s] 78%|███████▊  | 78/100 [00:10<00:02,  8.49it/s] 79%|███████▉  | 79/100 [00:10<00:02,  8.75it/s] 81%|████████  | 81/100 [00:10<00:03,  5.79it/s] 82%|████████▏ | 82/100 [00:11<00:02,  6.34it/s] 83%|████████▎ | 83/100 [00:11<00:02,  6.79it/s] 84%|████████▍ | 84/100 [00:11<00:02,  7.29it/s] 85%|████████▌ | 85/100 [00:11<00:02,  6.17it/s] 86%|████████▌ | 86/100 [00:11<00:02,  5.65it/s] 87%|████████▋ | 87/100 [00:11<00:02,  5.39it/s] 88%|████████▊ | 88/100 [00:12<00:02,  5.57it/s] 89%|████████▉ | 89/100 [00:12<00:01,  5.91it/s] 90%|█████████ | 90/100 [00:12<00:01,  6.68it/s] 91%|█████████ | 91/100 [00:12<00:01,  7.32it/s] 92%|█████████▏| 92/100 [00:12<00:01,  7.47it/s] 94%|█████████▍| 94/100 [00:12<00:00,  8.24it/s] 95%|█████████▌| 95/100 [00:12<00:00,  8.47it/s] 96%|█████████▌| 96/100 [00:12<00:00,  8.80it/s] 97%|█████████▋| 97/100 [00:13<00:00,  8.35it/s] 99%|█████████▉| 99/100 [00:13<00:00,  9.07it/s]100%|██████████| 100/100 [00:13<00:00,  7.62it/s]100%|██████████| 100/100 [00:13<00:00,  7.41it/s]
[I 2025-08-30 07:04:15,745] A new study created in memory with name: no-name-b4e0a053-7bde-4338-aafa-0201f791c639
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 46.00 MB
cuda
Epoch 1, Train Loss 0.674255, Valid_loss 0.657681
Epoch 2, Train Loss 0.654770, Valid_loss 0.626353
Epoch 3, Train Loss 0.617839, Valid_loss 0.607361
Epoch 4, Train Loss 0.619156, Valid_loss 0.601222
Epoch 5, Train Loss 0.568553, Valid_loss 0.576678
Epoch 6, Train Loss 0.536371, Valid_loss 0.564125
Epoch 7, Train Loss 0.523186, Valid_loss 0.542261
Epoch 8, Train Loss 0.507806, Valid_loss 0.530884
Epoch 9, Train Loss 0.495840, Valid_loss 0.519578
Epoch 10, Train Loss 0.484699, Valid_loss 0.512105
Epoch 11, Train Loss 0.487953, Valid_loss 0.500709
Epoch 12, Train Loss 0.481756, Valid_loss 0.493224
Epoch 13, Train Loss 0.472649, Valid_loss 0.488940
Epoch 14, Train Loss 0.467966, Valid_loss 0.487044
Epoch 15, Train Loss 0.444243, Valid_loss 0.474002
Epoch 16, Train Loss 0.443010, Valid_loss 0.471860
Epoch 17, Train Loss 0.447918, Valid_loss 0.466714
Epoch 18, Train Loss 0.442278, Valid_loss 0.450936
Epoch 19, Train Loss 0.462725, Valid_loss 0.472970
Epoch 20, Train Loss 0.440391, Valid_loss 0.456705
Epoch 21, Train Loss 0.449763, Valid_loss 0.453510
Epoch 22, Train Loss 0.424099, Valid_loss 0.433006
Epoch 23, Train Loss 0.431660, Valid_loss 0.441545
Epoch 24, Train Loss 0.434961, Valid_loss 0.436553
Epoch 25, Train Loss 0.436115, Valid_loss 0.428262
Epoch 26, Train Loss 0.421222, Valid_loss 0.432041
Epoch 27, Train Loss 0.431540, Valid_loss 0.438788
Epoch 28, Train Loss 0.427007, Valid_loss 0.433811
Epoch 29, Train Loss 0.441962, Valid_loss 0.433957
Epoch 30, Train Loss 0.425199, Valid_loss 0.427715
Epoch 31, Train Loss 0.403893, Valid_loss 0.413651
Epoch 32, Train Loss 0.411426, Valid_loss 0.434587
Epoch 33, Train Loss 0.423281, Valid_loss 0.417491
Epoch 34, Train Loss 0.415251, Valid_loss 0.409684
Epoch 35, Train Loss 0.427992, Valid_loss 0.415392
Epoch 36, Train Loss 0.416062, Valid_loss 0.418590
Epoch 37, Train Loss 0.422764, Valid_loss 0.418010
Epoch 38, Train Loss 0.407317, Valid_loss 0.406487
Epoch 39, Train Loss 0.413626, Valid_loss 0.408711
Epoch 40, Train Loss 0.416157, Valid_loss 0.397930
Epoch 41, Train Loss 0.392912, Valid_loss 0.392963
Epoch 42, Train Loss 0.396516, Valid_loss 0.396585
Epoch 43, Train Loss 0.413073, Valid_loss 0.403827
Epoch 44, Train Loss 0.383305, Valid_loss 0.407550
Epoch 45, Train Loss 0.397620, Valid_loss 0.395341
Epoch 46, Train Loss 0.402134, Valid_loss 0.419450
Epoch 47, Train Loss 0.398676, Valid_loss 0.387559
Epoch 48, Train Loss 0.389679, Valid_loss 0.413402
Epoch 49, Train Loss 0.378387, Valid_loss 0.411817
Epoch 50, Train Loss 0.395972, Valid_loss 0.385827
Epoch 51, Train Loss 0.403245, Valid_loss 0.393970
Epoch 52, Train Loss 0.409578, Valid_loss 0.389120
Epoch 53, Train Loss 0.389618, Valid_loss 0.405664
Epoch 54, Train Loss 0.404856, Valid_loss 0.399920
Epoch 55, Train Loss 0.394427, Valid_loss 0.388108
Epoch 56, Train Loss 0.392762, Valid_loss 0.407614
Epoch 57, Train Loss 0.379679, Valid_loss 0.402150
Epoch 58, Train Loss 0.399651, Valid_loss 0.394023
Epoch 59, Train Loss 0.380902, Valid_loss 0.392128
Epoch 60, Train Loss 0.381089, Valid_loss 0.403206
Epoch 61, Train Loss 0.398052, Valid_loss 0.381643
Epoch 62, Train Loss 0.415426, Valid_loss 0.359677
Epoch 63, Train Loss 0.396697, Valid_loss 0.392322
Epoch 64, Train Loss 0.392240, Valid_loss 0.387482
Epoch 65, Train Loss 0.385244, Valid_loss 0.363894
Epoch 66, Train Loss 0.368860, Valid_loss 0.372137
Epoch 67, Train Loss 0.380627, Valid_loss 0.367481
Epoch 68, Train Loss 0.370989, Valid_loss 0.368025
Epoch 69, Train Loss 0.377131, Valid_loss 0.373205
[I 2025-08-30 07:09:39,387] Trial 0 finished with value: 0.35967652925423216 and parameters: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 4, 'dropout': 0.3, 'weight_decay': 0.0001, 'emb_dim': 8, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.35967652925423216.
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 26.13 MB
Memory Reserved: 46.00 MB
cuda
Epoch 1, Train Loss 0.660321, Valid_loss 0.607142
Epoch 2, Train Loss 0.655096, Valid_loss 0.606793
Epoch 3, Train Loss 0.635404, Valid_loss 0.600789
Epoch 4, Train Loss 0.644459, Valid_loss 0.605602
Epoch 5, Train Loss 0.645519, Valid_loss 0.617047
Epoch 6, Train Loss 0.637117, Valid_loss 0.589082
Epoch 7, Train Loss 0.529334, Valid_loss 0.435154
Epoch 8, Train Loss 0.492584, Valid_loss 0.506361
Epoch 9, Train Loss 0.376241, Valid_loss 0.235645
Epoch 10, Train Loss 0.339864, Valid_loss 0.304687
Epoch 11, Train Loss 0.329463, Valid_loss 0.287350
Epoch 12, Train Loss 0.295779, Valid_loss 0.255731
Epoch 13, Train Loss 0.299189, Valid_loss 0.319460
Epoch 14, Train Loss 0.289211, Valid_loss 0.277395
Epoch 15, Train Loss 0.291637, Valid_loss 0.253606
Epoch 16, Train Loss 0.276529, Valid_loss 0.246617
Epoch 17, Train Loss 0.264789, Valid_loss 0.264605
Epoch 18, Train Loss 0.260775, Valid_loss 0.465071
Epoch 19, Train Loss 0.254831, Valid_loss 0.280245
Epoch 20, Train Loss 0.252130, Valid_loss 0.361629
Epoch 21, Train Loss 0.266496, Valid_loss 0.261741
Epoch 22, Train Loss 0.258358, Valid_loss 0.270154
Epoch 23, Train Loss 0.254832, Valid_loss 0.311489
Epoch 24, Train Loss 0.252707, Valid_loss 0.298685
Epoch 25, Train Loss 0.255177, Valid_loss 0.337294
Epoch 26, Train Loss 0.251915, Valid_loss 0.329164
Epoch 27, Train Loss 0.257799, Valid_loss 0.325772
Epoch 28, Train Loss 0.239494, Valid_loss 0.308905
Epoch 29, Train Loss 0.212410, Valid_loss 0.307507
Epoch 30, Train Loss 0.222236, Valid_loss 0.413356
Epoch 31, Train Loss 0.220995, Valid_loss 0.315719
Epoch 32, Train Loss 0.219173, Valid_loss 0.319924
Epoch 33, Train Loss 0.221477, Valid_loss 0.367674
Epoch 34, Train Loss 0.212658, Valid_loss 0.318793
Epoch 35, Train Loss 0.225010, Valid_loss 0.306449
Epoch 36, Train Loss 0.299004, Valid_loss 0.330848
Epoch 37, Train Loss 0.277530, Valid_loss 0.330559
Epoch 38, Train Loss 0.253353, Valid_loss 0.338242
Epoch 39, Train Loss 0.274573, Valid_loss 0.304794
Epoch 40, Train Loss 0.302836, Valid_loss 0.510254
Epoch 41, Train Loss 0.253186, Valid_loss 0.296525
Epoch 42, Train Loss 0.251701, Valid_loss 0.304942
Epoch 43, Train Loss 0.248128, Valid_loss 0.306923
Epoch 44, Train Loss 0.223581, Valid_loss 0.305819
Epoch 45, Train Loss 0.238882, Valid_loss 0.306611
Epoch 46, Train Loss 0.221115, Valid_loss 0.310878
Epoch 47, Train Loss 0.236625, Valid_loss 0.322293
Epoch 48, Train Loss 0.249736, Valid_loss 0.302570
Epoch 49, Train Loss 0.222226, Valid_loss 0.338767
Epoch 50, Train Loss 0.234984, Valid_loss 0.345057
Epoch 51, Train Loss 0.217040, Valid_loss 0.309864
Epoch 52, Train Loss 0.222412, Valid_loss 0.317039
Epoch 53, Train Loss 0.216787, Valid_loss 0.341722
[I 2025-08-30 07:13:16,583] Trial 1 finished with value: 0.23564461804926395 and parameters: {'learning_rate': 0.01, 'epochs': 100, 'heads': 2, 'dropout': 0.3, 'weight_decay': 0.001, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 1 with value: 0.23564461804926395.
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 27.97 MB
Memory Reserved: 46.00 MB
cuda
Epoch 1, Train Loss 0.625712, Valid_loss 0.526120
Epoch 2, Train Loss 0.492851, Valid_loss 0.469873
Epoch 3, Train Loss 0.417639, Valid_loss 0.854578
Epoch 4, Train Loss 0.429933, Valid_loss 0.425981
Epoch 5, Train Loss 0.399335, Valid_loss 0.343936
Epoch 6, Train Loss 0.344090, Valid_loss 0.320380
Epoch 7, Train Loss 0.324816, Valid_loss 0.376373
Epoch 8, Train Loss 0.304313, Valid_loss 0.449331
Epoch 9, Train Loss 0.298264, Valid_loss 0.394977
Epoch 10, Train Loss 0.272821, Valid_loss 0.332889
Epoch 11, Train Loss 0.290782, Valid_loss 0.302576
Epoch 12, Train Loss 0.283024, Valid_loss 0.332194
Epoch 13, Train Loss 0.268230, Valid_loss 0.315849
Epoch 14, Train Loss 0.288689, Valid_loss 0.294058
Epoch 15, Train Loss 0.266612, Valid_loss 0.286756
Epoch 16, Train Loss 0.270650, Valid_loss 0.342756
Epoch 17, Train Loss 0.271775, Valid_loss 0.339623
Epoch 18, Train Loss 0.263868, Valid_loss 0.338289
Epoch 19, Train Loss 0.247314, Valid_loss 0.353568
Epoch 20, Train Loss 0.260570, Valid_loss 0.338902
Epoch 21, Train Loss 0.257214, Valid_loss 0.385615
Epoch 22, Train Loss 0.267375, Valid_loss 0.355760
Epoch 23, Train Loss 0.270081, Valid_loss 0.348762
Epoch 24, Train Loss 0.245995, Valid_loss 0.353763
Epoch 25, Train Loss 0.257327, Valid_loss 0.344283
Epoch 26, Train Loss 0.257303, Valid_loss 0.326260
Epoch 27, Train Loss 0.256910, Valid_loss 0.344175
Epoch 28, Train Loss 0.248195, Valid_loss 0.375242
Epoch 29, Train Loss 0.251205, Valid_loss 0.381388
Epoch 30, Train Loss 0.246873, Valid_loss 0.344498
Epoch 31, Train Loss 0.227947, Valid_loss 0.390401
Epoch 32, Train Loss 0.236633, Valid_loss 0.356833
Epoch 33, Train Loss 0.235642, Valid_loss 0.359673
Epoch 34, Train Loss 0.239038, Valid_loss 0.362469
Epoch 35, Train Loss 0.239682, Valid_loss 0.357331
Epoch 36, Train Loss 0.242981, Valid_loss 0.466766
Epoch 37, Train Loss 0.244377, Valid_loss 0.398062
Epoch 38, Train Loss 0.248125, Valid_loss 0.403566
Epoch 39, Train Loss 0.231173, Valid_loss 0.359478
Epoch 40, Train Loss 0.227097, Valid_loss 0.387825
Epoch 41, Train Loss 0.258624, Valid_loss 0.409368
Epoch 42, Train Loss 0.232454, Valid_loss 0.393119
Epoch 43, Train Loss 0.224868, Valid_loss 0.451728
Epoch 44, Train Loss 0.229203, Valid_loss 0.396811
Epoch 45, Train Loss 0.235466, Valid_loss 0.439207
Epoch 46, Train Loss 0.232209, Valid_loss 0.451781
Epoch 47, Train Loss 0.231915, Valid_loss 0.403020
Epoch 48, Train Loss 0.218073, Valid_loss 0.448241
Epoch 49, Train Loss 0.207623, Valid_loss 0.440554
Epoch 50, Train Loss 0.214581, Valid_loss 0.420480
Epoch 51, Train Loss 0.219384, Valid_loss 0.440406
Epoch 52, Train Loss 0.213759, Valid_loss 0.472266
[I 2025-08-30 07:16:50,539] Trial 2 finished with value: 0.2867555881717375 and parameters: {'learning_rate': 0.001, 'epochs': 100, 'heads': 2, 'dropout': 0.7, 'weight_decay': 0.0001, 'emb_dim': 64, 'augment_num': 100, 'pca': False}. Best is trial 1 with value: 0.23564461804926395.
선택된 trial params: {'learning_rate': 0.01, 'epochs': 100, 'heads': 2, 'dropout': 0.3, 'weight_decay': 0.001, 'emb_dim': 32, 'augment_num': 100, 'pca': False}
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=10, batch_size=1 -> steps=10
output_class :  1
Memory Allocated: 26.13 MB
Memory Reserved: 46.00 MB
cuda
Epoch 1, Train Loss 0.673320, Valid_loss 0.602245
Epoch 2, Train Loss 0.663194, Valid_loss 0.601947
Epoch 3, Train Loss 0.659775, Valid_loss 0.598808
Epoch 4, Train Loss 0.640166, Valid_loss 0.624704
Epoch 5, Train Loss 0.634769, Valid_loss 0.606259
Epoch 6, Train Loss 0.633609, Valid_loss 0.602765
Epoch 7, Train Loss 0.647636, Valid_loss 0.596844
Epoch 8, Train Loss 0.625848, Valid_loss 0.579407
Epoch 9, Train Loss 0.517528, Valid_loss 0.844473
Epoch 10, Train Loss 0.480534, Valid_loss 0.494783
Epoch 11, Train Loss 0.479241, Valid_loss 0.430010
Epoch 12, Train Loss 0.388601, Valid_loss 0.343903
Epoch 13, Train Loss 0.364624, Valid_loss 0.490782
Epoch 14, Train Loss 0.368935, Valid_loss 0.420381
Epoch 15, Train Loss 0.309746, Valid_loss 0.414574
Epoch 16, Train Loss 0.308011, Valid_loss 0.394228
Epoch 17, Train Loss 0.299975, Valid_loss 0.259313
Epoch 18, Train Loss 0.281322, Valid_loss 0.304245
Epoch 19, Train Loss 0.294469, Valid_loss 0.369069
Epoch 20, Train Loss 0.258928, Valid_loss 0.225533
Epoch 21, Train Loss 0.246764, Valid_loss 0.250068
Epoch 22, Train Loss 0.239871, Valid_loss 0.263797
Epoch 23, Train Loss 0.264063, Valid_loss 0.257435
Epoch 24, Train Loss 0.245865, Valid_loss 0.301287
Epoch 25, Train Loss 0.296736, Valid_loss 0.373297
Epoch 26, Train Loss 0.300418, Valid_loss 0.261528
Epoch 27, Train Loss 0.252916, Valid_loss 0.336088
Epoch 28, Train Loss 0.260129, Valid_loss 0.353410
Epoch 29, Train Loss 0.236814, Valid_loss 0.336894
Epoch 30, Train Loss 0.233142, Valid_loss 0.304715
Epoch 31, Train Loss 0.254417, Valid_loss 0.296004
Epoch 32, Train Loss 0.222819, Valid_loss 0.251939
Epoch 33, Train Loss 0.243732, Valid_loss 0.302426
Epoch 34, Train Loss 0.248740, Valid_loss 0.287249
Epoch 35, Train Loss 0.245789, Valid_loss 0.295258
Epoch 36, Train Loss 0.231607, Valid_loss 0.328004
Epoch 37, Train Loss 0.229291, Valid_loss 0.332340
Epoch 38, Train Loss 0.255269, Valid_loss 0.307193
Epoch 39, Train Loss 0.235371, Valid_loss 0.340802
Epoch 40, Train Loss 0.243686, Valid_loss 0.369001
Epoch 41, Train Loss 0.224849, Valid_loss 0.318197
Epoch 42, Train Loss 0.217531, Valid_loss 0.302301
Epoch 43, Train Loss 0.210060, Valid_loss 0.314351
Epoch 44, Train Loss 0.246785, Valid_loss 0.309603
Epoch 45, Train Loss 0.220625, Valid_loss 0.308324
Epoch 46, Train Loss 0.241490, Valid_loss 0.307210
Epoch 47, Train Loss 0.287573, Valid_loss 0.280673
Epoch 48, Train Loss 0.233254, Valid_loss 0.314018
Epoch 49, Train Loss 0.237459, Valid_loss 0.315801
Epoch 50, Train Loss 0.234805, Valid_loss 0.370348
Epoch 51, Train Loss 0.242946, Valid_loss 0.302011
Epoch 52, Train Loss 0.232200, Valid_loss 0.285564
Epoch 53, Train Loss 0.208371, Valid_loss 0.313171
Epoch 54, Train Loss 0.228020, Valid_loss 0.281273
Epoch 55, Train Loss 0.213684, Valid_loss 0.295524
Epoch 56, Train Loss 0.215764, Valid_loss 0.287838
Epoch 57, Train Loss 0.216358, Valid_loss 0.325753
Epoch 58, Train Loss 0.208721, Valid_loss 0.283938
Epoch 59, Train Loss 0.220681, Valid_loss 0.304704
Epoch 60, Train Loss 0.220750, Valid_loss 0.299765
Epoch 61, Train Loss 0.237073, Valid_loss 0.298446
Epoch 62, Train Loss 0.227990, Valid_loss 0.306275
Epoch 63, Train Loss 0.235079, Valid_loss 0.289824
Epoch 64, Train Loss 0.219106, Valid_loss 0.315021
Epoch 65, Train Loss 0.215314, Valid_loss 0.313388
Epoch 66, Train Loss 0.223204, Valid_loss 0.346400
Epoch 67, Train Loss 0.229509, Valid_loss 0.307672
Epoch 68, Train Loss 0.206497, Valid_loss 0.304401
Epoch 69, Train Loss 0.220434, Valid_loss 0.300254
Epoch 70, Train Loss 0.220232, Valid_loss 0.293813
Epoch 71, Train Loss 0.225612, Valid_loss 0.278456
Epoch 72, Train Loss 0.219992, Valid_loss 0.323073
Epoch 73, Train Loss 0.222731, Valid_loss 0.308889
Epoch 74, Train Loss 0.212848, Valid_loss 0.307212
Epoch 75, Train Loss 0.213259, Valid_loss 0.298000
Epoch 76, Train Loss 0.214219, Valid_loss 0.316358
Epoch 77, Train Loss 0.209195, Valid_loss 0.319563
환자ID=COVID19_Participant23 -- true: 1 -- pred: 1
환자ID=COVID19_Participant26 -- true: 1 -- pred: 1
환자ID=COVID19_Participant35 -- true: 1 -- pred: 0
환자ID=COVID19_Participant36 -- true: 1 -- pred: 1
환자ID=COVID19_Participant37 -- true: 1 -- pred: 1
환자ID=COVID19_Participant38 -- true: 1 -- pred: 0
환자ID=COVID19_Participant8 -- true: 1 -- pred: 1
환자ID=Control_Participant12 -- true: 0 -- pred: 0
환자ID=Control_Participant3 -- true: 0 -- pred: 0
환자ID=Control_Participant4 -- true: 0 -- pred: 0
Best performance: Epoch 20, Loss 0.258928, Test ACC 0.800000, Test AUC 0.904762, Test Recall 0.714286, Test Precision 1.000000
Confusion Matrix:
 [3 0 2 5]
✅ Total valid splits used: 2
🔁 Repeat 2, Fold 2
cell type :  GTCGGGGGGTGG_Control_Participant7     Developing Ciliated Cells
CAAATCAATTAT_Control_Participant7     Developing Ciliated Cells
ATACAATTGACA_Control_Participant7     Developing Ciliated Cells
CTGTTAATGAGA_Control_Participant7     Developing Ciliated Cells
CTTCACATTATT_Control_Participant7     Developing Ciliated Cells
                                                ...            
GCAGGGAACTCC_COVID19_Participant30               Squamous Cells
CAGCACCGAGCC_COVID19_Participant30               Squamous Cells
GCCCCTTGTGAT_COVID19_Participant30               Squamous Cells
GTGTTGTGTGTC_COVID19_Participant30               Squamous Cells
TAACACTCACTT_COVID19_Participant30               Squamous Cells
Name: manual_annotation, Length: 21042, dtype: string
cell type annotation :  GTCGGGGGGTGG_Control_Participant7     Developing Ciliated Cells
CAAATCAATTAT_Control_Participant7     Developing Ciliated Cells
ATACAATTGACA_Control_Participant7     Developing Ciliated Cells
CTGTTAATGAGA_Control_Participant7     Developing Ciliated Cells
CTTCACATTATT_Control_Participant7     Developing Ciliated Cells
                                                ...            
GCAGGGAACTCC_COVID19_Participant30               Squamous Cells
CAGCACCGAGCC_COVID19_Participant30               Squamous Cells
GCCCCTTGTGAT_COVID19_Participant30               Squamous Cells
GTGTTGTGTGTC_COVID19_Participant30               Squamous Cells
TAACACTCACTT_COVID19_Participant30               Squamous Cells
Name: manual_annotation, Length: 21042, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Developing Ciliated Cells', 'Ciliated Cells', 'Secretory Cells', 'Squamous Cells', 'Goblet Cells', 'T Cells', 'Dendritic Cells', 'Basal Cells', 'Deuterosomal Cells', 'Mitotic Basal Cells', 'Macrophages', 'B Cells', 'Ionocytes', 'Developing Secretory and Goblet Cells', 'Plasmacytoid DCs', 'Enteroendocrine Cells', 'Erythroblasts', 'Mast Cells']
라벨별 그룹 개수 {1: 28, 0: 12}
cell type :  TGGGATTACAGG_Control_Participant2        Enteroendocrine Cells
TCTGTGCTTGAG_Control_Participant2               Ciliated Cells
TCTACACCCTGA_Control_Participant2           Deuterosomal Cells
AGCCCTCGTCAT_Control_Participant2               Squamous Cells
TCGAGCAAGCTT_Control_Participant2                  Basal Cells
                                               ...            
GTGTCGCGCCTG_Control_Participant6               Ciliated Cells
TGGAATTATGAT_Control_Participant6               Ciliated Cells
TAGTCGAGACGT_Control_Participant6               Ciliated Cells
CTCCAGTGGCAC_Control_Participant6    Developing Ciliated Cells
GAATAGACGACA_Control_Participant6               Ciliated Cells
Name: manual_annotation, Length: 5905, dtype: string
cell type annotation :  TGGGATTACAGG_Control_Participant2        Enteroendocrine Cells
TCTGTGCTTGAG_Control_Participant2               Ciliated Cells
TCTACACCCTGA_Control_Participant2           Deuterosomal Cells
AGCCCTCGTCAT_Control_Participant2               Squamous Cells
TCGAGCAAGCTT_Control_Participant2                  Basal Cells
                                               ...            
GTGTCGCGCCTG_Control_Participant6               Ciliated Cells
TGGAATTATGAT_Control_Participant6               Ciliated Cells
TAGTCGAGACGT_Control_Participant6               Ciliated Cells
CTCCAGTGGCAC_Control_Participant6    Developing Ciliated Cells
GAATAGACGACA_Control_Participant6               Ciliated Cells
Name: manual_annotation, Length: 5905, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Enteroendocrine Cells', 'Ciliated Cells', 'Deuterosomal Cells', 'Squamous Cells', 'Basal Cells', 'Mitotic Basal Cells', 'Developing Secretory and Goblet Cells', 'Goblet Cells', 'Secretory Cells', 'Developing Ciliated Cells', 'Macrophages', 'Ionocytes', 'T Cells', 'B Cells', 'Mast Cells', 'Dendritic Cells', 'Erythroblasts', 'Plasmacytoid DCs']
라벨별 그룹 개수 {1: 7, 0: 3}
🔍 Split #3
  → train_p_index 환자 수 (환자 단위로 묶인 index list): 40
  → test_p_index 환자 수  (환자 단위로 묶인 index list): 10
  → train 환자 ID: ['COVID19_Participant10', 'COVID19_Participant11', 'COVID19_Participant12', 'COVID19_Participant13', 'COVID19_Participant14', 'COVID19_Participant18', 'COVID19_Participant19', 'COVID19_Participant2', 'COVID19_Participant20', 'COVID19_Participant21', 'COVID19_Participant23', 'COVID19_Participant25', 'COVID19_Participant26', 'COVID19_Participant27', 'COVID19_Participant29', 'COVID19_Participant30', 'COVID19_Participant31', 'COVID19_Participant35', 'COVID19_Participant36', 'COVID19_Participant37', 'COVID19_Participant38', 'COVID19_Participant39', 'COVID19_Participant4', 'COVID19_Participant40', 'COVID19_Participant5', 'COVID19_Participant6', 'COVID19_Participant7', 'COVID19_Participant8', 'Control_Participant1', 'Control_Participant10', 'Control_Participant11', 'Control_Participant12', 'Control_Participant14', 'Control_Participant15', 'Control_Participant3', 'Control_Participant4', 'Control_Participant5', 'Control_Participant7', 'Control_Participant8', 'Control_Participant9']
  → test  환자 ID: ['COVID19_Participant15', 'COVID19_Participant17', 'COVID19_Participant22', 'COVID19_Participant28', 'COVID19_Participant3', 'COVID19_Participant32', 'COVID19_Participant9', 'Control_Participant13', 'Control_Participant2', 'Control_Participant6']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant10, Label: 1
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant12, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant18, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant21, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant27, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant30, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant35, Label: 1
    ID: COVID19_Participant36, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant38, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: COVID19_Participant5, Label: 1
    ID: COVID19_Participant6, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant10, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant12, Label: 0
    ID: Control_Participant14, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant4, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant8, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant3, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant9, Label: 1
    ID: Control_Participant13, Label: 0
    ID: Control_Participant2, Label: 0
    ID: Control_Participant6, Label: 0
전체 데이터 index 길이 50
label_stat (train 환자 라벨 목록) 갯수 40
train_data에서 환자 단위로, train과 validation 나누기
기존 train_p_index 40
기존 (train) label_stat 40
train-vali 분할 후! 
train y 의 classes : {0, 1} valid y 의 classes : {0, 1} label_stat 의 classes : {0, 1}
train_p_index_ 26
valid_p_index 14
test_p_index 10
→ train 환자 ID 및 라벨:
   총 개수: 26
   환자ID=Control_Participant10, Label=0, 셀개수=1645
   환자ID=Control_Participant15, Label=0, 셀개수=528
   환자ID=COVID19_Participant19, Label=1, 셀개수=816
   환자ID=COVID19_Participant39, Label=1, 셀개수=454
   환자ID=COVID19_Participant10, Label=1, 셀개수=18
   환자ID=Control_Participant5, Label=0, 셀개수=717
   환자ID=COVID19_Participant13, Label=1, 셀개수=730
   환자ID=COVID19_Participant2, Label=1, 셀개수=329
   환자ID=COVID19_Participant40, Label=1, 셀개수=381
   환자ID=COVID19_Participant12, Label=1, 셀개수=102
   환자ID=COVID19_Participant20, Label=1, 셀개수=2033
   환자ID=Control_Participant3, Label=0, 셀개수=1620
   환자ID=COVID19_Participant27, Label=1, 셀개수=93
   환자ID=Control_Participant8, Label=0, 셀개수=393
   환자ID=Control_Participant7, Label=0, 셀개수=762
   환자ID=COVID19_Participant14, Label=1, 셀개수=382
   환자ID=Control_Participant9, Label=0, 셀개수=558
   환자ID=Control_Participant11, Label=0, 셀개수=1164
   환자ID=COVID19_Participant23, Label=1, 셀개수=307
   환자ID=COVID19_Participant31, Label=1, 셀개수=410
   환자ID=COVID19_Participant26, Label=1, 셀개수=814
   환자ID=COVID19_Participant18, Label=1, 셀개수=227
   환자ID=COVID19_Participant6, Label=1, 셀개수=84
   환자ID=COVID19_Participant4, Label=1, 셀개수=1680
   환자ID=COVID19_Participant38, Label=1, 셀개수=51
   환자ID=COVID19_Participant30, Label=1, 셀개수=116
→ valid 환자 ID 및 라벨:
   총 개수: 14
   환자ID=Control_Participant14, Label=0, 셀개수=274
   환자ID=COVID19_Participant29, Label=1, 셀개수=573
   환자ID=COVID19_Participant36, Label=1, 셀개수=200
   환자ID=COVID19_Participant35, Label=1, 셀개수=83
   환자ID=COVID19_Participant5, Label=1, 셀개수=89
   환자ID=COVID19_Participant21, Label=1, 셀개수=39
   환자ID=Control_Participant4, Label=0, 셀개수=440
   환자ID=Control_Participant1, Label=0, 셀개수=414
   환자ID=COVID19_Participant8, Label=1, 셀개수=462
   환자ID=COVID19_Participant7, Label=1, 셀개수=409
   환자ID=Control_Participant12, Label=0, 셀개수=99
   환자ID=COVID19_Participant37, Label=1, 셀개수=668
   환자ID=COVID19_Participant11, Label=1, 셀개수=382
   환자ID=COVID19_Participant25, Label=1, 셀개수=496
→ test 환자 ID 및 라벨:
   총 개수: 10
   환자ID=COVID19_Participant15, Label=1, 셀개수=1003
   환자ID=COVID19_Participant17, Label=1, 셀개수=843
   환자ID=COVID19_Participant22, Label=1, 셀개수=865
   환자ID=COVID19_Participant28, Label=1, 셀개수=1079
   환자ID=COVID19_Participant3, Label=1, 셀개수=104
   환자ID=COVID19_Participant32, Label=1, 셀개수=1665
   환자ID=COVID19_Participant9, Label=1, 셀개수=86
   환자ID=Control_Participant13, Label=0, 셀개수=88
   환자ID=Control_Participant2, Label=0, 셀개수=41
   환자ID=Control_Participant6, Label=0, 셀개수=131
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Ciliated Cells', 'Developing Ciliated Cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
전체 데이터 길이 26947
전체 cell type 길이 0        Developing Ciliated Cells
1        Developing Ciliated Cells
2        Developing Ciliated Cells
3        Developing Ciliated Cells
4        Developing Ciliated Cells
                   ...            
26942               Ciliated Cells
26943               Ciliated Cells
26944               Ciliated Cells
26945    Developing Ciliated Cells
26946               Ciliated Cells
Length: 26947, dtype: string
cell type의 NaN 개수 체크 0
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:26,  3.77it/s]  2%|▏         | 2/100 [00:00<00:16,  5.92it/s]  3%|▎         | 3/100 [00:00<00:13,  7.13it/s]  4%|▍         | 4/100 [00:00<00:12,  7.75it/s]  5%|▌         | 5/100 [00:00<00:11,  8.01it/s]  7%|▋         | 7/100 [00:00<00:11,  8.28it/s]  8%|▊         | 8/100 [00:01<00:10,  8.55it/s]  9%|▉         | 9/100 [00:01<00:10,  8.70it/s] 10%|█         | 10/100 [00:01<00:10,  8.87it/s] 11%|█         | 11/100 [00:01<00:10,  8.43it/s] 12%|█▏        | 12/100 [00:01<00:10,  8.21it/s] 13%|█▎        | 13/100 [00:01<00:10,  8.52it/s] 14%|█▍        | 14/100 [00:01<00:10,  8.59it/s] 16%|█▌        | 16/100 [00:01<00:09,  9.27it/s] 18%|█▊        | 18/100 [00:02<00:08,  9.50it/s] 19%|█▉        | 19/100 [00:02<00:08,  9.49it/s] 20%|██        | 20/100 [00:02<00:08,  9.39it/s] 22%|██▏       | 22/100 [00:02<00:08,  9.56it/s] 23%|██▎       | 23/100 [00:02<00:10,  7.55it/s] 25%|██▌       | 25/100 [00:02<00:08,  8.42it/s] 27%|██▋       | 27/100 [00:03<00:08,  8.93it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.42it/s] 29%|██▉       | 29/100 [00:03<00:08,  8.63it/s] 30%|███       | 30/100 [00:03<00:10,  6.49it/s] 31%|███       | 31/100 [00:03<00:10,  6.81it/s] 32%|███▏      | 32/100 [00:03<00:09,  7.41it/s] 33%|███▎      | 33/100 [00:04<00:10,  6.53it/s] 34%|███▍      | 34/100 [00:04<00:09,  7.20it/s] 35%|███▌      | 35/100 [00:04<00:08,  7.69it/s] 37%|███▋      | 37/100 [00:04<00:07,  8.71it/s] 38%|███▊      | 38/100 [00:04<00:07,  8.82it/s] 39%|███▉      | 39/100 [00:04<00:06,  9.00it/s] 40%|████      | 40/100 [00:04<00:07,  8.25it/s] 41%|████      | 41/100 [00:05<00:07,  8.06it/s] 42%|████▏     | 42/100 [00:05<00:08,  7.24it/s] 44%|████▍     | 44/100 [00:05<00:06,  8.43it/s] 45%|████▌     | 45/100 [00:05<00:06,  8.70it/s] 46%|████▌     | 46/100 [00:05<00:06,  8.84it/s] 47%|████▋     | 47/100 [00:05<00:06,  8.49it/s] 48%|████▊     | 48/100 [00:05<00:06,  8.43it/s] 49%|████▉     | 49/100 [00:05<00:06,  8.49it/s] 50%|█████     | 50/100 [00:06<00:05,  8.83it/s] 51%|█████     | 51/100 [00:06<00:05,  9.11it/s] 53%|█████▎    | 53/100 [00:06<00:04,  9.45it/s] 54%|█████▍    | 54/100 [00:06<00:04,  9.27it/s] 55%|█████▌    | 55/100 [00:06<00:04,  9.33it/s] 56%|█████▌    | 56/100 [00:06<00:04,  9.48it/s] 57%|█████▋    | 57/100 [00:06<00:04,  8.80it/s] 58%|█████▊    | 58/100 [00:06<00:04,  8.87it/s] 60%|██████    | 60/100 [00:07<00:04,  8.64it/s] 61%|██████    | 61/100 [00:07<00:04,  7.82it/s] 62%|██████▏   | 62/100 [00:07<00:04,  8.01it/s] 63%|██████▎   | 63/100 [00:07<00:04,  8.27it/s] 64%|██████▍   | 64/100 [00:07<00:04,  8.39it/s] 65%|██████▌   | 65/100 [00:07<00:04,  8.42it/s] 66%|██████▌   | 66/100 [00:08<00:06,  4.99it/s] 67%|██████▋   | 67/100 [00:08<00:05,  5.82it/s] 68%|██████▊   | 68/100 [00:08<00:05,  6.16it/s] 69%|██████▉   | 69/100 [00:08<00:04,  6.50it/s] 70%|███████   | 70/100 [00:08<00:04,  7.21it/s] 72%|███████▏  | 72/100 [00:09<00:05,  5.52it/s] 73%|███████▎  | 73/100 [00:09<00:05,  5.03it/s] 74%|███████▍  | 74/100 [00:09<00:04,  5.58it/s] 75%|███████▌  | 75/100 [00:09<00:04,  6.24it/s] 76%|███████▌  | 76/100 [00:09<00:03,  6.81it/s] 77%|███████▋  | 77/100 [00:09<00:03,  6.55it/s] 78%|███████▊  | 78/100 [00:10<00:03,  7.08it/s] 79%|███████▉  | 79/100 [00:10<00:02,  7.67it/s] 80%|████████  | 80/100 [00:10<00:02,  8.00it/s] 81%|████████  | 81/100 [00:10<00:02,  7.91it/s] 82%|████████▏ | 82/100 [00:10<00:02,  6.75it/s] 83%|████████▎ | 83/100 [00:10<00:02,  6.91it/s] 84%|████████▍ | 84/100 [00:10<00:02,  7.50it/s] 85%|████████▌ | 85/100 [00:11<00:02,  6.61it/s] 86%|████████▌ | 86/100 [00:11<00:01,  7.33it/s] 87%|████████▋ | 87/100 [00:11<00:01,  6.98it/s] 88%|████████▊ | 88/100 [00:11<00:01,  7.54it/s] 89%|████████▉ | 89/100 [00:11<00:01,  6.96it/s] 90%|█████████ | 90/100 [00:11<00:01,  6.96it/s] 91%|█████████ | 91/100 [00:11<00:01,  7.16it/s] 92%|█████████▏| 92/100 [00:11<00:01,  6.87it/s] 93%|█████████▎| 93/100 [00:12<00:00,  7.34it/s] 94%|█████████▍| 94/100 [00:12<00:00,  6.54it/s] 95%|█████████▌| 95/100 [00:12<00:00,  6.56it/s] 96%|█████████▌| 96/100 [00:12<00:00,  7.29it/s] 97%|█████████▋| 97/100 [00:12<00:00,  7.90it/s] 98%|█████████▊| 98/100 [00:12<00:00,  5.79it/s] 99%|█████████▉| 99/100 [00:13<00:00,  5.96it/s]100%|██████████| 100/100 [00:13<00:00,  6.62it/s]100%|██████████| 100/100 [00:13<00:00,  7.58it/s]
[I 2025-08-30 07:22:20,689] A new study created in memory with name: no-name-b0b6f7d0-c6cf-465c-bd3e-e7e5ed171a90
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 27.97 MB
Memory Reserved: 46.00 MB
cuda
Epoch 1, Train Loss 0.707914, Valid_loss 0.557078
Epoch 2, Train Loss 0.576558, Valid_loss 0.543744
Epoch 3, Train Loss 0.584522, Valid_loss 0.512447
Epoch 4, Train Loss 0.555047, Valid_loss 0.472661
Epoch 5, Train Loss 0.496693, Valid_loss 0.461690
Epoch 6, Train Loss 0.473795, Valid_loss 0.437130
Epoch 7, Train Loss 0.435260, Valid_loss 0.426065
Epoch 8, Train Loss 0.388812, Valid_loss 0.424087
Epoch 9, Train Loss 0.392321, Valid_loss 0.399798
Epoch 10, Train Loss 0.369070, Valid_loss 0.405113
Epoch 11, Train Loss 0.358605, Valid_loss 0.395360
Epoch 12, Train Loss 0.337496, Valid_loss 0.388388
Epoch 13, Train Loss 0.343887, Valid_loss 0.393328
Epoch 14, Train Loss 0.328087, Valid_loss 0.372906
Epoch 15, Train Loss 0.358141, Valid_loss 0.375274
Epoch 16, Train Loss 0.340103, Valid_loss 0.371720
Epoch 17, Train Loss 0.330074, Valid_loss 0.369081
Epoch 18, Train Loss 0.336585, Valid_loss 0.393332
Epoch 19, Train Loss 0.354375, Valid_loss 0.364718
Epoch 20, Train Loss 0.347608, Valid_loss 0.381216
Epoch 21, Train Loss 0.328428, Valid_loss 0.375733
Epoch 22, Train Loss 0.314650, Valid_loss 0.409701
Epoch 23, Train Loss 0.314775, Valid_loss 0.364825
Epoch 24, Train Loss 0.318869, Valid_loss 0.376711
Epoch 25, Train Loss 0.325679, Valid_loss 0.359858
Epoch 26, Train Loss 0.300760, Valid_loss 0.360799
Epoch 27, Train Loss 0.287665, Valid_loss 0.369997
Epoch 28, Train Loss 0.307153, Valid_loss 0.366498
Epoch 29, Train Loss 0.310275, Valid_loss 0.366833
Epoch 30, Train Loss 0.312982, Valid_loss 0.352199
Epoch 31, Train Loss 0.289320, Valid_loss 0.349944
Epoch 32, Train Loss 0.284919, Valid_loss 0.345872
Epoch 33, Train Loss 0.284240, Valid_loss 0.349268
Epoch 34, Train Loss 0.283393, Valid_loss 0.356527
Epoch 35, Train Loss 0.290659, Valid_loss 0.349533
Epoch 36, Train Loss 0.272063, Valid_loss 0.353463
Epoch 37, Train Loss 0.305420, Valid_loss 0.350577
Epoch 38, Train Loss 0.267107, Valid_loss 0.379085
Epoch 39, Train Loss 0.288869, Valid_loss 0.344763
Epoch 40, Train Loss 0.273894, Valid_loss 0.353582
Epoch 41, Train Loss 0.280902, Valid_loss 0.351660
Epoch 42, Train Loss 0.285781, Valid_loss 0.342248
Epoch 43, Train Loss 0.286887, Valid_loss 0.340493
Epoch 44, Train Loss 0.267424, Valid_loss 0.341052
Epoch 45, Train Loss 0.284923, Valid_loss 0.336404
Epoch 46, Train Loss 0.281677, Valid_loss 0.352089
Epoch 47, Train Loss 0.266293, Valid_loss 0.348103
Epoch 48, Train Loss 0.245731, Valid_loss 0.350124
Epoch 49, Train Loss 0.253894, Valid_loss 0.370949
Epoch 50, Train Loss 0.260232, Valid_loss 0.353679
Epoch 51, Train Loss 0.254305, Valid_loss 0.351968
Epoch 52, Train Loss 0.251783, Valid_loss 0.346837
Epoch 53, Train Loss 0.254100, Valid_loss 0.350674
Epoch 54, Train Loss 0.260953, Valid_loss 0.347572
Epoch 55, Train Loss 0.268700, Valid_loss 0.350766
Epoch 56, Train Loss 0.247166, Valid_loss 0.345802
Epoch 57, Train Loss 0.267651, Valid_loss 0.359345
Epoch 58, Train Loss 0.254732, Valid_loss 0.344625
Epoch 59, Train Loss 0.256872, Valid_loss 0.364827
Epoch 60, Train Loss 0.278103, Valid_loss 0.360716
Epoch 61, Train Loss 0.258209, Valid_loss 0.358510
Epoch 62, Train Loss 0.256163, Valid_loss 0.363284
Epoch 63, Train Loss 0.300246, Valid_loss 0.359893
Epoch 64, Train Loss 0.243141, Valid_loss 0.370024
Epoch 65, Train Loss 0.246968, Valid_loss 0.353481
Epoch 66, Train Loss 0.250179, Valid_loss 0.380062
Epoch 67, Train Loss 0.251150, Valid_loss 0.361456
Epoch 68, Train Loss 0.243916, Valid_loss 0.353105
Epoch 69, Train Loss 0.246464, Valid_loss 0.373456
Epoch 70, Train Loss 0.258628, Valid_loss 0.363483
Epoch 71, Train Loss 0.246836, Valid_loss 0.361285
Epoch 72, Train Loss 0.242384, Valid_loss 0.356857
Epoch 73, Train Loss 0.263046, Valid_loss 0.363899
Epoch 74, Train Loss 0.263679, Valid_loss 0.366780
[I 2025-08-30 07:27:26,073] Trial 0 finished with value: 0.33640363679400515 and parameters: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 2, 'dropout': 0.7, 'weight_decay': 0.001, 'emb_dim': 64, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.33640363679400515.
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 46.00 MB
cuda
Epoch 1, Train Loss 0.720701, Valid_loss 0.602880
Epoch 2, Train Loss 0.630394, Valid_loss 0.572530
Epoch 3, Train Loss 0.566362, Valid_loss 0.537568
Epoch 4, Train Loss 0.501029, Valid_loss 0.433074
Epoch 5, Train Loss 0.391769, Valid_loss 0.406458
Epoch 6, Train Loss 0.354468, Valid_loss 0.324217
Epoch 7, Train Loss 0.369721, Valid_loss 0.413152
Epoch 8, Train Loss 0.321487, Valid_loss 0.403335
Epoch 9, Train Loss 0.304503, Valid_loss 0.342379
Epoch 10, Train Loss 0.340734, Valid_loss 0.340115
Epoch 11, Train Loss 0.312476, Valid_loss 0.300089
Epoch 12, Train Loss 0.320208, Valid_loss 0.273016
Epoch 13, Train Loss 0.292504, Valid_loss 0.263132
Epoch 14, Train Loss 0.359185, Valid_loss 0.353637
Epoch 15, Train Loss 0.326091, Valid_loss 0.303460
Epoch 16, Train Loss 0.287893, Valid_loss 0.339310
Epoch 17, Train Loss 0.281473, Valid_loss 0.327963
Epoch 18, Train Loss 0.280831, Valid_loss 0.356425
Epoch 19, Train Loss 0.259400, Valid_loss 0.416568
Epoch 20, Train Loss 0.273273, Valid_loss 0.363266
Epoch 21, Train Loss 0.294172, Valid_loss 0.400945
Epoch 22, Train Loss 0.303574, Valid_loss 0.433255
Epoch 23, Train Loss 0.245905, Valid_loss 0.368901
Epoch 24, Train Loss 0.258947, Valid_loss 0.322278
Epoch 25, Train Loss 0.270336, Valid_loss 0.395251
Epoch 26, Train Loss 0.238173, Valid_loss 0.356056
Epoch 27, Train Loss 0.224230, Valid_loss 0.319836
Epoch 28, Train Loss 0.229619, Valid_loss 0.325580
Epoch 29, Train Loss 0.253565, Valid_loss 0.321971
Epoch 30, Train Loss 0.230439, Valid_loss 0.379291
Epoch 31, Train Loss 0.246952, Valid_loss 0.347767
Epoch 32, Train Loss 0.237559, Valid_loss 0.363535
Epoch 33, Train Loss 0.228513, Valid_loss 0.366570
Epoch 34, Train Loss 0.233727, Valid_loss 0.440021
Epoch 35, Train Loss 0.229247, Valid_loss 0.411832
Epoch 36, Train Loss 0.229339, Valid_loss 0.400992
Epoch 37, Train Loss 0.224405, Valid_loss 0.416306
Epoch 38, Train Loss 0.220939, Valid_loss 0.379026
Epoch 39, Train Loss 0.228795, Valid_loss 0.415773
Epoch 40, Train Loss 0.211475, Valid_loss 0.371307
Epoch 41, Train Loss 0.250131, Valid_loss 0.360194
Epoch 42, Train Loss 0.222799, Valid_loss 0.423788
Epoch 43, Train Loss 0.227814, Valid_loss 0.457542
Epoch 44, Train Loss 0.237347, Valid_loss 0.348906
Epoch 45, Train Loss 0.245224, Valid_loss 0.308575
Epoch 46, Train Loss 0.231072, Valid_loss 0.332990
Epoch 47, Train Loss 0.232532, Valid_loss 0.425640
Epoch 48, Train Loss 0.218878, Valid_loss 0.363193
Epoch 49, Train Loss 0.200648, Valid_loss 0.358363
Epoch 50, Train Loss 0.196397, Valid_loss 0.741046
Epoch 51, Train Loss 0.228673, Valid_loss 0.532103
Epoch 52, Train Loss 0.223602, Valid_loss 0.356173
Epoch 53, Train Loss 0.196846, Valid_loss 0.340493
Epoch 54, Train Loss 0.197564, Valid_loss 0.417273
Epoch 55, Train Loss 0.217463, Valid_loss 0.385474
Epoch 56, Train Loss 0.200695, Valid_loss 0.270177
Epoch 57, Train Loss 0.196917, Valid_loss 0.405569
Epoch 58, Train Loss 0.190468, Valid_loss 0.307618
Epoch 59, Train Loss 0.188394, Valid_loss 0.473088
Epoch 60, Train Loss 0.193549, Valid_loss 0.772263
[I 2025-08-30 07:32:09,736] Trial 1 finished with value: 0.263131602534226 and parameters: {'learning_rate': 0.01, 'epochs': 100, 'heads': 4, 'dropout': 0.3, 'weight_decay': 0.001, 'emb_dim': 8, 'augment_num': 100, 'pca': False}. Best is trial 1 with value: 0.263131602534226.
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 27.97 MB
Memory Reserved: 46.00 MB
cuda
Epoch 1, Train Loss 0.652859, Valid_loss 0.599337
Epoch 2, Train Loss 0.634860, Valid_loss 0.616134
Epoch 3, Train Loss 0.629694, Valid_loss 0.600447
Epoch 4, Train Loss 0.625459, Valid_loss 0.605116
Epoch 5, Train Loss 0.599005, Valid_loss 0.598502
Epoch 6, Train Loss 0.599856, Valid_loss 0.599034
Epoch 7, Train Loss 0.589434, Valid_loss 0.601193
Epoch 8, Train Loss 0.602905, Valid_loss 0.608603
Epoch 9, Train Loss 0.603153, Valid_loss 0.601555
Epoch 10, Train Loss 0.608927, Valid_loss 0.612051
Epoch 11, Train Loss 0.620129, Valid_loss 0.631510
Epoch 12, Train Loss 0.622438, Valid_loss 0.598772
Epoch 13, Train Loss 0.608134, Valid_loss 0.602152
Epoch 14, Train Loss 0.600028, Valid_loss 0.605967
Epoch 15, Train Loss 0.605583, Valid_loss 0.604700
Epoch 16, Train Loss 0.588667, Valid_loss 0.656850
Epoch 17, Train Loss 0.615513, Valid_loss 0.598321
Epoch 18, Train Loss 0.596190, Valid_loss 0.600959
Epoch 19, Train Loss 0.596483, Valid_loss 0.600609
Epoch 20, Train Loss 0.596098, Valid_loss 0.599475
Epoch 21, Train Loss 0.603052, Valid_loss 0.601314
Epoch 22, Train Loss 0.616704, Valid_loss 0.607454
Epoch 23, Train Loss 0.599194, Valid_loss 0.506436
Epoch 24, Train Loss 0.607064, Valid_loss 0.616806
Epoch 25, Train Loss 0.605220, Valid_loss 0.611092
Epoch 26, Train Loss 0.615183, Valid_loss 0.600188
Epoch 27, Train Loss 0.606727, Valid_loss 0.599985
Epoch 28, Train Loss 0.599636, Valid_loss 0.607877
Epoch 29, Train Loss 0.607019, Valid_loss 0.601551
Epoch 30, Train Loss 0.599327, Valid_loss 0.605874
Epoch 31, Train Loss 0.599157, Valid_loss 0.612178
Epoch 32, Train Loss 0.597098, Valid_loss 0.599748
Epoch 33, Train Loss 0.596321, Valid_loss 0.605038
Epoch 34, Train Loss 0.590811, Valid_loss 0.599275
Epoch 35, Train Loss 0.592172, Valid_loss 0.601357
Epoch 36, Train Loss 0.589412, Valid_loss 0.599667
Epoch 37, Train Loss 0.589124, Valid_loss 0.605714
Epoch 38, Train Loss 0.589412, Valid_loss 0.602958
Epoch 39, Train Loss 0.594154, Valid_loss 0.600595
Epoch 40, Train Loss 0.589086, Valid_loss 0.605090
Epoch 41, Train Loss 0.589559, Valid_loss 0.600484
Epoch 42, Train Loss 0.601141, Valid_loss 0.601135
Epoch 43, Train Loss 0.591836, Valid_loss 0.610150
Epoch 44, Train Loss 0.599844, Valid_loss 0.602789
Epoch 45, Train Loss 0.584773, Valid_loss 0.602525
Epoch 46, Train Loss 0.590631, Valid_loss 0.601246
Epoch 47, Train Loss 0.590238, Valid_loss 0.604863
Epoch 48, Train Loss 0.590118, Valid_loss 0.598383
Epoch 49, Train Loss 0.593152, Valid_loss 0.604569
Epoch 50, Train Loss 0.597527, Valid_loss 0.615296
Epoch 51, Train Loss 0.588458, Valid_loss 0.603041
Epoch 52, Train Loss 0.586425, Valid_loss 0.600716
Epoch 53, Train Loss 0.590063, Valid_loss 0.601202
Epoch 54, Train Loss 0.595796, Valid_loss 0.599995
Epoch 55, Train Loss 0.584899, Valid_loss 0.609589
Epoch 56, Train Loss 0.586191, Valid_loss 0.604306
Epoch 57, Train Loss 0.585768, Valid_loss 0.600263
Epoch 58, Train Loss 0.586594, Valid_loss 0.599484
Epoch 59, Train Loss 0.582300, Valid_loss 0.601998
Epoch 60, Train Loss 0.579656, Valid_loss 0.600159
Epoch 61, Train Loss 0.581329, Valid_loss 0.601140
Epoch 62, Train Loss 0.583720, Valid_loss 0.600134
Epoch 63, Train Loss 0.581734, Valid_loss 0.599421
Epoch 64, Train Loss 0.578149, Valid_loss 0.600422
Epoch 65, Train Loss 0.582628, Valid_loss 0.599524
Epoch 66, Train Loss 0.581674, Valid_loss 0.603398
Epoch 67, Train Loss 0.584879, Valid_loss 0.598208
Epoch 68, Train Loss 0.576220, Valid_loss 0.602842
Epoch 69, Train Loss 0.574930, Valid_loss 0.591166
Epoch 70, Train Loss 0.543922, Valid_loss 0.547501
Epoch 71, Train Loss 0.430740, Valid_loss 0.410100
Epoch 72, Train Loss 0.361470, Valid_loss 0.353103
Epoch 73, Train Loss 0.283993, Valid_loss 0.295010
Epoch 74, Train Loss 0.242239, Valid_loss 0.297837
Epoch 75, Train Loss 0.223111, Valid_loss 0.233932
Epoch 76, Train Loss 0.213110, Valid_loss 0.207581
Epoch 77, Train Loss 0.224043, Valid_loss 0.238306
Epoch 78, Train Loss 0.221948, Valid_loss 0.284293
[I 2025-08-30 07:38:07,769] Trial 2 finished with value: 0.2075813560347472 and parameters: {'learning_rate': 0.01, 'epochs': 100, 'heads': 4, 'dropout': 0.0, 'weight_decay': 0.001, 'emb_dim': 64, 'augment_num': 100, 'pca': False}. Best is trial 2 with value: 0.2075813560347472.
선택된 trial params: {'learning_rate': 0.01, 'epochs': 100, 'heads': 4, 'dropout': 0.0, 'weight_decay': 0.001, 'emb_dim': 64, 'augment_num': 100, 'pca': False}
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=10, batch_size=1 -> steps=10
output_class :  1
Memory Allocated: 27.97 MB
Memory Reserved: 46.00 MB
cuda
Epoch 1, Train Loss 0.649826, Valid_loss 0.607244
Epoch 2, Train Loss 0.592264, Valid_loss 0.573085
Epoch 3, Train Loss 0.459973, Valid_loss 0.809892
Epoch 4, Train Loss 0.496022, Valid_loss 0.359370
Epoch 5, Train Loss 0.340137, Valid_loss 0.307950
Epoch 6, Train Loss 0.292719, Valid_loss 0.369268
Epoch 7, Train Loss 0.249199, Valid_loss 0.308778
Epoch 8, Train Loss 0.256016, Valid_loss 0.313356
Epoch 9, Train Loss 0.244380, Valid_loss 0.316774
Epoch 10, Train Loss 0.231461, Valid_loss 0.328115
Epoch 11, Train Loss 0.232576, Valid_loss 0.312734
Epoch 12, Train Loss 0.222105, Valid_loss 0.321141
Epoch 13, Train Loss 0.219097, Valid_loss 0.325047
Epoch 14, Train Loss 0.213404, Valid_loss 0.326464
Epoch 15, Train Loss 0.218749, Valid_loss 0.362295
Epoch 16, Train Loss 0.207935, Valid_loss 0.328771
Epoch 17, Train Loss 0.199671, Valid_loss 0.374822
Epoch 18, Train Loss 0.215549, Valid_loss 0.348581
Epoch 19, Train Loss 0.243810, Valid_loss 0.551290
Epoch 20, Train Loss 0.240399, Valid_loss 0.301300
Epoch 21, Train Loss 0.228901, Valid_loss 0.289693
Epoch 22, Train Loss 0.211826, Valid_loss 0.384921
Epoch 23, Train Loss 0.202345, Valid_loss 0.506865
Epoch 24, Train Loss 0.207720, Valid_loss 0.209917
Epoch 25, Train Loss 0.201729, Valid_loss 0.248364
Epoch 26, Train Loss 0.211194, Valid_loss 0.234755
Epoch 27, Train Loss 0.195223, Valid_loss 0.245376
Epoch 28, Train Loss 0.190206, Valid_loss 0.267957
Epoch 29, Train Loss 0.189195, Valid_loss 0.280537
Epoch 30, Train Loss 0.196138, Valid_loss 0.360328
Epoch 31, Train Loss 0.193265, Valid_loss 0.397764
Epoch 32, Train Loss 0.194194, Valid_loss 0.239874
Epoch 33, Train Loss 0.202029, Valid_loss 0.404081
Epoch 34, Train Loss 0.226486, Valid_loss 0.331188
Epoch 35, Train Loss 0.208161, Valid_loss 0.483910
Epoch 36, Train Loss 0.238463, Valid_loss 0.429284
Epoch 37, Train Loss 0.256201, Valid_loss 0.410541
Epoch 38, Train Loss 0.252601, Valid_loss 0.352564
Epoch 39, Train Loss 0.203053, Valid_loss 0.432505
Epoch 40, Train Loss 0.201339, Valid_loss 0.439396
Epoch 41, Train Loss 0.222008, Valid_loss 0.375016
Epoch 42, Train Loss 0.344606, Valid_loss 0.377624
Epoch 43, Train Loss 0.305134, Valid_loss 0.394810
Epoch 44, Train Loss 0.275058, Valid_loss 0.615783
Epoch 45, Train Loss 0.231494, Valid_loss 0.287724
Epoch 46, Train Loss 0.205670, Valid_loss 0.225986
Epoch 47, Train Loss 0.216767, Valid_loss 0.260108
Epoch 48, Train Loss 0.208745, Valid_loss 0.398803
Epoch 49, Train Loss 0.230852, Valid_loss 0.483713
Epoch 50, Train Loss 0.206475, Valid_loss 0.426442
Epoch 51, Train Loss 0.215225, Valid_loss 0.458101
Epoch 52, Train Loss 0.195148, Valid_loss 0.434789
Epoch 53, Train Loss 0.192667, Valid_loss 0.383220
Epoch 54, Train Loss 0.191011, Valid_loss 0.400338
Epoch 55, Train Loss 0.189130, Valid_loss 0.347063
Epoch 56, Train Loss 0.189724, Valid_loss 0.379697
Epoch 57, Train Loss 0.188691, Valid_loss 0.387107
환자ID=COVID19_Participant15 -- true: 1 -- pred: 1
환자ID=COVID19_Participant17 -- true: 1 -- pred: 1
환자ID=COVID19_Participant22 -- true: 1 -- pred: 0
환자ID=COVID19_Participant28 -- true: 1 -- pred: 1
환자ID=COVID19_Participant3 -- true: 1 -- pred: 1
환자ID=COVID19_Participant32 -- true: 1 -- pred: 0
환자ID=COVID19_Participant9 -- true: 1 -- pred: 1
환자ID=Control_Participant13 -- true: 0 -- pred: 0
환자ID=Control_Participant2 -- true: 0 -- pred: 0
환자ID=Control_Participant6 -- true: 0 -- pred: 0
Best performance: Epoch 24, Loss 0.207720, Test ACC 0.800000, Test AUC 0.904762, Test Recall 0.714286, Test Precision 1.000000
Confusion Matrix:
 [3 0 2 5]
✅ Total valid splits used: 3
🔁 Repeat 2, Fold 3
cell type :  CATTAAGGATAT_COVID19_Participant13    Developing Ciliated Cells
GTAGAAGGGGGG_COVID19_Participant13    Developing Ciliated Cells
ATTAAGAGGTAG_COVID19_Participant13    Developing Ciliated Cells
AGATATGACAAG_COVID19_Participant13    Developing Ciliated Cells
CTTGTAACAAAT_COVID19_Participant13               Squamous Cells
                                                ...            
GCAGGGAACTCC_COVID19_Participant30               Squamous Cells
CAGCACCGAGCC_COVID19_Participant30               Squamous Cells
GCCCCTTGTGAT_COVID19_Participant30               Squamous Cells
GTGTTGTGTGTC_COVID19_Participant30               Squamous Cells
TAACACTCACTT_COVID19_Participant30               Squamous Cells
Name: manual_annotation, Length: 21084, dtype: string
cell type annotation :  CATTAAGGATAT_COVID19_Participant13    Developing Ciliated Cells
GTAGAAGGGGGG_COVID19_Participant13    Developing Ciliated Cells
ATTAAGAGGTAG_COVID19_Participant13    Developing Ciliated Cells
AGATATGACAAG_COVID19_Participant13    Developing Ciliated Cells
CTTGTAACAAAT_COVID19_Participant13               Squamous Cells
                                                ...            
GCAGGGAACTCC_COVID19_Participant30               Squamous Cells
CAGCACCGAGCC_COVID19_Participant30               Squamous Cells
GCCCCTTGTGAT_COVID19_Participant30               Squamous Cells
GTGTTGTGTGTC_COVID19_Participant30               Squamous Cells
TAACACTCACTT_COVID19_Participant30               Squamous Cells
Name: manual_annotation, Length: 21084, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Developing Ciliated Cells', 'Squamous Cells', 'Secretory Cells', 'Macrophages', 'B Cells', 'Ciliated Cells', 'T Cells', 'Dendritic Cells', 'Goblet Cells', 'Deuterosomal Cells', 'Basal Cells', 'Ionocytes', 'Mitotic Basal Cells', 'Developing Secretory and Goblet Cells', 'Enteroendocrine Cells', 'Erythroblasts', 'Plasmacytoid DCs', 'Mast Cells']
라벨별 그룹 개수 {1: 28, 0: 12}
cell type :  GTCGGGGGGTGG_Control_Participant7     Developing Ciliated Cells
CAAATCAATTAT_Control_Participant7     Developing Ciliated Cells
ATACAATTGACA_Control_Participant7     Developing Ciliated Cells
CTGTTAATGAGA_Control_Participant7     Developing Ciliated Cells
CTTCACATTATT_Control_Participant7     Developing Ciliated Cells
                                                ...            
TCTAGGTGTCTA_COVID19_Participant18              Secretory Cells
TAAAACTATATT_COVID19_Participant18              Secretory Cells
ACACGGTAAGAC_COVID19_Participant18              Secretory Cells
CACAAACCCACG_COVID19_Participant18              Secretory Cells
TTTCAAACTTCT_COVID19_Participant18              Secretory Cells
Name: manual_annotation, Length: 5863, dtype: string
cell type annotation :  GTCGGGGGGTGG_Control_Participant7     Developing Ciliated Cells
CAAATCAATTAT_Control_Participant7     Developing Ciliated Cells
ATACAATTGACA_Control_Participant7     Developing Ciliated Cells
CTGTTAATGAGA_Control_Participant7     Developing Ciliated Cells
CTTCACATTATT_Control_Participant7     Developing Ciliated Cells
                                                ...            
TCTAGGTGTCTA_COVID19_Participant18              Secretory Cells
TAAAACTATATT_COVID19_Participant18              Secretory Cells
ACACGGTAAGAC_COVID19_Participant18              Secretory Cells
CACAAACCCACG_COVID19_Participant18              Secretory Cells
TTTCAAACTTCT_COVID19_Participant18              Secretory Cells
Name: manual_annotation, Length: 5863, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Developing Ciliated Cells', 'Ciliated Cells', 'Secretory Cells', 'Squamous Cells', 'Goblet Cells', 'T Cells', 'Dendritic Cells', 'Basal Cells', 'Deuterosomal Cells', 'Mitotic Basal Cells', 'Developing Secretory and Goblet Cells', 'Macrophages', 'Plasmacytoid DCs', 'Ionocytes', 'Enteroendocrine Cells', 'B Cells', 'Erythroblasts', 'Mast Cells']
라벨별 그룹 개수 {1: 7, 0: 3}
🔍 Split #4
  → train_p_index 환자 수 (환자 단위로 묶인 index list): 40
  → test_p_index 환자 수  (환자 단위로 묶인 index list): 10
  → train 환자 ID: ['COVID19_Participant10', 'COVID19_Participant12', 'COVID19_Participant13', 'COVID19_Participant15', 'COVID19_Participant17', 'COVID19_Participant20', 'COVID19_Participant21', 'COVID19_Participant22', 'COVID19_Participant23', 'COVID19_Participant26', 'COVID19_Participant27', 'COVID19_Participant28', 'COVID19_Participant29', 'COVID19_Participant3', 'COVID19_Participant30', 'COVID19_Participant32', 'COVID19_Participant35', 'COVID19_Participant36', 'COVID19_Participant37', 'COVID19_Participant38', 'COVID19_Participant39', 'COVID19_Participant4', 'COVID19_Participant40', 'COVID19_Participant5', 'COVID19_Participant6', 'COVID19_Participant7', 'COVID19_Participant8', 'COVID19_Participant9', 'Control_Participant11', 'Control_Participant12', 'Control_Participant13', 'Control_Participant14', 'Control_Participant15', 'Control_Participant2', 'Control_Participant3', 'Control_Participant4', 'Control_Participant5', 'Control_Participant6', 'Control_Participant8', 'Control_Participant9']
  → test  환자 ID: ['COVID19_Participant11', 'COVID19_Participant14', 'COVID19_Participant18', 'COVID19_Participant19', 'COVID19_Participant2', 'COVID19_Participant25', 'COVID19_Participant31', 'Control_Participant1', 'Control_Participant10', 'Control_Participant7']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant10, Label: 1
    ID: COVID19_Participant12, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant21, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant27, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant3, Label: 1
    ID: COVID19_Participant30, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant35, Label: 1
    ID: COVID19_Participant36, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant38, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: COVID19_Participant5, Label: 1
    ID: COVID19_Participant6, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: COVID19_Participant9, Label: 1
    ID: Control_Participant11, Label: 0
    ID: Control_Participant12, Label: 0
    ID: Control_Participant13, Label: 0
    ID: Control_Participant14, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant2, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant4, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant6, Label: 0
    ID: Control_Participant8, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant18, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant10, Label: 0
    ID: Control_Participant7, Label: 0
전체 데이터 index 길이 50
label_stat (train 환자 라벨 목록) 갯수 40
train_data에서 환자 단위로, train과 validation 나누기
기존 train_p_index 40
기존 (train) label_stat 40
train-vali 분할 후! 
train y 의 classes : {0, 1} valid y 의 classes : {0, 1} label_stat 의 classes : {0, 1}
train_p_index_ 26
valid_p_index 14
test_p_index 10
→ train 환자 ID 및 라벨:
   총 개수: 26
   환자ID=Control_Participant12, Label=0, 셀개수=99
   환자ID=Control_Participant2, Label=0, 셀개수=41
   환자ID=COVID19_Participant21, Label=1, 셀개수=39
   환자ID=COVID19_Participant4, Label=1, 셀개수=1680
   환자ID=COVID19_Participant10, Label=1, 셀개수=18
   환자ID=Control_Participant5, Label=0, 셀개수=717
   환자ID=COVID19_Participant15, Label=1, 셀개수=1003
   환자ID=COVID19_Participant22, Label=1, 셀개수=865
   환자ID=COVID19_Participant5, Label=1, 셀개수=89
   환자ID=COVID19_Participant13, Label=1, 셀개수=730
   환자ID=COVID19_Participant23, Label=1, 셀개수=307
   환자ID=Control_Participant3, Label=0, 셀개수=1620
   환자ID=COVID19_Participant3, Label=1, 셀개수=104
   환자ID=Control_Participant8, Label=0, 셀개수=393
   환자ID=Control_Participant6, Label=0, 셀개수=131
   환자ID=COVID19_Participant17, Label=1, 셀개수=843
   환자ID=Control_Participant9, Label=0, 셀개수=558
   환자ID=Control_Participant13, Label=0, 셀개수=88
   환자ID=COVID19_Participant27, Label=1, 셀개수=93
   환자ID=COVID19_Participant35, Label=1, 셀개수=83
   환자ID=COVID19_Participant29, Label=1, 셀개수=573
   환자ID=COVID19_Participant20, Label=1, 셀개수=2033
   환자ID=COVID19_Participant7, Label=1, 셀개수=409
   환자ID=COVID19_Participant40, Label=1, 셀개수=381
   환자ID=COVID19_Participant39, Label=1, 셀개수=454
   환자ID=COVID19_Participant32, Label=1, 셀개수=1665
→ valid 환자 ID 및 라벨:
   총 개수: 14
   환자ID=Control_Participant15, Label=0, 셀개수=528
   환자ID=COVID19_Participant30, Label=1, 셀개수=116
   환자ID=COVID19_Participant37, Label=1, 셀개수=668
   환자ID=COVID19_Participant36, Label=1, 셀개수=200
   환자ID=COVID19_Participant6, Label=1, 셀개수=84
   환자ID=COVID19_Participant26, Label=1, 셀개수=814
   환자ID=Control_Participant4, Label=0, 셀개수=440
   환자ID=Control_Participant11, Label=0, 셀개수=1164
   환자ID=COVID19_Participant9, Label=1, 셀개수=86
   환자ID=COVID19_Participant8, Label=1, 셀개수=462
   환자ID=Control_Participant14, Label=0, 셀개수=274
   환자ID=COVID19_Participant38, Label=1, 셀개수=51
   환자ID=COVID19_Participant12, Label=1, 셀개수=102
   환자ID=COVID19_Participant28, Label=1, 셀개수=1079
→ test 환자 ID 및 라벨:
   총 개수: 10
   환자ID=COVID19_Participant11, Label=1, 셀개수=382
   환자ID=COVID19_Participant14, Label=1, 셀개수=382
   환자ID=COVID19_Participant18, Label=1, 셀개수=227
   환자ID=COVID19_Participant19, Label=1, 셀개수=816
   환자ID=COVID19_Participant2, Label=1, 셀개수=329
   환자ID=COVID19_Participant25, Label=1, 셀개수=496
   환자ID=COVID19_Participant31, Label=1, 셀개수=410
   환자ID=Control_Participant1, Label=0, 셀개수=414
   환자ID=Control_Participant10, Label=0, 셀개수=1645
   환자ID=Control_Participant7, Label=0, 셀개수=762
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Squamous Cells', 'Secretory Cells', 'Macrophages', 'Developing Ciliated Cells', 'B Cells', 'Ciliated Cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
전체 데이터 길이 26947
전체 cell type 길이 0        Developing Ciliated Cells
1        Developing Ciliated Cells
2        Developing Ciliated Cells
3        Developing Ciliated Cells
4                   Squamous Cells
                   ...            
26942              Secretory Cells
26943              Secretory Cells
26944              Secretory Cells
26945              Secretory Cells
26946              Secretory Cells
Length: 26947, dtype: string
cell type의 NaN 개수 체크 0
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:29,  3.39it/s]  3%|▎         | 3/100 [00:00<00:15,  6.10it/s]  5%|▌         | 5/100 [00:00<00:14,  6.59it/s]  7%|▋         | 7/100 [00:01<00:18,  5.03it/s]  8%|▊         | 8/100 [00:01<00:16,  5.65it/s]  9%|▉         | 9/100 [00:01<00:19,  4.77it/s] 10%|█         | 10/100 [00:01<00:16,  5.35it/s] 11%|█         | 11/100 [00:01<00:14,  6.13it/s] 12%|█▏        | 12/100 [00:02<00:14,  6.01it/s] 14%|█▍        | 14/100 [00:02<00:17,  4.93it/s] 16%|█▌        | 16/100 [00:02<00:13,  6.05it/s] 17%|█▋        | 17/100 [00:02<00:12,  6.58it/s] 18%|█▊        | 18/100 [00:03<00:14,  5.85it/s] 19%|█▉        | 19/100 [00:03<00:12,  6.32it/s] 20%|██        | 20/100 [00:03<00:12,  6.49it/s] 21%|██        | 21/100 [00:03<00:11,  7.09it/s] 22%|██▏       | 22/100 [00:03<00:10,  7.58it/s] 23%|██▎       | 23/100 [00:03<00:10,  7.37it/s] 24%|██▍       | 24/100 [00:03<00:10,  7.02it/s] 25%|██▌       | 25/100 [00:04<00:09,  7.68it/s] 26%|██▌       | 26/100 [00:04<00:08,  8.24it/s] 27%|██▋       | 27/100 [00:04<00:09,  7.52it/s] 28%|██▊       | 28/100 [00:04<00:09,  7.82it/s] 29%|██▉       | 29/100 [00:04<00:10,  6.58it/s] 30%|███       | 30/100 [00:04<00:10,  6.97it/s] 31%|███       | 31/100 [00:04<00:11,  6.18it/s] 32%|███▏      | 32/100 [00:05<00:10,  6.63it/s] 34%|███▍      | 34/100 [00:05<00:08,  7.79it/s] 35%|███▌      | 35/100 [00:05<00:08,  8.04it/s] 36%|███▌      | 36/100 [00:05<00:07,  8.01it/s] 37%|███▋      | 37/100 [00:05<00:07,  8.10it/s] 38%|███▊      | 38/100 [00:05<00:10,  5.93it/s] 40%|████      | 40/100 [00:06<00:08,  7.21it/s] 41%|████      | 41/100 [00:06<00:07,  7.48it/s] 43%|████▎     | 43/100 [00:06<00:06,  8.28it/s] 45%|████▌     | 45/100 [00:06<00:06,  8.91it/s] 47%|████▋     | 47/100 [00:06<00:06,  8.54it/s] 48%|████▊     | 48/100 [00:07<00:06,  7.98it/s] 49%|████▉     | 49/100 [00:07<00:06,  7.94it/s] 50%|█████     | 50/100 [00:07<00:07,  7.13it/s] 51%|█████     | 51/100 [00:07<00:06,  7.11it/s] 52%|█████▏    | 52/100 [00:07<00:06,  7.62it/s] 53%|█████▎    | 53/100 [00:07<00:05,  8.15it/s] 54%|█████▍    | 54/100 [00:07<00:05,  8.38it/s] 55%|█████▌    | 55/100 [00:07<00:05,  8.48it/s] 56%|█████▌    | 56/100 [00:08<00:05,  7.85it/s] 58%|█████▊    | 58/100 [00:08<00:04,  8.47it/s] 59%|█████▉    | 59/100 [00:08<00:04,  8.73it/s] 60%|██████    | 60/100 [00:08<00:04,  8.89it/s] 61%|██████    | 61/100 [00:08<00:04,  7.83it/s] 62%|██████▏   | 62/100 [00:08<00:04,  7.92it/s] 63%|██████▎   | 63/100 [00:09<00:05,  6.76it/s] 65%|██████▌   | 65/100 [00:09<00:04,  7.92it/s] 66%|██████▌   | 66/100 [00:09<00:04,  8.28it/s] 68%|██████▊   | 68/100 [00:09<00:03,  8.84it/s] 69%|██████▉   | 69/100 [00:09<00:03,  8.52it/s] 70%|███████   | 70/100 [00:09<00:03,  8.67it/s] 72%|███████▏  | 72/100 [00:09<00:03,  9.19it/s] 73%|███████▎  | 73/100 [00:10<00:02,  9.24it/s] 74%|███████▍  | 74/100 [00:10<00:03,  8.38it/s] 75%|███████▌  | 75/100 [00:10<00:02,  8.51it/s] 76%|███████▌  | 76/100 [00:10<00:03,  7.97it/s] 77%|███████▋  | 77/100 [00:10<00:02,  8.30it/s] 78%|███████▊  | 78/100 [00:10<00:02,  8.65it/s] 79%|███████▉  | 79/100 [00:10<00:02,  8.77it/s] 80%|████████  | 80/100 [00:10<00:02,  8.85it/s] 81%|████████  | 81/100 [00:11<00:02,  8.92it/s] 82%|████████▏ | 82/100 [00:11<00:01,  9.00it/s] 83%|████████▎ | 83/100 [00:11<00:01,  9.18it/s] 84%|████████▍ | 84/100 [00:11<00:01,  9.16it/s] 85%|████████▌ | 85/100 [00:11<00:01,  9.18it/s] 86%|████████▌ | 86/100 [00:11<00:01,  8.38it/s] 87%|████████▋ | 87/100 [00:11<00:01,  6.68it/s] 88%|████████▊ | 88/100 [00:11<00:01,  7.16it/s] 90%|█████████ | 90/100 [00:12<00:01,  8.20it/s] 92%|█████████▏| 92/100 [00:12<00:00,  8.72it/s] 94%|█████████▍| 94/100 [00:12<00:00,  8.55it/s] 95%|█████████▌| 95/100 [00:12<00:00,  8.63it/s] 96%|█████████▌| 96/100 [00:12<00:00,  8.67it/s] 97%|█████████▋| 97/100 [00:12<00:00,  8.04it/s] 98%|█████████▊| 98/100 [00:13<00:00,  8.22it/s] 99%|█████████▉| 99/100 [00:13<00:00,  8.57it/s]100%|██████████| 100/100 [00:13<00:00,  8.86it/s]100%|██████████| 100/100 [00:13<00:00,  7.51it/s]
[I 2025-08-30 07:42:43,538] A new study created in memory with name: no-name-bd0337d9-4367-43dc-9c97-a3aa50d38f2d
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 26.13 MB
Memory Reserved: 46.00 MB
cuda
Epoch 1, Train Loss 0.621963, Valid_loss 0.423736
Epoch 2, Train Loss 0.503143, Valid_loss 0.302006
Epoch 3, Train Loss 0.425767, Valid_loss 0.283218
Epoch 4, Train Loss 0.404307, Valid_loss 0.292794
Epoch 5, Train Loss 0.366523, Valid_loss 0.241863
Epoch 6, Train Loss 0.377713, Valid_loss 0.300731
Epoch 7, Train Loss 0.355461, Valid_loss 0.321610
Epoch 8, Train Loss 0.373159, Valid_loss 0.267285
Epoch 9, Train Loss 0.328207, Valid_loss 0.239154
Epoch 10, Train Loss 0.340812, Valid_loss 0.257354
Epoch 11, Train Loss 0.343725, Valid_loss 0.239968
Epoch 12, Train Loss 0.341029, Valid_loss 0.216640
Epoch 13, Train Loss 0.323660, Valid_loss 0.243141
Epoch 14, Train Loss 0.319681, Valid_loss 0.231081
Epoch 15, Train Loss 0.311691, Valid_loss 0.230597
Epoch 16, Train Loss 0.290082, Valid_loss 0.194333
Epoch 17, Train Loss 0.294059, Valid_loss 0.190237
Epoch 18, Train Loss 0.283415, Valid_loss 0.191083
Epoch 19, Train Loss 0.282746, Valid_loss 0.211378
Epoch 20, Train Loss 0.281285, Valid_loss 0.160031
Epoch 21, Train Loss 0.262960, Valid_loss 0.214842
Epoch 22, Train Loss 0.256267, Valid_loss 0.172562
Epoch 23, Train Loss 0.251557, Valid_loss 0.198608
Epoch 24, Train Loss 0.249605, Valid_loss 0.209396
Epoch 25, Train Loss 0.248367, Valid_loss 0.241259
Epoch 26, Train Loss 0.243695, Valid_loss 0.210146
Epoch 27, Train Loss 0.247791, Valid_loss 0.188572
Epoch 28, Train Loss 0.242738, Valid_loss 0.173391
Epoch 29, Train Loss 0.253237, Valid_loss 0.190224
Epoch 30, Train Loss 0.254508, Valid_loss 0.209910
Epoch 31, Train Loss 0.254675, Valid_loss 0.174571
Epoch 32, Train Loss 0.239400, Valid_loss 0.210526
Epoch 33, Train Loss 0.236198, Valid_loss 0.238403
Epoch 34, Train Loss 0.238288, Valid_loss 0.265785
Epoch 35, Train Loss 0.234043, Valid_loss 0.240478
Epoch 36, Train Loss 0.237233, Valid_loss 0.228536
Epoch 37, Train Loss 0.239483, Valid_loss 0.207391
Epoch 38, Train Loss 0.239640, Valid_loss 0.301989
Epoch 39, Train Loss 0.232790, Valid_loss 0.237378
Epoch 40, Train Loss 0.228171, Valid_loss 0.224337
Epoch 41, Train Loss 0.231871, Valid_loss 0.216237
Epoch 42, Train Loss 0.225190, Valid_loss 0.251919
Epoch 43, Train Loss 0.241733, Valid_loss 0.272607
Epoch 44, Train Loss 0.233200, Valid_loss 0.250201
Epoch 45, Train Loss 0.235779, Valid_loss 0.277746
Epoch 46, Train Loss 0.249189, Valid_loss 0.180095
Epoch 47, Train Loss 0.229713, Valid_loss 0.195253
Epoch 48, Train Loss 0.232908, Valid_loss 0.173367
Epoch 49, Train Loss 0.227878, Valid_loss 0.205846
Epoch 50, Train Loss 0.219037, Valid_loss 0.203792
Epoch 51, Train Loss 0.221174, Valid_loss 0.215613
Epoch 52, Train Loss 0.220197, Valid_loss 0.196197
Epoch 53, Train Loss 0.223063, Valid_loss 0.185924
Epoch 54, Train Loss 0.224447, Valid_loss 0.228755
Epoch 55, Train Loss 0.225573, Valid_loss 0.211468
Epoch 56, Train Loss 0.226618, Valid_loss 0.194406
Epoch 57, Train Loss 0.219565, Valid_loss 0.196746
Epoch 58, Train Loss 0.220483, Valid_loss 0.225164
[I 2025-08-30 07:47:19,357] Trial 0 finished with value: 0.1600309440067836 and parameters: {'learning_rate': 0.001, 'epochs': 100, 'heads': 4, 'dropout': 0.3, 'weight_decay': 0.001, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.1600309440067836.
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 46.00 MB
cuda
Epoch 1, Train Loss 0.657029, Valid_loss 0.595041
Epoch 2, Train Loss 0.644311, Valid_loss 0.598307
Epoch 3, Train Loss 0.643518, Valid_loss 0.596232
Epoch 4, Train Loss 0.599439, Valid_loss 0.520148
Epoch 5, Train Loss 0.487975, Valid_loss 0.379852
Epoch 6, Train Loss 0.395582, Valid_loss 0.465765
Epoch 7, Train Loss 0.345473, Valid_loss 0.410231
Epoch 8, Train Loss 0.327197, Valid_loss 0.277757
Epoch 9, Train Loss 0.315283, Valid_loss 0.292083
Epoch 10, Train Loss 0.278470, Valid_loss 0.289250
Epoch 11, Train Loss 0.248499, Valid_loss 0.301419
Epoch 12, Train Loss 0.263059, Valid_loss 0.376431
Epoch 13, Train Loss 0.253822, Valid_loss 0.279908
Epoch 14, Train Loss 0.235300, Valid_loss 0.298860
Epoch 15, Train Loss 0.250435, Valid_loss 0.304990
Epoch 16, Train Loss 0.252130, Valid_loss 0.272757
Epoch 17, Train Loss 0.238811, Valid_loss 0.285966
Epoch 18, Train Loss 0.234504, Valid_loss 0.307443
Epoch 19, Train Loss 0.227845, Valid_loss 0.276946
Epoch 20, Train Loss 0.222630, Valid_loss 0.299210
Epoch 21, Train Loss 0.221656, Valid_loss 0.336922
Epoch 22, Train Loss 0.217720, Valid_loss 0.317349
Epoch 23, Train Loss 0.209093, Valid_loss 0.293065
Epoch 24, Train Loss 0.228603, Valid_loss 0.342153
Epoch 25, Train Loss 0.281144, Valid_loss 0.328901
Epoch 26, Train Loss 0.268303, Valid_loss 0.272496
Epoch 27, Train Loss 0.252931, Valid_loss 0.341605
Epoch 28, Train Loss 0.241145, Valid_loss 0.368217
Epoch 29, Train Loss 0.229224, Valid_loss 0.363693
Epoch 30, Train Loss 0.222918, Valid_loss 0.367788
Epoch 31, Train Loss 0.216238, Valid_loss 0.379259
Epoch 32, Train Loss 0.213199, Valid_loss 0.392615
Epoch 33, Train Loss 0.218963, Valid_loss 0.429742
Epoch 34, Train Loss 0.216151, Valid_loss 0.340369
Epoch 35, Train Loss 0.213724, Valid_loss 0.311106
Epoch 36, Train Loss 0.215669, Valid_loss 0.323952
Epoch 37, Train Loss 0.216476, Valid_loss 0.333697
Epoch 38, Train Loss 0.216874, Valid_loss 0.247183
Epoch 39, Train Loss 0.253393, Valid_loss 0.285130
Epoch 40, Train Loss 0.252652, Valid_loss 0.246590
Epoch 41, Train Loss 0.239402, Valid_loss 0.249963
Epoch 42, Train Loss 0.232805, Valid_loss 0.231218
Epoch 43, Train Loss 0.227425, Valid_loss 0.209565
Epoch 44, Train Loss 0.222178, Valid_loss 0.252286
Epoch 45, Train Loss 0.220834, Valid_loss 0.257931
Epoch 46, Train Loss 0.218235, Valid_loss 0.267611
Epoch 47, Train Loss 0.233538, Valid_loss 0.321321
Epoch 48, Train Loss 0.216208, Valid_loss 0.296344
Epoch 49, Train Loss 0.211538, Valid_loss 0.353894
Epoch 50, Train Loss 0.206502, Valid_loss 0.363961
Epoch 51, Train Loss 0.205478, Valid_loss 0.384458
Epoch 52, Train Loss 0.203939, Valid_loss 0.380830
Epoch 53, Train Loss 0.204394, Valid_loss 0.384256
Epoch 54, Train Loss 0.202868, Valid_loss 0.373708
Epoch 55, Train Loss 0.201052, Valid_loss 0.341683
Epoch 56, Train Loss 0.201120, Valid_loss 0.360227
Epoch 57, Train Loss 0.201434, Valid_loss 0.355769
Epoch 58, Train Loss 0.201355, Valid_loss 0.345909
Epoch 59, Train Loss 0.198855, Valid_loss 0.355299
Epoch 60, Train Loss 0.204391, Valid_loss 0.330360
Epoch 61, Train Loss 0.202009, Valid_loss 0.325142
Epoch 62, Train Loss 0.201778, Valid_loss 0.308291
Epoch 63, Train Loss 0.199727, Valid_loss 0.314249
Epoch 64, Train Loss 0.203200, Valid_loss 0.311768
Epoch 65, Train Loss 0.199890, Valid_loss 0.307704
Epoch 66, Train Loss 0.201535, Valid_loss 0.306224
Epoch 67, Train Loss 0.202570, Valid_loss 0.296115
Epoch 68, Train Loss 0.199643, Valid_loss 0.314878
Epoch 69, Train Loss 0.202863, Valid_loss 0.295127
Epoch 70, Train Loss 0.203860, Valid_loss 0.302111
Epoch 71, Train Loss 0.201456, Valid_loss 0.300624
Epoch 72, Train Loss 0.200014, Valid_loss 0.289645
Epoch 73, Train Loss 0.202263, Valid_loss 0.300221
Epoch 74, Train Loss 0.197142, Valid_loss 0.284494
Epoch 75, Train Loss 0.200432, Valid_loss 0.337565
Epoch 76, Train Loss 0.205029, Valid_loss 0.319878
Epoch 77, Train Loss 0.199430, Valid_loss 0.302185
Epoch 78, Train Loss 0.198616, Valid_loss 0.297370
Epoch 79, Train Loss 0.201358, Valid_loss 0.293985
Epoch 80, Train Loss 0.204256, Valid_loss 0.336284
Epoch 81, Train Loss 0.205452, Valid_loss 0.297855
Epoch 82, Train Loss 0.208566, Valid_loss 0.299269
Epoch 83, Train Loss 0.199673, Valid_loss 0.278554
Epoch 84, Train Loss 0.201071, Valid_loss 0.278032
Epoch 85, Train Loss 0.198678, Valid_loss 0.279462
Epoch 86, Train Loss 0.203776, Valid_loss 0.308034
[I 2025-08-30 07:53:51,760] Trial 1 finished with value: 0.2095647360464292 and parameters: {'learning_rate': 0.01, 'epochs': 100, 'heads': 4, 'dropout': 0.0, 'weight_decay': 0.0001, 'emb_dim': 8, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.1600309440067836.
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 27.97 MB
Memory Reserved: 46.00 MB
cuda
Epoch 1, Train Loss 0.718122, Valid_loss 0.597993
Epoch 2, Train Loss 0.658883, Valid_loss 0.633586
Epoch 3, Train Loss 0.679619, Valid_loss 0.606987
Epoch 4, Train Loss 0.636553, Valid_loss 0.603464
Epoch 5, Train Loss 0.660003, Valid_loss 0.625724
Epoch 6, Train Loss 0.668580, Valid_loss 0.614719
Epoch 7, Train Loss 0.658997, Valid_loss 0.613583
Epoch 8, Train Loss 0.617169, Valid_loss 0.466542
Epoch 9, Train Loss 0.584795, Valid_loss 0.373903
Epoch 10, Train Loss 0.474869, Valid_loss 0.395599
Epoch 11, Train Loss 0.429369, Valid_loss 0.931914
Epoch 12, Train Loss 0.422871, Valid_loss 1.569153
Epoch 13, Train Loss 0.437285, Valid_loss 1.567658
Epoch 14, Train Loss 0.490699, Valid_loss 1.150544
Epoch 15, Train Loss 0.418159, Valid_loss 1.128800
Epoch 16, Train Loss 0.345352, Valid_loss 1.485624
Epoch 17, Train Loss 0.380476, Valid_loss 1.370797
Epoch 18, Train Loss 0.345173, Valid_loss 1.336950
Epoch 19, Train Loss 0.351952, Valid_loss 1.350254
Epoch 20, Train Loss 0.381382, Valid_loss 0.383915
Epoch 21, Train Loss 0.360805, Valid_loss 1.018412
Epoch 22, Train Loss 0.346645, Valid_loss 1.441208
Epoch 23, Train Loss 0.333006, Valid_loss 1.511482
Epoch 24, Train Loss 0.417922, Valid_loss 0.898579
Epoch 25, Train Loss 0.327714, Valid_loss 0.862753
Epoch 26, Train Loss 0.341901, Valid_loss 0.621086
Epoch 27, Train Loss 0.312662, Valid_loss 0.909043
Epoch 28, Train Loss 0.322733, Valid_loss 0.980437
Epoch 29, Train Loss 0.334046, Valid_loss 1.221230
Epoch 30, Train Loss 0.353171, Valid_loss 1.099796
Epoch 31, Train Loss 0.314450, Valid_loss 0.271152
Epoch 32, Train Loss 0.308453, Valid_loss 0.199022
Epoch 33, Train Loss 0.312920, Valid_loss 1.190354
Epoch 34, Train Loss 0.319985, Valid_loss 0.972515
Epoch 35, Train Loss 0.322567, Valid_loss 2.108607
Epoch 36, Train Loss 0.341740, Valid_loss 2.546477
Epoch 37, Train Loss 0.321640, Valid_loss 2.457364
Epoch 38, Train Loss 0.296539, Valid_loss 2.479716
Epoch 39, Train Loss 0.285528, Valid_loss 2.644494
Epoch 40, Train Loss 0.300148, Valid_loss 1.717274
Epoch 41, Train Loss 0.278937, Valid_loss 0.015478
Epoch 42, Train Loss 0.283614, Valid_loss 0.011526
Epoch 43, Train Loss 0.316411, Valid_loss 0.372170
Epoch 44, Train Loss 0.315110, Valid_loss 0.334186
Epoch 45, Train Loss 0.307742, Valid_loss 0.369996
Epoch 46, Train Loss 0.285096, Valid_loss 0.929395
Epoch 47, Train Loss 0.306351, Valid_loss 0.549570
Epoch 48, Train Loss 0.309038, Valid_loss 2.238852
Epoch 49, Train Loss 0.325433, Valid_loss 2.431883
Epoch 50, Train Loss 0.317216, Valid_loss 3.045899
Epoch 51, Train Loss 0.315213, Valid_loss 2.609632
Epoch 52, Train Loss 0.292804, Valid_loss 3.408976
Epoch 53, Train Loss 0.276948, Valid_loss 3.205359
Epoch 54, Train Loss 0.262965, Valid_loss 3.147092
Epoch 55, Train Loss 0.272403, Valid_loss 2.496018
Epoch 56, Train Loss 0.303686, Valid_loss 2.322117
Epoch 57, Train Loss 0.264044, Valid_loss 2.129838
Epoch 58, Train Loss 0.301999, Valid_loss 2.021473
Epoch 59, Train Loss 0.298105, Valid_loss 1.562076
Epoch 60, Train Loss 0.283915, Valid_loss 1.186538
Epoch 61, Train Loss 0.270352, Valid_loss 1.215910
Epoch 62, Train Loss 0.272267, Valid_loss 1.378828
[I 2025-08-30 07:57:51,017] Trial 2 finished with value: 0.011525955483583468 and parameters: {'learning_rate': 0.01, 'epochs': 100, 'heads': 1, 'dropout': 0.7, 'weight_decay': 0.001, 'emb_dim': 64, 'augment_num': 100, 'pca': False}. Best is trial 2 with value: 0.011525955483583468.
선택된 trial params: {'learning_rate': 0.01, 'epochs': 100, 'heads': 1, 'dropout': 0.7, 'weight_decay': 0.001, 'emb_dim': 64, 'augment_num': 100, 'pca': False}
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=10, batch_size=1 -> steps=10
output_class :  1
Memory Allocated: 27.97 MB
Memory Reserved: 46.00 MB
cuda
Epoch 1, Train Loss 0.690971, Valid_loss 0.607675
Epoch 2, Train Loss 0.675650, Valid_loss 0.597554
Epoch 3, Train Loss 0.664672, Valid_loss 0.668822
Epoch 4, Train Loss 0.672918, Valid_loss 0.598555
Epoch 5, Train Loss 0.667949, Valid_loss 0.604123
Epoch 6, Train Loss 0.646817, Valid_loss 0.599920
Epoch 7, Train Loss 0.632565, Valid_loss 0.579525
Epoch 8, Train Loss 0.618931, Valid_loss 0.465704
Epoch 9, Train Loss 0.562597, Valid_loss 0.310940
Epoch 10, Train Loss 0.480750, Valid_loss 0.552808
Epoch 11, Train Loss 0.403355, Valid_loss 1.107992
Epoch 12, Train Loss 0.416092, Valid_loss 1.223301
Epoch 13, Train Loss 0.399249, Valid_loss 0.360671
Epoch 14, Train Loss 0.383163, Valid_loss 1.485943
Epoch 15, Train Loss 0.386707, Valid_loss 1.750496
Epoch 16, Train Loss 0.363494, Valid_loss 1.830548
Epoch 17, Train Loss 0.358948, Valid_loss 0.074000
Epoch 18, Train Loss 0.429047, Valid_loss 0.801141
Epoch 19, Train Loss 0.389321, Valid_loss 1.291558
Epoch 20, Train Loss 0.351235, Valid_loss 1.583517
Epoch 21, Train Loss 0.334867, Valid_loss 0.323739
Epoch 22, Train Loss 0.344547, Valid_loss 0.238927
Epoch 23, Train Loss 0.330102, Valid_loss 1.377880
Epoch 24, Train Loss 0.323101, Valid_loss 1.307245
Epoch 25, Train Loss 0.309437, Valid_loss 1.419567
Epoch 26, Train Loss 0.302825, Valid_loss 1.488065
Epoch 27, Train Loss 0.287211, Valid_loss 1.350930
Epoch 28, Train Loss 0.357112, Valid_loss 1.440377
Epoch 29, Train Loss 0.309897, Valid_loss 2.335533
Epoch 30, Train Loss 0.283938, Valid_loss 0.790152
Epoch 31, Train Loss 0.306495, Valid_loss 1.059798
Epoch 32, Train Loss 0.342639, Valid_loss 1.104916
Epoch 33, Train Loss 0.339256, Valid_loss 1.305129
Epoch 34, Train Loss 0.325730, Valid_loss 0.341784
Epoch 35, Train Loss 0.327327, Valid_loss 0.542663
Epoch 36, Train Loss 0.294921, Valid_loss 1.459532
Epoch 37, Train Loss 0.320576, Valid_loss 0.430657
Epoch 38, Train Loss 0.325709, Valid_loss 0.115262
Epoch 39, Train Loss 0.293032, Valid_loss 0.376165
Epoch 40, Train Loss 0.342158, Valid_loss 0.566045
Epoch 41, Train Loss 0.352597, Valid_loss 0.294009
Epoch 42, Train Loss 0.331957, Valid_loss 1.045347
Epoch 43, Train Loss 0.335580, Valid_loss 0.232007
Epoch 44, Train Loss 0.279259, Valid_loss 0.163012
Epoch 45, Train Loss 0.282311, Valid_loss 0.256083
Epoch 46, Train Loss 0.310765, Valid_loss 0.829684
Epoch 47, Train Loss 0.347269, Valid_loss 1.761749
Epoch 48, Train Loss 0.348653, Valid_loss 1.886080
Epoch 49, Train Loss 0.287363, Valid_loss 1.422366
Epoch 50, Train Loss 0.315989, Valid_loss 0.308439
Epoch 51, Train Loss 0.396851, Valid_loss 0.582540
Epoch 52, Train Loss 0.274086, Valid_loss 0.379635
Epoch 53, Train Loss 0.300236, Valid_loss 1.387192
Epoch 54, Train Loss 0.283595, Valid_loss 1.522313
환자ID=COVID19_Participant11 -- true: 1 -- pred: 0
환자ID=COVID19_Participant14 -- true: 1 -- pred: 1
환자ID=COVID19_Participant18 -- true: 1 -- pred: 0
환자ID=COVID19_Participant19 -- true: 1 -- pred: 1
환자ID=COVID19_Participant2 -- true: 1 -- pred: 1
환자ID=COVID19_Participant25 -- true: 1 -- pred: 0
환자ID=COVID19_Participant31 -- true: 1 -- pred: 0
환자ID=Control_Participant1 -- true: 0 -- pred: 1
환자ID=Control_Participant10 -- true: 0 -- pred: 0
환자ID=Control_Participant7 -- true: 0 -- pred: 0
Best performance: Epoch 17, Loss 0.358948, Test ACC 0.500000, Test AUC 0.809524, Test Recall 0.428571, Test Precision 0.750000
Confusion Matrix:
 [2 1 4 3]
✅ Total valid splits used: 4
🔁 Repeat 2, Fold 4
cell type :  GTCGGGGGGTGG_Control_Participant7     Developing Ciliated Cells
CAAATCAATTAT_Control_Participant7     Developing Ciliated Cells
ATACAATTGACA_Control_Participant7     Developing Ciliated Cells
CTGTTAATGAGA_Control_Participant7     Developing Ciliated Cells
CTTCACATTATT_Control_Participant7     Developing Ciliated Cells
                                                ...            
GCAGGGAACTCC_COVID19_Participant30               Squamous Cells
CAGCACCGAGCC_COVID19_Participant30               Squamous Cells
GCCCCTTGTGAT_COVID19_Participant30               Squamous Cells
GTGTTGTGTGTC_COVID19_Participant30               Squamous Cells
TAACACTCACTT_COVID19_Participant30               Squamous Cells
Name: manual_annotation, Length: 22631, dtype: string
cell type annotation :  GTCGGGGGGTGG_Control_Participant7     Developing Ciliated Cells
CAAATCAATTAT_Control_Participant7     Developing Ciliated Cells
ATACAATTGACA_Control_Participant7     Developing Ciliated Cells
CTGTTAATGAGA_Control_Participant7     Developing Ciliated Cells
CTTCACATTATT_Control_Participant7     Developing Ciliated Cells
                                                ...            
GCAGGGAACTCC_COVID19_Participant30               Squamous Cells
CAGCACCGAGCC_COVID19_Participant30               Squamous Cells
GCCCCTTGTGAT_COVID19_Participant30               Squamous Cells
GTGTTGTGTGTC_COVID19_Participant30               Squamous Cells
TAACACTCACTT_COVID19_Participant30               Squamous Cells
Name: manual_annotation, Length: 22631, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Developing Ciliated Cells', 'Ciliated Cells', 'Secretory Cells', 'Squamous Cells', 'Goblet Cells', 'T Cells', 'Dendritic Cells', 'Basal Cells', 'Deuterosomal Cells', 'Mitotic Basal Cells', 'Developing Secretory and Goblet Cells', 'Macrophages', 'Plasmacytoid DCs', 'Ionocytes', 'Enteroendocrine Cells', 'B Cells', 'Erythroblasts', 'Mast Cells']
라벨별 그룹 개수 {1: 28, 0: 12}
cell type :  CATTAAGGATAT_COVID19_Participant13    Developing Ciliated Cells
GTAGAAGGGGGG_COVID19_Participant13    Developing Ciliated Cells
ATTAAGAGGTAG_COVID19_Participant13    Developing Ciliated Cells
AGATATGACAAG_COVID19_Participant13    Developing Ciliated Cells
CTTGTAACAAAT_COVID19_Participant13               Squamous Cells
                                                ...            
ACCATATTCAGG_COVID19_Participant21    Developing Ciliated Cells
GCCCGTTTCACG_COVID19_Participant21              Secretory Cells
TATTATCTCTTA_COVID19_Participant21    Developing Ciliated Cells
TTCCGTTTGTCC_COVID19_Participant21                 Goblet Cells
TCGGGATTGGAT_COVID19_Participant21               Ciliated Cells
Name: manual_annotation, Length: 4316, dtype: string
cell type annotation :  CATTAAGGATAT_COVID19_Participant13    Developing Ciliated Cells
GTAGAAGGGGGG_COVID19_Participant13    Developing Ciliated Cells
ATTAAGAGGTAG_COVID19_Participant13    Developing Ciliated Cells
AGATATGACAAG_COVID19_Participant13    Developing Ciliated Cells
CTTGTAACAAAT_COVID19_Participant13               Squamous Cells
                                                ...            
ACCATATTCAGG_COVID19_Participant21    Developing Ciliated Cells
GCCCGTTTCACG_COVID19_Participant21              Secretory Cells
TATTATCTCTTA_COVID19_Participant21    Developing Ciliated Cells
TTCCGTTTGTCC_COVID19_Participant21                 Goblet Cells
TCGGGATTGGAT_COVID19_Participant21               Ciliated Cells
Name: manual_annotation, Length: 4316, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Developing Ciliated Cells', 'Squamous Cells', 'Secretory Cells', 'Macrophages', 'B Cells', 'Ciliated Cells', 'T Cells', 'Dendritic Cells', 'Goblet Cells', 'Deuterosomal Cells', 'Basal Cells', 'Ionocytes', 'Mitotic Basal Cells', 'Developing Secretory and Goblet Cells', 'Enteroendocrine Cells', 'Plasmacytoid DCs', 'Erythroblasts']
라벨별 그룹 개수 {1: 7, 0: 3}
🔍 Split #5
  → train_p_index 환자 수 (환자 단위로 묶인 index list): 40
  → test_p_index 환자 수  (환자 단위로 묶인 index list): 10
  → train 환자 ID: ['COVID19_Participant10', 'COVID19_Participant11', 'COVID19_Participant12', 'COVID19_Participant14', 'COVID19_Participant15', 'COVID19_Participant17', 'COVID19_Participant18', 'COVID19_Participant19', 'COVID19_Participant2', 'COVID19_Participant20', 'COVID19_Participant22', 'COVID19_Participant23', 'COVID19_Participant25', 'COVID19_Participant26', 'COVID19_Participant27', 'COVID19_Participant28', 'COVID19_Participant3', 'COVID19_Participant30', 'COVID19_Participant31', 'COVID19_Participant32', 'COVID19_Participant35', 'COVID19_Participant36', 'COVID19_Participant37', 'COVID19_Participant38', 'COVID19_Participant4', 'COVID19_Participant7', 'COVID19_Participant8', 'COVID19_Participant9', 'Control_Participant1', 'Control_Participant10', 'Control_Participant12', 'Control_Participant13', 'Control_Participant2', 'Control_Participant3', 'Control_Participant4', 'Control_Participant5', 'Control_Participant6', 'Control_Participant7', 'Control_Participant8', 'Control_Participant9']
  → test  환자 ID: ['COVID19_Participant13', 'COVID19_Participant21', 'COVID19_Participant29', 'COVID19_Participant39', 'COVID19_Participant40', 'COVID19_Participant5', 'COVID19_Participant6', 'Control_Participant11', 'Control_Participant14', 'Control_Participant15']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant10, Label: 1
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant12, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant18, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant27, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant3, Label: 1
    ID: COVID19_Participant30, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant35, Label: 1
    ID: COVID19_Participant36, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant38, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: COVID19_Participant9, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant10, Label: 0
    ID: Control_Participant12, Label: 0
    ID: Control_Participant13, Label: 0
    ID: Control_Participant2, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant4, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant6, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant8, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant21, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: COVID19_Participant5, Label: 1
    ID: COVID19_Participant6, Label: 1
    ID: Control_Participant11, Label: 0
    ID: Control_Participant14, Label: 0
    ID: Control_Participant15, Label: 0
전체 데이터 index 길이 50
label_stat (train 환자 라벨 목록) 갯수 40
train_data에서 환자 단위로, train과 validation 나누기
기존 train_p_index 40
기존 (train) label_stat 40
train-vali 분할 후! 
train y 의 classes : {0, 1} valid y 의 classes : {0, 1} label_stat 의 classes : {0, 1}
train_p_index_ 26
valid_p_index 14
test_p_index 10
→ train 환자 ID 및 라벨:
   총 개수: 26
   환자ID=Control_Participant10, Label=0, 셀개수=1645
   환자ID=Control_Participant3, Label=0, 셀개수=1620
   환자ID=COVID19_Participant18, Label=1, 셀개수=227
   환자ID=COVID19_Participant36, Label=1, 셀개수=200
   환자ID=COVID19_Participant10, Label=1, 셀개수=18
   환자ID=Control_Participant6, Label=0, 셀개수=131
   환자ID=COVID19_Participant14, Label=1, 셀개수=382
   환자ID=COVID19_Participant19, Label=1, 셀개수=816
   환자ID=COVID19_Participant38, Label=1, 셀개수=51
   환자ID=COVID19_Participant12, Label=1, 셀개수=102
   환자ID=COVID19_Participant2, Label=1, 셀개수=329
   환자ID=Control_Participant4, Label=0, 셀개수=440
   환자ID=COVID19_Participant26, Label=1, 셀개수=814
   환자ID=Control_Participant8, Label=0, 셀개수=393
   환자ID=Control_Participant7, Label=0, 셀개수=762
   환자ID=COVID19_Participant15, Label=1, 셀개수=1003
   환자ID=Control_Participant9, Label=0, 셀개수=558
   환자ID=Control_Participant12, Label=0, 셀개수=99
   환자ID=COVID19_Participant22, Label=1, 셀개수=865
   환자ID=COVID19_Participant3, Label=1, 셀개수=104
   환자ID=COVID19_Participant25, Label=1, 셀개수=496
   환자ID=COVID19_Participant17, Label=1, 셀개수=843
   환자ID=COVID19_Participant7, Label=1, 셀개수=409
   환자ID=COVID19_Participant37, Label=1, 셀개수=668
   환자ID=COVID19_Participant35, Label=1, 셀개수=83
   환자ID=COVID19_Participant28, Label=1, 셀개수=1079
→ valid 환자 ID 및 라벨:
   총 개수: 14
   환자ID=Control_Participant2, Label=0, 셀개수=41
   환자ID=COVID19_Participant27, Label=1, 셀개수=93
   환자ID=COVID19_Participant31, Label=1, 셀개수=410
   환자ID=COVID19_Participant30, Label=1, 셀개수=116
   환자ID=COVID19_Participant4, Label=1, 셀개수=1680
   환자ID=COVID19_Participant20, Label=1, 셀개수=2033
   환자ID=Control_Participant5, Label=0, 셀개수=717
   환자ID=Control_Participant1, Label=0, 셀개수=414
   환자ID=COVID19_Participant9, Label=1, 셀개수=86
   환자ID=COVID19_Participant8, Label=1, 셀개수=462
   환자ID=Control_Participant13, Label=0, 셀개수=88
   환자ID=COVID19_Participant32, Label=1, 셀개수=1665
   환자ID=COVID19_Participant11, Label=1, 셀개수=382
   환자ID=COVID19_Participant23, Label=1, 셀개수=307
→ test 환자 ID 및 라벨:
   총 개수: 10
   환자ID=COVID19_Participant13, Label=1, 셀개수=730
   환자ID=COVID19_Participant21, Label=1, 셀개수=39
   환자ID=COVID19_Participant29, Label=1, 셀개수=573
   환자ID=COVID19_Participant39, Label=1, 셀개수=454
   환자ID=COVID19_Participant40, Label=1, 셀개수=381
   환자ID=COVID19_Participant5, Label=1, 셀개수=89
   환자ID=COVID19_Participant6, Label=1, 셀개수=84
   환자ID=Control_Participant11, Label=0, 셀개수=1164
   환자ID=Control_Participant14, Label=0, 셀개수=274
   환자ID=Control_Participant15, Label=0, 셀개수=528
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Ciliated Cells', 'Developing Ciliated Cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
전체 데이터 길이 26947
전체 cell type 길이 0        Developing Ciliated Cells
1        Developing Ciliated Cells
2        Developing Ciliated Cells
3        Developing Ciliated Cells
4        Developing Ciliated Cells
                   ...            
26942    Developing Ciliated Cells
26943              Secretory Cells
26944    Developing Ciliated Cells
26945                 Goblet Cells
26946               Ciliated Cells
Length: 26947, dtype: string
cell type의 NaN 개수 체크 0
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:10,  9.56it/s]  2%|▏         | 2/100 [00:00<00:11,  8.77it/s]  3%|▎         | 3/100 [00:00<00:15,  6.07it/s]  5%|▌         | 5/100 [00:00<00:12,  7.66it/s]  6%|▌         | 6/100 [00:00<00:11,  8.18it/s]  7%|▋         | 7/100 [00:00<00:10,  8.56it/s]  8%|▊         | 8/100 [00:00<00:10,  8.93it/s] 10%|█         | 10/100 [00:01<00:10,  8.89it/s] 11%|█         | 11/100 [00:01<00:12,  7.11it/s] 12%|█▏        | 12/100 [00:01<00:11,  7.66it/s] 13%|█▎        | 13/100 [00:01<00:10,  7.93it/s] 14%|█▍        | 14/100 [00:01<00:10,  8.33it/s] 15%|█▌        | 15/100 [00:01<00:09,  8.58it/s] 16%|█▌        | 16/100 [00:02<00:11,  7.19it/s] 17%|█▋        | 17/100 [00:02<00:10,  7.56it/s] 18%|█▊        | 18/100 [00:02<00:10,  7.87it/s] 19%|█▉        | 19/100 [00:02<00:09,  8.18it/s] 20%|██        | 20/100 [00:02<00:12,  6.45it/s] 21%|██        | 21/100 [00:02<00:11,  7.18it/s] 22%|██▏       | 22/100 [00:02<00:11,  6.65it/s] 24%|██▍       | 24/100 [00:03<00:10,  7.45it/s] 25%|██▌       | 25/100 [00:03<00:09,  7.81it/s] 27%|██▋       | 27/100 [00:03<00:08,  8.57it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.52it/s] 29%|██▉       | 29/100 [00:03<00:08,  8.74it/s] 31%|███       | 31/100 [00:03<00:07,  9.19it/s] 32%|███▏      | 32/100 [00:03<00:07,  8.88it/s] 33%|███▎      | 33/100 [00:04<00:07,  8.94it/s] 35%|███▌      | 35/100 [00:04<00:06,  9.37it/s] 36%|███▌      | 36/100 [00:04<00:07,  8.53it/s] 37%|███▋      | 37/100 [00:04<00:07,  8.66it/s] 38%|███▊      | 38/100 [00:04<00:07,  8.66it/s] 39%|███▉      | 39/100 [00:04<00:10,  5.88it/s] 40%|████      | 40/100 [00:05<00:09,  6.63it/s] 41%|████      | 41/100 [00:05<00:08,  7.27it/s] 42%|████▏     | 42/100 [00:05<00:07,  7.67it/s] 43%|████▎     | 43/100 [00:05<00:08,  7.07it/s] 44%|████▍     | 44/100 [00:05<00:07,  7.62it/s] 45%|████▌     | 45/100 [00:05<00:06,  8.11it/s] 46%|████▌     | 46/100 [00:05<00:08,  6.47it/s] 47%|████▋     | 47/100 [00:06<00:07,  6.89it/s] 49%|████▉     | 49/100 [00:06<00:06,  7.93it/s] 50%|█████     | 50/100 [00:06<00:06,  8.13it/s] 51%|█████     | 51/100 [00:06<00:05,  8.43it/s] 52%|█████▏    | 52/100 [00:06<00:05,  8.31it/s] 53%|█████▎    | 53/100 [00:06<00:07,  5.89it/s] 54%|█████▍    | 54/100 [00:06<00:06,  6.57it/s] 55%|█████▌    | 55/100 [00:07<00:06,  7.12it/s] 56%|█████▌    | 56/100 [00:07<00:08,  5.30it/s] 57%|█████▋    | 57/100 [00:07<00:07,  6.06it/s] 58%|█████▊    | 58/100 [00:07<00:06,  6.71it/s] 59%|█████▉    | 59/100 [00:07<00:05,  6.97it/s] 60%|██████    | 60/100 [00:07<00:05,  7.33it/s] 61%|██████    | 61/100 [00:07<00:05,  7.77it/s] 62%|██████▏   | 62/100 [00:08<00:06,  6.20it/s] 63%|██████▎   | 63/100 [00:08<00:05,  6.70it/s] 64%|██████▍   | 64/100 [00:08<00:04,  7.31it/s] 65%|██████▌   | 65/100 [00:08<00:04,  7.81it/s] 66%|██████▌   | 66/100 [00:08<00:05,  5.93it/s] 67%|██████▋   | 67/100 [00:08<00:05,  6.46it/s] 68%|██████▊   | 68/100 [00:09<00:04,  6.86it/s] 69%|██████▉   | 69/100 [00:09<00:04,  7.02it/s] 70%|███████   | 70/100 [00:09<00:04,  7.42it/s] 71%|███████   | 71/100 [00:09<00:03,  7.76it/s] 72%|███████▏  | 72/100 [00:09<00:03,  8.24it/s] 73%|███████▎  | 73/100 [00:09<00:03,  8.55it/s] 74%|███████▍  | 74/100 [00:09<00:03,  8.55it/s] 75%|███████▌  | 75/100 [00:09<00:03,  7.82it/s] 76%|███████▌  | 76/100 [00:10<00:03,  6.93it/s] 77%|███████▋  | 77/100 [00:10<00:03,  7.08it/s] 78%|███████▊  | 78/100 [00:10<00:02,  7.56it/s] 79%|███████▉  | 79/100 [00:10<00:02,  8.12it/s] 80%|████████  | 80/100 [00:10<00:02,  8.23it/s] 81%|████████  | 81/100 [00:10<00:02,  8.13it/s] 82%|████████▏ | 82/100 [00:10<00:02,  8.05it/s] 83%|████████▎ | 83/100 [00:10<00:02,  8.27it/s] 84%|████████▍ | 84/100 [00:11<00:01,  8.39it/s] 85%|████████▌ | 85/100 [00:11<00:01,  8.47it/s] 86%|████████▌ | 86/100 [00:11<00:01,  8.81it/s] 87%|████████▋ | 87/100 [00:11<00:01,  8.68it/s] 88%|████████▊ | 88/100 [00:11<00:01,  8.70it/s] 89%|████████▉ | 89/100 [00:11<00:01,  8.86it/s] 90%|█████████ | 90/100 [00:11<00:01,  8.96it/s] 91%|█████████ | 91/100 [00:11<00:01,  8.43it/s] 92%|█████████▏| 92/100 [00:11<00:00,  8.81it/s] 93%|█████████▎| 93/100 [00:12<00:00,  8.88it/s] 94%|█████████▍| 94/100 [00:12<00:00,  8.98it/s] 95%|█████████▌| 95/100 [00:12<00:00,  9.17it/s] 96%|█████████▌| 96/100 [00:12<00:00,  9.01it/s] 97%|█████████▋| 97/100 [00:12<00:00,  7.86it/s] 98%|█████████▊| 98/100 [00:12<00:00,  8.24it/s] 99%|█████████▉| 99/100 [00:12<00:00,  8.49it/s]100%|██████████| 100/100 [00:12<00:00,  8.80it/s]100%|██████████| 100/100 [00:12<00:00,  7.76it/s]
[I 2025-08-30 08:01:33,223] A new study created in memory with name: no-name-b08147e1-c604-4bb2-93db-c0cfa1feecbd
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 26.13 MB
Memory Reserved: 46.00 MB
cuda
Epoch 1, Train Loss 0.684214, Valid_loss 0.588773
Epoch 2, Train Loss 0.693594, Valid_loss 0.575491
Epoch 3, Train Loss 0.659060, Valid_loss 0.553070
Epoch 4, Train Loss 0.626346, Valid_loss 0.515784
Epoch 5, Train Loss 0.589892, Valid_loss 0.494449
Epoch 6, Train Loss 0.558537, Valid_loss 0.475511
Epoch 7, Train Loss 0.515440, Valid_loss 0.460797
Epoch 8, Train Loss 0.560159, Valid_loss 0.466468
Epoch 9, Train Loss 0.498164, Valid_loss 0.478720
Epoch 10, Train Loss 0.491392, Valid_loss 0.439772
Epoch 11, Train Loss 0.471462, Valid_loss 0.429928
Epoch 12, Train Loss 0.450558, Valid_loss 0.429777
Epoch 13, Train Loss 0.493188, Valid_loss 0.440301
Epoch 14, Train Loss 0.455945, Valid_loss 0.428325
Epoch 15, Train Loss 0.455471, Valid_loss 0.428289
Epoch 16, Train Loss 0.451675, Valid_loss 0.404636
Epoch 17, Train Loss 0.464932, Valid_loss 0.407961
Epoch 18, Train Loss 0.443917, Valid_loss 0.402293
Epoch 19, Train Loss 0.431075, Valid_loss 0.412411
Epoch 20, Train Loss 0.471380, Valid_loss 0.395895
Epoch 21, Train Loss 0.434605, Valid_loss 0.384852
Epoch 22, Train Loss 0.424830, Valid_loss 0.405118
Epoch 23, Train Loss 0.467694, Valid_loss 0.404175
Epoch 24, Train Loss 0.454219, Valid_loss 0.416017
Epoch 25, Train Loss 0.430476, Valid_loss 0.397580
Epoch 26, Train Loss 0.443872, Valid_loss 0.398383
Epoch 27, Train Loss 0.431377, Valid_loss 0.402499
Epoch 28, Train Loss 0.466785, Valid_loss 0.381546
Epoch 29, Train Loss 0.420200, Valid_loss 0.399011
Epoch 30, Train Loss 0.444503, Valid_loss 0.375876
Epoch 31, Train Loss 0.428309, Valid_loss 0.377656
Epoch 32, Train Loss 0.420065, Valid_loss 0.380119
Epoch 33, Train Loss 0.416452, Valid_loss 0.384539
Epoch 34, Train Loss 0.405162, Valid_loss 0.387709
Epoch 35, Train Loss 0.424418, Valid_loss 0.388669
Epoch 36, Train Loss 0.430591, Valid_loss 0.382933
Epoch 37, Train Loss 0.431212, Valid_loss 0.388681
Epoch 38, Train Loss 0.406822, Valid_loss 0.377013
Epoch 39, Train Loss 0.428816, Valid_loss 0.391491
Epoch 40, Train Loss 0.450159, Valid_loss 0.394044
Epoch 41, Train Loss 0.383208, Valid_loss 0.404970
Epoch 42, Train Loss 0.409912, Valid_loss 0.385432
Epoch 43, Train Loss 0.393650, Valid_loss 0.388812
Epoch 44, Train Loss 0.405863, Valid_loss 0.389981
Epoch 45, Train Loss 0.431056, Valid_loss 0.377986
Epoch 46, Train Loss 0.377119, Valid_loss 0.380121
Epoch 47, Train Loss 0.395743, Valid_loss 0.381219
Epoch 48, Train Loss 0.370681, Valid_loss 0.367125
Epoch 49, Train Loss 0.372869, Valid_loss 0.374136
Epoch 50, Train Loss 0.365744, Valid_loss 0.380480
Epoch 51, Train Loss 0.387344, Valid_loss 0.379200
Epoch 52, Train Loss 0.384618, Valid_loss 0.372278
Epoch 53, Train Loss 0.408574, Valid_loss 0.375567
Epoch 54, Train Loss 0.377553, Valid_loss 0.375275
Epoch 55, Train Loss 0.417070, Valid_loss 0.378410
Epoch 56, Train Loss 0.402624, Valid_loss 0.378890
[I 2025-08-30 08:05:59,508] Trial 0 finished with value: 0.3671248842562948 and parameters: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 4, 'dropout': 0.7, 'weight_decay': 0.001, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.3671248842562948.
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 26.13 MB
Memory Reserved: 46.00 MB
cuda
Epoch 1, Train Loss 0.658769, Valid_loss 0.586307
Epoch 2, Train Loss 0.529901, Valid_loss 0.455229
Epoch 3, Train Loss 0.382114, Valid_loss 0.332367
Epoch 4, Train Loss 0.316236, Valid_loss 0.668752
Epoch 5, Train Loss 0.315643, Valid_loss 0.268151
Epoch 6, Train Loss 0.255572, Valid_loss 0.310819
Epoch 7, Train Loss 0.245966, Valid_loss 0.309629
Epoch 8, Train Loss 0.239493, Valid_loss 0.393374
Epoch 9, Train Loss 0.225778, Valid_loss 0.382538
Epoch 10, Train Loss 0.222567, Valid_loss 0.363753
Epoch 11, Train Loss 0.222849, Valid_loss 0.305332
Epoch 12, Train Loss 0.233448, Valid_loss 0.432530
Epoch 13, Train Loss 0.217941, Valid_loss 0.502254
Epoch 14, Train Loss 0.217792, Valid_loss 0.533261
Epoch 15, Train Loss 0.216531, Valid_loss 0.467377
Epoch 16, Train Loss 0.215564, Valid_loss 0.454063
Epoch 17, Train Loss 0.208545, Valid_loss 0.433608
Epoch 18, Train Loss 0.240718, Valid_loss 0.418361
Epoch 19, Train Loss 0.223710, Valid_loss 0.379566
Epoch 20, Train Loss 0.233983, Valid_loss 0.468173
Epoch 21, Train Loss 0.215187, Valid_loss 0.323593
Epoch 22, Train Loss 0.206032, Valid_loss 0.334826
Epoch 23, Train Loss 0.211225, Valid_loss 0.364964
Epoch 24, Train Loss 0.212440, Valid_loss 0.346754
Epoch 25, Train Loss 0.201713, Valid_loss 0.362541
Epoch 26, Train Loss 0.204587, Valid_loss 0.391327
Epoch 27, Train Loss 0.202518, Valid_loss 0.355140
Epoch 28, Train Loss 0.200894, Valid_loss 0.361784
Epoch 29, Train Loss 0.204410, Valid_loss 0.340784
Epoch 30, Train Loss 0.202105, Valid_loss 0.461453
Epoch 31, Train Loss 0.200635, Valid_loss 0.435479
Epoch 32, Train Loss 0.207315, Valid_loss 0.405531
Epoch 33, Train Loss 0.208845, Valid_loss 0.376876
Epoch 34, Train Loss 0.207466, Valid_loss 0.383460
Epoch 35, Train Loss 0.201746, Valid_loss 0.427039
Epoch 36, Train Loss 0.206501, Valid_loss 0.385577
Epoch 37, Train Loss 0.200522, Valid_loss 0.345762
Epoch 38, Train Loss 0.201818, Valid_loss 0.330965
Epoch 39, Train Loss 0.205141, Valid_loss 0.526571
Epoch 40, Train Loss 0.204685, Valid_loss 0.321073
Epoch 41, Train Loss 0.197912, Valid_loss 0.374721
Epoch 42, Train Loss 0.234895, Valid_loss 0.286366
Epoch 43, Train Loss 0.219197, Valid_loss 0.353646
Epoch 44, Train Loss 0.203999, Valid_loss 0.350921
Epoch 45, Train Loss 0.204627, Valid_loss 0.307958
Epoch 46, Train Loss 0.198604, Valid_loss 0.295135
Epoch 47, Train Loss 0.196802, Valid_loss 0.306821
Epoch 48, Train Loss 0.195261, Valid_loss 0.251990
Epoch 49, Train Loss 0.205960, Valid_loss 0.251802
Epoch 50, Train Loss 0.200612, Valid_loss 0.275722
Epoch 51, Train Loss 0.196389, Valid_loss 0.253324
Epoch 52, Train Loss 0.193858, Valid_loss 0.254352
Epoch 53, Train Loss 0.197120, Valid_loss 0.277413
[I 2025-08-30 08:10:01,925] Trial 1 finished with value: 0.25180238515271675 and parameters: {'learning_rate': 0.01, 'epochs': 100, 'heads': 4, 'dropout': 0.0, 'weight_decay': 0.0001, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 1 with value: 0.25180238515271675.
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 26.13 MB
Memory Reserved: 46.00 MB
cuda
Epoch 1, Train Loss 0.590030, Valid_loss 0.519479
Epoch 2, Train Loss 0.426492, Valid_loss 0.413431
Epoch 3, Train Loss 0.368061, Valid_loss 0.380168
Epoch 4, Train Loss 0.331773, Valid_loss 0.393070
Epoch 5, Train Loss 0.315922, Valid_loss 0.320631
Epoch 6, Train Loss 0.296139, Valid_loss 0.341777
Epoch 7, Train Loss 0.286770, Valid_loss 0.331108
Epoch 8, Train Loss 0.282060, Valid_loss 0.297298
Epoch 9, Train Loss 0.275182, Valid_loss 0.339848
Epoch 10, Train Loss 0.269874, Valid_loss 0.309214
Epoch 11, Train Loss 0.264389, Valid_loss 0.325025
Epoch 12, Train Loss 0.260736, Valid_loss 0.394653
Epoch 13, Train Loss 0.257650, Valid_loss 0.322524
Epoch 14, Train Loss 0.246865, Valid_loss 0.323048
Epoch 15, Train Loss 0.247778, Valid_loss 0.354034
Epoch 16, Train Loss 0.251877, Valid_loss 0.371064
Epoch 17, Train Loss 0.238641, Valid_loss 0.331380
Epoch 18, Train Loss 0.242915, Valid_loss 0.310799
Epoch 19, Train Loss 0.239462, Valid_loss 0.299182
Epoch 20, Train Loss 0.230484, Valid_loss 0.338994
Epoch 21, Train Loss 0.225320, Valid_loss 0.306591
Epoch 22, Train Loss 0.216127, Valid_loss 0.320984
Epoch 23, Train Loss 0.225637, Valid_loss 0.296284
Epoch 24, Train Loss 0.222613, Valid_loss 0.318866
Epoch 25, Train Loss 0.217083, Valid_loss 0.359344
Epoch 26, Train Loss 0.216104, Valid_loss 0.362277
Epoch 27, Train Loss 0.219023, Valid_loss 0.360053
Epoch 28, Train Loss 0.218339, Valid_loss 0.377727
Epoch 29, Train Loss 0.230269, Valid_loss 0.354725
Epoch 30, Train Loss 0.220350, Valid_loss 0.341347
Epoch 31, Train Loss 0.217093, Valid_loss 0.351680
Epoch 32, Train Loss 0.224540, Valid_loss 0.343785
Epoch 33, Train Loss 0.226379, Valid_loss 0.340476
Epoch 34, Train Loss 0.216507, Valid_loss 0.331685
Epoch 35, Train Loss 0.242276, Valid_loss 0.428974
Epoch 36, Train Loss 0.241381, Valid_loss 0.329212
Epoch 37, Train Loss 0.232126, Valid_loss 0.320508
Epoch 38, Train Loss 0.229979, Valid_loss 0.370619
Epoch 39, Train Loss 0.222058, Valid_loss 0.328908
Epoch 40, Train Loss 0.214992, Valid_loss 0.334028
Epoch 41, Train Loss 0.215568, Valid_loss 0.339245
Epoch 42, Train Loss 0.212467, Valid_loss 0.344666
Epoch 43, Train Loss 0.212555, Valid_loss 0.385640
Epoch 44, Train Loss 0.214264, Valid_loss 0.343160
Epoch 45, Train Loss 0.212647, Valid_loss 0.401939
Epoch 46, Train Loss 0.211136, Valid_loss 0.390879
Epoch 47, Train Loss 0.215833, Valid_loss 0.379506
Epoch 48, Train Loss 0.229393, Valid_loss 0.358707
Epoch 49, Train Loss 0.224718, Valid_loss 0.374480
Epoch 50, Train Loss 0.241255, Valid_loss 0.471720
Epoch 51, Train Loss 0.228622, Valid_loss 0.317854
Epoch 52, Train Loss 0.228024, Valid_loss 0.324481
Epoch 53, Train Loss 0.214019, Valid_loss 0.335352
[I 2025-08-30 08:13:24,044] Trial 2 finished with value: 0.296284326219133 and parameters: {'learning_rate': 0.001, 'epochs': 100, 'heads': 1, 'dropout': 0.0, 'weight_decay': 0.01, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 1 with value: 0.25180238515271675.
선택된 trial params: {'learning_rate': 0.01, 'epochs': 100, 'heads': 4, 'dropout': 0.0, 'weight_decay': 0.0001, 'emb_dim': 32, 'augment_num': 100, 'pca': False}
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=10, batch_size=1 -> steps=10
output_class :  1
Memory Allocated: 26.13 MB
Memory Reserved: 46.00 MB
cuda
Epoch 1, Train Loss 0.686206, Valid_loss 0.699649
Epoch 2, Train Loss 0.667413, Valid_loss 0.617678
Epoch 3, Train Loss 0.663698, Valid_loss 0.602481
Epoch 4, Train Loss 0.650636, Valid_loss 0.607720
Epoch 5, Train Loss 0.651090, Valid_loss 0.613189
Epoch 6, Train Loss 0.646969, Valid_loss 0.608555
Epoch 7, Train Loss 0.649071, Valid_loss 0.612096
Epoch 8, Train Loss 0.650400, Valid_loss 0.616377
Epoch 9, Train Loss 0.654623, Valid_loss 0.607174
Epoch 10, Train Loss 0.650286, Valid_loss 0.609637
Epoch 11, Train Loss 0.648470, Valid_loss 0.613560
Epoch 12, Train Loss 0.650573, Valid_loss 0.620496
Epoch 13, Train Loss 0.649665, Valid_loss 0.611420
Epoch 14, Train Loss 0.648782, Valid_loss 0.610950
Epoch 15, Train Loss 0.649508, Valid_loss 0.625244
Epoch 16, Train Loss 0.648231, Valid_loss 0.609275
Epoch 17, Train Loss 0.650915, Valid_loss 0.617242
Epoch 18, Train Loss 0.646197, Valid_loss 0.659622
Epoch 19, Train Loss 0.658440, Valid_loss 0.605553
Epoch 20, Train Loss 0.584584, Valid_loss 0.799112
Epoch 21, Train Loss 0.674820, Valid_loss 0.604586
Epoch 22, Train Loss 0.651260, Valid_loss 0.615064
Epoch 23, Train Loss 0.644681, Valid_loss 0.612332
Epoch 24, Train Loss 0.643537, Valid_loss 0.602424
Epoch 25, Train Loss 0.662358, Valid_loss 0.603008
Epoch 26, Train Loss 0.648435, Valid_loss 0.619489
Epoch 27, Train Loss 0.652227, Valid_loss 0.616859
Epoch 28, Train Loss 0.644335, Valid_loss 0.618301
Epoch 29, Train Loss 0.643358, Valid_loss 0.608384
Epoch 30, Train Loss 0.647113, Valid_loss 0.611583
Epoch 31, Train Loss 0.645108, Valid_loss 0.615489
Epoch 32, Train Loss 0.636348, Valid_loss 0.584515
Epoch 33, Train Loss 0.552311, Valid_loss 0.461148
Epoch 34, Train Loss 0.512235, Valid_loss 0.791580
Epoch 35, Train Loss 0.727109, Valid_loss 0.654819
Epoch 36, Train Loss 0.550949, Valid_loss 0.591037
Epoch 37, Train Loss 0.502837, Valid_loss 0.587169
Epoch 38, Train Loss 0.468048, Valid_loss 0.468910
Epoch 39, Train Loss 0.415351, Valid_loss 0.421828
Epoch 40, Train Loss 0.378654, Valid_loss 0.552875
Epoch 41, Train Loss 0.329917, Valid_loss 0.553563
Epoch 42, Train Loss 0.361161, Valid_loss 0.522175
Epoch 43, Train Loss 0.397610, Valid_loss 0.367768
Epoch 44, Train Loss 0.361078, Valid_loss 0.317834
Epoch 45, Train Loss 0.373695, Valid_loss 0.293044
Epoch 46, Train Loss 0.354863, Valid_loss 0.282313
Epoch 47, Train Loss 0.321474, Valid_loss 0.287049
Epoch 48, Train Loss 0.324743, Valid_loss 0.419048
Epoch 49, Train Loss 0.349967, Valid_loss 0.435937
Epoch 50, Train Loss 0.370510, Valid_loss 0.421063
Epoch 51, Train Loss 0.329073, Valid_loss 0.374502
Epoch 52, Train Loss 0.323456, Valid_loss 0.369397
Epoch 53, Train Loss 0.327468, Valid_loss 0.344018
Epoch 54, Train Loss 0.328305, Valid_loss 0.341426
Epoch 55, Train Loss 0.330456, Valid_loss 0.335880
Epoch 56, Train Loss 0.317374, Valid_loss 0.350467
Epoch 57, Train Loss 0.316068, Valid_loss 0.315981
Epoch 58, Train Loss 0.319383, Valid_loss 0.320780
Epoch 59, Train Loss 0.312320, Valid_loss 0.339575
환자ID=COVID19_Participant13 -- true: 1 -- pred: 1
환자ID=COVID19_Participant21 -- true: 1 -- pred: 1
환자ID=COVID19_Participant29 -- true: 1 -- pred: 1
환자ID=COVID19_Participant39 -- true: 1 -- pred: 1
환자ID=COVID19_Participant40 -- true: 1 -- pred: 1
환자ID=COVID19_Participant5 -- true: 1 -- pred: 1
환자ID=COVID19_Participant6 -- true: 1 -- pred: 1
환자ID=Control_Participant11 -- true: 0 -- pred: 1
환자ID=Control_Participant14 -- true: 0 -- pred: 0
환자ID=Control_Participant15 -- true: 0 -- pred: 0
Best performance: Epoch 46, Loss 0.354863, Test ACC 0.900000, Test AUC 0.952381, Test Recall 1.000000, Test Precision 0.875000
Confusion Matrix:
 [2 1 0 7]
✅ Total valid splits used: 5

📌 Repeat 2: 평균 AUC = 0.9048, 표준편차 = 0.0522
Test ACC 평균 0.760000, Test Recall 평균 0.742857, Test Precision 평균 0.896429
fold_aucs = [0.9523809523809524, 0.9047619047619049, 0.9047619047619048, 0.8095238095238095, 0.9523809523809524]
NaN 개수: 0 / 전체 5개

🔁 Repeat 3, Fold 0
cell type :  GTCGGGGGGTGG_Control_Participant7     Developing Ciliated Cells
CAAATCAATTAT_Control_Participant7     Developing Ciliated Cells
ATACAATTGACA_Control_Participant7     Developing Ciliated Cells
CTGTTAATGAGA_Control_Participant7     Developing Ciliated Cells
CTTCACATTATT_Control_Participant7     Developing Ciliated Cells
                                                ...            
GCAGGGAACTCC_COVID19_Participant30               Squamous Cells
CAGCACCGAGCC_COVID19_Participant30               Squamous Cells
GCCCCTTGTGAT_COVID19_Participant30               Squamous Cells
GTGTTGTGTGTC_COVID19_Participant30               Squamous Cells
TAACACTCACTT_COVID19_Participant30               Squamous Cells
Name: manual_annotation, Length: 22638, dtype: string
cell type annotation :  GTCGGGGGGTGG_Control_Participant7     Developing Ciliated Cells
CAAATCAATTAT_Control_Participant7     Developing Ciliated Cells
ATACAATTGACA_Control_Participant7     Developing Ciliated Cells
CTGTTAATGAGA_Control_Participant7     Developing Ciliated Cells
CTTCACATTATT_Control_Participant7     Developing Ciliated Cells
                                                ...            
GCAGGGAACTCC_COVID19_Participant30               Squamous Cells
CAGCACCGAGCC_COVID19_Participant30               Squamous Cells
GCCCCTTGTGAT_COVID19_Participant30               Squamous Cells
GTGTTGTGTGTC_COVID19_Participant30               Squamous Cells
TAACACTCACTT_COVID19_Participant30               Squamous Cells
Name: manual_annotation, Length: 22638, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Developing Ciliated Cells', 'Ciliated Cells', 'Secretory Cells', 'Squamous Cells', 'Goblet Cells', 'T Cells', 'Dendritic Cells', 'Basal Cells', 'Deuterosomal Cells', 'Mitotic Basal Cells', 'Macrophages', 'B Cells', 'Ionocytes', 'Developing Secretory and Goblet Cells', 'Enteroendocrine Cells', 'Erythroblasts', 'Plasmacytoid DCs', 'Mast Cells']
라벨별 그룹 개수 {1: 28, 0: 12}
cell type :  TTGCGGTGACCA_COVID19_Participant31                           Ciliated Cells
AGGCTCGAACTG_COVID19_Participant31                           Ciliated Cells
TATCCGTATGTT_COVID19_Participant31                             Goblet Cells
CAGACAGCGGCT_COVID19_Participant31                              Basal Cells
CAAAGAGAACTA_COVID19_Participant31                           Ciliated Cells
                                                      ...                  
CGTATGTACGAG_COVID19_Participant9                              Goblet Cells
TCATAGGCTGGG_COVID19_Participant9                                   T Cells
AGGGATCAGGCG_COVID19_Participant9     Developing Secretory and Goblet Cells
TTCCTCATTAGC_COVID19_Participant9                              Goblet Cells
TCTAGGCCACAA_COVID19_Participant9                        Deuterosomal Cells
Name: manual_annotation, Length: 4309, dtype: string
cell type annotation :  TTGCGGTGACCA_COVID19_Participant31                           Ciliated Cells
AGGCTCGAACTG_COVID19_Participant31                           Ciliated Cells
TATCCGTATGTT_COVID19_Participant31                             Goblet Cells
CAGACAGCGGCT_COVID19_Participant31                              Basal Cells
CAAAGAGAACTA_COVID19_Participant31                           Ciliated Cells
                                                      ...                  
CGTATGTACGAG_COVID19_Participant9                              Goblet Cells
TCATAGGCTGGG_COVID19_Participant9                                   T Cells
AGGGATCAGGCG_COVID19_Participant9     Developing Secretory and Goblet Cells
TTCCTCATTAGC_COVID19_Participant9                              Goblet Cells
TCTAGGCCACAA_COVID19_Participant9                        Deuterosomal Cells
Name: manual_annotation, Length: 4309, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Ciliated Cells', 'Goblet Cells', 'Basal Cells', 'Developing Secretory and Goblet Cells', 'Macrophages', 'T Cells', 'Deuterosomal Cells', 'Mitotic Basal Cells', 'Developing Ciliated Cells', 'Secretory Cells', 'Squamous Cells', 'Plasmacytoid DCs', 'Ionocytes', 'Enteroendocrine Cells', 'Dendritic Cells', 'B Cells', 'Erythroblasts', 'Mast Cells']
라벨별 그룹 개수 {1: 7, 0: 3}
🔍 Split #1
  → train_p_index 환자 수 (환자 단위로 묶인 index list): 40
  → test_p_index 환자 수  (환자 단위로 묶인 index list): 10
  → train 환자 ID: ['COVID19_Participant10', 'COVID19_Participant12', 'COVID19_Participant13', 'COVID19_Participant14', 'COVID19_Participant15', 'COVID19_Participant18', 'COVID19_Participant2', 'COVID19_Participant20', 'COVID19_Participant21', 'COVID19_Participant22', 'COVID19_Participant23', 'COVID19_Participant26', 'COVID19_Participant27', 'COVID19_Participant28', 'COVID19_Participant29', 'COVID19_Participant3', 'COVID19_Participant30', 'COVID19_Participant32', 'COVID19_Participant35', 'COVID19_Participant36', 'COVID19_Participant37', 'COVID19_Participant38', 'COVID19_Participant39', 'COVID19_Participant4', 'COVID19_Participant5', 'COVID19_Participant6', 'COVID19_Participant7', 'COVID19_Participant8', 'Control_Participant10', 'Control_Participant11', 'Control_Participant12', 'Control_Participant13', 'Control_Participant14', 'Control_Participant15', 'Control_Participant3', 'Control_Participant5', 'Control_Participant6', 'Control_Participant7', 'Control_Participant8', 'Control_Participant9']
  → test  환자 ID: ['COVID19_Participant11', 'COVID19_Participant17', 'COVID19_Participant19', 'COVID19_Participant25', 'COVID19_Participant31', 'COVID19_Participant40', 'COVID19_Participant9', 'Control_Participant1', 'Control_Participant2', 'Control_Participant4']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant10, Label: 1
    ID: COVID19_Participant12, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant18, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant21, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant27, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant3, Label: 1
    ID: COVID19_Participant30, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant35, Label: 1
    ID: COVID19_Participant36, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant38, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant5, Label: 1
    ID: COVID19_Participant6, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: Control_Participant10, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant12, Label: 0
    ID: Control_Participant13, Label: 0
    ID: Control_Participant14, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant6, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant8, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: COVID19_Participant9, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant2, Label: 0
    ID: Control_Participant4, Label: 0
전체 데이터 index 길이 50
label_stat (train 환자 라벨 목록) 갯수 40
train_data에서 환자 단위로, train과 validation 나누기
기존 train_p_index 40
기존 (train) label_stat 40
train-vali 분할 후! 
train y 의 classes : {0, 1} valid y 의 classes : {0, 1} label_stat 의 classes : {0, 1}
train_p_index_ 26
valid_p_index 14
test_p_index 10
→ train 환자 ID 및 라벨:
   총 개수: 26
   환자ID=Control_Participant11, Label=0, 셀개수=1164
   환자ID=Control_Participant15, Label=0, 셀개수=528
   환자ID=COVID19_Participant2, Label=1, 셀개수=329
   환자ID=COVID19_Participant38, Label=1, 셀개수=51
   환자ID=COVID19_Participant10, Label=1, 셀개수=18
   환자ID=Control_Participant6, Label=0, 셀개수=131
   환자ID=COVID19_Participant14, Label=1, 셀개수=382
   환자ID=COVID19_Participant20, Label=1, 셀개수=2033
   환자ID=COVID19_Participant4, Label=1, 셀개수=1680
   환자ID=COVID19_Participant13, Label=1, 셀개수=730
   환자ID=COVID19_Participant21, Label=1, 셀개수=39
   환자ID=Control_Participant3, Label=0, 셀개수=1620
   환자ID=COVID19_Participant28, Label=1, 셀개수=1079
   환자ID=Control_Participant8, Label=0, 셀개수=393
   환자ID=Control_Participant7, Label=0, 셀개수=762
   환자ID=COVID19_Participant15, Label=1, 셀개수=1003
   환자ID=Control_Participant9, Label=0, 셀개수=558
   환자ID=Control_Participant12, Label=0, 셀개수=99
   환자ID=COVID19_Participant23, Label=1, 셀개수=307
   환자ID=COVID19_Participant30, Label=1, 셀개수=116
   환자ID=COVID19_Participant27, Label=1, 셀개수=93
   환자ID=COVID19_Participant18, Label=1, 셀개수=227
   환자ID=COVID19_Participant6, Label=1, 셀개수=84
   환자ID=COVID19_Participant39, Label=1, 셀개수=454
   환자ID=COVID19_Participant37, Label=1, 셀개수=668
   환자ID=COVID19_Participant3, Label=1, 셀개수=104
→ valid 환자 ID 및 라벨:
   총 개수: 14
   환자ID=Control_Participant14, Label=0, 셀개수=274
   환자ID=COVID19_Participant29, Label=1, 셀개수=573
   환자ID=COVID19_Participant35, Label=1, 셀개수=83
   환자ID=COVID19_Participant32, Label=1, 셀개수=1665
   환자ID=COVID19_Participant5, Label=1, 셀개수=89
   환자ID=COVID19_Participant22, Label=1, 셀개수=865
   환자ID=Control_Participant5, Label=0, 셀개수=717
   환자ID=Control_Participant10, Label=0, 셀개수=1645
   환자ID=COVID19_Participant8, Label=1, 셀개수=462
   환자ID=COVID19_Participant7, Label=1, 셀개수=409
   환자ID=Control_Participant13, Label=0, 셀개수=88
   환자ID=COVID19_Participant36, Label=1, 셀개수=200
   환자ID=COVID19_Participant12, Label=1, 셀개수=102
   환자ID=COVID19_Participant26, Label=1, 셀개수=814
→ test 환자 ID 및 라벨:
   총 개수: 10
   환자ID=COVID19_Participant11, Label=1, 셀개수=382
   환자ID=COVID19_Participant17, Label=1, 셀개수=843
   환자ID=COVID19_Participant19, Label=1, 셀개수=816
   환자ID=COVID19_Participant25, Label=1, 셀개수=496
   환자ID=COVID19_Participant31, Label=1, 셀개수=410
   환자ID=COVID19_Participant40, Label=1, 셀개수=381
   환자ID=COVID19_Participant9, Label=1, 셀개수=86
   환자ID=Control_Participant1, Label=0, 셀개수=414
   환자ID=Control_Participant2, Label=0, 셀개수=41
   환자ID=Control_Participant4, Label=0, 셀개수=440
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Ciliated Cells', 'Developing Ciliated Cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
전체 데이터 길이 26947
전체 cell type 길이 0                    Developing Ciliated Cells
1                    Developing Ciliated Cells
2                    Developing Ciliated Cells
3                    Developing Ciliated Cells
4                    Developing Ciliated Cells
                         ...                  
26942                             Goblet Cells
26943                                  T Cells
26944    Developing Secretory and Goblet Cells
26945                             Goblet Cells
26946                       Deuterosomal Cells
Length: 26947, dtype: string
cell type의 NaN 개수 체크 0
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  2%|▏         | 2/100 [00:00<00:09,  9.96it/s]  3%|▎         | 3/100 [00:00<00:13,  6.96it/s]  4%|▍         | 4/100 [00:00<00:13,  6.97it/s]  5%|▌         | 5/100 [00:00<00:12,  7.31it/s]  6%|▌         | 6/100 [00:00<00:16,  5.70it/s]  8%|▊         | 8/100 [00:01<00:13,  6.81it/s]  9%|▉         | 9/100 [00:01<00:14,  6.28it/s] 10%|█         | 10/100 [00:01<00:13,  6.59it/s] 12%|█▏        | 12/100 [00:01<00:13,  6.76it/s] 13%|█▎        | 13/100 [00:01<00:11,  7.27it/s] 15%|█▌        | 15/100 [00:02<00:11,  7.40it/s] 17%|█▋        | 17/100 [00:02<00:14,  5.55it/s] 19%|█▉        | 19/100 [00:02<00:12,  6.31it/s] 21%|██        | 21/100 [00:03<00:10,  7.36it/s] 22%|██▏       | 22/100 [00:03<00:10,  7.72it/s] 24%|██▍       | 24/100 [00:03<00:08,  8.46it/s] 26%|██▌       | 26/100 [00:03<00:08,  8.95it/s] 27%|██▋       | 27/100 [00:03<00:08,  8.91it/s] 28%|██▊       | 28/100 [00:03<00:07,  9.08it/s] 29%|██▉       | 29/100 [00:03<00:07,  9.00it/s] 30%|███       | 30/100 [00:03<00:07,  9.16it/s] 31%|███       | 31/100 [00:04<00:07,  8.95it/s] 32%|███▏      | 32/100 [00:04<00:07,  8.62it/s] 33%|███▎      | 33/100 [00:04<00:07,  8.84it/s] 34%|███▍      | 34/100 [00:04<00:07,  8.65it/s] 36%|███▌      | 36/100 [00:04<00:06,  9.37it/s] 37%|███▋      | 37/100 [00:04<00:07,  8.50it/s] 38%|███▊      | 38/100 [00:04<00:07,  8.78it/s] 39%|███▉      | 39/100 [00:05<00:07,  7.95it/s] 40%|████      | 40/100 [00:05<00:07,  8.33it/s] 42%|████▏     | 42/100 [00:05<00:09,  6.38it/s] 43%|████▎     | 43/100 [00:05<00:09,  5.90it/s] 44%|████▍     | 44/100 [00:05<00:08,  6.56it/s] 45%|████▌     | 45/100 [00:06<00:07,  7.13it/s] 47%|████▋     | 47/100 [00:06<00:07,  6.92it/s] 48%|████▊     | 48/100 [00:06<00:07,  7.09it/s] 49%|████▉     | 49/100 [00:06<00:06,  7.41it/s] 50%|█████     | 50/100 [00:06<00:07,  6.82it/s] 51%|█████     | 51/100 [00:06<00:06,  7.22it/s] 52%|█████▏    | 52/100 [00:06<00:06,  7.34it/s] 53%|█████▎    | 53/100 [00:07<00:06,  7.78it/s] 54%|█████▍    | 54/100 [00:07<00:06,  7.23it/s] 55%|█████▌    | 55/100 [00:07<00:05,  7.71it/s] 56%|█████▌    | 56/100 [00:07<00:05,  8.16it/s] 57%|█████▋    | 57/100 [00:07<00:05,  8.57it/s] 58%|█████▊    | 58/100 [00:07<00:04,  8.93it/s] 59%|█████▉    | 59/100 [00:07<00:04,  8.67it/s] 60%|██████    | 60/100 [00:07<00:04,  8.93it/s] 61%|██████    | 61/100 [00:08<00:04,  8.94it/s] 62%|██████▏   | 62/100 [00:08<00:06,  6.21it/s] 64%|██████▍   | 64/100 [00:08<00:04,  7.28it/s] 65%|██████▌   | 65/100 [00:08<00:04,  7.66it/s] 66%|██████▌   | 66/100 [00:08<00:04,  7.07it/s] 67%|██████▋   | 67/100 [00:08<00:04,  7.36it/s] 68%|██████▊   | 68/100 [00:09<00:04,  7.11it/s] 70%|███████   | 70/100 [00:09<00:03,  7.71it/s] 71%|███████   | 71/100 [00:09<00:04,  7.01it/s] 72%|███████▏  | 72/100 [00:09<00:04,  6.39it/s] 73%|███████▎  | 73/100 [00:09<00:03,  7.03it/s] 75%|███████▌  | 75/100 [00:09<00:03,  7.85it/s] 76%|███████▌  | 76/100 [00:10<00:02,  8.14it/s] 77%|███████▋  | 77/100 [00:10<00:02,  8.23it/s] 78%|███████▊  | 78/100 [00:10<00:02,  8.45it/s] 79%|███████▉  | 79/100 [00:10<00:02,  8.67it/s] 80%|████████  | 80/100 [00:10<00:02,  8.54it/s] 81%|████████  | 81/100 [00:10<00:02,  8.65it/s] 82%|████████▏ | 82/100 [00:10<00:02,  6.96it/s] 83%|████████▎ | 83/100 [00:11<00:02,  6.43it/s] 84%|████████▍ | 84/100 [00:11<00:02,  6.98it/s] 85%|████████▌ | 85/100 [00:11<00:01,  7.52it/s] 87%|████████▋ | 87/100 [00:11<00:01,  8.62it/s] 88%|████████▊ | 88/100 [00:11<00:01,  8.51it/s] 89%|████████▉ | 89/100 [00:11<00:01,  8.66it/s] 90%|█████████ | 90/100 [00:11<00:01,  8.75it/s] 91%|█████████ | 91/100 [00:11<00:01,  8.58it/s] 92%|█████████▏| 92/100 [00:12<00:00,  8.84it/s] 93%|█████████▎| 93/100 [00:12<00:00,  8.80it/s] 94%|█████████▍| 94/100 [00:12<00:00,  8.89it/s] 95%|█████████▌| 95/100 [00:12<00:00,  9.03it/s] 96%|█████████▌| 96/100 [00:12<00:00,  8.04it/s] 97%|█████████▋| 97/100 [00:12<00:00,  8.43it/s] 98%|█████████▊| 98/100 [00:12<00:00,  8.28it/s] 99%|█████████▉| 99/100 [00:12<00:00,  7.87it/s]100%|██████████| 100/100 [00:13<00:00,  7.77it/s]100%|██████████| 100/100 [00:13<00:00,  7.67it/s]
[I 2025-08-30 08:18:08,099] A new study created in memory with name: no-name-7bbd44a0-487e-4aff-86e7-004bb2234520
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 46.00 MB
cuda
Epoch 1, Train Loss 0.637888, Valid_loss 0.600985
Epoch 2, Train Loss 0.622074, Valid_loss 0.586083
Epoch 3, Train Loss 0.547206, Valid_loss 0.448332
Epoch 4, Train Loss 0.435876, Valid_loss 0.495509
Epoch 5, Train Loss 0.370345, Valid_loss 0.699230
Epoch 6, Train Loss 0.316887, Valid_loss 0.666278
Epoch 7, Train Loss 0.315937, Valid_loss 0.242430
Epoch 8, Train Loss 0.287440, Valid_loss 0.244407
Epoch 9, Train Loss 0.255751, Valid_loss 0.315026
Epoch 10, Train Loss 0.270154, Valid_loss 0.218986
Epoch 11, Train Loss 0.269556, Valid_loss 0.205445
Epoch 12, Train Loss 0.280425, Valid_loss 0.243195
Epoch 13, Train Loss 0.267867, Valid_loss 0.198779
Epoch 14, Train Loss 0.269212, Valid_loss 0.331823
Epoch 15, Train Loss 0.317337, Valid_loss 0.346403
Epoch 16, Train Loss 0.310181, Valid_loss 0.560439
Epoch 17, Train Loss 0.440058, Valid_loss 0.231730
Epoch 18, Train Loss 0.257879, Valid_loss 0.311260
Epoch 19, Train Loss 0.255245, Valid_loss 0.337736
Epoch 20, Train Loss 0.276778, Valid_loss 0.372014
Epoch 21, Train Loss 0.249237, Valid_loss 0.365001
Epoch 22, Train Loss 0.284369, Valid_loss 0.322587
Epoch 23, Train Loss 0.255083, Valid_loss 0.399796
Epoch 24, Train Loss 0.241380, Valid_loss 0.302463
Epoch 25, Train Loss 0.265570, Valid_loss 0.360506
Epoch 26, Train Loss 0.288799, Valid_loss 0.530119
Epoch 27, Train Loss 0.262877, Valid_loss 0.408069
Epoch 28, Train Loss 0.261172, Valid_loss 0.326764
Epoch 29, Train Loss 0.294885, Valid_loss 0.420844
Epoch 30, Train Loss 0.267057, Valid_loss 0.254482
Epoch 31, Train Loss 0.261928, Valid_loss 0.380148
Epoch 32, Train Loss 0.257451, Valid_loss 0.241514
Epoch 33, Train Loss 0.244909, Valid_loss 0.245339
Epoch 34, Train Loss 0.250606, Valid_loss 0.437258
Epoch 35, Train Loss 0.220785, Valid_loss 0.402155
Epoch 36, Train Loss 0.220886, Valid_loss 0.525977
Epoch 37, Train Loss 0.263283, Valid_loss 0.293975
Epoch 38, Train Loss 0.306188, Valid_loss 0.257398
Epoch 39, Train Loss 0.268188, Valid_loss 0.598403
Epoch 40, Train Loss 0.271138, Valid_loss 0.285406
Epoch 41, Train Loss 0.237562, Valid_loss 0.528408
Epoch 42, Train Loss 0.257500, Valid_loss 0.415218
Epoch 43, Train Loss 0.228786, Valid_loss 0.394911
Epoch 44, Train Loss 0.218016, Valid_loss 0.449552
Epoch 45, Train Loss 0.227875, Valid_loss 0.376941
Epoch 46, Train Loss 0.224059, Valid_loss 0.491165
Epoch 47, Train Loss 0.224055, Valid_loss 0.329072
Epoch 48, Train Loss 0.228187, Valid_loss 0.296350
Epoch 49, Train Loss 0.259439, Valid_loss 0.445838
Epoch 50, Train Loss 0.260900, Valid_loss 0.493012
Epoch 51, Train Loss 0.221099, Valid_loss 0.486235
Epoch 52, Train Loss 0.255316, Valid_loss 0.439400
Epoch 53, Train Loss 0.213076, Valid_loss 0.418826
Epoch 54, Train Loss 0.220979, Valid_loss 0.575516
Epoch 55, Train Loss 0.206107, Valid_loss 0.382448
Epoch 56, Train Loss 0.235802, Valid_loss 0.607409
Epoch 57, Train Loss 0.213504, Valid_loss 0.514804
Epoch 58, Train Loss 0.255144, Valid_loss 0.263009
Epoch 59, Train Loss 0.219787, Valid_loss 0.606135
Epoch 60, Train Loss 0.212029, Valid_loss 0.391001
Epoch 61, Train Loss 0.205184, Valid_loss 0.426143
Epoch 62, Train Loss 0.221299, Valid_loss 0.495718
[I 2025-08-30 08:22:21,102] Trial 0 finished with value: 0.19877904374152422 and parameters: {'learning_rate': 0.01, 'epochs': 100, 'heads': 2, 'dropout': 0.3, 'weight_decay': 0.001, 'emb_dim': 8, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.19877904374152422.
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 26.13 MB
Memory Reserved: 46.00 MB
cuda
Epoch 1, Train Loss 0.625230, Valid_loss 0.560576
Epoch 2, Train Loss 0.557808, Valid_loss 0.507150
Epoch 3, Train Loss 0.484601, Valid_loss 0.436606
Epoch 4, Train Loss 0.423387, Valid_loss 0.387539
Epoch 5, Train Loss 0.387595, Valid_loss 0.385087
Epoch 6, Train Loss 0.361469, Valid_loss 0.353753
Epoch 7, Train Loss 0.344745, Valid_loss 0.351200
Epoch 8, Train Loss 0.331846, Valid_loss 0.398299
Epoch 9, Train Loss 0.326644, Valid_loss 0.349499
Epoch 10, Train Loss 0.320322, Valid_loss 0.386406
Epoch 11, Train Loss 0.314989, Valid_loss 0.358187
Epoch 12, Train Loss 0.311388, Valid_loss 0.456364
Epoch 13, Train Loss 0.308799, Valid_loss 0.374940
Epoch 14, Train Loss 0.302609, Valid_loss 0.388926
Epoch 15, Train Loss 0.301331, Valid_loss 0.414872
Epoch 16, Train Loss 0.296592, Valid_loss 0.411806
Epoch 17, Train Loss 0.291564, Valid_loss 0.419278
Epoch 18, Train Loss 0.286613, Valid_loss 0.401070
Epoch 19, Train Loss 0.285601, Valid_loss 0.377601
Epoch 20, Train Loss 0.282300, Valid_loss 0.405792
Epoch 21, Train Loss 0.284668, Valid_loss 0.359459
Epoch 22, Train Loss 0.279970, Valid_loss 0.387856
Epoch 23, Train Loss 0.276016, Valid_loss 0.438120
Epoch 24, Train Loss 0.271788, Valid_loss 0.391088
Epoch 25, Train Loss 0.272158, Valid_loss 0.392074
Epoch 26, Train Loss 0.269979, Valid_loss 0.410212
Epoch 27, Train Loss 0.266293, Valid_loss 0.396564
Epoch 28, Train Loss 0.262016, Valid_loss 0.413010
Epoch 29, Train Loss 0.260698, Valid_loss 0.460575
Epoch 30, Train Loss 0.261110, Valid_loss 0.447410
Epoch 31, Train Loss 0.257998, Valid_loss 0.425580
Epoch 32, Train Loss 0.256906, Valid_loss 0.379817
Epoch 33, Train Loss 0.253760, Valid_loss 0.408372
Epoch 34, Train Loss 0.249458, Valid_loss 0.444091
Epoch 35, Train Loss 0.252692, Valid_loss 0.439591
Epoch 36, Train Loss 0.247094, Valid_loss 0.443524
Epoch 37, Train Loss 0.245970, Valid_loss 0.434885
Epoch 38, Train Loss 0.247816, Valid_loss 0.363011
Epoch 39, Train Loss 0.248210, Valid_loss 0.395371
Epoch 40, Train Loss 0.239945, Valid_loss 0.432351
Epoch 41, Train Loss 0.239894, Valid_loss 0.421315
Epoch 42, Train Loss 0.238253, Valid_loss 0.408116
Epoch 43, Train Loss 0.240428, Valid_loss 0.409296
Epoch 44, Train Loss 0.235996, Valid_loss 0.428212
Epoch 45, Train Loss 0.235826, Valid_loss 0.435690
Epoch 46, Train Loss 0.234180, Valid_loss 0.422540
Epoch 47, Train Loss 0.234284, Valid_loss 0.422868
Epoch 48, Train Loss 0.229576, Valid_loss 0.453955
Epoch 49, Train Loss 0.229618, Valid_loss 0.452435
Epoch 50, Train Loss 0.229080, Valid_loss 0.450701
Epoch 51, Train Loss 0.228570, Valid_loss 0.461616
Epoch 52, Train Loss 0.223901, Valid_loss 0.406143
Epoch 53, Train Loss 0.226017, Valid_loss 0.438315
Epoch 54, Train Loss 0.226010, Valid_loss 0.441035
[I 2025-08-30 08:25:57,602] Trial 1 finished with value: 0.3494985045066902 and parameters: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 2, 'dropout': 0.0, 'weight_decay': 0.001, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.19877904374152422.
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 26.13 MB
Memory Reserved: 46.00 MB
cuda
Epoch 1, Train Loss 0.662722, Valid_loss 0.679147
Epoch 2, Train Loss 0.648550, Valid_loss 0.599893
Epoch 3, Train Loss 0.636702, Valid_loss 0.607012
Epoch 4, Train Loss 0.627065, Valid_loss 0.598433
Epoch 5, Train Loss 0.628160, Valid_loss 0.610747
Epoch 6, Train Loss 0.617208, Valid_loss 0.598891
Epoch 7, Train Loss 0.625473, Valid_loss 0.602347
Epoch 8, Train Loss 0.622715, Valid_loss 0.599485
Epoch 9, Train Loss 0.621164, Valid_loss 0.599240
Epoch 10, Train Loss 0.595732, Valid_loss 0.498369
Epoch 11, Train Loss 0.627016, Valid_loss 0.593189
Epoch 12, Train Loss 0.598113, Valid_loss 0.467530
Epoch 13, Train Loss 0.410936, Valid_loss 0.731064
Epoch 14, Train Loss 0.409837, Valid_loss 0.318472
Epoch 15, Train Loss 0.308468, Valid_loss 0.339571
Epoch 16, Train Loss 0.255873, Valid_loss 0.216344
Epoch 17, Train Loss 0.233104, Valid_loss 0.230376
Epoch 18, Train Loss 0.217346, Valid_loss 0.300669
Epoch 19, Train Loss 0.209595, Valid_loss 0.300510
Epoch 20, Train Loss 0.204384, Valid_loss 0.485962
Epoch 21, Train Loss 0.202839, Valid_loss 0.547734
Epoch 22, Train Loss 0.197562, Valid_loss 0.417630
Epoch 23, Train Loss 0.212908, Valid_loss 0.561524
Epoch 24, Train Loss 0.218345, Valid_loss 0.645215
Epoch 25, Train Loss 0.215936, Valid_loss 0.342528
Epoch 26, Train Loss 0.219706, Valid_loss 0.732492
Epoch 27, Train Loss 0.249089, Valid_loss 0.529407
Epoch 28, Train Loss 0.218054, Valid_loss 0.421306
Epoch 29, Train Loss 0.206350, Valid_loss 0.375023
Epoch 30, Train Loss 0.183236, Valid_loss 0.548503
Epoch 31, Train Loss 0.186495, Valid_loss 0.527242
Epoch 32, Train Loss 0.185336, Valid_loss 0.417069
Epoch 33, Train Loss 0.178726, Valid_loss 0.347349
Epoch 34, Train Loss 0.186466, Valid_loss 0.316170
Epoch 35, Train Loss 0.180849, Valid_loss 0.481879
Epoch 36, Train Loss 0.207713, Valid_loss 0.414356
Epoch 37, Train Loss 0.204687, Valid_loss 0.352871
Epoch 38, Train Loss 0.199342, Valid_loss 0.365944
Epoch 39, Train Loss 0.215611, Valid_loss 0.303218
Epoch 40, Train Loss 0.186982, Valid_loss 0.418620
Epoch 41, Train Loss 0.185278, Valid_loss 0.323664
Epoch 42, Train Loss 0.173975, Valid_loss 0.395526
Epoch 43, Train Loss 0.176480, Valid_loss 0.480714
Epoch 44, Train Loss 0.190886, Valid_loss 0.489459
Epoch 45, Train Loss 0.183967, Valid_loss 0.609662
Epoch 46, Train Loss 0.178943, Valid_loss 0.491465
Epoch 47, Train Loss 0.186003, Valid_loss 0.421282
Epoch 48, Train Loss 0.171801, Valid_loss 0.312021
Epoch 49, Train Loss 0.179529, Valid_loss 0.342192
Epoch 50, Train Loss 0.172197, Valid_loss 0.363214
Epoch 51, Train Loss 0.170800, Valid_loss 0.451644
Epoch 52, Train Loss 0.164480, Valid_loss 0.374389
Epoch 53, Train Loss 0.162336, Valid_loss 0.410044
Epoch 54, Train Loss 0.160520, Valid_loss 0.508227
[I 2025-08-30 08:29:23,171] Trial 2 finished with value: 0.21634443423577718 and parameters: {'learning_rate': 0.01, 'epochs': 100, 'heads': 1, 'dropout': 0.0, 'weight_decay': 0.001, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.19877904374152422.
선택된 trial params: {'learning_rate': 0.01, 'epochs': 100, 'heads': 2, 'dropout': 0.3, 'weight_decay': 0.001, 'emb_dim': 8, 'augment_num': 100, 'pca': False}
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=10, batch_size=1 -> steps=10
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 46.00 MB
cuda
Epoch 1, Train Loss 0.679484, Valid_loss 0.610511
Epoch 2, Train Loss 0.624651, Valid_loss 0.603708
Epoch 3, Train Loss 0.630509, Valid_loss 0.606413
Epoch 4, Train Loss 0.615223, Valid_loss 0.572264
Epoch 5, Train Loss 0.636653, Valid_loss 0.608785
Epoch 6, Train Loss 0.618256, Valid_loss 0.604068
Epoch 7, Train Loss 0.615520, Valid_loss 0.602315
Epoch 8, Train Loss 0.607677, Valid_loss 0.598227
Epoch 9, Train Loss 0.626537, Valid_loss 0.599110
Epoch 10, Train Loss 0.620305, Valid_loss 0.602281
Epoch 11, Train Loss 0.605644, Valid_loss 0.550752
Epoch 12, Train Loss 0.515015, Valid_loss 0.534838
Epoch 13, Train Loss 0.475770, Valid_loss 0.246895
Epoch 14, Train Loss 0.429049, Valid_loss 0.315356
Epoch 15, Train Loss 0.375602, Valid_loss 0.410428
Epoch 16, Train Loss 0.325086, Valid_loss 0.208565
Epoch 17, Train Loss 0.303476, Valid_loss 0.129579
Epoch 18, Train Loss 0.342267, Valid_loss 0.314672
Epoch 19, Train Loss 0.377736, Valid_loss 0.301113
Epoch 20, Train Loss 0.291766, Valid_loss 0.354796
Epoch 21, Train Loss 0.268420, Valid_loss 0.201793
Epoch 22, Train Loss 0.261532, Valid_loss 0.313475
Epoch 23, Train Loss 0.294032, Valid_loss 0.570977
Epoch 24, Train Loss 0.282189, Valid_loss 0.301392
Epoch 25, Train Loss 0.283980, Valid_loss 0.435808
Epoch 26, Train Loss 0.285375, Valid_loss 0.291765
Epoch 27, Train Loss 0.288001, Valid_loss 0.346758
Epoch 28, Train Loss 0.265087, Valid_loss 0.386785
Epoch 29, Train Loss 0.264819, Valid_loss 0.492534
Epoch 30, Train Loss 0.262097, Valid_loss 0.538483
Epoch 31, Train Loss 0.264965, Valid_loss 0.554349
Epoch 32, Train Loss 0.271240, Valid_loss 0.274001
Epoch 33, Train Loss 0.245500, Valid_loss 0.319065
Epoch 34, Train Loss 0.259641, Valid_loss 0.489885
Epoch 35, Train Loss 0.255140, Valid_loss 0.500130
Epoch 36, Train Loss 0.256826, Valid_loss 0.484130
Epoch 37, Train Loss 0.256955, Valid_loss 0.462108
Epoch 38, Train Loss 0.273093, Valid_loss 0.284223
Epoch 39, Train Loss 0.269847, Valid_loss 0.271808
Epoch 40, Train Loss 0.243513, Valid_loss 0.524275
Epoch 41, Train Loss 0.244950, Valid_loss 0.431976
Epoch 42, Train Loss 0.233341, Valid_loss 0.553252
Epoch 43, Train Loss 0.237104, Valid_loss 0.622170
Epoch 44, Train Loss 0.216249, Valid_loss 0.365382
Epoch 45, Train Loss 0.234782, Valid_loss 0.263649
Epoch 46, Train Loss 0.230764, Valid_loss 0.193342
Epoch 47, Train Loss 0.286241, Valid_loss 0.274795
Epoch 48, Train Loss 0.261436, Valid_loss 0.688921
Epoch 49, Train Loss 0.238581, Valid_loss 0.304144
Epoch 50, Train Loss 0.228112, Valid_loss 0.458360
Epoch 51, Train Loss 0.205185, Valid_loss 0.461620
Epoch 52, Train Loss 0.201482, Valid_loss 0.412258
Epoch 53, Train Loss 0.231065, Valid_loss 0.440707
Epoch 54, Train Loss 0.213952, Valid_loss 0.406449
Epoch 55, Train Loss 0.212355, Valid_loss 0.428343
Epoch 56, Train Loss 0.192129, Valid_loss 0.414053
Epoch 57, Train Loss 0.206156, Valid_loss 0.446495
Epoch 58, Train Loss 0.195639, Valid_loss 0.498844
환자ID=COVID19_Participant11 -- true: 1 -- pred: 1
환자ID=COVID19_Participant17 -- true: 1 -- pred: 1
환자ID=COVID19_Participant19 -- true: 1 -- pred: 1
환자ID=COVID19_Participant25 -- true: 1 -- pred: 1
환자ID=COVID19_Participant31 -- true: 1 -- pred: 0
환자ID=COVID19_Participant40 -- true: 1 -- pred: 1
환자ID=COVID19_Participant9 -- true: 1 -- pred: 1
환자ID=Control_Participant1 -- true: 0 -- pred: 1
환자ID=Control_Participant2 -- true: 0 -- pred: 0
환자ID=Control_Participant4 -- true: 0 -- pred: 0
Best performance: Epoch 17, Loss 0.303476, Test ACC 0.800000, Test AUC 0.857143, Test Recall 0.857143, Test Precision 0.857143
Confusion Matrix:
 [2 1 1 6]
✅ Total valid splits used: 1
🔁 Repeat 3, Fold 1
cell type :  GTCGGGGGGTGG_Control_Participant7     Developing Ciliated Cells
CAAATCAATTAT_Control_Participant7     Developing Ciliated Cells
ATACAATTGACA_Control_Participant7     Developing Ciliated Cells
CTGTTAATGAGA_Control_Participant7     Developing Ciliated Cells
CTTCACATTATT_Control_Participant7     Developing Ciliated Cells
                                                ...            
CAGGTTGGTATC_COVID19_Participant20              Secretory Cells
TATAGCTTGGTA_COVID19_Participant20              Secretory Cells
TTGTTAGACGGT_COVID19_Participant20                      T Cells
ATGGCTCAGGCT_COVID19_Participant20              Secretory Cells
ACATGATCCTTT_COVID19_Participant20              Secretory Cells
Name: manual_annotation, Length: 22718, dtype: string
cell type annotation :  GTCGGGGGGTGG_Control_Participant7     Developing Ciliated Cells
CAAATCAATTAT_Control_Participant7     Developing Ciliated Cells
ATACAATTGACA_Control_Participant7     Developing Ciliated Cells
CTGTTAATGAGA_Control_Participant7     Developing Ciliated Cells
CTTCACATTATT_Control_Participant7     Developing Ciliated Cells
                                                ...            
CAGGTTGGTATC_COVID19_Participant20              Secretory Cells
TATAGCTTGGTA_COVID19_Participant20              Secretory Cells
TTGTTAGACGGT_COVID19_Participant20                      T Cells
ATGGCTCAGGCT_COVID19_Participant20              Secretory Cells
ACATGATCCTTT_COVID19_Participant20              Secretory Cells
Name: manual_annotation, Length: 22718, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Developing Ciliated Cells', 'Ciliated Cells', 'Secretory Cells', 'Squamous Cells', 'Goblet Cells', 'T Cells', 'Dendritic Cells', 'Basal Cells', 'Deuterosomal Cells', 'Mitotic Basal Cells', 'Macrophages', 'B Cells', 'Ionocytes', 'Developing Secretory and Goblet Cells', 'Plasmacytoid DCs', 'Enteroendocrine Cells', 'Erythroblasts', 'Mast Cells']
라벨별 그룹 개수 {1: 28, 0: 12}
cell type :  CGAACGGACTCC_Control_Participant12                           Squamous Cells
GTGTCCTGGGGT_Control_Participant12    Developing Secretory and Goblet Cells
ATTTGCCTGTCG_Control_Participant12                             Goblet Cells
TCTCTAAAGTGT_Control_Participant12                           Ciliated Cells
TAGAGACAACGA_Control_Participant12    Developing Secretory and Goblet Cells
                                                      ...                  
GCAGGGAACTCC_COVID19_Participant30                           Squamous Cells
CAGCACCGAGCC_COVID19_Participant30                           Squamous Cells
GCCCCTTGTGAT_COVID19_Participant30                           Squamous Cells
GTGTTGTGTGTC_COVID19_Participant30                           Squamous Cells
TAACACTCACTT_COVID19_Participant30                           Squamous Cells
Name: manual_annotation, Length: 4229, dtype: string
cell type annotation :  CGAACGGACTCC_Control_Participant12                           Squamous Cells
GTGTCCTGGGGT_Control_Participant12    Developing Secretory and Goblet Cells
ATTTGCCTGTCG_Control_Participant12                             Goblet Cells
TCTCTAAAGTGT_Control_Participant12                           Ciliated Cells
TAGAGACAACGA_Control_Participant12    Developing Secretory and Goblet Cells
                                                      ...                  
GCAGGGAACTCC_COVID19_Participant30                           Squamous Cells
CAGCACCGAGCC_COVID19_Participant30                           Squamous Cells
GCCCCTTGTGAT_COVID19_Participant30                           Squamous Cells
GTGTTGTGTGTC_COVID19_Participant30                           Squamous Cells
TAACACTCACTT_COVID19_Participant30                           Squamous Cells
Name: manual_annotation, Length: 4229, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Squamous Cells', 'Developing Secretory and Goblet Cells', 'Goblet Cells', 'Ciliated Cells', 'Basal Cells', 'Developing Ciliated Cells', 'Enteroendocrine Cells', 'Secretory Cells', 'T Cells', 'Mitotic Basal Cells', 'Ionocytes', 'Deuterosomal Cells', 'B Cells', 'Dendritic Cells', 'Erythroblasts', 'Macrophages', 'Plasmacytoid DCs']
라벨별 그룹 개수 {1: 7, 0: 3}
🔍 Split #2
  → train_p_index 환자 수 (환자 단위로 묶인 index list): 40
  → test_p_index 환자 수  (환자 단위로 묶인 index list): 10
  → train 환자 ID: ['COVID19_Participant10', 'COVID19_Participant11', 'COVID19_Participant12', 'COVID19_Participant13', 'COVID19_Participant14', 'COVID19_Participant17', 'COVID19_Participant19', 'COVID19_Participant2', 'COVID19_Participant20', 'COVID19_Participant21', 'COVID19_Participant22', 'COVID19_Participant23', 'COVID19_Participant25', 'COVID19_Participant26', 'COVID19_Participant27', 'COVID19_Participant28', 'COVID19_Participant29', 'COVID19_Participant31', 'COVID19_Participant32', 'COVID19_Participant35', 'COVID19_Participant36', 'COVID19_Participant37', 'COVID19_Participant38', 'COVID19_Participant4', 'COVID19_Participant40', 'COVID19_Participant5', 'COVID19_Participant8', 'COVID19_Participant9', 'Control_Participant1', 'Control_Participant11', 'Control_Participant14', 'Control_Participant15', 'Control_Participant2', 'Control_Participant3', 'Control_Participant4', 'Control_Participant5', 'Control_Participant6', 'Control_Participant7', 'Control_Participant8', 'Control_Participant9']
  → test  환자 ID: ['COVID19_Participant15', 'COVID19_Participant18', 'COVID19_Participant3', 'COVID19_Participant30', 'COVID19_Participant39', 'COVID19_Participant6', 'COVID19_Participant7', 'Control_Participant10', 'Control_Participant12', 'Control_Participant13']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant10, Label: 1
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant12, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant21, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant27, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant35, Label: 1
    ID: COVID19_Participant36, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant38, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: COVID19_Participant5, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: COVID19_Participant9, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant14, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant2, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant4, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant6, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant8, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant18, Label: 1
    ID: COVID19_Participant3, Label: 1
    ID: COVID19_Participant30, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant6, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: Control_Participant10, Label: 0
    ID: Control_Participant12, Label: 0
    ID: Control_Participant13, Label: 0
전체 데이터 index 길이 50
label_stat (train 환자 라벨 목록) 갯수 40
train_data에서 환자 단위로, train과 validation 나누기
기존 train_p_index 40
기존 (train) label_stat 40
train-vali 분할 후! 
train y 의 classes : {0, 1} valid y 의 classes : {0, 1} label_stat 의 classes : {0, 1}
train_p_index_ 26
valid_p_index 14
test_p_index 10
→ train 환자 ID 및 라벨:
   총 개수: 26
   환자ID=Control_Participant11, Label=0, 셀개수=1164
   환자ID=Control_Participant3, Label=0, 셀개수=1620
   환자ID=COVID19_Participant19, Label=1, 셀개수=816
   환자ID=COVID19_Participant37, Label=1, 셀개수=668
   환자ID=COVID19_Participant10, Label=1, 셀개수=18
   환자ID=Control_Participant6, Label=0, 셀개수=131
   환자ID=COVID19_Participant13, Label=1, 셀개수=730
   환자ID=COVID19_Participant2, Label=1, 셀개수=329
   환자ID=COVID19_Participant4, Label=1, 셀개수=1680
   환자ID=COVID19_Participant12, Label=1, 셀개수=102
   환자ID=COVID19_Participant20, Label=1, 셀개수=2033
   환자ID=Control_Participant4, Label=0, 셀개수=440
   환자ID=COVID19_Participant26, Label=1, 셀개수=814
   환자ID=Control_Participant8, Label=0, 셀개수=393
   환자ID=Control_Participant7, Label=0, 셀개수=762
   환자ID=COVID19_Participant14, Label=1, 셀개수=382
   환자ID=Control_Participant9, Label=0, 셀개수=558
   환자ID=Control_Participant14, Label=0, 셀개수=274
   환자ID=COVID19_Participant22, Label=1, 셀개수=865
   환자ID=COVID19_Participant29, Label=1, 셀개수=573
   환자ID=COVID19_Participant25, Label=1, 셀개수=496
   환자ID=COVID19_Participant17, Label=1, 셀개수=843
   환자ID=COVID19_Participant5, Label=1, 셀개수=89
   환자ID=COVID19_Participant38, Label=1, 셀개수=51
   환자ID=COVID19_Participant36, Label=1, 셀개수=200
   환자ID=COVID19_Participant28, Label=1, 셀개수=1079
→ valid 환자 ID 및 라벨:
   총 개수: 14
   환자ID=Control_Participant2, Label=0, 셀개수=41
   환자ID=COVID19_Participant27, Label=1, 셀개수=93
   환자ID=COVID19_Participant32, Label=1, 셀개수=1665
   환자ID=COVID19_Participant31, Label=1, 셀개수=410
   환자ID=COVID19_Participant40, Label=1, 셀개수=381
   환자ID=COVID19_Participant21, Label=1, 셀개수=39
   환자ID=Control_Participant5, Label=0, 셀개수=717
   환자ID=Control_Participant1, Label=0, 셀개수=414
   환자ID=COVID19_Participant9, Label=1, 셀개수=86
   환자ID=COVID19_Participant8, Label=1, 셀개수=462
   환자ID=Control_Participant15, Label=0, 셀개수=528
   환자ID=COVID19_Participant35, Label=1, 셀개수=83
   환자ID=COVID19_Participant11, Label=1, 셀개수=382
   환자ID=COVID19_Participant23, Label=1, 셀개수=307
→ test 환자 ID 및 라벨:
   총 개수: 10
   환자ID=COVID19_Participant15, Label=1, 셀개수=1003
   환자ID=COVID19_Participant18, Label=1, 셀개수=227
   환자ID=COVID19_Participant3, Label=1, 셀개수=104
   환자ID=COVID19_Participant30, Label=1, 셀개수=116
   환자ID=COVID19_Participant39, Label=1, 셀개수=454
   환자ID=COVID19_Participant6, Label=1, 셀개수=84
   환자ID=COVID19_Participant7, Label=1, 셀개수=409
   환자ID=Control_Participant10, Label=0, 셀개수=1645
   환자ID=Control_Participant12, Label=0, 셀개수=99
   환자ID=Control_Participant13, Label=0, 셀개수=88
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Ciliated Cells', 'Developing Ciliated Cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
전체 데이터 길이 26947
전체 cell type 길이 0        Developing Ciliated Cells
1        Developing Ciliated Cells
2        Developing Ciliated Cells
3        Developing Ciliated Cells
4        Developing Ciliated Cells
                   ...            
26942               Squamous Cells
26943               Squamous Cells
26944               Squamous Cells
26945               Squamous Cells
26946               Squamous Cells
Length: 26947, dtype: string
cell type의 NaN 개수 체크 0
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  2%|▏         | 2/100 [00:00<00:09, 10.47it/s]  4%|▍         | 4/100 [00:00<00:08, 10.77it/s]  6%|▌         | 6/100 [00:00<00:09,  9.93it/s]  8%|▊         | 8/100 [00:00<00:09,  9.77it/s] 10%|█         | 10/100 [00:01<00:09,  9.66it/s] 11%|█         | 11/100 [00:01<00:09,  9.06it/s] 13%|█▎        | 13/100 [00:01<00:10,  8.01it/s] 14%|█▍        | 14/100 [00:01<00:11,  7.75it/s] 16%|█▌        | 16/100 [00:01<00:12,  6.63it/s] 17%|█▋        | 17/100 [00:02<00:15,  5.45it/s] 18%|█▊        | 18/100 [00:02<00:13,  6.06it/s] 19%|█▉        | 19/100 [00:02<00:12,  6.37it/s] 21%|██        | 21/100 [00:02<00:10,  7.64it/s] 22%|██▏       | 22/100 [00:02<00:10,  7.51it/s] 23%|██▎       | 23/100 [00:02<00:09,  8.00it/s] 25%|██▌       | 25/100 [00:03<00:08,  8.55it/s] 27%|██▋       | 27/100 [00:03<00:08,  9.00it/s] 28%|██▊       | 28/100 [00:03<00:07,  9.10it/s] 29%|██▉       | 29/100 [00:03<00:07,  9.25it/s] 30%|███       | 30/100 [00:03<00:08,  8.00it/s] 32%|███▏      | 32/100 [00:03<00:07,  8.86it/s] 33%|███▎      | 33/100 [00:04<00:07,  9.05it/s] 35%|███▌      | 35/100 [00:04<00:06,  9.34it/s] 37%|███▋      | 37/100 [00:04<00:06,  9.39it/s] 39%|███▉      | 39/100 [00:04<00:06,  9.71it/s] 40%|████      | 40/100 [00:04<00:06,  9.49it/s] 41%|████      | 41/100 [00:04<00:07,  7.99it/s] 42%|████▏     | 42/100 [00:05<00:09,  6.01it/s] 43%|████▎     | 43/100 [00:05<00:08,  6.66it/s] 44%|████▍     | 44/100 [00:05<00:07,  7.23it/s] 45%|████▌     | 45/100 [00:05<00:07,  7.53it/s] 46%|████▌     | 46/100 [00:05<00:06,  8.06it/s] 47%|████▋     | 47/100 [00:05<00:06,  8.29it/s] 48%|████▊     | 48/100 [00:05<00:06,  8.39it/s] 49%|████▉     | 49/100 [00:06<00:06,  7.35it/s] 50%|█████     | 50/100 [00:06<00:06,  7.34it/s] 52%|█████▏    | 52/100 [00:06<00:05,  8.23it/s] 53%|█████▎    | 53/100 [00:06<00:08,  5.26it/s] 54%|█████▍    | 54/100 [00:06<00:07,  5.85it/s] 56%|█████▌    | 56/100 [00:07<00:06,  7.09it/s] 57%|█████▋    | 57/100 [00:07<00:05,  7.56it/s] 58%|█████▊    | 58/100 [00:07<00:05,  7.88it/s] 59%|█████▉    | 59/100 [00:07<00:05,  7.36it/s] 60%|██████    | 60/100 [00:07<00:05,  7.60it/s] 61%|██████    | 61/100 [00:07<00:05,  7.71it/s] 62%|██████▏   | 62/100 [00:07<00:04,  8.19it/s] 63%|██████▎   | 63/100 [00:07<00:04,  8.51it/s] 64%|██████▍   | 64/100 [00:08<00:04,  8.36it/s] 65%|██████▌   | 65/100 [00:08<00:04,  8.60it/s] 66%|██████▌   | 66/100 [00:08<00:04,  8.16it/s] 67%|██████▋   | 67/100 [00:08<00:04,  6.83it/s] 68%|██████▊   | 68/100 [00:08<00:04,  7.28it/s] 69%|██████▉   | 69/100 [00:08<00:04,  7.28it/s] 70%|███████   | 70/100 [00:08<00:03,  7.90it/s] 71%|███████   | 71/100 [00:09<00:03,  8.41it/s] 72%|███████▏  | 72/100 [00:09<00:03,  8.63it/s] 73%|███████▎  | 73/100 [00:09<00:03,  8.92it/s] 74%|███████▍  | 74/100 [00:09<00:03,  8.62it/s] 76%|███████▌  | 76/100 [00:09<00:02,  8.27it/s] 78%|███████▊  | 78/100 [00:10<00:03,  6.27it/s] 80%|████████  | 80/100 [00:10<00:02,  7.19it/s] 81%|████████  | 81/100 [00:10<00:02,  7.09it/s] 82%|████████▏ | 82/100 [00:10<00:02,  7.45it/s] 83%|████████▎ | 83/100 [00:10<00:02,  7.91it/s] 84%|████████▍ | 84/100 [00:10<00:02,  7.87it/s] 85%|████████▌ | 85/100 [00:10<00:02,  6.74it/s] 86%|████████▌ | 86/100 [00:11<00:01,  7.39it/s] 88%|████████▊ | 88/100 [00:11<00:01,  8.24it/s] 89%|████████▉ | 89/100 [00:11<00:01,  8.59it/s] 90%|█████████ | 90/100 [00:11<00:01,  7.98it/s] 91%|█████████ | 91/100 [00:11<00:01,  8.26it/s] 92%|█████████▏| 92/100 [00:11<00:00,  8.58it/s] 94%|█████████▍| 94/100 [00:12<00:00,  7.69it/s] 95%|█████████▌| 95/100 [00:12<00:00,  8.00it/s] 96%|█████████▌| 96/100 [00:12<00:00,  8.06it/s] 97%|█████████▋| 97/100 [00:12<00:00,  8.21it/s] 98%|█████████▊| 98/100 [00:12<00:00,  6.82it/s] 99%|█████████▉| 99/100 [00:12<00:00,  7.34it/s]100%|██████████| 100/100 [00:12<00:00,  7.29it/s]100%|██████████| 100/100 [00:12<00:00,  7.81it/s]
[I 2025-08-30 08:33:34,141] A new study created in memory with name: no-name-b35d8be4-4438-4250-a8ea-8b5a47042fc9
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 26.13 MB
Memory Reserved: 46.00 MB
cuda
Epoch 1, Train Loss 0.698386, Valid_loss 0.629792
Epoch 2, Train Loss 0.596606, Valid_loss 0.573141
Epoch 3, Train Loss 0.553202, Valid_loss 0.547527
Epoch 4, Train Loss 0.525217, Valid_loss 0.526961
Epoch 5, Train Loss 0.505011, Valid_loss 0.499494
Epoch 6, Train Loss 0.473892, Valid_loss 0.485048
Epoch 7, Train Loss 0.434411, Valid_loss 0.490047
Epoch 8, Train Loss 0.430398, Valid_loss 0.474854
Epoch 9, Train Loss 0.401224, Valid_loss 0.485622
Epoch 10, Train Loss 0.369578, Valid_loss 0.493181
Epoch 11, Train Loss 0.372821, Valid_loss 0.494469
Epoch 12, Train Loss 0.375403, Valid_loss 0.499106
Epoch 13, Train Loss 0.352661, Valid_loss 0.521072
Epoch 14, Train Loss 0.335294, Valid_loss 0.497367
Epoch 15, Train Loss 0.346832, Valid_loss 0.507522
Epoch 16, Train Loss 0.346262, Valid_loss 0.507114
Epoch 17, Train Loss 0.335642, Valid_loss 0.506340
Epoch 18, Train Loss 0.321161, Valid_loss 0.493871
Epoch 19, Train Loss 0.324776, Valid_loss 0.485424
Epoch 20, Train Loss 0.344944, Valid_loss 0.511153
Epoch 21, Train Loss 0.325427, Valid_loss 0.509379
Epoch 22, Train Loss 0.335592, Valid_loss 0.496649
Epoch 23, Train Loss 0.316615, Valid_loss 0.483039
Epoch 24, Train Loss 0.321707, Valid_loss 0.486302
Epoch 25, Train Loss 0.323065, Valid_loss 0.515843
Epoch 26, Train Loss 0.340624, Valid_loss 0.501938
Epoch 27, Train Loss 0.283844, Valid_loss 0.498937
Epoch 28, Train Loss 0.304025, Valid_loss 0.483199
Epoch 29, Train Loss 0.306252, Valid_loss 0.497427
Epoch 30, Train Loss 0.281290, Valid_loss 0.488477
Epoch 31, Train Loss 0.305569, Valid_loss 0.497124
Epoch 32, Train Loss 0.316183, Valid_loss 0.495026
Epoch 33, Train Loss 0.288741, Valid_loss 0.506645
Epoch 34, Train Loss 0.294497, Valid_loss 0.495055
Epoch 35, Train Loss 0.283119, Valid_loss 0.481964
Epoch 36, Train Loss 0.288502, Valid_loss 0.531018
Epoch 37, Train Loss 0.314776, Valid_loss 0.504252
Epoch 38, Train Loss 0.287803, Valid_loss 0.487208
Epoch 39, Train Loss 0.290925, Valid_loss 0.502728
Epoch 40, Train Loss 0.271082, Valid_loss 0.492015
Epoch 41, Train Loss 0.285168, Valid_loss 0.495622
Epoch 42, Train Loss 0.282313, Valid_loss 0.486214
Epoch 43, Train Loss 0.294633, Valid_loss 0.497113
Epoch 44, Train Loss 0.288283, Valid_loss 0.470858
Epoch 45, Train Loss 0.279955, Valid_loss 0.513408
Epoch 46, Train Loss 0.264793, Valid_loss 0.458421
Epoch 47, Train Loss 0.280780, Valid_loss 0.490904
Epoch 48, Train Loss 0.289639, Valid_loss 0.467570
Epoch 49, Train Loss 0.270666, Valid_loss 0.468637
Epoch 50, Train Loss 0.263148, Valid_loss 0.496158
Epoch 51, Train Loss 0.253774, Valid_loss 0.455776
Epoch 52, Train Loss 0.259428, Valid_loss 0.458406
Epoch 53, Train Loss 0.257191, Valid_loss 0.454767
Epoch 54, Train Loss 0.263230, Valid_loss 0.468834
Epoch 55, Train Loss 0.283253, Valid_loss 0.458635
Epoch 56, Train Loss 0.249560, Valid_loss 0.444907
Epoch 57, Train Loss 0.268402, Valid_loss 0.472861
Epoch 58, Train Loss 0.269930, Valid_loss 0.486058
[I 2025-08-30 08:37:18,230] Trial 0 finished with value: 0.4449074683444841 and parameters: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 1, 'dropout': 0.5, 'weight_decay': 0.0001, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.4449074683444841.
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 46.00 MB
cuda
Epoch 1, Train Loss 0.656666, Valid_loss 0.599019
Epoch 2, Train Loss 0.600098, Valid_loss 0.588287
Epoch 3, Train Loss 0.550375, Valid_loss 0.497101
Epoch 4, Train Loss 0.392784, Valid_loss 0.509718
Epoch 5, Train Loss 0.298297, Valid_loss 0.540087
Epoch 6, Train Loss 0.336157, Valid_loss 0.988953
Epoch 7, Train Loss 0.399481, Valid_loss 0.422789
Epoch 8, Train Loss 0.286250, Valid_loss 0.390689
Epoch 9, Train Loss 0.234298, Valid_loss 0.529180
Epoch 10, Train Loss 0.210519, Valid_loss 0.573070
Epoch 11, Train Loss 0.199263, Valid_loss 0.518248
Epoch 12, Train Loss 0.193740, Valid_loss 0.485131
Epoch 13, Train Loss 0.193060, Valid_loss 0.479497
Epoch 14, Train Loss 0.193646, Valid_loss 0.469108
Epoch 15, Train Loss 0.184827, Valid_loss 0.435310
Epoch 16, Train Loss 0.178735, Valid_loss 0.467294
Epoch 17, Train Loss 0.178151, Valid_loss 0.423570
Epoch 18, Train Loss 0.177273, Valid_loss 0.462733
Epoch 19, Train Loss 0.169654, Valid_loss 0.404273
Epoch 20, Train Loss 0.167140, Valid_loss 0.452250
Epoch 21, Train Loss 0.166378, Valid_loss 0.400248
Epoch 22, Train Loss 0.164272, Valid_loss 0.403173
Epoch 23, Train Loss 0.162097, Valid_loss 0.420794
Epoch 24, Train Loss 0.160856, Valid_loss 0.449700
Epoch 25, Train Loss 0.160215, Valid_loss 0.347297
Epoch 26, Train Loss 0.161312, Valid_loss 0.398849
Epoch 27, Train Loss 0.158650, Valid_loss 0.368114
Epoch 28, Train Loss 0.157699, Valid_loss 0.402513
Epoch 29, Train Loss 0.156110, Valid_loss 0.423739
Epoch 30, Train Loss 0.151419, Valid_loss 0.407824
Epoch 31, Train Loss 0.156102, Valid_loss 0.411954
Epoch 32, Train Loss 0.154811, Valid_loss 0.427592
Epoch 33, Train Loss 0.156682, Valid_loss 0.410127
Epoch 34, Train Loss 0.239952, Valid_loss 0.439004
Epoch 35, Train Loss 0.186040, Valid_loss 0.408615
Epoch 36, Train Loss 0.166694, Valid_loss 0.451217
Epoch 37, Train Loss 0.162933, Valid_loss 0.395242
Epoch 38, Train Loss 0.159644, Valid_loss 0.372527
Epoch 39, Train Loss 0.154407, Valid_loss 0.428920
Epoch 40, Train Loss 0.152895, Valid_loss 0.402353
Epoch 41, Train Loss 0.148894, Valid_loss 0.458466
Epoch 42, Train Loss 0.152465, Valid_loss 0.471487
Epoch 43, Train Loss 0.155759, Valid_loss 0.460966
Epoch 44, Train Loss 0.146086, Valid_loss 0.508410
Epoch 45, Train Loss 0.151805, Valid_loss 0.386168
Epoch 46, Train Loss 0.148299, Valid_loss 0.379770
Epoch 47, Train Loss 0.149188, Valid_loss 0.397270
Epoch 48, Train Loss 0.148423, Valid_loss 0.366244
Epoch 49, Train Loss 0.148468, Valid_loss 0.393051
Epoch 50, Train Loss 0.148657, Valid_loss 0.417931
Epoch 51, Train Loss 0.144655, Valid_loss 0.420217
Epoch 52, Train Loss 0.141258, Valid_loss 0.395546
Epoch 53, Train Loss 0.144584, Valid_loss 0.419321
Epoch 54, Train Loss 0.141588, Valid_loss 0.437879
[I 2025-08-30 08:40:56,917] Trial 1 finished with value: 0.3472968988852309 and parameters: {'learning_rate': 0.01, 'epochs': 100, 'heads': 2, 'dropout': 0.0, 'weight_decay': 0.0001, 'emb_dim': 8, 'augment_num': 100, 'pca': False}. Best is trial 1 with value: 0.3472968988852309.
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 26.13 MB
Memory Reserved: 46.00 MB
cuda
Epoch 1, Train Loss 0.687819, Valid_loss 0.597228
Epoch 2, Train Loss 0.622262, Valid_loss 0.560869
Epoch 3, Train Loss 0.560120, Valid_loss 0.516237
Epoch 4, Train Loss 0.502206, Valid_loss 0.518232
Epoch 5, Train Loss 0.429930, Valid_loss 0.492875
Epoch 6, Train Loss 0.418376, Valid_loss 0.496123
Epoch 7, Train Loss 0.365491, Valid_loss 0.480371
Epoch 8, Train Loss 0.367132, Valid_loss 0.469066
Epoch 9, Train Loss 0.369276, Valid_loss 0.483783
Epoch 10, Train Loss 0.351283, Valid_loss 0.494594
Epoch 11, Train Loss 0.350160, Valid_loss 0.506946
Epoch 12, Train Loss 0.394423, Valid_loss 0.512318
Epoch 13, Train Loss 0.319952, Valid_loss 0.471722
Epoch 14, Train Loss 0.315488, Valid_loss 0.473695
Epoch 15, Train Loss 0.299527, Valid_loss 0.472233
Epoch 16, Train Loss 0.290404, Valid_loss 0.483768
Epoch 17, Train Loss 0.309316, Valid_loss 0.436361
Epoch 18, Train Loss 0.306299, Valid_loss 0.420630
Epoch 19, Train Loss 0.293997, Valid_loss 0.460930
Epoch 20, Train Loss 0.319542, Valid_loss 0.421912
Epoch 21, Train Loss 0.279147, Valid_loss 0.438121
Epoch 22, Train Loss 0.303933, Valid_loss 0.408563
Epoch 23, Train Loss 0.284252, Valid_loss 0.423364
Epoch 24, Train Loss 0.285795, Valid_loss 0.477782
Epoch 25, Train Loss 0.289085, Valid_loss 0.485198
Epoch 26, Train Loss 0.442726, Valid_loss 0.492096
Epoch 27, Train Loss 0.299136, Valid_loss 0.492692
Epoch 28, Train Loss 0.312854, Valid_loss 0.465941
Epoch 29, Train Loss 0.245740, Valid_loss 0.500646
Epoch 30, Train Loss 0.262663, Valid_loss 0.467746
Epoch 31, Train Loss 0.276082, Valid_loss 0.484522
Epoch 32, Train Loss 0.270455, Valid_loss 0.464640
Epoch 33, Train Loss 0.258769, Valid_loss 0.456547
Epoch 34, Train Loss 0.274915, Valid_loss 0.495477
Epoch 35, Train Loss 0.259590, Valid_loss 0.486592
Epoch 36, Train Loss 0.256392, Valid_loss 0.492579
Epoch 37, Train Loss 0.237052, Valid_loss 0.474041
Epoch 38, Train Loss 0.274774, Valid_loss 0.475380
Epoch 39, Train Loss 0.253709, Valid_loss 0.463442
Epoch 40, Train Loss 0.240766, Valid_loss 0.435104
Epoch 41, Train Loss 0.252074, Valid_loss 0.437358
Epoch 42, Train Loss 0.278279, Valid_loss 0.437772
Epoch 43, Train Loss 0.290706, Valid_loss 0.433894
Epoch 44, Train Loss 0.261233, Valid_loss 0.464123
Epoch 45, Train Loss 0.281283, Valid_loss 0.446554
Epoch 46, Train Loss 0.249710, Valid_loss 0.520601
Epoch 47, Train Loss 0.264604, Valid_loss 0.456823
Epoch 48, Train Loss 0.264333, Valid_loss 0.453523
Epoch 49, Train Loss 0.245812, Valid_loss 0.443886
Epoch 50, Train Loss 0.237161, Valid_loss 0.442501
Epoch 51, Train Loss 0.222179, Valid_loss 0.441021
Epoch 52, Train Loss 0.236257, Valid_loss 0.435812
Epoch 53, Train Loss 0.264113, Valid_loss 0.429234
Epoch 54, Train Loss 0.268610, Valid_loss 0.433985
Epoch 55, Train Loss 0.257205, Valid_loss 0.435511
[I 2025-08-30 08:44:29,287] Trial 2 finished with value: 0.40856328420341015 and parameters: {'learning_rate': 0.001, 'epochs': 100, 'heads': 1, 'dropout': 0.7, 'weight_decay': 0.01, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 1 with value: 0.3472968988852309.
선택된 trial params: {'learning_rate': 0.01, 'epochs': 100, 'heads': 2, 'dropout': 0.0, 'weight_decay': 0.0001, 'emb_dim': 8, 'augment_num': 100, 'pca': False}
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=10, batch_size=1 -> steps=10
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 46.00 MB
cuda
Epoch 1, Train Loss 0.610194, Valid_loss 0.589649
Epoch 2, Train Loss 0.569932, Valid_loss 0.515706
Epoch 3, Train Loss 0.409886, Valid_loss 0.534148
Epoch 4, Train Loss 0.284304, Valid_loss 0.465032
Epoch 5, Train Loss 0.219971, Valid_loss 0.611976
Epoch 6, Train Loss 0.213347, Valid_loss 0.522725
Epoch 7, Train Loss 0.218759, Valid_loss 0.451542
Epoch 8, Train Loss 0.208610, Valid_loss 0.443011
Epoch 9, Train Loss 0.196485, Valid_loss 0.580030
Epoch 10, Train Loss 0.178759, Valid_loss 0.533302
Epoch 11, Train Loss 0.172985, Valid_loss 0.480034
Epoch 12, Train Loss 0.170511, Valid_loss 0.439895
Epoch 13, Train Loss 0.175153, Valid_loss 0.442548
Epoch 14, Train Loss 0.174924, Valid_loss 0.441336
Epoch 15, Train Loss 0.189832, Valid_loss 0.423887
Epoch 16, Train Loss 0.191495, Valid_loss 0.428323
Epoch 17, Train Loss 0.192948, Valid_loss 0.448795
Epoch 18, Train Loss 0.169050, Valid_loss 0.467501
Epoch 19, Train Loss 0.166806, Valid_loss 0.536405
Epoch 20, Train Loss 0.162165, Valid_loss 0.451381
Epoch 21, Train Loss 0.162843, Valid_loss 0.514283
Epoch 22, Train Loss 0.164369, Valid_loss 0.550610
Epoch 23, Train Loss 0.164342, Valid_loss 0.468491
Epoch 24, Train Loss 0.161543, Valid_loss 0.481943
Epoch 25, Train Loss 0.160798, Valid_loss 0.510824
Epoch 26, Train Loss 0.160192, Valid_loss 0.479034
Epoch 27, Train Loss 0.158307, Valid_loss 0.462732
Epoch 28, Train Loss 0.158139, Valid_loss 0.495077
Epoch 29, Train Loss 0.158935, Valid_loss 0.508186
Epoch 30, Train Loss 0.157077, Valid_loss 0.453491
Epoch 31, Train Loss 0.157556, Valid_loss 0.596263
Epoch 32, Train Loss 0.170188, Valid_loss 0.571583
Epoch 33, Train Loss 0.169180, Valid_loss 0.411070
Epoch 34, Train Loss 0.192902, Valid_loss 0.414900
Epoch 35, Train Loss 0.160394, Valid_loss 0.497083
Epoch 36, Train Loss 0.161171, Valid_loss 0.449731
Epoch 37, Train Loss 0.160147, Valid_loss 0.428567
Epoch 38, Train Loss 0.161270, Valid_loss 0.426667
Epoch 39, Train Loss 0.165281, Valid_loss 0.436505
Epoch 40, Train Loss 0.173140, Valid_loss 0.392619
Epoch 41, Train Loss 0.168297, Valid_loss 0.452191
Epoch 42, Train Loss 0.174107, Valid_loss 0.411443
Epoch 43, Train Loss 0.168061, Valid_loss 0.500991
Epoch 44, Train Loss 0.160300, Valid_loss 0.452343
Epoch 45, Train Loss 0.156431, Valid_loss 0.479514
Epoch 46, Train Loss 0.152191, Valid_loss 0.473785
Epoch 47, Train Loss 0.151226, Valid_loss 0.582119
Epoch 48, Train Loss 0.150600, Valid_loss 0.501467
Epoch 49, Train Loss 0.156099, Valid_loss 0.484230
Epoch 50, Train Loss 0.152663, Valid_loss 0.557820
Epoch 51, Train Loss 0.148103, Valid_loss 0.513555
Epoch 52, Train Loss 0.151708, Valid_loss 0.468684
Epoch 53, Train Loss 0.148134, Valid_loss 0.467861
Epoch 54, Train Loss 0.149909, Valid_loss 0.539819
Epoch 55, Train Loss 0.149468, Valid_loss 0.602317
환자ID=COVID19_Participant15 -- true: 1 -- pred: 1
환자ID=COVID19_Participant18 -- true: 1 -- pred: 1
환자ID=COVID19_Participant3 -- true: 1 -- pred: 1
환자ID=COVID19_Participant30 -- true: 1 -- pred: 1
환자ID=COVID19_Participant39 -- true: 1 -- pred: 1
환자ID=COVID19_Participant6 -- true: 1 -- pred: 1
환자ID=COVID19_Participant7 -- true: 1 -- pred: 1
환자ID=Control_Participant10 -- true: 0 -- pred: 0
환자ID=Control_Participant12 -- true: 0 -- pred: 0
환자ID=Control_Participant13 -- true: 0 -- pred: 1
Best performance: Epoch 40, Loss 0.173140, Test ACC 0.900000, Test AUC 1.000000, Test Recall 1.000000, Test Precision 0.875000
Confusion Matrix:
 [2 1 0 7]
✅ Total valid splits used: 2
🔁 Repeat 3, Fold 2
cell type :  GTCGGGGGGTGG_Control_Participant7     Developing Ciliated Cells
CAAATCAATTAT_Control_Participant7     Developing Ciliated Cells
ATACAATTGACA_Control_Participant7     Developing Ciliated Cells
CTGTTAATGAGA_Control_Participant7     Developing Ciliated Cells
CTTCACATTATT_Control_Participant7     Developing Ciliated Cells
                                                ...            
GCAGGGAACTCC_COVID19_Participant30               Squamous Cells
CAGCACCGAGCC_COVID19_Participant30               Squamous Cells
GCCCCTTGTGAT_COVID19_Participant30               Squamous Cells
GTGTTGTGTGTC_COVID19_Participant30               Squamous Cells
TAACACTCACTT_COVID19_Participant30               Squamous Cells
Name: manual_annotation, Length: 23100, dtype: string
cell type annotation :  GTCGGGGGGTGG_Control_Participant7     Developing Ciliated Cells
CAAATCAATTAT_Control_Participant7     Developing Ciliated Cells
ATACAATTGACA_Control_Participant7     Developing Ciliated Cells
CTGTTAATGAGA_Control_Participant7     Developing Ciliated Cells
CTTCACATTATT_Control_Participant7     Developing Ciliated Cells
                                                ...            
GCAGGGAACTCC_COVID19_Participant30               Squamous Cells
CAGCACCGAGCC_COVID19_Participant30               Squamous Cells
GCCCCTTGTGAT_COVID19_Participant30               Squamous Cells
GTGTTGTGTGTC_COVID19_Participant30               Squamous Cells
TAACACTCACTT_COVID19_Participant30               Squamous Cells
Name: manual_annotation, Length: 23100, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Developing Ciliated Cells', 'Ciliated Cells', 'Secretory Cells', 'Squamous Cells', 'Goblet Cells', 'T Cells', 'Dendritic Cells', 'Basal Cells', 'Deuterosomal Cells', 'Mitotic Basal Cells', 'Macrophages', 'B Cells', 'Ionocytes', 'Developing Secretory and Goblet Cells', 'Plasmacytoid DCs', 'Enteroendocrine Cells', 'Erythroblasts', 'Mast Cells']
라벨별 그룹 개수 {1: 28, 0: 12}
cell type :  TGGGATTACAGG_Control_Participant5     Enteroendocrine Cells
CTGCGACGGCAC_Control_Participant5           Secretory Cells
GGAATAAGTATC_Control_Participant5            Ciliated Cells
GACACGCCCTTA_Control_Participant5            Ciliated Cells
TTCAAGGTAGTC_Control_Participant5            Ciliated Cells
                                              ...          
GCGCCCGTGTTA_COVID19_Participant27             Goblet Cells
TTGATCCGTGGC_COVID19_Participant27                  T Cells
CGCGACTACTCT_COVID19_Participant27          Secretory Cells
AAACGCTTGTTA_COVID19_Participant27           Ciliated Cells
CATTGGGGGAAA_COVID19_Participant27          Secretory Cells
Name: manual_annotation, Length: 3847, dtype: string
cell type annotation :  TGGGATTACAGG_Control_Participant5     Enteroendocrine Cells
CTGCGACGGCAC_Control_Participant5           Secretory Cells
GGAATAAGTATC_Control_Participant5            Ciliated Cells
GACACGCCCTTA_Control_Participant5            Ciliated Cells
TTCAAGGTAGTC_Control_Participant5            Ciliated Cells
                                              ...          
GCGCCCGTGTTA_COVID19_Participant27             Goblet Cells
TTGATCCGTGGC_COVID19_Participant27                  T Cells
CGCGACTACTCT_COVID19_Participant27          Secretory Cells
AAACGCTTGTTA_COVID19_Participant27           Ciliated Cells
CATTGGGGGAAA_COVID19_Participant27          Secretory Cells
Name: manual_annotation, Length: 3847, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Enteroendocrine Cells', 'Secretory Cells', 'Ciliated Cells', 'T Cells', 'Goblet Cells', 'Squamous Cells', 'Mitotic Basal Cells', 'Basal Cells', 'Dendritic Cells', 'Developing Ciliated Cells', 'Deuterosomal Cells', 'B Cells', 'Ionocytes', 'Macrophages', 'Developing Secretory and Goblet Cells', 'Erythroblasts', 'Plasmacytoid DCs', 'Mast Cells']
라벨별 그룹 개수 {1: 7, 0: 3}
🔍 Split #3
  → train_p_index 환자 수 (환자 단위로 묶인 index list): 40
  → test_p_index 환자 수  (환자 단위로 묶인 index list): 10
  → train 환자 ID: ['COVID19_Participant10', 'COVID19_Participant11', 'COVID19_Participant13', 'COVID19_Participant14', 'COVID19_Participant15', 'COVID19_Participant17', 'COVID19_Participant18', 'COVID19_Participant19', 'COVID19_Participant20', 'COVID19_Participant21', 'COVID19_Participant22', 'COVID19_Participant25', 'COVID19_Participant26', 'COVID19_Participant28', 'COVID19_Participant29', 'COVID19_Participant3', 'COVID19_Participant30', 'COVID19_Participant31', 'COVID19_Participant32', 'COVID19_Participant36', 'COVID19_Participant38', 'COVID19_Participant39', 'COVID19_Participant4', 'COVID19_Participant40', 'COVID19_Participant5', 'COVID19_Participant6', 'COVID19_Participant7', 'COVID19_Participant9', 'Control_Participant1', 'Control_Participant10', 'Control_Participant11', 'Control_Participant12', 'Control_Participant13', 'Control_Participant14', 'Control_Participant2', 'Control_Participant3', 'Control_Participant4', 'Control_Participant6', 'Control_Participant7', 'Control_Participant8']
  → test  환자 ID: ['COVID19_Participant12', 'COVID19_Participant2', 'COVID19_Participant23', 'COVID19_Participant27', 'COVID19_Participant35', 'COVID19_Participant37', 'COVID19_Participant8', 'Control_Participant15', 'Control_Participant5', 'Control_Participant9']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant10, Label: 1
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant18, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant21, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant3, Label: 1
    ID: COVID19_Participant30, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant36, Label: 1
    ID: COVID19_Participant38, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: COVID19_Participant5, Label: 1
    ID: COVID19_Participant6, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: COVID19_Participant9, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant10, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant12, Label: 0
    ID: Control_Participant13, Label: 0
    ID: Control_Participant14, Label: 0
    ID: Control_Participant2, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant4, Label: 0
    ID: Control_Participant6, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant8, Label: 0
  → test 환자 ID 및 라벨:
    ID: COVID19_Participant12, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant27, Label: 1
    ID: COVID19_Participant35, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: Control_Participant15, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant9, Label: 0
전체 데이터 index 길이 50
label_stat (train 환자 라벨 목록) 갯수 40
train_data에서 환자 단위로, train과 validation 나누기
기존 train_p_index 40
기존 (train) label_stat 40
train-vali 분할 후! 
train y 의 classes : {0, 1} valid y 의 classes : {0, 1} label_stat 의 classes : {0, 1}
train_p_index_ 26
valid_p_index 14
test_p_index 10
→ train 환자 ID 및 라벨:
   총 개수: 26
   환자ID=Control_Participant10, Label=0, 셀개수=1645
   환자ID=Control_Participant14, Label=0, 셀개수=274
   환자ID=COVID19_Participant18, Label=1, 셀개수=227
   환자ID=COVID19_Participant39, Label=1, 셀개수=454
   환자ID=COVID19_Participant10, Label=1, 셀개수=18
   환자ID=Control_Participant4, Label=0, 셀개수=440
   환자ID=COVID19_Participant14, Label=1, 셀개수=382
   환자ID=COVID19_Participant19, Label=1, 셀개수=816
   환자ID=COVID19_Participant40, Label=1, 셀개수=381
   환자ID=COVID19_Participant13, Label=1, 셀개수=730
   환자ID=COVID19_Participant20, Label=1, 셀개수=2033
   환자ID=Control_Participant2, Label=0, 셀개수=41
   환자ID=COVID19_Participant28, Label=1, 셀개수=1079
   환자ID=Control_Participant7, Label=0, 셀개수=762
   환자ID=Control_Participant6, Label=0, 셀개수=131
   환자ID=COVID19_Participant15, Label=1, 셀개수=1003
   환자ID=Control_Participant8, Label=0, 셀개수=393
   환자ID=Control_Participant11, Label=0, 셀개수=1164
   환자ID=COVID19_Participant22, Label=1, 셀개수=865
   환자ID=COVID19_Participant30, Label=1, 셀개수=116
   환자ID=COVID19_Participant26, Label=1, 셀개수=814
   환자ID=COVID19_Participant17, Label=1, 셀개수=843
   환자ID=COVID19_Participant6, Label=1, 셀개수=84
   환자ID=COVID19_Participant4, Label=1, 셀개수=1680
   환자ID=COVID19_Participant38, Label=1, 셀개수=51
   환자ID=COVID19_Participant3, Label=1, 셀개수=104
→ valid 환자 ID 및 라벨:
   총 개수: 14
   환자ID=Control_Participant13, Label=0, 셀개수=88
   환자ID=COVID19_Participant29, Label=1, 셀개수=573
   환자ID=COVID19_Participant32, Label=1, 셀개수=1665
   환자ID=COVID19_Participant31, Label=1, 셀개수=410
   환자ID=COVID19_Participant5, Label=1, 셀개수=89
   환자ID=COVID19_Participant21, Label=1, 셀개수=39
   환자ID=Control_Participant3, Label=0, 셀개수=1620
   환자ID=Control_Participant1, Label=0, 셀개수=414
   환자ID=COVID19_Participant9, Label=1, 셀개수=86
   환자ID=COVID19_Participant7, Label=1, 셀개수=409
   환자ID=Control_Participant12, Label=0, 셀개수=99
   환자ID=COVID19_Participant36, Label=1, 셀개수=200
   환자ID=COVID19_Participant11, Label=1, 셀개수=382
   환자ID=COVID19_Participant25, Label=1, 셀개수=496
→ test 환자 ID 및 라벨:
   총 개수: 10
   환자ID=COVID19_Participant12, Label=1, 셀개수=102
   환자ID=COVID19_Participant2, Label=1, 셀개수=329
   환자ID=COVID19_Participant23, Label=1, 셀개수=307
   환자ID=COVID19_Participant27, Label=1, 셀개수=93
   환자ID=COVID19_Participant35, Label=1, 셀개수=83
   환자ID=COVID19_Participant37, Label=1, 셀개수=668
   환자ID=COVID19_Participant8, Label=1, 셀개수=462
   환자ID=Control_Participant15, Label=0, 셀개수=528
   환자ID=Control_Participant5, Label=0, 셀개수=717
   환자ID=Control_Participant9, Label=0, 셀개수=558
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Ciliated Cells', 'Developing Ciliated Cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
전체 데이터 길이 26947
전체 cell type 길이 0        Developing Ciliated Cells
1        Developing Ciliated Cells
2        Developing Ciliated Cells
3        Developing Ciliated Cells
4        Developing Ciliated Cells
                   ...            
26942                 Goblet Cells
26943                      T Cells
26944              Secretory Cells
26945               Ciliated Cells
26946              Secretory Cells
Length: 26947, dtype: string
cell type의 NaN 개수 체크 0
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  2%|▏         | 2/100 [00:00<00:09,  9.92it/s]  4%|▍         | 4/100 [00:00<00:10,  9.28it/s]  6%|▌         | 6/100 [00:00<00:12,  7.79it/s]  7%|▋         | 7/100 [00:01<00:15,  5.90it/s]  8%|▊         | 8/100 [00:01<00:14,  6.56it/s]  9%|▉         | 9/100 [00:01<00:13,  6.90it/s] 11%|█         | 11/100 [00:01<00:11,  7.91it/s] 12%|█▏        | 12/100 [00:01<00:10,  8.28it/s] 14%|█▍        | 14/100 [00:02<00:13,  6.22it/s] 16%|█▌        | 16/100 [00:02<00:12,  6.53it/s] 17%|█▋        | 17/100 [00:02<00:16,  5.01it/s] 19%|█▉        | 19/100 [00:02<00:13,  6.02it/s] 20%|██        | 20/100 [00:03<00:14,  5.51it/s] 22%|██▏       | 22/100 [00:03<00:11,  6.73it/s] 23%|██▎       | 23/100 [00:03<00:10,  7.20it/s] 24%|██▍       | 24/100 [00:03<00:10,  7.11it/s] 25%|██▌       | 25/100 [00:03<00:09,  7.62it/s] 26%|██▌       | 26/100 [00:03<00:11,  6.53it/s] 27%|██▋       | 27/100 [00:03<00:10,  7.18it/s] 28%|██▊       | 28/100 [00:04<00:09,  7.74it/s] 29%|██▉       | 29/100 [00:04<00:08,  8.18it/s] 30%|███       | 30/100 [00:04<00:09,  7.44it/s] 32%|███▏      | 32/100 [00:04<00:07,  8.54it/s] 33%|███▎      | 33/100 [00:04<00:10,  6.42it/s] 34%|███▍      | 34/100 [00:04<00:09,  7.01it/s] 35%|███▌      | 35/100 [00:05<00:08,  7.34it/s] 37%|███▋      | 37/100 [00:05<00:08,  7.87it/s] 39%|███▉      | 39/100 [00:05<00:08,  7.45it/s] 40%|████      | 40/100 [00:05<00:07,  7.74it/s] 41%|████      | 41/100 [00:05<00:07,  7.64it/s] 42%|████▏     | 42/100 [00:05<00:07,  8.01it/s] 43%|████▎     | 43/100 [00:06<00:07,  7.85it/s] 44%|████▍     | 44/100 [00:06<00:07,  7.96it/s] 45%|████▌     | 45/100 [00:06<00:09,  5.80it/s] 46%|████▌     | 46/100 [00:06<00:08,  6.51it/s] 48%|████▊     | 48/100 [00:06<00:06,  7.63it/s] 49%|████▉     | 49/100 [00:07<00:07,  6.50it/s] 51%|█████     | 51/100 [00:07<00:07,  6.16it/s] 52%|█████▏    | 52/100 [00:07<00:08,  5.50it/s] 53%|█████▎    | 53/100 [00:07<00:08,  5.32it/s] 55%|█████▌    | 55/100 [00:08<00:06,  6.50it/s] 56%|█████▌    | 56/100 [00:08<00:06,  6.72it/s] 57%|█████▋    | 57/100 [00:08<00:05,  7.28it/s] 58%|█████▊    | 58/100 [00:08<00:07,  5.49it/s] 59%|█████▉    | 59/100 [00:08<00:06,  6.18it/s] 61%|██████    | 61/100 [00:08<00:05,  7.25it/s] 62%|██████▏   | 62/100 [00:08<00:05,  7.51it/s] 63%|██████▎   | 63/100 [00:09<00:05,  6.99it/s] 64%|██████▍   | 64/100 [00:09<00:04,  7.23it/s] 65%|██████▌   | 65/100 [00:09<00:04,  7.71it/s] 66%|██████▌   | 66/100 [00:09<00:04,  7.37it/s] 67%|██████▋   | 67/100 [00:09<00:04,  7.06it/s] 68%|██████▊   | 68/100 [00:09<00:04,  6.46it/s] 69%|██████▉   | 69/100 [00:10<00:04,  7.01it/s] 70%|███████   | 70/100 [00:10<00:04,  7.50it/s] 71%|███████   | 71/100 [00:10<00:03,  7.97it/s] 72%|███████▏  | 72/100 [00:10<00:03,  8.25it/s] 73%|███████▎  | 73/100 [00:10<00:03,  8.00it/s] 74%|███████▍  | 74/100 [00:10<00:03,  6.53it/s] 75%|███████▌  | 75/100 [00:10<00:03,  7.16it/s] 76%|███████▌  | 76/100 [00:10<00:03,  7.68it/s] 77%|███████▋  | 77/100 [00:11<00:02,  7.68it/s] 78%|███████▊  | 78/100 [00:11<00:02,  7.76it/s] 79%|███████▉  | 79/100 [00:11<00:03,  5.65it/s] 80%|████████  | 80/100 [00:11<00:03,  6.44it/s] 81%|████████  | 81/100 [00:11<00:02,  7.08it/s] 82%|████████▏ | 82/100 [00:11<00:02,  7.58it/s] 83%|████████▎ | 83/100 [00:11<00:02,  8.16it/s] 84%|████████▍ | 84/100 [00:12<00:02,  7.99it/s] 85%|████████▌ | 85/100 [00:12<00:03,  4.74it/s] 86%|████████▌ | 86/100 [00:12<00:02,  5.58it/s] 87%|████████▋ | 87/100 [00:12<00:02,  5.88it/s] 88%|████████▊ | 88/100 [00:12<00:01,  6.01it/s] 89%|████████▉ | 89/100 [00:12<00:01,  6.76it/s] 91%|█████████ | 91/100 [00:13<00:01,  7.74it/s] 92%|█████████▏| 92/100 [00:13<00:01,  7.23it/s] 93%|█████████▎| 93/100 [00:13<00:00,  7.58it/s] 94%|█████████▍| 94/100 [00:13<00:00,  7.61it/s] 95%|█████████▌| 95/100 [00:13<00:00,  7.98it/s] 96%|█████████▌| 96/100 [00:13<00:00,  8.21it/s] 97%|█████████▋| 97/100 [00:14<00:00,  5.48it/s] 98%|█████████▊| 98/100 [00:14<00:00,  5.71it/s] 99%|█████████▉| 99/100 [00:14<00:00,  6.44it/s]100%|██████████| 100/100 [00:14<00:00,  6.20it/s]100%|██████████| 100/100 [00:14<00:00,  6.87it/s]
[I 2025-08-30 08:48:27,690] A new study created in memory with name: no-name-05c9b785-a1f7-49ad-8b48-25216d009d29
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 26.13 MB
Memory Reserved: 46.00 MB
cuda
Epoch 1, Train Loss 0.712660, Valid_loss 0.668989
Epoch 2, Train Loss 0.649399, Valid_loss 0.621724
Epoch 3, Train Loss 0.617100, Valid_loss 0.609559
Epoch 4, Train Loss 0.604947, Valid_loss 0.599187
Epoch 5, Train Loss 0.573407, Valid_loss 0.588656
Epoch 6, Train Loss 0.557506, Valid_loss 0.578071
Epoch 7, Train Loss 0.559003, Valid_loss 0.582549
Epoch 8, Train Loss 0.543643, Valid_loss 0.578091
Epoch 9, Train Loss 0.522739, Valid_loss 0.572620
Epoch 10, Train Loss 0.525741, Valid_loss 0.574404
Epoch 11, Train Loss 0.481728, Valid_loss 0.596615
Epoch 12, Train Loss 0.480404, Valid_loss 0.593511
Epoch 13, Train Loss 0.464000, Valid_loss 0.555831
Epoch 14, Train Loss 0.437430, Valid_loss 0.539701
Epoch 15, Train Loss 0.416167, Valid_loss 0.562208
Epoch 16, Train Loss 0.423676, Valid_loss 0.561480
Epoch 17, Train Loss 0.426505, Valid_loss 0.549059
Epoch 18, Train Loss 0.421086, Valid_loss 0.604025
Epoch 19, Train Loss 0.432689, Valid_loss 0.521982
Epoch 20, Train Loss 0.417056, Valid_loss 0.530292
Epoch 21, Train Loss 0.428104, Valid_loss 0.542616
Epoch 22, Train Loss 0.427762, Valid_loss 0.521607
Epoch 23, Train Loss 0.412996, Valid_loss 0.523689
Epoch 24, Train Loss 0.441507, Valid_loss 0.568478
Epoch 25, Train Loss 0.398649, Valid_loss 0.535814
Epoch 26, Train Loss 0.417507, Valid_loss 0.533470
Epoch 27, Train Loss 0.402477, Valid_loss 0.571621
Epoch 28, Train Loss 0.404051, Valid_loss 0.505992
Epoch 29, Train Loss 0.395017, Valid_loss 0.529965
Epoch 30, Train Loss 0.403055, Valid_loss 0.541887
Epoch 31, Train Loss 0.419763, Valid_loss 0.540099
Epoch 32, Train Loss 0.387551, Valid_loss 0.502154
Epoch 33, Train Loss 0.369490, Valid_loss 0.523367
Epoch 34, Train Loss 0.389641, Valid_loss 0.508897
Epoch 35, Train Loss 0.387925, Valid_loss 0.497146
Epoch 36, Train Loss 0.369864, Valid_loss 0.482059
Epoch 37, Train Loss 0.377771, Valid_loss 0.493373
Epoch 38, Train Loss 0.391090, Valid_loss 0.508136
Epoch 39, Train Loss 0.368939, Valid_loss 0.484228
Epoch 40, Train Loss 0.364659, Valid_loss 0.469940
Epoch 41, Train Loss 0.365896, Valid_loss 0.484526
Epoch 42, Train Loss 0.376834, Valid_loss 0.525038
Epoch 43, Train Loss 0.355997, Valid_loss 0.503612
Epoch 44, Train Loss 0.335153, Valid_loss 0.461750
Epoch 45, Train Loss 0.385753, Valid_loss 0.530371
Epoch 46, Train Loss 0.377703, Valid_loss 0.465773
Epoch 47, Train Loss 0.341599, Valid_loss 0.508278
Epoch 48, Train Loss 0.373429, Valid_loss 0.505490
Epoch 49, Train Loss 0.356412, Valid_loss 0.516048
Epoch 50, Train Loss 0.341712, Valid_loss 0.475977
Epoch 51, Train Loss 0.360204, Valid_loss 0.525995
Epoch 52, Train Loss 0.351255, Valid_loss 0.502546
Epoch 53, Train Loss 0.351044, Valid_loss 0.514843
Epoch 54, Train Loss 0.355530, Valid_loss 0.489658
Epoch 55, Train Loss 0.361939, Valid_loss 0.503442
Epoch 56, Train Loss 0.342564, Valid_loss 0.487205
Epoch 57, Train Loss 0.362277, Valid_loss 0.495526
Epoch 58, Train Loss 0.347708, Valid_loss 0.485406
Epoch 59, Train Loss 0.349853, Valid_loss 0.492617
Epoch 60, Train Loss 0.353339, Valid_loss 0.526921
[I 2025-08-30 08:52:35,390] Trial 0 finished with value: 0.4617504285914557 and parameters: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 2, 'dropout': 0.5, 'weight_decay': 0.01, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.4617504285914557.
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 27.97 MB
Memory Reserved: 46.00 MB
cuda
Epoch 1, Train Loss 0.669656, Valid_loss 0.601789
Epoch 2, Train Loss 0.596220, Valid_loss 0.601087
Epoch 3, Train Loss 0.625260, Valid_loss 0.598287
Epoch 4, Train Loss 0.611489, Valid_loss 0.599189
Epoch 5, Train Loss 0.625162, Valid_loss 0.598301
Epoch 6, Train Loss 0.612837, Valid_loss 0.599461
Epoch 7, Train Loss 0.616169, Valid_loss 0.598270
Epoch 8, Train Loss 0.596418, Valid_loss 0.598294
Epoch 9, Train Loss 0.589423, Valid_loss 0.598454
Epoch 10, Train Loss 0.612752, Valid_loss 0.600740
Epoch 11, Train Loss 0.593872, Valid_loss 0.598787
Epoch 12, Train Loss 0.588775, Valid_loss 0.602165
Epoch 13, Train Loss 0.594945, Valid_loss 0.598781
Epoch 14, Train Loss 0.599894, Valid_loss 0.598382
Epoch 15, Train Loss 0.594056, Valid_loss 0.598689
Epoch 16, Train Loss 0.607152, Valid_loss 0.599228
Epoch 17, Train Loss 0.597781, Valid_loss 0.599548
Epoch 18, Train Loss 0.590171, Valid_loss 0.601973
Epoch 19, Train Loss 0.599622, Valid_loss 0.599598
Epoch 20, Train Loss 0.598832, Valid_loss 0.599690
Epoch 21, Train Loss 0.598764, Valid_loss 0.599007
Epoch 22, Train Loss 0.588326, Valid_loss 0.604721
Epoch 23, Train Loss 0.605087, Valid_loss 0.598465
Epoch 24, Train Loss 0.600085, Valid_loss 0.598186
Epoch 25, Train Loss 0.591703, Valid_loss 0.598181
Epoch 26, Train Loss 0.599290, Valid_loss 0.599347
Epoch 27, Train Loss 0.596252, Valid_loss 0.599015
Epoch 28, Train Loss 0.592718, Valid_loss 0.601772
Epoch 29, Train Loss 0.587143, Valid_loss 0.598293
Epoch 30, Train Loss 0.597962, Valid_loss 0.598439
Epoch 31, Train Loss 0.599934, Valid_loss 0.599205
Epoch 32, Train Loss 0.594767, Valid_loss 0.599811
Epoch 33, Train Loss 0.595873, Valid_loss 0.598908
Epoch 34, Train Loss 0.599544, Valid_loss 0.598579
Epoch 35, Train Loss 0.598661, Valid_loss 0.598279
Epoch 36, Train Loss 0.591053, Valid_loss 0.605228
Epoch 37, Train Loss 0.593981, Valid_loss 0.598168
Epoch 38, Train Loss 0.590583, Valid_loss 0.597983
Epoch 39, Train Loss 0.585507, Valid_loss 0.594401
Epoch 40, Train Loss 0.610358, Valid_loss 0.601792
Epoch 41, Train Loss 0.596754, Valid_loss 0.598185
Epoch 42, Train Loss 0.597168, Valid_loss 0.598429
Epoch 43, Train Loss 0.595695, Valid_loss 0.598164
Epoch 44, Train Loss 0.593560, Valid_loss 0.599835
Epoch 45, Train Loss 0.594563, Valid_loss 0.597935
Epoch 46, Train Loss 0.591859, Valid_loss 0.598987
Epoch 47, Train Loss 0.595194, Valid_loss 0.596016
Epoch 48, Train Loss 0.586098, Valid_loss 0.607598
Epoch 49, Train Loss 0.547542, Valid_loss 0.531878
Epoch 50, Train Loss 0.503505, Valid_loss 0.623267
Epoch 51, Train Loss 0.622619, Valid_loss 0.599368
Epoch 52, Train Loss 0.600216, Valid_loss 0.597808
Epoch 53, Train Loss 0.570013, Valid_loss 0.595483
Epoch 54, Train Loss 0.546771, Valid_loss 0.585872
Epoch 55, Train Loss 0.426663, Valid_loss 0.550436
Epoch 56, Train Loss 0.463889, Valid_loss 0.581984
Epoch 57, Train Loss 0.530930, Valid_loss 0.747887
[I 2025-08-30 08:57:06,852] Trial 1 finished with value: 0.5318784351859774 and parameters: {'learning_rate': 0.01, 'epochs': 100, 'heads': 4, 'dropout': 0.3, 'weight_decay': 0.0001, 'emb_dim': 64, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.4617504285914557.
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 26.13 MB
Memory Reserved: 46.00 MB
cuda
Epoch 1, Train Loss 0.586513, Valid_loss 0.591941
Epoch 2, Train Loss 0.572393, Valid_loss 0.575182
Epoch 3, Train Loss 0.536470, Valid_loss 0.559869
Epoch 4, Train Loss 0.492349, Valid_loss 0.534736
Epoch 5, Train Loss 0.440640, Valid_loss 0.528469
Epoch 6, Train Loss 0.420379, Valid_loss 0.538649
Epoch 7, Train Loss 0.425388, Valid_loss 0.558275
Epoch 8, Train Loss 0.406634, Valid_loss 0.532627
Epoch 9, Train Loss 0.385588, Valid_loss 0.528680
Epoch 10, Train Loss 0.383567, Valid_loss 0.519196
Epoch 11, Train Loss 0.375189, Valid_loss 0.488266
Epoch 12, Train Loss 0.364375, Valid_loss 0.514850
Epoch 13, Train Loss 0.357058, Valid_loss 0.534232
Epoch 14, Train Loss 0.353416, Valid_loss 0.488095
Epoch 15, Train Loss 0.351000, Valid_loss 0.499998
Epoch 16, Train Loss 0.357148, Valid_loss 0.503754
Epoch 17, Train Loss 0.346549, Valid_loss 0.468903
Epoch 18, Train Loss 0.327555, Valid_loss 0.475821
Epoch 19, Train Loss 0.339843, Valid_loss 0.552091
Epoch 20, Train Loss 0.345611, Valid_loss 0.487335
Epoch 21, Train Loss 0.339252, Valid_loss 0.494498
Epoch 22, Train Loss 0.332746, Valid_loss 0.483773
Epoch 23, Train Loss 0.338074, Valid_loss 0.443553
Epoch 24, Train Loss 0.326771, Valid_loss 0.444060
Epoch 25, Train Loss 0.333577, Valid_loss 0.483317
Epoch 26, Train Loss 0.327726, Valid_loss 0.440548
Epoch 27, Train Loss 0.322027, Valid_loss 0.491492
Epoch 28, Train Loss 0.313977, Valid_loss 0.414489
Epoch 29, Train Loss 0.325791, Valid_loss 0.437242
Epoch 30, Train Loss 0.299170, Valid_loss 0.429911
Epoch 31, Train Loss 0.307274, Valid_loss 0.485075
Epoch 32, Train Loss 0.319202, Valid_loss 0.426523
Epoch 33, Train Loss 0.316887, Valid_loss 0.412845
Epoch 34, Train Loss 0.309922, Valid_loss 0.551487
Epoch 35, Train Loss 0.320490, Valid_loss 0.510864
Epoch 36, Train Loss 0.303606, Valid_loss 0.448268
Epoch 37, Train Loss 0.298915, Valid_loss 0.411402
Epoch 38, Train Loss 0.313959, Valid_loss 0.487190
Epoch 39, Train Loss 0.305850, Valid_loss 0.446857
Epoch 40, Train Loss 0.310907, Valid_loss 0.437103
Epoch 41, Train Loss 0.311835, Valid_loss 0.468084
Epoch 42, Train Loss 0.298753, Valid_loss 0.426852
Epoch 43, Train Loss 0.307290, Valid_loss 0.434702
Epoch 44, Train Loss 0.299117, Valid_loss 0.449546
Epoch 45, Train Loss 0.293736, Valid_loss 0.443098
Epoch 46, Train Loss 0.289013, Valid_loss 0.423829
Epoch 47, Train Loss 0.292905, Valid_loss 0.417079
Epoch 48, Train Loss 0.296425, Valid_loss 0.481509
Epoch 49, Train Loss 0.289111, Valid_loss 0.449193
Epoch 50, Train Loss 0.285042, Valid_loss 0.406369
Epoch 51, Train Loss 0.288262, Valid_loss 0.528067
Epoch 52, Train Loss 0.295431, Valid_loss 0.457289
Epoch 53, Train Loss 0.291598, Valid_loss 0.469566
Epoch 54, Train Loss 0.285659, Valid_loss 0.423192
Epoch 55, Train Loss 0.293126, Valid_loss 0.488432
Epoch 56, Train Loss 0.285531, Valid_loss 0.467411
Epoch 57, Train Loss 0.298247, Valid_loss 0.415846
Epoch 58, Train Loss 0.281987, Valid_loss 0.470779
Epoch 59, Train Loss 0.271273, Valid_loss 0.464410
Epoch 60, Train Loss 0.285941, Valid_loss 0.434353
Epoch 61, Train Loss 0.282732, Valid_loss 0.440314
Epoch 62, Train Loss 0.290720, Valid_loss 0.470813
[I 2025-08-30 09:01:03,356] Trial 2 finished with value: 0.40636919704931124 and parameters: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 1, 'dropout': 0.3, 'weight_decay': 0.01, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 2 with value: 0.40636919704931124.
선택된 trial params: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 1, 'dropout': 0.3, 'weight_decay': 0.01, 'emb_dim': 32, 'augment_num': 100, 'pca': False}
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=10, batch_size=1 -> steps=10
output_class :  1
Memory Allocated: 26.13 MB
Memory Reserved: 46.00 MB
cuda
Epoch 1, Train Loss 0.789925, Valid_loss 0.654086
Epoch 2, Train Loss 0.650168, Valid_loss 0.607388
Epoch 3, Train Loss 0.634401, Valid_loss 0.595528
Epoch 4, Train Loss 0.595463, Valid_loss 0.586200
Epoch 5, Train Loss 0.605001, Valid_loss 0.575530
Epoch 6, Train Loss 0.562201, Valid_loss 0.572477
Epoch 7, Train Loss 0.545195, Valid_loss 0.573707
Epoch 8, Train Loss 0.503501, Valid_loss 0.573323
Epoch 9, Train Loss 0.489275, Valid_loss 0.596000
Epoch 10, Train Loss 0.480969, Valid_loss 0.590488
Epoch 11, Train Loss 0.458214, Valid_loss 0.590715
Epoch 12, Train Loss 0.459353, Valid_loss 0.592992
Epoch 13, Train Loss 0.436634, Valid_loss 0.593438
Epoch 14, Train Loss 0.433938, Valid_loss 0.601025
Epoch 15, Train Loss 0.430338, Valid_loss 0.583777
Epoch 16, Train Loss 0.416120, Valid_loss 0.621901
Epoch 17, Train Loss 0.406454, Valid_loss 0.603551
Epoch 18, Train Loss 0.417005, Valid_loss 0.567756
Epoch 19, Train Loss 0.413951, Valid_loss 0.565049
Epoch 20, Train Loss 0.410160, Valid_loss 0.562086
Epoch 21, Train Loss 0.376200, Valid_loss 0.566278
Epoch 22, Train Loss 0.385277, Valid_loss 0.586182
Epoch 23, Train Loss 0.386699, Valid_loss 0.525324
Epoch 24, Train Loss 0.390225, Valid_loss 0.564918
Epoch 25, Train Loss 0.382553, Valid_loss 0.539834
Epoch 26, Train Loss 0.366806, Valid_loss 0.545616
Epoch 27, Train Loss 0.373491, Valid_loss 0.536741
Epoch 28, Train Loss 0.369740, Valid_loss 0.521105
Epoch 29, Train Loss 0.362820, Valid_loss 0.635075
Epoch 30, Train Loss 0.354193, Valid_loss 0.519893
Epoch 31, Train Loss 0.354962, Valid_loss 0.547652
Epoch 32, Train Loss 0.353263, Valid_loss 0.546387
Epoch 33, Train Loss 0.352312, Valid_loss 0.511236
Epoch 34, Train Loss 0.360303, Valid_loss 0.528807
Epoch 35, Train Loss 0.350034, Valid_loss 0.541001
Epoch 36, Train Loss 0.344257, Valid_loss 0.513232
Epoch 37, Train Loss 0.346676, Valid_loss 0.524970
Epoch 38, Train Loss 0.337232, Valid_loss 0.519356
Epoch 39, Train Loss 0.350892, Valid_loss 0.532941
Epoch 40, Train Loss 0.335711, Valid_loss 0.465406
Epoch 41, Train Loss 0.343738, Valid_loss 0.489165
Epoch 42, Train Loss 0.338882, Valid_loss 0.502548
Epoch 43, Train Loss 0.343760, Valid_loss 0.529381
Epoch 44, Train Loss 0.321680, Valid_loss 0.539982
Epoch 45, Train Loss 0.321766, Valid_loss 0.471684
Epoch 46, Train Loss 0.325574, Valid_loss 0.500520
Epoch 47, Train Loss 0.332739, Valid_loss 0.466959
Epoch 48, Train Loss 0.343168, Valid_loss 0.505949
Epoch 49, Train Loss 0.339319, Valid_loss 0.483796
Epoch 50, Train Loss 0.317027, Valid_loss 0.577898
Epoch 51, Train Loss 0.317845, Valid_loss 0.472589
Epoch 52, Train Loss 0.329579, Valid_loss 0.521154
Epoch 53, Train Loss 0.328879, Valid_loss 0.460950
Epoch 54, Train Loss 0.331013, Valid_loss 0.496910
Epoch 55, Train Loss 0.321198, Valid_loss 0.523728
환자ID=COVID19_Participant12 -- true: 1 -- pred: 1
환자ID=COVID19_Participant2 -- true: 1 -- pred: 1
환자ID=COVID19_Participant23 -- true: 1 -- pred: 1
환자ID=COVID19_Participant27 -- true: 1 -- pred: 1
환자ID=COVID19_Participant35 -- true: 1 -- pred: 1
환자ID=COVID19_Participant37 -- true: 1 -- pred: 1
환자ID=COVID19_Participant8 -- true: 1 -- pred: 1
환자ID=Control_Participant15 -- true: 0 -- pred: 0
환자ID=Control_Participant5 -- true: 0 -- pred: 0
환자ID=Control_Participant9 -- true: 0 -- pred: 0
Best performance: Epoch 53, Loss 0.328879, Test ACC 1.000000, Test AUC 1.000000, Test Recall 1.000000, Test Precision 1.000000
Confusion Matrix:
 [3 0 0 7]
✅ Total valid splits used: 3
🔁 Repeat 3, Fold 3
cell type :  GTCGGGGGGTGG_Control_Participant7     Developing Ciliated Cells
CAAATCAATTAT_Control_Participant7     Developing Ciliated Cells
ATACAATTGACA_Control_Participant7     Developing Ciliated Cells
CTGTTAATGAGA_Control_Participant7     Developing Ciliated Cells
CTTCACATTATT_Control_Participant7     Developing Ciliated Cells
                                                ...            
GCAGGGAACTCC_COVID19_Participant30               Squamous Cells
CAGCACCGAGCC_COVID19_Participant30               Squamous Cells
GCCCCTTGTGAT_COVID19_Participant30               Squamous Cells
GTGTTGTGTGTC_COVID19_Participant30               Squamous Cells
TAACACTCACTT_COVID19_Participant30               Squamous Cells
Name: manual_annotation, Length: 16697, dtype: string
cell type annotation :  GTCGGGGGGTGG_Control_Participant7     Developing Ciliated Cells
CAAATCAATTAT_Control_Participant7     Developing Ciliated Cells
ATACAATTGACA_Control_Participant7     Developing Ciliated Cells
CTGTTAATGAGA_Control_Participant7     Developing Ciliated Cells
CTTCACATTATT_Control_Participant7     Developing Ciliated Cells
                                                ...            
GCAGGGAACTCC_COVID19_Participant30               Squamous Cells
CAGCACCGAGCC_COVID19_Participant30               Squamous Cells
GCCCCTTGTGAT_COVID19_Participant30               Squamous Cells
GTGTTGTGTGTC_COVID19_Participant30               Squamous Cells
TAACACTCACTT_COVID19_Participant30               Squamous Cells
Name: manual_annotation, Length: 16697, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Developing Ciliated Cells', 'Ciliated Cells', 'Secretory Cells', 'Squamous Cells', 'Goblet Cells', 'T Cells', 'Dendritic Cells', 'Basal Cells', 'Deuterosomal Cells', 'Mitotic Basal Cells', 'Macrophages', 'B Cells', 'Ionocytes', 'Developing Secretory and Goblet Cells', 'Plasmacytoid DCs', 'Enteroendocrine Cells', 'Erythroblasts', 'Mast Cells']
라벨별 그룹 개수 {1: 28, 0: 12}
cell type :  GTAACGCCGTGT_COVID19_Participant5            Ciliated Cells
TCATATGTCGTC_COVID19_Participant5            Ciliated Cells
ATCCCGGCAGCT_COVID19_Participant5                   T Cells
TGGGATTACAGG_COVID19_Participant5     Enteroendocrine Cells
AGCCAGTAAGAT_COVID19_Participant5        Deuterosomal Cells
                                              ...          
CAGGTTGGTATC_COVID19_Participant20          Secretory Cells
TATAGCTTGGTA_COVID19_Participant20          Secretory Cells
TTGTTAGACGGT_COVID19_Participant20                  T Cells
ATGGCTCAGGCT_COVID19_Participant20          Secretory Cells
ACATGATCCTTT_COVID19_Participant20          Secretory Cells
Name: manual_annotation, Length: 10250, dtype: string
cell type annotation :  GTAACGCCGTGT_COVID19_Participant5            Ciliated Cells
TCATATGTCGTC_COVID19_Participant5            Ciliated Cells
ATCCCGGCAGCT_COVID19_Participant5                   T Cells
TGGGATTACAGG_COVID19_Participant5     Enteroendocrine Cells
AGCCAGTAAGAT_COVID19_Participant5        Deuterosomal Cells
                                              ...          
CAGGTTGGTATC_COVID19_Participant20          Secretory Cells
TATAGCTTGGTA_COVID19_Participant20          Secretory Cells
TTGTTAGACGGT_COVID19_Participant20                  T Cells
ATGGCTCAGGCT_COVID19_Participant20          Secretory Cells
ACATGATCCTTT_COVID19_Participant20          Secretory Cells
Name: manual_annotation, Length: 10250, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Ciliated Cells', 'T Cells', 'Enteroendocrine Cells', 'Deuterosomal Cells', 'Goblet Cells', 'Secretory Cells', 'Squamous Cells', 'Mitotic Basal Cells', 'Ionocytes', 'Developing Ciliated Cells', 'Macrophages', 'Basal Cells', 'Developing Secretory and Goblet Cells', 'Dendritic Cells', 'Erythroblasts', 'B Cells', 'Mast Cells', 'Plasmacytoid DCs']
라벨별 그룹 개수 {1: 7, 0: 3}
🔍 Split #4
  → train_p_index 환자 수 (환자 단위로 묶인 index list): 40
  → test_p_index 환자 수  (환자 단위로 묶인 index list): 10
  → train 환자 ID: ['COVID19_Participant10', 'COVID19_Participant11', 'COVID19_Participant12', 'COVID19_Participant13', 'COVID19_Participant14', 'COVID19_Participant15', 'COVID19_Participant17', 'COVID19_Participant18', 'COVID19_Participant19', 'COVID19_Participant2', 'COVID19_Participant21', 'COVID19_Participant23', 'COVID19_Participant25', 'COVID19_Participant27', 'COVID19_Participant29', 'COVID19_Participant3', 'COVID19_Participant30', 'COVID19_Participant31', 'COVID19_Participant35', 'COVID19_Participant36', 'COVID19_Participant37', 'COVID19_Participant38', 'COVID19_Participant39', 'COVID19_Participant40', 'COVID19_Participant6', 'COVID19_Participant7', 'COVID19_Participant8', 'COVID19_Participant9', 'Control_Participant1', 'Control_Participant10', 'Control_Participant11', 'Control_Participant12', 'Control_Participant13', 'Control_Participant15', 'Control_Participant2', 'Control_Participant4', 'Control_Participant5', 'Control_Participant7', 'Control_Participant8', 'Control_Participant9']
  → test  환자 ID: ['COVID19_Participant20', 'COVID19_Participant22', 'COVID19_Participant26', 'COVID19_Participant28', 'COVID19_Participant32', 'COVID19_Participant4', 'COVID19_Participant5', 'Control_Participant14', 'Control_Participant3', 'Control_Participant6']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant10, Label: 1
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant12, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant18, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant21, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant27, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant3, Label: 1
    ID: COVID19_Participant30, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant35, Label: 1
    ID: COVID19_Participant36, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant38, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: COVID19_Participant6, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: COVID19_Participant9, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant10, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant12, Label: 0
    ID: Control_Participant13, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant2, Label: 0
    ID: Control_Participant4, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant8, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant5, Label: 1
    ID: Control_Participant14, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant6, Label: 0
전체 데이터 index 길이 50
label_stat (train 환자 라벨 목록) 갯수 40
train_data에서 환자 단위로, train과 validation 나누기
기존 train_p_index 40
기존 (train) label_stat 40
train-vali 분할 후! 
train y 의 classes : {0, 1} valid y 의 classes : {0, 1} label_stat 의 classes : {0, 1}
train_p_index_ 26
valid_p_index 14
test_p_index 10
→ train 환자 ID 및 라벨:
   총 개수: 26
   환자ID=Control_Participant10, Label=0, 셀개수=1645
   환자ID=Control_Participant15, Label=0, 셀개수=528
   환자ID=COVID19_Participant17, Label=1, 셀개수=843
   환자ID=COVID19_Participant38, Label=1, 셀개수=51
   환자ID=COVID19_Participant10, Label=1, 셀개수=18
   환자ID=Control_Participant5, Label=0, 셀개수=717
   환자ID=COVID19_Participant13, Label=1, 셀개수=730
   환자ID=COVID19_Participant18, Label=1, 셀개수=227
   환자ID=COVID19_Participant40, Label=1, 셀개수=381
   환자ID=COVID19_Participant12, Label=1, 셀개수=102
   환자ID=COVID19_Participant19, Label=1, 셀개수=816
   환자ID=Control_Participant2, Label=0, 셀개수=41
   환자ID=COVID19_Participant27, Label=1, 셀개수=93
   환자ID=Control_Participant8, Label=0, 셀개수=393
   환자ID=Control_Participant7, Label=0, 셀개수=762
   환자ID=COVID19_Participant14, Label=1, 셀개수=382
   환자ID=Control_Participant9, Label=0, 셀개수=558
   환자ID=Control_Participant11, Label=0, 셀개수=1164
   환자ID=COVID19_Participant21, Label=1, 셀개수=39
   환자ID=COVID19_Participant30, Label=1, 셀개수=116
   환자ID=COVID19_Participant25, Label=1, 셀개수=496
   환자ID=COVID19_Participant15, Label=1, 셀개수=1003
   환자ID=COVID19_Participant7, Label=1, 셀개수=409
   환자ID=COVID19_Participant39, Label=1, 셀개수=454
   환자ID=COVID19_Participant37, Label=1, 셀개수=668
   환자ID=COVID19_Participant3, Label=1, 셀개수=104
→ valid 환자 ID 및 라벨:
   총 개수: 14
   환자ID=Control_Participant13, Label=0, 셀개수=88
   환자ID=COVID19_Participant29, Label=1, 셀개수=573
   환자ID=COVID19_Participant35, Label=1, 셀개수=83
   환자ID=COVID19_Participant31, Label=1, 셀개수=410
   환자ID=COVID19_Participant6, Label=1, 셀개수=84
   환자ID=COVID19_Participant2, Label=1, 셀개수=329
   환자ID=Control_Participant4, Label=0, 셀개수=440
   환자ID=Control_Participant1, Label=0, 셀개수=414
   환자ID=COVID19_Participant9, Label=1, 셀개수=86
   환자ID=COVID19_Participant8, Label=1, 셀개수=462
   환자ID=Control_Participant12, Label=0, 셀개수=99
   환자ID=COVID19_Participant36, Label=1, 셀개수=200
   환자ID=COVID19_Participant11, Label=1, 셀개수=382
   환자ID=COVID19_Participant23, Label=1, 셀개수=307
→ test 환자 ID 및 라벨:
   총 개수: 10
   환자ID=COVID19_Participant20, Label=1, 셀개수=2033
   환자ID=COVID19_Participant22, Label=1, 셀개수=865
   환자ID=COVID19_Participant26, Label=1, 셀개수=814
   환자ID=COVID19_Participant28, Label=1, 셀개수=1079
   환자ID=COVID19_Participant32, Label=1, 셀개수=1665
   환자ID=COVID19_Participant4, Label=1, 셀개수=1680
   환자ID=COVID19_Participant5, Label=1, 셀개수=89
   환자ID=Control_Participant14, Label=0, 셀개수=274
   환자ID=Control_Participant3, Label=0, 셀개수=1620
   환자ID=Control_Participant6, Label=0, 셀개수=131
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Ciliated Cells', 'Developing Ciliated Cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
전체 데이터 길이 26947
전체 cell type 길이 0        Developing Ciliated Cells
1        Developing Ciliated Cells
2        Developing Ciliated Cells
3        Developing Ciliated Cells
4        Developing Ciliated Cells
                   ...            
26942              Secretory Cells
26943              Secretory Cells
26944                      T Cells
26945              Secretory Cells
26946              Secretory Cells
Length: 26947, dtype: string
cell type의 NaN 개수 체크 0
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:10,  9.78it/s]  2%|▏         | 2/100 [00:00<00:19,  5.07it/s]  4%|▍         | 4/100 [00:00<00:13,  7.21it/s]  6%|▌         | 6/100 [00:00<00:11,  8.36it/s]  7%|▋         | 7/100 [00:01<00:13,  6.75it/s]  8%|▊         | 8/100 [00:01<00:12,  7.12it/s]  9%|▉         | 9/100 [00:01<00:12,  7.47it/s] 10%|█         | 10/100 [00:01<00:17,  5.26it/s] 11%|█         | 11/100 [00:01<00:14,  6.05it/s] 12%|█▏        | 12/100 [00:01<00:13,  6.33it/s] 13%|█▎        | 13/100 [00:01<00:12,  7.09it/s] 14%|█▍        | 14/100 [00:02<00:11,  7.57it/s] 15%|█▌        | 15/100 [00:02<00:18,  4.56it/s] 17%|█▋        | 17/100 [00:02<00:14,  5.91it/s] 19%|█▉        | 19/100 [00:02<00:11,  7.11it/s] 20%|██        | 20/100 [00:03<00:11,  6.85it/s] 21%|██        | 21/100 [00:03<00:10,  7.40it/s] 22%|██▏       | 22/100 [00:03<00:09,  7.83it/s] 23%|██▎       | 23/100 [00:03<00:10,  7.33it/s] 24%|██▍       | 24/100 [00:03<00:09,  7.88it/s] 26%|██▌       | 26/100 [00:03<00:08,  8.60it/s] 27%|██▋       | 27/100 [00:03<00:08,  8.83it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.77it/s] 29%|██▉       | 29/100 [00:04<00:07,  8.95it/s] 30%|███       | 30/100 [00:04<00:08,  8.56it/s] 31%|███       | 31/100 [00:04<00:07,  8.81it/s] 32%|███▏      | 32/100 [00:04<00:07,  9.08it/s] 33%|███▎      | 33/100 [00:04<00:07,  9.29it/s] 35%|███▌      | 35/100 [00:04<00:08,  7.31it/s] 36%|███▌      | 36/100 [00:04<00:08,  7.72it/s] 37%|███▋      | 37/100 [00:05<00:07,  8.09it/s] 38%|███▊      | 38/100 [00:05<00:07,  8.03it/s] 39%|███▉      | 39/100 [00:05<00:07,  7.72it/s] 40%|████      | 40/100 [00:05<00:07,  7.86it/s] 41%|████      | 41/100 [00:05<00:07,  8.35it/s] 42%|████▏     | 42/100 [00:05<00:07,  7.99it/s] 44%|████▍     | 44/100 [00:05<00:06,  8.78it/s] 46%|████▌     | 46/100 [00:06<00:05,  9.08it/s] 47%|████▋     | 47/100 [00:06<00:08,  6.08it/s] 48%|████▊     | 48/100 [00:06<00:07,  6.68it/s] 49%|████▉     | 49/100 [00:06<00:09,  5.11it/s] 50%|█████     | 50/100 [00:06<00:08,  5.81it/s] 51%|█████     | 51/100 [00:07<00:07,  6.50it/s] 52%|█████▏    | 52/100 [00:07<00:06,  7.06it/s] 53%|█████▎    | 53/100 [00:07<00:06,  7.51it/s] 54%|█████▍    | 54/100 [00:07<00:05,  7.99it/s] 55%|█████▌    | 55/100 [00:07<00:05,  8.45it/s] 56%|█████▌    | 56/100 [00:07<00:05,  8.68it/s] 57%|█████▋    | 57/100 [00:07<00:05,  8.51it/s] 59%|█████▉    | 59/100 [00:07<00:04,  9.39it/s] 60%|██████    | 60/100 [00:08<00:04,  9.36it/s] 62%|██████▏   | 62/100 [00:08<00:04,  8.15it/s] 63%|██████▎   | 63/100 [00:08<00:04,  8.20it/s] 65%|██████▌   | 65/100 [00:08<00:03,  8.92it/s] 67%|██████▋   | 67/100 [00:08<00:03,  9.31it/s] 68%|██████▊   | 68/100 [00:08<00:03,  9.38it/s] 69%|██████▉   | 69/100 [00:09<00:03,  9.33it/s] 70%|███████   | 70/100 [00:09<00:03,  9.30it/s] 71%|███████   | 71/100 [00:09<00:03,  9.32it/s] 72%|███████▏  | 72/100 [00:09<00:04,  6.65it/s] 73%|███████▎  | 73/100 [00:09<00:03,  6.89it/s] 74%|███████▍  | 74/100 [00:09<00:04,  5.61it/s] 76%|███████▌  | 76/100 [00:10<00:03,  6.54it/s] 77%|███████▋  | 77/100 [00:10<00:03,  7.04it/s] 78%|███████▊  | 78/100 [00:10<00:02,  7.58it/s] 79%|███████▉  | 79/100 [00:10<00:02,  7.89it/s] 81%|████████  | 81/100 [00:10<00:02,  8.73it/s] 82%|████████▏ | 82/100 [00:10<00:02,  8.66it/s] 83%|████████▎ | 83/100 [00:10<00:02,  8.00it/s] 84%|████████▍ | 84/100 [00:11<00:01,  8.18it/s] 85%|████████▌ | 85/100 [00:11<00:01,  8.17it/s] 86%|████████▌ | 86/100 [00:11<00:01,  8.47it/s] 87%|████████▋ | 87/100 [00:11<00:01,  8.54it/s] 88%|████████▊ | 88/100 [00:11<00:01,  8.18it/s] 89%|████████▉ | 89/100 [00:11<00:01,  8.48it/s] 90%|█████████ | 90/100 [00:11<00:01,  8.74it/s] 91%|█████████ | 91/100 [00:11<00:01,  8.98it/s] 92%|█████████▏| 92/100 [00:11<00:00,  9.26it/s] 93%|█████████▎| 93/100 [00:12<00:00,  9.44it/s] 94%|█████████▍| 94/100 [00:12<00:00,  9.18it/s] 96%|█████████▌| 96/100 [00:12<00:00,  9.69it/s] 97%|█████████▋| 97/100 [00:12<00:00,  9.42it/s] 98%|█████████▊| 98/100 [00:12<00:00,  8.86it/s] 99%|█████████▉| 99/100 [00:12<00:00,  8.97it/s]100%|██████████| 100/100 [00:12<00:00,  7.51it/s]100%|██████████| 100/100 [00:12<00:00,  7.74it/s]
[I 2025-08-30 09:04:48,603] A new study created in memory with name: no-name-325154e7-95ee-49b8-9716-a15f60865bb0
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 27.97 MB
Memory Reserved: 46.00 MB
cuda
Epoch 1, Train Loss 0.558357, Valid_loss 0.527763
Epoch 2, Train Loss 0.370804, Valid_loss 0.507824
Epoch 3, Train Loss 0.335498, Valid_loss 0.481672
Epoch 4, Train Loss 0.290866, Valid_loss 0.557406
Epoch 5, Train Loss 0.283976, Valid_loss 0.396859
Epoch 6, Train Loss 0.253572, Valid_loss 0.436407
Epoch 7, Train Loss 0.241337, Valid_loss 0.497822
Epoch 8, Train Loss 0.241572, Valid_loss 0.398098
Epoch 9, Train Loss 0.231031, Valid_loss 0.362419
Epoch 10, Train Loss 0.228840, Valid_loss 0.377777
Epoch 11, Train Loss 0.221759, Valid_loss 0.395187
Epoch 12, Train Loss 0.221562, Valid_loss 0.398934
Epoch 13, Train Loss 0.220009, Valid_loss 0.355543
Epoch 14, Train Loss 0.225838, Valid_loss 0.392093
Epoch 15, Train Loss 0.220445, Valid_loss 0.347351
Epoch 16, Train Loss 0.242565, Valid_loss 0.348677
Epoch 17, Train Loss 0.223238, Valid_loss 0.344517
Epoch 18, Train Loss 0.228392, Valid_loss 0.323222
Epoch 19, Train Loss 0.219008, Valid_loss 0.338952
Epoch 20, Train Loss 0.220155, Valid_loss 0.326367
Epoch 21, Train Loss 0.211519, Valid_loss 0.314943
Epoch 22, Train Loss 0.219594, Valid_loss 0.326201
Epoch 23, Train Loss 0.212179, Valid_loss 0.351206
Epoch 24, Train Loss 0.240736, Valid_loss 0.418142
Epoch 25, Train Loss 0.249606, Valid_loss 0.381020
Epoch 26, Train Loss 0.227141, Valid_loss 0.323015
Epoch 27, Train Loss 0.219790, Valid_loss 0.325485
Epoch 28, Train Loss 0.208114, Valid_loss 0.307672
Epoch 29, Train Loss 0.205473, Valid_loss 0.301992
Epoch 30, Train Loss 0.202177, Valid_loss 0.296171
Epoch 31, Train Loss 0.202652, Valid_loss 0.279437
Epoch 32, Train Loss 0.198632, Valid_loss 0.283771
Epoch 33, Train Loss 0.200478, Valid_loss 0.278338
Epoch 34, Train Loss 0.209029, Valid_loss 0.279512
Epoch 35, Train Loss 0.200937, Valid_loss 0.267286
Epoch 36, Train Loss 0.202222, Valid_loss 0.353012
Epoch 37, Train Loss 0.219522, Valid_loss 0.275879
Epoch 38, Train Loss 0.214051, Valid_loss 0.274465
Epoch 39, Train Loss 0.215923, Valid_loss 0.275053
Epoch 40, Train Loss 0.209520, Valid_loss 0.289497
Epoch 41, Train Loss 0.211769, Valid_loss 0.265315
Epoch 42, Train Loss 0.203036, Valid_loss 0.300778
Epoch 43, Train Loss 0.205629, Valid_loss 0.286877
Epoch 44, Train Loss 0.208718, Valid_loss 0.325572
Epoch 45, Train Loss 0.198246, Valid_loss 0.264262
Epoch 46, Train Loss 0.202844, Valid_loss 0.252989
Epoch 47, Train Loss 0.197813, Valid_loss 0.348250
Epoch 48, Train Loss 0.208717, Valid_loss 0.280583
Epoch 49, Train Loss 0.217343, Valid_loss 0.288022
Epoch 50, Train Loss 0.201196, Valid_loss 0.309097
Epoch 51, Train Loss 0.195996, Valid_loss 0.288321
Epoch 52, Train Loss 0.196480, Valid_loss 0.260196
Epoch 53, Train Loss 0.190533, Valid_loss 0.254060
Epoch 54, Train Loss 0.192470, Valid_loss 0.271755
Epoch 55, Train Loss 0.190764, Valid_loss 0.263072
Epoch 56, Train Loss 0.189620, Valid_loss 0.263160
Epoch 57, Train Loss 0.189870, Valid_loss 0.279777
[I 2025-08-30 09:08:40,953] Trial 0 finished with value: 0.25298881956509184 and parameters: {'learning_rate': 0.001, 'epochs': 100, 'heads': 2, 'dropout': 0.0, 'weight_decay': 0.01, 'emb_dim': 64, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.25298881956509184.
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 26.13 MB
Memory Reserved: 46.00 MB
cuda
Epoch 1, Train Loss 0.671249, Valid_loss 0.592773
Epoch 2, Train Loss 0.649027, Valid_loss 0.579622
Epoch 3, Train Loss 0.587804, Valid_loss 0.552009
Epoch 4, Train Loss 0.552050, Valid_loss 0.523124
Epoch 5, Train Loss 0.501090, Valid_loss 0.494201
Epoch 6, Train Loss 0.479130, Valid_loss 0.479643
Epoch 7, Train Loss 0.432570, Valid_loss 0.466942
Epoch 8, Train Loss 0.405385, Valid_loss 0.459267
Epoch 9, Train Loss 0.405022, Valid_loss 0.451253
Epoch 10, Train Loss 0.382734, Valid_loss 0.451862
Epoch 11, Train Loss 0.368111, Valid_loss 0.436306
Epoch 12, Train Loss 0.357715, Valid_loss 0.429737
Epoch 13, Train Loss 0.351642, Valid_loss 0.422073
Epoch 14, Train Loss 0.351999, Valid_loss 0.431097
Epoch 15, Train Loss 0.348751, Valid_loss 0.424000
Epoch 16, Train Loss 0.348819, Valid_loss 0.452811
Epoch 17, Train Loss 0.335370, Valid_loss 0.416992
Epoch 18, Train Loss 0.328972, Valid_loss 0.422599
Epoch 19, Train Loss 0.336417, Valid_loss 0.420731
Epoch 20, Train Loss 0.327012, Valid_loss 0.418481
Epoch 21, Train Loss 0.323987, Valid_loss 0.424159
Epoch 22, Train Loss 0.323587, Valid_loss 0.414628
Epoch 23, Train Loss 0.321582, Valid_loss 0.412752
Epoch 24, Train Loss 0.316669, Valid_loss 0.417884
Epoch 25, Train Loss 0.311081, Valid_loss 0.410296
Epoch 26, Train Loss 0.324430, Valid_loss 0.401442
Epoch 27, Train Loss 0.314389, Valid_loss 0.409869
Epoch 28, Train Loss 0.309107, Valid_loss 0.397464
Epoch 29, Train Loss 0.305664, Valid_loss 0.431615
Epoch 30, Train Loss 0.301096, Valid_loss 0.407076
Epoch 31, Train Loss 0.298027, Valid_loss 0.425221
Epoch 32, Train Loss 0.309789, Valid_loss 0.414591
Epoch 33, Train Loss 0.297647, Valid_loss 0.410617
Epoch 34, Train Loss 0.300057, Valid_loss 0.415519
Epoch 35, Train Loss 0.293049, Valid_loss 0.418403
Epoch 36, Train Loss 0.293708, Valid_loss 0.429617
Epoch 37, Train Loss 0.286971, Valid_loss 0.417197
Epoch 38, Train Loss 0.288752, Valid_loss 0.402918
Epoch 39, Train Loss 0.285344, Valid_loss 0.419440
Epoch 40, Train Loss 0.279042, Valid_loss 0.406638
Epoch 41, Train Loss 0.290382, Valid_loss 0.392780
Epoch 42, Train Loss 0.303920, Valid_loss 0.406082
Epoch 43, Train Loss 0.285521, Valid_loss 0.392051
Epoch 44, Train Loss 0.265739, Valid_loss 0.400063
Epoch 45, Train Loss 0.272259, Valid_loss 0.406513
Epoch 46, Train Loss 0.268713, Valid_loss 0.417768
Epoch 47, Train Loss 0.267102, Valid_loss 0.398701
Epoch 48, Train Loss 0.267066, Valid_loss 0.408814
Epoch 49, Train Loss 0.274523, Valid_loss 0.425649
Epoch 50, Train Loss 0.267921, Valid_loss 0.408425
Epoch 51, Train Loss 0.270147, Valid_loss 0.400204
Epoch 52, Train Loss 0.273320, Valid_loss 0.399236
Epoch 53, Train Loss 0.279908, Valid_loss 0.410181
Epoch 54, Train Loss 0.276056, Valid_loss 0.399880
Epoch 55, Train Loss 0.271576, Valid_loss 0.408263
Epoch 56, Train Loss 0.271636, Valid_loss 0.397100
Epoch 57, Train Loss 0.267376, Valid_loss 0.408990
Epoch 58, Train Loss 0.265292, Valid_loss 0.402485
Epoch 59, Train Loss 0.262136, Valid_loss 0.419831
Epoch 60, Train Loss 0.272024, Valid_loss 0.420723
[I 2025-08-30 09:12:32,391] Trial 1 finished with value: 0.39205098684344974 and parameters: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 1, 'dropout': 0.3, 'weight_decay': 0.0001, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.25298881956509184.
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 26.13 MB
Memory Reserved: 46.00 MB
cuda
Epoch 1, Train Loss 0.640941, Valid_loss 0.562096
Epoch 2, Train Loss 0.556319, Valid_loss 0.518347
Epoch 3, Train Loss 0.458150, Valid_loss 0.521341
Epoch 4, Train Loss 0.379588, Valid_loss 0.463606
Epoch 5, Train Loss 0.343459, Valid_loss 0.437198
Epoch 6, Train Loss 0.354161, Valid_loss 0.431467
Epoch 7, Train Loss 0.334894, Valid_loss 0.429885
Epoch 8, Train Loss 0.317081, Valid_loss 0.454502
Epoch 9, Train Loss 0.294897, Valid_loss 0.448021
Epoch 10, Train Loss 0.303873, Valid_loss 0.453565
Epoch 11, Train Loss 0.294202, Valid_loss 0.446977
Epoch 12, Train Loss 0.275180, Valid_loss 0.396951
Epoch 13, Train Loss 0.285972, Valid_loss 0.399403
Epoch 14, Train Loss 0.300174, Valid_loss 0.412952
Epoch 15, Train Loss 0.262076, Valid_loss 0.402157
Epoch 16, Train Loss 0.297028, Valid_loss 0.415680
Epoch 17, Train Loss 0.265206, Valid_loss 0.458851
Epoch 18, Train Loss 0.267615, Valid_loss 0.400978
Epoch 19, Train Loss 0.269081, Valid_loss 0.409869
Epoch 20, Train Loss 0.276422, Valid_loss 0.538128
Epoch 21, Train Loss 0.261718, Valid_loss 0.386248
Epoch 22, Train Loss 0.276276, Valid_loss 0.400478
Epoch 23, Train Loss 0.265621, Valid_loss 0.412463
Epoch 24, Train Loss 0.229844, Valid_loss 0.423800
Epoch 25, Train Loss 0.276256, Valid_loss 0.445750
Epoch 26, Train Loss 0.259331, Valid_loss 0.487695
Epoch 27, Train Loss 0.251857, Valid_loss 0.416032
Epoch 28, Train Loss 0.273252, Valid_loss 0.408535
Epoch 29, Train Loss 0.236475, Valid_loss 0.424731
Epoch 30, Train Loss 0.240057, Valid_loss 0.408553
Epoch 31, Train Loss 0.221955, Valid_loss 0.387384
Epoch 32, Train Loss 0.239722, Valid_loss 0.402158
Epoch 33, Train Loss 0.232125, Valid_loss 0.411456
Epoch 34, Train Loss 0.250347, Valid_loss 0.382142
Epoch 35, Train Loss 0.242668, Valid_loss 0.413277
Epoch 36, Train Loss 0.221728, Valid_loss 0.394185
Epoch 37, Train Loss 0.247822, Valid_loss 0.386252
Epoch 38, Train Loss 0.232912, Valid_loss 0.365020
Epoch 39, Train Loss 0.214627, Valid_loss 0.383482
Epoch 40, Train Loss 0.226002, Valid_loss 0.470919
Epoch 41, Train Loss 0.222791, Valid_loss 0.357605
Epoch 42, Train Loss 0.224794, Valid_loss 0.370832
Epoch 43, Train Loss 0.228869, Valid_loss 0.371185
Epoch 44, Train Loss 0.214675, Valid_loss 0.371281
Epoch 45, Train Loss 0.223623, Valid_loss 0.360808
Epoch 46, Train Loss 0.217348, Valid_loss 0.400016
Epoch 47, Train Loss 0.222109, Valid_loss 0.422119
Epoch 48, Train Loss 0.222143, Valid_loss 0.417925
Epoch 49, Train Loss 0.211698, Valid_loss 0.400683
Epoch 50, Train Loss 0.214260, Valid_loss 0.385471
Epoch 51, Train Loss 0.205142, Valid_loss 0.395971
Epoch 52, Train Loss 0.214067, Valid_loss 0.425751
[I 2025-08-30 09:16:08,490] Trial 2 finished with value: 0.3576048603281379 and parameters: {'learning_rate': 0.001, 'epochs': 100, 'heads': 2, 'dropout': 0.5, 'weight_decay': 0.0001, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.25298881956509184.
선택된 trial params: {'learning_rate': 0.001, 'epochs': 100, 'heads': 2, 'dropout': 0.0, 'weight_decay': 0.01, 'emb_dim': 64, 'augment_num': 100, 'pca': False}
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=10, batch_size=1 -> steps=10
output_class :  1
Memory Allocated: 27.97 MB
Memory Reserved: 46.00 MB
cuda
Epoch 1, Train Loss 0.548674, Valid_loss 0.477716
Epoch 2, Train Loss 0.365789, Valid_loss 0.459008
Epoch 3, Train Loss 0.294722, Valid_loss 0.527864
Epoch 4, Train Loss 0.276475, Valid_loss 0.412953
Epoch 5, Train Loss 0.248225, Valid_loss 0.397741
Epoch 6, Train Loss 0.240070, Valid_loss 0.434674
Epoch 7, Train Loss 0.239942, Valid_loss 0.361650
Epoch 8, Train Loss 0.232590, Valid_loss 0.367803
Epoch 9, Train Loss 0.226070, Valid_loss 0.379123
Epoch 10, Train Loss 0.227667, Valid_loss 0.380267
Epoch 11, Train Loss 0.255774, Valid_loss 0.390875
Epoch 12, Train Loss 0.231700, Valid_loss 0.331043
Epoch 13, Train Loss 0.227244, Valid_loss 0.328388
Epoch 14, Train Loss 0.224741, Valid_loss 0.312951
Epoch 15, Train Loss 0.213154, Valid_loss 0.311816
Epoch 16, Train Loss 0.219359, Valid_loss 0.324496
Epoch 17, Train Loss 0.224401, Valid_loss 0.337248
Epoch 18, Train Loss 0.219723, Valid_loss 0.330566
Epoch 19, Train Loss 0.223328, Valid_loss 0.340827
Epoch 20, Train Loss 0.211317, Valid_loss 0.319778
Epoch 21, Train Loss 0.213394, Valid_loss 0.326412
Epoch 22, Train Loss 0.213516, Valid_loss 0.291849
Epoch 23, Train Loss 0.207479, Valid_loss 0.319159
Epoch 24, Train Loss 0.215663, Valid_loss 0.340593
Epoch 25, Train Loss 0.222572, Valid_loss 0.376430
Epoch 26, Train Loss 0.221298, Valid_loss 0.336763
Epoch 27, Train Loss 0.210743, Valid_loss 0.315884
Epoch 28, Train Loss 0.209267, Valid_loss 0.285661
Epoch 29, Train Loss 0.209883, Valid_loss 0.330910
Epoch 30, Train Loss 0.216510, Valid_loss 0.299748
Epoch 31, Train Loss 0.202457, Valid_loss 0.308865
Epoch 32, Train Loss 0.198851, Valid_loss 0.300214
Epoch 33, Train Loss 0.199321, Valid_loss 0.298955
Epoch 34, Train Loss 0.197260, Valid_loss 0.292206
Epoch 35, Train Loss 0.196250, Valid_loss 0.293663
Epoch 36, Train Loss 0.198547, Valid_loss 0.301420
Epoch 37, Train Loss 0.205622, Valid_loss 0.543014
Epoch 38, Train Loss 0.241098, Valid_loss 0.334545
Epoch 39, Train Loss 0.207562, Valid_loss 0.322071
Epoch 40, Train Loss 0.195788, Valid_loss 0.311762
Epoch 41, Train Loss 0.194602, Valid_loss 0.296425
Epoch 42, Train Loss 0.197598, Valid_loss 0.297660
Epoch 43, Train Loss 0.206192, Valid_loss 0.278083
Epoch 44, Train Loss 0.211937, Valid_loss 0.302342
Epoch 45, Train Loss 0.202055, Valid_loss 0.308548
Epoch 46, Train Loss 0.202073, Valid_loss 0.301384
Epoch 47, Train Loss 0.192770, Valid_loss 0.309418
Epoch 48, Train Loss 0.198002, Valid_loss 0.308492
Epoch 49, Train Loss 0.200235, Valid_loss 0.270537
Epoch 50, Train Loss 0.207836, Valid_loss 0.288307
Epoch 51, Train Loss 0.192885, Valid_loss 0.282608
Epoch 52, Train Loss 0.191556, Valid_loss 0.287210
Epoch 53, Train Loss 0.189692, Valid_loss 0.280536
Epoch 54, Train Loss 0.186928, Valid_loss 0.275712
Epoch 55, Train Loss 0.190688, Valid_loss 0.275866
Epoch 56, Train Loss 0.192501, Valid_loss 0.277253
환자ID=COVID19_Participant20 -- true: 1 -- pred: 1
환자ID=COVID19_Participant22 -- true: 1 -- pred: 1
환자ID=COVID19_Participant26 -- true: 1 -- pred: 1
환자ID=COVID19_Participant28 -- true: 1 -- pred: 1
환자ID=COVID19_Participant32 -- true: 1 -- pred: 0
환자ID=COVID19_Participant4 -- true: 1 -- pred: 1
환자ID=COVID19_Participant5 -- true: 1 -- pred: 1
환자ID=Control_Participant14 -- true: 0 -- pred: 0
환자ID=Control_Participant3 -- true: 0 -- pred: 0
환자ID=Control_Participant6 -- true: 0 -- pred: 0
Best performance: Epoch 49, Loss 0.200235, Test ACC 0.900000, Test AUC 1.000000, Test Recall 0.857143, Test Precision 1.000000
Confusion Matrix:
 [3 0 1 6]
✅ Total valid splits used: 4
🔁 Repeat 3, Fold 4
cell type :  TTGCGGTGACCA_COVID19_Participant31    Ciliated Cells
AGGCTCGAACTG_COVID19_Participant31    Ciliated Cells
TATCCGTATGTT_COVID19_Participant31      Goblet Cells
CAGACAGCGGCT_COVID19_Participant31       Basal Cells
CAAAGAGAACTA_COVID19_Participant31    Ciliated Cells
                                           ...      
GCAGGGAACTCC_COVID19_Participant30    Squamous Cells
CAGCACCGAGCC_COVID19_Participant30    Squamous Cells
GCCCCTTGTGAT_COVID19_Participant30    Squamous Cells
GTGTTGTGTGTC_COVID19_Participant30    Squamous Cells
TAACACTCACTT_COVID19_Participant30    Squamous Cells
Name: manual_annotation, Length: 22635, dtype: string
cell type annotation :  TTGCGGTGACCA_COVID19_Participant31    Ciliated Cells
AGGCTCGAACTG_COVID19_Participant31    Ciliated Cells
TATCCGTATGTT_COVID19_Participant31      Goblet Cells
CAGACAGCGGCT_COVID19_Participant31       Basal Cells
CAAAGAGAACTA_COVID19_Participant31    Ciliated Cells
                                           ...      
GCAGGGAACTCC_COVID19_Participant30    Squamous Cells
CAGCACCGAGCC_COVID19_Participant30    Squamous Cells
GCCCCTTGTGAT_COVID19_Participant30    Squamous Cells
GTGTTGTGTGTC_COVID19_Participant30    Squamous Cells
TAACACTCACTT_COVID19_Participant30    Squamous Cells
Name: manual_annotation, Length: 22635, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Ciliated Cells', 'Goblet Cells', 'Basal Cells', 'Developing Secretory and Goblet Cells', 'Macrophages', 'T Cells', 'Deuterosomal Cells', 'Mitotic Basal Cells', 'Developing Ciliated Cells', 'Secretory Cells', 'Squamous Cells', 'Plasmacytoid DCs', 'Ionocytes', 'Enteroendocrine Cells', 'Dendritic Cells', 'B Cells', 'Erythroblasts', 'Mast Cells']
라벨별 그룹 개수 {1: 28, 0: 12}
cell type :  GTCGGGGGGTGG_Control_Participant7     Developing Ciliated Cells
CAAATCAATTAT_Control_Participant7     Developing Ciliated Cells
ATACAATTGACA_Control_Participant7     Developing Ciliated Cells
CTGTTAATGAGA_Control_Participant7     Developing Ciliated Cells
CTTCACATTATT_Control_Participant7     Developing Ciliated Cells
                                                ...            
ACCATATTCAGG_COVID19_Participant21    Developing Ciliated Cells
GCCCGTTTCACG_COVID19_Participant21              Secretory Cells
TATTATCTCTTA_COVID19_Participant21    Developing Ciliated Cells
TTCCGTTTGTCC_COVID19_Participant21                 Goblet Cells
TCGGGATTGGAT_COVID19_Participant21               Ciliated Cells
Name: manual_annotation, Length: 4312, dtype: string
cell type annotation :  GTCGGGGGGTGG_Control_Participant7     Developing Ciliated Cells
CAAATCAATTAT_Control_Participant7     Developing Ciliated Cells
ATACAATTGACA_Control_Participant7     Developing Ciliated Cells
CTGTTAATGAGA_Control_Participant7     Developing Ciliated Cells
CTTCACATTATT_Control_Participant7     Developing Ciliated Cells
                                                ...            
ACCATATTCAGG_COVID19_Participant21    Developing Ciliated Cells
GCCCGTTTCACG_COVID19_Participant21              Secretory Cells
TATTATCTCTTA_COVID19_Participant21    Developing Ciliated Cells
TTCCGTTTGTCC_COVID19_Participant21                 Goblet Cells
TCGGGATTGGAT_COVID19_Participant21               Ciliated Cells
Name: manual_annotation, Length: 4312, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Developing Ciliated Cells', 'Ciliated Cells', 'Secretory Cells', 'Squamous Cells', 'Goblet Cells', 'T Cells', 'Dendritic Cells', 'Basal Cells', 'Deuterosomal Cells', 'Mitotic Basal Cells', 'Macrophages', 'B Cells', 'Ionocytes', 'Developing Secretory and Goblet Cells', 'Enteroendocrine Cells', 'Erythroblasts']
라벨별 그룹 개수 {1: 7, 0: 3}
🔍 Split #5
  → train_p_index 환자 수 (환자 단위로 묶인 index list): 40
  → test_p_index 환자 수  (환자 단위로 묶인 index list): 10
  → train 환자 ID: ['COVID19_Participant11', 'COVID19_Participant12', 'COVID19_Participant15', 'COVID19_Participant17', 'COVID19_Participant18', 'COVID19_Participant19', 'COVID19_Participant2', 'COVID19_Participant20', 'COVID19_Participant22', 'COVID19_Participant23', 'COVID19_Participant25', 'COVID19_Participant26', 'COVID19_Participant27', 'COVID19_Participant28', 'COVID19_Participant3', 'COVID19_Participant30', 'COVID19_Participant31', 'COVID19_Participant32', 'COVID19_Participant35', 'COVID19_Participant37', 'COVID19_Participant39', 'COVID19_Participant4', 'COVID19_Participant40', 'COVID19_Participant5', 'COVID19_Participant6', 'COVID19_Participant7', 'COVID19_Participant8', 'COVID19_Participant9', 'Control_Participant1', 'Control_Participant10', 'Control_Participant12', 'Control_Participant13', 'Control_Participant14', 'Control_Participant15', 'Control_Participant2', 'Control_Participant3', 'Control_Participant4', 'Control_Participant5', 'Control_Participant6', 'Control_Participant9']
  → test  환자 ID: ['COVID19_Participant10', 'COVID19_Participant13', 'COVID19_Participant14', 'COVID19_Participant21', 'COVID19_Participant29', 'COVID19_Participant36', 'COVID19_Participant38', 'Control_Participant11', 'Control_Participant7', 'Control_Participant8']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant12, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant18, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant27, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant3, Label: 1
    ID: COVID19_Participant30, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant35, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: COVID19_Participant5, Label: 1
    ID: COVID19_Participant6, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: COVID19_Participant9, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant10, Label: 0
    ID: Control_Participant12, Label: 0
    ID: Control_Participant13, Label: 0
    ID: Control_Participant14, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant2, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant4, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant6, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: COVID19_Participant10, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant21, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant36, Label: 1
    ID: COVID19_Participant38, Label: 1
    ID: Control_Participant11, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant8, Label: 0
전체 데이터 index 길이 50
label_stat (train 환자 라벨 목록) 갯수 40
train_data에서 환자 단위로, train과 validation 나누기
기존 train_p_index 40
기존 (train) label_stat 40
train-vali 분할 후! 
train y 의 classes : {0, 1} valid y 의 classes : {0, 1} label_stat 의 classes : {0, 1}
train_p_index_ 26
valid_p_index 14
test_p_index 10
→ train 환자 ID 및 라벨:
   총 개수: 26
   환자ID=Control_Participant10, Label=0, 셀개수=1645
   환자ID=Control_Participant15, Label=0, 셀개수=528
   환자ID=COVID19_Participant2, Label=1, 셀개수=329
   환자ID=COVID19_Participant4, Label=1, 셀개수=1680
   환자ID=COVID19_Participant11, Label=1, 셀개수=382
   환자ID=Control_Participant4, Label=0, 셀개수=440
   환자ID=COVID19_Participant17, Label=1, 셀개수=843
   환자ID=COVID19_Participant20, Label=1, 셀개수=2033
   환자ID=COVID19_Participant5, Label=1, 셀개수=89
   환자ID=COVID19_Participant15, Label=1, 셀개수=1003
   환자ID=COVID19_Participant22, Label=1, 셀개수=865
   환자ID=Control_Participant2, Label=0, 셀개수=41
   환자ID=COVID19_Participant28, Label=1, 셀개수=1079
   환자ID=Control_Participant6, Label=0, 셀개수=131
   환자ID=Control_Participant5, Label=0, 셀개수=717
   환자ID=COVID19_Participant18, Label=1, 셀개수=227
   환자ID=Control_Participant9, Label=0, 셀개수=558
   환자ID=Control_Participant12, Label=0, 셀개수=99
   환자ID=COVID19_Participant25, Label=1, 셀개수=496
   환자ID=COVID19_Participant31, Label=1, 셀개수=410
   환자ID=COVID19_Participant27, Label=1, 셀개수=93
   환자ID=COVID19_Participant19, Label=1, 셀개수=816
   환자ID=COVID19_Participant7, Label=1, 셀개수=409
   환자ID=COVID19_Participant40, Label=1, 셀개수=381
   환자ID=COVID19_Participant39, Label=1, 셀개수=454
   환자ID=COVID19_Participant30, Label=1, 셀개수=116
→ valid 환자 ID 및 라벨:
   총 개수: 14
   환자ID=Control_Participant14, Label=0, 셀개수=274
   환자ID=COVID19_Participant3, Label=1, 셀개수=104
   환자ID=COVID19_Participant35, Label=1, 셀개수=83
   환자ID=COVID19_Participant32, Label=1, 셀개수=1665
   환자ID=COVID19_Participant6, Label=1, 셀개수=84
   환자ID=COVID19_Participant23, Label=1, 셀개수=307
   환자ID=Control_Participant3, Label=0, 셀개수=1620
   환자ID=Control_Participant1, Label=0, 셀개수=414
   환자ID=COVID19_Participant9, Label=1, 셀개수=86
   환자ID=COVID19_Participant8, Label=1, 셀개수=462
   환자ID=Control_Participant13, Label=0, 셀개수=88
   환자ID=COVID19_Participant37, Label=1, 셀개수=668
   환자ID=COVID19_Participant12, Label=1, 셀개수=102
   환자ID=COVID19_Participant26, Label=1, 셀개수=814
→ test 환자 ID 및 라벨:
   총 개수: 10
   환자ID=COVID19_Participant10, Label=1, 셀개수=18
   환자ID=COVID19_Participant13, Label=1, 셀개수=730
   환자ID=COVID19_Participant14, Label=1, 셀개수=382
   환자ID=COVID19_Participant21, Label=1, 셀개수=39
   환자ID=COVID19_Participant29, Label=1, 셀개수=573
   환자ID=COVID19_Participant36, Label=1, 셀개수=200
   환자ID=COVID19_Participant38, Label=1, 셀개수=51
   환자ID=Control_Participant11, Label=0, 셀개수=1164
   환자ID=Control_Participant7, Label=0, 셀개수=762
   환자ID=Control_Participant8, Label=0, 셀개수=393
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Ciliated Cells', 'Ciliated Cells', 'Goblet Cells', 'Basal Cells', 'Ciliated Cells', 'Developing Secretory and Goblet Cells', 'Basal Cells', 'Ciliated Cells', 'Basal Cells', 'Developing Secretory and Goblet Cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
전체 데이터 길이 26947
전체 cell type 길이 0                   Ciliated Cells
1                   Ciliated Cells
2                     Goblet Cells
3                      Basal Cells
4                   Ciliated Cells
                   ...            
26942    Developing Ciliated Cells
26943              Secretory Cells
26944    Developing Ciliated Cells
26945                 Goblet Cells
26946               Ciliated Cells
Length: 26947, dtype: string
cell type의 NaN 개수 체크 0
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:12,  8.23it/s]  2%|▏         | 2/100 [00:00<00:12,  8.10it/s]  3%|▎         | 3/100 [00:00<00:11,  8.74it/s]  4%|▍         | 4/100 [00:00<00:11,  8.63it/s]  6%|▌         | 6/100 [00:00<00:09,  9.57it/s]  8%|▊         | 8/100 [00:00<00:11,  8.07it/s]  9%|▉         | 9/100 [00:01<00:11,  8.15it/s] 10%|█         | 10/100 [00:01<00:10,  8.54it/s] 11%|█         | 11/100 [00:01<00:10,  8.87it/s] 13%|█▎        | 13/100 [00:01<00:09,  9.64it/s] 15%|█▌        | 15/100 [00:01<00:08,  9.95it/s] 16%|█▌        | 16/100 [00:01<00:10,  8.11it/s] 17%|█▋        | 17/100 [00:02<00:11,  7.17it/s] 18%|█▊        | 18/100 [00:02<00:10,  7.68it/s] 19%|█▉        | 19/100 [00:02<00:10,  7.94it/s] 20%|██        | 20/100 [00:02<00:09,  8.30it/s] 22%|██▏       | 22/100 [00:02<00:08,  8.97it/s] 23%|██▎       | 23/100 [00:02<00:08,  9.01it/s] 25%|██▌       | 25/100 [00:02<00:07,  9.38it/s] 26%|██▌       | 26/100 [00:03<00:08,  8.90it/s] 27%|██▋       | 27/100 [00:03<00:09,  7.76it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.14it/s] 29%|██▉       | 29/100 [00:03<00:08,  8.22it/s] 30%|███       | 30/100 [00:03<00:08,  8.30it/s] 32%|███▏      | 32/100 [00:03<00:09,  7.24it/s] 33%|███▎      | 33/100 [00:04<00:09,  7.12it/s] 34%|███▍      | 34/100 [00:04<00:08,  7.67it/s] 36%|███▌      | 36/100 [00:04<00:07,  8.35it/s] 37%|███▋      | 37/100 [00:04<00:07,  8.43it/s] 39%|███▉      | 39/100 [00:04<00:06,  9.21it/s] 40%|████      | 40/100 [00:04<00:06,  9.03it/s] 42%|████▏     | 42/100 [00:04<00:06,  9.44it/s] 44%|████▍     | 44/100 [00:05<00:05,  9.70it/s] 45%|████▌     | 45/100 [00:05<00:05,  9.74it/s] 46%|████▌     | 46/100 [00:05<00:05,  9.68it/s] 47%|████▋     | 47/100 [00:05<00:05,  9.09it/s] 48%|████▊     | 48/100 [00:05<00:05,  8.99it/s] 49%|████▉     | 49/100 [00:06<00:09,  5.10it/s] 50%|█████     | 50/100 [00:06<00:09,  5.06it/s] 51%|█████     | 51/100 [00:06<00:08,  5.59it/s] 52%|█████▏    | 52/100 [00:06<00:07,  6.33it/s] 53%|█████▎    | 53/100 [00:06<00:06,  7.07it/s] 54%|█████▍    | 54/100 [00:06<00:06,  7.12it/s] 55%|█████▌    | 55/100 [00:06<00:06,  7.28it/s] 56%|█████▌    | 56/100 [00:06<00:05,  7.59it/s] 57%|█████▋    | 57/100 [00:07<00:05,  8.03it/s] 58%|█████▊    | 58/100 [00:07<00:04,  8.45it/s] 59%|█████▉    | 59/100 [00:07<00:07,  5.83it/s] 60%|██████    | 60/100 [00:07<00:07,  5.50it/s] 62%|██████▏   | 62/100 [00:07<00:05,  6.82it/s] 63%|██████▎   | 63/100 [00:08<00:07,  4.89it/s] 64%|██████▍   | 64/100 [00:08<00:06,  5.58it/s] 65%|██████▌   | 65/100 [00:08<00:05,  6.34it/s] 67%|██████▋   | 67/100 [00:08<00:04,  7.20it/s] 68%|██████▊   | 68/100 [00:08<00:04,  6.63it/s] 69%|██████▉   | 69/100 [00:08<00:04,  7.16it/s] 70%|███████   | 70/100 [00:09<00:04,  7.48it/s] 71%|███████   | 71/100 [00:09<00:03,  7.93it/s] 72%|███████▏  | 72/100 [00:09<00:03,  8.08it/s] 73%|███████▎  | 73/100 [00:09<00:03,  8.26it/s] 74%|███████▍  | 74/100 [00:09<00:03,  8.32it/s] 75%|███████▌  | 75/100 [00:09<00:03,  8.08it/s] 76%|███████▌  | 76/100 [00:09<00:03,  7.89it/s] 78%|███████▊  | 78/100 [00:10<00:02,  8.58it/s] 79%|███████▉  | 79/100 [00:10<00:02,  8.77it/s] 80%|████████  | 80/100 [00:10<00:02,  8.66it/s] 81%|████████  | 81/100 [00:10<00:02,  7.49it/s] 82%|████████▏ | 82/100 [00:10<00:02,  7.63it/s] 83%|████████▎ | 83/100 [00:10<00:02,  6.79it/s] 84%|████████▍ | 84/100 [00:10<00:02,  7.35it/s] 85%|████████▌ | 85/100 [00:10<00:01,  7.75it/s] 86%|████████▌ | 86/100 [00:11<00:01,  7.77it/s] 87%|████████▋ | 87/100 [00:11<00:01,  7.78it/s] 88%|████████▊ | 88/100 [00:11<00:01,  8.14it/s] 89%|████████▉ | 89/100 [00:11<00:01,  8.33it/s] 90%|█████████ | 90/100 [00:11<00:01,  8.54it/s] 91%|█████████ | 91/100 [00:11<00:01,  8.62it/s] 92%|█████████▏| 92/100 [00:11<00:01,  7.94it/s] 93%|█████████▎| 93/100 [00:11<00:00,  8.43it/s] 94%|█████████▍| 94/100 [00:12<00:00,  7.44it/s] 95%|█████████▌| 95/100 [00:12<00:00,  7.66it/s] 96%|█████████▌| 96/100 [00:12<00:00,  8.04it/s] 97%|█████████▋| 97/100 [00:12<00:00,  8.32it/s] 98%|█████████▊| 98/100 [00:12<00:00,  8.55it/s] 99%|█████████▉| 99/100 [00:12<00:00,  8.69it/s]100%|██████████| 100/100 [00:12<00:00,  8.84it/s]100%|██████████| 100/100 [00:12<00:00,  7.84it/s]
[I 2025-08-30 09:20:11,078] A new study created in memory with name: no-name-2cf69396-8c1a-405f-ba1d-10e13856631d
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 26.13 MB
Memory Reserved: 46.00 MB
cuda
Epoch 1, Train Loss 0.695953, Valid_loss 0.615706
Epoch 2, Train Loss 0.638277, Valid_loss 0.600460
Epoch 3, Train Loss 0.658666, Valid_loss 0.607237
Epoch 4, Train Loss 0.629483, Valid_loss 0.597420
Epoch 5, Train Loss 0.636064, Valid_loss 0.605974
Epoch 6, Train Loss 0.615909, Valid_loss 0.437289
Epoch 7, Train Loss 0.415604, Valid_loss 0.430451
Epoch 8, Train Loss 0.430706, Valid_loss 0.495231
Epoch 9, Train Loss 0.365953, Valid_loss 0.413840
Epoch 10, Train Loss 0.295735, Valid_loss 0.392028
Epoch 11, Train Loss 0.292092, Valid_loss 0.327811
Epoch 12, Train Loss 0.265356, Valid_loss 0.411870
Epoch 13, Train Loss 0.242604, Valid_loss 0.392860
Epoch 14, Train Loss 0.253152, Valid_loss 0.354161
Epoch 15, Train Loss 0.234346, Valid_loss 0.375686
Epoch 16, Train Loss 0.239639, Valid_loss 0.446932
Epoch 17, Train Loss 0.237549, Valid_loss 0.367167
Epoch 18, Train Loss 0.210933, Valid_loss 0.320803
Epoch 19, Train Loss 0.261795, Valid_loss 0.328905
Epoch 20, Train Loss 0.237833, Valid_loss 0.346300
Epoch 21, Train Loss 0.224279, Valid_loss 0.313048
Epoch 22, Train Loss 0.203729, Valid_loss 0.382736
Epoch 23, Train Loss 0.213434, Valid_loss 0.356574
Epoch 24, Train Loss 0.224421, Valid_loss 0.379067
Epoch 25, Train Loss 0.221167, Valid_loss 0.363143
Epoch 26, Train Loss 0.237401, Valid_loss 0.319200
Epoch 27, Train Loss 0.206353, Valid_loss 0.342965
Epoch 28, Train Loss 0.235293, Valid_loss 0.321428
Epoch 29, Train Loss 0.197513, Valid_loss 0.327472
Epoch 30, Train Loss 0.187566, Valid_loss 0.310860
Epoch 31, Train Loss 0.200003, Valid_loss 0.323089
Epoch 32, Train Loss 0.186587, Valid_loss 0.353354
Epoch 33, Train Loss 0.193974, Valid_loss 0.374328
Epoch 34, Train Loss 0.191363, Valid_loss 0.328062
Epoch 35, Train Loss 0.192409, Valid_loss 0.305302
Epoch 36, Train Loss 0.198553, Valid_loss 0.310391
Epoch 37, Train Loss 0.225586, Valid_loss 0.428674
Epoch 38, Train Loss 0.244690, Valid_loss 0.406939
Epoch 39, Train Loss 0.224975, Valid_loss 0.293626
Epoch 40, Train Loss 0.204610, Valid_loss 0.380465
Epoch 41, Train Loss 0.194986, Valid_loss 0.304052
Epoch 42, Train Loss 0.194920, Valid_loss 0.362202
Epoch 43, Train Loss 0.198325, Valid_loss 0.396067
Epoch 44, Train Loss 0.206736, Valid_loss 0.472032
Epoch 45, Train Loss 0.205006, Valid_loss 0.382845
Epoch 46, Train Loss 0.197603, Valid_loss 0.311025
Epoch 47, Train Loss 0.189531, Valid_loss 0.326311
Epoch 48, Train Loss 0.195489, Valid_loss 0.310130
Epoch 49, Train Loss 0.197267, Valid_loss 0.298615
Epoch 50, Train Loss 0.188109, Valid_loss 0.300988
Epoch 51, Train Loss 0.181778, Valid_loss 0.272435
Epoch 52, Train Loss 0.183379, Valid_loss 0.275826
Epoch 53, Train Loss 0.176624, Valid_loss 0.286584
[I 2025-08-30 09:24:22,545] Trial 0 finished with value: 0.2724354504275003 and parameters: {'learning_rate': 0.01, 'epochs': 100, 'heads': 4, 'dropout': 0.3, 'weight_decay': 0.001, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.2724354504275003.
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 26.13 MB
Memory Reserved: 46.00 MB
cuda
Epoch 1, Train Loss 0.646839, Valid_loss 0.583718
Epoch 2, Train Loss 0.480423, Valid_loss 0.460519
Epoch 3, Train Loss 0.425786, Valid_loss 0.437934
Epoch 4, Train Loss 0.405136, Valid_loss 0.408484
Epoch 5, Train Loss 0.363173, Valid_loss 0.350615
Epoch 6, Train Loss 0.334623, Valid_loss 0.385935
Epoch 7, Train Loss 0.332725, Valid_loss 0.364417
Epoch 8, Train Loss 0.313190, Valid_loss 0.351594
Epoch 9, Train Loss 0.305123, Valid_loss 0.316958
Epoch 10, Train Loss 0.289663, Valid_loss 0.297779
Epoch 11, Train Loss 0.297521, Valid_loss 0.325760
Epoch 12, Train Loss 0.327026, Valid_loss 0.326731
Epoch 13, Train Loss 0.272099, Valid_loss 0.385442
Epoch 14, Train Loss 0.277232, Valid_loss 0.369921
Epoch 15, Train Loss 0.291268, Valid_loss 0.359289
Epoch 16, Train Loss 0.266329, Valid_loss 0.329842
Epoch 17, Train Loss 0.242813, Valid_loss 0.365684
Epoch 18, Train Loss 0.242484, Valid_loss 0.350585
Epoch 19, Train Loss 0.236124, Valid_loss 0.308307
Epoch 20, Train Loss 0.220041, Valid_loss 0.337783
Epoch 21, Train Loss 0.224521, Valid_loss 0.324897
Epoch 22, Train Loss 0.218464, Valid_loss 0.327877
Epoch 23, Train Loss 0.229174, Valid_loss 0.348292
Epoch 24, Train Loss 0.210007, Valid_loss 0.397528
Epoch 25, Train Loss 0.230087, Valid_loss 0.392634
Epoch 26, Train Loss 0.223860, Valid_loss 0.346888
Epoch 27, Train Loss 0.217709, Valid_loss 0.416689
Epoch 28, Train Loss 0.218186, Valid_loss 0.349312
Epoch 29, Train Loss 0.224763, Valid_loss 0.416422
Epoch 30, Train Loss 0.247253, Valid_loss 0.413010
Epoch 31, Train Loss 0.236368, Valid_loss 0.326991
Epoch 32, Train Loss 0.207868, Valid_loss 0.361446
Epoch 33, Train Loss 0.216344, Valid_loss 0.352681
Epoch 34, Train Loss 0.209184, Valid_loss 0.401391
Epoch 35, Train Loss 0.213887, Valid_loss 0.366277
Epoch 36, Train Loss 0.194919, Valid_loss 0.431695
Epoch 37, Train Loss 0.194667, Valid_loss 0.396996
Epoch 38, Train Loss 0.200117, Valid_loss 0.441931
Epoch 39, Train Loss 0.212880, Valid_loss 0.438099
Epoch 40, Train Loss 0.200739, Valid_loss 0.367974
Epoch 41, Train Loss 0.198393, Valid_loss 0.396832
Epoch 42, Train Loss 0.195535, Valid_loss 0.388103
Epoch 43, Train Loss 0.202202, Valid_loss 0.431622
Epoch 44, Train Loss 0.200414, Valid_loss 0.458639
Epoch 45, Train Loss 0.207671, Valid_loss 0.488265
Epoch 46, Train Loss 0.200571, Valid_loss 0.448159
Epoch 47, Train Loss 0.198749, Valid_loss 0.512564
Epoch 48, Train Loss 0.197608, Valid_loss 0.438749
Epoch 49, Train Loss 0.199321, Valid_loss 0.492175
Epoch 50, Train Loss 0.197975, Valid_loss 0.403667
Epoch 51, Train Loss 0.188811, Valid_loss 0.499130
Epoch 52, Train Loss 0.192497, Valid_loss 0.422520
Epoch 53, Train Loss 0.187479, Valid_loss 0.451906
Epoch 54, Train Loss 0.190612, Valid_loss 0.489230
[I 2025-08-30 09:28:39,145] Trial 1 finished with value: 0.29777911997267176 and parameters: {'learning_rate': 0.001, 'epochs': 100, 'heads': 4, 'dropout': 0.5, 'weight_decay': 0.001, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.2724354504275003.
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 27.97 MB
Memory Reserved: 46.00 MB
cuda
Epoch 1, Train Loss 0.662291, Valid_loss 0.573277
Epoch 2, Train Loss 0.576529, Valid_loss 0.526462
Epoch 3, Train Loss 0.519414, Valid_loss 0.470566
Epoch 4, Train Loss 0.434027, Valid_loss 0.403633
Epoch 5, Train Loss 0.369278, Valid_loss 0.381069
Epoch 6, Train Loss 0.352942, Valid_loss 0.360630
Epoch 7, Train Loss 0.326141, Valid_loss 0.349960
Epoch 8, Train Loss 0.314064, Valid_loss 0.336402
Epoch 9, Train Loss 0.318038, Valid_loss 0.335436
Epoch 10, Train Loss 0.290937, Valid_loss 0.340156
Epoch 11, Train Loss 0.295412, Valid_loss 0.319572
Epoch 12, Train Loss 0.290501, Valid_loss 0.312346
Epoch 13, Train Loss 0.282636, Valid_loss 0.301945
Epoch 14, Train Loss 0.272877, Valid_loss 0.299659
Epoch 15, Train Loss 0.287374, Valid_loss 0.303887
Epoch 16, Train Loss 0.262807, Valid_loss 0.312339
Epoch 17, Train Loss 0.267641, Valid_loss 0.333243
Epoch 18, Train Loss 0.258277, Valid_loss 0.305411
Epoch 19, Train Loss 0.266318, Valid_loss 0.293667
Epoch 20, Train Loss 0.257150, Valid_loss 0.301266
Epoch 21, Train Loss 0.262239, Valid_loss 0.327128
Epoch 22, Train Loss 0.259392, Valid_loss 0.314700
Epoch 23, Train Loss 0.258171, Valid_loss 0.306230
Epoch 24, Train Loss 0.252781, Valid_loss 0.289359
Epoch 25, Train Loss 0.250099, Valid_loss 0.304498
Epoch 26, Train Loss 0.260518, Valid_loss 0.352296
Epoch 27, Train Loss 0.259317, Valid_loss 0.342655
Epoch 28, Train Loss 0.242683, Valid_loss 0.348113
Epoch 29, Train Loss 0.245648, Valid_loss 0.312720
Epoch 30, Train Loss 0.238285, Valid_loss 0.314778
Epoch 31, Train Loss 0.245060, Valid_loss 0.317677
Epoch 32, Train Loss 0.237131, Valid_loss 0.315859
Epoch 33, Train Loss 0.246862, Valid_loss 0.335551
Epoch 34, Train Loss 0.244196, Valid_loss 0.317491
Epoch 35, Train Loss 0.230986, Valid_loss 0.308181
Epoch 36, Train Loss 0.231008, Valid_loss 0.336202
Epoch 37, Train Loss 0.234555, Valid_loss 0.334274
Epoch 38, Train Loss 0.233780, Valid_loss 0.344213
Epoch 39, Train Loss 0.230981, Valid_loss 0.333132
Epoch 40, Train Loss 0.227605, Valid_loss 0.342890
Epoch 41, Train Loss 0.234994, Valid_loss 0.355332
Epoch 42, Train Loss 0.248743, Valid_loss 0.324334
Epoch 43, Train Loss 0.226368, Valid_loss 0.308496
Epoch 44, Train Loss 0.227375, Valid_loss 0.308325
Epoch 45, Train Loss 0.227914, Valid_loss 0.319389
Epoch 46, Train Loss 0.230499, Valid_loss 0.330739
Epoch 47, Train Loss 0.223550, Valid_loss 0.344933
Epoch 48, Train Loss 0.220671, Valid_loss 0.357290
Epoch 49, Train Loss 0.222526, Valid_loss 0.336948
Epoch 50, Train Loss 0.221343, Valid_loss 0.334302
Epoch 51, Train Loss 0.213142, Valid_loss 0.336117
Epoch 52, Train Loss 0.219638, Valid_loss 0.338831
[I 2025-08-30 09:31:59,312] Trial 2 finished with value: 0.28935864354882923 and parameters: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 1, 'dropout': 0.3, 'weight_decay': 0.001, 'emb_dim': 64, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.2724354504275003.
선택된 trial params: {'learning_rate': 0.01, 'epochs': 100, 'heads': 4, 'dropout': 0.3, 'weight_decay': 0.001, 'emb_dim': 32, 'augment_num': 100, 'pca': False}
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=10, batch_size=1 -> steps=10
output_class :  1
Memory Allocated: 26.13 MB
Memory Reserved: 46.00 MB
cuda
Epoch 1, Train Loss 0.516512, Valid_loss 0.354435
Epoch 2, Train Loss 0.412349, Valid_loss 0.398037
Epoch 3, Train Loss 0.329630, Valid_loss 0.328411
Epoch 4, Train Loss 0.317909, Valid_loss 0.420499
Epoch 5, Train Loss 0.288111, Valid_loss 0.455768
Epoch 6, Train Loss 0.268804, Valid_loss 0.409818
Epoch 7, Train Loss 0.244585, Valid_loss 0.426364
Epoch 8, Train Loss 0.230408, Valid_loss 0.358700
Epoch 9, Train Loss 0.245538, Valid_loss 0.446120
Epoch 10, Train Loss 0.226934, Valid_loss 0.362225
Epoch 11, Train Loss 0.229081, Valid_loss 0.397462
Epoch 12, Train Loss 0.222728, Valid_loss 0.449966
Epoch 13, Train Loss 0.236602, Valid_loss 0.422981
Epoch 14, Train Loss 0.207217, Valid_loss 0.400962
Epoch 15, Train Loss 0.223788, Valid_loss 0.461596
Epoch 16, Train Loss 0.240410, Valid_loss 0.315154
Epoch 17, Train Loss 0.220462, Valid_loss 0.388194
Epoch 18, Train Loss 0.233154, Valid_loss 0.535685
Epoch 19, Train Loss 0.207587, Valid_loss 0.592987
Epoch 20, Train Loss 0.232149, Valid_loss 0.494496
Epoch 21, Train Loss 0.199875, Valid_loss 0.452088
Epoch 22, Train Loss 0.222233, Valid_loss 0.558512
Epoch 23, Train Loss 0.213637, Valid_loss 0.479482
Epoch 24, Train Loss 0.220323, Valid_loss 0.415018
Epoch 25, Train Loss 0.214260, Valid_loss 0.336028
Epoch 26, Train Loss 0.217951, Valid_loss 0.472525
Epoch 27, Train Loss 0.212405, Valid_loss 0.413009
Epoch 28, Train Loss 0.210985, Valid_loss 0.326606
Epoch 29, Train Loss 0.208706, Valid_loss 0.369029
Epoch 30, Train Loss 0.199477, Valid_loss 0.428319
Epoch 31, Train Loss 0.202054, Valid_loss 0.349455
Epoch 32, Train Loss 0.200522, Valid_loss 0.340114
Epoch 33, Train Loss 0.205721, Valid_loss 0.377467
Epoch 34, Train Loss 0.187467, Valid_loss 0.382282
Epoch 35, Train Loss 0.205482, Valid_loss 0.450587
Epoch 36, Train Loss 0.239973, Valid_loss 0.456997
Epoch 37, Train Loss 0.217613, Valid_loss 0.388736
Epoch 38, Train Loss 0.224145, Valid_loss 0.428739
Epoch 39, Train Loss 0.208051, Valid_loss 0.414592
Epoch 40, Train Loss 0.212396, Valid_loss 0.363749
Epoch 41, Train Loss 0.194338, Valid_loss 0.575958
Epoch 42, Train Loss 0.192345, Valid_loss 0.367326
Epoch 43, Train Loss 0.192861, Valid_loss 0.419237
Epoch 44, Train Loss 0.186849, Valid_loss 0.450305
Epoch 45, Train Loss 0.194148, Valid_loss 0.329153
Epoch 46, Train Loss 0.186371, Valid_loss 0.344973
Epoch 47, Train Loss 0.197768, Valid_loss 0.273418
Epoch 48, Train Loss 0.190890, Valid_loss 0.278297
Epoch 49, Train Loss 0.181832, Valid_loss 0.381136
Epoch 50, Train Loss 0.187363, Valid_loss 0.366830
Epoch 51, Train Loss 0.189246, Valid_loss 0.376797
Epoch 52, Train Loss 0.186273, Valid_loss 0.328579
Epoch 53, Train Loss 0.180588, Valid_loss 0.343992
Epoch 54, Train Loss 0.185919, Valid_loss 0.328680
Epoch 55, Train Loss 0.177888, Valid_loss 0.322707
Epoch 56, Train Loss 0.178470, Valid_loss 0.363563
Epoch 57, Train Loss 0.187036, Valid_loss 0.432921
환자ID=COVID19_Participant10 -- true: 1 -- pred: 0
환자ID=COVID19_Participant13 -- true: 1 -- pred: 1
환자ID=COVID19_Participant14 -- true: 1 -- pred: 1
환자ID=COVID19_Participant21 -- true: 1 -- pred: 1
환자ID=COVID19_Participant29 -- true: 1 -- pred: 1
환자ID=COVID19_Participant36 -- true: 1 -- pred: 1
환자ID=COVID19_Participant38 -- true: 1 -- pred: 1
환자ID=Control_Participant11 -- true: 0 -- pred: 1
환자ID=Control_Participant7 -- true: 0 -- pred: 0
환자ID=Control_Participant8 -- true: 0 -- pred: 1
Best performance: Epoch 47, Loss 0.197768, Test ACC 0.700000, Test AUC 0.809524, Test Recall 0.857143, Test Precision 0.750000
Confusion Matrix:
 [1 2 1 6]
✅ Total valid splits used: 5

📌 Repeat 3: 평균 AUC = 0.9333, 표준편차 = 0.0830
Test ACC 평균 0.860000, Test Recall 평균 0.914286, Test Precision 평균 0.896429
fold_aucs = [0.8571428571428571, 1.0, 1.0, 1.0, 0.8095238095238095]
NaN 개수: 0 / 전체 5개

🔁 Repeat 4, Fold 0
cell type :  GTCGGGGGGTGG_Control_Participant7     Developing Ciliated Cells
CAAATCAATTAT_Control_Participant7     Developing Ciliated Cells
ATACAATTGACA_Control_Participant7     Developing Ciliated Cells
CTGTTAATGAGA_Control_Participant7     Developing Ciliated Cells
CTTCACATTATT_Control_Participant7     Developing Ciliated Cells
                                                ...            
ACCATATTCAGG_COVID19_Participant21    Developing Ciliated Cells
GCCCGTTTCACG_COVID19_Participant21              Secretory Cells
TATTATCTCTTA_COVID19_Participant21    Developing Ciliated Cells
TTCCGTTTGTCC_COVID19_Participant21                 Goblet Cells
TCGGGATTGGAT_COVID19_Participant21               Ciliated Cells
Name: manual_annotation, Length: 20178, dtype: string
cell type annotation :  GTCGGGGGGTGG_Control_Participant7     Developing Ciliated Cells
CAAATCAATTAT_Control_Participant7     Developing Ciliated Cells
ATACAATTGACA_Control_Participant7     Developing Ciliated Cells
CTGTTAATGAGA_Control_Participant7     Developing Ciliated Cells
CTTCACATTATT_Control_Participant7     Developing Ciliated Cells
                                                ...            
ACCATATTCAGG_COVID19_Participant21    Developing Ciliated Cells
GCCCGTTTCACG_COVID19_Participant21              Secretory Cells
TATTATCTCTTA_COVID19_Participant21    Developing Ciliated Cells
TTCCGTTTGTCC_COVID19_Participant21                 Goblet Cells
TCGGGATTGGAT_COVID19_Participant21               Ciliated Cells
Name: manual_annotation, Length: 20178, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Developing Ciliated Cells', 'Ciliated Cells', 'Secretory Cells', 'Squamous Cells', 'Goblet Cells', 'T Cells', 'Dendritic Cells', 'Basal Cells', 'Deuterosomal Cells', 'Mitotic Basal Cells', 'Macrophages', 'B Cells', 'Ionocytes', 'Developing Secretory and Goblet Cells', 'Enteroendocrine Cells', 'Erythroblasts', 'Mast Cells', 'Plasmacytoid DCs']
라벨별 그룹 개수 {1: 28, 0: 12}
cell type :  TTGCGGTGACCA_COVID19_Participant31    Ciliated Cells
AGGCTCGAACTG_COVID19_Participant31    Ciliated Cells
TATCCGTATGTT_COVID19_Participant31      Goblet Cells
CAGACAGCGGCT_COVID19_Participant31       Basal Cells
CAAAGAGAACTA_COVID19_Participant31    Ciliated Cells
                                           ...      
GCAGGGAACTCC_COVID19_Participant30    Squamous Cells
CAGCACCGAGCC_COVID19_Participant30    Squamous Cells
GCCCCTTGTGAT_COVID19_Participant30    Squamous Cells
GTGTTGTGTGTC_COVID19_Participant30    Squamous Cells
TAACACTCACTT_COVID19_Participant30    Squamous Cells
Name: manual_annotation, Length: 6769, dtype: string
cell type annotation :  TTGCGGTGACCA_COVID19_Participant31    Ciliated Cells
AGGCTCGAACTG_COVID19_Participant31    Ciliated Cells
TATCCGTATGTT_COVID19_Participant31      Goblet Cells
CAGACAGCGGCT_COVID19_Participant31       Basal Cells
CAAAGAGAACTA_COVID19_Participant31    Ciliated Cells
                                           ...      
GCAGGGAACTCC_COVID19_Participant30    Squamous Cells
CAGCACCGAGCC_COVID19_Participant30    Squamous Cells
GCCCCTTGTGAT_COVID19_Participant30    Squamous Cells
GTGTTGTGTGTC_COVID19_Participant30    Squamous Cells
TAACACTCACTT_COVID19_Participant30    Squamous Cells
Name: manual_annotation, Length: 6769, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Ciliated Cells', 'Goblet Cells', 'Basal Cells', 'Developing Secretory and Goblet Cells', 'Macrophages', 'T Cells', 'Deuterosomal Cells', 'Mitotic Basal Cells', 'Developing Ciliated Cells', 'Secretory Cells', 'Squamous Cells', 'Plasmacytoid DCs', 'Ionocytes', 'Enteroendocrine Cells', 'Erythroblasts', 'Dendritic Cells', 'B Cells']
라벨별 그룹 개수 {1: 7, 0: 3}
🔍 Split #1
  → train_p_index 환자 수 (환자 단위로 묶인 index list): 40
  → test_p_index 환자 수  (환자 단위로 묶인 index list): 10
  → train 환자 ID: ['COVID19_Participant10', 'COVID19_Participant11', 'COVID19_Participant12', 'COVID19_Participant13', 'COVID19_Participant14', 'COVID19_Participant15', 'COVID19_Participant17', 'COVID19_Participant18', 'COVID19_Participant19', 'COVID19_Participant2', 'COVID19_Participant21', 'COVID19_Participant22', 'COVID19_Participant23', 'COVID19_Participant25', 'COVID19_Participant26', 'COVID19_Participant27', 'COVID19_Participant28', 'COVID19_Participant3', 'COVID19_Participant35', 'COVID19_Participant36', 'COVID19_Participant37', 'COVID19_Participant39', 'COVID19_Participant4', 'COVID19_Participant40', 'COVID19_Participant6', 'COVID19_Participant7', 'COVID19_Participant8', 'COVID19_Participant9', 'Control_Participant1', 'Control_Participant11', 'Control_Participant14', 'Control_Participant15', 'Control_Participant2', 'Control_Participant3', 'Control_Participant4', 'Control_Participant5', 'Control_Participant6', 'Control_Participant7', 'Control_Participant8', 'Control_Participant9']
  → test  환자 ID: ['COVID19_Participant20', 'COVID19_Participant29', 'COVID19_Participant30', 'COVID19_Participant31', 'COVID19_Participant32', 'COVID19_Participant38', 'COVID19_Participant5', 'Control_Participant10', 'Control_Participant12', 'Control_Participant13']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant10, Label: 1
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant12, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant18, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant21, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant27, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant3, Label: 1
    ID: COVID19_Participant35, Label: 1
    ID: COVID19_Participant36, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: COVID19_Participant6, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: COVID19_Participant9, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant14, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant2, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant4, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant6, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant8, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant30, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant38, Label: 1
    ID: COVID19_Participant5, Label: 1
    ID: Control_Participant10, Label: 0
    ID: Control_Participant12, Label: 0
    ID: Control_Participant13, Label: 0
전체 데이터 index 길이 50
label_stat (train 환자 라벨 목록) 갯수 40
train_data에서 환자 단위로, train과 validation 나누기
기존 train_p_index 40
기존 (train) label_stat 40
train-vali 분할 후! 
train y 의 classes : {0, 1} valid y 의 classes : {0, 1} label_stat 의 classes : {0, 1}
train_p_index_ 26
valid_p_index 14
test_p_index 10
→ train 환자 ID 및 라벨:
   총 개수: 26
   환자ID=Control_Participant11, Label=0, 셀개수=1164
   환자ID=Control_Participant3, Label=0, 셀개수=1620
   환자ID=COVID19_Participant17, Label=1, 셀개수=843
   환자ID=COVID19_Participant39, Label=1, 셀개수=454
   환자ID=COVID19_Participant10, Label=1, 셀개수=18
   환자ID=Control_Participant6, Label=0, 셀개수=131
   환자ID=COVID19_Participant13, Label=1, 셀개수=730
   환자ID=COVID19_Participant18, Label=1, 셀개수=227
   환자ID=COVID19_Participant40, Label=1, 셀개수=381
   환자ID=COVID19_Participant12, Label=1, 셀개수=102
   환자ID=COVID19_Participant19, Label=1, 셀개수=816
   환자ID=Control_Participant4, Label=0, 셀개수=440
   환자ID=COVID19_Participant25, Label=1, 셀개수=496
   환자ID=Control_Participant8, Label=0, 셀개수=393
   환자ID=Control_Participant7, Label=0, 셀개수=762
   환자ID=COVID19_Participant14, Label=1, 셀개수=382
   환자ID=Control_Participant9, Label=0, 셀개수=558
   환자ID=Control_Participant14, Label=0, 셀개수=274
   환자ID=COVID19_Participant21, Label=1, 셀개수=39
   환자ID=COVID19_Participant28, Label=1, 셀개수=1079
   환자ID=COVID19_Participant23, Label=1, 셀개수=307
   환자ID=COVID19_Participant15, Label=1, 셀개수=1003
   환자ID=COVID19_Participant7, Label=1, 셀개수=409
   환자ID=COVID19_Participant4, Label=1, 셀개수=1680
   환자ID=COVID19_Participant37, Label=1, 셀개수=668
   환자ID=COVID19_Participant27, Label=1, 셀개수=93
→ valid 환자 ID 및 라벨:
   총 개수: 14
   환자ID=Control_Participant2, Label=0, 셀개수=41
   환자ID=COVID19_Participant26, Label=1, 셀개수=814
   환자ID=COVID19_Participant35, Label=1, 셀개수=83
   환자ID=COVID19_Participant3, Label=1, 셀개수=104
   환자ID=COVID19_Participant6, Label=1, 셀개수=84
   환자ID=COVID19_Participant2, Label=1, 셀개수=329
   환자ID=Control_Participant5, Label=0, 셀개수=717
   환자ID=Control_Participant1, Label=0, 셀개수=414
   환자ID=COVID19_Participant9, Label=1, 셀개수=86
   환자ID=COVID19_Participant8, Label=1, 셀개수=462
   환자ID=Control_Participant15, Label=0, 셀개수=528
   환자ID=COVID19_Participant36, Label=1, 셀개수=200
   환자ID=COVID19_Participant11, Label=1, 셀개수=382
   환자ID=COVID19_Participant22, Label=1, 셀개수=865
→ test 환자 ID 및 라벨:
   총 개수: 10
   환자ID=COVID19_Participant20, Label=1, 셀개수=2033
   환자ID=COVID19_Participant29, Label=1, 셀개수=573
   환자ID=COVID19_Participant30, Label=1, 셀개수=116
   환자ID=COVID19_Participant31, Label=1, 셀개수=410
   환자ID=COVID19_Participant32, Label=1, 셀개수=1665
   환자ID=COVID19_Participant38, Label=1, 셀개수=51
   환자ID=COVID19_Participant5, Label=1, 셀개수=89
   환자ID=Control_Participant10, Label=0, 셀개수=1645
   환자ID=Control_Participant12, Label=0, 셀개수=99
   환자ID=Control_Participant13, Label=0, 셀개수=88
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Ciliated Cells', 'Developing Ciliated Cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
전체 데이터 길이 26947
전체 cell type 길이 0        Developing Ciliated Cells
1        Developing Ciliated Cells
2        Developing Ciliated Cells
3        Developing Ciliated Cells
4        Developing Ciliated Cells
                   ...            
26942               Squamous Cells
26943               Squamous Cells
26944               Squamous Cells
26945               Squamous Cells
26946               Squamous Cells
Length: 26947, dtype: string
cell type의 NaN 개수 체크 0
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:11,  8.85it/s]  2%|▏         | 2/100 [00:00<00:16,  5.87it/s]  3%|▎         | 3/100 [00:00<00:13,  7.15it/s]  4%|▍         | 4/100 [00:00<00:12,  7.76it/s]  5%|▌         | 5/100 [00:00<00:11,  8.31it/s]  6%|▌         | 6/100 [00:00<00:15,  6.07it/s]  7%|▋         | 7/100 [00:01<00:14,  6.61it/s]  8%|▊         | 8/100 [00:01<00:13,  6.77it/s]  9%|▉         | 9/100 [00:01<00:14,  6.16it/s] 10%|█         | 10/100 [00:01<00:13,  6.91it/s] 12%|█▏        | 12/100 [00:01<00:11,  7.83it/s] 13%|█▎        | 13/100 [00:01<00:12,  6.93it/s] 14%|█▍        | 14/100 [00:01<00:11,  7.50it/s] 15%|█▌        | 15/100 [00:02<00:10,  8.01it/s] 16%|█▌        | 16/100 [00:02<00:10,  8.21it/s] 17%|█▋        | 17/100 [00:02<00:10,  8.23it/s] 18%|█▊        | 18/100 [00:02<00:09,  8.21it/s] 19%|█▉        | 19/100 [00:02<00:09,  8.62it/s] 21%|██        | 21/100 [00:02<00:08,  9.50it/s] 23%|██▎       | 23/100 [00:02<00:07, 10.08it/s] 24%|██▍       | 24/100 [00:03<00:07,  9.84it/s] 26%|██▌       | 26/100 [00:03<00:07,  9.75it/s] 27%|██▋       | 27/100 [00:03<00:07,  9.79it/s] 28%|██▊       | 28/100 [00:03<00:07,  9.78it/s] 29%|██▉       | 29/100 [00:03<00:08,  8.03it/s] 31%|███       | 31/100 [00:03<00:07,  8.83it/s] 32%|███▏      | 32/100 [00:03<00:07,  9.06it/s] 34%|███▍      | 34/100 [00:04<00:06,  9.50it/s] 35%|███▌      | 35/100 [00:04<00:07,  9.22it/s] 37%|███▋      | 37/100 [00:04<00:06,  9.13it/s] 38%|███▊      | 38/100 [00:04<00:06,  9.06it/s] 39%|███▉      | 39/100 [00:04<00:07,  8.07it/s] 41%|████      | 41/100 [00:05<00:07,  7.47it/s] 43%|████▎     | 43/100 [00:05<00:09,  5.91it/s] 44%|████▍     | 44/100 [00:05<00:09,  6.15it/s] 45%|████▌     | 45/100 [00:05<00:08,  6.18it/s] 46%|████▌     | 46/100 [00:05<00:09,  5.88it/s] 47%|████▋     | 47/100 [00:06<00:08,  6.22it/s] 48%|████▊     | 48/100 [00:06<00:07,  6.92it/s] 49%|████▉     | 49/100 [00:06<00:07,  6.81it/s] 50%|█████     | 50/100 [00:06<00:06,  7.26it/s] 52%|█████▏    | 52/100 [00:06<00:05,  8.45it/s] 53%|█████▎    | 53/100 [00:06<00:06,  7.67it/s] 54%|█████▍    | 54/100 [00:06<00:05,  7.70it/s] 55%|█████▌    | 55/100 [00:07<00:05,  8.14it/s] 56%|█████▌    | 56/100 [00:07<00:05,  8.45it/s] 57%|█████▋    | 57/100 [00:07<00:05,  8.04it/s] 59%|█████▉    | 59/100 [00:07<00:04,  8.78it/s] 60%|██████    | 60/100 [00:07<00:04,  8.88it/s] 61%|██████    | 61/100 [00:07<00:04,  8.98it/s] 63%|██████▎   | 63/100 [00:08<00:05,  6.79it/s] 64%|██████▍   | 64/100 [00:08<00:04,  7.23it/s] 65%|██████▌   | 65/100 [00:08<00:04,  7.72it/s] 66%|██████▌   | 66/100 [00:08<00:04,  7.72it/s] 67%|██████▋   | 67/100 [00:08<00:04,  8.15it/s] 69%|██████▉   | 69/100 [00:08<00:03,  8.64it/s] 70%|███████   | 70/100 [00:08<00:03,  8.45it/s] 71%|███████   | 71/100 [00:09<00:04,  6.73it/s] 72%|███████▏  | 72/100 [00:09<00:03,  7.34it/s] 73%|███████▎  | 73/100 [00:09<00:03,  7.43it/s] 74%|███████▍  | 74/100 [00:09<00:03,  7.34it/s] 75%|███████▌  | 75/100 [00:09<00:03,  7.90it/s] 76%|███████▌  | 76/100 [00:09<00:02,  8.37it/s] 77%|███████▋  | 77/100 [00:09<00:02,  8.10it/s] 79%|███████▉  | 79/100 [00:10<00:02,  8.09it/s] 80%|████████  | 80/100 [00:10<00:02,  8.39it/s] 81%|████████  | 81/100 [00:10<00:02,  8.48it/s] 82%|████████▏ | 82/100 [00:10<00:02,  8.82it/s] 83%|████████▎ | 83/100 [00:10<00:01,  9.12it/s] 84%|████████▍ | 84/100 [00:10<00:01,  9.00it/s] 85%|████████▌ | 85/100 [00:10<00:01,  9.05it/s] 86%|████████▌ | 86/100 [00:10<00:01,  9.17it/s] 87%|████████▋ | 87/100 [00:10<00:01,  9.12it/s] 88%|████████▊ | 88/100 [00:11<00:01,  9.30it/s] 89%|████████▉ | 89/100 [00:11<00:01,  9.12it/s] 90%|█████████ | 90/100 [00:11<00:01,  9.15it/s] 91%|█████████ | 91/100 [00:11<00:01,  7.85it/s] 92%|█████████▏| 92/100 [00:11<00:01,  6.77it/s] 93%|█████████▎| 93/100 [00:11<00:00,  7.22it/s] 95%|█████████▌| 95/100 [00:11<00:00,  8.14it/s] 96%|█████████▌| 96/100 [00:12<00:00,  8.40it/s] 97%|█████████▋| 97/100 [00:12<00:00,  8.65it/s] 98%|█████████▊| 98/100 [00:12<00:00,  8.79it/s] 99%|█████████▉| 99/100 [00:12<00:00,  9.02it/s]100%|██████████| 100/100 [00:12<00:00,  8.81it/s]100%|██████████| 100/100 [00:12<00:00,  7.98it/s]
[I 2025-08-30 09:36:44,454] A new study created in memory with name: no-name-b29f24de-f37c-467a-baa7-d8e9162cd1b7
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 26.13 MB
Memory Reserved: 46.00 MB
cuda
Epoch 1, Train Loss 0.683907, Valid_loss 0.595663
Epoch 2, Train Loss 0.565937, Valid_loss 0.574014
Epoch 3, Train Loss 0.540716, Valid_loss 0.551280
Epoch 4, Train Loss 0.520316, Valid_loss 0.510179
Epoch 5, Train Loss 0.482401, Valid_loss 0.462815
Epoch 6, Train Loss 0.450971, Valid_loss 0.426606
Epoch 7, Train Loss 0.422417, Valid_loss 0.413251
Epoch 8, Train Loss 0.396075, Valid_loss 0.398716
Epoch 9, Train Loss 0.377571, Valid_loss 0.364524
Epoch 10, Train Loss 0.364943, Valid_loss 0.397214
Epoch 11, Train Loss 0.353091, Valid_loss 0.384380
Epoch 12, Train Loss 0.344656, Valid_loss 0.363178
Epoch 13, Train Loss 0.334330, Valid_loss 0.372114
Epoch 14, Train Loss 0.327442, Valid_loss 0.361935
Epoch 15, Train Loss 0.323238, Valid_loss 0.364749
Epoch 16, Train Loss 0.316739, Valid_loss 0.369588
Epoch 17, Train Loss 0.315453, Valid_loss 0.377603
Epoch 18, Train Loss 0.310817, Valid_loss 0.361954
Epoch 19, Train Loss 0.307561, Valid_loss 0.372605
Epoch 20, Train Loss 0.304080, Valid_loss 0.348229
Epoch 21, Train Loss 0.300906, Valid_loss 0.341334
Epoch 22, Train Loss 0.295987, Valid_loss 0.359273
Epoch 23, Train Loss 0.294378, Valid_loss 0.351979
Epoch 24, Train Loss 0.290109, Valid_loss 0.339022
Epoch 25, Train Loss 0.292537, Valid_loss 0.378716
Epoch 26, Train Loss 0.286489, Valid_loss 0.358691
Epoch 27, Train Loss 0.285216, Valid_loss 0.362057
Epoch 28, Train Loss 0.281109, Valid_loss 0.357382
Epoch 29, Train Loss 0.278396, Valid_loss 0.342979
Epoch 30, Train Loss 0.278004, Valid_loss 0.356994
Epoch 31, Train Loss 0.272664, Valid_loss 0.350101
Epoch 32, Train Loss 0.271633, Valid_loss 0.335595
Epoch 33, Train Loss 0.268260, Valid_loss 0.342152
Epoch 34, Train Loss 0.267701, Valid_loss 0.334675
Epoch 35, Train Loss 0.265801, Valid_loss 0.332502
Epoch 36, Train Loss 0.263292, Valid_loss 0.329209
Epoch 37, Train Loss 0.260700, Valid_loss 0.321930
Epoch 38, Train Loss 0.261532, Valid_loss 0.319996
Epoch 39, Train Loss 0.260206, Valid_loss 0.324752
Epoch 40, Train Loss 0.257731, Valid_loss 0.347499
Epoch 41, Train Loss 0.256479, Valid_loss 0.336088
Epoch 42, Train Loss 0.253851, Valid_loss 0.347233
Epoch 43, Train Loss 0.249356, Valid_loss 0.341072
Epoch 44, Train Loss 0.250156, Valid_loss 0.333878
Epoch 45, Train Loss 0.248905, Valid_loss 0.330964
Epoch 46, Train Loss 0.247608, Valid_loss 0.356878
Epoch 47, Train Loss 0.244663, Valid_loss 0.353265
Epoch 48, Train Loss 0.244485, Valid_loss 0.339566
Epoch 49, Train Loss 0.243054, Valid_loss 0.330072
Epoch 50, Train Loss 0.240366, Valid_loss 0.313805
Epoch 51, Train Loss 0.237871, Valid_loss 0.328041
Epoch 52, Train Loss 0.238776, Valid_loss 0.345488
[I 2025-08-30 09:40:15,467] Trial 0 finished with value: 0.31380472012928556 and parameters: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 2, 'dropout': 0.0, 'weight_decay': 0.01, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.31380472012928556.
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 46.00 MB
cuda
Epoch 1, Train Loss 0.664657, Valid_loss 0.602252
Epoch 2, Train Loss 0.629086, Valid_loss 0.600319
Epoch 3, Train Loss 0.573806, Valid_loss 0.599875
Epoch 4, Train Loss 0.602970, Valid_loss 0.598976
Epoch 5, Train Loss 0.586033, Valid_loss 0.598472
Epoch 6, Train Loss 0.572063, Valid_loss 0.598581
Epoch 7, Train Loss 0.587542, Valid_loss 0.598058
Epoch 8, Train Loss 0.574307, Valid_loss 0.597939
Epoch 9, Train Loss 0.572050, Valid_loss 0.598264
Epoch 10, Train Loss 0.576857, Valid_loss 0.597875
Epoch 11, Train Loss 0.567861, Valid_loss 0.598073
Epoch 12, Train Loss 0.562181, Valid_loss 0.599797
Epoch 13, Train Loss 0.544530, Valid_loss 0.603875
Epoch 14, Train Loss 0.558260, Valid_loss 0.601250
Epoch 15, Train Loss 0.569591, Valid_loss 0.598447
Epoch 16, Train Loss 0.572199, Valid_loss 0.594222
Epoch 17, Train Loss 0.572231, Valid_loss 0.588070
Epoch 18, Train Loss 0.548955, Valid_loss 0.571165
Epoch 19, Train Loss 0.509446, Valid_loss 0.567910
Epoch 20, Train Loss 0.516910, Valid_loss 0.480130
Epoch 21, Train Loss 0.463888, Valid_loss 0.578150
Epoch 22, Train Loss 0.430992, Valid_loss 0.506231
Epoch 23, Train Loss 0.391473, Valid_loss 0.471619
Epoch 24, Train Loss 0.447522, Valid_loss 0.603198
Epoch 25, Train Loss 0.600839, Valid_loss 0.679354
Epoch 26, Train Loss 0.628120, Valid_loss 0.577170
Epoch 27, Train Loss 0.537011, Valid_loss 0.534099
Epoch 28, Train Loss 0.506850, Valid_loss 0.453994
Epoch 29, Train Loss 0.508335, Valid_loss 0.538267
Epoch 30, Train Loss 0.469342, Valid_loss 0.414937
Epoch 31, Train Loss 0.472667, Valid_loss 0.556915
Epoch 32, Train Loss 0.474101, Valid_loss 0.525894
Epoch 33, Train Loss 0.459202, Valid_loss 0.375091
Epoch 34, Train Loss 0.381895, Valid_loss 0.407645
Epoch 35, Train Loss 0.447181, Valid_loss 0.418323
Epoch 36, Train Loss 0.456747, Valid_loss 0.428495
Epoch 37, Train Loss 0.424941, Valid_loss 0.549662
Epoch 38, Train Loss 0.426420, Valid_loss 0.444255
Epoch 39, Train Loss 0.387524, Valid_loss 0.387038
Epoch 40, Train Loss 0.339049, Valid_loss 0.346603
Epoch 41, Train Loss 0.361869, Valid_loss 0.353973
Epoch 42, Train Loss 0.362201, Valid_loss 0.349225
Epoch 43, Train Loss 0.416166, Valid_loss 0.364121
Epoch 44, Train Loss 0.356567, Valid_loss 0.365303
Epoch 45, Train Loss 0.387736, Valid_loss 0.361168
Epoch 46, Train Loss 0.332116, Valid_loss 0.362697
Epoch 47, Train Loss 0.347535, Valid_loss 0.335945
Epoch 48, Train Loss 0.306521, Valid_loss 0.385757
Epoch 49, Train Loss 0.329761, Valid_loss 0.352770
Epoch 50, Train Loss 0.363093, Valid_loss 0.365223
Epoch 51, Train Loss 0.382048, Valid_loss 0.387664
Epoch 52, Train Loss 0.338504, Valid_loss 0.357576
Epoch 53, Train Loss 0.418512, Valid_loss 0.356827
Epoch 54, Train Loss 0.330927, Valid_loss 0.360793
Epoch 55, Train Loss 0.319978, Valid_loss 0.353824
Epoch 56, Train Loss 0.365452, Valid_loss 0.352496
Epoch 57, Train Loss 0.314188, Valid_loss 0.352956
Epoch 58, Train Loss 0.336524, Valid_loss 0.365348
[I 2025-08-30 09:44:15,879] Trial 1 finished with value: 0.3359445801803044 and parameters: {'learning_rate': 0.01, 'epochs': 100, 'heads': 2, 'dropout': 0.7, 'weight_decay': 0.001, 'emb_dim': 8, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.31380472012928556.
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 46.00 MB
cuda
Epoch 1, Train Loss 0.626568, Valid_loss 0.603909
Epoch 2, Train Loss 0.599392, Valid_loss 0.604804
Epoch 3, Train Loss 0.574837, Valid_loss 0.604343
Epoch 4, Train Loss 0.555335, Valid_loss 0.602633
Epoch 5, Train Loss 0.567906, Valid_loss 0.598941
Epoch 6, Train Loss 0.570316, Valid_loss 0.553170
Epoch 7, Train Loss 0.475077, Valid_loss 0.566488
Epoch 8, Train Loss 0.459902, Valid_loss 0.353051
Epoch 9, Train Loss 0.365688, Valid_loss 0.329413
Epoch 10, Train Loss 0.320227, Valid_loss 0.227563
Epoch 11, Train Loss 0.300052, Valid_loss 0.352127
Epoch 12, Train Loss 0.282506, Valid_loss 0.322685
Epoch 13, Train Loss 0.260227, Valid_loss 0.236607
Epoch 14, Train Loss 0.275170, Valid_loss 0.263937
Epoch 15, Train Loss 0.247800, Valid_loss 0.260609
Epoch 16, Train Loss 0.270180, Valid_loss 0.282043
Epoch 17, Train Loss 0.234198, Valid_loss 0.269475
Epoch 18, Train Loss 0.227451, Valid_loss 0.287064
Epoch 19, Train Loss 0.235956, Valid_loss 0.253095
Epoch 20, Train Loss 0.224960, Valid_loss 0.189867
Epoch 21, Train Loss 0.223187, Valid_loss 0.224318
Epoch 22, Train Loss 0.233601, Valid_loss 0.335246
Epoch 23, Train Loss 0.242095, Valid_loss 0.226167
Epoch 24, Train Loss 0.233732, Valid_loss 0.247254
Epoch 25, Train Loss 0.224959, Valid_loss 0.180373
Epoch 26, Train Loss 0.237394, Valid_loss 0.244550
Epoch 27, Train Loss 0.230740, Valid_loss 0.250152
Epoch 28, Train Loss 0.236580, Valid_loss 0.280871
Epoch 29, Train Loss 0.207427, Valid_loss 0.269936
Epoch 30, Train Loss 0.227929, Valid_loss 0.246541
Epoch 31, Train Loss 0.230497, Valid_loss 0.262849
Epoch 32, Train Loss 0.231139, Valid_loss 0.231769
Epoch 33, Train Loss 0.223872, Valid_loss 0.253912
Epoch 34, Train Loss 0.198779, Valid_loss 0.232346
Epoch 35, Train Loss 0.201044, Valid_loss 0.252163
Epoch 36, Train Loss 0.208616, Valid_loss 0.235718
Epoch 37, Train Loss 0.209724, Valid_loss 0.213611
Epoch 38, Train Loss 0.211064, Valid_loss 0.309117
Epoch 39, Train Loss 0.204070, Valid_loss 0.272582
Epoch 40, Train Loss 0.212990, Valid_loss 0.268747
Epoch 41, Train Loss 0.214432, Valid_loss 0.208024
Epoch 42, Train Loss 0.219119, Valid_loss 0.213700
Epoch 43, Train Loss 0.211107, Valid_loss 0.275902
Epoch 44, Train Loss 0.217081, Valid_loss 0.243317
Epoch 45, Train Loss 0.206622, Valid_loss 0.234936
Epoch 46, Train Loss 0.200979, Valid_loss 0.245025
Epoch 47, Train Loss 0.198395, Valid_loss 0.247604
Epoch 48, Train Loss 0.186694, Valid_loss 0.232021
Epoch 49, Train Loss 0.198220, Valid_loss 0.231015
Epoch 50, Train Loss 0.185281, Valid_loss 0.253861
Epoch 51, Train Loss 0.189537, Valid_loss 0.249100
Epoch 52, Train Loss 0.210672, Valid_loss 0.250396
Epoch 53, Train Loss 0.178844, Valid_loss 0.241127
Epoch 54, Train Loss 0.181285, Valid_loss 0.258393
Epoch 55, Train Loss 0.217428, Valid_loss 0.243103
Epoch 56, Train Loss 0.197731, Valid_loss 0.278051
Epoch 57, Train Loss 0.200698, Valid_loss 0.251253
Epoch 58, Train Loss 0.179614, Valid_loss 0.253407
Epoch 59, Train Loss 0.184195, Valid_loss 0.244716
Epoch 60, Train Loss 0.182676, Valid_loss 0.264965
Epoch 61, Train Loss 0.189583, Valid_loss 0.244549
Epoch 62, Train Loss 0.178645, Valid_loss 0.253973
Epoch 63, Train Loss 0.192186, Valid_loss 0.232059
Epoch 64, Train Loss 0.200157, Valid_loss 0.255264
Epoch 65, Train Loss 0.173525, Valid_loss 0.245870
Epoch 66, Train Loss 0.182750, Valid_loss 0.238940
Epoch 67, Train Loss 0.177395, Valid_loss 0.247468
Epoch 68, Train Loss 0.175713, Valid_loss 0.231684
Epoch 69, Train Loss 0.188276, Valid_loss 0.269560
Epoch 70, Train Loss 0.176778, Valid_loss 0.263028
Epoch 71, Train Loss 0.182441, Valid_loss 0.249122
Epoch 72, Train Loss 0.178997, Valid_loss 0.252938
Epoch 73, Train Loss 0.199786, Valid_loss 0.274764
[I 2025-08-30 09:50:05,468] Trial 2 finished with value: 0.18037344674978936 and parameters: {'learning_rate': 0.01, 'epochs': 100, 'heads': 4, 'dropout': 0.3, 'weight_decay': 0.0001, 'emb_dim': 8, 'augment_num': 100, 'pca': False}. Best is trial 2 with value: 0.18037344674978936.
선택된 trial params: {'learning_rate': 0.01, 'epochs': 100, 'heads': 4, 'dropout': 0.3, 'weight_decay': 0.0001, 'emb_dim': 8, 'augment_num': 100, 'pca': False}
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=10, batch_size=1 -> steps=10
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 46.00 MB
cuda
Epoch 1, Train Loss 0.605893, Valid_loss 0.598324
Epoch 2, Train Loss 0.561548, Valid_loss 0.602223
Epoch 3, Train Loss 0.578267, Valid_loss 0.598723
Epoch 4, Train Loss 0.569662, Valid_loss 0.597365
Epoch 5, Train Loss 0.558731, Valid_loss 0.585310
Epoch 6, Train Loss 0.515063, Valid_loss 0.490741
Epoch 7, Train Loss 0.398142, Valid_loss 0.379823
Epoch 8, Train Loss 0.360879, Valid_loss 0.296821
Epoch 9, Train Loss 0.335171, Valid_loss 0.373908
Epoch 10, Train Loss 0.270599, Valid_loss 0.349605
Epoch 11, Train Loss 0.282733, Valid_loss 0.320468
Epoch 12, Train Loss 0.264201, Valid_loss 0.465889
Epoch 13, Train Loss 0.299747, Valid_loss 0.440637
Epoch 14, Train Loss 0.250678, Valid_loss 0.397548
Epoch 15, Train Loss 0.237793, Valid_loss 0.440958
Epoch 16, Train Loss 0.231704, Valid_loss 0.388760
Epoch 17, Train Loss 0.237046, Valid_loss 0.398270
Epoch 18, Train Loss 0.214573, Valid_loss 0.309672
Epoch 19, Train Loss 0.241452, Valid_loss 0.332743
Epoch 20, Train Loss 0.227697, Valid_loss 0.342252
Epoch 21, Train Loss 0.207240, Valid_loss 0.379787
Epoch 22, Train Loss 0.211124, Valid_loss 0.337239
Epoch 23, Train Loss 0.239796, Valid_loss 0.384691
Epoch 24, Train Loss 0.208125, Valid_loss 0.379770
Epoch 25, Train Loss 0.244367, Valid_loss 0.265209
Epoch 26, Train Loss 0.223304, Valid_loss 0.301962
Epoch 27, Train Loss 0.214887, Valid_loss 0.336385
Epoch 28, Train Loss 0.229391, Valid_loss 0.399376
Epoch 29, Train Loss 0.253910, Valid_loss 0.564462
Epoch 30, Train Loss 0.264890, Valid_loss 0.353328
Epoch 31, Train Loss 0.231921, Valid_loss 0.267754
Epoch 32, Train Loss 0.211057, Valid_loss 0.277085
Epoch 33, Train Loss 0.240099, Valid_loss 0.372692
Epoch 34, Train Loss 0.239900, Valid_loss 0.284322
Epoch 35, Train Loss 0.259749, Valid_loss 0.257485
Epoch 36, Train Loss 0.214956, Valid_loss 0.285262
Epoch 37, Train Loss 0.212950, Valid_loss 0.292508
Epoch 38, Train Loss 0.215585, Valid_loss 0.490847
Epoch 39, Train Loss 0.202460, Valid_loss 0.273798
Epoch 40, Train Loss 0.198848, Valid_loss 0.289564
Epoch 41, Train Loss 0.198470, Valid_loss 0.255946
Epoch 42, Train Loss 0.219450, Valid_loss 0.298014
Epoch 43, Train Loss 0.194328, Valid_loss 0.273284
Epoch 44, Train Loss 0.182111, Valid_loss 0.303860
Epoch 45, Train Loss 0.188979, Valid_loss 0.287950
Epoch 46, Train Loss 0.208580, Valid_loss 0.283328
Epoch 47, Train Loss 0.189599, Valid_loss 0.301524
Epoch 48, Train Loss 0.202578, Valid_loss 0.331205
Epoch 49, Train Loss 0.208557, Valid_loss 0.347111
Epoch 50, Train Loss 0.198667, Valid_loss 0.329832
Epoch 51, Train Loss 0.204997, Valid_loss 0.321799
Epoch 52, Train Loss 0.181308, Valid_loss 0.328963
Epoch 53, Train Loss 0.189176, Valid_loss 0.314633
Epoch 54, Train Loss 0.168697, Valid_loss 0.382370
Epoch 55, Train Loss 0.182913, Valid_loss 0.361965
Epoch 56, Train Loss 0.178173, Valid_loss 0.380677
Epoch 57, Train Loss 0.163563, Valid_loss 0.347129
Epoch 58, Train Loss 0.176774, Valid_loss 0.292840
Epoch 59, Train Loss 0.200285, Valid_loss 0.339761
Epoch 60, Train Loss 0.201091, Valid_loss 0.330625
Epoch 61, Train Loss 0.196171, Valid_loss 0.330496
Epoch 62, Train Loss 0.190889, Valid_loss 0.397841
Epoch 63, Train Loss 0.194820, Valid_loss 0.281710
Epoch 64, Train Loss 0.182058, Valid_loss 0.303128
Epoch 65, Train Loss 0.205406, Valid_loss 0.307789
환자ID=COVID19_Participant20 -- true: 1 -- pred: 1
환자ID=COVID19_Participant29 -- true: 1 -- pred: 1
환자ID=COVID19_Participant30 -- true: 1 -- pred: 1
환자ID=COVID19_Participant31 -- true: 1 -- pred: 0
환자ID=COVID19_Participant32 -- true: 1 -- pred: 0
환자ID=COVID19_Participant38 -- true: 1 -- pred: 0
환자ID=COVID19_Participant5 -- true: 1 -- pred: 1
환자ID=Control_Participant10 -- true: 0 -- pred: 0
환자ID=Control_Participant12 -- true: 0 -- pred: 0
환자ID=Control_Participant13 -- true: 0 -- pred: 0
Best performance: Epoch 41, Loss 0.198470, Test ACC 0.700000, Test AUC 0.952381, Test Recall 0.571429, Test Precision 1.000000
Confusion Matrix:
 [3 0 3 4]
✅ Total valid splits used: 1
🔁 Repeat 4, Fold 1
cell type :  GTCGGGGGGTGG_Control_Participant7     Developing Ciliated Cells
CAAATCAATTAT_Control_Participant7     Developing Ciliated Cells
ATACAATTGACA_Control_Participant7     Developing Ciliated Cells
CTGTTAATGAGA_Control_Participant7     Developing Ciliated Cells
CTTCACATTATT_Control_Participant7     Developing Ciliated Cells
                                                ...            
GCAGGGAACTCC_COVID19_Participant30               Squamous Cells
CAGCACCGAGCC_COVID19_Participant30               Squamous Cells
GCCCCTTGTGAT_COVID19_Participant30               Squamous Cells
GTGTTGTGTGTC_COVID19_Participant30               Squamous Cells
TAACACTCACTT_COVID19_Participant30               Squamous Cells
Name: manual_annotation, Length: 23132, dtype: string
cell type annotation :  GTCGGGGGGTGG_Control_Participant7     Developing Ciliated Cells
CAAATCAATTAT_Control_Participant7     Developing Ciliated Cells
ATACAATTGACA_Control_Participant7     Developing Ciliated Cells
CTGTTAATGAGA_Control_Participant7     Developing Ciliated Cells
CTTCACATTATT_Control_Participant7     Developing Ciliated Cells
                                                ...            
GCAGGGAACTCC_COVID19_Participant30               Squamous Cells
CAGCACCGAGCC_COVID19_Participant30               Squamous Cells
GCCCCTTGTGAT_COVID19_Participant30               Squamous Cells
GTGTTGTGTGTC_COVID19_Participant30               Squamous Cells
TAACACTCACTT_COVID19_Participant30               Squamous Cells
Name: manual_annotation, Length: 23132, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Developing Ciliated Cells', 'Ciliated Cells', 'Secretory Cells', 'Squamous Cells', 'Goblet Cells', 'T Cells', 'Dendritic Cells', 'Basal Cells', 'Deuterosomal Cells', 'Mitotic Basal Cells', 'Macrophages', 'B Cells', 'Ionocytes', 'Developing Secretory and Goblet Cells', 'Plasmacytoid DCs', 'Enteroendocrine Cells', 'Erythroblasts', 'Mast Cells']
라벨별 그룹 개수 {1: 28, 0: 12}
cell type :  TGGGATTACAGG_Control_Participant5     Enteroendocrine Cells
CTGCGACGGCAC_Control_Participant5           Secretory Cells
GGAATAAGTATC_Control_Participant5            Ciliated Cells
GACACGCCCTTA_Control_Participant5            Ciliated Cells
TTCAAGGTAGTC_Control_Participant5            Ciliated Cells
                                              ...          
TCTAGGTGTCTA_COVID19_Participant18          Secretory Cells
TAAAACTATATT_COVID19_Participant18          Secretory Cells
ACACGGTAAGAC_COVID19_Participant18          Secretory Cells
CACAAACCCACG_COVID19_Participant18          Secretory Cells
TTTCAAACTTCT_COVID19_Participant18          Secretory Cells
Name: manual_annotation, Length: 3815, dtype: string
cell type annotation :  TGGGATTACAGG_Control_Participant5     Enteroendocrine Cells
CTGCGACGGCAC_Control_Participant5           Secretory Cells
GGAATAAGTATC_Control_Participant5            Ciliated Cells
GACACGCCCTTA_Control_Participant5            Ciliated Cells
TTCAAGGTAGTC_Control_Participant5            Ciliated Cells
                                              ...          
TCTAGGTGTCTA_COVID19_Participant18          Secretory Cells
TAAAACTATATT_COVID19_Participant18          Secretory Cells
ACACGGTAAGAC_COVID19_Participant18          Secretory Cells
CACAAACCCACG_COVID19_Participant18          Secretory Cells
TTTCAAACTTCT_COVID19_Participant18          Secretory Cells
Name: manual_annotation, Length: 3815, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Enteroendocrine Cells', 'Secretory Cells', 'Ciliated Cells', 'T Cells', 'Goblet Cells', 'Squamous Cells', 'Mitotic Basal Cells', 'Basal Cells', 'Dendritic Cells', 'Developing Ciliated Cells', 'Deuterosomal Cells', 'B Cells', 'Ionocytes', 'Macrophages', 'Developing Secretory and Goblet Cells', 'Erythroblasts', 'Plasmacytoid DCs']
라벨별 그룹 개수 {1: 7, 0: 3}
🔍 Split #2
  → train_p_index 환자 수 (환자 단위로 묶인 index list): 40
  → test_p_index 환자 수  (환자 단위로 묶인 index list): 10
  → train 환자 ID: ['COVID19_Participant11', 'COVID19_Participant12', 'COVID19_Participant13', 'COVID19_Participant14', 'COVID19_Participant15', 'COVID19_Participant17', 'COVID19_Participant19', 'COVID19_Participant2', 'COVID19_Participant20', 'COVID19_Participant21', 'COVID19_Participant22', 'COVID19_Participant23', 'COVID19_Participant25', 'COVID19_Participant26', 'COVID19_Participant27', 'COVID19_Participant29', 'COVID19_Participant3', 'COVID19_Participant30', 'COVID19_Participant31', 'COVID19_Participant32', 'COVID19_Participant35', 'COVID19_Participant36', 'COVID19_Participant37', 'COVID19_Participant38', 'COVID19_Participant4', 'COVID19_Participant40', 'COVID19_Participant5', 'COVID19_Participant7', 'Control_Participant10', 'Control_Participant11', 'Control_Participant12', 'Control_Participant13', 'Control_Participant15', 'Control_Participant2', 'Control_Participant3', 'Control_Participant4', 'Control_Participant6', 'Control_Participant7', 'Control_Participant8', 'Control_Participant9']
  → test  환자 ID: ['COVID19_Participant10', 'COVID19_Participant18', 'COVID19_Participant28', 'COVID19_Participant39', 'COVID19_Participant6', 'COVID19_Participant8', 'COVID19_Participant9', 'Control_Participant1', 'Control_Participant14', 'Control_Participant5']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant12, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant21, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant27, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant3, Label: 1
    ID: COVID19_Participant30, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant35, Label: 1
    ID: COVID19_Participant36, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant38, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: COVID19_Participant5, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: Control_Participant10, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant12, Label: 0
    ID: Control_Participant13, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant2, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant4, Label: 0
    ID: Control_Participant6, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant8, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: COVID19_Participant10, Label: 1
    ID: COVID19_Participant18, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant6, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: COVID19_Participant9, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant14, Label: 0
    ID: Control_Participant5, Label: 0
전체 데이터 index 길이 50
label_stat (train 환자 라벨 목록) 갯수 40
train_data에서 환자 단위로, train과 validation 나누기
기존 train_p_index 40
기존 (train) label_stat 40
train-vali 분할 후! 
train y 의 classes : {0, 1} valid y 의 classes : {0, 1} label_stat 의 classes : {0, 1}
train_p_index_ 26
valid_p_index 14
test_p_index 10
→ train 환자 ID 및 라벨:
   총 개수: 26
   환자ID=Control_Participant11, Label=0, 셀개수=1164
   환자ID=Control_Participant2, Label=0, 셀개수=41
   환자ID=COVID19_Participant19, Label=1, 셀개수=816
   환자ID=COVID19_Participant36, Label=1, 셀개수=200
   환자ID=COVID19_Participant11, Label=1, 셀개수=382
   환자ID=Control_Participant6, Label=0, 셀개수=131
   환자ID=COVID19_Participant14, Label=1, 셀개수=382
   환자ID=COVID19_Participant2, Label=1, 셀개수=329
   환자ID=COVID19_Participant38, Label=1, 셀개수=51
   환자ID=COVID19_Participant13, Label=1, 셀개수=730
   환자ID=COVID19_Participant20, Label=1, 셀개수=2033
   환자ID=Control_Participant3, Label=0, 셀개수=1620
   환자ID=COVID19_Participant26, Label=1, 셀개수=814
   환자ID=Control_Participant8, Label=0, 셀개수=393
   환자ID=Control_Participant7, Label=0, 셀개수=762
   환자ID=COVID19_Participant15, Label=1, 셀개수=1003
   환자ID=Control_Participant9, Label=0, 셀개수=558
   환자ID=Control_Participant12, Label=0, 셀개수=99
   환자ID=COVID19_Participant22, Label=1, 셀개수=865
   환자ID=COVID19_Participant3, Label=1, 셀개수=104
   환자ID=COVID19_Participant25, Label=1, 셀개수=496
   환자ID=COVID19_Participant17, Label=1, 셀개수=843
   환자ID=COVID19_Participant40, Label=1, 셀개수=381
   환자ID=COVID19_Participant37, Label=1, 셀개수=668
   환자ID=COVID19_Participant35, Label=1, 셀개수=83
   환자ID=COVID19_Participant29, Label=1, 셀개수=573
→ valid 환자 ID 및 라벨:
   총 개수: 14
   환자ID=Control_Participant15, Label=0, 셀개수=528
   환자ID=COVID19_Participant27, Label=1, 셀개수=93
   환자ID=COVID19_Participant31, Label=1, 셀개수=410
   환자ID=COVID19_Participant30, Label=1, 셀개수=116
   환자ID=COVID19_Participant4, Label=1, 셀개수=1680
   환자ID=COVID19_Participant21, Label=1, 셀개수=39
   환자ID=Control_Participant4, Label=0, 셀개수=440
   환자ID=Control_Participant10, Label=0, 셀개수=1645
   환자ID=COVID19_Participant7, Label=1, 셀개수=409
   환자ID=COVID19_Participant5, Label=1, 셀개수=89
   환자ID=Control_Participant13, Label=0, 셀개수=88
   환자ID=COVID19_Participant32, Label=1, 셀개수=1665
   환자ID=COVID19_Participant12, Label=1, 셀개수=102
   환자ID=COVID19_Participant23, Label=1, 셀개수=307
→ test 환자 ID 및 라벨:
   총 개수: 10
   환자ID=COVID19_Participant10, Label=1, 셀개수=18
   환자ID=COVID19_Participant18, Label=1, 셀개수=227
   환자ID=COVID19_Participant28, Label=1, 셀개수=1079
   환자ID=COVID19_Participant39, Label=1, 셀개수=454
   환자ID=COVID19_Participant6, Label=1, 셀개수=84
   환자ID=COVID19_Participant8, Label=1, 셀개수=462
   환자ID=COVID19_Participant9, Label=1, 셀개수=86
   환자ID=Control_Participant1, Label=0, 셀개수=414
   환자ID=Control_Participant14, Label=0, 셀개수=274
   환자ID=Control_Participant5, Label=0, 셀개수=717
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Ciliated Cells', 'Developing Ciliated Cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
전체 데이터 길이 26947
전체 cell type 길이 0        Developing Ciliated Cells
1        Developing Ciliated Cells
2        Developing Ciliated Cells
3        Developing Ciliated Cells
4        Developing Ciliated Cells
                   ...            
26942              Secretory Cells
26943              Secretory Cells
26944              Secretory Cells
26945              Secretory Cells
26946              Secretory Cells
Length: 26947, dtype: string
cell type의 NaN 개수 체크 0
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:11,  8.74it/s]  2%|▏         | 2/100 [00:00<00:11,  8.84it/s]  3%|▎         | 3/100 [00:00<00:10,  9.02it/s]  5%|▌         | 5/100 [00:00<00:11,  8.16it/s]  7%|▋         | 7/100 [00:00<00:10,  8.64it/s]  9%|▉         | 9/100 [00:01<00:09,  9.13it/s] 11%|█         | 11/100 [00:01<00:09,  9.48it/s] 12%|█▏        | 12/100 [00:01<00:09,  9.56it/s] 13%|█▎        | 13/100 [00:01<00:09,  9.44it/s] 14%|█▍        | 14/100 [00:01<00:09,  9.45it/s] 15%|█▌        | 15/100 [00:01<00:08,  9.59it/s] 17%|█▋        | 17/100 [00:01<00:08,  9.96it/s] 18%|█▊        | 18/100 [00:02<00:10,  7.50it/s] 19%|█▉        | 19/100 [00:02<00:10,  7.93it/s] 20%|██        | 20/100 [00:02<00:09,  8.09it/s] 22%|██▏       | 22/100 [00:02<00:08,  8.93it/s] 24%|██▍       | 24/100 [00:02<00:08,  9.28it/s] 26%|██▌       | 26/100 [00:02<00:07,  9.42it/s] 28%|██▊       | 28/100 [00:03<00:07,  9.60it/s] 29%|██▉       | 29/100 [00:03<00:07,  9.58it/s] 30%|███       | 30/100 [00:03<00:07,  9.55it/s] 31%|███       | 31/100 [00:03<00:07,  9.30it/s] 32%|███▏      | 32/100 [00:03<00:07,  8.54it/s] 34%|███▍      | 34/100 [00:03<00:07,  8.89it/s] 35%|███▌      | 35/100 [00:03<00:07,  8.89it/s] 36%|███▌      | 36/100 [00:04<00:08,  7.28it/s] 38%|███▊      | 38/100 [00:04<00:07,  8.32it/s] 39%|███▉      | 39/100 [00:04<00:07,  8.45it/s] 40%|████      | 40/100 [00:04<00:06,  8.67it/s] 42%|████▏     | 42/100 [00:04<00:06,  8.68it/s] 43%|████▎     | 43/100 [00:04<00:06,  8.75it/s] 44%|████▍     | 44/100 [00:04<00:06,  8.10it/s] 46%|████▌     | 46/100 [00:05<00:06,  8.45it/s] 47%|████▋     | 47/100 [00:05<00:06,  8.68it/s] 48%|████▊     | 48/100 [00:05<00:06,  8.57it/s] 50%|█████     | 50/100 [00:05<00:05,  9.16it/s] 51%|█████     | 51/100 [00:05<00:05,  9.32it/s] 53%|█████▎    | 53/100 [00:05<00:04,  9.53it/s] 55%|█████▌    | 55/100 [00:06<00:04,  9.71it/s] 56%|█████▌    | 56/100 [00:06<00:04,  9.73it/s] 57%|█████▋    | 57/100 [00:06<00:04,  9.78it/s] 58%|█████▊    | 58/100 [00:06<00:05,  8.05it/s] 59%|█████▉    | 59/100 [00:06<00:05,  7.53it/s] 60%|██████    | 60/100 [00:06<00:04,  8.03it/s] 61%|██████    | 61/100 [00:06<00:04,  8.40it/s] 62%|██████▏   | 62/100 [00:07<00:04,  8.72it/s] 63%|██████▎   | 63/100 [00:07<00:04,  8.22it/s] 64%|██████▍   | 64/100 [00:07<00:04,  8.29it/s] 65%|██████▌   | 65/100 [00:07<00:04,  8.48it/s] 66%|██████▌   | 66/100 [00:07<00:06,  5.61it/s] 67%|██████▋   | 67/100 [00:07<00:05,  6.20it/s] 68%|██████▊   | 68/100 [00:07<00:05,  6.02it/s] 70%|███████   | 70/100 [00:08<00:04,  7.42it/s] 71%|███████   | 71/100 [00:08<00:03,  7.76it/s] 72%|███████▏  | 72/100 [00:08<00:03,  7.96it/s] 73%|███████▎  | 73/100 [00:08<00:03,  7.51it/s] 74%|███████▍  | 74/100 [00:08<00:03,  8.07it/s] 75%|███████▌  | 75/100 [00:08<00:02,  8.52it/s] 76%|███████▌  | 76/100 [00:08<00:02,  8.69it/s] 77%|███████▋  | 77/100 [00:09<00:02,  8.50it/s] 78%|███████▊  | 78/100 [00:09<00:02,  8.73it/s] 79%|███████▉  | 79/100 [00:09<00:02,  9.00it/s] 80%|████████  | 80/100 [00:09<00:02,  8.71it/s] 82%|████████▏ | 82/100 [00:09<00:01,  9.58it/s] 83%|████████▎ | 83/100 [00:09<00:01,  9.55it/s] 84%|████████▍ | 84/100 [00:09<00:02,  6.28it/s] 85%|████████▌ | 85/100 [00:10<00:02,  6.98it/s] 87%|████████▋ | 87/100 [00:10<00:01,  7.93it/s] 88%|████████▊ | 88/100 [00:10<00:01,  8.09it/s] 89%|████████▉ | 89/100 [00:10<00:01,  8.40it/s] 90%|█████████ | 90/100 [00:10<00:01,  8.64it/s] 91%|█████████ | 91/100 [00:10<00:01,  8.81it/s] 92%|█████████▏| 92/100 [00:10<00:01,  6.11it/s] 93%|█████████▎| 93/100 [00:11<00:01,  6.84it/s] 94%|█████████▍| 94/100 [00:11<00:00,  7.43it/s] 95%|█████████▌| 95/100 [00:11<00:00,  7.99it/s] 97%|█████████▋| 97/100 [00:11<00:00,  8.72it/s] 98%|█████████▊| 98/100 [00:11<00:00,  8.63it/s] 99%|█████████▉| 99/100 [00:11<00:00,  8.66it/s]100%|██████████| 100/100 [00:11<00:00,  8.57it/s]100%|██████████| 100/100 [00:11<00:00,  8.44it/s]
[I 2025-08-30 09:55:29,669] A new study created in memory with name: no-name-1b83e280-e9e4-42e3-9865-561498b93783
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 26.13 MB
Memory Reserved: 46.00 MB
cuda
Epoch 1, Train Loss 0.662580, Valid_loss 0.590591
Epoch 2, Train Loss 0.638906, Valid_loss 0.578697
Epoch 3, Train Loss 0.605863, Valid_loss 0.567380
Epoch 4, Train Loss 0.594080, Valid_loss 0.546936
Epoch 5, Train Loss 0.537085, Valid_loss 0.525789
Epoch 6, Train Loss 0.529080, Valid_loss 0.509635
Epoch 7, Train Loss 0.502113, Valid_loss 0.490908
Epoch 8, Train Loss 0.486197, Valid_loss 0.491404
Epoch 9, Train Loss 0.490497, Valid_loss 0.475908
Epoch 10, Train Loss 0.463610, Valid_loss 0.491160
Epoch 11, Train Loss 0.454281, Valid_loss 0.461644
Epoch 12, Train Loss 0.438088, Valid_loss 0.453739
Epoch 13, Train Loss 0.408192, Valid_loss 0.446986
Epoch 14, Train Loss 0.454529, Valid_loss 0.436940
Epoch 15, Train Loss 0.451916, Valid_loss 0.459480
Epoch 16, Train Loss 0.447573, Valid_loss 0.431964
Epoch 17, Train Loss 0.423599, Valid_loss 0.468619
Epoch 18, Train Loss 0.408845, Valid_loss 0.423176
Epoch 19, Train Loss 0.421206, Valid_loss 0.431932
Epoch 20, Train Loss 0.412148, Valid_loss 0.423407
Epoch 21, Train Loss 0.448751, Valid_loss 0.420448
Epoch 22, Train Loss 0.434062, Valid_loss 0.423584
Epoch 23, Train Loss 0.425373, Valid_loss 0.426894
Epoch 24, Train Loss 0.415738, Valid_loss 0.428182
Epoch 25, Train Loss 0.420983, Valid_loss 0.425017
Epoch 26, Train Loss 0.421423, Valid_loss 0.439859
Epoch 27, Train Loss 0.418226, Valid_loss 0.425430
Epoch 28, Train Loss 0.395209, Valid_loss 0.422896
Epoch 29, Train Loss 0.413271, Valid_loss 0.412265
Epoch 30, Train Loss 0.410462, Valid_loss 0.436897
Epoch 31, Train Loss 0.426950, Valid_loss 0.406897
Epoch 32, Train Loss 0.370862, Valid_loss 0.403185
Epoch 33, Train Loss 0.352676, Valid_loss 0.399886
Epoch 34, Train Loss 0.382364, Valid_loss 0.404724
Epoch 35, Train Loss 0.411851, Valid_loss 0.427315
Epoch 36, Train Loss 0.387493, Valid_loss 0.405567
Epoch 37, Train Loss 0.378383, Valid_loss 0.403585
Epoch 38, Train Loss 0.414761, Valid_loss 0.397183
Epoch 39, Train Loss 0.395568, Valid_loss 0.406700
Epoch 40, Train Loss 0.400495, Valid_loss 0.409903
Epoch 41, Train Loss 0.392742, Valid_loss 0.407621
Epoch 42, Train Loss 0.397038, Valid_loss 0.405165
Epoch 43, Train Loss 0.375954, Valid_loss 0.394644
Epoch 44, Train Loss 0.428472, Valid_loss 0.392827
Epoch 45, Train Loss 0.391328, Valid_loss 0.400818
Epoch 46, Train Loss 0.381525, Valid_loss 0.412702
Epoch 47, Train Loss 0.346412, Valid_loss 0.383683
Epoch 48, Train Loss 0.361831, Valid_loss 0.388456
Epoch 49, Train Loss 0.366407, Valid_loss 0.390005
Epoch 50, Train Loss 0.364831, Valid_loss 0.389781
Epoch 51, Train Loss 0.371425, Valid_loss 0.396233
Epoch 52, Train Loss 0.358882, Valid_loss 0.383056
Epoch 53, Train Loss 0.369717, Valid_loss 0.382462
Epoch 54, Train Loss 0.387144, Valid_loss 0.394758
Epoch 55, Train Loss 0.384704, Valid_loss 0.391023
Epoch 56, Train Loss 0.352370, Valid_loss 0.385694
Epoch 57, Train Loss 0.371479, Valid_loss 0.382568
Epoch 58, Train Loss 0.365436, Valid_loss 0.390620
Epoch 59, Train Loss 0.353133, Valid_loss 0.406341
[I 2025-08-30 10:00:11,554] Trial 0 finished with value: 0.38246241052235874 and parameters: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 4, 'dropout': 0.7, 'weight_decay': 0.0001, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.38246241052235874.
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 27.97 MB
Memory Reserved: 46.00 MB
cuda
Epoch 1, Train Loss 0.620971, Valid_loss 0.540728
Epoch 2, Train Loss 0.589267, Valid_loss 0.496371
Epoch 3, Train Loss 0.512765, Valid_loss 0.496387
Epoch 4, Train Loss 0.424643, Valid_loss 0.482630
Epoch 5, Train Loss 0.397993, Valid_loss 0.441481
Epoch 6, Train Loss 0.376755, Valid_loss 0.440741
Epoch 7, Train Loss 0.350437, Valid_loss 0.468251
Epoch 8, Train Loss 0.346283, Valid_loss 0.377854
Epoch 9, Train Loss 0.350328, Valid_loss 0.497127
Epoch 10, Train Loss 0.307758, Valid_loss 0.437714
Epoch 11, Train Loss 0.301479, Valid_loss 0.460557
Epoch 12, Train Loss 0.317507, Valid_loss 0.483079
Epoch 13, Train Loss 0.306300, Valid_loss 0.374347
Epoch 14, Train Loss 0.322695, Valid_loss 0.470759
Epoch 15, Train Loss 0.292695, Valid_loss 0.421128
Epoch 16, Train Loss 0.297691, Valid_loss 0.396380
Epoch 17, Train Loss 0.297647, Valid_loss 0.387952
Epoch 18, Train Loss 0.299803, Valid_loss 0.377497
Epoch 19, Train Loss 0.269977, Valid_loss 0.384370
Epoch 20, Train Loss 0.278185, Valid_loss 0.442910
Epoch 21, Train Loss 0.277112, Valid_loss 0.383175
Epoch 22, Train Loss 0.275611, Valid_loss 0.437242
Epoch 23, Train Loss 0.269844, Valid_loss 0.340376
Epoch 24, Train Loss 0.292689, Valid_loss 0.390782
Epoch 25, Train Loss 0.286191, Valid_loss 0.538023
Epoch 26, Train Loss 0.277241, Valid_loss 0.391278
Epoch 27, Train Loss 0.274793, Valid_loss 0.434897
Epoch 28, Train Loss 0.270715, Valid_loss 0.364020
Epoch 29, Train Loss 0.272646, Valid_loss 0.414810
Epoch 30, Train Loss 0.258286, Valid_loss 0.407008
Epoch 31, Train Loss 0.262332, Valid_loss 0.387106
Epoch 32, Train Loss 0.282126, Valid_loss 0.428174
Epoch 33, Train Loss 0.261083, Valid_loss 0.354249
Epoch 34, Train Loss 0.273102, Valid_loss 0.400171
Epoch 35, Train Loss 0.267784, Valid_loss 0.443617
Epoch 36, Train Loss 0.256354, Valid_loss 0.391892
Epoch 37, Train Loss 0.266064, Valid_loss 0.362279
Epoch 38, Train Loss 0.266771, Valid_loss 0.406670
Epoch 39, Train Loss 0.284446, Valid_loss 0.444764
Epoch 40, Train Loss 0.253246, Valid_loss 0.365811
Epoch 41, Train Loss 0.264058, Valid_loss 0.446557
Epoch 42, Train Loss 0.266043, Valid_loss 0.408689
Epoch 43, Train Loss 0.255897, Valid_loss 0.410008
Epoch 44, Train Loss 0.257638, Valid_loss 0.348053
Epoch 45, Train Loss 0.253529, Valid_loss 0.442348
Epoch 46, Train Loss 0.250967, Valid_loss 0.380335
Epoch 47, Train Loss 0.255940, Valid_loss 0.303336
Epoch 48, Train Loss 0.264102, Valid_loss 0.473100
Epoch 49, Train Loss 0.253272, Valid_loss 0.314141
Epoch 50, Train Loss 0.250745, Valid_loss 0.379526
Epoch 51, Train Loss 0.243037, Valid_loss 0.363951
Epoch 52, Train Loss 0.245679, Valid_loss 0.370571
Epoch 53, Train Loss 0.258514, Valid_loss 0.369676
Epoch 54, Train Loss 0.252498, Valid_loss 0.392347
Epoch 55, Train Loss 0.247994, Valid_loss 0.355811
Epoch 56, Train Loss 0.252258, Valid_loss 0.359747
Epoch 57, Train Loss 0.241988, Valid_loss 0.352369
Epoch 58, Train Loss 0.254699, Valid_loss 0.424011
Epoch 59, Train Loss 0.246721, Valid_loss 0.343905
Epoch 60, Train Loss 0.246304, Valid_loss 0.419941
Epoch 61, Train Loss 0.240238, Valid_loss 0.358272
Epoch 62, Train Loss 0.248264, Valid_loss 0.390213
Epoch 63, Train Loss 0.248652, Valid_loss 0.368047
Epoch 64, Train Loss 0.250811, Valid_loss 0.374735
Epoch 65, Train Loss 0.239846, Valid_loss 0.408335
[I 2025-08-30 10:05:23,508] Trial 1 finished with value: 0.3033362023000206 and parameters: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 4, 'dropout': 0.5, 'weight_decay': 0.001, 'emb_dim': 64, 'augment_num': 100, 'pca': False}. Best is trial 1 with value: 0.3033362023000206.
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 26.13 MB
Memory Reserved: 46.00 MB
cuda
Epoch 1, Train Loss 0.664017, Valid_loss 0.608209
Epoch 2, Train Loss 0.639883, Valid_loss 0.600466
Epoch 3, Train Loss 0.653633, Valid_loss 0.613162
Epoch 4, Train Loss 0.640619, Valid_loss 0.598486
Epoch 5, Train Loss 0.641732, Valid_loss 0.612795
Epoch 6, Train Loss 0.656766, Valid_loss 0.598419
Epoch 7, Train Loss 0.648230, Valid_loss 0.612002
Epoch 8, Train Loss 0.648460, Valid_loss 0.601560
Epoch 9, Train Loss 0.653598, Valid_loss 0.612564
Epoch 10, Train Loss 0.642977, Valid_loss 0.604376
Epoch 11, Train Loss 0.638601, Valid_loss 0.606232
Epoch 12, Train Loss 0.645070, Valid_loss 0.601792
Epoch 13, Train Loss 0.638894, Valid_loss 0.612341
Epoch 14, Train Loss 0.634461, Valid_loss 0.602086
Epoch 15, Train Loss 0.638055, Valid_loss 0.600376
Epoch 16, Train Loss 0.634223, Valid_loss 0.614627
Epoch 17, Train Loss 0.640932, Valid_loss 0.597454
Epoch 18, Train Loss 0.625493, Valid_loss 0.594375
Epoch 19, Train Loss 0.627777, Valid_loss 0.635197
Epoch 20, Train Loss 0.497623, Valid_loss 0.627009
Epoch 21, Train Loss 0.355797, Valid_loss 0.855060
Epoch 22, Train Loss 0.326285, Valid_loss 1.138642
Epoch 23, Train Loss 0.309815, Valid_loss 0.734248
Epoch 24, Train Loss 0.265921, Valid_loss 0.884425
Epoch 25, Train Loss 0.251042, Valid_loss 0.838841
Epoch 26, Train Loss 0.231241, Valid_loss 0.944036
Epoch 27, Train Loss 0.255395, Valid_loss 0.932098
Epoch 28, Train Loss 0.265050, Valid_loss 0.839274
Epoch 29, Train Loss 0.276471, Valid_loss 0.903382
Epoch 30, Train Loss 0.245831, Valid_loss 0.955017
Epoch 31, Train Loss 0.226170, Valid_loss 0.867935
Epoch 32, Train Loss 0.226600, Valid_loss 0.916812
Epoch 33, Train Loss 0.217317, Valid_loss 0.915562
Epoch 34, Train Loss 0.212934, Valid_loss 0.911897
Epoch 35, Train Loss 0.211198, Valid_loss 0.951413
Epoch 36, Train Loss 0.210418, Valid_loss 0.968360
Epoch 37, Train Loss 0.227939, Valid_loss 0.702617
Epoch 38, Train Loss 0.215524, Valid_loss 0.802835
Epoch 39, Train Loss 0.205370, Valid_loss 0.662930
Epoch 40, Train Loss 0.199746, Valid_loss 0.891939
Epoch 41, Train Loss 0.202765, Valid_loss 0.684049
Epoch 42, Train Loss 0.197907, Valid_loss 0.808308
Epoch 43, Train Loss 0.199505, Valid_loss 0.946200
Epoch 44, Train Loss 0.198012, Valid_loss 0.741661
Epoch 45, Train Loss 0.209660, Valid_loss 0.811325
Epoch 46, Train Loss 0.190292, Valid_loss 0.718829
Epoch 47, Train Loss 0.430993, Valid_loss 0.601264
Epoch 48, Train Loss 0.242308, Valid_loss 0.793139
Epoch 49, Train Loss 0.213409, Valid_loss 0.819784
Epoch 50, Train Loss 0.207718, Valid_loss 0.824931
Epoch 51, Train Loss 0.207831, Valid_loss 0.812070
Epoch 52, Train Loss 0.206543, Valid_loss 0.852402
Epoch 53, Train Loss 0.197106, Valid_loss 0.768944
Epoch 54, Train Loss 0.191312, Valid_loss 0.790028
Epoch 55, Train Loss 0.189084, Valid_loss 0.776554
Epoch 56, Train Loss 0.189469, Valid_loss 0.815093
Epoch 57, Train Loss 0.187637, Valid_loss 0.760237
Epoch 58, Train Loss 0.185745, Valid_loss 0.744536
Epoch 59, Train Loss 0.183152, Valid_loss 0.801363
Epoch 60, Train Loss 0.182255, Valid_loss 0.759855
Epoch 61, Train Loss 0.186182, Valid_loss 0.771650
Epoch 62, Train Loss 0.184976, Valid_loss 0.756637
Epoch 63, Train Loss 0.183219, Valid_loss 0.814433
Epoch 64, Train Loss 0.185014, Valid_loss 0.777992
Epoch 65, Train Loss 0.181246, Valid_loss 0.778813
Epoch 66, Train Loss 0.181475, Valid_loss 0.778598
Epoch 67, Train Loss 0.179831, Valid_loss 0.773248
Epoch 68, Train Loss 0.187589, Valid_loss 0.715932
Epoch 69, Train Loss 0.182088, Valid_loss 0.781665
Epoch 70, Train Loss 0.185604, Valid_loss 0.766959
Epoch 71, Train Loss 0.189714, Valid_loss 0.853271
Epoch 72, Train Loss 0.178979, Valid_loss 0.777205
Epoch 73, Train Loss 0.180983, Valid_loss 0.892830
Epoch 74, Train Loss 0.252626, Valid_loss 0.888705
Epoch 75, Train Loss 0.238353, Valid_loss 0.778623
Epoch 76, Train Loss 0.207707, Valid_loss 0.614176
Epoch 77, Train Loss 0.212960, Valid_loss 0.731743
Epoch 78, Train Loss 0.212451, Valid_loss 0.607720
Epoch 79, Train Loss 0.200850, Valid_loss 0.759644
Epoch 80, Train Loss 0.202852, Valid_loss 0.714379
Epoch 81, Train Loss 0.199608, Valid_loss 0.762309
Epoch 82, Train Loss 0.196610, Valid_loss 0.760401
Epoch 83, Train Loss 0.193132, Valid_loss 0.748403
Epoch 84, Train Loss 0.209557, Valid_loss 0.651359
Epoch 85, Train Loss 0.210202, Valid_loss 0.750623
Epoch 86, Train Loss 0.198358, Valid_loss 0.656214
Epoch 87, Train Loss 0.202843, Valid_loss 0.798614
Epoch 88, Train Loss 0.192719, Valid_loss 0.644432
Epoch 89, Train Loss 0.194054, Valid_loss 0.764868
Epoch 90, Train Loss 0.188136, Valid_loss 0.730071
Epoch 91, Train Loss 0.186330, Valid_loss 0.751732
Epoch 92, Train Loss 0.183710, Valid_loss 0.783022
[I 2025-08-30 10:11:15,891] Trial 2 finished with value: 0.594374846134867 and parameters: {'learning_rate': 0.01, 'epochs': 100, 'heads': 1, 'dropout': 0.0, 'weight_decay': 0.0001, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 1 with value: 0.3033362023000206.
선택된 trial params: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 4, 'dropout': 0.5, 'weight_decay': 0.001, 'emb_dim': 64, 'augment_num': 100, 'pca': False}
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=10, batch_size=1 -> steps=10
output_class :  1
Memory Allocated: 27.97 MB
Memory Reserved: 46.00 MB
cuda
Epoch 1, Train Loss 0.655315, Valid_loss 0.570313
Epoch 2, Train Loss 0.596390, Valid_loss 0.527061
Epoch 3, Train Loss 0.501046, Valid_loss 0.504875
Epoch 4, Train Loss 0.419595, Valid_loss 0.446806
Epoch 5, Train Loss 0.382779, Valid_loss 0.442606
Epoch 6, Train Loss 0.353497, Valid_loss 0.413091
Epoch 7, Train Loss 0.368015, Valid_loss 0.442356
Epoch 8, Train Loss 0.334800, Valid_loss 0.444245
Epoch 9, Train Loss 0.332227, Valid_loss 0.379406
Epoch 10, Train Loss 0.320269, Valid_loss 0.418945
Epoch 11, Train Loss 0.330661, Valid_loss 0.346211
Epoch 12, Train Loss 0.308441, Valid_loss 0.472907
Epoch 13, Train Loss 0.309417, Valid_loss 0.370777
Epoch 14, Train Loss 0.285300, Valid_loss 0.444960
Epoch 15, Train Loss 0.306922, Valid_loss 0.353041
Epoch 16, Train Loss 0.310036, Valid_loss 0.392783
Epoch 17, Train Loss 0.281792, Valid_loss 0.348585
Epoch 18, Train Loss 0.290875, Valid_loss 0.452497
Epoch 19, Train Loss 0.272611, Valid_loss 0.357870
Epoch 20, Train Loss 0.285827, Valid_loss 0.407887
Epoch 21, Train Loss 0.273890, Valid_loss 0.334290
Epoch 22, Train Loss 0.273523, Valid_loss 0.358439
Epoch 23, Train Loss 0.285224, Valid_loss 0.359818
Epoch 24, Train Loss 0.286068, Valid_loss 0.372320
Epoch 25, Train Loss 0.281785, Valid_loss 0.366852
Epoch 26, Train Loss 0.264637, Valid_loss 0.335745
Epoch 27, Train Loss 0.279509, Valid_loss 0.401840
Epoch 28, Train Loss 0.261098, Valid_loss 0.343012
Epoch 29, Train Loss 0.275720, Valid_loss 0.415049
Epoch 30, Train Loss 0.281599, Valid_loss 0.392945
Epoch 31, Train Loss 0.284832, Valid_loss 0.333723
Epoch 32, Train Loss 0.288658, Valid_loss 0.352477
Epoch 33, Train Loss 0.275838, Valid_loss 0.385074
Epoch 34, Train Loss 0.276633, Valid_loss 0.339225
Epoch 35, Train Loss 0.270037, Valid_loss 0.379807
Epoch 36, Train Loss 0.260853, Valid_loss 0.352220
Epoch 37, Train Loss 0.262913, Valid_loss 0.350937
Epoch 38, Train Loss 0.267055, Valid_loss 0.391669
Epoch 39, Train Loss 0.254031, Valid_loss 0.338382
Epoch 40, Train Loss 0.255454, Valid_loss 0.421971
Epoch 41, Train Loss 0.263209, Valid_loss 0.362858
Epoch 42, Train Loss 0.242513, Valid_loss 0.351425
Epoch 43, Train Loss 0.262836, Valid_loss 0.359118
Epoch 44, Train Loss 0.267934, Valid_loss 0.314528
Epoch 45, Train Loss 0.265271, Valid_loss 0.397608
Epoch 46, Train Loss 0.259883, Valid_loss 0.343135
Epoch 47, Train Loss 0.255773, Valid_loss 0.358770
Epoch 48, Train Loss 0.258585, Valid_loss 0.367908
Epoch 49, Train Loss 0.253286, Valid_loss 0.326842
Epoch 50, Train Loss 0.255110, Valid_loss 0.324929
Epoch 51, Train Loss 0.238862, Valid_loss 0.373318
Epoch 52, Train Loss 0.247958, Valid_loss 0.350767
Epoch 53, Train Loss 0.252806, Valid_loss 0.360790
Epoch 54, Train Loss 0.242530, Valid_loss 0.335446
Epoch 55, Train Loss 0.237118, Valid_loss 0.384747
Epoch 56, Train Loss 0.241130, Valid_loss 0.363300
Epoch 57, Train Loss 0.247728, Valid_loss 0.359915
Epoch 58, Train Loss 0.257173, Valid_loss 0.369015
Epoch 59, Train Loss 0.244173, Valid_loss 0.364354
Epoch 60, Train Loss 0.242254, Valid_loss 0.333817
Epoch 61, Train Loss 0.244326, Valid_loss 0.385682
Epoch 62, Train Loss 0.244171, Valid_loss 0.375893
Epoch 63, Train Loss 0.260906, Valid_loss 0.375668
Epoch 64, Train Loss 0.245342, Valid_loss 0.358631
Epoch 65, Train Loss 0.257280, Valid_loss 0.361108
Epoch 66, Train Loss 0.234908, Valid_loss 0.349545
Epoch 67, Train Loss 0.241422, Valid_loss 0.361207
Epoch 68, Train Loss 0.239712, Valid_loss 0.352220
Epoch 69, Train Loss 0.233641, Valid_loss 0.394276
Epoch 70, Train Loss 0.236477, Valid_loss 0.354373
Epoch 71, Train Loss 0.236733, Valid_loss 0.351866
Epoch 72, Train Loss 0.244901, Valid_loss 0.388410
Epoch 73, Train Loss 0.234930, Valid_loss 0.331425
Epoch 74, Train Loss 0.246184, Valid_loss 0.400035
Epoch 75, Train Loss 0.240637, Valid_loss 0.344806
Epoch 76, Train Loss 0.247402, Valid_loss 0.371949
Epoch 77, Train Loss 0.233564, Valid_loss 0.368948
Epoch 78, Train Loss 0.236579, Valid_loss 0.361418
Epoch 79, Train Loss 0.249062, Valid_loss 0.368606
Epoch 80, Train Loss 0.237767, Valid_loss 0.343473
Epoch 81, Train Loss 0.239105, Valid_loss 0.367323
Epoch 82, Train Loss 0.232691, Valid_loss 0.371678
환자ID=COVID19_Participant10 -- true: 1 -- pred: 1
환자ID=COVID19_Participant18 -- true: 1 -- pred: 1
환자ID=COVID19_Participant28 -- true: 1 -- pred: 1
환자ID=COVID19_Participant39 -- true: 1 -- pred: 1
환자ID=COVID19_Participant6 -- true: 1 -- pred: 1
환자ID=COVID19_Participant8 -- true: 1 -- pred: 1
환자ID=COVID19_Participant9 -- true: 1 -- pred: 1
환자ID=Control_Participant1 -- true: 0 -- pred: 1
환자ID=Control_Participant14 -- true: 0 -- pred: 0
환자ID=Control_Participant5 -- true: 0 -- pred: 0
Best performance: Epoch 44, Loss 0.267934, Test ACC 0.900000, Test AUC 0.952381, Test Recall 1.000000, Test Precision 0.875000
Confusion Matrix:
 [2 1 0 7]
✅ Total valid splits used: 2
🔁 Repeat 4, Fold 2
cell type :  GTCGGGGGGTGG_Control_Participant7     Developing Ciliated Cells
CAAATCAATTAT_Control_Participant7     Developing Ciliated Cells
ATACAATTGACA_Control_Participant7     Developing Ciliated Cells
CTGTTAATGAGA_Control_Participant7     Developing Ciliated Cells
CTTCACATTATT_Control_Participant7     Developing Ciliated Cells
                                                ...            
GCAGGGAACTCC_COVID19_Participant30               Squamous Cells
CAGCACCGAGCC_COVID19_Participant30               Squamous Cells
GCCCCTTGTGAT_COVID19_Participant30               Squamous Cells
GTGTTGTGTGTC_COVID19_Participant30               Squamous Cells
TAACACTCACTT_COVID19_Participant30               Squamous Cells
Name: manual_annotation, Length: 21867, dtype: string
cell type annotation :  GTCGGGGGGTGG_Control_Participant7     Developing Ciliated Cells
CAAATCAATTAT_Control_Participant7     Developing Ciliated Cells
ATACAATTGACA_Control_Participant7     Developing Ciliated Cells
CTGTTAATGAGA_Control_Participant7     Developing Ciliated Cells
CTTCACATTATT_Control_Participant7     Developing Ciliated Cells
                                                ...            
GCAGGGAACTCC_COVID19_Participant30               Squamous Cells
CAGCACCGAGCC_COVID19_Participant30               Squamous Cells
GCCCCTTGTGAT_COVID19_Participant30               Squamous Cells
GTGTTGTGTGTC_COVID19_Participant30               Squamous Cells
TAACACTCACTT_COVID19_Participant30               Squamous Cells
Name: manual_annotation, Length: 21867, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Developing Ciliated Cells', 'Ciliated Cells', 'Secretory Cells', 'Squamous Cells', 'Goblet Cells', 'T Cells', 'Dendritic Cells', 'Basal Cells', 'Deuterosomal Cells', 'Mitotic Basal Cells', 'Macrophages', 'B Cells', 'Ionocytes', 'Developing Secretory and Goblet Cells', 'Plasmacytoid DCs', 'Enteroendocrine Cells', 'Erythroblasts', 'Mast Cells']
라벨별 그룹 개수 {1: 28, 0: 12}
cell type :  CGAATCAAGGCC_COVID19_Participant26    Secretory Cells
ACGCCCTTCAAC_COVID19_Participant26    Secretory Cells
ACCATATTGCTT_COVID19_Participant26     Ciliated Cells
AAACCTCCGGGA_COVID19_Participant26     Ciliated Cells
TACGCGCCGAAC_COVID19_Participant26     Ciliated Cells
                                           ...       
CGCGCCCTAGAC_Control_Participant15       Goblet Cells
CGGACAGAATGG_Control_Participant15     Ciliated Cells
GTTTATTCATCA_Control_Participant15     Ciliated Cells
TTTTTGTACTAT_Control_Participant15     Ciliated Cells
CGATTGTAGATC_Control_Participant15     Ciliated Cells
Name: manual_annotation, Length: 5080, dtype: string
cell type annotation :  CGAATCAAGGCC_COVID19_Participant26    Secretory Cells
ACGCCCTTCAAC_COVID19_Participant26    Secretory Cells
ACCATATTGCTT_COVID19_Participant26     Ciliated Cells
AAACCTCCGGGA_COVID19_Participant26     Ciliated Cells
TACGCGCCGAAC_COVID19_Participant26     Ciliated Cells
                                           ...       
CGCGCCCTAGAC_Control_Participant15       Goblet Cells
CGGACAGAATGG_Control_Participant15     Ciliated Cells
GTTTATTCATCA_Control_Participant15     Ciliated Cells
TTTTTGTACTAT_Control_Participant15     Ciliated Cells
CGATTGTAGATC_Control_Participant15     Ciliated Cells
Name: manual_annotation, Length: 5080, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Secretory Cells', 'Ciliated Cells', 'Squamous Cells', 'Goblet Cells', 'Macrophages', 'Basal Cells', 'Deuterosomal Cells', 'Developing Ciliated Cells', 'Ionocytes', 'Mitotic Basal Cells', 'Enteroendocrine Cells', 'Developing Secretory and Goblet Cells', 'T Cells', 'Dendritic Cells', 'B Cells', 'Mast Cells', 'Erythroblasts', 'Plasmacytoid DCs']
라벨별 그룹 개수 {1: 7, 0: 3}
🔍 Split #3
  → train_p_index 환자 수 (환자 단위로 묶인 index list): 40
  → test_p_index 환자 수  (환자 단위로 묶인 index list): 10
  → train 환자 ID: ['COVID19_Participant10', 'COVID19_Participant12', 'COVID19_Participant13', 'COVID19_Participant14', 'COVID19_Participant15', 'COVID19_Participant17', 'COVID19_Participant18', 'COVID19_Participant20', 'COVID19_Participant21', 'COVID19_Participant23', 'COVID19_Participant25', 'COVID19_Participant27', 'COVID19_Participant28', 'COVID19_Participant29', 'COVID19_Participant30', 'COVID19_Participant31', 'COVID19_Participant32', 'COVID19_Participant35', 'COVID19_Participant36', 'COVID19_Participant37', 'COVID19_Participant38', 'COVID19_Participant39', 'COVID19_Participant4', 'COVID19_Participant40', 'COVID19_Participant5', 'COVID19_Participant6', 'COVID19_Participant8', 'COVID19_Participant9', 'Control_Participant1', 'Control_Participant10', 'Control_Participant11', 'Control_Participant12', 'Control_Participant13', 'Control_Participant14', 'Control_Participant2', 'Control_Participant3', 'Control_Participant5', 'Control_Participant6', 'Control_Participant7', 'Control_Participant9']
  → test  환자 ID: ['COVID19_Participant11', 'COVID19_Participant19', 'COVID19_Participant2', 'COVID19_Participant22', 'COVID19_Participant26', 'COVID19_Participant3', 'COVID19_Participant7', 'Control_Participant15', 'Control_Participant4', 'Control_Participant8']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant10, Label: 1
    ID: COVID19_Participant12, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant18, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant21, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant27, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant30, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant35, Label: 1
    ID: COVID19_Participant36, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant38, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: COVID19_Participant5, Label: 1
    ID: COVID19_Participant6, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: COVID19_Participant9, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant10, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant12, Label: 0
    ID: Control_Participant13, Label: 0
    ID: Control_Participant14, Label: 0
    ID: Control_Participant2, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant6, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant3, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: Control_Participant15, Label: 0
    ID: Control_Participant4, Label: 0
    ID: Control_Participant8, Label: 0
전체 데이터 index 길이 50
label_stat (train 환자 라벨 목록) 갯수 40
train_data에서 환자 단위로, train과 validation 나누기
기존 train_p_index 40
기존 (train) label_stat 40
train-vali 분할 후! 
train y 의 classes : {0, 1} valid y 의 classes : {0, 1} label_stat 의 classes : {0, 1}
train_p_index_ 26
valid_p_index 14
test_p_index 10
→ train 환자 ID 및 라벨:
   총 개수: 26
   환자ID=Control_Participant10, Label=0, 셀개수=1645
   환자ID=Control_Participant14, Label=0, 셀개수=274
   환자ID=COVID19_Participant18, Label=1, 셀개수=227
   환자ID=COVID19_Participant39, Label=1, 셀개수=454
   환자ID=COVID19_Participant10, Label=1, 셀개수=18
   환자ID=Control_Participant5, Label=0, 셀개수=717
   환자ID=COVID19_Participant14, Label=1, 셀개수=382
   환자ID=COVID19_Participant20, Label=1, 셀개수=2033
   환자ID=COVID19_Participant40, Label=1, 셀개수=381
   환자ID=COVID19_Participant13, Label=1, 셀개수=730
   환자ID=COVID19_Participant21, Label=1, 셀개수=39
   환자ID=Control_Participant2, Label=0, 셀개수=41
   환자ID=COVID19_Participant29, Label=1, 셀개수=573
   환자ID=Control_Participant7, Label=0, 셀개수=762
   환자ID=Control_Participant6, Label=0, 셀개수=131
   환자ID=COVID19_Participant15, Label=1, 셀개수=1003
   환자ID=Control_Participant9, Label=0, 셀개수=558
   환자ID=Control_Participant11, Label=0, 셀개수=1164
   환자ID=COVID19_Participant25, Label=1, 셀개수=496
   환자ID=COVID19_Participant32, Label=1, 셀개수=1665
   환자ID=COVID19_Participant28, Label=1, 셀개수=1079
   환자ID=COVID19_Participant17, Label=1, 셀개수=843
   환자ID=COVID19_Participant6, Label=1, 셀개수=84
   환자ID=COVID19_Participant4, Label=1, 셀개수=1680
   환자ID=COVID19_Participant38, Label=1, 셀개수=51
   환자ID=COVID19_Participant31, Label=1, 셀개수=410
→ valid 환자 ID 및 라벨:
   총 개수: 14
   환자ID=Control_Participant13, Label=0, 셀개수=88
   환자ID=COVID19_Participant30, Label=1, 셀개수=116
   환자ID=COVID19_Participant36, Label=1, 셀개수=200
   환자ID=COVID19_Participant35, Label=1, 셀개수=83
   환자ID=COVID19_Participant5, Label=1, 셀개수=89
   환자ID=COVID19_Participant23, Label=1, 셀개수=307
   환자ID=Control_Participant3, Label=0, 셀개수=1620
   환자ID=Control_Participant1, Label=0, 셀개수=414
   환자ID=COVID19_Participant9, Label=1, 셀개수=86
   환자ID=COVID19_Participant8, Label=1, 셀개수=462
   환자ID=Control_Participant12, Label=0, 셀개수=99
   환자ID=COVID19_Participant37, Label=1, 셀개수=668
   환자ID=COVID19_Participant12, Label=1, 셀개수=102
   환자ID=COVID19_Participant27, Label=1, 셀개수=93
→ test 환자 ID 및 라벨:
   총 개수: 10
   환자ID=COVID19_Participant11, Label=1, 셀개수=382
   환자ID=COVID19_Participant19, Label=1, 셀개수=816
   환자ID=COVID19_Participant2, Label=1, 셀개수=329
   환자ID=COVID19_Participant22, Label=1, 셀개수=865
   환자ID=COVID19_Participant26, Label=1, 셀개수=814
   환자ID=COVID19_Participant3, Label=1, 셀개수=104
   환자ID=COVID19_Participant7, Label=1, 셀개수=409
   환자ID=Control_Participant15, Label=0, 셀개수=528
   환자ID=Control_Participant4, Label=0, 셀개수=440
   환자ID=Control_Participant8, Label=0, 셀개수=393
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Ciliated Cells', 'Developing Ciliated Cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
전체 데이터 길이 26947
전체 cell type 길이 0        Developing Ciliated Cells
1        Developing Ciliated Cells
2        Developing Ciliated Cells
3        Developing Ciliated Cells
4        Developing Ciliated Cells
                   ...            
26942                 Goblet Cells
26943               Ciliated Cells
26944               Ciliated Cells
26945               Ciliated Cells
26946               Ciliated Cells
Length: 26947, dtype: string
cell type의 NaN 개수 체크 0
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:12,  7.72it/s]  2%|▏         | 2/100 [00:00<00:11,  8.82it/s]  3%|▎         | 3/100 [00:00<00:11,  8.76it/s]  4%|▍         | 4/100 [00:00<00:16,  5.95it/s]  5%|▌         | 5/100 [00:00<00:14,  6.51it/s]  6%|▌         | 6/100 [00:00<00:13,  7.13it/s]  8%|▊         | 8/100 [00:01<00:11,  8.35it/s]  9%|▉         | 9/100 [00:01<00:11,  7.81it/s] 10%|█         | 10/100 [00:01<00:11,  8.08it/s] 11%|█         | 11/100 [00:01<00:10,  8.33it/s] 12%|█▏        | 12/100 [00:01<00:10,  8.58it/s] 13%|█▎        | 13/100 [00:01<00:10,  7.95it/s] 15%|█▌        | 15/100 [00:01<00:09,  8.54it/s] 17%|█▋        | 17/100 [00:02<00:09,  8.91it/s] 18%|█▊        | 18/100 [00:02<00:09,  8.76it/s] 20%|██        | 20/100 [00:02<00:08,  9.26it/s] 21%|██        | 21/100 [00:02<00:09,  8.22it/s] 22%|██▏       | 22/100 [00:02<00:09,  8.28it/s] 23%|██▎       | 23/100 [00:02<00:09,  8.47it/s] 24%|██▍       | 24/100 [00:02<00:08,  8.74it/s] 26%|██▌       | 26/100 [00:03<00:10,  7.12it/s] 27%|██▋       | 27/100 [00:03<00:09,  7.52it/s] 28%|██▊       | 28/100 [00:03<00:09,  7.92it/s] 29%|██▉       | 29/100 [00:03<00:08,  8.38it/s] 30%|███       | 30/100 [00:03<00:08,  7.92it/s] 31%|███       | 31/100 [00:03<00:08,  7.99it/s] 33%|███▎      | 33/100 [00:04<00:07,  8.70it/s] 34%|███▍      | 34/100 [00:04<00:07,  8.85it/s] 35%|███▌      | 35/100 [00:04<00:11,  5.67it/s] 36%|███▌      | 36/100 [00:04<00:09,  6.42it/s] 37%|███▋      | 37/100 [00:04<00:09,  6.77it/s] 38%|███▊      | 38/100 [00:04<00:09,  6.72it/s] 39%|███▉      | 39/100 [00:04<00:08,  7.36it/s] 40%|████      | 40/100 [00:05<00:08,  7.18it/s] 41%|████      | 41/100 [00:05<00:07,  7.62it/s] 42%|████▏     | 42/100 [00:05<00:07,  8.05it/s] 43%|████▎     | 43/100 [00:05<00:10,  5.41it/s] 44%|████▍     | 44/100 [00:05<00:10,  5.28it/s] 45%|████▌     | 45/100 [00:06<00:09,  5.92it/s] 46%|████▌     | 46/100 [00:06<00:09,  5.56it/s] 47%|████▋     | 47/100 [00:06<00:08,  6.30it/s] 48%|████▊     | 48/100 [00:06<00:07,  7.09it/s] 49%|████▉     | 49/100 [00:06<00:06,  7.65it/s] 50%|█████     | 50/100 [00:06<00:10,  4.83it/s] 51%|█████     | 51/100 [00:07<00:08,  5.54it/s] 52%|█████▏    | 52/100 [00:07<00:07,  6.33it/s] 53%|█████▎    | 53/100 [00:07<00:06,  6.80it/s] 54%|█████▍    | 54/100 [00:07<00:06,  7.27it/s] 55%|█████▌    | 55/100 [00:07<00:05,  7.90it/s] 56%|█████▌    | 56/100 [00:07<00:08,  5.10it/s] 57%|█████▋    | 57/100 [00:07<00:07,  5.75it/s] 58%|█████▊    | 58/100 [00:08<00:06,  6.12it/s] 59%|█████▉    | 59/100 [00:08<00:07,  5.75it/s] 60%|██████    | 60/100 [00:08<00:07,  5.03it/s] 61%|██████    | 61/100 [00:08<00:07,  5.38it/s] 62%|██████▏   | 62/100 [00:08<00:06,  6.24it/s] 63%|██████▎   | 63/100 [00:08<00:05,  6.77it/s] 64%|██████▍   | 64/100 [00:09<00:04,  7.37it/s] 65%|██████▌   | 65/100 [00:09<00:04,  7.78it/s] 67%|██████▋   | 67/100 [00:09<00:03,  8.48it/s] 68%|██████▊   | 68/100 [00:09<00:03,  8.60it/s] 69%|██████▉   | 69/100 [00:09<00:03,  8.74it/s] 70%|███████   | 70/100 [00:10<00:05,  5.05it/s] 71%|███████   | 71/100 [00:10<00:06,  4.50it/s] 72%|███████▏  | 72/100 [00:10<00:05,  5.19it/s] 73%|███████▎  | 73/100 [00:10<00:05,  5.25it/s] 75%|███████▌  | 75/100 [00:10<00:03,  6.60it/s] 76%|███████▌  | 76/100 [00:10<00:03,  6.61it/s] 77%|███████▋  | 77/100 [00:11<00:03,  7.09it/s] 78%|███████▊  | 78/100 [00:11<00:02,  7.62it/s] 79%|███████▉  | 79/100 [00:11<00:02,  7.91it/s] 80%|████████  | 80/100 [00:11<00:02,  7.88it/s] 81%|████████  | 81/100 [00:11<00:02,  8.27it/s] 82%|████████▏ | 82/100 [00:11<00:03,  5.31it/s] 83%|████████▎ | 83/100 [00:12<00:03,  5.07it/s] 84%|████████▍ | 84/100 [00:12<00:03,  4.04it/s] 85%|████████▌ | 85/100 [00:12<00:03,  4.85it/s] 86%|████████▌ | 86/100 [00:12<00:02,  5.65it/s] 87%|████████▋ | 87/100 [00:12<00:02,  5.61it/s] 88%|████████▊ | 88/100 [00:13<00:02,  5.65it/s] 89%|████████▉ | 89/100 [00:13<00:01,  6.45it/s] 91%|█████████ | 91/100 [00:13<00:01,  7.47it/s] 92%|█████████▏| 92/100 [00:13<00:01,  7.75it/s] 93%|█████████▎| 93/100 [00:13<00:00,  7.94it/s] 94%|█████████▍| 94/100 [00:13<00:00,  7.58it/s] 95%|█████████▌| 95/100 [00:13<00:00,  7.32it/s] 96%|█████████▌| 96/100 [00:14<00:00,  7.48it/s] 98%|█████████▊| 98/100 [00:14<00:00,  8.22it/s] 99%|█████████▉| 99/100 [00:14<00:00,  8.11it/s]100%|██████████| 100/100 [00:14<00:00,  7.71it/s]100%|██████████| 100/100 [00:14<00:00,  6.90it/s]
[I 2025-08-30 10:18:04,921] A new study created in memory with name: no-name-390dba06-188b-4d2e-be29-d40b39755fa9
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 27.97 MB
Memory Reserved: 46.00 MB
cuda
Epoch 1, Train Loss 0.650010, Valid_loss 0.583411
Epoch 2, Train Loss 0.600965, Valid_loss 0.521868
Epoch 3, Train Loss 0.548481, Valid_loss 0.432573
Epoch 4, Train Loss 0.488323, Valid_loss 0.394449
Epoch 5, Train Loss 0.433003, Valid_loss 0.364740
Epoch 6, Train Loss 0.404067, Valid_loss 0.331346
Epoch 7, Train Loss 0.424395, Valid_loss 0.318561
Epoch 8, Train Loss 0.391625, Valid_loss 0.318318
Epoch 9, Train Loss 0.376477, Valid_loss 0.301355
Epoch 10, Train Loss 0.338184, Valid_loss 0.345971
Epoch 11, Train Loss 0.318606, Valid_loss 0.302113
Epoch 12, Train Loss 0.319525, Valid_loss 0.348982
Epoch 13, Train Loss 0.315479, Valid_loss 0.308446
Epoch 14, Train Loss 0.331161, Valid_loss 0.312549
Epoch 15, Train Loss 0.393017, Valid_loss 0.297371
Epoch 16, Train Loss 0.330218, Valid_loss 0.298308
Epoch 17, Train Loss 0.328420, Valid_loss 0.288850
Epoch 18, Train Loss 0.303461, Valid_loss 0.364202
Epoch 19, Train Loss 0.311477, Valid_loss 0.287909
Epoch 20, Train Loss 0.278411, Valid_loss 0.295186
Epoch 21, Train Loss 0.281488, Valid_loss 0.407874
Epoch 22, Train Loss 0.290631, Valid_loss 0.320808
Epoch 23, Train Loss 0.305990, Valid_loss 0.310365
Epoch 24, Train Loss 0.288595, Valid_loss 0.297157
Epoch 25, Train Loss 0.285348, Valid_loss 0.282698
Epoch 26, Train Loss 0.279930, Valid_loss 0.283235
Epoch 27, Train Loss 0.281416, Valid_loss 0.290509
Epoch 28, Train Loss 0.261066, Valid_loss 0.318306
Epoch 29, Train Loss 0.294997, Valid_loss 0.293055
Epoch 30, Train Loss 0.280947, Valid_loss 0.269407
Epoch 31, Train Loss 0.274112, Valid_loss 0.284685
Epoch 32, Train Loss 0.263754, Valid_loss 0.281701
Epoch 33, Train Loss 0.278662, Valid_loss 0.338958
Epoch 34, Train Loss 0.286294, Valid_loss 0.299841
Epoch 35, Train Loss 0.257355, Valid_loss 0.291107
Epoch 36, Train Loss 0.259752, Valid_loss 0.334477
Epoch 37, Train Loss 0.267274, Valid_loss 0.319043
Epoch 38, Train Loss 0.255510, Valid_loss 0.304264
Epoch 39, Train Loss 0.261620, Valid_loss 0.270726
Epoch 40, Train Loss 0.268934, Valid_loss 0.378390
Epoch 41, Train Loss 0.287352, Valid_loss 0.361427
Epoch 42, Train Loss 0.274563, Valid_loss 0.321607
Epoch 43, Train Loss 0.271632, Valid_loss 0.325873
Epoch 44, Train Loss 0.269372, Valid_loss 0.291499
Epoch 45, Train Loss 0.248934, Valid_loss 0.338275
Epoch 46, Train Loss 0.258411, Valid_loss 0.345227
Epoch 47, Train Loss 0.255653, Valid_loss 0.326002
Epoch 48, Train Loss 0.266488, Valid_loss 0.296458
Epoch 49, Train Loss 0.255305, Valid_loss 0.313881
Epoch 50, Train Loss 0.270629, Valid_loss 0.275926
Epoch 51, Train Loss 0.254870, Valid_loss 0.309420
Epoch 52, Train Loss 0.253230, Valid_loss 0.314311
[I 2025-08-30 10:21:43,678] Trial 0 finished with value: 0.26940687133797575 and parameters: {'learning_rate': 0.001, 'epochs': 100, 'heads': 2, 'dropout': 0.7, 'weight_decay': 0.01, 'emb_dim': 64, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.26940687133797575.
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 27.97 MB
Memory Reserved: 46.00 MB
cuda
Epoch 1, Train Loss 0.634727, Valid_loss 0.587878
Epoch 2, Train Loss 0.607237, Valid_loss 0.552212
Epoch 3, Train Loss 0.542365, Valid_loss 0.427885
Epoch 4, Train Loss 0.461849, Valid_loss 0.383107
Epoch 5, Train Loss 0.435018, Valid_loss 0.356413
Epoch 6, Train Loss 0.349979, Valid_loss 0.343963
Epoch 7, Train Loss 0.417089, Valid_loss 0.385021
Epoch 8, Train Loss 0.364303, Valid_loss 0.312674
Epoch 9, Train Loss 0.333656, Valid_loss 0.342774
Epoch 10, Train Loss 0.331905, Valid_loss 0.363095
Epoch 11, Train Loss 0.332977, Valid_loss 0.376307
Epoch 12, Train Loss 0.275374, Valid_loss 0.328130
Epoch 13, Train Loss 0.293723, Valid_loss 0.320405
Epoch 14, Train Loss 0.282889, Valid_loss 0.318073
Epoch 15, Train Loss 0.286793, Valid_loss 0.320713
Epoch 16, Train Loss 0.285338, Valid_loss 0.354088
Epoch 17, Train Loss 0.268772, Valid_loss 0.345765
Epoch 18, Train Loss 0.263097, Valid_loss 0.294776
Epoch 19, Train Loss 0.264611, Valid_loss 0.316880
Epoch 20, Train Loss 0.255982, Valid_loss 0.328181
Epoch 21, Train Loss 0.266695, Valid_loss 0.297153
Epoch 22, Train Loss 0.275411, Valid_loss 0.305886
Epoch 23, Train Loss 0.244503, Valid_loss 0.274960
Epoch 24, Train Loss 0.243933, Valid_loss 0.289872
Epoch 25, Train Loss 0.243839, Valid_loss 0.292639
Epoch 26, Train Loss 0.230852, Valid_loss 0.277512
Epoch 27, Train Loss 0.238817, Valid_loss 0.287917
Epoch 28, Train Loss 0.225412, Valid_loss 0.350238
Epoch 29, Train Loss 0.234655, Valid_loss 0.318722
Epoch 30, Train Loss 0.231769, Valid_loss 0.300324
Epoch 31, Train Loss 0.216308, Valid_loss 0.314473
Epoch 32, Train Loss 0.231882, Valid_loss 0.332950
Epoch 33, Train Loss 0.212653, Valid_loss 0.349553
Epoch 34, Train Loss 0.228720, Valid_loss 0.287915
Epoch 35, Train Loss 0.232568, Valid_loss 0.368948
Epoch 36, Train Loss 0.206997, Valid_loss 0.318471
Epoch 37, Train Loss 0.235910, Valid_loss 0.349783
Epoch 38, Train Loss 0.218914, Valid_loss 0.297949
Epoch 39, Train Loss 0.217579, Valid_loss 0.329423
Epoch 40, Train Loss 0.227080, Valid_loss 0.362132
Epoch 41, Train Loss 0.209815, Valid_loss 0.325200
Epoch 42, Train Loss 0.216779, Valid_loss 0.400936
Epoch 43, Train Loss 0.246881, Valid_loss 0.320627
Epoch 44, Train Loss 0.243315, Valid_loss 0.338640
Epoch 45, Train Loss 0.215940, Valid_loss 0.286599
Epoch 46, Train Loss 0.228257, Valid_loss 0.401094
Epoch 47, Train Loss 0.240555, Valid_loss 0.295156
Epoch 48, Train Loss 0.231546, Valid_loss 0.399230
Epoch 49, Train Loss 0.208667, Valid_loss 0.314969
Epoch 50, Train Loss 0.202346, Valid_loss 0.338525
Epoch 51, Train Loss 0.202569, Valid_loss 0.289361
Epoch 52, Train Loss 0.202110, Valid_loss 0.322294
Epoch 53, Train Loss 0.206241, Valid_loss 0.280557
Epoch 54, Train Loss 0.206262, Valid_loss 0.283571
Epoch 55, Train Loss 0.201037, Valid_loss 0.275634
Epoch 56, Train Loss 0.191697, Valid_loss 0.293801
Epoch 57, Train Loss 0.199436, Valid_loss 0.279830
Epoch 58, Train Loss 0.196113, Valid_loss 0.266517
Epoch 59, Train Loss 0.199961, Valid_loss 0.287549
Epoch 60, Train Loss 0.195204, Valid_loss 0.258243
Epoch 61, Train Loss 0.193463, Valid_loss 0.335994
Epoch 62, Train Loss 0.194213, Valid_loss 0.271083
Epoch 63, Train Loss 0.188151, Valid_loss 0.361554
Epoch 64, Train Loss 0.193646, Valid_loss 0.273160
Epoch 65, Train Loss 0.185262, Valid_loss 0.310630
Epoch 66, Train Loss 0.198695, Valid_loss 0.264423
Epoch 67, Train Loss 0.203552, Valid_loss 0.325987
Epoch 68, Train Loss 0.188751, Valid_loss 0.346508
[I 2025-08-30 10:27:12,846] Trial 1 finished with value: 0.2582432782343988 and parameters: {'learning_rate': 0.001, 'epochs': 100, 'heads': 4, 'dropout': 0.7, 'weight_decay': 0.0001, 'emb_dim': 64, 'augment_num': 100, 'pca': False}. Best is trial 1 with value: 0.2582432782343988.
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 27.97 MB
Memory Reserved: 46.00 MB
cuda
Epoch 1, Train Loss 0.588912, Valid_loss 0.554493
Epoch 2, Train Loss 0.517211, Valid_loss 0.513117
Epoch 3, Train Loss 0.444401, Valid_loss 0.373090
Epoch 4, Train Loss 0.375288, Valid_loss 0.326190
Epoch 5, Train Loss 0.346787, Valid_loss 0.296167
Epoch 6, Train Loss 0.298551, Valid_loss 0.308261
Epoch 7, Train Loss 0.277236, Valid_loss 0.305321
Epoch 8, Train Loss 0.260356, Valid_loss 0.290761
Epoch 9, Train Loss 0.290252, Valid_loss 0.346971
Epoch 10, Train Loss 0.290265, Valid_loss 0.356930
Epoch 11, Train Loss 0.253946, Valid_loss 0.324188
Epoch 12, Train Loss 0.256048, Valid_loss 0.315945
Epoch 13, Train Loss 0.264750, Valid_loss 0.314319
Epoch 14, Train Loss 0.250125, Valid_loss 0.313054
Epoch 15, Train Loss 0.225597, Valid_loss 0.320082
Epoch 16, Train Loss 0.228223, Valid_loss 0.293595
Epoch 17, Train Loss 0.218224, Valid_loss 0.304951
Epoch 18, Train Loss 0.221625, Valid_loss 0.324243
Epoch 19, Train Loss 0.219105, Valid_loss 0.319584
Epoch 20, Train Loss 0.224979, Valid_loss 0.385173
Epoch 21, Train Loss 0.257505, Valid_loss 0.438436
Epoch 22, Train Loss 0.230286, Valid_loss 0.325679
Epoch 23, Train Loss 0.223033, Valid_loss 0.326468
Epoch 24, Train Loss 0.212917, Valid_loss 0.308686
Epoch 25, Train Loss 0.209350, Valid_loss 0.336977
Epoch 26, Train Loss 0.207806, Valid_loss 0.309025
Epoch 27, Train Loss 0.192306, Valid_loss 0.350867
Epoch 28, Train Loss 0.204883, Valid_loss 0.306572
Epoch 29, Train Loss 0.215723, Valid_loss 0.312309
Epoch 30, Train Loss 0.206898, Valid_loss 0.301112
Epoch 31, Train Loss 0.199333, Valid_loss 0.284282
Epoch 32, Train Loss 0.192574, Valid_loss 0.265365
Epoch 33, Train Loss 0.191034, Valid_loss 0.274350
Epoch 34, Train Loss 0.186236, Valid_loss 0.282421
Epoch 35, Train Loss 0.191572, Valid_loss 0.294951
Epoch 36, Train Loss 0.195877, Valid_loss 0.335017
Epoch 37, Train Loss 0.199064, Valid_loss 0.297254
Epoch 38, Train Loss 0.203230, Valid_loss 0.296374
Epoch 39, Train Loss 0.189290, Valid_loss 0.268766
Epoch 40, Train Loss 0.191941, Valid_loss 0.262987
Epoch 41, Train Loss 0.191779, Valid_loss 0.344200
Epoch 42, Train Loss 0.184635, Valid_loss 0.274542
Epoch 43, Train Loss 0.188903, Valid_loss 0.334060
Epoch 44, Train Loss 0.199119, Valid_loss 0.263651
Epoch 45, Train Loss 0.190052, Valid_loss 0.246140
Epoch 46, Train Loss 0.190734, Valid_loss 0.250083
Epoch 47, Train Loss 0.185329, Valid_loss 0.285327
Epoch 48, Train Loss 0.188398, Valid_loss 0.375264
Epoch 49, Train Loss 0.182795, Valid_loss 0.259178
Epoch 50, Train Loss 0.182023, Valid_loss 0.268393
Epoch 51, Train Loss 0.185034, Valid_loss 0.265539
Epoch 52, Train Loss 0.187812, Valid_loss 0.353142
Epoch 53, Train Loss 0.182630, Valid_loss 0.311794
Epoch 54, Train Loss 0.179202, Valid_loss 0.258982
Epoch 55, Train Loss 0.184437, Valid_loss 0.257906
Epoch 56, Train Loss 0.185879, Valid_loss 0.252965
Epoch 57, Train Loss 0.177420, Valid_loss 0.402442
Epoch 58, Train Loss 0.178971, Valid_loss 0.250416
Epoch 59, Train Loss 0.186900, Valid_loss 0.268816
Epoch 60, Train Loss 0.182599, Valid_loss 0.300909
[I 2025-08-30 10:32:03,586] Trial 2 finished with value: 0.24613987153861672 and parameters: {'learning_rate': 0.001, 'epochs': 100, 'heads': 4, 'dropout': 0.3, 'weight_decay': 0.001, 'emb_dim': 64, 'augment_num': 100, 'pca': False}. Best is trial 2 with value: 0.24613987153861672.
선택된 trial params: {'learning_rate': 0.001, 'epochs': 100, 'heads': 4, 'dropout': 0.3, 'weight_decay': 0.001, 'emb_dim': 64, 'augment_num': 100, 'pca': False}
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=10, batch_size=1 -> steps=10
output_class :  1
Memory Allocated: 27.97 MB
Memory Reserved: 46.00 MB
cuda
Epoch 1, Train Loss 0.595640, Valid_loss 0.487534
Epoch 2, Train Loss 0.453006, Valid_loss 0.349323
Epoch 3, Train Loss 0.433979, Valid_loss 0.357381
Epoch 4, Train Loss 0.363549, Valid_loss 0.332169
Epoch 5, Train Loss 0.330735, Valid_loss 0.290440
Epoch 6, Train Loss 0.318844, Valid_loss 0.290287
Epoch 7, Train Loss 0.298884, Valid_loss 0.284254
Epoch 8, Train Loss 0.270738, Valid_loss 0.294732
Epoch 9, Train Loss 0.269764, Valid_loss 0.390508
Epoch 10, Train Loss 0.266279, Valid_loss 0.309072
Epoch 11, Train Loss 0.250354, Valid_loss 0.313996
Epoch 12, Train Loss 0.267038, Valid_loss 0.332894
Epoch 13, Train Loss 0.266666, Valid_loss 0.341389
Epoch 14, Train Loss 0.251546, Valid_loss 0.312800
Epoch 15, Train Loss 0.230450, Valid_loss 0.323870
Epoch 16, Train Loss 0.232654, Valid_loss 0.303605
Epoch 17, Train Loss 0.236753, Valid_loss 0.335537
Epoch 18, Train Loss 0.234416, Valid_loss 0.332930
Epoch 19, Train Loss 0.229103, Valid_loss 0.325093
Epoch 20, Train Loss 0.216364, Valid_loss 0.346270
Epoch 21, Train Loss 0.231057, Valid_loss 0.380556
Epoch 22, Train Loss 0.229117, Valid_loss 0.327136
Epoch 23, Train Loss 0.211904, Valid_loss 0.294995
Epoch 24, Train Loss 0.217645, Valid_loss 0.309913
Epoch 25, Train Loss 0.209677, Valid_loss 0.341054
Epoch 26, Train Loss 0.202375, Valid_loss 0.350756
Epoch 27, Train Loss 0.207582, Valid_loss 0.312906
Epoch 28, Train Loss 0.202100, Valid_loss 0.308760
Epoch 29, Train Loss 0.201934, Valid_loss 0.282958
Epoch 30, Train Loss 0.205053, Valid_loss 0.339161
Epoch 31, Train Loss 0.203137, Valid_loss 0.305635
Epoch 32, Train Loss 0.195966, Valid_loss 0.271117
Epoch 33, Train Loss 0.203063, Valid_loss 0.268702
Epoch 34, Train Loss 0.202957, Valid_loss 0.271922
Epoch 35, Train Loss 0.193673, Valid_loss 0.298067
Epoch 36, Train Loss 0.182941, Valid_loss 0.313759
Epoch 37, Train Loss 0.185934, Valid_loss 0.322213
Epoch 38, Train Loss 0.192281, Valid_loss 0.289297
Epoch 39, Train Loss 0.180615, Valid_loss 0.284888
Epoch 40, Train Loss 0.185891, Valid_loss 0.310525
Epoch 41, Train Loss 0.189646, Valid_loss 0.363877
Epoch 42, Train Loss 0.198148, Valid_loss 0.316181
Epoch 43, Train Loss 0.206405, Valid_loss 0.378753
Epoch 44, Train Loss 0.210965, Valid_loss 0.271441
Epoch 45, Train Loss 0.197949, Valid_loss 0.286926
Epoch 46, Train Loss 0.199795, Valid_loss 0.421440
Epoch 47, Train Loss 0.225838, Valid_loss 0.363427
Epoch 48, Train Loss 0.238487, Valid_loss 0.376671
Epoch 49, Train Loss 0.222370, Valid_loss 0.422499
Epoch 50, Train Loss 0.227866, Valid_loss 0.425179
Epoch 51, Train Loss 0.200402, Valid_loss 0.328257
Epoch 52, Train Loss 0.189718, Valid_loss 0.380299
Epoch 53, Train Loss 0.190616, Valid_loss 0.318401
Epoch 54, Train Loss 0.190167, Valid_loss 0.330390
Epoch 55, Train Loss 0.183896, Valid_loss 0.318049
Epoch 56, Train Loss 0.184052, Valid_loss 0.324939
Epoch 57, Train Loss 0.181265, Valid_loss 0.318371
Epoch 58, Train Loss 0.186755, Valid_loss 0.284604
Epoch 59, Train Loss 0.184746, Valid_loss 0.319732
Epoch 60, Train Loss 0.182407, Valid_loss 0.344833
환자ID=COVID19_Participant11 -- true: 1 -- pred: 1
환자ID=COVID19_Participant19 -- true: 1 -- pred: 1
환자ID=COVID19_Participant2 -- true: 1 -- pred: 1
환자ID=COVID19_Participant22 -- true: 1 -- pred: 1
환자ID=COVID19_Participant26 -- true: 1 -- pred: 1
환자ID=COVID19_Participant3 -- true: 1 -- pred: 1
환자ID=COVID19_Participant7 -- true: 1 -- pred: 1
환자ID=Control_Participant15 -- true: 0 -- pred: 0
환자ID=Control_Participant4 -- true: 0 -- pred: 0
환자ID=Control_Participant8 -- true: 0 -- pred: 0
Best performance: Epoch 33, Loss 0.203063, Test ACC 1.000000, Test AUC 1.000000, Test Recall 1.000000, Test Precision 1.000000
Confusion Matrix:
 [3 0 0 7]
✅ Total valid splits used: 3
🔁 Repeat 4, Fold 3
cell type :  GTCGGGGGGTGG_Control_Participant7     Developing Ciliated Cells
CAAATCAATTAT_Control_Participant7     Developing Ciliated Cells
ATACAATTGACA_Control_Participant7     Developing Ciliated Cells
CTGTTAATGAGA_Control_Participant7     Developing Ciliated Cells
CTTCACATTATT_Control_Participant7     Developing Ciliated Cells
                                                ...            
GCAGGGAACTCC_COVID19_Participant30               Squamous Cells
CAGCACCGAGCC_COVID19_Participant30               Squamous Cells
GCCCCTTGTGAT_COVID19_Participant30               Squamous Cells
GTGTTGTGTGTC_COVID19_Participant30               Squamous Cells
TAACACTCACTT_COVID19_Participant30               Squamous Cells
Name: manual_annotation, Length: 22140, dtype: string
cell type annotation :  GTCGGGGGGTGG_Control_Participant7     Developing Ciliated Cells
CAAATCAATTAT_Control_Participant7     Developing Ciliated Cells
ATACAATTGACA_Control_Participant7     Developing Ciliated Cells
CTGTTAATGAGA_Control_Participant7     Developing Ciliated Cells
CTTCACATTATT_Control_Participant7     Developing Ciliated Cells
                                                ...            
GCAGGGAACTCC_COVID19_Participant30               Squamous Cells
CAGCACCGAGCC_COVID19_Participant30               Squamous Cells
GCCCCTTGTGAT_COVID19_Participant30               Squamous Cells
GTGTTGTGTGTC_COVID19_Participant30               Squamous Cells
TAACACTCACTT_COVID19_Participant30               Squamous Cells
Name: manual_annotation, Length: 22140, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Developing Ciliated Cells', 'Ciliated Cells', 'Secretory Cells', 'Squamous Cells', 'Goblet Cells', 'T Cells', 'Dendritic Cells', 'Basal Cells', 'Deuterosomal Cells', 'Mitotic Basal Cells', 'Macrophages', 'B Cells', 'Ionocytes', 'Developing Secretory and Goblet Cells', 'Plasmacytoid DCs', 'Enteroendocrine Cells', 'Erythroblasts', 'Mast Cells']
라벨별 그룹 개수 {1: 28, 0: 12}
cell type :  TGTTTGCATTAA_Control_Participant3                Ciliated Cells
AAACGCAAATTG_Control_Participant3                Ciliated Cells
ACTTTCAGGACG_Control_Participant3                Ciliated Cells
CTTTTACTTTTT_Control_Participant3     Developing Ciliated Cells
GAATTATCAGGA_Control_Participant3                Ciliated Cells
                                                ...            
ACCATATTCAGG_COVID19_Participant21    Developing Ciliated Cells
GCCCGTTTCACG_COVID19_Participant21              Secretory Cells
TATTATCTCTTA_COVID19_Participant21    Developing Ciliated Cells
TTCCGTTTGTCC_COVID19_Participant21                 Goblet Cells
TCGGGATTGGAT_COVID19_Participant21               Ciliated Cells
Name: manual_annotation, Length: 4807, dtype: string
cell type annotation :  TGTTTGCATTAA_Control_Participant3                Ciliated Cells
AAACGCAAATTG_Control_Participant3                Ciliated Cells
ACTTTCAGGACG_Control_Participant3                Ciliated Cells
CTTTTACTTTTT_Control_Participant3     Developing Ciliated Cells
GAATTATCAGGA_Control_Participant3                Ciliated Cells
                                                ...            
ACCATATTCAGG_COVID19_Participant21    Developing Ciliated Cells
GCCCGTTTCACG_COVID19_Participant21              Secretory Cells
TATTATCTCTTA_COVID19_Participant21    Developing Ciliated Cells
TTCCGTTTGTCC_COVID19_Participant21                 Goblet Cells
TCGGGATTGGAT_COVID19_Participant21               Ciliated Cells
Name: manual_annotation, Length: 4807, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Ciliated Cells', 'Developing Ciliated Cells', 'Enteroendocrine Cells', 'Squamous Cells', 'Deuterosomal Cells', 'Macrophages', 'Developing Secretory and Goblet Cells', 'Mitotic Basal Cells', 'Ionocytes', 'Goblet Cells', 'Basal Cells', 'Dendritic Cells', 'T Cells', 'Erythroblasts', 'Secretory Cells', 'Plasmacytoid DCs', 'B Cells', 'Mast Cells']
라벨별 그룹 개수 {1: 7, 0: 3}
🔍 Split #4
  → train_p_index 환자 수 (환자 단위로 묶인 index list): 40
  → test_p_index 환자 수  (환자 단위로 묶인 index list): 10
  → train 환자 ID: ['COVID19_Participant10', 'COVID19_Participant11', 'COVID19_Participant13', 'COVID19_Participant15', 'COVID19_Participant18', 'COVID19_Participant19', 'COVID19_Participant2', 'COVID19_Participant20', 'COVID19_Participant22', 'COVID19_Participant23', 'COVID19_Participant25', 'COVID19_Participant26', 'COVID19_Participant27', 'COVID19_Participant28', 'COVID19_Participant29', 'COVID19_Participant3', 'COVID19_Participant30', 'COVID19_Participant31', 'COVID19_Participant32', 'COVID19_Participant36', 'COVID19_Participant38', 'COVID19_Participant39', 'COVID19_Participant4', 'COVID19_Participant5', 'COVID19_Participant6', 'COVID19_Participant7', 'COVID19_Participant8', 'COVID19_Participant9', 'Control_Participant1', 'Control_Participant10', 'Control_Participant11', 'Control_Participant12', 'Control_Participant13', 'Control_Participant14', 'Control_Participant15', 'Control_Participant2', 'Control_Participant4', 'Control_Participant5', 'Control_Participant7', 'Control_Participant8']
  → test  환자 ID: ['COVID19_Participant12', 'COVID19_Participant14', 'COVID19_Participant17', 'COVID19_Participant21', 'COVID19_Participant35', 'COVID19_Participant37', 'COVID19_Participant40', 'Control_Participant3', 'Control_Participant6', 'Control_Participant9']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant10, Label: 1
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant18, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant27, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant3, Label: 1
    ID: COVID19_Participant30, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant36, Label: 1
    ID: COVID19_Participant38, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant5, Label: 1
    ID: COVID19_Participant6, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: COVID19_Participant9, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant10, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant12, Label: 0
    ID: Control_Participant13, Label: 0
    ID: Control_Participant14, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant2, Label: 0
    ID: Control_Participant4, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant8, Label: 0
  → test 환자 ID 및 라벨:
    ID: COVID19_Participant12, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant21, Label: 1
    ID: COVID19_Participant35, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: Control_Participant3, Label: 0
    ID: Control_Participant6, Label: 0
    ID: Control_Participant9, Label: 0
전체 데이터 index 길이 50
label_stat (train 환자 라벨 목록) 갯수 40
train_data에서 환자 단위로, train과 validation 나누기
기존 train_p_index 40
기존 (train) label_stat 40
train-vali 분할 후! 
train y 의 classes : {0, 1} valid y 의 classes : {0, 1} label_stat 의 classes : {0, 1}
train_p_index_ 26
valid_p_index 14
test_p_index 10
→ train 환자 ID 및 라벨:
   총 개수: 26
   환자ID=Control_Participant10, Label=0, 셀개수=1645
   환자ID=Control_Participant14, Label=0, 셀개수=274
   환자ID=COVID19_Participant2, Label=1, 셀개수=329
   환자ID=COVID19_Participant39, Label=1, 셀개수=454
   환자ID=COVID19_Participant10, Label=1, 셀개수=18
   환자ID=Control_Participant4, Label=0, 셀개수=440
   환자ID=COVID19_Participant15, Label=1, 셀개수=1003
   환자ID=COVID19_Participant20, Label=1, 셀개수=2033
   환자ID=COVID19_Participant5, Label=1, 셀개수=89
   환자ID=COVID19_Participant13, Label=1, 셀개수=730
   환자ID=COVID19_Participant22, Label=1, 셀개수=865
   환자ID=Control_Participant15, Label=0, 셀개수=528
   환자ID=COVID19_Participant28, Label=1, 셀개수=1079
   환자ID=Control_Participant7, Label=0, 셀개수=762
   환자ID=Control_Participant5, Label=0, 셀개수=717
   환자ID=COVID19_Participant18, Label=1, 셀개수=227
   환자ID=Control_Participant8, Label=0, 셀개수=393
   환자ID=Control_Participant11, Label=0, 셀개수=1164
   환자ID=COVID19_Participant25, Label=1, 셀개수=496
   환자ID=COVID19_Participant30, Label=1, 셀개수=116
   환자ID=COVID19_Participant27, Label=1, 셀개수=93
   환자ID=COVID19_Participant19, Label=1, 셀개수=816
   환자ID=COVID19_Participant7, Label=1, 셀개수=409
   환자ID=COVID19_Participant4, Label=1, 셀개수=1680
   환자ID=COVID19_Participant38, Label=1, 셀개수=51
   환자ID=COVID19_Participant3, Label=1, 셀개수=104
→ valid 환자 ID 및 라벨:
   총 개수: 14
   환자ID=Control_Participant13, Label=0, 셀개수=88
   환자ID=COVID19_Participant29, Label=1, 셀개수=573
   환자ID=COVID19_Participant32, Label=1, 셀개수=1665
   환자ID=COVID19_Participant31, Label=1, 셀개수=410
   환자ID=COVID19_Participant6, Label=1, 셀개수=84
   환자ID=COVID19_Participant23, Label=1, 셀개수=307
   환자ID=Control_Participant2, Label=0, 셀개수=41
   환자ID=Control_Participant1, Label=0, 셀개수=414
   환자ID=COVID19_Participant9, Label=1, 셀개수=86
   환자ID=COVID19_Participant8, Label=1, 셀개수=462
   환자ID=Control_Participant12, Label=0, 셀개수=99
   환자ID=COVID19_Participant36, Label=1, 셀개수=200
   환자ID=COVID19_Participant11, Label=1, 셀개수=382
   환자ID=COVID19_Participant26, Label=1, 셀개수=814
→ test 환자 ID 및 라벨:
   총 개수: 10
   환자ID=COVID19_Participant12, Label=1, 셀개수=102
   환자ID=COVID19_Participant14, Label=1, 셀개수=382
   환자ID=COVID19_Participant17, Label=1, 셀개수=843
   환자ID=COVID19_Participant21, Label=1, 셀개수=39
   환자ID=COVID19_Participant35, Label=1, 셀개수=83
   환자ID=COVID19_Participant37, Label=1, 셀개수=668
   환자ID=COVID19_Participant40, Label=1, 셀개수=381
   환자ID=Control_Participant3, Label=0, 셀개수=1620
   환자ID=Control_Participant6, Label=0, 셀개수=131
   환자ID=Control_Participant9, Label=0, 셀개수=558
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Developing Ciliated Cells', 'Ciliated Cells', 'Developing Ciliated Cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
전체 데이터 길이 26947
전체 cell type 길이 0        Developing Ciliated Cells
1        Developing Ciliated Cells
2        Developing Ciliated Cells
3        Developing Ciliated Cells
4        Developing Ciliated Cells
                   ...            
26942    Developing Ciliated Cells
26943              Secretory Cells
26944    Developing Ciliated Cells
26945                 Goblet Cells
26946               Ciliated Cells
Length: 26947, dtype: string
cell type의 NaN 개수 체크 0
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:18,  5.44it/s]  2%|▏         | 2/100 [00:00<00:13,  7.28it/s]  3%|▎         | 3/100 [00:00<00:12,  7.81it/s]  4%|▍         | 4/100 [00:00<00:11,  8.49it/s]  5%|▌         | 5/100 [00:00<00:12,  7.74it/s]  6%|▌         | 6/100 [00:00<00:11,  8.38it/s]  7%|▋         | 7/100 [00:00<00:10,  8.74it/s]  8%|▊         | 8/100 [00:00<00:10,  8.51it/s]  9%|▉         | 9/100 [00:01<00:10,  8.82it/s] 10%|█         | 10/100 [00:01<00:09,  9.11it/s] 12%|█▏        | 12/100 [00:01<00:10,  8.46it/s] 13%|█▎        | 13/100 [00:01<00:11,  7.46it/s] 14%|█▍        | 14/100 [00:01<00:14,  5.96it/s] 15%|█▌        | 15/100 [00:01<00:12,  6.63it/s] 16%|█▌        | 16/100 [00:02<00:13,  6.43it/s] 17%|█▋        | 17/100 [00:02<00:12,  6.86it/s] 18%|█▊        | 18/100 [00:02<00:12,  6.68it/s] 19%|█▉        | 19/100 [00:02<00:11,  7.26it/s] 20%|██        | 20/100 [00:02<00:10,  7.75it/s] 21%|██        | 21/100 [00:02<00:09,  8.27it/s] 22%|██▏       | 22/100 [00:02<00:09,  8.46it/s] 23%|██▎       | 23/100 [00:02<00:08,  8.77it/s] 24%|██▍       | 24/100 [00:03<00:09,  8.38it/s] 25%|██▌       | 25/100 [00:03<00:09,  7.89it/s] 26%|██▌       | 26/100 [00:03<00:09,  7.47it/s] 27%|██▋       | 27/100 [00:03<00:09,  7.95it/s] 29%|██▉       | 29/100 [00:03<00:08,  8.81it/s] 30%|███       | 30/100 [00:03<00:07,  8.98it/s] 31%|███       | 31/100 [00:03<00:07,  9.10it/s] 32%|███▏      | 32/100 [00:04<00:07,  8.58it/s] 33%|███▎      | 33/100 [00:04<00:10,  6.37it/s] 34%|███▍      | 34/100 [00:04<00:09,  6.96it/s] 36%|███▌      | 36/100 [00:04<00:07,  8.11it/s] 37%|███▋      | 37/100 [00:04<00:08,  7.49it/s] 38%|███▊      | 38/100 [00:04<00:08,  7.72it/s] 39%|███▉      | 39/100 [00:05<00:07,  8.03it/s] 40%|████      | 40/100 [00:05<00:07,  8.45it/s] 41%|████      | 41/100 [00:05<00:06,  8.54it/s] 42%|████▏     | 42/100 [00:05<00:07,  7.45it/s] 43%|████▎     | 43/100 [00:05<00:07,  8.01it/s] 45%|████▌     | 45/100 [00:05<00:06,  9.07it/s] 46%|████▌     | 46/100 [00:05<00:05,  9.15it/s] 47%|████▋     | 47/100 [00:05<00:05,  9.28it/s] 48%|████▊     | 48/100 [00:06<00:07,  6.74it/s] 49%|████▉     | 49/100 [00:06<00:09,  5.57it/s] 51%|█████     | 51/100 [00:06<00:07,  6.92it/s] 52%|█████▏    | 52/100 [00:06<00:06,  7.40it/s] 53%|█████▎    | 53/100 [00:06<00:07,  6.59it/s] 54%|█████▍    | 54/100 [00:07<00:08,  5.53it/s] 55%|█████▌    | 55/100 [00:07<00:07,  6.22it/s] 56%|█████▌    | 56/100 [00:07<00:08,  5.32it/s] 57%|█████▋    | 57/100 [00:07<00:07,  6.11it/s] 59%|█████▉    | 59/100 [00:07<00:05,  7.21it/s] 60%|██████    | 60/100 [00:08<00:06,  6.61it/s] 62%|██████▏   | 62/100 [00:08<00:05,  7.59it/s] 63%|██████▎   | 63/100 [00:08<00:04,  7.58it/s] 64%|██████▍   | 64/100 [00:08<00:06,  5.71it/s] 65%|██████▌   | 65/100 [00:08<00:05,  6.31it/s] 67%|██████▋   | 67/100 [00:09<00:04,  6.85it/s] 68%|██████▊   | 68/100 [00:09<00:05,  6.22it/s] 69%|██████▉   | 69/100 [00:09<00:04,  6.73it/s] 70%|███████   | 70/100 [00:09<00:04,  7.31it/s] 71%|███████   | 71/100 [00:09<00:03,  7.83it/s] 72%|███████▏  | 72/100 [00:09<00:03,  7.83it/s] 73%|███████▎  | 73/100 [00:09<00:03,  8.30it/s] 74%|███████▍  | 74/100 [00:09<00:03,  8.08it/s] 75%|███████▌  | 75/100 [00:10<00:03,  8.25it/s] 76%|███████▌  | 76/100 [00:10<00:02,  8.47it/s] 77%|███████▋  | 77/100 [00:10<00:02,  8.57it/s] 78%|███████▊  | 78/100 [00:10<00:04,  5.32it/s] 79%|███████▉  | 79/100 [00:10<00:03,  5.90it/s] 80%|████████  | 80/100 [00:10<00:03,  6.51it/s] 81%|████████  | 81/100 [00:11<00:02,  7.08it/s] 82%|████████▏ | 82/100 [00:11<00:02,  7.59it/s] 83%|████████▎ | 83/100 [00:11<00:02,  8.01it/s] 84%|████████▍ | 84/100 [00:11<00:01,  8.23it/s] 85%|████████▌ | 85/100 [00:11<00:01,  7.89it/s] 86%|████████▌ | 86/100 [00:11<00:02,  6.31it/s] 87%|████████▋ | 87/100 [00:11<00:01,  6.95it/s] 88%|████████▊ | 88/100 [00:11<00:01,  7.55it/s] 89%|████████▉ | 89/100 [00:12<00:01,  8.05it/s] 90%|█████████ | 90/100 [00:12<00:01,  8.54it/s] 91%|█████████ | 91/100 [00:12<00:01,  8.66it/s] 92%|█████████▏| 92/100 [00:12<00:00,  8.81it/s] 93%|█████████▎| 93/100 [00:12<00:00,  8.88it/s] 94%|█████████▍| 94/100 [00:12<00:00,  8.49it/s] 95%|█████████▌| 95/100 [00:12<00:00,  8.52it/s] 96%|█████████▌| 96/100 [00:12<00:00,  8.07it/s] 98%|█████████▊| 98/100 [00:13<00:00,  8.85it/s] 99%|█████████▉| 99/100 [00:13<00:00,  9.06it/s]100%|██████████| 100/100 [00:13<00:00,  9.19it/s]100%|██████████| 100/100 [00:13<00:00,  7.53it/s]
[I 2025-08-30 10:37:09,665] A new study created in memory with name: no-name-f13e8f07-3a38-4011-92ae-7d8109179646
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 46.00 MB
cuda
Epoch 1, Train Loss 0.851311, Valid_loss 0.760589
Epoch 2, Train Loss 0.776961, Valid_loss 0.744372
Epoch 3, Train Loss 0.755977, Valid_loss 0.730798
Epoch 4, Train Loss 0.739701, Valid_loss 0.718129
Epoch 5, Train Loss 0.722903, Valid_loss 0.704769
Epoch 6, Train Loss 0.716941, Valid_loss 0.692129
Epoch 7, Train Loss 0.697376, Valid_loss 0.681824
Epoch 8, Train Loss 0.682585, Valid_loss 0.671329
Epoch 9, Train Loss 0.688577, Valid_loss 0.661796
Epoch 10, Train Loss 0.677380, Valid_loss 0.653373
Epoch 11, Train Loss 0.674928, Valid_loss 0.647629
Epoch 12, Train Loss 0.667059, Valid_loss 0.640650
Epoch 13, Train Loss 0.649061, Valid_loss 0.626565
Epoch 14, Train Loss 0.601947, Valid_loss 0.589901
Epoch 15, Train Loss 0.575240, Valid_loss 0.584518
Epoch 16, Train Loss 0.536315, Valid_loss 0.565060
Epoch 17, Train Loss 0.516669, Valid_loss 0.556106
Epoch 18, Train Loss 0.490919, Valid_loss 0.545471
Epoch 19, Train Loss 0.487228, Valid_loss 0.528476
Epoch 20, Train Loss 0.463494, Valid_loss 0.518976
Epoch 21, Train Loss 0.444923, Valid_loss 0.488164
Epoch 22, Train Loss 0.472253, Valid_loss 0.494434
Epoch 23, Train Loss 0.482482, Valid_loss 0.508489
Epoch 24, Train Loss 0.424455, Valid_loss 0.503493
Epoch 25, Train Loss 0.423079, Valid_loss 0.497887
Epoch 26, Train Loss 0.458240, Valid_loss 0.443743
Epoch 27, Train Loss 0.374237, Valid_loss 0.409531
Epoch 28, Train Loss 0.350345, Valid_loss 0.400790
Epoch 29, Train Loss 0.362649, Valid_loss 0.396634
Epoch 30, Train Loss 0.362757, Valid_loss 0.374963
Epoch 31, Train Loss 0.364233, Valid_loss 0.401563
Epoch 32, Train Loss 0.350824, Valid_loss 0.377744
Epoch 33, Train Loss 0.329954, Valid_loss 0.384809
Epoch 34, Train Loss 0.313847, Valid_loss 0.418800
Epoch 35, Train Loss 0.329067, Valid_loss 0.411334
Epoch 36, Train Loss 0.343129, Valid_loss 0.363144
Epoch 37, Train Loss 0.344359, Valid_loss 0.379918
Epoch 38, Train Loss 0.334076, Valid_loss 0.426467
Epoch 39, Train Loss 0.281818, Valid_loss 0.426658
Epoch 40, Train Loss 0.314619, Valid_loss 0.381384
Epoch 41, Train Loss 0.281036, Valid_loss 0.359080
Epoch 42, Train Loss 0.270412, Valid_loss 0.349327
Epoch 43, Train Loss 0.320391, Valid_loss 0.351406
Epoch 44, Train Loss 0.288977, Valid_loss 0.355481
Epoch 45, Train Loss 0.295516, Valid_loss 0.350158
Epoch 46, Train Loss 0.299148, Valid_loss 0.362401
Epoch 47, Train Loss 0.288458, Valid_loss 0.340513
Epoch 48, Train Loss 0.320545, Valid_loss 0.336347
Epoch 49, Train Loss 0.283389, Valid_loss 0.351491
Epoch 50, Train Loss 0.311676, Valid_loss 0.328483
Epoch 51, Train Loss 0.275291, Valid_loss 0.341491
Epoch 52, Train Loss 0.301348, Valid_loss 0.331667
Epoch 53, Train Loss 0.322657, Valid_loss 0.321079
Epoch 54, Train Loss 0.280981, Valid_loss 0.328692
Epoch 55, Train Loss 0.246744, Valid_loss 0.317501
Epoch 56, Train Loss 0.273226, Valid_loss 0.328142
Epoch 57, Train Loss 0.287322, Valid_loss 0.321782
Epoch 58, Train Loss 0.279052, Valid_loss 0.322236
Epoch 59, Train Loss 0.278081, Valid_loss 0.314150
Epoch 60, Train Loss 0.325140, Valid_loss 0.311709
Epoch 61, Train Loss 0.283178, Valid_loss 0.287543
Epoch 62, Train Loss 0.272007, Valid_loss 0.324391
Epoch 63, Train Loss 0.271537, Valid_loss 0.308137
Epoch 64, Train Loss 0.299884, Valid_loss 0.324158
Epoch 65, Train Loss 0.334463, Valid_loss 0.316793
Epoch 66, Train Loss 0.255759, Valid_loss 0.314554
Epoch 67, Train Loss 0.252378, Valid_loss 0.318673
Epoch 68, Train Loss 0.267143, Valid_loss 0.320510
[I 2025-08-30 10:42:34,163] Trial 0 finished with value: 0.28754308234368053 and parameters: {'learning_rate': 0.001, 'epochs': 100, 'heads': 4, 'dropout': 0.3, 'weight_decay': 0.01, 'emb_dim': 8, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.28754308234368053.
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 46.00 MB
cuda
Epoch 1, Train Loss 0.720436, Valid_loss 0.652039
Epoch 2, Train Loss 0.673789, Valid_loss 0.642151
Epoch 3, Train Loss 0.669964, Valid_loss 0.635790
Epoch 4, Train Loss 0.657037, Valid_loss 0.629470
Epoch 5, Train Loss 0.637071, Valid_loss 0.619120
Epoch 6, Train Loss 0.630542, Valid_loss 0.606739
Epoch 7, Train Loss 0.613418, Valid_loss 0.586359
Epoch 8, Train Loss 0.577913, Valid_loss 0.576917
Epoch 9, Train Loss 0.578384, Valid_loss 0.568390
Epoch 10, Train Loss 0.566354, Valid_loss 0.562325
Epoch 11, Train Loss 0.539555, Valid_loss 0.548158
Epoch 12, Train Loss 0.533844, Valid_loss 0.535182
Epoch 13, Train Loss 0.528645, Valid_loss 0.528497
Epoch 14, Train Loss 0.545900, Valid_loss 0.512714
Epoch 15, Train Loss 0.523245, Valid_loss 0.493889
Epoch 16, Train Loss 0.545282, Valid_loss 0.512246
Epoch 17, Train Loss 0.536542, Valid_loss 0.487135
Epoch 18, Train Loss 0.504045, Valid_loss 0.493778
Epoch 19, Train Loss 0.461807, Valid_loss 0.490366
Epoch 20, Train Loss 0.469827, Valid_loss 0.482454
Epoch 21, Train Loss 0.474879, Valid_loss 0.458618
Epoch 22, Train Loss 0.467398, Valid_loss 0.467537
Epoch 23, Train Loss 0.452679, Valid_loss 0.462838
Epoch 24, Train Loss 0.490470, Valid_loss 0.475126
Epoch 25, Train Loss 0.469182, Valid_loss 0.457020
Epoch 26, Train Loss 0.457238, Valid_loss 0.439005
Epoch 27, Train Loss 0.434796, Valid_loss 0.460586
Epoch 28, Train Loss 0.441777, Valid_loss 0.404979
Epoch 29, Train Loss 0.459746, Valid_loss 0.463670
Epoch 30, Train Loss 0.413832, Valid_loss 0.445277
Epoch 31, Train Loss 0.419316, Valid_loss 0.416235
Epoch 32, Train Loss 0.442931, Valid_loss 0.449016
Epoch 33, Train Loss 0.399732, Valid_loss 0.399559
Epoch 34, Train Loss 0.429315, Valid_loss 0.381317
Epoch 35, Train Loss 0.434023, Valid_loss 0.435130
Epoch 36, Train Loss 0.428084, Valid_loss 0.398590
Epoch 37, Train Loss 0.399629, Valid_loss 0.454005
Epoch 38, Train Loss 0.445157, Valid_loss 0.449536
Epoch 39, Train Loss 0.427247, Valid_loss 0.388439
Epoch 40, Train Loss 0.407538, Valid_loss 0.377552
Epoch 41, Train Loss 0.368126, Valid_loss 0.444655
Epoch 42, Train Loss 0.398689, Valid_loss 0.366957
Epoch 43, Train Loss 0.388594, Valid_loss 0.425810
Epoch 44, Train Loss 0.377902, Valid_loss 0.382378
Epoch 45, Train Loss 0.395051, Valid_loss 0.371371
Epoch 46, Train Loss 0.359869, Valid_loss 0.364596
Epoch 47, Train Loss 0.412244, Valid_loss 0.363264
Epoch 48, Train Loss 0.397637, Valid_loss 0.352206
Epoch 49, Train Loss 0.367687, Valid_loss 0.395550
Epoch 50, Train Loss 0.354450, Valid_loss 0.397632
Epoch 51, Train Loss 0.385758, Valid_loss 0.392851
Epoch 52, Train Loss 0.413206, Valid_loss 0.384108
Epoch 53, Train Loss 0.343348, Valid_loss 0.358251
Epoch 54, Train Loss 0.376928, Valid_loss 0.361130
Epoch 55, Train Loss 0.413247, Valid_loss 0.388534
[I 2025-08-30 10:46:56,227] Trial 1 finished with value: 0.35220609818186077 and parameters: {'learning_rate': 0.001, 'epochs': 100, 'heads': 4, 'dropout': 0.7, 'weight_decay': 0.01, 'emb_dim': 8, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.28754308234368053.
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 26.13 MB
Memory Reserved: 46.00 MB
cuda
Epoch 1, Train Loss 0.641328, Valid_loss 0.592811
Epoch 2, Train Loss 0.577825, Valid_loss 0.580128
Epoch 3, Train Loss 0.581706, Valid_loss 0.573217
Epoch 4, Train Loss 0.533362, Valid_loss 0.547983
Epoch 5, Train Loss 0.537978, Valid_loss 0.527376
Epoch 6, Train Loss 0.529282, Valid_loss 0.490457
Epoch 7, Train Loss 0.475520, Valid_loss 0.465107
Epoch 8, Train Loss 0.444493, Valid_loss 0.460382
Epoch 9, Train Loss 0.415015, Valid_loss 0.443702
Epoch 10, Train Loss 0.401415, Valid_loss 0.443579
Epoch 11, Train Loss 0.378165, Valid_loss 0.442706
Epoch 12, Train Loss 0.376792, Valid_loss 0.442813
Epoch 13, Train Loss 0.358729, Valid_loss 0.429155
Epoch 14, Train Loss 0.366597, Valid_loss 0.437164
Epoch 15, Train Loss 0.367309, Valid_loss 0.416199
Epoch 16, Train Loss 0.364835, Valid_loss 0.416253
Epoch 17, Train Loss 0.365307, Valid_loss 0.401654
Epoch 18, Train Loss 0.340940, Valid_loss 0.416211
Epoch 19, Train Loss 0.323937, Valid_loss 0.405208
Epoch 20, Train Loss 0.330850, Valid_loss 0.399315
Epoch 21, Train Loss 0.323993, Valid_loss 0.396379
Epoch 22, Train Loss 0.324446, Valid_loss 0.400643
Epoch 23, Train Loss 0.324466, Valid_loss 0.385998
Epoch 24, Train Loss 0.332118, Valid_loss 0.380096
Epoch 25, Train Loss 0.349209, Valid_loss 0.385252
Epoch 26, Train Loss 0.340901, Valid_loss 0.392001
Epoch 27, Train Loss 0.325274, Valid_loss 0.393217
Epoch 28, Train Loss 0.323151, Valid_loss 0.392154
Epoch 29, Train Loss 0.310676, Valid_loss 0.383360
Epoch 30, Train Loss 0.322149, Valid_loss 0.376052
Epoch 31, Train Loss 0.315298, Valid_loss 0.376079
Epoch 32, Train Loss 0.321481, Valid_loss 0.371451
Epoch 33, Train Loss 0.311324, Valid_loss 0.373329
Epoch 34, Train Loss 0.301559, Valid_loss 0.366147
Epoch 35, Train Loss 0.299760, Valid_loss 0.360810
Epoch 36, Train Loss 0.342398, Valid_loss 0.355972
Epoch 37, Train Loss 0.294816, Valid_loss 0.358972
Epoch 38, Train Loss 0.311876, Valid_loss 0.354292
Epoch 39, Train Loss 0.302662, Valid_loss 0.361490
Epoch 40, Train Loss 0.295482, Valid_loss 0.363017
Epoch 41, Train Loss 0.293652, Valid_loss 0.369083
Epoch 42, Train Loss 0.282266, Valid_loss 0.359049
Epoch 43, Train Loss 0.292700, Valid_loss 0.356251
Epoch 44, Train Loss 0.288275, Valid_loss 0.345550
Epoch 45, Train Loss 0.285746, Valid_loss 0.355713
Epoch 46, Train Loss 0.281415, Valid_loss 0.370023
Epoch 47, Train Loss 0.308693, Valid_loss 0.345217
Epoch 48, Train Loss 0.283281, Valid_loss 0.353685
Epoch 49, Train Loss 0.287128, Valid_loss 0.344167
Epoch 50, Train Loss 0.274238, Valid_loss 0.369232
Epoch 51, Train Loss 0.284671, Valid_loss 0.356532
Epoch 52, Train Loss 0.289860, Valid_loss 0.351486
Epoch 53, Train Loss 0.272782, Valid_loss 0.360080
Epoch 54, Train Loss 0.282901, Valid_loss 0.354442
Epoch 55, Train Loss 0.291278, Valid_loss 0.355696
Epoch 56, Train Loss 0.294174, Valid_loss 0.351615
Epoch 57, Train Loss 0.274286, Valid_loss 0.359585
Epoch 58, Train Loss 0.300284, Valid_loss 0.352036
Epoch 59, Train Loss 0.272513, Valid_loss 0.356448
Epoch 60, Train Loss 0.288766, Valid_loss 0.351844
Epoch 61, Train Loss 0.266924, Valid_loss 0.359602
Epoch 62, Train Loss 0.288252, Valid_loss 0.350020
Epoch 63, Train Loss 0.267774, Valid_loss 0.351698
Epoch 64, Train Loss 0.267071, Valid_loss 0.350888
Epoch 65, Train Loss 0.258643, Valid_loss 0.355453
Epoch 66, Train Loss 0.292731, Valid_loss 0.343858
Epoch 67, Train Loss 0.266239, Valid_loss 0.362998
Epoch 68, Train Loss 0.266604, Valid_loss 0.346407
Epoch 69, Train Loss 0.268270, Valid_loss 0.358244
Epoch 70, Train Loss 0.262900, Valid_loss 0.351405
Epoch 71, Train Loss 0.283368, Valid_loss 0.363095
Epoch 72, Train Loss 0.280502, Valid_loss 0.370607
[I 2025-08-30 10:51:32,527] Trial 2 finished with value: 0.3438581643360002 and parameters: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 1, 'dropout': 0.5, 'weight_decay': 0.0001, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.28754308234368053.
선택된 trial params: {'learning_rate': 0.001, 'epochs': 100, 'heads': 4, 'dropout': 0.3, 'weight_decay': 0.01, 'emb_dim': 8, 'augment_num': 100, 'pca': False}
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=10, batch_size=1 -> steps=10
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 46.00 MB
cuda
Epoch 1, Train Loss 0.648600, Valid_loss 0.604547
Epoch 2, Train Loss 0.587106, Valid_loss 0.562848
Epoch 3, Train Loss 0.573308, Valid_loss 0.536742
Epoch 4, Train Loss 0.522218, Valid_loss 0.526142
Epoch 5, Train Loss 0.494617, Valid_loss 0.486470
Epoch 6, Train Loss 0.479788, Valid_loss 0.483579
Epoch 7, Train Loss 0.453639, Valid_loss 0.459012
Epoch 8, Train Loss 0.467703, Valid_loss 0.451537
Epoch 9, Train Loss 0.434437, Valid_loss 0.440355
Epoch 10, Train Loss 0.421306, Valid_loss 0.450688
Epoch 11, Train Loss 0.443381, Valid_loss 0.458293
Epoch 12, Train Loss 0.384407, Valid_loss 0.424436
Epoch 13, Train Loss 0.373539, Valid_loss 0.455487
Epoch 14, Train Loss 0.385887, Valid_loss 0.393910
Epoch 15, Train Loss 0.373467, Valid_loss 0.403076
Epoch 16, Train Loss 0.380492, Valid_loss 0.361753
Epoch 17, Train Loss 0.357999, Valid_loss 0.399679
Epoch 18, Train Loss 0.384034, Valid_loss 0.357169
Epoch 19, Train Loss 0.324531, Valid_loss 0.351133
Epoch 20, Train Loss 0.332583, Valid_loss 0.389113
Epoch 21, Train Loss 0.311020, Valid_loss 0.361457
Epoch 22, Train Loss 0.343006, Valid_loss 0.357123
Epoch 23, Train Loss 0.301548, Valid_loss 0.346772
Epoch 24, Train Loss 0.312446, Valid_loss 0.341230
Epoch 25, Train Loss 0.321075, Valid_loss 0.384614
Epoch 26, Train Loss 0.305393, Valid_loss 0.327327
Epoch 27, Train Loss 0.296065, Valid_loss 0.327778
Epoch 28, Train Loss 0.293341, Valid_loss 0.311237
Epoch 29, Train Loss 0.280098, Valid_loss 0.326667
Epoch 30, Train Loss 0.308709, Valid_loss 0.348889
Epoch 31, Train Loss 0.289912, Valid_loss 0.325249
Epoch 32, Train Loss 0.268435, Valid_loss 0.340407
Epoch 33, Train Loss 0.317280, Valid_loss 0.349385
Epoch 34, Train Loss 0.313279, Valid_loss 0.315004
Epoch 35, Train Loss 0.292476, Valid_loss 0.309711
Epoch 36, Train Loss 0.293242, Valid_loss 0.315579
Epoch 37, Train Loss 0.275442, Valid_loss 0.328164
Epoch 38, Train Loss 0.255545, Valid_loss 0.313806
Epoch 39, Train Loss 0.271169, Valid_loss 0.351166
Epoch 40, Train Loss 0.290047, Valid_loss 0.302532
Epoch 41, Train Loss 0.264223, Valid_loss 0.298744
Epoch 42, Train Loss 0.294641, Valid_loss 0.299529
Epoch 43, Train Loss 0.271534, Valid_loss 0.298622
Epoch 44, Train Loss 0.294644, Valid_loss 0.315854
Epoch 45, Train Loss 0.292781, Valid_loss 0.271947
Epoch 46, Train Loss 0.273253, Valid_loss 0.333136
Epoch 47, Train Loss 0.299846, Valid_loss 0.313253
Epoch 48, Train Loss 0.288804, Valid_loss 0.310180
Epoch 49, Train Loss 0.284678, Valid_loss 0.306795
Epoch 50, Train Loss 0.251250, Valid_loss 0.299532
Epoch 51, Train Loss 0.299184, Valid_loss 0.296675
Epoch 52, Train Loss 0.271396, Valid_loss 0.287486
Epoch 53, Train Loss 0.255736, Valid_loss 0.310380
Epoch 54, Train Loss 0.270880, Valid_loss 0.292907
Epoch 55, Train Loss 0.267465, Valid_loss 0.284870
Epoch 56, Train Loss 0.234317, Valid_loss 0.281283
Epoch 57, Train Loss 0.257009, Valid_loss 0.287712
Epoch 58, Train Loss 0.274272, Valid_loss 0.283527
Epoch 59, Train Loss 0.265223, Valid_loss 0.302727
Epoch 60, Train Loss 0.254599, Valid_loss 0.280159
Epoch 61, Train Loss 0.274953, Valid_loss 0.288000
Epoch 62, Train Loss 0.275527, Valid_loss 0.286014
Epoch 63, Train Loss 0.280489, Valid_loss 0.269269
Epoch 64, Train Loss 0.282499, Valid_loss 0.284415
Epoch 65, Train Loss 0.251650, Valid_loss 0.298971
환자ID=COVID19_Participant12 -- true: 1 -- pred: 1
환자ID=COVID19_Participant14 -- true: 1 -- pred: 1
환자ID=COVID19_Participant17 -- true: 1 -- pred: 1
환자ID=COVID19_Participant21 -- true: 1 -- pred: 1
환자ID=COVID19_Participant35 -- true: 1 -- pred: 0
환자ID=COVID19_Participant37 -- true: 1 -- pred: 1
환자ID=COVID19_Participant40 -- true: 1 -- pred: 1
환자ID=Control_Participant3 -- true: 0 -- pred: 0
환자ID=Control_Participant6 -- true: 0 -- pred: 0
환자ID=Control_Participant9 -- true: 0 -- pred: 0
Best performance: Epoch 63, Loss 0.280489, Test ACC 0.900000, Test AUC 1.000000, Test Recall 0.857143, Test Precision 1.000000
Confusion Matrix:
 [3 0 1 6]
✅ Total valid splits used: 4
🔁 Repeat 4, Fold 4
cell type :  TTGCGGTGACCA_COVID19_Participant31    Ciliated Cells
AGGCTCGAACTG_COVID19_Participant31    Ciliated Cells
TATCCGTATGTT_COVID19_Participant31      Goblet Cells
CAGACAGCGGCT_COVID19_Participant31       Basal Cells
CAAAGAGAACTA_COVID19_Participant31    Ciliated Cells
                                           ...      
GCAGGGAACTCC_COVID19_Participant30    Squamous Cells
CAGCACCGAGCC_COVID19_Participant30    Squamous Cells
GCCCCTTGTGAT_COVID19_Participant30    Squamous Cells
GTGTTGTGTGTC_COVID19_Participant30    Squamous Cells
TAACACTCACTT_COVID19_Participant30    Squamous Cells
Name: manual_annotation, Length: 20471, dtype: string
cell type annotation :  TTGCGGTGACCA_COVID19_Participant31    Ciliated Cells
AGGCTCGAACTG_COVID19_Participant31    Ciliated Cells
TATCCGTATGTT_COVID19_Participant31      Goblet Cells
CAGACAGCGGCT_COVID19_Participant31       Basal Cells
CAAAGAGAACTA_COVID19_Participant31    Ciliated Cells
                                           ...      
GCAGGGAACTCC_COVID19_Participant30    Squamous Cells
CAGCACCGAGCC_COVID19_Participant30    Squamous Cells
GCCCCTTGTGAT_COVID19_Participant30    Squamous Cells
GTGTTGTGTGTC_COVID19_Participant30    Squamous Cells
TAACACTCACTT_COVID19_Participant30    Squamous Cells
Name: manual_annotation, Length: 20471, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Ciliated Cells', 'Goblet Cells', 'Basal Cells', 'Developing Secretory and Goblet Cells', 'Macrophages', 'T Cells', 'Deuterosomal Cells', 'Mitotic Basal Cells', 'Developing Ciliated Cells', 'Secretory Cells', 'Squamous Cells', 'Plasmacytoid DCs', 'Ionocytes', 'Enteroendocrine Cells', 'Dendritic Cells', 'B Cells', 'Erythroblasts', 'Mast Cells']
라벨별 그룹 개수 {1: 28, 0: 12}
cell type :  GTCGGGGGGTGG_Control_Participant7     Developing Ciliated Cells
CAAATCAATTAT_Control_Participant7     Developing Ciliated Cells
ATACAATTGACA_Control_Participant7     Developing Ciliated Cells
CTGTTAATGAGA_Control_Participant7     Developing Ciliated Cells
CTTCACATTATT_Control_Participant7     Developing Ciliated Cells
                                                ...            
GCGCCCGTGTTA_COVID19_Participant27                 Goblet Cells
TTGATCCGTGGC_COVID19_Participant27                      T Cells
CGCGACTACTCT_COVID19_Participant27              Secretory Cells
AAACGCTTGTTA_COVID19_Participant27               Ciliated Cells
CATTGGGGGAAA_COVID19_Participant27              Secretory Cells
Name: manual_annotation, Length: 6476, dtype: string
cell type annotation :  GTCGGGGGGTGG_Control_Participant7     Developing Ciliated Cells
CAAATCAATTAT_Control_Participant7     Developing Ciliated Cells
ATACAATTGACA_Control_Participant7     Developing Ciliated Cells
CTGTTAATGAGA_Control_Participant7     Developing Ciliated Cells
CTTCACATTATT_Control_Participant7     Developing Ciliated Cells
                                                ...            
GCGCCCGTGTTA_COVID19_Participant27                 Goblet Cells
TTGATCCGTGGC_COVID19_Participant27                      T Cells
CGCGACTACTCT_COVID19_Participant27              Secretory Cells
AAACGCTTGTTA_COVID19_Participant27               Ciliated Cells
CATTGGGGGAAA_COVID19_Participant27              Secretory Cells
Name: manual_annotation, Length: 6476, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Developing Ciliated Cells', 'Ciliated Cells', 'Secretory Cells', 'Squamous Cells', 'Goblet Cells', 'T Cells', 'Dendritic Cells', 'Basal Cells', 'Deuterosomal Cells', 'Mitotic Basal Cells', 'Macrophages', 'B Cells', 'Ionocytes', 'Developing Secretory and Goblet Cells', 'Enteroendocrine Cells', 'Mast Cells', 'Plasmacytoid DCs', 'Erythroblasts']
라벨별 그룹 개수 {1: 7, 0: 3}
🔍 Split #5
  → train_p_index 환자 수 (환자 단위로 묶인 index list): 40
  → test_p_index 환자 수  (환자 단위로 묶인 index list): 10
  → train 환자 ID: ['COVID19_Participant10', 'COVID19_Participant11', 'COVID19_Participant12', 'COVID19_Participant14', 'COVID19_Participant17', 'COVID19_Participant18', 'COVID19_Participant19', 'COVID19_Participant2', 'COVID19_Participant20', 'COVID19_Participant21', 'COVID19_Participant22', 'COVID19_Participant26', 'COVID19_Participant28', 'COVID19_Participant29', 'COVID19_Participant3', 'COVID19_Participant30', 'COVID19_Participant31', 'COVID19_Participant32', 'COVID19_Participant35', 'COVID19_Participant37', 'COVID19_Participant38', 'COVID19_Participant39', 'COVID19_Participant40', 'COVID19_Participant5', 'COVID19_Participant6', 'COVID19_Participant7', 'COVID19_Participant8', 'COVID19_Participant9', 'Control_Participant1', 'Control_Participant10', 'Control_Participant12', 'Control_Participant13', 'Control_Participant14', 'Control_Participant15', 'Control_Participant3', 'Control_Participant4', 'Control_Participant5', 'Control_Participant6', 'Control_Participant8', 'Control_Participant9']
  → test  환자 ID: ['COVID19_Participant13', 'COVID19_Participant15', 'COVID19_Participant23', 'COVID19_Participant25', 'COVID19_Participant27', 'COVID19_Participant36', 'COVID19_Participant4', 'Control_Participant11', 'Control_Participant2', 'Control_Participant7']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant10, Label: 1
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant12, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant18, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant21, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant3, Label: 1
    ID: COVID19_Participant30, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant35, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant38, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: COVID19_Participant5, Label: 1
    ID: COVID19_Participant6, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: COVID19_Participant9, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant10, Label: 0
    ID: Control_Participant12, Label: 0
    ID: Control_Participant13, Label: 0
    ID: Control_Participant14, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant4, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant6, Label: 0
    ID: Control_Participant8, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant27, Label: 1
    ID: COVID19_Participant36, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: Control_Participant11, Label: 0
    ID: Control_Participant2, Label: 0
    ID: Control_Participant7, Label: 0
전체 데이터 index 길이 50
label_stat (train 환자 라벨 목록) 갯수 40
train_data에서 환자 단위로, train과 validation 나누기
기존 train_p_index 40
기존 (train) label_stat 40
train-vali 분할 후! 
train y 의 classes : {0, 1} valid y 의 classes : {0, 1} label_stat 의 classes : {0, 1}
train_p_index_ 26
valid_p_index 14
test_p_index 10
→ train 환자 ID 및 라벨:
   총 개수: 26
   환자ID=Control_Participant10, Label=0, 셀개수=1645
   환자ID=Control_Participant15, Label=0, 셀개수=528
   환자ID=COVID19_Participant19, Label=1, 셀개수=816
   환자ID=COVID19_Participant39, Label=1, 셀개수=454
   환자ID=COVID19_Participant10, Label=1, 셀개수=18
   환자ID=Control_Participant5, Label=0, 셀개수=717
   환자ID=COVID19_Participant14, Label=1, 셀개수=382
   환자ID=COVID19_Participant2, Label=1, 셀개수=329
   환자ID=COVID19_Participant5, Label=1, 셀개수=89
   환자ID=COVID19_Participant12, Label=1, 셀개수=102
   환자ID=COVID19_Participant20, Label=1, 셀개수=2033
   환자ID=Control_Participant3, Label=0, 셀개수=1620
   환자ID=COVID19_Participant29, Label=1, 셀개수=573
   환자ID=Control_Participant8, Label=0, 셀개수=393
   환자ID=Control_Participant6, Label=0, 셀개수=131
   환자ID=COVID19_Participant17, Label=1, 셀개수=843
   환자ID=Control_Participant9, Label=0, 셀개수=558
   환자ID=Control_Participant12, Label=0, 셀개수=99
   환자ID=COVID19_Participant22, Label=1, 셀개수=865
   환자ID=COVID19_Participant31, Label=1, 셀개수=410
   환자ID=COVID19_Participant28, Label=1, 셀개수=1079
   환자ID=COVID19_Participant18, Label=1, 셀개수=227
   환자ID=COVID19_Participant7, Label=1, 셀개수=409
   환자ID=COVID19_Participant40, Label=1, 셀개수=381
   환자ID=COVID19_Participant38, Label=1, 셀개수=51
   환자ID=COVID19_Participant30, Label=1, 셀개수=116
→ valid 환자 ID 및 라벨:
   총 개수: 14
   환자ID=Control_Participant14, Label=0, 셀개수=274
   환자ID=COVID19_Participant3, Label=1, 셀개수=104
   환자ID=COVID19_Participant35, Label=1, 셀개수=83
   환자ID=COVID19_Participant32, Label=1, 셀개수=1665
   환자ID=COVID19_Participant6, Label=1, 셀개수=84
   환자ID=COVID19_Participant21, Label=1, 셀개수=39
   환자ID=Control_Participant4, Label=0, 셀개수=440
   환자ID=Control_Participant1, Label=0, 셀개수=414
   환자ID=COVID19_Participant9, Label=1, 셀개수=86
   환자ID=COVID19_Participant8, Label=1, 셀개수=462
   환자ID=Control_Participant13, Label=0, 셀개수=88
   환자ID=COVID19_Participant37, Label=1, 셀개수=668
   환자ID=COVID19_Participant11, Label=1, 셀개수=382
   환자ID=COVID19_Participant26, Label=1, 셀개수=814
→ test 환자 ID 및 라벨:
   총 개수: 10
   환자ID=COVID19_Participant13, Label=1, 셀개수=730
   환자ID=COVID19_Participant15, Label=1, 셀개수=1003
   환자ID=COVID19_Participant23, Label=1, 셀개수=307
   환자ID=COVID19_Participant25, Label=1, 셀개수=496
   환자ID=COVID19_Participant27, Label=1, 셀개수=93
   환자ID=COVID19_Participant36, Label=1, 셀개수=200
   환자ID=COVID19_Participant4, Label=1, 셀개수=1680
   환자ID=Control_Participant11, Label=0, 셀개수=1164
   환자ID=Control_Participant2, Label=0, 셀개수=41
   환자ID=Control_Participant7, Label=0, 셀개수=762
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Ciliated Cells', 'Ciliated Cells', 'Goblet Cells', 'Basal Cells', 'Ciliated Cells', 'Developing Secretory and Goblet Cells', 'Basal Cells', 'Ciliated Cells', 'Basal Cells', 'Developing Secretory and Goblet Cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
전체 데이터 길이 26947
전체 cell type 길이 0         Ciliated Cells
1         Ciliated Cells
2           Goblet Cells
3            Basal Cells
4         Ciliated Cells
              ...       
26942       Goblet Cells
26943            T Cells
26944    Secretory Cells
26945     Ciliated Cells
26946    Secretory Cells
Length: 26947, dtype: string
cell type의 NaN 개수 체크 0
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:10,  9.79it/s]  2%|▏         | 2/100 [00:00<00:12,  8.06it/s]  4%|▍         | 4/100 [00:00<00:09,  9.61it/s]  5%|▌         | 5/100 [00:00<00:19,  4.84it/s]  6%|▌         | 6/100 [00:00<00:16,  5.72it/s]  7%|▋         | 7/100 [00:01<00:14,  6.47it/s]  9%|▉         | 9/100 [00:01<00:11,  7.89it/s] 11%|█         | 11/100 [00:01<00:10,  8.54it/s] 13%|█▎        | 13/100 [00:01<00:09,  9.15it/s] 15%|█▌        | 15/100 [00:01<00:08,  9.56it/s] 16%|█▌        | 16/100 [00:01<00:08,  9.49it/s] 17%|█▋        | 17/100 [00:02<00:08,  9.23it/s] 19%|█▉        | 19/100 [00:02<00:08,  9.19it/s] 20%|██        | 20/100 [00:02<00:11,  7.15it/s] 22%|██▏       | 22/100 [00:02<00:10,  7.75it/s] 24%|██▍       | 24/100 [00:02<00:09,  8.40it/s] 25%|██▌       | 25/100 [00:03<00:09,  7.89it/s] 26%|██▌       | 26/100 [00:03<00:09,  7.98it/s] 27%|██▋       | 27/100 [00:03<00:09,  7.98it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.40it/s] 29%|██▉       | 29/100 [00:03<00:08,  8.72it/s] 30%|███       | 30/100 [00:03<00:08,  8.01it/s] 31%|███       | 31/100 [00:03<00:08,  7.89it/s] 32%|███▏      | 32/100 [00:03<00:08,  8.33it/s] 33%|███▎      | 33/100 [00:04<00:10,  6.60it/s] 34%|███▍      | 34/100 [00:04<00:10,  6.32it/s] 36%|███▌      | 36/100 [00:04<00:08,  7.54it/s] 37%|███▋      | 37/100 [00:04<00:08,  7.78it/s] 38%|███▊      | 38/100 [00:05<00:11,  5.33it/s] 39%|███▉      | 39/100 [00:05<00:13,  4.48it/s] 41%|████      | 41/100 [00:05<00:10,  5.38it/s] 42%|████▏     | 42/100 [00:05<00:09,  5.81it/s] 44%|████▍     | 44/100 [00:05<00:08,  6.80it/s] 46%|████▌     | 46/100 [00:06<00:08,  6.66it/s] 47%|████▋     | 47/100 [00:06<00:07,  6.75it/s] 48%|████▊     | 48/100 [00:06<00:07,  7.21it/s] 50%|█████     | 50/100 [00:06<00:06,  8.06it/s] 51%|█████     | 51/100 [00:06<00:05,  8.19it/s] 52%|█████▏    | 52/100 [00:07<00:06,  7.22it/s] 53%|█████▎    | 53/100 [00:07<00:06,  7.35it/s] 55%|█████▌    | 55/100 [00:07<00:05,  7.93it/s] 57%|█████▋    | 57/100 [00:07<00:05,  7.98it/s] 58%|█████▊    | 58/100 [00:07<00:05,  7.85it/s] 59%|█████▉    | 59/100 [00:07<00:05,  6.87it/s] 60%|██████    | 60/100 [00:08<00:05,  7.31it/s] 61%|██████    | 61/100 [00:08<00:04,  7.82it/s] 62%|██████▏   | 62/100 [00:08<00:04,  8.29it/s] 64%|██████▍   | 64/100 [00:08<00:04,  8.96it/s] 65%|██████▌   | 65/100 [00:08<00:04,  7.33it/s] 66%|██████▌   | 66/100 [00:08<00:04,  7.73it/s] 68%|██████▊   | 68/100 [00:09<00:04,  7.78it/s] 69%|██████▉   | 69/100 [00:09<00:03,  8.06it/s] 70%|███████   | 70/100 [00:09<00:03,  8.15it/s] 71%|███████   | 71/100 [00:09<00:04,  6.51it/s] 73%|███████▎  | 73/100 [00:09<00:03,  7.69it/s] 74%|███████▍  | 74/100 [00:09<00:03,  8.04it/s] 75%|███████▌  | 75/100 [00:09<00:03,  8.32it/s] 76%|███████▌  | 76/100 [00:10<00:03,  7.04it/s] 77%|███████▋  | 77/100 [00:10<00:03,  7.32it/s] 78%|███████▊  | 78/100 [00:10<00:02,  7.50it/s] 79%|███████▉  | 79/100 [00:10<00:02,  7.92it/s] 80%|████████  | 80/100 [00:10<00:02,  8.29it/s] 81%|████████  | 81/100 [00:10<00:02,  8.56it/s] 82%|████████▏ | 82/100 [00:11<00:02,  6.12it/s] 83%|████████▎ | 83/100 [00:11<00:02,  6.65it/s] 84%|████████▍ | 84/100 [00:11<00:02,  6.40it/s] 85%|████████▌ | 85/100 [00:11<00:02,  6.73it/s] 86%|████████▌ | 86/100 [00:11<00:01,  7.31it/s] 87%|████████▋ | 87/100 [00:11<00:01,  7.42it/s] 88%|████████▊ | 88/100 [00:11<00:01,  7.45it/s] 89%|████████▉ | 89/100 [00:11<00:01,  7.82it/s] 90%|█████████ | 90/100 [00:12<00:01,  8.16it/s] 91%|█████████ | 91/100 [00:12<00:01,  8.01it/s] 92%|█████████▏| 92/100 [00:12<00:00,  8.31it/s] 93%|█████████▎| 93/100 [00:12<00:00,  8.38it/s] 95%|█████████▌| 95/100 [00:12<00:00,  8.20it/s] 96%|█████████▌| 96/100 [00:12<00:00,  8.41it/s] 97%|█████████▋| 97/100 [00:12<00:00,  8.12it/s] 98%|█████████▊| 98/100 [00:12<00:00,  8.39it/s] 99%|█████████▉| 99/100 [00:13<00:00,  8.14it/s]100%|██████████| 100/100 [00:13<00:00,  6.94it/s]100%|██████████| 100/100 [00:13<00:00,  7.51it/s]
[I 2025-08-30 10:56:55,821] A new study created in memory with name: no-name-9da59e3d-b1e9-4da9-9a0d-34cdc91352d6
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 24.81 MB
Memory Reserved: 46.00 MB
cuda
Epoch 1, Train Loss 0.985594, Valid_loss 0.982977
Epoch 2, Train Loss 0.881765, Valid_loss 0.804160
Epoch 3, Train Loss 0.779324, Valid_loss 0.721283
Epoch 4, Train Loss 0.736973, Valid_loss 0.694951
Epoch 5, Train Loss 0.712004, Valid_loss 0.691183
Epoch 6, Train Loss 0.710059, Valid_loss 0.685737
Epoch 7, Train Loss 0.724126, Valid_loss 0.680903
Epoch 8, Train Loss 0.698625, Valid_loss 0.684541
Epoch 9, Train Loss 0.709950, Valid_loss 0.680246
Epoch 10, Train Loss 0.683451, Valid_loss 0.677145
Epoch 11, Train Loss 0.677520, Valid_loss 0.669943
Epoch 12, Train Loss 0.684634, Valid_loss 0.675446
Epoch 13, Train Loss 0.669455, Valid_loss 0.664782
Epoch 14, Train Loss 0.665722, Valid_loss 0.658050
Epoch 15, Train Loss 0.658472, Valid_loss 0.657789
Epoch 16, Train Loss 0.655336, Valid_loss 0.647581
Epoch 17, Train Loss 0.633133, Valid_loss 0.657163
Epoch 18, Train Loss 0.656668, Valid_loss 0.644834
Epoch 19, Train Loss 0.646758, Valid_loss 0.641136
Epoch 20, Train Loss 0.640632, Valid_loss 0.638667
Epoch 21, Train Loss 0.631630, Valid_loss 0.633624
Epoch 22, Train Loss 0.642470, Valid_loss 0.634513
Epoch 23, Train Loss 0.624944, Valid_loss 0.633247
Epoch 24, Train Loss 0.652070, Valid_loss 0.629457
Epoch 25, Train Loss 0.615398, Valid_loss 0.625269
Epoch 26, Train Loss 0.623540, Valid_loss 0.624249
Epoch 27, Train Loss 0.628086, Valid_loss 0.622743
Epoch 28, Train Loss 0.618072, Valid_loss 0.614860
Epoch 29, Train Loss 0.618706, Valid_loss 0.613314
Epoch 30, Train Loss 0.607520, Valid_loss 0.613236
Epoch 31, Train Loss 0.616575, Valid_loss 0.614606
Epoch 32, Train Loss 0.610280, Valid_loss 0.603410
Epoch 33, Train Loss 0.612487, Valid_loss 0.608968
Epoch 34, Train Loss 0.600384, Valid_loss 0.609042
Epoch 35, Train Loss 0.584664, Valid_loss 0.599490
Epoch 36, Train Loss 0.586254, Valid_loss 0.605794
Epoch 37, Train Loss 0.587543, Valid_loss 0.590880
Epoch 38, Train Loss 0.594204, Valid_loss 0.595062
Epoch 39, Train Loss 0.579550, Valid_loss 0.594277
Epoch 40, Train Loss 0.585545, Valid_loss 0.585530
Epoch 41, Train Loss 0.581781, Valid_loss 0.595118
Epoch 42, Train Loss 0.596354, Valid_loss 0.582962
Epoch 43, Train Loss 0.576032, Valid_loss 0.579206
Epoch 44, Train Loss 0.571044, Valid_loss 0.583261
Epoch 45, Train Loss 0.576887, Valid_loss 0.578854
Epoch 46, Train Loss 0.588996, Valid_loss 0.579470
Epoch 47, Train Loss 0.580826, Valid_loss 0.586757
Epoch 48, Train Loss 0.598633, Valid_loss 0.568230
Epoch 49, Train Loss 0.576196, Valid_loss 0.586005
Epoch 50, Train Loss 0.574709, Valid_loss 0.562726
Epoch 51, Train Loss 0.551859, Valid_loss 0.577719
Epoch 52, Train Loss 0.575419, Valid_loss 0.570590
Epoch 53, Train Loss 0.566235, Valid_loss 0.568957
Epoch 54, Train Loss 0.562596, Valid_loss 0.571813
Epoch 55, Train Loss 0.563291, Valid_loss 0.564918
Epoch 56, Train Loss 0.563839, Valid_loss 0.564850
Epoch 57, Train Loss 0.563569, Valid_loss 0.576996
Epoch 58, Train Loss 0.573534, Valid_loss 0.568667
Epoch 59, Train Loss 0.548474, Valid_loss 0.565198
Epoch 60, Train Loss 0.551875, Valid_loss 0.561186
Epoch 61, Train Loss 0.560575, Valid_loss 0.572171
Epoch 62, Train Loss 0.553334, Valid_loss 0.576742
[I 2025-08-30 11:00:55,344] Trial 0 finished with value: 0.5611858602081027 and parameters: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 1, 'dropout': 0.3, 'weight_decay': 0.001, 'emb_dim': 8, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.5611858602081027.
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 27.97 MB
Memory Reserved: 46.00 MB
cuda
Epoch 1, Train Loss 0.660040, Valid_loss 0.625334
Epoch 2, Train Loss 0.639711, Valid_loss 0.600414
Epoch 3, Train Loss 0.643538, Valid_loss 0.606153
Epoch 4, Train Loss 0.620529, Valid_loss 0.597868
Epoch 5, Train Loss 0.622220, Valid_loss 0.602358
Epoch 6, Train Loss 0.608182, Valid_loss 0.587989
Epoch 7, Train Loss 0.587069, Valid_loss 0.518161
Epoch 8, Train Loss 0.521130, Valid_loss 0.429614
Epoch 9, Train Loss 0.475652, Valid_loss 0.401807
Epoch 10, Train Loss 0.457401, Valid_loss 0.354609
Epoch 11, Train Loss 0.417175, Valid_loss 0.401388
Epoch 12, Train Loss 0.441314, Valid_loss 0.645973
Epoch 13, Train Loss 0.544486, Valid_loss 0.514595
Epoch 14, Train Loss 0.433837, Valid_loss 0.373900
Epoch 15, Train Loss 0.454867, Valid_loss 0.528609
Epoch 16, Train Loss 0.421916, Valid_loss 0.407543
Epoch 17, Train Loss 0.401178, Valid_loss 0.416827
Epoch 18, Train Loss 0.385792, Valid_loss 0.290729
Epoch 19, Train Loss 0.409336, Valid_loss 0.361099
Epoch 20, Train Loss 0.430417, Valid_loss 0.435616
Epoch 21, Train Loss 0.396383, Valid_loss 0.403400
Epoch 22, Train Loss 0.407257, Valid_loss 0.366356
Epoch 23, Train Loss 0.399274, Valid_loss 0.303369
Epoch 24, Train Loss 0.377425, Valid_loss 0.295820
Epoch 25, Train Loss 0.335012, Valid_loss 0.356346
Epoch 26, Train Loss 0.366353, Valid_loss 0.332788
Epoch 27, Train Loss 0.350976, Valid_loss 0.327558
Epoch 28, Train Loss 0.361999, Valid_loss 0.366268
Epoch 29, Train Loss 0.318501, Valid_loss 0.297364
Epoch 30, Train Loss 0.372767, Valid_loss 0.280866
Epoch 31, Train Loss 0.419574, Valid_loss 0.380161
Epoch 32, Train Loss 0.375621, Valid_loss 0.466359
Epoch 33, Train Loss 0.332669, Valid_loss 0.385922
Epoch 34, Train Loss 0.344763, Valid_loss 0.291701
Epoch 35, Train Loss 0.324336, Valid_loss 0.292212
Epoch 36, Train Loss 0.333583, Valid_loss 0.570597
Epoch 37, Train Loss 0.354220, Valid_loss 0.380172
Epoch 38, Train Loss 0.307765, Valid_loss 0.314632
Epoch 39, Train Loss 0.328129, Valid_loss 0.502771
Epoch 40, Train Loss 0.359910, Valid_loss 0.523424
Epoch 41, Train Loss 0.388094, Valid_loss 0.328574
Epoch 42, Train Loss 0.356206, Valid_loss 0.324347
Epoch 43, Train Loss 0.320414, Valid_loss 0.394981
Epoch 44, Train Loss 0.320136, Valid_loss 0.339904
Epoch 45, Train Loss 0.336488, Valid_loss 0.322780
Epoch 46, Train Loss 0.386711, Valid_loss 0.359164
Epoch 47, Train Loss 0.362363, Valid_loss 0.387704
Epoch 48, Train Loss 0.307078, Valid_loss 0.361200
Epoch 49, Train Loss 0.298603, Valid_loss 0.328677
Epoch 50, Train Loss 0.289093, Valid_loss 0.375575
Epoch 51, Train Loss 0.350112, Valid_loss 0.373642
Epoch 52, Train Loss 0.341397, Valid_loss 0.363870
Epoch 53, Train Loss 0.296348, Valid_loss 0.306769
Epoch 54, Train Loss 0.284720, Valid_loss 0.286519
Epoch 55, Train Loss 0.291926, Valid_loss 0.288327
Epoch 56, Train Loss 0.270336, Valid_loss 0.293205
[I 2025-08-30 11:05:24,928] Trial 1 finished with value: 0.28086625039577484 and parameters: {'learning_rate': 0.01, 'epochs': 100, 'heads': 4, 'dropout': 0.5, 'weight_decay': 0.01, 'emb_dim': 64, 'augment_num': 100, 'pca': False}. Best is trial 1 with value: 0.28086625039577484.
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 27.97 MB
Memory Reserved: 46.00 MB
cuda
Epoch 1, Train Loss 0.522796, Valid_loss 0.436340
Epoch 2, Train Loss 0.399883, Valid_loss 0.442432
Epoch 3, Train Loss 0.352425, Valid_loss 0.362106
Epoch 4, Train Loss 0.320220, Valid_loss 0.354874
Epoch 5, Train Loss 0.320395, Valid_loss 0.404763
Epoch 6, Train Loss 0.349335, Valid_loss 0.412881
Epoch 7, Train Loss 0.326016, Valid_loss 0.342438
Epoch 8, Train Loss 0.313576, Valid_loss 0.353768
Epoch 9, Train Loss 0.300760, Valid_loss 0.321904
Epoch 10, Train Loss 0.293126, Valid_loss 0.316668
Epoch 11, Train Loss 0.283043, Valid_loss 0.390266
Epoch 12, Train Loss 0.293141, Valid_loss 0.444934
Epoch 13, Train Loss 0.281504, Valid_loss 0.318658
Epoch 14, Train Loss 0.262074, Valid_loss 0.309526
Epoch 15, Train Loss 0.266972, Valid_loss 0.307826
Epoch 16, Train Loss 0.260788, Valid_loss 0.289561
Epoch 17, Train Loss 0.264706, Valid_loss 0.319056
Epoch 18, Train Loss 0.259678, Valid_loss 0.290478
Epoch 19, Train Loss 0.256263, Valid_loss 0.317860
Epoch 20, Train Loss 0.262008, Valid_loss 0.358725
Epoch 21, Train Loss 0.260002, Valid_loss 0.310117
Epoch 22, Train Loss 0.251590, Valid_loss 0.295841
Epoch 23, Train Loss 0.257967, Valid_loss 0.326393
Epoch 24, Train Loss 0.256590, Valid_loss 0.314758
Epoch 25, Train Loss 0.264195, Valid_loss 0.300684
Epoch 26, Train Loss 0.273952, Valid_loss 0.296087
Epoch 27, Train Loss 0.261983, Valid_loss 0.341457
Epoch 28, Train Loss 0.280310, Valid_loss 0.286487
Epoch 29, Train Loss 0.254932, Valid_loss 0.280472
Epoch 30, Train Loss 0.260801, Valid_loss 0.301865
Epoch 31, Train Loss 0.254973, Valid_loss 0.309387
Epoch 32, Train Loss 0.250919, Valid_loss 0.311946
Epoch 33, Train Loss 0.260295, Valid_loss 0.349988
Epoch 34, Train Loss 0.252055, Valid_loss 0.296683
Epoch 35, Train Loss 0.244329, Valid_loss 0.280089
Epoch 36, Train Loss 0.253083, Valid_loss 0.312270
Epoch 37, Train Loss 0.265896, Valid_loss 0.331438
Epoch 38, Train Loss 0.266290, Valid_loss 0.299065
Epoch 39, Train Loss 0.248469, Valid_loss 0.346479
Epoch 40, Train Loss 0.249468, Valid_loss 0.286916
Epoch 41, Train Loss 0.249140, Valid_loss 0.304219
Epoch 42, Train Loss 0.261324, Valid_loss 0.304644
Epoch 43, Train Loss 0.249923, Valid_loss 0.314563
Epoch 44, Train Loss 0.246518, Valid_loss 0.303915
Epoch 45, Train Loss 0.245686, Valid_loss 0.289023
Epoch 46, Train Loss 0.245112, Valid_loss 0.330301
Epoch 47, Train Loss 0.250460, Valid_loss 0.331529
Epoch 48, Train Loss 0.250066, Valid_loss 0.323735
Epoch 49, Train Loss 0.251128, Valid_loss 0.302168
Epoch 50, Train Loss 0.243019, Valid_loss 0.256177
Epoch 51, Train Loss 0.250990, Valid_loss 0.280740
Epoch 52, Train Loss 0.249004, Valid_loss 0.301438
[I 2025-08-30 11:08:47,168] Trial 2 finished with value: 0.2561769359745085 and parameters: {'learning_rate': 0.001, 'epochs': 100, 'heads': 1, 'dropout': 0.3, 'weight_decay': 0.01, 'emb_dim': 64, 'augment_num': 100, 'pca': False}. Best is trial 2 with value: 0.2561769359745085.
선택된 trial params: {'learning_rate': 0.001, 'epochs': 100, 'heads': 1, 'dropout': 0.3, 'weight_decay': 0.01, 'emb_dim': 64, 'augment_num': 100, 'pca': False}
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=10, batch_size=1 -> steps=10
output_class :  1
Memory Allocated: 27.97 MB
Memory Reserved: 46.00 MB
cuda
Epoch 1, Train Loss 0.656925, Valid_loss 0.589935
Epoch 2, Train Loss 0.551853, Valid_loss 0.468796
Epoch 3, Train Loss 0.455997, Valid_loss 0.415987
Epoch 4, Train Loss 0.384884, Valid_loss 0.378271
Epoch 5, Train Loss 0.355888, Valid_loss 0.380422
Epoch 6, Train Loss 0.328134, Valid_loss 0.354812
Epoch 7, Train Loss 0.330200, Valid_loss 0.377305
Epoch 8, Train Loss 0.321504, Valid_loss 0.337512
Epoch 9, Train Loss 0.307665, Valid_loss 0.354048
Epoch 10, Train Loss 0.307140, Valid_loss 0.360064
Epoch 11, Train Loss 0.313684, Valid_loss 0.388211
Epoch 12, Train Loss 0.291441, Valid_loss 0.306139
Epoch 13, Train Loss 0.288141, Valid_loss 0.290482
Epoch 14, Train Loss 0.274667, Valid_loss 0.295535
Epoch 15, Train Loss 0.285315, Valid_loss 0.302540
Epoch 16, Train Loss 0.307034, Valid_loss 0.309870
Epoch 17, Train Loss 0.271623, Valid_loss 0.304266
Epoch 18, Train Loss 0.271107, Valid_loss 0.401023
Epoch 19, Train Loss 0.282233, Valid_loss 0.315130
Epoch 20, Train Loss 0.268879, Valid_loss 0.290549
Epoch 21, Train Loss 0.269038, Valid_loss 0.320716
Epoch 22, Train Loss 0.262830, Valid_loss 0.311030
Epoch 23, Train Loss 0.259813, Valid_loss 0.285505
Epoch 24, Train Loss 0.256705, Valid_loss 0.283667
Epoch 25, Train Loss 0.259289, Valid_loss 0.284214
Epoch 26, Train Loss 0.265180, Valid_loss 0.284932
Epoch 27, Train Loss 0.259328, Valid_loss 0.255714
Epoch 28, Train Loss 0.254345, Valid_loss 0.273848
Epoch 29, Train Loss 0.262754, Valid_loss 0.278318
Epoch 30, Train Loss 0.265852, Valid_loss 0.322413
Epoch 31, Train Loss 0.246701, Valid_loss 0.308001
Epoch 32, Train Loss 0.253631, Valid_loss 0.370040
Epoch 33, Train Loss 0.261119, Valid_loss 0.295501
Epoch 34, Train Loss 0.257023, Valid_loss 0.295799
Epoch 35, Train Loss 0.247237, Valid_loss 0.286008
Epoch 36, Train Loss 0.254662, Valid_loss 0.272058
Epoch 37, Train Loss 0.260145, Valid_loss 0.306775
Epoch 38, Train Loss 0.245109, Valid_loss 0.298362
Epoch 39, Train Loss 0.259973, Valid_loss 0.282557
Epoch 40, Train Loss 0.256818, Valid_loss 0.264770
Epoch 41, Train Loss 0.268410, Valid_loss 0.283383
Epoch 42, Train Loss 0.269542, Valid_loss 0.326105
Epoch 43, Train Loss 0.266592, Valid_loss 0.328367
Epoch 44, Train Loss 0.252935, Valid_loss 0.281590
Epoch 45, Train Loss 0.259860, Valid_loss 0.283399
Epoch 46, Train Loss 0.253391, Valid_loss 0.280012
Epoch 47, Train Loss 0.260322, Valid_loss 0.397387
Epoch 48, Train Loss 0.255795, Valid_loss 0.315769
Epoch 49, Train Loss 0.265881, Valid_loss 0.310704
Epoch 50, Train Loss 0.254908, Valid_loss 0.300718
Epoch 51, Train Loss 0.244995, Valid_loss 0.270176
Epoch 52, Train Loss 0.256629, Valid_loss 0.279435
Epoch 53, Train Loss 0.246599, Valid_loss 0.285241
환자ID=COVID19_Participant13 -- true: 1 -- pred: 1
환자ID=COVID19_Participant15 -- true: 1 -- pred: 1
환자ID=COVID19_Participant23 -- true: 1 -- pred: 1
환자ID=COVID19_Participant25 -- true: 1 -- pred: 1
환자ID=COVID19_Participant27 -- true: 1 -- pred: 1
환자ID=COVID19_Participant36 -- true: 1 -- pred: 1
환자ID=COVID19_Participant4 -- true: 1 -- pred: 1
환자ID=Control_Participant11 -- true: 0 -- pred: 1
환자ID=Control_Participant2 -- true: 0 -- pred: 1
환자ID=Control_Participant7 -- true: 0 -- pred: 0
Best performance: Epoch 27, Loss 0.259328, Test ACC 0.800000, Test AUC 0.666667, Test Recall 1.000000, Test Precision 0.777778
Confusion Matrix:
 [1 2 0 7]
✅ Total valid splits used: 5

📌 Repeat 4: 평균 AUC = 0.9143, 표준편차 = 0.1256
Test ACC 평균 0.860000, Test Recall 평균 0.885714, Test Precision 평균 0.930556
fold_aucs = [0.9523809523809524, 0.9523809523809524, 1.0, 1.0, 0.6666666666666667]
NaN 개수: 0 / 전체 5개


================ 전체 Repeat 요약 ================
Repeat 0: AUC 0.9524 ± 0.0602 | ACC 0.9000 | Recall 0.8571 | Precision 1.0000 | NaN 0/5
Repeat 1: AUC 0.9619 ± 0.0356 | ACC 0.8600 | Recall 0.8857 | Precision 0.9095 | NaN 0/5
Repeat 2: AUC 0.9048 ± 0.0522 | ACC 0.7600 | Recall 0.7429 | Precision 0.8964 | NaN 0/5
Repeat 3: AUC 0.9333 ± 0.0830 | ACC 0.8600 | Recall 0.9143 | Precision 0.8964 | NaN 0/5
Repeat 4: AUC 0.9143 ± 0.1256 | ACC 0.8600 | Recall 0.8857 | Precision 0.9306 | NaN 0/5

🏁 최종 결과 (각 Repeat의 AUC 평균의 평균): 0.9333 ± 0.0217
