Namespace(seed=240, batch_size=16, learning_rate=0.003, weight_decay=0.0001, epochs=100, task='custom_covid', emb_dim=128, h_dim=128, dropout=0.3, layers=1, heads=8, train_sample_cells=500, test_sample_cells=500, train_num_sample=20, test_num_sample=100, model='Transformer', dataset='/data/project/kim89/0804_data', inter_only=False, same_pheno=0, augment_num=100, alpha=1.0, repeat=5, all=1, min_size=6000, n_splits=5, pca=False, mix_type=1, norm_first=False, warmup=False, top_k=1, cell_type_annotation='singler_annotation')
🔁 Repeat 0, Fold 0
cell type :  CATTAAGGATAT_COVID19_Participant13    Epithelial_cells
GTAGAAGGGGGG_COVID19_Participant13           Platelets
ATTAAGAGGTAG_COVID19_Participant13    Epithelial_cells
AGATATGACAAG_COVID19_Participant13    Epithelial_cells
CTTGTAACAAAT_COVID19_Participant13    Epithelial_cells
                                            ...       
CAGGTTGGTATC_COVID19_Participant20    Epithelial_cells
TATAGCTTGGTA_COVID19_Participant20    Epithelial_cells
TTGTTAGACGGT_COVID19_Participant20          HSC_-G-CSF
ATGGCTCAGGCT_COVID19_Participant20    Epithelial_cells
ACATGATCCTTT_COVID19_Participant20    Epithelial_cells
Name: singler_annotation, Length: 22137, dtype: string
cell type annotation :  CATTAAGGATAT_COVID19_Participant13    Epithelial_cells
GTAGAAGGGGGG_COVID19_Participant13           Platelets
ATTAAGAGGTAG_COVID19_Participant13    Epithelial_cells
AGATATGACAAG_COVID19_Participant13    Epithelial_cells
CTTGTAACAAAT_COVID19_Participant13    Epithelial_cells
                                            ...       
CAGGTTGGTATC_COVID19_Participant20    Epithelial_cells
TATAGCTTGGTA_COVID19_Participant20    Epithelial_cells
TTGTTAGACGGT_COVID19_Participant20          HSC_-G-CSF
ATGGCTCAGGCT_COVID19_Participant20    Epithelial_cells
ACATGATCCTTT_COVID19_Participant20    Epithelial_cells
Name: singler_annotation, Length: 22137, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Epithelial_cells', 'Platelets', 'Keratinocytes', 'Macrophage', 'B_cell', 'Neutrophils', 'DC', 'Monocyte', 'T_cells', 'NK_cell', 'HSC_CD34+', 'Tissue_stem_cells', 'Embryonic_stem_cells', 'HSC_-G-CSF', 'Neurons', 'BM', 'Erythroblast', 'Fibroblasts', 'iPS_cells', 'Hepatocytes', 'CMP', 'Gametocytes', 'Chondrocytes', 'Endothelial_cells', 'Pre-B_cell_CD34-', 'Myelocyte', 'Astrocyte', 'Neuroepithelial_cell', 'Smooth_muscle_cells', 'GMP', 'MSC', 'Osteoblasts', 'MEP', 'BM & Prog.', 'Pro-B_cell_CD34+', 'Pro-Myelocyte', 'Unknown']
라벨별 그룹 개수 {1: 28, 0: 12}
cell type :  GTCGGGGGGTGG_Control_Participant7        Keratinocytes
CAAATCAATTAT_Control_Participant7     Epithelial_cells
ATACAATTGACA_Control_Participant7     Epithelial_cells
CTGTTAATGAGA_Control_Participant7     Epithelial_cells
CTTCACATTATT_Control_Participant7     Epithelial_cells
                                            ...       
GCAGGGAACTCC_COVID19_Participant30    Epithelial_cells
CAGCACCGAGCC_COVID19_Participant30    Epithelial_cells
GCCCCTTGTGAT_COVID19_Participant30    Epithelial_cells
GTGTTGTGTGTC_COVID19_Participant30              B_cell
TAACACTCACTT_COVID19_Participant30           Myelocyte
Name: singler_annotation, Length: 4810, dtype: string
cell type annotation :  GTCGGGGGGTGG_Control_Participant7        Keratinocytes
CAAATCAATTAT_Control_Participant7     Epithelial_cells
ATACAATTGACA_Control_Participant7     Epithelial_cells
CTGTTAATGAGA_Control_Participant7     Epithelial_cells
CTTCACATTATT_Control_Participant7     Epithelial_cells
                                            ...       
GCAGGGAACTCC_COVID19_Participant30    Epithelial_cells
CAGCACCGAGCC_COVID19_Participant30    Epithelial_cells
GCCCCTTGTGAT_COVID19_Participant30    Epithelial_cells
GTGTTGTGTGTC_COVID19_Participant30              B_cell
TAACACTCACTT_COVID19_Participant30           Myelocyte
Name: singler_annotation, Length: 4810, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Keratinocytes', 'Epithelial_cells', 'Neurons', 'iPS_cells', 'Embryonic_stem_cells', 'Astrocyte', 'DC', 'Gametocytes', 'HSC_-G-CSF', 'Smooth_muscle_cells', 'BM & Prog.', 'Monocyte', 'Myelocyte', 'BM', 'Endothelial_cells', 'Osteoblasts', 'Platelets', 'Erythroblast', 'NK_cell', 'T_cells', 'Chondrocytes', 'HSC_CD34+', 'CMP', 'Neutrophils', 'Fibroblasts', 'MEP', 'Neuroepithelial_cell', 'MSC', 'Pro-Myelocyte', 'B_cell', 'GMP', 'Hepatocytes', 'Macrophage', 'Pro-B_cell_CD34+', 'Tissue_stem_cells', 'Pre-B_cell_CD34-']
라벨별 그룹 개수 {1: 7, 0: 3}
🔍 Split #1
  → train_p_index 환자 수 (환자 단위로 묶인 index list): 40
  → test_p_index 환자 수  (환자 단위로 묶인 index list): 10
  → train 환자 ID: ['COVID19_Participant10', 'COVID19_Participant12', 'COVID19_Participant13', 'COVID19_Participant14', 'COVID19_Participant15', 'COVID19_Participant17', 'COVID19_Participant19', 'COVID19_Participant2', 'COVID19_Participant20', 'COVID19_Participant21', 'COVID19_Participant22', 'COVID19_Participant23', 'COVID19_Participant26', 'COVID19_Participant27', 'COVID19_Participant29', 'COVID19_Participant3', 'COVID19_Participant31', 'COVID19_Participant32', 'COVID19_Participant35', 'COVID19_Participant36', 'COVID19_Participant37', 'COVID19_Participant38', 'COVID19_Participant4', 'COVID19_Participant40', 'COVID19_Participant5', 'COVID19_Participant6', 'COVID19_Participant7', 'COVID19_Participant9', 'Control_Participant1', 'Control_Participant10', 'Control_Participant11', 'Control_Participant12', 'Control_Participant13', 'Control_Participant15', 'Control_Participant2', 'Control_Participant3', 'Control_Participant4', 'Control_Participant5', 'Control_Participant6', 'Control_Participant8']
  → test  환자 ID: ['COVID19_Participant11', 'COVID19_Participant18', 'COVID19_Participant25', 'COVID19_Participant28', 'COVID19_Participant30', 'COVID19_Participant39', 'COVID19_Participant8', 'Control_Participant14', 'Control_Participant7', 'Control_Participant9']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant10, Label: 1
    ID: COVID19_Participant12, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant21, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant27, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant3, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant35, Label: 1
    ID: COVID19_Participant36, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant38, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: COVID19_Participant5, Label: 1
    ID: COVID19_Participant6, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: COVID19_Participant9, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant10, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant12, Label: 0
    ID: Control_Participant13, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant2, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant4, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant6, Label: 0
    ID: Control_Participant8, Label: 0
  → test 환자 ID 및 라벨:
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant18, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant30, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: Control_Participant14, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant9, Label: 0
전체 데이터 index 길이 50
label_stat (train 환자 라벨 목록) 갯수 40
train_data에서 환자 단위로, train과 validation 나누기
기존 train_p_index 40
기존 (train) label_stat 40
train-vali 분할 후! 
train y 의 classes : {0, 1} valid y 의 classes : {0, 1} label_stat 의 classes : {0, 1}
train_p_index_ 26
valid_p_index 14
test_p_index 10
→ train 환자 ID 및 라벨:
   총 개수: 26
   환자ID=Control_Participant10, Label=0, 셀개수=1645
   환자ID=Control_Participant15, Label=0, 셀개수=528
   환자ID=COVID19_Participant19, Label=1, 셀개수=816
   환자ID=COVID19_Participant38, Label=1, 셀개수=51
   환자ID=COVID19_Participant10, Label=1, 셀개수=18
   환자ID=Control_Participant4, Label=0, 셀개수=440
   환자ID=COVID19_Participant14, Label=1, 셀개수=382
   환자ID=COVID19_Participant2, Label=1, 셀개수=329
   환자ID=COVID19_Participant40, Label=1, 셀개수=381
   환자ID=COVID19_Participant13, Label=1, 셀개수=730
   환자ID=COVID19_Participant20, Label=1, 셀개수=2033
   환자ID=Control_Participant2, Label=0, 셀개수=41
   환자ID=COVID19_Participant27, Label=1, 셀개수=93
   환자ID=Control_Participant6, Label=0, 셀개수=131
   환자ID=Control_Participant5, Label=0, 셀개수=717
   환자ID=COVID19_Participant15, Label=1, 셀개수=1003
   환자ID=Control_Participant8, Label=0, 셀개수=393
   환자ID=Control_Participant11, Label=0, 셀개수=1164
   환자ID=COVID19_Participant22, Label=1, 셀개수=865
   환자ID=COVID19_Participant31, Label=1, 셀개수=410
   환자ID=COVID19_Participant26, Label=1, 셀개수=814
   환자ID=COVID19_Participant17, Label=1, 셀개수=843
   환자ID=COVID19_Participant6, Label=1, 셀개수=84
   환자ID=COVID19_Participant4, Label=1, 셀개수=1680
   환자ID=COVID19_Participant37, Label=1, 셀개수=668
   환자ID=COVID19_Participant3, Label=1, 셀개수=104
→ valid 환자 ID 및 라벨:
   총 개수: 14
   환자ID=Control_Participant13, Label=0, 셀개수=88
   환자ID=COVID19_Participant29, Label=1, 셀개수=573
   환자ID=COVID19_Participant35, Label=1, 셀개수=83
   환자ID=COVID19_Participant32, Label=1, 셀개수=1665
   환자ID=COVID19_Participant5, Label=1, 셀개수=89
   환자ID=COVID19_Participant21, Label=1, 셀개수=39
   환자ID=Control_Participant3, Label=0, 셀개수=1620
   환자ID=Control_Participant1, Label=0, 셀개수=414
   환자ID=COVID19_Participant9, Label=1, 셀개수=86
   환자ID=COVID19_Participant7, Label=1, 셀개수=409
   환자ID=Control_Participant12, Label=0, 셀개수=99
   환자ID=COVID19_Participant36, Label=1, 셀개수=200
   환자ID=COVID19_Participant12, Label=1, 셀개수=102
   환자ID=COVID19_Participant23, Label=1, 셀개수=307
→ test 환자 ID 및 라벨:
   총 개수: 10
   환자ID=COVID19_Participant11, Label=1, 셀개수=382
   환자ID=COVID19_Participant18, Label=1, 셀개수=227
   환자ID=COVID19_Participant25, Label=1, 셀개수=496
   환자ID=COVID19_Participant28, Label=1, 셀개수=1079
   환자ID=COVID19_Participant30, Label=1, 셀개수=116
   환자ID=COVID19_Participant39, Label=1, 셀개수=454
   환자ID=COVID19_Participant8, Label=1, 셀개수=462
   환자ID=Control_Participant14, Label=0, 셀개수=274
   환자ID=Control_Participant7, Label=0, 셀개수=762
   환자ID=Control_Participant9, Label=0, 셀개수=558
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Epithelial_cells', 'Platelets', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Keratinocytes', 'Macrophage', 'Epithelial_cells', 'B_cell', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
전체 데이터 길이 26947
전체 cell type 길이 0        Epithelial_cells
1               Platelets
2        Epithelial_cells
3        Epithelial_cells
4        Epithelial_cells
               ...       
26942    Epithelial_cells
26943    Epithelial_cells
26944    Epithelial_cells
26945              B_cell
26946           Myelocyte
Length: 26947, dtype: string
cell type의 NaN 개수 체크 0
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:16,  5.86it/s]  2%|▏         | 2/100 [00:00<00:13,  7.53it/s]  3%|▎         | 3/100 [00:00<00:11,  8.42it/s]  4%|▍         | 4/100 [00:00<00:11,  8.61it/s]  5%|▌         | 5/100 [00:00<00:11,  8.12it/s]  6%|▌         | 6/100 [00:00<00:11,  8.48it/s]  7%|▋         | 7/100 [00:00<00:10,  8.63it/s]  8%|▊         | 8/100 [00:01<00:12,  7.14it/s]  9%|▉         | 9/100 [00:01<00:11,  7.66it/s] 10%|█         | 10/100 [00:01<00:11,  8.16it/s] 11%|█         | 11/100 [00:01<00:11,  7.82it/s] 12%|█▏        | 12/100 [00:01<00:11,  7.83it/s] 13%|█▎        | 13/100 [00:01<00:10,  8.33it/s] 14%|█▍        | 14/100 [00:01<00:09,  8.67it/s] 15%|█▌        | 15/100 [00:01<00:09,  9.00it/s] 16%|█▌        | 16/100 [00:01<00:09,  9.02it/s] 17%|█▋        | 17/100 [00:02<00:09,  9.18it/s] 18%|█▊        | 18/100 [00:02<00:09,  9.04it/s] 19%|█▉        | 19/100 [00:02<00:09,  8.19it/s] 20%|██        | 20/100 [00:02<00:09,  8.16it/s] 21%|██        | 21/100 [00:02<00:10,  7.21it/s] 22%|██▏       | 22/100 [00:02<00:10,  7.42it/s] 23%|██▎       | 23/100 [00:02<00:10,  7.57it/s] 24%|██▍       | 24/100 [00:02<00:10,  7.41it/s] 26%|██▌       | 26/100 [00:03<00:09,  8.21it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.16it/s] 29%|██▉       | 29/100 [00:03<00:08,  8.32it/s] 30%|███       | 30/100 [00:03<00:08,  8.63it/s] 31%|███       | 31/100 [00:03<00:08,  8.46it/s] 32%|███▏      | 32/100 [00:03<00:07,  8.56it/s] 33%|███▎      | 33/100 [00:04<00:08,  8.29it/s] 34%|███▍      | 34/100 [00:04<00:07,  8.27it/s] 35%|███▌      | 35/100 [00:04<00:07,  8.37it/s] 37%|███▋      | 37/100 [00:04<00:07,  8.92it/s] 38%|███▊      | 38/100 [00:04<00:07,  8.35it/s] 39%|███▉      | 39/100 [00:04<00:07,  8.00it/s] 40%|████      | 40/100 [00:04<00:07,  7.97it/s] 41%|████      | 41/100 [00:05<00:07,  7.77it/s] 42%|████▏     | 42/100 [00:05<00:07,  7.96it/s] 43%|████▎     | 43/100 [00:05<00:06,  8.15it/s] 44%|████▍     | 44/100 [00:05<00:06,  8.43it/s] 45%|████▌     | 45/100 [00:05<00:06,  8.65it/s] 46%|████▌     | 46/100 [00:05<00:06,  8.52it/s] 47%|████▋     | 47/100 [00:05<00:06,  7.92it/s] 48%|████▊     | 48/100 [00:05<00:06,  8.07it/s] 49%|████▉     | 49/100 [00:05<00:06,  8.25it/s] 50%|█████     | 50/100 [00:06<00:06,  7.68it/s] 51%|█████     | 51/100 [00:06<00:06,  8.13it/s] 52%|█████▏    | 52/100 [00:06<00:07,  6.46it/s] 53%|█████▎    | 53/100 [00:06<00:06,  7.15it/s] 54%|█████▍    | 54/100 [00:06<00:05,  7.69it/s] 55%|█████▌    | 55/100 [00:06<00:05,  7.51it/s] 56%|█████▌    | 56/100 [00:06<00:06,  7.02it/s] 57%|█████▋    | 57/100 [00:07<00:06,  7.11it/s] 58%|█████▊    | 58/100 [00:07<00:05,  7.49it/s] 59%|█████▉    | 59/100 [00:07<00:05,  7.60it/s] 60%|██████    | 60/100 [00:07<00:05,  7.43it/s] 61%|██████    | 61/100 [00:07<00:04,  7.91it/s] 62%|██████▏   | 62/100 [00:07<00:04,  8.16it/s] 63%|██████▎   | 63/100 [00:07<00:04,  8.19it/s] 64%|██████▍   | 64/100 [00:07<00:04,  8.34it/s] 65%|██████▌   | 65/100 [00:08<00:04,  8.68it/s] 66%|██████▌   | 66/100 [00:08<00:04,  8.06it/s] 67%|██████▋   | 67/100 [00:08<00:04,  7.47it/s] 68%|██████▊   | 68/100 [00:08<00:04,  7.94it/s] 69%|██████▉   | 69/100 [00:08<00:03,  7.97it/s] 70%|███████   | 70/100 [00:08<00:03,  8.25it/s] 71%|███████   | 71/100 [00:08<00:03,  8.18it/s] 72%|███████▏  | 72/100 [00:08<00:03,  7.54it/s] 73%|███████▎  | 73/100 [00:09<00:03,  7.90it/s] 74%|███████▍  | 74/100 [00:09<00:03,  8.04it/s] 75%|███████▌  | 75/100 [00:09<00:03,  7.16it/s] 76%|███████▌  | 76/100 [00:09<00:03,  6.79it/s] 77%|███████▋  | 77/100 [00:09<00:03,  6.42it/s] 78%|███████▊  | 78/100 [00:09<00:03,  6.83it/s] 79%|███████▉  | 79/100 [00:10<00:03,  6.88it/s] 80%|████████  | 80/100 [00:10<00:02,  7.23it/s] 81%|████████  | 81/100 [00:10<00:02,  7.52it/s] 82%|████████▏ | 82/100 [00:10<00:02,  7.75it/s] 83%|████████▎ | 83/100 [00:10<00:02,  7.73it/s] 84%|████████▍ | 84/100 [00:10<00:02,  7.25it/s] 85%|████████▌ | 85/100 [00:10<00:02,  7.25it/s] 86%|████████▌ | 86/100 [00:10<00:01,  7.09it/s] 87%|████████▋ | 87/100 [00:11<00:01,  7.58it/s] 88%|████████▊ | 88/100 [00:11<00:01,  7.80it/s] 89%|████████▉ | 89/100 [00:11<00:01,  8.11it/s] 90%|█████████ | 90/100 [00:11<00:01,  8.04it/s] 91%|█████████ | 91/100 [00:11<00:01,  8.04it/s] 92%|█████████▏| 92/100 [00:11<00:01,  5.69it/s] 93%|█████████▎| 93/100 [00:11<00:01,  6.43it/s] 94%|█████████▍| 94/100 [00:12<00:00,  6.92it/s] 95%|█████████▌| 95/100 [00:12<00:00,  7.29it/s] 96%|█████████▌| 96/100 [00:12<00:00,  6.59it/s] 97%|█████████▋| 97/100 [00:12<00:00,  6.97it/s] 98%|█████████▊| 98/100 [00:12<00:00,  7.14it/s] 99%|█████████▉| 99/100 [00:12<00:00,  6.66it/s]100%|██████████| 100/100 [00:12<00:00,  6.98it/s]100%|██████████| 100/100 [00:12<00:00,  7.73it/s]
[I 2025-08-31 14:51:48,589] A new study created in memory with name: no-name-8469aefc-51bc-495c-840d-c7c32723be51
👉 train samples(학습 샘플(bag))=126, batch_size=16 -> steps(샘플수/batch크기)=8
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 0.44 MB
Memory Reserved: 2.00 MB
cuda
Epoch 1, Train Loss 0.600793, Valid_loss 0.588759
Epoch 2, Train Loss 0.595348, Valid_loss 0.580747
Epoch 3, Train Loss 0.605235, Valid_loss 0.589579
Epoch 4, Train Loss 0.590148, Valid_loss 0.570334
Epoch 5, Train Loss 0.564934, Valid_loss 0.575626
Epoch 6, Train Loss 0.554097, Valid_loss 0.557644
Epoch 7, Train Loss 0.537081, Valid_loss 0.557971
Epoch 8, Train Loss 0.515929, Valid_loss 0.550665
Epoch 9, Train Loss 0.530188, Valid_loss 0.590504
Epoch 10, Train Loss 0.514399, Valid_loss 0.525974
Epoch 11, Train Loss 0.482678, Valid_loss 0.600319
Epoch 12, Train Loss 0.504553, Valid_loss 0.516454
Epoch 13, Train Loss 0.498889, Valid_loss 0.629871
Epoch 14, Train Loss 0.490380, Valid_loss 0.510022
Epoch 15, Train Loss 0.473322, Valid_loss 0.618989
Epoch 16, Train Loss 0.465482, Valid_loss 0.541335
Epoch 17, Train Loss 0.469413, Valid_loss 0.597512
Epoch 18, Train Loss 0.481166, Valid_loss 0.513876
Epoch 19, Train Loss 0.452896, Valid_loss 0.539378
Epoch 20, Train Loss 0.468397, Valid_loss 0.596630
Epoch 21, Train Loss 0.439843, Valid_loss 0.544940
Epoch 22, Train Loss 0.437332, Valid_loss 0.507809
Epoch 23, Train Loss 0.461070, Valid_loss 0.477654
Epoch 24, Train Loss 0.462033, Valid_loss 0.496895
Epoch 25, Train Loss 0.437806, Valid_loss 0.543966
Epoch 26, Train Loss 0.452614, Valid_loss 0.570840
Epoch 27, Train Loss 0.426757, Valid_loss 0.540934
Epoch 28, Train Loss 0.418697, Valid_loss 0.577028
Epoch 29, Train Loss 0.463703, Valid_loss 0.522604
Epoch 30, Train Loss 0.449474, Valid_loss 0.633359
Epoch 31, Train Loss 0.469246, Valid_loss 0.545108
Epoch 32, Train Loss 0.421680, Valid_loss 0.602442
Epoch 33, Train Loss 0.411855, Valid_loss 0.607452
Epoch 34, Train Loss 0.402218, Valid_loss 0.534609
Epoch 35, Train Loss 0.404527, Valid_loss 0.552721
Epoch 36, Train Loss 0.430140, Valid_loss 0.610359
Epoch 37, Train Loss 0.418705, Valid_loss 0.463755
Epoch 38, Train Loss 0.421823, Valid_loss 0.545277
Epoch 39, Train Loss 0.400711, Valid_loss 0.562346
Epoch 40, Train Loss 0.400454, Valid_loss 0.525452
Epoch 41, Train Loss 0.423525, Valid_loss 0.662494
Epoch 42, Train Loss 0.412481, Valid_loss 0.505570
Epoch 43, Train Loss 0.400860, Valid_loss 0.534934
Epoch 44, Train Loss 0.392596, Valid_loss 0.589745
Epoch 45, Train Loss 0.382190, Valid_loss 0.601806
Epoch 46, Train Loss 0.395740, Valid_loss 0.552193
Epoch 47, Train Loss 0.381829, Valid_loss 0.535811
Epoch 48, Train Loss 0.376370, Valid_loss 0.589077
Epoch 49, Train Loss 0.449949, Valid_loss 0.675902
Epoch 50, Train Loss 0.393892, Valid_loss 0.555047
Epoch 51, Train Loss 0.403729, Valid_loss 0.564464
Epoch 52, Train Loss 0.395959, Valid_loss 0.599507
[I 2025-08-31 14:56:47,989] Trial 0 finished with value: 0.46375472471117973 and parameters: {'learning_rate': 0.001, 'epochs': 100, 'heads': 4, 'dropout': 0.5, 'weight_decay': 0.0001, 'emb_dim': 8, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.46375472471117973.
👉 train samples(학습 샘플(bag))=126, batch_size=16 -> steps(샘플수/batch크기)=8
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 26.96 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.653479, Valid_loss 0.597469
Epoch 2, Train Loss 0.646710, Valid_loss 0.601239
Epoch 3, Train Loss 0.619498, Valid_loss 0.599648
Epoch 4, Train Loss 0.632559, Valid_loss 0.600564
Epoch 5, Train Loss 0.588131, Valid_loss 0.599850
Epoch 6, Train Loss 0.592479, Valid_loss 0.598468
Epoch 7, Train Loss 0.598336, Valid_loss 0.598918
Epoch 8, Train Loss 0.607107, Valid_loss 0.601413
Epoch 9, Train Loss 0.603953, Valid_loss 0.598331
Epoch 10, Train Loss 0.611373, Valid_loss 0.598311
Epoch 11, Train Loss 0.608738, Valid_loss 0.598712
Epoch 12, Train Loss 0.619891, Valid_loss 0.598871
Epoch 13, Train Loss 0.612536, Valid_loss 0.599619
Epoch 14, Train Loss 0.603088, Valid_loss 0.599662
Epoch 15, Train Loss 0.614376, Valid_loss 0.598205
Epoch 16, Train Loss 0.598091, Valid_loss 0.598013
Epoch 17, Train Loss 0.589005, Valid_loss 0.597906
Epoch 18, Train Loss 0.595310, Valid_loss 0.598022
Epoch 19, Train Loss 0.602240, Valid_loss 0.597904
Epoch 20, Train Loss 0.584896, Valid_loss 0.597510
Epoch 21, Train Loss 0.608881, Valid_loss 0.597295
Epoch 22, Train Loss 0.587327, Valid_loss 0.597216
Epoch 23, Train Loss 0.582136, Valid_loss 0.594444
Epoch 24, Train Loss 0.594962, Valid_loss 0.581796
Epoch 25, Train Loss 0.542403, Valid_loss 0.718002
Epoch 26, Train Loss 0.505353, Valid_loss 0.850182
Epoch 27, Train Loss 0.503058, Valid_loss 0.875213
Epoch 28, Train Loss 0.536459, Valid_loss 0.500696
Epoch 29, Train Loss 0.458813, Valid_loss 0.498725
Epoch 30, Train Loss 0.396270, Valid_loss 0.470028
Epoch 31, Train Loss 0.385432, Valid_loss 0.481791
Epoch 32, Train Loss 0.395585, Valid_loss 0.484156
Epoch 33, Train Loss 0.373211, Valid_loss 0.969175
Epoch 34, Train Loss 0.384536, Valid_loss 0.578072
Epoch 35, Train Loss 0.394060, Valid_loss 0.574717
Epoch 36, Train Loss 0.346536, Valid_loss 1.072885
Epoch 37, Train Loss 0.349668, Valid_loss 1.069402
Epoch 38, Train Loss 0.363284, Valid_loss 1.036258
Epoch 39, Train Loss 0.379572, Valid_loss 0.566503
Epoch 40, Train Loss 0.365922, Valid_loss 0.726356
Epoch 41, Train Loss 0.353091, Valid_loss 0.732907
Epoch 42, Train Loss 0.358825, Valid_loss 0.578502
Epoch 43, Train Loss 0.377379, Valid_loss 0.611718
Epoch 44, Train Loss 0.363905, Valid_loss 0.489432
Epoch 45, Train Loss 0.377872, Valid_loss 0.617779
Epoch 46, Train Loss 0.325021, Valid_loss 0.818473
Epoch 47, Train Loss 0.324586, Valid_loss 0.874888
Epoch 48, Train Loss 0.385563, Valid_loss 0.855795
Epoch 49, Train Loss 0.290882, Valid_loss 0.894743
Epoch 50, Train Loss 0.299378, Valid_loss 0.915534
Epoch 51, Train Loss 0.326573, Valid_loss 0.908155
Epoch 52, Train Loss 0.305513, Valid_loss 0.925714
Epoch 53, Train Loss 0.305122, Valid_loss 0.946438
[I 2025-08-31 15:00:06,150] Trial 1 finished with value: 0.47002773944820675 and parameters: {'learning_rate': 0.01, 'epochs': 100, 'heads': 1, 'dropout': 0.7, 'weight_decay': 0.0001, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.46375472471117973.
👉 train samples(학습 샘플(bag))=126, batch_size=16 -> steps(샘플수/batch크기)=8
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 26.96 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.687424, Valid_loss 0.598475
Epoch 2, Train Loss 0.583329, Valid_loss 0.598148
Epoch 3, Train Loss 0.599384, Valid_loss 0.601567
Epoch 4, Train Loss 0.607979, Valid_loss 0.598971
Epoch 5, Train Loss 0.602815, Valid_loss 0.597793
Epoch 6, Train Loss 0.597979, Valid_loss 0.597961
Epoch 7, Train Loss 0.615828, Valid_loss 0.601233
Epoch 8, Train Loss 0.597572, Valid_loss 0.597788
Epoch 9, Train Loss 0.600268, Valid_loss 0.597752
Epoch 10, Train Loss 0.579889, Valid_loss 0.598157
Epoch 11, Train Loss 0.591035, Valid_loss 0.597930
Epoch 12, Train Loss 0.593046, Valid_loss 0.598718
Epoch 13, Train Loss 0.587838, Valid_loss 0.599236
Epoch 14, Train Loss 0.592513, Valid_loss 0.598296
Epoch 15, Train Loss 0.592903, Valid_loss 0.597931
Epoch 16, Train Loss 0.589948, Valid_loss 0.603119
Epoch 17, Train Loss 0.596051, Valid_loss 0.597706
Epoch 18, Train Loss 0.589988, Valid_loss 0.597503
Epoch 19, Train Loss 0.592996, Valid_loss 0.595784
Epoch 20, Train Loss 0.567686, Valid_loss 0.535902
Epoch 21, Train Loss 0.565648, Valid_loss 0.520436
Epoch 22, Train Loss 0.504711, Valid_loss 0.487112
Epoch 23, Train Loss 0.483433, Valid_loss 0.682161
Epoch 24, Train Loss 0.464926, Valid_loss 0.458936
Epoch 25, Train Loss 0.417411, Valid_loss 0.562350
Epoch 26, Train Loss 0.403693, Valid_loss 0.589739
Epoch 27, Train Loss 0.384226, Valid_loss 0.512857
Epoch 28, Train Loss 0.342657, Valid_loss 0.470497
Epoch 29, Train Loss 0.351490, Valid_loss 0.459365
Epoch 30, Train Loss 0.355102, Valid_loss 0.570872
Epoch 31, Train Loss 0.334564, Valid_loss 0.635745
Epoch 32, Train Loss 0.343871, Valid_loss 0.551749
Epoch 33, Train Loss 0.300319, Valid_loss 0.510244
Epoch 34, Train Loss 0.292687, Valid_loss 0.577348
Epoch 35, Train Loss 0.304105, Valid_loss 0.568222
Epoch 36, Train Loss 0.313621, Valid_loss 0.576784
Epoch 37, Train Loss 0.296007, Valid_loss 0.570194
Epoch 38, Train Loss 0.311434, Valid_loss 0.587732
Epoch 39, Train Loss 0.307445, Valid_loss 0.641163
Epoch 40, Train Loss 0.312735, Valid_loss 0.529006
Epoch 41, Train Loss 0.316120, Valid_loss 0.566438
Epoch 42, Train Loss 0.286566, Valid_loss 0.506516
Epoch 43, Train Loss 0.269313, Valid_loss 0.534487
Epoch 44, Train Loss 0.280223, Valid_loss 0.531356
Epoch 45, Train Loss 0.267348, Valid_loss 0.585308
Epoch 46, Train Loss 0.269370, Valid_loss 0.528265
Epoch 47, Train Loss 0.253711, Valid_loss 0.586780
Epoch 48, Train Loss 0.255363, Valid_loss 0.515328
Epoch 49, Train Loss 0.252290, Valid_loss 0.635893
Epoch 50, Train Loss 0.257258, Valid_loss 0.554204
Epoch 51, Train Loss 0.254223, Valid_loss 0.512134
Epoch 52, Train Loss 0.268260, Valid_loss 0.537118
Epoch 53, Train Loss 0.245221, Valid_loss 0.514554
Epoch 54, Train Loss 0.256339, Valid_loss 0.545811
Epoch 55, Train Loss 0.249673, Valid_loss 0.510849
Epoch 56, Train Loss 0.242931, Valid_loss 0.523747
Epoch 57, Train Loss 0.232144, Valid_loss 0.595650
[I 2025-08-31 15:03:40,339] Trial 2 finished with value: 0.4589360643710409 and parameters: {'learning_rate': 0.01, 'epochs': 100, 'heads': 1, 'dropout': 0.3, 'weight_decay': 0.001, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 2 with value: 0.4589360643710409.
선택된 trial params: {'learning_rate': 0.01, 'epochs': 100, 'heads': 1, 'dropout': 0.3, 'weight_decay': 0.001, 'emb_dim': 32, 'augment_num': 100, 'pca': False}
👉 train samples(학습 샘플(bag))=126, batch_size=16 -> steps(샘플수/batch크기)=8
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=10, batch_size=1 -> steps=10
output_class :  1
Memory Allocated: 26.96 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.638008, Valid_loss 0.597000
Epoch 2, Train Loss 0.613141, Valid_loss 0.593765
Epoch 3, Train Loss 0.593047, Valid_loss 0.589450
Epoch 4, Train Loss 0.606239, Valid_loss 0.595325
Epoch 5, Train Loss 0.597191, Valid_loss 0.605903
Epoch 6, Train Loss 0.614206, Valid_loss 0.598380
Epoch 7, Train Loss 0.607196, Valid_loss 0.598760
Epoch 8, Train Loss 0.599385, Valid_loss 0.597624
Epoch 9, Train Loss 0.595823, Valid_loss 0.597652
Epoch 10, Train Loss 0.592302, Valid_loss 0.595320
Epoch 11, Train Loss 0.590400, Valid_loss 0.591807
Epoch 12, Train Loss 0.602253, Valid_loss 0.580139
Epoch 13, Train Loss 0.590609, Valid_loss 0.525131
Epoch 14, Train Loss 0.565307, Valid_loss 0.497842
Epoch 15, Train Loss 0.479250, Valid_loss 0.554996
Epoch 16, Train Loss 0.604482, Valid_loss 0.564575
Epoch 17, Train Loss 0.550345, Valid_loss 0.557305
Epoch 18, Train Loss 0.456467, Valid_loss 0.700790
Epoch 19, Train Loss 0.474891, Valid_loss 0.519895
Epoch 20, Train Loss 0.391854, Valid_loss 0.688212
Epoch 21, Train Loss 0.404083, Valid_loss 0.507024
Epoch 22, Train Loss 0.397841, Valid_loss 0.608683
Epoch 23, Train Loss 0.404417, Valid_loss 0.476569
Epoch 24, Train Loss 0.346267, Valid_loss 0.643788
Epoch 25, Train Loss 0.369142, Valid_loss 0.517283
Epoch 26, Train Loss 0.330146, Valid_loss 0.567834
Epoch 27, Train Loss 0.331446, Valid_loss 0.553614
Epoch 28, Train Loss 0.319094, Valid_loss 0.525850
Epoch 29, Train Loss 0.314132, Valid_loss 0.662938
Epoch 30, Train Loss 0.292084, Valid_loss 0.601545
Epoch 31, Train Loss 0.305215, Valid_loss 0.583885
Epoch 32, Train Loss 0.302528, Valid_loss 0.602935
Epoch 33, Train Loss 0.302583, Valid_loss 0.586962
Epoch 34, Train Loss 0.306134, Valid_loss 0.519494
Epoch 35, Train Loss 0.311397, Valid_loss 0.536031
Epoch 36, Train Loss 0.321100, Valid_loss 0.503561
Epoch 37, Train Loss 0.295126, Valid_loss 0.518472
Epoch 38, Train Loss 0.287790, Valid_loss 0.589172
Epoch 39, Train Loss 0.265453, Valid_loss 0.539726
Epoch 40, Train Loss 0.276442, Valid_loss 0.450686
Epoch 41, Train Loss 0.280435, Valid_loss 0.535691
Epoch 42, Train Loss 0.293348, Valid_loss 0.589286
Epoch 43, Train Loss 0.266803, Valid_loss 0.663782
Epoch 44, Train Loss 0.280756, Valid_loss 0.547527
Epoch 45, Train Loss 0.254855, Valid_loss 0.534827
Epoch 46, Train Loss 0.262437, Valid_loss 0.634162
Epoch 47, Train Loss 0.251148, Valid_loss 0.658807
Epoch 48, Train Loss 0.250991, Valid_loss 0.664839
Epoch 49, Train Loss 0.264417, Valid_loss 0.594051
Epoch 50, Train Loss 0.242360, Valid_loss 0.714681
Epoch 51, Train Loss 0.260873, Valid_loss 0.647534
Epoch 52, Train Loss 0.249870, Valid_loss 0.688447
Epoch 53, Train Loss 0.244995, Valid_loss 0.644145
Epoch 54, Train Loss 0.251902, Valid_loss 0.657862
Epoch 55, Train Loss 0.233186, Valid_loss 0.686431
환자ID=COVID19_Participant11 -- true: 1 -- pred: 1
환자ID=COVID19_Participant18 -- true: 1 -- pred: 1
환자ID=COVID19_Participant25 -- true: 1 -- pred: 1
환자ID=COVID19_Participant28 -- true: 1 -- pred: 1
환자ID=COVID19_Participant30 -- true: 1 -- pred: 1
환자ID=COVID19_Participant39 -- true: 1 -- pred: 1
환자ID=COVID19_Participant8 -- true: 1 -- pred: 1
환자ID=Control_Participant14 -- true: 0 -- pred: 0
환자ID=Control_Participant7 -- true: 0 -- pred: 0
환자ID=Control_Participant9 -- true: 0 -- pred: 0
Best performance: Epoch 40, Loss 0.276442, Test ACC 1.000000, Test AUC 1.000000, Test Recall 1.000000, Test Precision 1.000000
Confusion Matrix:
 [3 0 0 7]
✅ Total valid splits used: 1
🔁 Repeat 0, Fold 1
cell type :  GTCGGGGGGTGG_Control_Participant7        Keratinocytes
CAAATCAATTAT_Control_Participant7     Epithelial_cells
ATACAATTGACA_Control_Participant7     Epithelial_cells
CTGTTAATGAGA_Control_Participant7     Epithelial_cells
CTTCACATTATT_Control_Participant7     Epithelial_cells
                                            ...       
GCAGGGAACTCC_COVID19_Participant30    Epithelial_cells
CAGCACCGAGCC_COVID19_Participant30    Epithelial_cells
GCCCCTTGTGAT_COVID19_Participant30    Epithelial_cells
GTGTTGTGTGTC_COVID19_Participant30              B_cell
TAACACTCACTT_COVID19_Participant30           Myelocyte
Name: singler_annotation, Length: 21138, dtype: string
cell type annotation :  GTCGGGGGGTGG_Control_Participant7        Keratinocytes
CAAATCAATTAT_Control_Participant7     Epithelial_cells
ATACAATTGACA_Control_Participant7     Epithelial_cells
CTGTTAATGAGA_Control_Participant7     Epithelial_cells
CTTCACATTATT_Control_Participant7     Epithelial_cells
                                            ...       
GCAGGGAACTCC_COVID19_Participant30    Epithelial_cells
CAGCACCGAGCC_COVID19_Participant30    Epithelial_cells
GCCCCTTGTGAT_COVID19_Participant30    Epithelial_cells
GTGTTGTGTGTC_COVID19_Participant30              B_cell
TAACACTCACTT_COVID19_Participant30           Myelocyte
Name: singler_annotation, Length: 21138, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Keratinocytes', 'Epithelial_cells', 'Neurons', 'iPS_cells', 'Embryonic_stem_cells', 'Astrocyte', 'DC', 'Gametocytes', 'HSC_-G-CSF', 'Smooth_muscle_cells', 'BM & Prog.', 'Monocyte', 'Myelocyte', 'BM', 'Endothelial_cells', 'Osteoblasts', 'Platelets', 'Erythroblast', 'NK_cell', 'T_cells', 'Chondrocytes', 'HSC_CD34+', 'CMP', 'Neutrophils', 'Fibroblasts', 'MEP', 'Neuroepithelial_cell', 'MSC', 'Pro-Myelocyte', 'B_cell', 'GMP', 'Hepatocytes', 'Macrophage', 'Tissue_stem_cells', 'Pre-B_cell_CD34-', 'Pro-B_cell_CD34+', 'Unknown']
라벨별 그룹 개수 {1: 28, 0: 12}
cell type :  TTGCGGTGACCA_COVID19_Participant31    Epithelial_cells
AGGCTCGAACTG_COVID19_Participant31    Epithelial_cells
TATCCGTATGTT_COVID19_Participant31             NK_cell
CAGACAGCGGCT_COVID19_Participant31    Epithelial_cells
CAAAGAGAACTA_COVID19_Participant31    Epithelial_cells
                                            ...       
CGCGCCCTAGAC_Control_Participant15    Epithelial_cells
CGGACAGAATGG_Control_Participant15         Gametocytes
GTTTATTCATCA_Control_Participant15        Chondrocytes
TTTTTGTACTAT_Control_Participant15         Gametocytes
CGATTGTAGATC_Control_Participant15         Gametocytes
Name: singler_annotation, Length: 5809, dtype: string
cell type annotation :  TTGCGGTGACCA_COVID19_Participant31    Epithelial_cells
AGGCTCGAACTG_COVID19_Participant31    Epithelial_cells
TATCCGTATGTT_COVID19_Participant31             NK_cell
CAGACAGCGGCT_COVID19_Participant31    Epithelial_cells
CAAAGAGAACTA_COVID19_Participant31    Epithelial_cells
                                            ...       
CGCGCCCTAGAC_Control_Participant15    Epithelial_cells
CGGACAGAATGG_Control_Participant15         Gametocytes
GTTTATTCATCA_Control_Participant15        Chondrocytes
TTTTTGTACTAT_Control_Participant15         Gametocytes
CGATTGTAGATC_Control_Participant15         Gametocytes
Name: singler_annotation, Length: 5809, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Epithelial_cells', 'NK_cell', 'Keratinocytes', 'Macrophage', 'Neurons', 'T_cells', 'Monocyte', 'Chondrocytes', 'MEP', 'Neutrophils', 'Gametocytes', 'Endothelial_cells', 'HSC_CD34+', 'Hepatocytes', 'Tissue_stem_cells', 'Erythroblast', 'iPS_cells', 'DC', 'B_cell', 'Myelocyte', 'Astrocyte', 'Smooth_muscle_cells', 'Embryonic_stem_cells', 'HSC_-G-CSF', 'CMP', 'Osteoblasts', 'Platelets', 'BM & Prog.', 'BM', 'Fibroblasts', 'Neuroepithelial_cell', 'Unknown', 'Pro-B_cell_CD34+', 'Pre-B_cell_CD34-', 'Pro-Myelocyte', 'GMP', 'MSC']
라벨별 그룹 개수 {1: 7, 0: 3}
🔍 Split #2
  → train_p_index 환자 수 (환자 단위로 묶인 index list): 40
  → test_p_index 환자 수  (환자 단위로 묶인 index list): 10
  → train 환자 ID: ['COVID19_Participant10', 'COVID19_Participant11', 'COVID19_Participant13', 'COVID19_Participant14', 'COVID19_Participant17', 'COVID19_Participant18', 'COVID19_Participant19', 'COVID19_Participant2', 'COVID19_Participant20', 'COVID19_Participant21', 'COVID19_Participant22', 'COVID19_Participant23', 'COVID19_Participant25', 'COVID19_Participant26', 'COVID19_Participant27', 'COVID19_Participant28', 'COVID19_Participant29', 'COVID19_Participant30', 'COVID19_Participant35', 'COVID19_Participant37', 'COVID19_Participant38', 'COVID19_Participant39', 'COVID19_Participant4', 'COVID19_Participant40', 'COVID19_Participant6', 'COVID19_Participant7', 'COVID19_Participant8', 'COVID19_Participant9', 'Control_Participant1', 'Control_Participant10', 'Control_Participant11', 'Control_Participant12', 'Control_Participant14', 'Control_Participant2', 'Control_Participant4', 'Control_Participant5', 'Control_Participant6', 'Control_Participant7', 'Control_Participant8', 'Control_Participant9']
  → test  환자 ID: ['COVID19_Participant12', 'COVID19_Participant15', 'COVID19_Participant3', 'COVID19_Participant31', 'COVID19_Participant32', 'COVID19_Participant36', 'COVID19_Participant5', 'Control_Participant13', 'Control_Participant15', 'Control_Participant3']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant10, Label: 1
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant18, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant21, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant27, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant30, Label: 1
    ID: COVID19_Participant35, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant38, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: COVID19_Participant6, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: COVID19_Participant9, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant10, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant12, Label: 0
    ID: Control_Participant14, Label: 0
    ID: Control_Participant2, Label: 0
    ID: Control_Participant4, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant6, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant8, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: COVID19_Participant12, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant3, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant36, Label: 1
    ID: COVID19_Participant5, Label: 1
    ID: Control_Participant13, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant3, Label: 0
전체 데이터 index 길이 50
label_stat (train 환자 라벨 목록) 갯수 40
train_data에서 환자 단위로, train과 validation 나누기
기존 train_p_index 40
기존 (train) label_stat 40
train-vali 분할 후! 
train y 의 classes : {0, 1} valid y 의 classes : {0, 1} label_stat 의 classes : {0, 1}
train_p_index_ 26
valid_p_index 14
test_p_index 10
→ train 환자 ID 및 라벨:
   총 개수: 26
   환자ID=Control_Participant10, Label=0, 셀개수=1645
   환자ID=Control_Participant2, Label=0, 셀개수=41
   환자ID=COVID19_Participant19, Label=1, 셀개수=816
   환자ID=COVID19_Participant39, Label=1, 셀개수=454
   환자ID=COVID19_Participant10, Label=1, 셀개수=18
   환자ID=Control_Participant6, Label=0, 셀개수=131
   환자ID=COVID19_Participant14, Label=1, 셀개수=382
   환자ID=COVID19_Participant2, Label=1, 셀개수=329
   환자ID=COVID19_Participant40, Label=1, 셀개수=381
   환자ID=COVID19_Participant13, Label=1, 셀개수=730
   환자ID=COVID19_Participant20, Label=1, 셀개수=2033
   환자ID=Control_Participant4, Label=0, 셀개수=440
   환자ID=COVID19_Participant26, Label=1, 셀개수=814
   환자ID=Control_Participant8, Label=0, 셀개수=393
   환자ID=Control_Participant7, Label=0, 셀개수=762
   환자ID=COVID19_Participant17, Label=1, 셀개수=843
   환자ID=Control_Participant9, Label=0, 셀개수=558
   환자ID=Control_Participant11, Label=0, 셀개수=1164
   환자ID=COVID19_Participant22, Label=1, 셀개수=865
   환자ID=COVID19_Participant29, Label=1, 셀개수=573
   환자ID=COVID19_Participant25, Label=1, 셀개수=496
   환자ID=COVID19_Participant18, Label=1, 셀개수=227
   환자ID=COVID19_Participant7, Label=1, 셀개수=409
   환자ID=COVID19_Participant4, Label=1, 셀개수=1680
   환자ID=COVID19_Participant38, Label=1, 셀개수=51
   환자ID=COVID19_Participant28, Label=1, 셀개수=1079
→ valid 환자 ID 및 라벨:
   총 개수: 14
   환자ID=Control_Participant14, Label=0, 셀개수=274
   환자ID=COVID19_Participant27, Label=1, 셀개수=93
   환자ID=COVID19_Participant35, Label=1, 셀개수=83
   환자ID=COVID19_Participant30, Label=1, 셀개수=116
   환자ID=COVID19_Participant6, Label=1, 셀개수=84
   환자ID=COVID19_Participant21, Label=1, 셀개수=39
   환자ID=Control_Participant5, Label=0, 셀개수=717
   환자ID=Control_Participant1, Label=0, 셀개수=414
   환자ID=COVID19_Participant9, Label=1, 셀개수=86
   환자ID=COVID19_Participant8, Label=1, 셀개수=462
   환자ID=Control_Participant12, Label=0, 셀개수=99
   환자ID=COVID19_Participant37, Label=1, 셀개수=668
   환자ID=COVID19_Participant11, Label=1, 셀개수=382
   환자ID=COVID19_Participant23, Label=1, 셀개수=307
→ test 환자 ID 및 라벨:
   총 개수: 10
   환자ID=COVID19_Participant12, Label=1, 셀개수=102
   환자ID=COVID19_Participant15, Label=1, 셀개수=1003
   환자ID=COVID19_Participant3, Label=1, 셀개수=104
   환자ID=COVID19_Participant31, Label=1, 셀개수=410
   환자ID=COVID19_Participant32, Label=1, 셀개수=1665
   환자ID=COVID19_Participant36, Label=1, 셀개수=200
   환자ID=COVID19_Participant5, Label=1, 셀개수=89
   환자ID=Control_Participant13, Label=0, 셀개수=88
   환자ID=Control_Participant15, Label=0, 셀개수=528
   환자ID=Control_Participant3, Label=0, 셀개수=1620
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Keratinocytes', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Neurons', 'iPS_cells', 'Embryonic_stem_cells', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
전체 데이터 길이 26947
전체 cell type 길이 0           Keratinocytes
1        Epithelial_cells
2        Epithelial_cells
3        Epithelial_cells
4        Epithelial_cells
               ...       
26942    Epithelial_cells
26943         Gametocytes
26944        Chondrocytes
26945         Gametocytes
26946         Gametocytes
Length: 26947, dtype: string
cell type의 NaN 개수 체크 0
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:12,  7.70it/s]  2%|▏         | 2/100 [00:00<00:11,  8.70it/s]  3%|▎         | 3/100 [00:00<00:11,  8.53it/s]  4%|▍         | 4/100 [00:00<00:11,  8.06it/s]  5%|▌         | 5/100 [00:00<00:11,  8.08it/s]  6%|▌         | 6/100 [00:00<00:11,  8.24it/s]  7%|▋         | 7/100 [00:00<00:12,  7.47it/s]  9%|▉         | 9/100 [00:01<00:10,  8.38it/s] 10%|█         | 10/100 [00:01<00:10,  8.71it/s] 11%|█         | 11/100 [00:01<00:09,  8.91it/s] 13%|█▎        | 13/100 [00:01<00:09,  9.00it/s] 14%|█▍        | 14/100 [00:01<00:09,  8.93it/s] 15%|█▌        | 15/100 [00:01<00:09,  8.82it/s] 16%|█▌        | 16/100 [00:01<00:09,  9.04it/s] 17%|█▋        | 17/100 [00:01<00:09,  8.79it/s] 18%|█▊        | 18/100 [00:02<00:09,  8.98it/s] 19%|█▉        | 19/100 [00:02<00:08,  9.00it/s] 20%|██        | 20/100 [00:02<00:08,  8.90it/s] 21%|██        | 21/100 [00:02<00:08,  8.91it/s] 22%|██▏       | 22/100 [00:02<00:08,  8.81it/s] 23%|██▎       | 23/100 [00:02<00:09,  8.10it/s] 24%|██▍       | 24/100 [00:02<00:09,  8.19it/s] 25%|██▌       | 25/100 [00:02<00:09,  8.17it/s] 26%|██▌       | 26/100 [00:03<00:09,  7.61it/s] 27%|██▋       | 27/100 [00:03<00:09,  7.77it/s] 28%|██▊       | 28/100 [00:03<00:09,  7.94it/s] 29%|██▉       | 29/100 [00:03<00:08,  8.29it/s] 30%|███       | 30/100 [00:03<00:08,  8.63it/s] 31%|███       | 31/100 [00:03<00:07,  8.89it/s] 32%|███▏      | 32/100 [00:03<00:07,  8.94it/s] 33%|███▎      | 33/100 [00:03<00:07,  8.70it/s] 34%|███▍      | 34/100 [00:03<00:07,  8.96it/s] 35%|███▌      | 35/100 [00:04<00:09,  7.04it/s] 36%|███▌      | 36/100 [00:04<00:08,  7.28it/s] 37%|███▋      | 37/100 [00:04<00:08,  7.74it/s] 38%|███▊      | 38/100 [00:04<00:07,  8.22it/s] 39%|███▉      | 39/100 [00:04<00:07,  8.01it/s] 40%|████      | 40/100 [00:04<00:07,  8.02it/s] 41%|████      | 41/100 [00:04<00:07,  7.56it/s] 42%|████▏     | 42/100 [00:05<00:07,  8.00it/s] 43%|████▎     | 43/100 [00:05<00:07,  8.06it/s] 44%|████▍     | 44/100 [00:05<00:06,  8.43it/s] 45%|████▌     | 45/100 [00:05<00:06,  8.58it/s] 46%|████▌     | 46/100 [00:05<00:06,  7.85it/s] 47%|████▋     | 47/100 [00:05<00:07,  7.30it/s] 48%|████▊     | 48/100 [00:05<00:06,  7.45it/s] 49%|████▉     | 49/100 [00:05<00:06,  7.72it/s] 50%|█████     | 50/100 [00:06<00:06,  7.28it/s] 51%|█████     | 51/100 [00:06<00:06,  7.62it/s] 52%|█████▏    | 52/100 [00:06<00:06,  7.79it/s] 53%|█████▎    | 53/100 [00:06<00:06,  7.62it/s] 54%|█████▍    | 54/100 [00:06<00:06,  7.66it/s] 55%|█████▌    | 55/100 [00:06<00:05,  7.66it/s] 56%|█████▌    | 56/100 [00:06<00:05,  7.97it/s] 57%|█████▋    | 57/100 [00:06<00:05,  7.92it/s] 58%|█████▊    | 58/100 [00:07<00:05,  7.90it/s] 59%|█████▉    | 59/100 [00:07<00:05,  7.89it/s] 60%|██████    | 60/100 [00:07<00:05,  7.88it/s] 61%|██████    | 61/100 [00:07<00:04,  8.17it/s] 62%|██████▏   | 62/100 [00:07<00:04,  8.00it/s] 63%|██████▎   | 63/100 [00:07<00:04,  8.32it/s] 64%|██████▍   | 64/100 [00:07<00:04,  7.69it/s] 65%|██████▌   | 65/100 [00:07<00:04,  8.05it/s] 66%|██████▌   | 66/100 [00:08<00:04,  8.11it/s] 67%|██████▋   | 67/100 [00:08<00:03,  8.26it/s] 68%|██████▊   | 68/100 [00:08<00:03,  8.03it/s] 69%|██████▉   | 69/100 [00:08<00:04,  7.61it/s] 70%|███████   | 70/100 [00:08<00:03,  7.94it/s] 71%|███████   | 71/100 [00:08<00:03,  8.05it/s] 72%|███████▏  | 72/100 [00:08<00:03,  8.23it/s] 73%|███████▎  | 73/100 [00:08<00:03,  8.03it/s] 74%|███████▍  | 74/100 [00:09<00:03,  8.06it/s] 75%|███████▌  | 75/100 [00:09<00:03,  8.19it/s] 76%|███████▌  | 76/100 [00:09<00:03,  7.88it/s] 77%|███████▋  | 77/100 [00:09<00:02,  7.92it/s] 78%|███████▊  | 78/100 [00:09<00:03,  6.99it/s] 79%|███████▉  | 79/100 [00:09<00:02,  7.33it/s] 80%|████████  | 80/100 [00:09<00:02,  7.52it/s] 81%|████████  | 81/100 [00:10<00:02,  7.54it/s] 82%|████████▏ | 82/100 [00:10<00:02,  7.61it/s] 83%|████████▎ | 83/100 [00:10<00:02,  7.89it/s] 84%|████████▍ | 84/100 [00:10<00:02,  7.96it/s] 85%|████████▌ | 85/100 [00:10<00:01,  7.55it/s] 86%|████████▌ | 86/100 [00:10<00:01,  7.58it/s] 87%|████████▋ | 87/100 [00:10<00:01,  6.62it/s] 88%|████████▊ | 88/100 [00:10<00:01,  7.02it/s] 89%|████████▉ | 89/100 [00:11<00:01,  5.72it/s] 90%|█████████ | 90/100 [00:11<00:01,  6.37it/s] 91%|█████████ | 91/100 [00:11<00:01,  6.65it/s] 92%|█████████▏| 92/100 [00:11<00:01,  7.02it/s] 93%|█████████▎| 93/100 [00:11<00:00,  7.35it/s] 94%|█████████▍| 94/100 [00:11<00:00,  7.71it/s] 95%|█████████▌| 95/100 [00:11<00:00,  7.53it/s] 96%|█████████▌| 96/100 [00:12<00:00,  7.71it/s] 97%|█████████▋| 97/100 [00:12<00:00,  7.76it/s] 98%|█████████▊| 98/100 [00:12<00:00,  7.55it/s] 99%|█████████▉| 99/100 [00:12<00:00,  7.62it/s]100%|██████████| 100/100 [00:12<00:00,  6.93it/s]100%|██████████| 100/100 [00:12<00:00,  7.88it/s]
[I 2025-08-31 15:07:21,628] A new study created in memory with name: no-name-f3f6e54d-1596-4a6d-9efb-8fae00d734d0
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 29.04 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.617372, Valid_loss 0.613322
Epoch 2, Train Loss 0.602025, Valid_loss 0.598103
Epoch 3, Train Loss 0.615413, Valid_loss 0.613860
Epoch 4, Train Loss 0.627638, Valid_loss 0.601202
Epoch 5, Train Loss 0.620252, Valid_loss 0.598707
Epoch 6, Train Loss 0.626469, Valid_loss 0.599705
Epoch 7, Train Loss 0.600617, Valid_loss 0.598497
Epoch 8, Train Loss 0.619159, Valid_loss 0.598570
Epoch 9, Train Loss 0.609234, Valid_loss 0.598470
Epoch 10, Train Loss 0.624965, Valid_loss 0.601425
Epoch 11, Train Loss 0.597028, Valid_loss 0.598317
Epoch 12, Train Loss 0.613103, Valid_loss 0.599426
Epoch 13, Train Loss 0.619751, Valid_loss 0.598306
Epoch 14, Train Loss 0.585605, Valid_loss 0.599498
Epoch 15, Train Loss 0.599910, Valid_loss 0.598193
Epoch 16, Train Loss 0.593196, Valid_loss 0.598218
Epoch 17, Train Loss 0.583832, Valid_loss 0.598590
Epoch 18, Train Loss 0.601548, Valid_loss 0.598249
Epoch 19, Train Loss 0.611335, Valid_loss 0.598652
Epoch 20, Train Loss 0.580319, Valid_loss 0.598364
Epoch 21, Train Loss 0.610840, Valid_loss 0.580941
Epoch 22, Train Loss 0.600312, Valid_loss 0.593229
Epoch 23, Train Loss 0.587911, Valid_loss 0.594690
Epoch 24, Train Loss 0.591728, Valid_loss 0.608933
Epoch 25, Train Loss 0.546957, Valid_loss 0.763745
Epoch 26, Train Loss 0.605166, Valid_loss 0.628789
Epoch 27, Train Loss 0.615404, Valid_loss 0.607430
Epoch 28, Train Loss 0.602056, Valid_loss 0.610207
Epoch 29, Train Loss 0.559193, Valid_loss 0.766118
Epoch 30, Train Loss 0.492485, Valid_loss 0.979324
Epoch 31, Train Loss 0.460297, Valid_loss 0.752346
Epoch 32, Train Loss 0.400137, Valid_loss 0.870873
Epoch 33, Train Loss 0.451587, Valid_loss 0.775726
Epoch 34, Train Loss 0.434448, Valid_loss 1.041784
Epoch 35, Train Loss 0.397285, Valid_loss 1.395754
Epoch 36, Train Loss 0.365431, Valid_loss 1.589630
Epoch 37, Train Loss 0.399219, Valid_loss 1.722092
Epoch 38, Train Loss 0.359761, Valid_loss 1.788025
Epoch 39, Train Loss 0.409018, Valid_loss 2.360017
Epoch 40, Train Loss 0.410842, Valid_loss 2.112834
Epoch 41, Train Loss 0.360181, Valid_loss 2.172464
Epoch 42, Train Loss 0.430487, Valid_loss 2.151747
Epoch 43, Train Loss 0.436566, Valid_loss 2.284558
Epoch 44, Train Loss 0.460486, Valid_loss 1.917674
Epoch 45, Train Loss 0.427192, Valid_loss 1.501889
Epoch 46, Train Loss 0.436517, Valid_loss 1.698807
Epoch 47, Train Loss 0.365705, Valid_loss 1.635316
Epoch 48, Train Loss 0.348400, Valid_loss 1.693200
Epoch 49, Train Loss 0.381537, Valid_loss 1.662288
Epoch 50, Train Loss 0.364332, Valid_loss 1.699429
Epoch 51, Train Loss 0.325540, Valid_loss 1.782650
Epoch 52, Train Loss 0.357750, Valid_loss 1.819890
[I 2025-08-31 15:11:26,523] Trial 0 finished with value: 0.5809413301093238 and parameters: {'learning_rate': 0.01, 'epochs': 100, 'heads': 4, 'dropout': 0.7, 'weight_decay': 0.0001, 'emb_dim': 64, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.5809413301093238.
👉 train samples(학습 샘플(bag))=126, batch_size=16 -> steps(샘플수/batch크기)=8
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 26.96 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.749940, Valid_loss 0.599641
Epoch 2, Train Loss 0.610622, Valid_loss 0.599730
Epoch 3, Train Loss 0.620749, Valid_loss 0.598560
Epoch 4, Train Loss 0.640022, Valid_loss 0.598281
Epoch 5, Train Loss 0.575462, Valid_loss 0.598628
Epoch 6, Train Loss 0.607503, Valid_loss 0.598186
Epoch 7, Train Loss 0.616516, Valid_loss 0.599234
Epoch 8, Train Loss 0.622304, Valid_loss 0.602277
Epoch 9, Train Loss 0.626706, Valid_loss 0.599230
Epoch 10, Train Loss 0.583010, Valid_loss 0.598065
Epoch 11, Train Loss 0.618427, Valid_loss 0.598140
Epoch 12, Train Loss 0.609606, Valid_loss 0.597974
Epoch 13, Train Loss 0.595684, Valid_loss 0.597634
Epoch 14, Train Loss 0.599333, Valid_loss 0.597296
Epoch 15, Train Loss 0.600574, Valid_loss 0.596902
Epoch 16, Train Loss 0.604529, Valid_loss 0.596807
Epoch 17, Train Loss 0.602191, Valid_loss 0.595727
Epoch 18, Train Loss 0.592875, Valid_loss 0.592792
Epoch 19, Train Loss 0.602620, Valid_loss 0.585370
Epoch 20, Train Loss 0.575119, Valid_loss 0.549550
Epoch 21, Train Loss 0.521376, Valid_loss 0.493003
Epoch 22, Train Loss 0.525842, Valid_loss 0.481771
Epoch 23, Train Loss 0.497113, Valid_loss 0.452452
Epoch 24, Train Loss 0.421278, Valid_loss 0.499941
Epoch 25, Train Loss 0.432004, Valid_loss 0.385898
Epoch 26, Train Loss 0.393455, Valid_loss 0.405636
Epoch 27, Train Loss 0.445613, Valid_loss 0.260970
Epoch 28, Train Loss 0.416007, Valid_loss 0.271449
Epoch 29, Train Loss 0.363583, Valid_loss 0.726786
Epoch 30, Train Loss 0.365822, Valid_loss 0.232021
Epoch 31, Train Loss 0.331936, Valid_loss 0.338375
Epoch 32, Train Loss 0.359249, Valid_loss 0.397074
Epoch 33, Train Loss 0.377114, Valid_loss 0.214463
Epoch 34, Train Loss 0.427547, Valid_loss 0.449944
Epoch 35, Train Loss 0.374215, Valid_loss 0.306563
Epoch 36, Train Loss 0.348624, Valid_loss 0.281563
Epoch 37, Train Loss 0.350258, Valid_loss 0.379687
Epoch 38, Train Loss 0.344356, Valid_loss 0.438291
Epoch 39, Train Loss 0.365726, Valid_loss 0.324223
Epoch 40, Train Loss 0.325516, Valid_loss 0.204282
Epoch 41, Train Loss 0.292940, Valid_loss 0.384400
Epoch 42, Train Loss 0.323899, Valid_loss 0.486078
Epoch 43, Train Loss 0.309027, Valid_loss 0.340632
Epoch 44, Train Loss 0.351896, Valid_loss 1.018179
Epoch 45, Train Loss 0.301085, Valid_loss 0.294971
Epoch 46, Train Loss 0.312784, Valid_loss 0.425706
Epoch 47, Train Loss 0.347103, Valid_loss 0.971318
Epoch 48, Train Loss 0.331903, Valid_loss 1.851511
Epoch 49, Train Loss 0.366710, Valid_loss 1.686259
Epoch 50, Train Loss 0.332579, Valid_loss 2.130809
Epoch 51, Train Loss 0.327933, Valid_loss 1.981405
Epoch 52, Train Loss 0.286857, Valid_loss 1.884320
Epoch 53, Train Loss 0.330388, Valid_loss 1.891146
Epoch 54, Train Loss 0.292693, Valid_loss 1.876447
Epoch 55, Train Loss 0.284618, Valid_loss 1.901738
Epoch 56, Train Loss 0.313815, Valid_loss 1.868482
Epoch 57, Train Loss 0.279851, Valid_loss 1.921181
Epoch 58, Train Loss 0.298285, Valid_loss 1.909306
Epoch 59, Train Loss 0.278146, Valid_loss 2.034290
Epoch 60, Train Loss 0.289757, Valid_loss 2.062295
[I 2025-08-31 15:15:11,045] Trial 1 finished with value: 0.20428218998547112 and parameters: {'learning_rate': 0.01, 'epochs': 100, 'heads': 1, 'dropout': 0.7, 'weight_decay': 0.001, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 1 with value: 0.20428218998547112.
👉 train samples(학습 샘플(bag))=126, batch_size=16 -> steps(샘플수/batch크기)=8
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 25.64 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.624362, Valid_loss 0.596860
Epoch 2, Train Loss 0.583491, Valid_loss 0.602705
Epoch 3, Train Loss 0.587627, Valid_loss 0.600941
Epoch 4, Train Loss 0.587445, Valid_loss 0.586867
Epoch 5, Train Loss 0.571144, Valid_loss 0.507354
Epoch 6, Train Loss 0.514846, Valid_loss 0.466875
Epoch 7, Train Loss 0.474355, Valid_loss 0.496363
Epoch 8, Train Loss 0.488217, Valid_loss 0.405255
Epoch 9, Train Loss 0.409681, Valid_loss 0.434719
Epoch 10, Train Loss 0.373143, Valid_loss 0.511374
Epoch 11, Train Loss 0.358569, Valid_loss 0.496295
Epoch 12, Train Loss 0.354588, Valid_loss 0.470868
Epoch 13, Train Loss 0.323515, Valid_loss 0.332335
Epoch 14, Train Loss 0.308816, Valid_loss 0.403275
Epoch 15, Train Loss 0.300847, Valid_loss 0.328507
Epoch 16, Train Loss 0.303708, Valid_loss 0.266114
Epoch 17, Train Loss 0.333762, Valid_loss 0.285622
Epoch 18, Train Loss 0.352551, Valid_loss 0.481522
Epoch 19, Train Loss 0.343333, Valid_loss 0.293630
Epoch 20, Train Loss 0.311783, Valid_loss 0.298274
Epoch 21, Train Loss 0.306830, Valid_loss 0.276162
Epoch 22, Train Loss 0.290121, Valid_loss 0.271196
Epoch 23, Train Loss 0.285408, Valid_loss 0.265344
Epoch 24, Train Loss 0.281800, Valid_loss 0.265373
Epoch 25, Train Loss 0.274897, Valid_loss 0.292521
Epoch 26, Train Loss 0.296855, Valid_loss 0.449655
Epoch 27, Train Loss 0.293456, Valid_loss 0.446417
Epoch 28, Train Loss 0.284079, Valid_loss 0.334061
Epoch 29, Train Loss 0.268978, Valid_loss 0.324247
Epoch 30, Train Loss 0.259895, Valid_loss 0.376629
Epoch 31, Train Loss 0.271077, Valid_loss 0.533010
Epoch 32, Train Loss 0.333853, Valid_loss 0.465644
Epoch 33, Train Loss 0.306623, Valid_loss 0.289418
Epoch 34, Train Loss 0.294097, Valid_loss 0.390971
Epoch 35, Train Loss 0.279934, Valid_loss 0.414326
Epoch 36, Train Loss 0.281865, Valid_loss 0.338380
Epoch 37, Train Loss 0.303850, Valid_loss 0.261368
Epoch 38, Train Loss 0.291503, Valid_loss 0.245913
Epoch 39, Train Loss 0.303839, Valid_loss 0.236799
Epoch 40, Train Loss 0.270120, Valid_loss 0.247542
Epoch 41, Train Loss 0.259732, Valid_loss 0.230058
Epoch 42, Train Loss 0.270174, Valid_loss 0.331065
Epoch 43, Train Loss 0.281535, Valid_loss 0.421356
Epoch 44, Train Loss 0.312389, Valid_loss 0.247585
Epoch 45, Train Loss 0.297725, Valid_loss 0.288195
Epoch 46, Train Loss 0.272139, Valid_loss 0.272808
Epoch 47, Train Loss 0.278266, Valid_loss 0.349585
Epoch 48, Train Loss 0.278030, Valid_loss 0.344529
Epoch 49, Train Loss 0.285928, Valid_loss 0.272549
Epoch 50, Train Loss 0.266765, Valid_loss 0.297715
Epoch 51, Train Loss 0.262290, Valid_loss 0.361396
Epoch 52, Train Loss 0.253691, Valid_loss 0.357161
Epoch 53, Train Loss 0.243588, Valid_loss 0.348107
Epoch 54, Train Loss 0.241236, Valid_loss 0.321737
Epoch 55, Train Loss 0.237623, Valid_loss 0.340394
Epoch 56, Train Loss 0.233533, Valid_loss 0.315610
Epoch 57, Train Loss 0.233226, Valid_loss 0.333089
Epoch 58, Train Loss 0.232942, Valid_loss 0.375938
[I 2025-08-31 15:19:00,988] Trial 2 finished with value: 0.23005842098167964 and parameters: {'learning_rate': 0.01, 'epochs': 100, 'heads': 2, 'dropout': 0.0, 'weight_decay': 0.01, 'emb_dim': 8, 'augment_num': 100, 'pca': False}. Best is trial 1 with value: 0.20428218998547112.
선택된 trial params: {'learning_rate': 0.01, 'epochs': 100, 'heads': 1, 'dropout': 0.7, 'weight_decay': 0.001, 'emb_dim': 32, 'augment_num': 100, 'pca': False}
👉 train samples(학습 샘플(bag))=126, batch_size=16 -> steps(샘플수/batch크기)=8
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=10, batch_size=1 -> steps=10
output_class :  1
Memory Allocated: 26.96 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.702296, Valid_loss 0.599360
Epoch 2, Train Loss 0.625084, Valid_loss 0.602594
Epoch 3, Train Loss 0.607821, Valid_loss 0.599116
Epoch 4, Train Loss 0.606062, Valid_loss 0.598376
Epoch 5, Train Loss 0.612522, Valid_loss 0.598134
Epoch 6, Train Loss 0.597176, Valid_loss 0.598447
Epoch 7, Train Loss 0.603974, Valid_loss 0.599028
Epoch 8, Train Loss 0.606664, Valid_loss 0.598092
Epoch 9, Train Loss 0.586975, Valid_loss 0.598308
Epoch 10, Train Loss 0.589670, Valid_loss 0.598422
Epoch 11, Train Loss 0.616323, Valid_loss 0.598172
Epoch 12, Train Loss 0.603323, Valid_loss 0.598116
Epoch 13, Train Loss 0.596132, Valid_loss 0.598489
Epoch 14, Train Loss 0.587766, Valid_loss 0.597871
Epoch 15, Train Loss 0.591483, Valid_loss 0.599642
Epoch 16, Train Loss 0.600351, Valid_loss 0.598883
Epoch 17, Train Loss 0.582433, Valid_loss 0.599046
Epoch 18, Train Loss 0.593307, Valid_loss 0.599572
Epoch 19, Train Loss 0.570350, Valid_loss 0.600184
Epoch 20, Train Loss 0.588996, Valid_loss 0.597686
Epoch 21, Train Loss 0.614037, Valid_loss 0.597524
Epoch 22, Train Loss 0.597158, Valid_loss 0.597926
Epoch 23, Train Loss 0.610425, Valid_loss 0.597393
Epoch 24, Train Loss 0.589754, Valid_loss 0.595231
Epoch 25, Train Loss 0.588975, Valid_loss 0.591548
Epoch 26, Train Loss 0.587752, Valid_loss 0.574462
Epoch 27, Train Loss 0.566486, Valid_loss 0.486689
Epoch 28, Train Loss 0.573607, Valid_loss 0.642833
Epoch 29, Train Loss 0.608363, Valid_loss 0.597720
Epoch 30, Train Loss 0.620453, Valid_loss 0.595055
Epoch 31, Train Loss 0.565678, Valid_loss 0.563981
Epoch 32, Train Loss 0.547606, Valid_loss 0.536305
Epoch 33, Train Loss 0.514666, Valid_loss 0.494957
Epoch 34, Train Loss 0.481322, Valid_loss 0.462366
Epoch 35, Train Loss 0.457679, Valid_loss 0.576940
Epoch 36, Train Loss 0.416913, Valid_loss 0.503867
Epoch 37, Train Loss 0.407878, Valid_loss 0.456466
Epoch 38, Train Loss 0.396993, Valid_loss 0.445725
Epoch 39, Train Loss 0.378903, Valid_loss 0.404495
Epoch 40, Train Loss 0.367549, Valid_loss 0.535679
Epoch 41, Train Loss 0.358653, Valid_loss 0.534497
Epoch 42, Train Loss 0.402574, Valid_loss 0.501039
Epoch 43, Train Loss 0.361850, Valid_loss 0.519014
Epoch 44, Train Loss 0.374608, Valid_loss 0.545650
Epoch 45, Train Loss 0.359812, Valid_loss 0.645349
Epoch 46, Train Loss 0.375884, Valid_loss 0.544865
Epoch 47, Train Loss 0.379993, Valid_loss 0.529027
Epoch 48, Train Loss 0.340883, Valid_loss 0.513693
Epoch 49, Train Loss 0.381787, Valid_loss 0.295717
Epoch 50, Train Loss 0.370541, Valid_loss 0.255441
Epoch 51, Train Loss 0.330448, Valid_loss 0.367648
Epoch 52, Train Loss 0.337507, Valid_loss 0.617008
환자ID=COVID19_Participant12 -- true: 1 -- pred: 1
환자ID=COVID19_Participant15 -- true: 1 -- pred: 1
환자ID=COVID19_Participant3 -- true: 1 -- pred: 1
환자ID=COVID19_Participant31 -- true: 1 -- pred: 0
환자ID=COVID19_Participant32 -- true: 1 -- pred: 0
환자ID=COVID19_Participant36 -- true: 1 -- pred: 1
환자ID=COVID19_Participant5 -- true: 1 -- pred: 1
환자ID=Control_Participant13 -- true: 0 -- pred: 0
환자ID=Control_Participant15 -- true: 0 -- pred: 0
환자ID=Control_Participant3 -- true: 0 -- pred: 0
Best performance: Epoch 50, Loss 0.370541, Test ACC 0.800000, Test AUC 0.904762, Test Recall 0.714286, Test Precision 1.000000
Confusion Matrix:
 [3 0 2 5]
✅ Total valid splits used: 2
🔁 Repeat 0, Fold 2
cell type :  GTCGGGGGGTGG_Control_Participant7        Keratinocytes
CAAATCAATTAT_Control_Participant7     Epithelial_cells
ATACAATTGACA_Control_Participant7     Epithelial_cells
CTGTTAATGAGA_Control_Participant7     Epithelial_cells
CTTCACATTATT_Control_Participant7     Epithelial_cells
                                            ...       
GCAGGGAACTCC_COVID19_Participant30    Epithelial_cells
CAGCACCGAGCC_COVID19_Participant30    Epithelial_cells
GCCCCTTGTGAT_COVID19_Participant30    Epithelial_cells
GTGTTGTGTGTC_COVID19_Participant30              B_cell
TAACACTCACTT_COVID19_Participant30           Myelocyte
Name: singler_annotation, Length: 22316, dtype: string
cell type annotation :  GTCGGGGGGTGG_Control_Participant7        Keratinocytes
CAAATCAATTAT_Control_Participant7     Epithelial_cells
ATACAATTGACA_Control_Participant7     Epithelial_cells
CTGTTAATGAGA_Control_Participant7     Epithelial_cells
CTTCACATTATT_Control_Participant7     Epithelial_cells
                                            ...       
GCAGGGAACTCC_COVID19_Participant30    Epithelial_cells
CAGCACCGAGCC_COVID19_Participant30    Epithelial_cells
GCCCCTTGTGAT_COVID19_Participant30    Epithelial_cells
GTGTTGTGTGTC_COVID19_Participant30              B_cell
TAACACTCACTT_COVID19_Participant30           Myelocyte
Name: singler_annotation, Length: 22316, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Keratinocytes', 'Epithelial_cells', 'Neurons', 'iPS_cells', 'Embryonic_stem_cells', 'Astrocyte', 'DC', 'Gametocytes', 'HSC_-G-CSF', 'Smooth_muscle_cells', 'BM & Prog.', 'Monocyte', 'Myelocyte', 'BM', 'Endothelial_cells', 'Osteoblasts', 'Platelets', 'Erythroblast', 'NK_cell', 'T_cells', 'Chondrocytes', 'HSC_CD34+', 'CMP', 'Neutrophils', 'Fibroblasts', 'MEP', 'Neuroepithelial_cell', 'MSC', 'Pro-Myelocyte', 'B_cell', 'GMP', 'Hepatocytes', 'Macrophage', 'Tissue_stem_cells', 'Pre-B_cell_CD34-', 'Pro-B_cell_CD34+', 'Unknown']
라벨별 그룹 개수 {1: 28, 0: 12}
cell type :  CGAACGGACTCC_Control_Participant12       Epithelial_cells
GTGTCCTGGGGT_Control_Participant12    Smooth_muscle_cells
ATTTGCCTGTCG_Control_Participant12       Epithelial_cells
TCTCTAAAGTGT_Control_Participant12                Neurons
TAGAGACAACGA_Control_Participant12       Epithelial_cells
                                             ...         
GCGCCCGTGTTA_COVID19_Participant27       Epithelial_cells
TTGATCCGTGGC_COVID19_Participant27                T_cells
CGCGACTACTCT_COVID19_Participant27       Epithelial_cells
AAACGCTTGTTA_COVID19_Participant27       Epithelial_cells
CATTGGGGGAAA_COVID19_Participant27    Smooth_muscle_cells
Name: singler_annotation, Length: 4631, dtype: string
cell type annotation :  CGAACGGACTCC_Control_Participant12       Epithelial_cells
GTGTCCTGGGGT_Control_Participant12    Smooth_muscle_cells
ATTTGCCTGTCG_Control_Participant12       Epithelial_cells
TCTCTAAAGTGT_Control_Participant12                Neurons
TAGAGACAACGA_Control_Participant12       Epithelial_cells
                                             ...         
GCGCCCGTGTTA_COVID19_Participant27       Epithelial_cells
TTGATCCGTGGC_COVID19_Participant27                T_cells
CGCGACTACTCT_COVID19_Participant27       Epithelial_cells
AAACGCTTGTTA_COVID19_Participant27       Epithelial_cells
CATTGGGGGAAA_COVID19_Participant27    Smooth_muscle_cells
Name: singler_annotation, Length: 4631, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Epithelial_cells', 'Smooth_muscle_cells', 'Neurons', 'Erythroblast', 'Keratinocytes', 'T_cells', 'Gametocytes', 'B_cell', 'Neutrophils', 'HSC_CD34+', 'MSC', 'Embryonic_stem_cells', 'Neuroepithelial_cell', 'HSC_-G-CSF', 'MEP', 'Endothelial_cells', 'NK_cell', 'Astrocyte', 'CMP', 'GMP', 'Platelets', 'BM & Prog.', 'Monocyte', 'Myelocyte', 'Pro-B_cell_CD34+', 'DC', 'Osteoblasts', 'BM', 'Macrophage', 'Pro-Myelocyte', 'Fibroblasts', 'Pre-B_cell_CD34-', 'Chondrocytes', 'Tissue_stem_cells', 'Hepatocytes', 'iPS_cells']
라벨별 그룹 개수 {1: 7, 0: 3}
🔍 Split #3
  → train_p_index 환자 수 (환자 단위로 묶인 index list): 40
  → test_p_index 환자 수  (환자 단위로 묶인 index list): 10
  → train 환자 ID: ['COVID19_Participant10', 'COVID19_Participant11', 'COVID19_Participant12', 'COVID19_Participant13', 'COVID19_Participant15', 'COVID19_Participant17', 'COVID19_Participant18', 'COVID19_Participant19', 'COVID19_Participant20', 'COVID19_Participant21', 'COVID19_Participant22', 'COVID19_Participant25', 'COVID19_Participant26', 'COVID19_Participant28', 'COVID19_Participant29', 'COVID19_Participant3', 'COVID19_Participant30', 'COVID19_Participant31', 'COVID19_Participant32', 'COVID19_Participant35', 'COVID19_Participant36', 'COVID19_Participant37', 'COVID19_Participant39', 'COVID19_Participant40', 'COVID19_Participant5', 'COVID19_Participant6', 'COVID19_Participant7', 'COVID19_Participant8', 'Control_Participant1', 'Control_Participant10', 'Control_Participant13', 'Control_Participant14', 'Control_Participant15', 'Control_Participant2', 'Control_Participant3', 'Control_Participant5', 'Control_Participant6', 'Control_Participant7', 'Control_Participant8', 'Control_Participant9']
  → test  환자 ID: ['COVID19_Participant14', 'COVID19_Participant2', 'COVID19_Participant23', 'COVID19_Participant27', 'COVID19_Participant38', 'COVID19_Participant4', 'COVID19_Participant9', 'Control_Participant11', 'Control_Participant12', 'Control_Participant4']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant10, Label: 1
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant12, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant18, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant21, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant3, Label: 1
    ID: COVID19_Participant30, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant35, Label: 1
    ID: COVID19_Participant36, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: COVID19_Participant5, Label: 1
    ID: COVID19_Participant6, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant10, Label: 0
    ID: Control_Participant13, Label: 0
    ID: Control_Participant14, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant2, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant6, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant8, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant27, Label: 1
    ID: COVID19_Participant38, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant9, Label: 1
    ID: Control_Participant11, Label: 0
    ID: Control_Participant12, Label: 0
    ID: Control_Participant4, Label: 0
전체 데이터 index 길이 50
label_stat (train 환자 라벨 목록) 갯수 40
train_data에서 환자 단위로, train과 validation 나누기
기존 train_p_index 40
기존 (train) label_stat 40
train-vali 분할 후! 
train y 의 classes : {0, 1} valid y 의 classes : {0, 1} label_stat 의 classes : {0, 1}
train_p_index_ 26
valid_p_index 14
test_p_index 10
→ train 환자 ID 및 라벨:
   총 개수: 26
   환자ID=Control_Participant10, Label=0, 셀개수=1645
   환자ID=Control_Participant2, Label=0, 셀개수=41
   환자ID=COVID19_Participant18, Label=1, 셀개수=227
   환자ID=COVID19_Participant37, Label=1, 셀개수=668
   환자ID=COVID19_Participant10, Label=1, 셀개수=18
   환자ID=Control_Participant6, Label=0, 셀개수=131
   환자ID=COVID19_Participant13, Label=1, 셀개수=730
   환자ID=COVID19_Participant19, Label=1, 셀개수=816
   환자ID=COVID19_Participant40, Label=1, 셀개수=381
   환자ID=COVID19_Participant12, Label=1, 셀개수=102
   환자ID=COVID19_Participant20, Label=1, 셀개수=2033
   환자ID=Control_Participant3, Label=0, 셀개수=1620
   환자ID=COVID19_Participant28, Label=1, 셀개수=1079
   환자ID=Control_Participant8, Label=0, 셀개수=393
   환자ID=Control_Participant7, Label=0, 셀개수=762
   환자ID=COVID19_Participant15, Label=1, 셀개수=1003
   환자ID=Control_Participant9, Label=0, 셀개수=558
   환자ID=Control_Participant13, Label=0, 셀개수=88
   환자ID=COVID19_Participant22, Label=1, 셀개수=865
   환자ID=COVID19_Participant30, Label=1, 셀개수=116
   환자ID=COVID19_Participant26, Label=1, 셀개수=814
   환자ID=COVID19_Participant17, Label=1, 셀개수=843
   환자ID=COVID19_Participant6, Label=1, 셀개수=84
   환자ID=COVID19_Participant39, Label=1, 셀개수=454
   환자ID=COVID19_Participant36, Label=1, 셀개수=200
   환자ID=COVID19_Participant3, Label=1, 셀개수=104
→ valid 환자 ID 및 라벨:
   총 개수: 14
   환자ID=Control_Participant15, Label=0, 셀개수=528
   환자ID=COVID19_Participant29, Label=1, 셀개수=573
   환자ID=COVID19_Participant32, Label=1, 셀개수=1665
   환자ID=COVID19_Participant31, Label=1, 셀개수=410
   환자ID=COVID19_Participant5, Label=1, 셀개수=89
   환자ID=COVID19_Participant21, Label=1, 셀개수=39
   환자ID=Control_Participant5, Label=0, 셀개수=717
   환자ID=Control_Participant1, Label=0, 셀개수=414
   환자ID=COVID19_Participant8, Label=1, 셀개수=462
   환자ID=COVID19_Participant7, Label=1, 셀개수=409
   환자ID=Control_Participant14, Label=0, 셀개수=274
   환자ID=COVID19_Participant35, Label=1, 셀개수=83
   환자ID=COVID19_Participant11, Label=1, 셀개수=382
   환자ID=COVID19_Participant25, Label=1, 셀개수=496
→ test 환자 ID 및 라벨:
   총 개수: 10
   환자ID=COVID19_Participant14, Label=1, 셀개수=382
   환자ID=COVID19_Participant2, Label=1, 셀개수=329
   환자ID=COVID19_Participant23, Label=1, 셀개수=307
   환자ID=COVID19_Participant27, Label=1, 셀개수=93
   환자ID=COVID19_Participant38, Label=1, 셀개수=51
   환자ID=COVID19_Participant4, Label=1, 셀개수=1680
   환자ID=COVID19_Participant9, Label=1, 셀개수=86
   환자ID=Control_Participant11, Label=0, 셀개수=1164
   환자ID=Control_Participant12, Label=0, 셀개수=99
   환자ID=Control_Participant4, Label=0, 셀개수=440
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Keratinocytes', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Neurons', 'iPS_cells', 'Embryonic_stem_cells', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
전체 데이터 길이 26947
전체 cell type 길이 0              Keratinocytes
1           Epithelial_cells
2           Epithelial_cells
3           Epithelial_cells
4           Epithelial_cells
                ...         
26942       Epithelial_cells
26943                T_cells
26944       Epithelial_cells
26945       Epithelial_cells
26946    Smooth_muscle_cells
Length: 26947, dtype: string
cell type의 NaN 개수 체크 0
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:15,  6.59it/s]  2%|▏         | 2/100 [00:00<00:12,  7.75it/s]  3%|▎         | 3/100 [00:00<00:11,  8.09it/s]  4%|▍         | 4/100 [00:00<00:11,  8.42it/s]  6%|▌         | 6/100 [00:00<00:10,  9.00it/s]  7%|▋         | 7/100 [00:00<00:10,  9.09it/s]  8%|▊         | 8/100 [00:00<00:11,  8.21it/s] 10%|█         | 10/100 [00:01<00:10,  8.95it/s] 11%|█         | 11/100 [00:01<00:10,  8.88it/s] 12%|█▏        | 12/100 [00:01<00:10,  8.72it/s] 13%|█▎        | 13/100 [00:01<00:10,  8.40it/s] 15%|█▌        | 15/100 [00:01<00:09,  9.15it/s] 16%|█▌        | 16/100 [00:01<00:11,  7.47it/s] 17%|█▋        | 17/100 [00:02<00:10,  7.83it/s] 19%|█▉        | 19/100 [00:02<00:09,  8.48it/s] 20%|██        | 20/100 [00:02<00:09,  8.62it/s] 21%|██        | 21/100 [00:02<00:09,  8.60it/s] 22%|██▏       | 22/100 [00:02<00:10,  7.31it/s] 24%|██▍       | 24/100 [00:02<00:09,  8.23it/s] 25%|██▌       | 25/100 [00:02<00:08,  8.50it/s] 26%|██▌       | 26/100 [00:03<00:08,  8.51it/s] 27%|██▋       | 27/100 [00:03<00:08,  8.83it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.97it/s] 29%|██▉       | 29/100 [00:03<00:08,  8.84it/s] 30%|███       | 30/100 [00:03<00:08,  8.42it/s] 31%|███       | 31/100 [00:03<00:08,  8.38it/s] 32%|███▏      | 32/100 [00:03<00:08,  8.35it/s] 33%|███▎      | 33/100 [00:03<00:07,  8.38it/s] 34%|███▍      | 34/100 [00:04<00:08,  7.48it/s] 35%|███▌      | 35/100 [00:04<00:08,  7.61it/s] 36%|███▌      | 36/100 [00:04<00:07,  8.00it/s] 37%|███▋      | 37/100 [00:04<00:08,  7.77it/s] 38%|███▊      | 38/100 [00:04<00:07,  8.13it/s] 39%|███▉      | 39/100 [00:04<00:07,  8.05it/s] 40%|████      | 40/100 [00:04<00:07,  8.21it/s] 41%|████      | 41/100 [00:04<00:07,  8.29it/s] 42%|████▏     | 42/100 [00:05<00:06,  8.55it/s] 43%|████▎     | 43/100 [00:05<00:06,  8.76it/s] 44%|████▍     | 44/100 [00:05<00:06,  8.47it/s] 45%|████▌     | 45/100 [00:05<00:06,  8.10it/s] 47%|████▋     | 47/100 [00:05<00:05,  9.16it/s] 48%|████▊     | 48/100 [00:05<00:05,  9.06it/s] 49%|████▉     | 49/100 [00:05<00:05,  9.10it/s] 50%|█████     | 50/100 [00:05<00:05,  8.94it/s] 51%|█████     | 51/100 [00:06<00:05,  8.98it/s] 52%|█████▏    | 52/100 [00:06<00:05,  8.91it/s] 53%|█████▎    | 53/100 [00:06<00:05,  8.61it/s] 54%|█████▍    | 54/100 [00:06<00:05,  8.49it/s] 55%|█████▌    | 55/100 [00:06<00:05,  8.71it/s] 56%|█████▌    | 56/100 [00:06<00:04,  8.88it/s] 57%|█████▋    | 57/100 [00:06<00:05,  8.46it/s] 58%|█████▊    | 58/100 [00:06<00:05,  7.24it/s] 59%|█████▉    | 59/100 [00:07<00:05,  7.52it/s] 60%|██████    | 60/100 [00:07<00:05,  7.05it/s] 61%|██████    | 61/100 [00:07<00:05,  7.30it/s] 62%|██████▏   | 62/100 [00:07<00:05,  7.45it/s] 63%|██████▎   | 63/100 [00:07<00:04,  7.72it/s] 64%|██████▍   | 64/100 [00:07<00:04,  7.73it/s] 65%|██████▌   | 65/100 [00:07<00:04,  7.88it/s] 66%|██████▌   | 66/100 [00:07<00:04,  8.04it/s] 67%|██████▋   | 67/100 [00:08<00:04,  8.13it/s] 68%|██████▊   | 68/100 [00:08<00:03,  8.01it/s] 69%|██████▉   | 69/100 [00:08<00:03,  8.24it/s] 70%|███████   | 70/100 [00:08<00:03,  8.37it/s] 71%|███████   | 71/100 [00:08<00:03,  8.46it/s] 72%|███████▏  | 72/100 [00:08<00:03,  8.44it/s] 73%|███████▎  | 73/100 [00:08<00:03,  7.32it/s] 74%|███████▍  | 74/100 [00:09<00:03,  6.70it/s] 75%|███████▌  | 75/100 [00:09<00:03,  7.06it/s] 76%|███████▌  | 76/100 [00:09<00:03,  6.52it/s] 77%|███████▋  | 77/100 [00:09<00:03,  6.94it/s] 78%|███████▊  | 78/100 [00:09<00:03,  7.16it/s] 79%|███████▉  | 79/100 [00:09<00:02,  7.50it/s] 80%|████████  | 80/100 [00:09<00:02,  7.81it/s] 81%|████████  | 81/100 [00:09<00:02,  7.82it/s] 82%|████████▏ | 82/100 [00:10<00:02,  7.54it/s] 83%|████████▎ | 83/100 [00:10<00:02,  7.51it/s] 84%|████████▍ | 84/100 [00:10<00:02,  7.59it/s] 85%|████████▌ | 85/100 [00:10<00:01,  7.61it/s] 86%|████████▌ | 86/100 [00:10<00:01,  7.72it/s] 87%|████████▋ | 87/100 [00:10<00:01,  6.81it/s] 88%|████████▊ | 88/100 [00:11<00:01,  6.07it/s] 89%|████████▉ | 89/100 [00:11<00:01,  6.25it/s] 90%|█████████ | 90/100 [00:11<00:01,  6.41it/s] 91%|█████████ | 91/100 [00:11<00:01,  6.67it/s] 92%|█████████▏| 92/100 [00:11<00:01,  6.71it/s] 93%|█████████▎| 93/100 [00:11<00:00,  7.14it/s] 94%|█████████▍| 94/100 [00:11<00:00,  7.25it/s] 95%|█████████▌| 95/100 [00:11<00:00,  7.58it/s] 96%|█████████▌| 96/100 [00:12<00:00,  7.38it/s] 97%|█████████▋| 97/100 [00:12<00:00,  7.58it/s] 98%|█████████▊| 98/100 [00:12<00:00,  7.81it/s] 99%|█████████▉| 99/100 [00:12<00:00,  7.97it/s]100%|██████████| 100/100 [00:12<00:00,  8.07it/s]100%|██████████| 100/100 [00:12<00:00,  7.95it/s]
[I 2025-08-31 15:22:29,983] A new study created in memory with name: no-name-a9c9ccf4-e170-4dff-b20a-8462f5fd8674
👉 train samples(학습 샘플(bag))=126, batch_size=16 -> steps(샘플수/batch크기)=8
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 29.04 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.707933, Valid_loss 0.639669
Epoch 2, Train Loss 0.624404, Valid_loss 0.599609
Epoch 3, Train Loss 0.671113, Valid_loss 0.599908
Epoch 4, Train Loss 0.653393, Valid_loss 0.641513
Epoch 5, Train Loss 0.632797, Valid_loss 0.602062
Epoch 6, Train Loss 0.665716, Valid_loss 0.601711
Epoch 7, Train Loss 0.640538, Valid_loss 0.601686
Epoch 8, Train Loss 0.617111, Valid_loss 0.609757
Epoch 9, Train Loss 0.635467, Valid_loss 0.604177
Epoch 10, Train Loss 0.637314, Valid_loss 0.607838
Epoch 11, Train Loss 0.620905, Valid_loss 0.604648
Epoch 12, Train Loss 0.645137, Valid_loss 0.629979
Epoch 13, Train Loss 0.548880, Valid_loss 0.819261
Epoch 14, Train Loss 0.451987, Valid_loss 1.059970
Epoch 15, Train Loss 0.423183, Valid_loss 0.795328
Epoch 16, Train Loss 0.326681, Valid_loss 0.704737
Epoch 17, Train Loss 0.318123, Valid_loss 0.775347
Epoch 18, Train Loss 0.324028, Valid_loss 1.236456
Epoch 19, Train Loss 0.298762, Valid_loss 0.744353
Epoch 20, Train Loss 0.310523, Valid_loss 0.419802
Epoch 21, Train Loss 0.265732, Valid_loss 1.159084
Epoch 22, Train Loss 0.283616, Valid_loss 0.955418
Epoch 23, Train Loss 0.264820, Valid_loss 0.872358
Epoch 24, Train Loss 0.298186, Valid_loss 1.256905
Epoch 25, Train Loss 0.304140, Valid_loss 0.961255
Epoch 26, Train Loss 0.282178, Valid_loss 1.120896
Epoch 27, Train Loss 0.284059, Valid_loss 0.814854
Epoch 28, Train Loss 0.261922, Valid_loss 1.013134
Epoch 29, Train Loss 0.284424, Valid_loss 0.692176
Epoch 30, Train Loss 0.230932, Valid_loss 1.040004
Epoch 31, Train Loss 0.244829, Valid_loss 0.769315
Epoch 32, Train Loss 0.268391, Valid_loss 1.002259
Epoch 33, Train Loss 0.276125, Valid_loss 0.612253
Epoch 34, Train Loss 0.278101, Valid_loss 0.825120
Epoch 35, Train Loss 0.255560, Valid_loss 0.565913
Epoch 36, Train Loss 0.233210, Valid_loss 0.615632
Epoch 37, Train Loss 0.233442, Valid_loss 0.593029
Epoch 38, Train Loss 0.234609, Valid_loss 0.604524
Epoch 39, Train Loss 0.232465, Valid_loss 1.137595
Epoch 40, Train Loss 0.264365, Valid_loss 1.107452
Epoch 41, Train Loss 0.224073, Valid_loss 1.107689
Epoch 42, Train Loss 0.232726, Valid_loss 0.755046
Epoch 43, Train Loss 0.230711, Valid_loss 0.389257
Epoch 44, Train Loss 0.229481, Valid_loss 0.774590
Epoch 45, Train Loss 0.228180, Valid_loss 0.756697
Epoch 46, Train Loss 0.226469, Valid_loss 0.409238
Epoch 47, Train Loss 0.208614, Valid_loss 1.279685
Epoch 48, Train Loss 0.208994, Valid_loss 1.930071
Epoch 49, Train Loss 0.238241, Valid_loss 1.896615
Epoch 50, Train Loss 0.242363, Valid_loss 1.893341
Epoch 51, Train Loss 0.247140, Valid_loss 1.696547
Epoch 52, Train Loss 0.230203, Valid_loss 1.294944
Epoch 53, Train Loss 0.234241, Valid_loss 1.137859
Epoch 54, Train Loss 0.218635, Valid_loss 1.360164
Epoch 55, Train Loss 0.218538, Valid_loss 1.286368
Epoch 56, Train Loss 0.220270, Valid_loss 0.658859
Epoch 57, Train Loss 0.217578, Valid_loss 0.722575
Epoch 58, Train Loss 0.220255, Valid_loss 0.743179
[I 2025-08-31 15:26:08,523] Trial 0 finished with value: 0.3892568931582251 and parameters: {'learning_rate': 0.01, 'epochs': 100, 'heads': 1, 'dropout': 0.7, 'weight_decay': 0.0001, 'emb_dim': 64, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.3892568931582251.
👉 train samples(학습 샘플(bag))=126, batch_size=16 -> steps(샘플수/batch크기)=8
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 29.04 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.644273, Valid_loss 0.605328
Epoch 2, Train Loss 0.608655, Valid_loss 0.593700
Epoch 3, Train Loss 0.484896, Valid_loss 1.083732
Epoch 4, Train Loss 0.334816, Valid_loss 0.743526
Epoch 5, Train Loss 0.297835, Valid_loss 0.945860
Epoch 6, Train Loss 0.267930, Valid_loss 0.987972
Epoch 7, Train Loss 0.243280, Valid_loss 0.760771
Epoch 8, Train Loss 0.220647, Valid_loss 0.757811
Epoch 9, Train Loss 0.238296, Valid_loss 0.635875
Epoch 10, Train Loss 0.224346, Valid_loss 0.682905
Epoch 11, Train Loss 0.235063, Valid_loss 0.562229
Epoch 12, Train Loss 0.282421, Valid_loss 0.698777
Epoch 13, Train Loss 0.248059, Valid_loss 0.742632
Epoch 14, Train Loss 0.248644, Valid_loss 0.835642
Epoch 15, Train Loss 0.232321, Valid_loss 0.571711
Epoch 16, Train Loss 0.244003, Valid_loss 0.667517
Epoch 17, Train Loss 0.214473, Valid_loss 0.545717
Epoch 18, Train Loss 0.214187, Valid_loss 0.857183
Epoch 19, Train Loss 0.250671, Valid_loss 0.578351
Epoch 20, Train Loss 0.249825, Valid_loss 0.902570
Epoch 21, Train Loss 0.243743, Valid_loss 1.411840
Epoch 22, Train Loss 0.212014, Valid_loss 0.880528
Epoch 23, Train Loss 0.214887, Valid_loss 0.828350
Epoch 24, Train Loss 0.224155, Valid_loss 1.031440
Epoch 25, Train Loss 0.220247, Valid_loss 1.300007
Epoch 26, Train Loss 0.188963, Valid_loss 1.128196
Epoch 27, Train Loss 0.178915, Valid_loss 1.181971
Epoch 28, Train Loss 0.187627, Valid_loss 1.332314
Epoch 29, Train Loss 0.177046, Valid_loss 1.114344
Epoch 30, Train Loss 0.182727, Valid_loss 1.249377
Epoch 31, Train Loss 0.171445, Valid_loss 1.042261
Epoch 32, Train Loss 0.176582, Valid_loss 1.101750
Epoch 33, Train Loss 0.178865, Valid_loss 1.039859
Epoch 34, Train Loss 0.180715, Valid_loss 0.860311
Epoch 35, Train Loss 0.181066, Valid_loss 1.044234
Epoch 36, Train Loss 0.178232, Valid_loss 1.202664
Epoch 37, Train Loss 0.175555, Valid_loss 1.519488
Epoch 38, Train Loss 0.191585, Valid_loss 1.365526
Epoch 39, Train Loss 0.182832, Valid_loss 1.062552
Epoch 40, Train Loss 0.172498, Valid_loss 0.813312
Epoch 41, Train Loss 0.167163, Valid_loss 1.698872
Epoch 42, Train Loss 0.168765, Valid_loss 1.265622
Epoch 43, Train Loss 0.172280, Valid_loss 1.863897
Epoch 44, Train Loss 0.176259, Valid_loss 1.546323
Epoch 45, Train Loss 0.169659, Valid_loss 1.284546
Epoch 46, Train Loss 0.165871, Valid_loss 1.704281
Epoch 47, Train Loss 0.171026, Valid_loss 1.427337
Epoch 48, Train Loss 0.179563, Valid_loss 0.343335
Epoch 49, Train Loss 0.233103, Valid_loss 0.846990
Epoch 50, Train Loss 0.186915, Valid_loss 1.033480
Epoch 51, Train Loss 0.191847, Valid_loss 0.669675
Epoch 52, Train Loss 0.207878, Valid_loss 0.926833
Epoch 53, Train Loss 0.185088, Valid_loss 1.012496
[I 2025-08-31 15:29:44,188] Trial 1 finished with value: 0.3433346474401852 and parameters: {'learning_rate': 0.01, 'epochs': 100, 'heads': 2, 'dropout': 0.3, 'weight_decay': 0.0001, 'emb_dim': 64, 'augment_num': 100, 'pca': False}. Best is trial 1 with value: 0.3433346474401852.
👉 train samples(학습 샘플(bag))=126, batch_size=16 -> steps(샘플수/batch크기)=8
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 25.64 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.710788, Valid_loss 0.602832
Epoch 2, Train Loss 0.626497, Valid_loss 0.598344
Epoch 3, Train Loss 0.623241, Valid_loss 0.598332
Epoch 4, Train Loss 0.623565, Valid_loss 0.598669
Epoch 5, Train Loss 0.621726, Valid_loss 0.598921
Epoch 6, Train Loss 0.620709, Valid_loss 0.601208
Epoch 7, Train Loss 0.621838, Valid_loss 0.601643
Epoch 8, Train Loss 0.622821, Valid_loss 0.600829
Epoch 9, Train Loss 0.622697, Valid_loss 0.598888
Epoch 10, Train Loss 0.622910, Valid_loss 0.598655
Epoch 11, Train Loss 0.621709, Valid_loss 0.599702
Epoch 12, Train Loss 0.621926, Valid_loss 0.601418
Epoch 13, Train Loss 0.621186, Valid_loss 0.604177
Epoch 14, Train Loss 0.620680, Valid_loss 0.602076
Epoch 15, Train Loss 0.621797, Valid_loss 0.598867
Epoch 16, Train Loss 0.622114, Valid_loss 0.599436
Epoch 17, Train Loss 0.618905, Valid_loss 0.600412
Epoch 18, Train Loss 0.619924, Valid_loss 0.600438
Epoch 19, Train Loss 0.620522, Valid_loss 0.600812
Epoch 20, Train Loss 0.619997, Valid_loss 0.599535
Epoch 21, Train Loss 0.623403, Valid_loss 0.598940
Epoch 22, Train Loss 0.619913, Valid_loss 0.600233
Epoch 23, Train Loss 0.619121, Valid_loss 0.600774
Epoch 24, Train Loss 0.622876, Valid_loss 0.599791
Epoch 25, Train Loss 0.621564, Valid_loss 0.600235
Epoch 26, Train Loss 0.621371, Valid_loss 0.599772
Epoch 27, Train Loss 0.621846, Valid_loss 0.600590
Epoch 28, Train Loss 0.620318, Valid_loss 0.600388
Epoch 29, Train Loss 0.620391, Valid_loss 0.601865
Epoch 30, Train Loss 0.620617, Valid_loss 0.600289
Epoch 31, Train Loss 0.620465, Valid_loss 0.600451
Epoch 32, Train Loss 0.620481, Valid_loss 0.599654
Epoch 33, Train Loss 0.619674, Valid_loss 0.599696
Epoch 34, Train Loss 0.620719, Valid_loss 0.601039
Epoch 35, Train Loss 0.620623, Valid_loss 0.600458
Epoch 36, Train Loss 0.620306, Valid_loss 0.599896
Epoch 37, Train Loss 0.619143, Valid_loss 0.600950
Epoch 38, Train Loss 0.619178, Valid_loss 0.600128
Epoch 39, Train Loss 0.619215, Valid_loss 0.599857
Epoch 40, Train Loss 0.619751, Valid_loss 0.599443
Epoch 41, Train Loss 0.621032, Valid_loss 0.600468
Epoch 42, Train Loss 0.621701, Valid_loss 0.599814
Epoch 43, Train Loss 0.619804, Valid_loss 0.600305
Epoch 44, Train Loss 0.619503, Valid_loss 0.600249
Epoch 45, Train Loss 0.619821, Valid_loss 0.600356
Epoch 46, Train Loss 0.622865, Valid_loss 0.601247
Epoch 47, Train Loss 0.619452, Valid_loss 0.600604
Epoch 48, Train Loss 0.621323, Valid_loss 0.600031
Epoch 49, Train Loss 0.621973, Valid_loss 0.601263
Epoch 50, Train Loss 0.623715, Valid_loss 0.600022
Epoch 51, Train Loss 0.619902, Valid_loss 0.601396
Epoch 52, Train Loss 0.623298, Valid_loss 0.599738
Epoch 53, Train Loss 0.620694, Valid_loss 0.599880
Epoch 54, Train Loss 0.620334, Valid_loss 0.600361
[I 2025-08-31 15:34:39,797] Trial 2 finished with value: 0.5983316110713142 and parameters: {'learning_rate': 0.01, 'epochs': 100, 'heads': 4, 'dropout': 0.0, 'weight_decay': 0.01, 'emb_dim': 8, 'augment_num': 100, 'pca': False}. Best is trial 1 with value: 0.3433346474401852.
선택된 trial params: {'learning_rate': 0.01, 'epochs': 100, 'heads': 2, 'dropout': 0.3, 'weight_decay': 0.0001, 'emb_dim': 64, 'augment_num': 100, 'pca': False}
👉 train samples(학습 샘플(bag))=126, batch_size=16 -> steps(샘플수/batch크기)=8
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=10, batch_size=1 -> steps=10
output_class :  1
Memory Allocated: 29.04 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.674355, Valid_loss 0.599174
Epoch 2, Train Loss 0.630462, Valid_loss 0.609116
Epoch 3, Train Loss 0.633192, Valid_loss 0.598130
Epoch 4, Train Loss 0.621978, Valid_loss 0.603615
Epoch 5, Train Loss 0.633773, Valid_loss 0.613026
Epoch 6, Train Loss 0.628880, Valid_loss 0.598245
Epoch 7, Train Loss 0.611366, Valid_loss 0.599169
Epoch 8, Train Loss 0.620353, Valid_loss 0.601339
Epoch 9, Train Loss 0.628757, Valid_loss 0.605822
Epoch 10, Train Loss 0.622288, Valid_loss 0.598309
Epoch 11, Train Loss 0.626164, Valid_loss 0.598050
Epoch 12, Train Loss 0.623443, Valid_loss 0.598738
Epoch 13, Train Loss 0.625641, Valid_loss 0.607281
Epoch 14, Train Loss 0.628128, Valid_loss 0.602561
Epoch 15, Train Loss 0.609938, Valid_loss 0.605963
Epoch 16, Train Loss 0.638140, Valid_loss 0.598962
Epoch 17, Train Loss 0.634981, Valid_loss 0.605093
Epoch 18, Train Loss 0.618461, Valid_loss 0.602416
Epoch 19, Train Loss 0.613938, Valid_loss 0.612007
Epoch 20, Train Loss 0.577169, Valid_loss 0.737448
Epoch 21, Train Loss 0.481732, Valid_loss 0.960911
Epoch 22, Train Loss 0.570995, Valid_loss 0.629900
Epoch 23, Train Loss 0.469492, Valid_loss 0.690652
Epoch 24, Train Loss 0.414265, Valid_loss 0.598333
Epoch 25, Train Loss 0.515648, Valid_loss 1.130218
Epoch 26, Train Loss 0.351665, Valid_loss 1.067178
Epoch 27, Train Loss 0.372961, Valid_loss 0.957882
Epoch 28, Train Loss 0.306845, Valid_loss 1.178543
Epoch 29, Train Loss 0.296392, Valid_loss 1.340322
Epoch 30, Train Loss 0.294421, Valid_loss 1.432552
Epoch 31, Train Loss 0.322076, Valid_loss 1.249608
Epoch 32, Train Loss 0.334836, Valid_loss 1.937556
Epoch 33, Train Loss 0.365988, Valid_loss 1.611839
Epoch 34, Train Loss 0.320603, Valid_loss 1.879489
Epoch 35, Train Loss 0.318871, Valid_loss 2.317328
Epoch 36, Train Loss 0.336282, Valid_loss 0.942023
Epoch 37, Train Loss 0.347198, Valid_loss 1.339303
Epoch 38, Train Loss 0.299654, Valid_loss 1.530629
Epoch 39, Train Loss 0.308888, Valid_loss 1.685326
Epoch 40, Train Loss 0.318583, Valid_loss 1.206503
Epoch 41, Train Loss 0.290125, Valid_loss 1.762798
Epoch 42, Train Loss 0.262298, Valid_loss 1.123465
Epoch 43, Train Loss 0.531047, Valid_loss 0.566013
Epoch 44, Train Loss 0.534043, Valid_loss 0.505846
Epoch 45, Train Loss 0.554859, Valid_loss 0.711249
Epoch 46, Train Loss 0.522803, Valid_loss 0.609001
Epoch 47, Train Loss 0.411841, Valid_loss 0.724555
Epoch 48, Train Loss 0.332041, Valid_loss 1.308819
Epoch 49, Train Loss 0.320848, Valid_loss 1.288133
Epoch 50, Train Loss 0.295245, Valid_loss 1.515152
Epoch 51, Train Loss 0.299377, Valid_loss 1.274203
Epoch 52, Train Loss 0.280824, Valid_loss 1.184882
Epoch 53, Train Loss 0.290592, Valid_loss 1.215141
Epoch 54, Train Loss 0.264146, Valid_loss 1.260934
환자ID=COVID19_Participant14 -- true: 1 -- pred: 1
환자ID=COVID19_Participant2 -- true: 1 -- pred: 1
환자ID=COVID19_Participant23 -- true: 1 -- pred: 1
환자ID=COVID19_Participant27 -- true: 1 -- pred: 1
환자ID=COVID19_Participant38 -- true: 1 -- pred: 1
환자ID=COVID19_Participant4 -- true: 1 -- pred: 1
환자ID=COVID19_Participant9 -- true: 1 -- pred: 1
환자ID=Control_Participant11 -- true: 0 -- pred: 1
환자ID=Control_Participant12 -- true: 0 -- pred: 1
환자ID=Control_Participant4 -- true: 0 -- pred: 1
Best performance: Epoch 44, Loss 0.534043, Test ACC 0.700000, Test AUC 0.761905, Test Recall 1.000000, Test Precision 0.700000
Confusion Matrix:
 [0 3 0 7]
✅ Total valid splits used: 3
🔁 Repeat 0, Fold 3
cell type :  GTCGGGGGGTGG_Control_Participant7        Keratinocytes
CAAATCAATTAT_Control_Participant7     Epithelial_cells
ATACAATTGACA_Control_Participant7     Epithelial_cells
CTGTTAATGAGA_Control_Participant7     Epithelial_cells
CTTCACATTATT_Control_Participant7     Epithelial_cells
                                            ...       
GCAGGGAACTCC_COVID19_Participant30    Epithelial_cells
CAGCACCGAGCC_COVID19_Participant30    Epithelial_cells
GCCCCTTGTGAT_COVID19_Participant30    Epithelial_cells
GTGTTGTGTGTC_COVID19_Participant30              B_cell
TAACACTCACTT_COVID19_Participant30           Myelocyte
Name: singler_annotation, Length: 21028, dtype: string
cell type annotation :  GTCGGGGGGTGG_Control_Participant7        Keratinocytes
CAAATCAATTAT_Control_Participant7     Epithelial_cells
ATACAATTGACA_Control_Participant7     Epithelial_cells
CTGTTAATGAGA_Control_Participant7     Epithelial_cells
CTTCACATTATT_Control_Participant7     Epithelial_cells
                                            ...       
GCAGGGAACTCC_COVID19_Participant30    Epithelial_cells
CAGCACCGAGCC_COVID19_Participant30    Epithelial_cells
GCCCCTTGTGAT_COVID19_Participant30    Epithelial_cells
GTGTTGTGTGTC_COVID19_Participant30              B_cell
TAACACTCACTT_COVID19_Participant30           Myelocyte
Name: singler_annotation, Length: 21028, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Keratinocytes', 'Epithelial_cells', 'Neurons', 'iPS_cells', 'Embryonic_stem_cells', 'Astrocyte', 'DC', 'Gametocytes', 'HSC_-G-CSF', 'Smooth_muscle_cells', 'BM & Prog.', 'Monocyte', 'Myelocyte', 'BM', 'Endothelial_cells', 'Osteoblasts', 'Platelets', 'Erythroblast', 'NK_cell', 'T_cells', 'Chondrocytes', 'HSC_CD34+', 'CMP', 'Neutrophils', 'Fibroblasts', 'MEP', 'Neuroepithelial_cell', 'MSC', 'Pro-Myelocyte', 'B_cell', 'GMP', 'Hepatocytes', 'Macrophage', 'Tissue_stem_cells', 'Pre-B_cell_CD34-', 'Pro-B_cell_CD34+', 'Unknown']
라벨별 그룹 개수 {1: 28, 0: 12}
cell type :  CGAATCAAGGCC_COVID19_Participant26    Epithelial_cells
ACGCCCTTCAAC_COVID19_Participant26    Epithelial_cells
ACCATATTGCTT_COVID19_Participant26    Epithelial_cells
AAACCTCCGGGA_COVID19_Participant26    Epithelial_cells
TACGCGCCGAAC_COVID19_Participant26    Epithelial_cells
                                            ...       
CAGGTTGGTATC_COVID19_Participant20    Epithelial_cells
TATAGCTTGGTA_COVID19_Participant20    Epithelial_cells
TTGTTAGACGGT_COVID19_Participant20          HSC_-G-CSF
ATGGCTCAGGCT_COVID19_Participant20    Epithelial_cells
ACATGATCCTTT_COVID19_Participant20    Epithelial_cells
Name: singler_annotation, Length: 5919, dtype: string
cell type annotation :  CGAATCAAGGCC_COVID19_Participant26    Epithelial_cells
ACGCCCTTCAAC_COVID19_Participant26    Epithelial_cells
ACCATATTGCTT_COVID19_Participant26    Epithelial_cells
AAACCTCCGGGA_COVID19_Participant26    Epithelial_cells
TACGCGCCGAAC_COVID19_Participant26    Epithelial_cells
                                            ...       
CAGGTTGGTATC_COVID19_Participant20    Epithelial_cells
TATAGCTTGGTA_COVID19_Participant20    Epithelial_cells
TTGTTAGACGGT_COVID19_Participant20          HSC_-G-CSF
ATGGCTCAGGCT_COVID19_Participant20    Epithelial_cells
ACATGATCCTTT_COVID19_Participant20    Epithelial_cells
Name: singler_annotation, Length: 5919, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Epithelial_cells', 'Keratinocytes', 'Macrophage', 'NK_cell', 'Erythroblast', 'Neurons', 'Gametocytes', 'Platelets', 'Monocyte', 'DC', 'Neutrophils', 'B_cell', 'Endothelial_cells', 'Pre-B_cell_CD34-', 'HSC_CD34+', 'Myelocyte', 'T_cells', 'MEP', 'Hepatocytes', 'Astrocyte', 'BM', 'HSC_-G-CSF', 'BM & Prog.', 'Embryonic_stem_cells', 'Osteoblasts', 'Smooth_muscle_cells', 'CMP', 'Tissue_stem_cells', 'Chondrocytes', 'Neuroepithelial_cell', 'iPS_cells', 'GMP', 'Pro-Myelocyte', 'Fibroblasts', 'MSC', 'Pro-B_cell_CD34+', 'Unknown']
라벨별 그룹 개수 {1: 7, 0: 3}
🔍 Split #4
  → train_p_index 환자 수 (환자 단위로 묶인 index list): 40
  → test_p_index 환자 수  (환자 단위로 묶인 index list): 10
  → train 환자 ID: ['COVID19_Participant10', 'COVID19_Participant11', 'COVID19_Participant12', 'COVID19_Participant13', 'COVID19_Participant14', 'COVID19_Participant15', 'COVID19_Participant17', 'COVID19_Participant18', 'COVID19_Participant2', 'COVID19_Participant22', 'COVID19_Participant23', 'COVID19_Participant25', 'COVID19_Participant27', 'COVID19_Participant28', 'COVID19_Participant3', 'COVID19_Participant30', 'COVID19_Participant31', 'COVID19_Participant32', 'COVID19_Participant35', 'COVID19_Participant36', 'COVID19_Participant37', 'COVID19_Participant38', 'COVID19_Participant39', 'COVID19_Participant4', 'COVID19_Participant40', 'COVID19_Participant5', 'COVID19_Participant8', 'COVID19_Participant9', 'Control_Participant1', 'Control_Participant10', 'Control_Participant11', 'Control_Participant12', 'Control_Participant13', 'Control_Participant14', 'Control_Participant15', 'Control_Participant3', 'Control_Participant4', 'Control_Participant6', 'Control_Participant7', 'Control_Participant9']
  → test  환자 ID: ['COVID19_Participant19', 'COVID19_Participant20', 'COVID19_Participant21', 'COVID19_Participant26', 'COVID19_Participant29', 'COVID19_Participant6', 'COVID19_Participant7', 'Control_Participant2', 'Control_Participant5', 'Control_Participant8']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant10, Label: 1
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant12, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant18, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant27, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant3, Label: 1
    ID: COVID19_Participant30, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant35, Label: 1
    ID: COVID19_Participant36, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant38, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: COVID19_Participant5, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: COVID19_Participant9, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant10, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant12, Label: 0
    ID: Control_Participant13, Label: 0
    ID: Control_Participant14, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant4, Label: 0
    ID: Control_Participant6, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant21, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant6, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: Control_Participant2, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant8, Label: 0
전체 데이터 index 길이 50
label_stat (train 환자 라벨 목록) 갯수 40
train_data에서 환자 단위로, train과 validation 나누기
기존 train_p_index 40
기존 (train) label_stat 40
train-vali 분할 후! 
train y 의 classes : {0, 1} valid y 의 classes : {0, 1} label_stat 의 classes : {0, 1}
train_p_index_ 26
valid_p_index 14
test_p_index 10
→ train 환자 ID 및 라벨:
   총 개수: 26
   환자ID=Control_Participant10, Label=0, 셀개수=1645
   환자ID=Control_Participant14, Label=0, 셀개수=274
   환자ID=COVID19_Participant17, Label=1, 셀개수=843
   환자ID=COVID19_Participant38, Label=1, 셀개수=51
   환자ID=COVID19_Participant10, Label=1, 셀개수=18
   환자ID=Control_Participant4, Label=0, 셀개수=440
   환자ID=COVID19_Participant13, Label=1, 셀개수=730
   환자ID=COVID19_Participant18, Label=1, 셀개수=227
   환자ID=COVID19_Participant4, Label=1, 셀개수=1680
   환자ID=COVID19_Participant12, Label=1, 셀개수=102
   환자ID=COVID19_Participant2, Label=1, 셀개수=329
   환자ID=Control_Participant15, Label=0, 셀개수=528
   환자ID=COVID19_Participant28, Label=1, 셀개수=1079
   환자ID=Control_Participant7, Label=0, 셀개수=762
   환자ID=Control_Participant6, Label=0, 셀개수=131
   환자ID=COVID19_Participant14, Label=1, 셀개수=382
   환자ID=Control_Participant9, Label=0, 셀개수=558
   환자ID=Control_Participant11, Label=0, 셀개수=1164
   환자ID=COVID19_Participant23, Label=1, 셀개수=307
   환자ID=COVID19_Participant31, Label=1, 셀개수=410
   환자ID=COVID19_Participant27, Label=1, 셀개수=93
   환자ID=COVID19_Participant15, Label=1, 셀개수=1003
   환자ID=COVID19_Participant5, Label=1, 셀개수=89
   환자ID=COVID19_Participant39, Label=1, 셀개수=454
   환자ID=COVID19_Participant37, Label=1, 셀개수=668
   환자ID=COVID19_Participant30, Label=1, 셀개수=116
→ valid 환자 ID 및 라벨:
   총 개수: 14
   환자ID=Control_Participant13, Label=0, 셀개수=88
   환자ID=COVID19_Participant3, Label=1, 셀개수=104
   환자ID=COVID19_Participant35, Label=1, 셀개수=83
   환자ID=COVID19_Participant32, Label=1, 셀개수=1665
   환자ID=COVID19_Participant40, Label=1, 셀개수=381
   환자ID=COVID19_Participant22, Label=1, 셀개수=865
   환자ID=Control_Participant3, Label=0, 셀개수=1620
   환자ID=Control_Participant1, Label=0, 셀개수=414
   환자ID=COVID19_Participant9, Label=1, 셀개수=86
   환자ID=COVID19_Participant8, Label=1, 셀개수=462
   환자ID=Control_Participant12, Label=0, 셀개수=99
   환자ID=COVID19_Participant36, Label=1, 셀개수=200
   환자ID=COVID19_Participant11, Label=1, 셀개수=382
   환자ID=COVID19_Participant25, Label=1, 셀개수=496
→ test 환자 ID 및 라벨:
   총 개수: 10
   환자ID=COVID19_Participant19, Label=1, 셀개수=816
   환자ID=COVID19_Participant20, Label=1, 셀개수=2033
   환자ID=COVID19_Participant21, Label=1, 셀개수=39
   환자ID=COVID19_Participant26, Label=1, 셀개수=814
   환자ID=COVID19_Participant29, Label=1, 셀개수=573
   환자ID=COVID19_Participant6, Label=1, 셀개수=84
   환자ID=COVID19_Participant7, Label=1, 셀개수=409
   환자ID=Control_Participant2, Label=0, 셀개수=41
   환자ID=Control_Participant5, Label=0, 셀개수=717
   환자ID=Control_Participant8, Label=0, 셀개수=393
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Keratinocytes', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Neurons', 'iPS_cells', 'Embryonic_stem_cells', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
전체 데이터 길이 26947
전체 cell type 길이 0           Keratinocytes
1        Epithelial_cells
2        Epithelial_cells
3        Epithelial_cells
4        Epithelial_cells
               ...       
26942    Epithelial_cells
26943    Epithelial_cells
26944          HSC_-G-CSF
26945    Epithelial_cells
26946    Epithelial_cells
Length: 26947, dtype: string
cell type의 NaN 개수 체크 0
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:10,  9.58it/s]  2%|▏         | 2/100 [00:00<00:10,  9.71it/s]  3%|▎         | 3/100 [00:00<00:10,  9.37it/s]  4%|▍         | 4/100 [00:00<00:10,  9.21it/s]  5%|▌         | 5/100 [00:00<00:10,  9.11it/s]  6%|▌         | 6/100 [00:00<00:10,  9.34it/s]  7%|▋         | 7/100 [00:00<00:09,  9.34it/s]  8%|▊         | 8/100 [00:00<00:10,  9.16it/s]  9%|▉         | 9/100 [00:00<00:10,  8.50it/s] 10%|█         | 10/100 [00:01<00:10,  8.74it/s] 12%|█▏        | 12/100 [00:01<00:10,  8.66it/s] 13%|█▎        | 13/100 [00:01<00:10,  7.94it/s] 14%|█▍        | 14/100 [00:01<00:10,  8.05it/s] 15%|█▌        | 15/100 [00:01<00:10,  8.36it/s] 17%|█▋        | 17/100 [00:01<00:09,  8.99it/s] 19%|█▉        | 19/100 [00:02<00:08,  9.34it/s] 20%|██        | 20/100 [00:02<00:08,  9.39it/s] 22%|██▏       | 22/100 [00:02<00:08,  8.86it/s] 23%|██▎       | 23/100 [00:02<00:09,  8.29it/s] 24%|██▍       | 24/100 [00:02<00:09,  7.88it/s] 25%|██▌       | 25/100 [00:02<00:09,  8.29it/s] 26%|██▌       | 26/100 [00:03<00:09,  8.07it/s] 27%|██▋       | 27/100 [00:03<00:08,  8.36it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.35it/s] 29%|██▉       | 29/100 [00:03<00:08,  8.36it/s] 30%|███       | 30/100 [00:03<00:08,  8.54it/s] 31%|███       | 31/100 [00:03<00:08,  8.40it/s] 32%|███▏      | 32/100 [00:03<00:07,  8.69it/s] 33%|███▎      | 33/100 [00:03<00:08,  8.33it/s] 34%|███▍      | 34/100 [00:03<00:08,  8.03it/s] 35%|███▌      | 35/100 [00:04<00:07,  8.42it/s] 36%|███▌      | 36/100 [00:04<00:07,  8.21it/s] 37%|███▋      | 37/100 [00:04<00:07,  8.59it/s] 38%|███▊      | 38/100 [00:04<00:07,  7.97it/s] 39%|███▉      | 39/100 [00:04<00:07,  7.83it/s] 40%|████      | 40/100 [00:04<00:07,  7.60it/s] 41%|████      | 41/100 [00:04<00:08,  6.86it/s] 42%|████▏     | 42/100 [00:05<00:07,  7.35it/s] 43%|████▎     | 43/100 [00:05<00:07,  7.59it/s] 44%|████▍     | 44/100 [00:05<00:07,  7.82it/s] 45%|████▌     | 45/100 [00:05<00:06,  8.11it/s] 46%|████▌     | 46/100 [00:05<00:06,  8.14it/s] 47%|████▋     | 47/100 [00:05<00:06,  8.14it/s] 48%|████▊     | 48/100 [00:05<00:06,  8.29it/s] 49%|████▉     | 49/100 [00:05<00:06,  7.56it/s] 50%|█████     | 50/100 [00:06<00:06,  7.78it/s] 51%|█████     | 51/100 [00:06<00:06,  8.16it/s] 52%|█████▏    | 52/100 [00:06<00:06,  7.72it/s] 53%|█████▎    | 53/100 [00:06<00:05,  8.10it/s] 54%|█████▍    | 54/100 [00:06<00:05,  8.35it/s] 55%|█████▌    | 55/100 [00:06<00:05,  8.57it/s] 56%|█████▌    | 56/100 [00:06<00:05,  7.65it/s] 57%|█████▋    | 57/100 [00:06<00:05,  7.94it/s] 58%|█████▊    | 58/100 [00:06<00:05,  8.23it/s] 59%|█████▉    | 59/100 [00:07<00:04,  8.59it/s] 60%|██████    | 60/100 [00:07<00:04,  8.39it/s] 61%|██████    | 61/100 [00:07<00:04,  8.57it/s] 62%|██████▏   | 62/100 [00:07<00:04,  8.71it/s] 63%|██████▎   | 63/100 [00:07<00:04,  8.72it/s] 64%|██████▍   | 64/100 [00:07<00:04,  8.51it/s] 65%|██████▌   | 65/100 [00:07<00:04,  8.34it/s] 66%|██████▌   | 66/100 [00:07<00:04,  8.41it/s] 67%|██████▋   | 67/100 [00:08<00:04,  7.70it/s] 68%|██████▊   | 68/100 [00:08<00:04,  7.94it/s] 69%|██████▉   | 69/100 [00:08<00:03,  8.25it/s] 70%|███████   | 70/100 [00:08<00:03,  8.47it/s] 71%|███████   | 71/100 [00:08<00:03,  7.84it/s] 72%|███████▏  | 72/100 [00:08<00:03,  8.13it/s] 73%|███████▎  | 73/100 [00:08<00:03,  8.04it/s] 75%|███████▌  | 75/100 [00:09<00:02,  8.60it/s] 77%|███████▋  | 77/100 [00:09<00:02,  9.09it/s] 78%|███████▊  | 78/100 [00:09<00:02,  8.22it/s] 79%|███████▉  | 79/100 [00:09<00:02,  8.20it/s] 80%|████████  | 80/100 [00:09<00:02,  8.42it/s] 81%|████████  | 81/100 [00:09<00:02,  8.32it/s] 82%|████████▏ | 82/100 [00:09<00:02,  8.34it/s] 83%|████████▎ | 83/100 [00:09<00:02,  8.26it/s] 84%|████████▍ | 84/100 [00:10<00:01,  8.07it/s] 85%|████████▌ | 85/100 [00:10<00:01,  8.05it/s] 86%|████████▌ | 86/100 [00:10<00:01,  7.99it/s] 87%|████████▋ | 87/100 [00:10<00:01,  8.25it/s] 88%|████████▊ | 88/100 [00:10<00:01,  8.28it/s] 89%|████████▉ | 89/100 [00:10<00:01,  7.58it/s] 90%|█████████ | 90/100 [00:10<00:01,  7.75it/s] 92%|█████████▏| 92/100 [00:11<00:00,  8.37it/s] 93%|█████████▎| 93/100 [00:11<00:00,  8.54it/s] 94%|█████████▍| 94/100 [00:11<00:00,  8.61it/s] 95%|█████████▌| 95/100 [00:11<00:00,  8.32it/s] 96%|█████████▌| 96/100 [00:11<00:00,  7.74it/s] 97%|█████████▋| 97/100 [00:11<00:00,  7.56it/s] 98%|█████████▊| 98/100 [00:11<00:00,  7.67it/s] 99%|█████████▉| 99/100 [00:12<00:00,  7.00it/s]100%|██████████| 100/100 [00:12<00:00,  7.35it/s]100%|██████████| 100/100 [00:12<00:00,  8.23it/s]
[I 2025-08-31 15:38:32,685] A new study created in memory with name: no-name-78f735ab-bf04-493d-8341-7899c11cf4ed
👉 train samples(학습 샘플(bag))=126, batch_size=16 -> steps(샘플수/batch크기)=8
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 25.64 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.596351, Valid_loss 0.558020
Epoch 2, Train Loss 0.542698, Valid_loss 0.527027
Epoch 3, Train Loss 0.519483, Valid_loss 0.500544
Epoch 4, Train Loss 0.502423, Valid_loss 0.497187
Epoch 5, Train Loss 0.489882, Valid_loss 0.499701
Epoch 6, Train Loss 0.471862, Valid_loss 0.507947
Epoch 7, Train Loss 0.443736, Valid_loss 0.494991
Epoch 8, Train Loss 0.451756, Valid_loss 0.480060
Epoch 9, Train Loss 0.431657, Valid_loss 0.490109
Epoch 10, Train Loss 0.431737, Valid_loss 0.479382
Epoch 11, Train Loss 0.450530, Valid_loss 0.533171
Epoch 12, Train Loss 0.440833, Valid_loss 0.507847
Epoch 13, Train Loss 0.418959, Valid_loss 0.486642
Epoch 14, Train Loss 0.396019, Valid_loss 0.519553
Epoch 15, Train Loss 0.396415, Valid_loss 0.493080
Epoch 16, Train Loss 0.401229, Valid_loss 0.444847
Epoch 17, Train Loss 0.389664, Valid_loss 0.470902
Epoch 18, Train Loss 0.403785, Valid_loss 0.470912
Epoch 19, Train Loss 0.384859, Valid_loss 0.435832
Epoch 20, Train Loss 0.390122, Valid_loss 0.465259
Epoch 21, Train Loss 0.375450, Valid_loss 0.548977
Epoch 22, Train Loss 0.393333, Valid_loss 0.457882
Epoch 23, Train Loss 0.355749, Valid_loss 0.474843
Epoch 24, Train Loss 0.374670, Valid_loss 0.472469
Epoch 25, Train Loss 0.354945, Valid_loss 0.499227
Epoch 26, Train Loss 0.377373, Valid_loss 0.434623
Epoch 27, Train Loss 0.340643, Valid_loss 0.493741
Epoch 28, Train Loss 0.340821, Valid_loss 0.440730
Epoch 29, Train Loss 0.342154, Valid_loss 0.416382
Epoch 30, Train Loss 0.351500, Valid_loss 0.443914
Epoch 31, Train Loss 0.352286, Valid_loss 0.457245
Epoch 32, Train Loss 0.344127, Valid_loss 0.403545
Epoch 33, Train Loss 0.311120, Valid_loss 0.453556
Epoch 34, Train Loss 0.316524, Valid_loss 0.392537
Epoch 35, Train Loss 0.308809, Valid_loss 0.494258
Epoch 36, Train Loss 0.325072, Valid_loss 0.433690
Epoch 37, Train Loss 0.292469, Valid_loss 0.400218
Epoch 38, Train Loss 0.302455, Valid_loss 0.413137
Epoch 39, Train Loss 0.284472, Valid_loss 0.366554
Epoch 40, Train Loss 0.287422, Valid_loss 0.399424
Epoch 41, Train Loss 0.288678, Valid_loss 0.414390
Epoch 42, Train Loss 0.270655, Valid_loss 0.442987
Epoch 43, Train Loss 0.279492, Valid_loss 0.445848
Epoch 44, Train Loss 0.268551, Valid_loss 0.435964
Epoch 45, Train Loss 0.294601, Valid_loss 0.427794
Epoch 46, Train Loss 0.260528, Valid_loss 0.400856
Epoch 47, Train Loss 0.301841, Valid_loss 0.417413
Epoch 48, Train Loss 0.286677, Valid_loss 0.408008
Epoch 49, Train Loss 0.271690, Valid_loss 0.465236
Epoch 50, Train Loss 0.253754, Valid_loss 0.412341
Epoch 51, Train Loss 0.246916, Valid_loss 0.420742
Epoch 52, Train Loss 0.258967, Valid_loss 0.436733
[I 2025-08-31 15:41:45,644] Trial 0 finished with value: 0.3665540851652622 and parameters: {'learning_rate': 0.001, 'epochs': 100, 'heads': 1, 'dropout': 0.3, 'weight_decay': 0.01, 'emb_dim': 8, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.3665540851652622.
👉 train samples(학습 샘플(bag))=126, batch_size=16 -> steps(샘플수/batch크기)=8
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 29.04 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.652526, Valid_loss 0.586369
Epoch 2, Train Loss 0.624248, Valid_loss 0.554802
Epoch 3, Train Loss 0.570731, Valid_loss 0.527455
Epoch 4, Train Loss 0.520527, Valid_loss 0.492697
Epoch 5, Train Loss 0.501138, Valid_loss 0.472761
Epoch 6, Train Loss 0.466003, Valid_loss 0.467042
Epoch 7, Train Loss 0.415780, Valid_loss 0.451527
Epoch 8, Train Loss 0.411374, Valid_loss 0.441406
Epoch 9, Train Loss 0.369483, Valid_loss 0.448416
Epoch 10, Train Loss 0.354543, Valid_loss 0.446673
Epoch 11, Train Loss 0.333562, Valid_loss 0.466195
Epoch 12, Train Loss 0.328379, Valid_loss 0.451480
Epoch 13, Train Loss 0.331689, Valid_loss 0.505916
Epoch 14, Train Loss 0.321461, Valid_loss 0.477917
Epoch 15, Train Loss 0.318391, Valid_loss 0.471641
Epoch 16, Train Loss 0.327898, Valid_loss 0.492928
Epoch 17, Train Loss 0.311598, Valid_loss 0.495939
Epoch 18, Train Loss 0.306579, Valid_loss 0.471783
Epoch 19, Train Loss 0.313570, Valid_loss 0.531875
Epoch 20, Train Loss 0.317093, Valid_loss 0.476444
Epoch 21, Train Loss 0.297963, Valid_loss 0.475199
Epoch 22, Train Loss 0.300739, Valid_loss 0.482860
Epoch 23, Train Loss 0.282927, Valid_loss 0.471815
Epoch 24, Train Loss 0.309973, Valid_loss 0.461049
Epoch 25, Train Loss 0.292915, Valid_loss 0.488630
Epoch 26, Train Loss 0.280299, Valid_loss 0.488169
Epoch 27, Train Loss 0.273561, Valid_loss 0.482947
Epoch 28, Train Loss 0.291408, Valid_loss 0.453051
Epoch 29, Train Loss 0.293986, Valid_loss 0.482866
Epoch 30, Train Loss 0.289583, Valid_loss 0.465695
Epoch 31, Train Loss 0.275763, Valid_loss 0.443997
Epoch 32, Train Loss 0.283770, Valid_loss 0.478448
Epoch 33, Train Loss 0.276299, Valid_loss 0.463419
Epoch 34, Train Loss 0.283097, Valid_loss 0.497620
Epoch 35, Train Loss 0.278210, Valid_loss 0.432684
Epoch 36, Train Loss 0.273778, Valid_loss 0.523729
Epoch 37, Train Loss 0.272502, Valid_loss 0.440158
Epoch 38, Train Loss 0.257119, Valid_loss 0.471787
Epoch 39, Train Loss 0.270716, Valid_loss 0.450846
Epoch 40, Train Loss 0.271351, Valid_loss 0.422193
Epoch 41, Train Loss 0.264343, Valid_loss 0.465976
Epoch 42, Train Loss 0.272943, Valid_loss 0.421523
Epoch 43, Train Loss 0.270172, Valid_loss 0.449191
Epoch 44, Train Loss 0.269723, Valid_loss 0.462909
Epoch 45, Train Loss 0.256304, Valid_loss 0.442535
Epoch 46, Train Loss 0.269531, Valid_loss 0.458711
Epoch 47, Train Loss 0.265800, Valid_loss 0.416409
Epoch 48, Train Loss 0.262749, Valid_loss 0.424845
Epoch 49, Train Loss 0.251271, Valid_loss 0.435495
Epoch 50, Train Loss 0.257144, Valid_loss 0.419754
Epoch 51, Train Loss 0.249684, Valid_loss 0.432375
Epoch 52, Train Loss 0.252952, Valid_loss 0.459345
[I 2025-08-31 15:44:59,909] Trial 1 finished with value: 0.416409361575331 and parameters: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 1, 'dropout': 0.5, 'weight_decay': 0.0001, 'emb_dim': 64, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.3665540851652622.
👉 train samples(학습 샘플(bag))=126, batch_size=16 -> steps(샘플수/batch크기)=8
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 29.04 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.627751, Valid_loss 0.569579
Epoch 2, Train Loss 0.586803, Valid_loss 0.537549
Epoch 3, Train Loss 0.532023, Valid_loss 0.502012
Epoch 4, Train Loss 0.498172, Valid_loss 0.474935
Epoch 5, Train Loss 0.458228, Valid_loss 0.451728
Epoch 6, Train Loss 0.424392, Valid_loss 0.434794
Epoch 7, Train Loss 0.398419, Valid_loss 0.424566
Epoch 8, Train Loss 0.371060, Valid_loss 0.418569
Epoch 9, Train Loss 0.348669, Valid_loss 0.422306
Epoch 10, Train Loss 0.329332, Valid_loss 0.421777
Epoch 11, Train Loss 0.321825, Valid_loss 0.441823
Epoch 12, Train Loss 0.304187, Valid_loss 0.430206
Epoch 13, Train Loss 0.314965, Valid_loss 0.421076
Epoch 14, Train Loss 0.292519, Valid_loss 0.419522
Epoch 15, Train Loss 0.297354, Valid_loss 0.425367
Epoch 16, Train Loss 0.286982, Valid_loss 0.428910
Epoch 17, Train Loss 0.284743, Valid_loss 0.401100
Epoch 18, Train Loss 0.284057, Valid_loss 0.422262
Epoch 19, Train Loss 0.277049, Valid_loss 0.433747
Epoch 20, Train Loss 0.273579, Valid_loss 0.397156
Epoch 21, Train Loss 0.280303, Valid_loss 0.447550
Epoch 22, Train Loss 0.274335, Valid_loss 0.418339
Epoch 23, Train Loss 0.262597, Valid_loss 0.404594
Epoch 24, Train Loss 0.275433, Valid_loss 0.410514
Epoch 25, Train Loss 0.272916, Valid_loss 0.397299
Epoch 26, Train Loss 0.260067, Valid_loss 0.401999
Epoch 27, Train Loss 0.263347, Valid_loss 0.419986
Epoch 28, Train Loss 0.252434, Valid_loss 0.392560
Epoch 29, Train Loss 0.251851, Valid_loss 0.415046
Epoch 30, Train Loss 0.255631, Valid_loss 0.390789
Epoch 31, Train Loss 0.249605, Valid_loss 0.392086
Epoch 32, Train Loss 0.250408, Valid_loss 0.398175
Epoch 33, Train Loss 0.255408, Valid_loss 0.397528
Epoch 34, Train Loss 0.245868, Valid_loss 0.401982
Epoch 35, Train Loss 0.250747, Valid_loss 0.390907
Epoch 36, Train Loss 0.249052, Valid_loss 0.384484
Epoch 37, Train Loss 0.243555, Valid_loss 0.380288
Epoch 38, Train Loss 0.253365, Valid_loss 0.422894
Epoch 39, Train Loss 0.246360, Valid_loss 0.387806
Epoch 40, Train Loss 0.247644, Valid_loss 0.413326
Epoch 41, Train Loss 0.242145, Valid_loss 0.384069
Epoch 42, Train Loss 0.237552, Valid_loss 0.384955
Epoch 43, Train Loss 0.238238, Valid_loss 0.395721
Epoch 44, Train Loss 0.236526, Valid_loss 0.400780
Epoch 45, Train Loss 0.240034, Valid_loss 0.380081
Epoch 46, Train Loss 0.242473, Valid_loss 0.367751
Epoch 47, Train Loss 0.235837, Valid_loss 0.402988
Epoch 48, Train Loss 0.237294, Valid_loss 0.379317
Epoch 49, Train Loss 0.231885, Valid_loss 0.427485
Epoch 50, Train Loss 0.235701, Valid_loss 0.374341
Epoch 51, Train Loss 0.235506, Valid_loss 0.391988
Epoch 52, Train Loss 0.237263, Valid_loss 0.392940
[I 2025-08-31 15:48:30,542] Trial 2 finished with value: 0.36775109970143866 and parameters: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 2, 'dropout': 0.3, 'weight_decay': 0.001, 'emb_dim': 64, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.3665540851652622.
선택된 trial params: {'learning_rate': 0.001, 'epochs': 100, 'heads': 1, 'dropout': 0.3, 'weight_decay': 0.01, 'emb_dim': 8, 'augment_num': 100, 'pca': False}
👉 train samples(학습 샘플(bag))=126, batch_size=16 -> steps(샘플수/batch크기)=8
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=10, batch_size=1 -> steps=10
output_class :  1
Memory Allocated: 25.64 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.669485, Valid_loss 0.640706
Epoch 2, Train Loss 0.656730, Valid_loss 0.626030
Epoch 3, Train Loss 0.636704, Valid_loss 0.614698
Epoch 4, Train Loss 0.617082, Valid_loss 0.608692
Epoch 5, Train Loss 0.642362, Valid_loss 0.602281
Epoch 6, Train Loss 0.615378, Valid_loss 0.589308
Epoch 7, Train Loss 0.607649, Valid_loss 0.562014
Epoch 8, Train Loss 0.569859, Valid_loss 0.544578
Epoch 9, Train Loss 0.530573, Valid_loss 0.529022
Epoch 10, Train Loss 0.532419, Valid_loss 0.523985
Epoch 11, Train Loss 0.520156, Valid_loss 0.511770
Epoch 12, Train Loss 0.501377, Valid_loss 0.496535
Epoch 13, Train Loss 0.480008, Valid_loss 0.530318
Epoch 14, Train Loss 0.492263, Valid_loss 0.479966
Epoch 15, Train Loss 0.468523, Valid_loss 0.508152
Epoch 16, Train Loss 0.449983, Valid_loss 0.549575
Epoch 17, Train Loss 0.454908, Valid_loss 0.524172
Epoch 18, Train Loss 0.441232, Valid_loss 0.466363
Epoch 19, Train Loss 0.441286, Valid_loss 0.510064
Epoch 20, Train Loss 0.431596, Valid_loss 0.502421
Epoch 21, Train Loss 0.429367, Valid_loss 0.484559
Epoch 22, Train Loss 0.418151, Valid_loss 0.473955
Epoch 23, Train Loss 0.434398, Valid_loss 0.507938
Epoch 24, Train Loss 0.422370, Valid_loss 0.510449
Epoch 25, Train Loss 0.432233, Valid_loss 0.413128
Epoch 26, Train Loss 0.423232, Valid_loss 0.475426
Epoch 27, Train Loss 0.418410, Valid_loss 0.426711
Epoch 28, Train Loss 0.437251, Valid_loss 0.492471
Epoch 29, Train Loss 0.415323, Valid_loss 0.419466
Epoch 30, Train Loss 0.408157, Valid_loss 0.508882
Epoch 31, Train Loss 0.402710, Valid_loss 0.426970
Epoch 32, Train Loss 0.403792, Valid_loss 0.481599
Epoch 33, Train Loss 0.389533, Valid_loss 0.493932
Epoch 34, Train Loss 0.408039, Valid_loss 0.452518
Epoch 35, Train Loss 0.402436, Valid_loss 0.476406
Epoch 36, Train Loss 0.400108, Valid_loss 0.413302
Epoch 37, Train Loss 0.367750, Valid_loss 0.473484
Epoch 38, Train Loss 0.404016, Valid_loss 0.455931
Epoch 39, Train Loss 0.393468, Valid_loss 0.450463
Epoch 40, Train Loss 0.388499, Valid_loss 0.514315
Epoch 41, Train Loss 0.395217, Valid_loss 0.461067
Epoch 42, Train Loss 0.355935, Valid_loss 0.498646
Epoch 43, Train Loss 0.409944, Valid_loss 0.472354
Epoch 44, Train Loss 0.380940, Valid_loss 0.441399
Epoch 45, Train Loss 0.379498, Valid_loss 0.424386
Epoch 46, Train Loss 0.370014, Valid_loss 0.454364
Epoch 47, Train Loss 0.382193, Valid_loss 0.426581
Epoch 48, Train Loss 0.389636, Valid_loss 0.453882
Epoch 49, Train Loss 0.366523, Valid_loss 0.416732
Epoch 50, Train Loss 0.360244, Valid_loss 0.459902
Epoch 51, Train Loss 0.369426, Valid_loss 0.405415
Epoch 52, Train Loss 0.379034, Valid_loss 0.449205
Epoch 53, Train Loss 0.377511, Valid_loss 0.402035
Epoch 54, Train Loss 0.378074, Valid_loss 0.468418
Epoch 55, Train Loss 0.363608, Valid_loss 0.436857
Epoch 56, Train Loss 0.385924, Valid_loss 0.440954
Epoch 57, Train Loss 0.389162, Valid_loss 0.439464
Epoch 58, Train Loss 0.367296, Valid_loss 0.404692
Epoch 59, Train Loss 0.365479, Valid_loss 0.395761
Epoch 60, Train Loss 0.346678, Valid_loss 0.430024
Epoch 61, Train Loss 0.377563, Valid_loss 0.437575
환자ID=COVID19_Participant19 -- true: 1 -- pred: 1
환자ID=COVID19_Participant20 -- true: 1 -- pred: 1
환자ID=COVID19_Participant21 -- true: 1 -- pred: 1
환자ID=COVID19_Participant26 -- true: 1 -- pred: 1
환자ID=COVID19_Participant29 -- true: 1 -- pred: 1
환자ID=COVID19_Participant6 -- true: 1 -- pred: 1
환자ID=COVID19_Participant7 -- true: 1 -- pred: 1
환자ID=Control_Participant2 -- true: 0 -- pred: 0
환자ID=Control_Participant5 -- true: 0 -- pred: 0
환자ID=Control_Participant8 -- true: 0 -- pred: 0
Best performance: Epoch 59, Loss 0.365479, Test ACC 1.000000, Test AUC 1.000000, Test Recall 1.000000, Test Precision 1.000000
Confusion Matrix:
 [3 0 0 7]
✅ Total valid splits used: 4
🔁 Repeat 0, Fold 4
cell type :  GTCGGGGGGTGG_Control_Participant7        Keratinocytes
CAAATCAATTAT_Control_Participant7     Epithelial_cells
ATACAATTGACA_Control_Participant7     Epithelial_cells
CTGTTAATGAGA_Control_Participant7     Epithelial_cells
CTTCACATTATT_Control_Participant7     Epithelial_cells
                                            ...       
GCAGGGAACTCC_COVID19_Participant30    Epithelial_cells
CAGCACCGAGCC_COVID19_Participant30    Epithelial_cells
GCCCCTTGTGAT_COVID19_Participant30    Epithelial_cells
GTGTTGTGTGTC_COVID19_Participant30              B_cell
TAACACTCACTT_COVID19_Participant30           Myelocyte
Name: singler_annotation, Length: 21169, dtype: string
cell type annotation :  GTCGGGGGGTGG_Control_Participant7        Keratinocytes
CAAATCAATTAT_Control_Participant7     Epithelial_cells
ATACAATTGACA_Control_Participant7     Epithelial_cells
CTGTTAATGAGA_Control_Participant7     Epithelial_cells
CTTCACATTATT_Control_Participant7     Epithelial_cells
                                            ...       
GCAGGGAACTCC_COVID19_Participant30    Epithelial_cells
CAGCACCGAGCC_COVID19_Participant30    Epithelial_cells
GCCCCTTGTGAT_COVID19_Participant30    Epithelial_cells
GTGTTGTGTGTC_COVID19_Participant30              B_cell
TAACACTCACTT_COVID19_Participant30           Myelocyte
Name: singler_annotation, Length: 21169, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Keratinocytes', 'Epithelial_cells', 'Neurons', 'iPS_cells', 'Embryonic_stem_cells', 'Astrocyte', 'DC', 'Gametocytes', 'HSC_-G-CSF', 'Smooth_muscle_cells', 'BM & Prog.', 'Monocyte', 'Myelocyte', 'BM', 'Endothelial_cells', 'Osteoblasts', 'Platelets', 'Erythroblast', 'NK_cell', 'T_cells', 'Chondrocytes', 'HSC_CD34+', 'CMP', 'Neutrophils', 'Fibroblasts', 'MEP', 'Neuroepithelial_cell', 'MSC', 'Pro-Myelocyte', 'B_cell', 'GMP', 'Hepatocytes', 'Macrophage', 'Tissue_stem_cells', 'Pre-B_cell_CD34-', 'Pro-B_cell_CD34+', 'Unknown']
라벨별 그룹 개수 {1: 28, 0: 12}
cell type :  CATTAAGGATAT_COVID19_Participant13    Epithelial_cells
GTAGAAGGGGGG_COVID19_Participant13           Platelets
ATTAAGAGGTAG_COVID19_Participant13    Epithelial_cells
AGATATGACAAG_COVID19_Participant13    Epithelial_cells
CTTGTAACAAAT_COVID19_Participant13    Epithelial_cells
                                            ...       
GTGTCGCGCCTG_Control_Participant6     Epithelial_cells
TGGAATTATGAT_Control_Participant6                  CMP
TAGTCGAGACGT_Control_Participant6     Epithelial_cells
CTCCAGTGGCAC_Control_Participant6     Epithelial_cells
GAATAGACGACA_Control_Participant6     Epithelial_cells
Name: singler_annotation, Length: 5778, dtype: string
cell type annotation :  CATTAAGGATAT_COVID19_Participant13    Epithelial_cells
GTAGAAGGGGGG_COVID19_Participant13           Platelets
ATTAAGAGGTAG_COVID19_Participant13    Epithelial_cells
AGATATGACAAG_COVID19_Participant13    Epithelial_cells
CTTGTAACAAAT_COVID19_Participant13    Epithelial_cells
                                            ...       
GTGTCGCGCCTG_Control_Participant6     Epithelial_cells
TGGAATTATGAT_Control_Participant6                  CMP
TAGTCGAGACGT_Control_Participant6     Epithelial_cells
CTCCAGTGGCAC_Control_Participant6     Epithelial_cells
GAATAGACGACA_Control_Participant6     Epithelial_cells
Name: singler_annotation, Length: 5778, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Epithelial_cells', 'Platelets', 'Keratinocytes', 'Macrophage', 'B_cell', 'Neutrophils', 'DC', 'Monocyte', 'T_cells', 'NK_cell', 'HSC_CD34+', 'Tissue_stem_cells', 'Embryonic_stem_cells', 'HSC_-G-CSF', 'Neurons', 'BM', 'Erythroblast', 'Fibroblasts', 'iPS_cells', 'Hepatocytes', 'CMP', 'Gametocytes', 'Chondrocytes', 'Endothelial_cells', 'Pre-B_cell_CD34-', 'Myelocyte', 'Astrocyte', 'Neuroepithelial_cell', 'Smooth_muscle_cells', 'GMP', 'MSC', 'Osteoblasts', 'MEP', 'BM & Prog.', 'Pro-B_cell_CD34+', 'Pro-Myelocyte', 'Unknown']
라벨별 그룹 개수 {1: 7, 0: 3}
🔍 Split #5
  → train_p_index 환자 수 (환자 단위로 묶인 index list): 40
  → test_p_index 환자 수  (환자 단위로 묶인 index list): 10
  → train 환자 ID: ['COVID19_Participant11', 'COVID19_Participant12', 'COVID19_Participant14', 'COVID19_Participant15', 'COVID19_Participant18', 'COVID19_Participant19', 'COVID19_Participant2', 'COVID19_Participant20', 'COVID19_Participant21', 'COVID19_Participant23', 'COVID19_Participant25', 'COVID19_Participant26', 'COVID19_Participant27', 'COVID19_Participant28', 'COVID19_Participant29', 'COVID19_Participant3', 'COVID19_Participant30', 'COVID19_Participant31', 'COVID19_Participant32', 'COVID19_Participant36', 'COVID19_Participant38', 'COVID19_Participant39', 'COVID19_Participant4', 'COVID19_Participant5', 'COVID19_Participant6', 'COVID19_Participant7', 'COVID19_Participant8', 'COVID19_Participant9', 'Control_Participant11', 'Control_Participant12', 'Control_Participant13', 'Control_Participant14', 'Control_Participant15', 'Control_Participant2', 'Control_Participant3', 'Control_Participant4', 'Control_Participant5', 'Control_Participant7', 'Control_Participant8', 'Control_Participant9']
  → test  환자 ID: ['COVID19_Participant10', 'COVID19_Participant13', 'COVID19_Participant17', 'COVID19_Participant22', 'COVID19_Participant35', 'COVID19_Participant37', 'COVID19_Participant40', 'Control_Participant1', 'Control_Participant10', 'Control_Participant6']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant12, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant18, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant21, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant27, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant3, Label: 1
    ID: COVID19_Participant30, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant36, Label: 1
    ID: COVID19_Participant38, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant5, Label: 1
    ID: COVID19_Participant6, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: COVID19_Participant9, Label: 1
    ID: Control_Participant11, Label: 0
    ID: Control_Participant12, Label: 0
    ID: Control_Participant13, Label: 0
    ID: Control_Participant14, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant2, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant4, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant8, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: COVID19_Participant10, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant35, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant10, Label: 0
    ID: Control_Participant6, Label: 0
전체 데이터 index 길이 50
label_stat (train 환자 라벨 목록) 갯수 40
train_data에서 환자 단위로, train과 validation 나누기
기존 train_p_index 40
기존 (train) label_stat 40
train-vali 분할 후! 
train y 의 classes : {0, 1} valid y 의 classes : {0, 1} label_stat 의 classes : {0, 1}
train_p_index_ 26
valid_p_index 14
test_p_index 10
→ train 환자 ID 및 라벨:
   총 개수: 26
   환자ID=Control_Participant12, Label=0, 셀개수=99
   환자ID=Control_Participant2, Label=0, 셀개수=41
   환자ID=COVID19_Participant2, Label=1, 셀개수=329
   환자ID=COVID19_Participant39, Label=1, 셀개수=454
   환자ID=COVID19_Participant11, Label=1, 셀개수=382
   환자ID=Control_Participant5, Label=0, 셀개수=717
   환자ID=COVID19_Participant15, Label=1, 셀개수=1003
   환자ID=COVID19_Participant20, Label=1, 셀개수=2033
   환자ID=COVID19_Participant5, Label=1, 셀개수=89
   환자ID=COVID19_Participant14, Label=1, 셀개수=382
   환자ID=COVID19_Participant21, Label=1, 셀개수=39
   환자ID=Control_Participant3, Label=0, 셀개수=1620
   환자ID=COVID19_Participant28, Label=1, 셀개수=1079
   환자ID=Control_Participant8, Label=0, 셀개수=393
   환자ID=Control_Participant7, Label=0, 셀개수=762
   환자ID=COVID19_Participant18, Label=1, 셀개수=227
   환자ID=Control_Participant9, Label=0, 셀개수=558
   환자ID=Control_Participant13, Label=0, 셀개수=88
   환자ID=COVID19_Participant25, Label=1, 셀개수=496
   환자ID=COVID19_Participant30, Label=1, 셀개수=116
   환자ID=COVID19_Participant27, Label=1, 셀개수=93
   환자ID=COVID19_Participant19, Label=1, 셀개수=816
   환자ID=COVID19_Participant7, Label=1, 셀개수=409
   환자ID=COVID19_Participant4, Label=1, 셀개수=1680
   환자ID=COVID19_Participant38, Label=1, 셀개수=51
   환자ID=COVID19_Participant3, Label=1, 셀개수=104
→ valid 환자 ID 및 라벨:
   총 개수: 14
   환자ID=Control_Participant15, Label=0, 셀개수=528
   환자ID=COVID19_Participant29, Label=1, 셀개수=573
   환자ID=COVID19_Participant32, Label=1, 셀개수=1665
   환자ID=COVID19_Participant31, Label=1, 셀개수=410
   환자ID=COVID19_Participant6, Label=1, 셀개수=84
   환자ID=COVID19_Participant23, Label=1, 셀개수=307
   환자ID=Control_Participant4, Label=0, 셀개수=440
   환자ID=Control_Participant11, Label=0, 셀개수=1164
   환자ID=COVID19_Participant9, Label=1, 셀개수=86
   환자ID=COVID19_Participant8, Label=1, 셀개수=462
   환자ID=Control_Participant14, Label=0, 셀개수=274
   환자ID=COVID19_Participant36, Label=1, 셀개수=200
   환자ID=COVID19_Participant12, Label=1, 셀개수=102
   환자ID=COVID19_Participant26, Label=1, 셀개수=814
→ test 환자 ID 및 라벨:
   총 개수: 10
   환자ID=COVID19_Participant10, Label=1, 셀개수=18
   환자ID=COVID19_Participant13, Label=1, 셀개수=730
   환자ID=COVID19_Participant17, Label=1, 셀개수=843
   환자ID=COVID19_Participant22, Label=1, 셀개수=865
   환자ID=COVID19_Participant35, Label=1, 셀개수=83
   환자ID=COVID19_Participant37, Label=1, 셀개수=668
   환자ID=COVID19_Participant40, Label=1, 셀개수=381
   환자ID=Control_Participant1, Label=0, 셀개수=414
   환자ID=Control_Participant10, Label=0, 셀개수=1645
   환자ID=Control_Participant6, Label=0, 셀개수=131
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Keratinocytes', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Neurons', 'iPS_cells', 'Embryonic_stem_cells', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
전체 데이터 길이 26947
전체 cell type 길이 0           Keratinocytes
1        Epithelial_cells
2        Epithelial_cells
3        Epithelial_cells
4        Epithelial_cells
               ...       
26942    Epithelial_cells
26943                 CMP
26944    Epithelial_cells
26945    Epithelial_cells
26946    Epithelial_cells
Length: 26947, dtype: string
cell type의 NaN 개수 체크 0
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:11,  8.73it/s]  2%|▏         | 2/100 [00:00<00:12,  7.92it/s]  3%|▎         | 3/100 [00:00<00:11,  8.41it/s]  4%|▍         | 4/100 [00:00<00:11,  8.44it/s]  5%|▌         | 5/100 [00:00<00:11,  8.25it/s]  6%|▌         | 6/100 [00:00<00:10,  8.58it/s]  7%|▋         | 7/100 [00:00<00:10,  8.69it/s]  8%|▊         | 8/100 [00:00<00:10,  8.81it/s]  9%|▉         | 9/100 [00:01<00:10,  8.73it/s] 10%|█         | 10/100 [00:01<00:10,  8.87it/s] 11%|█         | 11/100 [00:01<00:09,  9.00it/s] 12%|█▏        | 12/100 [00:01<00:09,  8.98it/s] 13%|█▎        | 13/100 [00:01<00:09,  8.73it/s] 14%|█▍        | 14/100 [00:01<00:09,  8.84it/s] 15%|█▌        | 15/100 [00:01<00:09,  9.05it/s] 16%|█▌        | 16/100 [00:01<00:09,  9.26it/s] 17%|█▋        | 17/100 [00:01<00:09,  9.19it/s] 18%|█▊        | 18/100 [00:02<00:08,  9.33it/s] 19%|█▉        | 19/100 [00:02<00:09,  8.77it/s] 20%|██        | 20/100 [00:02<00:08,  8.99it/s] 21%|██        | 21/100 [00:02<00:08,  8.99it/s] 22%|██▏       | 22/100 [00:02<00:08,  8.94it/s] 23%|██▎       | 23/100 [00:02<00:08,  9.13it/s] 24%|██▍       | 24/100 [00:02<00:08,  9.15it/s] 25%|██▌       | 25/100 [00:02<00:08,  9.23it/s] 26%|██▌       | 26/100 [00:02<00:07,  9.28it/s] 27%|██▋       | 27/100 [00:03<00:08,  9.03it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.72it/s] 29%|██▉       | 29/100 [00:03<00:07,  8.94it/s] 30%|███       | 30/100 [00:03<00:07,  8.87it/s] 31%|███       | 31/100 [00:03<00:07,  8.80it/s] 32%|███▏      | 32/100 [00:03<00:07,  8.50it/s] 33%|███▎      | 33/100 [00:03<00:07,  8.63it/s] 34%|███▍      | 34/100 [00:03<00:07,  8.82it/s] 35%|███▌      | 35/100 [00:03<00:07,  8.92it/s] 36%|███▌      | 36/100 [00:04<00:07,  8.95it/s] 37%|███▋      | 37/100 [00:04<00:07,  8.48it/s] 38%|███▊      | 38/100 [00:04<00:06,  8.88it/s] 39%|███▉      | 39/100 [00:04<00:07,  8.68it/s] 40%|████      | 40/100 [00:04<00:07,  8.41it/s] 41%|████      | 41/100 [00:04<00:06,  8.56it/s] 42%|████▏     | 42/100 [00:04<00:06,  8.67it/s] 43%|████▎     | 43/100 [00:04<00:06,  8.35it/s] 44%|████▍     | 44/100 [00:05<00:06,  8.55it/s] 45%|████▌     | 45/100 [00:05<00:06,  8.58it/s] 46%|████▌     | 46/100 [00:05<00:06,  8.78it/s] 47%|████▋     | 47/100 [00:05<00:06,  8.40it/s] 48%|████▊     | 48/100 [00:05<00:05,  8.82it/s] 49%|████▉     | 49/100 [00:05<00:05,  9.02it/s] 50%|█████     | 50/100 [00:05<00:05,  9.18it/s] 51%|█████     | 51/100 [00:05<00:05,  8.32it/s] 52%|█████▏    | 52/100 [00:05<00:05,  8.49it/s] 53%|█████▎    | 53/100 [00:06<00:05,  8.62it/s] 54%|█████▍    | 54/100 [00:06<00:05,  8.09it/s] 55%|█████▌    | 55/100 [00:06<00:05,  8.05it/s] 56%|█████▌    | 56/100 [00:06<00:05,  8.34it/s] 57%|█████▋    | 57/100 [00:06<00:05,  7.96it/s] 58%|█████▊    | 58/100 [00:06<00:05,  7.81it/s] 59%|█████▉    | 59/100 [00:06<00:05,  8.00it/s] 60%|██████    | 60/100 [00:06<00:04,  8.15it/s] 61%|██████    | 61/100 [00:07<00:04,  8.10it/s] 62%|██████▏   | 62/100 [00:07<00:04,  8.15it/s] 63%|██████▎   | 63/100 [00:07<00:04,  8.29it/s] 64%|██████▍   | 64/100 [00:07<00:04,  8.40it/s] 65%|██████▌   | 65/100 [00:07<00:04,  8.36it/s] 66%|██████▌   | 66/100 [00:07<00:05,  6.34it/s] 67%|██████▋   | 67/100 [00:07<00:04,  6.91it/s] 68%|██████▊   | 68/100 [00:08<00:04,  6.91it/s] 69%|██████▉   | 69/100 [00:08<00:04,  6.87it/s] 70%|███████   | 70/100 [00:08<00:04,  7.26it/s] 71%|███████   | 71/100 [00:08<00:03,  7.72it/s] 72%|███████▏  | 72/100 [00:08<00:03,  7.70it/s] 73%|███████▎  | 73/100 [00:08<00:03,  7.61it/s] 74%|███████▍  | 74/100 [00:08<00:03,  7.90it/s] 75%|███████▌  | 75/100 [00:08<00:03,  8.13it/s] 76%|███████▌  | 76/100 [00:09<00:03,  7.52it/s] 77%|███████▋  | 77/100 [00:09<00:02,  7.85it/s] 78%|███████▊  | 78/100 [00:09<00:02,  7.60it/s] 79%|███████▉  | 79/100 [00:09<00:02,  7.75it/s] 80%|████████  | 80/100 [00:09<00:02,  7.04it/s] 81%|████████  | 81/100 [00:09<00:02,  7.43it/s] 82%|████████▏ | 82/100 [00:09<00:02,  7.72it/s] 83%|████████▎ | 83/100 [00:09<00:02,  8.03it/s] 84%|████████▍ | 84/100 [00:10<00:02,  6.97it/s] 85%|████████▌ | 85/100 [00:10<00:02,  5.86it/s] 86%|████████▌ | 86/100 [00:10<00:02,  6.16it/s] 87%|████████▋ | 87/100 [00:10<00:01,  6.62it/s] 88%|████████▊ | 88/100 [00:10<00:01,  7.23it/s] 89%|████████▉ | 89/100 [00:10<00:01,  7.43it/s] 90%|█████████ | 90/100 [00:11<00:01,  7.66it/s] 91%|█████████ | 91/100 [00:11<00:01,  7.47it/s] 92%|█████████▏| 92/100 [00:11<00:01,  7.75it/s] 93%|█████████▎| 93/100 [00:11<00:00,  7.80it/s] 94%|█████████▍| 94/100 [00:11<00:00,  7.95it/s] 95%|█████████▌| 95/100 [00:11<00:00,  7.97it/s] 96%|█████████▌| 96/100 [00:11<00:00,  8.06it/s] 97%|█████████▋| 97/100 [00:11<00:00,  8.19it/s] 98%|█████████▊| 98/100 [00:11<00:00,  8.13it/s] 99%|█████████▉| 99/100 [00:12<00:00,  7.29it/s]100%|██████████| 100/100 [00:12<00:00,  7.06it/s]100%|██████████| 100/100 [00:12<00:00,  8.12it/s]
[I 2025-08-31 15:52:30,188] A new study created in memory with name: no-name-9dfe07f5-8cfe-4076-b6d0-6b3127631a8a
👉 train samples(학습 샘플(bag))=126, batch_size=16 -> steps(샘플수/batch크기)=8
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 26.96 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.688408, Valid_loss 0.564767
Epoch 2, Train Loss 0.634191, Valid_loss 0.469196
Epoch 3, Train Loss 0.514144, Valid_loss 0.391708
Epoch 4, Train Loss 0.451227, Valid_loss 0.379270
Epoch 5, Train Loss 0.431072, Valid_loss 0.395996
Epoch 6, Train Loss 0.408268, Valid_loss 0.378299
Epoch 7, Train Loss 0.410339, Valid_loss 0.384127
Epoch 8, Train Loss 0.380257, Valid_loss 0.319543
Epoch 9, Train Loss 0.400706, Valid_loss 0.346627
Epoch 10, Train Loss 0.388110, Valid_loss 0.286200
Epoch 11, Train Loss 0.349666, Valid_loss 0.440334
Epoch 12, Train Loss 0.413907, Valid_loss 0.305660
Epoch 13, Train Loss 0.381942, Valid_loss 0.391348
Epoch 14, Train Loss 0.359235, Valid_loss 0.348844
Epoch 15, Train Loss 0.357233, Valid_loss 0.331558
Epoch 16, Train Loss 0.375831, Valid_loss 0.302980
Epoch 17, Train Loss 0.351360, Valid_loss 0.288015
Epoch 18, Train Loss 0.351871, Valid_loss 0.340217
Epoch 19, Train Loss 0.354652, Valid_loss 0.236479
Epoch 20, Train Loss 0.335197, Valid_loss 0.281332
Epoch 21, Train Loss 0.342566, Valid_loss 0.277697
Epoch 22, Train Loss 0.338886, Valid_loss 0.314072
Epoch 23, Train Loss 0.357755, Valid_loss 0.276413
Epoch 24, Train Loss 0.345233, Valid_loss 0.242649
Epoch 25, Train Loss 0.358651, Valid_loss 0.378159
Epoch 26, Train Loss 0.357048, Valid_loss 0.245888
Epoch 27, Train Loss 0.345660, Valid_loss 0.345432
Epoch 28, Train Loss 0.345113, Valid_loss 0.266137
Epoch 29, Train Loss 0.349513, Valid_loss 0.289886
Epoch 30, Train Loss 0.325416, Valid_loss 0.267944
Epoch 31, Train Loss 0.344581, Valid_loss 0.255059
Epoch 32, Train Loss 0.319537, Valid_loss 0.294103
Epoch 33, Train Loss 0.322091, Valid_loss 0.230797
Epoch 34, Train Loss 0.324942, Valid_loss 0.288974
Epoch 35, Train Loss 0.318948, Valid_loss 0.309647
Epoch 36, Train Loss 0.318483, Valid_loss 0.235854
Epoch 37, Train Loss 0.312995, Valid_loss 0.288925
Epoch 38, Train Loss 0.302375, Valid_loss 0.256387
Epoch 39, Train Loss 0.295597, Valid_loss 0.266319
Epoch 40, Train Loss 0.303680, Valid_loss 0.249315
Epoch 41, Train Loss 0.296325, Valid_loss 0.295536
Epoch 42, Train Loss 0.304887, Valid_loss 0.263345
Epoch 43, Train Loss 0.288581, Valid_loss 0.245129
Epoch 44, Train Loss 0.280363, Valid_loss 0.224050
Epoch 45, Train Loss 0.289194, Valid_loss 0.276861
Epoch 46, Train Loss 0.281524, Valid_loss 0.246170
Epoch 47, Train Loss 0.284516, Valid_loss 0.245222
Epoch 48, Train Loss 0.276359, Valid_loss 0.237493
Epoch 49, Train Loss 0.280901, Valid_loss 0.237207
Epoch 50, Train Loss 0.291048, Valid_loss 0.239699
Epoch 51, Train Loss 0.277461, Valid_loss 0.246429
Epoch 52, Train Loss 0.289916, Valid_loss 0.230991
Epoch 53, Train Loss 0.295565, Valid_loss 0.231138
Epoch 54, Train Loss 0.266422, Valid_loss 0.237318
[I 2025-08-31 15:55:51,522] Trial 0 finished with value: 0.22405045772237436 and parameters: {'learning_rate': 0.001, 'epochs': 100, 'heads': 1, 'dropout': 0.5, 'weight_decay': 0.01, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.22405045772237436.
👉 train samples(학습 샘플(bag))=126, batch_size=16 -> steps(샘플수/batch크기)=8
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 29.04 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.605451, Valid_loss 0.493764
Epoch 2, Train Loss 0.425814, Valid_loss 0.391340
Epoch 3, Train Loss 0.366378, Valid_loss 0.360452
Epoch 4, Train Loss 0.345219, Valid_loss 0.289203
Epoch 5, Train Loss 0.337917, Valid_loss 0.251872
Epoch 6, Train Loss 0.325556, Valid_loss 0.265424
Epoch 7, Train Loss 0.342485, Valid_loss 0.401299
Epoch 8, Train Loss 0.329494, Valid_loss 0.244117
Epoch 9, Train Loss 0.325075, Valid_loss 0.267281
Epoch 10, Train Loss 0.328060, Valid_loss 0.473190
Epoch 11, Train Loss 0.311736, Valid_loss 0.253489
Epoch 12, Train Loss 0.314706, Valid_loss 0.400555
Epoch 13, Train Loss 0.309694, Valid_loss 0.241970
Epoch 14, Train Loss 0.287913, Valid_loss 0.334754
Epoch 15, Train Loss 0.274076, Valid_loss 0.261255
Epoch 16, Train Loss 0.267650, Valid_loss 0.276336
Epoch 17, Train Loss 0.264164, Valid_loss 0.253904
Epoch 18, Train Loss 0.268116, Valid_loss 0.231491
Epoch 19, Train Loss 0.264200, Valid_loss 0.260784
Epoch 20, Train Loss 0.265436, Valid_loss 0.227597
Epoch 21, Train Loss 0.246702, Valid_loss 0.243145
Epoch 22, Train Loss 0.255544, Valid_loss 0.221644
Epoch 23, Train Loss 0.244327, Valid_loss 0.243462
Epoch 24, Train Loss 0.241065, Valid_loss 0.244091
Epoch 25, Train Loss 0.246615, Valid_loss 0.251173
Epoch 26, Train Loss 0.245693, Valid_loss 0.204727
Epoch 27, Train Loss 0.239540, Valid_loss 0.235449
Epoch 28, Train Loss 0.242206, Valid_loss 0.230894
Epoch 29, Train Loss 0.246907, Valid_loss 0.235097
Epoch 30, Train Loss 0.237813, Valid_loss 0.243290
Epoch 31, Train Loss 0.236637, Valid_loss 0.216760
Epoch 32, Train Loss 0.235070, Valid_loss 0.221355
Epoch 33, Train Loss 0.236105, Valid_loss 0.217983
Epoch 34, Train Loss 0.237685, Valid_loss 0.235589
Epoch 35, Train Loss 0.240702, Valid_loss 0.243851
Epoch 36, Train Loss 0.242178, Valid_loss 0.236270
Epoch 37, Train Loss 0.242008, Valid_loss 0.204784
Epoch 38, Train Loss 0.232660, Valid_loss 0.235098
Epoch 39, Train Loss 0.232675, Valid_loss 0.216031
Epoch 40, Train Loss 0.229013, Valid_loss 0.242628
Epoch 41, Train Loss 0.234699, Valid_loss 0.201509
Epoch 42, Train Loss 0.239001, Valid_loss 0.219199
Epoch 43, Train Loss 0.234898, Valid_loss 0.210199
Epoch 44, Train Loss 0.233463, Valid_loss 0.232557
Epoch 45, Train Loss 0.231199, Valid_loss 0.221902
Epoch 46, Train Loss 0.233306, Valid_loss 0.219943
Epoch 47, Train Loss 0.228424, Valid_loss 0.210955
Epoch 48, Train Loss 0.227806, Valid_loss 0.196936
Epoch 49, Train Loss 0.229658, Valid_loss 0.195733
Epoch 50, Train Loss 0.237338, Valid_loss 0.243961
Epoch 51, Train Loss 0.230340, Valid_loss 0.195314
Epoch 52, Train Loss 0.227908, Valid_loss 0.205507
Epoch 53, Train Loss 0.226930, Valid_loss 0.218399
[I 2025-08-31 15:59:26,909] Trial 1 finished with value: 0.19531424469979747 and parameters: {'learning_rate': 0.001, 'epochs': 100, 'heads': 2, 'dropout': 0.3, 'weight_decay': 0.001, 'emb_dim': 64, 'augment_num': 100, 'pca': False}. Best is trial 1 with value: 0.19531424469979747.
👉 train samples(학습 샘플(bag))=126, batch_size=16 -> steps(샘플수/batch크기)=8
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 26.96 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.724305, Valid_loss 0.571176
Epoch 2, Train Loss 0.620205, Valid_loss 0.589695
Epoch 3, Train Loss 0.619731, Valid_loss 0.447307
Epoch 4, Train Loss 0.531068, Valid_loss 0.435163
Epoch 5, Train Loss 0.474118, Valid_loss 0.376518
Epoch 6, Train Loss 0.434011, Valid_loss 0.447907
Epoch 7, Train Loss 0.416222, Valid_loss 0.342258
Epoch 8, Train Loss 0.426325, Valid_loss 0.344449
Epoch 9, Train Loss 0.401764, Valid_loss 0.363450
Epoch 10, Train Loss 0.385278, Valid_loss 0.383150
Epoch 11, Train Loss 0.401730, Valid_loss 0.355189
Epoch 12, Train Loss 0.387276, Valid_loss 0.380973
Epoch 13, Train Loss 0.376190, Valid_loss 0.349409
Epoch 14, Train Loss 0.355125, Valid_loss 0.323932
Epoch 15, Train Loss 0.363812, Valid_loss 0.347229
Epoch 16, Train Loss 0.375501, Valid_loss 0.420712
Epoch 17, Train Loss 0.378124, Valid_loss 0.304607
Epoch 18, Train Loss 0.346006, Valid_loss 0.449247
Epoch 19, Train Loss 0.351074, Valid_loss 0.296533
Epoch 20, Train Loss 0.391490, Valid_loss 0.406198
Epoch 21, Train Loss 0.351065, Valid_loss 0.312602
Epoch 22, Train Loss 0.365940, Valid_loss 0.412722
Epoch 23, Train Loss 0.345452, Valid_loss 0.323131
Epoch 24, Train Loss 0.334117, Valid_loss 0.313409
Epoch 25, Train Loss 0.351526, Valid_loss 0.304741
Epoch 26, Train Loss 0.307172, Valid_loss 0.309086
Epoch 27, Train Loss 0.311613, Valid_loss 0.349194
Epoch 28, Train Loss 0.331421, Valid_loss 0.284410
Epoch 29, Train Loss 0.317340, Valid_loss 0.296293
Epoch 30, Train Loss 0.304262, Valid_loss 0.268936
Epoch 31, Train Loss 0.318418, Valid_loss 0.275940
Epoch 32, Train Loss 0.318822, Valid_loss 0.305148
Epoch 33, Train Loss 0.326985, Valid_loss 0.252982
Epoch 34, Train Loss 0.307131, Valid_loss 0.273527
Epoch 35, Train Loss 0.300677, Valid_loss 0.344774
Epoch 36, Train Loss 0.301729, Valid_loss 0.285846
Epoch 37, Train Loss 0.321254, Valid_loss 0.355108
Epoch 38, Train Loss 0.306156, Valid_loss 0.286085
Epoch 39, Train Loss 0.297685, Valid_loss 0.277213
Epoch 40, Train Loss 0.280343, Valid_loss 0.278437
Epoch 41, Train Loss 0.279787, Valid_loss 0.249998
Epoch 42, Train Loss 0.286100, Valid_loss 0.303963
Epoch 43, Train Loss 0.287261, Valid_loss 0.250530
Epoch 44, Train Loss 0.282388, Valid_loss 0.253538
Epoch 45, Train Loss 0.280980, Valid_loss 0.295893
Epoch 46, Train Loss 0.277697, Valid_loss 0.266147
Epoch 47, Train Loss 0.289298, Valid_loss 0.274041
Epoch 48, Train Loss 0.268116, Valid_loss 0.242393
Epoch 49, Train Loss 0.281062, Valid_loss 0.248742
Epoch 50, Train Loss 0.280477, Valid_loss 0.257656
Epoch 51, Train Loss 0.269003, Valid_loss 0.255004
Epoch 52, Train Loss 0.274000, Valid_loss 0.258560
Epoch 53, Train Loss 0.261706, Valid_loss 0.256889
Epoch 54, Train Loss 0.267905, Valid_loss 0.240375
Epoch 55, Train Loss 0.267672, Valid_loss 0.255005
Epoch 56, Train Loss 0.265303, Valid_loss 0.239385
Epoch 57, Train Loss 0.275539, Valid_loss 0.241730
Epoch 58, Train Loss 0.269420, Valid_loss 0.251481
[I 2025-08-31 16:04:56,438] Trial 2 finished with value: 0.23938501799213036 and parameters: {'learning_rate': 0.001, 'epochs': 100, 'heads': 4, 'dropout': 0.5, 'weight_decay': 0.001, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 1 with value: 0.19531424469979747.
선택된 trial params: {'learning_rate': 0.001, 'epochs': 100, 'heads': 2, 'dropout': 0.3, 'weight_decay': 0.001, 'emb_dim': 64, 'augment_num': 100, 'pca': False}
👉 train samples(학습 샘플(bag))=126, batch_size=16 -> steps(샘플수/batch크기)=8
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=10, batch_size=1 -> steps=10
output_class :  1
Memory Allocated: 29.04 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.644482, Valid_loss 0.493704
Epoch 2, Train Loss 0.493314, Valid_loss 0.354098
Epoch 3, Train Loss 0.393582, Valid_loss 0.326949
Epoch 4, Train Loss 0.349413, Valid_loss 0.409497
Epoch 5, Train Loss 0.348879, Valid_loss 0.301439
Epoch 6, Train Loss 0.336778, Valid_loss 0.341839
Epoch 7, Train Loss 0.311456, Valid_loss 0.318201
Epoch 8, Train Loss 0.315160, Valid_loss 0.318704
Epoch 9, Train Loss 0.314824, Valid_loss 0.261107
Epoch 10, Train Loss 0.302503, Valid_loss 0.306465
Epoch 11, Train Loss 0.306504, Valid_loss 0.391700
Epoch 12, Train Loss 0.320126, Valid_loss 0.259269
Epoch 13, Train Loss 0.318749, Valid_loss 0.278721
Epoch 14, Train Loss 0.293316, Valid_loss 0.300289
Epoch 15, Train Loss 0.290110, Valid_loss 0.259019
Epoch 16, Train Loss 0.270662, Valid_loss 0.238658
Epoch 17, Train Loss 0.281127, Valid_loss 0.285949
Epoch 18, Train Loss 0.267961, Valid_loss 0.237843
Epoch 19, Train Loss 0.268358, Valid_loss 0.259357
Epoch 20, Train Loss 0.258515, Valid_loss 0.293848
Epoch 21, Train Loss 0.259753, Valid_loss 0.240911
Epoch 22, Train Loss 0.256900, Valid_loss 0.260826
Epoch 23, Train Loss 0.253676, Valid_loss 0.230933
Epoch 24, Train Loss 0.260120, Valid_loss 0.237734
Epoch 25, Train Loss 0.270039, Valid_loss 0.268802
Epoch 26, Train Loss 0.254018, Valid_loss 0.242898
Epoch 27, Train Loss 0.252990, Valid_loss 0.221046
Epoch 28, Train Loss 0.240490, Valid_loss 0.230406
Epoch 29, Train Loss 0.241753, Valid_loss 0.226178
Epoch 30, Train Loss 0.240637, Valid_loss 0.233956
Epoch 31, Train Loss 0.238975, Valid_loss 0.229836
Epoch 32, Train Loss 0.237409, Valid_loss 0.232295
Epoch 33, Train Loss 0.240544, Valid_loss 0.232474
Epoch 34, Train Loss 0.241884, Valid_loss 0.226535
Epoch 35, Train Loss 0.234764, Valid_loss 0.217557
Epoch 36, Train Loss 0.233801, Valid_loss 0.220573
Epoch 37, Train Loss 0.234369, Valid_loss 0.208088
Epoch 38, Train Loss 0.234867, Valid_loss 0.204145
Epoch 39, Train Loss 0.239624, Valid_loss 0.214877
Epoch 40, Train Loss 0.230540, Valid_loss 0.208404
Epoch 41, Train Loss 0.239549, Valid_loss 0.219313
Epoch 42, Train Loss 0.231718, Valid_loss 0.227951
Epoch 43, Train Loss 0.232497, Valid_loss 0.214947
Epoch 44, Train Loss 0.236174, Valid_loss 0.242573
Epoch 45, Train Loss 0.235975, Valid_loss 0.216526
Epoch 46, Train Loss 0.234425, Valid_loss 0.228867
Epoch 47, Train Loss 0.235432, Valid_loss 0.191307
Epoch 48, Train Loss 0.245956, Valid_loss 0.231581
Epoch 49, Train Loss 0.241470, Valid_loss 0.195833
Epoch 50, Train Loss 0.233142, Valid_loss 0.230751
Epoch 51, Train Loss 0.233302, Valid_loss 0.216859
Epoch 52, Train Loss 0.226309, Valid_loss 0.214155
Epoch 53, Train Loss 0.226870, Valid_loss 0.220712
Epoch 54, Train Loss 0.227050, Valid_loss 0.218692
Epoch 55, Train Loss 0.228358, Valid_loss 0.213696
Epoch 56, Train Loss 0.225985, Valid_loss 0.221052
Epoch 57, Train Loss 0.222834, Valid_loss 0.213714
Epoch 58, Train Loss 0.226274, Valid_loss 0.205280
Epoch 59, Train Loss 0.224192, Valid_loss 0.210766
Epoch 60, Train Loss 0.226441, Valid_loss 0.212952
환자ID=COVID19_Participant10 -- true: 1 -- pred: 0
환자ID=COVID19_Participant13 -- true: 1 -- pred: 1
환자ID=COVID19_Participant17 -- true: 1 -- pred: 1
환자ID=COVID19_Participant22 -- true: 1 -- pred: 1
환자ID=COVID19_Participant35 -- true: 1 -- pred: 0
환자ID=COVID19_Participant37 -- true: 1 -- pred: 1
환자ID=COVID19_Participant40 -- true: 1 -- pred: 1
환자ID=Control_Participant1 -- true: 0 -- pred: 0
환자ID=Control_Participant10 -- true: 0 -- pred: 0
환자ID=Control_Participant6 -- true: 0 -- pred: 0
Best performance: Epoch 47, Loss 0.235432, Test ACC 0.800000, Test AUC 0.857143, Test Recall 0.714286, Test Precision 1.000000
Confusion Matrix:
 [3 0 2 5]
✅ Total valid splits used: 5

📌 Repeat 0: 평균 AUC = 0.9048, 표준편차 = 0.0904
Test ACC 평균 0.860000, Test Recall 평균 0.885714, Test Precision 평균 0.940000
fold_aucs = [1.0, 0.9047619047619048, 0.761904761904762, 1.0, 0.8571428571428571]
NaN 개수: 0 / 전체 5개

🔁 Repeat 1, Fold 0
cell type :  GTCGGGGGGTGG_Control_Participant7        Keratinocytes
CAAATCAATTAT_Control_Participant7     Epithelial_cells
ATACAATTGACA_Control_Participant7     Epithelial_cells
CTGTTAATGAGA_Control_Participant7     Epithelial_cells
CTTCACATTATT_Control_Participant7     Epithelial_cells
                                            ...       
GCAGGGAACTCC_COVID19_Participant30    Epithelial_cells
CAGCACCGAGCC_COVID19_Participant30    Epithelial_cells
GCCCCTTGTGAT_COVID19_Participant30    Epithelial_cells
GTGTTGTGTGTC_COVID19_Participant30              B_cell
TAACACTCACTT_COVID19_Participant30           Myelocyte
Name: singler_annotation, Length: 22840, dtype: string
cell type annotation :  GTCGGGGGGTGG_Control_Participant7        Keratinocytes
CAAATCAATTAT_Control_Participant7     Epithelial_cells
ATACAATTGACA_Control_Participant7     Epithelial_cells
CTGTTAATGAGA_Control_Participant7     Epithelial_cells
CTTCACATTATT_Control_Participant7     Epithelial_cells
                                            ...       
GCAGGGAACTCC_COVID19_Participant30    Epithelial_cells
CAGCACCGAGCC_COVID19_Participant30    Epithelial_cells
GCCCCTTGTGAT_COVID19_Participant30    Epithelial_cells
GTGTTGTGTGTC_COVID19_Participant30              B_cell
TAACACTCACTT_COVID19_Participant30           Myelocyte
Name: singler_annotation, Length: 22840, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Keratinocytes', 'Epithelial_cells', 'Neurons', 'iPS_cells', 'Embryonic_stem_cells', 'Astrocyte', 'DC', 'Gametocytes', 'HSC_-G-CSF', 'Smooth_muscle_cells', 'BM & Prog.', 'Monocyte', 'Myelocyte', 'BM', 'Endothelial_cells', 'Osteoblasts', 'Platelets', 'Erythroblast', 'NK_cell', 'T_cells', 'Chondrocytes', 'HSC_CD34+', 'CMP', 'Neutrophils', 'Fibroblasts', 'MEP', 'Neuroepithelial_cell', 'MSC', 'Pro-Myelocyte', 'B_cell', 'GMP', 'Hepatocytes', 'Macrophage', 'Tissue_stem_cells', 'Pre-B_cell_CD34-', 'Pro-B_cell_CD34+', 'Unknown']
라벨별 그룹 개수 {1: 28, 0: 12}
cell type :  AGAGTGCAAGGT_COVID19_Participant25    Epithelial_cells
TTCCTGGAACCT_COVID19_Participant25    Epithelial_cells
CGTTGCACGTAC_COVID19_Participant25    Epithelial_cells
ATCTCCGTGCGC_COVID19_Participant25    Epithelial_cells
CCCTCCCCAGAA_COVID19_Participant25    Epithelial_cells
                                            ...       
GGAAGAACCCAC_COVID19_Participant2     Epithelial_cells
TGGCAACCGAAT_COVID19_Participant2             Monocyte
CGCAAGAGAGAA_COVID19_Participant2          Gametocytes
CGCTAAAACCCG_COVID19_Participant2     Epithelial_cells
GAGCGCGTCACA_COVID19_Participant2     Epithelial_cells
Name: singler_annotation, Length: 4107, dtype: string
cell type annotation :  AGAGTGCAAGGT_COVID19_Participant25    Epithelial_cells
TTCCTGGAACCT_COVID19_Participant25    Epithelial_cells
CGTTGCACGTAC_COVID19_Participant25    Epithelial_cells
ATCTCCGTGCGC_COVID19_Participant25    Epithelial_cells
CCCTCCCCAGAA_COVID19_Participant25    Epithelial_cells
                                            ...       
GGAAGAACCCAC_COVID19_Participant2     Epithelial_cells
TGGCAACCGAAT_COVID19_Participant2             Monocyte
CGCAAGAGAGAA_COVID19_Participant2          Gametocytes
CGCTAAAACCCG_COVID19_Participant2     Epithelial_cells
GAGCGCGTCACA_COVID19_Participant2     Epithelial_cells
Name: singler_annotation, Length: 4107, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Epithelial_cells', 'Keratinocytes', 'Macrophage', 'Embryonic_stem_cells', 'Gametocytes', 'NK_cell', 'Neurons', 'MSC', 'Platelets', 'iPS_cells', 'Smooth_muscle_cells', 'BM & Prog.', 'Endothelial_cells', 'Astrocyte', 'Pro-B_cell_CD34+', 'B_cell', 'T_cells', 'Neutrophils', 'Neuroepithelial_cell', 'Hepatocytes', 'Erythroblast', 'GMP', 'CMP', 'HSC_CD34+', 'DC', 'HSC_-G-CSF', 'Pre-B_cell_CD34-', 'Tissue_stem_cells', 'Osteoblasts', 'Chondrocytes', 'Myelocyte', 'Monocyte', 'MEP', 'BM', 'Pro-Myelocyte', 'Fibroblasts']
라벨별 그룹 개수 {1: 7, 0: 3}
🔍 Split #1
  → train_p_index 환자 수 (환자 단위로 묶인 index list): 40
  → test_p_index 환자 수  (환자 단위로 묶인 index list): 10
  → train 환자 ID: ['COVID19_Participant10', 'COVID19_Participant12', 'COVID19_Participant13', 'COVID19_Participant14', 'COVID19_Participant15', 'COVID19_Participant17', 'COVID19_Participant18', 'COVID19_Participant19', 'COVID19_Participant20', 'COVID19_Participant21', 'COVID19_Participant22', 'COVID19_Participant26', 'COVID19_Participant27', 'COVID19_Participant28', 'COVID19_Participant29', 'COVID19_Participant3', 'COVID19_Participant30', 'COVID19_Participant31', 'COVID19_Participant32', 'COVID19_Participant35', 'COVID19_Participant38', 'COVID19_Participant39', 'COVID19_Participant4', 'COVID19_Participant40', 'COVID19_Participant5', 'COVID19_Participant6', 'COVID19_Participant8', 'COVID19_Participant9', 'Control_Participant1', 'Control_Participant10', 'Control_Participant11', 'Control_Participant12', 'Control_Participant13', 'Control_Participant14', 'Control_Participant15', 'Control_Participant3', 'Control_Participant4', 'Control_Participant6', 'Control_Participant7', 'Control_Participant8']
  → test  환자 ID: ['COVID19_Participant11', 'COVID19_Participant2', 'COVID19_Participant23', 'COVID19_Participant25', 'COVID19_Participant36', 'COVID19_Participant37', 'COVID19_Participant7', 'Control_Participant2', 'Control_Participant5', 'Control_Participant9']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant10, Label: 1
    ID: COVID19_Participant12, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant18, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant21, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant27, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant3, Label: 1
    ID: COVID19_Participant30, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant35, Label: 1
    ID: COVID19_Participant38, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: COVID19_Participant5, Label: 1
    ID: COVID19_Participant6, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: COVID19_Participant9, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant10, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant12, Label: 0
    ID: Control_Participant13, Label: 0
    ID: Control_Participant14, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant4, Label: 0
    ID: Control_Participant6, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant8, Label: 0
  → test 환자 ID 및 라벨:
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant36, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: Control_Participant2, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant9, Label: 0
전체 데이터 index 길이 50
label_stat (train 환자 라벨 목록) 갯수 40
train_data에서 환자 단위로, train과 validation 나누기
기존 train_p_index 40
기존 (train) label_stat 40
train-vali 분할 후! 
train y 의 classes : {0, 1} valid y 의 classes : {0, 1} label_stat 의 classes : {0, 1}
train_p_index_ 26
valid_p_index 14
test_p_index 10
→ train 환자 ID 및 라벨:
   총 개수: 26
   환자ID=Control_Participant10, Label=0, 셀개수=1645
   환자ID=Control_Participant14, Label=0, 셀개수=274
   환자ID=COVID19_Participant18, Label=1, 셀개수=227
   환자ID=COVID19_Participant39, Label=1, 셀개수=454
   환자ID=COVID19_Participant10, Label=1, 셀개수=18
   환자ID=Control_Participant4, Label=0, 셀개수=440
   환자ID=COVID19_Participant14, Label=1, 셀개수=382
   환자ID=COVID19_Participant19, Label=1, 셀개수=816
   환자ID=COVID19_Participant40, Label=1, 셀개수=381
   환자ID=COVID19_Participant13, Label=1, 셀개수=730
   환자ID=COVID19_Participant20, Label=1, 셀개수=2033
   환자ID=Control_Participant15, Label=0, 셀개수=528
   환자ID=COVID19_Participant28, Label=1, 셀개수=1079
   환자ID=Control_Participant7, Label=0, 셀개수=762
   환자ID=Control_Participant6, Label=0, 셀개수=131
   환자ID=COVID19_Participant15, Label=1, 셀개수=1003
   환자ID=Control_Participant8, Label=0, 셀개수=393
   환자ID=Control_Participant11, Label=0, 셀개수=1164
   환자ID=COVID19_Participant22, Label=1, 셀개수=865
   환자ID=COVID19_Participant30, Label=1, 셀개수=116
   환자ID=COVID19_Participant27, Label=1, 셀개수=93
   환자ID=COVID19_Participant17, Label=1, 셀개수=843
   환자ID=COVID19_Participant6, Label=1, 셀개수=84
   환자ID=COVID19_Participant4, Label=1, 셀개수=1680
   환자ID=COVID19_Participant38, Label=1, 셀개수=51
   환자ID=COVID19_Participant3, Label=1, 셀개수=104
→ valid 환자 ID 및 라벨:
   총 개수: 14
   환자ID=Control_Participant13, Label=0, 셀개수=88
   환자ID=COVID19_Participant29, Label=1, 셀개수=573
   환자ID=COVID19_Participant32, Label=1, 셀개수=1665
   환자ID=COVID19_Participant31, Label=1, 셀개수=410
   환자ID=COVID19_Participant5, Label=1, 셀개수=89
   환자ID=COVID19_Participant21, Label=1, 셀개수=39
   환자ID=Control_Participant3, Label=0, 셀개수=1620
   환자ID=Control_Participant1, Label=0, 셀개수=414
   환자ID=COVID19_Participant9, Label=1, 셀개수=86
   환자ID=COVID19_Participant8, Label=1, 셀개수=462
   환자ID=Control_Participant12, Label=0, 셀개수=99
   환자ID=COVID19_Participant35, Label=1, 셀개수=83
   환자ID=COVID19_Participant12, Label=1, 셀개수=102
   환자ID=COVID19_Participant26, Label=1, 셀개수=814
→ test 환자 ID 및 라벨:
   총 개수: 10
   환자ID=COVID19_Participant11, Label=1, 셀개수=382
   환자ID=COVID19_Participant2, Label=1, 셀개수=329
   환자ID=COVID19_Participant23, Label=1, 셀개수=307
   환자ID=COVID19_Participant25, Label=1, 셀개수=496
   환자ID=COVID19_Participant36, Label=1, 셀개수=200
   환자ID=COVID19_Participant37, Label=1, 셀개수=668
   환자ID=COVID19_Participant7, Label=1, 셀개수=409
   환자ID=Control_Participant2, Label=0, 셀개수=41
   환자ID=Control_Participant5, Label=0, 셀개수=717
   환자ID=Control_Participant9, Label=0, 셀개수=558
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Keratinocytes', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Neurons', 'iPS_cells', 'Embryonic_stem_cells', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
전체 데이터 길이 26947
전체 cell type 길이 0           Keratinocytes
1        Epithelial_cells
2        Epithelial_cells
3        Epithelial_cells
4        Epithelial_cells
               ...       
26942    Epithelial_cells
26943            Monocyte
26944         Gametocytes
26945    Epithelial_cells
26946    Epithelial_cells
Length: 26947, dtype: string
cell type의 NaN 개수 체크 0
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  2%|▏         | 2/100 [00:00<00:09, 10.34it/s]  4%|▍         | 4/100 [00:00<00:10,  8.83it/s]  5%|▌         | 5/100 [00:00<00:10,  9.07it/s]  7%|▋         | 7/100 [00:00<00:09,  9.51it/s]  8%|▊         | 8/100 [00:00<00:09,  9.25it/s]  9%|▉         | 9/100 [00:00<00:10,  8.81it/s] 11%|█         | 11/100 [00:01<00:09,  9.36it/s] 12%|█▏        | 12/100 [00:01<00:11,  7.48it/s] 13%|█▎        | 13/100 [00:01<00:10,  7.96it/s] 14%|█▍        | 14/100 [00:01<00:10,  8.34it/s] 15%|█▌        | 15/100 [00:01<00:09,  8.61it/s] 17%|█▋        | 17/100 [00:01<00:09,  8.40it/s] 18%|█▊        | 18/100 [00:02<00:09,  8.68it/s] 19%|█▉        | 19/100 [00:02<00:09,  8.47it/s] 21%|██        | 21/100 [00:02<00:08,  9.04it/s] 22%|██▏       | 22/100 [00:02<00:08,  8.94it/s] 23%|██▎       | 23/100 [00:02<00:09,  7.86it/s] 25%|██▌       | 25/100 [00:02<00:08,  8.58it/s] 26%|██▌       | 26/100 [00:02<00:08,  8.87it/s] 28%|██▊       | 28/100 [00:03<00:07,  9.22it/s] 30%|███       | 30/100 [00:03<00:07,  9.41it/s] 31%|███       | 31/100 [00:03<00:07,  9.51it/s] 33%|███▎      | 33/100 [00:03<00:07,  9.27it/s] 34%|███▍      | 34/100 [00:03<00:07,  9.26it/s] 35%|███▌      | 35/100 [00:03<00:06,  9.41it/s] 36%|███▌      | 36/100 [00:04<00:06,  9.16it/s] 37%|███▋      | 37/100 [00:04<00:07,  8.70it/s] 38%|███▊      | 38/100 [00:04<00:06,  8.96it/s] 39%|███▉      | 39/100 [00:04<00:07,  8.62it/s] 40%|████      | 40/100 [00:04<00:07,  8.54it/s] 41%|████      | 41/100 [00:04<00:06,  8.79it/s] 42%|████▏     | 42/100 [00:04<00:06,  8.87it/s] 43%|████▎     | 43/100 [00:04<00:06,  9.02it/s] 44%|████▍     | 44/100 [00:04<00:06,  9.09it/s] 45%|████▌     | 45/100 [00:05<00:07,  7.68it/s] 46%|████▌     | 46/100 [00:05<00:06,  7.72it/s] 47%|████▋     | 47/100 [00:05<00:06,  8.24it/s] 48%|████▊     | 48/100 [00:05<00:06,  8.57it/s] 49%|████▉     | 49/100 [00:05<00:05,  8.88it/s] 50%|█████     | 50/100 [00:05<00:05,  8.74it/s] 51%|█████     | 51/100 [00:05<00:05,  8.88it/s] 52%|█████▏    | 52/100 [00:05<00:05,  9.03it/s] 54%|█████▍    | 54/100 [00:06<00:04,  9.46it/s] 55%|█████▌    | 55/100 [00:06<00:04,  9.45it/s] 56%|█████▌    | 56/100 [00:06<00:04,  9.33it/s] 57%|█████▋    | 57/100 [00:06<00:04,  8.78it/s] 58%|█████▊    | 58/100 [00:06<00:05,  8.32it/s] 59%|█████▉    | 59/100 [00:06<00:04,  8.54it/s] 60%|██████    | 60/100 [00:06<00:04,  8.66it/s] 61%|██████    | 61/100 [00:06<00:04,  7.84it/s] 62%|██████▏   | 62/100 [00:07<00:04,  7.71it/s] 63%|██████▎   | 63/100 [00:07<00:04,  8.07it/s] 64%|██████▍   | 64/100 [00:07<00:04,  8.07it/s] 65%|██████▌   | 65/100 [00:07<00:04,  7.80it/s] 66%|██████▌   | 66/100 [00:07<00:04,  8.07it/s] 67%|██████▋   | 67/100 [00:07<00:04,  8.22it/s] 68%|██████▊   | 68/100 [00:07<00:03,  8.01it/s] 69%|██████▉   | 69/100 [00:07<00:03,  8.21it/s] 70%|███████   | 70/100 [00:08<00:03,  8.54it/s] 71%|███████   | 71/100 [00:08<00:03,  8.36it/s] 72%|███████▏  | 72/100 [00:08<00:03,  8.43it/s] 73%|███████▎  | 73/100 [00:08<00:04,  6.55it/s] 74%|███████▍  | 74/100 [00:08<00:03,  7.03it/s] 75%|███████▌  | 75/100 [00:08<00:03,  6.99it/s] 76%|███████▌  | 76/100 [00:08<00:03,  7.30it/s] 77%|███████▋  | 77/100 [00:09<00:03,  7.62it/s] 78%|███████▊  | 78/100 [00:09<00:02,  7.81it/s] 79%|███████▉  | 79/100 [00:09<00:02,  7.92it/s] 80%|████████  | 80/100 [00:09<00:02,  7.94it/s] 81%|████████  | 81/100 [00:09<00:02,  7.39it/s] 83%|████████▎ | 83/100 [00:09<00:02,  8.07it/s] 84%|████████▍ | 84/100 [00:09<00:02,  7.98it/s] 85%|████████▌ | 85/100 [00:10<00:01,  8.05it/s] 86%|████████▌ | 86/100 [00:10<00:01,  8.05it/s] 87%|████████▋ | 87/100 [00:10<00:01,  7.84it/s] 88%|████████▊ | 88/100 [00:10<00:01,  7.62it/s] 89%|████████▉ | 89/100 [00:10<00:01,  7.27it/s] 90%|█████████ | 90/100 [00:10<00:01,  7.20it/s] 91%|█████████ | 91/100 [00:10<00:01,  6.83it/s] 92%|█████████▏| 92/100 [00:11<00:01,  7.05it/s] 93%|█████████▎| 93/100 [00:11<00:01,  6.92it/s] 94%|█████████▍| 94/100 [00:11<00:00,  6.80it/s] 95%|█████████▌| 95/100 [00:11<00:00,  6.81it/s] 96%|█████████▌| 96/100 [00:11<00:00,  6.51it/s] 97%|█████████▋| 97/100 [00:11<00:00,  7.14it/s] 98%|█████████▊| 98/100 [00:11<00:00,  7.49it/s] 99%|█████████▉| 99/100 [00:11<00:00,  7.71it/s]100%|██████████| 100/100 [00:12<00:00,  8.08it/s]100%|██████████| 100/100 [00:12<00:00,  8.26it/s]
[I 2025-08-31 16:09:13,581] A new study created in memory with name: no-name-d7424c1d-3ca5-4c2f-a69f-4bb188d9a178
👉 train samples(학습 샘플(bag))=126, batch_size=16 -> steps(샘플수/batch크기)=8
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 25.64 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.655572, Valid_loss 0.606928
Epoch 2, Train Loss 0.595084, Valid_loss 0.617248
Epoch 3, Train Loss 0.570213, Valid_loss 0.587860
Epoch 4, Train Loss 0.534320, Valid_loss 0.584420
Epoch 5, Train Loss 0.516912, Valid_loss 0.578548
Epoch 6, Train Loss 0.545886, Valid_loss 0.564403
Epoch 7, Train Loss 0.507194, Valid_loss 0.592853
Epoch 8, Train Loss 0.496979, Valid_loss 0.571066
Epoch 9, Train Loss 0.484148, Valid_loss 0.597722
Epoch 10, Train Loss 0.502421, Valid_loss 0.558626
Epoch 11, Train Loss 0.496984, Valid_loss 0.594801
Epoch 12, Train Loss 0.455867, Valid_loss 0.556605
Epoch 13, Train Loss 0.469483, Valid_loss 0.572694
Epoch 14, Train Loss 0.459551, Valid_loss 0.572969
Epoch 15, Train Loss 0.473860, Valid_loss 0.589481
Epoch 16, Train Loss 0.467385, Valid_loss 0.627747
Epoch 17, Train Loss 0.478733, Valid_loss 0.577850
Epoch 18, Train Loss 0.447502, Valid_loss 0.623350
Epoch 19, Train Loss 0.458412, Valid_loss 0.514743
Epoch 20, Train Loss 0.437999, Valid_loss 0.623923
Epoch 21, Train Loss 0.480169, Valid_loss 0.509405
Epoch 22, Train Loss 0.459020, Valid_loss 0.562640
Epoch 23, Train Loss 0.424345, Valid_loss 0.571568
Epoch 24, Train Loss 0.419252, Valid_loss 0.583142
Epoch 25, Train Loss 0.453674, Valid_loss 0.578875
Epoch 26, Train Loss 0.449223, Valid_loss 0.635378
Epoch 27, Train Loss 0.379014, Valid_loss 0.492373
Epoch 28, Train Loss 0.449401, Valid_loss 0.609067
Epoch 29, Train Loss 0.430746, Valid_loss 0.521724
Epoch 30, Train Loss 0.444384, Valid_loss 0.529833
Epoch 31, Train Loss 0.435645, Valid_loss 0.500278
Epoch 32, Train Loss 0.428881, Valid_loss 0.516966
Epoch 33, Train Loss 0.422284, Valid_loss 0.545021
Epoch 34, Train Loss 0.408652, Valid_loss 0.502220
Epoch 35, Train Loss 0.397951, Valid_loss 0.607723
Epoch 36, Train Loss 0.454546, Valid_loss 0.508213
Epoch 37, Train Loss 0.403009, Valid_loss 0.591973
Epoch 38, Train Loss 0.424679, Valid_loss 0.520667
Epoch 39, Train Loss 0.433508, Valid_loss 0.551257
Epoch 40, Train Loss 0.406642, Valid_loss 0.495089
Epoch 41, Train Loss 0.414044, Valid_loss 0.496512
Epoch 42, Train Loss 0.409341, Valid_loss 0.538456
Epoch 43, Train Loss 0.416314, Valid_loss 0.538558
Epoch 44, Train Loss 0.372602, Valid_loss 0.633235
Epoch 45, Train Loss 0.408824, Valid_loss 0.515480
Epoch 46, Train Loss 0.396991, Valid_loss 0.738365
Epoch 47, Train Loss 0.444370, Valid_loss 0.479938
Epoch 48, Train Loss 0.378101, Valid_loss 0.610471
Epoch 49, Train Loss 0.393893, Valid_loss 0.565502
Epoch 50, Train Loss 0.378399, Valid_loss 0.500600
Epoch 51, Train Loss 0.422352, Valid_loss 0.556164
Epoch 52, Train Loss 0.413198, Valid_loss 0.644521
[I 2025-08-31 16:12:42,372] Trial 0 finished with value: 0.47993828090173857 and parameters: {'learning_rate': 0.001, 'epochs': 100, 'heads': 2, 'dropout': 0.5, 'weight_decay': 0.01, 'emb_dim': 8, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.47993828090173857.
👉 train samples(학습 샘플(bag))=126, batch_size=16 -> steps(샘플수/batch크기)=8
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 26.96 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.655795, Valid_loss 0.609303
Epoch 2, Train Loss 0.643380, Valid_loss 0.599551
Epoch 3, Train Loss 0.626777, Valid_loss 0.590768
Epoch 4, Train Loss 0.607857, Valid_loss 0.580863
Epoch 5, Train Loss 0.587792, Valid_loss 0.576905
Epoch 6, Train Loss 0.543818, Valid_loss 0.562816
Epoch 7, Train Loss 0.543888, Valid_loss 0.564776
Epoch 8, Train Loss 0.502607, Valid_loss 0.577563
Epoch 9, Train Loss 0.480308, Valid_loss 0.561532
Epoch 10, Train Loss 0.477293, Valid_loss 0.560001
Epoch 11, Train Loss 0.428336, Valid_loss 0.533301
Epoch 12, Train Loss 0.416686, Valid_loss 0.560107
Epoch 13, Train Loss 0.438433, Valid_loss 0.533824
Epoch 14, Train Loss 0.430777, Valid_loss 0.601063
Epoch 15, Train Loss 0.377703, Valid_loss 0.544030
Epoch 16, Train Loss 0.393132, Valid_loss 0.564914
Epoch 17, Train Loss 0.395633, Valid_loss 0.587202
Epoch 18, Train Loss 0.378558, Valid_loss 0.575951
Epoch 19, Train Loss 0.364817, Valid_loss 0.549491
Epoch 20, Train Loss 0.363793, Valid_loss 0.581110
Epoch 21, Train Loss 0.361569, Valid_loss 0.593584
Epoch 22, Train Loss 0.362455, Valid_loss 0.590304
Epoch 23, Train Loss 0.350146, Valid_loss 0.569193
Epoch 24, Train Loss 0.357854, Valid_loss 0.605620
Epoch 25, Train Loss 0.345819, Valid_loss 0.558090
Epoch 26, Train Loss 0.356209, Valid_loss 0.555984
Epoch 27, Train Loss 0.350017, Valid_loss 0.584346
Epoch 28, Train Loss 0.369685, Valid_loss 0.558267
Epoch 29, Train Loss 0.329102, Valid_loss 0.579179
Epoch 30, Train Loss 0.349475, Valid_loss 0.520115
Epoch 31, Train Loss 0.361772, Valid_loss 0.564856
Epoch 32, Train Loss 0.342018, Valid_loss 0.551342
Epoch 33, Train Loss 0.356242, Valid_loss 0.603788
Epoch 34, Train Loss 0.346072, Valid_loss 0.496815
Epoch 35, Train Loss 0.355925, Valid_loss 0.551964
Epoch 36, Train Loss 0.336237, Valid_loss 0.555733
Epoch 37, Train Loss 0.328302, Valid_loss 0.570661
Epoch 38, Train Loss 0.345556, Valid_loss 0.580978
Epoch 39, Train Loss 0.343665, Valid_loss 0.543852
Epoch 40, Train Loss 0.339755, Valid_loss 0.531780
Epoch 41, Train Loss 0.321695, Valid_loss 0.583707
Epoch 42, Train Loss 0.339796, Valid_loss 0.554861
Epoch 43, Train Loss 0.328531, Valid_loss 0.518362
Epoch 44, Train Loss 0.336286, Valid_loss 0.593059
Epoch 45, Train Loss 0.347677, Valid_loss 0.538461
Epoch 46, Train Loss 0.311844, Valid_loss 0.514353
Epoch 47, Train Loss 0.337040, Valid_loss 0.573397
Epoch 48, Train Loss 0.332890, Valid_loss 0.592817
Epoch 49, Train Loss 0.334308, Valid_loss 0.559126
Epoch 50, Train Loss 0.320779, Valid_loss 0.526701
Epoch 51, Train Loss 0.317009, Valid_loss 0.544690
Epoch 52, Train Loss 0.323810, Valid_loss 0.547215
[I 2025-08-31 16:17:39,667] Trial 1 finished with value: 0.4968147597142628 and parameters: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 4, 'dropout': 0.5, 'weight_decay': 0.0001, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.47993828090173857.
👉 train samples(학습 샘플(bag))=126, batch_size=16 -> steps(샘플수/batch크기)=8
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 26.96 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.636560, Valid_loss 0.616210
Epoch 2, Train Loss 0.555818, Valid_loss 0.825339
Epoch 3, Train Loss 0.436092, Valid_loss 0.495221
Epoch 4, Train Loss 0.372200, Valid_loss 0.848993
Epoch 5, Train Loss 0.363823, Valid_loss 0.784661
Epoch 6, Train Loss 0.311075, Valid_loss 0.820753
Epoch 7, Train Loss 0.295084, Valid_loss 0.659918
Epoch 8, Train Loss 0.285927, Valid_loss 0.653605
Epoch 9, Train Loss 0.266448, Valid_loss 0.710955
Epoch 10, Train Loss 0.245326, Valid_loss 0.587373
Epoch 11, Train Loss 0.233953, Valid_loss 0.575208
Epoch 12, Train Loss 0.232919, Valid_loss 0.561662
Epoch 13, Train Loss 0.231426, Valid_loss 0.942331
Epoch 14, Train Loss 0.263625, Valid_loss 0.406324
Epoch 15, Train Loss 0.247124, Valid_loss 0.458744
Epoch 16, Train Loss 0.265605, Valid_loss 0.904621
Epoch 17, Train Loss 0.242212, Valid_loss 0.626293
Epoch 18, Train Loss 0.231306, Valid_loss 0.628699
Epoch 19, Train Loss 0.226181, Valid_loss 0.509807
Epoch 20, Train Loss 0.229575, Valid_loss 0.606539
Epoch 21, Train Loss 0.235632, Valid_loss 0.746949
Epoch 22, Train Loss 0.224791, Valid_loss 0.734899
Epoch 23, Train Loss 0.232161, Valid_loss 0.486558
Epoch 24, Train Loss 0.220245, Valid_loss 0.449025
Epoch 25, Train Loss 0.247108, Valid_loss 0.573400
Epoch 26, Train Loss 0.240156, Valid_loss 1.001081
Epoch 27, Train Loss 0.209457, Valid_loss 0.544083
Epoch 28, Train Loss 0.218519, Valid_loss 0.526715
Epoch 29, Train Loss 0.211569, Valid_loss 0.631869
Epoch 30, Train Loss 0.205423, Valid_loss 0.552953
Epoch 31, Train Loss 0.210538, Valid_loss 0.384172
Epoch 32, Train Loss 0.231962, Valid_loss 0.404485
Epoch 33, Train Loss 0.233028, Valid_loss 0.706612
Epoch 34, Train Loss 0.208349, Valid_loss 0.620833
Epoch 35, Train Loss 0.220768, Valid_loss 0.619485
Epoch 36, Train Loss 0.218675, Valid_loss 0.799328
Epoch 37, Train Loss 0.296702, Valid_loss 0.455546
Epoch 38, Train Loss 0.265232, Valid_loss 0.431498
Epoch 39, Train Loss 0.240955, Valid_loss 0.777520
Epoch 40, Train Loss 0.212961, Valid_loss 0.590794
Epoch 41, Train Loss 0.206553, Valid_loss 0.595470
Epoch 42, Train Loss 0.201761, Valid_loss 0.626424
Epoch 43, Train Loss 0.195493, Valid_loss 0.474743
Epoch 44, Train Loss 0.201824, Valid_loss 0.498316
Epoch 45, Train Loss 0.196840, Valid_loss 0.581209
Epoch 46, Train Loss 0.204729, Valid_loss 0.691330
Epoch 47, Train Loss 0.205442, Valid_loss 0.930233
Epoch 48, Train Loss 0.227844, Valid_loss 0.530726
Epoch 49, Train Loss 0.217294, Valid_loss 0.532949
Epoch 50, Train Loss 0.218225, Valid_loss 0.676481
Epoch 51, Train Loss 0.220415, Valid_loss 0.514192
Epoch 52, Train Loss 0.201735, Valid_loss 0.545079
Epoch 53, Train Loss 0.201427, Valid_loss 0.534425
Epoch 54, Train Loss 0.191847, Valid_loss 0.531244
Epoch 55, Train Loss 0.194668, Valid_loss 0.501155
Epoch 56, Train Loss 0.193093, Valid_loss 0.481430
Epoch 57, Train Loss 0.189364, Valid_loss 0.518011
Epoch 58, Train Loss 0.187525, Valid_loss 0.463676
Epoch 59, Train Loss 0.196858, Valid_loss 0.492735
Epoch 60, Train Loss 0.195888, Valid_loss 0.525866
[I 2025-08-31 16:23:22,668] Trial 2 finished with value: 0.3841715364583901 and parameters: {'learning_rate': 0.01, 'epochs': 100, 'heads': 4, 'dropout': 0.3, 'weight_decay': 0.001, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 2 with value: 0.3841715364583901.
선택된 trial params: {'learning_rate': 0.01, 'epochs': 100, 'heads': 4, 'dropout': 0.3, 'weight_decay': 0.001, 'emb_dim': 32, 'augment_num': 100, 'pca': False}
👉 train samples(학습 샘플(bag))=126, batch_size=16 -> steps(샘플수/batch크기)=8
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=10, batch_size=1 -> steps=10
output_class :  1
Memory Allocated: 26.96 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.732360, Valid_loss 0.623824
Epoch 2, Train Loss 0.644509, Valid_loss 0.614306
Epoch 3, Train Loss 0.668266, Valid_loss 0.597926
Epoch 4, Train Loss 0.640505, Valid_loss 0.617565
Epoch 5, Train Loss 0.639320, Valid_loss 0.604006
Epoch 6, Train Loss 0.617468, Valid_loss 0.574775
Epoch 7, Train Loss 0.595803, Valid_loss 0.603016
Epoch 8, Train Loss 0.579878, Valid_loss 0.718541
Epoch 9, Train Loss 0.424661, Valid_loss 0.810288
Epoch 10, Train Loss 0.344088, Valid_loss 0.864747
Epoch 11, Train Loss 0.295917, Valid_loss 0.949385
Epoch 12, Train Loss 0.315754, Valid_loss 0.901618
Epoch 13, Train Loss 0.285210, Valid_loss 0.607626
Epoch 14, Train Loss 0.286982, Valid_loss 0.642382
Epoch 15, Train Loss 0.265107, Valid_loss 0.531179
Epoch 16, Train Loss 0.243027, Valid_loss 0.492251
Epoch 17, Train Loss 0.243927, Valid_loss 0.530643
Epoch 18, Train Loss 0.238764, Valid_loss 0.571778
Epoch 19, Train Loss 0.239354, Valid_loss 0.673072
Epoch 20, Train Loss 0.267083, Valid_loss 0.684946
Epoch 21, Train Loss 0.239521, Valid_loss 0.551131
Epoch 22, Train Loss 0.232360, Valid_loss 0.602700
Epoch 23, Train Loss 0.233633, Valid_loss 0.573093
Epoch 24, Train Loss 0.220476, Valid_loss 0.600676
Epoch 25, Train Loss 0.229083, Valid_loss 0.621372
Epoch 26, Train Loss 0.215793, Valid_loss 0.554039
Epoch 27, Train Loss 0.208215, Valid_loss 0.531360
Epoch 28, Train Loss 0.212133, Valid_loss 0.663465
Epoch 29, Train Loss 0.221965, Valid_loss 0.536708
Epoch 30, Train Loss 0.211815, Valid_loss 0.507268
Epoch 31, Train Loss 0.198203, Valid_loss 0.629708
Epoch 32, Train Loss 0.205203, Valid_loss 0.529669
Epoch 33, Train Loss 0.204543, Valid_loss 0.468785
Epoch 34, Train Loss 0.237325, Valid_loss 0.480867
Epoch 35, Train Loss 0.220713, Valid_loss 0.521487
Epoch 36, Train Loss 0.232352, Valid_loss 0.722864
Epoch 37, Train Loss 0.216418, Valid_loss 0.434927
Epoch 38, Train Loss 0.221385, Valid_loss 0.590860
Epoch 39, Train Loss 0.211047, Valid_loss 0.444019
Epoch 40, Train Loss 0.230189, Valid_loss 0.713746
Epoch 41, Train Loss 0.215111, Valid_loss 0.616292
Epoch 42, Train Loss 0.214759, Valid_loss 0.542435
Epoch 43, Train Loss 0.205511, Valid_loss 0.731350
Epoch 44, Train Loss 0.221288, Valid_loss 0.483902
Epoch 45, Train Loss 0.214908, Valid_loss 0.753792
Epoch 46, Train Loss 0.210636, Valid_loss 0.579947
Epoch 47, Train Loss 0.203444, Valid_loss 0.535488
Epoch 48, Train Loss 0.204927, Valid_loss 0.656817
Epoch 49, Train Loss 0.204368, Valid_loss 0.527918
Epoch 50, Train Loss 0.202789, Valid_loss 0.639244
Epoch 51, Train Loss 0.199862, Valid_loss 0.567088
Epoch 52, Train Loss 0.199110, Valid_loss 0.589635
Epoch 53, Train Loss 0.190215, Valid_loss 0.610598
환자ID=COVID19_Participant11 -- true: 1 -- pred: 1
환자ID=COVID19_Participant2 -- true: 1 -- pred: 1
환자ID=COVID19_Participant23 -- true: 1 -- pred: 1
환자ID=COVID19_Participant25 -- true: 1 -- pred: 1
환자ID=COVID19_Participant36 -- true: 1 -- pred: 1
환자ID=COVID19_Participant37 -- true: 1 -- pred: 1
환자ID=COVID19_Participant7 -- true: 1 -- pred: 1
환자ID=Control_Participant2 -- true: 0 -- pred: 0
환자ID=Control_Participant5 -- true: 0 -- pred: 1
환자ID=Control_Participant9 -- true: 0 -- pred: 0
Best performance: Epoch 37, Loss 0.216418, Test ACC 0.900000, Test AUC 1.000000, Test Recall 1.000000, Test Precision 0.875000
Confusion Matrix:
 [2 1 0 7]
✅ Total valid splits used: 1
🔁 Repeat 1, Fold 1
cell type :  CATTAAGGATAT_COVID19_Participant13    Epithelial_cells
GTAGAAGGGGGG_COVID19_Participant13           Platelets
ATTAAGAGGTAG_COVID19_Participant13    Epithelial_cells
AGATATGACAAG_COVID19_Participant13    Epithelial_cells
CTTGTAACAAAT_COVID19_Participant13    Epithelial_cells
                                            ...       
GCAGGGAACTCC_COVID19_Participant30    Epithelial_cells
CAGCACCGAGCC_COVID19_Participant30    Epithelial_cells
GCCCCTTGTGAT_COVID19_Participant30    Epithelial_cells
GTGTTGTGTGTC_COVID19_Participant30              B_cell
TAACACTCACTT_COVID19_Participant30           Myelocyte
Name: singler_annotation, Length: 20379, dtype: string
cell type annotation :  CATTAAGGATAT_COVID19_Participant13    Epithelial_cells
GTAGAAGGGGGG_COVID19_Participant13           Platelets
ATTAAGAGGTAG_COVID19_Participant13    Epithelial_cells
AGATATGACAAG_COVID19_Participant13    Epithelial_cells
CTTGTAACAAAT_COVID19_Participant13    Epithelial_cells
                                            ...       
GCAGGGAACTCC_COVID19_Participant30    Epithelial_cells
CAGCACCGAGCC_COVID19_Participant30    Epithelial_cells
GCCCCTTGTGAT_COVID19_Participant30    Epithelial_cells
GTGTTGTGTGTC_COVID19_Participant30              B_cell
TAACACTCACTT_COVID19_Participant30           Myelocyte
Name: singler_annotation, Length: 20379, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Epithelial_cells', 'Platelets', 'Keratinocytes', 'Macrophage', 'B_cell', 'Neutrophils', 'DC', 'Monocyte', 'T_cells', 'NK_cell', 'HSC_CD34+', 'Tissue_stem_cells', 'Embryonic_stem_cells', 'HSC_-G-CSF', 'Neurons', 'BM', 'Erythroblast', 'Fibroblasts', 'iPS_cells', 'Hepatocytes', 'CMP', 'Gametocytes', 'Chondrocytes', 'Endothelial_cells', 'Pre-B_cell_CD34-', 'Myelocyte', 'Astrocyte', 'Neuroepithelial_cell', 'Smooth_muscle_cells', 'GMP', 'MSC', 'Osteoblasts', 'MEP', 'BM & Prog.', 'Pro-B_cell_CD34+', 'Pro-Myelocyte', 'Unknown']
라벨별 그룹 개수 {1: 28, 0: 12}
cell type :  GTCGGGGGGTGG_Control_Participant7           Keratinocytes
CAAATCAATTAT_Control_Participant7        Epithelial_cells
ATACAATTGACA_Control_Participant7        Epithelial_cells
CTGTTAATGAGA_Control_Participant7        Epithelial_cells
CTTCACATTATT_Control_Participant7        Epithelial_cells
                                             ...         
GCGCCCGTGTTA_COVID19_Participant27       Epithelial_cells
TTGATCCGTGGC_COVID19_Participant27                T_cells
CGCGACTACTCT_COVID19_Participant27       Epithelial_cells
AAACGCTTGTTA_COVID19_Participant27       Epithelial_cells
CATTGGGGGAAA_COVID19_Participant27    Smooth_muscle_cells
Name: singler_annotation, Length: 6568, dtype: string
cell type annotation :  GTCGGGGGGTGG_Control_Participant7           Keratinocytes
CAAATCAATTAT_Control_Participant7        Epithelial_cells
ATACAATTGACA_Control_Participant7        Epithelial_cells
CTGTTAATGAGA_Control_Participant7        Epithelial_cells
CTTCACATTATT_Control_Participant7        Epithelial_cells
                                             ...         
GCGCCCGTGTTA_COVID19_Participant27       Epithelial_cells
TTGATCCGTGGC_COVID19_Participant27                T_cells
CGCGACTACTCT_COVID19_Participant27       Epithelial_cells
AAACGCTTGTTA_COVID19_Participant27       Epithelial_cells
CATTGGGGGAAA_COVID19_Participant27    Smooth_muscle_cells
Name: singler_annotation, Length: 6568, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Keratinocytes', 'Epithelial_cells', 'Neurons', 'iPS_cells', 'Embryonic_stem_cells', 'Astrocyte', 'DC', 'Gametocytes', 'HSC_-G-CSF', 'Smooth_muscle_cells', 'BM & Prog.', 'Monocyte', 'Myelocyte', 'BM', 'Endothelial_cells', 'Osteoblasts', 'Platelets', 'Erythroblast', 'NK_cell', 'T_cells', 'Chondrocytes', 'HSC_CD34+', 'CMP', 'Neutrophils', 'Fibroblasts', 'MEP', 'Neuroepithelial_cell', 'MSC', 'Pro-Myelocyte', 'B_cell', 'GMP', 'Hepatocytes', 'Macrophage', 'Pre-B_cell_CD34-', 'Unknown', 'Pro-B_cell_CD34+', 'Tissue_stem_cells']
라벨별 그룹 개수 {1: 7, 0: 3}
🔍 Split #2
  → train_p_index 환자 수 (환자 단위로 묶인 index list): 40
  → test_p_index 환자 수  (환자 단위로 묶인 index list): 10
  → train 환자 ID: ['COVID19_Participant10', 'COVID19_Participant11', 'COVID19_Participant12', 'COVID19_Participant13', 'COVID19_Participant14', 'COVID19_Participant15', 'COVID19_Participant18', 'COVID19_Participant2', 'COVID19_Participant20', 'COVID19_Participant21', 'COVID19_Participant23', 'COVID19_Participant25', 'COVID19_Participant28', 'COVID19_Participant3', 'COVID19_Participant30', 'COVID19_Participant31', 'COVID19_Participant32', 'COVID19_Participant35', 'COVID19_Participant36', 'COVID19_Participant37', 'COVID19_Participant39', 'COVID19_Participant4', 'COVID19_Participant40', 'COVID19_Participant5', 'COVID19_Participant6', 'COVID19_Participant7', 'COVID19_Participant8', 'COVID19_Participant9', 'Control_Participant1', 'Control_Participant10', 'Control_Participant11', 'Control_Participant12', 'Control_Participant13', 'Control_Participant14', 'Control_Participant15', 'Control_Participant2', 'Control_Participant4', 'Control_Participant5', 'Control_Participant8', 'Control_Participant9']
  → test  환자 ID: ['COVID19_Participant17', 'COVID19_Participant19', 'COVID19_Participant22', 'COVID19_Participant26', 'COVID19_Participant27', 'COVID19_Participant29', 'COVID19_Participant38', 'Control_Participant3', 'Control_Participant6', 'Control_Participant7']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant10, Label: 1
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant12, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant18, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant21, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant3, Label: 1
    ID: COVID19_Participant30, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant35, Label: 1
    ID: COVID19_Participant36, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: COVID19_Participant5, Label: 1
    ID: COVID19_Participant6, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: COVID19_Participant9, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant10, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant12, Label: 0
    ID: Control_Participant13, Label: 0
    ID: Control_Participant14, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant2, Label: 0
    ID: Control_Participant4, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant8, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant27, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant38, Label: 1
    ID: Control_Participant3, Label: 0
    ID: Control_Participant6, Label: 0
    ID: Control_Participant7, Label: 0
전체 데이터 index 길이 50
label_stat (train 환자 라벨 목록) 갯수 40
train_data에서 환자 단위로, train과 validation 나누기
기존 train_p_index 40
기존 (train) label_stat 40
train-vali 분할 후! 
train y 의 classes : {0, 1} valid y 의 classes : {0, 1} label_stat 의 classes : {0, 1}
train_p_index_ 26
valid_p_index 14
test_p_index 10
→ train 환자 ID 및 라벨:
   총 개수: 26
   환자ID=Control_Participant10, Label=0, 셀개수=1645
   환자ID=Control_Participant14, Label=0, 셀개수=274
   환자ID=COVID19_Participant18, Label=1, 셀개수=227
   환자ID=COVID19_Participant4, Label=1, 셀개수=1680
   환자ID=COVID19_Participant10, Label=1, 셀개수=18
   환자ID=Control_Participant4, Label=0, 셀개수=440
   환자ID=COVID19_Participant13, Label=1, 셀개수=730
   환자ID=COVID19_Participant2, Label=1, 셀개수=329
   환자ID=COVID19_Participant5, Label=1, 셀개수=89
   환자ID=COVID19_Participant12, Label=1, 셀개수=102
   환자ID=COVID19_Participant20, Label=1, 셀개수=2033
   환자ID=Control_Participant15, Label=0, 셀개수=528
   환자ID=COVID19_Participant3, Label=1, 셀개수=104
   환자ID=Control_Participant8, Label=0, 셀개수=393
   환자ID=Control_Participant5, Label=0, 셀개수=717
   환자ID=COVID19_Participant14, Label=1, 셀개수=382
   환자ID=Control_Participant9, Label=0, 셀개수=558
   환자ID=Control_Participant11, Label=0, 셀개수=1164
   환자ID=COVID19_Participant23, Label=1, 셀개수=307
   환자ID=COVID19_Participant32, Label=1, 셀개수=1665
   환자ID=COVID19_Participant28, Label=1, 셀개수=1079
   환자ID=COVID19_Participant15, Label=1, 셀개수=1003
   환자ID=COVID19_Participant7, Label=1, 셀개수=409
   환자ID=COVID19_Participant40, Label=1, 셀개수=381
   환자ID=COVID19_Participant39, Label=1, 셀개수=454
   환자ID=COVID19_Participant31, Label=1, 셀개수=410
→ valid 환자 ID 및 라벨:
   총 개수: 14
   환자ID=Control_Participant13, Label=0, 셀개수=88
   환자ID=COVID19_Participant30, Label=1, 셀개수=116
   환자ID=COVID19_Participant36, Label=1, 셀개수=200
   환자ID=COVID19_Participant35, Label=1, 셀개수=83
   환자ID=COVID19_Participant6, Label=1, 셀개수=84
   환자ID=COVID19_Participant21, Label=1, 셀개수=39
   환자ID=Control_Participant2, Label=0, 셀개수=41
   환자ID=Control_Participant1, Label=0, 셀개수=414
   환자ID=COVID19_Participant9, Label=1, 셀개수=86
   환자ID=COVID19_Participant8, Label=1, 셀개수=462
   환자ID=Control_Participant12, Label=0, 셀개수=99
   환자ID=COVID19_Participant37, Label=1, 셀개수=668
   환자ID=COVID19_Participant11, Label=1, 셀개수=382
   환자ID=COVID19_Participant25, Label=1, 셀개수=496
→ test 환자 ID 및 라벨:
   총 개수: 10
   환자ID=COVID19_Participant17, Label=1, 셀개수=843
   환자ID=COVID19_Participant19, Label=1, 셀개수=816
   환자ID=COVID19_Participant22, Label=1, 셀개수=865
   환자ID=COVID19_Participant26, Label=1, 셀개수=814
   환자ID=COVID19_Participant27, Label=1, 셀개수=93
   환자ID=COVID19_Participant29, Label=1, 셀개수=573
   환자ID=COVID19_Participant38, Label=1, 셀개수=51
   환자ID=Control_Participant3, Label=0, 셀개수=1620
   환자ID=Control_Participant6, Label=0, 셀개수=131
   환자ID=Control_Participant7, Label=0, 셀개수=762
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Epithelial_cells', 'Platelets', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Keratinocytes', 'Macrophage', 'Epithelial_cells', 'B_cell', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
전체 데이터 길이 26947
전체 cell type 길이 0           Epithelial_cells
1                  Platelets
2           Epithelial_cells
3           Epithelial_cells
4           Epithelial_cells
                ...         
26942       Epithelial_cells
26943                T_cells
26944       Epithelial_cells
26945       Epithelial_cells
26946    Smooth_muscle_cells
Length: 26947, dtype: string
cell type의 NaN 개수 체크 0
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:12,  7.87it/s]  2%|▏         | 2/100 [00:00<00:11,  8.67it/s]  3%|▎         | 3/100 [00:00<00:11,  8.54it/s]  5%|▌         | 5/100 [00:00<00:10,  9.35it/s]  7%|▋         | 7/100 [00:00<00:09,  9.70it/s]  9%|▉         | 9/100 [00:00<00:09,  9.51it/s] 11%|█         | 11/100 [00:01<00:09,  9.79it/s] 12%|█▏        | 12/100 [00:01<00:08,  9.83it/s] 13%|█▎        | 13/100 [00:01<00:08,  9.85it/s] 14%|█▍        | 14/100 [00:01<00:08,  9.59it/s] 16%|█▌        | 16/100 [00:01<00:08,  9.76it/s] 17%|█▋        | 17/100 [00:01<00:08,  9.72it/s] 19%|█▉        | 19/100 [00:01<00:08, 10.03it/s] 21%|██        | 21/100 [00:02<00:08,  9.60it/s] 23%|██▎       | 23/100 [00:02<00:07,  9.64it/s] 24%|██▍       | 24/100 [00:02<00:07,  9.68it/s] 25%|██▌       | 25/100 [00:02<00:07,  9.72it/s] 27%|██▋       | 27/100 [00:02<00:07, 10.21it/s] 29%|██▉       | 29/100 [00:02<00:07,  9.98it/s] 30%|███       | 30/100 [00:03<00:07,  9.88it/s] 32%|███▏      | 32/100 [00:03<00:06, 10.14it/s] 34%|███▍      | 34/100 [00:03<00:06, 10.15it/s] 36%|███▌      | 36/100 [00:03<00:06,  9.83it/s] 38%|███▊      | 38/100 [00:03<00:06, 10.02it/s] 40%|████      | 40/100 [00:04<00:06,  9.62it/s] 41%|████      | 41/100 [00:04<00:06,  9.48it/s] 42%|████▏     | 42/100 [00:04<00:06,  9.54it/s] 43%|████▎     | 43/100 [00:04<00:05,  9.58it/s] 45%|████▌     | 45/100 [00:04<00:05,  9.67it/s] 46%|████▌     | 46/100 [00:04<00:05,  9.57it/s] 47%|████▋     | 47/100 [00:04<00:06,  8.76it/s] 48%|████▊     | 48/100 [00:04<00:05,  8.96it/s] 49%|████▉     | 49/100 [00:05<00:06,  8.44it/s] 51%|█████     | 51/100 [00:05<00:05,  8.89it/s] 52%|█████▏    | 52/100 [00:05<00:05,  8.90it/s] 53%|█████▎    | 53/100 [00:05<00:05,  9.02it/s] 54%|█████▍    | 54/100 [00:05<00:05,  8.62it/s] 55%|█████▌    | 55/100 [00:05<00:05,  7.51it/s] 56%|█████▌    | 56/100 [00:05<00:05,  7.92it/s] 57%|█████▋    | 57/100 [00:06<00:05,  8.39it/s] 58%|█████▊    | 58/100 [00:06<00:04,  8.65it/s] 59%|█████▉    | 59/100 [00:06<00:04,  8.81it/s] 60%|██████    | 60/100 [00:06<00:04,  9.05it/s] 61%|██████    | 61/100 [00:06<00:04,  9.21it/s] 62%|██████▏   | 62/100 [00:06<00:04,  9.34it/s] 63%|██████▎   | 63/100 [00:06<00:03,  9.33it/s] 64%|██████▍   | 64/100 [00:06<00:03,  9.31it/s] 65%|██████▌   | 65/100 [00:06<00:03,  9.30it/s] 66%|██████▌   | 66/100 [00:07<00:03,  9.44it/s] 67%|██████▋   | 67/100 [00:07<00:03,  9.44it/s] 68%|██████▊   | 68/100 [00:07<00:03,  9.24it/s] 69%|██████▉   | 69/100 [00:07<00:03,  9.32it/s] 70%|███████   | 70/100 [00:07<00:03,  9.11it/s] 71%|███████   | 71/100 [00:07<00:03,  9.27it/s] 72%|███████▏  | 72/100 [00:07<00:03,  9.33it/s] 73%|███████▎  | 73/100 [00:07<00:02,  9.26it/s] 74%|███████▍  | 74/100 [00:07<00:02,  9.41it/s] 75%|███████▌  | 75/100 [00:07<00:02,  9.36it/s] 76%|███████▌  | 76/100 [00:08<00:02,  9.20it/s] 77%|███████▋  | 77/100 [00:08<00:02,  9.24it/s] 78%|███████▊  | 78/100 [00:08<00:02,  9.26it/s] 79%|███████▉  | 79/100 [00:08<00:02,  9.12it/s] 80%|████████  | 80/100 [00:08<00:02,  9.04it/s] 81%|████████  | 81/100 [00:08<00:02,  8.92it/s] 82%|████████▏ | 82/100 [00:08<00:02,  8.88it/s] 84%|████████▍ | 84/100 [00:08<00:01,  9.34it/s] 85%|████████▌ | 85/100 [00:09<00:01,  9.29it/s] 86%|████████▌ | 86/100 [00:09<00:01,  9.38it/s] 87%|████████▋ | 87/100 [00:09<00:01,  9.46it/s] 88%|████████▊ | 88/100 [00:09<00:01,  9.19it/s] 89%|████████▉ | 89/100 [00:09<00:01,  8.63it/s] 90%|█████████ | 90/100 [00:09<00:01,  8.71it/s] 91%|█████████ | 91/100 [00:09<00:01,  8.73it/s] 92%|█████████▏| 92/100 [00:09<00:00,  8.83it/s] 93%|█████████▎| 93/100 [00:10<00:00,  8.49it/s] 94%|█████████▍| 94/100 [00:10<00:00,  8.69it/s] 95%|█████████▌| 95/100 [00:10<00:00,  8.54it/s] 96%|█████████▌| 96/100 [00:10<00:00,  8.63it/s] 97%|█████████▋| 97/100 [00:10<00:00,  8.53it/s] 98%|█████████▊| 98/100 [00:10<00:00,  8.39it/s] 99%|█████████▉| 99/100 [00:10<00:00,  8.36it/s]100%|██████████| 100/100 [00:10<00:00,  8.47it/s]100%|██████████| 100/100 [00:10<00:00,  9.23it/s]
[I 2025-08-31 16:28:37,937] A new study created in memory with name: no-name-0c5c45c8-c321-44e3-807c-12acd4acc19b
👉 train samples(학습 샘플(bag))=126, batch_size=16 -> steps(샘플수/batch크기)=8
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 25.64 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.729636, Valid_loss 0.718687
Epoch 2, Train Loss 0.702905, Valid_loss 0.705376
Epoch 3, Train Loss 0.696463, Valid_loss 0.695026
Epoch 4, Train Loss 0.686458, Valid_loss 0.688998
Epoch 5, Train Loss 0.709397, Valid_loss 0.682814
Epoch 6, Train Loss 0.692619, Valid_loss 0.676753
Epoch 7, Train Loss 0.672452, Valid_loss 0.675224
Epoch 8, Train Loss 0.691105, Valid_loss 0.669451
Epoch 9, Train Loss 0.677388, Valid_loss 0.663826
Epoch 10, Train Loss 0.652381, Valid_loss 0.662145
Epoch 11, Train Loss 0.697193, Valid_loss 0.659593
Epoch 12, Train Loss 0.672982, Valid_loss 0.653084
Epoch 13, Train Loss 0.664106, Valid_loss 0.649705
Epoch 14, Train Loss 0.670159, Valid_loss 0.647569
Epoch 15, Train Loss 0.649705, Valid_loss 0.643082
Epoch 16, Train Loss 0.646783, Valid_loss 0.639403
Epoch 17, Train Loss 0.677857, Valid_loss 0.635728
Epoch 18, Train Loss 0.635266, Valid_loss 0.632720
Epoch 19, Train Loss 0.686759, Valid_loss 0.625072
Epoch 20, Train Loss 0.657438, Valid_loss 0.621299
Epoch 21, Train Loss 0.611641, Valid_loss 0.616479
Epoch 22, Train Loss 0.631682, Valid_loss 0.612184
Epoch 23, Train Loss 0.663641, Valid_loss 0.607678
Epoch 24, Train Loss 0.625025, Valid_loss 0.603907
Epoch 25, Train Loss 0.615817, Valid_loss 0.599791
Epoch 26, Train Loss 0.642119, Valid_loss 0.598537
Epoch 27, Train Loss 0.646426, Valid_loss 0.591713
Epoch 28, Train Loss 0.615057, Valid_loss 0.587619
Epoch 29, Train Loss 0.585490, Valid_loss 0.584031
Epoch 30, Train Loss 0.570154, Valid_loss 0.579745
Epoch 31, Train Loss 0.577210, Valid_loss 0.576772
Epoch 32, Train Loss 0.617748, Valid_loss 0.571085
Epoch 33, Train Loss 0.589530, Valid_loss 0.567604
Epoch 34, Train Loss 0.544322, Valid_loss 0.563560
Epoch 35, Train Loss 0.618575, Valid_loss 0.560926
Epoch 36, Train Loss 0.568322, Valid_loss 0.559174
Epoch 37, Train Loss 0.606949, Valid_loss 0.555938
Epoch 38, Train Loss 0.573435, Valid_loss 0.553786
Epoch 39, Train Loss 0.578252, Valid_loss 0.551449
Epoch 40, Train Loss 0.598709, Valid_loss 0.548301
Epoch 41, Train Loss 0.586217, Valid_loss 0.548183
Epoch 42, Train Loss 0.575881, Valid_loss 0.548151
Epoch 43, Train Loss 0.588835, Valid_loss 0.546955
Epoch 44, Train Loss 0.577699, Valid_loss 0.546741
Epoch 45, Train Loss 0.547652, Valid_loss 0.546562
Epoch 46, Train Loss 0.555211, Valid_loss 0.542313
Epoch 47, Train Loss 0.552889, Valid_loss 0.538369
Epoch 48, Train Loss 0.603159, Valid_loss 0.541049
Epoch 49, Train Loss 0.571474, Valid_loss 0.554761
Epoch 50, Train Loss 0.586664, Valid_loss 0.544872
Epoch 51, Train Loss 0.535421, Valid_loss 0.545018
Epoch 52, Train Loss 0.532826, Valid_loss 0.549146
[I 2025-08-31 16:31:49,125] Trial 0 finished with value: 0.538368576339313 and parameters: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 1, 'dropout': 0.5, 'weight_decay': 0.001, 'emb_dim': 8, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.538368576339313.
👉 train samples(학습 샘플(bag))=126, batch_size=16 -> steps(샘플수/batch크기)=8
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 29.04 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.631805, Valid_loss 0.599526
Epoch 2, Train Loss 0.571242, Valid_loss 0.603410
Epoch 3, Train Loss 0.608129, Valid_loss 0.597739
Epoch 4, Train Loss 0.589013, Valid_loss 0.597029
Epoch 5, Train Loss 0.610655, Valid_loss 0.596718
Epoch 6, Train Loss 0.608367, Valid_loss 0.598783
Epoch 7, Train Loss 0.602167, Valid_loss 0.605110
Epoch 8, Train Loss 0.591675, Valid_loss 0.598773
Epoch 9, Train Loss 0.577480, Valid_loss 0.598808
Epoch 10, Train Loss 0.600519, Valid_loss 0.602813
Epoch 11, Train Loss 0.579415, Valid_loss 0.593391
Epoch 12, Train Loss 0.600039, Valid_loss 0.591750
Epoch 13, Train Loss 0.559990, Valid_loss 0.612837
Epoch 14, Train Loss 0.488765, Valid_loss 0.564005
Epoch 15, Train Loss 0.391622, Valid_loss 1.137557
Epoch 16, Train Loss 0.380636, Valid_loss 1.041397
Epoch 17, Train Loss 0.309598, Valid_loss 1.163155
Epoch 18, Train Loss 0.466955, Valid_loss 0.698956
Epoch 19, Train Loss 0.364691, Valid_loss 0.415548
Epoch 20, Train Loss 0.351234, Valid_loss 0.497246
Epoch 21, Train Loss 0.403566, Valid_loss 0.798280
Epoch 22, Train Loss 0.361517, Valid_loss 0.506287
Epoch 23, Train Loss 0.320424, Valid_loss 0.469512
Epoch 24, Train Loss 0.280436, Valid_loss 0.480380
Epoch 25, Train Loss 0.325814, Valid_loss 0.347392
Epoch 26, Train Loss 0.332930, Valid_loss 0.306205
Epoch 27, Train Loss 0.271035, Valid_loss 0.366944
Epoch 28, Train Loss 0.290642, Valid_loss 0.306568
Epoch 29, Train Loss 0.285325, Valid_loss 0.230739
Epoch 30, Train Loss 0.249433, Valid_loss 0.765006
Epoch 31, Train Loss 0.249466, Valid_loss 1.110860
Epoch 32, Train Loss 0.235487, Valid_loss 1.175432
Epoch 33, Train Loss 0.260408, Valid_loss 0.403269
Epoch 34, Train Loss 0.283760, Valid_loss 0.494475
Epoch 35, Train Loss 0.277140, Valid_loss 0.490815
Epoch 36, Train Loss 0.234761, Valid_loss 0.527530
Epoch 37, Train Loss 0.307460, Valid_loss 0.733846
Epoch 38, Train Loss 0.556764, Valid_loss 0.423914
Epoch 39, Train Loss 0.508667, Valid_loss 0.487619
Epoch 40, Train Loss 0.388812, Valid_loss 0.513012
Epoch 41, Train Loss 0.347822, Valid_loss 0.479310
Epoch 42, Train Loss 0.889056, Valid_loss 0.528508
Epoch 43, Train Loss 0.754446, Valid_loss 0.604492
Epoch 44, Train Loss 0.581878, Valid_loss 0.609627
Epoch 45, Train Loss 0.601337, Valid_loss 0.600227
Epoch 46, Train Loss 0.585964, Valid_loss 0.596992
Epoch 47, Train Loss 0.569955, Valid_loss 0.599237
Epoch 48, Train Loss 0.581801, Valid_loss 0.602579
Epoch 49, Train Loss 0.559877, Valid_loss 0.603316
Epoch 50, Train Loss 0.559905, Valid_loss 0.610725
Epoch 51, Train Loss 0.539199, Valid_loss 0.617652
Epoch 52, Train Loss 0.517574, Valid_loss 0.621305
[I 2025-08-31 16:35:17,359] Trial 1 finished with value: 0.23073880627219165 and parameters: {'learning_rate': 0.01, 'epochs': 100, 'heads': 2, 'dropout': 0.5, 'weight_decay': 0.0001, 'emb_dim': 64, 'augment_num': 100, 'pca': False}. Best is trial 1 with value: 0.23073880627219165.
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 29.04 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.561842, Valid_loss 0.482199
Epoch 2, Train Loss 0.409445, Valid_loss 0.382793
Epoch 3, Train Loss 0.339089, Valid_loss 0.408843
Epoch 4, Train Loss 0.344387, Valid_loss 0.345018
Epoch 5, Train Loss 0.278527, Valid_loss 0.299056
Epoch 6, Train Loss 0.223994, Valid_loss 0.273685
Epoch 7, Train Loss 0.205843, Valid_loss 0.241950
Epoch 8, Train Loss 0.190521, Valid_loss 0.254052
Epoch 9, Train Loss 0.192448, Valid_loss 0.242857
Epoch 10, Train Loss 0.188273, Valid_loss 0.260422
Epoch 11, Train Loss 0.185185, Valid_loss 0.270260
Epoch 12, Train Loss 0.183931, Valid_loss 0.260189
Epoch 13, Train Loss 0.176419, Valid_loss 0.254765
Epoch 14, Train Loss 0.175543, Valid_loss 0.237917
Epoch 15, Train Loss 0.182253, Valid_loss 0.254850
Epoch 16, Train Loss 0.185466, Valid_loss 0.352878
Epoch 17, Train Loss 0.175860, Valid_loss 0.266930
Epoch 18, Train Loss 0.167447, Valid_loss 0.254374
Epoch 19, Train Loss 0.174986, Valid_loss 0.258319
Epoch 20, Train Loss 0.168193, Valid_loss 0.271668
Epoch 21, Train Loss 0.165593, Valid_loss 0.250515
Epoch 22, Train Loss 0.162037, Valid_loss 0.253666
Epoch 23, Train Loss 0.163166, Valid_loss 0.281140
Epoch 24, Train Loss 0.163158, Valid_loss 0.265435
Epoch 25, Train Loss 0.199249, Valid_loss 0.289831
Epoch 26, Train Loss 0.180829, Valid_loss 0.244925
Epoch 27, Train Loss 0.177504, Valid_loss 0.252327
Epoch 28, Train Loss 0.165328, Valid_loss 0.267191
Epoch 29, Train Loss 0.159491, Valid_loss 0.267720
Epoch 30, Train Loss 0.164168, Valid_loss 0.246990
Epoch 31, Train Loss 0.160842, Valid_loss 0.237440
Epoch 32, Train Loss 0.162161, Valid_loss 0.361601
Epoch 33, Train Loss 0.167292, Valid_loss 0.249760
Epoch 34, Train Loss 0.155528, Valid_loss 0.286513
Epoch 35, Train Loss 0.156984, Valid_loss 0.247149
Epoch 36, Train Loss 0.159270, Valid_loss 0.243700
Epoch 37, Train Loss 0.150881, Valid_loss 0.277407
Epoch 38, Train Loss 0.155832, Valid_loss 0.233018
Epoch 39, Train Loss 0.153122, Valid_loss 0.232828
Epoch 40, Train Loss 0.148253, Valid_loss 0.231413
Epoch 41, Train Loss 0.154725, Valid_loss 0.247524
Epoch 42, Train Loss 0.153177, Valid_loss 0.235858
Epoch 43, Train Loss 0.151392, Valid_loss 0.277799
Epoch 44, Train Loss 0.156295, Valid_loss 0.237687
Epoch 45, Train Loss 0.158407, Valid_loss 0.224154
Epoch 46, Train Loss 0.162758, Valid_loss 0.218701
Epoch 47, Train Loss 0.150375, Valid_loss 0.233223
Epoch 48, Train Loss 0.151662, Valid_loss 0.236097
Epoch 49, Train Loss 0.146814, Valid_loss 0.233290
Epoch 50, Train Loss 0.148456, Valid_loss 0.236409
Epoch 51, Train Loss 0.148878, Valid_loss 0.241826
Epoch 52, Train Loss 0.146690, Valid_loss 0.232532
Epoch 53, Train Loss 0.145015, Valid_loss 0.229715
Epoch 54, Train Loss 0.147980, Valid_loss 0.223475
Epoch 55, Train Loss 0.146911, Valid_loss 0.220403
Epoch 56, Train Loss 0.141744, Valid_loss 0.234169
Epoch 57, Train Loss 0.149385, Valid_loss 0.243326
[I 2025-08-31 16:39:42,804] Trial 2 finished with value: 0.21870113105978817 and parameters: {'learning_rate': 0.001, 'epochs': 100, 'heads': 4, 'dropout': 0.3, 'weight_decay': 0.001, 'emb_dim': 64, 'augment_num': 100, 'pca': False}. Best is trial 2 with value: 0.21870113105978817.
선택된 trial params: {'learning_rate': 0.001, 'epochs': 100, 'heads': 4, 'dropout': 0.3, 'weight_decay': 0.001, 'emb_dim': 64, 'augment_num': 100, 'pca': False}
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=10, batch_size=1 -> steps=10
output_class :  1
Memory Allocated: 29.04 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.584128, Valid_loss 0.455982
Epoch 2, Train Loss 0.411904, Valid_loss 0.316981
Epoch 3, Train Loss 0.340935, Valid_loss 0.550010
Epoch 4, Train Loss 0.355010, Valid_loss 0.290884
Epoch 5, Train Loss 0.298210, Valid_loss 0.317284
Epoch 6, Train Loss 0.261555, Valid_loss 0.297093
Epoch 7, Train Loss 0.254149, Valid_loss 0.321514
Epoch 8, Train Loss 0.217652, Valid_loss 0.278025
Epoch 9, Train Loss 0.213270, Valid_loss 0.288464
Epoch 10, Train Loss 0.216129, Valid_loss 0.252474
Epoch 11, Train Loss 0.205930, Valid_loss 0.276589
Epoch 12, Train Loss 0.224704, Valid_loss 0.335201
Epoch 13, Train Loss 0.205758, Valid_loss 0.321197
Epoch 14, Train Loss 0.199944, Valid_loss 0.285120
Epoch 15, Train Loss 0.190813, Valid_loss 0.261644
Epoch 16, Train Loss 0.176920, Valid_loss 0.236447
Epoch 17, Train Loss 0.176141, Valid_loss 0.237823
Epoch 18, Train Loss 0.170703, Valid_loss 0.282290
Epoch 19, Train Loss 0.171458, Valid_loss 0.270126
Epoch 20, Train Loss 0.164824, Valid_loss 0.280805
Epoch 21, Train Loss 0.184916, Valid_loss 0.334088
Epoch 22, Train Loss 0.174263, Valid_loss 0.243453
Epoch 23, Train Loss 0.168670, Valid_loss 0.244937
Epoch 24, Train Loss 0.163716, Valid_loss 0.248542
Epoch 25, Train Loss 0.170726, Valid_loss 0.295233
Epoch 26, Train Loss 0.170154, Valid_loss 0.246676
Epoch 27, Train Loss 0.169989, Valid_loss 0.311512
Epoch 28, Train Loss 0.170349, Valid_loss 0.260677
Epoch 29, Train Loss 0.162734, Valid_loss 0.253766
Epoch 30, Train Loss 0.158818, Valid_loss 0.261270
Epoch 31, Train Loss 0.163299, Valid_loss 0.276660
Epoch 32, Train Loss 0.163364, Valid_loss 0.238872
Epoch 33, Train Loss 0.170121, Valid_loss 0.332872
Epoch 34, Train Loss 0.173905, Valid_loss 0.233444
Epoch 35, Train Loss 0.170183, Valid_loss 0.260756
Epoch 36, Train Loss 0.162255, Valid_loss 0.247618
Epoch 37, Train Loss 0.154242, Valid_loss 0.255938
Epoch 38, Train Loss 0.160626, Valid_loss 0.251556
Epoch 39, Train Loss 0.150577, Valid_loss 0.232294
Epoch 40, Train Loss 0.157456, Valid_loss 0.246399
Epoch 41, Train Loss 0.166287, Valid_loss 0.273806
Epoch 42, Train Loss 0.173567, Valid_loss 0.256555
Epoch 43, Train Loss 0.157789, Valid_loss 0.240362
Epoch 44, Train Loss 0.153575, Valid_loss 0.248580
Epoch 45, Train Loss 0.165496, Valid_loss 0.281722
Epoch 46, Train Loss 0.153323, Valid_loss 0.224211
Epoch 47, Train Loss 0.156880, Valid_loss 0.265116
Epoch 48, Train Loss 0.154674, Valid_loss 0.236258
Epoch 49, Train Loss 0.154131, Valid_loss 0.242044
Epoch 50, Train Loss 0.153410, Valid_loss 0.249249
Epoch 51, Train Loss 0.147118, Valid_loss 0.260821
Epoch 52, Train Loss 0.148730, Valid_loss 0.233512
Epoch 53, Train Loss 0.154247, Valid_loss 0.265838
Epoch 54, Train Loss 0.148751, Valid_loss 0.227142
Epoch 55, Train Loss 0.145024, Valid_loss 0.247960
Epoch 56, Train Loss 0.142927, Valid_loss 0.239543
Epoch 57, Train Loss 0.150384, Valid_loss 0.240385
Epoch 58, Train Loss 0.146535, Valid_loss 0.250719
환자ID=COVID19_Participant17 -- true: 1 -- pred: 1
환자ID=COVID19_Participant19 -- true: 1 -- pred: 1
환자ID=COVID19_Participant22 -- true: 1 -- pred: 1
환자ID=COVID19_Participant26 -- true: 1 -- pred: 1
환자ID=COVID19_Participant27 -- true: 1 -- pred: 1
환자ID=COVID19_Participant29 -- true: 1 -- pred: 1
환자ID=COVID19_Participant38 -- true: 1 -- pred: 1
환자ID=Control_Participant3 -- true: 0 -- pred: 0
환자ID=Control_Participant6 -- true: 0 -- pred: 0
환자ID=Control_Participant7 -- true: 0 -- pred: 0
Best performance: Epoch 46, Loss 0.153323, Test ACC 1.000000, Test AUC 1.000000, Test Recall 1.000000, Test Precision 1.000000
Confusion Matrix:
 [3 0 0 7]
✅ Total valid splits used: 2
🔁 Repeat 1, Fold 2
cell type :  GTCGGGGGGTGG_Control_Participant7        Keratinocytes
CAAATCAATTAT_Control_Participant7     Epithelial_cells
ATACAATTGACA_Control_Participant7     Epithelial_cells
CTGTTAATGAGA_Control_Participant7     Epithelial_cells
CTTCACATTATT_Control_Participant7     Epithelial_cells
                                            ...       
ACCATATTCAGG_COVID19_Participant21       Keratinocytes
GCCCGTTTCACG_COVID19_Participant21    Epithelial_cells
TATTATCTCTTA_COVID19_Participant21    Epithelial_cells
TTCCGTTTGTCC_COVID19_Participant21    Epithelial_cells
TCGGGATTGGAT_COVID19_Participant21         Neutrophils
Name: singler_annotation, Length: 23113, dtype: string
cell type annotation :  GTCGGGGGGTGG_Control_Participant7        Keratinocytes
CAAATCAATTAT_Control_Participant7     Epithelial_cells
ATACAATTGACA_Control_Participant7     Epithelial_cells
CTGTTAATGAGA_Control_Participant7     Epithelial_cells
CTTCACATTATT_Control_Participant7     Epithelial_cells
                                            ...       
ACCATATTCAGG_COVID19_Participant21       Keratinocytes
GCCCGTTTCACG_COVID19_Participant21    Epithelial_cells
TATTATCTCTTA_COVID19_Participant21    Epithelial_cells
TTCCGTTTGTCC_COVID19_Participant21    Epithelial_cells
TCGGGATTGGAT_COVID19_Participant21         Neutrophils
Name: singler_annotation, Length: 23113, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Keratinocytes', 'Epithelial_cells', 'Neurons', 'iPS_cells', 'Embryonic_stem_cells', 'Astrocyte', 'DC', 'Gametocytes', 'HSC_-G-CSF', 'Smooth_muscle_cells', 'BM & Prog.', 'Monocyte', 'Myelocyte', 'BM', 'Endothelial_cells', 'Osteoblasts', 'Platelets', 'Erythroblast', 'NK_cell', 'T_cells', 'Chondrocytes', 'HSC_CD34+', 'CMP', 'Neutrophils', 'Fibroblasts', 'MEP', 'Neuroepithelial_cell', 'MSC', 'Pro-Myelocyte', 'B_cell', 'GMP', 'Hepatocytes', 'Macrophage', 'Tissue_stem_cells', 'Pre-B_cell_CD34-', 'Pro-B_cell_CD34+', 'Unknown']
라벨별 그룹 개수 {1: 28, 0: 12}
cell type :  CGAACGGACTCC_Control_Participant12       Epithelial_cells
GTGTCCTGGGGT_Control_Participant12    Smooth_muscle_cells
ATTTGCCTGTCG_Control_Participant12       Epithelial_cells
TCTCTAAAGTGT_Control_Participant12                Neurons
TAGAGACAACGA_Control_Participant12       Epithelial_cells
                                             ...         
GCAGGGAACTCC_COVID19_Participant30       Epithelial_cells
CAGCACCGAGCC_COVID19_Participant30       Epithelial_cells
GCCCCTTGTGAT_COVID19_Participant30       Epithelial_cells
GTGTTGTGTGTC_COVID19_Participant30                 B_cell
TAACACTCACTT_COVID19_Participant30              Myelocyte
Name: singler_annotation, Length: 3834, dtype: string
cell type annotation :  CGAACGGACTCC_Control_Participant12       Epithelial_cells
GTGTCCTGGGGT_Control_Participant12    Smooth_muscle_cells
ATTTGCCTGTCG_Control_Participant12       Epithelial_cells
TCTCTAAAGTGT_Control_Participant12                Neurons
TAGAGACAACGA_Control_Participant12       Epithelial_cells
                                             ...         
GCAGGGAACTCC_COVID19_Participant30       Epithelial_cells
CAGCACCGAGCC_COVID19_Participant30       Epithelial_cells
GCCCCTTGTGAT_COVID19_Participant30       Epithelial_cells
GTGTTGTGTGTC_COVID19_Participant30                 B_cell
TAACACTCACTT_COVID19_Participant30              Myelocyte
Name: singler_annotation, Length: 3834, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Epithelial_cells', 'Smooth_muscle_cells', 'Neurons', 'Erythroblast', 'Keratinocytes', 'T_cells', 'Gametocytes', 'B_cell', 'Neutrophils', 'HSC_CD34+', 'MSC', 'Embryonic_stem_cells', 'Neuroepithelial_cell', 'BM & Prog.', 'Platelets', 'HSC_-G-CSF', 'NK_cell', 'MEP', 'Endothelial_cells', 'Astrocyte', 'CMP', 'GMP', 'Monocyte', 'Myelocyte', 'Pro-B_cell_CD34+', 'DC', 'Osteoblasts', 'BM', 'Macrophage', 'Pro-Myelocyte', 'Fibroblasts', 'Pre-B_cell_CD34-', 'Hepatocytes', 'Chondrocytes', 'Tissue_stem_cells', 'Unknown']
라벨별 그룹 개수 {1: 7, 0: 3}
🔍 Split #3
  → train_p_index 환자 수 (환자 단위로 묶인 index list): 40
  → test_p_index 환자 수  (환자 단위로 묶인 index list): 10
  → train 환자 ID: ['COVID19_Participant10', 'COVID19_Participant11', 'COVID19_Participant13', 'COVID19_Participant15', 'COVID19_Participant17', 'COVID19_Participant18', 'COVID19_Participant19', 'COVID19_Participant2', 'COVID19_Participant21', 'COVID19_Participant22', 'COVID19_Participant23', 'COVID19_Participant25', 'COVID19_Participant26', 'COVID19_Participant27', 'COVID19_Participant28', 'COVID19_Participant29', 'COVID19_Participant31', 'COVID19_Participant32', 'COVID19_Participant35', 'COVID19_Participant36', 'COVID19_Participant37', 'COVID19_Participant38', 'COVID19_Participant39', 'COVID19_Participant4', 'COVID19_Participant6', 'COVID19_Participant7', 'COVID19_Participant8', 'COVID19_Participant9', 'Control_Participant1', 'Control_Participant10', 'Control_Participant11', 'Control_Participant14', 'Control_Participant15', 'Control_Participant2', 'Control_Participant3', 'Control_Participant5', 'Control_Participant6', 'Control_Participant7', 'Control_Participant8', 'Control_Participant9']
  → test  환자 ID: ['COVID19_Participant12', 'COVID19_Participant14', 'COVID19_Participant20', 'COVID19_Participant3', 'COVID19_Participant30', 'COVID19_Participant40', 'COVID19_Participant5', 'Control_Participant12', 'Control_Participant13', 'Control_Participant4']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant10, Label: 1
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant18, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant21, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant27, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant35, Label: 1
    ID: COVID19_Participant36, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant38, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant6, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: COVID19_Participant9, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant10, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant14, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant2, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant6, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant8, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: COVID19_Participant12, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant3, Label: 1
    ID: COVID19_Participant30, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: COVID19_Participant5, Label: 1
    ID: Control_Participant12, Label: 0
    ID: Control_Participant13, Label: 0
    ID: Control_Participant4, Label: 0
전체 데이터 index 길이 50
label_stat (train 환자 라벨 목록) 갯수 40
train_data에서 환자 단위로, train과 validation 나누기
기존 train_p_index 40
기존 (train) label_stat 40
train-vali 분할 후! 
train y 의 classes : {0, 1} valid y 의 classes : {0, 1} label_stat 의 classes : {0, 1}
train_p_index_ 26
valid_p_index 14
test_p_index 10
→ train 환자 ID 및 라벨:
   총 개수: 26
   환자ID=Control_Participant10, Label=0, 셀개수=1645
   환자ID=Control_Participant2, Label=0, 셀개수=41
   환자ID=COVID19_Participant19, Label=1, 셀개수=816
   환자ID=COVID19_Participant38, Label=1, 셀개수=51
   환자ID=COVID19_Participant10, Label=1, 셀개수=18
   환자ID=Control_Participant6, Label=0, 셀개수=131
   환자ID=COVID19_Participant15, Label=1, 셀개수=1003
   환자ID=COVID19_Participant2, Label=1, 셀개수=329
   환자ID=COVID19_Participant4, Label=1, 셀개수=1680
   환자ID=COVID19_Participant13, Label=1, 셀개수=730
   환자ID=COVID19_Participant21, Label=1, 셀개수=39
   환자ID=Control_Participant3, Label=0, 셀개수=1620
   환자ID=COVID19_Participant27, Label=1, 셀개수=93
   환자ID=Control_Participant8, Label=0, 셀개수=393
   환자ID=Control_Participant7, Label=0, 셀개수=762
   환자ID=COVID19_Participant17, Label=1, 셀개수=843
   환자ID=Control_Participant9, Label=0, 셀개수=558
   환자ID=Control_Participant11, Label=0, 셀개수=1164
   환자ID=COVID19_Participant23, Label=1, 셀개수=307
   환자ID=COVID19_Participant31, Label=1, 셀개수=410
   환자ID=COVID19_Participant26, Label=1, 셀개수=814
   환자ID=COVID19_Participant18, Label=1, 셀개수=227
   환자ID=COVID19_Participant7, Label=1, 셀개수=409
   환자ID=COVID19_Participant39, Label=1, 셀개수=454
   환자ID=COVID19_Participant37, Label=1, 셀개수=668
   환자ID=COVID19_Participant29, Label=1, 셀개수=573
→ valid 환자 ID 및 라벨:
   총 개수: 14
   환자ID=Control_Participant15, Label=0, 셀개수=528
   환자ID=COVID19_Participant28, Label=1, 셀개수=1079
   환자ID=COVID19_Participant35, Label=1, 셀개수=83
   환자ID=COVID19_Participant32, Label=1, 셀개수=1665
   환자ID=COVID19_Participant6, Label=1, 셀개수=84
   환자ID=COVID19_Participant22, Label=1, 셀개수=865
   환자ID=Control_Participant5, Label=0, 셀개수=717
   환자ID=Control_Participant1, Label=0, 셀개수=414
   환자ID=COVID19_Participant9, Label=1, 셀개수=86
   환자ID=COVID19_Participant8, Label=1, 셀개수=462
   환자ID=Control_Participant14, Label=0, 셀개수=274
   환자ID=COVID19_Participant36, Label=1, 셀개수=200
   환자ID=COVID19_Participant11, Label=1, 셀개수=382
   환자ID=COVID19_Participant25, Label=1, 셀개수=496
→ test 환자 ID 및 라벨:
   총 개수: 10
   환자ID=COVID19_Participant12, Label=1, 셀개수=102
   환자ID=COVID19_Participant14, Label=1, 셀개수=382
   환자ID=COVID19_Participant20, Label=1, 셀개수=2033
   환자ID=COVID19_Participant3, Label=1, 셀개수=104
   환자ID=COVID19_Participant30, Label=1, 셀개수=116
   환자ID=COVID19_Participant40, Label=1, 셀개수=381
   환자ID=COVID19_Participant5, Label=1, 셀개수=89
   환자ID=Control_Participant12, Label=0, 셀개수=99
   환자ID=Control_Participant13, Label=0, 셀개수=88
   환자ID=Control_Participant4, Label=0, 셀개수=440
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Keratinocytes', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Neurons', 'iPS_cells', 'Embryonic_stem_cells', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
전체 데이터 길이 26947
전체 cell type 길이 0           Keratinocytes
1        Epithelial_cells
2        Epithelial_cells
3        Epithelial_cells
4        Epithelial_cells
               ...       
26942    Epithelial_cells
26943    Epithelial_cells
26944    Epithelial_cells
26945              B_cell
26946           Myelocyte
Length: 26947, dtype: string
cell type의 NaN 개수 체크 0
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:10,  9.45it/s]  2%|▏         | 2/100 [00:00<00:10,  9.64it/s]  3%|▎         | 3/100 [00:00<00:09,  9.70it/s]  5%|▌         | 5/100 [00:00<00:09, 10.13it/s]  7%|▋         | 7/100 [00:00<00:09, 10.28it/s]  9%|▉         | 9/100 [00:00<00:08, 10.26it/s] 11%|█         | 11/100 [00:01<00:08,  9.95it/s] 12%|█▏        | 12/100 [00:01<00:08,  9.91it/s] 13%|█▎        | 13/100 [00:01<00:08,  9.85it/s] 14%|█▍        | 14/100 [00:01<00:08,  9.81it/s] 15%|█▌        | 15/100 [00:01<00:08,  9.69it/s] 17%|█▋        | 17/100 [00:01<00:08,  9.91it/s] 19%|█▉        | 19/100 [00:01<00:08,  9.81it/s] 20%|██        | 20/100 [00:02<00:08,  9.52it/s] 21%|██        | 21/100 [00:02<00:08,  8.87it/s] 22%|██▏       | 22/100 [00:02<00:08,  8.97it/s] 24%|██▍       | 24/100 [00:02<00:09,  8.37it/s] 25%|██▌       | 25/100 [00:02<00:09,  7.72it/s] 26%|██▌       | 26/100 [00:02<00:09,  7.94it/s] 27%|██▋       | 27/100 [00:02<00:08,  8.37it/s] 29%|██▉       | 29/100 [00:03<00:08,  8.59it/s] 30%|███       | 30/100 [00:03<00:08,  8.15it/s] 32%|███▏      | 32/100 [00:03<00:08,  8.50it/s] 33%|███▎      | 33/100 [00:03<00:07,  8.76it/s] 34%|███▍      | 34/100 [00:03<00:07,  8.99it/s] 35%|███▌      | 35/100 [00:03<00:07,  8.65it/s] 36%|███▌      | 36/100 [00:03<00:07,  8.90it/s] 37%|███▋      | 37/100 [00:04<00:06,  9.08it/s] 38%|███▊      | 38/100 [00:04<00:07,  8.48it/s] 39%|███▉      | 39/100 [00:04<00:07,  8.59it/s] 40%|████      | 40/100 [00:04<00:08,  7.32it/s] 41%|████      | 41/100 [00:04<00:07,  7.89it/s] 42%|████▏     | 42/100 [00:04<00:07,  8.27it/s] 43%|████▎     | 43/100 [00:04<00:07,  7.79it/s] 44%|████▍     | 44/100 [00:04<00:06,  8.31it/s] 45%|████▌     | 45/100 [00:05<00:06,  8.64it/s] 46%|████▌     | 46/100 [00:05<00:06,  8.34it/s] 47%|████▋     | 47/100 [00:05<00:06,  8.68it/s] 48%|████▊     | 48/100 [00:05<00:05,  8.86it/s] 49%|████▉     | 49/100 [00:05<00:05,  9.03it/s] 50%|█████     | 50/100 [00:05<00:05,  8.52it/s] 51%|█████     | 51/100 [00:05<00:05,  8.72it/s] 52%|█████▏    | 52/100 [00:05<00:05,  9.07it/s] 53%|█████▎    | 53/100 [00:05<00:05,  8.90it/s] 54%|█████▍    | 54/100 [00:06<00:07,  6.43it/s] 55%|█████▌    | 55/100 [00:06<00:06,  6.98it/s] 56%|█████▌    | 56/100 [00:06<00:06,  7.11it/s] 57%|█████▋    | 57/100 [00:06<00:05,  7.60it/s] 58%|█████▊    | 58/100 [00:06<00:05,  7.95it/s] 59%|█████▉    | 59/100 [00:06<00:04,  8.23it/s] 60%|██████    | 60/100 [00:06<00:04,  8.31it/s] 61%|██████    | 61/100 [00:07<00:04,  8.51it/s] 62%|██████▏   | 62/100 [00:07<00:04,  8.43it/s] 63%|██████▎   | 63/100 [00:07<00:04,  8.42it/s] 64%|██████▍   | 64/100 [00:07<00:04,  8.54it/s] 65%|██████▌   | 65/100 [00:07<00:04,  8.71it/s] 66%|██████▌   | 66/100 [00:07<00:03,  8.63it/s] 67%|██████▋   | 67/100 [00:07<00:03,  8.46it/s] 68%|██████▊   | 68/100 [00:07<00:03,  8.69it/s] 69%|██████▉   | 69/100 [00:07<00:03,  9.00it/s] 70%|███████   | 70/100 [00:08<00:03,  8.76it/s] 71%|███████   | 71/100 [00:08<00:03,  8.76it/s] 72%|███████▏  | 72/100 [00:08<00:03,  8.79it/s] 73%|███████▎  | 73/100 [00:08<00:03,  8.53it/s] 74%|███████▍  | 74/100 [00:08<00:03,  8.62it/s] 75%|███████▌  | 75/100 [00:08<00:02,  8.63it/s] 76%|███████▌  | 76/100 [00:08<00:02,  8.59it/s] 77%|███████▋  | 77/100 [00:08<00:02,  8.37it/s] 78%|███████▊  | 78/100 [00:09<00:02,  8.42it/s] 79%|███████▉  | 79/100 [00:09<00:02,  8.30it/s] 80%|████████  | 80/100 [00:09<00:02,  8.45it/s] 81%|████████  | 81/100 [00:09<00:02,  8.07it/s] 82%|████████▏ | 82/100 [00:09<00:02,  8.02it/s] 83%|████████▎ | 83/100 [00:09<00:02,  8.15it/s] 84%|████████▍ | 84/100 [00:09<00:01,  8.18it/s] 85%|████████▌ | 85/100 [00:09<00:01,  8.36it/s] 86%|████████▌ | 86/100 [00:09<00:01,  8.45it/s] 87%|████████▋ | 87/100 [00:10<00:01,  8.43it/s] 88%|████████▊ | 88/100 [00:10<00:01,  8.75it/s] 89%|████████▉ | 89/100 [00:10<00:01,  9.00it/s] 90%|█████████ | 90/100 [00:10<00:01,  8.70it/s] 91%|█████████ | 91/100 [00:10<00:01,  8.13it/s] 92%|█████████▏| 92/100 [00:10<00:01,  7.63it/s] 93%|█████████▎| 93/100 [00:10<00:00,  7.99it/s] 94%|█████████▍| 94/100 [00:10<00:00,  7.97it/s] 95%|█████████▌| 95/100 [00:11<00:00,  8.03it/s] 96%|█████████▌| 96/100 [00:11<00:00,  7.71it/s] 97%|█████████▋| 97/100 [00:11<00:00,  7.91it/s] 98%|█████████▊| 98/100 [00:11<00:00,  8.07it/s] 99%|█████████▉| 99/100 [00:11<00:00,  7.79it/s]100%|██████████| 100/100 [00:11<00:00,  7.80it/s]100%|██████████| 100/100 [00:11<00:00,  8.53it/s]
[I 2025-08-31 16:44:26,086] A new study created in memory with name: no-name-3ebf79c2-26b1-4094-9054-a94c824813d3
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 25.64 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.785570, Valid_loss 0.741776
Epoch 2, Train Loss 0.803772, Valid_loss 0.715703
Epoch 3, Train Loss 0.755575, Valid_loss 0.687797
Epoch 4, Train Loss 0.713292, Valid_loss 0.683966
Epoch 5, Train Loss 0.702716, Valid_loss 0.671479
Epoch 6, Train Loss 0.680708, Valid_loss 0.661266
Epoch 7, Train Loss 0.690337, Valid_loss 0.651403
Epoch 8, Train Loss 0.682345, Valid_loss 0.641920
Epoch 9, Train Loss 0.690279, Valid_loss 0.635573
Epoch 10, Train Loss 0.672104, Valid_loss 0.629756
Epoch 11, Train Loss 0.651022, Valid_loss 0.618597
Epoch 12, Train Loss 0.662116, Valid_loss 0.613951
Epoch 13, Train Loss 0.642598, Valid_loss 0.583892
Epoch 14, Train Loss 0.647731, Valid_loss 0.575293
Epoch 15, Train Loss 0.634716, Valid_loss 0.575934
Epoch 16, Train Loss 0.614123, Valid_loss 0.550837
Epoch 17, Train Loss 0.619039, Valid_loss 0.551638
Epoch 18, Train Loss 0.625128, Valid_loss 0.551360
Epoch 19, Train Loss 0.602711, Valid_loss 0.543594
Epoch 20, Train Loss 0.600703, Valid_loss 0.533377
Epoch 21, Train Loss 0.580601, Valid_loss 0.553133
Epoch 22, Train Loss 0.575417, Valid_loss 0.507934
Epoch 23, Train Loss 0.556330, Valid_loss 0.551892
Epoch 24, Train Loss 0.581044, Valid_loss 0.502333
Epoch 25, Train Loss 0.565581, Valid_loss 0.545095
Epoch 26, Train Loss 0.584076, Valid_loss 0.500902
Epoch 27, Train Loss 0.554122, Valid_loss 0.528425
Epoch 28, Train Loss 0.528136, Valid_loss 0.515758
Epoch 29, Train Loss 0.567992, Valid_loss 0.518013
Epoch 30, Train Loss 0.529348, Valid_loss 0.527266
Epoch 31, Train Loss 0.557662, Valid_loss 0.523151
Epoch 32, Train Loss 0.548585, Valid_loss 0.483915
Epoch 33, Train Loss 0.531302, Valid_loss 0.506437
Epoch 34, Train Loss 0.545097, Valid_loss 0.509597
Epoch 35, Train Loss 0.539276, Valid_loss 0.472455
Epoch 36, Train Loss 0.538456, Valid_loss 0.521641
Epoch 37, Train Loss 0.548896, Valid_loss 0.508207
Epoch 38, Train Loss 0.557836, Valid_loss 0.470723
Epoch 39, Train Loss 0.545254, Valid_loss 0.520704
Epoch 40, Train Loss 0.518002, Valid_loss 0.491208
Epoch 41, Train Loss 0.560459, Valid_loss 0.443851
Epoch 42, Train Loss 0.546092, Valid_loss 0.508089
Epoch 43, Train Loss 0.520762, Valid_loss 0.467852
Epoch 44, Train Loss 0.519162, Valid_loss 0.502773
Epoch 45, Train Loss 0.526567, Valid_loss 0.482188
Epoch 46, Train Loss 0.537102, Valid_loss 0.462708
Epoch 47, Train Loss 0.541009, Valid_loss 0.465417
Epoch 48, Train Loss 0.517226, Valid_loss 0.473040
Epoch 49, Train Loss 0.490574, Valid_loss 0.495216
Epoch 50, Train Loss 0.523393, Valid_loss 0.504953
Epoch 51, Train Loss 0.490108, Valid_loss 0.501144
Epoch 52, Train Loss 0.510875, Valid_loss 0.491044
Epoch 53, Train Loss 0.511256, Valid_loss 0.491632
Epoch 54, Train Loss 0.502470, Valid_loss 0.495568
[I 2025-08-31 16:47:45,145] Trial 0 finished with value: 0.44385138366903576 and parameters: {'learning_rate': 0.001, 'epochs': 100, 'heads': 1, 'dropout': 0.7, 'weight_decay': 0.01, 'emb_dim': 8, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.44385138366903576.
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 26.96 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.689001, Valid_loss 0.598731
Epoch 2, Train Loss 0.673023, Valid_loss 0.640795
Epoch 3, Train Loss 0.668309, Valid_loss 0.613917
Epoch 4, Train Loss 0.658571, Valid_loss 0.625954
Epoch 5, Train Loss 0.651001, Valid_loss 0.604058
Epoch 6, Train Loss 0.669905, Valid_loss 0.632977
Epoch 7, Train Loss 0.665381, Valid_loss 0.616480
Epoch 8, Train Loss 0.650303, Valid_loss 0.613906
Epoch 9, Train Loss 0.671535, Valid_loss 0.609564
Epoch 10, Train Loss 0.665974, Valid_loss 0.635791
Epoch 11, Train Loss 0.663385, Valid_loss 0.617765
Epoch 12, Train Loss 0.649732, Valid_loss 0.611906
Epoch 13, Train Loss 0.649760, Valid_loss 0.588187
Epoch 14, Train Loss 0.619817, Valid_loss 0.475468
Epoch 15, Train Loss 0.576000, Valid_loss 0.393076
Epoch 16, Train Loss 0.520405, Valid_loss 0.516112
Epoch 17, Train Loss 0.608575, Valid_loss 0.540504
Epoch 18, Train Loss 0.557187, Valid_loss 0.516563
Epoch 19, Train Loss 0.506563, Valid_loss 0.492099
Epoch 20, Train Loss 0.517378, Valid_loss 0.500814
Epoch 21, Train Loss 0.449787, Valid_loss 0.695527
Epoch 22, Train Loss 0.412196, Valid_loss 0.635771
Epoch 23, Train Loss 0.428351, Valid_loss 0.557801
Epoch 24, Train Loss 0.446874, Valid_loss 0.553269
Epoch 25, Train Loss 0.390275, Valid_loss 0.532321
Epoch 26, Train Loss 0.374679, Valid_loss 0.650155
Epoch 27, Train Loss 0.372617, Valid_loss 0.474634
Epoch 28, Train Loss 0.358328, Valid_loss 0.865937
Epoch 29, Train Loss 0.406496, Valid_loss 0.241256
Epoch 30, Train Loss 0.450363, Valid_loss 0.369478
Epoch 31, Train Loss 0.438991, Valid_loss 0.365751
Epoch 32, Train Loss 0.387579, Valid_loss 0.376558
Epoch 33, Train Loss 0.378635, Valid_loss 0.249440
Epoch 34, Train Loss 0.393242, Valid_loss 0.293733
Epoch 35, Train Loss 0.402467, Valid_loss 0.305956
Epoch 36, Train Loss 0.392161, Valid_loss 0.419649
Epoch 37, Train Loss 0.384420, Valid_loss 0.419958
Epoch 38, Train Loss 0.361757, Valid_loss 0.428298
Epoch 39, Train Loss 0.377110, Valid_loss 0.491746
Epoch 40, Train Loss 0.433445, Valid_loss 0.563750
Epoch 41, Train Loss 0.409106, Valid_loss 0.426637
Epoch 42, Train Loss 0.392710, Valid_loss 0.867640
Epoch 43, Train Loss 0.369646, Valid_loss 0.935488
Epoch 44, Train Loss 0.333014, Valid_loss 0.912044
Epoch 45, Train Loss 0.334851, Valid_loss 1.072150
Epoch 46, Train Loss 0.316617, Valid_loss 0.847868
Epoch 47, Train Loss 0.413468, Valid_loss 0.625219
Epoch 48, Train Loss 0.406516, Valid_loss 1.469722
Epoch 49, Train Loss 0.417256, Valid_loss 0.343365
Epoch 50, Train Loss 0.405419, Valid_loss 0.327384
Epoch 51, Train Loss 0.384866, Valid_loss 0.325208
Epoch 52, Train Loss 0.375765, Valid_loss 0.298536
Epoch 53, Train Loss 0.351493, Valid_loss 0.392869
Epoch 54, Train Loss 0.335736, Valid_loss 0.527634
[I 2025-08-31 16:51:21,203] Trial 1 finished with value: 0.24125611502677202 and parameters: {'learning_rate': 0.01, 'epochs': 100, 'heads': 2, 'dropout': 0.5, 'weight_decay': 0.001, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 1 with value: 0.24125611502677202.
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 26.96 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.672125, Valid_loss 0.591497
Epoch 2, Train Loss 0.648987, Valid_loss 0.578062
Epoch 3, Train Loss 0.622229, Valid_loss 0.543484
Epoch 4, Train Loss 0.595331, Valid_loss 0.542468
Epoch 5, Train Loss 0.591947, Valid_loss 0.516410
Epoch 6, Train Loss 0.597541, Valid_loss 0.495313
Epoch 7, Train Loss 0.588770, Valid_loss 0.495170
Epoch 8, Train Loss 0.570005, Valid_loss 0.473602
Epoch 9, Train Loss 0.540888, Valid_loss 0.471903
Epoch 10, Train Loss 0.523919, Valid_loss 0.455641
Epoch 11, Train Loss 0.491278, Valid_loss 0.445922
Epoch 12, Train Loss 0.529943, Valid_loss 0.454849
Epoch 13, Train Loss 0.525024, Valid_loss 0.443703
Epoch 14, Train Loss 0.500464, Valid_loss 0.437633
Epoch 15, Train Loss 0.488302, Valid_loss 0.449276
Epoch 16, Train Loss 0.470664, Valid_loss 0.442297
Epoch 17, Train Loss 0.467401, Valid_loss 0.453020
Epoch 18, Train Loss 0.482182, Valid_loss 0.462897
Epoch 19, Train Loss 0.496185, Valid_loss 0.451818
Epoch 20, Train Loss 0.500397, Valid_loss 0.446504
Epoch 21, Train Loss 0.463136, Valid_loss 0.452307
Epoch 22, Train Loss 0.451914, Valid_loss 0.476338
Epoch 23, Train Loss 0.451835, Valid_loss 0.493494
Epoch 24, Train Loss 0.455448, Valid_loss 0.471913
Epoch 25, Train Loss 0.466193, Valid_loss 0.464253
Epoch 26, Train Loss 0.449711, Valid_loss 0.478737
Epoch 27, Train Loss 0.445974, Valid_loss 0.457884
Epoch 28, Train Loss 0.453970, Valid_loss 0.466239
Epoch 29, Train Loss 0.440622, Valid_loss 0.481345
Epoch 30, Train Loss 0.460484, Valid_loss 0.451495
Epoch 31, Train Loss 0.439847, Valid_loss 0.492290
Epoch 32, Train Loss 0.464920, Valid_loss 0.461691
Epoch 33, Train Loss 0.462835, Valid_loss 0.458260
Epoch 34, Train Loss 0.456735, Valid_loss 0.485060
Epoch 35, Train Loss 0.437380, Valid_loss 0.485433
Epoch 36, Train Loss 0.445671, Valid_loss 0.484422
Epoch 37, Train Loss 0.437094, Valid_loss 0.464902
Epoch 38, Train Loss 0.432908, Valid_loss 0.486905
Epoch 39, Train Loss 0.453633, Valid_loss 0.459629
Epoch 40, Train Loss 0.437606, Valid_loss 0.475329
Epoch 41, Train Loss 0.431768, Valid_loss 0.445463
Epoch 42, Train Loss 0.453174, Valid_loss 0.481381
Epoch 43, Train Loss 0.448663, Valid_loss 0.447588
Epoch 44, Train Loss 0.416672, Valid_loss 0.464946
Epoch 45, Train Loss 0.428537, Valid_loss 0.426691
Epoch 46, Train Loss 0.434715, Valid_loss 0.495650
Epoch 47, Train Loss 0.426266, Valid_loss 0.453633
Epoch 48, Train Loss 0.457797, Valid_loss 0.497821
Epoch 49, Train Loss 0.449202, Valid_loss 0.431304
Epoch 50, Train Loss 0.404963, Valid_loss 0.492995
Epoch 51, Train Loss 0.439116, Valid_loss 0.442025
Epoch 52, Train Loss 0.434009, Valid_loss 0.473597
Epoch 53, Train Loss 0.420453, Valid_loss 0.480074
[I 2025-08-31 16:55:26,032] Trial 2 finished with value: 0.4266913224543844 and parameters: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 4, 'dropout': 0.7, 'weight_decay': 0.001, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 1 with value: 0.24125611502677202.
선택된 trial params: {'learning_rate': 0.01, 'epochs': 100, 'heads': 2, 'dropout': 0.5, 'weight_decay': 0.001, 'emb_dim': 32, 'augment_num': 100, 'pca': False}
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=10, batch_size=1 -> steps=10
output_class :  1
Memory Allocated: 26.96 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.680898, Valid_loss 0.656522
Epoch 2, Train Loss 0.628632, Valid_loss 0.519862
Epoch 3, Train Loss 0.548373, Valid_loss 0.701814
Epoch 4, Train Loss 0.573192, Valid_loss 0.491901
Epoch 5, Train Loss 0.450823, Valid_loss 0.499645
Epoch 6, Train Loss 0.410342, Valid_loss 0.521305
Epoch 7, Train Loss 0.414756, Valid_loss 0.365213
Epoch 8, Train Loss 0.389748, Valid_loss 0.346764
Epoch 9, Train Loss 0.343270, Valid_loss 0.373552
Epoch 10, Train Loss 0.416305, Valid_loss 0.434034
Epoch 11, Train Loss 0.357646, Valid_loss 0.657770
Epoch 12, Train Loss 0.366048, Valid_loss 0.418714
Epoch 13, Train Loss 0.353766, Valid_loss 0.632693
Epoch 14, Train Loss 0.377560, Valid_loss 0.517493
Epoch 15, Train Loss 0.372702, Valid_loss 0.719845
Epoch 16, Train Loss 0.407872, Valid_loss 0.659053
Epoch 17, Train Loss 0.320446, Valid_loss 0.662510
Epoch 18, Train Loss 0.327376, Valid_loss 0.534243
Epoch 19, Train Loss 0.335683, Valid_loss 0.607755
Epoch 20, Train Loss 0.325570, Valid_loss 0.502875
Epoch 21, Train Loss 0.379399, Valid_loss 0.445919
Epoch 22, Train Loss 0.360461, Valid_loss 0.566459
Epoch 23, Train Loss 0.334863, Valid_loss 0.557676
Epoch 24, Train Loss 0.316838, Valid_loss 0.561086
Epoch 25, Train Loss 0.321872, Valid_loss 0.545239
Epoch 26, Train Loss 0.289512, Valid_loss 0.480693
Epoch 27, Train Loss 0.283997, Valid_loss 0.389682
Epoch 28, Train Loss 0.320493, Valid_loss 0.402475
Epoch 29, Train Loss 0.300206, Valid_loss 0.444047
Epoch 30, Train Loss 0.302565, Valid_loss 0.475840
Epoch 31, Train Loss 0.293977, Valid_loss 0.595644
Epoch 32, Train Loss 0.330299, Valid_loss 0.597354
Epoch 33, Train Loss 0.298941, Valid_loss 0.527901
Epoch 34, Train Loss 0.321425, Valid_loss 0.754799
Epoch 35, Train Loss 0.288760, Valid_loss 0.560663
Epoch 36, Train Loss 0.359079, Valid_loss 0.361022
Epoch 37, Train Loss 0.324947, Valid_loss 0.495213
Epoch 38, Train Loss 0.279391, Valid_loss 0.473437
Epoch 39, Train Loss 0.282895, Valid_loss 0.495491
Epoch 40, Train Loss 0.291479, Valid_loss 0.699078
Epoch 41, Train Loss 0.308752, Valid_loss 0.638600
Epoch 42, Train Loss 0.298290, Valid_loss 0.606800
Epoch 43, Train Loss 0.260393, Valid_loss 0.656366
Epoch 44, Train Loss 0.295844, Valid_loss 0.672729
Epoch 45, Train Loss 0.321453, Valid_loss 0.585185
Epoch 46, Train Loss 0.292593, Valid_loss 0.501572
Epoch 47, Train Loss 0.266797, Valid_loss 0.683528
Epoch 48, Train Loss 0.304133, Valid_loss 0.310766
Epoch 49, Train Loss 0.303323, Valid_loss 0.522013
Epoch 50, Train Loss 0.285436, Valid_loss 0.735375
Epoch 51, Train Loss 0.290323, Valid_loss 0.810798
Epoch 52, Train Loss 0.304499, Valid_loss 0.628374
Epoch 53, Train Loss 0.276732, Valid_loss 0.592757
Epoch 54, Train Loss 0.257396, Valid_loss 0.504279
Epoch 55, Train Loss 0.275817, Valid_loss 0.516646
Epoch 56, Train Loss 0.280202, Valid_loss 0.525267
환자ID=COVID19_Participant12 -- true: 1 -- pred: 1
환자ID=COVID19_Participant14 -- true: 1 -- pred: 1
환자ID=COVID19_Participant20 -- true: 1 -- pred: 1
환자ID=COVID19_Participant3 -- true: 1 -- pred: 1
환자ID=COVID19_Participant30 -- true: 1 -- pred: 1
환자ID=COVID19_Participant40 -- true: 1 -- pred: 1
환자ID=COVID19_Participant5 -- true: 1 -- pred: 1
환자ID=Control_Participant12 -- true: 0 -- pred: 0
환자ID=Control_Participant13 -- true: 0 -- pred: 0
환자ID=Control_Participant4 -- true: 0 -- pred: 0
Best performance: Epoch 48, Loss 0.304133, Test ACC 1.000000, Test AUC 1.000000, Test Recall 1.000000, Test Precision 1.000000
Confusion Matrix:
 [3 0 0 7]
✅ Total valid splits used: 3
🔁 Repeat 1, Fold 3
cell type :  GTCGGGGGGTGG_Control_Participant7        Keratinocytes
CAAATCAATTAT_Control_Participant7     Epithelial_cells
ATACAATTGACA_Control_Participant7     Epithelial_cells
CTGTTAATGAGA_Control_Participant7     Epithelial_cells
CTTCACATTATT_Control_Participant7     Epithelial_cells
                                            ...       
GCAGGGAACTCC_COVID19_Participant30    Epithelial_cells
CAGCACCGAGCC_COVID19_Participant30    Epithelial_cells
GCCCCTTGTGAT_COVID19_Participant30    Epithelial_cells
GTGTTGTGTGTC_COVID19_Participant30              B_cell
TAACACTCACTT_COVID19_Participant30           Myelocyte
Name: singler_annotation, Length: 21089, dtype: string
cell type annotation :  GTCGGGGGGTGG_Control_Participant7        Keratinocytes
CAAATCAATTAT_Control_Participant7     Epithelial_cells
ATACAATTGACA_Control_Participant7     Epithelial_cells
CTGTTAATGAGA_Control_Participant7     Epithelial_cells
CTTCACATTATT_Control_Participant7     Epithelial_cells
                                            ...       
GCAGGGAACTCC_COVID19_Participant30    Epithelial_cells
CAGCACCGAGCC_COVID19_Participant30    Epithelial_cells
GCCCCTTGTGAT_COVID19_Participant30    Epithelial_cells
GTGTTGTGTGTC_COVID19_Participant30              B_cell
TAACACTCACTT_COVID19_Participant30           Myelocyte
Name: singler_annotation, Length: 21089, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Keratinocytes', 'Epithelial_cells', 'Neurons', 'iPS_cells', 'Embryonic_stem_cells', 'Astrocyte', 'DC', 'Gametocytes', 'HSC_-G-CSF', 'Smooth_muscle_cells', 'BM & Prog.', 'Monocyte', 'Myelocyte', 'BM', 'Endothelial_cells', 'Osteoblasts', 'Platelets', 'Erythroblast', 'NK_cell', 'T_cells', 'Chondrocytes', 'HSC_CD34+', 'CMP', 'Neutrophils', 'Fibroblasts', 'MEP', 'Neuroepithelial_cell', 'MSC', 'Pro-Myelocyte', 'B_cell', 'GMP', 'Hepatocytes', 'Macrophage', 'Pre-B_cell_CD34-', 'Pro-B_cell_CD34+', 'Tissue_stem_cells', 'Unknown']
라벨별 그룹 개수 {1: 28, 0: 12}
cell type :  CATTAAGGATAT_COVID19_Participant13    Epithelial_cells
GTAGAAGGGGGG_COVID19_Participant13           Platelets
ATTAAGAGGTAG_COVID19_Participant13    Epithelial_cells
AGATATGACAAG_COVID19_Participant13    Epithelial_cells
CTTGTAACAAAT_COVID19_Participant13    Epithelial_cells
                                            ...       
CGCGCCCTAGAC_Control_Participant15    Epithelial_cells
CGGACAGAATGG_Control_Participant15         Gametocytes
GTTTATTCATCA_Control_Participant15        Chondrocytes
TTTTTGTACTAT_Control_Participant15         Gametocytes
CGATTGTAGATC_Control_Participant15         Gametocytes
Name: singler_annotation, Length: 5858, dtype: string
cell type annotation :  CATTAAGGATAT_COVID19_Participant13    Epithelial_cells
GTAGAAGGGGGG_COVID19_Participant13           Platelets
ATTAAGAGGTAG_COVID19_Participant13    Epithelial_cells
AGATATGACAAG_COVID19_Participant13    Epithelial_cells
CTTGTAACAAAT_COVID19_Participant13    Epithelial_cells
                                            ...       
CGCGCCCTAGAC_Control_Participant15    Epithelial_cells
CGGACAGAATGG_Control_Participant15         Gametocytes
GTTTATTCATCA_Control_Participant15        Chondrocytes
TTTTTGTACTAT_Control_Participant15         Gametocytes
CGATTGTAGATC_Control_Participant15         Gametocytes
Name: singler_annotation, Length: 5858, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Epithelial_cells', 'Platelets', 'Keratinocytes', 'Macrophage', 'B_cell', 'Neutrophils', 'DC', 'Monocyte', 'T_cells', 'NK_cell', 'HSC_CD34+', 'Tissue_stem_cells', 'Embryonic_stem_cells', 'HSC_-G-CSF', 'Neurons', 'BM', 'Erythroblast', 'Fibroblasts', 'iPS_cells', 'Hepatocytes', 'CMP', 'Gametocytes', 'Chondrocytes', 'Endothelial_cells', 'Pre-B_cell_CD34-', 'Myelocyte', 'Astrocyte', 'Neuroepithelial_cell', 'Smooth_muscle_cells', 'GMP', 'MSC', 'Osteoblasts', 'MEP', 'BM & Prog.', 'Pro-B_cell_CD34+', 'Pro-Myelocyte']
라벨별 그룹 개수 {1: 7, 0: 3}
🔍 Split #4
  → train_p_index 환자 수 (환자 단위로 묶인 index list): 40
  → test_p_index 환자 수  (환자 단위로 묶인 index list): 10
  → train 환자 ID: ['COVID19_Participant10', 'COVID19_Participant11', 'COVID19_Participant12', 'COVID19_Participant14', 'COVID19_Participant15', 'COVID19_Participant17', 'COVID19_Participant18', 'COVID19_Participant19', 'COVID19_Participant2', 'COVID19_Participant20', 'COVID19_Participant21', 'COVID19_Participant22', 'COVID19_Participant23', 'COVID19_Participant25', 'COVID19_Participant26', 'COVID19_Participant27', 'COVID19_Participant29', 'COVID19_Participant3', 'COVID19_Participant30', 'COVID19_Participant32', 'COVID19_Participant35', 'COVID19_Participant36', 'COVID19_Participant37', 'COVID19_Participant38', 'COVID19_Participant40', 'COVID19_Participant5', 'COVID19_Participant7', 'COVID19_Participant8', 'Control_Participant10', 'Control_Participant11', 'Control_Participant12', 'Control_Participant13', 'Control_Participant14', 'Control_Participant2', 'Control_Participant3', 'Control_Participant4', 'Control_Participant5', 'Control_Participant6', 'Control_Participant7', 'Control_Participant9']
  → test  환자 ID: ['COVID19_Participant13', 'COVID19_Participant28', 'COVID19_Participant31', 'COVID19_Participant39', 'COVID19_Participant4', 'COVID19_Participant6', 'COVID19_Participant9', 'Control_Participant1', 'Control_Participant15', 'Control_Participant8']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant10, Label: 1
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant12, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant18, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant21, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant27, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant3, Label: 1
    ID: COVID19_Participant30, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant35, Label: 1
    ID: COVID19_Participant36, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant38, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: COVID19_Participant5, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: Control_Participant10, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant12, Label: 0
    ID: Control_Participant13, Label: 0
    ID: Control_Participant14, Label: 0
    ID: Control_Participant2, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant4, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant6, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant6, Label: 1
    ID: COVID19_Participant9, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant8, Label: 0
전체 데이터 index 길이 50
label_stat (train 환자 라벨 목록) 갯수 40
train_data에서 환자 단위로, train과 validation 나누기
기존 train_p_index 40
기존 (train) label_stat 40
train-vali 분할 후! 
train y 의 classes : {0, 1} valid y 의 classes : {0, 1} label_stat 의 classes : {0, 1}
train_p_index_ 26
valid_p_index 14
test_p_index 10
→ train 환자 ID 및 라벨:
   총 개수: 26
   환자ID=Control_Participant11, Label=0, 셀개수=1164
   환자ID=Control_Participant2, Label=0, 셀개수=41
   환자ID=COVID19_Participant18, Label=1, 셀개수=227
   환자ID=COVID19_Participant36, Label=1, 셀개수=200
   환자ID=COVID19_Participant10, Label=1, 셀개수=18
   환자ID=Control_Participant5, Label=0, 셀개수=717
   환자ID=COVID19_Participant14, Label=1, 셀개수=382
   환자ID=COVID19_Participant19, Label=1, 셀개수=816
   환자ID=COVID19_Participant38, Label=1, 셀개수=51
   환자ID=COVID19_Participant12, Label=1, 셀개수=102
   환자ID=COVID19_Participant2, Label=1, 셀개수=329
   환자ID=Control_Participant3, Label=0, 셀개수=1620
   환자ID=COVID19_Participant25, Label=1, 셀개수=496
   환자ID=Control_Participant7, Label=0, 셀개수=762
   환자ID=Control_Participant6, Label=0, 셀개수=131
   환자ID=COVID19_Participant15, Label=1, 셀개수=1003
   환자ID=Control_Participant9, Label=0, 셀개수=558
   환자ID=Control_Participant12, Label=0, 셀개수=99
   환자ID=COVID19_Participant21, Label=1, 셀개수=39
   환자ID=COVID19_Participant29, Label=1, 셀개수=573
   환자ID=COVID19_Participant23, Label=1, 셀개수=307
   환자ID=COVID19_Participant17, Label=1, 셀개수=843
   환자ID=COVID19_Participant5, Label=1, 셀개수=89
   환자ID=COVID19_Participant37, Label=1, 셀개수=668
   환자ID=COVID19_Participant35, Label=1, 셀개수=83
   환자ID=COVID19_Participant27, Label=1, 셀개수=93
→ valid 환자 ID 및 라벨:
   총 개수: 14
   환자ID=Control_Participant14, Label=0, 셀개수=274
   환자ID=COVID19_Participant26, Label=1, 셀개수=814
   환자ID=COVID19_Participant30, Label=1, 셀개수=116
   환자ID=COVID19_Participant3, Label=1, 셀개수=104
   환자ID=COVID19_Participant40, Label=1, 셀개수=381
   환자ID=COVID19_Participant20, Label=1, 셀개수=2033
   환자ID=Control_Participant4, Label=0, 셀개수=440
   환자ID=Control_Participant10, Label=0, 셀개수=1645
   환자ID=COVID19_Participant8, Label=1, 셀개수=462
   환자ID=COVID19_Participant7, Label=1, 셀개수=409
   환자ID=Control_Participant13, Label=0, 셀개수=88
   환자ID=COVID19_Participant32, Label=1, 셀개수=1665
   환자ID=COVID19_Participant11, Label=1, 셀개수=382
   환자ID=COVID19_Participant22, Label=1, 셀개수=865
→ test 환자 ID 및 라벨:
   총 개수: 10
   환자ID=COVID19_Participant13, Label=1, 셀개수=730
   환자ID=COVID19_Participant28, Label=1, 셀개수=1079
   환자ID=COVID19_Participant31, Label=1, 셀개수=410
   환자ID=COVID19_Participant39, Label=1, 셀개수=454
   환자ID=COVID19_Participant4, Label=1, 셀개수=1680
   환자ID=COVID19_Participant6, Label=1, 셀개수=84
   환자ID=COVID19_Participant9, Label=1, 셀개수=86
   환자ID=Control_Participant1, Label=0, 셀개수=414
   환자ID=Control_Participant15, Label=0, 셀개수=528
   환자ID=Control_Participant8, Label=0, 셀개수=393
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Keratinocytes', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Neurons', 'iPS_cells', 'Embryonic_stem_cells', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
전체 데이터 길이 26947
전체 cell type 길이 0           Keratinocytes
1        Epithelial_cells
2        Epithelial_cells
3        Epithelial_cells
4        Epithelial_cells
               ...       
26942    Epithelial_cells
26943         Gametocytes
26944        Chondrocytes
26945         Gametocytes
26946         Gametocytes
Length: 26947, dtype: string
cell type의 NaN 개수 체크 0
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:10,  9.04it/s]  2%|▏         | 2/100 [00:00<00:13,  7.35it/s]  3%|▎         | 3/100 [00:00<00:11,  8.08it/s]  5%|▌         | 5/100 [00:00<00:11,  8.41it/s]  6%|▌         | 6/100 [00:00<00:11,  8.26it/s]  7%|▋         | 7/100 [00:00<00:15,  6.16it/s]  8%|▊         | 8/100 [00:01<00:13,  6.80it/s] 10%|█         | 10/100 [00:01<00:12,  7.42it/s] 11%|█         | 11/100 [00:01<00:11,  7.62it/s] 12%|█▏        | 12/100 [00:01<00:11,  7.88it/s] 13%|█▎        | 13/100 [00:01<00:11,  7.80it/s] 14%|█▍        | 14/100 [00:01<00:10,  8.15it/s] 15%|█▌        | 15/100 [00:01<00:09,  8.52it/s] 16%|█▌        | 16/100 [00:02<00:09,  8.68it/s] 17%|█▋        | 17/100 [00:02<00:09,  8.68it/s] 18%|█▊        | 18/100 [00:02<00:09,  8.64it/s] 20%|██        | 20/100 [00:02<00:08,  9.33it/s] 21%|██        | 21/100 [00:02<00:08,  9.43it/s] 23%|██▎       | 23/100 [00:02<00:07,  9.71it/s] 24%|██▍       | 24/100 [00:02<00:08,  9.40it/s] 25%|██▌       | 25/100 [00:02<00:08,  9.35it/s] 26%|██▌       | 26/100 [00:03<00:08,  9.21it/s] 27%|██▋       | 27/100 [00:03<00:08,  8.70it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.46it/s] 29%|██▉       | 29/100 [00:03<00:08,  8.66it/s] 30%|███       | 30/100 [00:03<00:08,  8.33it/s] 31%|███       | 31/100 [00:03<00:11,  6.05it/s] 32%|███▏      | 32/100 [00:03<00:10,  6.71it/s] 33%|███▎      | 33/100 [00:04<00:09,  7.34it/s] 34%|███▍      | 34/100 [00:04<00:08,  7.94it/s] 35%|███▌      | 35/100 [00:04<00:08,  7.73it/s] 36%|███▌      | 36/100 [00:04<00:11,  5.60it/s] 37%|███▋      | 37/100 [00:04<00:10,  6.15it/s] 38%|███▊      | 38/100 [00:04<00:09,  6.61it/s] 39%|███▉      | 39/100 [00:04<00:08,  7.35it/s] 40%|████      | 40/100 [00:05<00:08,  7.41it/s] 41%|████      | 41/100 [00:05<00:07,  7.59it/s] 42%|████▏     | 42/100 [00:05<00:07,  7.97it/s] 43%|████▎     | 43/100 [00:05<00:07,  8.14it/s] 44%|████▍     | 44/100 [00:05<00:06,  8.58it/s] 45%|████▌     | 45/100 [00:05<00:06,  8.74it/s] 46%|████▌     | 46/100 [00:05<00:06,  8.90it/s] 47%|████▋     | 47/100 [00:05<00:05,  9.04it/s] 48%|████▊     | 48/100 [00:05<00:05,  8.97it/s] 49%|████▉     | 49/100 [00:06<00:06,  8.35it/s] 50%|█████     | 50/100 [00:06<00:06,  7.73it/s] 51%|█████     | 51/100 [00:06<00:06,  7.91it/s] 53%|█████▎    | 53/100 [00:06<00:05,  8.33it/s] 54%|█████▍    | 54/100 [00:06<00:05,  8.66it/s] 55%|█████▌    | 55/100 [00:06<00:05,  8.61it/s] 56%|█████▌    | 56/100 [00:06<00:04,  8.86it/s] 57%|█████▋    | 57/100 [00:07<00:04,  9.14it/s] 58%|█████▊    | 58/100 [00:07<00:05,  8.04it/s] 59%|█████▉    | 59/100 [00:07<00:04,  8.26it/s] 60%|██████    | 60/100 [00:07<00:04,  8.49it/s] 61%|██████    | 61/100 [00:07<00:04,  8.16it/s] 62%|██████▏   | 62/100 [00:07<00:04,  8.34it/s] 63%|██████▎   | 63/100 [00:07<00:04,  8.50it/s] 64%|██████▍   | 64/100 [00:07<00:04,  8.51it/s] 65%|██████▌   | 65/100 [00:08<00:04,  8.44it/s] 66%|██████▌   | 66/100 [00:08<00:04,  7.74it/s] 67%|██████▋   | 67/100 [00:08<00:04,  8.03it/s] 69%|██████▉   | 69/100 [00:08<00:03,  8.68it/s] 70%|███████   | 70/100 [00:08<00:03,  8.53it/s] 71%|███████   | 71/100 [00:08<00:03,  8.47it/s] 72%|███████▏  | 72/100 [00:08<00:03,  8.30it/s] 73%|███████▎  | 73/100 [00:08<00:03,  8.46it/s] 74%|███████▍  | 74/100 [00:09<00:03,  8.00it/s] 75%|███████▌  | 75/100 [00:09<00:03,  7.66it/s] 76%|███████▌  | 76/100 [00:09<00:03,  7.96it/s] 77%|███████▋  | 77/100 [00:09<00:02,  8.13it/s] 78%|███████▊  | 78/100 [00:09<00:02,  8.57it/s] 79%|███████▉  | 79/100 [00:09<00:02,  8.40it/s] 80%|████████  | 80/100 [00:10<00:03,  5.95it/s] 81%|████████  | 81/100 [00:10<00:02,  6.38it/s] 82%|████████▏ | 82/100 [00:10<00:02,  6.92it/s] 83%|████████▎ | 83/100 [00:10<00:02,  7.13it/s] 84%|████████▍ | 84/100 [00:10<00:02,  7.18it/s] 85%|████████▌ | 85/100 [00:10<00:01,  7.60it/s] 86%|████████▌ | 86/100 [00:10<00:01,  7.83it/s] 88%|████████▊ | 88/100 [00:10<00:01,  8.44it/s] 89%|████████▉ | 89/100 [00:11<00:01,  8.23it/s] 90%|█████████ | 90/100 [00:11<00:01,  8.25it/s] 91%|█████████ | 91/100 [00:11<00:01,  8.28it/s] 92%|█████████▏| 92/100 [00:11<00:01,  7.73it/s] 93%|█████████▎| 93/100 [00:11<00:00,  8.02it/s] 94%|█████████▍| 94/100 [00:11<00:00,  8.00it/s] 95%|█████████▌| 95/100 [00:11<00:00,  8.20it/s] 96%|█████████▌| 96/100 [00:11<00:00,  8.03it/s] 97%|█████████▋| 97/100 [00:12<00:00,  8.11it/s] 98%|█████████▊| 98/100 [00:12<00:00,  8.22it/s] 99%|█████████▉| 99/100 [00:12<00:00,  8.29it/s]100%|██████████| 100/100 [00:12<00:00,  8.52it/s]100%|██████████| 100/100 [00:12<00:00,  8.03it/s]
[I 2025-08-31 16:59:24,009] A new study created in memory with name: no-name-a75ae24a-9c02-43e1-8f72-e45d089cb3e5
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 25.64 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.627850, Valid_loss 0.587331
Epoch 2, Train Loss 0.575818, Valid_loss 0.485782
Epoch 3, Train Loss 0.498747, Valid_loss 0.432772
Epoch 4, Train Loss 0.500622, Valid_loss 0.436506
Epoch 5, Train Loss 0.391307, Valid_loss 0.462393
Epoch 6, Train Loss 0.388404, Valid_loss 0.457530
Epoch 7, Train Loss 0.377608, Valid_loss 0.435391
Epoch 8, Train Loss 0.363511, Valid_loss 0.400570
Epoch 9, Train Loss 0.342852, Valid_loss 0.603005
Epoch 10, Train Loss 0.327183, Valid_loss 0.437633
Epoch 11, Train Loss 0.291257, Valid_loss 0.519816
Epoch 12, Train Loss 0.291833, Valid_loss 0.441575
Epoch 13, Train Loss 0.303410, Valid_loss 0.428928
Epoch 14, Train Loss 0.283955, Valid_loss 0.356766
Epoch 15, Train Loss 0.286135, Valid_loss 0.348444
Epoch 16, Train Loss 0.265197, Valid_loss 0.396624
Epoch 17, Train Loss 0.254841, Valid_loss 0.308589
Epoch 18, Train Loss 0.238892, Valid_loss 0.382346
Epoch 19, Train Loss 0.231602, Valid_loss 0.376051
Epoch 20, Train Loss 0.238623, Valid_loss 0.409657
Epoch 21, Train Loss 0.324982, Valid_loss 0.510167
Epoch 22, Train Loss 0.276322, Valid_loss 0.378308
Epoch 23, Train Loss 0.246986, Valid_loss 0.493459
Epoch 24, Train Loss 0.250169, Valid_loss 0.342135
Epoch 25, Train Loss 0.228909, Valid_loss 0.333421
Epoch 26, Train Loss 0.246014, Valid_loss 0.383363
Epoch 27, Train Loss 0.225567, Valid_loss 0.328511
Epoch 28, Train Loss 0.228532, Valid_loss 0.353687
Epoch 29, Train Loss 0.276105, Valid_loss 0.366204
Epoch 30, Train Loss 0.242603, Valid_loss 0.307210
Epoch 31, Train Loss 0.248148, Valid_loss 0.413358
Epoch 32, Train Loss 0.280695, Valid_loss 0.437764
Epoch 33, Train Loss 0.245376, Valid_loss 0.508836
Epoch 34, Train Loss 0.228554, Valid_loss 0.339841
Epoch 35, Train Loss 0.243786, Valid_loss 0.358976
Epoch 36, Train Loss 0.249867, Valid_loss 0.354489
Epoch 37, Train Loss 0.222280, Valid_loss 0.354200
Epoch 38, Train Loss 0.221012, Valid_loss 0.361927
Epoch 39, Train Loss 0.222255, Valid_loss 0.330713
Epoch 40, Train Loss 0.248682, Valid_loss 0.407412
Epoch 41, Train Loss 0.234912, Valid_loss 0.422956
Epoch 42, Train Loss 0.236435, Valid_loss 0.411811
Epoch 43, Train Loss 0.237184, Valid_loss 0.380743
Epoch 44, Train Loss 0.217773, Valid_loss 0.378523
Epoch 45, Train Loss 0.213450, Valid_loss 0.412768
Epoch 46, Train Loss 0.208104, Valid_loss 0.383643
Epoch 47, Train Loss 0.224086, Valid_loss 0.409232
Epoch 48, Train Loss 0.208651, Valid_loss 0.446588
Epoch 49, Train Loss 0.221594, Valid_loss 0.392010
Epoch 50, Train Loss 0.202421, Valid_loss 0.373641
Epoch 51, Train Loss 0.214997, Valid_loss 0.382158
Epoch 52, Train Loss 0.191892, Valid_loss 0.360505
Epoch 53, Train Loss 0.204938, Valid_loss 0.386013
Epoch 54, Train Loss 0.204177, Valid_loss 0.383589
Epoch 55, Train Loss 0.218460, Valid_loss 0.380740
Epoch 56, Train Loss 0.190958, Valid_loss 0.362481
Epoch 57, Train Loss 0.206278, Valid_loss 0.404999
Epoch 58, Train Loss 0.214161, Valid_loss 0.370277
Epoch 59, Train Loss 0.194983, Valid_loss 0.386098
Epoch 60, Train Loss 0.211666, Valid_loss 0.389211
[I 2025-08-31 17:03:25,216] Trial 0 finished with value: 0.30720974722810623 and parameters: {'learning_rate': 0.01, 'epochs': 100, 'heads': 2, 'dropout': 0.3, 'weight_decay': 0.0001, 'emb_dim': 8, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.30720974722810623.
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 26.96 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.611190, Valid_loss 0.567076
Epoch 2, Train Loss 0.586445, Valid_loss 0.526219
Epoch 3, Train Loss 0.528629, Valid_loss 0.456008
Epoch 4, Train Loss 0.486262, Valid_loss 0.417212
Epoch 5, Train Loss 0.448388, Valid_loss 0.400699
Epoch 6, Train Loss 0.418615, Valid_loss 0.378954
Epoch 7, Train Loss 0.397147, Valid_loss 0.363232
Epoch 8, Train Loss 0.403947, Valid_loss 0.422988
Epoch 9, Train Loss 0.389873, Valid_loss 0.392974
Epoch 10, Train Loss 0.385148, Valid_loss 0.373599
Epoch 11, Train Loss 0.385270, Valid_loss 0.365510
Epoch 12, Train Loss 0.381306, Valid_loss 0.366548
Epoch 13, Train Loss 0.364199, Valid_loss 0.345484
Epoch 14, Train Loss 0.357340, Valid_loss 0.435435
Epoch 15, Train Loss 0.358792, Valid_loss 0.344170
Epoch 16, Train Loss 0.368872, Valid_loss 0.355447
Epoch 17, Train Loss 0.353200, Valid_loss 0.331174
Epoch 18, Train Loss 0.364281, Valid_loss 0.427422
Epoch 19, Train Loss 0.351200, Valid_loss 0.379655
Epoch 20, Train Loss 0.336108, Valid_loss 0.360800
Epoch 21, Train Loss 0.348018, Valid_loss 0.342374
Epoch 22, Train Loss 0.342053, Valid_loss 0.373483
Epoch 23, Train Loss 0.341958, Valid_loss 0.369731
Epoch 24, Train Loss 0.339798, Valid_loss 0.313196
Epoch 25, Train Loss 0.324918, Valid_loss 0.352104
Epoch 26, Train Loss 0.320360, Valid_loss 0.441968
Epoch 27, Train Loss 0.321942, Valid_loss 0.363259
Epoch 28, Train Loss 0.334552, Valid_loss 0.337701
Epoch 29, Train Loss 0.341735, Valid_loss 0.395795
Epoch 30, Train Loss 0.323937, Valid_loss 0.408195
Epoch 31, Train Loss 0.321478, Valid_loss 0.321475
Epoch 32, Train Loss 0.317813, Valid_loss 0.367464
Epoch 33, Train Loss 0.320400, Valid_loss 0.407693
Epoch 34, Train Loss 0.316521, Valid_loss 0.381609
Epoch 35, Train Loss 0.309459, Valid_loss 0.357346
Epoch 36, Train Loss 0.329974, Valid_loss 0.410254
Epoch 37, Train Loss 0.317271, Valid_loss 0.348038
Epoch 38, Train Loss 0.309090, Valid_loss 0.341959
Epoch 39, Train Loss 0.320004, Valid_loss 0.349388
Epoch 40, Train Loss 0.312320, Valid_loss 0.331485
Epoch 41, Train Loss 0.305602, Valid_loss 0.376273
Epoch 42, Train Loss 0.299504, Valid_loss 0.366325
Epoch 43, Train Loss 0.308188, Valid_loss 0.332959
Epoch 44, Train Loss 0.311831, Valid_loss 0.308167
Epoch 45, Train Loss 0.309688, Valid_loss 0.349274
Epoch 46, Train Loss 0.307862, Valid_loss 0.436496
Epoch 47, Train Loss 0.312622, Valid_loss 0.373674
Epoch 48, Train Loss 0.307357, Valid_loss 0.324669
Epoch 49, Train Loss 0.309047, Valid_loss 0.336224
Epoch 50, Train Loss 0.299665, Valid_loss 0.403380
Epoch 51, Train Loss 0.299554, Valid_loss 0.363261
Epoch 52, Train Loss 0.295482, Valid_loss 0.398545
Epoch 53, Train Loss 0.304453, Valid_loss 0.386239
Epoch 54, Train Loss 0.292195, Valid_loss 0.362521
Epoch 55, Train Loss 0.311851, Valid_loss 0.348317
Epoch 56, Train Loss 0.301696, Valid_loss 0.373168
Epoch 57, Train Loss 0.291478, Valid_loss 0.358725
Epoch 58, Train Loss 0.303100, Valid_loss 0.377075
Epoch 59, Train Loss 0.295147, Valid_loss 0.353884
Epoch 60, Train Loss 0.301993, Valid_loss 0.410209
Epoch 61, Train Loss 0.288478, Valid_loss 0.353340
Epoch 62, Train Loss 0.297070, Valid_loss 0.420396
Epoch 63, Train Loss 0.305599, Valid_loss 0.366010
Epoch 64, Train Loss 0.304282, Valid_loss 0.342884
Epoch 65, Train Loss 0.295751, Valid_loss 0.386863
Epoch 66, Train Loss 0.307325, Valid_loss 0.337097
Epoch 67, Train Loss 0.317152, Valid_loss 0.415570
Epoch 68, Train Loss 0.293581, Valid_loss 0.366114
Epoch 69, Train Loss 0.295277, Valid_loss 0.360471
Epoch 70, Train Loss 0.289631, Valid_loss 0.375821
Epoch 71, Train Loss 0.297003, Valid_loss 0.356080
Epoch 72, Train Loss 0.292252, Valid_loss 0.412673
Epoch 73, Train Loss 0.293748, Valid_loss 0.338060
Epoch 74, Train Loss 0.279101, Valid_loss 0.413768
Epoch 75, Train Loss 0.292187, Valid_loss 0.392327
Epoch 76, Train Loss 0.291749, Valid_loss 0.365179
Epoch 77, Train Loss 0.297180, Valid_loss 0.348056
Epoch 78, Train Loss 0.286990, Valid_loss 0.388420
Epoch 79, Train Loss 0.289330, Valid_loss 0.343223
Epoch 80, Train Loss 0.294870, Valid_loss 0.368889
Epoch 81, Train Loss 0.287050, Valid_loss 0.352417
Epoch 82, Train Loss 0.291957, Valid_loss 0.426929
Epoch 83, Train Loss 0.290420, Valid_loss 0.350912
Epoch 84, Train Loss 0.282851, Valid_loss 0.369404
Epoch 85, Train Loss 0.294482, Valid_loss 0.387191
[I 2025-08-31 17:10:01,116] Trial 1 finished with value: 0.30816719627806116 and parameters: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 4, 'dropout': 0.3, 'weight_decay': 0.01, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.30720974722810623.
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 26.96 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.629582, Valid_loss 0.480808
Epoch 2, Train Loss 0.517542, Valid_loss 0.433486
Epoch 3, Train Loss 0.409948, Valid_loss 0.395366
Epoch 4, Train Loss 0.411042, Valid_loss 0.417688
Epoch 5, Train Loss 0.385296, Valid_loss 0.412126
Epoch 6, Train Loss 0.363880, Valid_loss 0.392079
Epoch 7, Train Loss 0.369617, Valid_loss 0.483909
Epoch 8, Train Loss 0.350235, Valid_loss 0.350132
Epoch 9, Train Loss 0.335692, Valid_loss 0.325353
Epoch 10, Train Loss 0.320971, Valid_loss 0.347258
Epoch 11, Train Loss 0.327196, Valid_loss 0.323650
Epoch 12, Train Loss 0.311423, Valid_loss 0.301685
Epoch 13, Train Loss 0.304647, Valid_loss 0.346389
Epoch 14, Train Loss 0.282716, Valid_loss 0.381529
Epoch 15, Train Loss 0.295850, Valid_loss 0.391780
Epoch 16, Train Loss 0.311377, Valid_loss 0.462201
Epoch 17, Train Loss 0.281916, Valid_loss 0.362969
Epoch 18, Train Loss 0.272158, Valid_loss 0.330705
Epoch 19, Train Loss 0.261400, Valid_loss 0.365442
Epoch 20, Train Loss 0.274462, Valid_loss 0.369026
Epoch 21, Train Loss 0.259524, Valid_loss 0.352558
Epoch 22, Train Loss 0.269729, Valid_loss 0.398773
Epoch 23, Train Loss 0.242596, Valid_loss 0.392676
Epoch 24, Train Loss 0.265996, Valid_loss 0.333604
Epoch 25, Train Loss 0.244460, Valid_loss 0.312986
Epoch 26, Train Loss 0.269069, Valid_loss 0.333740
Epoch 27, Train Loss 0.240771, Valid_loss 0.324551
Epoch 28, Train Loss 0.240876, Valid_loss 0.368217
Epoch 29, Train Loss 0.234752, Valid_loss 0.367760
Epoch 30, Train Loss 0.239216, Valid_loss 0.322831
Epoch 31, Train Loss 0.232856, Valid_loss 0.345850
Epoch 32, Train Loss 0.225477, Valid_loss 0.347362
Epoch 33, Train Loss 0.226973, Valid_loss 0.328275
Epoch 34, Train Loss 0.225968, Valid_loss 0.315069
Epoch 35, Train Loss 0.231262, Valid_loss 0.395803
Epoch 36, Train Loss 0.223481, Valid_loss 0.385984
Epoch 37, Train Loss 0.231497, Valid_loss 0.416472
Epoch 38, Train Loss 0.232930, Valid_loss 0.436719
Epoch 39, Train Loss 0.238221, Valid_loss 0.341548
Epoch 40, Train Loss 0.223001, Valid_loss 0.297015
Epoch 41, Train Loss 0.229913, Valid_loss 0.308119
Epoch 42, Train Loss 0.215343, Valid_loss 0.294439
Epoch 43, Train Loss 0.225508, Valid_loss 0.319036
Epoch 44, Train Loss 0.217670, Valid_loss 0.437894
Epoch 45, Train Loss 0.226388, Valid_loss 0.312988
Epoch 46, Train Loss 0.217847, Valid_loss 0.301184
Epoch 47, Train Loss 0.225205, Valid_loss 0.303520
Epoch 48, Train Loss 0.243187, Valid_loss 0.337712
Epoch 49, Train Loss 0.228276, Valid_loss 0.362173
Epoch 50, Train Loss 0.224359, Valid_loss 0.324056
Epoch 51, Train Loss 0.209525, Valid_loss 0.387611
Epoch 52, Train Loss 0.218617, Valid_loss 0.333270
Epoch 53, Train Loss 0.217831, Valid_loss 0.334626
Epoch 54, Train Loss 0.214069, Valid_loss 0.357676
[I 2025-08-31 17:13:22,716] Trial 2 finished with value: 0.2944392828004701 and parameters: {'learning_rate': 0.001, 'epochs': 100, 'heads': 1, 'dropout': 0.5, 'weight_decay': 0.0001, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 2 with value: 0.2944392828004701.
선택된 trial params: {'learning_rate': 0.001, 'epochs': 100, 'heads': 1, 'dropout': 0.5, 'weight_decay': 0.0001, 'emb_dim': 32, 'augment_num': 100, 'pca': False}
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=10, batch_size=1 -> steps=10
output_class :  1
Memory Allocated: 26.96 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.641427, Valid_loss 0.534338
Epoch 2, Train Loss 0.512033, Valid_loss 0.421811
Epoch 3, Train Loss 0.423577, Valid_loss 0.404266
Epoch 4, Train Loss 0.396618, Valid_loss 0.483877
Epoch 5, Train Loss 0.403878, Valid_loss 0.407618
Epoch 6, Train Loss 0.390791, Valid_loss 0.369250
Epoch 7, Train Loss 0.369399, Valid_loss 0.493191
Epoch 8, Train Loss 0.343725, Valid_loss 0.428960
Epoch 9, Train Loss 0.322108, Valid_loss 0.377321
Epoch 10, Train Loss 0.349430, Valid_loss 0.357830
Epoch 11, Train Loss 0.331090, Valid_loss 0.378421
Epoch 12, Train Loss 0.344172, Valid_loss 0.336230
Epoch 13, Train Loss 0.324419, Valid_loss 0.422427
Epoch 14, Train Loss 0.286838, Valid_loss 0.470967
Epoch 15, Train Loss 0.289755, Valid_loss 0.344736
Epoch 16, Train Loss 0.300644, Valid_loss 0.297021
Epoch 17, Train Loss 0.303972, Valid_loss 0.442813
Epoch 18, Train Loss 0.273927, Valid_loss 0.426914
Epoch 19, Train Loss 0.282403, Valid_loss 0.377506
Epoch 20, Train Loss 0.263921, Valid_loss 0.434872
Epoch 21, Train Loss 0.268621, Valid_loss 0.364469
Epoch 22, Train Loss 0.280052, Valid_loss 0.345922
Epoch 23, Train Loss 0.270259, Valid_loss 0.325451
Epoch 24, Train Loss 0.272039, Valid_loss 0.303718
Epoch 25, Train Loss 0.265148, Valid_loss 0.283535
Epoch 26, Train Loss 0.248972, Valid_loss 0.317149
Epoch 27, Train Loss 0.254436, Valid_loss 0.320247
Epoch 28, Train Loss 0.257875, Valid_loss 0.318244
Epoch 29, Train Loss 0.246124, Valid_loss 0.337689
Epoch 30, Train Loss 0.241729, Valid_loss 0.329051
Epoch 31, Train Loss 0.239423, Valid_loss 0.368885
Epoch 32, Train Loss 0.245037, Valid_loss 0.371133
Epoch 33, Train Loss 0.230216, Valid_loss 0.322424
Epoch 34, Train Loss 0.247510, Valid_loss 0.343342
Epoch 35, Train Loss 0.238139, Valid_loss 0.338562
Epoch 36, Train Loss 0.237979, Valid_loss 0.305792
Epoch 37, Train Loss 0.228275, Valid_loss 0.319490
Epoch 38, Train Loss 0.227821, Valid_loss 0.504289
Epoch 39, Train Loss 0.233721, Valid_loss 0.359956
Epoch 40, Train Loss 0.217650, Valid_loss 0.341715
Epoch 41, Train Loss 0.211916, Valid_loss 0.377456
Epoch 42, Train Loss 0.216173, Valid_loss 0.316718
Epoch 43, Train Loss 0.217230, Valid_loss 0.323785
Epoch 44, Train Loss 0.218737, Valid_loss 0.406447
Epoch 45, Train Loss 0.213419, Valid_loss 0.359443
Epoch 46, Train Loss 0.210356, Valid_loss 0.393989
Epoch 47, Train Loss 0.215037, Valid_loss 0.354004
Epoch 48, Train Loss 0.229965, Valid_loss 0.377765
Epoch 49, Train Loss 0.224204, Valid_loss 0.386017
Epoch 50, Train Loss 0.213224, Valid_loss 0.338049
Epoch 51, Train Loss 0.210994, Valid_loss 0.334819
Epoch 52, Train Loss 0.209188, Valid_loss 0.318026
Epoch 53, Train Loss 0.211753, Valid_loss 0.317332
Epoch 54, Train Loss 0.218493, Valid_loss 0.396227
Epoch 55, Train Loss 0.203328, Valid_loss 0.331626
Epoch 56, Train Loss 0.208891, Valid_loss 0.336626
Epoch 57, Train Loss 0.202069, Valid_loss 0.326146
Epoch 58, Train Loss 0.201426, Valid_loss 0.332689
Epoch 59, Train Loss 0.209622, Valid_loss 0.381088
환자ID=COVID19_Participant13 -- true: 1 -- pred: 1
환자ID=COVID19_Participant28 -- true: 1 -- pred: 1
환자ID=COVID19_Participant31 -- true: 1 -- pred: 0
환자ID=COVID19_Participant39 -- true: 1 -- pred: 1
환자ID=COVID19_Participant4 -- true: 1 -- pred: 1
환자ID=COVID19_Participant6 -- true: 1 -- pred: 1
환자ID=COVID19_Participant9 -- true: 1 -- pred: 1
환자ID=Control_Participant1 -- true: 0 -- pred: 1
환자ID=Control_Participant15 -- true: 0 -- pred: 0
환자ID=Control_Participant8 -- true: 0 -- pred: 0
Best performance: Epoch 25, Loss 0.265148, Test ACC 0.800000, Test AUC 0.952381, Test Recall 0.857143, Test Precision 0.857143
Confusion Matrix:
 [2 1 1 6]
✅ Total valid splits used: 4
🔁 Repeat 1, Fold 4
cell type :  GTCGGGGGGTGG_Control_Participant7        Keratinocytes
CAAATCAATTAT_Control_Participant7     Epithelial_cells
ATACAATTGACA_Control_Participant7     Epithelial_cells
CTGTTAATGAGA_Control_Participant7     Epithelial_cells
CTTCACATTATT_Control_Participant7     Epithelial_cells
                                            ...       
GCAGGGAACTCC_COVID19_Participant30    Epithelial_cells
CAGCACCGAGCC_COVID19_Participant30    Epithelial_cells
GCCCCTTGTGAT_COVID19_Participant30    Epithelial_cells
GTGTTGTGTGTC_COVID19_Participant30              B_cell
TAACACTCACTT_COVID19_Participant30           Myelocyte
Name: singler_annotation, Length: 20367, dtype: string
cell type annotation :  GTCGGGGGGTGG_Control_Participant7        Keratinocytes
CAAATCAATTAT_Control_Participant7     Epithelial_cells
ATACAATTGACA_Control_Participant7     Epithelial_cells
CTGTTAATGAGA_Control_Participant7     Epithelial_cells
CTTCACATTATT_Control_Participant7     Epithelial_cells
                                            ...       
GCAGGGAACTCC_COVID19_Participant30    Epithelial_cells
CAGCACCGAGCC_COVID19_Participant30    Epithelial_cells
GCCCCTTGTGAT_COVID19_Participant30    Epithelial_cells
GTGTTGTGTGTC_COVID19_Participant30              B_cell
TAACACTCACTT_COVID19_Participant30           Myelocyte
Name: singler_annotation, Length: 20367, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Keratinocytes', 'Epithelial_cells', 'Neurons', 'iPS_cells', 'Embryonic_stem_cells', 'Astrocyte', 'DC', 'Gametocytes', 'HSC_-G-CSF', 'Smooth_muscle_cells', 'BM & Prog.', 'Monocyte', 'Myelocyte', 'BM', 'Endothelial_cells', 'Osteoblasts', 'Platelets', 'Erythroblast', 'NK_cell', 'T_cells', 'Chondrocytes', 'HSC_CD34+', 'CMP', 'Neutrophils', 'Fibroblasts', 'MEP', 'Neuroepithelial_cell', 'MSC', 'Pro-Myelocyte', 'B_cell', 'GMP', 'Hepatocytes', 'Macrophage', 'Tissue_stem_cells', 'Pre-B_cell_CD34-', 'Pro-B_cell_CD34+', 'Unknown']
라벨별 그룹 개수 {1: 28, 0: 12}
cell type :  TGGGATTACAGG_COVID19_Participant10         Gametocytes
AACCGTGGTCAT_COVID19_Participant10    Epithelial_cells
TAAGCCTGCGGA_COVID19_Participant10    Epithelial_cells
CTACCCAGACAC_COVID19_Participant10    Epithelial_cells
CGTCTACATCTT_COVID19_Participant10    Epithelial_cells
                                            ...       
ACCATATTCAGG_COVID19_Participant21       Keratinocytes
GCCCGTTTCACG_COVID19_Participant21    Epithelial_cells
TATTATCTCTTA_COVID19_Participant21    Epithelial_cells
TTCCGTTTGTCC_COVID19_Participant21    Epithelial_cells
TCGGGATTGGAT_COVID19_Participant21         Neutrophils
Name: singler_annotation, Length: 6580, dtype: string
cell type annotation :  TGGGATTACAGG_COVID19_Participant10         Gametocytes
AACCGTGGTCAT_COVID19_Participant10    Epithelial_cells
TAAGCCTGCGGA_COVID19_Participant10    Epithelial_cells
CTACCCAGACAC_COVID19_Participant10    Epithelial_cells
CGTCTACATCTT_COVID19_Participant10    Epithelial_cells
                                            ...       
ACCATATTCAGG_COVID19_Participant21       Keratinocytes
GCCCGTTTCACG_COVID19_Participant21    Epithelial_cells
TATTATCTCTTA_COVID19_Participant21    Epithelial_cells
TTCCGTTTGTCC_COVID19_Participant21    Epithelial_cells
TCGGGATTGGAT_COVID19_Participant21         Neutrophils
Name: singler_annotation, Length: 6580, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Gametocytes', 'Epithelial_cells', 'Neurons', 'T_cells', 'Keratinocytes', 'NK_cell', 'Neutrophils', 'Platelets', 'DC', 'Monocyte', 'CMP', 'Macrophage', 'HSC_-G-CSF', 'BM & Prog.', 'Chondrocytes', 'Myelocyte', 'Erythroblast', 'Neuroepithelial_cell', 'Pre-B_cell_CD34-', 'Smooth_muscle_cells', 'Endothelial_cells', 'MSC', 'Astrocyte', 'Pro-B_cell_CD34+', 'GMP', 'Hepatocytes', 'Embryonic_stem_cells', 'Pro-Myelocyte', 'HSC_CD34+', 'BM', 'B_cell', 'MEP', 'Fibroblasts', 'Tissue_stem_cells', 'Osteoblasts', 'Unknown', 'iPS_cells']
라벨별 그룹 개수 {1: 7, 0: 3}
🔍 Split #5
  → train_p_index 환자 수 (환자 단위로 묶인 index list): 40
  → test_p_index 환자 수  (환자 단위로 묶인 index list): 10
  → train 환자 ID: ['COVID19_Participant11', 'COVID19_Participant12', 'COVID19_Participant13', 'COVID19_Participant14', 'COVID19_Participant17', 'COVID19_Participant19', 'COVID19_Participant2', 'COVID19_Participant20', 'COVID19_Participant22', 'COVID19_Participant23', 'COVID19_Participant25', 'COVID19_Participant26', 'COVID19_Participant27', 'COVID19_Participant28', 'COVID19_Participant29', 'COVID19_Participant3', 'COVID19_Participant30', 'COVID19_Participant31', 'COVID19_Participant36', 'COVID19_Participant37', 'COVID19_Participant38', 'COVID19_Participant39', 'COVID19_Participant4', 'COVID19_Participant40', 'COVID19_Participant5', 'COVID19_Participant6', 'COVID19_Participant7', 'COVID19_Participant9', 'Control_Participant1', 'Control_Participant12', 'Control_Participant13', 'Control_Participant15', 'Control_Participant2', 'Control_Participant3', 'Control_Participant4', 'Control_Participant5', 'Control_Participant6', 'Control_Participant7', 'Control_Participant8', 'Control_Participant9']
  → test  환자 ID: ['COVID19_Participant10', 'COVID19_Participant15', 'COVID19_Participant18', 'COVID19_Participant21', 'COVID19_Participant32', 'COVID19_Participant35', 'COVID19_Participant8', 'Control_Participant10', 'Control_Participant11', 'Control_Participant14']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant12, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant27, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant3, Label: 1
    ID: COVID19_Participant30, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant36, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant38, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: COVID19_Participant5, Label: 1
    ID: COVID19_Participant6, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: COVID19_Participant9, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant12, Label: 0
    ID: Control_Participant13, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant2, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant4, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant6, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant8, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: COVID19_Participant10, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant18, Label: 1
    ID: COVID19_Participant21, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant35, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: Control_Participant10, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant14, Label: 0
전체 데이터 index 길이 50
label_stat (train 환자 라벨 목록) 갯수 40
train_data에서 환자 단위로, train과 validation 나누기
기존 train_p_index 40
기존 (train) label_stat 40
train-vali 분할 후! 
train y 의 classes : {0, 1} valid y 의 classes : {0, 1} label_stat 의 classes : {0, 1}
train_p_index_ 26
valid_p_index 14
test_p_index 10
→ train 환자 ID 및 라벨:
   총 개수: 26
   환자ID=Control_Participant12, Label=0, 셀개수=99
   환자ID=Control_Participant3, Label=0, 셀개수=1620
   환자ID=COVID19_Participant2, Label=1, 셀개수=329
   환자ID=COVID19_Participant39, Label=1, 셀개수=454
   환자ID=COVID19_Participant11, Label=1, 셀개수=382
   환자ID=Control_Participant6, Label=0, 셀개수=131
   환자ID=COVID19_Participant14, Label=1, 셀개수=382
   환자ID=COVID19_Participant20, Label=1, 셀개수=2033
   환자ID=COVID19_Participant40, Label=1, 셀개수=381
   환자ID=COVID19_Participant13, Label=1, 셀개수=730
   환자ID=COVID19_Participant22, Label=1, 셀개수=865
   환자ID=Control_Participant4, Label=0, 셀개수=440
   환자ID=COVID19_Participant28, Label=1, 셀개수=1079
   환자ID=Control_Participant8, Label=0, 셀개수=393
   환자ID=Control_Participant7, Label=0, 셀개수=762
   환자ID=COVID19_Participant17, Label=1, 셀개수=843
   환자ID=Control_Participant9, Label=0, 셀개수=558
   환자ID=Control_Participant13, Label=0, 셀개수=88
   환자ID=COVID19_Participant25, Label=1, 셀개수=496
   환자ID=COVID19_Participant30, Label=1, 셀개수=116
   환자ID=COVID19_Participant27, Label=1, 셀개수=93
   환자ID=COVID19_Participant19, Label=1, 셀개수=816
   환자ID=COVID19_Participant6, Label=1, 셀개수=84
   환자ID=COVID19_Participant4, Label=1, 셀개수=1680
   환자ID=COVID19_Participant38, Label=1, 셀개수=51
   환자ID=COVID19_Participant3, Label=1, 셀개수=104
→ valid 환자 ID 및 라벨:
   총 개수: 14
   환자ID=Control_Participant2, Label=0, 셀개수=41
   환자ID=COVID19_Participant29, Label=1, 셀개수=573
   환자ID=COVID19_Participant36, Label=1, 셀개수=200
   환자ID=COVID19_Participant31, Label=1, 셀개수=410
   환자ID=COVID19_Participant5, Label=1, 셀개수=89
   환자ID=COVID19_Participant23, Label=1, 셀개수=307
   환자ID=Control_Participant5, Label=0, 셀개수=717
   환자ID=Control_Participant1, Label=0, 셀개수=414
   환자ID=COVID19_Participant9, Label=1, 셀개수=86
   환자ID=COVID19_Participant7, Label=1, 셀개수=409
   환자ID=Control_Participant15, Label=0, 셀개수=528
   환자ID=COVID19_Participant37, Label=1, 셀개수=668
   환자ID=COVID19_Participant12, Label=1, 셀개수=102
   환자ID=COVID19_Participant26, Label=1, 셀개수=814
→ test 환자 ID 및 라벨:
   총 개수: 10
   환자ID=COVID19_Participant10, Label=1, 셀개수=18
   환자ID=COVID19_Participant15, Label=1, 셀개수=1003
   환자ID=COVID19_Participant18, Label=1, 셀개수=227
   환자ID=COVID19_Participant21, Label=1, 셀개수=39
   환자ID=COVID19_Participant32, Label=1, 셀개수=1665
   환자ID=COVID19_Participant35, Label=1, 셀개수=83
   환자ID=COVID19_Participant8, Label=1, 셀개수=462
   환자ID=Control_Participant10, Label=0, 셀개수=1645
   환자ID=Control_Participant11, Label=0, 셀개수=1164
   환자ID=Control_Participant14, Label=0, 셀개수=274
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Keratinocytes', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Neurons', 'iPS_cells', 'Embryonic_stem_cells', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
전체 데이터 길이 26947
전체 cell type 길이 0           Keratinocytes
1        Epithelial_cells
2        Epithelial_cells
3        Epithelial_cells
4        Epithelial_cells
               ...       
26942       Keratinocytes
26943    Epithelial_cells
26944    Epithelial_cells
26945    Epithelial_cells
26946         Neutrophils
Length: 26947, dtype: string
cell type의 NaN 개수 체크 0
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:09,  9.97it/s]  2%|▏         | 2/100 [00:00<00:10,  9.49it/s]  3%|▎         | 3/100 [00:00<00:10,  9.35it/s]  4%|▍         | 4/100 [00:00<00:10,  9.10it/s]  5%|▌         | 5/100 [00:00<00:10,  9.12it/s]  6%|▌         | 6/100 [00:00<00:11,  8.39it/s]  7%|▋         | 7/100 [00:00<00:12,  7.73it/s]  8%|▊         | 8/100 [00:00<00:11,  8.22it/s]  9%|▉         | 9/100 [00:01<00:11,  8.21it/s] 10%|█         | 10/100 [00:01<00:10,  8.69it/s] 11%|█         | 11/100 [00:01<00:10,  8.89it/s] 12%|█▏        | 12/100 [00:01<00:10,  8.64it/s] 13%|█▎        | 13/100 [00:01<00:12,  6.91it/s] 15%|█▌        | 15/100 [00:01<00:11,  7.64it/s] 16%|█▌        | 16/100 [00:01<00:10,  7.95it/s] 17%|█▋        | 17/100 [00:02<00:10,  8.16it/s] 18%|█▊        | 18/100 [00:02<00:09,  8.42it/s] 19%|█▉        | 19/100 [00:02<00:09,  8.15it/s] 20%|██        | 20/100 [00:02<00:09,  8.34it/s] 21%|██        | 21/100 [00:02<00:09,  8.75it/s] 23%|██▎       | 23/100 [00:02<00:08,  9.34it/s] 25%|██▌       | 25/100 [00:02<00:07,  9.41it/s] 27%|██▋       | 27/100 [00:03<00:07,  9.49it/s] 28%|██▊       | 28/100 [00:03<00:07,  9.46it/s] 29%|██▉       | 29/100 [00:03<00:07,  9.56it/s] 30%|███       | 30/100 [00:03<00:07,  9.32it/s] 31%|███       | 31/100 [00:03<00:08,  8.51it/s] 32%|███▏      | 32/100 [00:03<00:08,  8.23it/s] 33%|███▎      | 33/100 [00:03<00:07,  8.42it/s] 34%|███▍      | 34/100 [00:03<00:07,  8.44it/s] 35%|███▌      | 35/100 [00:04<00:08,  7.64it/s] 36%|███▌      | 36/100 [00:04<00:07,  8.00it/s] 37%|███▋      | 37/100 [00:04<00:07,  8.19it/s] 38%|███▊      | 38/100 [00:04<00:07,  8.22it/s] 39%|███▉      | 39/100 [00:04<00:07,  8.41it/s] 41%|████      | 41/100 [00:04<00:06,  8.83it/s] 42%|████▏     | 42/100 [00:04<00:06,  9.07it/s] 43%|████▎     | 43/100 [00:05<00:06,  8.89it/s] 44%|████▍     | 44/100 [00:05<00:06,  8.99it/s] 45%|████▌     | 45/100 [00:05<00:06,  8.82it/s] 46%|████▌     | 46/100 [00:05<00:06,  8.86it/s] 47%|████▋     | 47/100 [00:05<00:05,  8.94it/s] 48%|████▊     | 48/100 [00:05<00:06,  8.49it/s] 49%|████▉     | 49/100 [00:05<00:05,  8.56it/s] 50%|█████     | 50/100 [00:05<00:05,  8.56it/s] 51%|█████     | 51/100 [00:05<00:05,  8.53it/s] 52%|█████▏    | 52/100 [00:06<00:05,  8.68it/s] 53%|█████▎    | 53/100 [00:06<00:05,  8.81it/s] 54%|█████▍    | 54/100 [00:06<00:05,  8.58it/s] 55%|█████▌    | 55/100 [00:06<00:05,  8.57it/s] 56%|█████▌    | 56/100 [00:06<00:05,  7.92it/s] 57%|█████▋    | 57/100 [00:06<00:05,  7.97it/s] 58%|█████▊    | 58/100 [00:06<00:04,  8.43it/s] 59%|█████▉    | 59/100 [00:06<00:05,  8.00it/s] 60%|██████    | 60/100 [00:07<00:04,  8.06it/s] 61%|██████    | 61/100 [00:07<00:04,  8.30it/s] 62%|██████▏   | 62/100 [00:07<00:04,  8.42it/s] 63%|██████▎   | 63/100 [00:07<00:04,  8.78it/s] 64%|██████▍   | 64/100 [00:07<00:04,  8.87it/s] 65%|██████▌   | 65/100 [00:07<00:03,  8.75it/s] 66%|██████▌   | 66/100 [00:07<00:03,  8.95it/s] 67%|██████▋   | 67/100 [00:07<00:03,  8.90it/s] 68%|██████▊   | 68/100 [00:07<00:03,  8.79it/s] 69%|██████▉   | 69/100 [00:08<00:03,  7.94it/s] 70%|███████   | 70/100 [00:08<00:03,  7.88it/s] 71%|███████   | 71/100 [00:08<00:03,  8.15it/s] 72%|███████▏  | 72/100 [00:08<00:03,  8.13it/s] 73%|███████▎  | 73/100 [00:08<00:03,  8.25it/s] 74%|███████▍  | 74/100 [00:08<00:03,  7.82it/s] 75%|███████▌  | 75/100 [00:08<00:03,  7.03it/s] 76%|███████▌  | 76/100 [00:08<00:03,  7.61it/s] 77%|███████▋  | 77/100 [00:09<00:02,  8.00it/s] 78%|███████▊  | 78/100 [00:09<00:02,  8.15it/s] 79%|███████▉  | 79/100 [00:09<00:02,  7.82it/s] 80%|████████  | 80/100 [00:09<00:02,  7.93it/s] 81%|████████  | 81/100 [00:09<00:02,  7.63it/s] 82%|████████▏ | 82/100 [00:09<00:02,  7.81it/s] 83%|████████▎ | 83/100 [00:09<00:02,  7.73it/s] 84%|████████▍ | 84/100 [00:09<00:01,  8.13it/s] 85%|████████▌ | 85/100 [00:10<00:01,  8.31it/s] 86%|████████▌ | 86/100 [00:10<00:01,  8.43it/s] 87%|████████▋ | 87/100 [00:10<00:01,  8.20it/s] 88%|████████▊ | 88/100 [00:10<00:01,  8.45it/s] 89%|████████▉ | 89/100 [00:10<00:01,  8.39it/s] 90%|█████████ | 90/100 [00:10<00:01,  8.60it/s] 91%|█████████ | 91/100 [00:10<00:01,  8.50it/s] 92%|█████████▏| 92/100 [00:10<00:01,  7.88it/s] 93%|█████████▎| 93/100 [00:11<00:00,  7.97it/s] 94%|█████████▍| 94/100 [00:11<00:00,  8.07it/s] 95%|█████████▌| 95/100 [00:11<00:00,  8.20it/s] 96%|█████████▌| 96/100 [00:11<00:00,  8.08it/s] 97%|█████████▋| 97/100 [00:11<00:00,  8.43it/s] 98%|█████████▊| 98/100 [00:11<00:00,  6.03it/s] 99%|█████████▉| 99/100 [00:11<00:00,  6.57it/s]100%|██████████| 100/100 [00:12<00:00,  6.98it/s]100%|██████████| 100/100 [00:12<00:00,  8.29it/s]
[I 2025-08-31 17:17:16,407] A new study created in memory with name: no-name-54abd313-2b08-4ef7-ab87-cbce51b86ca4
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 25.64 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.635736, Valid_loss 0.558536
Epoch 2, Train Loss 0.581552, Valid_loss 0.557090
Epoch 3, Train Loss 0.523491, Valid_loss 0.502037
Epoch 4, Train Loss 0.487616, Valid_loss 0.474044
Epoch 5, Train Loss 0.470951, Valid_loss 0.526928
Epoch 6, Train Loss 0.452782, Valid_loss 0.478314
Epoch 7, Train Loss 0.435973, Valid_loss 0.497922
Epoch 8, Train Loss 0.424181, Valid_loss 0.491551
Epoch 9, Train Loss 0.413369, Valid_loss 0.490651
Epoch 10, Train Loss 0.411098, Valid_loss 0.539698
Epoch 11, Train Loss 0.400368, Valid_loss 0.481971
Epoch 12, Train Loss 0.396875, Valid_loss 0.426845
Epoch 13, Train Loss 0.388319, Valid_loss 0.549479
Epoch 14, Train Loss 0.382956, Valid_loss 0.445326
Epoch 15, Train Loss 0.364782, Valid_loss 0.420877
Epoch 16, Train Loss 0.351957, Valid_loss 0.527328
Epoch 17, Train Loss 0.351351, Valid_loss 0.443870
Epoch 18, Train Loss 0.338267, Valid_loss 0.542370
Epoch 19, Train Loss 0.326472, Valid_loss 0.440329
Epoch 20, Train Loss 0.322182, Valid_loss 0.486124
Epoch 21, Train Loss 0.307958, Valid_loss 0.446136
Epoch 22, Train Loss 0.298117, Valid_loss 0.477084
Epoch 23, Train Loss 0.291037, Valid_loss 0.463207
Epoch 24, Train Loss 0.277078, Valid_loss 0.525322
Epoch 25, Train Loss 0.261361, Valid_loss 0.423539
Epoch 26, Train Loss 0.256196, Valid_loss 0.442474
Epoch 27, Train Loss 0.249834, Valid_loss 0.547478
Epoch 28, Train Loss 0.251497, Valid_loss 0.381904
Epoch 29, Train Loss 0.249731, Valid_loss 0.496471
Epoch 30, Train Loss 0.244238, Valid_loss 0.495389
Epoch 31, Train Loss 0.242193, Valid_loss 0.405253
Epoch 32, Train Loss 0.243013, Valid_loss 0.582046
Epoch 33, Train Loss 0.243256, Valid_loss 0.387850
Epoch 34, Train Loss 0.235568, Valid_loss 0.405351
Epoch 35, Train Loss 0.233370, Valid_loss 0.487604
Epoch 36, Train Loss 0.237238, Valid_loss 0.425016
Epoch 37, Train Loss 0.230784, Valid_loss 0.368944
Epoch 38, Train Loss 0.237276, Valid_loss 0.432307
Epoch 39, Train Loss 0.223337, Valid_loss 0.404534
Epoch 40, Train Loss 0.226704, Valid_loss 0.450708
Epoch 41, Train Loss 0.228094, Valid_loss 0.429727
Epoch 42, Train Loss 0.223442, Valid_loss 0.558351
Epoch 43, Train Loss 0.225772, Valid_loss 0.393664
Epoch 44, Train Loss 0.224993, Valid_loss 0.457226
Epoch 45, Train Loss 0.237546, Valid_loss 0.408360
Epoch 46, Train Loss 0.233026, Valid_loss 0.520403
Epoch 47, Train Loss 0.224806, Valid_loss 0.346495
Epoch 48, Train Loss 0.232497, Valid_loss 0.597417
Epoch 49, Train Loss 0.224896, Valid_loss 0.472082
Epoch 50, Train Loss 0.220109, Valid_loss 0.417529
Epoch 51, Train Loss 0.218607, Valid_loss 0.446460
Epoch 52, Train Loss 0.214368, Valid_loss 0.516319
[I 2025-08-31 17:21:07,893] Trial 0 finished with value: 0.34649520287556307 and parameters: {'learning_rate': 0.001, 'epochs': 100, 'heads': 4, 'dropout': 0.0, 'weight_decay': 0.01, 'emb_dim': 8, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.34649520287556307.
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 29.04 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.715716, Valid_loss 0.536967
Epoch 2, Train Loss 0.628939, Valid_loss 0.512751
Epoch 3, Train Loss 0.534395, Valid_loss 0.402672
Epoch 4, Train Loss 0.466313, Valid_loss 0.395755
Epoch 5, Train Loss 0.421863, Valid_loss 0.371364
Epoch 6, Train Loss 0.420543, Valid_loss 0.363847
Epoch 7, Train Loss 0.396133, Valid_loss 0.327606
Epoch 8, Train Loss 0.372142, Valid_loss 0.400488
Epoch 9, Train Loss 0.370133, Valid_loss 0.329343
Epoch 10, Train Loss 0.363078, Valid_loss 0.373479
Epoch 11, Train Loss 0.372876, Valid_loss 0.326176
Epoch 12, Train Loss 0.362563, Valid_loss 0.310873
Epoch 13, Train Loss 0.339055, Valid_loss 0.367726
Epoch 14, Train Loss 0.335284, Valid_loss 0.322296
Epoch 15, Train Loss 0.335357, Valid_loss 0.306866
Epoch 16, Train Loss 0.337713, Valid_loss 0.342823
Epoch 17, Train Loss 0.331991, Valid_loss 0.344963
Epoch 18, Train Loss 0.316738, Valid_loss 0.326608
Epoch 19, Train Loss 0.323141, Valid_loss 0.342180
Epoch 20, Train Loss 0.321912, Valid_loss 0.305160
Epoch 21, Train Loss 0.328541, Valid_loss 0.352489
Epoch 22, Train Loss 0.310709, Valid_loss 0.385614
Epoch 23, Train Loss 0.318119, Valid_loss 0.316234
Epoch 24, Train Loss 0.302394, Valid_loss 0.340469
Epoch 25, Train Loss 0.305187, Valid_loss 0.366622
Epoch 26, Train Loss 0.303300, Valid_loss 0.327487
Epoch 27, Train Loss 0.288777, Valid_loss 0.352234
Epoch 28, Train Loss 0.299711, Valid_loss 0.332056
Epoch 29, Train Loss 0.291289, Valid_loss 0.329614
Epoch 30, Train Loss 0.295001, Valid_loss 0.311260
Epoch 31, Train Loss 0.315529, Valid_loss 0.370453
Epoch 32, Train Loss 0.301075, Valid_loss 0.391699
Epoch 33, Train Loss 0.294411, Valid_loss 0.307368
Epoch 34, Train Loss 0.285886, Valid_loss 0.333127
Epoch 35, Train Loss 0.284409, Valid_loss 0.309725
Epoch 36, Train Loss 0.290158, Valid_loss 0.379993
Epoch 37, Train Loss 0.283070, Valid_loss 0.313557
Epoch 38, Train Loss 0.282087, Valid_loss 0.358783
Epoch 39, Train Loss 0.275662, Valid_loss 0.341411
Epoch 40, Train Loss 0.285122, Valid_loss 0.370602
Epoch 41, Train Loss 0.267041, Valid_loss 0.319175
Epoch 42, Train Loss 0.284409, Valid_loss 0.331586
Epoch 43, Train Loss 0.283667, Valid_loss 0.301157
Epoch 44, Train Loss 0.276427, Valid_loss 0.370853
Epoch 45, Train Loss 0.272206, Valid_loss 0.324992
Epoch 46, Train Loss 0.270873, Valid_loss 0.390683
Epoch 47, Train Loss 0.266597, Valid_loss 0.331455
Epoch 48, Train Loss 0.264428, Valid_loss 0.378097
Epoch 49, Train Loss 0.265121, Valid_loss 0.400041
Epoch 50, Train Loss 0.258338, Valid_loss 0.362097
Epoch 51, Train Loss 0.276228, Valid_loss 0.321283
Epoch 52, Train Loss 0.263170, Valid_loss 0.359090
Epoch 53, Train Loss 0.260958, Valid_loss 0.321830
Epoch 54, Train Loss 0.271365, Valid_loss 0.364246
Epoch 55, Train Loss 0.265530, Valid_loss 0.343952
Epoch 56, Train Loss 0.257429, Valid_loss 0.362230
Epoch 57, Train Loss 0.262595, Valid_loss 0.354081
Epoch 58, Train Loss 0.252053, Valid_loss 0.327315
Epoch 59, Train Loss 0.251576, Valid_loss 0.349895
Epoch 60, Train Loss 0.266862, Valid_loss 0.380190
[I 2025-08-31 17:25:47,600] Trial 1 finished with value: 0.30115664271371706 and parameters: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 4, 'dropout': 0.5, 'weight_decay': 0.0001, 'emb_dim': 64, 'augment_num': 100, 'pca': False}. Best is trial 1 with value: 0.30115664271371706.
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 26.96 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.701772, Valid_loss 0.643735
Epoch 2, Train Loss 0.673499, Valid_loss 0.615537
Epoch 3, Train Loss 0.656310, Valid_loss 0.606452
Epoch 4, Train Loss 0.672409, Valid_loss 0.614956
Epoch 5, Train Loss 0.646099, Valid_loss 0.566890
Epoch 6, Train Loss 0.590421, Valid_loss 0.471745
Epoch 7, Train Loss 0.635927, Valid_loss 0.552689
Epoch 8, Train Loss 0.491521, Valid_loss 0.436791
Epoch 9, Train Loss 0.502323, Valid_loss 0.507175
Epoch 10, Train Loss 0.478117, Valid_loss 0.532168
Epoch 11, Train Loss 0.614573, Valid_loss 1.229759
Epoch 12, Train Loss 0.490297, Valid_loss 0.427338
Epoch 13, Train Loss 0.524620, Valid_loss 0.749266
Epoch 14, Train Loss 0.475202, Valid_loss 0.384762
Epoch 15, Train Loss 0.443724, Valid_loss 0.347226
Epoch 16, Train Loss 0.453184, Valid_loss 0.361813
Epoch 17, Train Loss 0.428416, Valid_loss 0.423902
Epoch 18, Train Loss 0.469831, Valid_loss 0.511755
Epoch 19, Train Loss 0.394286, Valid_loss 0.905654
Epoch 20, Train Loss 0.459615, Valid_loss 0.761487
Epoch 21, Train Loss 0.497759, Valid_loss 0.860412
Epoch 22, Train Loss 0.422125, Valid_loss 1.011516
Epoch 23, Train Loss 0.435439, Valid_loss 0.335642
Epoch 24, Train Loss 0.483425, Valid_loss 0.402549
Epoch 25, Train Loss 0.469272, Valid_loss 0.369562
Epoch 26, Train Loss 0.456784, Valid_loss 0.413349
Epoch 27, Train Loss 0.445345, Valid_loss 0.585001
Epoch 28, Train Loss 0.503093, Valid_loss 0.512236
Epoch 29, Train Loss 0.415350, Valid_loss 0.554227
Epoch 30, Train Loss 0.690868, Valid_loss 0.720057
Epoch 31, Train Loss 0.677341, Valid_loss 0.599331
Epoch 32, Train Loss 0.656031, Valid_loss 0.600794
Epoch 33, Train Loss 0.659020, Valid_loss 0.614896
Epoch 34, Train Loss 0.654996, Valid_loss 0.614429
Epoch 35, Train Loss 0.649945, Valid_loss 0.611677
Epoch 36, Train Loss 0.651011, Valid_loss 0.611756
Epoch 37, Train Loss 0.650099, Valid_loss 0.613243
Epoch 38, Train Loss 0.651224, Valid_loss 0.613285
Epoch 39, Train Loss 0.650153, Valid_loss 0.611603
Epoch 40, Train Loss 0.650116, Valid_loss 0.612655
Epoch 41, Train Loss 0.655654, Valid_loss 0.611343
Epoch 42, Train Loss 0.650645, Valid_loss 0.610915
Epoch 43, Train Loss 0.653327, Valid_loss 0.610054
Epoch 44, Train Loss 0.650237, Valid_loss 0.611368
Epoch 45, Train Loss 0.648823, Valid_loss 0.611448
Epoch 46, Train Loss 0.655358, Valid_loss 0.611015
Epoch 47, Train Loss 0.649379, Valid_loss 0.610913
Epoch 48, Train Loss 0.652274, Valid_loss 0.610937
Epoch 49, Train Loss 0.651564, Valid_loss 0.610994
Epoch 50, Train Loss 0.654297, Valid_loss 0.611080
Epoch 51, Train Loss 0.653051, Valid_loss 0.607058
Epoch 52, Train Loss 0.639264, Valid_loss 0.565230
Epoch 53, Train Loss 0.612188, Valid_loss 0.507743
Epoch 54, Train Loss 0.565719, Valid_loss 0.465393
Epoch 55, Train Loss 0.566886, Valid_loss 0.466144
Epoch 56, Train Loss 0.547851, Valid_loss 0.467571
[I 2025-08-31 17:29:32,128] Trial 2 finished with value: 0.33564184818949017 and parameters: {'learning_rate': 0.01, 'epochs': 100, 'heads': 2, 'dropout': 0.7, 'weight_decay': 0.01, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 1 with value: 0.30115664271371706.
선택된 trial params: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 4, 'dropout': 0.5, 'weight_decay': 0.0001, 'emb_dim': 64, 'augment_num': 100, 'pca': False}
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=10, batch_size=1 -> steps=10
output_class :  1
Memory Allocated: 29.04 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.653115, Valid_loss 0.550007
Epoch 2, Train Loss 0.585026, Valid_loss 0.475781
Epoch 3, Train Loss 0.500617, Valid_loss 0.409367
Epoch 4, Train Loss 0.441942, Valid_loss 0.420423
Epoch 5, Train Loss 0.409994, Valid_loss 0.408777
Epoch 6, Train Loss 0.414856, Valid_loss 0.382506
Epoch 7, Train Loss 0.398493, Valid_loss 0.366728
Epoch 8, Train Loss 0.367244, Valid_loss 0.378078
Epoch 9, Train Loss 0.377825, Valid_loss 0.391379
Epoch 10, Train Loss 0.360080, Valid_loss 0.424013
Epoch 11, Train Loss 0.364252, Valid_loss 0.388078
Epoch 12, Train Loss 0.353729, Valid_loss 0.356650
Epoch 13, Train Loss 0.374279, Valid_loss 0.506974
Epoch 14, Train Loss 0.350324, Valid_loss 0.396108
Epoch 15, Train Loss 0.354864, Valid_loss 0.368868
Epoch 16, Train Loss 0.342978, Valid_loss 0.395528
Epoch 17, Train Loss 0.322574, Valid_loss 0.396853
Epoch 18, Train Loss 0.320667, Valid_loss 0.362898
Epoch 19, Train Loss 0.318089, Valid_loss 0.355828
Epoch 20, Train Loss 0.324537, Valid_loss 0.351810
Epoch 21, Train Loss 0.326838, Valid_loss 0.394503
Epoch 22, Train Loss 0.313178, Valid_loss 0.351835
Epoch 23, Train Loss 0.311742, Valid_loss 0.380820
Epoch 24, Train Loss 0.304291, Valid_loss 0.344947
Epoch 25, Train Loss 0.319887, Valid_loss 0.348700
Epoch 26, Train Loss 0.305295, Valid_loss 0.381968
Epoch 27, Train Loss 0.305394, Valid_loss 0.368890
Epoch 28, Train Loss 0.301882, Valid_loss 0.384300
Epoch 29, Train Loss 0.311032, Valid_loss 0.415075
Epoch 30, Train Loss 0.302045, Valid_loss 0.436765
Epoch 31, Train Loss 0.295775, Valid_loss 0.383269
Epoch 32, Train Loss 0.291095, Valid_loss 0.376640
Epoch 33, Train Loss 0.291910, Valid_loss 0.387907
Epoch 34, Train Loss 0.298052, Valid_loss 0.359493
Epoch 35, Train Loss 0.293308, Valid_loss 0.397336
Epoch 36, Train Loss 0.287342, Valid_loss 0.480803
Epoch 37, Train Loss 0.291961, Valid_loss 0.366759
Epoch 38, Train Loss 0.281916, Valid_loss 0.381201
Epoch 39, Train Loss 0.274028, Valid_loss 0.370523
Epoch 40, Train Loss 0.281878, Valid_loss 0.390311
Epoch 41, Train Loss 0.278787, Valid_loss 0.406455
Epoch 42, Train Loss 0.285089, Valid_loss 0.370647
Epoch 43, Train Loss 0.274146, Valid_loss 0.380387
Epoch 44, Train Loss 0.277027, Valid_loss 0.376687
Epoch 45, Train Loss 0.278193, Valid_loss 0.363806
Epoch 46, Train Loss 0.271176, Valid_loss 0.361443
Epoch 47, Train Loss 0.282064, Valid_loss 0.401210
Epoch 48, Train Loss 0.265556, Valid_loss 0.383462
Epoch 49, Train Loss 0.283196, Valid_loss 0.377661
Epoch 50, Train Loss 0.269777, Valid_loss 0.413094
Epoch 51, Train Loss 0.268592, Valid_loss 0.392453
Epoch 52, Train Loss 0.263753, Valid_loss 0.377460
Epoch 53, Train Loss 0.267906, Valid_loss 0.448229
Epoch 54, Train Loss 0.264791, Valid_loss 0.359960
Epoch 55, Train Loss 0.269735, Valid_loss 0.391450
Epoch 56, Train Loss 0.270135, Valid_loss 0.371967
Epoch 57, Train Loss 0.266092, Valid_loss 0.394282
Epoch 58, Train Loss 0.256293, Valid_loss 0.374930
Epoch 59, Train Loss 0.264614, Valid_loss 0.394886
Epoch 60, Train Loss 0.258582, Valid_loss 0.382442
Epoch 61, Train Loss 0.260729, Valid_loss 0.407911
Epoch 62, Train Loss 0.275573, Valid_loss 0.379901
Epoch 63, Train Loss 0.255155, Valid_loss 0.363221
Epoch 64, Train Loss 0.256951, Valid_loss 0.397912
Epoch 65, Train Loss 0.264252, Valid_loss 0.366984
Epoch 66, Train Loss 0.252207, Valid_loss 0.383306
Epoch 67, Train Loss 0.256238, Valid_loss 0.386857
환자ID=COVID19_Participant10 -- true: 1 -- pred: 0
환자ID=COVID19_Participant15 -- true: 1 -- pred: 1
환자ID=COVID19_Participant18 -- true: 1 -- pred: 1
환자ID=COVID19_Participant21 -- true: 1 -- pred: 1
환자ID=COVID19_Participant32 -- true: 1 -- pred: 0
환자ID=COVID19_Participant35 -- true: 1 -- pred: 0
환자ID=COVID19_Participant8 -- true: 1 -- pred: 1
환자ID=Control_Participant10 -- true: 0 -- pred: 0
환자ID=Control_Participant11 -- true: 0 -- pred: 1
환자ID=Control_Participant14 -- true: 0 -- pred: 0
Best performance: Epoch 24, Loss 0.304291, Test ACC 0.600000, Test AUC 0.809524, Test Recall 0.571429, Test Precision 0.800000
Confusion Matrix:
 [2 1 3 4]
✅ Total valid splits used: 5

📌 Repeat 1: 평균 AUC = 0.9524, 표준편차 = 0.0738
Test ACC 평균 0.860000, Test Recall 평균 0.885714, Test Precision 평균 0.906429
fold_aucs = [1.0, 1.0, 1.0, 0.9523809523809524, 0.8095238095238095]
NaN 개수: 0 / 전체 5개

🔁 Repeat 2, Fold 0
cell type :  GTCGGGGGGTGG_Control_Participant7        Keratinocytes
CAAATCAATTAT_Control_Participant7     Epithelial_cells
ATACAATTGACA_Control_Participant7     Epithelial_cells
CTGTTAATGAGA_Control_Participant7     Epithelial_cells
CTTCACATTATT_Control_Participant7     Epithelial_cells
                                            ...       
ACCATATTCAGG_COVID19_Participant21       Keratinocytes
GCCCGTTTCACG_COVID19_Participant21    Epithelial_cells
TATTATCTCTTA_COVID19_Participant21    Epithelial_cells
TTCCGTTTGTCC_COVID19_Participant21    Epithelial_cells
TCGGGATTGGAT_COVID19_Participant21         Neutrophils
Name: singler_annotation, Length: 20828, dtype: string
cell type annotation :  GTCGGGGGGTGG_Control_Participant7        Keratinocytes
CAAATCAATTAT_Control_Participant7     Epithelial_cells
ATACAATTGACA_Control_Participant7     Epithelial_cells
CTGTTAATGAGA_Control_Participant7     Epithelial_cells
CTTCACATTATT_Control_Participant7     Epithelial_cells
                                            ...       
ACCATATTCAGG_COVID19_Participant21       Keratinocytes
GCCCGTTTCACG_COVID19_Participant21    Epithelial_cells
TATTATCTCTTA_COVID19_Participant21    Epithelial_cells
TTCCGTTTGTCC_COVID19_Participant21    Epithelial_cells
TCGGGATTGGAT_COVID19_Participant21         Neutrophils
Name: singler_annotation, Length: 20828, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Keratinocytes', 'Epithelial_cells', 'Neurons', 'iPS_cells', 'Embryonic_stem_cells', 'Astrocyte', 'DC', 'Gametocytes', 'HSC_-G-CSF', 'Smooth_muscle_cells', 'BM & Prog.', 'Monocyte', 'Myelocyte', 'BM', 'Endothelial_cells', 'Osteoblasts', 'Platelets', 'Erythroblast', 'NK_cell', 'T_cells', 'Chondrocytes', 'HSC_CD34+', 'CMP', 'Neutrophils', 'Fibroblasts', 'MEP', 'Neuroepithelial_cell', 'MSC', 'Pro-Myelocyte', 'B_cell', 'GMP', 'Hepatocytes', 'Macrophage', 'Tissue_stem_cells', 'Pre-B_cell_CD34-', 'Pro-B_cell_CD34+', 'Unknown']
라벨별 그룹 개수 {1: 28, 0: 12}
cell type :  TTCCCAAGATCC_COVID19_Participant7     Epithelial_cells
TGGGATTACAGG_COVID19_Participant7               B_cell
CACCTTCCCCTT_COVID19_Participant7     Epithelial_cells
CAATGCCCGCTA_COVID19_Participant7     Epithelial_cells
TTCTGAAAACAA_COVID19_Participant7     Epithelial_cells
                                            ...       
GCAGGGAACTCC_COVID19_Participant30    Epithelial_cells
CAGCACCGAGCC_COVID19_Participant30    Epithelial_cells
GCCCCTTGTGAT_COVID19_Participant30    Epithelial_cells
GTGTTGTGTGTC_COVID19_Participant30              B_cell
TAACACTCACTT_COVID19_Participant30           Myelocyte
Name: singler_annotation, Length: 6119, dtype: string
cell type annotation :  TTCCCAAGATCC_COVID19_Participant7     Epithelial_cells
TGGGATTACAGG_COVID19_Participant7               B_cell
CACCTTCCCCTT_COVID19_Participant7     Epithelial_cells
CAATGCCCGCTA_COVID19_Participant7     Epithelial_cells
TTCTGAAAACAA_COVID19_Participant7     Epithelial_cells
                                            ...       
GCAGGGAACTCC_COVID19_Participant30    Epithelial_cells
CAGCACCGAGCC_COVID19_Participant30    Epithelial_cells
GCCCCTTGTGAT_COVID19_Participant30    Epithelial_cells
GTGTTGTGTGTC_COVID19_Participant30              B_cell
TAACACTCACTT_COVID19_Participant30           Myelocyte
Name: singler_annotation, Length: 6119, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Epithelial_cells', 'B_cell', 'Keratinocytes', 'CMP', 'T_cells', 'Gametocytes', 'Platelets', 'NK_cell', 'HSC_CD34+', 'DC', 'HSC_-G-CSF', 'Neurons', 'Pre-B_cell_CD34-', 'Neutrophils', 'Smooth_muscle_cells', 'Tissue_stem_cells', 'Astrocyte', 'Embryonic_stem_cells', 'Osteoblasts', 'Chondrocytes', 'Erythroblast', 'Myelocyte', 'Hepatocytes', 'Endothelial_cells', 'BM & Prog.', 'Macrophage', 'Neuroepithelial_cell', 'iPS_cells', 'Monocyte', 'MEP', 'MSC', 'Pro-Myelocyte', 'Fibroblasts', 'Pro-B_cell_CD34+', 'BM', 'GMP', 'Unknown']
라벨별 그룹 개수 {1: 7, 0: 3}
🔍 Split #1
  → train_p_index 환자 수 (환자 단위로 묶인 index list): 40
  → test_p_index 환자 수  (환자 단위로 묶인 index list): 10
  → train 환자 ID: ['COVID19_Participant11', 'COVID19_Participant13', 'COVID19_Participant14', 'COVID19_Participant15', 'COVID19_Participant17', 'COVID19_Participant18', 'COVID19_Participant19', 'COVID19_Participant2', 'COVID19_Participant21', 'COVID19_Participant22', 'COVID19_Participant23', 'COVID19_Participant25', 'COVID19_Participant26', 'COVID19_Participant28', 'COVID19_Participant29', 'COVID19_Participant3', 'COVID19_Participant31', 'COVID19_Participant32', 'COVID19_Participant35', 'COVID19_Participant36', 'COVID19_Participant37', 'COVID19_Participant38', 'COVID19_Participant39', 'COVID19_Participant40', 'COVID19_Participant5', 'COVID19_Participant6', 'COVID19_Participant8', 'COVID19_Participant9', 'Control_Participant1', 'Control_Participant10', 'Control_Participant11', 'Control_Participant12', 'Control_Participant13', 'Control_Participant14', 'Control_Participant15', 'Control_Participant2', 'Control_Participant3', 'Control_Participant4', 'Control_Participant6', 'Control_Participant7']
  → test  환자 ID: ['COVID19_Participant10', 'COVID19_Participant12', 'COVID19_Participant20', 'COVID19_Participant27', 'COVID19_Participant30', 'COVID19_Participant4', 'COVID19_Participant7', 'Control_Participant5', 'Control_Participant8', 'Control_Participant9']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant18, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant21, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant3, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant35, Label: 1
    ID: COVID19_Participant36, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant38, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: COVID19_Participant5, Label: 1
    ID: COVID19_Participant6, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: COVID19_Participant9, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant10, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant12, Label: 0
    ID: Control_Participant13, Label: 0
    ID: Control_Participant14, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant2, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant4, Label: 0
    ID: Control_Participant6, Label: 0
    ID: Control_Participant7, Label: 0
  → test 환자 ID 및 라벨:
    ID: COVID19_Participant10, Label: 1
    ID: COVID19_Participant12, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant27, Label: 1
    ID: COVID19_Participant30, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: Control_Participant5, Label: 0
    ID: Control_Participant8, Label: 0
    ID: Control_Participant9, Label: 0
전체 데이터 index 길이 50
label_stat (train 환자 라벨 목록) 갯수 40
train_data에서 환자 단위로, train과 validation 나누기
기존 train_p_index 40
기존 (train) label_stat 40
train-vali 분할 후! 
train y 의 classes : {0, 1} valid y 의 classes : {0, 1} label_stat 의 classes : {0, 1}
train_p_index_ 26
valid_p_index 14
test_p_index 10
→ train 환자 ID 및 라벨:
   총 개수: 26
   환자ID=Control_Participant10, Label=0, 셀개수=1645
   환자ID=Control_Participant14, Label=0, 셀개수=274
   환자ID=COVID19_Participant19, Label=1, 셀개수=816
   환자ID=COVID19_Participant38, Label=1, 셀개수=51
   환자ID=COVID19_Participant11, Label=1, 셀개수=382
   환자ID=Control_Participant3, Label=0, 셀개수=1620
   환자ID=COVID19_Participant15, Label=1, 셀개수=1003
   환자ID=COVID19_Participant2, Label=1, 셀개수=329
   환자ID=COVID19_Participant40, Label=1, 셀개수=381
   환자ID=COVID19_Participant14, Label=1, 셀개수=382
   환자ID=COVID19_Participant21, Label=1, 셀개수=39
   환자ID=Control_Participant15, Label=0, 셀개수=528
   환자ID=COVID19_Participant28, Label=1, 셀개수=1079
   환자ID=Control_Participant6, Label=0, 셀개수=131
   환자ID=Control_Participant4, Label=0, 셀개수=440
   환자ID=COVID19_Participant17, Label=1, 셀개수=843
   환자ID=Control_Participant7, Label=0, 셀개수=762
   환자ID=Control_Participant11, Label=0, 셀개수=1164
   환자ID=COVID19_Participant23, Label=1, 셀개수=307
   환자ID=COVID19_Participant31, Label=1, 셀개수=410
   환자ID=COVID19_Participant26, Label=1, 셀개수=814
   환자ID=COVID19_Participant18, Label=1, 셀개수=227
   환자ID=COVID19_Participant6, Label=1, 셀개수=84
   환자ID=COVID19_Participant39, Label=1, 셀개수=454
   환자ID=COVID19_Participant37, Label=1, 셀개수=668
   환자ID=COVID19_Participant3, Label=1, 셀개수=104
→ valid 환자 ID 및 라벨:
   총 개수: 14
   환자ID=Control_Participant13, Label=0, 셀개수=88
   환자ID=COVID19_Participant29, Label=1, 셀개수=573
   환자ID=COVID19_Participant35, Label=1, 셀개수=83
   환자ID=COVID19_Participant32, Label=1, 셀개수=1665
   환자ID=COVID19_Participant5, Label=1, 셀개수=89
   환자ID=COVID19_Participant22, Label=1, 셀개수=865
   환자ID=Control_Participant2, Label=0, 셀개수=41
   환자ID=Control_Participant1, Label=0, 셀개수=414
   환자ID=COVID19_Participant9, Label=1, 셀개수=86
   환자ID=COVID19_Participant8, Label=1, 셀개수=462
   환자ID=Control_Participant12, Label=0, 셀개수=99
   환자ID=COVID19_Participant36, Label=1, 셀개수=200
   환자ID=COVID19_Participant13, Label=1, 셀개수=730
   환자ID=COVID19_Participant25, Label=1, 셀개수=496
→ test 환자 ID 및 라벨:
   총 개수: 10
   환자ID=COVID19_Participant10, Label=1, 셀개수=18
   환자ID=COVID19_Participant12, Label=1, 셀개수=102
   환자ID=COVID19_Participant20, Label=1, 셀개수=2033
   환자ID=COVID19_Participant27, Label=1, 셀개수=93
   환자ID=COVID19_Participant30, Label=1, 셀개수=116
   환자ID=COVID19_Participant4, Label=1, 셀개수=1680
   환자ID=COVID19_Participant7, Label=1, 셀개수=409
   환자ID=Control_Participant5, Label=0, 셀개수=717
   환자ID=Control_Participant8, Label=0, 셀개수=393
   환자ID=Control_Participant9, Label=0, 셀개수=558
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Keratinocytes', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Neurons', 'iPS_cells', 'Embryonic_stem_cells', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
전체 데이터 길이 26947
전체 cell type 길이 0           Keratinocytes
1        Epithelial_cells
2        Epithelial_cells
3        Epithelial_cells
4        Epithelial_cells
               ...       
26942    Epithelial_cells
26943    Epithelial_cells
26944    Epithelial_cells
26945              B_cell
26946           Myelocyte
Length: 26947, dtype: string
cell type의 NaN 개수 체크 0
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  2%|▏         | 2/100 [00:00<00:09, 10.21it/s]  4%|▍         | 4/100 [00:00<00:09,  9.92it/s]  5%|▌         | 5/100 [00:00<00:09,  9.74it/s]  7%|▋         | 7/100 [00:00<00:09,  9.98it/s]  9%|▉         | 9/100 [00:00<00:09,  9.98it/s] 10%|█         | 10/100 [00:01<00:09,  9.63it/s] 11%|█         | 11/100 [00:01<00:09,  9.62it/s] 12%|█▏        | 12/100 [00:01<00:09,  9.57it/s] 13%|█▎        | 13/100 [00:01<00:08,  9.68it/s] 14%|█▍        | 14/100 [00:01<00:08,  9.70it/s] 15%|█▌        | 15/100 [00:01<00:08,  9.48it/s] 16%|█▌        | 16/100 [00:01<00:08,  9.40it/s] 17%|█▋        | 17/100 [00:01<00:08,  9.36it/s] 18%|█▊        | 18/100 [00:01<00:08,  9.32it/s] 19%|█▉        | 19/100 [00:01<00:09,  8.88it/s] 20%|██        | 20/100 [00:02<00:09,  8.53it/s] 21%|██        | 21/100 [00:02<00:08,  8.86it/s] 22%|██▏       | 22/100 [00:02<00:08,  8.83it/s] 24%|██▍       | 24/100 [00:02<00:08,  8.95it/s] 25%|██▌       | 25/100 [00:02<00:11,  6.75it/s] 27%|██▋       | 27/100 [00:03<00:09,  7.74it/s] 29%|██▉       | 29/100 [00:03<00:08,  8.40it/s] 30%|███       | 30/100 [00:03<00:08,  8.56it/s] 31%|███       | 31/100 [00:03<00:08,  8.00it/s] 32%|███▏      | 32/100 [00:03<00:08,  8.28it/s] 34%|███▍      | 34/100 [00:03<00:07,  8.78it/s] 35%|███▌      | 35/100 [00:03<00:08,  8.12it/s] 36%|███▌      | 36/100 [00:04<00:07,  8.20it/s] 37%|███▋      | 37/100 [00:04<00:07,  8.09it/s] 38%|███▊      | 38/100 [00:04<00:07,  8.49it/s] 39%|███▉      | 39/100 [00:04<00:06,  8.80it/s] 40%|████      | 40/100 [00:04<00:06,  8.94it/s] 41%|████      | 41/100 [00:04<00:06,  8.79it/s] 42%|████▏     | 42/100 [00:04<00:06,  8.86it/s] 43%|████▎     | 43/100 [00:04<00:06,  8.47it/s] 44%|████▍     | 44/100 [00:04<00:06,  8.75it/s] 45%|████▌     | 45/100 [00:05<00:06,  8.75it/s] 46%|████▌     | 46/100 [00:05<00:06,  8.63it/s] 47%|████▋     | 47/100 [00:05<00:06,  8.78it/s] 48%|████▊     | 48/100 [00:05<00:05,  8.93it/s] 49%|████▉     | 49/100 [00:05<00:05,  9.03it/s] 50%|█████     | 50/100 [00:05<00:06,  8.11it/s] 51%|█████     | 51/100 [00:05<00:06,  8.10it/s] 52%|█████▏    | 52/100 [00:05<00:05,  8.43it/s] 53%|█████▎    | 53/100 [00:06<00:05,  8.78it/s] 54%|█████▍    | 54/100 [00:06<00:05,  8.92it/s] 55%|█████▌    | 55/100 [00:06<00:05,  8.99it/s] 56%|█████▌    | 56/100 [00:06<00:05,  8.62it/s] 57%|█████▋    | 57/100 [00:06<00:04,  8.73it/s] 58%|█████▊    | 58/100 [00:06<00:04,  9.04it/s] 59%|█████▉    | 59/100 [00:06<00:04,  8.27it/s] 61%|██████    | 61/100 [00:06<00:04,  8.57it/s] 62%|██████▏   | 62/100 [00:07<00:04,  8.33it/s] 63%|██████▎   | 63/100 [00:07<00:04,  8.50it/s] 64%|██████▍   | 64/100 [00:07<00:04,  8.79it/s] 65%|██████▌   | 65/100 [00:07<00:03,  8.94it/s] 66%|██████▌   | 66/100 [00:07<00:04,  8.49it/s] 67%|██████▋   | 67/100 [00:07<00:03,  8.81it/s] 68%|██████▊   | 68/100 [00:07<00:03,  9.01it/s] 69%|██████▉   | 69/100 [00:07<00:03,  9.25it/s] 70%|███████   | 70/100 [00:07<00:03,  8.66it/s] 71%|███████   | 71/100 [00:08<00:03,  8.71it/s] 73%|███████▎  | 73/100 [00:08<00:02,  9.16it/s] 74%|███████▍  | 74/100 [00:08<00:02,  9.23it/s] 75%|███████▌  | 75/100 [00:08<00:02,  8.92it/s] 76%|███████▌  | 76/100 [00:08<00:02,  9.08it/s] 77%|███████▋  | 77/100 [00:08<00:02,  8.83it/s] 78%|███████▊  | 78/100 [00:08<00:02,  8.52it/s] 79%|███████▉  | 79/100 [00:09<00:02,  8.47it/s] 80%|████████  | 80/100 [00:09<00:02,  8.50it/s] 81%|████████  | 81/100 [00:09<00:02,  8.64it/s] 82%|████████▏ | 82/100 [00:09<00:02,  8.73it/s] 83%|████████▎ | 83/100 [00:09<00:01,  8.51it/s] 84%|████████▍ | 84/100 [00:09<00:01,  8.06it/s] 85%|████████▌ | 85/100 [00:09<00:01,  8.25it/s] 86%|████████▌ | 86/100 [00:09<00:01,  8.37it/s] 87%|████████▋ | 87/100 [00:09<00:01,  8.51it/s] 88%|████████▊ | 88/100 [00:10<00:01,  8.53it/s] 89%|████████▉ | 89/100 [00:10<00:01,  8.57it/s] 90%|█████████ | 90/100 [00:10<00:01,  7.66it/s] 91%|█████████ | 91/100 [00:10<00:01,  7.72it/s] 92%|█████████▏| 92/100 [00:10<00:01,  7.96it/s] 93%|█████████▎| 93/100 [00:10<00:00,  8.07it/s] 94%|█████████▍| 94/100 [00:10<00:00,  7.31it/s] 95%|█████████▌| 95/100 [00:10<00:00,  7.72it/s] 96%|█████████▌| 96/100 [00:11<00:00,  7.80it/s] 97%|█████████▋| 97/100 [00:11<00:00,  7.54it/s] 98%|█████████▊| 98/100 [00:11<00:00,  7.68it/s] 99%|█████████▉| 99/100 [00:11<00:00,  7.61it/s]100%|██████████| 100/100 [00:11<00:00,  7.83it/s]100%|██████████| 100/100 [00:11<00:00,  8.60it/s]
[I 2025-08-31 17:34:57,082] A new study created in memory with name: no-name-cc5ed4c8-b0d9-45f6-a62b-e9ab717f72d1
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 26.96 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.638916, Valid_loss 0.655541
Epoch 2, Train Loss 0.560082, Valid_loss 0.480118
Epoch 3, Train Loss 0.488637, Valid_loss 0.501185
Epoch 4, Train Loss 0.441272, Valid_loss 0.518191
Epoch 5, Train Loss 0.452181, Valid_loss 0.470970
Epoch 6, Train Loss 0.456980, Valid_loss 0.468199
Epoch 7, Train Loss 0.414042, Valid_loss 0.596788
Epoch 8, Train Loss 0.383078, Valid_loss 0.400227
Epoch 9, Train Loss 0.377198, Valid_loss 0.521501
Epoch 10, Train Loss 0.413529, Valid_loss 0.505883
Epoch 11, Train Loss 0.347921, Valid_loss 0.635076
Epoch 12, Train Loss 0.370742, Valid_loss 0.663197
Epoch 13, Train Loss 0.359809, Valid_loss 0.598579
Epoch 14, Train Loss 0.414323, Valid_loss 0.505422
Epoch 15, Train Loss 0.373254, Valid_loss 0.604305
Epoch 16, Train Loss 0.375288, Valid_loss 0.414691
Epoch 17, Train Loss 0.351971, Valid_loss 0.505845
Epoch 18, Train Loss 0.384555, Valid_loss 0.711242
Epoch 19, Train Loss 0.417274, Valid_loss 0.654614
Epoch 20, Train Loss 0.350456, Valid_loss 0.553209
Epoch 21, Train Loss 0.407687, Valid_loss 0.905627
Epoch 22, Train Loss 0.361017, Valid_loss 0.877630
Epoch 23, Train Loss 0.409200, Valid_loss 1.019300
Epoch 24, Train Loss 0.454395, Valid_loss 0.735425
Epoch 25, Train Loss 0.732569, Valid_loss 0.599815
Epoch 26, Train Loss 0.669526, Valid_loss 0.598123
Epoch 27, Train Loss 0.594809, Valid_loss 0.600322
Epoch 28, Train Loss 0.493417, Valid_loss 0.642074
Epoch 29, Train Loss 0.416111, Valid_loss 0.707113
Epoch 30, Train Loss 0.387967, Valid_loss 0.796819
Epoch 31, Train Loss 0.375499, Valid_loss 0.709644
Epoch 32, Train Loss 0.458032, Valid_loss 0.701100
Epoch 33, Train Loss 0.457906, Valid_loss 0.732871
Epoch 34, Train Loss 0.406844, Valid_loss 0.672156
Epoch 35, Train Loss 0.390404, Valid_loss 0.843847
Epoch 36, Train Loss 0.349077, Valid_loss 0.774937
Epoch 37, Train Loss 0.379684, Valid_loss 0.767710
Epoch 38, Train Loss 0.429643, Valid_loss 0.980661
Epoch 39, Train Loss 0.444874, Valid_loss 0.645870
Epoch 40, Train Loss 0.416069, Valid_loss 0.684904
Epoch 41, Train Loss 0.373570, Valid_loss 0.689560
Epoch 42, Train Loss 0.362635, Valid_loss 0.731751
Epoch 43, Train Loss 0.365450, Valid_loss 0.944358
Epoch 44, Train Loss 0.380362, Valid_loss 1.029715
Epoch 45, Train Loss 0.374088, Valid_loss 0.775499
Epoch 46, Train Loss 0.419656, Valid_loss 0.783607
Epoch 47, Train Loss 0.387251, Valid_loss 0.781189
Epoch 48, Train Loss 0.362250, Valid_loss 1.046111
Epoch 49, Train Loss 0.401611, Valid_loss 1.046012
Epoch 50, Train Loss 0.369859, Valid_loss 1.066164
Epoch 51, Train Loss 0.397571, Valid_loss 1.067404
Epoch 52, Train Loss 0.401214, Valid_loss 1.072525
[I 2025-08-31 17:38:58,091] Trial 0 finished with value: 0.400227406461324 and parameters: {'learning_rate': 0.01, 'epochs': 100, 'heads': 4, 'dropout': 0.7, 'weight_decay': 0.0001, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.400227406461324.
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 26.96 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.638682, Valid_loss 0.570097
Epoch 2, Train Loss 0.504715, Valid_loss 0.598840
Epoch 3, Train Loss 0.416521, Valid_loss 0.513514
Epoch 4, Train Loss 0.397000, Valid_loss 0.509829
Epoch 5, Train Loss 0.354916, Valid_loss 0.467664
Epoch 6, Train Loss 0.338894, Valid_loss 0.445256
Epoch 7, Train Loss 0.326076, Valid_loss 0.463889
Epoch 8, Train Loss 0.322713, Valid_loss 0.454368
Epoch 9, Train Loss 0.319827, Valid_loss 0.410029
Epoch 10, Train Loss 0.304973, Valid_loss 0.490731
Epoch 11, Train Loss 0.292974, Valid_loss 0.467529
Epoch 12, Train Loss 0.274359, Valid_loss 0.450291
Epoch 13, Train Loss 0.278435, Valid_loss 0.469189
Epoch 14, Train Loss 0.288025, Valid_loss 0.515755
Epoch 15, Train Loss 0.288117, Valid_loss 0.472684
Epoch 16, Train Loss 0.281223, Valid_loss 0.544295
Epoch 17, Train Loss 0.282190, Valid_loss 0.452034
Epoch 18, Train Loss 0.264326, Valid_loss 0.431155
Epoch 19, Train Loss 0.266251, Valid_loss 0.387901
Epoch 20, Train Loss 0.267429, Valid_loss 0.441205
Epoch 21, Train Loss 0.251702, Valid_loss 0.384332
Epoch 22, Train Loss 0.252086, Valid_loss 0.454653
Epoch 23, Train Loss 0.245776, Valid_loss 0.397687
Epoch 24, Train Loss 0.253304, Valid_loss 0.347754
Epoch 25, Train Loss 0.242805, Valid_loss 0.428978
Epoch 26, Train Loss 0.239781, Valid_loss 0.407362
Epoch 27, Train Loss 0.249532, Valid_loss 0.528619
Epoch 28, Train Loss 0.239814, Valid_loss 0.426705
Epoch 29, Train Loss 0.239767, Valid_loss 0.438158
Epoch 30, Train Loss 0.230727, Valid_loss 0.455250
Epoch 31, Train Loss 0.237615, Valid_loss 0.459211
Epoch 32, Train Loss 0.233827, Valid_loss 0.355653
Epoch 33, Train Loss 0.252587, Valid_loss 0.425550
Epoch 34, Train Loss 0.232895, Valid_loss 0.450626
Epoch 35, Train Loss 0.232967, Valid_loss 0.500896
Epoch 36, Train Loss 0.231981, Valid_loss 0.521085
Epoch 37, Train Loss 0.226118, Valid_loss 0.312269
Epoch 38, Train Loss 0.246706, Valid_loss 0.396731
Epoch 39, Train Loss 0.243331, Valid_loss 0.459605
Epoch 40, Train Loss 0.240862, Valid_loss 0.409319
Epoch 41, Train Loss 0.221668, Valid_loss 0.406846
Epoch 42, Train Loss 0.222911, Valid_loss 0.698056
Epoch 43, Train Loss 0.231748, Valid_loss 0.431864
Epoch 44, Train Loss 0.219210, Valid_loss 0.357760
Epoch 45, Train Loss 0.216360, Valid_loss 0.406522
Epoch 46, Train Loss 0.213735, Valid_loss 0.477975
Epoch 47, Train Loss 0.218712, Valid_loss 0.425607
Epoch 48, Train Loss 0.216603, Valid_loss 0.390423
Epoch 49, Train Loss 0.217800, Valid_loss 0.364397
Epoch 50, Train Loss 0.212512, Valid_loss 0.365173
Epoch 51, Train Loss 0.213328, Valid_loss 0.449387
Epoch 52, Train Loss 0.210806, Valid_loss 0.400496
Epoch 53, Train Loss 0.213590, Valid_loss 0.418937
Epoch 54, Train Loss 0.212484, Valid_loss 0.361350
Epoch 55, Train Loss 0.211303, Valid_loss 0.422789
Epoch 56, Train Loss 0.209578, Valid_loss 0.360409
Epoch 57, Train Loss 0.210782, Valid_loss 0.367905
Epoch 58, Train Loss 0.213283, Valid_loss 0.462456
[I 2025-08-31 17:42:34,061] Trial 1 finished with value: 0.31226875772699714 and parameters: {'learning_rate': 0.001, 'epochs': 100, 'heads': 1, 'dropout': 0.3, 'weight_decay': 0.001, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 1 with value: 0.31226875772699714.
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 25.64 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.662160, Valid_loss 0.625399
Epoch 2, Train Loss 0.641592, Valid_loss 0.584928
Epoch 3, Train Loss 0.575626, Valid_loss 0.612422
Epoch 4, Train Loss 0.498127, Valid_loss 0.489982
Epoch 5, Train Loss 0.661104, Valid_loss 0.799477
Epoch 6, Train Loss 0.617668, Valid_loss 0.510213
Epoch 7, Train Loss 0.578343, Valid_loss 0.544515
Epoch 8, Train Loss 0.492697, Valid_loss 0.530342
Epoch 9, Train Loss 0.562697, Valid_loss 0.777606
Epoch 10, Train Loss 0.627956, Valid_loss 0.476794
Epoch 11, Train Loss 0.468544, Valid_loss 0.496892
Epoch 12, Train Loss 0.453490, Valid_loss 0.523711
Epoch 13, Train Loss 0.443406, Valid_loss 0.893710
Epoch 14, Train Loss 0.788728, Valid_loss 0.668227
Epoch 15, Train Loss 0.492216, Valid_loss 0.501572
Epoch 16, Train Loss 0.526573, Valid_loss 0.449321
Epoch 17, Train Loss 0.472118, Valid_loss 0.448817
Epoch 18, Train Loss 0.446953, Valid_loss 0.493443
Epoch 19, Train Loss 0.461197, Valid_loss 0.553511
Epoch 20, Train Loss 0.417805, Valid_loss 0.455453
Epoch 21, Train Loss 0.477120, Valid_loss 0.449450
Epoch 22, Train Loss 0.430036, Valid_loss 0.403668
Epoch 23, Train Loss 0.412662, Valid_loss 0.451516
Epoch 24, Train Loss 0.440544, Valid_loss 0.355636
Epoch 25, Train Loss 0.405633, Valid_loss 0.394216
Epoch 26, Train Loss 0.402771, Valid_loss 0.407050
Epoch 27, Train Loss 0.349926, Valid_loss 0.442855
Epoch 28, Train Loss 0.407048, Valid_loss 0.373858
Epoch 29, Train Loss 0.439689, Valid_loss 0.412997
Epoch 30, Train Loss 0.396214, Valid_loss 0.551494
Epoch 31, Train Loss 0.394329, Valid_loss 0.579917
Epoch 32, Train Loss 0.387857, Valid_loss 0.540990
Epoch 33, Train Loss 0.411877, Valid_loss 0.638566
Epoch 34, Train Loss 0.386751, Valid_loss 0.414192
Epoch 35, Train Loss 0.350539, Valid_loss 0.689103
Epoch 36, Train Loss 0.372990, Valid_loss 0.696643
Epoch 37, Train Loss 0.378995, Valid_loss 0.395020
Epoch 38, Train Loss 0.342705, Valid_loss 0.617385
Epoch 39, Train Loss 0.360289, Valid_loss 0.770004
Epoch 40, Train Loss 0.368731, Valid_loss 0.439209
Epoch 41, Train Loss 0.344055, Valid_loss 0.650175
Epoch 42, Train Loss 0.315447, Valid_loss 0.523176
Epoch 43, Train Loss 0.336112, Valid_loss 0.517221
Epoch 44, Train Loss 0.359253, Valid_loss 0.693666
Epoch 45, Train Loss 0.341824, Valid_loss 0.491853
Epoch 46, Train Loss 0.313317, Valid_loss 0.481387
Epoch 47, Train Loss 0.302456, Valid_loss 0.559661
Epoch 48, Train Loss 0.326986, Valid_loss 0.447672
Epoch 49, Train Loss 0.328515, Valid_loss 0.537641
Epoch 50, Train Loss 0.336563, Valid_loss 0.458344
Epoch 51, Train Loss 0.338101, Valid_loss 0.537537
Epoch 52, Train Loss 0.312403, Valid_loss 0.518492
Epoch 53, Train Loss 0.306833, Valid_loss 0.577795
Epoch 54, Train Loss 0.280671, Valid_loss 0.474355
Epoch 55, Train Loss 0.288315, Valid_loss 0.543292
Epoch 56, Train Loss 0.285531, Valid_loss 0.520769
Epoch 57, Train Loss 0.321155, Valid_loss 0.553484
Epoch 58, Train Loss 0.304837, Valid_loss 0.486166
Epoch 59, Train Loss 0.296885, Valid_loss 0.411703
Epoch 60, Train Loss 0.316465, Valid_loss 0.419624
Epoch 61, Train Loss 0.299702, Valid_loss 0.498051
[I 2025-08-31 17:46:38,493] Trial 2 finished with value: 0.35563611957643715 and parameters: {'learning_rate': 0.01, 'epochs': 100, 'heads': 2, 'dropout': 0.5, 'weight_decay': 0.001, 'emb_dim': 8, 'augment_num': 100, 'pca': False}. Best is trial 1 with value: 0.31226875772699714.
선택된 trial params: {'learning_rate': 0.001, 'epochs': 100, 'heads': 1, 'dropout': 0.3, 'weight_decay': 0.001, 'emb_dim': 32, 'augment_num': 100, 'pca': False}
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=10, batch_size=1 -> steps=10
output_class :  1
Memory Allocated: 26.96 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.577260, Valid_loss 0.457626
Epoch 2, Train Loss 0.433231, Valid_loss 0.487466
Epoch 3, Train Loss 0.390873, Valid_loss 0.467819
Epoch 4, Train Loss 0.350790, Valid_loss 0.406132
Epoch 5, Train Loss 0.338089, Valid_loss 0.526632
Epoch 6, Train Loss 0.315931, Valid_loss 0.454289
Epoch 7, Train Loss 0.322071, Valid_loss 0.447430
Epoch 8, Train Loss 0.296188, Valid_loss 0.652695
Epoch 9, Train Loss 0.282096, Valid_loss 0.429396
Epoch 10, Train Loss 0.306395, Valid_loss 0.609004
Epoch 11, Train Loss 0.283367, Valid_loss 0.417136
Epoch 12, Train Loss 0.271264, Valid_loss 0.384070
Epoch 13, Train Loss 0.275632, Valid_loss 0.386029
Epoch 14, Train Loss 0.270098, Valid_loss 0.374495
Epoch 15, Train Loss 0.267759, Valid_loss 0.407227
Epoch 16, Train Loss 0.258600, Valid_loss 0.395037
Epoch 17, Train Loss 0.260187, Valid_loss 0.367750
Epoch 18, Train Loss 0.250461, Valid_loss 0.371929
Epoch 19, Train Loss 0.249645, Valid_loss 0.402365
Epoch 20, Train Loss 0.253953, Valid_loss 0.486492
Epoch 21, Train Loss 0.254669, Valid_loss 0.759921
Epoch 22, Train Loss 0.260416, Valid_loss 0.500916
Epoch 23, Train Loss 0.249966, Valid_loss 0.384956
Epoch 24, Train Loss 0.240442, Valid_loss 0.388112
Epoch 25, Train Loss 0.240836, Valid_loss 0.384996
Epoch 26, Train Loss 0.235993, Valid_loss 0.531319
Epoch 27, Train Loss 0.239086, Valid_loss 0.624172
Epoch 28, Train Loss 0.245066, Valid_loss 0.396231
Epoch 29, Train Loss 0.234332, Valid_loss 0.472563
Epoch 30, Train Loss 0.248975, Valid_loss 0.435529
Epoch 31, Train Loss 0.233936, Valid_loss 0.442154
Epoch 32, Train Loss 0.240416, Valid_loss 0.372110
Epoch 33, Train Loss 0.229239, Valid_loss 0.370213
Epoch 34, Train Loss 0.226679, Valid_loss 0.359635
Epoch 35, Train Loss 0.229430, Valid_loss 0.383951
Epoch 36, Train Loss 0.224584, Valid_loss 0.512885
Epoch 37, Train Loss 0.259942, Valid_loss 0.543149
Epoch 38, Train Loss 0.238348, Valid_loss 0.337416
Epoch 39, Train Loss 0.232012, Valid_loss 0.492970
Epoch 40, Train Loss 0.230899, Valid_loss 0.457156
Epoch 41, Train Loss 0.225039, Valid_loss 0.379309
Epoch 42, Train Loss 0.220918, Valid_loss 0.469440
Epoch 43, Train Loss 0.222592, Valid_loss 0.365409
Epoch 44, Train Loss 0.219416, Valid_loss 0.467311
Epoch 45, Train Loss 0.222013, Valid_loss 0.364199
Epoch 46, Train Loss 0.221003, Valid_loss 0.395937
Epoch 47, Train Loss 0.219708, Valid_loss 0.431395
Epoch 48, Train Loss 0.223805, Valid_loss 0.389964
Epoch 49, Train Loss 0.227173, Valid_loss 0.417411
Epoch 50, Train Loss 0.216658, Valid_loss 0.410757
Epoch 51, Train Loss 0.209508, Valid_loss 0.371724
Epoch 52, Train Loss 0.213735, Valid_loss 0.425409
Epoch 53, Train Loss 0.220681, Valid_loss 0.348828
Epoch 54, Train Loss 0.218599, Valid_loss 0.389933
Epoch 55, Train Loss 0.222195, Valid_loss 0.412368
환자ID=COVID19_Participant10 -- true: 1 -- pred: 0
환자ID=COVID19_Participant12 -- true: 1 -- pred: 1
환자ID=COVID19_Participant20 -- true: 1 -- pred: 1
환자ID=COVID19_Participant27 -- true: 1 -- pred: 1
환자ID=COVID19_Participant30 -- true: 1 -- pred: 1
환자ID=COVID19_Participant4 -- true: 1 -- pred: 1
환자ID=COVID19_Participant7 -- true: 1 -- pred: 1
환자ID=Control_Participant5 -- true: 0 -- pred: 0
환자ID=Control_Participant8 -- true: 0 -- pred: 0
환자ID=Control_Participant9 -- true: 0 -- pred: 0
Best performance: Epoch 38, Loss 0.238348, Test ACC 0.900000, Test AUC 0.904762, Test Recall 0.857143, Test Precision 1.000000
Confusion Matrix:
 [3 0 1 6]
✅ Total valid splits used: 1
🔁 Repeat 2, Fold 1
cell type :  GTCGGGGGGTGG_Control_Participant7        Keratinocytes
CAAATCAATTAT_Control_Participant7     Epithelial_cells
ATACAATTGACA_Control_Participant7     Epithelial_cells
CTGTTAATGAGA_Control_Participant7     Epithelial_cells
CTTCACATTATT_Control_Participant7     Epithelial_cells
                                            ...       
GCAGGGAACTCC_COVID19_Participant30    Epithelial_cells
CAGCACCGAGCC_COVID19_Participant30    Epithelial_cells
GCCCCTTGTGAT_COVID19_Participant30    Epithelial_cells
GTGTTGTGTGTC_COVID19_Participant30              B_cell
TAACACTCACTT_COVID19_Participant30           Myelocyte
Name: singler_annotation, Length: 22203, dtype: string
cell type annotation :  GTCGGGGGGTGG_Control_Participant7        Keratinocytes
CAAATCAATTAT_Control_Participant7     Epithelial_cells
ATACAATTGACA_Control_Participant7     Epithelial_cells
CTGTTAATGAGA_Control_Participant7     Epithelial_cells
CTTCACATTATT_Control_Participant7     Epithelial_cells
                                            ...       
GCAGGGAACTCC_COVID19_Participant30    Epithelial_cells
CAGCACCGAGCC_COVID19_Participant30    Epithelial_cells
GCCCCTTGTGAT_COVID19_Participant30    Epithelial_cells
GTGTTGTGTGTC_COVID19_Participant30              B_cell
TAACACTCACTT_COVID19_Participant30           Myelocyte
Name: singler_annotation, Length: 22203, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Keratinocytes', 'Epithelial_cells', 'Neurons', 'iPS_cells', 'Embryonic_stem_cells', 'Astrocyte', 'DC', 'Gametocytes', 'HSC_-G-CSF', 'Smooth_muscle_cells', 'BM & Prog.', 'Monocyte', 'Myelocyte', 'BM', 'Endothelial_cells', 'Osteoblasts', 'Platelets', 'Erythroblast', 'NK_cell', 'T_cells', 'Chondrocytes', 'HSC_CD34+', 'CMP', 'Neutrophils', 'Fibroblasts', 'MEP', 'Neuroepithelial_cell', 'MSC', 'Pro-Myelocyte', 'B_cell', 'GMP', 'Hepatocytes', 'Macrophage', 'Tissue_stem_cells', 'Pre-B_cell_CD34-', 'Pro-B_cell_CD34+', 'Unknown']
라벨별 그룹 개수 {1: 28, 0: 12}
cell type :  CGAACGGACTCC_Control_Participant12       Epithelial_cells
GTGTCCTGGGGT_Control_Participant12    Smooth_muscle_cells
ATTTGCCTGTCG_Control_Participant12       Epithelial_cells
TCTCTAAAGTGT_Control_Participant12                Neurons
TAGAGACAACGA_Control_Participant12       Epithelial_cells
                                             ...         
TTTCTGCACTGC_COVID19_Participant23       Epithelial_cells
AACGAGTGTGCT_COVID19_Participant23       Epithelial_cells
AGCATCCCACTA_COVID19_Participant23       Epithelial_cells
CACAAACCTGAG_COVID19_Participant23       Epithelial_cells
ATAGCGAGTAGG_COVID19_Participant23      Endothelial_cells
Name: singler_annotation, Length: 4744, dtype: string
cell type annotation :  CGAACGGACTCC_Control_Participant12       Epithelial_cells
GTGTCCTGGGGT_Control_Participant12    Smooth_muscle_cells
ATTTGCCTGTCG_Control_Participant12       Epithelial_cells
TCTCTAAAGTGT_Control_Participant12                Neurons
TAGAGACAACGA_Control_Participant12       Epithelial_cells
                                             ...         
TTTCTGCACTGC_COVID19_Participant23       Epithelial_cells
AACGAGTGTGCT_COVID19_Participant23       Epithelial_cells
AGCATCCCACTA_COVID19_Participant23       Epithelial_cells
CACAAACCTGAG_COVID19_Participant23       Epithelial_cells
ATAGCGAGTAGG_COVID19_Participant23      Endothelial_cells
Name: singler_annotation, Length: 4744, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Epithelial_cells', 'Smooth_muscle_cells', 'Neurons', 'Erythroblast', 'Keratinocytes', 'T_cells', 'Gametocytes', 'B_cell', 'Neutrophils', 'HSC_CD34+', 'MSC', 'Embryonic_stem_cells', 'Neuroepithelial_cell', 'Macrophage', 'NK_cell', 'Platelets', 'Monocyte', 'DC', 'Endothelial_cells', 'Pre-B_cell_CD34-', 'Myelocyte', 'MEP', 'Hepatocytes', 'Astrocyte', 'BM', 'HSC_-G-CSF', 'BM & Prog.', 'Osteoblasts', 'CMP', 'GMP', 'Pro-B_cell_CD34+', 'Chondrocytes', 'Fibroblasts', 'Unknown', 'Pro-Myelocyte', 'iPS_cells']
라벨별 그룹 개수 {1: 7, 0: 3}
🔍 Split #2
  → train_p_index 환자 수 (환자 단위로 묶인 index list): 40
  → test_p_index 환자 수  (환자 단위로 묶인 index list): 10
  → train 환자 ID: ['COVID19_Participant10', 'COVID19_Participant11', 'COVID19_Participant12', 'COVID19_Participant13', 'COVID19_Participant14', 'COVID19_Participant15', 'COVID19_Participant17', 'COVID19_Participant18', 'COVID19_Participant19', 'COVID19_Participant2', 'COVID19_Participant20', 'COVID19_Participant21', 'COVID19_Participant22', 'COVID19_Participant25', 'COVID19_Participant27', 'COVID19_Participant28', 'COVID19_Participant29', 'COVID19_Participant3', 'COVID19_Participant30', 'COVID19_Participant31', 'COVID19_Participant32', 'COVID19_Participant39', 'COVID19_Participant4', 'COVID19_Participant40', 'COVID19_Participant5', 'COVID19_Participant6', 'COVID19_Participant7', 'COVID19_Participant9', 'Control_Participant1', 'Control_Participant10', 'Control_Participant11', 'Control_Participant13', 'Control_Participant14', 'Control_Participant15', 'Control_Participant2', 'Control_Participant5', 'Control_Participant6', 'Control_Participant7', 'Control_Participant8', 'Control_Participant9']
  → test  환자 ID: ['COVID19_Participant23', 'COVID19_Participant26', 'COVID19_Participant35', 'COVID19_Participant36', 'COVID19_Participant37', 'COVID19_Participant38', 'COVID19_Participant8', 'Control_Participant12', 'Control_Participant3', 'Control_Participant4']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant10, Label: 1
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant12, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant18, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant21, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant27, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant3, Label: 1
    ID: COVID19_Participant30, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: COVID19_Participant5, Label: 1
    ID: COVID19_Participant6, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: COVID19_Participant9, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant10, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant13, Label: 0
    ID: Control_Participant14, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant2, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant6, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant8, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant35, Label: 1
    ID: COVID19_Participant36, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant38, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: Control_Participant12, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant4, Label: 0
전체 데이터 index 길이 50
label_stat (train 환자 라벨 목록) 갯수 40
train_data에서 환자 단위로, train과 validation 나누기
기존 train_p_index 40
기존 (train) label_stat 40
train-vali 분할 후! 
train y 의 classes : {0, 1} valid y 의 classes : {0, 1} label_stat 의 classes : {0, 1}
train_p_index_ 26
valid_p_index 14
test_p_index 10
→ train 환자 ID 및 라벨:
   총 개수: 26
   환자ID=Control_Participant10, Label=0, 셀개수=1645
   환자ID=Control_Participant15, Label=0, 셀개수=528
   환자ID=COVID19_Participant17, Label=1, 셀개수=843
   환자ID=COVID19_Participant39, Label=1, 셀개수=454
   환자ID=COVID19_Participant10, Label=1, 셀개수=18
   환자ID=Control_Participant6, Label=0, 셀개수=131
   환자ID=COVID19_Participant13, Label=1, 셀개수=730
   환자ID=COVID19_Participant18, Label=1, 셀개수=227
   환자ID=COVID19_Participant40, Label=1, 셀개수=381
   환자ID=COVID19_Participant12, Label=1, 셀개수=102
   환자ID=COVID19_Participant19, Label=1, 셀개수=816
   환자ID=Control_Participant2, Label=0, 셀개수=41
   환자ID=COVID19_Participant25, Label=1, 셀개수=496
   환자ID=Control_Participant8, Label=0, 셀개수=393
   환자ID=Control_Participant7, Label=0, 셀개수=762
   환자ID=COVID19_Participant14, Label=1, 셀개수=382
   환자ID=Control_Participant9, Label=0, 셀개수=558
   환자ID=Control_Participant11, Label=0, 셀개수=1164
   환자ID=COVID19_Participant20, Label=1, 셀개수=2033
   환자ID=COVID19_Participant29, Label=1, 셀개수=573
   환자ID=COVID19_Participant22, Label=1, 셀개수=865
   환자ID=COVID19_Participant15, Label=1, 셀개수=1003
   환자ID=COVID19_Participant6, Label=1, 셀개수=84
   환자ID=COVID19_Participant4, Label=1, 셀개수=1680
   환자ID=COVID19_Participant32, Label=1, 셀개수=1665
   환자ID=COVID19_Participant28, Label=1, 셀개수=1079
→ valid 환자 ID 및 라벨:
   총 개수: 14
   환자ID=Control_Participant14, Label=0, 셀개수=274
   환자ID=COVID19_Participant27, Label=1, 셀개수=93
   환자ID=COVID19_Participant30, Label=1, 셀개수=116
   환자ID=COVID19_Participant3, Label=1, 셀개수=104
   환자ID=COVID19_Participant5, Label=1, 셀개수=89
   환자ID=COVID19_Participant2, Label=1, 셀개수=329
   환자ID=Control_Participant5, Label=0, 셀개수=717
   환자ID=Control_Participant1, Label=0, 셀개수=414
   환자ID=COVID19_Participant9, Label=1, 셀개수=86
   환자ID=COVID19_Participant7, Label=1, 셀개수=409
   환자ID=Control_Participant13, Label=0, 셀개수=88
   환자ID=COVID19_Participant31, Label=1, 셀개수=410
   환자ID=COVID19_Participant11, Label=1, 셀개수=382
   환자ID=COVID19_Participant21, Label=1, 셀개수=39
→ test 환자 ID 및 라벨:
   총 개수: 10
   환자ID=COVID19_Participant23, Label=1, 셀개수=307
   환자ID=COVID19_Participant26, Label=1, 셀개수=814
   환자ID=COVID19_Participant35, Label=1, 셀개수=83
   환자ID=COVID19_Participant36, Label=1, 셀개수=200
   환자ID=COVID19_Participant37, Label=1, 셀개수=668
   환자ID=COVID19_Participant38, Label=1, 셀개수=51
   환자ID=COVID19_Participant8, Label=1, 셀개수=462
   환자ID=Control_Participant12, Label=0, 셀개수=99
   환자ID=Control_Participant3, Label=0, 셀개수=1620
   환자ID=Control_Participant4, Label=0, 셀개수=440
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Keratinocytes', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Neurons', 'iPS_cells', 'Embryonic_stem_cells', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
전체 데이터 길이 26947
전체 cell type 길이 0            Keratinocytes
1         Epithelial_cells
2         Epithelial_cells
3         Epithelial_cells
4         Epithelial_cells
               ...        
26942     Epithelial_cells
26943     Epithelial_cells
26944     Epithelial_cells
26945     Epithelial_cells
26946    Endothelial_cells
Length: 26947, dtype: string
cell type의 NaN 개수 체크 0
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:11,  8.65it/s]  2%|▏         | 2/100 [00:00<00:11,  8.69it/s]  3%|▎         | 3/100 [00:00<00:11,  8.15it/s]  4%|▍         | 4/100 [00:00<00:11,  8.32it/s]  6%|▌         | 6/100 [00:00<00:10,  9.03it/s]  7%|▋         | 7/100 [00:00<00:10,  9.26it/s]  9%|▉         | 9/100 [00:00<00:09,  9.91it/s] 10%|█         | 10/100 [00:01<00:09,  9.80it/s] 11%|█         | 11/100 [00:01<00:09,  9.70it/s] 12%|█▏        | 12/100 [00:01<00:09,  9.56it/s] 13%|█▎        | 13/100 [00:01<00:09,  8.75it/s] 14%|█▍        | 14/100 [00:01<00:11,  7.50it/s] 15%|█▌        | 15/100 [00:01<00:10,  7.83it/s] 16%|█▌        | 16/100 [00:01<00:10,  8.04it/s] 17%|█▋        | 17/100 [00:01<00:09,  8.48it/s] 18%|█▊        | 18/100 [00:02<00:09,  8.59it/s] 19%|█▉        | 19/100 [00:02<00:09,  8.55it/s] 20%|██        | 20/100 [00:02<00:09,  8.78it/s] 21%|██        | 21/100 [00:02<00:08,  8.87it/s] 23%|██▎       | 23/100 [00:02<00:08,  9.23it/s] 24%|██▍       | 24/100 [00:02<00:08,  9.12it/s] 25%|██▌       | 25/100 [00:02<00:08,  8.97it/s] 26%|██▌       | 26/100 [00:03<00:09,  7.46it/s] 27%|██▋       | 27/100 [00:03<00:09,  7.83it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.14it/s] 29%|██▉       | 29/100 [00:03<00:08,  8.55it/s] 31%|███       | 31/100 [00:03<00:07,  9.43it/s] 32%|███▏      | 32/100 [00:03<00:07,  9.06it/s] 33%|███▎      | 33/100 [00:03<00:07,  8.84it/s] 34%|███▍      | 34/100 [00:03<00:07,  8.90it/s] 35%|███▌      | 35/100 [00:03<00:07,  8.96it/s] 36%|███▌      | 36/100 [00:04<00:07,  9.05it/s] 38%|███▊      | 38/100 [00:04<00:06,  9.36it/s] 39%|███▉      | 39/100 [00:04<00:06,  9.11it/s] 40%|████      | 40/100 [00:04<00:07,  8.22it/s] 41%|████      | 41/100 [00:04<00:07,  7.71it/s] 42%|████▏     | 42/100 [00:04<00:07,  7.95it/s] 43%|████▎     | 43/100 [00:04<00:06,  8.39it/s] 44%|████▍     | 44/100 [00:05<00:06,  8.58it/s] 45%|████▌     | 45/100 [00:05<00:07,  7.48it/s] 46%|████▌     | 46/100 [00:05<00:06,  7.97it/s] 47%|████▋     | 47/100 [00:05<00:06,  8.22it/s] 48%|████▊     | 48/100 [00:05<00:06,  8.16it/s] 49%|████▉     | 49/100 [00:05<00:06,  8.16it/s] 50%|█████     | 50/100 [00:05<00:06,  8.10it/s] 51%|█████     | 51/100 [00:05<00:05,  8.44it/s] 52%|█████▏    | 52/100 [00:06<00:05,  8.55it/s] 53%|█████▎    | 53/100 [00:06<00:05,  8.59it/s] 54%|█████▍    | 54/100 [00:06<00:05,  8.72it/s] 55%|█████▌    | 55/100 [00:06<00:05,  8.77it/s] 56%|█████▌    | 56/100 [00:06<00:05,  8.73it/s] 57%|█████▋    | 57/100 [00:06<00:04,  8.94it/s] 58%|█████▊    | 58/100 [00:06<00:04,  8.95it/s] 59%|█████▉    | 59/100 [00:06<00:04,  9.20it/s] 60%|██████    | 60/100 [00:06<00:04,  8.08it/s] 61%|██████    | 61/100 [00:07<00:04,  8.15it/s] 62%|██████▏   | 62/100 [00:07<00:04,  8.34it/s] 63%|██████▎   | 63/100 [00:07<00:04,  8.33it/s] 64%|██████▍   | 64/100 [00:07<00:04,  7.57it/s] 65%|██████▌   | 65/100 [00:07<00:04,  7.86it/s] 66%|██████▌   | 66/100 [00:07<00:04,  8.18it/s] 67%|██████▋   | 67/100 [00:07<00:03,  8.41it/s] 68%|██████▊   | 68/100 [00:07<00:03,  8.78it/s] 69%|██████▉   | 69/100 [00:08<00:03,  8.94it/s] 70%|███████   | 70/100 [00:08<00:03,  8.91it/s] 71%|███████   | 71/100 [00:08<00:03,  8.91it/s] 72%|███████▏  | 72/100 [00:08<00:03,  7.56it/s] 73%|███████▎  | 73/100 [00:08<00:03,  8.05it/s] 74%|███████▍  | 74/100 [00:08<00:03,  8.09it/s] 75%|███████▌  | 75/100 [00:08<00:03,  8.15it/s] 76%|███████▌  | 76/100 [00:08<00:02,  8.47it/s] 77%|███████▋  | 77/100 [00:09<00:02,  8.60it/s] 78%|███████▊  | 78/100 [00:09<00:02,  8.25it/s] 79%|███████▉  | 79/100 [00:09<00:02,  8.40it/s] 80%|████████  | 80/100 [00:09<00:02,  8.63it/s] 81%|████████  | 81/100 [00:09<00:02,  7.90it/s] 82%|████████▏ | 82/100 [00:09<00:02,  7.90it/s] 83%|████████▎ | 83/100 [00:09<00:02,  7.96it/s] 84%|████████▍ | 84/100 [00:09<00:01,  8.04it/s] 85%|████████▌ | 85/100 [00:09<00:01,  8.39it/s] 86%|████████▌ | 86/100 [00:10<00:01,  8.29it/s] 87%|████████▋ | 87/100 [00:10<00:01,  8.07it/s] 88%|████████▊ | 88/100 [00:10<00:01,  7.60it/s] 89%|████████▉ | 89/100 [00:10<00:01,  7.73it/s] 90%|█████████ | 90/100 [00:10<00:01,  8.01it/s] 91%|█████████ | 91/100 [00:10<00:01,  8.03it/s] 92%|█████████▏| 92/100 [00:10<00:00,  8.10it/s] 93%|█████████▎| 93/100 [00:11<00:00,  8.17it/s] 94%|█████████▍| 94/100 [00:11<00:00,  8.00it/s] 95%|█████████▌| 95/100 [00:11<00:00,  8.11it/s] 96%|█████████▌| 96/100 [00:11<00:00,  8.06it/s] 97%|█████████▋| 97/100 [00:11<00:00,  7.52it/s] 98%|█████████▊| 98/100 [00:11<00:00,  7.73it/s] 99%|█████████▉| 99/100 [00:11<00:00,  7.92it/s]100%|██████████| 100/100 [00:11<00:00,  8.06it/s]100%|██████████| 100/100 [00:11<00:00,  8.41it/s]
[I 2025-08-31 17:50:16,844] A new study created in memory with name: no-name-14b93890-4a5b-4a0e-b3b1-de58b117332f
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 29.04 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.676723, Valid_loss 0.600250
Epoch 2, Train Loss 0.633118, Valid_loss 0.603703
Epoch 3, Train Loss 0.631281, Valid_loss 0.600060
Epoch 4, Train Loss 0.606631, Valid_loss 0.601773
Epoch 5, Train Loss 0.635640, Valid_loss 0.601217
Epoch 6, Train Loss 0.619848, Valid_loss 0.602733
Epoch 7, Train Loss 0.607228, Valid_loss 0.599546
Epoch 8, Train Loss 0.624507, Valid_loss 0.598520
Epoch 9, Train Loss 0.612452, Valid_loss 0.599083
Epoch 10, Train Loss 0.581677, Valid_loss 0.479280
Epoch 11, Train Loss 0.635198, Valid_loss 0.590473
Epoch 12, Train Loss 0.609137, Valid_loss 0.584982
Epoch 13, Train Loss 0.560593, Valid_loss 0.766656
Epoch 14, Train Loss 0.550200, Valid_loss 0.645410
Epoch 15, Train Loss 0.537804, Valid_loss 0.590253
Epoch 16, Train Loss 0.620559, Valid_loss 0.604178
Epoch 17, Train Loss 0.528547, Valid_loss 0.696079
Epoch 18, Train Loss 0.473988, Valid_loss 0.606174
Epoch 19, Train Loss 0.479409, Valid_loss 0.637166
Epoch 20, Train Loss 0.468972, Valid_loss 0.502281
Epoch 21, Train Loss 0.422149, Valid_loss 0.487475
Epoch 22, Train Loss 0.378813, Valid_loss 0.697353
Epoch 23, Train Loss 0.461705, Valid_loss 0.610810
Epoch 24, Train Loss 0.351174, Valid_loss 0.687772
Epoch 25, Train Loss 0.329537, Valid_loss 0.517771
Epoch 26, Train Loss 0.295785, Valid_loss 0.441898
Epoch 27, Train Loss 0.278061, Valid_loss 0.533155
Epoch 28, Train Loss 0.301470, Valid_loss 0.329720
Epoch 29, Train Loss 0.280525, Valid_loss 0.371686
Epoch 30, Train Loss 0.277419, Valid_loss 0.443885
Epoch 31, Train Loss 0.295355, Valid_loss 0.402178
Epoch 32, Train Loss 0.238835, Valid_loss 0.544038
Epoch 33, Train Loss 0.266432, Valid_loss 0.369178
Epoch 34, Train Loss 0.296560, Valid_loss 0.520608
Epoch 35, Train Loss 0.272831, Valid_loss 0.516203
Epoch 36, Train Loss 0.248601, Valid_loss 0.396294
Epoch 37, Train Loss 0.236345, Valid_loss 0.438167
Epoch 38, Train Loss 0.254277, Valid_loss 0.545304
Epoch 39, Train Loss 0.233767, Valid_loss 0.543668
Epoch 40, Train Loss 0.318856, Valid_loss 0.579996
Epoch 41, Train Loss 0.308739, Valid_loss 0.542321
Epoch 42, Train Loss 0.283810, Valid_loss 0.497708
Epoch 43, Train Loss 0.261336, Valid_loss 0.780075
Epoch 44, Train Loss 0.262780, Valid_loss 0.742771
Epoch 45, Train Loss 0.252455, Valid_loss 0.732178
Epoch 46, Train Loss 0.242597, Valid_loss 0.579548
Epoch 47, Train Loss 0.234977, Valid_loss 0.719936
Epoch 48, Train Loss 0.242154, Valid_loss 0.614317
Epoch 49, Train Loss 0.267078, Valid_loss 0.512617
Epoch 50, Train Loss 0.433277, Valid_loss 0.483376
Epoch 51, Train Loss 0.267556, Valid_loss 0.898726
Epoch 52, Train Loss 0.246568, Valid_loss 0.479850
Epoch 53, Train Loss 0.237147, Valid_loss 0.384183
Epoch 54, Train Loss 0.258190, Valid_loss 0.370406
Epoch 55, Train Loss 0.252405, Valid_loss 0.443486
Epoch 56, Train Loss 0.233076, Valid_loss 0.391338
Epoch 57, Train Loss 0.212890, Valid_loss 0.388116
Epoch 58, Train Loss 0.216434, Valid_loss 0.389878
Epoch 59, Train Loss 0.220822, Valid_loss 0.386391
Epoch 60, Train Loss 0.215686, Valid_loss 0.380372
Epoch 61, Train Loss 0.224874, Valid_loss 0.395677
Epoch 62, Train Loss 0.212743, Valid_loss 0.399280
[I 2025-08-31 17:54:25,625] Trial 0 finished with value: 0.3297198110127023 and parameters: {'learning_rate': 0.01, 'epochs': 100, 'heads': 2, 'dropout': 0.3, 'weight_decay': 0.001, 'emb_dim': 64, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.3297198110127023.
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 26.96 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.673087, Valid_loss 0.599254
Epoch 2, Train Loss 0.649173, Valid_loss 0.602735
Epoch 3, Train Loss 0.595315, Valid_loss 0.598338
Epoch 4, Train Loss 0.589360, Valid_loss 0.605712
Epoch 5, Train Loss 0.502575, Valid_loss 0.567642
Epoch 6, Train Loss 0.473153, Valid_loss 0.721691
Epoch 7, Train Loss 0.396964, Valid_loss 0.694155
Epoch 8, Train Loss 0.350582, Valid_loss 0.758514
Epoch 9, Train Loss 0.356439, Valid_loss 0.881562
Epoch 10, Train Loss 0.325693, Valid_loss 0.949079
Epoch 11, Train Loss 0.332373, Valid_loss 0.992990
Epoch 12, Train Loss 0.306878, Valid_loss 0.967310
Epoch 13, Train Loss 0.340391, Valid_loss 1.025765
Epoch 14, Train Loss 0.327618, Valid_loss 0.985359
Epoch 15, Train Loss 0.312711, Valid_loss 0.946961
Epoch 16, Train Loss 0.286668, Valid_loss 1.076971
Epoch 17, Train Loss 0.288367, Valid_loss 1.097302
Epoch 18, Train Loss 0.301012, Valid_loss 1.091740
Epoch 19, Train Loss 0.291014, Valid_loss 1.150820
Epoch 20, Train Loss 0.279781, Valid_loss 1.118422
Epoch 21, Train Loss 0.273788, Valid_loss 1.231624
Epoch 22, Train Loss 0.323621, Valid_loss 1.281421
Epoch 23, Train Loss 0.297809, Valid_loss 1.242953
Epoch 24, Train Loss 0.283661, Valid_loss 1.139554
Epoch 25, Train Loss 0.266075, Valid_loss 1.212914
Epoch 26, Train Loss 0.247201, Valid_loss 1.288567
Epoch 27, Train Loss 0.245690, Valid_loss 1.317642
Epoch 28, Train Loss 0.271194, Valid_loss 1.379365
Epoch 29, Train Loss 0.270250, Valid_loss 1.481550
Epoch 30, Train Loss 0.238176, Valid_loss 1.493999
Epoch 31, Train Loss 0.223588, Valid_loss 1.574605
Epoch 32, Train Loss 0.239474, Valid_loss 1.736777
Epoch 33, Train Loss 0.231135, Valid_loss 2.131973
Epoch 34, Train Loss 0.260808, Valid_loss 1.639910
Epoch 35, Train Loss 0.259673, Valid_loss 1.232208
Epoch 36, Train Loss 0.234989, Valid_loss 0.375141
Epoch 37, Train Loss 0.227516, Valid_loss 0.401432
Epoch 38, Train Loss 0.254031, Valid_loss 0.716373
Epoch 39, Train Loss 0.303120, Valid_loss 0.816340
Epoch 40, Train Loss 0.272476, Valid_loss 0.634070
Epoch 41, Train Loss 0.263998, Valid_loss 0.774767
Epoch 42, Train Loss 0.276639, Valid_loss 0.678419
Epoch 43, Train Loss 0.260581, Valid_loss 0.702498
Epoch 44, Train Loss 0.242786, Valid_loss 0.683843
Epoch 45, Train Loss 0.303918, Valid_loss 1.130600
Epoch 46, Train Loss 0.235472, Valid_loss 1.756579
Epoch 47, Train Loss 0.259070, Valid_loss 1.976643
Epoch 48, Train Loss 0.260337, Valid_loss 1.444401
Epoch 49, Train Loss 0.247630, Valid_loss 1.432200
Epoch 50, Train Loss 0.244807, Valid_loss 1.324922
Epoch 51, Train Loss 0.226223, Valid_loss 1.310394
Epoch 52, Train Loss 0.241788, Valid_loss 1.160632
Epoch 53, Train Loss 0.257850, Valid_loss 1.157082
Epoch 54, Train Loss 0.246658, Valid_loss 0.723158
Epoch 55, Train Loss 0.244056, Valid_loss 0.710333
Epoch 56, Train Loss 0.250821, Valid_loss 0.695833
Epoch 57, Train Loss 0.238449, Valid_loss 0.810295
Epoch 58, Train Loss 0.214066, Valid_loss 1.092061
[I 2025-08-31 17:58:00,279] Trial 1 finished with value: 0.3751410831298147 and parameters: {'learning_rate': 0.01, 'epochs': 100, 'heads': 1, 'dropout': 0.7, 'weight_decay': 0.0001, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.3297198110127023.
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 25.64 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.784088, Valid_loss 0.711337
Epoch 2, Train Loss 0.719360, Valid_loss 0.681609
Epoch 3, Train Loss 0.708918, Valid_loss 0.662280
Epoch 4, Train Loss 0.682151, Valid_loss 0.644558
Epoch 5, Train Loss 0.668462, Valid_loss 0.632190
Epoch 6, Train Loss 0.659003, Valid_loss 0.622072
Epoch 7, Train Loss 0.636812, Valid_loss 0.605695
Epoch 8, Train Loss 0.609564, Valid_loss 0.561165
Epoch 9, Train Loss 0.566829, Valid_loss 0.537034
Epoch 10, Train Loss 0.537078, Valid_loss 0.527508
Epoch 11, Train Loss 0.557224, Valid_loss 0.491439
Epoch 12, Train Loss 0.513269, Valid_loss 0.457863
Epoch 13, Train Loss 0.503161, Valid_loss 0.429366
Epoch 14, Train Loss 0.470790, Valid_loss 0.438529
Epoch 15, Train Loss 0.479430, Valid_loss 0.410855
Epoch 16, Train Loss 0.441895, Valid_loss 0.376267
Epoch 17, Train Loss 0.398597, Valid_loss 0.365900
Epoch 18, Train Loss 0.398247, Valid_loss 0.404151
Epoch 19, Train Loss 0.420103, Valid_loss 0.412529
Epoch 20, Train Loss 0.401119, Valid_loss 0.435966
Epoch 21, Train Loss 0.418662, Valid_loss 0.328659
Epoch 22, Train Loss 0.401218, Valid_loss 0.336519
Epoch 23, Train Loss 0.376787, Valid_loss 0.352546
Epoch 24, Train Loss 0.349007, Valid_loss 0.314998
Epoch 25, Train Loss 0.380840, Valid_loss 0.357837
Epoch 26, Train Loss 0.387193, Valid_loss 0.305613
Epoch 27, Train Loss 0.373953, Valid_loss 0.356684
Epoch 28, Train Loss 0.369478, Valid_loss 0.321292
Epoch 29, Train Loss 0.377151, Valid_loss 0.406307
Epoch 30, Train Loss 0.362681, Valid_loss 0.329754
Epoch 31, Train Loss 0.362719, Valid_loss 0.320710
Epoch 32, Train Loss 0.354841, Valid_loss 0.299947
Epoch 33, Train Loss 0.382371, Valid_loss 0.315149
Epoch 34, Train Loss 0.345956, Valid_loss 0.302504
Epoch 35, Train Loss 0.320883, Valid_loss 0.363085
Epoch 36, Train Loss 0.315189, Valid_loss 0.303075
Epoch 37, Train Loss 0.310512, Valid_loss 0.321191
Epoch 38, Train Loss 0.355368, Valid_loss 0.315500
Epoch 39, Train Loss 0.311221, Valid_loss 0.333310
Epoch 40, Train Loss 0.335940, Valid_loss 0.462794
Epoch 41, Train Loss 0.297071, Valid_loss 0.405331
Epoch 42, Train Loss 0.313072, Valid_loss 0.325010
Epoch 43, Train Loss 0.326503, Valid_loss 0.340945
Epoch 44, Train Loss 0.301766, Valid_loss 0.316969
Epoch 45, Train Loss 0.284152, Valid_loss 0.354398
Epoch 46, Train Loss 0.325675, Valid_loss 0.332963
Epoch 47, Train Loss 0.280538, Valid_loss 0.386456
Epoch 48, Train Loss 0.302170, Valid_loss 0.332919
Epoch 49, Train Loss 0.323115, Valid_loss 0.372476
Epoch 50, Train Loss 0.331677, Valid_loss 0.379652
Epoch 51, Train Loss 0.302742, Valid_loss 0.342318
Epoch 52, Train Loss 0.294132, Valid_loss 0.363408
Epoch 53, Train Loss 0.319867, Valid_loss 0.347727
Epoch 54, Train Loss 0.294350, Valid_loss 0.337573
Epoch 55, Train Loss 0.279191, Valid_loss 0.329988
Epoch 56, Train Loss 0.276171, Valid_loss 0.351799
Epoch 57, Train Loss 0.290826, Valid_loss 0.324954
Epoch 58, Train Loss 0.279635, Valid_loss 0.337112
Epoch 59, Train Loss 0.291248, Valid_loss 0.344766
[I 2025-08-31 18:01:55,396] Trial 2 finished with value: 0.2999470297779356 and parameters: {'learning_rate': 0.001, 'epochs': 100, 'heads': 2, 'dropout': 0.3, 'weight_decay': 0.001, 'emb_dim': 8, 'augment_num': 100, 'pca': False}. Best is trial 2 with value: 0.2999470297779356.
선택된 trial params: {'learning_rate': 0.001, 'epochs': 100, 'heads': 2, 'dropout': 0.3, 'weight_decay': 0.001, 'emb_dim': 8, 'augment_num': 100, 'pca': False}
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=10, batch_size=1 -> steps=10
output_class :  1
Memory Allocated: 25.64 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.652520, Valid_loss 0.622295
Epoch 2, Train Loss 0.637274, Valid_loss 0.609076
Epoch 3, Train Loss 0.620685, Valid_loss 0.598758
Epoch 4, Train Loss 0.610349, Valid_loss 0.590674
Epoch 5, Train Loss 0.603405, Valid_loss 0.588901
Epoch 6, Train Loss 0.602094, Valid_loss 0.558162
Epoch 7, Train Loss 0.559840, Valid_loss 0.550876
Epoch 8, Train Loss 0.519030, Valid_loss 0.549287
Epoch 9, Train Loss 0.534637, Valid_loss 0.520306
Epoch 10, Train Loss 0.514662, Valid_loss 0.477909
Epoch 11, Train Loss 0.505748, Valid_loss 0.475907
Epoch 12, Train Loss 0.461308, Valid_loss 0.447172
Epoch 13, Train Loss 0.439923, Valid_loss 0.416160
Epoch 14, Train Loss 0.482632, Valid_loss 0.444589
Epoch 15, Train Loss 0.446199, Valid_loss 0.371962
Epoch 16, Train Loss 0.405645, Valid_loss 0.387504
Epoch 17, Train Loss 0.397427, Valid_loss 0.343493
Epoch 18, Train Loss 0.395304, Valid_loss 0.347597
Epoch 19, Train Loss 0.382843, Valid_loss 0.358036
Epoch 20, Train Loss 0.391277, Valid_loss 0.373514
Epoch 21, Train Loss 0.405597, Valid_loss 0.469690
Epoch 22, Train Loss 0.383565, Valid_loss 0.380039
Epoch 23, Train Loss 0.387446, Valid_loss 0.350916
Epoch 24, Train Loss 0.356538, Valid_loss 0.411180
Epoch 25, Train Loss 0.362040, Valid_loss 0.417069
Epoch 26, Train Loss 0.338383, Valid_loss 0.316170
Epoch 27, Train Loss 0.353633, Valid_loss 0.306668
Epoch 28, Train Loss 0.332871, Valid_loss 0.295287
Epoch 29, Train Loss 0.338056, Valid_loss 0.330338
Epoch 30, Train Loss 0.357458, Valid_loss 0.441756
Epoch 31, Train Loss 0.373854, Valid_loss 0.456715
Epoch 32, Train Loss 0.368282, Valid_loss 0.301880
Epoch 33, Train Loss 0.339907, Valid_loss 0.376844
Epoch 34, Train Loss 0.326543, Valid_loss 0.339991
Epoch 35, Train Loss 0.348269, Valid_loss 0.320979
Epoch 36, Train Loss 0.317268, Valid_loss 0.313345
Epoch 37, Train Loss 0.348277, Valid_loss 0.359225
Epoch 38, Train Loss 0.316569, Valid_loss 0.479943
Epoch 39, Train Loss 0.346311, Valid_loss 0.388260
Epoch 40, Train Loss 0.318602, Valid_loss 0.324864
Epoch 41, Train Loss 0.322623, Valid_loss 0.350500
Epoch 42, Train Loss 0.309331, Valid_loss 0.390695
Epoch 43, Train Loss 0.304110, Valid_loss 0.352315
Epoch 44, Train Loss 0.315139, Valid_loss 0.340368
Epoch 45, Train Loss 0.297469, Valid_loss 0.378256
Epoch 46, Train Loss 0.294325, Valid_loss 0.371410
Epoch 47, Train Loss 0.288843, Valid_loss 0.360546
Epoch 48, Train Loss 0.313332, Valid_loss 0.424713
Epoch 49, Train Loss 0.292651, Valid_loss 0.377535
Epoch 50, Train Loss 0.288692, Valid_loss 0.432073
Epoch 51, Train Loss 0.339195, Valid_loss 0.447554
Epoch 52, Train Loss 0.299969, Valid_loss 0.371519
Epoch 53, Train Loss 0.287575, Valid_loss 0.385340
Epoch 54, Train Loss 0.320707, Valid_loss 0.373329
Epoch 55, Train Loss 0.281593, Valid_loss 0.403434
Epoch 56, Train Loss 0.281174, Valid_loss 0.386942
Epoch 57, Train Loss 0.284667, Valid_loss 0.395586
Epoch 58, Train Loss 0.292318, Valid_loss 0.397119
환자ID=COVID19_Participant23 -- true: 1 -- pred: 1
환자ID=COVID19_Participant26 -- true: 1 -- pred: 1
환자ID=COVID19_Participant35 -- true: 1 -- pred: 0
환자ID=COVID19_Participant36 -- true: 1 -- pred: 1
환자ID=COVID19_Participant37 -- true: 1 -- pred: 1
환자ID=COVID19_Participant38 -- true: 1 -- pred: 0
환자ID=COVID19_Participant8 -- true: 1 -- pred: 1
환자ID=Control_Participant12 -- true: 0 -- pred: 0
환자ID=Control_Participant3 -- true: 0 -- pred: 0
환자ID=Control_Participant4 -- true: 0 -- pred: 1
Best performance: Epoch 28, Loss 0.332871, Test ACC 0.700000, Test AUC 0.857143, Test Recall 0.714286, Test Precision 0.833333
Confusion Matrix:
 [2 1 2 5]
✅ Total valid splits used: 2
🔁 Repeat 2, Fold 2
cell type :  GTCGGGGGGTGG_Control_Participant7        Keratinocytes
CAAATCAATTAT_Control_Participant7     Epithelial_cells
ATACAATTGACA_Control_Participant7     Epithelial_cells
CTGTTAATGAGA_Control_Participant7     Epithelial_cells
CTTCACATTATT_Control_Participant7     Epithelial_cells
                                            ...       
GCAGGGAACTCC_COVID19_Participant30    Epithelial_cells
CAGCACCGAGCC_COVID19_Participant30    Epithelial_cells
GCCCCTTGTGAT_COVID19_Participant30    Epithelial_cells
GTGTTGTGTGTC_COVID19_Participant30              B_cell
TAACACTCACTT_COVID19_Participant30           Myelocyte
Name: singler_annotation, Length: 21042, dtype: string
cell type annotation :  GTCGGGGGGTGG_Control_Participant7        Keratinocytes
CAAATCAATTAT_Control_Participant7     Epithelial_cells
ATACAATTGACA_Control_Participant7     Epithelial_cells
CTGTTAATGAGA_Control_Participant7     Epithelial_cells
CTTCACATTATT_Control_Participant7     Epithelial_cells
                                            ...       
GCAGGGAACTCC_COVID19_Participant30    Epithelial_cells
CAGCACCGAGCC_COVID19_Participant30    Epithelial_cells
GCCCCTTGTGAT_COVID19_Participant30    Epithelial_cells
GTGTTGTGTGTC_COVID19_Participant30              B_cell
TAACACTCACTT_COVID19_Participant30           Myelocyte
Name: singler_annotation, Length: 21042, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Keratinocytes', 'Epithelial_cells', 'Neurons', 'iPS_cells', 'Embryonic_stem_cells', 'Astrocyte', 'DC', 'Gametocytes', 'HSC_-G-CSF', 'Smooth_muscle_cells', 'BM & Prog.', 'Monocyte', 'Myelocyte', 'BM', 'Endothelial_cells', 'Osteoblasts', 'Platelets', 'Erythroblast', 'NK_cell', 'T_cells', 'Chondrocytes', 'HSC_CD34+', 'CMP', 'Neutrophils', 'Fibroblasts', 'MEP', 'Neuroepithelial_cell', 'MSC', 'Pro-Myelocyte', 'B_cell', 'GMP', 'Hepatocytes', 'Macrophage', 'Tissue_stem_cells', 'Pre-B_cell_CD34-', 'Pro-B_cell_CD34+', 'Unknown']
라벨별 그룹 개수 {1: 28, 0: 12}
cell type :  TGGGATTACAGG_Control_Participant2       Keratinocytes
TCTGTGCTTGAG_Control_Participant2    Epithelial_cells
TCTACACCCTGA_Control_Participant2        Erythroblast
AGCCCTCGTCAT_Control_Participant2         Hepatocytes
TCGAGCAAGCTT_Control_Participant2             Neurons
                                           ...       
GTGTCGCGCCTG_Control_Participant6    Epithelial_cells
TGGAATTATGAT_Control_Participant6                 CMP
TAGTCGAGACGT_Control_Participant6    Epithelial_cells
CTCCAGTGGCAC_Control_Participant6    Epithelial_cells
GAATAGACGACA_Control_Participant6    Epithelial_cells
Name: singler_annotation, Length: 5905, dtype: string
cell type annotation :  TGGGATTACAGG_Control_Participant2       Keratinocytes
TCTGTGCTTGAG_Control_Participant2    Epithelial_cells
TCTACACCCTGA_Control_Participant2        Erythroblast
AGCCCTCGTCAT_Control_Participant2         Hepatocytes
TCGAGCAAGCTT_Control_Participant2             Neurons
                                           ...       
GTGTCGCGCCTG_Control_Participant6    Epithelial_cells
TGGAATTATGAT_Control_Participant6                 CMP
TAGTCGAGACGT_Control_Participant6    Epithelial_cells
CTCCAGTGGCAC_Control_Participant6    Epithelial_cells
GAATAGACGACA_Control_Participant6    Epithelial_cells
Name: singler_annotation, Length: 5905, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Keratinocytes', 'Epithelial_cells', 'Erythroblast', 'Hepatocytes', 'Neurons', 'Neutrophils', 'Astrocyte', 'Smooth_muscle_cells', 'CMP', 'Macrophage', 'T_cells', 'Platelets', 'Gametocytes', 'Monocyte', 'NK_cell', 'Embryonic_stem_cells', 'DC', 'GMP', 'HSC_CD34+', 'iPS_cells', 'MEP', 'Chondrocytes', 'Pre-B_cell_CD34-', 'Fibroblasts', 'B_cell', 'Endothelial_cells', 'Pro-Myelocyte', 'Tissue_stem_cells', 'Myelocyte', 'HSC_-G-CSF', 'Osteoblasts', 'BM', 'MSC', 'Neuroepithelial_cell', 'BM & Prog.', 'Pro-B_cell_CD34+']
라벨별 그룹 개수 {1: 7, 0: 3}
🔍 Split #3
  → train_p_index 환자 수 (환자 단위로 묶인 index list): 40
  → test_p_index 환자 수  (환자 단위로 묶인 index list): 10
  → train 환자 ID: ['COVID19_Participant10', 'COVID19_Participant11', 'COVID19_Participant12', 'COVID19_Participant13', 'COVID19_Participant14', 'COVID19_Participant18', 'COVID19_Participant19', 'COVID19_Participant2', 'COVID19_Participant20', 'COVID19_Participant21', 'COVID19_Participant23', 'COVID19_Participant25', 'COVID19_Participant26', 'COVID19_Participant27', 'COVID19_Participant29', 'COVID19_Participant30', 'COVID19_Participant31', 'COVID19_Participant35', 'COVID19_Participant36', 'COVID19_Participant37', 'COVID19_Participant38', 'COVID19_Participant39', 'COVID19_Participant4', 'COVID19_Participant40', 'COVID19_Participant5', 'COVID19_Participant6', 'COVID19_Participant7', 'COVID19_Participant8', 'Control_Participant1', 'Control_Participant10', 'Control_Participant11', 'Control_Participant12', 'Control_Participant14', 'Control_Participant15', 'Control_Participant3', 'Control_Participant4', 'Control_Participant5', 'Control_Participant7', 'Control_Participant8', 'Control_Participant9']
  → test  환자 ID: ['COVID19_Participant15', 'COVID19_Participant17', 'COVID19_Participant22', 'COVID19_Participant28', 'COVID19_Participant3', 'COVID19_Participant32', 'COVID19_Participant9', 'Control_Participant13', 'Control_Participant2', 'Control_Participant6']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant10, Label: 1
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant12, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant18, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant21, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant27, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant30, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant35, Label: 1
    ID: COVID19_Participant36, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant38, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: COVID19_Participant5, Label: 1
    ID: COVID19_Participant6, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant10, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant12, Label: 0
    ID: Control_Participant14, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant4, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant8, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant3, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant9, Label: 1
    ID: Control_Participant13, Label: 0
    ID: Control_Participant2, Label: 0
    ID: Control_Participant6, Label: 0
전체 데이터 index 길이 50
label_stat (train 환자 라벨 목록) 갯수 40
train_data에서 환자 단위로, train과 validation 나누기
기존 train_p_index 40
기존 (train) label_stat 40
train-vali 분할 후! 
train y 의 classes : {0, 1} valid y 의 classes : {0, 1} label_stat 의 classes : {0, 1}
train_p_index_ 26
valid_p_index 14
test_p_index 10
→ train 환자 ID 및 라벨:
   총 개수: 26
   환자ID=Control_Participant10, Label=0, 셀개수=1645
   환자ID=Control_Participant15, Label=0, 셀개수=528
   환자ID=COVID19_Participant19, Label=1, 셀개수=816
   환자ID=COVID19_Participant39, Label=1, 셀개수=454
   환자ID=COVID19_Participant10, Label=1, 셀개수=18
   환자ID=Control_Participant5, Label=0, 셀개수=717
   환자ID=COVID19_Participant13, Label=1, 셀개수=730
   환자ID=COVID19_Participant2, Label=1, 셀개수=329
   환자ID=COVID19_Participant40, Label=1, 셀개수=381
   환자ID=COVID19_Participant12, Label=1, 셀개수=102
   환자ID=COVID19_Participant20, Label=1, 셀개수=2033
   환자ID=Control_Participant3, Label=0, 셀개수=1620
   환자ID=COVID19_Participant27, Label=1, 셀개수=93
   환자ID=Control_Participant8, Label=0, 셀개수=393
   환자ID=Control_Participant7, Label=0, 셀개수=762
   환자ID=COVID19_Participant14, Label=1, 셀개수=382
   환자ID=Control_Participant9, Label=0, 셀개수=558
   환자ID=Control_Participant11, Label=0, 셀개수=1164
   환자ID=COVID19_Participant23, Label=1, 셀개수=307
   환자ID=COVID19_Participant31, Label=1, 셀개수=410
   환자ID=COVID19_Participant26, Label=1, 셀개수=814
   환자ID=COVID19_Participant18, Label=1, 셀개수=227
   환자ID=COVID19_Participant6, Label=1, 셀개수=84
   환자ID=COVID19_Participant4, Label=1, 셀개수=1680
   환자ID=COVID19_Participant38, Label=1, 셀개수=51
   환자ID=COVID19_Participant30, Label=1, 셀개수=116
→ valid 환자 ID 및 라벨:
   총 개수: 14
   환자ID=Control_Participant14, Label=0, 셀개수=274
   환자ID=COVID19_Participant29, Label=1, 셀개수=573
   환자ID=COVID19_Participant36, Label=1, 셀개수=200
   환자ID=COVID19_Participant35, Label=1, 셀개수=83
   환자ID=COVID19_Participant5, Label=1, 셀개수=89
   환자ID=COVID19_Participant21, Label=1, 셀개수=39
   환자ID=Control_Participant4, Label=0, 셀개수=440
   환자ID=Control_Participant1, Label=0, 셀개수=414
   환자ID=COVID19_Participant8, Label=1, 셀개수=462
   환자ID=COVID19_Participant7, Label=1, 셀개수=409
   환자ID=Control_Participant12, Label=0, 셀개수=99
   환자ID=COVID19_Participant37, Label=1, 셀개수=668
   환자ID=COVID19_Participant11, Label=1, 셀개수=382
   환자ID=COVID19_Participant25, Label=1, 셀개수=496
→ test 환자 ID 및 라벨:
   총 개수: 10
   환자ID=COVID19_Participant15, Label=1, 셀개수=1003
   환자ID=COVID19_Participant17, Label=1, 셀개수=843
   환자ID=COVID19_Participant22, Label=1, 셀개수=865
   환자ID=COVID19_Participant28, Label=1, 셀개수=1079
   환자ID=COVID19_Participant3, Label=1, 셀개수=104
   환자ID=COVID19_Participant32, Label=1, 셀개수=1665
   환자ID=COVID19_Participant9, Label=1, 셀개수=86
   환자ID=Control_Participant13, Label=0, 셀개수=88
   환자ID=Control_Participant2, Label=0, 셀개수=41
   환자ID=Control_Participant6, Label=0, 셀개수=131
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Keratinocytes', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Neurons', 'iPS_cells', 'Embryonic_stem_cells', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
전체 데이터 길이 26947
전체 cell type 길이 0           Keratinocytes
1        Epithelial_cells
2        Epithelial_cells
3        Epithelial_cells
4        Epithelial_cells
               ...       
26942    Epithelial_cells
26943                 CMP
26944    Epithelial_cells
26945    Epithelial_cells
26946    Epithelial_cells
Length: 26947, dtype: string
cell type의 NaN 개수 체크 0
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:10,  9.86it/s]  2%|▏         | 2/100 [00:00<00:10,  9.75it/s]  3%|▎         | 3/100 [00:00<00:10,  9.46it/s]  4%|▍         | 4/100 [00:00<00:12,  7.90it/s]  5%|▌         | 5/100 [00:00<00:11,  8.38it/s]  6%|▌         | 6/100 [00:00<00:11,  8.21it/s]  8%|▊         | 8/100 [00:00<00:10,  9.07it/s]  9%|▉         | 9/100 [00:01<00:10,  8.58it/s] 11%|█         | 11/100 [00:01<00:09,  9.46it/s] 12%|█▏        | 12/100 [00:01<00:09,  9.49it/s] 14%|█▍        | 14/100 [00:01<00:08,  9.56it/s] 15%|█▌        | 15/100 [00:01<00:08,  9.60it/s] 16%|█▌        | 16/100 [00:01<00:08,  9.47it/s] 18%|█▊        | 18/100 [00:01<00:08,  9.80it/s] 19%|█▉        | 19/100 [00:02<00:08,  9.74it/s] 20%|██        | 20/100 [00:02<00:08,  9.19it/s] 21%|██        | 21/100 [00:02<00:08,  9.22it/s] 22%|██▏       | 22/100 [00:02<00:08,  9.16it/s] 23%|██▎       | 23/100 [00:02<00:08,  9.29it/s] 24%|██▍       | 24/100 [00:02<00:08,  8.81it/s] 25%|██▌       | 25/100 [00:02<00:08,  8.63it/s] 26%|██▌       | 26/100 [00:02<00:10,  7.38it/s] 27%|██▋       | 27/100 [00:03<00:09,  7.76it/s] 29%|██▉       | 29/100 [00:03<00:08,  8.74it/s] 30%|███       | 30/100 [00:03<00:10,  6.76it/s] 31%|███       | 31/100 [00:03<00:09,  7.29it/s] 32%|███▏      | 32/100 [00:03<00:08,  7.74it/s] 33%|███▎      | 33/100 [00:03<00:08,  7.79it/s] 34%|███▍      | 34/100 [00:03<00:08,  8.22it/s] 35%|███▌      | 35/100 [00:04<00:07,  8.64it/s] 36%|███▌      | 36/100 [00:04<00:08,  7.35it/s] 37%|███▋      | 37/100 [00:04<00:08,  7.70it/s] 38%|███▊      | 38/100 [00:04<00:07,  7.75it/s] 39%|███▉      | 39/100 [00:04<00:07,  7.84it/s] 40%|████      | 40/100 [00:04<00:07,  8.30it/s] 41%|████      | 41/100 [00:04<00:06,  8.68it/s] 42%|████▏     | 42/100 [00:04<00:06,  9.01it/s] 43%|████▎     | 43/100 [00:05<00:06,  8.92it/s] 44%|████▍     | 44/100 [00:05<00:06,  8.82it/s] 45%|████▌     | 45/100 [00:05<00:06,  9.06it/s] 46%|████▌     | 46/100 [00:05<00:06,  8.72it/s] 47%|████▋     | 47/100 [00:05<00:06,  8.38it/s] 48%|████▊     | 48/100 [00:05<00:06,  8.62it/s] 49%|████▉     | 49/100 [00:05<00:05,  8.68it/s] 50%|█████     | 50/100 [00:05<00:05,  8.61it/s] 51%|█████     | 51/100 [00:05<00:05,  8.37it/s] 52%|█████▏    | 52/100 [00:06<00:05,  8.44it/s] 53%|█████▎    | 53/100 [00:06<00:06,  7.55it/s] 54%|█████▍    | 54/100 [00:06<00:05,  7.90it/s] 55%|█████▌    | 55/100 [00:06<00:05,  8.08it/s] 56%|█████▌    | 56/100 [00:06<00:06,  7.30it/s] 57%|█████▋    | 57/100 [00:06<00:05,  7.70it/s] 58%|█████▊    | 58/100 [00:06<00:05,  8.12it/s] 59%|█████▉    | 59/100 [00:06<00:04,  8.52it/s] 60%|██████    | 60/100 [00:07<00:04,  8.30it/s] 61%|██████    | 61/100 [00:07<00:04,  8.53it/s] 62%|██████▏   | 62/100 [00:07<00:04,  8.86it/s] 63%|██████▎   | 63/100 [00:07<00:04,  8.74it/s] 64%|██████▍   | 64/100 [00:07<00:04,  8.91it/s] 65%|██████▌   | 65/100 [00:07<00:03,  9.10it/s] 66%|██████▌   | 66/100 [00:07<00:03,  9.18it/s] 67%|██████▋   | 67/100 [00:07<00:03,  8.85it/s] 68%|██████▊   | 68/100 [00:07<00:03,  8.83it/s] 69%|██████▉   | 69/100 [00:08<00:03,  8.44it/s] 70%|███████   | 70/100 [00:08<00:03,  8.13it/s] 71%|███████   | 71/100 [00:08<00:03,  8.42it/s] 72%|███████▏  | 72/100 [00:08<00:03,  8.57it/s] 73%|███████▎  | 73/100 [00:08<00:03,  8.74it/s] 74%|███████▍  | 74/100 [00:08<00:02,  8.84it/s] 75%|███████▌  | 75/100 [00:08<00:03,  7.85it/s] 76%|███████▌  | 76/100 [00:08<00:02,  8.21it/s] 77%|███████▋  | 77/100 [00:09<00:02,  8.49it/s] 78%|███████▊  | 78/100 [00:09<00:02,  8.45it/s] 79%|███████▉  | 79/100 [00:09<00:02,  8.58it/s] 80%|████████  | 80/100 [00:09<00:02,  8.44it/s] 81%|████████  | 81/100 [00:09<00:02,  8.45it/s] 82%|████████▏ | 82/100 [00:09<00:02,  8.02it/s] 83%|████████▎ | 83/100 [00:09<00:02,  8.38it/s] 84%|████████▍ | 84/100 [00:09<00:01,  8.42it/s] 85%|████████▌ | 85/100 [00:10<00:02,  6.22it/s] 86%|████████▌ | 86/100 [00:10<00:02,  6.75it/s] 87%|████████▋ | 87/100 [00:10<00:01,  7.17it/s] 88%|████████▊ | 88/100 [00:10<00:01,  7.56it/s] 89%|████████▉ | 89/100 [00:10<00:01,  7.82it/s] 90%|█████████ | 90/100 [00:10<00:01,  7.63it/s] 91%|█████████ | 91/100 [00:10<00:01,  7.23it/s] 92%|█████████▏| 92/100 [00:11<00:01,  7.33it/s] 93%|█████████▎| 93/100 [00:11<00:00,  7.77it/s] 94%|█████████▍| 94/100 [00:11<00:00,  7.88it/s] 95%|█████████▌| 95/100 [00:11<00:00,  8.03it/s] 96%|█████████▌| 96/100 [00:11<00:00,  8.12it/s] 97%|█████████▋| 97/100 [00:11<00:00,  8.21it/s] 98%|█████████▊| 98/100 [00:11<00:00,  8.14it/s] 99%|█████████▉| 99/100 [00:11<00:00,  8.06it/s]100%|██████████| 100/100 [00:11<00:00,  8.44it/s]100%|██████████| 100/100 [00:11<00:00,  8.34it/s]
[I 2025-08-31 18:05:59,810] A new study created in memory with name: no-name-085f5049-8995-4fb4-831f-bae4bd342ee8
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 25.64 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.612658, Valid_loss 0.491055
Epoch 2, Train Loss 0.472066, Valid_loss 0.418182
Epoch 3, Train Loss 0.464426, Valid_loss 0.459157
Epoch 4, Train Loss 0.391149, Valid_loss 0.412962
Epoch 5, Train Loss 0.332844, Valid_loss 0.317345
Epoch 6, Train Loss 0.384640, Valid_loss 0.402225
Epoch 7, Train Loss 0.383991, Valid_loss 0.321377
Epoch 8, Train Loss 0.299747, Valid_loss 0.501224
Epoch 9, Train Loss 0.357314, Valid_loss 0.312577
Epoch 10, Train Loss 0.289779, Valid_loss 0.312655
Epoch 11, Train Loss 0.279971, Valid_loss 0.362871
Epoch 12, Train Loss 0.293133, Valid_loss 0.320450
Epoch 13, Train Loss 0.250891, Valid_loss 0.333299
Epoch 14, Train Loss 0.283847, Valid_loss 0.344904
Epoch 15, Train Loss 0.309657, Valid_loss 0.328351
Epoch 16, Train Loss 0.285322, Valid_loss 0.350155
Epoch 17, Train Loss 0.300812, Valid_loss 0.355128
Epoch 18, Train Loss 0.304776, Valid_loss 0.330414
Epoch 19, Train Loss 0.292786, Valid_loss 0.289236
Epoch 20, Train Loss 0.265718, Valid_loss 0.283473
Epoch 21, Train Loss 0.273862, Valid_loss 0.353205
Epoch 22, Train Loss 0.272619, Valid_loss 0.313798
Epoch 23, Train Loss 0.270534, Valid_loss 0.312742
Epoch 24, Train Loss 0.270036, Valid_loss 0.366471
Epoch 25, Train Loss 0.274744, Valid_loss 0.353609
Epoch 26, Train Loss 0.276587, Valid_loss 0.286943
Epoch 27, Train Loss 0.239258, Valid_loss 0.313613
Epoch 28, Train Loss 0.260032, Valid_loss 0.249915
Epoch 29, Train Loss 0.253998, Valid_loss 0.331287
Epoch 30, Train Loss 0.237639, Valid_loss 0.310538
Epoch 31, Train Loss 0.235849, Valid_loss 0.333816
Epoch 32, Train Loss 0.273852, Valid_loss 0.273833
Epoch 33, Train Loss 0.252051, Valid_loss 0.235421
Epoch 34, Train Loss 0.218296, Valid_loss 0.280036
Epoch 35, Train Loss 0.231875, Valid_loss 0.244686
Epoch 36, Train Loss 0.241545, Valid_loss 0.315556
Epoch 37, Train Loss 0.325972, Valid_loss 0.378242
Epoch 38, Train Loss 0.281924, Valid_loss 0.651989
Epoch 39, Train Loss 0.283082, Valid_loss 0.261433
Epoch 40, Train Loss 0.246684, Valid_loss 0.258371
Epoch 41, Train Loss 0.235454, Valid_loss 0.276922
Epoch 42, Train Loss 0.229149, Valid_loss 0.273555
Epoch 43, Train Loss 0.228848, Valid_loss 0.304965
Epoch 44, Train Loss 0.246195, Valid_loss 0.233584
Epoch 45, Train Loss 0.213804, Valid_loss 0.293263
Epoch 46, Train Loss 0.211568, Valid_loss 0.288524
Epoch 47, Train Loss 0.227443, Valid_loss 0.281038
Epoch 48, Train Loss 0.273029, Valid_loss 0.283638
Epoch 49, Train Loss 0.294042, Valid_loss 0.340640
Epoch 50, Train Loss 0.226969, Valid_loss 0.303326
Epoch 51, Train Loss 0.244967, Valid_loss 0.268978
Epoch 52, Train Loss 0.232541, Valid_loss 0.237136
Epoch 53, Train Loss 0.255972, Valid_loss 0.297234
Epoch 54, Train Loss 0.219132, Valid_loss 0.311873
[I 2025-08-31 18:10:09,729] Trial 0 finished with value: 0.23358402933393205 and parameters: {'learning_rate': 0.01, 'epochs': 100, 'heads': 4, 'dropout': 0.3, 'weight_decay': 0.001, 'emb_dim': 8, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.23358402933393205.
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 25.64 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.754836, Valid_loss 0.711960
Epoch 2, Train Loss 0.719120, Valid_loss 0.673589
Epoch 3, Train Loss 0.703598, Valid_loss 0.577343
Epoch 4, Train Loss 0.655055, Valid_loss 0.547806
Epoch 5, Train Loss 0.597671, Valid_loss 0.524474
Epoch 6, Train Loss 0.587088, Valid_loss 0.523655
Epoch 7, Train Loss 0.579222, Valid_loss 0.504954
Epoch 8, Train Loss 0.557803, Valid_loss 0.497706
Epoch 9, Train Loss 0.581588, Valid_loss 0.502738
Epoch 10, Train Loss 0.558008, Valid_loss 0.496550
Epoch 11, Train Loss 0.555374, Valid_loss 0.490575
Epoch 12, Train Loss 0.550701, Valid_loss 0.498426
Epoch 13, Train Loss 0.530192, Valid_loss 0.497173
Epoch 14, Train Loss 0.518376, Valid_loss 0.495518
Epoch 15, Train Loss 0.544557, Valid_loss 0.507991
Epoch 16, Train Loss 0.527912, Valid_loss 0.488277
Epoch 17, Train Loss 0.512735, Valid_loss 0.502287
Epoch 18, Train Loss 0.540316, Valid_loss 0.496886
Epoch 19, Train Loss 0.520003, Valid_loss 0.485797
Epoch 20, Train Loss 0.508541, Valid_loss 0.487486
Epoch 21, Train Loss 0.521220, Valid_loss 0.495347
Epoch 22, Train Loss 0.504638, Valid_loss 0.503486
Epoch 23, Train Loss 0.513365, Valid_loss 0.493856
Epoch 24, Train Loss 0.523770, Valid_loss 0.484692
Epoch 25, Train Loss 0.485646, Valid_loss 0.488977
Epoch 26, Train Loss 0.497982, Valid_loss 0.501937
Epoch 27, Train Loss 0.552211, Valid_loss 0.490445
Epoch 28, Train Loss 0.462383, Valid_loss 0.484420
Epoch 29, Train Loss 0.510149, Valid_loss 0.473365
Epoch 30, Train Loss 0.486915, Valid_loss 0.483483
Epoch 31, Train Loss 0.512094, Valid_loss 0.474698
Epoch 32, Train Loss 0.493649, Valid_loss 0.476049
Epoch 33, Train Loss 0.484272, Valid_loss 0.491763
Epoch 34, Train Loss 0.503575, Valid_loss 0.472753
Epoch 35, Train Loss 0.503504, Valid_loss 0.493961
Epoch 36, Train Loss 0.510666, Valid_loss 0.476616
Epoch 37, Train Loss 0.502591, Valid_loss 0.482935
Epoch 38, Train Loss 0.495877, Valid_loss 0.461640
Epoch 39, Train Loss 0.514889, Valid_loss 0.491317
Epoch 40, Train Loss 0.499764, Valid_loss 0.467787
Epoch 41, Train Loss 0.508499, Valid_loss 0.466688
Epoch 42, Train Loss 0.495285, Valid_loss 0.468201
Epoch 43, Train Loss 0.479177, Valid_loss 0.462277
Epoch 44, Train Loss 0.492375, Valid_loss 0.469475
Epoch 45, Train Loss 0.476988, Valid_loss 0.470130
Epoch 46, Train Loss 0.485633, Valid_loss 0.475302
Epoch 47, Train Loss 0.473024, Valid_loss 0.471374
Epoch 48, Train Loss 0.479614, Valid_loss 0.468346
Epoch 49, Train Loss 0.487449, Valid_loss 0.480442
Epoch 50, Train Loss 0.482318, Valid_loss 0.473462
Epoch 51, Train Loss 0.452024, Valid_loss 0.461572
Epoch 52, Train Loss 0.480979, Valid_loss 0.454461
Epoch 53, Train Loss 0.466068, Valid_loss 0.468882
Epoch 54, Train Loss 0.466891, Valid_loss 0.480630
[I 2025-08-31 18:13:30,658] Trial 1 finished with value: 0.4544606400387628 and parameters: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 1, 'dropout': 0.3, 'weight_decay': 0.0001, 'emb_dim': 8, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.23358402933393205.
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 25.64 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.688279, Valid_loss 0.640304
Epoch 2, Train Loss 0.681740, Valid_loss 0.635448
Epoch 3, Train Loss 0.664842, Valid_loss 0.632887
Epoch 4, Train Loss 0.683670, Valid_loss 0.631707
Epoch 5, Train Loss 0.657709, Valid_loss 0.628895
Epoch 6, Train Loss 0.697801, Valid_loss 0.628131
Epoch 7, Train Loss 0.702680, Valid_loss 0.626832
Epoch 8, Train Loss 0.671522, Valid_loss 0.622419
Epoch 9, Train Loss 0.678665, Valid_loss 0.618615
Epoch 10, Train Loss 0.668666, Valid_loss 0.615863
Epoch 11, Train Loss 0.630109, Valid_loss 0.611162
Epoch 12, Train Loss 0.657083, Valid_loss 0.607518
Epoch 13, Train Loss 0.629111, Valid_loss 0.604296
Epoch 14, Train Loss 0.641740, Valid_loss 0.596359
Epoch 15, Train Loss 0.654209, Valid_loss 0.594175
Epoch 16, Train Loss 0.623053, Valid_loss 0.589156
Epoch 17, Train Loss 0.607544, Valid_loss 0.579935
Epoch 18, Train Loss 0.620042, Valid_loss 0.587981
Epoch 19, Train Loss 0.607355, Valid_loss 0.581139
Epoch 20, Train Loss 0.597034, Valid_loss 0.576816
Epoch 21, Train Loss 0.577686, Valid_loss 0.574734
Epoch 22, Train Loss 0.583068, Valid_loss 0.555246
Epoch 23, Train Loss 0.583944, Valid_loss 0.561212
Epoch 24, Train Loss 0.563913, Valid_loss 0.564165
Epoch 25, Train Loss 0.567860, Valid_loss 0.556915
Epoch 26, Train Loss 0.544060, Valid_loss 0.563589
Epoch 27, Train Loss 0.566819, Valid_loss 0.549792
Epoch 28, Train Loss 0.538150, Valid_loss 0.561821
Epoch 29, Train Loss 0.558220, Valid_loss 0.552736
Epoch 30, Train Loss 0.539627, Valid_loss 0.534910
Epoch 31, Train Loss 0.530640, Valid_loss 0.548138
Epoch 32, Train Loss 0.542913, Valid_loss 0.556163
Epoch 33, Train Loss 0.522673, Valid_loss 0.550311
Epoch 34, Train Loss 0.514347, Valid_loss 0.560237
Epoch 35, Train Loss 0.559488, Valid_loss 0.554179
Epoch 36, Train Loss 0.553812, Valid_loss 0.546822
Epoch 37, Train Loss 0.539326, Valid_loss 0.531302
Epoch 38, Train Loss 0.522125, Valid_loss 0.560492
Epoch 39, Train Loss 0.551415, Valid_loss 0.538943
Epoch 40, Train Loss 0.513115, Valid_loss 0.546900
Epoch 41, Train Loss 0.550223, Valid_loss 0.553300
Epoch 42, Train Loss 0.538490, Valid_loss 0.534648
Epoch 43, Train Loss 0.534352, Valid_loss 0.560015
Epoch 44, Train Loss 0.510096, Valid_loss 0.566216
Epoch 45, Train Loss 0.512934, Valid_loss 0.544834
Epoch 46, Train Loss 0.510694, Valid_loss 0.556812
Epoch 47, Train Loss 0.513553, Valid_loss 0.519773
Epoch 48, Train Loss 0.528640, Valid_loss 0.540512
Epoch 49, Train Loss 0.538034, Valid_loss 0.542102
Epoch 50, Train Loss 0.557525, Valid_loss 0.546277
Epoch 51, Train Loss 0.494151, Valid_loss 0.537550
Epoch 52, Train Loss 0.483780, Valid_loss 0.536074
Epoch 53, Train Loss 0.508889, Valid_loss 0.545815
Epoch 54, Train Loss 0.494833, Valid_loss 0.555141
[I 2025-08-31 18:17:07,385] Trial 2 finished with value: 0.5197731554508209 and parameters: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 2, 'dropout': 0.5, 'weight_decay': 0.0001, 'emb_dim': 8, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.23358402933393205.
선택된 trial params: {'learning_rate': 0.01, 'epochs': 100, 'heads': 4, 'dropout': 0.3, 'weight_decay': 0.001, 'emb_dim': 8, 'augment_num': 100, 'pca': False}
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=10, batch_size=1 -> steps=10
output_class :  1
Memory Allocated: 25.64 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.659489, Valid_loss 0.571913
Epoch 2, Train Loss 0.575356, Valid_loss 0.498945
Epoch 3, Train Loss 0.463493, Valid_loss 0.371104
Epoch 4, Train Loss 0.403490, Valid_loss 0.406819
Epoch 5, Train Loss 0.359294, Valid_loss 0.424309
Epoch 6, Train Loss 0.361483, Valid_loss 0.288950
Epoch 7, Train Loss 0.283970, Valid_loss 0.316677
Epoch 8, Train Loss 0.339296, Valid_loss 0.583404
Epoch 9, Train Loss 0.328488, Valid_loss 0.459612
Epoch 10, Train Loss 0.290197, Valid_loss 0.360924
Epoch 11, Train Loss 0.290785, Valid_loss 0.606695
Epoch 12, Train Loss 0.335044, Valid_loss 0.476694
Epoch 13, Train Loss 0.310979, Valid_loss 0.322512
Epoch 14, Train Loss 0.294509, Valid_loss 0.286348
Epoch 15, Train Loss 0.297704, Valid_loss 0.287280
Epoch 16, Train Loss 0.294802, Valid_loss 0.305962
Epoch 17, Train Loss 0.314494, Valid_loss 0.332215
Epoch 18, Train Loss 0.251904, Valid_loss 0.344252
Epoch 19, Train Loss 0.235297, Valid_loss 0.362981
Epoch 20, Train Loss 0.236142, Valid_loss 0.298018
Epoch 21, Train Loss 0.224669, Valid_loss 0.264697
Epoch 22, Train Loss 0.224984, Valid_loss 0.276227
Epoch 23, Train Loss 0.256554, Valid_loss 0.370724
Epoch 24, Train Loss 0.257796, Valid_loss 0.366452
Epoch 25, Train Loss 0.254899, Valid_loss 0.307542
Epoch 26, Train Loss 0.281936, Valid_loss 0.310359
Epoch 27, Train Loss 0.223218, Valid_loss 0.294981
Epoch 28, Train Loss 0.283778, Valid_loss 0.363140
Epoch 29, Train Loss 0.248972, Valid_loss 0.339823
Epoch 30, Train Loss 0.243355, Valid_loss 0.371953
Epoch 31, Train Loss 0.234275, Valid_loss 0.339493
Epoch 32, Train Loss 0.243870, Valid_loss 0.312171
Epoch 33, Train Loss 0.242230, Valid_loss 0.378310
Epoch 34, Train Loss 0.246745, Valid_loss 0.240234
Epoch 35, Train Loss 0.241378, Valid_loss 0.323004
Epoch 36, Train Loss 0.294763, Valid_loss 0.294965
Epoch 37, Train Loss 0.282480, Valid_loss 0.278528
Epoch 38, Train Loss 0.259970, Valid_loss 0.516637
Epoch 39, Train Loss 0.276395, Valid_loss 0.337175
Epoch 40, Train Loss 0.246611, Valid_loss 0.326119
Epoch 41, Train Loss 0.253222, Valid_loss 0.278859
Epoch 42, Train Loss 0.224202, Valid_loss 0.311350
Epoch 43, Train Loss 0.224454, Valid_loss 0.255827
Epoch 44, Train Loss 0.231992, Valid_loss 0.276343
Epoch 45, Train Loss 0.230416, Valid_loss 0.342089
Epoch 46, Train Loss 0.228805, Valid_loss 0.341646
Epoch 47, Train Loss 0.228426, Valid_loss 0.285182
Epoch 48, Train Loss 0.242512, Valid_loss 0.277395
Epoch 49, Train Loss 0.231267, Valid_loss 0.486772
Epoch 50, Train Loss 0.289043, Valid_loss 0.376297
Epoch 51, Train Loss 0.253295, Valid_loss 0.370168
Epoch 52, Train Loss 0.231458, Valid_loss 0.316276
Epoch 53, Train Loss 0.220921, Valid_loss 0.304113
Epoch 54, Train Loss 0.211254, Valid_loss 0.287198
Epoch 55, Train Loss 0.216104, Valid_loss 0.292937
Epoch 56, Train Loss 0.206266, Valid_loss 0.283842
Epoch 57, Train Loss 0.205499, Valid_loss 0.315881
Epoch 58, Train Loss 0.205348, Valid_loss 0.221071
Epoch 59, Train Loss 0.198512, Valid_loss 0.226223
Epoch 60, Train Loss 0.213500, Valid_loss 0.234803
환자ID=COVID19_Participant15 -- true: 1 -- pred: 1
환자ID=COVID19_Participant17 -- true: 1 -- pred: 1
환자ID=COVID19_Participant22 -- true: 1 -- pred: 0
환자ID=COVID19_Participant28 -- true: 1 -- pred: 1
환자ID=COVID19_Participant3 -- true: 1 -- pred: 1
환자ID=COVID19_Participant32 -- true: 1 -- pred: 0
환자ID=COVID19_Participant9 -- true: 1 -- pred: 1
환자ID=Control_Participant13 -- true: 0 -- pred: 0
환자ID=Control_Participant2 -- true: 0 -- pred: 0
환자ID=Control_Participant6 -- true: 0 -- pred: 0
Best performance: Epoch 58, Loss 0.205348, Test ACC 0.800000, Test AUC 0.857143, Test Recall 0.714286, Test Precision 1.000000
Confusion Matrix:
 [3 0 2 5]
✅ Total valid splits used: 3
🔁 Repeat 2, Fold 3
cell type :  CATTAAGGATAT_COVID19_Participant13    Epithelial_cells
GTAGAAGGGGGG_COVID19_Participant13           Platelets
ATTAAGAGGTAG_COVID19_Participant13    Epithelial_cells
AGATATGACAAG_COVID19_Participant13    Epithelial_cells
CTTGTAACAAAT_COVID19_Participant13    Epithelial_cells
                                            ...       
GCAGGGAACTCC_COVID19_Participant30    Epithelial_cells
CAGCACCGAGCC_COVID19_Participant30    Epithelial_cells
GCCCCTTGTGAT_COVID19_Participant30    Epithelial_cells
GTGTTGTGTGTC_COVID19_Participant30              B_cell
TAACACTCACTT_COVID19_Participant30           Myelocyte
Name: singler_annotation, Length: 21084, dtype: string
cell type annotation :  CATTAAGGATAT_COVID19_Participant13    Epithelial_cells
GTAGAAGGGGGG_COVID19_Participant13           Platelets
ATTAAGAGGTAG_COVID19_Participant13    Epithelial_cells
AGATATGACAAG_COVID19_Participant13    Epithelial_cells
CTTGTAACAAAT_COVID19_Participant13    Epithelial_cells
                                            ...       
GCAGGGAACTCC_COVID19_Participant30    Epithelial_cells
CAGCACCGAGCC_COVID19_Participant30    Epithelial_cells
GCCCCTTGTGAT_COVID19_Participant30    Epithelial_cells
GTGTTGTGTGTC_COVID19_Participant30              B_cell
TAACACTCACTT_COVID19_Participant30           Myelocyte
Name: singler_annotation, Length: 21084, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Epithelial_cells', 'Platelets', 'Keratinocytes', 'Macrophage', 'B_cell', 'Neutrophils', 'DC', 'Monocyte', 'T_cells', 'NK_cell', 'HSC_CD34+', 'Tissue_stem_cells', 'Embryonic_stem_cells', 'HSC_-G-CSF', 'Neurons', 'BM', 'Erythroblast', 'Fibroblasts', 'iPS_cells', 'Hepatocytes', 'CMP', 'Gametocytes', 'Chondrocytes', 'Endothelial_cells', 'Pre-B_cell_CD34-', 'Myelocyte', 'Astrocyte', 'Neuroepithelial_cell', 'Smooth_muscle_cells', 'GMP', 'MSC', 'Osteoblasts', 'MEP', 'BM & Prog.', 'Pro-B_cell_CD34+', 'Unknown', 'Pro-Myelocyte']
라벨별 그룹 개수 {1: 28, 0: 12}
cell type :  GTCGGGGGGTGG_Control_Participant7        Keratinocytes
CAAATCAATTAT_Control_Participant7     Epithelial_cells
ATACAATTGACA_Control_Participant7     Epithelial_cells
CTGTTAATGAGA_Control_Participant7     Epithelial_cells
CTTCACATTATT_Control_Participant7     Epithelial_cells
                                            ...       
TCTAGGTGTCTA_COVID19_Participant18       Keratinocytes
TAAAACTATATT_COVID19_Participant18    Epithelial_cells
ACACGGTAAGAC_COVID19_Participant18    Epithelial_cells
CACAAACCCACG_COVID19_Participant18       Keratinocytes
TTTCAAACTTCT_COVID19_Participant18    Epithelial_cells
Name: singler_annotation, Length: 5863, dtype: string
cell type annotation :  GTCGGGGGGTGG_Control_Participant7        Keratinocytes
CAAATCAATTAT_Control_Participant7     Epithelial_cells
ATACAATTGACA_Control_Participant7     Epithelial_cells
CTGTTAATGAGA_Control_Participant7     Epithelial_cells
CTTCACATTATT_Control_Participant7     Epithelial_cells
                                            ...       
TCTAGGTGTCTA_COVID19_Participant18       Keratinocytes
TAAAACTATATT_COVID19_Participant18    Epithelial_cells
ACACGGTAAGAC_COVID19_Participant18    Epithelial_cells
CACAAACCCACG_COVID19_Participant18       Keratinocytes
TTTCAAACTTCT_COVID19_Participant18    Epithelial_cells
Name: singler_annotation, Length: 5863, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Keratinocytes', 'Epithelial_cells', 'Neurons', 'iPS_cells', 'Embryonic_stem_cells', 'Astrocyte', 'DC', 'Gametocytes', 'HSC_-G-CSF', 'Smooth_muscle_cells', 'BM & Prog.', 'Monocyte', 'Myelocyte', 'BM', 'Endothelial_cells', 'Osteoblasts', 'Platelets', 'Erythroblast', 'NK_cell', 'T_cells', 'Chondrocytes', 'HSC_CD34+', 'CMP', 'Neutrophils', 'Fibroblasts', 'MEP', 'Neuroepithelial_cell', 'MSC', 'Pro-Myelocyte', 'B_cell', 'GMP', 'Hepatocytes', 'Macrophage', 'Tissue_stem_cells', 'Pro-B_cell_CD34+', 'Pre-B_cell_CD34-', 'Unknown']
라벨별 그룹 개수 {1: 7, 0: 3}
🔍 Split #4
  → train_p_index 환자 수 (환자 단위로 묶인 index list): 40
  → test_p_index 환자 수  (환자 단위로 묶인 index list): 10
  → train 환자 ID: ['COVID19_Participant10', 'COVID19_Participant12', 'COVID19_Participant13', 'COVID19_Participant15', 'COVID19_Participant17', 'COVID19_Participant20', 'COVID19_Participant21', 'COVID19_Participant22', 'COVID19_Participant23', 'COVID19_Participant26', 'COVID19_Participant27', 'COVID19_Participant28', 'COVID19_Participant29', 'COVID19_Participant3', 'COVID19_Participant30', 'COVID19_Participant32', 'COVID19_Participant35', 'COVID19_Participant36', 'COVID19_Participant37', 'COVID19_Participant38', 'COVID19_Participant39', 'COVID19_Participant4', 'COVID19_Participant40', 'COVID19_Participant5', 'COVID19_Participant6', 'COVID19_Participant7', 'COVID19_Participant8', 'COVID19_Participant9', 'Control_Participant11', 'Control_Participant12', 'Control_Participant13', 'Control_Participant14', 'Control_Participant15', 'Control_Participant2', 'Control_Participant3', 'Control_Participant4', 'Control_Participant5', 'Control_Participant6', 'Control_Participant8', 'Control_Participant9']
  → test  환자 ID: ['COVID19_Participant11', 'COVID19_Participant14', 'COVID19_Participant18', 'COVID19_Participant19', 'COVID19_Participant2', 'COVID19_Participant25', 'COVID19_Participant31', 'Control_Participant1', 'Control_Participant10', 'Control_Participant7']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant10, Label: 1
    ID: COVID19_Participant12, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant21, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant27, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant3, Label: 1
    ID: COVID19_Participant30, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant35, Label: 1
    ID: COVID19_Participant36, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant38, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: COVID19_Participant5, Label: 1
    ID: COVID19_Participant6, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: COVID19_Participant9, Label: 1
    ID: Control_Participant11, Label: 0
    ID: Control_Participant12, Label: 0
    ID: Control_Participant13, Label: 0
    ID: Control_Participant14, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant2, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant4, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant6, Label: 0
    ID: Control_Participant8, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant18, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant10, Label: 0
    ID: Control_Participant7, Label: 0
전체 데이터 index 길이 50
label_stat (train 환자 라벨 목록) 갯수 40
train_data에서 환자 단위로, train과 validation 나누기
기존 train_p_index 40
기존 (train) label_stat 40
train-vali 분할 후! 
train y 의 classes : {0, 1} valid y 의 classes : {0, 1} label_stat 의 classes : {0, 1}
train_p_index_ 26
valid_p_index 14
test_p_index 10
→ train 환자 ID 및 라벨:
   총 개수: 26
   환자ID=Control_Participant12, Label=0, 셀개수=99
   환자ID=Control_Participant2, Label=0, 셀개수=41
   환자ID=COVID19_Participant21, Label=1, 셀개수=39
   환자ID=COVID19_Participant4, Label=1, 셀개수=1680
   환자ID=COVID19_Participant10, Label=1, 셀개수=18
   환자ID=Control_Participant5, Label=0, 셀개수=717
   환자ID=COVID19_Participant15, Label=1, 셀개수=1003
   환자ID=COVID19_Participant22, Label=1, 셀개수=865
   환자ID=COVID19_Participant5, Label=1, 셀개수=89
   환자ID=COVID19_Participant13, Label=1, 셀개수=730
   환자ID=COVID19_Participant23, Label=1, 셀개수=307
   환자ID=Control_Participant3, Label=0, 셀개수=1620
   환자ID=COVID19_Participant3, Label=1, 셀개수=104
   환자ID=Control_Participant8, Label=0, 셀개수=393
   환자ID=Control_Participant6, Label=0, 셀개수=131
   환자ID=COVID19_Participant17, Label=1, 셀개수=843
   환자ID=Control_Participant9, Label=0, 셀개수=558
   환자ID=Control_Participant13, Label=0, 셀개수=88
   환자ID=COVID19_Participant27, Label=1, 셀개수=93
   환자ID=COVID19_Participant35, Label=1, 셀개수=83
   환자ID=COVID19_Participant29, Label=1, 셀개수=573
   환자ID=COVID19_Participant20, Label=1, 셀개수=2033
   환자ID=COVID19_Participant7, Label=1, 셀개수=409
   환자ID=COVID19_Participant40, Label=1, 셀개수=381
   환자ID=COVID19_Participant39, Label=1, 셀개수=454
   환자ID=COVID19_Participant32, Label=1, 셀개수=1665
→ valid 환자 ID 및 라벨:
   총 개수: 14
   환자ID=Control_Participant15, Label=0, 셀개수=528
   환자ID=COVID19_Participant30, Label=1, 셀개수=116
   환자ID=COVID19_Participant37, Label=1, 셀개수=668
   환자ID=COVID19_Participant36, Label=1, 셀개수=200
   환자ID=COVID19_Participant6, Label=1, 셀개수=84
   환자ID=COVID19_Participant26, Label=1, 셀개수=814
   환자ID=Control_Participant4, Label=0, 셀개수=440
   환자ID=Control_Participant11, Label=0, 셀개수=1164
   환자ID=COVID19_Participant9, Label=1, 셀개수=86
   환자ID=COVID19_Participant8, Label=1, 셀개수=462
   환자ID=Control_Participant14, Label=0, 셀개수=274
   환자ID=COVID19_Participant38, Label=1, 셀개수=51
   환자ID=COVID19_Participant12, Label=1, 셀개수=102
   환자ID=COVID19_Participant28, Label=1, 셀개수=1079
→ test 환자 ID 및 라벨:
   총 개수: 10
   환자ID=COVID19_Participant11, Label=1, 셀개수=382
   환자ID=COVID19_Participant14, Label=1, 셀개수=382
   환자ID=COVID19_Participant18, Label=1, 셀개수=227
   환자ID=COVID19_Participant19, Label=1, 셀개수=816
   환자ID=COVID19_Participant2, Label=1, 셀개수=329
   환자ID=COVID19_Participant25, Label=1, 셀개수=496
   환자ID=COVID19_Participant31, Label=1, 셀개수=410
   환자ID=Control_Participant1, Label=0, 셀개수=414
   환자ID=Control_Participant10, Label=0, 셀개수=1645
   환자ID=Control_Participant7, Label=0, 셀개수=762
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Epithelial_cells', 'Platelets', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Keratinocytes', 'Macrophage', 'Epithelial_cells', 'B_cell', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
전체 데이터 길이 26947
전체 cell type 길이 0        Epithelial_cells
1               Platelets
2        Epithelial_cells
3        Epithelial_cells
4        Epithelial_cells
               ...       
26942       Keratinocytes
26943    Epithelial_cells
26944    Epithelial_cells
26945       Keratinocytes
26946    Epithelial_cells
Length: 26947, dtype: string
cell type의 NaN 개수 체크 0
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:10,  9.01it/s]  2%|▏         | 2/100 [00:00<00:10,  9.46it/s]  4%|▍         | 4/100 [00:00<00:11,  8.64it/s]  5%|▌         | 5/100 [00:00<00:10,  8.82it/s]  6%|▌         | 6/100 [00:00<00:10,  8.73it/s]  8%|▊         | 8/100 [00:00<00:10,  9.18it/s]  9%|▉         | 9/100 [00:00<00:09,  9.30it/s] 11%|█         | 11/100 [00:01<00:09,  9.01it/s] 13%|█▎        | 13/100 [00:01<00:09,  9.43it/s] 15%|█▌        | 15/100 [00:01<00:08,  9.73it/s] 16%|█▌        | 16/100 [00:01<00:08,  9.70it/s] 17%|█▋        | 17/100 [00:01<00:08,  9.54it/s] 18%|█▊        | 18/100 [00:01<00:08,  9.58it/s] 19%|█▉        | 19/100 [00:02<00:08,  9.54it/s] 20%|██        | 20/100 [00:02<00:08,  9.56it/s] 21%|██        | 21/100 [00:02<00:08,  9.59it/s] 22%|██▏       | 22/100 [00:02<00:08,  9.14it/s] 24%|██▍       | 24/100 [00:02<00:07,  9.69it/s] 26%|██▌       | 26/100 [00:02<00:07,  9.65it/s] 27%|██▋       | 27/100 [00:02<00:07,  9.69it/s] 29%|██▉       | 29/100 [00:03<00:07,  9.75it/s] 30%|███       | 30/100 [00:03<00:07,  9.39it/s] 32%|███▏      | 32/100 [00:03<00:07,  9.56it/s] 33%|███▎      | 33/100 [00:03<00:07,  9.28it/s] 34%|███▍      | 34/100 [00:03<00:07,  9.08it/s] 35%|███▌      | 35/100 [00:03<00:07,  9.28it/s] 36%|███▌      | 36/100 [00:03<00:06,  9.36it/s] 37%|███▋      | 37/100 [00:03<00:06,  9.02it/s] 38%|███▊      | 38/100 [00:04<00:06,  9.10it/s] 39%|███▉      | 39/100 [00:04<00:06,  9.15it/s] 40%|████      | 40/100 [00:04<00:06,  8.92it/s] 41%|████      | 41/100 [00:04<00:06,  8.75it/s] 42%|████▏     | 42/100 [00:04<00:06,  8.70it/s] 43%|████▎     | 43/100 [00:04<00:07,  7.79it/s] 44%|████▍     | 44/100 [00:04<00:08,  6.98it/s] 45%|████▌     | 45/100 [00:04<00:07,  7.50it/s] 46%|████▌     | 46/100 [00:05<00:06,  8.02it/s] 47%|████▋     | 47/100 [00:05<00:06,  7.63it/s] 48%|████▊     | 48/100 [00:05<00:06,  7.50it/s] 49%|████▉     | 49/100 [00:05<00:06,  7.80it/s] 50%|█████     | 50/100 [00:05<00:06,  8.10it/s] 51%|█████     | 51/100 [00:05<00:05,  8.42it/s] 52%|█████▏    | 52/100 [00:05<00:05,  8.59it/s] 53%|█████▎    | 53/100 [00:05<00:05,  8.74it/s] 54%|█████▍    | 54/100 [00:06<00:05,  7.69it/s] 55%|█████▌    | 55/100 [00:06<00:05,  8.18it/s] 56%|█████▌    | 56/100 [00:06<00:05,  8.27it/s] 57%|█████▋    | 57/100 [00:06<00:06,  7.02it/s] 58%|█████▊    | 58/100 [00:06<00:05,  7.49it/s] 59%|█████▉    | 59/100 [00:06<00:05,  7.87it/s] 60%|██████    | 60/100 [00:06<00:04,  8.03it/s] 61%|██████    | 61/100 [00:06<00:05,  7.69it/s] 62%|██████▏   | 62/100 [00:07<00:04,  8.01it/s] 63%|██████▎   | 63/100 [00:07<00:04,  8.09it/s] 64%|██████▍   | 64/100 [00:07<00:04,  8.06it/s] 65%|██████▌   | 65/100 [00:07<00:04,  8.49it/s] 66%|██████▌   | 66/100 [00:07<00:04,  8.25it/s] 67%|██████▋   | 67/100 [00:07<00:03,  8.66it/s] 68%|██████▊   | 68/100 [00:07<00:03,  8.39it/s] 69%|██████▉   | 69/100 [00:07<00:03,  8.50it/s] 70%|███████   | 70/100 [00:08<00:03,  8.72it/s] 71%|███████   | 71/100 [00:08<00:03,  8.68it/s] 72%|███████▏  | 72/100 [00:08<00:03,  8.81it/s] 73%|███████▎  | 73/100 [00:08<00:03,  8.69it/s] 74%|███████▍  | 74/100 [00:08<00:03,  8.63it/s] 75%|███████▌  | 75/100 [00:08<00:02,  8.63it/s] 77%|███████▋  | 77/100 [00:08<00:02,  8.48it/s] 78%|███████▊  | 78/100 [00:09<00:02,  7.93it/s] 79%|███████▉  | 79/100 [00:09<00:02,  8.11it/s] 81%|████████  | 81/100 [00:09<00:02,  8.54it/s] 82%|████████▏ | 82/100 [00:09<00:02,  8.33it/s] 83%|████████▎ | 83/100 [00:09<00:02,  8.14it/s] 84%|████████▍ | 84/100 [00:09<00:02,  6.63it/s] 85%|████████▌ | 85/100 [00:09<00:02,  7.05it/s] 86%|████████▌ | 86/100 [00:10<00:01,  7.45it/s] 87%|████████▋ | 87/100 [00:10<00:01,  7.90it/s] 88%|████████▊ | 88/100 [00:10<00:01,  7.68it/s] 89%|████████▉ | 89/100 [00:10<00:01,  7.31it/s] 90%|█████████ | 90/100 [00:10<00:01,  7.46it/s] 91%|█████████ | 91/100 [00:10<00:01,  7.76it/s] 92%|█████████▏| 92/100 [00:10<00:01,  7.98it/s] 93%|█████████▎| 93/100 [00:10<00:00,  8.14it/s] 94%|█████████▍| 94/100 [00:11<00:00,  8.22it/s] 95%|█████████▌| 95/100 [00:11<00:00,  8.07it/s] 96%|█████████▌| 96/100 [00:11<00:00,  7.75it/s] 97%|█████████▋| 97/100 [00:11<00:00,  7.46it/s] 98%|█████████▊| 98/100 [00:11<00:00,  7.62it/s] 99%|█████████▉| 99/100 [00:11<00:00,  7.57it/s]100%|██████████| 100/100 [00:11<00:00,  6.90it/s]100%|██████████| 100/100 [00:11<00:00,  8.40it/s]
[I 2025-08-31 18:21:58,440] A new study created in memory with name: no-name-9deb7bbc-a6fe-4b4e-8e85-cb95a8c64b6e
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 25.64 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.685171, Valid_loss 0.611393
Epoch 2, Train Loss 0.638817, Valid_loss 0.601527
Epoch 3, Train Loss 0.638818, Valid_loss 0.602474
Epoch 4, Train Loss 0.598907, Valid_loss 0.599552
Epoch 5, Train Loss 0.626245, Valid_loss 0.598890
Epoch 6, Train Loss 0.598905, Valid_loss 0.593615
Epoch 7, Train Loss 0.592606, Valid_loss 0.572043
Epoch 8, Train Loss 0.578847, Valid_loss 0.525742
Epoch 9, Train Loss 0.569239, Valid_loss 0.478106
Epoch 10, Train Loss 0.563691, Valid_loss 0.484024
Epoch 11, Train Loss 0.535914, Valid_loss 0.481462
Epoch 12, Train Loss 0.506943, Valid_loss 0.467786
Epoch 13, Train Loss 0.515128, Valid_loss 0.471492
Epoch 14, Train Loss 0.484751, Valid_loss 0.390953
Epoch 15, Train Loss 0.467796, Valid_loss 0.387709
Epoch 16, Train Loss 0.465882, Valid_loss 0.368551
Epoch 17, Train Loss 0.487956, Valid_loss 0.369798
Epoch 18, Train Loss 0.487470, Valid_loss 0.386217
Epoch 19, Train Loss 0.465662, Valid_loss 0.364981
Epoch 20, Train Loss 0.458377, Valid_loss 0.368683
Epoch 21, Train Loss 0.491601, Valid_loss 0.374372
Epoch 22, Train Loss 0.468760, Valid_loss 0.530329
Epoch 23, Train Loss 0.487898, Valid_loss 0.325391
Epoch 24, Train Loss 0.469917, Valid_loss 0.328721
Epoch 25, Train Loss 0.477342, Valid_loss 0.344367
Epoch 26, Train Loss 0.463136, Valid_loss 0.342671
Epoch 27, Train Loss 0.457162, Valid_loss 0.325543
Epoch 28, Train Loss 0.485862, Valid_loss 0.412727
Epoch 29, Train Loss 0.498123, Valid_loss 0.346723
Epoch 30, Train Loss 0.432596, Valid_loss 0.353317
Epoch 31, Train Loss 0.454960, Valid_loss 0.358385
Epoch 32, Train Loss 0.442261, Valid_loss 0.312976
Epoch 33, Train Loss 0.462306, Valid_loss 0.331750
Epoch 34, Train Loss 0.465661, Valid_loss 0.361713
Epoch 35, Train Loss 0.459793, Valid_loss 0.316128
Epoch 36, Train Loss 0.432508, Valid_loss 0.309504
Epoch 37, Train Loss 0.436698, Valid_loss 0.348695
Epoch 38, Train Loss 0.415891, Valid_loss 0.313695
Epoch 39, Train Loss 0.451345, Valid_loss 0.318667
Epoch 40, Train Loss 0.441984, Valid_loss 0.360160
Epoch 41, Train Loss 0.433390, Valid_loss 0.325791
Epoch 42, Train Loss 0.445837, Valid_loss 0.332249
Epoch 43, Train Loss 0.421435, Valid_loss 0.420962
Epoch 44, Train Loss 0.456318, Valid_loss 0.340185
Epoch 45, Train Loss 0.423449, Valid_loss 0.373092
Epoch 46, Train Loss 0.467524, Valid_loss 0.311143
Epoch 47, Train Loss 0.443992, Valid_loss 0.328920
Epoch 48, Train Loss 0.460109, Valid_loss 0.304532
Epoch 49, Train Loss 0.411587, Valid_loss 0.332017
Epoch 50, Train Loss 0.430339, Valid_loss 0.310150
Epoch 51, Train Loss 0.427162, Valid_loss 0.298767
Epoch 52, Train Loss 0.440932, Valid_loss 0.295795
Epoch 53, Train Loss 0.418628, Valid_loss 0.396448
Epoch 54, Train Loss 0.414058, Valid_loss 0.290555
Epoch 55, Train Loss 0.447711, Valid_loss 0.308234
Epoch 56, Train Loss 0.396472, Valid_loss 0.303401
Epoch 57, Train Loss 0.443143, Valid_loss 0.359391
Epoch 58, Train Loss 0.406530, Valid_loss 0.294649
Epoch 59, Train Loss 0.396586, Valid_loss 0.305672
Epoch 60, Train Loss 0.412713, Valid_loss 0.345710
[I 2025-08-31 18:26:33,804] Trial 0 finished with value: 0.29055518390876905 and parameters: {'learning_rate': 0.001, 'epochs': 100, 'heads': 4, 'dropout': 0.5, 'weight_decay': 0.01, 'emb_dim': 8, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.29055518390876905.
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 25.64 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.649052, Valid_loss 0.615420
Epoch 2, Train Loss 0.635291, Valid_loss 0.605801
Epoch 3, Train Loss 0.640950, Valid_loss 0.596223
Epoch 4, Train Loss 0.599327, Valid_loss 0.588776
Epoch 5, Train Loss 0.595717, Valid_loss 0.578336
Epoch 6, Train Loss 0.599374, Valid_loss 0.574290
Epoch 7, Train Loss 0.592545, Valid_loss 0.565453
Epoch 8, Train Loss 0.594165, Valid_loss 0.560287
Epoch 9, Train Loss 0.582165, Valid_loss 0.558644
Epoch 10, Train Loss 0.576122, Valid_loss 0.549020
Epoch 11, Train Loss 0.587484, Valid_loss 0.544186
Epoch 12, Train Loss 0.582318, Valid_loss 0.538939
Epoch 13, Train Loss 0.575306, Valid_loss 0.534874
Epoch 14, Train Loss 0.572414, Valid_loss 0.519670
Epoch 15, Train Loss 0.555564, Valid_loss 0.516885
Epoch 16, Train Loss 0.553175, Valid_loss 0.510565
Epoch 17, Train Loss 0.558977, Valid_loss 0.490197
Epoch 18, Train Loss 0.566967, Valid_loss 0.482875
Epoch 19, Train Loss 0.535586, Valid_loss 0.474097
Epoch 20, Train Loss 0.534241, Valid_loss 0.477458
Epoch 21, Train Loss 0.531944, Valid_loss 0.469495
Epoch 22, Train Loss 0.524339, Valid_loss 0.470245
Epoch 23, Train Loss 0.519747, Valid_loss 0.459710
Epoch 24, Train Loss 0.516291, Valid_loss 0.456802
Epoch 25, Train Loss 0.505987, Valid_loss 0.451971
Epoch 26, Train Loss 0.504295, Valid_loss 0.447355
Epoch 27, Train Loss 0.501504, Valid_loss 0.449640
Epoch 28, Train Loss 0.495161, Valid_loss 0.446468
Epoch 29, Train Loss 0.500917, Valid_loss 0.442870
Epoch 30, Train Loss 0.478150, Valid_loss 0.445391
Epoch 31, Train Loss 0.497906, Valid_loss 0.442087
Epoch 32, Train Loss 0.500764, Valid_loss 0.439096
Epoch 33, Train Loss 0.486198, Valid_loss 0.443149
Epoch 34, Train Loss 0.500479, Valid_loss 0.434293
Epoch 35, Train Loss 0.490424, Valid_loss 0.433719
Epoch 36, Train Loss 0.483316, Valid_loss 0.434249
Epoch 37, Train Loss 0.471832, Valid_loss 0.430846
Epoch 38, Train Loss 0.500105, Valid_loss 0.427180
Epoch 39, Train Loss 0.468578, Valid_loss 0.430058
Epoch 40, Train Loss 0.480836, Valid_loss 0.424469
Epoch 41, Train Loss 0.490092, Valid_loss 0.422425
Epoch 42, Train Loss 0.492111, Valid_loss 0.423957
Epoch 43, Train Loss 0.483119, Valid_loss 0.425802
Epoch 44, Train Loss 0.473538, Valid_loss 0.419046
Epoch 45, Train Loss 0.466367, Valid_loss 0.421249
Epoch 46, Train Loss 0.476557, Valid_loss 0.415575
Epoch 47, Train Loss 0.455624, Valid_loss 0.421534
Epoch 48, Train Loss 0.478448, Valid_loss 0.417959
Epoch 49, Train Loss 0.468826, Valid_loss 0.417129
Epoch 50, Train Loss 0.461713, Valid_loss 0.415589
Epoch 51, Train Loss 0.469001, Valid_loss 0.418337
Epoch 52, Train Loss 0.469501, Valid_loss 0.425588
[I 2025-08-31 18:29:45,664] Trial 1 finished with value: 0.4155754510845457 and parameters: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 1, 'dropout': 0.3, 'weight_decay': 0.001, 'emb_dim': 8, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.29055518390876905.
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 29.04 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.685354, Valid_loss 0.598495
Epoch 2, Train Loss 0.648255, Valid_loss 0.606529
Epoch 3, Train Loss 0.627282, Valid_loss 0.598670
Epoch 4, Train Loss 0.617141, Valid_loss 0.603712
Epoch 5, Train Loss 0.594175, Valid_loss 0.604855
Epoch 6, Train Loss 0.604562, Valid_loss 0.598531
Epoch 7, Train Loss 0.630789, Valid_loss 0.601009
Epoch 8, Train Loss 0.600694, Valid_loss 0.599355
Epoch 9, Train Loss 0.611743, Valid_loss 0.599551
Epoch 10, Train Loss 0.596175, Valid_loss 0.598262
Epoch 11, Train Loss 0.592683, Valid_loss 0.599071
Epoch 12, Train Loss 0.603135, Valid_loss 0.598276
Epoch 13, Train Loss 0.605234, Valid_loss 0.598224
Epoch 14, Train Loss 0.608701, Valid_loss 0.598269
Epoch 15, Train Loss 0.592489, Valid_loss 0.601963
Epoch 16, Train Loss 0.604049, Valid_loss 0.598000
Epoch 17, Train Loss 0.594038, Valid_loss 0.598151
Epoch 18, Train Loss 0.611562, Valid_loss 0.597653
Epoch 19, Train Loss 0.590798, Valid_loss 0.598368
Epoch 20, Train Loss 0.614647, Valid_loss 0.609925
Epoch 21, Train Loss 0.591975, Valid_loss 0.633659
Epoch 22, Train Loss 0.600399, Valid_loss 0.612035
Epoch 23, Train Loss 0.598536, Valid_loss 0.595355
Epoch 24, Train Loss 0.616540, Valid_loss 0.598567
Epoch 25, Train Loss 0.595953, Valid_loss 0.598248
Epoch 26, Train Loss 0.587096, Valid_loss 0.598743
Epoch 27, Train Loss 0.573442, Valid_loss 0.603453
Epoch 28, Train Loss 0.599428, Valid_loss 0.599330
Epoch 29, Train Loss 0.606503, Valid_loss 0.598509
Epoch 30, Train Loss 0.574261, Valid_loss 0.602999
Epoch 31, Train Loss 0.596348, Valid_loss 0.600321
Epoch 32, Train Loss 0.591468, Valid_loss 0.598352
Epoch 33, Train Loss 0.597852, Valid_loss 0.597955
Epoch 34, Train Loss 0.605623, Valid_loss 0.598687
Epoch 35, Train Loss 0.593278, Valid_loss 0.599664
Epoch 36, Train Loss 0.603281, Valid_loss 0.598721
Epoch 37, Train Loss 0.590217, Valid_loss 0.597905
Epoch 38, Train Loss 0.597741, Valid_loss 0.597946
Epoch 39, Train Loss 0.592542, Valid_loss 0.599130
Epoch 40, Train Loss 0.585103, Valid_loss 0.599870
Epoch 41, Train Loss 0.594240, Valid_loss 0.597511
Epoch 42, Train Loss 0.596284, Valid_loss 0.598109
Epoch 43, Train Loss 0.598628, Valid_loss 0.598462
Epoch 44, Train Loss 0.597022, Valid_loss 0.598559
Epoch 45, Train Loss 0.590875, Valid_loss 0.597506
Epoch 46, Train Loss 0.590677, Valid_loss 0.598281
Epoch 47, Train Loss 0.582498, Valid_loss 0.599723
Epoch 48, Train Loss 0.592096, Valid_loss 0.602570
Epoch 49, Train Loss 0.590907, Valid_loss 0.598335
Epoch 50, Train Loss 0.590711, Valid_loss 0.601916
Epoch 51, Train Loss 0.598968, Valid_loss 0.599307
Epoch 52, Train Loss 0.585614, Valid_loss 0.598283
Epoch 53, Train Loss 0.597255, Valid_loss 0.598594
Epoch 54, Train Loss 0.589934, Valid_loss 0.598645
[I 2025-08-31 18:33:22,377] Trial 2 finished with value: 0.5953549210514341 and parameters: {'learning_rate': 0.01, 'epochs': 100, 'heads': 2, 'dropout': 0.7, 'weight_decay': 0.0001, 'emb_dim': 64, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.29055518390876905.
선택된 trial params: {'learning_rate': 0.001, 'epochs': 100, 'heads': 4, 'dropout': 0.5, 'weight_decay': 0.01, 'emb_dim': 8, 'augment_num': 100, 'pca': False}
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=10, batch_size=1 -> steps=10
output_class :  1
Memory Allocated: 25.64 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.759655, Valid_loss 0.694951
Epoch 2, Train Loss 0.675281, Valid_loss 0.618012
Epoch 3, Train Loss 0.626717, Valid_loss 0.601538
Epoch 4, Train Loss 0.618414, Valid_loss 0.559586
Epoch 5, Train Loss 0.623532, Valid_loss 0.536792
Epoch 6, Train Loss 0.627914, Valid_loss 0.522227
Epoch 7, Train Loss 0.606431, Valid_loss 0.506123
Epoch 8, Train Loss 0.547842, Valid_loss 0.489969
Epoch 9, Train Loss 0.609302, Valid_loss 0.492477
Epoch 10, Train Loss 0.540297, Valid_loss 0.471054
Epoch 11, Train Loss 0.558622, Valid_loss 0.448270
Epoch 12, Train Loss 0.563389, Valid_loss 0.461951
Epoch 13, Train Loss 0.628600, Valid_loss 0.462816
Epoch 14, Train Loss 0.536897, Valid_loss 0.429704
Epoch 15, Train Loss 0.509632, Valid_loss 0.407126
Epoch 16, Train Loss 0.487218, Valid_loss 0.387513
Epoch 17, Train Loss 0.499148, Valid_loss 0.416487
Epoch 18, Train Loss 0.532493, Valid_loss 0.401734
Epoch 19, Train Loss 0.484112, Valid_loss 0.420320
Epoch 20, Train Loss 0.487816, Valid_loss 0.486953
Epoch 21, Train Loss 0.549007, Valid_loss 0.401289
Epoch 22, Train Loss 0.520861, Valid_loss 0.378285
Epoch 23, Train Loss 0.507750, Valid_loss 0.355280
Epoch 24, Train Loss 0.493987, Valid_loss 0.387533
Epoch 25, Train Loss 0.507497, Valid_loss 0.346466
Epoch 26, Train Loss 0.512107, Valid_loss 0.350054
Epoch 27, Train Loss 0.458556, Valid_loss 0.376105
Epoch 28, Train Loss 0.486087, Valid_loss 0.414870
Epoch 29, Train Loss 0.515056, Valid_loss 0.306120
Epoch 30, Train Loss 0.494567, Valid_loss 0.354992
Epoch 31, Train Loss 0.462467, Valid_loss 0.384409
Epoch 32, Train Loss 0.438739, Valid_loss 0.320920
Epoch 33, Train Loss 0.456064, Valid_loss 0.354242
Epoch 34, Train Loss 0.399711, Valid_loss 0.320942
Epoch 35, Train Loss 0.534520, Valid_loss 0.306942
Epoch 36, Train Loss 0.458903, Valid_loss 0.307456
Epoch 37, Train Loss 0.479976, Valid_loss 0.302912
Epoch 38, Train Loss 0.470061, Valid_loss 0.318985
Epoch 39, Train Loss 0.462199, Valid_loss 0.320947
Epoch 40, Train Loss 0.450608, Valid_loss 0.365593
Epoch 41, Train Loss 0.485278, Valid_loss 0.313540
Epoch 42, Train Loss 0.474047, Valid_loss 0.303970
Epoch 43, Train Loss 0.449572, Valid_loss 0.395454
Epoch 44, Train Loss 0.422448, Valid_loss 0.309341
Epoch 45, Train Loss 0.468276, Valid_loss 0.390129
Epoch 46, Train Loss 0.525248, Valid_loss 0.295891
Epoch 47, Train Loss 0.472154, Valid_loss 0.281555
Epoch 48, Train Loss 0.510993, Valid_loss 0.419136
Epoch 49, Train Loss 0.480895, Valid_loss 0.270289
Epoch 50, Train Loss 0.491902, Valid_loss 0.376231
Epoch 51, Train Loss 0.482392, Valid_loss 0.308162
Epoch 52, Train Loss 0.492877, Valid_loss 0.283111
Epoch 53, Train Loss 0.504800, Valid_loss 0.321664
Epoch 54, Train Loss 0.436982, Valid_loss 0.300421
Epoch 55, Train Loss 0.481464, Valid_loss 0.263261
Epoch 56, Train Loss 0.399687, Valid_loss 0.325219
Epoch 57, Train Loss 0.489388, Valid_loss 0.310612
Epoch 58, Train Loss 0.433051, Valid_loss 0.339353
Epoch 59, Train Loss 0.411516, Valid_loss 0.266402
Epoch 60, Train Loss 0.441231, Valid_loss 0.301255
Epoch 61, Train Loss 0.436655, Valid_loss 0.287687
Epoch 62, Train Loss 0.482439, Valid_loss 0.307877
Epoch 63, Train Loss 0.429936, Valid_loss 0.253976
Epoch 64, Train Loss 0.486073, Valid_loss 0.271732
Epoch 65, Train Loss 0.464399, Valid_loss 0.263934
Epoch 66, Train Loss 0.457327, Valid_loss 0.339565
Epoch 67, Train Loss 0.454891, Valid_loss 0.301634
Epoch 68, Train Loss 0.445147, Valid_loss 0.269889
Epoch 69, Train Loss 0.409060, Valid_loss 0.322393
Epoch 70, Train Loss 0.440919, Valid_loss 0.295263
Epoch 71, Train Loss 0.402449, Valid_loss 0.277046
Epoch 72, Train Loss 0.431222, Valid_loss 0.288673
Epoch 73, Train Loss 0.429343, Valid_loss 0.272336
Epoch 74, Train Loss 0.423441, Valid_loss 0.278505
Epoch 75, Train Loss 0.465373, Valid_loss 0.282198
환자ID=COVID19_Participant11 -- true: 1 -- pred: 1
환자ID=COVID19_Participant14 -- true: 1 -- pred: 1
환자ID=COVID19_Participant18 -- true: 1 -- pred: 1
환자ID=COVID19_Participant19 -- true: 1 -- pred: 1
환자ID=COVID19_Participant2 -- true: 1 -- pred: 1
환자ID=COVID19_Participant25 -- true: 1 -- pred: 0
환자ID=COVID19_Participant31 -- true: 1 -- pred: 0
환자ID=Control_Participant1 -- true: 0 -- pred: 1
환자ID=Control_Participant10 -- true: 0 -- pred: 0
환자ID=Control_Participant7 -- true: 0 -- pred: 0
Best performance: Epoch 63, Loss 0.429936, Test ACC 0.700000, Test AUC 0.904762, Test Recall 0.714286, Test Precision 0.833333
Confusion Matrix:
 [2 1 2 5]
✅ Total valid splits used: 4
🔁 Repeat 2, Fold 4
cell type :  GTCGGGGGGTGG_Control_Participant7        Keratinocytes
CAAATCAATTAT_Control_Participant7     Epithelial_cells
ATACAATTGACA_Control_Participant7     Epithelial_cells
CTGTTAATGAGA_Control_Participant7     Epithelial_cells
CTTCACATTATT_Control_Participant7     Epithelial_cells
                                            ...       
GCAGGGAACTCC_COVID19_Participant30    Epithelial_cells
CAGCACCGAGCC_COVID19_Participant30    Epithelial_cells
GCCCCTTGTGAT_COVID19_Participant30    Epithelial_cells
GTGTTGTGTGTC_COVID19_Participant30              B_cell
TAACACTCACTT_COVID19_Participant30           Myelocyte
Name: singler_annotation, Length: 22631, dtype: string
cell type annotation :  GTCGGGGGGTGG_Control_Participant7        Keratinocytes
CAAATCAATTAT_Control_Participant7     Epithelial_cells
ATACAATTGACA_Control_Participant7     Epithelial_cells
CTGTTAATGAGA_Control_Participant7     Epithelial_cells
CTTCACATTATT_Control_Participant7     Epithelial_cells
                                            ...       
GCAGGGAACTCC_COVID19_Participant30    Epithelial_cells
CAGCACCGAGCC_COVID19_Participant30    Epithelial_cells
GCCCCTTGTGAT_COVID19_Participant30    Epithelial_cells
GTGTTGTGTGTC_COVID19_Participant30              B_cell
TAACACTCACTT_COVID19_Participant30           Myelocyte
Name: singler_annotation, Length: 22631, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Keratinocytes', 'Epithelial_cells', 'Neurons', 'iPS_cells', 'Embryonic_stem_cells', 'Astrocyte', 'DC', 'Gametocytes', 'HSC_-G-CSF', 'Smooth_muscle_cells', 'BM & Prog.', 'Monocyte', 'Myelocyte', 'BM', 'Endothelial_cells', 'Osteoblasts', 'Platelets', 'Erythroblast', 'NK_cell', 'T_cells', 'Chondrocytes', 'HSC_CD34+', 'CMP', 'Neutrophils', 'Fibroblasts', 'MEP', 'Neuroepithelial_cell', 'MSC', 'Pro-Myelocyte', 'B_cell', 'GMP', 'Hepatocytes', 'Macrophage', 'Tissue_stem_cells', 'Pre-B_cell_CD34-', 'Pro-B_cell_CD34+', 'Unknown']
라벨별 그룹 개수 {1: 28, 0: 12}
cell type :  CATTAAGGATAT_COVID19_Participant13    Epithelial_cells
GTAGAAGGGGGG_COVID19_Participant13           Platelets
ATTAAGAGGTAG_COVID19_Participant13    Epithelial_cells
AGATATGACAAG_COVID19_Participant13    Epithelial_cells
CTTGTAACAAAT_COVID19_Participant13    Epithelial_cells
                                            ...       
ACCATATTCAGG_COVID19_Participant21       Keratinocytes
GCCCGTTTCACG_COVID19_Participant21    Epithelial_cells
TATTATCTCTTA_COVID19_Participant21    Epithelial_cells
TTCCGTTTGTCC_COVID19_Participant21    Epithelial_cells
TCGGGATTGGAT_COVID19_Participant21         Neutrophils
Name: singler_annotation, Length: 4316, dtype: string
cell type annotation :  CATTAAGGATAT_COVID19_Participant13    Epithelial_cells
GTAGAAGGGGGG_COVID19_Participant13           Platelets
ATTAAGAGGTAG_COVID19_Participant13    Epithelial_cells
AGATATGACAAG_COVID19_Participant13    Epithelial_cells
CTTGTAACAAAT_COVID19_Participant13    Epithelial_cells
                                            ...       
ACCATATTCAGG_COVID19_Participant21       Keratinocytes
GCCCGTTTCACG_COVID19_Participant21    Epithelial_cells
TATTATCTCTTA_COVID19_Participant21    Epithelial_cells
TTCCGTTTGTCC_COVID19_Participant21    Epithelial_cells
TCGGGATTGGAT_COVID19_Participant21         Neutrophils
Name: singler_annotation, Length: 4316, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Epithelial_cells', 'Platelets', 'Keratinocytes', 'Macrophage', 'B_cell', 'Neutrophils', 'DC', 'Monocyte', 'T_cells', 'NK_cell', 'HSC_CD34+', 'Tissue_stem_cells', 'Embryonic_stem_cells', 'HSC_-G-CSF', 'Neurons', 'BM', 'Erythroblast', 'Fibroblasts', 'iPS_cells', 'Hepatocytes', 'CMP', 'Gametocytes', 'Chondrocytes', 'Endothelial_cells', 'Pre-B_cell_CD34-', 'Myelocyte', 'Astrocyte', 'Neuroepithelial_cell', 'Smooth_muscle_cells', 'GMP', 'MSC', 'Osteoblasts', 'MEP', 'BM & Prog.', 'Pro-B_cell_CD34+', 'Pro-Myelocyte']
라벨별 그룹 개수 {1: 7, 0: 3}
🔍 Split #5
  → train_p_index 환자 수 (환자 단위로 묶인 index list): 40
  → test_p_index 환자 수  (환자 단위로 묶인 index list): 10
  → train 환자 ID: ['COVID19_Participant10', 'COVID19_Participant11', 'COVID19_Participant12', 'COVID19_Participant14', 'COVID19_Participant15', 'COVID19_Participant17', 'COVID19_Participant18', 'COVID19_Participant19', 'COVID19_Participant2', 'COVID19_Participant20', 'COVID19_Participant22', 'COVID19_Participant23', 'COVID19_Participant25', 'COVID19_Participant26', 'COVID19_Participant27', 'COVID19_Participant28', 'COVID19_Participant3', 'COVID19_Participant30', 'COVID19_Participant31', 'COVID19_Participant32', 'COVID19_Participant35', 'COVID19_Participant36', 'COVID19_Participant37', 'COVID19_Participant38', 'COVID19_Participant4', 'COVID19_Participant7', 'COVID19_Participant8', 'COVID19_Participant9', 'Control_Participant1', 'Control_Participant10', 'Control_Participant12', 'Control_Participant13', 'Control_Participant2', 'Control_Participant3', 'Control_Participant4', 'Control_Participant5', 'Control_Participant6', 'Control_Participant7', 'Control_Participant8', 'Control_Participant9']
  → test  환자 ID: ['COVID19_Participant13', 'COVID19_Participant21', 'COVID19_Participant29', 'COVID19_Participant39', 'COVID19_Participant40', 'COVID19_Participant5', 'COVID19_Participant6', 'Control_Participant11', 'Control_Participant14', 'Control_Participant15']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant10, Label: 1
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant12, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant18, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant27, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant3, Label: 1
    ID: COVID19_Participant30, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant35, Label: 1
    ID: COVID19_Participant36, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant38, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: COVID19_Participant9, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant10, Label: 0
    ID: Control_Participant12, Label: 0
    ID: Control_Participant13, Label: 0
    ID: Control_Participant2, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant4, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant6, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant8, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant21, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: COVID19_Participant5, Label: 1
    ID: COVID19_Participant6, Label: 1
    ID: Control_Participant11, Label: 0
    ID: Control_Participant14, Label: 0
    ID: Control_Participant15, Label: 0
전체 데이터 index 길이 50
label_stat (train 환자 라벨 목록) 갯수 40
train_data에서 환자 단위로, train과 validation 나누기
기존 train_p_index 40
기존 (train) label_stat 40
train-vali 분할 후! 
train y 의 classes : {0, 1} valid y 의 classes : {0, 1} label_stat 의 classes : {0, 1}
train_p_index_ 26
valid_p_index 14
test_p_index 10
→ train 환자 ID 및 라벨:
   총 개수: 26
   환자ID=Control_Participant10, Label=0, 셀개수=1645
   환자ID=Control_Participant3, Label=0, 셀개수=1620
   환자ID=COVID19_Participant18, Label=1, 셀개수=227
   환자ID=COVID19_Participant36, Label=1, 셀개수=200
   환자ID=COVID19_Participant10, Label=1, 셀개수=18
   환자ID=Control_Participant6, Label=0, 셀개수=131
   환자ID=COVID19_Participant14, Label=1, 셀개수=382
   환자ID=COVID19_Participant19, Label=1, 셀개수=816
   환자ID=COVID19_Participant38, Label=1, 셀개수=51
   환자ID=COVID19_Participant12, Label=1, 셀개수=102
   환자ID=COVID19_Participant2, Label=1, 셀개수=329
   환자ID=Control_Participant4, Label=0, 셀개수=440
   환자ID=COVID19_Participant26, Label=1, 셀개수=814
   환자ID=Control_Participant8, Label=0, 셀개수=393
   환자ID=Control_Participant7, Label=0, 셀개수=762
   환자ID=COVID19_Participant15, Label=1, 셀개수=1003
   환자ID=Control_Participant9, Label=0, 셀개수=558
   환자ID=Control_Participant12, Label=0, 셀개수=99
   환자ID=COVID19_Participant22, Label=1, 셀개수=865
   환자ID=COVID19_Participant3, Label=1, 셀개수=104
   환자ID=COVID19_Participant25, Label=1, 셀개수=496
   환자ID=COVID19_Participant17, Label=1, 셀개수=843
   환자ID=COVID19_Participant7, Label=1, 셀개수=409
   환자ID=COVID19_Participant37, Label=1, 셀개수=668
   환자ID=COVID19_Participant35, Label=1, 셀개수=83
   환자ID=COVID19_Participant28, Label=1, 셀개수=1079
→ valid 환자 ID 및 라벨:
   총 개수: 14
   환자ID=Control_Participant2, Label=0, 셀개수=41
   환자ID=COVID19_Participant27, Label=1, 셀개수=93
   환자ID=COVID19_Participant31, Label=1, 셀개수=410
   환자ID=COVID19_Participant30, Label=1, 셀개수=116
   환자ID=COVID19_Participant4, Label=1, 셀개수=1680
   환자ID=COVID19_Participant20, Label=1, 셀개수=2033
   환자ID=Control_Participant5, Label=0, 셀개수=717
   환자ID=Control_Participant1, Label=0, 셀개수=414
   환자ID=COVID19_Participant9, Label=1, 셀개수=86
   환자ID=COVID19_Participant8, Label=1, 셀개수=462
   환자ID=Control_Participant13, Label=0, 셀개수=88
   환자ID=COVID19_Participant32, Label=1, 셀개수=1665
   환자ID=COVID19_Participant11, Label=1, 셀개수=382
   환자ID=COVID19_Participant23, Label=1, 셀개수=307
→ test 환자 ID 및 라벨:
   총 개수: 10
   환자ID=COVID19_Participant13, Label=1, 셀개수=730
   환자ID=COVID19_Participant21, Label=1, 셀개수=39
   환자ID=COVID19_Participant29, Label=1, 셀개수=573
   환자ID=COVID19_Participant39, Label=1, 셀개수=454
   환자ID=COVID19_Participant40, Label=1, 셀개수=381
   환자ID=COVID19_Participant5, Label=1, 셀개수=89
   환자ID=COVID19_Participant6, Label=1, 셀개수=84
   환자ID=Control_Participant11, Label=0, 셀개수=1164
   환자ID=Control_Participant14, Label=0, 셀개수=274
   환자ID=Control_Participant15, Label=0, 셀개수=528
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Keratinocytes', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Neurons', 'iPS_cells', 'Embryonic_stem_cells', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
전체 데이터 길이 26947
전체 cell type 길이 0           Keratinocytes
1        Epithelial_cells
2        Epithelial_cells
3        Epithelial_cells
4        Epithelial_cells
               ...       
26942       Keratinocytes
26943    Epithelial_cells
26944    Epithelial_cells
26945    Epithelial_cells
26946         Neutrophils
Length: 26947, dtype: string
cell type의 NaN 개수 체크 0
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:10,  9.66it/s]  3%|▎         | 3/100 [00:00<00:09,  9.81it/s]  5%|▌         | 5/100 [00:00<00:09, 10.16it/s]  7%|▋         | 7/100 [00:00<00:09, 10.04it/s]  9%|▉         | 9/100 [00:00<00:09,  9.98it/s] 10%|█         | 10/100 [00:01<00:09,  9.93it/s] 11%|█         | 11/100 [00:01<00:09,  9.85it/s] 12%|█▏        | 12/100 [00:01<00:09,  9.54it/s] 13%|█▎        | 13/100 [00:01<00:09,  9.30it/s] 14%|█▍        | 14/100 [00:01<00:09,  9.31it/s] 15%|█▌        | 15/100 [00:01<00:09,  8.86it/s] 16%|█▌        | 16/100 [00:01<00:09,  8.95it/s] 17%|█▋        | 17/100 [00:01<00:10,  7.85it/s] 18%|█▊        | 18/100 [00:01<00:10,  8.14it/s] 19%|█▉        | 19/100 [00:02<00:09,  8.22it/s] 20%|██        | 20/100 [00:02<00:09,  8.49it/s] 21%|██        | 21/100 [00:02<00:09,  8.77it/s] 22%|██▏       | 22/100 [00:02<00:08,  9.06it/s] 24%|██▍       | 24/100 [00:02<00:08,  9.32it/s] 25%|██▌       | 25/100 [00:02<00:08,  9.11it/s] 26%|██▌       | 26/100 [00:02<00:07,  9.29it/s] 27%|██▋       | 27/100 [00:02<00:07,  9.34it/s] 29%|██▉       | 29/100 [00:03<00:07,  9.62it/s] 30%|███       | 30/100 [00:03<00:07,  9.61it/s] 31%|███       | 31/100 [00:03<00:07,  9.46it/s] 32%|███▏      | 32/100 [00:03<00:07,  9.35it/s] 33%|███▎      | 33/100 [00:03<00:07,  8.88it/s] 34%|███▍      | 34/100 [00:03<00:07,  8.88it/s] 35%|███▌      | 35/100 [00:03<00:07,  8.79it/s] 36%|███▌      | 36/100 [00:03<00:07,  9.09it/s] 37%|███▋      | 37/100 [00:04<00:07,  8.76it/s] 38%|███▊      | 38/100 [00:04<00:07,  8.61it/s] 39%|███▉      | 39/100 [00:04<00:06,  8.87it/s] 40%|████      | 40/100 [00:04<00:06,  8.83it/s] 41%|████      | 41/100 [00:04<00:06,  8.47it/s] 42%|████▏     | 42/100 [00:04<00:06,  8.38it/s] 43%|████▎     | 43/100 [00:04<00:06,  8.57it/s] 44%|████▍     | 44/100 [00:04<00:06,  8.53it/s] 45%|████▌     | 45/100 [00:04<00:06,  8.75it/s] 46%|████▌     | 46/100 [00:05<00:06,  8.70it/s] 47%|████▋     | 47/100 [00:05<00:05,  8.98it/s] 48%|████▊     | 48/100 [00:05<00:05,  8.98it/s] 49%|████▉     | 49/100 [00:05<00:05,  8.81it/s] 50%|█████     | 50/100 [00:05<00:05,  8.95it/s] 51%|█████     | 51/100 [00:05<00:05,  8.98it/s] 52%|█████▏    | 52/100 [00:05<00:05,  9.13it/s] 53%|█████▎    | 53/100 [00:05<00:05,  9.19it/s] 54%|█████▍    | 54/100 [00:05<00:05,  8.97it/s] 55%|█████▌    | 55/100 [00:06<00:05,  9.00it/s] 56%|█████▌    | 56/100 [00:06<00:04,  8.87it/s] 57%|█████▋    | 57/100 [00:06<00:04,  9.03it/s] 58%|█████▊    | 58/100 [00:06<00:04,  9.05it/s] 59%|█████▉    | 59/100 [00:06<00:04,  8.69it/s] 60%|██████    | 60/100 [00:06<00:04,  8.64it/s] 61%|██████    | 61/100 [00:06<00:04,  8.53it/s] 63%|██████▎   | 63/100 [00:06<00:04,  8.81it/s] 64%|██████▍   | 64/100 [00:07<00:04,  8.96it/s] 65%|██████▌   | 65/100 [00:07<00:03,  8.99it/s] 66%|██████▌   | 66/100 [00:07<00:03,  9.08it/s] 67%|██████▋   | 67/100 [00:07<00:03,  9.18it/s] 69%|██████▉   | 69/100 [00:07<00:03,  9.57it/s] 70%|███████   | 70/100 [00:07<00:03,  7.91it/s] 71%|███████   | 71/100 [00:07<00:03,  8.13it/s] 72%|███████▏  | 72/100 [00:08<00:03,  8.08it/s] 73%|███████▎  | 73/100 [00:08<00:03,  8.06it/s] 74%|███████▍  | 74/100 [00:08<00:03,  8.12it/s] 75%|███████▌  | 75/100 [00:08<00:03,  8.20it/s] 76%|███████▌  | 76/100 [00:08<00:02,  8.16it/s] 77%|███████▋  | 77/100 [00:08<00:02,  8.26it/s] 78%|███████▊  | 78/100 [00:08<00:02,  8.50it/s] 79%|███████▉  | 79/100 [00:08<00:02,  8.62it/s] 80%|████████  | 80/100 [00:09<00:02,  8.19it/s] 81%|████████  | 81/100 [00:09<00:02,  8.30it/s] 82%|████████▏ | 82/100 [00:09<00:02,  8.47it/s] 83%|████████▎ | 83/100 [00:09<00:02,  8.47it/s] 84%|████████▍ | 84/100 [00:09<00:01,  8.56it/s] 85%|████████▌ | 85/100 [00:09<00:01,  8.57it/s] 86%|████████▌ | 86/100 [00:09<00:01,  8.87it/s] 87%|████████▋ | 87/100 [00:09<00:01,  8.73it/s] 89%|████████▉ | 89/100 [00:10<00:01,  9.12it/s] 90%|█████████ | 90/100 [00:10<00:01,  8.98it/s] 91%|█████████ | 91/100 [00:10<00:00,  9.01it/s] 92%|█████████▏| 92/100 [00:10<00:00,  8.88it/s] 93%|█████████▎| 93/100 [00:10<00:00,  7.43it/s] 94%|█████████▍| 94/100 [00:10<00:00,  7.61it/s] 95%|█████████▌| 95/100 [00:10<00:00,  7.56it/s] 96%|█████████▌| 96/100 [00:10<00:00,  7.69it/s] 97%|█████████▋| 97/100 [00:11<00:00,  7.79it/s] 98%|█████████▊| 98/100 [00:11<00:00,  7.86it/s] 99%|█████████▉| 99/100 [00:11<00:00,  7.24it/s]100%|██████████| 100/100 [00:11<00:00,  7.52it/s]100%|██████████| 100/100 [00:11<00:00,  8.72it/s]
[I 2025-08-31 18:39:19,190] A new study created in memory with name: no-name-6207109e-2914-4ba0-8db3-ff89728c2ad3
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 25.64 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.665845, Valid_loss 0.624219
Epoch 2, Train Loss 0.615058, Valid_loss 0.587622
Epoch 3, Train Loss 0.575862, Valid_loss 0.572117
Epoch 4, Train Loss 0.530028, Valid_loss 0.527798
Epoch 5, Train Loss 0.502398, Valid_loss 0.519785
Epoch 6, Train Loss 0.478223, Valid_loss 0.480610
Epoch 7, Train Loss 0.466412, Valid_loss 0.470345
Epoch 8, Train Loss 0.448953, Valid_loss 0.459540
Epoch 9, Train Loss 0.435857, Valid_loss 0.455231
Epoch 10, Train Loss 0.425506, Valid_loss 0.426643
Epoch 11, Train Loss 0.414065, Valid_loss 0.419671
Epoch 12, Train Loss 0.400716, Valid_loss 0.418357
Epoch 13, Train Loss 0.399034, Valid_loss 0.407940
Epoch 14, Train Loss 0.386183, Valid_loss 0.407904
Epoch 15, Train Loss 0.386912, Valid_loss 0.404685
Epoch 16, Train Loss 0.377955, Valid_loss 0.395435
Epoch 17, Train Loss 0.368366, Valid_loss 0.382914
Epoch 18, Train Loss 0.360658, Valid_loss 0.392650
Epoch 19, Train Loss 0.358250, Valid_loss 0.379140
Epoch 20, Train Loss 0.354808, Valid_loss 0.420447
Epoch 21, Train Loss 0.351185, Valid_loss 0.363355
Epoch 22, Train Loss 0.356965, Valid_loss 0.363905
Epoch 23, Train Loss 0.342567, Valid_loss 0.353812
Epoch 24, Train Loss 0.331325, Valid_loss 0.387408
Epoch 25, Train Loss 0.338291, Valid_loss 0.343771
Epoch 26, Train Loss 0.337974, Valid_loss 0.426308
Epoch 27, Train Loss 0.338896, Valid_loss 0.349158
Epoch 28, Train Loss 0.325419, Valid_loss 0.361341
Epoch 29, Train Loss 0.312313, Valid_loss 0.317138
Epoch 30, Train Loss 0.307379, Valid_loss 0.338293
Epoch 31, Train Loss 0.297807, Valid_loss 0.330065
Epoch 32, Train Loss 0.290362, Valid_loss 0.336198
Epoch 33, Train Loss 0.287753, Valid_loss 0.357290
Epoch 34, Train Loss 0.276800, Valid_loss 0.310367
Epoch 35, Train Loss 0.273664, Valid_loss 0.363432
Epoch 36, Train Loss 0.272505, Valid_loss 0.328474
Epoch 37, Train Loss 0.258229, Valid_loss 0.332956
Epoch 38, Train Loss 0.254066, Valid_loss 0.344491
Epoch 39, Train Loss 0.254664, Valid_loss 0.307285
Epoch 40, Train Loss 0.246361, Valid_loss 0.344690
Epoch 41, Train Loss 0.246608, Valid_loss 0.312563
Epoch 42, Train Loss 0.242259, Valid_loss 0.309577
Epoch 43, Train Loss 0.241710, Valid_loss 0.368169
Epoch 44, Train Loss 0.245154, Valid_loss 0.296736
Epoch 45, Train Loss 0.249564, Valid_loss 0.323037
Epoch 46, Train Loss 0.243664, Valid_loss 0.298953
Epoch 47, Train Loss 0.242160, Valid_loss 0.326546
Epoch 48, Train Loss 0.242994, Valid_loss 0.317214
Epoch 49, Train Loss 0.235332, Valid_loss 0.340862
Epoch 50, Train Loss 0.239413, Valid_loss 0.331450
Epoch 51, Train Loss 0.232787, Valid_loss 0.307107
Epoch 52, Train Loss 0.237160, Valid_loss 0.325545
Epoch 53, Train Loss 0.233229, Valid_loss 0.323818
Epoch 54, Train Loss 0.232985, Valid_loss 0.338178
Epoch 55, Train Loss 0.230821, Valid_loss 0.358799
[I 2025-08-31 18:43:24,055] Trial 0 finished with value: 0.296736016869545 and parameters: {'learning_rate': 0.001, 'epochs': 100, 'heads': 4, 'dropout': 0.0, 'weight_decay': 0.01, 'emb_dim': 8, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.296736016869545.
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 25.64 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.685508, Valid_loss 0.600591
Epoch 2, Train Loss 0.673080, Valid_loss 0.623377
Epoch 3, Train Loss 0.684543, Valid_loss 0.628573
Epoch 4, Train Loss 0.651096, Valid_loss 0.619597
Epoch 5, Train Loss 0.633310, Valid_loss 0.613561
Epoch 6, Train Loss 0.618878, Valid_loss 0.602948
Epoch 7, Train Loss 0.647838, Valid_loss 0.601168
Epoch 8, Train Loss 0.633665, Valid_loss 0.603051
Epoch 9, Train Loss 0.650496, Valid_loss 0.606411
Epoch 10, Train Loss 0.635038, Valid_loss 0.607854
Epoch 11, Train Loss 0.625214, Valid_loss 0.603792
Epoch 12, Train Loss 0.644079, Valid_loss 0.596097
Epoch 13, Train Loss 0.629901, Valid_loss 0.602392
Epoch 14, Train Loss 0.624624, Valid_loss 0.566858
Epoch 15, Train Loss 0.588150, Valid_loss 0.599558
Epoch 16, Train Loss 0.588415, Valid_loss 0.478092
Epoch 17, Train Loss 0.558958, Valid_loss 0.511969
Epoch 18, Train Loss 0.589966, Valid_loss 0.492634
Epoch 19, Train Loss 0.566870, Valid_loss 0.509120
Epoch 20, Train Loss 0.585189, Valid_loss 0.462279
Epoch 21, Train Loss 0.558127, Valid_loss 0.613737
Epoch 22, Train Loss 0.557107, Valid_loss 0.620291
Epoch 23, Train Loss 0.555620, Valid_loss 0.628297
Epoch 24, Train Loss 0.535365, Valid_loss 0.626751
Epoch 25, Train Loss 0.562545, Valid_loss 0.629151
Epoch 26, Train Loss 0.537814, Valid_loss 0.648282
Epoch 27, Train Loss 0.607623, Valid_loss 0.627592
Epoch 28, Train Loss 0.685802, Valid_loss 0.602666
Epoch 29, Train Loss 0.632282, Valid_loss 0.609616
Epoch 30, Train Loss 0.630435, Valid_loss 0.608465
Epoch 31, Train Loss 0.629285, Valid_loss 0.605490
Epoch 32, Train Loss 0.629416, Valid_loss 0.603125
Epoch 33, Train Loss 0.630769, Valid_loss 0.604536
Epoch 34, Train Loss 0.637442, Valid_loss 0.604238
Epoch 35, Train Loss 0.627443, Valid_loss 0.603335
Epoch 36, Train Loss 0.631783, Valid_loss 0.603444
Epoch 37, Train Loss 0.634410, Valid_loss 0.603509
Epoch 38, Train Loss 0.629920, Valid_loss 0.604202
Epoch 39, Train Loss 0.636902, Valid_loss 0.603406
Epoch 40, Train Loss 0.632228, Valid_loss 0.604559
Epoch 41, Train Loss 0.630742, Valid_loss 0.605603
Epoch 42, Train Loss 0.630786, Valid_loss 0.603710
Epoch 43, Train Loss 0.626471, Valid_loss 0.604980
Epoch 44, Train Loss 0.625512, Valid_loss 0.602939
Epoch 45, Train Loss 0.631644, Valid_loss 0.604413
Epoch 46, Train Loss 0.632126, Valid_loss 0.603385
Epoch 47, Train Loss 0.634555, Valid_loss 0.603655
Epoch 48, Train Loss 0.630051, Valid_loss 0.604563
Epoch 49, Train Loss 0.629613, Valid_loss 0.603439
Epoch 50, Train Loss 0.632410, Valid_loss 0.602599
Epoch 51, Train Loss 0.629898, Valid_loss 0.603296
Epoch 52, Train Loss 0.629591, Valid_loss 0.603045
Epoch 53, Train Loss 0.626430, Valid_loss 0.602887
Epoch 54, Train Loss 0.632526, Valid_loss 0.603161
Epoch 55, Train Loss 0.630982, Valid_loss 0.603284
[I 2025-08-31 18:47:04,898] Trial 1 finished with value: 0.46227945600237164 and parameters: {'learning_rate': 0.01, 'epochs': 100, 'heads': 2, 'dropout': 0.7, 'weight_decay': 0.01, 'emb_dim': 8, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.296736016869545.
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 29.04 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.607254, Valid_loss 0.590405
Epoch 2, Train Loss 0.445423, Valid_loss 0.419920
Epoch 3, Train Loss 0.327377, Valid_loss 0.377279
Epoch 4, Train Loss 0.306694, Valid_loss 0.367698
Epoch 5, Train Loss 0.289340, Valid_loss 0.354810
Epoch 6, Train Loss 0.273848, Valid_loss 0.343929
Epoch 7, Train Loss 0.262831, Valid_loss 0.439394
Epoch 8, Train Loss 0.252186, Valid_loss 0.361908
Epoch 9, Train Loss 0.244572, Valid_loss 0.336677
Epoch 10, Train Loss 0.239446, Valid_loss 0.342769
Epoch 11, Train Loss 0.241195, Valid_loss 0.371545
Epoch 12, Train Loss 0.236691, Valid_loss 0.326612
Epoch 13, Train Loss 0.233562, Valid_loss 0.329721
Epoch 14, Train Loss 0.247984, Valid_loss 0.684800
Epoch 15, Train Loss 0.279681, Valid_loss 0.305424
Epoch 16, Train Loss 0.234275, Valid_loss 0.362049
Epoch 17, Train Loss 0.226561, Valid_loss 0.305414
Epoch 18, Train Loss 0.225208, Valid_loss 0.349007
Epoch 19, Train Loss 0.216240, Valid_loss 0.313857
Epoch 20, Train Loss 0.210211, Valid_loss 0.338811
Epoch 21, Train Loss 0.212429, Valid_loss 0.314673
Epoch 22, Train Loss 0.211904, Valid_loss 0.303440
Epoch 23, Train Loss 0.211970, Valid_loss 0.322007
Epoch 24, Train Loss 0.210596, Valid_loss 0.309235
Epoch 25, Train Loss 0.213920, Valid_loss 0.313170
Epoch 26, Train Loss 0.221059, Valid_loss 0.328193
Epoch 27, Train Loss 0.222655, Valid_loss 0.320737
Epoch 28, Train Loss 0.211497, Valid_loss 0.304326
Epoch 29, Train Loss 0.223829, Valid_loss 0.318611
Epoch 30, Train Loss 0.211034, Valid_loss 0.310208
Epoch 31, Train Loss 0.205987, Valid_loss 0.296633
Epoch 32, Train Loss 0.215603, Valid_loss 0.326968
Epoch 33, Train Loss 0.216783, Valid_loss 0.302885
Epoch 34, Train Loss 0.222078, Valid_loss 0.297664
Epoch 35, Train Loss 0.206803, Valid_loss 0.326037
Epoch 36, Train Loss 0.208981, Valid_loss 0.304414
Epoch 37, Train Loss 0.206435, Valid_loss 0.311386
Epoch 38, Train Loss 0.208897, Valid_loss 0.295748
Epoch 39, Train Loss 0.207235, Valid_loss 0.316529
Epoch 40, Train Loss 0.206128, Valid_loss 0.317928
Epoch 41, Train Loss 0.205691, Valid_loss 0.323499
Epoch 42, Train Loss 0.204310, Valid_loss 0.318929
Epoch 43, Train Loss 0.206984, Valid_loss 0.295779
Epoch 44, Train Loss 0.204251, Valid_loss 0.300546
Epoch 45, Train Loss 0.205687, Valid_loss 0.323489
Epoch 46, Train Loss 0.204317, Valid_loss 0.313777
Epoch 47, Train Loss 0.203212, Valid_loss 0.339444
Epoch 48, Train Loss 0.212118, Valid_loss 0.331588
Epoch 49, Train Loss 0.210234, Valid_loss 0.329279
Epoch 50, Train Loss 0.212481, Valid_loss 0.244067
Epoch 51, Train Loss 0.217886, Valid_loss 0.314906
Epoch 52, Train Loss 0.205103, Valid_loss 0.293925
Epoch 53, Train Loss 0.202223, Valid_loss 0.297763
Epoch 54, Train Loss 0.199411, Valid_loss 0.294208
Epoch 55, Train Loss 0.201317, Valid_loss 0.296491
Epoch 56, Train Loss 0.200590, Valid_loss 0.296791
[I 2025-08-31 18:50:32,321] Trial 2 finished with value: 0.2440670155254858 and parameters: {'learning_rate': 0.001, 'epochs': 100, 'heads': 1, 'dropout': 0.0, 'weight_decay': 0.0001, 'emb_dim': 64, 'augment_num': 100, 'pca': False}. Best is trial 2 with value: 0.2440670155254858.
선택된 trial params: {'learning_rate': 0.001, 'epochs': 100, 'heads': 1, 'dropout': 0.0, 'weight_decay': 0.0001, 'emb_dim': 64, 'augment_num': 100, 'pca': False}
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=10, batch_size=1 -> steps=10
output_class :  1
Memory Allocated: 29.04 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.565454, Valid_loss 0.468916
Epoch 2, Train Loss 0.369040, Valid_loss 0.402418
Epoch 3, Train Loss 0.327334, Valid_loss 0.360518
Epoch 4, Train Loss 0.294673, Valid_loss 0.408677
Epoch 5, Train Loss 0.305799, Valid_loss 0.351019
Epoch 6, Train Loss 0.277632, Valid_loss 0.322533
Epoch 7, Train Loss 0.262138, Valid_loss 0.315307
Epoch 8, Train Loss 0.258694, Valid_loss 0.428545
Epoch 9, Train Loss 0.261588, Valid_loss 0.377195
Epoch 10, Train Loss 0.251387, Valid_loss 0.316644
Epoch 11, Train Loss 0.247438, Valid_loss 0.411044
Epoch 12, Train Loss 0.236171, Valid_loss 0.344254
Epoch 13, Train Loss 0.233149, Valid_loss 0.327599
Epoch 14, Train Loss 0.227691, Valid_loss 0.330449
Epoch 15, Train Loss 0.222411, Valid_loss 0.285460
Epoch 16, Train Loss 0.217388, Valid_loss 0.283775
Epoch 17, Train Loss 0.222172, Valid_loss 0.285731
Epoch 18, Train Loss 0.218793, Valid_loss 0.288437
Epoch 19, Train Loss 0.227781, Valid_loss 0.299707
Epoch 20, Train Loss 0.225682, Valid_loss 0.287433
Epoch 21, Train Loss 0.218173, Valid_loss 0.298954
Epoch 22, Train Loss 0.211169, Valid_loss 0.320575
Epoch 23, Train Loss 0.210190, Valid_loss 0.301489
Epoch 24, Train Loss 0.213764, Valid_loss 0.346915
Epoch 25, Train Loss 0.217001, Valid_loss 0.323634
Epoch 26, Train Loss 0.220083, Valid_loss 0.303142
Epoch 27, Train Loss 0.230311, Valid_loss 0.308060
Epoch 28, Train Loss 0.237816, Valid_loss 0.258477
Epoch 29, Train Loss 0.216722, Valid_loss 0.245231
Epoch 30, Train Loss 0.209935, Valid_loss 0.262331
Epoch 31, Train Loss 0.207028, Valid_loss 0.292401
Epoch 32, Train Loss 0.207802, Valid_loss 0.249506
Epoch 33, Train Loss 0.207490, Valid_loss 0.271686
Epoch 34, Train Loss 0.207901, Valid_loss 0.280283
Epoch 35, Train Loss 0.207515, Valid_loss 0.286046
Epoch 36, Train Loss 0.210259, Valid_loss 0.270818
Epoch 37, Train Loss 0.204217, Valid_loss 0.283062
Epoch 38, Train Loss 0.208348, Valid_loss 0.282195
Epoch 39, Train Loss 0.206924, Valid_loss 0.269695
Epoch 40, Train Loss 0.205792, Valid_loss 0.244761
Epoch 41, Train Loss 0.208729, Valid_loss 0.248383
Epoch 42, Train Loss 0.206281, Valid_loss 0.283022
Epoch 43, Train Loss 0.203796, Valid_loss 0.292686
Epoch 44, Train Loss 0.202334, Valid_loss 0.251050
Epoch 45, Train Loss 0.203218, Valid_loss 0.258609
Epoch 46, Train Loss 0.203887, Valid_loss 0.288846
Epoch 47, Train Loss 0.204560, Valid_loss 0.271783
Epoch 48, Train Loss 0.207425, Valid_loss 0.274351
Epoch 49, Train Loss 0.212710, Valid_loss 0.282265
Epoch 50, Train Loss 0.207626, Valid_loss 0.281986
Epoch 51, Train Loss 0.200003, Valid_loss 0.281640
Epoch 52, Train Loss 0.201095, Valid_loss 0.261655
Epoch 53, Train Loss 0.201892, Valid_loss 0.269140
Epoch 54, Train Loss 0.198985, Valid_loss 0.270975
환자ID=COVID19_Participant13 -- true: 1 -- pred: 1
환자ID=COVID19_Participant21 -- true: 1 -- pred: 1
환자ID=COVID19_Participant29 -- true: 1 -- pred: 1
환자ID=COVID19_Participant39 -- true: 1 -- pred: 1
환자ID=COVID19_Participant40 -- true: 1 -- pred: 1
환자ID=COVID19_Participant5 -- true: 1 -- pred: 1
환자ID=COVID19_Participant6 -- true: 1 -- pred: 1
환자ID=Control_Participant11 -- true: 0 -- pred: 1
환자ID=Control_Participant14 -- true: 0 -- pred: 0
환자ID=Control_Participant15 -- true: 0 -- pred: 0
Best performance: Epoch 40, Loss 0.205792, Test ACC 0.900000, Test AUC 0.904762, Test Recall 1.000000, Test Precision 0.875000
Confusion Matrix:
 [2 1 0 7]
✅ Total valid splits used: 5

📌 Repeat 2: 평균 AUC = 0.8857, 표준편차 = 0.0233
Test ACC 평균 0.800000, Test Recall 평균 0.800000, Test Precision 평균 0.908333
fold_aucs = [0.9047619047619048, 0.8571428571428571, 0.8571428571428571, 0.9047619047619049, 0.9047619047619049]
NaN 개수: 0 / 전체 5개

🔁 Repeat 3, Fold 0
cell type :  GTCGGGGGGTGG_Control_Participant7        Keratinocytes
CAAATCAATTAT_Control_Participant7     Epithelial_cells
ATACAATTGACA_Control_Participant7     Epithelial_cells
CTGTTAATGAGA_Control_Participant7     Epithelial_cells
CTTCACATTATT_Control_Participant7     Epithelial_cells
                                            ...       
GCAGGGAACTCC_COVID19_Participant30    Epithelial_cells
CAGCACCGAGCC_COVID19_Participant30    Epithelial_cells
GCCCCTTGTGAT_COVID19_Participant30    Epithelial_cells
GTGTTGTGTGTC_COVID19_Participant30              B_cell
TAACACTCACTT_COVID19_Participant30           Myelocyte
Name: singler_annotation, Length: 22638, dtype: string
cell type annotation :  GTCGGGGGGTGG_Control_Participant7        Keratinocytes
CAAATCAATTAT_Control_Participant7     Epithelial_cells
ATACAATTGACA_Control_Participant7     Epithelial_cells
CTGTTAATGAGA_Control_Participant7     Epithelial_cells
CTTCACATTATT_Control_Participant7     Epithelial_cells
                                            ...       
GCAGGGAACTCC_COVID19_Participant30    Epithelial_cells
CAGCACCGAGCC_COVID19_Participant30    Epithelial_cells
GCCCCTTGTGAT_COVID19_Participant30    Epithelial_cells
GTGTTGTGTGTC_COVID19_Participant30              B_cell
TAACACTCACTT_COVID19_Participant30           Myelocyte
Name: singler_annotation, Length: 22638, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Keratinocytes', 'Epithelial_cells', 'Neurons', 'iPS_cells', 'Embryonic_stem_cells', 'Astrocyte', 'DC', 'Gametocytes', 'HSC_-G-CSF', 'Smooth_muscle_cells', 'BM & Prog.', 'Monocyte', 'Myelocyte', 'BM', 'Endothelial_cells', 'Osteoblasts', 'Platelets', 'Erythroblast', 'NK_cell', 'T_cells', 'Chondrocytes', 'HSC_CD34+', 'CMP', 'Neutrophils', 'Fibroblasts', 'MEP', 'Neuroepithelial_cell', 'MSC', 'Pro-Myelocyte', 'B_cell', 'GMP', 'Hepatocytes', 'Macrophage', 'Tissue_stem_cells', 'Pre-B_cell_CD34-', 'Unknown', 'Pro-B_cell_CD34+']
라벨별 그룹 개수 {1: 28, 0: 12}
cell type :  TTGCGGTGACCA_COVID19_Participant31    Epithelial_cells
AGGCTCGAACTG_COVID19_Participant31    Epithelial_cells
TATCCGTATGTT_COVID19_Participant31             NK_cell
CAGACAGCGGCT_COVID19_Participant31    Epithelial_cells
CAAAGAGAACTA_COVID19_Participant31    Epithelial_cells
                                            ...       
CGTATGTACGAG_COVID19_Participant9     Epithelial_cells
TCATAGGCTGGG_COVID19_Participant9              T_cells
AGGGATCAGGCG_COVID19_Participant9         Erythroblast
TTCCTCATTAGC_COVID19_Participant9        Keratinocytes
TCTAGGCCACAA_COVID19_Participant9     Epithelial_cells
Name: singler_annotation, Length: 4309, dtype: string
cell type annotation :  TTGCGGTGACCA_COVID19_Participant31    Epithelial_cells
AGGCTCGAACTG_COVID19_Participant31    Epithelial_cells
TATCCGTATGTT_COVID19_Participant31             NK_cell
CAGACAGCGGCT_COVID19_Participant31    Epithelial_cells
CAAAGAGAACTA_COVID19_Participant31    Epithelial_cells
                                            ...       
CGTATGTACGAG_COVID19_Participant9     Epithelial_cells
TCATAGGCTGGG_COVID19_Participant9              T_cells
AGGGATCAGGCG_COVID19_Participant9         Erythroblast
TTCCTCATTAGC_COVID19_Participant9        Keratinocytes
TCTAGGCCACAA_COVID19_Participant9     Epithelial_cells
Name: singler_annotation, Length: 4309, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Epithelial_cells', 'NK_cell', 'Keratinocytes', 'Macrophage', 'Neurons', 'T_cells', 'Monocyte', 'Chondrocytes', 'MEP', 'Neutrophils', 'Gametocytes', 'Endothelial_cells', 'HSC_CD34+', 'Hepatocytes', 'Tissue_stem_cells', 'Erythroblast', 'iPS_cells', 'DC', 'B_cell', 'Myelocyte', 'Astrocyte', 'Smooth_muscle_cells', 'Embryonic_stem_cells', 'HSC_-G-CSF', 'CMP', 'Osteoblasts', 'Platelets', 'BM & Prog.', 'GMP', 'Pro-B_cell_CD34+', 'BM', 'MSC', 'Neuroepithelial_cell', 'Pre-B_cell_CD34-', 'Pro-Myelocyte', 'Fibroblasts']
라벨별 그룹 개수 {1: 7, 0: 3}
🔍 Split #1
  → train_p_index 환자 수 (환자 단위로 묶인 index list): 40
  → test_p_index 환자 수  (환자 단위로 묶인 index list): 10
  → train 환자 ID: ['COVID19_Participant10', 'COVID19_Participant12', 'COVID19_Participant13', 'COVID19_Participant14', 'COVID19_Participant15', 'COVID19_Participant18', 'COVID19_Participant2', 'COVID19_Participant20', 'COVID19_Participant21', 'COVID19_Participant22', 'COVID19_Participant23', 'COVID19_Participant26', 'COVID19_Participant27', 'COVID19_Participant28', 'COVID19_Participant29', 'COVID19_Participant3', 'COVID19_Participant30', 'COVID19_Participant32', 'COVID19_Participant35', 'COVID19_Participant36', 'COVID19_Participant37', 'COVID19_Participant38', 'COVID19_Participant39', 'COVID19_Participant4', 'COVID19_Participant5', 'COVID19_Participant6', 'COVID19_Participant7', 'COVID19_Participant8', 'Control_Participant10', 'Control_Participant11', 'Control_Participant12', 'Control_Participant13', 'Control_Participant14', 'Control_Participant15', 'Control_Participant3', 'Control_Participant5', 'Control_Participant6', 'Control_Participant7', 'Control_Participant8', 'Control_Participant9']
  → test  환자 ID: ['COVID19_Participant11', 'COVID19_Participant17', 'COVID19_Participant19', 'COVID19_Participant25', 'COVID19_Participant31', 'COVID19_Participant40', 'COVID19_Participant9', 'Control_Participant1', 'Control_Participant2', 'Control_Participant4']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant10, Label: 1
    ID: COVID19_Participant12, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant18, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant21, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant27, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant3, Label: 1
    ID: COVID19_Participant30, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant35, Label: 1
    ID: COVID19_Participant36, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant38, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant5, Label: 1
    ID: COVID19_Participant6, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: Control_Participant10, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant12, Label: 0
    ID: Control_Participant13, Label: 0
    ID: Control_Participant14, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant6, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant8, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: COVID19_Participant9, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant2, Label: 0
    ID: Control_Participant4, Label: 0
전체 데이터 index 길이 50
label_stat (train 환자 라벨 목록) 갯수 40
train_data에서 환자 단위로, train과 validation 나누기
기존 train_p_index 40
기존 (train) label_stat 40
train-vali 분할 후! 
train y 의 classes : {0, 1} valid y 의 classes : {0, 1} label_stat 의 classes : {0, 1}
train_p_index_ 26
valid_p_index 14
test_p_index 10
→ train 환자 ID 및 라벨:
   총 개수: 26
   환자ID=Control_Participant11, Label=0, 셀개수=1164
   환자ID=Control_Participant15, Label=0, 셀개수=528
   환자ID=COVID19_Participant2, Label=1, 셀개수=329
   환자ID=COVID19_Participant38, Label=1, 셀개수=51
   환자ID=COVID19_Participant10, Label=1, 셀개수=18
   환자ID=Control_Participant6, Label=0, 셀개수=131
   환자ID=COVID19_Participant14, Label=1, 셀개수=382
   환자ID=COVID19_Participant20, Label=1, 셀개수=2033
   환자ID=COVID19_Participant4, Label=1, 셀개수=1680
   환자ID=COVID19_Participant13, Label=1, 셀개수=730
   환자ID=COVID19_Participant21, Label=1, 셀개수=39
   환자ID=Control_Participant3, Label=0, 셀개수=1620
   환자ID=COVID19_Participant28, Label=1, 셀개수=1079
   환자ID=Control_Participant8, Label=0, 셀개수=393
   환자ID=Control_Participant7, Label=0, 셀개수=762
   환자ID=COVID19_Participant15, Label=1, 셀개수=1003
   환자ID=Control_Participant9, Label=0, 셀개수=558
   환자ID=Control_Participant12, Label=0, 셀개수=99
   환자ID=COVID19_Participant23, Label=1, 셀개수=307
   환자ID=COVID19_Participant30, Label=1, 셀개수=116
   환자ID=COVID19_Participant27, Label=1, 셀개수=93
   환자ID=COVID19_Participant18, Label=1, 셀개수=227
   환자ID=COVID19_Participant6, Label=1, 셀개수=84
   환자ID=COVID19_Participant39, Label=1, 셀개수=454
   환자ID=COVID19_Participant37, Label=1, 셀개수=668
   환자ID=COVID19_Participant3, Label=1, 셀개수=104
→ valid 환자 ID 및 라벨:
   총 개수: 14
   환자ID=Control_Participant14, Label=0, 셀개수=274
   환자ID=COVID19_Participant29, Label=1, 셀개수=573
   환자ID=COVID19_Participant35, Label=1, 셀개수=83
   환자ID=COVID19_Participant32, Label=1, 셀개수=1665
   환자ID=COVID19_Participant5, Label=1, 셀개수=89
   환자ID=COVID19_Participant22, Label=1, 셀개수=865
   환자ID=Control_Participant5, Label=0, 셀개수=717
   환자ID=Control_Participant10, Label=0, 셀개수=1645
   환자ID=COVID19_Participant8, Label=1, 셀개수=462
   환자ID=COVID19_Participant7, Label=1, 셀개수=409
   환자ID=Control_Participant13, Label=0, 셀개수=88
   환자ID=COVID19_Participant36, Label=1, 셀개수=200
   환자ID=COVID19_Participant12, Label=1, 셀개수=102
   환자ID=COVID19_Participant26, Label=1, 셀개수=814
→ test 환자 ID 및 라벨:
   총 개수: 10
   환자ID=COVID19_Participant11, Label=1, 셀개수=382
   환자ID=COVID19_Participant17, Label=1, 셀개수=843
   환자ID=COVID19_Participant19, Label=1, 셀개수=816
   환자ID=COVID19_Participant25, Label=1, 셀개수=496
   환자ID=COVID19_Participant31, Label=1, 셀개수=410
   환자ID=COVID19_Participant40, Label=1, 셀개수=381
   환자ID=COVID19_Participant9, Label=1, 셀개수=86
   환자ID=Control_Participant1, Label=0, 셀개수=414
   환자ID=Control_Participant2, Label=0, 셀개수=41
   환자ID=Control_Participant4, Label=0, 셀개수=440
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Keratinocytes', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Neurons', 'iPS_cells', 'Embryonic_stem_cells', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
전체 데이터 길이 26947
전체 cell type 길이 0           Keratinocytes
1        Epithelial_cells
2        Epithelial_cells
3        Epithelial_cells
4        Epithelial_cells
               ...       
26942    Epithelial_cells
26943             T_cells
26944        Erythroblast
26945       Keratinocytes
26946    Epithelial_cells
Length: 26947, dtype: string
cell type의 NaN 개수 체크 0
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:14,  6.82it/s]  2%|▏         | 2/100 [00:00<00:14,  6.75it/s]  4%|▍         | 4/100 [00:00<00:11,  8.17it/s]  5%|▌         | 5/100 [00:00<00:11,  8.02it/s]  6%|▌         | 6/100 [00:00<00:12,  7.42it/s]  8%|▊         | 8/100 [00:01<00:11,  7.75it/s] 10%|█         | 10/100 [00:01<00:10,  8.53it/s] 12%|█▏        | 12/100 [00:01<00:09,  9.07it/s] 14%|█▍        | 14/100 [00:01<00:09,  9.42it/s] 15%|█▌        | 15/100 [00:01<00:09,  9.36it/s] 17%|█▋        | 17/100 [00:01<00:08,  9.64it/s] 18%|█▊        | 18/100 [00:02<00:08,  9.53it/s] 19%|█▉        | 19/100 [00:02<00:08,  9.43it/s] 20%|██        | 20/100 [00:02<00:08,  9.50it/s] 21%|██        | 21/100 [00:02<00:08,  9.61it/s] 22%|██▏       | 22/100 [00:02<00:08,  9.61it/s] 23%|██▎       | 23/100 [00:02<00:08,  9.37it/s] 25%|██▌       | 25/100 [00:02<00:07,  9.52it/s] 26%|██▌       | 26/100 [00:02<00:07,  9.37it/s] 27%|██▋       | 27/100 [00:03<00:08,  9.07it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.27it/s] 29%|██▉       | 29/100 [00:03<00:08,  8.13it/s] 31%|███       | 31/100 [00:03<00:07,  8.68it/s] 32%|███▏      | 32/100 [00:03<00:07,  8.93it/s] 33%|███▎      | 33/100 [00:03<00:08,  8.36it/s] 34%|███▍      | 34/100 [00:03<00:07,  8.63it/s] 35%|███▌      | 35/100 [00:03<00:07,  8.79it/s] 36%|███▌      | 36/100 [00:04<00:07,  8.12it/s] 37%|███▋      | 37/100 [00:04<00:07,  7.92it/s] 38%|███▊      | 38/100 [00:04<00:07,  8.41it/s] 39%|███▉      | 39/100 [00:04<00:07,  7.72it/s] 40%|████      | 40/100 [00:04<00:07,  8.03it/s] 41%|████      | 41/100 [00:04<00:07,  8.37it/s] 42%|████▏     | 42/100 [00:04<00:06,  8.38it/s] 43%|████▎     | 43/100 [00:04<00:06,  8.70it/s] 44%|████▍     | 44/100 [00:05<00:06,  8.60it/s] 45%|████▌     | 45/100 [00:05<00:06,  8.57it/s] 46%|████▌     | 46/100 [00:05<00:06,  8.79it/s] 47%|████▋     | 47/100 [00:05<00:05,  8.92it/s] 48%|████▊     | 48/100 [00:05<00:05,  8.88it/s] 49%|████▉     | 49/100 [00:05<00:05,  9.08it/s] 50%|█████     | 50/100 [00:05<00:05,  9.00it/s] 51%|█████     | 51/100 [00:05<00:05,  9.05it/s] 52%|█████▏    | 52/100 [00:06<00:06,  7.87it/s] 53%|█████▎    | 53/100 [00:06<00:05,  8.31it/s] 54%|█████▍    | 54/100 [00:06<00:05,  8.59it/s] 55%|█████▌    | 55/100 [00:06<00:05,  8.55it/s] 56%|█████▌    | 56/100 [00:06<00:04,  8.84it/s] 57%|█████▋    | 57/100 [00:06<00:05,  7.75it/s] 58%|█████▊    | 58/100 [00:06<00:05,  8.03it/s] 59%|█████▉    | 59/100 [00:06<00:05,  7.48it/s] 60%|██████    | 60/100 [00:06<00:05,  7.82it/s] 61%|██████    | 61/100 [00:07<00:04,  7.97it/s] 63%|██████▎   | 63/100 [00:07<00:04,  8.56it/s] 65%|██████▌   | 65/100 [00:07<00:04,  8.52it/s] 66%|██████▌   | 66/100 [00:07<00:04,  8.43it/s] 67%|██████▋   | 67/100 [00:07<00:04,  7.80it/s] 68%|██████▊   | 68/100 [00:07<00:03,  8.21it/s] 69%|██████▉   | 69/100 [00:08<00:04,  6.71it/s] 70%|███████   | 70/100 [00:08<00:04,  7.38it/s] 71%|███████   | 71/100 [00:08<00:04,  7.00it/s] 72%|███████▏  | 72/100 [00:08<00:03,  7.60it/s] 73%|███████▎  | 73/100 [00:08<00:03,  7.43it/s] 74%|███████▍  | 74/100 [00:08<00:03,  7.98it/s] 75%|███████▌  | 75/100 [00:08<00:03,  8.31it/s] 76%|███████▌  | 76/100 [00:09<00:02,  8.34it/s] 77%|███████▋  | 77/100 [00:09<00:02,  7.67it/s] 78%|███████▊  | 78/100 [00:09<00:03,  7.07it/s] 79%|███████▉  | 79/100 [00:09<00:03,  6.13it/s] 80%|████████  | 80/100 [00:09<00:03,  6.46it/s] 81%|████████  | 81/100 [00:09<00:02,  6.80it/s] 82%|████████▏ | 82/100 [00:09<00:02,  6.89it/s] 83%|████████▎ | 83/100 [00:10<00:02,  7.39it/s] 84%|████████▍ | 84/100 [00:10<00:02,  7.17it/s] 85%|████████▌ | 85/100 [00:10<00:02,  7.18it/s] 86%|████████▌ | 86/100 [00:10<00:01,  7.30it/s] 87%|████████▋ | 87/100 [00:10<00:01,  7.02it/s] 88%|████████▊ | 88/100 [00:10<00:01,  7.39it/s] 89%|████████▉ | 89/100 [00:10<00:01,  7.64it/s] 90%|█████████ | 90/100 [00:10<00:01,  7.99it/s] 91%|█████████ | 91/100 [00:11<00:01,  7.63it/s] 92%|█████████▏| 92/100 [00:11<00:01,  7.64it/s] 93%|█████████▎| 93/100 [00:11<00:00,  7.64it/s] 94%|█████████▍| 94/100 [00:11<00:00,  7.21it/s] 95%|█████████▌| 95/100 [00:11<00:00,  7.62it/s] 96%|█████████▌| 96/100 [00:11<00:00,  7.02it/s] 97%|█████████▋| 97/100 [00:11<00:00,  7.53it/s] 98%|█████████▊| 98/100 [00:12<00:00,  7.42it/s] 99%|█████████▉| 99/100 [00:12<00:00,  7.56it/s]100%|██████████| 100/100 [00:12<00:00,  7.55it/s]100%|██████████| 100/100 [00:12<00:00,  8.10it/s]
[I 2025-08-31 18:54:06,125] A new study created in memory with name: no-name-aa43d7bd-4166-4b3a-afeb-d0b6f1aeab8f
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 26.96 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.614377, Valid_loss 0.583030
Epoch 2, Train Loss 0.495203, Valid_loss 0.495099
Epoch 3, Train Loss 0.314465, Valid_loss 0.729493
Epoch 4, Train Loss 0.326445, Valid_loss 0.585028
Epoch 5, Train Loss 0.300416, Valid_loss 0.798811
Epoch 6, Train Loss 0.234203, Valid_loss 0.503887
Epoch 7, Train Loss 0.224401, Valid_loss 0.345816
Epoch 8, Train Loss 0.241576, Valid_loss 0.537552
Epoch 9, Train Loss 0.233713, Valid_loss 0.442369
Epoch 10, Train Loss 0.228249, Valid_loss 0.452486
Epoch 11, Train Loss 0.216239, Valid_loss 0.347667
Epoch 12, Train Loss 0.218914, Valid_loss 0.884814
Epoch 13, Train Loss 0.210320, Valid_loss 0.484089
Epoch 14, Train Loss 0.226116, Valid_loss 0.527646
Epoch 15, Train Loss 0.220730, Valid_loss 0.438207
Epoch 16, Train Loss 0.226458, Valid_loss 0.565749
Epoch 17, Train Loss 0.246098, Valid_loss 0.434666
Epoch 18, Train Loss 0.223300, Valid_loss 0.473387
Epoch 19, Train Loss 0.208870, Valid_loss 0.502332
Epoch 20, Train Loss 0.198190, Valid_loss 0.473772
Epoch 21, Train Loss 0.199583, Valid_loss 0.466608
Epoch 22, Train Loss 0.195574, Valid_loss 0.518055
Epoch 23, Train Loss 0.196336, Valid_loss 0.545643
Epoch 24, Train Loss 0.196011, Valid_loss 0.570227
Epoch 25, Train Loss 0.196751, Valid_loss 0.685631
Epoch 26, Train Loss 0.202046, Valid_loss 0.611682
Epoch 27, Train Loss 0.203823, Valid_loss 0.999702
Epoch 28, Train Loss 0.202835, Valid_loss 0.375202
Epoch 29, Train Loss 0.215731, Valid_loss 0.677688
Epoch 30, Train Loss 0.228016, Valid_loss 0.443284
Epoch 31, Train Loss 0.209077, Valid_loss 0.393960
Epoch 32, Train Loss 0.192778, Valid_loss 0.437242
Epoch 33, Train Loss 0.188571, Valid_loss 0.495757
Epoch 34, Train Loss 0.192193, Valid_loss 0.472536
Epoch 35, Train Loss 0.194532, Valid_loss 0.625420
Epoch 36, Train Loss 0.188244, Valid_loss 0.542893
Epoch 37, Train Loss 0.184478, Valid_loss 0.638816
Epoch 38, Train Loss 0.191339, Valid_loss 0.524909
Epoch 39, Train Loss 0.368017, Valid_loss 0.726382
Epoch 40, Train Loss 0.270397, Valid_loss 0.457629
Epoch 41, Train Loss 0.227872, Valid_loss 0.534840
Epoch 42, Train Loss 0.222108, Valid_loss 0.583883
Epoch 43, Train Loss 0.204869, Valid_loss 0.602118
Epoch 44, Train Loss 0.206151, Valid_loss 0.666573
Epoch 45, Train Loss 0.212670, Valid_loss 0.814866
Epoch 46, Train Loss 0.203119, Valid_loss 0.604174
Epoch 47, Train Loss 0.192718, Valid_loss 0.586422
Epoch 48, Train Loss 0.195108, Valid_loss 0.450504
Epoch 49, Train Loss 0.196472, Valid_loss 0.546354
Epoch 50, Train Loss 0.192764, Valid_loss 0.661288
Epoch 51, Train Loss 0.190151, Valid_loss 0.565005
Epoch 52, Train Loss 0.187569, Valid_loss 0.541430
Epoch 53, Train Loss 0.193952, Valid_loss 0.674406
Epoch 54, Train Loss 0.185998, Valid_loss 0.628479
Epoch 55, Train Loss 0.187413, Valid_loss 0.542150
Epoch 56, Train Loss 0.183420, Valid_loss 0.618773
Epoch 57, Train Loss 0.185212, Valid_loss 0.554990
Epoch 58, Train Loss 0.185809, Valid_loss 0.648350
Epoch 59, Train Loss 0.187021, Valid_loss 0.680252
[I 2025-08-31 18:58:28,124] Trial 0 finished with value: 0.34581598320177626 and parameters: {'learning_rate': 0.01, 'epochs': 100, 'heads': 4, 'dropout': 0.0, 'weight_decay': 0.001, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.34581598320177626.
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 29.04 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.612663, Valid_loss 0.551874
Epoch 2, Train Loss 0.457805, Valid_loss 0.450539
Epoch 3, Train Loss 0.334696, Valid_loss 0.498437
Epoch 4, Train Loss 0.291838, Valid_loss 0.450491
Epoch 5, Train Loss 0.287317, Valid_loss 0.308313
Epoch 6, Train Loss 0.287798, Valid_loss 0.306505
Epoch 7, Train Loss 0.285834, Valid_loss 0.459554
Epoch 8, Train Loss 0.265716, Valid_loss 0.608637
Epoch 9, Train Loss 0.262033, Valid_loss 0.453402
Epoch 10, Train Loss 0.245809, Valid_loss 0.454973
Epoch 11, Train Loss 0.253872, Valid_loss 0.528106
Epoch 12, Train Loss 0.226790, Valid_loss 0.493110
Epoch 13, Train Loss 0.223467, Valid_loss 0.439868
Epoch 14, Train Loss 0.223935, Valid_loss 0.447647
Epoch 15, Train Loss 0.229217, Valid_loss 0.414707
Epoch 16, Train Loss 0.210109, Valid_loss 0.447862
Epoch 17, Train Loss 0.227776, Valid_loss 0.348436
Epoch 18, Train Loss 0.223227, Valid_loss 0.509960
Epoch 19, Train Loss 0.209404, Valid_loss 0.485843
Epoch 20, Train Loss 0.208033, Valid_loss 0.517009
Epoch 21, Train Loss 0.202186, Valid_loss 0.401518
Epoch 22, Train Loss 0.230675, Valid_loss 0.740439
Epoch 23, Train Loss 0.267753, Valid_loss 0.753885
Epoch 24, Train Loss 0.225148, Valid_loss 0.670321
Epoch 25, Train Loss 0.204452, Valid_loss 0.458083
Epoch 26, Train Loss 0.206003, Valid_loss 0.508729
Epoch 27, Train Loss 0.198187, Valid_loss 0.455437
Epoch 28, Train Loss 0.196047, Valid_loss 0.394077
Epoch 29, Train Loss 0.210417, Valid_loss 0.359217
Epoch 30, Train Loss 0.204722, Valid_loss 0.429676
Epoch 31, Train Loss 0.198672, Valid_loss 0.472825
Epoch 32, Train Loss 0.191440, Valid_loss 0.370613
Epoch 33, Train Loss 0.200407, Valid_loss 0.360139
Epoch 34, Train Loss 0.201221, Valid_loss 0.380445
Epoch 35, Train Loss 0.193796, Valid_loss 0.400561
Epoch 36, Train Loss 0.192153, Valid_loss 0.469192
Epoch 37, Train Loss 0.194492, Valid_loss 0.373535
Epoch 38, Train Loss 0.199139, Valid_loss 0.361796
Epoch 39, Train Loss 0.205294, Valid_loss 0.374493
Epoch 40, Train Loss 0.196619, Valid_loss 0.370355
Epoch 41, Train Loss 0.201445, Valid_loss 0.393707
Epoch 42, Train Loss 0.197451, Valid_loss 0.345770
Epoch 43, Train Loss 0.208478, Valid_loss 0.333903
Epoch 44, Train Loss 0.209250, Valid_loss 0.365280
Epoch 45, Train Loss 0.197385, Valid_loss 0.441684
Epoch 46, Train Loss 0.191430, Valid_loss 0.464351
Epoch 47, Train Loss 0.190725, Valid_loss 0.393699
Epoch 48, Train Loss 0.195147, Valid_loss 0.346763
Epoch 49, Train Loss 0.199299, Valid_loss 0.503007
Epoch 50, Train Loss 0.208706, Valid_loss 0.560283
Epoch 51, Train Loss 0.201612, Valid_loss 0.392035
Epoch 52, Train Loss 0.192386, Valid_loss 0.411993
Epoch 53, Train Loss 0.192385, Valid_loss 0.570175
[I 2025-08-31 19:02:01,486] Trial 1 finished with value: 0.3065053772713457 and parameters: {'learning_rate': 0.001, 'epochs': 100, 'heads': 2, 'dropout': 0.3, 'weight_decay': 0.0001, 'emb_dim': 64, 'augment_num': 100, 'pca': False}. Best is trial 1 with value: 0.3065053772713457.
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 29.04 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.651397, Valid_loss 0.598453
Epoch 2, Train Loss 0.610252, Valid_loss 0.600738
Epoch 3, Train Loss 0.613575, Valid_loss 0.598313
Epoch 4, Train Loss 0.619164, Valid_loss 0.599551
Epoch 5, Train Loss 0.614403, Valid_loss 0.599512
Epoch 6, Train Loss 0.609939, Valid_loss 0.599088
Epoch 7, Train Loss 0.613682, Valid_loss 0.602058
Epoch 8, Train Loss 0.604778, Valid_loss 0.596030
Epoch 9, Train Loss 0.611033, Valid_loss 0.596003
Epoch 10, Train Loss 0.622114, Valid_loss 0.615660
Epoch 11, Train Loss 0.602137, Valid_loss 0.587068
Epoch 12, Train Loss 0.569273, Valid_loss 0.648713
Epoch 13, Train Loss 0.629202, Valid_loss 0.603072
Epoch 14, Train Loss 0.602882, Valid_loss 0.597622
Epoch 15, Train Loss 0.613939, Valid_loss 0.599693
Epoch 16, Train Loss 0.601843, Valid_loss 0.592079
Epoch 17, Train Loss 0.621730, Valid_loss 0.603318
Epoch 18, Train Loss 0.610478, Valid_loss 0.600987
Epoch 19, Train Loss 0.620847, Valid_loss 0.598543
Epoch 20, Train Loss 0.608230, Valid_loss 0.600313
Epoch 21, Train Loss 0.608914, Valid_loss 0.598407
Epoch 22, Train Loss 0.611117, Valid_loss 0.606257
Epoch 23, Train Loss 0.618405, Valid_loss 0.598699
Epoch 24, Train Loss 0.610201, Valid_loss 0.602198
Epoch 25, Train Loss 0.604210, Valid_loss 0.598608
Epoch 26, Train Loss 0.604053, Valid_loss 0.586264
Epoch 27, Train Loss 0.568569, Valid_loss 0.445050
Epoch 28, Train Loss 0.478059, Valid_loss 0.470141
Epoch 29, Train Loss 0.490058, Valid_loss 0.360149
Epoch 30, Train Loss 0.366798, Valid_loss 0.318282
Epoch 31, Train Loss 0.319269, Valid_loss 0.405651
Epoch 32, Train Loss 0.290314, Valid_loss 0.322974
Epoch 33, Train Loss 0.298134, Valid_loss 0.550422
Epoch 34, Train Loss 0.249925, Valid_loss 0.220088
Epoch 35, Train Loss 0.306819, Valid_loss 0.232679
Epoch 36, Train Loss 0.371797, Valid_loss 0.293495
Epoch 37, Train Loss 0.298193, Valid_loss 0.424466
Epoch 38, Train Loss 0.285787, Valid_loss 0.462918
Epoch 39, Train Loss 0.268165, Valid_loss 0.578062
Epoch 40, Train Loss 0.247461, Valid_loss 0.511940
Epoch 41, Train Loss 0.257386, Valid_loss 0.428753
Epoch 42, Train Loss 0.267403, Valid_loss 0.813206
Epoch 43, Train Loss 0.289006, Valid_loss 0.387813
Epoch 44, Train Loss 0.354576, Valid_loss 0.702656
Epoch 45, Train Loss 0.308437, Valid_loss 0.369739
Epoch 46, Train Loss 0.277901, Valid_loss 0.354055
Epoch 47, Train Loss 0.255216, Valid_loss 0.344172
Epoch 48, Train Loss 0.316140, Valid_loss 0.452623
Epoch 49, Train Loss 0.787560, Valid_loss 0.647356
Epoch 50, Train Loss 0.621892, Valid_loss 0.598668
Epoch 51, Train Loss 0.607601, Valid_loss 0.594883
Epoch 52, Train Loss 0.601710, Valid_loss 0.598070
Epoch 53, Train Loss 0.595519, Valid_loss 0.685772
[I 2025-08-31 19:05:59,177] Trial 2 finished with value: 0.2200876378587314 and parameters: {'learning_rate': 0.01, 'epochs': 100, 'heads': 4, 'dropout': 0.0, 'weight_decay': 0.001, 'emb_dim': 64, 'augment_num': 100, 'pca': False}. Best is trial 2 with value: 0.2200876378587314.
선택된 trial params: {'learning_rate': 0.01, 'epochs': 100, 'heads': 4, 'dropout': 0.0, 'weight_decay': 0.001, 'emb_dim': 64, 'augment_num': 100, 'pca': False}
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=10, batch_size=1 -> steps=10
output_class :  1
Memory Allocated: 29.04 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.588604, Valid_loss 0.396356
Epoch 2, Train Loss 0.374173, Valid_loss 0.319885
Epoch 3, Train Loss 0.353937, Valid_loss 0.600296
Epoch 4, Train Loss 0.428383, Valid_loss 0.413183
Epoch 5, Train Loss 0.370366, Valid_loss 0.398236
Epoch 6, Train Loss 0.340524, Valid_loss 0.305234
Epoch 7, Train Loss 0.294678, Valid_loss 0.279724
Epoch 8, Train Loss 0.267846, Valid_loss 0.300766
Epoch 9, Train Loss 0.293943, Valid_loss 0.266415
Epoch 10, Train Loss 0.305623, Valid_loss 0.253412
Epoch 11, Train Loss 0.289772, Valid_loss 0.838396
Epoch 12, Train Loss 0.335981, Valid_loss 0.510658
Epoch 13, Train Loss 0.380898, Valid_loss 0.388657
Epoch 14, Train Loss 0.357820, Valid_loss 0.481318
Epoch 15, Train Loss 0.365591, Valid_loss 0.633882
Epoch 16, Train Loss 0.380474, Valid_loss 0.452910
Epoch 17, Train Loss 0.330461, Valid_loss 0.291609
Epoch 18, Train Loss 0.283344, Valid_loss 0.203876
Epoch 19, Train Loss 0.268065, Valid_loss 0.219851
Epoch 20, Train Loss 0.262664, Valid_loss 0.511657
Epoch 21, Train Loss 0.310482, Valid_loss 0.345000
Epoch 22, Train Loss 0.244917, Valid_loss 0.352432
Epoch 23, Train Loss 0.246175, Valid_loss 0.216848
Epoch 24, Train Loss 0.236431, Valid_loss 0.258975
Epoch 25, Train Loss 0.245704, Valid_loss 0.317260
Epoch 26, Train Loss 0.236945, Valid_loss 0.252605
Epoch 27, Train Loss 0.232717, Valid_loss 0.265640
Epoch 28, Train Loss 0.232455, Valid_loss 0.262986
Epoch 29, Train Loss 0.233351, Valid_loss 0.242339
Epoch 30, Train Loss 0.233663, Valid_loss 0.291428
Epoch 31, Train Loss 0.229866, Valid_loss 0.287342
Epoch 32, Train Loss 0.223293, Valid_loss 0.272915
Epoch 33, Train Loss 0.221963, Valid_loss 0.281342
Epoch 34, Train Loss 0.256050, Valid_loss 0.264941
Epoch 35, Train Loss 0.237019, Valid_loss 0.246207
Epoch 36, Train Loss 0.228198, Valid_loss 0.275371
Epoch 37, Train Loss 0.240322, Valid_loss 0.250041
Epoch 38, Train Loss 0.235115, Valid_loss 0.348976
Epoch 39, Train Loss 0.229627, Valid_loss 0.270021
Epoch 40, Train Loss 0.226827, Valid_loss 0.329656
Epoch 41, Train Loss 0.215072, Valid_loss 0.563541
Epoch 42, Train Loss 0.288774, Valid_loss 0.555318
Epoch 43, Train Loss 0.282474, Valid_loss 0.407903
Epoch 44, Train Loss 0.247872, Valid_loss 0.430090
Epoch 45, Train Loss 0.226166, Valid_loss 0.429777
Epoch 46, Train Loss 0.273751, Valid_loss 0.566340
Epoch 47, Train Loss 0.242179, Valid_loss 0.389253
Epoch 48, Train Loss 0.243259, Valid_loss 0.339276
Epoch 49, Train Loss 0.241622, Valid_loss 0.465028
Epoch 50, Train Loss 0.345201, Valid_loss 0.303631
Epoch 51, Train Loss 0.260280, Valid_loss 0.357048
Epoch 52, Train Loss 0.245879, Valid_loss 0.356306
Epoch 53, Train Loss 0.230702, Valid_loss 0.398821
Epoch 54, Train Loss 0.262945, Valid_loss 0.349410
Epoch 55, Train Loss 0.250427, Valid_loss 0.321632
Epoch 56, Train Loss 0.220397, Valid_loss 0.387942
Epoch 57, Train Loss 0.217766, Valid_loss 0.355701
Epoch 58, Train Loss 0.215996, Valid_loss 0.443689
Epoch 59, Train Loss 0.221258, Valid_loss 0.393240
Epoch 60, Train Loss 0.219370, Valid_loss 0.417740
Epoch 61, Train Loss 0.212992, Valid_loss 0.403209
Epoch 62, Train Loss 0.212462, Valid_loss 0.410301
Epoch 63, Train Loss 0.209774, Valid_loss 0.462356
환자ID=COVID19_Participant11 -- true: 1 -- pred: 1
환자ID=COVID19_Participant17 -- true: 1 -- pred: 1
환자ID=COVID19_Participant19 -- true: 1 -- pred: 1
환자ID=COVID19_Participant25 -- true: 1 -- pred: 1
환자ID=COVID19_Participant31 -- true: 1 -- pred: 0
환자ID=COVID19_Participant40 -- true: 1 -- pred: 1
환자ID=COVID19_Participant9 -- true: 1 -- pred: 1
환자ID=Control_Participant1 -- true: 0 -- pred: 0
환자ID=Control_Participant2 -- true: 0 -- pred: 0
환자ID=Control_Participant4 -- true: 0 -- pred: 1
Best performance: Epoch 18, Loss 0.283344, Test ACC 0.800000, Test AUC 0.857143, Test Recall 0.857143, Test Precision 0.857143
Confusion Matrix:
 [2 1 1 6]
✅ Total valid splits used: 1
🔁 Repeat 3, Fold 1
cell type :  GTCGGGGGGTGG_Control_Participant7        Keratinocytes
CAAATCAATTAT_Control_Participant7     Epithelial_cells
ATACAATTGACA_Control_Participant7     Epithelial_cells
CTGTTAATGAGA_Control_Participant7     Epithelial_cells
CTTCACATTATT_Control_Participant7     Epithelial_cells
                                            ...       
CAGGTTGGTATC_COVID19_Participant20    Epithelial_cells
TATAGCTTGGTA_COVID19_Participant20    Epithelial_cells
TTGTTAGACGGT_COVID19_Participant20          HSC_-G-CSF
ATGGCTCAGGCT_COVID19_Participant20    Epithelial_cells
ACATGATCCTTT_COVID19_Participant20    Epithelial_cells
Name: singler_annotation, Length: 22718, dtype: string
cell type annotation :  GTCGGGGGGTGG_Control_Participant7        Keratinocytes
CAAATCAATTAT_Control_Participant7     Epithelial_cells
ATACAATTGACA_Control_Participant7     Epithelial_cells
CTGTTAATGAGA_Control_Participant7     Epithelial_cells
CTTCACATTATT_Control_Participant7     Epithelial_cells
                                            ...       
CAGGTTGGTATC_COVID19_Participant20    Epithelial_cells
TATAGCTTGGTA_COVID19_Participant20    Epithelial_cells
TTGTTAGACGGT_COVID19_Participant20          HSC_-G-CSF
ATGGCTCAGGCT_COVID19_Participant20    Epithelial_cells
ACATGATCCTTT_COVID19_Participant20    Epithelial_cells
Name: singler_annotation, Length: 22718, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Keratinocytes', 'Epithelial_cells', 'Neurons', 'iPS_cells', 'Embryonic_stem_cells', 'Astrocyte', 'DC', 'Gametocytes', 'HSC_-G-CSF', 'Smooth_muscle_cells', 'BM & Prog.', 'Monocyte', 'Myelocyte', 'BM', 'Endothelial_cells', 'Osteoblasts', 'Platelets', 'Erythroblast', 'NK_cell', 'T_cells', 'Chondrocytes', 'HSC_CD34+', 'CMP', 'Neutrophils', 'Fibroblasts', 'MEP', 'Neuroepithelial_cell', 'MSC', 'Pro-Myelocyte', 'B_cell', 'GMP', 'Hepatocytes', 'Macrophage', 'Tissue_stem_cells', 'Pre-B_cell_CD34-', 'Pro-B_cell_CD34+', 'Unknown']
라벨별 그룹 개수 {1: 28, 0: 12}
cell type :  CGAACGGACTCC_Control_Participant12       Epithelial_cells
GTGTCCTGGGGT_Control_Participant12    Smooth_muscle_cells
ATTTGCCTGTCG_Control_Participant12       Epithelial_cells
TCTCTAAAGTGT_Control_Participant12                Neurons
TAGAGACAACGA_Control_Participant12       Epithelial_cells
                                             ...         
GCAGGGAACTCC_COVID19_Participant30       Epithelial_cells
CAGCACCGAGCC_COVID19_Participant30       Epithelial_cells
GCCCCTTGTGAT_COVID19_Participant30       Epithelial_cells
GTGTTGTGTGTC_COVID19_Participant30                 B_cell
TAACACTCACTT_COVID19_Participant30              Myelocyte
Name: singler_annotation, Length: 4229, dtype: string
cell type annotation :  CGAACGGACTCC_Control_Participant12       Epithelial_cells
GTGTCCTGGGGT_Control_Participant12    Smooth_muscle_cells
ATTTGCCTGTCG_Control_Participant12       Epithelial_cells
TCTCTAAAGTGT_Control_Participant12                Neurons
TAGAGACAACGA_Control_Participant12       Epithelial_cells
                                             ...         
GCAGGGAACTCC_COVID19_Participant30       Epithelial_cells
CAGCACCGAGCC_COVID19_Participant30       Epithelial_cells
GCCCCTTGTGAT_COVID19_Participant30       Epithelial_cells
GTGTTGTGTGTC_COVID19_Participant30                 B_cell
TAACACTCACTT_COVID19_Participant30              Myelocyte
Name: singler_annotation, Length: 4229, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Epithelial_cells', 'Smooth_muscle_cells', 'Neurons', 'Erythroblast', 'Keratinocytes', 'T_cells', 'Gametocytes', 'B_cell', 'Neutrophils', 'HSC_CD34+', 'MSC', 'Embryonic_stem_cells', 'Neuroepithelial_cell', 'CMP', 'Platelets', 'NK_cell', 'DC', 'HSC_-G-CSF', 'Pre-B_cell_CD34-', 'Tissue_stem_cells', 'Astrocyte', 'Osteoblasts', 'Chondrocytes', 'Myelocyte', 'Hepatocytes', 'Endothelial_cells', 'BM & Prog.', 'Monocyte', 'BM', 'Pro-B_cell_CD34+', 'MEP', 'Macrophage', 'Pro-Myelocyte', 'Fibroblasts', 'GMP', 'Unknown', 'iPS_cells']
라벨별 그룹 개수 {1: 7, 0: 3}
🔍 Split #2
  → train_p_index 환자 수 (환자 단위로 묶인 index list): 40
  → test_p_index 환자 수  (환자 단위로 묶인 index list): 10
  → train 환자 ID: ['COVID19_Participant10', 'COVID19_Participant11', 'COVID19_Participant12', 'COVID19_Participant13', 'COVID19_Participant14', 'COVID19_Participant17', 'COVID19_Participant19', 'COVID19_Participant2', 'COVID19_Participant20', 'COVID19_Participant21', 'COVID19_Participant22', 'COVID19_Participant23', 'COVID19_Participant25', 'COVID19_Participant26', 'COVID19_Participant27', 'COVID19_Participant28', 'COVID19_Participant29', 'COVID19_Participant31', 'COVID19_Participant32', 'COVID19_Participant35', 'COVID19_Participant36', 'COVID19_Participant37', 'COVID19_Participant38', 'COVID19_Participant4', 'COVID19_Participant40', 'COVID19_Participant5', 'COVID19_Participant8', 'COVID19_Participant9', 'Control_Participant1', 'Control_Participant11', 'Control_Participant14', 'Control_Participant15', 'Control_Participant2', 'Control_Participant3', 'Control_Participant4', 'Control_Participant5', 'Control_Participant6', 'Control_Participant7', 'Control_Participant8', 'Control_Participant9']
  → test  환자 ID: ['COVID19_Participant15', 'COVID19_Participant18', 'COVID19_Participant3', 'COVID19_Participant30', 'COVID19_Participant39', 'COVID19_Participant6', 'COVID19_Participant7', 'Control_Participant10', 'Control_Participant12', 'Control_Participant13']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant10, Label: 1
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant12, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant21, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant27, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant35, Label: 1
    ID: COVID19_Participant36, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant38, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: COVID19_Participant5, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: COVID19_Participant9, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant14, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant2, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant4, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant6, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant8, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant18, Label: 1
    ID: COVID19_Participant3, Label: 1
    ID: COVID19_Participant30, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant6, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: Control_Participant10, Label: 0
    ID: Control_Participant12, Label: 0
    ID: Control_Participant13, Label: 0
전체 데이터 index 길이 50
label_stat (train 환자 라벨 목록) 갯수 40
train_data에서 환자 단위로, train과 validation 나누기
기존 train_p_index 40
기존 (train) label_stat 40
train-vali 분할 후! 
train y 의 classes : {0, 1} valid y 의 classes : {0, 1} label_stat 의 classes : {0, 1}
train_p_index_ 26
valid_p_index 14
test_p_index 10
→ train 환자 ID 및 라벨:
   총 개수: 26
   환자ID=Control_Participant11, Label=0, 셀개수=1164
   환자ID=Control_Participant3, Label=0, 셀개수=1620
   환자ID=COVID19_Participant19, Label=1, 셀개수=816
   환자ID=COVID19_Participant37, Label=1, 셀개수=668
   환자ID=COVID19_Participant10, Label=1, 셀개수=18
   환자ID=Control_Participant6, Label=0, 셀개수=131
   환자ID=COVID19_Participant13, Label=1, 셀개수=730
   환자ID=COVID19_Participant2, Label=1, 셀개수=329
   환자ID=COVID19_Participant4, Label=1, 셀개수=1680
   환자ID=COVID19_Participant12, Label=1, 셀개수=102
   환자ID=COVID19_Participant20, Label=1, 셀개수=2033
   환자ID=Control_Participant4, Label=0, 셀개수=440
   환자ID=COVID19_Participant26, Label=1, 셀개수=814
   환자ID=Control_Participant8, Label=0, 셀개수=393
   환자ID=Control_Participant7, Label=0, 셀개수=762
   환자ID=COVID19_Participant14, Label=1, 셀개수=382
   환자ID=Control_Participant9, Label=0, 셀개수=558
   환자ID=Control_Participant14, Label=0, 셀개수=274
   환자ID=COVID19_Participant22, Label=1, 셀개수=865
   환자ID=COVID19_Participant29, Label=1, 셀개수=573
   환자ID=COVID19_Participant25, Label=1, 셀개수=496
   환자ID=COVID19_Participant17, Label=1, 셀개수=843
   환자ID=COVID19_Participant5, Label=1, 셀개수=89
   환자ID=COVID19_Participant38, Label=1, 셀개수=51
   환자ID=COVID19_Participant36, Label=1, 셀개수=200
   환자ID=COVID19_Participant28, Label=1, 셀개수=1079
→ valid 환자 ID 및 라벨:
   총 개수: 14
   환자ID=Control_Participant2, Label=0, 셀개수=41
   환자ID=COVID19_Participant27, Label=1, 셀개수=93
   환자ID=COVID19_Participant32, Label=1, 셀개수=1665
   환자ID=COVID19_Participant31, Label=1, 셀개수=410
   환자ID=COVID19_Participant40, Label=1, 셀개수=381
   환자ID=COVID19_Participant21, Label=1, 셀개수=39
   환자ID=Control_Participant5, Label=0, 셀개수=717
   환자ID=Control_Participant1, Label=0, 셀개수=414
   환자ID=COVID19_Participant9, Label=1, 셀개수=86
   환자ID=COVID19_Participant8, Label=1, 셀개수=462
   환자ID=Control_Participant15, Label=0, 셀개수=528
   환자ID=COVID19_Participant35, Label=1, 셀개수=83
   환자ID=COVID19_Participant11, Label=1, 셀개수=382
   환자ID=COVID19_Participant23, Label=1, 셀개수=307
→ test 환자 ID 및 라벨:
   총 개수: 10
   환자ID=COVID19_Participant15, Label=1, 셀개수=1003
   환자ID=COVID19_Participant18, Label=1, 셀개수=227
   환자ID=COVID19_Participant3, Label=1, 셀개수=104
   환자ID=COVID19_Participant30, Label=1, 셀개수=116
   환자ID=COVID19_Participant39, Label=1, 셀개수=454
   환자ID=COVID19_Participant6, Label=1, 셀개수=84
   환자ID=COVID19_Participant7, Label=1, 셀개수=409
   환자ID=Control_Participant10, Label=0, 셀개수=1645
   환자ID=Control_Participant12, Label=0, 셀개수=99
   환자ID=Control_Participant13, Label=0, 셀개수=88
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Keratinocytes', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Neurons', 'iPS_cells', 'Embryonic_stem_cells', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
전체 데이터 길이 26947
전체 cell type 길이 0           Keratinocytes
1        Epithelial_cells
2        Epithelial_cells
3        Epithelial_cells
4        Epithelial_cells
               ...       
26942    Epithelial_cells
26943    Epithelial_cells
26944    Epithelial_cells
26945              B_cell
26946           Myelocyte
Length: 26947, dtype: string
cell type의 NaN 개수 체크 0
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:10,  9.00it/s]  2%|▏         | 2/100 [00:00<00:10,  9.10it/s]  4%|▍         | 4/100 [00:00<00:10,  9.38it/s]  5%|▌         | 5/100 [00:00<00:10,  9.41it/s]  6%|▌         | 6/100 [00:00<00:10,  8.87it/s]  8%|▊         | 8/100 [00:00<00:10,  8.71it/s]  9%|▉         | 9/100 [00:00<00:10,  8.99it/s] 10%|█         | 10/100 [00:01<00:09,  9.12it/s] 12%|█▏        | 12/100 [00:01<00:09,  9.38it/s] 13%|█▎        | 13/100 [00:01<00:09,  9.47it/s] 15%|█▌        | 15/100 [00:01<00:08,  9.50it/s] 16%|█▌        | 16/100 [00:01<00:08,  9.60it/s] 18%|█▊        | 18/100 [00:01<00:08,  9.80it/s] 19%|█▉        | 19/100 [00:02<00:08,  9.16it/s] 20%|██        | 20/100 [00:02<00:08,  9.23it/s] 21%|██        | 21/100 [00:02<00:08,  9.36it/s] 22%|██▏       | 22/100 [00:02<00:08,  9.37it/s] 23%|██▎       | 23/100 [00:02<00:08,  9.43it/s] 24%|██▍       | 24/100 [00:02<00:08,  9.31it/s] 25%|██▌       | 25/100 [00:02<00:08,  9.10it/s] 26%|██▌       | 26/100 [00:02<00:08,  8.41it/s] 27%|██▋       | 27/100 [00:02<00:08,  8.50it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.68it/s] 29%|██▉       | 29/100 [00:03<00:08,  8.62it/s] 30%|███       | 30/100 [00:03<00:07,  8.93it/s] 31%|███       | 31/100 [00:03<00:07,  8.88it/s] 32%|███▏      | 32/100 [00:03<00:07,  8.88it/s] 33%|███▎      | 33/100 [00:03<00:07,  9.02it/s] 34%|███▍      | 34/100 [00:03<00:07,  8.96it/s] 35%|███▌      | 35/100 [00:03<00:07,  8.96it/s] 36%|███▌      | 36/100 [00:03<00:07,  8.79it/s] 37%|███▋      | 37/100 [00:04<00:07,  8.48it/s] 38%|███▊      | 38/100 [00:04<00:07,  8.51it/s] 39%|███▉      | 39/100 [00:04<00:07,  8.49it/s] 40%|████      | 40/100 [00:04<00:06,  8.64it/s] 41%|████      | 41/100 [00:04<00:06,  8.55it/s] 42%|████▏     | 42/100 [00:04<00:07,  8.18it/s] 43%|████▎     | 43/100 [00:04<00:06,  8.27it/s] 44%|████▍     | 44/100 [00:04<00:06,  8.47it/s] 45%|████▌     | 45/100 [00:05<00:06,  8.17it/s] 46%|████▌     | 46/100 [00:05<00:06,  8.61it/s] 47%|████▋     | 47/100 [00:05<00:06,  8.76it/s] 48%|████▊     | 48/100 [00:05<00:06,  8.65it/s] 49%|████▉     | 49/100 [00:05<00:05,  9.00it/s] 50%|█████     | 50/100 [00:05<00:05,  9.22it/s] 51%|█████     | 51/100 [00:05<00:06,  8.00it/s] 52%|█████▏    | 52/100 [00:05<00:06,  7.63it/s] 53%|█████▎    | 53/100 [00:06<00:05,  7.96it/s] 54%|█████▍    | 54/100 [00:06<00:05,  8.28it/s] 55%|█████▌    | 55/100 [00:06<00:05,  8.46it/s] 56%|█████▌    | 56/100 [00:06<00:05,  8.21it/s] 57%|█████▋    | 57/100 [00:06<00:05,  8.42it/s] 58%|█████▊    | 58/100 [00:06<00:05,  8.38it/s] 59%|█████▉    | 59/100 [00:06<00:05,  8.15it/s] 60%|██████    | 60/100 [00:06<00:04,  8.36it/s] 61%|██████    | 61/100 [00:06<00:04,  8.46it/s] 62%|██████▏   | 62/100 [00:07<00:05,  6.52it/s] 63%|██████▎   | 63/100 [00:07<00:05,  7.13it/s] 64%|██████▍   | 64/100 [00:07<00:04,  7.53it/s] 65%|██████▌   | 65/100 [00:07<00:04,  7.76it/s] 66%|██████▌   | 66/100 [00:07<00:04,  7.77it/s] 67%|██████▋   | 67/100 [00:07<00:04,  8.00it/s] 68%|██████▊   | 68/100 [00:07<00:03,  8.47it/s] 69%|██████▉   | 69/100 [00:07<00:03,  8.70it/s] 71%|███████   | 71/100 [00:08<00:03,  9.24it/s] 72%|███████▏  | 72/100 [00:08<00:03,  9.24it/s] 73%|███████▎  | 73/100 [00:08<00:03,  8.91it/s] 74%|███████▍  | 74/100 [00:08<00:02,  8.90it/s] 75%|███████▌  | 75/100 [00:08<00:02,  8.52it/s] 76%|███████▌  | 76/100 [00:08<00:02,  8.53it/s] 77%|███████▋  | 77/100 [00:08<00:02,  8.54it/s] 78%|███████▊  | 78/100 [00:09<00:03,  6.46it/s] 79%|███████▉  | 79/100 [00:09<00:03,  6.94it/s] 80%|████████  | 80/100 [00:09<00:02,  7.33it/s] 81%|████████  | 81/100 [00:09<00:02,  7.61it/s] 82%|████████▏ | 82/100 [00:09<00:02,  7.73it/s] 83%|████████▎ | 83/100 [00:09<00:02,  7.87it/s] 84%|████████▍ | 84/100 [00:09<00:02,  7.95it/s] 85%|████████▌ | 85/100 [00:09<00:01,  8.10it/s] 86%|████████▌ | 86/100 [00:10<00:01,  8.13it/s] 87%|████████▋ | 87/100 [00:10<00:01,  8.13it/s] 88%|████████▊ | 88/100 [00:10<00:01,  8.17it/s] 89%|████████▉ | 89/100 [00:10<00:01,  8.19it/s] 90%|█████████ | 90/100 [00:10<00:01,  7.91it/s] 91%|█████████ | 91/100 [00:10<00:01,  8.06it/s] 92%|█████████▏| 92/100 [00:10<00:00,  8.15it/s] 93%|█████████▎| 93/100 [00:10<00:00,  8.22it/s] 94%|█████████▍| 94/100 [00:11<00:00,  8.09it/s] 95%|█████████▌| 95/100 [00:11<00:00,  8.35it/s] 96%|█████████▌| 96/100 [00:11<00:00,  8.54it/s] 97%|█████████▋| 97/100 [00:11<00:00,  8.42it/s] 98%|█████████▊| 98/100 [00:11<00:00,  8.24it/s] 99%|█████████▉| 99/100 [00:11<00:00,  8.41it/s]100%|██████████| 100/100 [00:11<00:00,  8.41it/s]100%|██████████| 100/100 [00:11<00:00,  8.48it/s]
[I 2025-08-31 19:10:55,353] A new study created in memory with name: no-name-8f7638cb-7284-426e-997e-cb3899a773fa
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 29.04 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.520668, Valid_loss 0.439237
Epoch 2, Train Loss 0.291162, Valid_loss 0.780916
Epoch 3, Train Loss 0.312723, Valid_loss 0.522076
Epoch 4, Train Loss 0.308466, Valid_loss 0.372062
Epoch 5, Train Loss 0.342859, Valid_loss 0.281741
Epoch 6, Train Loss 0.287925, Valid_loss 0.413609
Epoch 7, Train Loss 0.363548, Valid_loss 0.371480
Epoch 8, Train Loss 0.279635, Valid_loss 0.691897
Epoch 9, Train Loss 0.279334, Valid_loss 0.545757
Epoch 10, Train Loss 0.257316, Valid_loss 0.535121
Epoch 11, Train Loss 0.258056, Valid_loss 0.548735
Epoch 12, Train Loss 0.232652, Valid_loss 0.579583
Epoch 13, Train Loss 0.242101, Valid_loss 0.790134
Epoch 14, Train Loss 0.251126, Valid_loss 0.602080
Epoch 15, Train Loss 0.241972, Valid_loss 0.424572
Epoch 16, Train Loss 0.238036, Valid_loss 0.476876
Epoch 17, Train Loss 0.276798, Valid_loss 0.487550
Epoch 18, Train Loss 0.253827, Valid_loss 0.524439
Epoch 19, Train Loss 0.227169, Valid_loss 0.603497
Epoch 20, Train Loss 0.216080, Valid_loss 0.522193
Epoch 21, Train Loss 0.208535, Valid_loss 0.556618
Epoch 22, Train Loss 0.224346, Valid_loss 0.527436
Epoch 23, Train Loss 0.316784, Valid_loss 0.464562
Epoch 24, Train Loss 0.234931, Valid_loss 0.567909
Epoch 25, Train Loss 0.286860, Valid_loss 0.508846
Epoch 26, Train Loss 0.333708, Valid_loss 0.542908
Epoch 27, Train Loss 0.276922, Valid_loss 0.554365
Epoch 28, Train Loss 0.269132, Valid_loss 0.591216
Epoch 29, Train Loss 0.271251, Valid_loss 0.547588
Epoch 30, Train Loss 0.317978, Valid_loss 0.920368
Epoch 31, Train Loss 0.318040, Valid_loss 0.440161
Epoch 32, Train Loss 0.295516, Valid_loss 0.385154
Epoch 33, Train Loss 0.263221, Valid_loss 0.549486
Epoch 34, Train Loss 0.248631, Valid_loss 0.479601
Epoch 35, Train Loss 0.300887, Valid_loss 0.968268
Epoch 36, Train Loss 0.298498, Valid_loss 0.616257
Epoch 37, Train Loss 0.376496, Valid_loss 0.922711
Epoch 38, Train Loss 0.445867, Valid_loss 0.503535
Epoch 39, Train Loss 0.407561, Valid_loss 0.546141
Epoch 40, Train Loss 0.307165, Valid_loss 0.613969
Epoch 41, Train Loss 0.351270, Valid_loss 0.718030
Epoch 42, Train Loss 0.381230, Valid_loss 0.561622
Epoch 43, Train Loss 0.294093, Valid_loss 0.521194
Epoch 44, Train Loss 0.268920, Valid_loss 0.458887
Epoch 45, Train Loss 0.295240, Valid_loss 0.489668
Epoch 46, Train Loss 0.276557, Valid_loss 0.590086
Epoch 47, Train Loss 0.376348, Valid_loss 0.849210
Epoch 48, Train Loss 0.521032, Valid_loss 0.518667
Epoch 49, Train Loss 0.486926, Valid_loss 0.573255
Epoch 50, Train Loss 0.318447, Valid_loss 0.665254
Epoch 51, Train Loss 0.292768, Valid_loss 0.747478
Epoch 52, Train Loss 0.270947, Valid_loss 0.873398
[I 2025-08-31 19:14:26,780] Trial 0 finished with value: 0.2817406441484179 and parameters: {'learning_rate': 0.01, 'epochs': 100, 'heads': 2, 'dropout': 0.3, 'weight_decay': 0.001, 'emb_dim': 64, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.2817406441484179.
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 25.64 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.652120, Valid_loss 0.598407
Epoch 2, Train Loss 0.649382, Valid_loss 0.614321
Epoch 3, Train Loss 0.579981, Valid_loss 0.875098
Epoch 4, Train Loss 0.452611, Valid_loss 0.732405
Epoch 5, Train Loss 0.388350, Valid_loss 1.051002
Epoch 6, Train Loss 0.392688, Valid_loss 1.485679
Epoch 7, Train Loss 0.386647, Valid_loss 0.867548
Epoch 8, Train Loss 0.295604, Valid_loss 1.266421
Epoch 9, Train Loss 0.309034, Valid_loss 0.607807
Epoch 10, Train Loss 0.310582, Valid_loss 0.682369
Epoch 11, Train Loss 0.284711, Valid_loss 0.809844
Epoch 12, Train Loss 0.267114, Valid_loss 0.719411
Epoch 13, Train Loss 0.301234, Valid_loss 0.900486
Epoch 14, Train Loss 0.262406, Valid_loss 0.600120
Epoch 15, Train Loss 0.241084, Valid_loss 0.849081
Epoch 16, Train Loss 0.249533, Valid_loss 0.890029
Epoch 17, Train Loss 0.249171, Valid_loss 0.722079
Epoch 18, Train Loss 0.231071, Valid_loss 0.932893
Epoch 19, Train Loss 0.240365, Valid_loss 1.057900
Epoch 20, Train Loss 0.241161, Valid_loss 0.885329
Epoch 21, Train Loss 0.270808, Valid_loss 0.772715
Epoch 22, Train Loss 0.258151, Valid_loss 0.631076
Epoch 23, Train Loss 0.216349, Valid_loss 0.810440
Epoch 24, Train Loss 0.226433, Valid_loss 0.583470
Epoch 25, Train Loss 0.240568, Valid_loss 0.809239
Epoch 26, Train Loss 0.210055, Valid_loss 0.665687
Epoch 27, Train Loss 0.251888, Valid_loss 0.637264
Epoch 28, Train Loss 0.237955, Valid_loss 0.636165
Epoch 29, Train Loss 0.224095, Valid_loss 0.523466
Epoch 30, Train Loss 0.235032, Valid_loss 0.692765
Epoch 31, Train Loss 0.214140, Valid_loss 0.614599
Epoch 32, Train Loss 0.214334, Valid_loss 0.747410
Epoch 33, Train Loss 0.229182, Valid_loss 0.730765
Epoch 34, Train Loss 0.243937, Valid_loss 0.914359
Epoch 35, Train Loss 0.231877, Valid_loss 0.685665
Epoch 36, Train Loss 0.213919, Valid_loss 0.657158
Epoch 37, Train Loss 0.198345, Valid_loss 0.992546
Epoch 38, Train Loss 0.217005, Valid_loss 0.580103
Epoch 39, Train Loss 0.245692, Valid_loss 0.661983
Epoch 40, Train Loss 0.247164, Valid_loss 0.859591
Epoch 41, Train Loss 0.254777, Valid_loss 0.558749
Epoch 42, Train Loss 0.240186, Valid_loss 0.451860
Epoch 43, Train Loss 0.227487, Valid_loss 0.549319
Epoch 44, Train Loss 0.252480, Valid_loss 0.912423
Epoch 45, Train Loss 0.219416, Valid_loss 0.849742
Epoch 46, Train Loss 0.196289, Valid_loss 0.754661
Epoch 47, Train Loss 0.204715, Valid_loss 0.920241
Epoch 48, Train Loss 0.211232, Valid_loss 0.836078
Epoch 49, Train Loss 0.223781, Valid_loss 0.926872
Epoch 50, Train Loss 0.212289, Valid_loss 0.838364
Epoch 51, Train Loss 0.216355, Valid_loss 0.726082
Epoch 52, Train Loss 0.213098, Valid_loss 0.887678
Epoch 53, Train Loss 0.196884, Valid_loss 0.907001
[I 2025-08-31 19:18:01,150] Trial 1 finished with value: 0.45186017846156445 and parameters: {'learning_rate': 0.01, 'epochs': 100, 'heads': 2, 'dropout': 0.3, 'weight_decay': 0.0001, 'emb_dim': 8, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.2817406441484179.
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 26.96 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.650125, Valid_loss 0.596913
Epoch 2, Train Loss 0.632107, Valid_loss 0.613928
Epoch 3, Train Loss 0.623552, Valid_loss 0.599767
Epoch 4, Train Loss 0.625416, Valid_loss 0.600793
Epoch 5, Train Loss 0.628284, Valid_loss 0.604280
Epoch 6, Train Loss 0.631699, Valid_loss 0.605499
Epoch 7, Train Loss 0.625031, Valid_loss 0.598716
Epoch 8, Train Loss 0.622624, Valid_loss 0.601568
Epoch 9, Train Loss 0.625444, Valid_loss 0.601904
Epoch 10, Train Loss 0.625887, Valid_loss 0.598956
Epoch 11, Train Loss 0.633407, Valid_loss 0.599134
Epoch 12, Train Loss 0.627791, Valid_loss 0.600767
Epoch 13, Train Loss 0.631292, Valid_loss 0.598519
Epoch 14, Train Loss 0.633967, Valid_loss 0.601132
Epoch 15, Train Loss 0.628163, Valid_loss 0.608939
Epoch 16, Train Loss 0.627232, Valid_loss 0.599854
Epoch 17, Train Loss 0.624379, Valid_loss 0.601095
Epoch 18, Train Loss 0.620870, Valid_loss 0.600091
Epoch 19, Train Loss 0.625929, Valid_loss 0.601559
Epoch 20, Train Loss 0.624771, Valid_loss 0.602469
Epoch 21, Train Loss 0.620346, Valid_loss 0.599743
Epoch 22, Train Loss 0.621090, Valid_loss 0.601222
Epoch 23, Train Loss 0.622633, Valid_loss 0.603894
Epoch 24, Train Loss 0.621007, Valid_loss 0.598468
Epoch 25, Train Loss 0.623628, Valid_loss 0.601363
Epoch 26, Train Loss 0.625949, Valid_loss 0.604592
Epoch 27, Train Loss 0.630604, Valid_loss 0.601126
Epoch 28, Train Loss 0.625575, Valid_loss 0.612290
Epoch 29, Train Loss 0.637742, Valid_loss 0.598125
Epoch 30, Train Loss 0.631104, Valid_loss 0.610451
Epoch 31, Train Loss 0.634521, Valid_loss 0.598735
Epoch 32, Train Loss 0.615458, Valid_loss 0.605820
Epoch 33, Train Loss 0.619013, Valid_loss 0.606311
Epoch 34, Train Loss 0.617416, Valid_loss 0.601109
Epoch 35, Train Loss 0.612451, Valid_loss 0.601800
Epoch 36, Train Loss 0.619906, Valid_loss 0.597690
Epoch 37, Train Loss 0.617439, Valid_loss 0.596860
Epoch 38, Train Loss 0.601583, Valid_loss 0.529609
Epoch 39, Train Loss 0.439242, Valid_loss 0.503350
Epoch 40, Train Loss 0.419224, Valid_loss 0.800194
Epoch 41, Train Loss 0.614202, Valid_loss 0.559265
Epoch 42, Train Loss 0.417328, Valid_loss 0.477117
Epoch 43, Train Loss 0.269394, Valid_loss 0.646693
Epoch 44, Train Loss 0.265840, Valid_loss 0.748789
Epoch 45, Train Loss 0.250996, Valid_loss 0.676236
Epoch 46, Train Loss 0.270246, Valid_loss 0.626724
Epoch 47, Train Loss 0.245300, Valid_loss 0.534048
Epoch 48, Train Loss 0.230310, Valid_loss 0.716236
Epoch 49, Train Loss 0.271149, Valid_loss 0.556316
Epoch 50, Train Loss 0.273084, Valid_loss 0.511419
Epoch 51, Train Loss 0.255012, Valid_loss 0.458457
Epoch 52, Train Loss 0.272154, Valid_loss 0.458551
Epoch 53, Train Loss 0.253268, Valid_loss 0.480902
[I 2025-08-31 19:21:32,508] Trial 2 finished with value: 0.45845719280519653 and parameters: {'learning_rate': 0.01, 'epochs': 100, 'heads': 2, 'dropout': 0.0, 'weight_decay': 0.0001, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.2817406441484179.
선택된 trial params: {'learning_rate': 0.01, 'epochs': 100, 'heads': 2, 'dropout': 0.3, 'weight_decay': 0.001, 'emb_dim': 64, 'augment_num': 100, 'pca': False}
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=10, batch_size=1 -> steps=10
output_class :  1
Memory Allocated: 29.04 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.636684, Valid_loss 0.599921
Epoch 2, Train Loss 0.655729, Valid_loss 0.596832
Epoch 3, Train Loss 0.633646, Valid_loss 0.593923
Epoch 4, Train Loss 0.631190, Valid_loss 0.581753
Epoch 5, Train Loss 0.555164, Valid_loss 0.597942
Epoch 6, Train Loss 0.432196, Valid_loss 0.576732
Epoch 7, Train Loss 0.385385, Valid_loss 0.679302
Epoch 8, Train Loss 0.383902, Valid_loss 0.737202
Epoch 9, Train Loss 0.324672, Valid_loss 0.732436
Epoch 10, Train Loss 0.326878, Valid_loss 0.743939
Epoch 11, Train Loss 0.622622, Valid_loss 0.593836
Epoch 12, Train Loss 0.474149, Valid_loss 0.627835
Epoch 13, Train Loss 0.394490, Valid_loss 0.764368
Epoch 14, Train Loss 0.274808, Valid_loss 0.920002
Epoch 15, Train Loss 0.305916, Valid_loss 0.918580
Epoch 16, Train Loss 0.275558, Valid_loss 0.922987
Epoch 17, Train Loss 0.402198, Valid_loss 0.636818
Epoch 18, Train Loss 0.370288, Valid_loss 0.693566
Epoch 19, Train Loss 0.288001, Valid_loss 1.098346
Epoch 20, Train Loss 0.326362, Valid_loss 0.888315
Epoch 21, Train Loss 0.328542, Valid_loss 0.762991
Epoch 22, Train Loss 0.328988, Valid_loss 0.916894
Epoch 23, Train Loss 0.287176, Valid_loss 1.070453
Epoch 24, Train Loss 0.251678, Valid_loss 1.047147
Epoch 25, Train Loss 0.317835, Valid_loss 1.068126
Epoch 26, Train Loss 0.604511, Valid_loss 0.606774
Epoch 27, Train Loss 0.343241, Valid_loss 0.966640
Epoch 28, Train Loss 0.269495, Valid_loss 1.103260
Epoch 29, Train Loss 0.338897, Valid_loss 1.064492
Epoch 30, Train Loss 0.338622, Valid_loss 0.932873
Epoch 31, Train Loss 0.279569, Valid_loss 1.060793
Epoch 32, Train Loss 0.291763, Valid_loss 0.992188
Epoch 33, Train Loss 0.281503, Valid_loss 0.988170
Epoch 34, Train Loss 0.258467, Valid_loss 1.061949
Epoch 35, Train Loss 0.286704, Valid_loss 1.019416
Epoch 36, Train Loss 0.296499, Valid_loss 0.769027
Epoch 37, Train Loss 0.316408, Valid_loss 0.775125
Epoch 38, Train Loss 0.312078, Valid_loss 0.745156
Epoch 39, Train Loss 0.308178, Valid_loss 0.698860
Epoch 40, Train Loss 0.456574, Valid_loss 0.718428
Epoch 41, Train Loss 0.313153, Valid_loss 1.184623
Epoch 42, Train Loss 0.357376, Valid_loss 0.746327
Epoch 43, Train Loss 0.287914, Valid_loss 1.165019
Epoch 44, Train Loss 0.297568, Valid_loss 0.711061
Epoch 45, Train Loss 0.252527, Valid_loss 1.008535
Epoch 46, Train Loss 0.253539, Valid_loss 1.051451
Epoch 47, Train Loss 0.281903, Valid_loss 0.909015
Epoch 48, Train Loss 0.245006, Valid_loss 1.055099
Epoch 49, Train Loss 0.249113, Valid_loss 1.251108
Epoch 50, Train Loss 0.243377, Valid_loss 1.108421
Epoch 51, Train Loss 0.230623, Valid_loss 1.085366
Epoch 52, Train Loss 0.241995, Valid_loss 1.019748
Epoch 53, Train Loss 0.234927, Valid_loss 1.034595
Epoch 54, Train Loss 0.242158, Valid_loss 1.046642
환자ID=COVID19_Participant15 -- true: 1 -- pred: 1
환자ID=COVID19_Participant18 -- true: 1 -- pred: 1
환자ID=COVID19_Participant3 -- true: 1 -- pred: 1
환자ID=COVID19_Participant30 -- true: 1 -- pred: 1
환자ID=COVID19_Participant39 -- true: 1 -- pred: 1
환자ID=COVID19_Participant6 -- true: 1 -- pred: 1
환자ID=COVID19_Participant7 -- true: 1 -- pred: 1
환자ID=Control_Participant10 -- true: 0 -- pred: 1
환자ID=Control_Participant12 -- true: 0 -- pred: 1
환자ID=Control_Participant13 -- true: 0 -- pred: 1
Best performance: Epoch 6, Loss 0.432196, Test ACC 0.700000, Test AUC 1.000000, Test Recall 1.000000, Test Precision 0.700000
Confusion Matrix:
 [0 3 0 7]
✅ Total valid splits used: 2
🔁 Repeat 3, Fold 2
cell type :  GTCGGGGGGTGG_Control_Participant7        Keratinocytes
CAAATCAATTAT_Control_Participant7     Epithelial_cells
ATACAATTGACA_Control_Participant7     Epithelial_cells
CTGTTAATGAGA_Control_Participant7     Epithelial_cells
CTTCACATTATT_Control_Participant7     Epithelial_cells
                                            ...       
GCAGGGAACTCC_COVID19_Participant30    Epithelial_cells
CAGCACCGAGCC_COVID19_Participant30    Epithelial_cells
GCCCCTTGTGAT_COVID19_Participant30    Epithelial_cells
GTGTTGTGTGTC_COVID19_Participant30              B_cell
TAACACTCACTT_COVID19_Participant30           Myelocyte
Name: singler_annotation, Length: 23100, dtype: string
cell type annotation :  GTCGGGGGGTGG_Control_Participant7        Keratinocytes
CAAATCAATTAT_Control_Participant7     Epithelial_cells
ATACAATTGACA_Control_Participant7     Epithelial_cells
CTGTTAATGAGA_Control_Participant7     Epithelial_cells
CTTCACATTATT_Control_Participant7     Epithelial_cells
                                            ...       
GCAGGGAACTCC_COVID19_Participant30    Epithelial_cells
CAGCACCGAGCC_COVID19_Participant30    Epithelial_cells
GCCCCTTGTGAT_COVID19_Participant30    Epithelial_cells
GTGTTGTGTGTC_COVID19_Participant30              B_cell
TAACACTCACTT_COVID19_Participant30           Myelocyte
Name: singler_annotation, Length: 23100, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Keratinocytes', 'Epithelial_cells', 'Neurons', 'iPS_cells', 'Embryonic_stem_cells', 'Astrocyte', 'DC', 'Gametocytes', 'HSC_-G-CSF', 'Smooth_muscle_cells', 'BM & Prog.', 'Monocyte', 'Myelocyte', 'BM', 'Endothelial_cells', 'Osteoblasts', 'Platelets', 'Erythroblast', 'NK_cell', 'T_cells', 'Chondrocytes', 'HSC_CD34+', 'CMP', 'Neutrophils', 'Fibroblasts', 'MEP', 'Neuroepithelial_cell', 'MSC', 'Pro-Myelocyte', 'B_cell', 'GMP', 'Hepatocytes', 'Macrophage', 'Tissue_stem_cells', 'Pre-B_cell_CD34-', 'Pro-B_cell_CD34+', 'Unknown']
라벨별 그룹 개수 {1: 28, 0: 12}
cell type :  TGGGATTACAGG_Control_Participant5              Macrophage
CTGCGACGGCAC_Control_Participant5        Epithelial_cells
GGAATAAGTATC_Control_Participant5        Epithelial_cells
GACACGCCCTTA_Control_Participant5        Epithelial_cells
TTCAAGGTAGTC_Control_Participant5        Epithelial_cells
                                             ...         
GCGCCCGTGTTA_COVID19_Participant27       Epithelial_cells
TTGATCCGTGGC_COVID19_Participant27                T_cells
CGCGACTACTCT_COVID19_Participant27       Epithelial_cells
AAACGCTTGTTA_COVID19_Participant27       Epithelial_cells
CATTGGGGGAAA_COVID19_Participant27    Smooth_muscle_cells
Name: singler_annotation, Length: 3847, dtype: string
cell type annotation :  TGGGATTACAGG_Control_Participant5              Macrophage
CTGCGACGGCAC_Control_Participant5        Epithelial_cells
GGAATAAGTATC_Control_Participant5        Epithelial_cells
GACACGCCCTTA_Control_Participant5        Epithelial_cells
TTCAAGGTAGTC_Control_Participant5        Epithelial_cells
                                             ...         
GCGCCCGTGTTA_COVID19_Participant27       Epithelial_cells
TTGATCCGTGGC_COVID19_Participant27                T_cells
CGCGACTACTCT_COVID19_Participant27       Epithelial_cells
AAACGCTTGTTA_COVID19_Participant27       Epithelial_cells
CATTGGGGGAAA_COVID19_Participant27    Smooth_muscle_cells
Name: singler_annotation, Length: 3847, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Macrophage', 'Epithelial_cells', 'HSC_-G-CSF', 'Neurons', 'Neutrophils', 'T_cells', 'Gametocytes', 'Neuroepithelial_cell', 'NK_cell', 'BM & Prog.', 'Keratinocytes', 'DC', 'Astrocyte', 'Embryonic_stem_cells', 'CMP', 'Tissue_stem_cells', 'Smooth_muscle_cells', 'Erythroblast', 'Myelocyte', 'iPS_cells', 'Pre-B_cell_CD34-', 'Platelets', 'Monocyte', 'MEP', 'B_cell', 'MSC', 'Pro-Myelocyte', 'Osteoblasts', 'HSC_CD34+', 'Fibroblasts', 'Pro-B_cell_CD34+', 'Chondrocytes', 'Endothelial_cells', 'GMP', 'Hepatocytes', 'BM']
라벨별 그룹 개수 {1: 7, 0: 3}
🔍 Split #3
  → train_p_index 환자 수 (환자 단위로 묶인 index list): 40
  → test_p_index 환자 수  (환자 단위로 묶인 index list): 10
  → train 환자 ID: ['COVID19_Participant10', 'COVID19_Participant11', 'COVID19_Participant13', 'COVID19_Participant14', 'COVID19_Participant15', 'COVID19_Participant17', 'COVID19_Participant18', 'COVID19_Participant19', 'COVID19_Participant20', 'COVID19_Participant21', 'COVID19_Participant22', 'COVID19_Participant25', 'COVID19_Participant26', 'COVID19_Participant28', 'COVID19_Participant29', 'COVID19_Participant3', 'COVID19_Participant30', 'COVID19_Participant31', 'COVID19_Participant32', 'COVID19_Participant36', 'COVID19_Participant38', 'COVID19_Participant39', 'COVID19_Participant4', 'COVID19_Participant40', 'COVID19_Participant5', 'COVID19_Participant6', 'COVID19_Participant7', 'COVID19_Participant9', 'Control_Participant1', 'Control_Participant10', 'Control_Participant11', 'Control_Participant12', 'Control_Participant13', 'Control_Participant14', 'Control_Participant2', 'Control_Participant3', 'Control_Participant4', 'Control_Participant6', 'Control_Participant7', 'Control_Participant8']
  → test  환자 ID: ['COVID19_Participant12', 'COVID19_Participant2', 'COVID19_Participant23', 'COVID19_Participant27', 'COVID19_Participant35', 'COVID19_Participant37', 'COVID19_Participant8', 'Control_Participant15', 'Control_Participant5', 'Control_Participant9']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant10, Label: 1
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant18, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant21, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant3, Label: 1
    ID: COVID19_Participant30, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant36, Label: 1
    ID: COVID19_Participant38, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: COVID19_Participant5, Label: 1
    ID: COVID19_Participant6, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: COVID19_Participant9, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant10, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant12, Label: 0
    ID: Control_Participant13, Label: 0
    ID: Control_Participant14, Label: 0
    ID: Control_Participant2, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant4, Label: 0
    ID: Control_Participant6, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant8, Label: 0
  → test 환자 ID 및 라벨:
    ID: COVID19_Participant12, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant27, Label: 1
    ID: COVID19_Participant35, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: Control_Participant15, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant9, Label: 0
전체 데이터 index 길이 50
label_stat (train 환자 라벨 목록) 갯수 40
train_data에서 환자 단위로, train과 validation 나누기
기존 train_p_index 40
기존 (train) label_stat 40
train-vali 분할 후! 
train y 의 classes : {0, 1} valid y 의 classes : {0, 1} label_stat 의 classes : {0, 1}
train_p_index_ 26
valid_p_index 14
test_p_index 10
→ train 환자 ID 및 라벨:
   총 개수: 26
   환자ID=Control_Participant10, Label=0, 셀개수=1645
   환자ID=Control_Participant14, Label=0, 셀개수=274
   환자ID=COVID19_Participant18, Label=1, 셀개수=227
   환자ID=COVID19_Participant39, Label=1, 셀개수=454
   환자ID=COVID19_Participant10, Label=1, 셀개수=18
   환자ID=Control_Participant4, Label=0, 셀개수=440
   환자ID=COVID19_Participant14, Label=1, 셀개수=382
   환자ID=COVID19_Participant19, Label=1, 셀개수=816
   환자ID=COVID19_Participant40, Label=1, 셀개수=381
   환자ID=COVID19_Participant13, Label=1, 셀개수=730
   환자ID=COVID19_Participant20, Label=1, 셀개수=2033
   환자ID=Control_Participant2, Label=0, 셀개수=41
   환자ID=COVID19_Participant28, Label=1, 셀개수=1079
   환자ID=Control_Participant7, Label=0, 셀개수=762
   환자ID=Control_Participant6, Label=0, 셀개수=131
   환자ID=COVID19_Participant15, Label=1, 셀개수=1003
   환자ID=Control_Participant8, Label=0, 셀개수=393
   환자ID=Control_Participant11, Label=0, 셀개수=1164
   환자ID=COVID19_Participant22, Label=1, 셀개수=865
   환자ID=COVID19_Participant30, Label=1, 셀개수=116
   환자ID=COVID19_Participant26, Label=1, 셀개수=814
   환자ID=COVID19_Participant17, Label=1, 셀개수=843
   환자ID=COVID19_Participant6, Label=1, 셀개수=84
   환자ID=COVID19_Participant4, Label=1, 셀개수=1680
   환자ID=COVID19_Participant38, Label=1, 셀개수=51
   환자ID=COVID19_Participant3, Label=1, 셀개수=104
→ valid 환자 ID 및 라벨:
   총 개수: 14
   환자ID=Control_Participant13, Label=0, 셀개수=88
   환자ID=COVID19_Participant29, Label=1, 셀개수=573
   환자ID=COVID19_Participant32, Label=1, 셀개수=1665
   환자ID=COVID19_Participant31, Label=1, 셀개수=410
   환자ID=COVID19_Participant5, Label=1, 셀개수=89
   환자ID=COVID19_Participant21, Label=1, 셀개수=39
   환자ID=Control_Participant3, Label=0, 셀개수=1620
   환자ID=Control_Participant1, Label=0, 셀개수=414
   환자ID=COVID19_Participant9, Label=1, 셀개수=86
   환자ID=COVID19_Participant7, Label=1, 셀개수=409
   환자ID=Control_Participant12, Label=0, 셀개수=99
   환자ID=COVID19_Participant36, Label=1, 셀개수=200
   환자ID=COVID19_Participant11, Label=1, 셀개수=382
   환자ID=COVID19_Participant25, Label=1, 셀개수=496
→ test 환자 ID 및 라벨:
   총 개수: 10
   환자ID=COVID19_Participant12, Label=1, 셀개수=102
   환자ID=COVID19_Participant2, Label=1, 셀개수=329
   환자ID=COVID19_Participant23, Label=1, 셀개수=307
   환자ID=COVID19_Participant27, Label=1, 셀개수=93
   환자ID=COVID19_Participant35, Label=1, 셀개수=83
   환자ID=COVID19_Participant37, Label=1, 셀개수=668
   환자ID=COVID19_Participant8, Label=1, 셀개수=462
   환자ID=Control_Participant15, Label=0, 셀개수=528
   환자ID=Control_Participant5, Label=0, 셀개수=717
   환자ID=Control_Participant9, Label=0, 셀개수=558
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Keratinocytes', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Neurons', 'iPS_cells', 'Embryonic_stem_cells', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
전체 데이터 길이 26947
전체 cell type 길이 0              Keratinocytes
1           Epithelial_cells
2           Epithelial_cells
3           Epithelial_cells
4           Epithelial_cells
                ...         
26942       Epithelial_cells
26943                T_cells
26944       Epithelial_cells
26945       Epithelial_cells
26946    Smooth_muscle_cells
Length: 26947, dtype: string
cell type의 NaN 개수 체크 0
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:15,  6.43it/s]  2%|▏         | 2/100 [00:00<00:12,  7.88it/s]  3%|▎         | 3/100 [00:00<00:12,  7.80it/s]  5%|▌         | 5/100 [00:00<00:10,  9.09it/s]  6%|▌         | 6/100 [00:00<00:12,  7.78it/s]  7%|▋         | 7/100 [00:00<00:12,  7.70it/s]  8%|▊         | 8/100 [00:00<00:11,  8.26it/s]  9%|▉         | 9/100 [00:01<00:10,  8.60it/s] 10%|█         | 10/100 [00:01<00:10,  8.64it/s] 11%|█         | 11/100 [00:01<00:10,  8.27it/s] 12%|█▏        | 12/100 [00:01<00:10,  8.44it/s] 14%|█▍        | 14/100 [00:01<00:09,  8.77it/s] 15%|█▌        | 15/100 [00:01<00:09,  8.97it/s] 16%|█▌        | 16/100 [00:01<00:09,  8.96it/s] 17%|█▋        | 17/100 [00:01<00:09,  9.05it/s] 18%|█▊        | 18/100 [00:02<00:08,  9.18it/s] 19%|█▉        | 19/100 [00:02<00:08,  9.28it/s] 20%|██        | 20/100 [00:02<00:08,  9.40it/s] 21%|██        | 21/100 [00:02<00:08,  9.46it/s] 22%|██▏       | 22/100 [00:02<00:08,  9.50it/s] 23%|██▎       | 23/100 [00:02<00:08,  9.43it/s] 24%|██▍       | 24/100 [00:02<00:09,  8.16it/s] 25%|██▌       | 25/100 [00:02<00:09,  8.05it/s] 26%|██▌       | 26/100 [00:03<00:08,  8.32it/s] 27%|██▋       | 27/100 [00:03<00:08,  8.66it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.77it/s] 29%|██▉       | 29/100 [00:03<00:08,  8.70it/s] 30%|███       | 30/100 [00:03<00:07,  8.90it/s] 31%|███       | 31/100 [00:03<00:07,  9.02it/s] 33%|███▎      | 33/100 [00:03<00:07,  9.21it/s] 34%|███▍      | 34/100 [00:03<00:07,  8.57it/s] 35%|███▌      | 35/100 [00:04<00:07,  8.90it/s] 36%|███▌      | 36/100 [00:04<00:07,  8.83it/s] 38%|███▊      | 38/100 [00:04<00:06,  9.09it/s] 39%|███▉      | 39/100 [00:04<00:06,  9.26it/s] 40%|████      | 40/100 [00:04<00:06,  9.02it/s] 41%|████      | 41/100 [00:04<00:06,  9.03it/s] 42%|████▏     | 42/100 [00:04<00:06,  9.26it/s] 43%|████▎     | 43/100 [00:04<00:06,  8.85it/s] 44%|████▍     | 44/100 [00:05<00:06,  8.84it/s] 45%|████▌     | 45/100 [00:05<00:06,  9.04it/s] 46%|████▌     | 46/100 [00:05<00:05,  9.23it/s] 47%|████▋     | 47/100 [00:05<00:05,  9.38it/s] 48%|████▊     | 48/100 [00:05<00:05,  9.24it/s] 49%|████▉     | 49/100 [00:05<00:05,  9.33it/s] 50%|█████     | 50/100 [00:05<00:05,  9.32it/s] 51%|█████     | 51/100 [00:05<00:05,  8.91it/s] 52%|█████▏    | 52/100 [00:05<00:05,  8.49it/s] 54%|█████▍    | 54/100 [00:06<00:05,  9.10it/s] 56%|█████▌    | 56/100 [00:06<00:04,  9.54it/s] 57%|█████▋    | 57/100 [00:06<00:04,  9.28it/s] 58%|█████▊    | 58/100 [00:06<00:04,  9.21it/s] 59%|█████▉    | 59/100 [00:06<00:04,  9.33it/s] 60%|██████    | 60/100 [00:06<00:04,  9.34it/s] 61%|██████    | 61/100 [00:06<00:04,  9.21it/s] 62%|██████▏   | 62/100 [00:06<00:04,  8.81it/s] 63%|██████▎   | 63/100 [00:07<00:04,  8.85it/s] 64%|██████▍   | 64/100 [00:07<00:05,  7.19it/s] 65%|██████▌   | 65/100 [00:07<00:04,  7.73it/s] 66%|██████▌   | 66/100 [00:07<00:04,  7.89it/s] 67%|██████▋   | 67/100 [00:07<00:04,  7.60it/s] 68%|██████▊   | 68/100 [00:07<00:04,  7.78it/s] 69%|██████▉   | 69/100 [00:07<00:03,  8.09it/s] 70%|███████   | 70/100 [00:08<00:03,  8.34it/s] 71%|███████   | 71/100 [00:08<00:03,  8.29it/s] 72%|███████▏  | 72/100 [00:08<00:03,  8.04it/s] 73%|███████▎  | 73/100 [00:08<00:03,  7.99it/s] 74%|███████▍  | 74/100 [00:08<00:03,  8.36it/s] 75%|███████▌  | 75/100 [00:08<00:02,  8.49it/s] 76%|███████▌  | 76/100 [00:08<00:02,  8.50it/s] 77%|███████▋  | 77/100 [00:08<00:03,  6.28it/s] 78%|███████▊  | 78/100 [00:09<00:03,  6.06it/s] 79%|███████▉  | 79/100 [00:09<00:03,  6.75it/s] 80%|████████  | 80/100 [00:09<00:03,  6.65it/s] 81%|████████  | 81/100 [00:09<00:02,  7.02it/s] 82%|████████▏ | 82/100 [00:09<00:02,  7.56it/s] 83%|████████▎ | 83/100 [00:09<00:02,  7.79it/s] 84%|████████▍ | 84/100 [00:09<00:02,  7.02it/s] 85%|████████▌ | 85/100 [00:10<00:02,  7.23it/s] 86%|████████▌ | 86/100 [00:10<00:01,  7.58it/s] 87%|████████▋ | 87/100 [00:10<00:01,  7.28it/s] 88%|████████▊ | 88/100 [00:10<00:01,  7.52it/s] 89%|████████▉ | 89/100 [00:10<00:01,  8.01it/s] 90%|█████████ | 90/100 [00:10<00:01,  8.28it/s] 91%|█████████ | 91/100 [00:10<00:01,  8.43it/s] 92%|█████████▏| 92/100 [00:10<00:00,  8.45it/s] 93%|█████████▎| 93/100 [00:11<00:00,  8.09it/s] 94%|█████████▍| 94/100 [00:11<00:00,  8.21it/s] 95%|█████████▌| 95/100 [00:11<00:00,  8.22it/s] 96%|█████████▌| 96/100 [00:11<00:00,  7.39it/s] 97%|█████████▋| 97/100 [00:11<00:00,  7.64it/s] 98%|█████████▊| 98/100 [00:11<00:00,  7.77it/s] 99%|█████████▉| 99/100 [00:11<00:00,  7.99it/s]100%|██████████| 100/100 [00:11<00:00,  7.37it/s]100%|██████████| 100/100 [00:11<00:00,  8.34it/s]
[I 2025-08-31 19:25:27,500] A new study created in memory with name: no-name-10671501-98a9-488f-a933-b1e7d9a22da3
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 26.96 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.617775, Valid_loss 0.542692
Epoch 2, Train Loss 0.474000, Valid_loss 0.555826
Epoch 3, Train Loss 0.389941, Valid_loss 0.534024
Epoch 4, Train Loss 0.366760, Valid_loss 0.517893
Epoch 5, Train Loss 0.342527, Valid_loss 0.468953
Epoch 6, Train Loss 0.308495, Valid_loss 0.616848
Epoch 7, Train Loss 0.304390, Valid_loss 0.512455
Epoch 8, Train Loss 0.288199, Valid_loss 0.599812
Epoch 9, Train Loss 0.295478, Valid_loss 0.465281
Epoch 10, Train Loss 0.291922, Valid_loss 0.489592
Epoch 11, Train Loss 0.292018, Valid_loss 0.446493
Epoch 12, Train Loss 0.288026, Valid_loss 0.493033
Epoch 13, Train Loss 0.267886, Valid_loss 0.449478
Epoch 14, Train Loss 0.260240, Valid_loss 0.532154
Epoch 15, Train Loss 0.255840, Valid_loss 0.590201
Epoch 16, Train Loss 0.251051, Valid_loss 0.829701
Epoch 17, Train Loss 0.254075, Valid_loss 0.454180
Epoch 18, Train Loss 0.253745, Valid_loss 0.632759
Epoch 19, Train Loss 0.254681, Valid_loss 0.440625
Epoch 20, Train Loss 0.230425, Valid_loss 0.460140
Epoch 21, Train Loss 0.236533, Valid_loss 0.516366
Epoch 22, Train Loss 0.239863, Valid_loss 0.732166
Epoch 23, Train Loss 0.235642, Valid_loss 0.566094
Epoch 24, Train Loss 0.228957, Valid_loss 0.430774
Epoch 25, Train Loss 0.257123, Valid_loss 0.573584
Epoch 26, Train Loss 0.236162, Valid_loss 0.654404
Epoch 27, Train Loss 0.232209, Valid_loss 0.633254
Epoch 28, Train Loss 0.239171, Valid_loss 0.539059
Epoch 29, Train Loss 0.241133, Valid_loss 0.470537
Epoch 30, Train Loss 0.235141, Valid_loss 0.457884
Epoch 31, Train Loss 0.230769, Valid_loss 0.621196
Epoch 32, Train Loss 0.232008, Valid_loss 0.756337
Epoch 33, Train Loss 0.251845, Valid_loss 0.440695
Epoch 34, Train Loss 0.274823, Valid_loss 0.420049
Epoch 35, Train Loss 0.246063, Valid_loss 0.512968
Epoch 36, Train Loss 0.229915, Valid_loss 0.625044
Epoch 37, Train Loss 0.239927, Valid_loss 0.672928
Epoch 38, Train Loss 0.220735, Valid_loss 0.649400
Epoch 39, Train Loss 0.227194, Valid_loss 0.621307
Epoch 40, Train Loss 0.233019, Valid_loss 0.527275
Epoch 41, Train Loss 0.232062, Valid_loss 0.449632
Epoch 42, Train Loss 0.244206, Valid_loss 0.450579
Epoch 43, Train Loss 0.261467, Valid_loss 0.528098
Epoch 44, Train Loss 0.228693, Valid_loss 0.728732
Epoch 45, Train Loss 0.234448, Valid_loss 0.616069
Epoch 46, Train Loss 0.225231, Valid_loss 0.557683
Epoch 47, Train Loss 0.216827, Valid_loss 0.562319
Epoch 48, Train Loss 0.234558, Valid_loss 0.689625
Epoch 49, Train Loss 0.239420, Valid_loss 0.710544
Epoch 50, Train Loss 0.215577, Valid_loss 0.524838
Epoch 51, Train Loss 0.225683, Valid_loss 0.596532
Epoch 52, Train Loss 0.217726, Valid_loss 0.561907
Epoch 53, Train Loss 0.210411, Valid_loss 0.488087
Epoch 54, Train Loss 0.204975, Valid_loss 0.577432
Epoch 55, Train Loss 0.213154, Valid_loss 0.649363
[I 2025-08-31 19:29:10,486] Trial 0 finished with value: 0.4200486269380365 and parameters: {'learning_rate': 0.001, 'epochs': 100, 'heads': 2, 'dropout': 0.3, 'weight_decay': 0.01, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.4200486269380365.
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 25.64 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.642673, Valid_loss 0.629743
Epoch 2, Train Loss 0.691982, Valid_loss 0.636868
Epoch 3, Train Loss 0.655917, Valid_loss 0.628547
Epoch 4, Train Loss 0.635379, Valid_loss 0.608163
Epoch 5, Train Loss 0.627440, Valid_loss 0.601655
Epoch 6, Train Loss 0.594364, Valid_loss 0.603851
Epoch 7, Train Loss 0.646963, Valid_loss 0.632133
Epoch 8, Train Loss 0.598541, Valid_loss 0.597665
Epoch 9, Train Loss 0.551529, Valid_loss 0.574400
Epoch 10, Train Loss 0.599412, Valid_loss 0.606755
Epoch 11, Train Loss 0.597393, Valid_loss 0.577131
Epoch 12, Train Loss 0.483769, Valid_loss 0.559387
Epoch 13, Train Loss 0.525958, Valid_loss 0.618873
Epoch 14, Train Loss 0.462263, Valid_loss 0.595813
Epoch 15, Train Loss 0.499566, Valid_loss 0.559585
Epoch 16, Train Loss 0.510713, Valid_loss 0.561597
Epoch 17, Train Loss 0.465894, Valid_loss 0.560016
Epoch 18, Train Loss 0.475633, Valid_loss 0.565642
Epoch 19, Train Loss 0.473062, Valid_loss 0.531233
Epoch 20, Train Loss 0.464036, Valid_loss 0.668956
Epoch 21, Train Loss 0.506393, Valid_loss 0.518980
Epoch 22, Train Loss 0.456848, Valid_loss 0.502856
Epoch 23, Train Loss 0.465764, Valid_loss 0.497642
Epoch 24, Train Loss 0.455372, Valid_loss 0.574151
Epoch 25, Train Loss 0.482318, Valid_loss 0.791116
Epoch 26, Train Loss 0.453695, Valid_loss 0.567179
Epoch 27, Train Loss 0.458291, Valid_loss 0.470025
Epoch 28, Train Loss 0.423460, Valid_loss 0.721643
Epoch 29, Train Loss 0.403711, Valid_loss 0.490144
Epoch 30, Train Loss 0.404752, Valid_loss 0.594626
Epoch 31, Train Loss 0.387024, Valid_loss 0.602404
Epoch 32, Train Loss 0.415151, Valid_loss 0.480234
Epoch 33, Train Loss 0.403274, Valid_loss 0.646536
Epoch 34, Train Loss 0.439148, Valid_loss 0.591274
Epoch 35, Train Loss 0.403415, Valid_loss 0.554663
Epoch 36, Train Loss 0.402087, Valid_loss 0.568682
Epoch 37, Train Loss 0.359393, Valid_loss 0.612692
Epoch 38, Train Loss 0.371159, Valid_loss 0.560894
Epoch 39, Train Loss 0.384529, Valid_loss 0.555122
Epoch 40, Train Loss 0.364156, Valid_loss 0.553047
Epoch 41, Train Loss 0.401592, Valid_loss 0.530356
Epoch 42, Train Loss 0.453072, Valid_loss 0.502349
Epoch 43, Train Loss 0.358139, Valid_loss 0.643503
Epoch 44, Train Loss 0.334465, Valid_loss 0.683659
Epoch 45, Train Loss 0.340761, Valid_loss 0.617013
Epoch 46, Train Loss 0.349222, Valid_loss 0.577703
Epoch 47, Train Loss 0.383339, Valid_loss 0.451913
Epoch 48, Train Loss 0.370380, Valid_loss 0.602876
Epoch 49, Train Loss 0.347258, Valid_loss 0.543336
Epoch 50, Train Loss 0.348345, Valid_loss 0.465864
Epoch 51, Train Loss 0.309846, Valid_loss 0.596871
Epoch 52, Train Loss 0.343036, Valid_loss 0.538382
Epoch 53, Train Loss 0.339623, Valid_loss 0.573825
Epoch 54, Train Loss 0.331337, Valid_loss 0.538127
Epoch 55, Train Loss 0.356027, Valid_loss 0.596209
Epoch 56, Train Loss 0.376403, Valid_loss 0.666852
[I 2025-08-31 19:33:30,822] Trial 1 finished with value: 0.451912912939276 and parameters: {'learning_rate': 0.001, 'epochs': 100, 'heads': 4, 'dropout': 0.5, 'weight_decay': 0.001, 'emb_dim': 8, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.4200486269380365.
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 26.96 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.666457, Valid_loss 0.595795
Epoch 2, Train Loss 0.620891, Valid_loss 0.607623
Epoch 3, Train Loss 0.517986, Valid_loss 0.582649
Epoch 4, Train Loss 0.443218, Valid_loss 0.679984
Epoch 5, Train Loss 0.410786, Valid_loss 0.555925
Epoch 6, Train Loss 0.432637, Valid_loss 0.461968
Epoch 7, Train Loss 0.374234, Valid_loss 0.508389
Epoch 8, Train Loss 0.313986, Valid_loss 0.340016
Epoch 9, Train Loss 0.364080, Valid_loss 0.455062
Epoch 10, Train Loss 0.367082, Valid_loss 0.538550
Epoch 11, Train Loss 0.400948, Valid_loss 0.490700
Epoch 12, Train Loss 0.323410, Valid_loss 0.425225
Epoch 13, Train Loss 0.322140, Valid_loss 0.423327
Epoch 14, Train Loss 0.315689, Valid_loss 0.562696
Epoch 15, Train Loss 0.281238, Valid_loss 0.565964
Epoch 16, Train Loss 0.283425, Valid_loss 0.469533
Epoch 17, Train Loss 0.340503, Valid_loss 0.572811
Epoch 18, Train Loss 0.294328, Valid_loss 0.785994
Epoch 19, Train Loss 0.303330, Valid_loss 0.526530
Epoch 20, Train Loss 0.281146, Valid_loss 0.483361
Epoch 21, Train Loss 0.277923, Valid_loss 0.425124
Epoch 22, Train Loss 0.271086, Valid_loss 0.465562
Epoch 23, Train Loss 0.349024, Valid_loss 0.416205
Epoch 24, Train Loss 0.294193, Valid_loss 0.669210
Epoch 25, Train Loss 0.294662, Valid_loss 0.585243
Epoch 26, Train Loss 0.267460, Valid_loss 0.560803
Epoch 27, Train Loss 0.290908, Valid_loss 0.653819
Epoch 28, Train Loss 0.249664, Valid_loss 0.609247
Epoch 29, Train Loss 0.263668, Valid_loss 0.443892
Epoch 30, Train Loss 0.271170, Valid_loss 0.551283
Epoch 31, Train Loss 0.282339, Valid_loss 0.485265
Epoch 32, Train Loss 0.252824, Valid_loss 0.427614
Epoch 33, Train Loss 0.270445, Valid_loss 0.609053
Epoch 34, Train Loss 0.252258, Valid_loss 0.647541
Epoch 35, Train Loss 0.233000, Valid_loss 0.550429
Epoch 36, Train Loss 0.260257, Valid_loss 0.618748
Epoch 37, Train Loss 0.254698, Valid_loss 0.588898
Epoch 38, Train Loss 0.254888, Valid_loss 0.725346
Epoch 39, Train Loss 0.297832, Valid_loss 0.480572
Epoch 40, Train Loss 0.302826, Valid_loss 0.765312
Epoch 41, Train Loss 0.278025, Valid_loss 0.549947
Epoch 42, Train Loss 0.256596, Valid_loss 0.562118
Epoch 43, Train Loss 0.249794, Valid_loss 0.923772
Epoch 44, Train Loss 0.397437, Valid_loss 0.423264
Epoch 45, Train Loss 0.356733, Valid_loss 0.563199
Epoch 46, Train Loss 0.289584, Valid_loss 0.705594
Epoch 47, Train Loss 0.275029, Valid_loss 0.464553
Epoch 48, Train Loss 0.267051, Valid_loss 0.488409
Epoch 49, Train Loss 0.271055, Valid_loss 0.503883
Epoch 50, Train Loss 0.244915, Valid_loss 0.637222
Epoch 51, Train Loss 0.264055, Valid_loss 0.558423
Epoch 52, Train Loss 0.270277, Valid_loss 0.592215
Epoch 53, Train Loss 0.238961, Valid_loss 0.651975
[I 2025-08-31 19:37:37,612] Trial 2 finished with value: 0.3400161111993449 and parameters: {'learning_rate': 0.01, 'epochs': 100, 'heads': 4, 'dropout': 0.3, 'weight_decay': 0.01, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 2 with value: 0.3400161111993449.
선택된 trial params: {'learning_rate': 0.01, 'epochs': 100, 'heads': 4, 'dropout': 0.3, 'weight_decay': 0.01, 'emb_dim': 32, 'augment_num': 100, 'pca': False}
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=10, batch_size=1 -> steps=10
output_class :  1
Memory Allocated: 26.96 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.642512, Valid_loss 0.599740
Epoch 2, Train Loss 0.650632, Valid_loss 0.625797
Epoch 3, Train Loss 0.652735, Valid_loss 0.599073
Epoch 4, Train Loss 0.623846, Valid_loss 0.559135
Epoch 5, Train Loss 0.526839, Valid_loss 0.445622
Epoch 6, Train Loss 0.449496, Valid_loss 0.473281
Epoch 7, Train Loss 0.477720, Valid_loss 0.574200
Epoch 8, Train Loss 0.392073, Valid_loss 0.644759
Epoch 9, Train Loss 0.427488, Valid_loss 0.786720
Epoch 10, Train Loss 0.424121, Valid_loss 0.390428
Epoch 11, Train Loss 0.360042, Valid_loss 0.544159
Epoch 12, Train Loss 0.338736, Valid_loss 0.419159
Epoch 13, Train Loss 0.314899, Valid_loss 0.514927
Epoch 14, Train Loss 0.324120, Valid_loss 0.466809
Epoch 15, Train Loss 0.307922, Valid_loss 0.518474
Epoch 16, Train Loss 0.302968, Valid_loss 0.413038
Epoch 17, Train Loss 0.345539, Valid_loss 0.505919
Epoch 18, Train Loss 0.283401, Valid_loss 0.580474
Epoch 19, Train Loss 0.335862, Valid_loss 0.478293
Epoch 20, Train Loss 0.323326, Valid_loss 0.458645
Epoch 21, Train Loss 0.318342, Valid_loss 0.418660
Epoch 22, Train Loss 0.282898, Valid_loss 0.511377
Epoch 23, Train Loss 0.323404, Valid_loss 0.730683
Epoch 24, Train Loss 0.331486, Valid_loss 0.496462
Epoch 25, Train Loss 0.285065, Valid_loss 0.418099
Epoch 26, Train Loss 0.311699, Valid_loss 0.731578
Epoch 27, Train Loss 0.282663, Valid_loss 0.566699
Epoch 28, Train Loss 0.293082, Valid_loss 0.583901
Epoch 29, Train Loss 0.275958, Valid_loss 0.536103
Epoch 30, Train Loss 0.263669, Valid_loss 0.543065
Epoch 31, Train Loss 0.263698, Valid_loss 0.604208
Epoch 32, Train Loss 0.310166, Valid_loss 0.545636
Epoch 33, Train Loss 0.295032, Valid_loss 0.528756
Epoch 34, Train Loss 0.276170, Valid_loss 0.422374
Epoch 35, Train Loss 0.337609, Valid_loss 0.546963
Epoch 36, Train Loss 0.298791, Valid_loss 0.618286
Epoch 37, Train Loss 0.328497, Valid_loss 0.555526
Epoch 38, Train Loss 0.289988, Valid_loss 0.671656
Epoch 39, Train Loss 0.281083, Valid_loss 0.430789
Epoch 40, Train Loss 0.299997, Valid_loss 0.487247
Epoch 41, Train Loss 0.391551, Valid_loss 0.453664
Epoch 42, Train Loss 0.382793, Valid_loss 0.693347
Epoch 43, Train Loss 0.374149, Valid_loss 0.945397
Epoch 44, Train Loss 0.321492, Valid_loss 0.600108
Epoch 45, Train Loss 0.334010, Valid_loss 0.786920
Epoch 46, Train Loss 0.299456, Valid_loss 0.572258
Epoch 47, Train Loss 0.290725, Valid_loss 0.417253
Epoch 48, Train Loss 0.259404, Valid_loss 0.858456
Epoch 49, Train Loss 0.261839, Valid_loss 0.845994
Epoch 50, Train Loss 0.352016, Valid_loss 0.945514
Epoch 51, Train Loss 0.334211, Valid_loss 0.645015
Epoch 52, Train Loss 0.265302, Valid_loss 0.562956
Epoch 53, Train Loss 0.236761, Valid_loss 0.518412
Epoch 54, Train Loss 0.259565, Valid_loss 0.540547
Epoch 55, Train Loss 0.257321, Valid_loss 0.602643
환자ID=COVID19_Participant12 -- true: 1 -- pred: 1
환자ID=COVID19_Participant2 -- true: 1 -- pred: 1
환자ID=COVID19_Participant23 -- true: 1 -- pred: 1
환자ID=COVID19_Participant27 -- true: 1 -- pred: 1
환자ID=COVID19_Participant35 -- true: 1 -- pred: 0
환자ID=COVID19_Participant37 -- true: 1 -- pred: 1
환자ID=COVID19_Participant8 -- true: 1 -- pred: 1
환자ID=Control_Participant15 -- true: 0 -- pred: 0
환자ID=Control_Participant5 -- true: 0 -- pred: 0
환자ID=Control_Participant9 -- true: 0 -- pred: 0
Best performance: Epoch 10, Loss 0.424121, Test ACC 0.900000, Test AUC 0.952381, Test Recall 0.857143, Test Precision 1.000000
Confusion Matrix:
 [3 0 1 6]
✅ Total valid splits used: 3
🔁 Repeat 3, Fold 3
cell type :  GTCGGGGGGTGG_Control_Participant7        Keratinocytes
CAAATCAATTAT_Control_Participant7     Epithelial_cells
ATACAATTGACA_Control_Participant7     Epithelial_cells
CTGTTAATGAGA_Control_Participant7     Epithelial_cells
CTTCACATTATT_Control_Participant7     Epithelial_cells
                                            ...       
GCAGGGAACTCC_COVID19_Participant30    Epithelial_cells
CAGCACCGAGCC_COVID19_Participant30    Epithelial_cells
GCCCCTTGTGAT_COVID19_Participant30    Epithelial_cells
GTGTTGTGTGTC_COVID19_Participant30              B_cell
TAACACTCACTT_COVID19_Participant30           Myelocyte
Name: singler_annotation, Length: 16697, dtype: string
cell type annotation :  GTCGGGGGGTGG_Control_Participant7        Keratinocytes
CAAATCAATTAT_Control_Participant7     Epithelial_cells
ATACAATTGACA_Control_Participant7     Epithelial_cells
CTGTTAATGAGA_Control_Participant7     Epithelial_cells
CTTCACATTATT_Control_Participant7     Epithelial_cells
                                            ...       
GCAGGGAACTCC_COVID19_Participant30    Epithelial_cells
CAGCACCGAGCC_COVID19_Participant30    Epithelial_cells
GCCCCTTGTGAT_COVID19_Participant30    Epithelial_cells
GTGTTGTGTGTC_COVID19_Participant30              B_cell
TAACACTCACTT_COVID19_Participant30           Myelocyte
Name: singler_annotation, Length: 16697, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Keratinocytes', 'Epithelial_cells', 'Neurons', 'iPS_cells', 'Embryonic_stem_cells', 'Astrocyte', 'DC', 'Gametocytes', 'HSC_-G-CSF', 'Smooth_muscle_cells', 'BM & Prog.', 'Monocyte', 'Myelocyte', 'BM', 'Endothelial_cells', 'Osteoblasts', 'Platelets', 'Erythroblast', 'NK_cell', 'T_cells', 'Chondrocytes', 'HSC_CD34+', 'CMP', 'Neutrophils', 'Fibroblasts', 'MEP', 'Neuroepithelial_cell', 'MSC', 'Pro-Myelocyte', 'B_cell', 'GMP', 'Hepatocytes', 'Macrophage', 'Tissue_stem_cells', 'Pre-B_cell_CD34-', 'Pro-B_cell_CD34+', 'Unknown']
라벨별 그룹 개수 {1: 28, 0: 12}
cell type :  GTAACGCCGTGT_COVID19_Participant5     Epithelial_cells
TCATATGTCGTC_COVID19_Participant5     Epithelial_cells
ATCCCGGCAGCT_COVID19_Participant5              T_cells
TGGGATTACAGG_COVID19_Participant5          Neutrophils
AGCCAGTAAGAT_COVID19_Participant5           BM & Prog.
                                            ...       
CAGGTTGGTATC_COVID19_Participant20    Epithelial_cells
TATAGCTTGGTA_COVID19_Participant20    Epithelial_cells
TTGTTAGACGGT_COVID19_Participant20          HSC_-G-CSF
ATGGCTCAGGCT_COVID19_Participant20    Epithelial_cells
ACATGATCCTTT_COVID19_Participant20    Epithelial_cells
Name: singler_annotation, Length: 10250, dtype: string
cell type annotation :  GTAACGCCGTGT_COVID19_Participant5     Epithelial_cells
TCATATGTCGTC_COVID19_Participant5     Epithelial_cells
ATCCCGGCAGCT_COVID19_Participant5              T_cells
TGGGATTACAGG_COVID19_Participant5          Neutrophils
AGCCAGTAAGAT_COVID19_Participant5           BM & Prog.
                                            ...       
CAGGTTGGTATC_COVID19_Participant20    Epithelial_cells
TATAGCTTGGTA_COVID19_Participant20    Epithelial_cells
TTGTTAGACGGT_COVID19_Participant20          HSC_-G-CSF
ATGGCTCAGGCT_COVID19_Participant20    Epithelial_cells
ACATGATCCTTT_COVID19_Participant20    Epithelial_cells
Name: singler_annotation, Length: 10250, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Epithelial_cells', 'T_cells', 'Neutrophils', 'BM & Prog.', 'Platelets', 'B_cell', 'HSC_-G-CSF', 'Keratinocytes', 'Gametocytes', 'NK_cell', 'Erythroblast', 'Neurons', 'Macrophage', 'Monocyte', 'DC', 'Endothelial_cells', 'Pre-B_cell_CD34-', 'HSC_CD34+', 'Myelocyte', 'MEP', 'Hepatocytes', 'Astrocyte', 'BM', 'Embryonic_stem_cells', 'Osteoblasts', 'Smooth_muscle_cells', 'Chondrocytes', 'Fibroblasts', 'Neuroepithelial_cell', 'Unknown', 'Pro-B_cell_CD34+', 'Pro-Myelocyte', 'CMP', 'GMP', 'iPS_cells', 'MSC', 'Tissue_stem_cells']
라벨별 그룹 개수 {1: 7, 0: 3}
🔍 Split #4
  → train_p_index 환자 수 (환자 단위로 묶인 index list): 40
  → test_p_index 환자 수  (환자 단위로 묶인 index list): 10
  → train 환자 ID: ['COVID19_Participant10', 'COVID19_Participant11', 'COVID19_Participant12', 'COVID19_Participant13', 'COVID19_Participant14', 'COVID19_Participant15', 'COVID19_Participant17', 'COVID19_Participant18', 'COVID19_Participant19', 'COVID19_Participant2', 'COVID19_Participant21', 'COVID19_Participant23', 'COVID19_Participant25', 'COVID19_Participant27', 'COVID19_Participant29', 'COVID19_Participant3', 'COVID19_Participant30', 'COVID19_Participant31', 'COVID19_Participant35', 'COVID19_Participant36', 'COVID19_Participant37', 'COVID19_Participant38', 'COVID19_Participant39', 'COVID19_Participant40', 'COVID19_Participant6', 'COVID19_Participant7', 'COVID19_Participant8', 'COVID19_Participant9', 'Control_Participant1', 'Control_Participant10', 'Control_Participant11', 'Control_Participant12', 'Control_Participant13', 'Control_Participant15', 'Control_Participant2', 'Control_Participant4', 'Control_Participant5', 'Control_Participant7', 'Control_Participant8', 'Control_Participant9']
  → test  환자 ID: ['COVID19_Participant20', 'COVID19_Participant22', 'COVID19_Participant26', 'COVID19_Participant28', 'COVID19_Participant32', 'COVID19_Participant4', 'COVID19_Participant5', 'Control_Participant14', 'Control_Participant3', 'Control_Participant6']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant10, Label: 1
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant12, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant18, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant21, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant27, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant3, Label: 1
    ID: COVID19_Participant30, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant35, Label: 1
    ID: COVID19_Participant36, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant38, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: COVID19_Participant6, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: COVID19_Participant9, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant10, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant12, Label: 0
    ID: Control_Participant13, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant2, Label: 0
    ID: Control_Participant4, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant8, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant5, Label: 1
    ID: Control_Participant14, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant6, Label: 0
전체 데이터 index 길이 50
label_stat (train 환자 라벨 목록) 갯수 40
train_data에서 환자 단위로, train과 validation 나누기
기존 train_p_index 40
기존 (train) label_stat 40
train-vali 분할 후! 
train y 의 classes : {0, 1} valid y 의 classes : {0, 1} label_stat 의 classes : {0, 1}
train_p_index_ 26
valid_p_index 14
test_p_index 10
→ train 환자 ID 및 라벨:
   총 개수: 26
   환자ID=Control_Participant10, Label=0, 셀개수=1645
   환자ID=Control_Participant15, Label=0, 셀개수=528
   환자ID=COVID19_Participant17, Label=1, 셀개수=843
   환자ID=COVID19_Participant38, Label=1, 셀개수=51
   환자ID=COVID19_Participant10, Label=1, 셀개수=18
   환자ID=Control_Participant5, Label=0, 셀개수=717
   환자ID=COVID19_Participant13, Label=1, 셀개수=730
   환자ID=COVID19_Participant18, Label=1, 셀개수=227
   환자ID=COVID19_Participant40, Label=1, 셀개수=381
   환자ID=COVID19_Participant12, Label=1, 셀개수=102
   환자ID=COVID19_Participant19, Label=1, 셀개수=816
   환자ID=Control_Participant2, Label=0, 셀개수=41
   환자ID=COVID19_Participant27, Label=1, 셀개수=93
   환자ID=Control_Participant8, Label=0, 셀개수=393
   환자ID=Control_Participant7, Label=0, 셀개수=762
   환자ID=COVID19_Participant14, Label=1, 셀개수=382
   환자ID=Control_Participant9, Label=0, 셀개수=558
   환자ID=Control_Participant11, Label=0, 셀개수=1164
   환자ID=COVID19_Participant21, Label=1, 셀개수=39
   환자ID=COVID19_Participant30, Label=1, 셀개수=116
   환자ID=COVID19_Participant25, Label=1, 셀개수=496
   환자ID=COVID19_Participant15, Label=1, 셀개수=1003
   환자ID=COVID19_Participant7, Label=1, 셀개수=409
   환자ID=COVID19_Participant39, Label=1, 셀개수=454
   환자ID=COVID19_Participant37, Label=1, 셀개수=668
   환자ID=COVID19_Participant3, Label=1, 셀개수=104
→ valid 환자 ID 및 라벨:
   총 개수: 14
   환자ID=Control_Participant13, Label=0, 셀개수=88
   환자ID=COVID19_Participant29, Label=1, 셀개수=573
   환자ID=COVID19_Participant35, Label=1, 셀개수=83
   환자ID=COVID19_Participant31, Label=1, 셀개수=410
   환자ID=COVID19_Participant6, Label=1, 셀개수=84
   환자ID=COVID19_Participant2, Label=1, 셀개수=329
   환자ID=Control_Participant4, Label=0, 셀개수=440
   환자ID=Control_Participant1, Label=0, 셀개수=414
   환자ID=COVID19_Participant9, Label=1, 셀개수=86
   환자ID=COVID19_Participant8, Label=1, 셀개수=462
   환자ID=Control_Participant12, Label=0, 셀개수=99
   환자ID=COVID19_Participant36, Label=1, 셀개수=200
   환자ID=COVID19_Participant11, Label=1, 셀개수=382
   환자ID=COVID19_Participant23, Label=1, 셀개수=307
→ test 환자 ID 및 라벨:
   총 개수: 10
   환자ID=COVID19_Participant20, Label=1, 셀개수=2033
   환자ID=COVID19_Participant22, Label=1, 셀개수=865
   환자ID=COVID19_Participant26, Label=1, 셀개수=814
   환자ID=COVID19_Participant28, Label=1, 셀개수=1079
   환자ID=COVID19_Participant32, Label=1, 셀개수=1665
   환자ID=COVID19_Participant4, Label=1, 셀개수=1680
   환자ID=COVID19_Participant5, Label=1, 셀개수=89
   환자ID=Control_Participant14, Label=0, 셀개수=274
   환자ID=Control_Participant3, Label=0, 셀개수=1620
   환자ID=Control_Participant6, Label=0, 셀개수=131
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Keratinocytes', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Neurons', 'iPS_cells', 'Embryonic_stem_cells', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
전체 데이터 길이 26947
전체 cell type 길이 0           Keratinocytes
1        Epithelial_cells
2        Epithelial_cells
3        Epithelial_cells
4        Epithelial_cells
               ...       
26942    Epithelial_cells
26943    Epithelial_cells
26944          HSC_-G-CSF
26945    Epithelial_cells
26946    Epithelial_cells
Length: 26947, dtype: string
cell type의 NaN 개수 체크 0
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  2%|▏         | 2/100 [00:00<00:09, 10.13it/s]  4%|▍         | 4/100 [00:00<00:12,  7.95it/s]  6%|▌         | 6/100 [00:00<00:10,  8.79it/s]  8%|▊         | 8/100 [00:00<00:10,  8.87it/s]  9%|▉         | 9/100 [00:01<00:10,  8.35it/s] 11%|█         | 11/100 [00:01<00:10,  8.84it/s] 12%|█▏        | 12/100 [00:01<00:09,  9.06it/s] 13%|█▎        | 13/100 [00:01<00:10,  8.61it/s] 14%|█▍        | 14/100 [00:01<00:12,  6.75it/s] 16%|█▌        | 16/100 [00:01<00:10,  7.74it/s] 17%|█▋        | 17/100 [00:02<00:10,  7.79it/s] 18%|█▊        | 18/100 [00:02<00:10,  8.11it/s] 19%|█▉        | 19/100 [00:02<00:09,  8.28it/s] 21%|██        | 21/100 [00:02<00:09,  8.45it/s] 22%|██▏       | 22/100 [00:02<00:09,  8.53it/s] 23%|██▎       | 23/100 [00:02<00:09,  8.43it/s] 24%|██▍       | 24/100 [00:02<00:08,  8.78it/s] 25%|██▌       | 25/100 [00:02<00:08,  8.84it/s] 26%|██▌       | 26/100 [00:03<00:08,  8.59it/s] 27%|██▋       | 27/100 [00:03<00:09,  7.57it/s] 28%|██▊       | 28/100 [00:03<00:09,  7.27it/s] 30%|███       | 30/100 [00:03<00:08,  8.30it/s] 31%|███       | 31/100 [00:03<00:08,  8.40it/s] 32%|███▏      | 32/100 [00:03<00:08,  7.75it/s] 33%|███▎      | 33/100 [00:04<00:08,  7.64it/s] 34%|███▍      | 34/100 [00:04<00:09,  7.23it/s] 35%|███▌      | 35/100 [00:04<00:08,  7.42it/s] 36%|███▌      | 36/100 [00:04<00:08,  7.93it/s] 37%|███▋      | 37/100 [00:04<00:08,  7.24it/s] 38%|███▊      | 38/100 [00:04<00:08,  7.71it/s] 39%|███▉      | 39/100 [00:04<00:07,  8.15it/s] 40%|████      | 40/100 [00:04<00:07,  8.39it/s] 41%|████      | 41/100 [00:05<00:07,  8.24it/s] 42%|████▏     | 42/100 [00:05<00:06,  8.54it/s] 43%|████▎     | 43/100 [00:05<00:06,  8.63it/s] 44%|████▍     | 44/100 [00:05<00:06,  8.39it/s] 45%|████▌     | 45/100 [00:05<00:06,  8.76it/s] 46%|████▌     | 46/100 [00:05<00:06,  8.73it/s] 47%|████▋     | 47/100 [00:05<00:06,  8.58it/s] 48%|████▊     | 48/100 [00:05<00:06,  8.12it/s] 49%|████▉     | 49/100 [00:05<00:05,  8.58it/s] 50%|█████     | 50/100 [00:06<00:05,  8.33it/s] 51%|█████     | 51/100 [00:06<00:05,  8.33it/s] 52%|█████▏    | 52/100 [00:06<00:07,  6.06it/s] 53%|█████▎    | 53/100 [00:06<00:07,  6.45it/s] 55%|█████▌    | 55/100 [00:06<00:06,  7.12it/s] 56%|█████▌    | 56/100 [00:06<00:05,  7.44it/s] 57%|█████▋    | 57/100 [00:07<00:05,  7.42it/s] 59%|█████▉    | 59/100 [00:07<00:04,  8.31it/s] 60%|██████    | 60/100 [00:07<00:04,  8.29it/s] 61%|██████    | 61/100 [00:07<00:04,  8.48it/s] 62%|██████▏   | 62/100 [00:07<00:04,  8.35it/s] 63%|██████▎   | 63/100 [00:07<00:04,  8.70it/s] 64%|██████▍   | 64/100 [00:07<00:04,  8.83it/s] 65%|██████▌   | 65/100 [00:07<00:03,  8.92it/s] 66%|██████▌   | 66/100 [00:08<00:04,  8.40it/s] 68%|██████▊   | 68/100 [00:08<00:03,  8.95it/s] 70%|███████   | 70/100 [00:08<00:03,  9.49it/s] 71%|███████   | 71/100 [00:08<00:03,  9.48it/s] 72%|███████▏  | 72/100 [00:08<00:02,  9.59it/s] 73%|███████▎  | 73/100 [00:08<00:02,  9.23it/s] 75%|███████▌  | 75/100 [00:09<00:02,  9.39it/s] 76%|███████▌  | 76/100 [00:09<00:03,  7.86it/s] 77%|███████▋  | 77/100 [00:09<00:02,  7.89it/s] 78%|███████▊  | 78/100 [00:09<00:02,  8.15it/s] 79%|███████▉  | 79/100 [00:09<00:02,  8.38it/s] 80%|████████  | 80/100 [00:09<00:02,  8.20it/s] 81%|████████  | 81/100 [00:09<00:02,  8.10it/s] 82%|████████▏ | 82/100 [00:09<00:02,  8.03it/s] 83%|████████▎ | 83/100 [00:10<00:02,  8.30it/s] 85%|████████▌ | 85/100 [00:10<00:01,  8.73it/s] 86%|████████▌ | 86/100 [00:10<00:01,  8.63it/s] 88%|████████▊ | 88/100 [00:10<00:01,  8.98it/s] 89%|████████▉ | 89/100 [00:10<00:01,  8.88it/s] 90%|█████████ | 90/100 [00:10<00:01,  8.12it/s] 91%|█████████ | 91/100 [00:11<00:01,  8.31it/s] 92%|█████████▏| 92/100 [00:11<00:00,  8.37it/s] 93%|█████████▎| 93/100 [00:11<00:00,  8.33it/s] 94%|█████████▍| 94/100 [00:11<00:00,  8.27it/s] 95%|█████████▌| 95/100 [00:11<00:00,  7.61it/s] 96%|█████████▌| 96/100 [00:11<00:00,  7.85it/s] 97%|█████████▋| 97/100 [00:11<00:00,  7.48it/s] 98%|█████████▊| 98/100 [00:11<00:00,  7.98it/s] 99%|█████████▉| 99/100 [00:12<00:00,  7.98it/s]100%|██████████| 100/100 [00:12<00:00,  7.14it/s]100%|██████████| 100/100 [00:12<00:00,  8.19it/s]
[I 2025-08-31 19:42:04,875] A new study created in memory with name: no-name-27a258fc-737a-470d-a1c1-c19654b98765
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 25.64 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.603810, Valid_loss 0.598405
Epoch 2, Train Loss 0.584920, Valid_loss 0.587595
Epoch 3, Train Loss 0.533513, Valid_loss 0.465459
Epoch 4, Train Loss 0.411364, Valid_loss 0.380568
Epoch 5, Train Loss 0.310436, Valid_loss 0.396834
Epoch 6, Train Loss 0.361542, Valid_loss 0.395050
Epoch 7, Train Loss 0.294188, Valid_loss 0.466506
Epoch 8, Train Loss 0.280769, Valid_loss 0.443412
Epoch 9, Train Loss 0.233336, Valid_loss 0.433499
Epoch 10, Train Loss 0.232098, Valid_loss 0.447580
Epoch 11, Train Loss 0.237393, Valid_loss 0.427543
Epoch 12, Train Loss 0.235192, Valid_loss 0.478739
Epoch 13, Train Loss 0.222267, Valid_loss 0.444061
Epoch 14, Train Loss 0.216466, Valid_loss 0.443066
Epoch 15, Train Loss 0.225601, Valid_loss 0.447932
Epoch 16, Train Loss 0.241417, Valid_loss 0.416681
Epoch 17, Train Loss 0.216247, Valid_loss 0.460376
Epoch 18, Train Loss 0.212607, Valid_loss 0.400904
Epoch 19, Train Loss 0.199143, Valid_loss 0.379001
Epoch 20, Train Loss 0.190460, Valid_loss 0.403016
Epoch 21, Train Loss 0.183011, Valid_loss 0.350853
Epoch 22, Train Loss 0.181716, Valid_loss 0.387864
Epoch 23, Train Loss 0.199451, Valid_loss 0.333160
Epoch 24, Train Loss 0.195691, Valid_loss 0.351528
Epoch 25, Train Loss 0.188666, Valid_loss 0.343177
Epoch 26, Train Loss 0.191765, Valid_loss 0.367816
Epoch 27, Train Loss 0.188646, Valid_loss 0.356456
Epoch 28, Train Loss 0.182239, Valid_loss 0.360330
Epoch 29, Train Loss 0.184543, Valid_loss 0.373664
Epoch 30, Train Loss 0.206465, Valid_loss 0.387470
Epoch 31, Train Loss 0.183554, Valid_loss 0.317956
Epoch 32, Train Loss 0.167548, Valid_loss 0.294102
Epoch 33, Train Loss 0.166458, Valid_loss 0.276412
Epoch 34, Train Loss 0.170952, Valid_loss 0.343455
Epoch 35, Train Loss 0.188580, Valid_loss 0.288485
Epoch 36, Train Loss 0.204049, Valid_loss 0.351279
Epoch 37, Train Loss 0.199981, Valid_loss 0.339296
Epoch 38, Train Loss 0.197906, Valid_loss 0.430103
Epoch 39, Train Loss 0.185028, Valid_loss 0.352132
Epoch 40, Train Loss 0.181781, Valid_loss 0.317526
Epoch 41, Train Loss 0.169051, Valid_loss 0.344758
Epoch 42, Train Loss 0.172600, Valid_loss 0.343558
Epoch 43, Train Loss 0.161558, Valid_loss 0.324610
Epoch 44, Train Loss 0.160014, Valid_loss 0.313280
Epoch 45, Train Loss 0.161359, Valid_loss 0.290205
Epoch 46, Train Loss 0.171148, Valid_loss 0.293532
Epoch 47, Train Loss 0.163786, Valid_loss 0.280708
Epoch 48, Train Loss 0.158664, Valid_loss 0.283973
Epoch 49, Train Loss 0.169581, Valid_loss 0.300429
Epoch 50, Train Loss 0.164223, Valid_loss 0.317933
Epoch 51, Train Loss 0.154745, Valid_loss 0.276790
Epoch 52, Train Loss 0.154378, Valid_loss 0.292421
Epoch 53, Train Loss 0.154427, Valid_loss 0.292474
[I 2025-08-31 19:45:32,369] Trial 0 finished with value: 0.2764123278403921 and parameters: {'learning_rate': 0.01, 'epochs': 100, 'heads': 2, 'dropout': 0.0, 'weight_decay': 0.001, 'emb_dim': 8, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.2764123278403921.
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 25.64 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.837343, Valid_loss 0.671270
Epoch 2, Train Loss 0.731814, Valid_loss 0.647753
Epoch 3, Train Loss 0.676698, Valid_loss 0.621027
Epoch 4, Train Loss 0.676362, Valid_loss 0.605810
Epoch 5, Train Loss 0.652949, Valid_loss 0.600231
Epoch 6, Train Loss 0.604022, Valid_loss 0.584060
Epoch 7, Train Loss 0.615121, Valid_loss 0.573883
Epoch 8, Train Loss 0.626910, Valid_loss 0.555773
Epoch 9, Train Loss 0.592537, Valid_loss 0.561805
Epoch 10, Train Loss 0.597077, Valid_loss 0.548371
Epoch 11, Train Loss 0.534982, Valid_loss 0.528173
Epoch 12, Train Loss 0.529688, Valid_loss 0.530280
Epoch 13, Train Loss 0.517251, Valid_loss 0.520713
Epoch 14, Train Loss 0.517431, Valid_loss 0.515179
Epoch 15, Train Loss 0.471206, Valid_loss 0.512860
Epoch 16, Train Loss 0.508964, Valid_loss 0.523084
Epoch 17, Train Loss 0.536843, Valid_loss 0.514265
Epoch 18, Train Loss 0.532060, Valid_loss 0.500397
Epoch 19, Train Loss 0.485027, Valid_loss 0.493046
Epoch 20, Train Loss 0.502103, Valid_loss 0.497037
Epoch 21, Train Loss 0.504002, Valid_loss 0.522018
Epoch 22, Train Loss 0.491591, Valid_loss 0.479387
Epoch 23, Train Loss 0.462409, Valid_loss 0.463703
Epoch 24, Train Loss 0.492521, Valid_loss 0.467801
Epoch 25, Train Loss 0.443105, Valid_loss 0.462578
Epoch 26, Train Loss 0.428687, Valid_loss 0.482519
Epoch 27, Train Loss 0.472137, Valid_loss 0.445433
Epoch 28, Train Loss 0.433963, Valid_loss 0.461107
Epoch 29, Train Loss 0.408575, Valid_loss 0.503344
Epoch 30, Train Loss 0.498670, Valid_loss 0.594056
Epoch 31, Train Loss 0.520742, Valid_loss 0.536553
Epoch 32, Train Loss 0.461759, Valid_loss 0.486441
Epoch 33, Train Loss 0.439797, Valid_loss 0.463354
Epoch 34, Train Loss 0.451940, Valid_loss 0.479771
Epoch 35, Train Loss 0.398538, Valid_loss 0.496115
Epoch 36, Train Loss 0.455882, Valid_loss 0.474320
Epoch 37, Train Loss 0.465793, Valid_loss 0.476162
Epoch 38, Train Loss 0.392592, Valid_loss 0.518041
Epoch 39, Train Loss 0.434600, Valid_loss 0.514531
Epoch 40, Train Loss 0.442717, Valid_loss 0.466741
Epoch 41, Train Loss 0.463516, Valid_loss 0.471776
Epoch 42, Train Loss 0.429565, Valid_loss 0.468064
Epoch 43, Train Loss 0.426809, Valid_loss 0.471343
Epoch 44, Train Loss 0.392965, Valid_loss 0.485242
Epoch 45, Train Loss 0.429004, Valid_loss 0.472467
Epoch 46, Train Loss 0.412832, Valid_loss 0.497590
Epoch 47, Train Loss 0.410015, Valid_loss 0.545964
Epoch 48, Train Loss 0.432896, Valid_loss 0.545917
Epoch 49, Train Loss 0.407182, Valid_loss 0.479309
Epoch 50, Train Loss 0.392862, Valid_loss 0.484305
Epoch 51, Train Loss 0.401826, Valid_loss 0.463607
Epoch 52, Train Loss 0.418271, Valid_loss 0.472663
Epoch 53, Train Loss 0.379935, Valid_loss 0.485014
[I 2025-08-31 19:48:49,031] Trial 1 finished with value: 0.4454330365572657 and parameters: {'learning_rate': 0.001, 'epochs': 100, 'heads': 1, 'dropout': 0.7, 'weight_decay': 0.001, 'emb_dim': 8, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.2764123278403921.
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 26.96 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.593169, Valid_loss 0.539464
Epoch 2, Train Loss 0.462205, Valid_loss 0.498190
Epoch 3, Train Loss 0.355508, Valid_loss 0.454089
Epoch 4, Train Loss 0.308777, Valid_loss 0.435444
Epoch 5, Train Loss 0.283247, Valid_loss 0.438830
Epoch 6, Train Loss 0.270688, Valid_loss 0.440858
Epoch 7, Train Loss 0.266540, Valid_loss 0.563217
Epoch 8, Train Loss 0.266330, Valid_loss 0.583513
Epoch 9, Train Loss 0.250302, Valid_loss 0.535181
Epoch 10, Train Loss 0.247959, Valid_loss 0.547092
Epoch 11, Train Loss 0.227204, Valid_loss 0.487807
Epoch 12, Train Loss 0.245991, Valid_loss 0.474371
Epoch 13, Train Loss 0.219371, Valid_loss 0.525238
Epoch 14, Train Loss 0.221019, Valid_loss 0.420801
Epoch 15, Train Loss 0.222457, Valid_loss 0.395173
Epoch 16, Train Loss 0.233301, Valid_loss 0.438961
Epoch 17, Train Loss 0.215028, Valid_loss 0.461192
Epoch 18, Train Loss 0.227099, Valid_loss 0.407454
Epoch 19, Train Loss 0.207853, Valid_loss 0.418414
Epoch 20, Train Loss 0.202970, Valid_loss 0.414186
Epoch 21, Train Loss 0.193485, Valid_loss 0.428542
Epoch 22, Train Loss 0.196508, Valid_loss 0.437935
Epoch 23, Train Loss 0.202109, Valid_loss 0.430738
Epoch 24, Train Loss 0.205261, Valid_loss 0.408669
Epoch 25, Train Loss 0.195497, Valid_loss 0.414686
Epoch 26, Train Loss 0.208422, Valid_loss 0.406319
Epoch 27, Train Loss 0.193419, Valid_loss 0.431258
Epoch 28, Train Loss 0.194626, Valid_loss 0.394692
Epoch 29, Train Loss 0.202813, Valid_loss 0.405962
Epoch 30, Train Loss 0.186660, Valid_loss 0.421453
Epoch 31, Train Loss 0.191682, Valid_loss 0.448763
Epoch 32, Train Loss 0.193157, Valid_loss 0.415275
Epoch 33, Train Loss 0.181921, Valid_loss 0.402835
Epoch 34, Train Loss 0.186482, Valid_loss 0.416243
Epoch 35, Train Loss 0.175283, Valid_loss 0.414232
Epoch 36, Train Loss 0.182404, Valid_loss 0.423225
Epoch 37, Train Loss 0.177604, Valid_loss 0.446838
Epoch 38, Train Loss 0.174611, Valid_loss 0.457620
Epoch 39, Train Loss 0.166250, Valid_loss 0.441546
Epoch 40, Train Loss 0.167026, Valid_loss 0.428058
Epoch 41, Train Loss 0.174769, Valid_loss 0.429371
Epoch 42, Train Loss 0.177060, Valid_loss 0.411682
Epoch 43, Train Loss 0.176322, Valid_loss 0.422870
Epoch 44, Train Loss 0.167046, Valid_loss 0.431491
Epoch 45, Train Loss 0.168260, Valid_loss 0.392036
Epoch 46, Train Loss 0.169569, Valid_loss 0.465466
Epoch 47, Train Loss 0.165914, Valid_loss 0.445924
Epoch 48, Train Loss 0.163986, Valid_loss 0.480410
Epoch 49, Train Loss 0.170045, Valid_loss 0.445768
Epoch 50, Train Loss 0.159052, Valid_loss 0.410827
Epoch 51, Train Loss 0.160659, Valid_loss 0.430665
Epoch 52, Train Loss 0.158725, Valid_loss 0.415731
Epoch 53, Train Loss 0.162722, Valid_loss 0.427894
Epoch 54, Train Loss 0.160609, Valid_loss 0.424141
Epoch 55, Train Loss 0.159519, Valid_loss 0.442795
Epoch 56, Train Loss 0.163149, Valid_loss 0.477253
[I 2025-08-31 19:52:17,459] Trial 2 finished with value: 0.3920364105475268 and parameters: {'learning_rate': 0.001, 'epochs': 100, 'heads': 1, 'dropout': 0.3, 'weight_decay': 0.0001, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.2764123278403921.
선택된 trial params: {'learning_rate': 0.01, 'epochs': 100, 'heads': 2, 'dropout': 0.0, 'weight_decay': 0.001, 'emb_dim': 8, 'augment_num': 100, 'pca': False}
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=10, batch_size=1 -> steps=10
output_class :  1
Memory Allocated: 25.64 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.631771, Valid_loss 0.600928
Epoch 2, Train Loss 0.588728, Valid_loss 0.598283
Epoch 3, Train Loss 0.582570, Valid_loss 0.598296
Epoch 4, Train Loss 0.583057, Valid_loss 0.598299
Epoch 5, Train Loss 0.585651, Valid_loss 0.597135
Epoch 6, Train Loss 0.579730, Valid_loss 0.577941
Epoch 7, Train Loss 0.516978, Valid_loss 0.492627
Epoch 8, Train Loss 0.346998, Valid_loss 0.410080
Epoch 9, Train Loss 0.424994, Valid_loss 0.494937
Epoch 10, Train Loss 0.323042, Valid_loss 0.413218
Epoch 11, Train Loss 0.301959, Valid_loss 0.449659
Epoch 12, Train Loss 0.281420, Valid_loss 0.377774
Epoch 13, Train Loss 0.251027, Valid_loss 0.437222
Epoch 14, Train Loss 0.250435, Valid_loss 0.417372
Epoch 15, Train Loss 0.217023, Valid_loss 0.371120
Epoch 16, Train Loss 0.217385, Valid_loss 0.365741
Epoch 17, Train Loss 0.203882, Valid_loss 0.359376
Epoch 18, Train Loss 0.211064, Valid_loss 0.369397
Epoch 19, Train Loss 0.204222, Valid_loss 0.395810
Epoch 20, Train Loss 0.197394, Valid_loss 0.362463
Epoch 21, Train Loss 0.203805, Valid_loss 0.367820
Epoch 22, Train Loss 0.194228, Valid_loss 0.325225
Epoch 23, Train Loss 0.184658, Valid_loss 0.315537
Epoch 24, Train Loss 0.190584, Valid_loss 0.318570
Epoch 25, Train Loss 0.190350, Valid_loss 0.312208
Epoch 26, Train Loss 0.193196, Valid_loss 0.301386
Epoch 27, Train Loss 0.187968, Valid_loss 0.294358
Epoch 28, Train Loss 0.182141, Valid_loss 0.324603
Epoch 29, Train Loss 0.181024, Valid_loss 0.343958
Epoch 30, Train Loss 0.185914, Valid_loss 0.328131
Epoch 31, Train Loss 0.196738, Valid_loss 0.336311
Epoch 32, Train Loss 0.184441, Valid_loss 0.330517
Epoch 33, Train Loss 0.185068, Valid_loss 0.317036
Epoch 34, Train Loss 0.174255, Valid_loss 0.321837
Epoch 35, Train Loss 0.178459, Valid_loss 0.299952
Epoch 36, Train Loss 0.192420, Valid_loss 0.292671
Epoch 37, Train Loss 0.224104, Valid_loss 0.320714
Epoch 38, Train Loss 0.198831, Valid_loss 0.346452
Epoch 39, Train Loss 0.199720, Valid_loss 0.300598
Epoch 40, Train Loss 0.191609, Valid_loss 0.296889
Epoch 41, Train Loss 0.181457, Valid_loss 0.282509
Epoch 42, Train Loss 0.177336, Valid_loss 0.292137
Epoch 43, Train Loss 0.170490, Valid_loss 0.298019
Epoch 44, Train Loss 0.174431, Valid_loss 0.294001
Epoch 45, Train Loss 0.168176, Valid_loss 0.266916
Epoch 46, Train Loss 0.162731, Valid_loss 0.289492
Epoch 47, Train Loss 0.196122, Valid_loss 0.279636
Epoch 48, Train Loss 0.177803, Valid_loss 0.337055
Epoch 49, Train Loss 0.181715, Valid_loss 0.288710
Epoch 50, Train Loss 0.174170, Valid_loss 0.281089
Epoch 51, Train Loss 0.162596, Valid_loss 0.279843
Epoch 52, Train Loss 0.158465, Valid_loss 0.263051
Epoch 53, Train Loss 0.156610, Valid_loss 0.258280
Epoch 54, Train Loss 0.155618, Valid_loss 0.265978
Epoch 55, Train Loss 0.154441, Valid_loss 0.251138
Epoch 56, Train Loss 0.151775, Valid_loss 0.266776
Epoch 57, Train Loss 0.155296, Valid_loss 0.250659
Epoch 58, Train Loss 0.155600, Valid_loss 0.264315
Epoch 59, Train Loss 0.158874, Valid_loss 0.246028
Epoch 60, Train Loss 0.159182, Valid_loss 0.265759
Epoch 61, Train Loss 0.157832, Valid_loss 0.269566
환자ID=COVID19_Participant20 -- true: 1 -- pred: 1
환자ID=COVID19_Participant22 -- true: 1 -- pred: 1
환자ID=COVID19_Participant26 -- true: 1 -- pred: 1
환자ID=COVID19_Participant28 -- true: 1 -- pred: 1
환자ID=COVID19_Participant32 -- true: 1 -- pred: 0
환자ID=COVID19_Participant4 -- true: 1 -- pred: 1
환자ID=COVID19_Participant5 -- true: 1 -- pred: 1
환자ID=Control_Participant14 -- true: 0 -- pred: 0
환자ID=Control_Participant3 -- true: 0 -- pred: 0
환자ID=Control_Participant6 -- true: 0 -- pred: 0
Best performance: Epoch 59, Loss 0.158874, Test ACC 0.900000, Test AUC 1.000000, Test Recall 0.857143, Test Precision 1.000000
Confusion Matrix:
 [3 0 1 6]
✅ Total valid splits used: 4
🔁 Repeat 3, Fold 4
cell type :  TTGCGGTGACCA_COVID19_Participant31    Epithelial_cells
AGGCTCGAACTG_COVID19_Participant31    Epithelial_cells
TATCCGTATGTT_COVID19_Participant31             NK_cell
CAGACAGCGGCT_COVID19_Participant31    Epithelial_cells
CAAAGAGAACTA_COVID19_Participant31    Epithelial_cells
                                            ...       
GCAGGGAACTCC_COVID19_Participant30    Epithelial_cells
CAGCACCGAGCC_COVID19_Participant30    Epithelial_cells
GCCCCTTGTGAT_COVID19_Participant30    Epithelial_cells
GTGTTGTGTGTC_COVID19_Participant30              B_cell
TAACACTCACTT_COVID19_Participant30           Myelocyte
Name: singler_annotation, Length: 22635, dtype: string
cell type annotation :  TTGCGGTGACCA_COVID19_Participant31    Epithelial_cells
AGGCTCGAACTG_COVID19_Participant31    Epithelial_cells
TATCCGTATGTT_COVID19_Participant31             NK_cell
CAGACAGCGGCT_COVID19_Participant31    Epithelial_cells
CAAAGAGAACTA_COVID19_Participant31    Epithelial_cells
                                            ...       
GCAGGGAACTCC_COVID19_Participant30    Epithelial_cells
CAGCACCGAGCC_COVID19_Participant30    Epithelial_cells
GCCCCTTGTGAT_COVID19_Participant30    Epithelial_cells
GTGTTGTGTGTC_COVID19_Participant30              B_cell
TAACACTCACTT_COVID19_Participant30           Myelocyte
Name: singler_annotation, Length: 22635, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Epithelial_cells', 'NK_cell', 'Keratinocytes', 'Macrophage', 'Neurons', 'T_cells', 'Monocyte', 'Chondrocytes', 'MEP', 'Neutrophils', 'Gametocytes', 'Endothelial_cells', 'HSC_CD34+', 'Hepatocytes', 'Tissue_stem_cells', 'Erythroblast', 'iPS_cells', 'DC', 'B_cell', 'Myelocyte', 'Astrocyte', 'Smooth_muscle_cells', 'Embryonic_stem_cells', 'HSC_-G-CSF', 'CMP', 'Osteoblasts', 'Platelets', 'BM & Prog.', 'MSC', 'Neuroepithelial_cell', 'Pre-B_cell_CD34-', 'BM', 'GMP', 'Pro-B_cell_CD34+', 'Pro-Myelocyte', 'Fibroblasts', 'Unknown']
라벨별 그룹 개수 {1: 28, 0: 12}
cell type :  GTCGGGGGGTGG_Control_Participant7        Keratinocytes
CAAATCAATTAT_Control_Participant7     Epithelial_cells
ATACAATTGACA_Control_Participant7     Epithelial_cells
CTGTTAATGAGA_Control_Participant7     Epithelial_cells
CTTCACATTATT_Control_Participant7     Epithelial_cells
                                            ...       
ACCATATTCAGG_COVID19_Participant21       Keratinocytes
GCCCGTTTCACG_COVID19_Participant21    Epithelial_cells
TATTATCTCTTA_COVID19_Participant21    Epithelial_cells
TTCCGTTTGTCC_COVID19_Participant21    Epithelial_cells
TCGGGATTGGAT_COVID19_Participant21         Neutrophils
Name: singler_annotation, Length: 4312, dtype: string
cell type annotation :  GTCGGGGGGTGG_Control_Participant7        Keratinocytes
CAAATCAATTAT_Control_Participant7     Epithelial_cells
ATACAATTGACA_Control_Participant7     Epithelial_cells
CTGTTAATGAGA_Control_Participant7     Epithelial_cells
CTTCACATTATT_Control_Participant7     Epithelial_cells
                                            ...       
ACCATATTCAGG_COVID19_Participant21       Keratinocytes
GCCCGTTTCACG_COVID19_Participant21    Epithelial_cells
TATTATCTCTTA_COVID19_Participant21    Epithelial_cells
TTCCGTTTGTCC_COVID19_Participant21    Epithelial_cells
TCGGGATTGGAT_COVID19_Participant21         Neutrophils
Name: singler_annotation, Length: 4312, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Keratinocytes', 'Epithelial_cells', 'Neurons', 'iPS_cells', 'Embryonic_stem_cells', 'Astrocyte', 'DC', 'Gametocytes', 'HSC_-G-CSF', 'Smooth_muscle_cells', 'BM & Prog.', 'Monocyte', 'Myelocyte', 'BM', 'Endothelial_cells', 'Osteoblasts', 'Platelets', 'Erythroblast', 'NK_cell', 'T_cells', 'Chondrocytes', 'HSC_CD34+', 'CMP', 'Neutrophils', 'Fibroblasts', 'MEP', 'Neuroepithelial_cell', 'MSC', 'Pro-Myelocyte', 'B_cell', 'GMP', 'Hepatocytes', 'Macrophage', 'Tissue_stem_cells', 'Pre-B_cell_CD34-']
라벨별 그룹 개수 {1: 7, 0: 3}
🔍 Split #5
  → train_p_index 환자 수 (환자 단위로 묶인 index list): 40
  → test_p_index 환자 수  (환자 단위로 묶인 index list): 10
  → train 환자 ID: ['COVID19_Participant11', 'COVID19_Participant12', 'COVID19_Participant15', 'COVID19_Participant17', 'COVID19_Participant18', 'COVID19_Participant19', 'COVID19_Participant2', 'COVID19_Participant20', 'COVID19_Participant22', 'COVID19_Participant23', 'COVID19_Participant25', 'COVID19_Participant26', 'COVID19_Participant27', 'COVID19_Participant28', 'COVID19_Participant3', 'COVID19_Participant30', 'COVID19_Participant31', 'COVID19_Participant32', 'COVID19_Participant35', 'COVID19_Participant37', 'COVID19_Participant39', 'COVID19_Participant4', 'COVID19_Participant40', 'COVID19_Participant5', 'COVID19_Participant6', 'COVID19_Participant7', 'COVID19_Participant8', 'COVID19_Participant9', 'Control_Participant1', 'Control_Participant10', 'Control_Participant12', 'Control_Participant13', 'Control_Participant14', 'Control_Participant15', 'Control_Participant2', 'Control_Participant3', 'Control_Participant4', 'Control_Participant5', 'Control_Participant6', 'Control_Participant9']
  → test  환자 ID: ['COVID19_Participant10', 'COVID19_Participant13', 'COVID19_Participant14', 'COVID19_Participant21', 'COVID19_Participant29', 'COVID19_Participant36', 'COVID19_Participant38', 'Control_Participant11', 'Control_Participant7', 'Control_Participant8']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant12, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant18, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant27, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant3, Label: 1
    ID: COVID19_Participant30, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant35, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: COVID19_Participant5, Label: 1
    ID: COVID19_Participant6, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: COVID19_Participant9, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant10, Label: 0
    ID: Control_Participant12, Label: 0
    ID: Control_Participant13, Label: 0
    ID: Control_Participant14, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant2, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant4, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant6, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: COVID19_Participant10, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant21, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant36, Label: 1
    ID: COVID19_Participant38, Label: 1
    ID: Control_Participant11, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant8, Label: 0
전체 데이터 index 길이 50
label_stat (train 환자 라벨 목록) 갯수 40
train_data에서 환자 단위로, train과 validation 나누기
기존 train_p_index 40
기존 (train) label_stat 40
train-vali 분할 후! 
train y 의 classes : {0, 1} valid y 의 classes : {0, 1} label_stat 의 classes : {0, 1}
train_p_index_ 26
valid_p_index 14
test_p_index 10
→ train 환자 ID 및 라벨:
   총 개수: 26
   환자ID=Control_Participant10, Label=0, 셀개수=1645
   환자ID=Control_Participant15, Label=0, 셀개수=528
   환자ID=COVID19_Participant2, Label=1, 셀개수=329
   환자ID=COVID19_Participant4, Label=1, 셀개수=1680
   환자ID=COVID19_Participant11, Label=1, 셀개수=382
   환자ID=Control_Participant4, Label=0, 셀개수=440
   환자ID=COVID19_Participant17, Label=1, 셀개수=843
   환자ID=COVID19_Participant20, Label=1, 셀개수=2033
   환자ID=COVID19_Participant5, Label=1, 셀개수=89
   환자ID=COVID19_Participant15, Label=1, 셀개수=1003
   환자ID=COVID19_Participant22, Label=1, 셀개수=865
   환자ID=Control_Participant2, Label=0, 셀개수=41
   환자ID=COVID19_Participant28, Label=1, 셀개수=1079
   환자ID=Control_Participant6, Label=0, 셀개수=131
   환자ID=Control_Participant5, Label=0, 셀개수=717
   환자ID=COVID19_Participant18, Label=1, 셀개수=227
   환자ID=Control_Participant9, Label=0, 셀개수=558
   환자ID=Control_Participant12, Label=0, 셀개수=99
   환자ID=COVID19_Participant25, Label=1, 셀개수=496
   환자ID=COVID19_Participant31, Label=1, 셀개수=410
   환자ID=COVID19_Participant27, Label=1, 셀개수=93
   환자ID=COVID19_Participant19, Label=1, 셀개수=816
   환자ID=COVID19_Participant7, Label=1, 셀개수=409
   환자ID=COVID19_Participant40, Label=1, 셀개수=381
   환자ID=COVID19_Participant39, Label=1, 셀개수=454
   환자ID=COVID19_Participant30, Label=1, 셀개수=116
→ valid 환자 ID 및 라벨:
   총 개수: 14
   환자ID=Control_Participant14, Label=0, 셀개수=274
   환자ID=COVID19_Participant3, Label=1, 셀개수=104
   환자ID=COVID19_Participant35, Label=1, 셀개수=83
   환자ID=COVID19_Participant32, Label=1, 셀개수=1665
   환자ID=COVID19_Participant6, Label=1, 셀개수=84
   환자ID=COVID19_Participant23, Label=1, 셀개수=307
   환자ID=Control_Participant3, Label=0, 셀개수=1620
   환자ID=Control_Participant1, Label=0, 셀개수=414
   환자ID=COVID19_Participant9, Label=1, 셀개수=86
   환자ID=COVID19_Participant8, Label=1, 셀개수=462
   환자ID=Control_Participant13, Label=0, 셀개수=88
   환자ID=COVID19_Participant37, Label=1, 셀개수=668
   환자ID=COVID19_Participant12, Label=1, 셀개수=102
   환자ID=COVID19_Participant26, Label=1, 셀개수=814
→ test 환자 ID 및 라벨:
   총 개수: 10
   환자ID=COVID19_Participant10, Label=1, 셀개수=18
   환자ID=COVID19_Participant13, Label=1, 셀개수=730
   환자ID=COVID19_Participant14, Label=1, 셀개수=382
   환자ID=COVID19_Participant21, Label=1, 셀개수=39
   환자ID=COVID19_Participant29, Label=1, 셀개수=573
   환자ID=COVID19_Participant36, Label=1, 셀개수=200
   환자ID=COVID19_Participant38, Label=1, 셀개수=51
   환자ID=Control_Participant11, Label=0, 셀개수=1164
   환자ID=Control_Participant7, Label=0, 셀개수=762
   환자ID=Control_Participant8, Label=0, 셀개수=393
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Epithelial_cells', 'Epithelial_cells', 'NK_cell', 'Epithelial_cells', 'Epithelial_cells', 'Keratinocytes', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
전체 데이터 길이 26947
전체 cell type 길이 0        Epithelial_cells
1        Epithelial_cells
2                 NK_cell
3        Epithelial_cells
4        Epithelial_cells
               ...       
26942       Keratinocytes
26943    Epithelial_cells
26944    Epithelial_cells
26945    Epithelial_cells
26946         Neutrophils
Length: 26947, dtype: string
cell type의 NaN 개수 체크 0
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:10,  9.35it/s]  3%|▎         | 3/100 [00:00<00:09, 10.11it/s]  4%|▍         | 4/100 [00:00<00:11,  8.32it/s]  5%|▌         | 5/100 [00:00<00:11,  8.44it/s]  6%|▌         | 6/100 [00:00<00:10,  8.71it/s]  7%|▋         | 7/100 [00:00<00:12,  7.53it/s]  8%|▊         | 8/100 [00:00<00:11,  7.83it/s]  9%|▉         | 9/100 [00:01<00:11,  8.27it/s] 10%|█         | 10/100 [00:01<00:10,  8.36it/s] 11%|█         | 11/100 [00:01<00:10,  8.36it/s] 12%|█▏        | 12/100 [00:01<00:10,  8.51it/s] 13%|█▎        | 13/100 [00:01<00:10,  8.62it/s] 14%|█▍        | 14/100 [00:01<00:09,  8.73it/s] 15%|█▌        | 15/100 [00:01<00:09,  8.99it/s] 16%|█▌        | 16/100 [00:01<00:09,  9.10it/s] 17%|█▋        | 17/100 [00:01<00:09,  9.14it/s] 18%|█▊        | 18/100 [00:02<00:08,  9.24it/s] 19%|█▉        | 19/100 [00:02<00:10,  7.64it/s] 20%|██        | 20/100 [00:02<00:10,  7.96it/s] 21%|██        | 21/100 [00:02<00:09,  8.22it/s] 22%|██▏       | 22/100 [00:02<00:09,  8.43it/s] 23%|██▎       | 23/100 [00:02<00:09,  7.99it/s] 24%|██▍       | 24/100 [00:02<00:09,  7.87it/s] 25%|██▌       | 25/100 [00:03<00:10,  7.26it/s] 26%|██▌       | 26/100 [00:03<00:09,  7.88it/s] 27%|██▋       | 27/100 [00:03<00:09,  7.86it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.24it/s] 29%|██▉       | 29/100 [00:03<00:08,  8.23it/s] 30%|███       | 30/100 [00:03<00:08,  8.40it/s] 31%|███       | 31/100 [00:03<00:08,  8.61it/s] 32%|███▏      | 32/100 [00:03<00:07,  8.63it/s] 33%|███▎      | 33/100 [00:03<00:07,  8.67it/s] 34%|███▍      | 34/100 [00:04<00:07,  8.89it/s] 35%|███▌      | 35/100 [00:04<00:07,  8.27it/s] 36%|███▌      | 36/100 [00:04<00:07,  8.41it/s] 37%|███▋      | 37/100 [00:04<00:07,  8.39it/s] 38%|███▊      | 38/100 [00:04<00:07,  8.59it/s] 39%|███▉      | 39/100 [00:04<00:07,  8.35it/s] 40%|████      | 40/100 [00:04<00:07,  8.37it/s] 41%|████      | 41/100 [00:04<00:06,  8.60it/s] 42%|████▏     | 42/100 [00:04<00:06,  8.87it/s] 43%|████▎     | 43/100 [00:05<00:07,  8.12it/s] 44%|████▍     | 44/100 [00:05<00:06,  8.04it/s] 45%|████▌     | 45/100 [00:05<00:07,  7.07it/s] 46%|████▌     | 46/100 [00:05<00:07,  7.43it/s] 47%|████▋     | 47/100 [00:05<00:07,  7.49it/s] 48%|████▊     | 48/100 [00:05<00:06,  7.44it/s] 49%|████▉     | 49/100 [00:05<00:07,  6.93it/s] 50%|█████     | 50/100 [00:06<00:06,  7.20it/s] 51%|█████     | 51/100 [00:06<00:06,  7.44it/s] 52%|█████▏    | 52/100 [00:06<00:06,  7.79it/s] 53%|█████▎    | 53/100 [00:06<00:06,  7.20it/s] 54%|█████▍    | 54/100 [00:06<00:06,  7.56it/s] 55%|█████▌    | 55/100 [00:06<00:05,  7.84it/s] 56%|█████▌    | 56/100 [00:06<00:05,  7.86it/s] 57%|█████▋    | 57/100 [00:07<00:05,  7.81it/s] 58%|█████▊    | 58/100 [00:07<00:05,  7.61it/s] 59%|█████▉    | 59/100 [00:07<00:07,  5.47it/s] 60%|██████    | 60/100 [00:07<00:07,  5.40it/s] 61%|██████    | 61/100 [00:07<00:07,  5.56it/s] 62%|██████▏   | 62/100 [00:07<00:06,  6.05it/s] 63%|██████▎   | 63/100 [00:08<00:05,  6.59it/s] 64%|██████▍   | 64/100 [00:08<00:05,  6.86it/s] 65%|██████▌   | 65/100 [00:08<00:05,  6.68it/s] 66%|██████▌   | 66/100 [00:08<00:04,  7.15it/s] 67%|██████▋   | 67/100 [00:08<00:04,  7.35it/s] 68%|██████▊   | 68/100 [00:08<00:04,  7.57it/s] 69%|██████▉   | 69/100 [00:08<00:03,  7.85it/s] 70%|███████   | 70/100 [00:08<00:03,  8.17it/s] 71%|███████   | 71/100 [00:09<00:03,  7.36it/s] 72%|███████▏  | 72/100 [00:09<00:03,  7.53it/s] 73%|███████▎  | 73/100 [00:09<00:03,  7.54it/s] 74%|███████▍  | 74/100 [00:09<00:03,  7.63it/s] 75%|███████▌  | 75/100 [00:09<00:03,  7.70it/s] 76%|███████▌  | 76/100 [00:09<00:03,  7.59it/s] 77%|███████▋  | 77/100 [00:09<00:03,  7.62it/s] 78%|███████▊  | 78/100 [00:10<00:02,  7.51it/s] 79%|███████▉  | 79/100 [00:10<00:02,  7.61it/s] 80%|████████  | 80/100 [00:10<00:02,  7.75it/s] 81%|████████  | 81/100 [00:10<00:02,  7.41it/s] 82%|████████▏ | 82/100 [00:10<00:02,  7.76it/s] 83%|████████▎ | 83/100 [00:10<00:02,  7.71it/s] 84%|████████▍ | 84/100 [00:10<00:02,  7.77it/s] 85%|████████▌ | 85/100 [00:10<00:01,  7.95it/s] 86%|████████▌ | 86/100 [00:11<00:01,  8.13it/s] 87%|████████▋ | 87/100 [00:11<00:01,  7.94it/s] 88%|████████▊ | 88/100 [00:11<00:01,  8.22it/s] 89%|████████▉ | 89/100 [00:11<00:01,  7.26it/s] 90%|█████████ | 90/100 [00:11<00:01,  7.32it/s] 91%|█████████ | 91/100 [00:11<00:01,  5.88it/s] 92%|█████████▏| 92/100 [00:11<00:01,  6.09it/s] 93%|█████████▎| 93/100 [00:12<00:01,  6.50it/s] 94%|█████████▍| 94/100 [00:12<00:00,  7.05it/s] 95%|█████████▌| 95/100 [00:12<00:00,  7.33it/s] 96%|█████████▌| 96/100 [00:12<00:00,  7.63it/s] 97%|█████████▋| 97/100 [00:12<00:00,  7.65it/s] 98%|█████████▊| 98/100 [00:12<00:00,  7.50it/s] 99%|█████████▉| 99/100 [00:12<00:00,  7.66it/s]100%|██████████| 100/100 [00:13<00:00,  7.77it/s]100%|██████████| 100/100 [00:13<00:00,  7.69it/s]
[I 2025-08-31 19:56:36,637] A new study created in memory with name: no-name-61203854-f4cf-43c4-97af-dfdcd28976ee
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 26.96 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.643140, Valid_loss 0.589177
Epoch 2, Train Loss 0.589804, Valid_loss 0.547897
Epoch 3, Train Loss 0.550367, Valid_loss 0.508956
Epoch 4, Train Loss 0.518156, Valid_loss 0.463904
Epoch 5, Train Loss 0.478732, Valid_loss 0.424313
Epoch 6, Train Loss 0.442059, Valid_loss 0.406713
Epoch 7, Train Loss 0.424006, Valid_loss 0.405657
Epoch 8, Train Loss 0.407925, Valid_loss 0.397917
Epoch 9, Train Loss 0.389846, Valid_loss 0.384755
Epoch 10, Train Loss 0.413735, Valid_loss 0.380387
Epoch 11, Train Loss 0.392449, Valid_loss 0.382747
Epoch 12, Train Loss 0.391367, Valid_loss 0.370931
Epoch 13, Train Loss 0.385510, Valid_loss 0.362914
Epoch 14, Train Loss 0.375086, Valid_loss 0.354441
Epoch 15, Train Loss 0.381481, Valid_loss 0.354942
Epoch 16, Train Loss 0.370394, Valid_loss 0.352148
Epoch 17, Train Loss 0.371374, Valid_loss 0.349429
Epoch 18, Train Loss 0.362848, Valid_loss 0.351666
Epoch 19, Train Loss 0.357030, Valid_loss 0.341584
Epoch 20, Train Loss 0.345692, Valid_loss 0.334803
Epoch 21, Train Loss 0.344645, Valid_loss 0.334721
Epoch 22, Train Loss 0.351121, Valid_loss 0.335000
Epoch 23, Train Loss 0.352713, Valid_loss 0.337583
Epoch 24, Train Loss 0.334412, Valid_loss 0.340532
Epoch 25, Train Loss 0.337409, Valid_loss 0.335226
Epoch 26, Train Loss 0.328975, Valid_loss 0.338718
Epoch 27, Train Loss 0.312980, Valid_loss 0.334034
Epoch 28, Train Loss 0.329270, Valid_loss 0.322791
Epoch 29, Train Loss 0.331199, Valid_loss 0.313778
Epoch 30, Train Loss 0.328996, Valid_loss 0.316141
Epoch 31, Train Loss 0.320299, Valid_loss 0.318051
Epoch 32, Train Loss 0.310768, Valid_loss 0.319071
Epoch 33, Train Loss 0.317157, Valid_loss 0.334194
Epoch 34, Train Loss 0.323980, Valid_loss 0.318458
Epoch 35, Train Loss 0.315901, Valid_loss 0.318285
Epoch 36, Train Loss 0.309568, Valid_loss 0.321687
Epoch 37, Train Loss 0.314855, Valid_loss 0.313184
Epoch 38, Train Loss 0.314221, Valid_loss 0.311178
Epoch 39, Train Loss 0.322200, Valid_loss 0.323977
Epoch 40, Train Loss 0.320047, Valid_loss 0.321394
Epoch 41, Train Loss 0.307798, Valid_loss 0.311714
Epoch 42, Train Loss 0.300356, Valid_loss 0.317486
Epoch 43, Train Loss 0.306863, Valid_loss 0.318736
Epoch 44, Train Loss 0.299095, Valid_loss 0.326064
Epoch 45, Train Loss 0.307330, Valid_loss 0.318945
Epoch 46, Train Loss 0.293024, Valid_loss 0.313600
Epoch 47, Train Loss 0.302743, Valid_loss 0.307583
Epoch 48, Train Loss 0.300524, Valid_loss 0.301397
Epoch 49, Train Loss 0.306471, Valid_loss 0.305537
Epoch 50, Train Loss 0.297821, Valid_loss 0.308287
Epoch 51, Train Loss 0.308826, Valid_loss 0.307739
Epoch 52, Train Loss 0.299379, Valid_loss 0.302927
Epoch 53, Train Loss 0.297055, Valid_loss 0.308873
Epoch 54, Train Loss 0.299060, Valid_loss 0.303384
Epoch 55, Train Loss 0.284463, Valid_loss 0.305048
Epoch 56, Train Loss 0.284038, Valid_loss 0.306849
[I 2025-08-31 20:00:27,496] Trial 0 finished with value: 0.3013974188693932 and parameters: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 2, 'dropout': 0.3, 'weight_decay': 0.0001, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.3013974188693932.
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 26.96 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.651338, Valid_loss 0.608182
Epoch 2, Train Loss 0.614213, Valid_loss 0.595522
Epoch 3, Train Loss 0.579920, Valid_loss 0.774719
Epoch 4, Train Loss 0.486362, Valid_loss 0.470641
Epoch 5, Train Loss 0.362673, Valid_loss 0.547876
Epoch 6, Train Loss 0.304979, Valid_loss 0.475511
Epoch 7, Train Loss 0.335833, Valid_loss 0.499014
Epoch 8, Train Loss 0.283361, Valid_loss 0.626601
Epoch 9, Train Loss 0.298485, Valid_loss 0.625384
Epoch 10, Train Loss 0.330158, Valid_loss 0.330471
Epoch 11, Train Loss 0.261079, Valid_loss 0.809229
Epoch 12, Train Loss 0.248003, Valid_loss 0.426385
Epoch 13, Train Loss 0.232628, Valid_loss 0.458385
Epoch 14, Train Loss 0.221163, Valid_loss 0.507385
Epoch 15, Train Loss 0.218755, Valid_loss 0.565691
Epoch 16, Train Loss 0.218663, Valid_loss 0.540908
Epoch 17, Train Loss 0.208903, Valid_loss 0.429530
Epoch 18, Train Loss 0.204892, Valid_loss 0.515159
Epoch 19, Train Loss 0.206213, Valid_loss 0.527072
Epoch 20, Train Loss 0.202556, Valid_loss 0.427449
Epoch 21, Train Loss 0.197817, Valid_loss 0.468380
Epoch 22, Train Loss 0.199432, Valid_loss 0.413901
Epoch 23, Train Loss 0.201765, Valid_loss 0.485946
Epoch 24, Train Loss 0.205119, Valid_loss 0.490406
Epoch 25, Train Loss 0.202125, Valid_loss 0.492593
Epoch 26, Train Loss 0.198483, Valid_loss 0.437204
Epoch 27, Train Loss 0.199682, Valid_loss 0.482517
Epoch 28, Train Loss 0.198476, Valid_loss 0.634983
Epoch 29, Train Loss 0.211060, Valid_loss 0.630965
Epoch 30, Train Loss 0.215084, Valid_loss 0.544846
Epoch 31, Train Loss 0.221796, Valid_loss 0.484624
Epoch 32, Train Loss 0.209937, Valid_loss 0.544953
Epoch 33, Train Loss 0.205640, Valid_loss 0.545575
Epoch 34, Train Loss 0.202734, Valid_loss 0.516687
Epoch 35, Train Loss 0.203056, Valid_loss 0.450135
Epoch 36, Train Loss 0.200766, Valid_loss 0.499235
Epoch 37, Train Loss 0.196832, Valid_loss 0.451937
Epoch 38, Train Loss 0.198164, Valid_loss 0.436730
Epoch 39, Train Loss 0.197896, Valid_loss 0.434295
Epoch 40, Train Loss 0.197544, Valid_loss 0.397783
Epoch 41, Train Loss 0.200616, Valid_loss 0.426396
Epoch 42, Train Loss 0.197384, Valid_loss 0.414633
Epoch 43, Train Loss 0.200948, Valid_loss 0.372876
Epoch 44, Train Loss 0.207318, Valid_loss 0.452418
Epoch 45, Train Loss 0.204244, Valid_loss 0.493039
Epoch 46, Train Loss 0.204732, Valid_loss 0.401280
Epoch 47, Train Loss 0.204941, Valid_loss 0.487691
Epoch 48, Train Loss 0.239977, Valid_loss 0.485464
Epoch 49, Train Loss 0.236461, Valid_loss 0.471184
Epoch 50, Train Loss 0.224773, Valid_loss 0.738227
Epoch 51, Train Loss 0.213718, Valid_loss 0.630351
Epoch 52, Train Loss 0.202143, Valid_loss 0.624932
Epoch 53, Train Loss 0.207116, Valid_loss 0.616782
Epoch 54, Train Loss 0.200984, Valid_loss 0.650958
Epoch 55, Train Loss 0.198750, Valid_loss 0.569415
Epoch 56, Train Loss 0.196215, Valid_loss 0.538176
Epoch 57, Train Loss 0.196774, Valid_loss 0.637305
Epoch 58, Train Loss 0.197252, Valid_loss 0.626040
Epoch 59, Train Loss 0.196780, Valid_loss 0.599463
Epoch 60, Train Loss 0.192792, Valid_loss 0.630912
Epoch 61, Train Loss 0.191815, Valid_loss 0.579370
Epoch 62, Train Loss 0.192141, Valid_loss 0.547064
Epoch 63, Train Loss 0.193013, Valid_loss 0.544325
Epoch 64, Train Loss 0.192696, Valid_loss 0.546342
Epoch 65, Train Loss 0.192144, Valid_loss 0.525628
Epoch 66, Train Loss 0.195133, Valid_loss 0.525566
Epoch 67, Train Loss 0.196381, Valid_loss 0.498320
Epoch 68, Train Loss 0.193487, Valid_loss 0.547574
Epoch 69, Train Loss 0.193585, Valid_loss 0.481513
Epoch 70, Train Loss 0.194441, Valid_loss 0.459962
Epoch 71, Train Loss 0.193255, Valid_loss 0.467508
Epoch 72, Train Loss 0.191166, Valid_loss 0.450163
Epoch 73, Train Loss 0.195424, Valid_loss 0.473966
Epoch 74, Train Loss 0.193807, Valid_loss 0.445417
Epoch 75, Train Loss 0.193841, Valid_loss 0.417089
Epoch 76, Train Loss 0.200486, Valid_loss 0.431166
Epoch 77, Train Loss 0.199952, Valid_loss 0.492575
[I 2025-08-31 20:05:37,912] Trial 1 finished with value: 0.3304712668593441 and parameters: {'learning_rate': 0.01, 'epochs': 100, 'heads': 2, 'dropout': 0.0, 'weight_decay': 0.0001, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.3013974188693932.
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 25.64 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.625571, Valid_loss 0.562047
Epoch 2, Train Loss 0.564331, Valid_loss 0.525556
Epoch 3, Train Loss 0.543285, Valid_loss 0.503467
Epoch 4, Train Loss 0.513920, Valid_loss 0.485182
Epoch 5, Train Loss 0.523796, Valid_loss 0.464236
Epoch 6, Train Loss 0.490302, Valid_loss 0.445408
Epoch 7, Train Loss 0.478865, Valid_loss 0.441729
Epoch 8, Train Loss 0.449019, Valid_loss 0.429895
Epoch 9, Train Loss 0.465090, Valid_loss 0.424364
Epoch 10, Train Loss 0.444326, Valid_loss 0.417367
Epoch 11, Train Loss 0.458725, Valid_loss 0.412704
Epoch 12, Train Loss 0.455522, Valid_loss 0.422483
Epoch 13, Train Loss 0.452444, Valid_loss 0.401959
Epoch 14, Train Loss 0.444624, Valid_loss 0.389939
Epoch 15, Train Loss 0.428002, Valid_loss 0.400439
Epoch 16, Train Loss 0.419033, Valid_loss 0.379478
Epoch 17, Train Loss 0.427569, Valid_loss 0.367509
Epoch 18, Train Loss 0.434648, Valid_loss 0.428854
Epoch 19, Train Loss 0.448478, Valid_loss 0.397810
Epoch 20, Train Loss 0.428023, Valid_loss 0.390342
Epoch 21, Train Loss 0.434358, Valid_loss 0.387797
Epoch 22, Train Loss 0.425924, Valid_loss 0.361312
Epoch 23, Train Loss 0.405037, Valid_loss 0.390826
Epoch 24, Train Loss 0.395728, Valid_loss 0.370373
Epoch 25, Train Loss 0.376362, Valid_loss 0.362766
Epoch 26, Train Loss 0.375231, Valid_loss 0.323128
Epoch 27, Train Loss 0.392514, Valid_loss 0.360935
Epoch 28, Train Loss 0.402510, Valid_loss 0.368130
Epoch 29, Train Loss 0.384771, Valid_loss 0.360955
Epoch 30, Train Loss 0.393830, Valid_loss 0.345277
Epoch 31, Train Loss 0.396733, Valid_loss 0.358832
Epoch 32, Train Loss 0.369355, Valid_loss 0.365363
Epoch 33, Train Loss 0.366021, Valid_loss 0.381608
Epoch 34, Train Loss 0.361740, Valid_loss 0.351211
Epoch 35, Train Loss 0.345235, Valid_loss 0.341239
Epoch 36, Train Loss 0.360792, Valid_loss 0.345356
Epoch 37, Train Loss 0.368237, Valid_loss 0.353721
Epoch 38, Train Loss 0.358243, Valid_loss 0.384990
Epoch 39, Train Loss 0.363286, Valid_loss 0.381908
Epoch 40, Train Loss 0.342312, Valid_loss 0.331626
Epoch 41, Train Loss 0.323015, Valid_loss 0.321040
Epoch 42, Train Loss 0.336523, Valid_loss 0.321645
Epoch 43, Train Loss 0.337224, Valid_loss 0.310224
Epoch 44, Train Loss 0.297886, Valid_loss 0.336377
Epoch 45, Train Loss 0.342748, Valid_loss 0.298567
Epoch 46, Train Loss 0.320527, Valid_loss 0.319473
Epoch 47, Train Loss 0.300537, Valid_loss 0.324848
Epoch 48, Train Loss 0.324547, Valid_loss 0.335026
Epoch 49, Train Loss 0.313900, Valid_loss 0.332233
Epoch 50, Train Loss 0.296884, Valid_loss 0.315834
Epoch 51, Train Loss 0.291125, Valid_loss 0.314785
Epoch 52, Train Loss 0.306297, Valid_loss 0.303627
Epoch 53, Train Loss 0.308680, Valid_loss 0.304646
Epoch 54, Train Loss 0.293394, Valid_loss 0.303135
Epoch 55, Train Loss 0.300868, Valid_loss 0.305015
Epoch 56, Train Loss 0.281854, Valid_loss 0.293558
Epoch 57, Train Loss 0.283920, Valid_loss 0.292508
Epoch 58, Train Loss 0.309798, Valid_loss 0.298816
Epoch 59, Train Loss 0.308416, Valid_loss 0.307502
[I 2025-08-31 20:09:23,466] Trial 2 finished with value: 0.29250757209956646 and parameters: {'learning_rate': 0.001, 'epochs': 100, 'heads': 1, 'dropout': 0.3, 'weight_decay': 0.01, 'emb_dim': 8, 'augment_num': 100, 'pca': False}. Best is trial 2 with value: 0.29250757209956646.
선택된 trial params: {'learning_rate': 0.001, 'epochs': 100, 'heads': 1, 'dropout': 0.3, 'weight_decay': 0.01, 'emb_dim': 8, 'augment_num': 100, 'pca': False}
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=10, batch_size=1 -> steps=10
output_class :  1
Memory Allocated: 25.64 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.619693, Valid_loss 0.562784
Epoch 2, Train Loss 0.589733, Valid_loss 0.532013
Epoch 3, Train Loss 0.550830, Valid_loss 0.494705
Epoch 4, Train Loss 0.497796, Valid_loss 0.473092
Epoch 5, Train Loss 0.489270, Valid_loss 0.485256
Epoch 6, Train Loss 0.468207, Valid_loss 0.440822
Epoch 7, Train Loss 0.485993, Valid_loss 0.433956
Epoch 8, Train Loss 0.440802, Valid_loss 0.428358
Epoch 9, Train Loss 0.448064, Valid_loss 0.418938
Epoch 10, Train Loss 0.434797, Valid_loss 0.433449
Epoch 11, Train Loss 0.429864, Valid_loss 0.423805
Epoch 12, Train Loss 0.456834, Valid_loss 0.408047
Epoch 13, Train Loss 0.478879, Valid_loss 0.432307
Epoch 14, Train Loss 0.431178, Valid_loss 0.443140
Epoch 15, Train Loss 0.431876, Valid_loss 0.423345
Epoch 16, Train Loss 0.438829, Valid_loss 0.424385
Epoch 17, Train Loss 0.449138, Valid_loss 0.401608
Epoch 18, Train Loss 0.417262, Valid_loss 0.359254
Epoch 19, Train Loss 0.423500, Valid_loss 0.366389
Epoch 20, Train Loss 0.410014, Valid_loss 0.397126
Epoch 21, Train Loss 0.429692, Valid_loss 0.372420
Epoch 22, Train Loss 0.399335, Valid_loss 0.368065
Epoch 23, Train Loss 0.408330, Valid_loss 0.364692
Epoch 24, Train Loss 0.411210, Valid_loss 0.372078
Epoch 25, Train Loss 0.435845, Valid_loss 0.388530
Epoch 26, Train Loss 0.400580, Valid_loss 0.392648
Epoch 27, Train Loss 0.385598, Valid_loss 0.370069
Epoch 28, Train Loss 0.417408, Valid_loss 0.348086
Epoch 29, Train Loss 0.387113, Valid_loss 0.345772
Epoch 30, Train Loss 0.369091, Valid_loss 0.339684
Epoch 31, Train Loss 0.369377, Valid_loss 0.326593
Epoch 32, Train Loss 0.355623, Valid_loss 0.334028
Epoch 33, Train Loss 0.367087, Valid_loss 0.322771
Epoch 34, Train Loss 0.351432, Valid_loss 0.327393
Epoch 35, Train Loss 0.380491, Valid_loss 0.326525
Epoch 36, Train Loss 0.348941, Valid_loss 0.327600
Epoch 37, Train Loss 0.353047, Valid_loss 0.320663
Epoch 38, Train Loss 0.350348, Valid_loss 0.322505
Epoch 39, Train Loss 0.343357, Valid_loss 0.330338
Epoch 40, Train Loss 0.326725, Valid_loss 0.328468
Epoch 41, Train Loss 0.337375, Valid_loss 0.320903
Epoch 42, Train Loss 0.320424, Valid_loss 0.334196
Epoch 43, Train Loss 0.337692, Valid_loss 0.310037
Epoch 44, Train Loss 0.322174, Valid_loss 0.320881
Epoch 45, Train Loss 0.308434, Valid_loss 0.307747
Epoch 46, Train Loss 0.329470, Valid_loss 0.295566
Epoch 47, Train Loss 0.320471, Valid_loss 0.296917
Epoch 48, Train Loss 0.350652, Valid_loss 0.319908
Epoch 49, Train Loss 0.324472, Valid_loss 0.318014
Epoch 50, Train Loss 0.318769, Valid_loss 0.300021
Epoch 51, Train Loss 0.301939, Valid_loss 0.306901
Epoch 52, Train Loss 0.318953, Valid_loss 0.327142
환자ID=COVID19_Participant10 -- true: 1 -- pred: 0
환자ID=COVID19_Participant13 -- true: 1 -- pred: 1
환자ID=COVID19_Participant14 -- true: 1 -- pred: 1
환자ID=COVID19_Participant21 -- true: 1 -- pred: 1
환자ID=COVID19_Participant29 -- true: 1 -- pred: 1
환자ID=COVID19_Participant36 -- true: 1 -- pred: 1
환자ID=COVID19_Participant38 -- true: 1 -- pred: 1
환자ID=Control_Participant11 -- true: 0 -- pred: 1
환자ID=Control_Participant7 -- true: 0 -- pred: 0
환자ID=Control_Participant8 -- true: 0 -- pred: 1
Best performance: Epoch 46, Loss 0.329470, Test ACC 0.700000, Test AUC 0.761905, Test Recall 0.857143, Test Precision 0.750000
Confusion Matrix:
 [1 2 1 6]
✅ Total valid splits used: 5

📌 Repeat 3: 평균 AUC = 0.9143, 표준편차 = 0.0923
Test ACC 평균 0.800000, Test Recall 평균 0.885714, Test Precision 평균 0.861429
fold_aucs = [0.8571428571428571, 1.0, 0.9523809523809524, 1.0, 0.7619047619047619]
NaN 개수: 0 / 전체 5개

🔁 Repeat 4, Fold 0
cell type :  GTCGGGGGGTGG_Control_Participant7        Keratinocytes
CAAATCAATTAT_Control_Participant7     Epithelial_cells
ATACAATTGACA_Control_Participant7     Epithelial_cells
CTGTTAATGAGA_Control_Participant7     Epithelial_cells
CTTCACATTATT_Control_Participant7     Epithelial_cells
                                            ...       
ACCATATTCAGG_COVID19_Participant21       Keratinocytes
GCCCGTTTCACG_COVID19_Participant21    Epithelial_cells
TATTATCTCTTA_COVID19_Participant21    Epithelial_cells
TTCCGTTTGTCC_COVID19_Participant21    Epithelial_cells
TCGGGATTGGAT_COVID19_Participant21         Neutrophils
Name: singler_annotation, Length: 20178, dtype: string
cell type annotation :  GTCGGGGGGTGG_Control_Participant7        Keratinocytes
CAAATCAATTAT_Control_Participant7     Epithelial_cells
ATACAATTGACA_Control_Participant7     Epithelial_cells
CTGTTAATGAGA_Control_Participant7     Epithelial_cells
CTTCACATTATT_Control_Participant7     Epithelial_cells
                                            ...       
ACCATATTCAGG_COVID19_Participant21       Keratinocytes
GCCCGTTTCACG_COVID19_Participant21    Epithelial_cells
TATTATCTCTTA_COVID19_Participant21    Epithelial_cells
TTCCGTTTGTCC_COVID19_Participant21    Epithelial_cells
TCGGGATTGGAT_COVID19_Participant21         Neutrophils
Name: singler_annotation, Length: 20178, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Keratinocytes', 'Epithelial_cells', 'Neurons', 'iPS_cells', 'Embryonic_stem_cells', 'Astrocyte', 'DC', 'Gametocytes', 'HSC_-G-CSF', 'Smooth_muscle_cells', 'BM & Prog.', 'Monocyte', 'Myelocyte', 'BM', 'Endothelial_cells', 'Osteoblasts', 'Platelets', 'Erythroblast', 'NK_cell', 'T_cells', 'Chondrocytes', 'HSC_CD34+', 'CMP', 'Neutrophils', 'Fibroblasts', 'MEP', 'Neuroepithelial_cell', 'MSC', 'Pro-Myelocyte', 'B_cell', 'GMP', 'Hepatocytes', 'Macrophage', 'Tissue_stem_cells', 'Pre-B_cell_CD34-', 'Pro-B_cell_CD34+', 'Unknown']
라벨별 그룹 개수 {1: 28, 0: 12}
cell type :  TTGCGGTGACCA_COVID19_Participant31    Epithelial_cells
AGGCTCGAACTG_COVID19_Participant31    Epithelial_cells
TATCCGTATGTT_COVID19_Participant31             NK_cell
CAGACAGCGGCT_COVID19_Participant31    Epithelial_cells
CAAAGAGAACTA_COVID19_Participant31    Epithelial_cells
                                            ...       
GCAGGGAACTCC_COVID19_Participant30    Epithelial_cells
CAGCACCGAGCC_COVID19_Participant30    Epithelial_cells
GCCCCTTGTGAT_COVID19_Participant30    Epithelial_cells
GTGTTGTGTGTC_COVID19_Participant30              B_cell
TAACACTCACTT_COVID19_Participant30           Myelocyte
Name: singler_annotation, Length: 6769, dtype: string
cell type annotation :  TTGCGGTGACCA_COVID19_Participant31    Epithelial_cells
AGGCTCGAACTG_COVID19_Participant31    Epithelial_cells
TATCCGTATGTT_COVID19_Participant31             NK_cell
CAGACAGCGGCT_COVID19_Participant31    Epithelial_cells
CAAAGAGAACTA_COVID19_Participant31    Epithelial_cells
                                            ...       
GCAGGGAACTCC_COVID19_Participant30    Epithelial_cells
CAGCACCGAGCC_COVID19_Participant30    Epithelial_cells
GCCCCTTGTGAT_COVID19_Participant30    Epithelial_cells
GTGTTGTGTGTC_COVID19_Participant30              B_cell
TAACACTCACTT_COVID19_Participant30           Myelocyte
Name: singler_annotation, Length: 6769, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Epithelial_cells', 'NK_cell', 'Keratinocytes', 'Macrophage', 'Neurons', 'T_cells', 'Monocyte', 'Chondrocytes', 'MEP', 'Neutrophils', 'Gametocytes', 'Endothelial_cells', 'HSC_CD34+', 'Hepatocytes', 'Tissue_stem_cells', 'Erythroblast', 'iPS_cells', 'DC', 'B_cell', 'Myelocyte', 'Astrocyte', 'Smooth_muscle_cells', 'Embryonic_stem_cells', 'HSC_-G-CSF', 'CMP', 'Osteoblasts', 'Platelets', 'BM & Prog.', 'MSC', 'Neuroepithelial_cell', 'BM', 'Pre-B_cell_CD34-', 'Pro-B_cell_CD34+', 'Pro-Myelocyte', 'Fibroblasts', 'GMP', 'Unknown']
라벨별 그룹 개수 {1: 7, 0: 3}
🔍 Split #1
  → train_p_index 환자 수 (환자 단위로 묶인 index list): 40
  → test_p_index 환자 수  (환자 단위로 묶인 index list): 10
  → train 환자 ID: ['COVID19_Participant10', 'COVID19_Participant11', 'COVID19_Participant12', 'COVID19_Participant13', 'COVID19_Participant14', 'COVID19_Participant15', 'COVID19_Participant17', 'COVID19_Participant18', 'COVID19_Participant19', 'COVID19_Participant2', 'COVID19_Participant21', 'COVID19_Participant22', 'COVID19_Participant23', 'COVID19_Participant25', 'COVID19_Participant26', 'COVID19_Participant27', 'COVID19_Participant28', 'COVID19_Participant3', 'COVID19_Participant35', 'COVID19_Participant36', 'COVID19_Participant37', 'COVID19_Participant39', 'COVID19_Participant4', 'COVID19_Participant40', 'COVID19_Participant6', 'COVID19_Participant7', 'COVID19_Participant8', 'COVID19_Participant9', 'Control_Participant1', 'Control_Participant11', 'Control_Participant14', 'Control_Participant15', 'Control_Participant2', 'Control_Participant3', 'Control_Participant4', 'Control_Participant5', 'Control_Participant6', 'Control_Participant7', 'Control_Participant8', 'Control_Participant9']
  → test  환자 ID: ['COVID19_Participant20', 'COVID19_Participant29', 'COVID19_Participant30', 'COVID19_Participant31', 'COVID19_Participant32', 'COVID19_Participant38', 'COVID19_Participant5', 'Control_Participant10', 'Control_Participant12', 'Control_Participant13']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant10, Label: 1
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant12, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant18, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant21, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant27, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant3, Label: 1
    ID: COVID19_Participant35, Label: 1
    ID: COVID19_Participant36, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: COVID19_Participant6, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: COVID19_Participant9, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant14, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant2, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant4, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant6, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant8, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant30, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant38, Label: 1
    ID: COVID19_Participant5, Label: 1
    ID: Control_Participant10, Label: 0
    ID: Control_Participant12, Label: 0
    ID: Control_Participant13, Label: 0
전체 데이터 index 길이 50
label_stat (train 환자 라벨 목록) 갯수 40
train_data에서 환자 단위로, train과 validation 나누기
기존 train_p_index 40
기존 (train) label_stat 40
train-vali 분할 후! 
train y 의 classes : {0, 1} valid y 의 classes : {0, 1} label_stat 의 classes : {0, 1}
train_p_index_ 26
valid_p_index 14
test_p_index 10
→ train 환자 ID 및 라벨:
   총 개수: 26
   환자ID=Control_Participant11, Label=0, 셀개수=1164
   환자ID=Control_Participant3, Label=0, 셀개수=1620
   환자ID=COVID19_Participant17, Label=1, 셀개수=843
   환자ID=COVID19_Participant39, Label=1, 셀개수=454
   환자ID=COVID19_Participant10, Label=1, 셀개수=18
   환자ID=Control_Participant6, Label=0, 셀개수=131
   환자ID=COVID19_Participant13, Label=1, 셀개수=730
   환자ID=COVID19_Participant18, Label=1, 셀개수=227
   환자ID=COVID19_Participant40, Label=1, 셀개수=381
   환자ID=COVID19_Participant12, Label=1, 셀개수=102
   환자ID=COVID19_Participant19, Label=1, 셀개수=816
   환자ID=Control_Participant4, Label=0, 셀개수=440
   환자ID=COVID19_Participant25, Label=1, 셀개수=496
   환자ID=Control_Participant8, Label=0, 셀개수=393
   환자ID=Control_Participant7, Label=0, 셀개수=762
   환자ID=COVID19_Participant14, Label=1, 셀개수=382
   환자ID=Control_Participant9, Label=0, 셀개수=558
   환자ID=Control_Participant14, Label=0, 셀개수=274
   환자ID=COVID19_Participant21, Label=1, 셀개수=39
   환자ID=COVID19_Participant28, Label=1, 셀개수=1079
   환자ID=COVID19_Participant23, Label=1, 셀개수=307
   환자ID=COVID19_Participant15, Label=1, 셀개수=1003
   환자ID=COVID19_Participant7, Label=1, 셀개수=409
   환자ID=COVID19_Participant4, Label=1, 셀개수=1680
   환자ID=COVID19_Participant37, Label=1, 셀개수=668
   환자ID=COVID19_Participant27, Label=1, 셀개수=93
→ valid 환자 ID 및 라벨:
   총 개수: 14
   환자ID=Control_Participant2, Label=0, 셀개수=41
   환자ID=COVID19_Participant26, Label=1, 셀개수=814
   환자ID=COVID19_Participant35, Label=1, 셀개수=83
   환자ID=COVID19_Participant3, Label=1, 셀개수=104
   환자ID=COVID19_Participant6, Label=1, 셀개수=84
   환자ID=COVID19_Participant2, Label=1, 셀개수=329
   환자ID=Control_Participant5, Label=0, 셀개수=717
   환자ID=Control_Participant1, Label=0, 셀개수=414
   환자ID=COVID19_Participant9, Label=1, 셀개수=86
   환자ID=COVID19_Participant8, Label=1, 셀개수=462
   환자ID=Control_Participant15, Label=0, 셀개수=528
   환자ID=COVID19_Participant36, Label=1, 셀개수=200
   환자ID=COVID19_Participant11, Label=1, 셀개수=382
   환자ID=COVID19_Participant22, Label=1, 셀개수=865
→ test 환자 ID 및 라벨:
   총 개수: 10
   환자ID=COVID19_Participant20, Label=1, 셀개수=2033
   환자ID=COVID19_Participant29, Label=1, 셀개수=573
   환자ID=COVID19_Participant30, Label=1, 셀개수=116
   환자ID=COVID19_Participant31, Label=1, 셀개수=410
   환자ID=COVID19_Participant32, Label=1, 셀개수=1665
   환자ID=COVID19_Participant38, Label=1, 셀개수=51
   환자ID=COVID19_Participant5, Label=1, 셀개수=89
   환자ID=Control_Participant10, Label=0, 셀개수=1645
   환자ID=Control_Participant12, Label=0, 셀개수=99
   환자ID=Control_Participant13, Label=0, 셀개수=88
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Keratinocytes', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Neurons', 'iPS_cells', 'Embryonic_stem_cells', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
전체 데이터 길이 26947
전체 cell type 길이 0           Keratinocytes
1        Epithelial_cells
2        Epithelial_cells
3        Epithelial_cells
4        Epithelial_cells
               ...       
26942    Epithelial_cells
26943    Epithelial_cells
26944    Epithelial_cells
26945              B_cell
26946           Myelocyte
Length: 26947, dtype: string
cell type의 NaN 개수 체크 0
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:11,  8.59it/s]  2%|▏         | 2/100 [00:00<00:12,  8.12it/s]  3%|▎         | 3/100 [00:00<00:11,  8.49it/s]  5%|▌         | 5/100 [00:00<00:10,  9.30it/s]  6%|▌         | 6/100 [00:00<00:10,  9.22it/s]  7%|▋         | 7/100 [00:00<00:11,  8.35it/s]  8%|▊         | 8/100 [00:00<00:10,  8.38it/s] 10%|█         | 10/100 [00:01<00:13,  6.85it/s] 11%|█         | 11/100 [00:01<00:12,  7.35it/s] 12%|█▏        | 12/100 [00:01<00:11,  7.51it/s] 13%|█▎        | 13/100 [00:01<00:11,  7.78it/s] 14%|█▍        | 14/100 [00:01<00:10,  8.10it/s] 15%|█▌        | 15/100 [00:01<00:10,  8.20it/s] 16%|█▌        | 16/100 [00:01<00:10,  8.10it/s] 17%|█▋        | 17/100 [00:02<00:10,  8.00it/s] 18%|█▊        | 18/100 [00:02<00:09,  8.32it/s] 19%|█▉        | 19/100 [00:02<00:09,  8.23it/s] 20%|██        | 20/100 [00:02<00:09,  8.34it/s] 21%|██        | 21/100 [00:02<00:10,  7.49it/s] 22%|██▏       | 22/100 [00:02<00:10,  7.54it/s] 23%|██▎       | 23/100 [00:02<00:09,  7.91it/s] 24%|██▍       | 24/100 [00:02<00:09,  8.06it/s] 25%|██▌       | 25/100 [00:03<00:09,  8.11it/s] 26%|██▌       | 26/100 [00:03<00:08,  8.32it/s] 27%|██▋       | 27/100 [00:03<00:08,  8.52it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.28it/s] 29%|██▉       | 29/100 [00:03<00:08,  8.40it/s] 30%|███       | 30/100 [00:03<00:08,  8.60it/s] 31%|███       | 31/100 [00:03<00:08,  8.41it/s] 32%|███▏      | 32/100 [00:03<00:07,  8.57it/s] 33%|███▎      | 33/100 [00:04<00:07,  8.88it/s] 34%|███▍      | 34/100 [00:04<00:07,  8.65it/s] 35%|███▌      | 35/100 [00:04<00:07,  8.60it/s] 36%|███▌      | 36/100 [00:04<00:07,  8.82it/s] 37%|███▋      | 37/100 [00:04<00:07,  8.66it/s] 38%|███▊      | 38/100 [00:04<00:07,  8.69it/s] 39%|███▉      | 39/100 [00:04<00:07,  8.57it/s] 40%|████      | 40/100 [00:04<00:07,  8.31it/s] 41%|████      | 41/100 [00:04<00:07,  8.40it/s] 42%|████▏     | 42/100 [00:05<00:06,  8.36it/s] 43%|████▎     | 43/100 [00:05<00:06,  8.24it/s] 44%|████▍     | 44/100 [00:05<00:07,  7.68it/s] 45%|████▌     | 45/100 [00:05<00:06,  7.95it/s] 46%|████▌     | 46/100 [00:05<00:06,  7.87it/s] 47%|████▋     | 47/100 [00:05<00:06,  8.16it/s] 48%|████▊     | 48/100 [00:05<00:06,  8.49it/s] 49%|████▉     | 49/100 [00:05<00:05,  8.50it/s] 50%|█████     | 50/100 [00:06<00:05,  8.35it/s] 51%|█████     | 51/100 [00:06<00:05,  8.34it/s] 52%|█████▏    | 52/100 [00:06<00:05,  8.38it/s] 53%|█████▎    | 53/100 [00:06<00:05,  8.73it/s] 54%|█████▍    | 54/100 [00:06<00:05,  8.92it/s] 55%|█████▌    | 55/100 [00:06<00:05,  8.55it/s] 56%|█████▌    | 56/100 [00:06<00:05,  8.12it/s] 57%|█████▋    | 57/100 [00:06<00:05,  8.30it/s] 58%|█████▊    | 58/100 [00:07<00:04,  8.42it/s] 59%|█████▉    | 59/100 [00:07<00:04,  8.39it/s] 60%|██████    | 60/100 [00:07<00:04,  8.28it/s] 61%|██████    | 61/100 [00:07<00:05,  7.78it/s] 62%|██████▏   | 62/100 [00:07<00:04,  7.85it/s] 63%|██████▎   | 63/100 [00:07<00:04,  8.04it/s] 64%|██████▍   | 64/100 [00:07<00:04,  7.94it/s] 65%|██████▌   | 65/100 [00:07<00:04,  8.16it/s] 66%|██████▌   | 66/100 [00:08<00:04,  8.17it/s] 67%|██████▋   | 67/100 [00:08<00:04,  7.91it/s] 68%|██████▊   | 68/100 [00:08<00:04,  7.95it/s] 69%|██████▉   | 69/100 [00:08<00:03,  7.95it/s] 70%|███████   | 70/100 [00:08<00:04,  7.23it/s] 71%|███████   | 71/100 [00:08<00:03,  7.65it/s] 72%|███████▏  | 72/100 [00:08<00:03,  7.75it/s] 73%|███████▎  | 73/100 [00:08<00:03,  7.07it/s] 74%|███████▍  | 74/100 [00:09<00:03,  7.58it/s] 75%|███████▌  | 75/100 [00:09<00:03,  7.68it/s] 76%|███████▌  | 76/100 [00:09<00:02,  8.00it/s] 77%|███████▋  | 77/100 [00:09<00:02,  8.06it/s] 78%|███████▊  | 78/100 [00:09<00:02,  8.39it/s] 79%|███████▉  | 79/100 [00:09<00:02,  8.02it/s] 80%|████████  | 80/100 [00:09<00:02,  6.92it/s] 81%|████████  | 81/100 [00:10<00:02,  7.33it/s] 82%|████████▏ | 82/100 [00:10<00:02,  7.31it/s] 83%|████████▎ | 83/100 [00:10<00:02,  7.35it/s] 84%|████████▍ | 84/100 [00:10<00:02,  7.04it/s] 85%|████████▌ | 85/100 [00:10<00:02,  6.89it/s] 86%|████████▌ | 86/100 [00:10<00:01,  7.28it/s] 87%|████████▋ | 87/100 [00:10<00:01,  7.82it/s] 88%|████████▊ | 88/100 [00:10<00:01,  7.80it/s] 89%|████████▉ | 89/100 [00:11<00:01,  7.95it/s] 90%|█████████ | 90/100 [00:11<00:01,  7.60it/s] 91%|█████████ | 91/100 [00:11<00:01,  7.56it/s] 92%|█████████▏| 92/100 [00:11<00:01,  7.57it/s] 93%|█████████▎| 93/100 [00:11<00:00,  7.51it/s] 94%|█████████▍| 94/100 [00:11<00:00,  6.54it/s] 95%|█████████▌| 95/100 [00:11<00:00,  6.82it/s] 96%|█████████▌| 96/100 [00:12<00:00,  6.99it/s] 97%|█████████▋| 97/100 [00:12<00:00,  7.41it/s] 98%|█████████▊| 98/100 [00:12<00:00,  7.25it/s] 99%|█████████▉| 99/100 [00:12<00:00,  7.15it/s]100%|██████████| 100/100 [00:12<00:00,  7.54it/s]100%|██████████| 100/100 [00:12<00:00,  7.94it/s]
[I 2025-08-31 20:12:56,519] A new study created in memory with name: no-name-3abf3be2-8d2d-4e3c-9473-c7cccaf50789
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 29.04 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.584136, Valid_loss 0.461665
Epoch 2, Train Loss 0.424492, Valid_loss 0.331389
Epoch 3, Train Loss 0.347465, Valid_loss 0.368341
Epoch 4, Train Loss 0.323972, Valid_loss 0.350789
Epoch 5, Train Loss 0.299612, Valid_loss 0.300341
Epoch 6, Train Loss 0.293087, Valid_loss 0.325636
Epoch 7, Train Loss 0.263729, Valid_loss 0.372040
Epoch 8, Train Loss 0.266103, Valid_loss 0.424727
Epoch 9, Train Loss 0.263353, Valid_loss 0.432812
Epoch 10, Train Loss 0.279184, Valid_loss 0.345083
Epoch 11, Train Loss 0.289814, Valid_loss 0.372697
Epoch 12, Train Loss 0.315856, Valid_loss 0.297353
Epoch 13, Train Loss 0.268200, Valid_loss 0.307162
Epoch 14, Train Loss 0.250582, Valid_loss 0.329784
Epoch 15, Train Loss 0.247147, Valid_loss 0.346905
Epoch 16, Train Loss 0.245694, Valid_loss 0.317938
Epoch 17, Train Loss 0.247195, Valid_loss 0.325738
Epoch 18, Train Loss 0.239687, Valid_loss 0.317917
Epoch 19, Train Loss 0.233620, Valid_loss 0.368596
Epoch 20, Train Loss 0.255296, Valid_loss 0.307007
Epoch 21, Train Loss 0.244465, Valid_loss 0.354288
Epoch 22, Train Loss 0.234930, Valid_loss 0.321014
Epoch 23, Train Loss 0.240888, Valid_loss 0.352654
Epoch 24, Train Loss 0.230393, Valid_loss 0.336781
Epoch 25, Train Loss 0.230000, Valid_loss 0.386250
Epoch 26, Train Loss 0.230015, Valid_loss 0.325936
Epoch 27, Train Loss 0.232282, Valid_loss 0.336578
Epoch 28, Train Loss 0.227220, Valid_loss 0.365749
Epoch 29, Train Loss 0.231567, Valid_loss 0.400794
Epoch 30, Train Loss 0.225300, Valid_loss 0.426671
Epoch 31, Train Loss 0.230800, Valid_loss 0.489053
Epoch 32, Train Loss 0.224052, Valid_loss 0.394247
Epoch 33, Train Loss 0.264915, Valid_loss 0.307146
Epoch 34, Train Loss 0.225998, Valid_loss 0.337007
Epoch 35, Train Loss 0.227041, Valid_loss 0.438478
Epoch 36, Train Loss 0.226150, Valid_loss 0.407872
Epoch 37, Train Loss 0.214521, Valid_loss 0.397601
Epoch 38, Train Loss 0.216135, Valid_loss 0.420215
Epoch 39, Train Loss 0.215475, Valid_loss 0.530152
Epoch 40, Train Loss 0.215653, Valid_loss 0.404723
Epoch 41, Train Loss 0.222338, Valid_loss 0.473565
Epoch 42, Train Loss 0.224132, Valid_loss 0.453507
Epoch 43, Train Loss 0.209837, Valid_loss 0.460426
Epoch 44, Train Loss 0.211844, Valid_loss 0.431394
Epoch 45, Train Loss 0.205010, Valid_loss 0.485251
Epoch 46, Train Loss 0.210092, Valid_loss 0.378500
Epoch 47, Train Loss 0.216083, Valid_loss 0.457031
Epoch 48, Train Loss 0.211967, Valid_loss 0.450517
Epoch 49, Train Loss 0.213492, Valid_loss 0.418327
Epoch 50, Train Loss 0.222259, Valid_loss 0.492658
Epoch 51, Train Loss 0.210454, Valid_loss 0.461369
Epoch 52, Train Loss 0.211642, Valid_loss 0.385372
Epoch 53, Train Loss 0.203919, Valid_loss 0.389439
Epoch 54, Train Loss 0.204228, Valid_loss 0.472302
[I 2025-08-31 20:16:41,551] Trial 0 finished with value: 0.29735309816896915 and parameters: {'learning_rate': 0.001, 'epochs': 100, 'heads': 2, 'dropout': 0.3, 'weight_decay': 0.001, 'emb_dim': 64, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.29735309816896915.
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 29.04 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.721651, Valid_loss 0.585910
Epoch 2, Train Loss 0.611149, Valid_loss 0.548566
Epoch 3, Train Loss 0.568497, Valid_loss 0.515546
Epoch 4, Train Loss 0.542941, Valid_loss 0.467295
Epoch 5, Train Loss 0.489104, Valid_loss 0.418322
Epoch 6, Train Loss 0.451559, Valid_loss 0.381206
Epoch 7, Train Loss 0.428281, Valid_loss 0.372761
Epoch 8, Train Loss 0.433275, Valid_loss 0.356274
Epoch 9, Train Loss 0.409781, Valid_loss 0.340886
Epoch 10, Train Loss 0.423374, Valid_loss 0.349559
Epoch 11, Train Loss 0.410710, Valid_loss 0.348224
Epoch 12, Train Loss 0.387678, Valid_loss 0.345245
Epoch 13, Train Loss 0.405133, Valid_loss 0.350402
Epoch 14, Train Loss 0.363422, Valid_loss 0.343083
Epoch 15, Train Loss 0.404052, Valid_loss 0.354005
Epoch 16, Train Loss 0.360996, Valid_loss 0.335594
Epoch 17, Train Loss 0.361377, Valid_loss 0.364398
Epoch 18, Train Loss 0.356795, Valid_loss 0.341198
Epoch 19, Train Loss 0.369807, Valid_loss 0.353937
Epoch 20, Train Loss 0.373448, Valid_loss 0.345382
Epoch 21, Train Loss 0.364369, Valid_loss 0.366674
Epoch 22, Train Loss 0.351491, Valid_loss 0.364468
Epoch 23, Train Loss 0.352411, Valid_loss 0.337687
Epoch 24, Train Loss 0.366463, Valid_loss 0.405765
Epoch 25, Train Loss 0.356288, Valid_loss 0.337410
Epoch 26, Train Loss 0.361228, Valid_loss 0.359027
Epoch 27, Train Loss 0.350423, Valid_loss 0.331841
Epoch 28, Train Loss 0.348333, Valid_loss 0.388774
Epoch 29, Train Loss 0.363040, Valid_loss 0.341009
Epoch 30, Train Loss 0.322981, Valid_loss 0.383602
Epoch 31, Train Loss 0.331328, Valid_loss 0.356157
Epoch 32, Train Loss 0.330803, Valid_loss 0.357123
Epoch 33, Train Loss 0.345090, Valid_loss 0.347286
Epoch 34, Train Loss 0.317014, Valid_loss 0.400153
Epoch 35, Train Loss 0.338015, Valid_loss 0.379594
Epoch 36, Train Loss 0.360057, Valid_loss 0.354652
Epoch 37, Train Loss 0.325585, Valid_loss 0.359632
Epoch 38, Train Loss 0.326757, Valid_loss 0.385591
Epoch 39, Train Loss 0.328334, Valid_loss 0.379648
Epoch 40, Train Loss 0.333598, Valid_loss 0.385523
Epoch 41, Train Loss 0.325064, Valid_loss 0.357721
Epoch 42, Train Loss 0.338111, Valid_loss 0.377527
Epoch 43, Train Loss 0.309734, Valid_loss 0.380075
Epoch 44, Train Loss 0.321791, Valid_loss 0.367802
Epoch 45, Train Loss 0.316686, Valid_loss 0.420201
Epoch 46, Train Loss 0.309976, Valid_loss 0.367259
Epoch 47, Train Loss 0.301602, Valid_loss 0.421169
Epoch 48, Train Loss 0.323462, Valid_loss 0.373261
Epoch 49, Train Loss 0.314541, Valid_loss 0.399771
Epoch 50, Train Loss 0.318797, Valid_loss 0.384535
Epoch 51, Train Loss 0.304448, Valid_loss 0.418883
Epoch 52, Train Loss 0.318724, Valid_loss 0.391446
Epoch 53, Train Loss 0.287174, Valid_loss 0.401999
Epoch 54, Train Loss 0.326517, Valid_loss 0.392531
Epoch 55, Train Loss 0.292313, Valid_loss 0.388713
Epoch 56, Train Loss 0.289011, Valid_loss 0.405476
Epoch 57, Train Loss 0.288683, Valid_loss 0.414924
[I 2025-08-31 20:20:21,966] Trial 1 finished with value: 0.331840878618615 and parameters: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 1, 'dropout': 0.7, 'weight_decay': 0.0001, 'emb_dim': 64, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.29735309816896915.
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 26.96 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.617561, Valid_loss 0.580440
Epoch 2, Train Loss 0.571518, Valid_loss 0.521614
Epoch 3, Train Loss 0.522051, Valid_loss 0.465440
Epoch 4, Train Loss 0.496887, Valid_loss 0.409581
Epoch 5, Train Loss 0.445829, Valid_loss 0.398169
Epoch 6, Train Loss 0.418107, Valid_loss 0.365616
Epoch 7, Train Loss 0.390665, Valid_loss 0.389514
Epoch 8, Train Loss 0.406604, Valid_loss 0.379612
Epoch 9, Train Loss 0.398296, Valid_loss 0.380125
Epoch 10, Train Loss 0.383160, Valid_loss 0.379071
Epoch 11, Train Loss 0.391571, Valid_loss 0.387103
Epoch 12, Train Loss 0.371871, Valid_loss 0.362660
Epoch 13, Train Loss 0.368535, Valid_loss 0.358984
Epoch 14, Train Loss 0.379209, Valid_loss 0.361411
Epoch 15, Train Loss 0.378608, Valid_loss 0.386366
Epoch 16, Train Loss 0.365891, Valid_loss 0.364069
Epoch 17, Train Loss 0.343126, Valid_loss 0.384870
Epoch 18, Train Loss 0.378466, Valid_loss 0.411875
Epoch 19, Train Loss 0.350424, Valid_loss 0.388720
Epoch 20, Train Loss 0.361540, Valid_loss 0.356363
Epoch 21, Train Loss 0.359603, Valid_loss 0.392174
Epoch 22, Train Loss 0.345010, Valid_loss 0.385585
Epoch 23, Train Loss 0.358030, Valid_loss 0.368528
Epoch 24, Train Loss 0.356329, Valid_loss 0.341435
Epoch 25, Train Loss 0.351015, Valid_loss 0.393601
Epoch 26, Train Loss 0.345823, Valid_loss 0.365035
Epoch 27, Train Loss 0.339788, Valid_loss 0.399940
Epoch 28, Train Loss 0.331855, Valid_loss 0.343996
Epoch 29, Train Loss 0.331431, Valid_loss 0.372513
Epoch 30, Train Loss 0.342002, Valid_loss 0.397354
Epoch 31, Train Loss 0.331799, Valid_loss 0.360990
Epoch 32, Train Loss 0.334905, Valid_loss 0.390197
Epoch 33, Train Loss 0.327365, Valid_loss 0.369780
Epoch 34, Train Loss 0.327334, Valid_loss 0.360319
Epoch 35, Train Loss 0.319122, Valid_loss 0.375265
Epoch 36, Train Loss 0.306792, Valid_loss 0.383125
Epoch 37, Train Loss 0.321455, Valid_loss 0.374125
Epoch 38, Train Loss 0.323390, Valid_loss 0.376147
Epoch 39, Train Loss 0.320181, Valid_loss 0.408128
Epoch 40, Train Loss 0.308618, Valid_loss 0.393706
Epoch 41, Train Loss 0.302237, Valid_loss 0.361075
Epoch 42, Train Loss 0.325868, Valid_loss 0.411987
Epoch 43, Train Loss 0.306092, Valid_loss 0.375422
Epoch 44, Train Loss 0.318377, Valid_loss 0.390017
Epoch 45, Train Loss 0.309219, Valid_loss 0.403319
Epoch 46, Train Loss 0.306367, Valid_loss 0.394345
Epoch 47, Train Loss 0.313954, Valid_loss 0.370359
Epoch 48, Train Loss 0.293531, Valid_loss 0.402296
Epoch 49, Train Loss 0.291118, Valid_loss 0.392347
Epoch 50, Train Loss 0.298931, Valid_loss 0.389097
Epoch 51, Train Loss 0.297118, Valid_loss 0.382371
Epoch 52, Train Loss 0.294488, Valid_loss 0.378741
Epoch 53, Train Loss 0.297389, Valid_loss 0.377333
Epoch 54, Train Loss 0.304379, Valid_loss 0.393770
Epoch 55, Train Loss 0.302906, Valid_loss 0.411710
[I 2025-08-31 20:24:43,521] Trial 2 finished with value: 0.34143470068063053 and parameters: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 4, 'dropout': 0.3, 'weight_decay': 0.0001, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.29735309816896915.
선택된 trial params: {'learning_rate': 0.001, 'epochs': 100, 'heads': 2, 'dropout': 0.3, 'weight_decay': 0.001, 'emb_dim': 64, 'augment_num': 100, 'pca': False}
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=10, batch_size=1 -> steps=10
output_class :  1
Memory Allocated: 29.04 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.547244, Valid_loss 0.517639
Epoch 2, Train Loss 0.415688, Valid_loss 0.327137
Epoch 3, Train Loss 0.331099, Valid_loss 0.358669
Epoch 4, Train Loss 0.314847, Valid_loss 0.329779
Epoch 5, Train Loss 0.290069, Valid_loss 0.342466
Epoch 6, Train Loss 0.285057, Valid_loss 0.413597
Epoch 7, Train Loss 0.285007, Valid_loss 0.383535
Epoch 8, Train Loss 0.272393, Valid_loss 0.303100
Epoch 9, Train Loss 0.262650, Valid_loss 0.404935
Epoch 10, Train Loss 0.260953, Valid_loss 0.341684
Epoch 11, Train Loss 0.254732, Valid_loss 0.334071
Epoch 12, Train Loss 0.260533, Valid_loss 0.324477
Epoch 13, Train Loss 0.250434, Valid_loss 0.339950
Epoch 14, Train Loss 0.251515, Valid_loss 0.366741
Epoch 15, Train Loss 0.259456, Valid_loss 0.374000
Epoch 16, Train Loss 0.258495, Valid_loss 0.364753
Epoch 17, Train Loss 0.247371, Valid_loss 0.369129
Epoch 18, Train Loss 0.253235, Valid_loss 0.349006
Epoch 19, Train Loss 0.238388, Valid_loss 0.321324
Epoch 20, Train Loss 0.241699, Valid_loss 0.332663
Epoch 21, Train Loss 0.243483, Valid_loss 0.439255
Epoch 22, Train Loss 0.243677, Valid_loss 0.359791
Epoch 23, Train Loss 0.232066, Valid_loss 0.462410
Epoch 24, Train Loss 0.242339, Valid_loss 0.406961
Epoch 25, Train Loss 0.240629, Valid_loss 0.436304
Epoch 26, Train Loss 0.223580, Valid_loss 0.403670
Epoch 27, Train Loss 0.224413, Valid_loss 0.470781
Epoch 28, Train Loss 0.240830, Valid_loss 0.373875
Epoch 29, Train Loss 0.225082, Valid_loss 0.515934
Epoch 30, Train Loss 0.238680, Valid_loss 0.446966
Epoch 31, Train Loss 0.231373, Valid_loss 0.420516
Epoch 32, Train Loss 0.212546, Valid_loss 0.405211
Epoch 33, Train Loss 0.214459, Valid_loss 0.432353
Epoch 34, Train Loss 0.221270, Valid_loss 0.470778
Epoch 35, Train Loss 0.206546, Valid_loss 0.505218
Epoch 36, Train Loss 0.212599, Valid_loss 0.414398
Epoch 37, Train Loss 0.216608, Valid_loss 0.436124
Epoch 38, Train Loss 0.250138, Valid_loss 0.446563
Epoch 39, Train Loss 0.220507, Valid_loss 0.418729
Epoch 40, Train Loss 0.214046, Valid_loss 0.443001
Epoch 41, Train Loss 0.209367, Valid_loss 0.452242
Epoch 42, Train Loss 0.208834, Valid_loss 0.458677
Epoch 43, Train Loss 0.202443, Valid_loss 0.461270
Epoch 44, Train Loss 0.206292, Valid_loss 0.453004
Epoch 45, Train Loss 0.209435, Valid_loss 0.465555
Epoch 46, Train Loss 0.204653, Valid_loss 0.467760
Epoch 47, Train Loss 0.208503, Valid_loss 0.447753
Epoch 48, Train Loss 0.209355, Valid_loss 0.376587
Epoch 49, Train Loss 0.199910, Valid_loss 0.482612
Epoch 50, Train Loss 0.214238, Valid_loss 0.437726
Epoch 51, Train Loss 0.209036, Valid_loss 0.483404
Epoch 52, Train Loss 0.220847, Valid_loss 0.483842
환자ID=COVID19_Participant20 -- true: 1 -- pred: 1
환자ID=COVID19_Participant29 -- true: 1 -- pred: 1
환자ID=COVID19_Participant30 -- true: 1 -- pred: 1
환자ID=COVID19_Participant31 -- true: 1 -- pred: 0
환자ID=COVID19_Participant32 -- true: 1 -- pred: 0
환자ID=COVID19_Participant38 -- true: 1 -- pred: 0
환자ID=COVID19_Participant5 -- true: 1 -- pred: 0
환자ID=Control_Participant10 -- true: 0 -- pred: 0
환자ID=Control_Participant12 -- true: 0 -- pred: 0
환자ID=Control_Participant13 -- true: 0 -- pred: 0
Best performance: Epoch 8, Loss 0.272393, Test ACC 0.600000, Test AUC 0.952381, Test Recall 0.428571, Test Precision 1.000000
Confusion Matrix:
 [3 0 4 3]
✅ Total valid splits used: 1
🔁 Repeat 4, Fold 1
cell type :  GTCGGGGGGTGG_Control_Participant7        Keratinocytes
CAAATCAATTAT_Control_Participant7     Epithelial_cells
ATACAATTGACA_Control_Participant7     Epithelial_cells
CTGTTAATGAGA_Control_Participant7     Epithelial_cells
CTTCACATTATT_Control_Participant7     Epithelial_cells
                                            ...       
GCAGGGAACTCC_COVID19_Participant30    Epithelial_cells
CAGCACCGAGCC_COVID19_Participant30    Epithelial_cells
GCCCCTTGTGAT_COVID19_Participant30    Epithelial_cells
GTGTTGTGTGTC_COVID19_Participant30              B_cell
TAACACTCACTT_COVID19_Participant30           Myelocyte
Name: singler_annotation, Length: 23132, dtype: string
cell type annotation :  GTCGGGGGGTGG_Control_Participant7        Keratinocytes
CAAATCAATTAT_Control_Participant7     Epithelial_cells
ATACAATTGACA_Control_Participant7     Epithelial_cells
CTGTTAATGAGA_Control_Participant7     Epithelial_cells
CTTCACATTATT_Control_Participant7     Epithelial_cells
                                            ...       
GCAGGGAACTCC_COVID19_Participant30    Epithelial_cells
CAGCACCGAGCC_COVID19_Participant30    Epithelial_cells
GCCCCTTGTGAT_COVID19_Participant30    Epithelial_cells
GTGTTGTGTGTC_COVID19_Participant30              B_cell
TAACACTCACTT_COVID19_Participant30           Myelocyte
Name: singler_annotation, Length: 23132, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Keratinocytes', 'Epithelial_cells', 'Neurons', 'iPS_cells', 'Embryonic_stem_cells', 'Astrocyte', 'DC', 'Gametocytes', 'HSC_-G-CSF', 'Smooth_muscle_cells', 'BM & Prog.', 'Monocyte', 'Myelocyte', 'BM', 'Endothelial_cells', 'Osteoblasts', 'Platelets', 'Erythroblast', 'NK_cell', 'T_cells', 'Chondrocytes', 'HSC_CD34+', 'CMP', 'Neutrophils', 'Fibroblasts', 'MEP', 'Neuroepithelial_cell', 'MSC', 'Pro-Myelocyte', 'B_cell', 'GMP', 'Hepatocytes', 'Macrophage', 'Tissue_stem_cells', 'Pre-B_cell_CD34-', 'Pro-B_cell_CD34+', 'Unknown']
라벨별 그룹 개수 {1: 28, 0: 12}
cell type :  TGGGATTACAGG_Control_Participant5           Macrophage
CTGCGACGGCAC_Control_Participant5     Epithelial_cells
GGAATAAGTATC_Control_Participant5     Epithelial_cells
GACACGCCCTTA_Control_Participant5     Epithelial_cells
TTCAAGGTAGTC_Control_Participant5     Epithelial_cells
                                            ...       
TCTAGGTGTCTA_COVID19_Participant18       Keratinocytes
TAAAACTATATT_COVID19_Participant18    Epithelial_cells
ACACGGTAAGAC_COVID19_Participant18    Epithelial_cells
CACAAACCCACG_COVID19_Participant18       Keratinocytes
TTTCAAACTTCT_COVID19_Participant18    Epithelial_cells
Name: singler_annotation, Length: 3815, dtype: string
cell type annotation :  TGGGATTACAGG_Control_Participant5           Macrophage
CTGCGACGGCAC_Control_Participant5     Epithelial_cells
GGAATAAGTATC_Control_Participant5     Epithelial_cells
GACACGCCCTTA_Control_Participant5     Epithelial_cells
TTCAAGGTAGTC_Control_Participant5     Epithelial_cells
                                            ...       
TCTAGGTGTCTA_COVID19_Participant18       Keratinocytes
TAAAACTATATT_COVID19_Participant18    Epithelial_cells
ACACGGTAAGAC_COVID19_Participant18    Epithelial_cells
CACAAACCCACG_COVID19_Participant18       Keratinocytes
TTTCAAACTTCT_COVID19_Participant18    Epithelial_cells
Name: singler_annotation, Length: 3815, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Macrophage', 'Epithelial_cells', 'HSC_-G-CSF', 'Neurons', 'Neutrophils', 'T_cells', 'Gametocytes', 'Neuroepithelial_cell', 'NK_cell', 'BM & Prog.', 'Keratinocytes', 'DC', 'Astrocyte', 'Embryonic_stem_cells', 'CMP', 'Tissue_stem_cells', 'Smooth_muscle_cells', 'Erythroblast', 'Myelocyte', 'iPS_cells', 'Pre-B_cell_CD34-', 'Platelets', 'Monocyte', 'MEP', 'Hepatocytes', 'GMP', 'Chondrocytes', 'Pro-B_cell_CD34+', 'HSC_CD34+', 'Osteoblasts', 'B_cell', 'Endothelial_cells', 'Pro-Myelocyte', 'Fibroblasts', 'BM', 'MSC']
라벨별 그룹 개수 {1: 7, 0: 3}
🔍 Split #2
  → train_p_index 환자 수 (환자 단위로 묶인 index list): 40
  → test_p_index 환자 수  (환자 단위로 묶인 index list): 10
  → train 환자 ID: ['COVID19_Participant11', 'COVID19_Participant12', 'COVID19_Participant13', 'COVID19_Participant14', 'COVID19_Participant15', 'COVID19_Participant17', 'COVID19_Participant19', 'COVID19_Participant2', 'COVID19_Participant20', 'COVID19_Participant21', 'COVID19_Participant22', 'COVID19_Participant23', 'COVID19_Participant25', 'COVID19_Participant26', 'COVID19_Participant27', 'COVID19_Participant29', 'COVID19_Participant3', 'COVID19_Participant30', 'COVID19_Participant31', 'COVID19_Participant32', 'COVID19_Participant35', 'COVID19_Participant36', 'COVID19_Participant37', 'COVID19_Participant38', 'COVID19_Participant4', 'COVID19_Participant40', 'COVID19_Participant5', 'COVID19_Participant7', 'Control_Participant10', 'Control_Participant11', 'Control_Participant12', 'Control_Participant13', 'Control_Participant15', 'Control_Participant2', 'Control_Participant3', 'Control_Participant4', 'Control_Participant6', 'Control_Participant7', 'Control_Participant8', 'Control_Participant9']
  → test  환자 ID: ['COVID19_Participant10', 'COVID19_Participant18', 'COVID19_Participant28', 'COVID19_Participant39', 'COVID19_Participant6', 'COVID19_Participant8', 'COVID19_Participant9', 'Control_Participant1', 'Control_Participant14', 'Control_Participant5']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant12, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant21, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant27, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant3, Label: 1
    ID: COVID19_Participant30, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant35, Label: 1
    ID: COVID19_Participant36, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant38, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: COVID19_Participant5, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: Control_Participant10, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant12, Label: 0
    ID: Control_Participant13, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant2, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant4, Label: 0
    ID: Control_Participant6, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant8, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: COVID19_Participant10, Label: 1
    ID: COVID19_Participant18, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant6, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: COVID19_Participant9, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant14, Label: 0
    ID: Control_Participant5, Label: 0
전체 데이터 index 길이 50
label_stat (train 환자 라벨 목록) 갯수 40
train_data에서 환자 단위로, train과 validation 나누기
기존 train_p_index 40
기존 (train) label_stat 40
train-vali 분할 후! 
train y 의 classes : {0, 1} valid y 의 classes : {0, 1} label_stat 의 classes : {0, 1}
train_p_index_ 26
valid_p_index 14
test_p_index 10
→ train 환자 ID 및 라벨:
   총 개수: 26
   환자ID=Control_Participant11, Label=0, 셀개수=1164
   환자ID=Control_Participant2, Label=0, 셀개수=41
   환자ID=COVID19_Participant19, Label=1, 셀개수=816
   환자ID=COVID19_Participant36, Label=1, 셀개수=200
   환자ID=COVID19_Participant11, Label=1, 셀개수=382
   환자ID=Control_Participant6, Label=0, 셀개수=131
   환자ID=COVID19_Participant14, Label=1, 셀개수=382
   환자ID=COVID19_Participant2, Label=1, 셀개수=329
   환자ID=COVID19_Participant38, Label=1, 셀개수=51
   환자ID=COVID19_Participant13, Label=1, 셀개수=730
   환자ID=COVID19_Participant20, Label=1, 셀개수=2033
   환자ID=Control_Participant3, Label=0, 셀개수=1620
   환자ID=COVID19_Participant26, Label=1, 셀개수=814
   환자ID=Control_Participant8, Label=0, 셀개수=393
   환자ID=Control_Participant7, Label=0, 셀개수=762
   환자ID=COVID19_Participant15, Label=1, 셀개수=1003
   환자ID=Control_Participant9, Label=0, 셀개수=558
   환자ID=Control_Participant12, Label=0, 셀개수=99
   환자ID=COVID19_Participant22, Label=1, 셀개수=865
   환자ID=COVID19_Participant3, Label=1, 셀개수=104
   환자ID=COVID19_Participant25, Label=1, 셀개수=496
   환자ID=COVID19_Participant17, Label=1, 셀개수=843
   환자ID=COVID19_Participant40, Label=1, 셀개수=381
   환자ID=COVID19_Participant37, Label=1, 셀개수=668
   환자ID=COVID19_Participant35, Label=1, 셀개수=83
   환자ID=COVID19_Participant29, Label=1, 셀개수=573
→ valid 환자 ID 및 라벨:
   총 개수: 14
   환자ID=Control_Participant15, Label=0, 셀개수=528
   환자ID=COVID19_Participant27, Label=1, 셀개수=93
   환자ID=COVID19_Participant31, Label=1, 셀개수=410
   환자ID=COVID19_Participant30, Label=1, 셀개수=116
   환자ID=COVID19_Participant4, Label=1, 셀개수=1680
   환자ID=COVID19_Participant21, Label=1, 셀개수=39
   환자ID=Control_Participant4, Label=0, 셀개수=440
   환자ID=Control_Participant10, Label=0, 셀개수=1645
   환자ID=COVID19_Participant7, Label=1, 셀개수=409
   환자ID=COVID19_Participant5, Label=1, 셀개수=89
   환자ID=Control_Participant13, Label=0, 셀개수=88
   환자ID=COVID19_Participant32, Label=1, 셀개수=1665
   환자ID=COVID19_Participant12, Label=1, 셀개수=102
   환자ID=COVID19_Participant23, Label=1, 셀개수=307
→ test 환자 ID 및 라벨:
   총 개수: 10
   환자ID=COVID19_Participant10, Label=1, 셀개수=18
   환자ID=COVID19_Participant18, Label=1, 셀개수=227
   환자ID=COVID19_Participant28, Label=1, 셀개수=1079
   환자ID=COVID19_Participant39, Label=1, 셀개수=454
   환자ID=COVID19_Participant6, Label=1, 셀개수=84
   환자ID=COVID19_Participant8, Label=1, 셀개수=462
   환자ID=COVID19_Participant9, Label=1, 셀개수=86
   환자ID=Control_Participant1, Label=0, 셀개수=414
   환자ID=Control_Participant14, Label=0, 셀개수=274
   환자ID=Control_Participant5, Label=0, 셀개수=717
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Keratinocytes', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Neurons', 'iPS_cells', 'Embryonic_stem_cells', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
전체 데이터 길이 26947
전체 cell type 길이 0           Keratinocytes
1        Epithelial_cells
2        Epithelial_cells
3        Epithelial_cells
4        Epithelial_cells
               ...       
26942       Keratinocytes
26943    Epithelial_cells
26944    Epithelial_cells
26945       Keratinocytes
26946    Epithelial_cells
Length: 26947, dtype: string
cell type의 NaN 개수 체크 0
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:10,  9.58it/s]  2%|▏         | 2/100 [00:00<00:10,  8.99it/s]  3%|▎         | 3/100 [00:00<00:12,  7.81it/s]  4%|▍         | 4/100 [00:00<00:12,  7.95it/s]  5%|▌         | 5/100 [00:00<00:12,  7.61it/s]  6%|▌         | 6/100 [00:00<00:11,  8.05it/s]  7%|▋         | 7/100 [00:00<00:10,  8.49it/s]  8%|▊         | 8/100 [00:00<00:10,  8.46it/s]  9%|▉         | 9/100 [00:01<00:10,  8.47it/s] 10%|█         | 10/100 [00:01<00:10,  8.64it/s] 11%|█         | 11/100 [00:01<00:10,  8.67it/s] 13%|█▎        | 13/100 [00:01<00:09,  9.25it/s] 14%|█▍        | 14/100 [00:01<00:09,  9.24it/s] 15%|█▌        | 15/100 [00:01<00:09,  9.41it/s] 16%|█▌        | 16/100 [00:01<00:09,  9.03it/s] 17%|█▋        | 17/100 [00:01<00:09,  9.05it/s] 18%|█▊        | 18/100 [00:02<00:09,  9.10it/s] 19%|█▉        | 19/100 [00:02<00:09,  8.90it/s] 20%|██        | 20/100 [00:02<00:08,  8.94it/s] 21%|██        | 21/100 [00:02<00:09,  8.40it/s] 22%|██▏       | 22/100 [00:02<00:09,  8.21it/s] 23%|██▎       | 23/100 [00:02<00:09,  8.34it/s] 24%|██▍       | 24/100 [00:02<00:08,  8.69it/s] 25%|██▌       | 25/100 [00:02<00:09,  7.63it/s] 26%|██▌       | 26/100 [00:03<00:09,  8.19it/s] 27%|██▋       | 27/100 [00:03<00:08,  8.46it/s] 28%|██▊       | 28/100 [00:03<00:09,  7.77it/s] 29%|██▉       | 29/100 [00:03<00:09,  7.82it/s] 30%|███       | 30/100 [00:03<00:09,  7.78it/s] 31%|███       | 31/100 [00:03<00:08,  8.18it/s] 32%|███▏      | 32/100 [00:03<00:08,  8.21it/s] 33%|███▎      | 33/100 [00:03<00:08,  8.20it/s] 34%|███▍      | 34/100 [00:04<00:08,  8.21it/s] 35%|███▌      | 35/100 [00:04<00:07,  8.40it/s] 36%|███▌      | 36/100 [00:04<00:08,  7.77it/s] 37%|███▋      | 37/100 [00:04<00:08,  7.87it/s] 38%|███▊      | 38/100 [00:04<00:07,  7.89it/s] 39%|███▉      | 39/100 [00:04<00:07,  8.00it/s] 40%|████      | 40/100 [00:04<00:07,  8.18it/s] 41%|████      | 41/100 [00:04<00:07,  8.18it/s] 42%|████▏     | 42/100 [00:05<00:07,  8.21it/s] 43%|████▎     | 43/100 [00:05<00:06,  8.39it/s] 44%|████▍     | 44/100 [00:05<00:06,  8.26it/s] 45%|████▌     | 45/100 [00:05<00:06,  7.96it/s] 46%|████▌     | 46/100 [00:05<00:06,  8.11it/s] 47%|████▋     | 47/100 [00:05<00:06,  8.03it/s] 48%|████▊     | 48/100 [00:05<00:06,  8.35it/s] 49%|████▉     | 49/100 [00:05<00:06,  7.94it/s] 50%|█████     | 50/100 [00:06<00:06,  8.08it/s] 51%|█████     | 51/100 [00:06<00:05,  8.18it/s] 52%|█████▏    | 52/100 [00:06<00:06,  8.00it/s] 53%|█████▎    | 53/100 [00:06<00:05,  7.98it/s] 54%|█████▍    | 54/100 [00:06<00:05,  8.11it/s] 55%|█████▌    | 55/100 [00:06<00:06,  6.73it/s] 56%|█████▌    | 56/100 [00:06<00:06,  7.09it/s] 57%|█████▋    | 57/100 [00:06<00:05,  7.34it/s] 58%|█████▊    | 58/100 [00:07<00:05,  7.51it/s] 59%|█████▉    | 59/100 [00:07<00:05,  7.85it/s] 60%|██████    | 60/100 [00:07<00:05,  7.95it/s] 61%|██████    | 61/100 [00:07<00:04,  8.00it/s] 62%|██████▏   | 62/100 [00:07<00:04,  7.97it/s] 63%|██████▎   | 63/100 [00:07<00:04,  7.78it/s] 64%|██████▍   | 64/100 [00:07<00:04,  7.84it/s] 65%|██████▌   | 65/100 [00:07<00:04,  8.34it/s] 66%|██████▌   | 66/100 [00:08<00:04,  7.85it/s] 67%|██████▋   | 67/100 [00:08<00:04,  7.81it/s] 68%|██████▊   | 68/100 [00:08<00:04,  7.86it/s] 69%|██████▉   | 69/100 [00:08<00:03,  7.84it/s] 70%|███████   | 70/100 [00:08<00:03,  7.77it/s] 71%|███████   | 71/100 [00:08<00:03,  8.16it/s] 72%|███████▏  | 72/100 [00:08<00:03,  7.59it/s] 73%|███████▎  | 73/100 [00:08<00:03,  7.56it/s] 74%|███████▍  | 74/100 [00:09<00:03,  7.75it/s] 75%|███████▌  | 75/100 [00:09<00:03,  7.22it/s] 76%|███████▌  | 76/100 [00:09<00:03,  7.50it/s] 77%|███████▋  | 77/100 [00:09<00:03,  7.12it/s] 78%|███████▊  | 78/100 [00:09<00:02,  7.44it/s] 79%|███████▉  | 79/100 [00:09<00:02,  7.63it/s] 80%|████████  | 80/100 [00:09<00:02,  7.67it/s] 81%|████████  | 81/100 [00:10<00:02,  7.52it/s] 82%|████████▏ | 82/100 [00:10<00:02,  7.46it/s] 83%|████████▎ | 83/100 [00:10<00:02,  7.55it/s] 84%|████████▍ | 84/100 [00:10<00:02,  7.71it/s] 85%|████████▌ | 85/100 [00:10<00:01,  7.53it/s] 86%|████████▌ | 86/100 [00:10<00:01,  7.59it/s] 87%|████████▋ | 87/100 [00:10<00:01,  7.41it/s] 88%|████████▊ | 88/100 [00:11<00:01,  6.99it/s] 89%|████████▉ | 89/100 [00:11<00:01,  7.29it/s] 90%|█████████ | 90/100 [00:11<00:01,  7.60it/s] 91%|█████████ | 91/100 [00:11<00:01,  7.82it/s] 92%|█████████▏| 92/100 [00:11<00:01,  7.72it/s] 93%|█████████▎| 93/100 [00:11<00:00,  7.61it/s] 94%|█████████▍| 94/100 [00:11<00:00,  7.75it/s] 95%|█████████▌| 95/100 [00:11<00:00,  7.49it/s] 96%|█████████▌| 96/100 [00:12<00:00,  7.24it/s] 97%|█████████▋| 97/100 [00:12<00:00,  7.46it/s] 98%|█████████▊| 98/100 [00:12<00:00,  7.45it/s] 99%|█████████▉| 99/100 [00:12<00:00,  7.12it/s]100%|██████████| 100/100 [00:12<00:00,  7.16it/s]100%|██████████| 100/100 [00:12<00:00,  7.92it/s]
[I 2025-08-31 20:28:35,141] A new study created in memory with name: no-name-8dba9cc6-09de-4213-91ec-5c6c9b2e3d54
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 25.64 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.672314, Valid_loss 0.659092
Epoch 2, Train Loss 0.691066, Valid_loss 0.652004
Epoch 3, Train Loss 0.656426, Valid_loss 0.648782
Epoch 4, Train Loss 0.695912, Valid_loss 0.646389
Epoch 5, Train Loss 0.679413, Valid_loss 0.644533
Epoch 6, Train Loss 0.683765, Valid_loss 0.642277
Epoch 7, Train Loss 0.677287, Valid_loss 0.638933
Epoch 8, Train Loss 0.685980, Valid_loss 0.636177
Epoch 9, Train Loss 0.643403, Valid_loss 0.635160
Epoch 10, Train Loss 0.650993, Valid_loss 0.631086
Epoch 11, Train Loss 0.647544, Valid_loss 0.633193
Epoch 12, Train Loss 0.612000, Valid_loss 0.631676
Epoch 13, Train Loss 0.610383, Valid_loss 0.632609
Epoch 14, Train Loss 0.612633, Valid_loss 0.624648
Epoch 15, Train Loss 0.579041, Valid_loss 0.620865
Epoch 16, Train Loss 0.575670, Valid_loss 0.615402
Epoch 17, Train Loss 0.606038, Valid_loss 0.610247
Epoch 18, Train Loss 0.572780, Valid_loss 0.603354
Epoch 19, Train Loss 0.570362, Valid_loss 0.599295
Epoch 20, Train Loss 0.575314, Valid_loss 0.598906
Epoch 21, Train Loss 0.594523, Valid_loss 0.600287
Epoch 22, Train Loss 0.620058, Valid_loss 0.603425
Epoch 23, Train Loss 0.559627, Valid_loss 0.604826
Epoch 24, Train Loss 0.564106, Valid_loss 0.602227
Epoch 25, Train Loss 0.547057, Valid_loss 0.587486
Epoch 26, Train Loss 0.503460, Valid_loss 0.590667
Epoch 27, Train Loss 0.571533, Valid_loss 0.592187
Epoch 28, Train Loss 0.565476, Valid_loss 0.583556
Epoch 29, Train Loss 0.576015, Valid_loss 0.622796
Epoch 30, Train Loss 0.567046, Valid_loss 0.600391
Epoch 31, Train Loss 0.578764, Valid_loss 0.574038
Epoch 32, Train Loss 0.580294, Valid_loss 0.599848
Epoch 33, Train Loss 0.557480, Valid_loss 0.582315
Epoch 34, Train Loss 0.505431, Valid_loss 0.625662
Epoch 35, Train Loss 0.531760, Valid_loss 0.587020
Epoch 36, Train Loss 0.569723, Valid_loss 0.586323
Epoch 37, Train Loss 0.552333, Valid_loss 0.578898
Epoch 38, Train Loss 0.526306, Valid_loss 0.593060
Epoch 39, Train Loss 0.550728, Valid_loss 0.565517
Epoch 40, Train Loss 0.543080, Valid_loss 0.560881
Epoch 41, Train Loss 0.535579, Valid_loss 0.572524
Epoch 42, Train Loss 0.544084, Valid_loss 0.593077
Epoch 43, Train Loss 0.528873, Valid_loss 0.605472
Epoch 44, Train Loss 0.530784, Valid_loss 0.561249
Epoch 45, Train Loss 0.539525, Valid_loss 0.570720
Epoch 46, Train Loss 0.516345, Valid_loss 0.614453
Epoch 47, Train Loss 0.509983, Valid_loss 0.565518
Epoch 48, Train Loss 0.531872, Valid_loss 0.546506
Epoch 49, Train Loss 0.546883, Valid_loss 0.549083
Epoch 50, Train Loss 0.528211, Valid_loss 0.622561
Epoch 51, Train Loss 0.532771, Valid_loss 0.555856
Epoch 52, Train Loss 0.538312, Valid_loss 0.558353
Epoch 53, Train Loss 0.518049, Valid_loss 0.549493
Epoch 54, Train Loss 0.533816, Valid_loss 0.553161
Epoch 55, Train Loss 0.510328, Valid_loss 0.561432
[I 2025-08-31 20:32:04,974] Trial 0 finished with value: 0.5465055235794612 and parameters: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 1, 'dropout': 0.5, 'weight_decay': 0.0001, 'emb_dim': 8, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.5465055235794612.
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 29.04 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.656280, Valid_loss 0.602900
Epoch 2, Train Loss 0.644253, Valid_loss 0.598904
Epoch 3, Train Loss 0.623554, Valid_loss 0.604406
Epoch 4, Train Loss 0.627607, Valid_loss 0.598339
Epoch 5, Train Loss 0.630659, Valid_loss 0.598227
Epoch 6, Train Loss 0.637583, Valid_loss 0.597820
Epoch 7, Train Loss 0.629615, Valid_loss 0.601062
Epoch 8, Train Loss 0.605369, Valid_loss 0.599966
Epoch 9, Train Loss 0.626129, Valid_loss 0.600182
Epoch 10, Train Loss 0.622717, Valid_loss 0.604661
Epoch 11, Train Loss 0.629665, Valid_loss 0.598259
Epoch 12, Train Loss 0.622232, Valid_loss 0.607117
Epoch 13, Train Loss 0.623588, Valid_loss 0.602306
Epoch 14, Train Loss 0.626075, Valid_loss 0.600978
Epoch 15, Train Loss 0.624847, Valid_loss 0.602613
Epoch 16, Train Loss 0.627181, Valid_loss 0.598579
Epoch 17, Train Loss 0.628224, Valid_loss 0.605269
Epoch 18, Train Loss 0.608619, Valid_loss 0.537548
Epoch 19, Train Loss 0.461049, Valid_loss 0.683569
Epoch 20, Train Loss 0.415995, Valid_loss 0.836424
Epoch 21, Train Loss 0.483777, Valid_loss 0.467182
Epoch 22, Train Loss 0.348845, Valid_loss 0.497516
Epoch 23, Train Loss 0.295925, Valid_loss 0.672479
Epoch 24, Train Loss 0.290781, Valid_loss 0.520995
Epoch 25, Train Loss 0.287862, Valid_loss 0.416743
Epoch 26, Train Loss 0.305424, Valid_loss 0.728824
Epoch 27, Train Loss 0.350965, Valid_loss 0.485747
Epoch 28, Train Loss 0.363892, Valid_loss 0.554061
Epoch 29, Train Loss 0.339816, Valid_loss 0.700858
Epoch 30, Train Loss 0.356478, Valid_loss 0.622078
Epoch 31, Train Loss 0.331385, Valid_loss 0.596477
Epoch 32, Train Loss 0.298510, Valid_loss 0.543192
Epoch 33, Train Loss 0.309863, Valid_loss 0.614008
Epoch 34, Train Loss 0.289248, Valid_loss 0.574850
Epoch 35, Train Loss 0.269036, Valid_loss 0.806391
Epoch 36, Train Loss 0.283158, Valid_loss 0.695408
Epoch 37, Train Loss 0.263741, Valid_loss 0.615137
Epoch 38, Train Loss 0.253034, Valid_loss 0.660045
Epoch 39, Train Loss 0.270271, Valid_loss 0.809220
Epoch 40, Train Loss 0.284052, Valid_loss 0.608577
Epoch 41, Train Loss 0.277065, Valid_loss 0.627639
Epoch 42, Train Loss 0.263133, Valid_loss 0.629130
Epoch 43, Train Loss 0.275601, Valid_loss 0.697610
Epoch 44, Train Loss 0.273920, Valid_loss 0.703738
Epoch 45, Train Loss 0.291725, Valid_loss 0.663001
Epoch 46, Train Loss 0.286073, Valid_loss 0.768769
Epoch 47, Train Loss 0.285946, Valid_loss 0.831035
Epoch 48, Train Loss 0.280457, Valid_loss 0.679718
Epoch 49, Train Loss 0.305084, Valid_loss 0.723080
Epoch 50, Train Loss 0.278915, Valid_loss 0.425887
Epoch 51, Train Loss 0.278885, Valid_loss 0.741832
Epoch 52, Train Loss 0.230256, Valid_loss 0.851389
[I 2025-08-31 20:35:22,821] Trial 1 finished with value: 0.41674323473125696 and parameters: {'learning_rate': 0.01, 'epochs': 100, 'heads': 1, 'dropout': 0.0, 'weight_decay': 0.001, 'emb_dim': 64, 'augment_num': 100, 'pca': False}. Best is trial 1 with value: 0.41674323473125696.
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 25.64 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.720627, Valid_loss 0.606621
Epoch 2, Train Loss 0.659460, Valid_loss 0.608137
Epoch 3, Train Loss 0.617908, Valid_loss 0.598214
Epoch 4, Train Loss 0.646029, Valid_loss 0.580120
Epoch 5, Train Loss 0.550601, Valid_loss 0.520382
Epoch 6, Train Loss 0.529107, Valid_loss 0.556591
Epoch 7, Train Loss 0.451637, Valid_loss 0.452782
Epoch 8, Train Loss 0.436309, Valid_loss 0.407781
Epoch 9, Train Loss 0.379620, Valid_loss 0.482032
Epoch 10, Train Loss 0.383523, Valid_loss 0.645229
Epoch 11, Train Loss 0.343597, Valid_loss 0.502832
Epoch 12, Train Loss 0.378642, Valid_loss 0.472914
Epoch 13, Train Loss 0.377925, Valid_loss 0.413461
Epoch 14, Train Loss 0.401492, Valid_loss 0.682655
Epoch 15, Train Loss 0.368865, Valid_loss 0.395351
Epoch 16, Train Loss 0.383441, Valid_loss 0.424341
Epoch 17, Train Loss 0.334101, Valid_loss 0.529307
Epoch 18, Train Loss 0.332467, Valid_loss 0.570390
Epoch 19, Train Loss 0.294029, Valid_loss 0.422974
Epoch 20, Train Loss 0.302326, Valid_loss 0.411680
Epoch 21, Train Loss 0.310153, Valid_loss 0.448488
Epoch 22, Train Loss 0.289765, Valid_loss 0.406553
Epoch 23, Train Loss 0.309402, Valid_loss 0.277281
Epoch 24, Train Loss 0.312089, Valid_loss 0.410844
Epoch 25, Train Loss 0.253109, Valid_loss 0.548774
Epoch 26, Train Loss 0.350508, Valid_loss 0.416238
Epoch 27, Train Loss 0.321326, Valid_loss 0.481366
Epoch 28, Train Loss 0.271946, Valid_loss 0.375864
Epoch 29, Train Loss 0.295435, Valid_loss 0.387825
Epoch 30, Train Loss 0.311666, Valid_loss 0.606005
Epoch 31, Train Loss 0.291116, Valid_loss 0.422088
Epoch 32, Train Loss 0.277881, Valid_loss 0.350618
Epoch 33, Train Loss 0.276490, Valid_loss 0.471438
Epoch 34, Train Loss 0.288152, Valid_loss 0.659629
Epoch 35, Train Loss 0.321782, Valid_loss 0.671528
Epoch 36, Train Loss 0.303572, Valid_loss 0.423088
Epoch 37, Train Loss 0.287644, Valid_loss 0.421850
Epoch 38, Train Loss 0.294247, Valid_loss 0.392574
Epoch 39, Train Loss 0.304439, Valid_loss 0.379764
Epoch 40, Train Loss 0.262856, Valid_loss 0.448688
Epoch 41, Train Loss 0.296575, Valid_loss 0.500532
Epoch 42, Train Loss 0.252321, Valid_loss 0.606410
Epoch 43, Train Loss 0.276243, Valid_loss 0.396693
Epoch 44, Train Loss 0.302116, Valid_loss 0.508282
Epoch 45, Train Loss 0.283982, Valid_loss 0.401681
Epoch 46, Train Loss 0.261608, Valid_loss 0.482336
Epoch 47, Train Loss 0.338978, Valid_loss 0.486525
Epoch 48, Train Loss 0.276635, Valid_loss 0.797713
Epoch 49, Train Loss 0.316105, Valid_loss 0.614358
Epoch 50, Train Loss 0.302854, Valid_loss 0.313738
Epoch 51, Train Loss 0.311501, Valid_loss 0.407314
Epoch 52, Train Loss 0.277625, Valid_loss 0.420845
[I 2025-08-31 20:38:56,942] Trial 2 finished with value: 0.27728136043463436 and parameters: {'learning_rate': 0.01, 'epochs': 100, 'heads': 2, 'dropout': 0.3, 'weight_decay': 0.01, 'emb_dim': 8, 'augment_num': 100, 'pca': False}. Best is trial 2 with value: 0.27728136043463436.
선택된 trial params: {'learning_rate': 0.01, 'epochs': 100, 'heads': 2, 'dropout': 0.3, 'weight_decay': 0.01, 'emb_dim': 8, 'augment_num': 100, 'pca': False}
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=10, batch_size=1 -> steps=10
output_class :  1
Memory Allocated: 25.64 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.661473, Valid_loss 0.609847
Epoch 2, Train Loss 0.634556, Valid_loss 0.599515
Epoch 3, Train Loss 0.585925, Valid_loss 0.566392
Epoch 4, Train Loss 0.493488, Valid_loss 0.480202
Epoch 5, Train Loss 0.457116, Valid_loss 0.609795
Epoch 6, Train Loss 0.419602, Valid_loss 0.463653
Epoch 7, Train Loss 0.396754, Valid_loss 0.414503
Epoch 8, Train Loss 0.375872, Valid_loss 0.601610
Epoch 9, Train Loss 0.365453, Valid_loss 0.445764
Epoch 10, Train Loss 0.480486, Valid_loss 0.653619
Epoch 11, Train Loss 0.465461, Valid_loss 0.484661
Epoch 12, Train Loss 0.382840, Valid_loss 0.425954
Epoch 13, Train Loss 0.385335, Valid_loss 0.540844
Epoch 14, Train Loss 0.349078, Valid_loss 0.355486
Epoch 15, Train Loss 0.425927, Valid_loss 0.376928
Epoch 16, Train Loss 0.467560, Valid_loss 0.547184
Epoch 17, Train Loss 0.350826, Valid_loss 0.423485
Epoch 18, Train Loss 0.310613, Valid_loss 0.657042
Epoch 19, Train Loss 0.307833, Valid_loss 0.407191
Epoch 20, Train Loss 0.290017, Valid_loss 0.395762
Epoch 21, Train Loss 0.303846, Valid_loss 0.547323
Epoch 22, Train Loss 0.300956, Valid_loss 0.497811
Epoch 23, Train Loss 0.321858, Valid_loss 0.725596
Epoch 24, Train Loss 0.370734, Valid_loss 0.380001
Epoch 25, Train Loss 0.322114, Valid_loss 0.389665
Epoch 26, Train Loss 0.312753, Valid_loss 0.363563
Epoch 27, Train Loss 0.319425, Valid_loss 0.510403
Epoch 28, Train Loss 0.305382, Valid_loss 0.474890
Epoch 29, Train Loss 0.301402, Valid_loss 0.406649
Epoch 30, Train Loss 0.320657, Valid_loss 0.615123
Epoch 31, Train Loss 0.291856, Valid_loss 0.414336
Epoch 32, Train Loss 0.291640, Valid_loss 0.336510
Epoch 33, Train Loss 0.317899, Valid_loss 0.432979
Epoch 34, Train Loss 0.303899, Valid_loss 0.590323
Epoch 35, Train Loss 0.291964, Valid_loss 0.333929
Epoch 36, Train Loss 0.301835, Valid_loss 0.429622
Epoch 37, Train Loss 0.272515, Valid_loss 0.671626
Epoch 38, Train Loss 0.278151, Valid_loss 0.349371
Epoch 39, Train Loss 0.264222, Valid_loss 0.562986
Epoch 40, Train Loss 0.354454, Valid_loss 0.315200
Epoch 41, Train Loss 0.313367, Valid_loss 0.551986
Epoch 42, Train Loss 0.301999, Valid_loss 0.557702
Epoch 43, Train Loss 0.322638, Valid_loss 0.512050
Epoch 44, Train Loss 0.303573, Valid_loss 0.523020
Epoch 45, Train Loss 0.268215, Valid_loss 0.433042
Epoch 46, Train Loss 0.291308, Valid_loss 0.411956
Epoch 47, Train Loss 0.287713, Valid_loss 0.509436
Epoch 48, Train Loss 0.270115, Valid_loss 0.393344
Epoch 49, Train Loss 0.282041, Valid_loss 0.513367
Epoch 50, Train Loss 0.278274, Valid_loss 0.287120
Epoch 51, Train Loss 0.313071, Valid_loss 0.617777
Epoch 52, Train Loss 0.263400, Valid_loss 0.437799
Epoch 53, Train Loss 0.253926, Valid_loss 0.530338
Epoch 54, Train Loss 0.282282, Valid_loss 0.480301
Epoch 55, Train Loss 0.252750, Valid_loss 0.463389
Epoch 56, Train Loss 0.269950, Valid_loss 0.353883
Epoch 57, Train Loss 0.247737, Valid_loss 0.434720
Epoch 58, Train Loss 0.295750, Valid_loss 0.328428
Epoch 59, Train Loss 0.249976, Valid_loss 0.586998
Epoch 60, Train Loss 0.237208, Valid_loss 0.552108
Epoch 61, Train Loss 0.285152, Valid_loss 0.544714
Epoch 62, Train Loss 0.275491, Valid_loss 0.463267
Epoch 63, Train Loss 0.276617, Valid_loss 0.468945
Epoch 64, Train Loss 0.250799, Valid_loss 0.462315
Epoch 65, Train Loss 0.248404, Valid_loss 0.400345
Epoch 66, Train Loss 0.244510, Valid_loss 0.316377
Epoch 67, Train Loss 0.266956, Valid_loss 0.355581
Epoch 68, Train Loss 0.289487, Valid_loss 0.336486
Epoch 69, Train Loss 0.364974, Valid_loss 0.361698
Epoch 70, Train Loss 0.309071, Valid_loss 0.426597
환자ID=COVID19_Participant10 -- true: 1 -- pred: 0
환자ID=COVID19_Participant18 -- true: 1 -- pred: 1
환자ID=COVID19_Participant28 -- true: 1 -- pred: 1
환자ID=COVID19_Participant39 -- true: 1 -- pred: 1
환자ID=COVID19_Participant6 -- true: 1 -- pred: 1
환자ID=COVID19_Participant8 -- true: 1 -- pred: 1
환자ID=COVID19_Participant9 -- true: 1 -- pred: 1
환자ID=Control_Participant1 -- true: 0 -- pred: 1
환자ID=Control_Participant14 -- true: 0 -- pred: 0
환자ID=Control_Participant5 -- true: 0 -- pred: 0
Best performance: Epoch 50, Loss 0.278274, Test ACC 0.800000, Test AUC 0.952381, Test Recall 0.857143, Test Precision 0.857143
Confusion Matrix:
 [2 1 1 6]
✅ Total valid splits used: 2
🔁 Repeat 4, Fold 2
cell type :  GTCGGGGGGTGG_Control_Participant7        Keratinocytes
CAAATCAATTAT_Control_Participant7     Epithelial_cells
ATACAATTGACA_Control_Participant7     Epithelial_cells
CTGTTAATGAGA_Control_Participant7     Epithelial_cells
CTTCACATTATT_Control_Participant7     Epithelial_cells
                                            ...       
GCAGGGAACTCC_COVID19_Participant30    Epithelial_cells
CAGCACCGAGCC_COVID19_Participant30    Epithelial_cells
GCCCCTTGTGAT_COVID19_Participant30    Epithelial_cells
GTGTTGTGTGTC_COVID19_Participant30              B_cell
TAACACTCACTT_COVID19_Participant30           Myelocyte
Name: singler_annotation, Length: 21867, dtype: string
cell type annotation :  GTCGGGGGGTGG_Control_Participant7        Keratinocytes
CAAATCAATTAT_Control_Participant7     Epithelial_cells
ATACAATTGACA_Control_Participant7     Epithelial_cells
CTGTTAATGAGA_Control_Participant7     Epithelial_cells
CTTCACATTATT_Control_Participant7     Epithelial_cells
                                            ...       
GCAGGGAACTCC_COVID19_Participant30    Epithelial_cells
CAGCACCGAGCC_COVID19_Participant30    Epithelial_cells
GCCCCTTGTGAT_COVID19_Participant30    Epithelial_cells
GTGTTGTGTGTC_COVID19_Participant30              B_cell
TAACACTCACTT_COVID19_Participant30           Myelocyte
Name: singler_annotation, Length: 21867, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Keratinocytes', 'Epithelial_cells', 'Neurons', 'iPS_cells', 'Embryonic_stem_cells', 'Astrocyte', 'DC', 'Gametocytes', 'HSC_-G-CSF', 'Smooth_muscle_cells', 'BM & Prog.', 'Monocyte', 'Myelocyte', 'BM', 'Endothelial_cells', 'Osteoblasts', 'Platelets', 'Erythroblast', 'NK_cell', 'T_cells', 'Chondrocytes', 'HSC_CD34+', 'CMP', 'Neutrophils', 'Fibroblasts', 'MEP', 'Neuroepithelial_cell', 'MSC', 'Pro-Myelocyte', 'B_cell', 'GMP', 'Hepatocytes', 'Macrophage', 'Tissue_stem_cells', 'Pre-B_cell_CD34-', 'Pro-B_cell_CD34+', 'Unknown']
라벨별 그룹 개수 {1: 28, 0: 12}
cell type :  CGAATCAAGGCC_COVID19_Participant26    Epithelial_cells
ACGCCCTTCAAC_COVID19_Participant26    Epithelial_cells
ACCATATTGCTT_COVID19_Participant26    Epithelial_cells
AAACCTCCGGGA_COVID19_Participant26    Epithelial_cells
TACGCGCCGAAC_COVID19_Participant26    Epithelial_cells
                                            ...       
CGCGCCCTAGAC_Control_Participant15    Epithelial_cells
CGGACAGAATGG_Control_Participant15         Gametocytes
GTTTATTCATCA_Control_Participant15        Chondrocytes
TTTTTGTACTAT_Control_Participant15         Gametocytes
CGATTGTAGATC_Control_Participant15         Gametocytes
Name: singler_annotation, Length: 5080, dtype: string
cell type annotation :  CGAATCAAGGCC_COVID19_Participant26    Epithelial_cells
ACGCCCTTCAAC_COVID19_Participant26    Epithelial_cells
ACCATATTGCTT_COVID19_Participant26    Epithelial_cells
AAACCTCCGGGA_COVID19_Participant26    Epithelial_cells
TACGCGCCGAAC_COVID19_Participant26    Epithelial_cells
                                            ...       
CGCGCCCTAGAC_Control_Participant15    Epithelial_cells
CGGACAGAATGG_Control_Participant15         Gametocytes
GTTTATTCATCA_Control_Participant15        Chondrocytes
TTTTTGTACTAT_Control_Participant15         Gametocytes
CGATTGTAGATC_Control_Participant15         Gametocytes
Name: singler_annotation, Length: 5080, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Epithelial_cells', 'Keratinocytes', 'Macrophage', 'NK_cell', 'Erythroblast', 'Neurons', 'Gametocytes', 'Platelets', 'Monocyte', 'DC', 'Neutrophils', 'B_cell', 'Endothelial_cells', 'Pre-B_cell_CD34-', 'HSC_CD34+', 'Myelocyte', 'T_cells', 'MEP', 'Hepatocytes', 'Astrocyte', 'BM', 'HSC_-G-CSF', 'BM & Prog.', 'Embryonic_stem_cells', 'Osteoblasts', 'Smooth_muscle_cells', 'CMP', 'GMP', 'Pro-B_cell_CD34+', 'Tissue_stem_cells', 'Chondrocytes', 'Neuroepithelial_cell', 'Pro-Myelocyte', 'iPS_cells', 'Fibroblasts', 'MSC']
라벨별 그룹 개수 {1: 7, 0: 3}
🔍 Split #3
  → train_p_index 환자 수 (환자 단위로 묶인 index list): 40
  → test_p_index 환자 수  (환자 단위로 묶인 index list): 10
  → train 환자 ID: ['COVID19_Participant10', 'COVID19_Participant12', 'COVID19_Participant13', 'COVID19_Participant14', 'COVID19_Participant15', 'COVID19_Participant17', 'COVID19_Participant18', 'COVID19_Participant20', 'COVID19_Participant21', 'COVID19_Participant23', 'COVID19_Participant25', 'COVID19_Participant27', 'COVID19_Participant28', 'COVID19_Participant29', 'COVID19_Participant30', 'COVID19_Participant31', 'COVID19_Participant32', 'COVID19_Participant35', 'COVID19_Participant36', 'COVID19_Participant37', 'COVID19_Participant38', 'COVID19_Participant39', 'COVID19_Participant4', 'COVID19_Participant40', 'COVID19_Participant5', 'COVID19_Participant6', 'COVID19_Participant8', 'COVID19_Participant9', 'Control_Participant1', 'Control_Participant10', 'Control_Participant11', 'Control_Participant12', 'Control_Participant13', 'Control_Participant14', 'Control_Participant2', 'Control_Participant3', 'Control_Participant5', 'Control_Participant6', 'Control_Participant7', 'Control_Participant9']
  → test  환자 ID: ['COVID19_Participant11', 'COVID19_Participant19', 'COVID19_Participant2', 'COVID19_Participant22', 'COVID19_Participant26', 'COVID19_Participant3', 'COVID19_Participant7', 'Control_Participant15', 'Control_Participant4', 'Control_Participant8']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant10, Label: 1
    ID: COVID19_Participant12, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant18, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant21, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant27, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant30, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant35, Label: 1
    ID: COVID19_Participant36, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant38, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: COVID19_Participant5, Label: 1
    ID: COVID19_Participant6, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: COVID19_Participant9, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant10, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant12, Label: 0
    ID: Control_Participant13, Label: 0
    ID: Control_Participant14, Label: 0
    ID: Control_Participant2, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant6, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant3, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: Control_Participant15, Label: 0
    ID: Control_Participant4, Label: 0
    ID: Control_Participant8, Label: 0
전체 데이터 index 길이 50
label_stat (train 환자 라벨 목록) 갯수 40
train_data에서 환자 단위로, train과 validation 나누기
기존 train_p_index 40
기존 (train) label_stat 40
train-vali 분할 후! 
train y 의 classes : {0, 1} valid y 의 classes : {0, 1} label_stat 의 classes : {0, 1}
train_p_index_ 26
valid_p_index 14
test_p_index 10
→ train 환자 ID 및 라벨:
   총 개수: 26
   환자ID=Control_Participant10, Label=0, 셀개수=1645
   환자ID=Control_Participant14, Label=0, 셀개수=274
   환자ID=COVID19_Participant18, Label=1, 셀개수=227
   환자ID=COVID19_Participant39, Label=1, 셀개수=454
   환자ID=COVID19_Participant10, Label=1, 셀개수=18
   환자ID=Control_Participant5, Label=0, 셀개수=717
   환자ID=COVID19_Participant14, Label=1, 셀개수=382
   환자ID=COVID19_Participant20, Label=1, 셀개수=2033
   환자ID=COVID19_Participant40, Label=1, 셀개수=381
   환자ID=COVID19_Participant13, Label=1, 셀개수=730
   환자ID=COVID19_Participant21, Label=1, 셀개수=39
   환자ID=Control_Participant2, Label=0, 셀개수=41
   환자ID=COVID19_Participant29, Label=1, 셀개수=573
   환자ID=Control_Participant7, Label=0, 셀개수=762
   환자ID=Control_Participant6, Label=0, 셀개수=131
   환자ID=COVID19_Participant15, Label=1, 셀개수=1003
   환자ID=Control_Participant9, Label=0, 셀개수=558
   환자ID=Control_Participant11, Label=0, 셀개수=1164
   환자ID=COVID19_Participant25, Label=1, 셀개수=496
   환자ID=COVID19_Participant32, Label=1, 셀개수=1665
   환자ID=COVID19_Participant28, Label=1, 셀개수=1079
   환자ID=COVID19_Participant17, Label=1, 셀개수=843
   환자ID=COVID19_Participant6, Label=1, 셀개수=84
   환자ID=COVID19_Participant4, Label=1, 셀개수=1680
   환자ID=COVID19_Participant38, Label=1, 셀개수=51
   환자ID=COVID19_Participant31, Label=1, 셀개수=410
→ valid 환자 ID 및 라벨:
   총 개수: 14
   환자ID=Control_Participant13, Label=0, 셀개수=88
   환자ID=COVID19_Participant30, Label=1, 셀개수=116
   환자ID=COVID19_Participant36, Label=1, 셀개수=200
   환자ID=COVID19_Participant35, Label=1, 셀개수=83
   환자ID=COVID19_Participant5, Label=1, 셀개수=89
   환자ID=COVID19_Participant23, Label=1, 셀개수=307
   환자ID=Control_Participant3, Label=0, 셀개수=1620
   환자ID=Control_Participant1, Label=0, 셀개수=414
   환자ID=COVID19_Participant9, Label=1, 셀개수=86
   환자ID=COVID19_Participant8, Label=1, 셀개수=462
   환자ID=Control_Participant12, Label=0, 셀개수=99
   환자ID=COVID19_Participant37, Label=1, 셀개수=668
   환자ID=COVID19_Participant12, Label=1, 셀개수=102
   환자ID=COVID19_Participant27, Label=1, 셀개수=93
→ test 환자 ID 및 라벨:
   총 개수: 10
   환자ID=COVID19_Participant11, Label=1, 셀개수=382
   환자ID=COVID19_Participant19, Label=1, 셀개수=816
   환자ID=COVID19_Participant2, Label=1, 셀개수=329
   환자ID=COVID19_Participant22, Label=1, 셀개수=865
   환자ID=COVID19_Participant26, Label=1, 셀개수=814
   환자ID=COVID19_Participant3, Label=1, 셀개수=104
   환자ID=COVID19_Participant7, Label=1, 셀개수=409
   환자ID=Control_Participant15, Label=0, 셀개수=528
   환자ID=Control_Participant4, Label=0, 셀개수=440
   환자ID=Control_Participant8, Label=0, 셀개수=393
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Keratinocytes', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Neurons', 'iPS_cells', 'Embryonic_stem_cells', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
전체 데이터 길이 26947
전체 cell type 길이 0           Keratinocytes
1        Epithelial_cells
2        Epithelial_cells
3        Epithelial_cells
4        Epithelial_cells
               ...       
26942    Epithelial_cells
26943         Gametocytes
26944        Chondrocytes
26945         Gametocytes
26946         Gametocytes
Length: 26947, dtype: string
cell type의 NaN 개수 체크 0
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:11,  8.82it/s]  2%|▏         | 2/100 [00:00<00:14,  6.67it/s]  3%|▎         | 3/100 [00:00<00:12,  7.58it/s]  4%|▍         | 4/100 [00:00<00:11,  8.31it/s]  5%|▌         | 5/100 [00:00<00:10,  8.66it/s]  6%|▌         | 6/100 [00:00<00:10,  8.91it/s]  7%|▋         | 7/100 [00:00<00:10,  8.92it/s]  8%|▊         | 8/100 [00:00<00:10,  8.48it/s]  9%|▉         | 9/100 [00:01<00:10,  8.55it/s] 11%|█         | 11/100 [00:01<00:09,  9.21it/s] 12%|█▏        | 12/100 [00:01<00:09,  9.01it/s] 13%|█▎        | 13/100 [00:01<00:09,  8.99it/s] 14%|█▍        | 14/100 [00:01<00:09,  8.93it/s] 15%|█▌        | 15/100 [00:01<00:09,  8.89it/s] 16%|█▌        | 16/100 [00:01<00:09,  8.72it/s] 17%|█▋        | 17/100 [00:02<00:10,  7.90it/s] 18%|█▊        | 18/100 [00:02<00:09,  8.20it/s] 19%|█▉        | 19/100 [00:02<00:09,  8.28it/s] 20%|██        | 20/100 [00:02<00:09,  8.00it/s] 21%|██        | 21/100 [00:02<00:09,  8.14it/s] 22%|██▏       | 22/100 [00:02<00:09,  7.93it/s] 23%|██▎       | 23/100 [00:02<00:09,  7.89it/s] 24%|██▍       | 24/100 [00:02<00:09,  8.32it/s] 25%|██▌       | 25/100 [00:02<00:09,  8.11it/s] 26%|██▌       | 26/100 [00:03<00:08,  8.38it/s] 27%|██▋       | 27/100 [00:03<00:08,  8.52it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.18it/s] 30%|███       | 30/100 [00:03<00:07,  8.92it/s] 31%|███       | 31/100 [00:03<00:07,  8.78it/s] 32%|███▏      | 32/100 [00:03<00:08,  8.37it/s] 33%|███▎      | 33/100 [00:03<00:08,  8.27it/s] 34%|███▍      | 34/100 [00:04<00:08,  8.10it/s] 35%|███▌      | 35/100 [00:04<00:08,  7.92it/s] 36%|███▌      | 36/100 [00:04<00:08,  7.77it/s] 37%|███▋      | 37/100 [00:04<00:08,  7.53it/s] 38%|███▊      | 38/100 [00:04<00:07,  8.04it/s] 39%|███▉      | 39/100 [00:04<00:07,  8.42it/s] 40%|████      | 40/100 [00:04<00:07,  8.51it/s] 41%|████      | 41/100 [00:04<00:06,  8.45it/s] 42%|████▏     | 42/100 [00:05<00:06,  8.44it/s] 43%|████▎     | 43/100 [00:05<00:06,  8.36it/s] 44%|████▍     | 44/100 [00:05<00:06,  8.40it/s] 45%|████▌     | 45/100 [00:05<00:06,  8.41it/s] 46%|████▌     | 46/100 [00:05<00:06,  8.12it/s] 47%|████▋     | 47/100 [00:05<00:06,  8.02it/s] 48%|████▊     | 48/100 [00:05<00:06,  7.67it/s] 49%|████▉     | 49/100 [00:05<00:07,  7.16it/s] 50%|█████     | 50/100 [00:06<00:07,  6.41it/s] 51%|█████     | 51/100 [00:06<00:07,  6.90it/s] 52%|█████▏    | 52/100 [00:06<00:06,  7.35it/s] 53%|█████▎    | 53/100 [00:06<00:06,  6.80it/s] 54%|█████▍    | 54/100 [00:06<00:06,  7.32it/s] 55%|█████▌    | 55/100 [00:06<00:05,  7.66it/s] 56%|█████▌    | 56/100 [00:06<00:06,  7.09it/s] 57%|█████▋    | 57/100 [00:07<00:05,  7.31it/s] 58%|█████▊    | 58/100 [00:07<00:05,  7.46it/s] 59%|█████▉    | 59/100 [00:07<00:05,  7.87it/s] 60%|██████    | 60/100 [00:07<00:05,  7.56it/s] 61%|██████    | 61/100 [00:07<00:04,  7.88it/s] 62%|██████▏   | 62/100 [00:07<00:04,  8.11it/s] 63%|██████▎   | 63/100 [00:07<00:04,  7.88it/s] 64%|██████▍   | 64/100 [00:07<00:04,  7.94it/s] 65%|██████▌   | 65/100 [00:08<00:04,  8.04it/s] 66%|██████▌   | 66/100 [00:08<00:04,  7.72it/s] 67%|██████▋   | 67/100 [00:08<00:04,  8.02it/s] 68%|██████▊   | 68/100 [00:08<00:04,  7.23it/s] 69%|██████▉   | 69/100 [00:08<00:04,  7.33it/s] 70%|███████   | 70/100 [00:08<00:04,  7.39it/s] 71%|███████   | 71/100 [00:08<00:04,  6.91it/s] 72%|███████▏  | 72/100 [00:09<00:03,  7.28it/s] 73%|███████▎  | 73/100 [00:09<00:03,  7.62it/s] 74%|███████▍  | 74/100 [00:09<00:03,  7.65it/s] 75%|███████▌  | 75/100 [00:09<00:03,  7.54it/s] 76%|███████▌  | 76/100 [00:09<00:03,  7.52it/s] 77%|███████▋  | 77/100 [00:09<00:02,  7.77it/s] 78%|███████▊  | 78/100 [00:09<00:02,  7.80it/s] 79%|███████▉  | 79/100 [00:09<00:02,  7.31it/s] 80%|████████  | 80/100 [00:10<00:02,  7.67it/s] 81%|████████  | 81/100 [00:10<00:02,  7.37it/s] 82%|████████▏ | 82/100 [00:10<00:02,  7.61it/s] 83%|████████▎ | 83/100 [00:10<00:02,  7.81it/s] 84%|████████▍ | 84/100 [00:10<00:02,  6.90it/s] 85%|████████▌ | 85/100 [00:10<00:02,  7.24it/s] 86%|████████▌ | 86/100 [00:10<00:01,  7.48it/s] 87%|████████▋ | 87/100 [00:11<00:01,  7.68it/s] 88%|████████▊ | 88/100 [00:11<00:01,  7.92it/s] 89%|████████▉ | 89/100 [00:11<00:01,  7.24it/s] 90%|█████████ | 90/100 [00:11<00:01,  7.41it/s] 91%|█████████ | 91/100 [00:11<00:01,  7.48it/s] 92%|█████████▏| 92/100 [00:11<00:01,  7.30it/s] 93%|█████████▎| 93/100 [00:11<00:01,  6.93it/s] 94%|█████████▍| 94/100 [00:11<00:00,  7.10it/s] 95%|█████████▌| 95/100 [00:12<00:00,  7.40it/s] 96%|█████████▌| 96/100 [00:12<00:00,  7.52it/s] 97%|█████████▋| 97/100 [00:12<00:00,  7.61it/s] 98%|█████████▊| 98/100 [00:12<00:00,  7.32it/s] 99%|█████████▉| 99/100 [00:12<00:00,  7.63it/s]100%|██████████| 100/100 [00:12<00:00,  7.58it/s]100%|██████████| 100/100 [00:12<00:00,  7.83it/s]
[I 2025-08-31 20:43:59,914] A new study created in memory with name: no-name-6b1985b6-6611-4315-9236-21be69786bae
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 29.04 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.618021, Valid_loss 0.551691
Epoch 2, Train Loss 0.532565, Valid_loss 0.413607
Epoch 3, Train Loss 0.401828, Valid_loss 0.346297
Epoch 4, Train Loss 0.391068, Valid_loss 0.347103
Epoch 5, Train Loss 0.344206, Valid_loss 0.349316
Epoch 6, Train Loss 0.303309, Valid_loss 0.279346
Epoch 7, Train Loss 0.282887, Valid_loss 0.323191
Epoch 8, Train Loss 0.271113, Valid_loss 0.261841
Epoch 9, Train Loss 0.256033, Valid_loss 0.273938
Epoch 10, Train Loss 0.305812, Valid_loss 0.249245
Epoch 11, Train Loss 0.244869, Valid_loss 0.283003
Epoch 12, Train Loss 0.273672, Valid_loss 0.265128
Epoch 13, Train Loss 0.298963, Valid_loss 0.271763
Epoch 14, Train Loss 0.252124, Valid_loss 0.262263
Epoch 15, Train Loss 0.250353, Valid_loss 0.248859
Epoch 16, Train Loss 0.232034, Valid_loss 0.227983
Epoch 17, Train Loss 0.227437, Valid_loss 0.213565
Epoch 18, Train Loss 0.225133, Valid_loss 0.197655
Epoch 19, Train Loss 0.250888, Valid_loss 0.264627
Epoch 20, Train Loss 0.218354, Valid_loss 0.247614
Epoch 21, Train Loss 0.229990, Valid_loss 0.232896
Epoch 22, Train Loss 0.213855, Valid_loss 0.225703
Epoch 23, Train Loss 0.210561, Valid_loss 0.232081
Epoch 24, Train Loss 0.224957, Valid_loss 0.215264
Epoch 25, Train Loss 0.225880, Valid_loss 0.264230
Epoch 26, Train Loss 0.283025, Valid_loss 0.251230
Epoch 27, Train Loss 0.239967, Valid_loss 0.244823
Epoch 28, Train Loss 0.229559, Valid_loss 0.238433
Epoch 29, Train Loss 0.230227, Valid_loss 0.333811
Epoch 30, Train Loss 0.230574, Valid_loss 0.236730
Epoch 31, Train Loss 0.204425, Valid_loss 0.233988
Epoch 32, Train Loss 0.211937, Valid_loss 0.213046
Epoch 33, Train Loss 0.225609, Valid_loss 0.237572
Epoch 34, Train Loss 0.217864, Valid_loss 0.216746
Epoch 35, Train Loss 0.225405, Valid_loss 0.184219
Epoch 36, Train Loss 0.220748, Valid_loss 0.224665
Epoch 37, Train Loss 0.214525, Valid_loss 0.212945
Epoch 38, Train Loss 0.224782, Valid_loss 0.190644
Epoch 39, Train Loss 0.218464, Valid_loss 0.189282
Epoch 40, Train Loss 0.208868, Valid_loss 0.200183
Epoch 41, Train Loss 0.216337, Valid_loss 0.259939
Epoch 42, Train Loss 0.236443, Valid_loss 0.190960
Epoch 43, Train Loss 0.230023, Valid_loss 0.196157
Epoch 44, Train Loss 0.223621, Valid_loss 0.230206
Epoch 45, Train Loss 0.205350, Valid_loss 0.179562
Epoch 46, Train Loss 0.222497, Valid_loss 0.178407
Epoch 47, Train Loss 0.213184, Valid_loss 0.183285
Epoch 48, Train Loss 0.220550, Valid_loss 0.274853
Epoch 49, Train Loss 0.321597, Valid_loss 0.334210
Epoch 50, Train Loss 0.225258, Valid_loss 0.218440
Epoch 51, Train Loss 0.242325, Valid_loss 0.196686
Epoch 52, Train Loss 0.221034, Valid_loss 0.193426
Epoch 53, Train Loss 0.208047, Valid_loss 0.188797
Epoch 54, Train Loss 0.208868, Valid_loss 0.187763
Epoch 55, Train Loss 0.202564, Valid_loss 0.200579
Epoch 56, Train Loss 0.209233, Valid_loss 0.180184
Epoch 57, Train Loss 0.206942, Valid_loss 0.177418
Epoch 58, Train Loss 0.212888, Valid_loss 0.175082
Epoch 59, Train Loss 0.198447, Valid_loss 0.167257
Epoch 60, Train Loss 0.200534, Valid_loss 0.168041
Epoch 61, Train Loss 0.202582, Valid_loss 0.174007
[I 2025-08-31 20:47:56,214] Trial 0 finished with value: 0.16725655498781375 and parameters: {'learning_rate': 0.001, 'epochs': 100, 'heads': 1, 'dropout': 0.5, 'weight_decay': 0.01, 'emb_dim': 64, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.16725655498781375.
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 29.04 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.457219, Valid_loss 0.363695
Epoch 2, Train Loss 0.340072, Valid_loss 0.351022
Epoch 3, Train Loss 0.319436, Valid_loss 0.349464
Epoch 4, Train Loss 0.331828, Valid_loss 0.349380
Epoch 5, Train Loss 0.321978, Valid_loss 0.334022
Epoch 6, Train Loss 0.273051, Valid_loss 0.305966
Epoch 7, Train Loss 0.250322, Valid_loss 0.274879
Epoch 8, Train Loss 0.241866, Valid_loss 0.245901
Epoch 9, Train Loss 0.230233, Valid_loss 0.226876
Epoch 10, Train Loss 0.230554, Valid_loss 0.225802
Epoch 11, Train Loss 0.217555, Valid_loss 0.211564
Epoch 12, Train Loss 0.220762, Valid_loss 0.236105
Epoch 13, Train Loss 0.226841, Valid_loss 0.204359
Epoch 14, Train Loss 0.209970, Valid_loss 0.201974
Epoch 15, Train Loss 0.213939, Valid_loss 0.197486
Epoch 16, Train Loss 0.209750, Valid_loss 0.205732
Epoch 17, Train Loss 0.213608, Valid_loss 0.206105
Epoch 18, Train Loss 0.206897, Valid_loss 0.213608
Epoch 19, Train Loss 0.199958, Valid_loss 0.219368
Epoch 20, Train Loss 0.208801, Valid_loss 0.212825
Epoch 21, Train Loss 0.214583, Valid_loss 0.212773
Epoch 22, Train Loss 0.219066, Valid_loss 0.219134
Epoch 23, Train Loss 0.206394, Valid_loss 0.204347
Epoch 24, Train Loss 0.202759, Valid_loss 0.183988
Epoch 25, Train Loss 0.203757, Valid_loss 0.192210
Epoch 26, Train Loss 0.205038, Valid_loss 0.248398
Epoch 27, Train Loss 0.227361, Valid_loss 0.253905
Epoch 28, Train Loss 0.224020, Valid_loss 0.259011
Epoch 29, Train Loss 0.225662, Valid_loss 0.235980
Epoch 30, Train Loss 0.217880, Valid_loss 0.207524
Epoch 31, Train Loss 0.222420, Valid_loss 0.198450
Epoch 32, Train Loss 0.228041, Valid_loss 0.218834
Epoch 33, Train Loss 0.211918, Valid_loss 0.259085
Epoch 34, Train Loss 0.202159, Valid_loss 0.278727
Epoch 35, Train Loss 0.195785, Valid_loss 0.195257
Epoch 36, Train Loss 0.197806, Valid_loss 0.210713
Epoch 37, Train Loss 0.197701, Valid_loss 0.175881
Epoch 38, Train Loss 0.199086, Valid_loss 0.202464
Epoch 39, Train Loss 0.214935, Valid_loss 0.203820
Epoch 40, Train Loss 0.216697, Valid_loss 0.197107
Epoch 41, Train Loss 0.204281, Valid_loss 0.189880
Epoch 42, Train Loss 0.195210, Valid_loss 0.176643
Epoch 43, Train Loss 0.204510, Valid_loss 0.184478
Epoch 44, Train Loss 0.199442, Valid_loss 0.247643
Epoch 45, Train Loss 0.200194, Valid_loss 0.264891
Epoch 46, Train Loss 0.218140, Valid_loss 0.255885
Epoch 47, Train Loss 0.215131, Valid_loss 0.205011
Epoch 48, Train Loss 0.198553, Valid_loss 0.199698
Epoch 49, Train Loss 0.195293, Valid_loss 0.167732
Epoch 50, Train Loss 0.186476, Valid_loss 0.193568
Epoch 51, Train Loss 0.197785, Valid_loss 0.198013
Epoch 52, Train Loss 0.185381, Valid_loss 0.182111
Epoch 53, Train Loss 0.193424, Valid_loss 0.157604
Epoch 54, Train Loss 0.190162, Valid_loss 0.201149
Epoch 55, Train Loss 0.182898, Valid_loss 0.225223
[I 2025-08-31 20:51:29,027] Trial 1 finished with value: 0.15760395782334463 and parameters: {'learning_rate': 0.001, 'epochs': 100, 'heads': 1, 'dropout': 0.3, 'weight_decay': 0.01, 'emb_dim': 64, 'augment_num': 100, 'pca': False}. Best is trial 1 with value: 0.15760395782334463.
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 29.04 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.690567, Valid_loss 0.589660
Epoch 2, Train Loss 0.602582, Valid_loss 0.531876
Epoch 3, Train Loss 0.528339, Valid_loss 0.386712
Epoch 4, Train Loss 0.452918, Valid_loss 0.399841
Epoch 5, Train Loss 0.431059, Valid_loss 0.380765
Epoch 6, Train Loss 0.357745, Valid_loss 0.405893
Epoch 7, Train Loss 0.336980, Valid_loss 0.353418
Epoch 8, Train Loss 0.303549, Valid_loss 0.358462
Epoch 9, Train Loss 0.302030, Valid_loss 0.345132
Epoch 10, Train Loss 0.286792, Valid_loss 0.336402
Epoch 11, Train Loss 0.285022, Valid_loss 0.317933
Epoch 12, Train Loss 0.287383, Valid_loss 0.287436
Epoch 13, Train Loss 0.315550, Valid_loss 0.314848
Epoch 14, Train Loss 0.266494, Valid_loss 0.318953
Epoch 15, Train Loss 0.257735, Valid_loss 0.285827
Epoch 16, Train Loss 0.238646, Valid_loss 0.313617
Epoch 17, Train Loss 0.252649, Valid_loss 0.298962
Epoch 18, Train Loss 0.252324, Valid_loss 0.323551
Epoch 19, Train Loss 0.241815, Valid_loss 0.316646
Epoch 20, Train Loss 0.239852, Valid_loss 0.283000
Epoch 21, Train Loss 0.236767, Valid_loss 0.304782
Epoch 22, Train Loss 0.226115, Valid_loss 0.293434
Epoch 23, Train Loss 0.227570, Valid_loss 0.294078
Epoch 24, Train Loss 0.250042, Valid_loss 0.243565
Epoch 25, Train Loss 0.230592, Valid_loss 0.252736
Epoch 26, Train Loss 0.222773, Valid_loss 0.242281
Epoch 27, Train Loss 0.220295, Valid_loss 0.239233
Epoch 28, Train Loss 0.231185, Valid_loss 0.260625
Epoch 29, Train Loss 0.243330, Valid_loss 0.273315
Epoch 30, Train Loss 0.253047, Valid_loss 0.261792
Epoch 31, Train Loss 0.217628, Valid_loss 0.288398
Epoch 32, Train Loss 0.239099, Valid_loss 0.247173
Epoch 33, Train Loss 0.223239, Valid_loss 0.305290
Epoch 34, Train Loss 0.218765, Valid_loss 0.242494
Epoch 35, Train Loss 0.223292, Valid_loss 0.256337
Epoch 36, Train Loss 0.218203, Valid_loss 0.283104
Epoch 37, Train Loss 0.230591, Valid_loss 0.336864
Epoch 38, Train Loss 0.261722, Valid_loss 0.281218
Epoch 39, Train Loss 0.229761, Valid_loss 0.272368
Epoch 40, Train Loss 0.221556, Valid_loss 0.269616
Epoch 41, Train Loss 0.203322, Valid_loss 0.246253
Epoch 42, Train Loss 0.203975, Valid_loss 0.245097
Epoch 43, Train Loss 0.221610, Valid_loss 0.227840
Epoch 44, Train Loss 0.203736, Valid_loss 0.267161
Epoch 45, Train Loss 0.217981, Valid_loss 0.241258
Epoch 46, Train Loss 0.230223, Valid_loss 0.244549
Epoch 47, Train Loss 0.211899, Valid_loss 0.239461
Epoch 48, Train Loss 0.207345, Valid_loss 0.271127
Epoch 49, Train Loss 0.214372, Valid_loss 0.229116
Epoch 50, Train Loss 0.203268, Valid_loss 0.262119
Epoch 51, Train Loss 0.206339, Valid_loss 0.291763
Epoch 52, Train Loss 0.196586, Valid_loss 0.227258
Epoch 53, Train Loss 0.199485, Valid_loss 0.238227
Epoch 54, Train Loss 0.188229, Valid_loss 0.223130
Epoch 55, Train Loss 0.198989, Valid_loss 0.240362
Epoch 56, Train Loss 0.186649, Valid_loss 0.245958
[I 2025-08-31 20:55:24,159] Trial 2 finished with value: 0.2231304215799485 and parameters: {'learning_rate': 0.001, 'epochs': 100, 'heads': 2, 'dropout': 0.7, 'weight_decay': 0.001, 'emb_dim': 64, 'augment_num': 100, 'pca': False}. Best is trial 1 with value: 0.15760395782334463.
선택된 trial params: {'learning_rate': 0.001, 'epochs': 100, 'heads': 1, 'dropout': 0.3, 'weight_decay': 0.01, 'emb_dim': 64, 'augment_num': 100, 'pca': False}
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=10, batch_size=1 -> steps=10
output_class :  1
Memory Allocated: 29.04 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.594285, Valid_loss 0.523702
Epoch 2, Train Loss 0.433764, Valid_loss 0.346738
Epoch 3, Train Loss 0.358013, Valid_loss 0.330722
Epoch 4, Train Loss 0.290975, Valid_loss 0.296992
Epoch 5, Train Loss 0.268000, Valid_loss 0.265897
Epoch 6, Train Loss 0.257430, Valid_loss 0.250606
Epoch 7, Train Loss 0.245541, Valid_loss 0.278166
Epoch 8, Train Loss 0.263460, Valid_loss 0.275999
Epoch 9, Train Loss 0.252126, Valid_loss 0.268713
Epoch 10, Train Loss 0.235363, Valid_loss 0.284279
Epoch 11, Train Loss 0.230265, Valid_loss 0.240008
Epoch 12, Train Loss 0.223700, Valid_loss 0.268923
Epoch 13, Train Loss 0.232334, Valid_loss 0.274302
Epoch 14, Train Loss 0.212561, Valid_loss 0.243168
Epoch 15, Train Loss 0.218009, Valid_loss 0.284194
Epoch 16, Train Loss 0.216241, Valid_loss 0.235732
Epoch 17, Train Loss 0.220369, Valid_loss 0.213677
Epoch 18, Train Loss 0.213678, Valid_loss 0.217776
Epoch 19, Train Loss 0.203280, Valid_loss 0.217703
Epoch 20, Train Loss 0.204227, Valid_loss 0.243160
Epoch 21, Train Loss 0.197794, Valid_loss 0.228787
Epoch 22, Train Loss 0.197124, Valid_loss 0.213856
Epoch 23, Train Loss 0.217196, Valid_loss 0.325682
Epoch 24, Train Loss 0.203123, Valid_loss 0.229803
Epoch 25, Train Loss 0.212345, Valid_loss 0.204952
Epoch 26, Train Loss 0.202118, Valid_loss 0.237825
Epoch 27, Train Loss 0.208187, Valid_loss 0.229085
Epoch 28, Train Loss 0.194424, Valid_loss 0.242092
Epoch 29, Train Loss 0.206651, Valid_loss 0.214528
Epoch 30, Train Loss 0.206462, Valid_loss 0.217426
Epoch 31, Train Loss 0.208530, Valid_loss 0.231875
Epoch 32, Train Loss 0.209384, Valid_loss 0.214388
Epoch 33, Train Loss 0.202588, Valid_loss 0.220149
Epoch 34, Train Loss 0.214231, Valid_loss 0.211357
Epoch 35, Train Loss 0.205071, Valid_loss 0.203980
Epoch 36, Train Loss 0.215998, Valid_loss 0.326857
Epoch 37, Train Loss 0.298043, Valid_loss 0.402346
Epoch 38, Train Loss 0.290643, Valid_loss 0.285522
Epoch 39, Train Loss 0.225972, Valid_loss 0.220690
Epoch 40, Train Loss 0.215548, Valid_loss 0.239983
Epoch 41, Train Loss 0.200784, Valid_loss 0.210625
Epoch 42, Train Loss 0.195692, Valid_loss 0.215169
Epoch 43, Train Loss 0.202834, Valid_loss 0.247358
Epoch 44, Train Loss 0.205032, Valid_loss 0.201058
Epoch 45, Train Loss 0.201822, Valid_loss 0.238367
Epoch 46, Train Loss 0.220227, Valid_loss 0.300895
Epoch 47, Train Loss 0.257094, Valid_loss 0.228493
Epoch 48, Train Loss 0.213133, Valid_loss 0.196710
Epoch 49, Train Loss 0.202623, Valid_loss 0.198741
Epoch 50, Train Loss 0.196898, Valid_loss 0.199074
Epoch 51, Train Loss 0.199647, Valid_loss 0.192750
Epoch 52, Train Loss 0.200381, Valid_loss 0.189989
Epoch 53, Train Loss 0.193788, Valid_loss 0.189640
Epoch 54, Train Loss 0.200267, Valid_loss 0.207346
Epoch 55, Train Loss 0.189268, Valid_loss 0.204694
Epoch 56, Train Loss 0.196869, Valid_loss 0.233466
Epoch 57, Train Loss 0.201170, Valid_loss 0.185214
Epoch 58, Train Loss 0.200677, Valid_loss 0.189323
Epoch 59, Train Loss 0.198796, Valid_loss 0.190764
환자ID=COVID19_Participant11 -- true: 1 -- pred: 1
환자ID=COVID19_Participant19 -- true: 1 -- pred: 1
환자ID=COVID19_Participant2 -- true: 1 -- pred: 1
환자ID=COVID19_Participant22 -- true: 1 -- pred: 1
환자ID=COVID19_Participant26 -- true: 1 -- pred: 1
환자ID=COVID19_Participant3 -- true: 1 -- pred: 1
환자ID=COVID19_Participant7 -- true: 1 -- pred: 1
환자ID=Control_Participant15 -- true: 0 -- pred: 0
환자ID=Control_Participant4 -- true: 0 -- pred: 0
환자ID=Control_Participant8 -- true: 0 -- pred: 0
Best performance: Epoch 57, Loss 0.201170, Test ACC 1.000000, Test AUC 1.000000, Test Recall 1.000000, Test Precision 1.000000
Confusion Matrix:
 [3 0 0 7]
✅ Total valid splits used: 3
🔁 Repeat 4, Fold 3
cell type :  GTCGGGGGGTGG_Control_Participant7        Keratinocytes
CAAATCAATTAT_Control_Participant7     Epithelial_cells
ATACAATTGACA_Control_Participant7     Epithelial_cells
CTGTTAATGAGA_Control_Participant7     Epithelial_cells
CTTCACATTATT_Control_Participant7     Epithelial_cells
                                            ...       
GCAGGGAACTCC_COVID19_Participant30    Epithelial_cells
CAGCACCGAGCC_COVID19_Participant30    Epithelial_cells
GCCCCTTGTGAT_COVID19_Participant30    Epithelial_cells
GTGTTGTGTGTC_COVID19_Participant30              B_cell
TAACACTCACTT_COVID19_Participant30           Myelocyte
Name: singler_annotation, Length: 22140, dtype: string
cell type annotation :  GTCGGGGGGTGG_Control_Participant7        Keratinocytes
CAAATCAATTAT_Control_Participant7     Epithelial_cells
ATACAATTGACA_Control_Participant7     Epithelial_cells
CTGTTAATGAGA_Control_Participant7     Epithelial_cells
CTTCACATTATT_Control_Participant7     Epithelial_cells
                                            ...       
GCAGGGAACTCC_COVID19_Participant30    Epithelial_cells
CAGCACCGAGCC_COVID19_Participant30    Epithelial_cells
GCCCCTTGTGAT_COVID19_Participant30    Epithelial_cells
GTGTTGTGTGTC_COVID19_Participant30              B_cell
TAACACTCACTT_COVID19_Participant30           Myelocyte
Name: singler_annotation, Length: 22140, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Keratinocytes', 'Epithelial_cells', 'Neurons', 'iPS_cells', 'Embryonic_stem_cells', 'Astrocyte', 'DC', 'Gametocytes', 'HSC_-G-CSF', 'Smooth_muscle_cells', 'BM & Prog.', 'Monocyte', 'Myelocyte', 'BM', 'Endothelial_cells', 'Osteoblasts', 'Platelets', 'Erythroblast', 'NK_cell', 'T_cells', 'Chondrocytes', 'HSC_CD34+', 'CMP', 'Neutrophils', 'Fibroblasts', 'MEP', 'Neuroepithelial_cell', 'MSC', 'Pro-Myelocyte', 'B_cell', 'GMP', 'Hepatocytes', 'Macrophage', 'Tissue_stem_cells', 'Pre-B_cell_CD34-', 'Pro-B_cell_CD34+', 'Unknown']
라벨별 그룹 개수 {1: 28, 0: 12}
cell type :  TGTTTGCATTAA_Control_Participant3           Macrophage
AAACGCAAATTG_Control_Participant3     Epithelial_cells
ACTTTCAGGACG_Control_Participant3     Epithelial_cells
CTTTTACTTTTT_Control_Participant3     Epithelial_cells
GAATTATCAGGA_Control_Participant3     Epithelial_cells
                                            ...       
ACCATATTCAGG_COVID19_Participant21       Keratinocytes
GCCCGTTTCACG_COVID19_Participant21    Epithelial_cells
TATTATCTCTTA_COVID19_Participant21    Epithelial_cells
TTCCGTTTGTCC_COVID19_Participant21    Epithelial_cells
TCGGGATTGGAT_COVID19_Participant21         Neutrophils
Name: singler_annotation, Length: 4807, dtype: string
cell type annotation :  TGTTTGCATTAA_Control_Participant3           Macrophage
AAACGCAAATTG_Control_Participant3     Epithelial_cells
ACTTTCAGGACG_Control_Participant3     Epithelial_cells
CTTTTACTTTTT_Control_Participant3     Epithelial_cells
GAATTATCAGGA_Control_Participant3     Epithelial_cells
                                            ...       
ACCATATTCAGG_COVID19_Participant21       Keratinocytes
GCCCGTTTCACG_COVID19_Participant21    Epithelial_cells
TATTATCTCTTA_COVID19_Participant21    Epithelial_cells
TTCCGTTTGTCC_COVID19_Participant21    Epithelial_cells
TCGGGATTGGAT_COVID19_Participant21         Neutrophils
Name: singler_annotation, Length: 4807, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Macrophage', 'Epithelial_cells', 'Chondrocytes', 'Keratinocytes', 'HSC_CD34+', 'Neurons', 'Gametocytes', 'Embryonic_stem_cells', 'BM', 'Platelets', 'Astrocyte', 'Fibroblasts', 'Smooth_muscle_cells', 'Myelocyte', 'Neuroepithelial_cell', 'NK_cell', 'DC', 'Unknown', 'BM & Prog.', 'T_cells', 'Erythroblast', 'Pro-B_cell_CD34+', 'Pre-B_cell_CD34-', 'Neutrophils', 'Pro-Myelocyte', 'CMP', 'Endothelial_cells', 'MEP', 'Hepatocytes', 'GMP', 'B_cell', 'HSC_-G-CSF', 'Monocyte', 'MSC', 'Tissue_stem_cells', 'Osteoblasts']
라벨별 그룹 개수 {1: 7, 0: 3}
🔍 Split #4
  → train_p_index 환자 수 (환자 단위로 묶인 index list): 40
  → test_p_index 환자 수  (환자 단위로 묶인 index list): 10
  → train 환자 ID: ['COVID19_Participant10', 'COVID19_Participant11', 'COVID19_Participant13', 'COVID19_Participant15', 'COVID19_Participant18', 'COVID19_Participant19', 'COVID19_Participant2', 'COVID19_Participant20', 'COVID19_Participant22', 'COVID19_Participant23', 'COVID19_Participant25', 'COVID19_Participant26', 'COVID19_Participant27', 'COVID19_Participant28', 'COVID19_Participant29', 'COVID19_Participant3', 'COVID19_Participant30', 'COVID19_Participant31', 'COVID19_Participant32', 'COVID19_Participant36', 'COVID19_Participant38', 'COVID19_Participant39', 'COVID19_Participant4', 'COVID19_Participant5', 'COVID19_Participant6', 'COVID19_Participant7', 'COVID19_Participant8', 'COVID19_Participant9', 'Control_Participant1', 'Control_Participant10', 'Control_Participant11', 'Control_Participant12', 'Control_Participant13', 'Control_Participant14', 'Control_Participant15', 'Control_Participant2', 'Control_Participant4', 'Control_Participant5', 'Control_Participant7', 'Control_Participant8']
  → test  환자 ID: ['COVID19_Participant12', 'COVID19_Participant14', 'COVID19_Participant17', 'COVID19_Participant21', 'COVID19_Participant35', 'COVID19_Participant37', 'COVID19_Participant40', 'Control_Participant3', 'Control_Participant6', 'Control_Participant9']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant10, Label: 1
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant18, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant27, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant3, Label: 1
    ID: COVID19_Participant30, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant36, Label: 1
    ID: COVID19_Participant38, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant5, Label: 1
    ID: COVID19_Participant6, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: COVID19_Participant9, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant10, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant12, Label: 0
    ID: Control_Participant13, Label: 0
    ID: Control_Participant14, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant2, Label: 0
    ID: Control_Participant4, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant8, Label: 0
  → test 환자 ID 및 라벨:
    ID: COVID19_Participant12, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant21, Label: 1
    ID: COVID19_Participant35, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: Control_Participant3, Label: 0
    ID: Control_Participant6, Label: 0
    ID: Control_Participant9, Label: 0
전체 데이터 index 길이 50
label_stat (train 환자 라벨 목록) 갯수 40
train_data에서 환자 단위로, train과 validation 나누기
기존 train_p_index 40
기존 (train) label_stat 40
train-vali 분할 후! 
train y 의 classes : {0, 1} valid y 의 classes : {0, 1} label_stat 의 classes : {0, 1}
train_p_index_ 26
valid_p_index 14
test_p_index 10
→ train 환자 ID 및 라벨:
   총 개수: 26
   환자ID=Control_Participant10, Label=0, 셀개수=1645
   환자ID=Control_Participant14, Label=0, 셀개수=274
   환자ID=COVID19_Participant2, Label=1, 셀개수=329
   환자ID=COVID19_Participant39, Label=1, 셀개수=454
   환자ID=COVID19_Participant10, Label=1, 셀개수=18
   환자ID=Control_Participant4, Label=0, 셀개수=440
   환자ID=COVID19_Participant15, Label=1, 셀개수=1003
   환자ID=COVID19_Participant20, Label=1, 셀개수=2033
   환자ID=COVID19_Participant5, Label=1, 셀개수=89
   환자ID=COVID19_Participant13, Label=1, 셀개수=730
   환자ID=COVID19_Participant22, Label=1, 셀개수=865
   환자ID=Control_Participant15, Label=0, 셀개수=528
   환자ID=COVID19_Participant28, Label=1, 셀개수=1079
   환자ID=Control_Participant7, Label=0, 셀개수=762
   환자ID=Control_Participant5, Label=0, 셀개수=717
   환자ID=COVID19_Participant18, Label=1, 셀개수=227
   환자ID=Control_Participant8, Label=0, 셀개수=393
   환자ID=Control_Participant11, Label=0, 셀개수=1164
   환자ID=COVID19_Participant25, Label=1, 셀개수=496
   환자ID=COVID19_Participant30, Label=1, 셀개수=116
   환자ID=COVID19_Participant27, Label=1, 셀개수=93
   환자ID=COVID19_Participant19, Label=1, 셀개수=816
   환자ID=COVID19_Participant7, Label=1, 셀개수=409
   환자ID=COVID19_Participant4, Label=1, 셀개수=1680
   환자ID=COVID19_Participant38, Label=1, 셀개수=51
   환자ID=COVID19_Participant3, Label=1, 셀개수=104
→ valid 환자 ID 및 라벨:
   총 개수: 14
   환자ID=Control_Participant13, Label=0, 셀개수=88
   환자ID=COVID19_Participant29, Label=1, 셀개수=573
   환자ID=COVID19_Participant32, Label=1, 셀개수=1665
   환자ID=COVID19_Participant31, Label=1, 셀개수=410
   환자ID=COVID19_Participant6, Label=1, 셀개수=84
   환자ID=COVID19_Participant23, Label=1, 셀개수=307
   환자ID=Control_Participant2, Label=0, 셀개수=41
   환자ID=Control_Participant1, Label=0, 셀개수=414
   환자ID=COVID19_Participant9, Label=1, 셀개수=86
   환자ID=COVID19_Participant8, Label=1, 셀개수=462
   환자ID=Control_Participant12, Label=0, 셀개수=99
   환자ID=COVID19_Participant36, Label=1, 셀개수=200
   환자ID=COVID19_Participant11, Label=1, 셀개수=382
   환자ID=COVID19_Participant26, Label=1, 셀개수=814
→ test 환자 ID 및 라벨:
   총 개수: 10
   환자ID=COVID19_Participant12, Label=1, 셀개수=102
   환자ID=COVID19_Participant14, Label=1, 셀개수=382
   환자ID=COVID19_Participant17, Label=1, 셀개수=843
   환자ID=COVID19_Participant21, Label=1, 셀개수=39
   환자ID=COVID19_Participant35, Label=1, 셀개수=83
   환자ID=COVID19_Participant37, Label=1, 셀개수=668
   환자ID=COVID19_Participant40, Label=1, 셀개수=381
   환자ID=Control_Participant3, Label=0, 셀개수=1620
   환자ID=Control_Participant6, Label=0, 셀개수=131
   환자ID=Control_Participant9, Label=0, 셀개수=558
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Keratinocytes', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Neurons', 'iPS_cells', 'Embryonic_stem_cells', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
전체 데이터 길이 26947
전체 cell type 길이 0           Keratinocytes
1        Epithelial_cells
2        Epithelial_cells
3        Epithelial_cells
4        Epithelial_cells
               ...       
26942       Keratinocytes
26943    Epithelial_cells
26944    Epithelial_cells
26945    Epithelial_cells
26946         Neutrophils
Length: 26947, dtype: string
cell type의 NaN 개수 체크 0
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:12,  7.66it/s]  2%|▏         | 2/100 [00:00<00:11,  8.70it/s]  3%|▎         | 3/100 [00:00<00:10,  8.95it/s]  4%|▍         | 4/100 [00:00<00:13,  6.91it/s]  5%|▌         | 5/100 [00:00<00:13,  7.28it/s]  6%|▌         | 6/100 [00:00<00:12,  7.29it/s]  7%|▋         | 7/100 [00:00<00:12,  7.39it/s]  8%|▊         | 8/100 [00:01<00:12,  7.24it/s]  9%|▉         | 9/100 [00:01<00:13,  6.88it/s] 10%|█         | 10/100 [00:01<00:12,  7.36it/s] 11%|█         | 11/100 [00:01<00:11,  7.83it/s] 12%|█▏        | 12/100 [00:01<00:10,  8.21it/s] 13%|█▎        | 13/100 [00:01<00:10,  8.38it/s] 14%|█▍        | 14/100 [00:01<00:10,  8.06it/s] 15%|█▌        | 15/100 [00:01<00:10,  8.20it/s] 16%|█▌        | 16/100 [00:02<00:10,  8.02it/s] 17%|█▋        | 17/100 [00:02<00:10,  8.29it/s] 18%|█▊        | 18/100 [00:02<00:09,  8.41it/s] 19%|█▉        | 19/100 [00:02<00:09,  8.22it/s] 20%|██        | 20/100 [00:02<00:09,  8.06it/s] 21%|██        | 21/100 [00:02<00:10,  7.60it/s] 22%|██▏       | 22/100 [00:02<00:09,  7.97it/s] 23%|██▎       | 23/100 [00:02<00:09,  8.34it/s] 24%|██▍       | 24/100 [00:03<00:09,  8.18it/s] 25%|██▌       | 25/100 [00:03<00:10,  7.08it/s] 26%|██▌       | 26/100 [00:03<00:09,  7.60it/s] 27%|██▋       | 27/100 [00:03<00:09,  7.90it/s] 28%|██▊       | 28/100 [00:03<00:08,  8.29it/s] 29%|██▉       | 29/100 [00:03<00:08,  7.99it/s] 30%|███       | 30/100 [00:03<00:08,  7.86it/s] 31%|███       | 31/100 [00:03<00:08,  8.04it/s] 32%|███▏      | 32/100 [00:04<00:09,  7.46it/s] 33%|███▎      | 33/100 [00:04<00:08,  7.64it/s] 34%|███▍      | 34/100 [00:04<00:08,  7.75it/s] 35%|███▌      | 35/100 [00:04<00:09,  6.73it/s] 36%|███▌      | 36/100 [00:04<00:09,  6.98it/s] 37%|███▋      | 37/100 [00:04<00:08,  7.03it/s] 38%|███▊      | 38/100 [00:04<00:08,  7.38it/s] 39%|███▉      | 39/100 [00:05<00:08,  7.42it/s] 40%|████      | 40/100 [00:05<00:07,  7.66it/s] 41%|████      | 41/100 [00:05<00:07,  7.97it/s] 42%|████▏     | 42/100 [00:05<00:08,  6.97it/s] 43%|████▎     | 43/100 [00:05<00:07,  7.40it/s] 44%|████▍     | 44/100 [00:05<00:07,  7.86it/s] 45%|████▌     | 45/100 [00:05<00:06,  8.07it/s] 46%|████▌     | 46/100 [00:05<00:07,  7.42it/s] 47%|████▋     | 47/100 [00:06<00:07,  7.26it/s] 48%|████▊     | 48/100 [00:06<00:06,  7.56it/s] 49%|████▉     | 49/100 [00:06<00:06,  7.71it/s] 50%|█████     | 50/100 [00:06<00:06,  7.59it/s] 51%|█████     | 51/100 [00:06<00:06,  7.88it/s] 52%|█████▏    | 52/100 [00:06<00:05,  8.31it/s] 53%|█████▎    | 53/100 [00:06<00:05,  8.52it/s] 54%|█████▍    | 54/100 [00:07<00:06,  7.25it/s] 55%|█████▌    | 55/100 [00:07<00:06,  7.09it/s] 56%|█████▌    | 56/100 [00:07<00:05,  7.58it/s] 57%|█████▋    | 57/100 [00:07<00:05,  7.77it/s] 58%|█████▊    | 58/100 [00:07<00:05,  7.54it/s] 59%|█████▉    | 59/100 [00:07<00:05,  7.66it/s] 60%|██████    | 60/100 [00:07<00:05,  7.24it/s] 61%|██████    | 61/100 [00:07<00:05,  7.37it/s] 62%|██████▏   | 62/100 [00:08<00:05,  7.49it/s] 63%|██████▎   | 63/100 [00:08<00:05,  7.22it/s] 64%|██████▍   | 64/100 [00:08<00:05,  7.06it/s] 65%|██████▌   | 65/100 [00:08<00:04,  7.31it/s] 66%|██████▌   | 66/100 [00:08<00:04,  7.47it/s] 67%|██████▋   | 67/100 [00:08<00:04,  7.32it/s] 68%|██████▊   | 68/100 [00:08<00:04,  7.36it/s] 69%|██████▉   | 69/100 [00:09<00:04,  7.38it/s] 70%|███████   | 70/100 [00:09<00:03,  7.55it/s] 71%|███████   | 71/100 [00:09<00:03,  7.48it/s] 72%|███████▏  | 72/100 [00:09<00:03,  7.65it/s] 73%|███████▎  | 73/100 [00:09<00:03,  7.80it/s] 74%|███████▍  | 74/100 [00:09<00:03,  7.79it/s] 75%|███████▌  | 75/100 [00:09<00:03,  7.00it/s] 76%|███████▌  | 76/100 [00:09<00:03,  7.24it/s] 77%|███████▋  | 77/100 [00:10<00:03,  7.15it/s] 78%|███████▊  | 78/100 [00:10<00:03,  7.33it/s] 79%|███████▉  | 79/100 [00:10<00:02,  7.52it/s] 80%|████████  | 80/100 [00:10<00:02,  7.19it/s] 81%|████████  | 81/100 [00:10<00:02,  7.46it/s] 82%|████████▏ | 82/100 [00:10<00:02,  7.38it/s] 83%|████████▎ | 83/100 [00:10<00:02,  7.24it/s] 84%|████████▍ | 84/100 [00:11<00:02,  7.62it/s] 85%|████████▌ | 85/100 [00:11<00:01,  7.56it/s] 86%|████████▌ | 86/100 [00:11<00:01,  7.42it/s] 87%|████████▋ | 87/100 [00:11<00:01,  7.48it/s] 88%|████████▊ | 88/100 [00:11<00:01,  7.06it/s] 89%|████████▉ | 89/100 [00:11<00:01,  7.33it/s] 90%|█████████ | 90/100 [00:11<00:01,  7.34it/s] 91%|█████████ | 91/100 [00:12<00:01,  7.43it/s] 92%|█████████▏| 92/100 [00:12<00:01,  7.32it/s] 93%|█████████▎| 93/100 [00:12<00:00,  7.34it/s] 94%|█████████▍| 94/100 [00:12<00:00,  7.56it/s] 95%|█████████▌| 95/100 [00:12<00:00,  7.85it/s] 96%|█████████▌| 96/100 [00:12<00:00,  7.98it/s] 97%|█████████▋| 97/100 [00:12<00:00,  7.65it/s] 98%|█████████▊| 98/100 [00:12<00:00,  7.85it/s] 99%|█████████▉| 99/100 [00:13<00:00,  7.08it/s]100%|██████████| 100/100 [00:13<00:00,  7.17it/s]100%|██████████| 100/100 [00:13<00:00,  7.56it/s]
[I 2025-08-31 20:59:32,901] A new study created in memory with name: no-name-2e1d64ff-a3de-48eb-8862-14907ad919f7
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 25.64 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.749720, Valid_loss 0.734458
Epoch 2, Train Loss 0.740606, Valid_loss 0.722719
Epoch 3, Train Loss 0.720314, Valid_loss 0.712120
Epoch 4, Train Loss 0.710077, Valid_loss 0.698733
Epoch 5, Train Loss 0.696262, Valid_loss 0.685872
Epoch 6, Train Loss 0.683039, Valid_loss 0.675016
Epoch 7, Train Loss 0.660711, Valid_loss 0.661371
Epoch 8, Train Loss 0.652317, Valid_loss 0.651075
Epoch 9, Train Loss 0.645871, Valid_loss 0.645740
Epoch 10, Train Loss 0.640403, Valid_loss 0.639648
Epoch 11, Train Loss 0.653667, Valid_loss 0.637382
Epoch 12, Train Loss 0.647719, Valid_loss 0.634242
Epoch 13, Train Loss 0.634317, Valid_loss 0.632187
Epoch 14, Train Loss 0.628795, Valid_loss 0.629134
Epoch 15, Train Loss 0.631613, Valid_loss 0.626976
Epoch 16, Train Loss 0.632785, Valid_loss 0.623664
Epoch 17, Train Loss 0.624868, Valid_loss 0.623483
Epoch 18, Train Loss 0.656129, Valid_loss 0.618056
Epoch 19, Train Loss 0.614811, Valid_loss 0.615464
Epoch 20, Train Loss 0.643610, Valid_loss 0.614430
Epoch 21, Train Loss 0.611433, Valid_loss 0.613506
Epoch 22, Train Loss 0.603123, Valid_loss 0.611735
Epoch 23, Train Loss 0.620763, Valid_loss 0.609064
Epoch 24, Train Loss 0.620311, Valid_loss 0.604167
Epoch 25, Train Loss 0.607498, Valid_loss 0.604379
Epoch 26, Train Loss 0.594681, Valid_loss 0.603285
Epoch 27, Train Loss 0.630306, Valid_loss 0.607097
Epoch 28, Train Loss 0.584013, Valid_loss 0.597324
Epoch 29, Train Loss 0.598561, Valid_loss 0.601977
Epoch 30, Train Loss 0.563911, Valid_loss 0.599049
Epoch 31, Train Loss 0.591438, Valid_loss 0.590462
Epoch 32, Train Loss 0.572513, Valid_loss 0.587449
Epoch 33, Train Loss 0.590846, Valid_loss 0.587901
Epoch 34, Train Loss 0.582550, Valid_loss 0.585968
Epoch 35, Train Loss 0.565419, Valid_loss 0.584010
Epoch 36, Train Loss 0.588181, Valid_loss 0.568895
Epoch 37, Train Loss 0.575828, Valid_loss 0.576940
Epoch 38, Train Loss 0.562825, Valid_loss 0.567855
Epoch 39, Train Loss 0.577879, Valid_loss 0.568575
Epoch 40, Train Loss 0.573839, Valid_loss 0.564000
Epoch 41, Train Loss 0.532631, Valid_loss 0.573830
Epoch 42, Train Loss 0.567746, Valid_loss 0.560264
Epoch 43, Train Loss 0.577566, Valid_loss 0.567171
Epoch 44, Train Loss 0.563542, Valid_loss 0.561027
Epoch 45, Train Loss 0.554539, Valid_loss 0.552944
Epoch 46, Train Loss 0.553206, Valid_loss 0.550418
Epoch 47, Train Loss 0.568253, Valid_loss 0.554898
Epoch 48, Train Loss 0.549756, Valid_loss 0.544533
Epoch 49, Train Loss 0.559184, Valid_loss 0.549573
Epoch 50, Train Loss 0.574743, Valid_loss 0.548052
Epoch 51, Train Loss 0.538225, Valid_loss 0.547202
Epoch 52, Train Loss 0.536968, Valid_loss 0.553687
Epoch 53, Train Loss 0.549377, Valid_loss 0.540714
Epoch 54, Train Loss 0.554358, Valid_loss 0.544366
Epoch 55, Train Loss 0.550180, Valid_loss 0.542977
Epoch 56, Train Loss 0.547627, Valid_loss 0.543379
Epoch 57, Train Loss 0.535428, Valid_loss 0.544971
[I 2025-08-31 21:04:09,679] Trial 0 finished with value: 0.5407141042607171 and parameters: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 4, 'dropout': 0.3, 'weight_decay': 0.01, 'emb_dim': 8, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.5407141042607171.
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 25.64 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.630224, Valid_loss 0.603212
Epoch 2, Train Loss 0.593222, Valid_loss 0.599097
Epoch 3, Train Loss 0.561070, Valid_loss 0.599612
Epoch 4, Train Loss 0.563605, Valid_loss 0.603362
Epoch 5, Train Loss 0.546860, Valid_loss 0.601349
Epoch 6, Train Loss 0.549311, Valid_loss 0.608736
Epoch 7, Train Loss 0.534787, Valid_loss 0.605315
Epoch 8, Train Loss 0.563211, Valid_loss 0.604772
Epoch 9, Train Loss 0.577159, Valid_loss 0.598904
Epoch 10, Train Loss 0.541410, Valid_loss 0.600200
Epoch 11, Train Loss 0.563672, Valid_loss 0.604220
Epoch 12, Train Loss 0.545871, Valid_loss 0.602354
Epoch 13, Train Loss 0.539700, Valid_loss 0.603367
Epoch 14, Train Loss 0.549090, Valid_loss 0.603090
Epoch 15, Train Loss 0.548788, Valid_loss 0.602952
Epoch 16, Train Loss 0.538135, Valid_loss 0.605172
Epoch 17, Train Loss 0.561927, Valid_loss 0.600118
Epoch 18, Train Loss 0.551634, Valid_loss 0.598742
Epoch 19, Train Loss 0.545246, Valid_loss 0.601077
Epoch 20, Train Loss 0.541506, Valid_loss 0.601756
Epoch 21, Train Loss 0.556186, Valid_loss 0.602296
Epoch 22, Train Loss 0.548005, Valid_loss 0.599698
Epoch 23, Train Loss 0.538954, Valid_loss 0.601428
Epoch 24, Train Loss 0.538608, Valid_loss 0.604205
Epoch 25, Train Loss 0.541756, Valid_loss 0.607599
Epoch 26, Train Loss 0.547216, Valid_loss 0.602866
Epoch 27, Train Loss 0.535928, Valid_loss 0.602724
Epoch 28, Train Loss 0.536478, Valid_loss 0.605500
Epoch 29, Train Loss 0.546447, Valid_loss 0.607324
Epoch 30, Train Loss 0.549401, Valid_loss 0.602905
Epoch 31, Train Loss 0.542093, Valid_loss 0.601028
Epoch 32, Train Loss 0.548562, Valid_loss 0.602424
Epoch 33, Train Loss 0.538826, Valid_loss 0.602752
Epoch 34, Train Loss 0.542215, Valid_loss 0.603073
Epoch 35, Train Loss 0.541660, Valid_loss 0.601791
Epoch 36, Train Loss 0.543653, Valid_loss 0.604097
Epoch 37, Train Loss 0.539843, Valid_loss 0.603555
Epoch 38, Train Loss 0.542629, Valid_loss 0.604167
Epoch 39, Train Loss 0.549371, Valid_loss 0.602021
Epoch 40, Train Loss 0.541997, Valid_loss 0.602914
Epoch 41, Train Loss 0.540340, Valid_loss 0.603487
Epoch 42, Train Loss 0.542687, Valid_loss 0.603520
Epoch 43, Train Loss 0.538711, Valid_loss 0.603827
Epoch 44, Train Loss 0.542502, Valid_loss 0.603587
Epoch 45, Train Loss 0.544592, Valid_loss 0.603188
Epoch 46, Train Loss 0.542425, Valid_loss 0.604201
Epoch 47, Train Loss 0.540487, Valid_loss 0.603954
Epoch 48, Train Loss 0.542379, Valid_loss 0.605425
Epoch 49, Train Loss 0.544984, Valid_loss 0.604386
Epoch 50, Train Loss 0.540908, Valid_loss 0.603799
Epoch 51, Train Loss 0.538226, Valid_loss 0.604161
Epoch 52, Train Loss 0.532121, Valid_loss 0.604822
[I 2025-08-31 21:07:50,312] Trial 1 finished with value: 0.5987424062831062 and parameters: {'learning_rate': 0.01, 'epochs': 100, 'heads': 2, 'dropout': 0.5, 'weight_decay': 0.01, 'emb_dim': 8, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.5407141042607171.
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 29.04 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.499112, Valid_loss 0.400805
Epoch 2, Train Loss 0.327904, Valid_loss 0.371903
Epoch 3, Train Loss 0.274082, Valid_loss 0.305140
Epoch 4, Train Loss 0.255354, Valid_loss 0.371978
Epoch 5, Train Loss 0.296484, Valid_loss 0.404416
Epoch 6, Train Loss 0.256905, Valid_loss 0.412193
Epoch 7, Train Loss 0.219834, Valid_loss 0.377224
Epoch 8, Train Loss 0.216831, Valid_loss 0.396320
Epoch 9, Train Loss 0.209123, Valid_loss 0.309152
Epoch 10, Train Loss 0.205646, Valid_loss 0.281328
Epoch 11, Train Loss 0.209917, Valid_loss 0.398913
Epoch 12, Train Loss 0.205171, Valid_loss 0.286259
Epoch 13, Train Loss 0.216312, Valid_loss 0.320429
Epoch 14, Train Loss 0.199793, Valid_loss 0.273111
Epoch 15, Train Loss 0.195340, Valid_loss 0.269446
Epoch 16, Train Loss 0.190235, Valid_loss 0.266636
Epoch 17, Train Loss 0.202042, Valid_loss 0.397127
Epoch 18, Train Loss 0.210485, Valid_loss 0.250230
Epoch 19, Train Loss 0.210457, Valid_loss 0.333052
Epoch 20, Train Loss 0.208484, Valid_loss 0.322603
Epoch 21, Train Loss 0.202979, Valid_loss 0.252192
Epoch 22, Train Loss 0.210710, Valid_loss 0.296441
Epoch 23, Train Loss 0.196304, Valid_loss 0.303956
Epoch 24, Train Loss 0.189444, Valid_loss 0.319796
Epoch 25, Train Loss 0.196672, Valid_loss 0.270909
Epoch 26, Train Loss 0.187765, Valid_loss 0.280025
Epoch 27, Train Loss 0.186231, Valid_loss 0.289913
Epoch 28, Train Loss 0.186197, Valid_loss 0.271115
Epoch 29, Train Loss 0.190440, Valid_loss 0.251944
Epoch 30, Train Loss 0.199889, Valid_loss 0.263040
Epoch 31, Train Loss 0.189780, Valid_loss 0.276827
Epoch 32, Train Loss 0.186034, Valid_loss 0.284288
Epoch 33, Train Loss 0.192135, Valid_loss 0.248353
Epoch 34, Train Loss 0.211846, Valid_loss 0.255471
Epoch 35, Train Loss 0.214602, Valid_loss 0.367665
Epoch 36, Train Loss 0.197449, Valid_loss 0.312814
Epoch 37, Train Loss 0.186729, Valid_loss 0.333890
Epoch 38, Train Loss 0.186872, Valid_loss 0.297527
Epoch 39, Train Loss 0.185682, Valid_loss 0.331892
Epoch 40, Train Loss 0.182528, Valid_loss 0.296010
Epoch 41, Train Loss 0.184529, Valid_loss 0.294912
Epoch 42, Train Loss 0.184447, Valid_loss 0.261450
Epoch 43, Train Loss 0.186577, Valid_loss 0.284870
Epoch 44, Train Loss 0.184919, Valid_loss 0.250402
Epoch 45, Train Loss 0.187443, Valid_loss 0.308701
Epoch 46, Train Loss 0.192486, Valid_loss 0.265121
Epoch 47, Train Loss 0.190011, Valid_loss 0.253072
Epoch 48, Train Loss 0.210540, Valid_loss 0.290540
Epoch 49, Train Loss 0.216730, Valid_loss 0.243518
Epoch 50, Train Loss 0.192838, Valid_loss 0.249811
Epoch 51, Train Loss 0.187463, Valid_loss 0.268235
Epoch 52, Train Loss 0.182544, Valid_loss 0.283019
[I 2025-08-31 21:11:26,264] Trial 2 finished with value: 0.24351773304598673 and parameters: {'learning_rate': 0.001, 'epochs': 100, 'heads': 2, 'dropout': 0.0, 'weight_decay': 0.01, 'emb_dim': 64, 'augment_num': 100, 'pca': False}. Best is trial 2 with value: 0.24351773304598673.
선택된 trial params: {'learning_rate': 0.001, 'epochs': 100, 'heads': 2, 'dropout': 0.0, 'weight_decay': 0.01, 'emb_dim': 64, 'augment_num': 100, 'pca': False}
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=10, batch_size=1 -> steps=10
output_class :  1
Memory Allocated: 29.04 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.581493, Valid_loss 0.596186
Epoch 2, Train Loss 0.507362, Valid_loss 0.512929
Epoch 3, Train Loss 0.432048, Valid_loss 0.402376
Epoch 4, Train Loss 0.360772, Valid_loss 0.380231
Epoch 5, Train Loss 0.292838, Valid_loss 0.394979
Epoch 6, Train Loss 0.264872, Valid_loss 0.329797
Epoch 7, Train Loss 0.242598, Valid_loss 0.379405
Epoch 8, Train Loss 0.233886, Valid_loss 0.298744
Epoch 9, Train Loss 0.249499, Valid_loss 0.341227
Epoch 10, Train Loss 0.227759, Valid_loss 0.348102
Epoch 11, Train Loss 0.212376, Valid_loss 0.338374
Epoch 12, Train Loss 0.212132, Valid_loss 0.280627
Epoch 13, Train Loss 0.206292, Valid_loss 0.291478
Epoch 14, Train Loss 0.202845, Valid_loss 0.283456
Epoch 15, Train Loss 0.206240, Valid_loss 0.281295
Epoch 16, Train Loss 0.202584, Valid_loss 0.337845
Epoch 17, Train Loss 0.201834, Valid_loss 0.269555
Epoch 18, Train Loss 0.220725, Valid_loss 0.306065
Epoch 19, Train Loss 0.208946, Valid_loss 0.402912
Epoch 20, Train Loss 0.229043, Valid_loss 0.269586
Epoch 21, Train Loss 0.247350, Valid_loss 0.299666
Epoch 22, Train Loss 0.212245, Valid_loss 0.279805
Epoch 23, Train Loss 0.214409, Valid_loss 0.254515
Epoch 24, Train Loss 0.197786, Valid_loss 0.283637
Epoch 25, Train Loss 0.198256, Valid_loss 0.290977
Epoch 26, Train Loss 0.192509, Valid_loss 0.289904
Epoch 27, Train Loss 0.187544, Valid_loss 0.292568
Epoch 28, Train Loss 0.188893, Valid_loss 0.289101
Epoch 29, Train Loss 0.188495, Valid_loss 0.294096
Epoch 30, Train Loss 0.186178, Valid_loss 0.291521
Epoch 31, Train Loss 0.187770, Valid_loss 0.246300
Epoch 32, Train Loss 0.189282, Valid_loss 0.286961
Epoch 33, Train Loss 0.204140, Valid_loss 0.311455
Epoch 34, Train Loss 0.194750, Valid_loss 0.249496
Epoch 35, Train Loss 0.187037, Valid_loss 0.308756
Epoch 36, Train Loss 0.187264, Valid_loss 0.253132
Epoch 37, Train Loss 0.187440, Valid_loss 0.378459
Epoch 38, Train Loss 0.193350, Valid_loss 0.268621
Epoch 39, Train Loss 0.263582, Valid_loss 0.273486
Epoch 40, Train Loss 0.212057, Valid_loss 0.338120
Epoch 41, Train Loss 0.189357, Valid_loss 0.286750
Epoch 42, Train Loss 0.188215, Valid_loss 0.306617
Epoch 43, Train Loss 0.182038, Valid_loss 0.278819
Epoch 44, Train Loss 0.183080, Valid_loss 0.302167
Epoch 45, Train Loss 0.185412, Valid_loss 0.248114
Epoch 46, Train Loss 0.190113, Valid_loss 0.240275
Epoch 47, Train Loss 0.202904, Valid_loss 0.334473
Epoch 48, Train Loss 0.204036, Valid_loss 0.404191
Epoch 49, Train Loss 0.202304, Valid_loss 0.287264
Epoch 50, Train Loss 0.186668, Valid_loss 0.304450
Epoch 51, Train Loss 0.182975, Valid_loss 0.266764
Epoch 52, Train Loss 0.179480, Valid_loss 0.291281
Epoch 53, Train Loss 0.180004, Valid_loss 0.295559
환자ID=COVID19_Participant12 -- true: 1 -- pred: 1
환자ID=COVID19_Participant14 -- true: 1 -- pred: 1
환자ID=COVID19_Participant17 -- true: 1 -- pred: 1
환자ID=COVID19_Participant21 -- true: 1 -- pred: 1
환자ID=COVID19_Participant35 -- true: 1 -- pred: 0
환자ID=COVID19_Participant37 -- true: 1 -- pred: 1
환자ID=COVID19_Participant40 -- true: 1 -- pred: 1
환자ID=Control_Participant3 -- true: 0 -- pred: 0
환자ID=Control_Participant6 -- true: 0 -- pred: 0
환자ID=Control_Participant9 -- true: 0 -- pred: 0
Best performance: Epoch 46, Loss 0.190113, Test ACC 0.900000, Test AUC 1.000000, Test Recall 0.857143, Test Precision 1.000000
Confusion Matrix:
 [3 0 1 6]
✅ Total valid splits used: 4
🔁 Repeat 4, Fold 4
cell type :  TTGCGGTGACCA_COVID19_Participant31    Epithelial_cells
AGGCTCGAACTG_COVID19_Participant31    Epithelial_cells
TATCCGTATGTT_COVID19_Participant31             NK_cell
CAGACAGCGGCT_COVID19_Participant31    Epithelial_cells
CAAAGAGAACTA_COVID19_Participant31    Epithelial_cells
                                            ...       
GCAGGGAACTCC_COVID19_Participant30    Epithelial_cells
CAGCACCGAGCC_COVID19_Participant30    Epithelial_cells
GCCCCTTGTGAT_COVID19_Participant30    Epithelial_cells
GTGTTGTGTGTC_COVID19_Participant30              B_cell
TAACACTCACTT_COVID19_Participant30           Myelocyte
Name: singler_annotation, Length: 20471, dtype: string
cell type annotation :  TTGCGGTGACCA_COVID19_Participant31    Epithelial_cells
AGGCTCGAACTG_COVID19_Participant31    Epithelial_cells
TATCCGTATGTT_COVID19_Participant31             NK_cell
CAGACAGCGGCT_COVID19_Participant31    Epithelial_cells
CAAAGAGAACTA_COVID19_Participant31    Epithelial_cells
                                            ...       
GCAGGGAACTCC_COVID19_Participant30    Epithelial_cells
CAGCACCGAGCC_COVID19_Participant30    Epithelial_cells
GCCCCTTGTGAT_COVID19_Participant30    Epithelial_cells
GTGTTGTGTGTC_COVID19_Participant30              B_cell
TAACACTCACTT_COVID19_Participant30           Myelocyte
Name: singler_annotation, Length: 20471, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Epithelial_cells', 'NK_cell', 'Keratinocytes', 'Macrophage', 'Neurons', 'T_cells', 'Monocyte', 'Chondrocytes', 'MEP', 'Neutrophils', 'Gametocytes', 'Endothelial_cells', 'HSC_CD34+', 'Hepatocytes', 'Tissue_stem_cells', 'Erythroblast', 'iPS_cells', 'DC', 'B_cell', 'Myelocyte', 'Astrocyte', 'Smooth_muscle_cells', 'Embryonic_stem_cells', 'HSC_-G-CSF', 'CMP', 'Osteoblasts', 'Platelets', 'BM & Prog.', 'MSC', 'Neuroepithelial_cell', 'Pre-B_cell_CD34-', 'BM', 'GMP', 'Pro-B_cell_CD34+', 'Pro-Myelocyte', 'Fibroblasts', 'Unknown']
라벨별 그룹 개수 {1: 28, 0: 12}
cell type :  GTCGGGGGGTGG_Control_Participant7           Keratinocytes
CAAATCAATTAT_Control_Participant7        Epithelial_cells
ATACAATTGACA_Control_Participant7        Epithelial_cells
CTGTTAATGAGA_Control_Participant7        Epithelial_cells
CTTCACATTATT_Control_Participant7        Epithelial_cells
                                             ...         
GCGCCCGTGTTA_COVID19_Participant27       Epithelial_cells
TTGATCCGTGGC_COVID19_Participant27                T_cells
CGCGACTACTCT_COVID19_Participant27       Epithelial_cells
AAACGCTTGTTA_COVID19_Participant27       Epithelial_cells
CATTGGGGGAAA_COVID19_Participant27    Smooth_muscle_cells
Name: singler_annotation, Length: 6476, dtype: string
cell type annotation :  GTCGGGGGGTGG_Control_Participant7           Keratinocytes
CAAATCAATTAT_Control_Participant7        Epithelial_cells
ATACAATTGACA_Control_Participant7        Epithelial_cells
CTGTTAATGAGA_Control_Participant7        Epithelial_cells
CTTCACATTATT_Control_Participant7        Epithelial_cells
                                             ...         
GCGCCCGTGTTA_COVID19_Participant27       Epithelial_cells
TTGATCCGTGGC_COVID19_Participant27                T_cells
CGCGACTACTCT_COVID19_Participant27       Epithelial_cells
AAACGCTTGTTA_COVID19_Participant27       Epithelial_cells
CATTGGGGGAAA_COVID19_Participant27    Smooth_muscle_cells
Name: singler_annotation, Length: 6476, dtype: string
✅ [DEBUG] manual_annotation 유니크값: ['Keratinocytes', 'Epithelial_cells', 'Neurons', 'iPS_cells', 'Embryonic_stem_cells', 'Astrocyte', 'DC', 'Gametocytes', 'HSC_-G-CSF', 'Smooth_muscle_cells', 'BM & Prog.', 'Monocyte', 'Myelocyte', 'BM', 'Endothelial_cells', 'Osteoblasts', 'Platelets', 'Erythroblast', 'NK_cell', 'T_cells', 'Chondrocytes', 'HSC_CD34+', 'CMP', 'Neutrophils', 'Fibroblasts', 'MEP', 'Neuroepithelial_cell', 'MSC', 'Pro-Myelocyte', 'B_cell', 'GMP', 'Hepatocytes', 'Macrophage', 'Tissue_stem_cells', 'Pre-B_cell_CD34-', 'Pro-B_cell_CD34+']
라벨별 그룹 개수 {1: 7, 0: 3}
🔍 Split #5
  → train_p_index 환자 수 (환자 단위로 묶인 index list): 40
  → test_p_index 환자 수  (환자 단위로 묶인 index list): 10
  → train 환자 ID: ['COVID19_Participant10', 'COVID19_Participant11', 'COVID19_Participant12', 'COVID19_Participant14', 'COVID19_Participant17', 'COVID19_Participant18', 'COVID19_Participant19', 'COVID19_Participant2', 'COVID19_Participant20', 'COVID19_Participant21', 'COVID19_Participant22', 'COVID19_Participant26', 'COVID19_Participant28', 'COVID19_Participant29', 'COVID19_Participant3', 'COVID19_Participant30', 'COVID19_Participant31', 'COVID19_Participant32', 'COVID19_Participant35', 'COVID19_Participant37', 'COVID19_Participant38', 'COVID19_Participant39', 'COVID19_Participant40', 'COVID19_Participant5', 'COVID19_Participant6', 'COVID19_Participant7', 'COVID19_Participant8', 'COVID19_Participant9', 'Control_Participant1', 'Control_Participant10', 'Control_Participant12', 'Control_Participant13', 'Control_Participant14', 'Control_Participant15', 'Control_Participant3', 'Control_Participant4', 'Control_Participant5', 'Control_Participant6', 'Control_Participant8', 'Control_Participant9']
  → test  환자 ID: ['COVID19_Participant13', 'COVID19_Participant15', 'COVID19_Participant23', 'COVID19_Participant25', 'COVID19_Participant27', 'COVID19_Participant36', 'COVID19_Participant4', 'Control_Participant11', 'Control_Participant2', 'Control_Participant7']
  → train 환자 ID 및 라벨:
    ID: COVID19_Participant10, Label: 1
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant12, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant18, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant21, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant3, Label: 1
    ID: COVID19_Participant30, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant35, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant38, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: COVID19_Participant5, Label: 1
    ID: COVID19_Participant6, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: COVID19_Participant9, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant10, Label: 0
    ID: Control_Participant12, Label: 0
    ID: Control_Participant13, Label: 0
    ID: Control_Participant14, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant4, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant6, Label: 0
    ID: Control_Participant8, Label: 0
    ID: Control_Participant9, Label: 0
  → test 환자 ID 및 라벨:
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant27, Label: 1
    ID: COVID19_Participant36, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: Control_Participant11, Label: 0
    ID: Control_Participant2, Label: 0
    ID: Control_Participant7, Label: 0
전체 데이터 index 길이 50
label_stat (train 환자 라벨 목록) 갯수 40
train_data에서 환자 단위로, train과 validation 나누기
기존 train_p_index 40
기존 (train) label_stat 40
train-vali 분할 후! 
train y 의 classes : {0, 1} valid y 의 classes : {0, 1} label_stat 의 classes : {0, 1}
train_p_index_ 26
valid_p_index 14
test_p_index 10
→ train 환자 ID 및 라벨:
   총 개수: 26
   환자ID=Control_Participant10, Label=0, 셀개수=1645
   환자ID=Control_Participant15, Label=0, 셀개수=528
   환자ID=COVID19_Participant19, Label=1, 셀개수=816
   환자ID=COVID19_Participant39, Label=1, 셀개수=454
   환자ID=COVID19_Participant10, Label=1, 셀개수=18
   환자ID=Control_Participant5, Label=0, 셀개수=717
   환자ID=COVID19_Participant14, Label=1, 셀개수=382
   환자ID=COVID19_Participant2, Label=1, 셀개수=329
   환자ID=COVID19_Participant5, Label=1, 셀개수=89
   환자ID=COVID19_Participant12, Label=1, 셀개수=102
   환자ID=COVID19_Participant20, Label=1, 셀개수=2033
   환자ID=Control_Participant3, Label=0, 셀개수=1620
   환자ID=COVID19_Participant29, Label=1, 셀개수=573
   환자ID=Control_Participant8, Label=0, 셀개수=393
   환자ID=Control_Participant6, Label=0, 셀개수=131
   환자ID=COVID19_Participant17, Label=1, 셀개수=843
   환자ID=Control_Participant9, Label=0, 셀개수=558
   환자ID=Control_Participant12, Label=0, 셀개수=99
   환자ID=COVID19_Participant22, Label=1, 셀개수=865
   환자ID=COVID19_Participant31, Label=1, 셀개수=410
   환자ID=COVID19_Participant28, Label=1, 셀개수=1079
   환자ID=COVID19_Participant18, Label=1, 셀개수=227
   환자ID=COVID19_Participant7, Label=1, 셀개수=409
   환자ID=COVID19_Participant40, Label=1, 셀개수=381
   환자ID=COVID19_Participant38, Label=1, 셀개수=51
   환자ID=COVID19_Participant30, Label=1, 셀개수=116
→ valid 환자 ID 및 라벨:
   총 개수: 14
   환자ID=Control_Participant14, Label=0, 셀개수=274
   환자ID=COVID19_Participant3, Label=1, 셀개수=104
   환자ID=COVID19_Participant35, Label=1, 셀개수=83
   환자ID=COVID19_Participant32, Label=1, 셀개수=1665
   환자ID=COVID19_Participant6, Label=1, 셀개수=84
   환자ID=COVID19_Participant21, Label=1, 셀개수=39
   환자ID=Control_Participant4, Label=0, 셀개수=440
   환자ID=Control_Participant1, Label=0, 셀개수=414
   환자ID=COVID19_Participant9, Label=1, 셀개수=86
   환자ID=COVID19_Participant8, Label=1, 셀개수=462
   환자ID=Control_Participant13, Label=0, 셀개수=88
   환자ID=COVID19_Participant37, Label=1, 셀개수=668
   환자ID=COVID19_Participant11, Label=1, 셀개수=382
   환자ID=COVID19_Participant26, Label=1, 셀개수=814
→ test 환자 ID 및 라벨:
   총 개수: 10
   환자ID=COVID19_Participant13, Label=1, 셀개수=730
   환자ID=COVID19_Participant15, Label=1, 셀개수=1003
   환자ID=COVID19_Participant23, Label=1, 셀개수=307
   환자ID=COVID19_Participant25, Label=1, 셀개수=496
   환자ID=COVID19_Participant27, Label=1, 셀개수=93
   환자ID=COVID19_Participant36, Label=1, 셀개수=200
   환자ID=COVID19_Participant4, Label=1, 셀개수=1680
   환자ID=Control_Participant11, Label=0, 셀개수=1164
   환자ID=Control_Participant2, Label=0, 셀개수=41
   환자ID=Control_Participant7, Label=0, 셀개수=762
✅ Checking cell_type before mixups...
Unique types: {<class 'str'>}
Example values (first 10): ['Epithelial_cells', 'Epithelial_cells', 'NK_cell', 'Epithelial_cells', 'Epithelial_cells', 'Keratinocytes', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells', 'Epithelial_cells']
NaN exists? False
🔍 isna count: 0
🧪 Types in set(cell_type): {<class 'str'>}
전체 데이터 길이 26947
전체 cell type 길이 0           Epithelial_cells
1           Epithelial_cells
2                    NK_cell
3           Epithelial_cells
4           Epithelial_cells
                ...         
26942       Epithelial_cells
26943                T_cells
26944       Epithelial_cells
26945       Epithelial_cells
26946    Smooth_muscle_cells
Length: 26947, dtype: string
cell type의 NaN 개수 체크 0
======= sample mixup ... ============
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:13,  7.51it/s]  2%|▏         | 2/100 [00:00<00:12,  7.68it/s]  3%|▎         | 3/100 [00:00<00:13,  7.32it/s]  4%|▍         | 4/100 [00:00<00:12,  7.74it/s]  5%|▌         | 5/100 [00:00<00:12,  7.56it/s]  6%|▌         | 6/100 [00:00<00:11,  7.94it/s]  7%|▋         | 7/100 [00:00<00:12,  7.66it/s]  8%|▊         | 8/100 [00:01<00:11,  7.93it/s]  9%|▉         | 9/100 [00:01<00:11,  8.00it/s] 10%|█         | 10/100 [00:01<00:10,  8.24it/s] 11%|█         | 11/100 [00:01<00:10,  8.48it/s] 12%|█▏        | 12/100 [00:01<00:10,  8.13it/s] 13%|█▎        | 13/100 [00:01<00:10,  8.46it/s] 14%|█▍        | 14/100 [00:01<00:10,  8.03it/s] 15%|█▌        | 15/100 [00:01<00:10,  8.06it/s] 16%|█▌        | 16/100 [00:01<00:10,  8.28it/s] 17%|█▋        | 17/100 [00:02<00:09,  8.47it/s] 18%|█▊        | 18/100 [00:02<00:09,  8.61it/s] 19%|█▉        | 19/100 [00:02<00:09,  8.47it/s] 20%|██        | 20/100 [00:02<00:09,  8.16it/s] 21%|██        | 21/100 [00:02<00:09,  8.21it/s] 22%|██▏       | 22/100 [00:02<00:09,  8.37it/s] 23%|██▎       | 23/100 [00:02<00:10,  7.40it/s] 24%|██▍       | 24/100 [00:03<00:10,  7.46it/s] 25%|██▌       | 25/100 [00:03<00:09,  7.78it/s] 26%|██▌       | 26/100 [00:03<00:09,  8.14it/s] 27%|██▋       | 27/100 [00:03<00:09,  7.76it/s] 29%|██▉       | 29/100 [00:03<00:08,  8.47it/s] 30%|███       | 30/100 [00:03<00:08,  8.41it/s] 32%|███▏      | 32/100 [00:03<00:07,  8.90it/s] 33%|███▎      | 33/100 [00:04<00:07,  8.73it/s] 34%|███▍      | 34/100 [00:04<00:07,  8.66it/s] 35%|███▌      | 35/100 [00:04<00:07,  8.62it/s] 36%|███▌      | 36/100 [00:04<00:10,  6.39it/s] 37%|███▋      | 37/100 [00:04<00:09,  6.89it/s] 38%|███▊      | 38/100 [00:04<00:08,  7.31it/s] 39%|███▉      | 39/100 [00:04<00:08,  7.37it/s] 41%|████      | 41/100 [00:05<00:07,  8.10it/s] 42%|████▏     | 42/100 [00:05<00:07,  8.19it/s] 43%|████▎     | 43/100 [00:05<00:07,  7.90it/s] 44%|████▍     | 44/100 [00:05<00:06,  8.11it/s] 45%|████▌     | 45/100 [00:05<00:07,  7.59it/s] 46%|████▌     | 46/100 [00:05<00:07,  6.80it/s] 47%|████▋     | 47/100 [00:05<00:07,  7.32it/s] 48%|████▊     | 48/100 [00:06<00:06,  7.60it/s] 49%|████▉     | 49/100 [00:06<00:06,  7.74it/s] 50%|█████     | 50/100 [00:06<00:06,  7.44it/s] 51%|█████     | 51/100 [00:06<00:06,  7.48it/s] 52%|█████▏    | 52/100 [00:06<00:06,  7.88it/s] 53%|█████▎    | 53/100 [00:06<00:06,  7.65it/s] 54%|█████▍    | 54/100 [00:06<00:06,  7.58it/s] 55%|█████▌    | 55/100 [00:06<00:05,  7.94it/s] 56%|█████▌    | 56/100 [00:07<00:05,  8.11it/s] 57%|█████▋    | 57/100 [00:07<00:05,  7.71it/s] 58%|█████▊    | 58/100 [00:07<00:05,  8.00it/s] 59%|█████▉    | 59/100 [00:07<00:05,  7.72it/s] 60%|██████    | 60/100 [00:07<00:05,  7.82it/s] 61%|██████    | 61/100 [00:07<00:05,  7.18it/s] 62%|██████▏   | 62/100 [00:07<00:05,  7.19it/s] 63%|██████▎   | 63/100 [00:08<00:05,  7.20it/s] 64%|██████▍   | 64/100 [00:08<00:04,  7.38it/s] 65%|██████▌   | 65/100 [00:08<00:04,  7.43it/s] 66%|██████▌   | 66/100 [00:08<00:04,  7.09it/s] 67%|██████▋   | 67/100 [00:08<00:04,  6.84it/s] 68%|██████▊   | 68/100 [00:08<00:04,  7.12it/s] 69%|██████▉   | 69/100 [00:08<00:04,  7.33it/s] 70%|███████   | 70/100 [00:09<00:04,  7.40it/s] 71%|███████   | 71/100 [00:09<00:03,  7.28it/s] 72%|███████▏  | 72/100 [00:09<00:04,  6.92it/s] 73%|███████▎  | 73/100 [00:09<00:03,  6.96it/s] 74%|███████▍  | 74/100 [00:09<00:05,  5.01it/s] 75%|███████▌  | 75/100 [00:09<00:04,  5.56it/s] 76%|███████▌  | 76/100 [00:10<00:03,  6.27it/s] 77%|███████▋  | 77/100 [00:10<00:03,  6.09it/s] 78%|███████▊  | 78/100 [00:10<00:03,  6.51it/s] 79%|███████▉  | 79/100 [00:10<00:03,  6.72it/s] 80%|████████  | 80/100 [00:10<00:02,  7.01it/s] 81%|████████  | 81/100 [00:10<00:03,  5.98it/s] 82%|████████▏ | 82/100 [00:10<00:02,  6.41it/s] 83%|████████▎ | 83/100 [00:11<00:02,  6.34it/s] 84%|████████▍ | 84/100 [00:11<00:02,  6.67it/s] 85%|████████▌ | 85/100 [00:11<00:02,  7.25it/s] 86%|████████▌ | 86/100 [00:11<00:01,  7.40it/s] 87%|████████▋ | 87/100 [00:11<00:01,  7.52it/s] 88%|████████▊ | 88/100 [00:11<00:01,  7.52it/s] 89%|████████▉ | 89/100 [00:11<00:01,  7.41it/s] 90%|█████████ | 90/100 [00:12<00:01,  7.59it/s] 91%|█████████ | 91/100 [00:12<00:01,  7.08it/s] 92%|█████████▏| 92/100 [00:12<00:01,  6.71it/s] 93%|█████████▎| 93/100 [00:12<00:01,  6.30it/s] 94%|█████████▍| 94/100 [00:12<00:01,  5.70it/s] 95%|█████████▌| 95/100 [00:12<00:00,  5.57it/s] 96%|█████████▌| 96/100 [00:13<00:00,  5.93it/s] 97%|█████████▋| 97/100 [00:13<00:00,  6.20it/s] 98%|█████████▊| 98/100 [00:13<00:00,  6.50it/s] 99%|█████████▉| 99/100 [00:13<00:00,  6.76it/s]100%|██████████| 100/100 [00:13<00:00,  6.97it/s]100%|██████████| 100/100 [00:13<00:00,  7.34it/s]
[I 2025-08-31 21:15:21,942] A new study created in memory with name: no-name-56f48da1-85e0-49b9-9cd0-ffad81ac2e70
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 29.04 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.683292, Valid_loss 0.562282
Epoch 2, Train Loss 0.609776, Valid_loss 0.525207
Epoch 3, Train Loss 0.543483, Valid_loss 0.495115
Epoch 4, Train Loss 0.523786, Valid_loss 0.465262
Epoch 5, Train Loss 0.484495, Valid_loss 0.417808
Epoch 6, Train Loss 0.459864, Valid_loss 0.386962
Epoch 7, Train Loss 0.436762, Valid_loss 0.390921
Epoch 8, Train Loss 0.411843, Valid_loss 0.434118
Epoch 9, Train Loss 0.499250, Valid_loss 0.426592
Epoch 10, Train Loss 0.407621, Valid_loss 0.383084
Epoch 11, Train Loss 0.441068, Valid_loss 0.392119
Epoch 12, Train Loss 0.412120, Valid_loss 0.373877
Epoch 13, Train Loss 0.403198, Valid_loss 0.377151
Epoch 14, Train Loss 0.389233, Valid_loss 0.365906
Epoch 15, Train Loss 0.404056, Valid_loss 0.366220
Epoch 16, Train Loss 0.360825, Valid_loss 0.353775
Epoch 17, Train Loss 0.381610, Valid_loss 0.355653
Epoch 18, Train Loss 0.358571, Valid_loss 0.341399
Epoch 19, Train Loss 0.353941, Valid_loss 0.340024
Epoch 20, Train Loss 0.382456, Valid_loss 0.329994
Epoch 21, Train Loss 0.382720, Valid_loss 0.348255
Epoch 22, Train Loss 0.346055, Valid_loss 0.329644
Epoch 23, Train Loss 0.357952, Valid_loss 0.346517
Epoch 24, Train Loss 0.372614, Valid_loss 0.320100
Epoch 25, Train Loss 0.329624, Valid_loss 0.314618
Epoch 26, Train Loss 0.365435, Valid_loss 0.315833
Epoch 27, Train Loss 0.353454, Valid_loss 0.347927
Epoch 28, Train Loss 0.352299, Valid_loss 0.304462
Epoch 29, Train Loss 0.338712, Valid_loss 0.300849
Epoch 30, Train Loss 0.343539, Valid_loss 0.342599
Epoch 31, Train Loss 0.324405, Valid_loss 0.293963
Epoch 32, Train Loss 0.332145, Valid_loss 0.300671
Epoch 33, Train Loss 0.335033, Valid_loss 0.321616
Epoch 34, Train Loss 0.341000, Valid_loss 0.304324
Epoch 35, Train Loss 0.330192, Valid_loss 0.318163
Epoch 36, Train Loss 0.327165, Valid_loss 0.305699
Epoch 37, Train Loss 0.301554, Valid_loss 0.303594
Epoch 38, Train Loss 0.328878, Valid_loss 0.307123
Epoch 39, Train Loss 0.349814, Valid_loss 0.304706
Epoch 40, Train Loss 0.342169, Valid_loss 0.290733
Epoch 41, Train Loss 0.334000, Valid_loss 0.294714
Epoch 42, Train Loss 0.309451, Valid_loss 0.303874
Epoch 43, Train Loss 0.316275, Valid_loss 0.304404
Epoch 44, Train Loss 0.332220, Valid_loss 0.310488
Epoch 45, Train Loss 0.325610, Valid_loss 0.287364
Epoch 46, Train Loss 0.314625, Valid_loss 0.301677
Epoch 47, Train Loss 0.306633, Valid_loss 0.281751
Epoch 48, Train Loss 0.319909, Valid_loss 0.296538
Epoch 49, Train Loss 0.321064, Valid_loss 0.289749
Epoch 50, Train Loss 0.314036, Valid_loss 0.277734
Epoch 51, Train Loss 0.322624, Valid_loss 0.281167
Epoch 52, Train Loss 0.311012, Valid_loss 0.292773
[I 2025-08-31 21:19:01,103] Trial 0 finished with value: 0.2777342492980616 and parameters: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 2, 'dropout': 0.7, 'weight_decay': 0.001, 'emb_dim': 64, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.2777342492980616.
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 26.96 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.648883, Valid_loss 0.605434
Epoch 2, Train Loss 0.653981, Valid_loss 0.595283
Epoch 3, Train Loss 0.633360, Valid_loss 0.586312
Epoch 4, Train Loss 0.615484, Valid_loss 0.573490
Epoch 5, Train Loss 0.575060, Valid_loss 0.556677
Epoch 6, Train Loss 0.541964, Valid_loss 0.529348
Epoch 7, Train Loss 0.507644, Valid_loss 0.499618
Epoch 8, Train Loss 0.506634, Valid_loss 0.480320
Epoch 9, Train Loss 0.497696, Valid_loss 0.461768
Epoch 10, Train Loss 0.451888, Valid_loss 0.453436
Epoch 11, Train Loss 0.448022, Valid_loss 0.452347
Epoch 12, Train Loss 0.432316, Valid_loss 0.440549
Epoch 13, Train Loss 0.424775, Valid_loss 0.434986
Epoch 14, Train Loss 0.481477, Valid_loss 0.438056
Epoch 15, Train Loss 0.439621, Valid_loss 0.427549
Epoch 16, Train Loss 0.401283, Valid_loss 0.417479
Epoch 17, Train Loss 0.416536, Valid_loss 0.425371
Epoch 18, Train Loss 0.427173, Valid_loss 0.430293
Epoch 19, Train Loss 0.390593, Valid_loss 0.411457
Epoch 20, Train Loss 0.446443, Valid_loss 0.409803
Epoch 21, Train Loss 0.438376, Valid_loss 0.410885
Epoch 22, Train Loss 0.430159, Valid_loss 0.402780
Epoch 23, Train Loss 0.388319, Valid_loss 0.392901
Epoch 24, Train Loss 0.429907, Valid_loss 0.397667
Epoch 25, Train Loss 0.390959, Valid_loss 0.383190
Epoch 26, Train Loss 0.415238, Valid_loss 0.385049
Epoch 27, Train Loss 0.428149, Valid_loss 0.392107
Epoch 28, Train Loss 0.443421, Valid_loss 0.384478
Epoch 29, Train Loss 0.406813, Valid_loss 0.381988
Epoch 30, Train Loss 0.406737, Valid_loss 0.373749
Epoch 31, Train Loss 0.402353, Valid_loss 0.376418
Epoch 32, Train Loss 0.393299, Valid_loss 0.363379
Epoch 33, Train Loss 0.383440, Valid_loss 0.358638
Epoch 34, Train Loss 0.398926, Valid_loss 0.357222
Epoch 35, Train Loss 0.396048, Valid_loss 0.344765
Epoch 36, Train Loss 0.398382, Valid_loss 0.354600
Epoch 37, Train Loss 0.388463, Valid_loss 0.348286
Epoch 38, Train Loss 0.403229, Valid_loss 0.367446
Epoch 39, Train Loss 0.396549, Valid_loss 0.362507
Epoch 40, Train Loss 0.395624, Valid_loss 0.350264
Epoch 41, Train Loss 0.375854, Valid_loss 0.389017
Epoch 42, Train Loss 0.407581, Valid_loss 0.354013
Epoch 43, Train Loss 0.410049, Valid_loss 0.360170
Epoch 44, Train Loss 0.402293, Valid_loss 0.357766
Epoch 45, Train Loss 0.350325, Valid_loss 0.350317
Epoch 46, Train Loss 0.367242, Valid_loss 0.352397
Epoch 47, Train Loss 0.404877, Valid_loss 0.355128
Epoch 48, Train Loss 0.385378, Valid_loss 0.348453
Epoch 49, Train Loss 0.380109, Valid_loss 0.346717
Epoch 50, Train Loss 0.350176, Valid_loss 0.339339
Epoch 51, Train Loss 0.391418, Valid_loss 0.350408
Epoch 52, Train Loss 0.404657, Valid_loss 0.337866
Epoch 53, Train Loss 0.360536, Valid_loss 0.335471
Epoch 54, Train Loss 0.374774, Valid_loss 0.334112
Epoch 55, Train Loss 0.373676, Valid_loss 0.332614
Epoch 56, Train Loss 0.359680, Valid_loss 0.332020
Epoch 57, Train Loss 0.392737, Valid_loss 0.329387
Epoch 58, Train Loss 0.384697, Valid_loss 0.335611
Epoch 59, Train Loss 0.392408, Valid_loss 0.331717
Epoch 60, Train Loss 0.399689, Valid_loss 0.327713
Epoch 61, Train Loss 0.379905, Valid_loss 0.323182
Epoch 62, Train Loss 0.361410, Valid_loss 0.323412
Epoch 63, Train Loss 0.376044, Valid_loss 0.327822
[I 2025-08-31 21:24:04,770] Trial 1 finished with value: 0.32318174466490746 and parameters: {'learning_rate': 0.0001, 'epochs': 100, 'heads': 4, 'dropout': 0.7, 'weight_decay': 0.001, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 0 with value: 0.2777342492980616.
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=0, batch_size=1 -> steps=0
output_class :  1
Memory Allocated: 26.96 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.662428, Valid_loss 0.565935
Epoch 2, Train Loss 0.547606, Valid_loss 0.477868
Epoch 3, Train Loss 0.485223, Valid_loss 0.448521
Epoch 4, Train Loss 0.413380, Valid_loss 0.427381
Epoch 5, Train Loss 0.403849, Valid_loss 0.370847
Epoch 6, Train Loss 0.405358, Valid_loss 0.422040
Epoch 7, Train Loss 0.379855, Valid_loss 0.426721
Epoch 8, Train Loss 0.383626, Valid_loss 0.453001
Epoch 9, Train Loss 0.380820, Valid_loss 0.425793
Epoch 10, Train Loss 0.355599, Valid_loss 0.475854
Epoch 11, Train Loss 0.365836, Valid_loss 0.469381
Epoch 12, Train Loss 0.366150, Valid_loss 0.390087
Epoch 13, Train Loss 0.346982, Valid_loss 0.361145
Epoch 14, Train Loss 0.355410, Valid_loss 0.375003
Epoch 15, Train Loss 0.362357, Valid_loss 0.429644
Epoch 16, Train Loss 0.369773, Valid_loss 0.386872
Epoch 17, Train Loss 0.308361, Valid_loss 0.350078
Epoch 18, Train Loss 0.323890, Valid_loss 0.380334
Epoch 19, Train Loss 0.346421, Valid_loss 0.362124
Epoch 20, Train Loss 0.339002, Valid_loss 0.428964
Epoch 21, Train Loss 0.317613, Valid_loss 0.340471
Epoch 22, Train Loss 0.301611, Valid_loss 0.317881
Epoch 23, Train Loss 0.313412, Valid_loss 0.303506
Epoch 24, Train Loss 0.304064, Valid_loss 0.295713
Epoch 25, Train Loss 0.312693, Valid_loss 0.285708
Epoch 26, Train Loss 0.294589, Valid_loss 0.298331
Epoch 27, Train Loss 0.300697, Valid_loss 0.316226
Epoch 28, Train Loss 0.282056, Valid_loss 0.290443
Epoch 29, Train Loss 0.286688, Valid_loss 0.276696
Epoch 30, Train Loss 0.291903, Valid_loss 0.267721
Epoch 31, Train Loss 0.302774, Valid_loss 0.303585
Epoch 32, Train Loss 0.287279, Valid_loss 0.307228
Epoch 33, Train Loss 0.300065, Valid_loss 0.324365
Epoch 34, Train Loss 0.287283, Valid_loss 0.289317
Epoch 35, Train Loss 0.289883, Valid_loss 0.277962
Epoch 36, Train Loss 0.283164, Valid_loss 0.278471
Epoch 37, Train Loss 0.278675, Valid_loss 0.272429
Epoch 38, Train Loss 0.271572, Valid_loss 0.261167
Epoch 39, Train Loss 0.281195, Valid_loss 0.249460
Epoch 40, Train Loss 0.256921, Valid_loss 0.239444
Epoch 41, Train Loss 0.279554, Valid_loss 0.268543
Epoch 42, Train Loss 0.268135, Valid_loss 0.251011
Epoch 43, Train Loss 0.270025, Valid_loss 0.328123
Epoch 44, Train Loss 0.277086, Valid_loss 0.233340
Epoch 45, Train Loss 0.274645, Valid_loss 0.263854
Epoch 46, Train Loss 0.271931, Valid_loss 0.288216
Epoch 47, Train Loss 0.274788, Valid_loss 0.258715
Epoch 48, Train Loss 0.281121, Valid_loss 0.304122
Epoch 49, Train Loss 0.280781, Valid_loss 0.266282
Epoch 50, Train Loss 0.274477, Valid_loss 0.246116
Epoch 51, Train Loss 0.272485, Valid_loss 0.288369
Epoch 52, Train Loss 0.275596, Valid_loss 0.262869
Epoch 53, Train Loss 0.262376, Valid_loss 0.279158
Epoch 54, Train Loss 0.264969, Valid_loss 0.254031
Epoch 55, Train Loss 0.265711, Valid_loss 0.261463
Epoch 56, Train Loss 0.253547, Valid_loss 0.246365
Epoch 57, Train Loss 0.255874, Valid_loss 0.257863
Epoch 58, Train Loss 0.258644, Valid_loss 0.275292
[I 2025-08-31 21:28:06,630] Trial 2 finished with value: 0.2333403088684593 and parameters: {'learning_rate': 0.001, 'epochs': 100, 'heads': 2, 'dropout': 0.5, 'weight_decay': 0.01, 'emb_dim': 32, 'augment_num': 100, 'pca': False}. Best is trial 2 with value: 0.2333403088684593.
선택된 trial params: {'learning_rate': 0.001, 'epochs': 100, 'heads': 2, 'dropout': 0.5, 'weight_decay': 0.01, 'emb_dim': 32, 'augment_num': 100, 'pca': False}
👉 train samples(학습 샘플(bag))=126, batch_size=8 -> steps(샘플수/batch크기)=16
👉 valid samples=14, batch_size=1 -> steps=14
👉 test  samples=10, batch_size=1 -> steps=10
output_class :  1
Memory Allocated: 26.96 MB
Memory Reserved: 42.00 MB
cuda
Epoch 1, Train Loss 0.619539, Valid_loss 0.532151
Epoch 2, Train Loss 0.491895, Valid_loss 0.492910
Epoch 3, Train Loss 0.399211, Valid_loss 0.425416
Epoch 4, Train Loss 0.375893, Valid_loss 0.437791
Epoch 5, Train Loss 0.419044, Valid_loss 0.436328
Epoch 6, Train Loss 0.367458, Valid_loss 0.462562
Epoch 7, Train Loss 0.376795, Valid_loss 0.411350
Epoch 8, Train Loss 0.328927, Valid_loss 0.381586
Epoch 9, Train Loss 0.344783, Valid_loss 0.378303
Epoch 10, Train Loss 0.358631, Valid_loss 0.398650
Epoch 11, Train Loss 0.350714, Valid_loss 0.432363
Epoch 12, Train Loss 0.346978, Valid_loss 0.367754
Epoch 13, Train Loss 0.330338, Valid_loss 0.337587
Epoch 14, Train Loss 0.320240, Valid_loss 0.383678
Epoch 15, Train Loss 0.349835, Valid_loss 0.437188
Epoch 16, Train Loss 0.328870, Valid_loss 0.356151
Epoch 17, Train Loss 0.308594, Valid_loss 0.341989
Epoch 18, Train Loss 0.346683, Valid_loss 0.345955
Epoch 19, Train Loss 0.305885, Valid_loss 0.363735
Epoch 20, Train Loss 0.322281, Valid_loss 0.341214
Epoch 21, Train Loss 0.302094, Valid_loss 0.348549
Epoch 22, Train Loss 0.318118, Valid_loss 0.332020
Epoch 23, Train Loss 0.277314, Valid_loss 0.349175
Epoch 24, Train Loss 0.291237, Valid_loss 0.330623
Epoch 25, Train Loss 0.276553, Valid_loss 0.365511
Epoch 26, Train Loss 0.290196, Valid_loss 0.367694
Epoch 27, Train Loss 0.294522, Valid_loss 0.322021
Epoch 28, Train Loss 0.276309, Valid_loss 0.282247
Epoch 29, Train Loss 0.294180, Valid_loss 0.293131
Epoch 30, Train Loss 0.272711, Valid_loss 0.305491
Epoch 31, Train Loss 0.277573, Valid_loss 0.290394
Epoch 32, Train Loss 0.272926, Valid_loss 0.287868
Epoch 33, Train Loss 0.279185, Valid_loss 0.281705
Epoch 34, Train Loss 0.255120, Valid_loss 0.282272
Epoch 35, Train Loss 0.268727, Valid_loss 0.260999
Epoch 36, Train Loss 0.281435, Valid_loss 0.277328
Epoch 37, Train Loss 0.286881, Valid_loss 0.281093
Epoch 38, Train Loss 0.258693, Valid_loss 0.272265
Epoch 39, Train Loss 0.285586, Valid_loss 0.303693
Epoch 40, Train Loss 0.284883, Valid_loss 0.254938
Epoch 41, Train Loss 0.307691, Valid_loss 0.285243
Epoch 42, Train Loss 0.274138, Valid_loss 0.306818
Epoch 43, Train Loss 0.267093, Valid_loss 0.253185
Epoch 44, Train Loss 0.280547, Valid_loss 0.304821
Epoch 45, Train Loss 0.260852, Valid_loss 0.280687
Epoch 46, Train Loss 0.255574, Valid_loss 0.283078
Epoch 47, Train Loss 0.259193, Valid_loss 0.252825
Epoch 48, Train Loss 0.248392, Valid_loss 0.239039
Epoch 49, Train Loss 0.280428, Valid_loss 0.243912
Epoch 50, Train Loss 0.268809, Valid_loss 0.338211
Epoch 51, Train Loss 0.278609, Valid_loss 0.250797
Epoch 52, Train Loss 0.268222, Valid_loss 0.268004
Epoch 53, Train Loss 0.247518, Valid_loss 0.246068
Epoch 54, Train Loss 0.266241, Valid_loss 0.242972
Epoch 55, Train Loss 0.270354, Valid_loss 0.237066
Epoch 56, Train Loss 0.249873, Valid_loss 0.259508
Epoch 57, Train Loss 0.255569, Valid_loss 0.235020
Epoch 58, Train Loss 0.262159, Valid_loss 0.251129
Epoch 59, Train Loss 0.253678, Valid_loss 0.227812
Epoch 60, Train Loss 0.258297, Valid_loss 0.247096
Epoch 61, Train Loss 0.245634, Valid_loss 0.242028
Epoch 62, Train Loss 0.253575, Valid_loss 0.241436
Epoch 63, Train Loss 0.255912, Valid_loss 0.228494
Epoch 64, Train Loss 0.247613, Valid_loss 0.237529
Epoch 65, Train Loss 0.252163, Valid_loss 0.209927
Epoch 66, Train Loss 0.252637, Valid_loss 0.243119
Epoch 67, Train Loss 0.252737, Valid_loss 0.224097
Epoch 68, Train Loss 0.257945, Valid_loss 0.236705
Epoch 69, Train Loss 0.256250, Valid_loss 0.372441
환자ID=COVID19_Participant13 -- true: 1 -- pred: 1
환자ID=COVID19_Participant15 -- true: 1 -- pred: 1
환자ID=COVID19_Participant23 -- true: 1 -- pred: 1
환자ID=COVID19_Participant25 -- true: 1 -- pred: 1
환자ID=COVID19_Participant27 -- true: 1 -- pred: 1
환자ID=COVID19_Participant36 -- true: 1 -- pred: 1
환자ID=COVID19_Participant4 -- true: 1 -- pred: 1
환자ID=Control_Participant11 -- true: 0 -- pred: 1
환자ID=Control_Participant2 -- true: 0 -- pred: 1
환자ID=Control_Participant7 -- true: 0 -- pred: 0
Best performance: Epoch 65, Loss 0.252163, Test ACC 0.800000, Test AUC 0.857143, Test Recall 1.000000, Test Precision 0.777778
Confusion Matrix:
 [1 2 0 7]
✅ Total valid splits used: 5

📌 Repeat 4: 평균 AUC = 0.9524, 표준편차 = 0.0522
Test ACC 평균 0.820000, Test Recall 평균 0.828571, Test Precision 평균 0.926984
fold_aucs = [0.9523809523809524, 0.9523809523809524, 1.0, 1.0, 0.8571428571428572]
NaN 개수: 0 / 전체 5개


================ 전체 Repeat 요약 ================
Repeat 0: AUC 0.9048 ± 0.0904 | ACC 0.8600 | Recall 0.8857 | Precision 0.9400 | NaN 0/5
Repeat 1: AUC 0.9524 ± 0.0738 | ACC 0.8600 | Recall 0.8857 | Precision 0.9064 | NaN 0/5
Repeat 2: AUC 0.8857 ± 0.0233 | ACC 0.8000 | Recall 0.8000 | Precision 0.9083 | NaN 0/5
Repeat 3: AUC 0.9143 ± 0.0923 | ACC 0.8000 | Recall 0.8857 | Precision 0.8614 | NaN 0/5
Repeat 4: AUC 0.9524 ± 0.0522 | ACC 0.8200 | Recall 0.8286 | Precision 0.9270 | NaN 0/5

🏁 최종 결과 (각 Repeat의 AUC 평균의 평균): 0.9219 ± 0.0265
