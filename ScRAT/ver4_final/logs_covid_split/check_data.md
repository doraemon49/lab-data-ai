# 1. ì›ë³¸(ê¸°ë³¸) ë°ì´í„°
ë¼ë²¨ë³„ ê·¸ë£¹ ê°œìˆ˜ {1: 28, 0: 12}
ë¼ë²¨ë³„ ê·¸ë£¹ ê°œìˆ˜ {1: 7, 0: 3}

  â†’ train_p_index í™˜ì ìˆ˜ (í™˜ì ë‹¨ìœ„ë¡œ ë¬¶ì¸ index list): 40
  â†’ test_p_index í™˜ì ìˆ˜  (í™˜ì ë‹¨ìœ„ë¡œ ë¬¶ì¸ index list): 10

    â†’ train í™˜ì ID ë° ë¼ë²¨:
    ID: COVID19_Participant10, Label: 1
    ID: COVID19_Participant12, Label: 1
    ID: COVID19_Participant13, Label: 1
    ID: COVID19_Participant14, Label: 1
    ID: COVID19_Participant15, Label: 1
    ID: COVID19_Participant17, Label: 1
    ID: COVID19_Participant19, Label: 1
    ID: COVID19_Participant2, Label: 1
    ID: COVID19_Participant20, Label: 1
    ID: COVID19_Participant21, Label: 1
    ID: COVID19_Participant22, Label: 1
    ID: COVID19_Participant23, Label: 1
    ID: COVID19_Participant26, Label: 1
    ID: COVID19_Participant27, Label: 1
    ID: COVID19_Participant29, Label: 1
    ID: COVID19_Participant3, Label: 1
    ID: COVID19_Participant31, Label: 1
    ID: COVID19_Participant32, Label: 1
    ID: COVID19_Participant35, Label: 1
    ID: COVID19_Participant36, Label: 1
    ID: COVID19_Participant37, Label: 1
    ID: COVID19_Participant38, Label: 1
    ID: COVID19_Participant4, Label: 1
    ID: COVID19_Participant40, Label: 1
    ID: COVID19_Participant5, Label: 1
    ID: COVID19_Participant6, Label: 1
    ID: COVID19_Participant7, Label: 1
    ID: COVID19_Participant9, Label: 1
    ID: Control_Participant1, Label: 0
    ID: Control_Participant10, Label: 0
    ID: Control_Participant11, Label: 0
    ID: Control_Participant12, Label: 0
    ID: Control_Participant13, Label: 0
    ID: Control_Participant15, Label: 0
    ID: Control_Participant2, Label: 0
    ID: Control_Participant3, Label: 0
    ID: Control_Participant4, Label: 0
    ID: Control_Participant5, Label: 0
    ID: Control_Participant6, Label: 0
    ID: Control_Participant8, Label: 0
  â†’ test í™˜ì ID ë° ë¼ë²¨:
    ID: COVID19_Participant11, Label: 1
    ID: COVID19_Participant18, Label: 1
    ID: COVID19_Participant25, Label: 1
    ID: COVID19_Participant28, Label: 1
    ID: COVID19_Participant30, Label: 1
    ID: COVID19_Participant39, Label: 1
    ID: COVID19_Participant8, Label: 1
    ID: Control_Participant14, Label: 0
    ID: Control_Participant7, Label: 0
    ID: Control_Participant9, Label: 0




# 2. train_dataì—ì„œ í™˜ì ë‹¨ìœ„ë¡œ, trainê³¼ validation 
train_p_index_ 26
valid_p_index 14
test_p_index 10

â†’ train í™˜ì ID ë° ë¼ë²¨:
   ì´ ê°œìˆ˜: 26
   í™˜ìID=Control_Participant10, Label=0, ì…€ê°œìˆ˜=1645
   í™˜ìID=Control_Participant15, Label=0, ì…€ê°œìˆ˜=528
   í™˜ìID=COVID19_Participant19, Label=1, ì…€ê°œìˆ˜=816
   í™˜ìID=COVID19_Participant38, Label=1, ì…€ê°œìˆ˜=51
   í™˜ìID=COVID19_Participant10, Label=1, ì…€ê°œìˆ˜=18
   í™˜ìID=Control_Participant4, Label=0, ì…€ê°œìˆ˜=440
   í™˜ìID=COVID19_Participant14, Label=1, ì…€ê°œìˆ˜=382
   í™˜ìID=COVID19_Participant2, Label=1, ì…€ê°œìˆ˜=329
   í™˜ìID=COVID19_Participant40, Label=1, ì…€ê°œìˆ˜=381
   í™˜ìID=COVID19_Participant13, Label=1, ì…€ê°œìˆ˜=730
   í™˜ìID=COVID19_Participant20, Label=1, ì…€ê°œìˆ˜=2033
   í™˜ìID=Control_Participant2, Label=0, ì…€ê°œìˆ˜=41
   í™˜ìID=COVID19_Participant27, Label=1, ì…€ê°œìˆ˜=93
   í™˜ìID=Control_Participant6, Label=0, ì…€ê°œìˆ˜=131
   í™˜ìID=Control_Participant5, Label=0, ì…€ê°œìˆ˜=717
   í™˜ìID=COVID19_Participant15, Label=1, ì…€ê°œìˆ˜=1003
   í™˜ìID=Control_Participant8, Label=0, ì…€ê°œìˆ˜=393
   í™˜ìID=Control_Participant11, Label=0, ì…€ê°œìˆ˜=1164
   í™˜ìID=COVID19_Participant22, Label=1, ì…€ê°œìˆ˜=865
   í™˜ìID=COVID19_Participant31, Label=1, ì…€ê°œìˆ˜=410
   í™˜ìID=COVID19_Participant26, Label=1, ì…€ê°œìˆ˜=814
   í™˜ìID=COVID19_Participant17, Label=1, ì…€ê°œìˆ˜=843
   í™˜ìID=COVID19_Participant6, Label=1, ì…€ê°œìˆ˜=84
   í™˜ìID=COVID19_Participant4, Label=1, ì…€ê°œìˆ˜=1680
   í™˜ìID=COVID19_Participant37, Label=1, ì…€ê°œìˆ˜=668
   í™˜ìID=COVID19_Participant3, Label=1, ì…€ê°œìˆ˜=104
â†’ valid í™˜ì ID ë° ë¼ë²¨:
   ì´ ê°œìˆ˜: 14
   í™˜ìID=Control_Participant13, Label=0, ì…€ê°œìˆ˜=88
   í™˜ìID=COVID19_Participant29, Label=1, ì…€ê°œìˆ˜=573
   í™˜ìID=COVID19_Participant35, Label=1, ì…€ê°œìˆ˜=83
   í™˜ìID=COVID19_Participant32, Label=1, ì…€ê°œìˆ˜=1665
   í™˜ìID=COVID19_Participant5, Label=1, ì…€ê°œìˆ˜=89
   í™˜ìID=COVID19_Participant21, Label=1, ì…€ê°œìˆ˜=39
   í™˜ìID=Control_Participant3, Label=0, ì…€ê°œìˆ˜=1620
   í™˜ìID=Control_Participant1, Label=0, ì…€ê°œìˆ˜=414
   í™˜ìID=COVID19_Participant9, Label=1, ì…€ê°œìˆ˜=86
   í™˜ìID=COVID19_Participant7, Label=1, ì…€ê°œìˆ˜=409
   í™˜ìID=Control_Participant12, Label=0, ì…€ê°œìˆ˜=99
   í™˜ìID=COVID19_Participant36, Label=1, ì…€ê°œìˆ˜=200
   í™˜ìID=COVID19_Participant12, Label=1, ì…€ê°œìˆ˜=102
   í™˜ìID=COVID19_Participant23, Label=1, ì…€ê°œìˆ˜=307
â†’ test í™˜ì ID ë° ë¼ë²¨:
   ì´ ê°œìˆ˜: 10
   í™˜ìID=COVID19_Participant11, Label=1, ì…€ê°œìˆ˜=382
   í™˜ìID=COVID19_Participant18, Label=1, ì…€ê°œìˆ˜=227
   í™˜ìID=COVID19_Participant25, Label=1, ì…€ê°œìˆ˜=496
   í™˜ìID=COVID19_Participant28, Label=1, ì…€ê°œìˆ˜=1079
   í™˜ìID=COVID19_Participant30, Label=1, ì…€ê°œìˆ˜=116
   í™˜ìID=COVID19_Participant39, Label=1, ì…€ê°œìˆ˜=454
   í™˜ìID=COVID19_Participant8, Label=1, ì…€ê°œìˆ˜=462
   í™˜ìID=Control_Participant14, Label=0, ì…€ê°œìˆ˜=274
   í™˜ìID=Control_Participant7, Label=0, ì…€ê°œìˆ˜=762
   í™˜ìID=Control_Participant9, Label=0, ì…€ê°œìˆ˜=558


# 3. ======= sample mixup ... ============

# 4.samling() : bag()ë§Œë“¦

# 5. hyper parameter tuning 5ë²ˆ ì‹œí–‰
ğŸ‘‰ train samples(í•™ìŠµ ìƒ˜í”Œ(bag))=126, batch_size=16 -> steps(ìƒ˜í”Œìˆ˜/batchí¬ê¸°)=8
ğŸ‘‰ valid samples=14, batch_size=1 -> steps=14
ğŸ‘‰ test  samples=0, batch_size=1 -> steps=0

# 6. test ê²°ê³¼
ì„ íƒëœ trial params: {'learning_rate': 0.001, 'epochs': 100, 'heads': 1, 'dropout': 0.5, 'weight_decay': 0.01, 'emb_dim': 8, 'augment_num': 100, 'pca': False}
ğŸ‘‰ train samples(í•™ìŠµ ìƒ˜í”Œ(bag))=126, batch_size=16 -> steps(ìƒ˜í”Œìˆ˜/batchí¬ê¸°)=8
ğŸ‘‰ valid samples=14, batch_size=1 -> steps=14
ğŸ‘‰ test  samples=10, batch_size=1 -> steps=10

í™˜ìID=COVID19_Participant11 -- true: 1 -- pred: 1
í™˜ìID=COVID19_Participant18 -- true: 1 -- pred: 1
í™˜ìID=COVID19_Participant25 -- true: 1 -- pred: 1
í™˜ìID=COVID19_Participant28 -- true: 1 -- pred: 1
í™˜ìID=COVID19_Participant30 -- true: 1 -- pred: 1
í™˜ìID=COVID19_Participant39 -- true: 1 -- pred: 1
í™˜ìID=COVID19_Participant8 -- true: 1 -- pred: 1
í™˜ìID=Control_Participant14 -- true: 0 -- pred: 0
í™˜ìID=Control_Participant7 -- true: 0 -- pred: 1
í™˜ìID=Control_Participant9 -- true: 0 -- pred: 0

Best performance: Epoch 30, Loss 0.504947, Test ACC 0.900000, Test AUC 1.000000, Test Recall 1.000000, Test Precision 0.875000
Confusion Matrix:
 [2 1 0 7]

# +. ì„ íƒëœ hyperparameterë¡œ, ê¸°ë³¸ ScRAT ì½”ë“œ (ì „í˜€ ìˆ˜ì • ì•ˆ í•œ ì›ë³¸)ì— ë„£ì–´ì„œ ëŒë ¤ë´¤ë‹¤.
